[{"tags": ["c++", "boost", "variant"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506557016, "post_id": 46458902, "comment_id": 79873253, "body": "BTW, you forgot lot of overloads (the ones where 3rd parameter is <code>std::string</code>)"}, {"owner": {"reputation": 2958, "user_id": 3781180, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a7fddcdb3bbcaa60147ebe56231c22c1?s=128&d=identicon&r=PG&f=1", "display_name": "OneRaynyDay", "link": "https://stackoverflow.com/users/3781180/oneraynyday"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506557058, "post_id": 46458902, "comment_id": 79873264, "body": "@Jarod42 I know. I&#39;m just trying to prove a point here"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1506557145, "post_id": 46458902, "comment_id": 79873293, "body": "Well, point proven. If you want to use boost, you&#39;ll have to deal with the limitation. If you need more than two arguments, replace them with a single structure, containing as many values as you wish."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1506557395, "post_id": 46458902, "comment_id": 79873353, "body": "With updated version, it is avalaible:  <a href=\"http://www.boost.org/doc/libs/1_65_1/doc/html/boost/apply_visitor.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_65_1/doc/html/boost/apply_visitor.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2958, "user_id": 3781180, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a7fddcdb3bbcaa60147ebe56231c22c1?s=128&d=identicon&r=PG&f=1", "display_name": "OneRaynyDay", "link": "https://stackoverflow.com/users/3781180/oneraynyday"}, "edited": false, "score": 0, "creation_date": 1506557954, "post_id": 46459002, "comment_id": 79873472, "body": "Got it. Thank you! I wish they could make this a little bit more visible. Also, it&#39;s extremely hard to read the error messages in this boost lib. :("}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "reply_to_user": {"reputation": 2958, "user_id": 3781180, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a7fddcdb3bbcaa60147ebe56231c22c1?s=128&d=identicon&r=PG&f=1", "display_name": "OneRaynyDay", "link": "https://stackoverflow.com/users/3781180/oneraynyday"}, "edited": false, "score": 0, "creation_date": 1506558113, "post_id": 46459002, "comment_id": 79873506, "body": "@OneRaynyDay Google searches rarely turn up the latest Boost release documentation, but if you&#39;re looking at old documentation, there will be a yellow box at the top that says you&#39;re not looking at the latest release and has a link for the latest docs (although that link is broken in some cases :))"}], "tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 2, "last_activity_date": 1506557978, "last_edit_date": 1506557978, "creation_date": 1506557620, "answer_id": 46459002, "question_id": 46458902, "link": "https://stackoverflow.com/questions/46458902/how-to-get-around-variant-apply-visitor-not-supporting-3-args/46459002#46459002", "title": "How to get around variant apply_visitor not supporting 3 args?", "body": "<p>You're looking at documentation for Boost 1.36, which was <a href=\"http://www.boost.org/users/history/\" rel=\"nofollow noreferrer\">released in 2008</a>. If you look at the <a href=\"http://www.boost.org/doc/libs/release/doc/html/boost/apply_visitor.html\" rel=\"nofollow noreferrer\">documentation for the current release</a>, it lists the following <code>apply_visitor</code> overloads</p>\n\n<pre><code>template&lt;typename MultiVisitor, typename Variant1, typename Variant2, \n         typename Variant3&gt; \n  typename MultiVisitor::result_type OR decltype(auto) \n  apply_visitor(MultiVisitor &amp; visitor, Variant1 &amp; operand1, \n                Variant2 &amp; operand2, Variant3 &amp; operand3, ... other_operands);\ntemplate&lt;typename MultiVisitor, typename Variant1, typename Variant2, \n         typename Variant3&gt; \n  typename MultiVisitor::result_type OR decltype(auto) \n  apply_visitor(const MultiVisitor &amp; visitor, Variant1 &amp; operand1, \n                Variant2 &amp; operand2, Variant3 &amp; operand3, ... other_operands);\n</code></pre>\n\n<p>The documentation also states</p>\n\n<blockquote>\n  <p>Overloads accepting three or more operands invoke the function call operator of the given visitor on the content of the given variant operands. ... <strong>Those functions are actually defined in a header <code>boost/variant/multivisitors.hpp</code></strong> ... <strong>That header must be manually included if multi visitors are meant for use.</strong></p>\n</blockquote>\n\n<p>So make sure you're using a recent Boost release, include the relevant header, define the missing <code>operator()</code> overloads for the 3 argument example and your code should compile.</p>\n"}], "owner": {"reputation": 2958, "user_id": 3781180, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a7fddcdb3bbcaa60147ebe56231c22c1?s=128&d=identicon&r=PG&f=1", "display_name": "OneRaynyDay", "link": "https://stackoverflow.com/users/3781180/oneraynyday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 46459002, "answer_count": 1, "score": 1, "last_activity_date": 1506557978, "creation_date": 1506556707, "question_id": 46458902, "link": "https://stackoverflow.com/questions/46458902/how-to-get-around-variant-apply-visitor-not-supporting-3-args", "title": "How to get around variant apply_visitor not supporting 3 args?", "body": "<p>For some reason, using boost's variant(I know there is a c++17 version, I'm providing backwards compatibility here, and plus c++17 isn't fully supported by clang++ yet) leads to some strange behavior when using the visitor paradigm:</p>\n\n<h1>2 arguments, works</h1>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/variant.hpp&gt;\n\nusing boost::variant;\n\ntypedef boost::variant&lt;double, std::string&gt; term_t;\n\nclass plus_visitor : public boost::static_visitor&lt;term_t&gt; {\npublic:\n    term_t operator()(double lhs, double rhs) const{\n        return {lhs + rhs};\n    }\n    term_t operator()(double lhs, std::string rhs) const{\n        return {lhs + std::stoi(rhs)};\n    }\n    term_t operator()(std::string lhs, int rhs) const{\n        return operator()(rhs, lhs);\n    }\n    term_t operator()(std::string lhs, std::string rhs) const{\n        return std::stoi(lhs) + std::stoi(rhs);\n    }\n};\n\nint main(){\n    // term_t lhs {3.0};\n    term_t rhs {\"10\"};\n    term_t lhs {\"3\"};\n    term_t res = boost::apply_visitor(plus_visitor(), lhs, rhs);\n    std::cout &lt;&lt; res &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>It outputs 13 as expected.</p>\n\n<h1>3 arguments, explodes</h1>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/variant.hpp&gt;\n\nusing boost::variant;\n\ntypedef boost::variant&lt;double, std::string&gt; term_t;\n\nclass plus_visitor : public boost::static_visitor&lt;term_t&gt; {\npublic:\n    term_t operator()(double lhs, double rhs, double x) const{\n        return {lhs + rhs + x};\n    }\n    term_t operator()(double lhs, std::string rhs, double x) const{\n        return {lhs + std::stoi(rhs) + x};\n    }\n    term_t operator()(std::string lhs, double rhs, double x) const{\n        return operator()(rhs, lhs, x);\n    }\n    term_t operator()(std::string lhs, std::string rhs, double x) const{\n        return std::stoi(lhs) + std::stoi(rhs) + x;\n    }\n};\n\nint main(){\n    term_t rhs {\"10\"};\n    term_t lhs {\"3\"};\n    term_t x {3.0};\n    term_t res = boost::apply_visitor(plus_visitor(), lhs, rhs, x);\n    std::cout &lt;&lt; res &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>What's the deal here? Does <code>apply_visitor</code> only work for 2 arguments?</p>\n\n<h1>Diagnosis</h1>\n\n<p>I looked to the documentation and found that: </p>\n\n<p><a href=\"http://www.boost.org/doc/libs/1_36_0/doc/html/boost/apply_visitor.html\" rel=\"nofollow noreferrer\">http://www.boost.org/doc/libs/1_36_0/doc/html/boost/apply_visitor.html</a></p>\n\n<p><code>apply_visitor</code> works only for binary arguments or unary arguments! This sucks! How can I work around this and supply a 3rd one without being completely ugly in the syntax? Is there another <code>boost</code> library function that allows more inputs? Why does the boost library not use variadic templates to allow for arbitrary sized <code>apply_visitor</code> functions?</p>\n"}, {"tags": ["c#", "c++"], "comments": [{"owner": {"reputation": 1553, "user_id": 6443307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pguLy.gif?s=128&g=1", "display_name": "wablab", "link": "https://stackoverflow.com/users/6443307/wablab"}, "edited": false, "score": 0, "creation_date": 1506555961, "post_id": 46458806, "comment_id": 79872997, "body": "It&#39;d probably help to know your ultimate goal here (e.g. what is your code going to do with <code>ptrb</code>)."}, {"owner": {"reputation": 4354, "user_id": 3339274, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sROPZ.jpg?s=128&g=1", "display_name": "ifconfig", "link": "https://stackoverflow.com/users/3339274/ifconfig"}, "edited": false, "score": 0, "creation_date": 1506556078, "post_id": 46458806, "comment_id": 79873021, "body": "Decide, <a href=\"https://stackoverflow.com/questions/tagged/c%23\">c#</a> or <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a>, but not both."}, {"owner": {"reputation": 5196, "user_id": 6501141, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UhrNj.jpg?s=128&g=1", "display_name": "LightCC", "link": "https://stackoverflow.com/users/6501141/lightcc"}, "edited": false, "score": 0, "creation_date": 1506556139, "post_id": 46458806, "comment_id": 79873037, "body": "What is the context of this?  C# avoids pointers and memory management. There is likely a better solution, or this is possibly unnecessary in C#, but we need more info on why you believe this needs to be translated."}, {"owner": {"reputation": 53, "user_id": 5693084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b7ca62d43ec3ef9f8513d47cc547bc?s=128&d=identicon&r=PG&f=1", "display_name": "xQueryUser", "link": "https://stackoverflow.com/users/5693084/xqueryuser"}, "edited": false, "score": 0, "creation_date": 1506558552, "post_id": 46458806, "comment_id": 79873585, "body": "I am trying to convert a small section of a library that does some YUV scaling and conversion and the code is in C/C++ . I didn&#39;t want to include the whole C++ library to the c# application since it is huge. Hence the idea of converting just the needed routines but I ran into pointer conversion issues as pointed above. I was just including a small section of the C++ routine"}, {"owner": {"reputation": 1553, "user_id": 6443307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pguLy.gif?s=128&g=1", "display_name": "wablab", "link": "https://stackoverflow.com/users/6443307/wablab"}, "edited": false, "score": 0, "creation_date": 1506566879, "post_id": 46458806, "comment_id": 79875462, "body": "Right, I was just wondering how the pointer was being used. Is the code making a copy of the array, iterating over it, etc. Knowing that might help answer your question. There generally isn&#39;t a direct translation of c++ pointer code to c#. Depending on your use case, you might be able to use the <code>fixed</code> keyword to work with pointers directly in your c# code."}, {"owner": {"reputation": 1553, "user_id": 6443307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pguLy.gif?s=128&g=1", "display_name": "wablab", "link": "https://stackoverflow.com/users/6443307/wablab"}, "edited": false, "score": 0, "creation_date": 1506612871, "post_id": 46458806, "comment_id": 79901159, "body": "@xQueryUser, take a look at this for more information on the <code>fixed</code> keyword in C#.  It&#39;ll allow you to work with pointers in small sections of code, which might be sufficient for what you&#39;re trying to do.  <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/fixed-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/csharp/language-reference/&hellip;</a>"}, {"owner": {"reputation": 1553, "user_id": 6443307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pguLy.gif?s=128&g=1", "display_name": "wablab", "link": "https://stackoverflow.com/users/6443307/wablab"}, "edited": false, "score": 0, "creation_date": 1506993849, "post_id": 46458806, "comment_id": 80026405, "body": "Hi, @xQueryUser, did you ever get this sorted out?"}, {"owner": {"reputation": 53, "user_id": 5693084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b7ca62d43ec3ef9f8513d47cc547bc?s=128&d=identicon&r=PG&f=1", "display_name": "xQueryUser", "link": "https://stackoverflow.com/users/5693084/xqueryuser"}, "reply_to_user": {"reputation": 1553, "user_id": 6443307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pguLy.gif?s=128&g=1", "display_name": "wablab", "link": "https://stackoverflow.com/users/6443307/wablab"}, "edited": false, "score": 0, "creation_date": 1507137816, "post_id": 46458806, "comment_id": 80094992, "body": "@wablab, hi, i am still going through the conversion and haven&#39;t had a chance to compile and execute the code yet but i am taking the unsafe/fixed keyword as a consideration in the code during the conversion. Thanks very much for your help."}], "answers": [{"tags": [], "owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "is_accepted": false, "score": 1, "last_activity_date": 1506948434, "last_edit_date": 1506948434, "creation_date": 1506568079, "answer_id": 46460339, "question_id": 46458806, "link": "https://stackoverflow.com/questions/46458806/c-to-c-conversion-for-const-uint8/46460339#46460339", "title": "C++ to C# conversion for const uint8*", "body": "<p>One way would be to have a single array that contains a_and_b elements</p>\n\n<pre><code>void SomeMethod(byte[] array, long offsetForBPart)\n{\n   //TODO is array big enough?\n   var b0 = array[0+offsetForBPart]; \n   var b1 = array[1+offsetForBPart]; \n   var b2 = array[2+offsetForBPart]; \n   //You get the idea;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1553, "user_id": 6443307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pguLy.gif?s=128&g=1", "display_name": "wablab", "link": "https://stackoverflow.com/users/6443307/wablab"}, "is_accepted": false, "score": 1, "last_activity_date": 1506719877, "creation_date": 1506719877, "answer_id": 46497025, "question_id": 46458806, "link": "https://stackoverflow.com/questions/46458806/c-to-c-conversion-for-const-uint8/46497025#46497025", "title": "C++ to C# conversion for const uint8*", "body": "<p>In C#, this is often not the best approach, but it does answer your question specifically.  You can use the <code>unsafe</code> and <code>fixed</code> keywords as follows:</p>\n\n<pre><code>public unsafe void DoSomething(byte[] data, long src)\n{\n    fixed (byte* ptra = data)\n    {\n        byte* ptrb = ptra + src;\n        // do your work... e.g.\n        //   ptrb[0] = 10;\n        //   ...is equivalent to...\n        //   data[src] = 10;\n    }\n}\n</code></pre>\n\n<p>To use this approach, you'll have to compile your code as 'unsafe'.  If you're using Visual Studio, you can right-click the project node in Solution Explorer and select Properties.  Under the Build tab of the properties pages, check the 'Allow unsafe code' box.</p>\n"}], "owner": {"reputation": 53, "user_id": 5693084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b7ca62d43ec3ef9f8513d47cc547bc?s=128&d=identicon&r=PG&f=1", "display_name": "xQueryUser", "link": "https://stackoverflow.com/users/5693084/xqueryuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506948434, "creation_date": 1506555758, "question_id": 46458806, "link": "https://stackoverflow.com/questions/46458806/c-to-c-conversion-for-const-uint8", "title": "C++ to C# conversion for const uint8*", "body": "<p>is there a way to convert this:</p>\n\n<pre><code>function (const uint8* ptra, long src)\n{\n\n  const uint8* ptrb = ptra + src;\n}\n</code></pre>\n\n<p>I've tried converting each const uint* to a byte[] but i'm not sure how to handle the ptra + src.\nThanks</p>\n"}, {"tags": ["c++", "templates", "static-methods"], "comments": [{"owner": {"reputation": 766, "user_id": 6926706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/551619408360290/picture?type=large", "display_name": "Kirill Korolev", "link": "https://stackoverflow.com/users/6926706/kirill-korolev"}, "edited": false, "score": 0, "creation_date": 1506556810, "post_id": 46458790, "comment_id": 79873184, "body": "do you imply to pass some arguments into addOption method?"}, {"owner": {"reputation": 11, "user_id": 8388105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a915ea45ae5ee9557311dae4021c54?s=128&d=identicon&r=PG&f=1", "display_name": "William Thompson", "link": "https://stackoverflow.com/users/8388105/william-thompson"}, "reply_to_user": {"reputation": 766, "user_id": 6926706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/551619408360290/picture?type=large", "display_name": "Kirill Korolev", "link": "https://stackoverflow.com/users/6926706/kirill-korolev"}, "edited": false, "score": 0, "creation_date": 1506557068, "post_id": 46458790, "comment_id": 79873266, "body": "yes. like a default value, a std::string keyName, and a std::string comment"}, {"owner": {"reputation": 766, "user_id": 6926706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/551619408360290/picture?type=large", "display_name": "Kirill Korolev", "link": "https://stackoverflow.com/users/6926706/kirill-korolev"}, "edited": false, "score": 0, "creation_date": 1506557563, "post_id": 46458790, "comment_id": 79873395, "body": "So, as far as you&#39;re using a template method, you&#39;re planning to use it with several classes. Therefore, each T class has to contain &quot;keyName&quot; and &quot;comment&quot; properties. Am I right? Otherwise, if MyClass is the only one that should be configured, I don&#39;t see any point to use templates."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1506556500, "creation_date": 1506556500, "answer_id": 46458877, "question_id": 46458790, "link": "https://stackoverflow.com/questions/46458790/template-call-static-method/46458877#46458877", "title": "Template call static method", "body": "<p>You may use something like:</p>\n\n<pre><code>class Config\n{\npublic:\n    // ...\n\n    template &lt;typename T&gt;\n    void addOption()\n    {\n        T::toConfig();\n    }\n\n};\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>Config configInstance;\n\nconfigInstance.addOption&lt;MyClass&gt;();\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8388105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a915ea45ae5ee9557311dae4021c54?s=128&d=identicon&r=PG&f=1", "display_name": "William Thompson", "link": "https://stackoverflow.com/users/8388105/william-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1506556500, "creation_date": 1506555587, "question_id": 46458790, "link": "https://stackoverflow.com/questions/46458790/template-call-static-method", "title": "Template call static method", "body": "<p>I'm making a config library and would like to add the ability for users to make a class object configurable.\nI want users to be able to run <code>configInstance.addOption&lt;MyClass&gt;()</code> and it run <code>MyClass::toConfig()</code>.</p>\n\n<p>How would I implement this?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8549610"}, "edited": false, "score": 0, "creation_date": 1506554762, "post_id": 46458604, "comment_id": 79872735, "body": "Consider adding <code>include_directories(&#47;path&#47;to&#47;include)</code> and <code>link_directories(&#47;path&#47;to&#47;lib)</code> before <code>add_executable()</code>. And then <code>target_link_libraries(pngwriter)</code> after <code>add_executable()</code>. Please replace <code>&#47;path&#47;to</code> with relevant values."}, {"owner": {"reputation": 365, "user_id": 5206420, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LTn4O.jpg?s=128&g=1", "display_name": "Roy Varon", "link": "https://stackoverflow.com/users/5206420/roy-varon"}, "edited": false, "score": 0, "creation_date": 1506555905, "post_id": 46458604, "comment_id": 79872983, "body": "Thank you so much, after adding: include_directories(C:/MinGW/include) link_directories(C:/MinGW/lib) and:  target_link_libraries(myproject pngwriter) it worked perfectly"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8549610"}, "edited": false, "score": 0, "creation_date": 1506556323, "post_id": 46458604, "comment_id": 79873080, "body": "You&#39;re always welcome. Shall I repost my advice as an answer?"}, {"owner": {"reputation": 365, "user_id": 5206420, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LTn4O.jpg?s=128&g=1", "display_name": "Roy Varon", "link": "https://stackoverflow.com/users/5206420/roy-varon"}, "edited": false, "score": 0, "creation_date": 1506558639, "post_id": 46458604, "comment_id": 79873603, "body": "Yes, I think that&#39;s a good idea."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1506585217, "post_id": 46458604, "comment_id": 79882273, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43136418/how-to-add-l-ell-compiler-flag-in-cmake\">How to add &quot;-l&quot; (ell) compiler flag in CMake</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8549610"}, "is_accepted": true, "score": 1, "last_activity_date": 1506575250, "creation_date": 1506575250, "answer_id": 46461356, "question_id": 46458604, "link": "https://stackoverflow.com/questions/46458604/dynamic-link-error-cmake/46461356#46461356", "title": "Dynamic link error cmake", "body": "<p>Consider adding <code>include_directories(/path/to/include)</code> and <code>link_directories(/path/to/lib)</code> before <code>add_executable()</code>.</p>\n\n<p>And then insert <code>target_link_libraries(pngwriter)</code> after <code>add_executable()</code>.</p>\n\n<p><code>/path/to</code> shall be replaced with relevant values for your system.</p>\n"}], "owner": {"reputation": 365, "user_id": 5206420, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LTn4O.jpg?s=128&g=1", "display_name": "Roy Varon", "link": "https://stackoverflow.com/users/5206420/roy-varon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 46461356, "answer_count": 1, "score": 0, "last_activity_date": 1506575250, "creation_date": 1506554107, "question_id": 46458604, "link": "https://stackoverflow.com/questions/46458604/dynamic-link-error-cmake", "title": "Dynamic link error cmake", "body": "<p>When I compile my code using command line everything works fine:</p>\n\n<pre><code>g++ main.cpp -lpngwriter\n</code></pre>\n\n<p>But when I try using cmake I get undefined reference errors.\nCMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(myproject)\n\nset(CMAKE_CXX_STANDARD 11)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -lpngwriter\")\n\nset(SOURCE_FILES main.cpp)\n\nadd_executable(myproject ${SOURCE_FILES})\n</code></pre>\n\n<p>Any ideas how to fix it?</p>\n"}, {"tags": ["c++", "c++11", "unique-ptr"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1506553989, "post_id": 46458514, "comment_id": 79872553, "body": "wild guessing I assume that your compiler tries to <code>.insert()</code> the range using copying, which is forbidden in case of perfoming it on <code>std::unique_ptr</code>"}, {"owner": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "edited": false, "score": 0, "creation_date": 1506554105, "post_id": 46458514, "comment_id": 79872578, "body": "yea I had a similar thought, and i tried using the std::move. got the same error."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "edited": false, "score": 0, "creation_date": 1506554453, "post_id": 46458611, "comment_id": 79872664, "body": "yes im aware of exclusive ownership that unique_ptr does. i didn&#39;t know about make_move_iterator. thanks a lot! :D it works"}, {"owner": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 1, "creation_date": 1506554551, "post_id": 46458611, "comment_id": 79872684, "body": "Yes. <code>use of deleted function &#39;unique_ptr(const std::unique_ptr&amp;)&#39;</code> &quot;Thou shalt not copy unique_ptr&quot;"}, {"owner": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "edited": false, "score": 0, "creation_date": 1506554729, "post_id": 46458611, "comment_id": 79872728, "body": "Didn&#39;t he fall anyways? haha"}], "tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 5, "last_activity_date": 1506554156, "creation_date": 1506554156, "answer_id": 46458611, "question_id": 46458514, "link": "https://stackoverflow.com/questions/46458514/stdset-of-unique-ptr-range-insert/46458611#46458611", "title": "std::set of unique ptr range insert", "body": "<pre><code>tmpSet.insert(tmpEnts.begin(), tmpEnts.end());\n</code></pre>\n\n<p>is trying to copy elements from the <code>vector</code> to the <code>set</code>. That fails to compile because <code>unique_ptr</code> is not copyable, it must be moved. You can move the elements by using <a href=\"http://en.cppreference.com/w/cpp/iterator/move_iterator\" rel=\"noreferrer\"><code>move_iterator</code></a>s instead.</p>\n\n<pre><code>tmpSet.insert(\n    std::make_move_iterator(tmpEnts.begin()),\n    std::make_move_iterator(tmpEnts.end()));\n</code></pre>\n\n<p>Note that after the above call, each <code>Entity</code> object in your <code>vector</code> will have been moved from.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "edited": false, "score": 0, "creation_date": 1506554265, "post_id": 46458612, "comment_id": 79872624, "body": "that part i figured out what i was saying is when i am using the iterator of the vector to copy data to the set, is where i am getting lost."}, {"owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "reply_to_user": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "edited": false, "score": 0, "creation_date": 1506554390, "post_id": 46458612, "comment_id": 79872650, "body": "@EvgenyDanilenko, I have added the missing implementation for copying data from the vector to the set."}, {"owner": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "edited": false, "score": 0, "creation_date": 1506554595, "post_id": 46458612, "comment_id": 79872696, "body": "yea i didn&#39;t know about std::make_move_iterator. I&#39;m relatively new to c++ as well but not new to programming. started learning c++ by building a simple 2d engine. currently implementing my ecs architecture. Thanks for your answer :)"}], "tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": false, "score": 1, "last_activity_date": 1506554346, "last_edit_date": 1506554346, "creation_date": 1506554174, "answer_id": 46458612, "question_id": 46458514, "link": "https://stackoverflow.com/questions/46458514/stdset-of-unique-ptr-range-insert/46458612#46458612", "title": "std::set of unique ptr range insert", "body": "<p>First of all, let me say that if you are planning of moving these pointers around, <code>unique_ptr</code> is not the preferred way to go, but rather <code>shared_ptr</code>.</p>\n\n<p>Second, <code>unique_ptr</code>-s cannot be just inserted into an adt. They have to be moved. So in order for your code to work, you have to use <code>std::move</code> semantics:</p>\n\n<pre><code>std::set&lt;std::unique_ptr&lt;int&gt;&gt; tmpSet;\n\nint main(int argc, char ** argv) {\n    tmpSet.insert(std::move(std::make_unique&lt;int&gt;(1)));\n    tmpSet.insert(std::move(std::make_unique&lt;int&gt;(2)));\n}\n</code></pre>\n\n<p>Or, when moving from one adt to another:</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;int&gt;&gt; tmpEnts;\nstd::set&lt;std::unique_ptr&lt;int&gt;&gt; tmpSet;\n\nint main(int argc, char ** argv) {\n    tmpEnts.push_back(std::move(std::make_unique&lt;int&gt;(1)));\n    tmpEnts.push_back(std::move(std::make_unique&lt;int&gt;(2)));\n\n    auto from = std::make_move_iterator(tmpEnts.begin());\n    auto to = std::make_move_iterator(tmpEnts.end());\n    tmpSet.insert(from, to);\n}\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 2779247, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/eda4d3fdc813bb4016803cb755b65144?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeny Danilenko", "link": "https://stackoverflow.com/users/2779247/evgeny-danilenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 46458611, "answer_count": 2, "score": 1, "last_activity_date": 1506554346, "creation_date": 1506553543, "last_edit_date": 1506554025, "question_id": 46458514, "link": "https://stackoverflow.com/questions/46458514/stdset-of-unique-ptr-range-insert", "title": "std::set of unique ptr range insert", "body": "<p>I have 2 data structures which hold a set of unique_ptr like so</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;Entity&gt;&gt; tmpEnts;\nstd::set&lt;std::unique_ptr&lt;Entity&gt;&gt; tmpSet;\n</code></pre>\n\n<p>I am trying to perform an insert as shown below but i get errors when i compile. I am new to smart pointers.</p>\n\n<pre><code>tmpSet.insert(tmpEnts.begin(), tmpEnts.end());\n</code></pre>\n\n<p>tmpEnts is actually a simplification, it actually resides in a <code>std::map&lt;uint, std::vector&lt;std::unique_ptr&lt;Entity&gt;&gt;&gt; entities</code></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The error is takes up a lot of space but i think there's something here which I don't really understand yet.</p>\n\n<pre><code>/home/evgen/workspace/test/ecs/src/entity_manager.cpp:41:22:   required from here\n/usr/include/c++/7.2.0/ext/new_allocator.h:136:4: error: use of deleted function \u2018std::unique_ptr&lt;_Tp, _Dp&gt;::unique_ptr(const std::unique_ptr&lt;_Tp, _Dp&gt;&amp;) [with _Tp = Entity; _Dp = std::default_delete&lt;Entity&gt;]\u2019\n  { ::new((void *)__p) _Up(std::forward&lt;_Args&gt;(__args)...); }\n    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn file included from /usr/include/c++/7.2.0/memory:80:0,\n                 from /home/evgen/workspace/test/ecs/src/entity.hpp:4,\n                 from /home/evgen/workspace/test/ecs/src/entity_manager.cpp:4:\n/usr/include/c++/7.2.0/bits/unique_ptr.h:388:7: note: declared here\n       unique_ptr(const unique_ptr&amp;) = delete;\n</code></pre>\n"}, {"tags": ["c++", "stl", "iterator", "containers"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1506553062, "post_id": 46458416, "comment_id": 79872322, "body": "&quot;I&#39;m stumped!&quot; is not a proper error message. Why exactly did <code>std::advance</code> not do the right thing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1506553126, "post_id": 46458416, "comment_id": 79872350, "body": "Binary search without random access iterators? What&#39;s the point?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1506553241, "post_id": 46458416, "comment_id": 79872378, "body": "Binary search for non-random-access ranges is useless. You have to iterate the range anyways, so you can just as well do a linear search. Binary search will be at most equally good, probably much worse."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8550177"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1506553571, "post_id": 46458416, "comment_id": 79872455, "body": "@nwp If I do &quot;ln current = advance(first, midpoint);&quot; I get &quot;error: conversion from \u2018void\u2019 to non-scalar type \u2018std::_List_iterator&lt;int&gt;\u2019 requested&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8550177"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1506553691, "post_id": 46458416, "comment_id": 79872481, "body": "@BaummitAugen Ideally it will just take the median of (first, last) and start the usual binary search. This is just for practice, I&#39;m not implementing it in a large program"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1506554953, "post_id": 46458416, "comment_id": 79872777, "body": "<code>ln current = advance(first, midpoint);</code> is not the correct usage. <a href=\"http://en.cppreference.com/w/cpp/iterator/advance\" rel=\"nofollow noreferrer\"><code>std::advance</code></a> advances the iterator <code>first</code>, it doesn&#39;t return an iterator. You would use <code>current = first; std::advance(current, midpoint);</code> instead."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1506556391, "post_id": 46458416, "comment_id": 79873100, "body": "@manni66 \u2014 if comparisons are expensive, the smaller number of comparisons done by a binary search can outweigh the linear movements."}], "owner": {"user_type": "does_not_exist", "display_name": "user8550177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506552892, "creation_date": 1506552892, "question_id": 46458416, "link": "https://stackoverflow.com/questions/46458416/getting-the-nth-value-of-any-stl-container-and-manipulating-iterators", "title": "Getting the nth value of any STL container and manipulating iterators", "body": "<p>I'm trying to write a function that can do a binary search for any given STL container (i.e lists, vectors, etc). My approach was using two iterators, one for the beginning and end of the sequences.</p>\n\n<pre><code>template &lt;class ln, class T&gt; int binarysearch_list(ln first, ln last, T search_value) {\n    int low = 0;\n    int high = 0;\n    int midpoint = 0;\n    int start = 0;\n\n    while(first != last) {\n        first++;\n        start++;\n    }\n    high = start;\n\n    while(low &lt;= high) {\n        ln current = next(first, midpoint);\n        if(search_value == *current) {   // if we already find search_value at the midpoint we can simply exit\n            return midpoint;\n        } else if(search_value &gt; midpoint) {\n            low = midpoint + 1; // change the low to the next element after midpoint\n        } else if(search_value &lt; midpoint) {\n            high = midpoint - 1;\n        }\n    }\n    return -1;\n}\n</code></pre>\n\n<p>The first while loop is used to get the size, the second one is the actual binary search. I get an error at ln current = next(first, midpoint), I'm not sure how to tackle increment the iterator. Ideally, where you see \"if(search_value == *current)\" it will act like vector[midpoint] or list(midpoint). I need a way to read the nth element of any given sequence using a begin and end iterator, and I need a way to flexibly increment an iterator by n. I've tried advance(first, amount), (first+amount), and many others but I'm stumped!</p>\n"}, {"tags": ["c++", "arrays", "language-lawyer", "sizeof"], "comments": [{"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1506552744, "post_id": 46458363, "comment_id": 79872238, "body": "Given that <code>sizeof</code> is always dealing with the static type and not runtime values, I don&#39;t think how the actual memory behaves matters. Whether <code>sizeof(T[N]) == N * sizeof(T)</code> is a type system and preprocessor concern."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 1, "creation_date": 1506553843, "post_id": 46458363, "comment_id": 79872520, "body": "@AsadSaeeduddin - correct, I don&#39;t think I implied otherwise? Or perhaps it was a reply to a now-deleted comment."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1506554882, "post_id": 46458363, "comment_id": 79872762, "body": "I was commenting on the discussion from the thread you linked to. It may very well be the case that there are runtimes where arrays occupy more space than the sum of their element sizes, but this has no bearing on the fact that <code>sizeof(T[N])</code> is <code>N * sizeof(T)</code>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1506554920, "post_id": 46458363, "comment_id": 79872770, "body": "@AsadSaeeduddin agreed."}, {"owner": {"reputation": 127, "user_id": 5233906, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lc-5enLAHpg/AAAAAAAAAAI/AAAAAAAAABY/tZdjPGEySF8/photo.jpg?sz=128", "display_name": "H\u1ea3i Ph\u1ea1m L&#234;", "link": "https://stackoverflow.com/users/5233906/h%e1%ba%a3i-ph%e1%ba%a1m-l%c3%aa"}, "edited": false, "score": 1, "creation_date": 1506572923, "post_id": 46458363, "comment_id": 79876838, "body": "Thanks for your question, I have chances to read the sizeof document, <a href=\"http://en.cppreference.com/w/cpp/language/sizeof\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/sizeof</a>, you can find that in notes section, they mentioned that sizeof when apply to class type, its result will include additional padding required to insert that object to array."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506576202, "post_id": 46458363, "comment_id": 79877738, "body": "I originally looked at this topic because of another question. I&#39;m not sure if it directly asked the same thing and this is a duplicate, or if it was tangential like to your other question; I&#39;ll post a link if I find it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1506585759, "post_id": 46458363, "comment_id": 79882600, "body": "Arrays cannot contain any padding other than paddind at the end of each individual element, which is already included in sizeof(element)."}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1506576277, "post_id": 46458393, "comment_id": 79877769, "body": "I think the question is if <code>sizeof(T)</code> allows extra padding <i>just for the array</i>. All of the individual objects have padding, but does the standard allow the array itself to have padding beyond beyond the padding of the elements?"}, {"owner": {"reputation": 168655, "user_id": 582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ev49G.png?s=128&g=1", "display_name": "Lily Ballard", "link": "https://stackoverflow.com/users/582/lily-ballard"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506620341, "post_id": 46458393, "comment_id": 79905446, "body": "Where would that extra padding come from?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506621227, "post_id": 46458393, "comment_id": 79905940, "body": "From the compiler saying that <code>sizeof(T[N]) &gt; N * sizeof(T)</code>, so it puts extra padding at the end. The C++ standard doesn\u2019t say very much about layout, and as long as the extra padding maintained the alignment requirements of <code>T[N]</code>, which would need to be at least those of <code>T</code> (I think that is required to be exactly the same, but I\u2019m not sure), it would be allowed."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1506624541, "post_id": 46458393, "comment_id": 79907760, "body": "@DanielH When discussing <code>sizeof</code>, the standard says that padding may be added at the end of class types and this padding is included in the size, for the purpose of placing objects of these types in an array. In the very next sentence it discusses <code>sizeof</code> applied to array types, and it doesn&#39;t say that padding may be added at the end of those (that&#39;s what @melpomene quotes). Why invent things that the standard never mentions?"}], "tags": [], "owner": {"reputation": 168655, "user_id": 582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ev49G.png?s=128&g=1", "display_name": "Lily Ballard", "link": "https://stackoverflow.com/users/582/lily-ballard"}, "is_accepted": false, "score": 2, "last_activity_date": 1506552756, "creation_date": 1506552756, "answer_id": 46458393, "question_id": 46458363, "link": "https://stackoverflow.com/questions/46458363/is-it-guaranteed-that-sizeoftn-n-sizeoft/46458393#46458393", "title": "Is it guaranteed that sizeof(T[N]) == N * sizeof(T)?", "body": "<p>The whole point of <code>sizeof</code> is it includes the relevant padding. Every element of an array is exactly <code>sizeof(T)</code> bytes after the previous element. So the size of the entire array is <code>N * sizeof(T)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506576082, "post_id": 46458404, "comment_id": 79877698, "body": "The thing is, I don&#39;t know where &quot;the total number of bytes in the array&quot; is defined, and I think that the statement &quot;This implies...&quot; is false; I think the rest of the standard without that statement does not imply there is no invisible padding at the end. If I&#39;m correct about that, then the question is whether that sentence counts as equivalent to &quot;It is guaranteed that the size of an array of <i>n</i> elements is <i>n</i> times the size of an element&quot; or just a problem in the standard."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506615971, "post_id": 46458404, "comment_id": 79902985, "body": "@DanielH Of course it is true, there is no padding in the end of the array. It is not mentioned anywhere in the standard that such padding may exist. &quot;An object of array type contains a contiguously allocated non-empty set of N subobjects of type T.&quot; Nothing more. Only class types may have padding bytes."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1506621570, "post_id": 46458404, "comment_id": 79906140, "body": "@n.m. If you go by \u201cof course\u201d, then you\u2019re going to get undefined behavior fairly quickly. Now that you point out that quote, I do remember seeing it, but people weren\u2019t sure on whether it meant it had to contain <i>only</i> those things or not."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1506623551, "post_id": 46458404, "comment_id": 79907228, "body": "@DanielH standard mentions more than once that the size of the array is the size of its element times the size of the element. This answer quotes one such mention, there are others. Whether they are legally normative or not, I don&#39;t really care. This is clearly the intent which is no less important than the actual wording."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 11, "last_activity_date": 1506552837, "creation_date": 1506552837, "answer_id": 46458404, "question_id": 46458363, "link": "https://stackoverflow.com/questions/46458363/is-it-guaranteed-that-sizeoftn-n-sizeoft/46458404#46458404", "title": "Is it guaranteed that sizeof(T[N]) == N * sizeof(T)?", "body": "<p>Yes. <em>[expr.sizeof]</em> includes this bit about <code>sizeof</code>:</p>\n\n<blockquote>\n  <p>When applied to an array, the result is the total number of bytes in the array. This implies that the size of an array of <em>n</em> elements is <em>n</em> times the size of an element.</p>\n</blockquote>\n"}], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1506584758, "creation_date": 1506552516, "last_edit_date": 1506584758, "question_id": 46458363, "link": "https://stackoverflow.com/questions/46458363/is-it-guaranteed-that-sizeoftn-n-sizeoft", "title": "Is it guaranteed that sizeof(T[N]) == N * sizeof(T)?", "body": "<p>I had always assumed that the size of an array of N elements of type <code>T</code>, as returned by <code>sizeof</code> was guaranteed to be exactly N times <code>sizeof(T)</code>. </p>\n\n<p>The <a href=\"https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-types-t/46458123?noredirect=1#comment79871390_46457449\">comments on this question</a> made me doubt it though. There are claims from reputable users that arrays may contain padding, which would break the equality. Of course such platforms may not exist, but are they allowed?</p>\n\n<p>If allowed, this would break many common idioms, such as calculating the needed storage for an array with <code>N * sizeof(T)</code>, or calculating the number of elements in an array using <code>sizeof(a)/sizeof(a[0])</code>. </p>\n"}, {"tags": ["c++", "c++11", "containers"], "comments": [{"owner": {"reputation": 14813, "user_id": 717898, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fca765c2ca8ea02f1897879ec60c4ab0?s=128&d=identicon&r=PG", "display_name": "Andrew Lazarus", "link": "https://stackoverflow.com/users/717898/andrew-lazarus"}, "edited": false, "score": 0, "creation_date": 1506552499, "post_id": 46458344, "comment_id": 79872191, "body": "<code>reverse_iterator</code>"}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 3483742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0Zo2.jpg?s=128&g=1", "display_name": "jdzions", "link": "https://stackoverflow.com/users/3483742/jdzions"}, "edited": false, "score": 0, "creation_date": 1506632995, "post_id": 46458486, "comment_id": 79911838, "body": "The key fact that I&#39;d missed was converting the bidirectional iterator returned from std::map::find() to a reverse iterator. I can&#39;t be quite as concise as your code here; my context requires me to throw if X isn&#39;t actually in the map. That&#39;s only one extra check, though, so it&#39;s still pretty clean.  I don&#39;t suppose you&#39;ve made that helper function available via gist or GitHub or blog posting..."}, {"owner": {"reputation": 2352, "user_id": 5711725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfaab398800db4fd0e9b0aae6621bda?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Mart&#237;n", "link": "https://stackoverflow.com/users/5711725/javier-mart%c3%adn"}, "reply_to_user": {"reputation": 116, "user_id": 3483742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0Zo2.jpg?s=128&g=1", "display_name": "jdzions", "link": "https://stackoverflow.com/users/3483742/jdzions"}, "edited": false, "score": 0, "creation_date": 1506635527, "post_id": 46458486, "comment_id": 79912772, "body": "@jdzions Maybe <a href=\"https://gist.github.com/anonymous/dd626b0dccfd70eb134bde5738bf79fa\" rel=\"nofollow noreferrer\">like this</a>? Note that this only has the very basic requirement, which is having a begin and end method. In C++17 you would also have a size method, I think."}], "tags": [], "owner": {"reputation": 2352, "user_id": 5711725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfaab398800db4fd0e9b0aae6621bda?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Mart&#237;n", "link": "https://stackoverflow.com/users/5711725/javier-mart%c3%adn"}, "is_accepted": false, "score": 2, "last_activity_date": 1506553367, "creation_date": 1506553367, "answer_id": 46458486, "question_id": 46458344, "link": "https://stackoverflow.com/questions/46458344/how-do-i-walk-a-bidirectional-iterator-backwards-in-clean-code/46458486#46458486", "title": "How do I walk a bidirectional iterator backwards in clean code?", "body": "<p>You want to process every item with key X <em>or lower</em>, and to do the processing starting at the element with key X and then go backwards. What you could do is use <code>reverse_iterator</code> on the first element <em>past</em> key X and create a reverse iterator, which points to the element <em>just before</em> the one you gave it. Then you can iterate until the \"reverse end\":</p>\n\n<pre><code>auto pastX = mymap.upper_bound(X); // First element with key &gt; X\n// make_reverse_iterator returns iter that dereferences to the previous element\nfor (auto iter = std::make_reverse_iterator(pastX); iter != mymap.rend(); ++iter)\n    // Use *iter\n</code></pre>\n\n<p>For better readability, I usually keep some helper functions to create an \"iterable object\" (one which can be called with <code>.begin()</code> and <code>.end()</code>) from a pair of iterators, so I would actually write:</p>\n\n<pre><code>auto pastX = mymap.upper_bound(X);\n// \"IteRange\" would return a \"range-for-iterable\" object from two iterators\nfor (auto&amp;&amp; elem : IteRange(std::make_reverse_iterator(pastX), mymap.rend()))\n    // Use elem\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 3483742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0Zo2.jpg?s=128&g=1", "display_name": "jdzions", "link": "https://stackoverflow.com/users/3483742/jdzions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506553367, "creation_date": 1506552426, "question_id": 46458344, "link": "https://stackoverflow.com/questions/46458344/how-do-i-walk-a-bidirectional-iterator-backwards-in-clean-code", "title": "How do I walk a bidirectional iterator backwards in clean code?", "body": "<p>Suppose I have an std::map and want to do something to the item with key X and every item with a higher key (remember, this is an ordered map). The code is obvious and clear:</p>\n\n<pre><code>auto iter = mymap.find(X);\nwhile (iter != mymap.end()) {\n    process(*iter);\n    iter++;\n}\n</code></pre>\n\n<p>or, possibly better, <code>std::for_each(mymap.find(X), mymap.end(), process)</code>. </p>\n\n<p>But if my task is to perform processing on the item with key X and every item with a <em>lower</em> key, in that order, I can't find a clean coding pattern that expresses intent.</p>\n\n<pre><code>auto iter mymap.find(x);\nif (iter != mymap.end()) {\n    iter++;                           // Go forward...\n    while (iter != mymap.begin()) {\n        iter--;                       // ... so we can go backwards\n        process(*iter);\n    }\n}\n</code></pre>\n\n<p>If I didn't want to do them in reverse order, it would be easy enough to increment the iterator returned by std::map::find() and then use std::for_each(mymap.begin(), incremented_iter, process).</p>\n\n<p>Bidirectional iterators aren't reverse iterators, so I can't use <code>mymap.rend()</code> as the \"off the beginning\" to compare against in a while() loop.</p>\n\n<p>Is there a clean way to do this in C++11 (or in +14 or +17, so I'll have something to look forward to)?</p>\n"}, {"tags": ["c++", "string", "algorithm", "reverse"], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1506555774, "last_edit_date": 1506555774, "creation_date": 1506554532, "answer_id": 46458656, "question_id": 46458269, "link": "https://stackoverflow.com/questions/46458269/converting-to-c-style-string/46458656#46458656", "title": "Converting to C style String", "body": "<p>The function is entirely invalid.</p>\n\n<p>For example the parameter should be declared as <code>std::string &amp;</code>.</p>\n\n<p>It is a bad idea when the function depends on a global variable.</p>\n\n<p>In this statement</p>\n\n<pre><code>char* a1 = a.c_str;\n</code></pre>\n\n<p>there are at once two errors. First of all instead of <code>a.c_str</code> there must be <code>a.c_str()</code>. And the member function <code>c_str</code> returns a constant pointer.</p>\n\n<p>This pointer</p>\n\n<pre><code>char* a2;\n</code></pre>\n\n<p>has indeterminate value.</p>\n\n<p>So as you till now know nothing about how the function can be written in C++ then I'll just show several variants of its implementation. </p>\n\n<p>The simplest one is the following</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstd::string &amp; Reverse( std::string &amp;s )\n{\n    s.assign(s.rbegin(), s.rend());\n\n    return s;\n}\n\n\nint main()\n{\n    std::string s = \"zombie\";\n\n    std::cout &lt;&lt; s &lt;&lt; std::endl;\n    std::cout &lt;&lt; Reverse(s) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>The function uses reversed iterators of the <code>class std::string</code>.</p>\n\n<p>Another approach is to use the standard algorithm <code>std::reverse</code> declared in the header <code>&lt;algorithm&gt;</code></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n\nstd::string &amp; Reverse(std::string &amp;s)\n{\n    std::reverse(s.begin(), s.end());\n\n    return s;\n}\n\nint main()\n{\n    std::string s = \"zombie\";\n\n    std::cout &lt;&lt; s &lt;&lt; std::endl;\n    std::cout &lt;&lt; Reverse(s) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>If you want to write the function yourself using a loop then its implementation can look like</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n\nstd::string &amp; Reverse(std::string &amp;s)\n{\n    for (std::string::size_type i = 0, n = s.size(); i &lt; n / 2; i++)\n    {\n        //std::swap(s[i], s[n - i - 1]);\n        char c = s[i];\n        s[i] = s[n - i - 1];\n        s[n - i - 1] = c;\n    }\n\n    return s;\n}\n\nint main()\n{\n    std::string s = \"zombie\";\n\n    std::cout &lt;&lt; s &lt;&lt; std::endl;\n    std::cout &lt;&lt; Reverse(s) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>In all three cases the program output looks like</p>\n\n<pre><code>zombie\neibmoz\n</code></pre>\n\n<p>You can also try to write the function yourself using iterators (either bidirectional or random) instead of indices.</p>\n"}], "owner": {"reputation": 61, "user_id": 8686114, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1831646316862688/picture?type=large", "display_name": "Granzo", "link": "https://stackoverflow.com/users/8686114/granzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 46458656, "answer_count": 1, "score": -3, "last_activity_date": 1506556008, "creation_date": 1506551920, "last_edit_date": 1506556008, "question_id": 46458269, "link": "https://stackoverflow.com/questions/46458269/converting-to-c-style-string", "title": "Converting to C style String", "body": "<p>I'm trying to create a function that takes in a string, the reverses it, which is all being done in main. Here's what I have so far. </p>\n\n<pre><code>#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n\nstd::string str = \"zombie\";\n\n\nvoid Reverse( std::string a)\n{\n\n    char* a1 = a.c_str;\n    char* a2;\n\n    for (int i = (strlen(a1) -1); a1[i]!=0; i--)\n    {\n        a2 += a1[i];\n    }\n\n    str = a2;\n}\n\nint main()\n{\n    Reverse(str);\n\n    std::cout &lt;&lt; str &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>But i keep getting this error. I can't utilize pointers in this question. Any suggestions?</p>\n\n<p>EDIT: I'm particularly having issues with converting the inserted parameter a into a c-style string. </p>\n\n<p>EDIT 2: So I started cleaning it up a bit, to my understanding, the code that I had wouldn't accomplish my goal at all, even with proper changes. Would this be on a better track? I plan on just converting the string to c-style before passing it to the function.</p>\n\n<pre><code>void Reverse(const char* s)\n{\n    int x = strlen(s);\n    std::string str = \"\";\n\n    for (int c = x; c &gt; 0; c--)\n    {\n        str += s[c];\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "xcode", "macos"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8327671, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/452476815120896/picture?type=large", "display_name": "Tyler Bloom", "link": "https://stackoverflow.com/users/8327671/tyler-bloom"}, "edited": false, "score": 0, "creation_date": 1506554097, "post_id": 46458488, "comment_id": 79872576, "body": "That is where it is located already. What is this exactly? -&gt; % clang++ main.cpp % ./a.out"}, {"owner": {"reputation": 61, "user_id": 8327671, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/452476815120896/picture?type=large", "display_name": "Tyler Bloom", "link": "https://stackoverflow.com/users/8327671/tyler-bloom"}, "edited": false, "score": 0, "creation_date": 1506554197, "post_id": 46458488, "comment_id": 79872605, "body": "Oh that is how it ran in terminal sorry I thought that was for Xcode. This is very strange why my Xcode isn&#39;t working"}, {"owner": {"reputation": 61, "user_id": 8327671, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/452476815120896/picture?type=large", "display_name": "Tyler Bloom", "link": "https://stackoverflow.com/users/8327671/tyler-bloom"}, "edited": false, "score": 0, "creation_date": 1506554453, "post_id": 46458488, "comment_id": 79872663, "body": "Ok wow I got it to work. The other files I had in the project were causing the error somehow even though they were not referenced in main.cpp. Thanks!"}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": true, "score": 0, "last_activity_date": 1506553385, "creation_date": 1506553385, "answer_id": 46458488, "question_id": 46458268, "link": "https://stackoverflow.com/questions/46458268/c-xcode-linker-error-with-header-file/46458488#46458488", "title": "C++, Xcode, linker error with header file", "body": "<p>I was able to get this to build and run, both from the command line:</p>\n\n<pre><code>% clang++ main.cpp\n% ./a.out\n20\n</code></pre>\n\n<p>and from XCode.  With XCode, it wants to find your <code>main.h</code> as part of the project, so it should show up in the project directory next to <code>main.cpp</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YFuro.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YFuro.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can just drag the file into the project.  If that's not your issue, than I don't have any other suggestions for you, hopefully others do.</p>\n"}], "owner": {"reputation": 61, "user_id": 8327671, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/452476815120896/picture?type=large", "display_name": "Tyler Bloom", "link": "https://stackoverflow.com/users/8327671/tyler-bloom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 46458488, "answer_count": 1, "score": 0, "last_activity_date": 1506553385, "creation_date": 1506551913, "question_id": 46458268, "link": "https://stackoverflow.com/questions/46458268/c-xcode-linker-error-with-header-file", "title": "C++, Xcode, linker error with header file", "body": "<p>I'm learning C++ using Xcode however I always get a linker error when I try to initialize a class in a header file. Here is <code>main.cpp:</code></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include \"main.h\"\n\nusing namespace std;\nint main() {\n    Rectangle rect(4, 5);\n    cout &lt;&lt; rect.area() &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>and <code>main.h</code>...  </p>\n\n<pre><code>#ifndef main_h\n#define main_h\nusing namespace std;\n\nclass Rectangle {\n    int width,height;\npublic:\n    Rectangle(int,int);\n    int area() {return width*height;}\n};\n\nRectangle::Rectangle (int x, int y) { width=x; height=y; }\n\n#endif /* main_h */\n</code></pre>\n\n<p>..and the linker error</p>\n\n<pre><code>clang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>I know Xcode is reading main.h because I used to get a \"file not found\" error (as well a bunch of others) but I fixed all of that and no longer get those errors. From what I understand Xcode is not able to build the machine code from these 2 files for some reason because if I just copy/paste all the code into one file it does work.</p>\n"}, {"tags": ["c++", "package", "nuget", "nuspec", "invalid-characters"], "comments": [{"owner": {"reputation": 125, "user_id": 473339, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a63c1452e90df52e74d564bb491a8c26?s=128&d=identicon&r=PG", "display_name": "Mikael Floberg", "link": "https://stackoverflow.com/users/473339/mikael-floberg"}, "edited": false, "score": 0, "creation_date": 1507103206, "post_id": 46458256, "comment_id": 80072897, "body": "I am in the exact same position and cant find a solution"}], "answers": [{"tags": [], "owner": {"reputation": 883, "user_id": 791587, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ttz5G.jpg?s=128&g=1", "display_name": "TDN", "link": "https://stackoverflow.com/users/791587/tdn"}, "is_accepted": true, "score": 0, "last_activity_date": 1512075558, "creation_date": 1512075558, "answer_id": 47582517, "question_id": 46458256, "link": "https://stackoverflow.com/questions/46458256/create-nuget-package-with-special-character-in-assembly-name/47582517#47582517", "title": "Create NuGet Package with Special Character in Assembly Name", "body": "<p>This thread pointed me to a workaround:\n<a href=\"https://stackoverflow.com/questions/19810844/nuget-encodes-the-blank-spaces-in-names-of-files\">nuget encodes the blank spaces in names of files</a></p>\n\n<p>In my case, I was using 7-Zip to unzip the NuGet package. That is when the filenames got messed up. I ran the command below and it worked (I tested with NuGet.exe v4.4.1).</p>\n\n<pre><code>nuget.exe install MyPackage -OutputDirectory C:\\test\n</code></pre>\n\n<p>What this command does is it downloads and extracts the package into the output directory.</p>\n"}], "owner": {"reputation": 883, "user_id": 791587, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ttz5G.jpg?s=128&g=1", "display_name": "TDN", "link": "https://stackoverflow.com/users/791587/tdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 47582517, "answer_count": 1, "score": 1, "last_activity_date": 1512075558, "creation_date": 1506551840, "last_edit_date": 1506616265, "question_id": 46458256, "link": "https://stackoverflow.com/questions/46458256/create-nuget-package-with-special-character-in-assembly-name", "title": "Create NuGet Package with Special Character in Assembly Name", "body": "<p>I have a project with C++ code that creates an assembly with a name like this: \"C++Adapter.dll\". I have not been able to create a proper NuGet package due to the \"++\" in the assembly name. When I run the nuget pack command-line, it goes and create a package but the assembly name is somehow changed and looks like this: \"C%2B%%2B%Adapter.dll\". Is there a workaround for this?</p>\n\n<p>Here is what my .nuspec file looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;package xmlns=\"http://schemas.microsoft.com/packaging/2011/08/nuspec.xsd\"&gt;\n  &lt;metadata&gt;\n    &lt;id&gt;$id$&lt;/id&gt;\n    &lt;version&gt;$version$&lt;/version&gt;\n  &lt;/metadata&gt;\n  &lt;files&gt;\n    &lt;file src=\"..\\bin\\*.dll\" exclude=\"**\\*.pdb;**\\*.dll.metagen\" target=\"MyFolder\" /&gt;\n  &lt;/files&gt;\n&lt;/package&gt;\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1506552325, "post_id": 46458224, "comment_id": 79872154, "body": "Prefer not to use global variables."}, {"owner": {"reputation": 169, "user_id": 8606156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/32ed1a7af959d4336bdc6107c1eb83a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pape Sow Traore", "link": "https://stackoverflow.com/users/8606156/pape-sow-traore"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1506566493, "post_id": 46458224, "comment_id": 79875383, "body": "its part of the homework lo"}], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 5402947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tjzKN.jpg?s=128&g=1", "display_name": "laudarch", "link": "https://stackoverflow.com/users/5402947/laudarch"}, "is_accepted": false, "score": 1, "last_activity_date": 1506551848, "creation_date": 1506551848, "answer_id": 46458261, "question_id": 46458224, "link": "https://stackoverflow.com/questions/46458224/using-extern-and-linking-files/46458261#46458261", "title": "Using extern and linking files", "body": "<p>You did not mention how you are compiling them, on unix like systems you can do</p>\n\n<p><code>$ gcc my.cpp use.cpp -o my</code></p>\n\n<p>to compile </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8643115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c3a17392d7135c771868848b4592da?s=128&d=identicon&r=PG&f=1", "display_name": "squarcia", "link": "https://stackoverflow.com/users/8643115/squarcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1506553150, "creation_date": 1506553150, "answer_id": 46458450, "question_id": 46458224, "link": "https://stackoverflow.com/questions/46458224/using-extern-and-linking-files/46458450#46458450", "title": "Using extern and linking files", "body": "<p>You must delete the main in</p>\n\n<blockquote>\n  <p>my.cpp</p>\n</blockquote>\n\n<p>You can't have two main.</p>\n"}], "owner": {"reputation": 169, "user_id": 8606156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/32ed1a7af959d4336bdc6107c1eb83a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pape Sow Traore", "link": "https://stackoverflow.com/users/8606156/pape-sow-traore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506553150, "creation_date": 1506551616, "last_edit_date": 1506551930, "question_id": 46458224, "link": "https://stackoverflow.com/questions/46458224/using-extern-and-linking-files", "title": "Using extern and linking files", "body": "<p>So I am supposed to link these 3 files but when I run use.cpp and it tells me there is a problem with print_foo and print so there must be a problem with my linking or declarations;(FYI I am using Xcode to compile)</p>\n\n<p>This is the header file</p>\n\n<pre><code>// my.h   (HEADER FILE)\nextern int foo;\nvoid print_foo();\nvoid print(int);\n</code></pre>\n\n<p>This is my.cpp </p>\n\n<pre><code>// my.cpp\n#include \"my.h\"\n#include \"std_lib_facilities_5.h\"\n\nvoid print_foo() {\n    cout &lt;&lt; foo;\n}\n\nvoid print(int i) {\n    cout &lt;&lt; i;\n\n}\n\nint main() {\n\n    return 0;\n}\n</code></pre>\n\n<p>And this is use.cpp</p>\n\n<pre><code>// use.cpp\n#include \"my.h\"   /* Declaration made available here */\n\nint foo;\n\nint main() {\n\n     foo = 7;\n     print_foo();\n     print(99);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "winapi"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1506551322, "post_id": 46458151, "comment_id": 79871883, "body": "The winapi used to be simple.  And then they had to add SFIBH to make it more complicated to make everybody happy.  Keep it simple."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1506551504, "post_id": 46458151, "comment_id": 79871935, "body": "of course much better direct use <code>SetFileInformationByHandle</code>. the <code>SetEndOfFile</code> first query file pointer and then call <code>ZwSetInformationFile</code> with <code>FileEndOfFileInformation</code> information. the <code>SetFileInformationByHandle</code> do the same, but use your information instead. for what do several calls to kernel instead single ?"}, {"owner": {"reputation": 4774, "user_id": 547065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca7b22b90c1506277b6f7ead24eb21c?s=128&d=identicon&r=PG", "display_name": "Vladislav Vaintroub", "link": "https://stackoverflow.com/users/547065/vladislav-vaintroub"}, "edited": false, "score": 0, "creation_date": 1506551506, "post_id": 46458151, "comment_id": 79871936, "body": "Well, Simple is good. However, fiddling with file pointer in general case needs some locks and resets for the file pointer. SFIBH can do without, so it  seems more attractive."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1506551905, "post_id": 46458151, "comment_id": 79872046, "body": "@RbMm: If it makes code easier to read, understand, and maintain, taking two trips to the kernel instead of one is more often than not worth it."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1506552006, "post_id": 46458151, "comment_id": 79872075, "body": "@IInspectable - why you think that use <code>SetFilePointerEx</code> followed by <code>SetEndOfFile</code> more easy than single call <code>SetFileInformationByHandle</code> ? and not 2 calls to kernel in first scenario but 3 or 4"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 3, "creation_date": 1506553939, "post_id": 46458151, "comment_id": 79872543, "body": "There is no difference in behaviour.  Use whichever one suits your particular scenario.  If you&#39;re accessing the same file from multiple threads, that&#39;s probably SetFileInformationByHandle."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1506553943, "post_id": 46458151, "comment_id": 79872544, "body": "also thin different - <code>SetEndOfFile</code> after call to <code>SetFileInformationByHandle</code> with <code>FileEndOfFileInfo</code> than call <code>SetFileInformationByHandle</code> with <code>FileAllocationInfo</code> - this force file system allocate additional memory for file or free it. actual code for <code>SetEndOfFile</code> - <a href=\"https://doxygen.reactos.org/da/d02/dll_2win32_2kernel32_2client_2file_2fileinfo_8c_source.html#l01133\" rel=\"nofollow noreferrer\">doxygen.reactos.org/da/d02/&hellip;</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 4, "creation_date": 1506559364, "post_id": 46458151, "comment_id": 79873761, "body": "@RbMm that is not official Microsoft source code. ReactOS is not Windows, it is a 3rd party open source OS that is compatible with Windows apps by emulating the Win32 API interfaces, but it can do whatever it wants internally"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1506560421, "post_id": 46458151, "comment_id": 79873964, "body": "@RemyLebeau - yes, I know. but I look asm code for <code>SetEndOfFile</code> too. and second call for <code>FileAllocationInformation</code> exist"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1506584873, "post_id": 46458151, "comment_id": 79882076, "body": "@RbMm: The issue here is, that the only optimization you know of is performance. Developers that work in teams usually optimize for readability first, and setting the current file pointer followed by marking it as the end of file is a natural way to express that intent. <code>SetFileInformationByHandle</code> is a powerful alternative. That power comes with much complexity. Compare its documentation to the documentation for <code>SetFilePointerEx</code>/<code>SetEndOfFile</code>, and you&#39;ll probably agree."}, {"owner": {"reputation": 4774, "user_id": 547065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca7b22b90c1506277b6f7ead24eb21c?s=128&d=identicon&r=PG", "display_name": "Vladislav Vaintroub", "link": "https://stackoverflow.com/users/547065/vladislav-vaintroub"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1506597712, "post_id": 46458151, "comment_id": 79890521, "body": "@IInspectable, the only real issue  here is documentation. <i>if</i> <code>SetFileInformationByHandle</code> was better documented, <i>and</i> it corresponded exactly to <code>SetFilePointerEx&#47;SetEndOfFile</code> do, I dont&#39;t see why one call where parameters clearly indicate  the intent is more complicated than moving file pointer to offset and &quot;set EOF here&quot;"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1506599032, "post_id": 46458151, "comment_id": 79891378, "body": "Even if the documentation were better, <code>SetFileInformationByHandle</code> is still a complex beast, with lots of overloads. As it stands, the documentation is as good as it is, and I was taking this into account when challenging the statement, that <code>SetFileInformationByHandle</code> were unconditionally much better. It may be better, for some use cases, in some teams, for some applications."}], "owner": {"reputation": 4774, "user_id": 547065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca7b22b90c1506277b6f7ead24eb21c?s=128&d=identicon&r=PG", "display_name": "Vladislav Vaintroub", "link": "https://stackoverflow.com/users/547065/vladislav-vaintroub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506552439, "creation_date": 1506551117, "last_edit_date": 1506552439, "question_id": 46458151, "link": "https://stackoverflow.com/questions/46458151/setendoffile-vs-setfileinformationbyhandle-to-extend-file", "title": "SetEndOfFile vs SetFileInformationByHandle to extend file", "body": "<p>I can set file size with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365542(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"SetFilePointerEx\">SetFilePointerEx</a> followed by <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365531(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"SetEndOfFile\">SetEndOfFile</a>.Or, I can do it with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365539(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"FileEndOfFileInfo\">SetFileInformationByHandle</a> with FileEndOfFileInfo. Is there any difference in behavior? SetFileInformationByHandle seems more straightforward, but has by far less google hits on some reason.</p>\n"}, {"tags": ["c++", "gcc", "vector", "struct", "types"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506557739, "post_id": 46458125, "comment_id": 79873436, "body": "In your case: <code>using IT = decltype(x.list.begin());</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8685981"}, "edited": false, "score": 0, "creation_date": 1506558047, "post_id": 46458420, "comment_id": 79873489, "body": "What&#39;s the reasoning behind having it be a reference type, instead of just a normal <code>long double</code>?"}], "tags": [], "owner": {"reputation": 1552, "user_id": 4142343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wB5v_3I2Ngc/AAAAAAAAAAI/AAAAAAAAAIg/CE6NNb98EPM/photo.jpg?sz=128", "display_name": "Mikhail Maltsev", "link": "https://stackoverflow.com/users/4142343/mikhail-maltsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1506552905, "creation_date": 1506552905, "answer_id": 46458420, "question_id": 46458125, "link": "https://stackoverflow.com/questions/46458125/type-of-vectors-elements-for-use-in-iterator-type/46458420#46458420", "title": "Type of Vector&#39;s Elements for Use in Iterator Type", "body": "<p>The type of <code>decltype(x.list[0])</code> is <code>long double&amp;</code>. <code>std::vector</code> cannot store references, hence you get an error. The second error (\"error: the value of 'x' is not usable in a constant expression.\") also seems pretty obvious: you need a type instead of a value. This should compile without errors:</p>\n\n<pre><code>#include &lt;vector&gt;\n\ntemplate&lt;typename T&gt;\nstruct s {\n    std::vector&lt;T&gt; list;\n};\n\nint main()\n{\n    s&lt;long double&gt; x;\n    typedef typename std::vector&lt;decltype(x.list)::value_type&gt;::iterator IT;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8685981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 46458420, "answer_count": 1, "score": 0, "last_activity_date": 1506552905, "creation_date": 1506550955, "question_id": 46458125, "link": "https://stackoverflow.com/questions/46458125/type-of-vectors-elements-for-use-in-iterator-type", "title": "Type of Vector&#39;s Elements for Use in Iterator Type", "body": "<p>If I have a struct <code>s</code>:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct s {\n    std::vector&lt;T&gt; list;\n};\n</code></pre>\n\n<p>Defined in <code>main()</code> as:</p>\n\n<pre><code>s&lt;long double&gt; x;\n</code></pre>\n\n<p>And I try to get the type of <code>list</code>'s iterator using:</p>\n\n<pre><code>typedef typename std::vector&lt;decltype(x.list[0])&gt;::iterator IT;\n</code></pre>\n\n<p>GCC 7.2.1 produces a bunch of errors, beginning with:</p>\n\n<pre><code>/usr/include/c++/7/bits/alloc_traits.h:392:27: error: forming pointer to reference type 'long double&amp;'\n    using pointer = _Tp*;\n                        ^\n</code></pre>\n\n<p>I doubt there is anything wrong with the underlying implementation of C++ in GCC, which this error seems to indicate.</p>\n\n<p>Using this method also assumes that <code>list</code> is not empty, so I instead tried using <code>::value_type</code> (as suggested on other SO answers):</p>\n\n<pre><code>typedef typename std::vector&lt;x.list::value_type&gt;::iterator IT;\n</code></pre>\n\n<p>GCC again produces errors:</p>\n\n<pre><code>error: the value of 'x' is not usable in a constant expression.\n    typedef typename std::vector&lt;x.list::value_type&gt;::iterator IT;\n                                   ^~~~\n</code></pre>\n\n<hr>\n\n<p>In order to find an alternative, I added a type-holding variable to the struct:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct s {\n    T typeholder;\n    std::vector&lt;T&gt; list;\n};\n</code></pre>\n\n<p>And this worked fine, using:</p>\n\n<pre><code>typedef typename std::vector&lt;decltype(x.typeholder)&gt;::iterator IT;\n</code></pre>\n\n<p>Where am I going wrong here? It seems convoluted to need to define an unused variable just to hold the type. Am I misusing <code>::value_type</code>?</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2015", "npm"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506608029, "post_id": 46458124, "comment_id": 79897770, "body": "Just typing &quot;vcbuild.exe&quot; in the Google query box is enough to find two existing questions at SO that describe this problem and its solution."}, {"owner": {"reputation": 790, "user_id": 4547188, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/e319d369e2fef493e84cba2aeb53e815?s=128&d=identicon&r=PG&f=1", "display_name": "grabbag", "link": "https://stackoverflow.com/users/4547188/grabbag"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506730195, "post_id": 46458124, "comment_id": 79951461, "body": "Not quite this simple.  Visual studio 2015 changed name of compiler and I can&#39;t switch to 2013 or earlier."}], "answers": [{"tags": [], "owner": {"reputation": 790, "user_id": 4547188, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/e319d369e2fef493e84cba2aeb53e815?s=128&d=identicon&r=PG&f=1", "display_name": "grabbag", "link": "https://stackoverflow.com/users/4547188/grabbag"}, "is_accepted": false, "score": 0, "last_activity_date": 1506730635, "creation_date": 1506730635, "answer_id": 46498343, "question_id": 46458124, "link": "https://stackoverflow.com/questions/46458124/visual-c-component-vcbuild-exe/46498343#46498343", "title": "Visual C++ component &quot;VCBuild.exe&quot;", "body": "<p>Microsoft provides an npm package that solves all these native build issues without the need to install visual studio.</p>\n\n<p>\"windows-build-tools\": \"^1.3.2\"</p>\n"}], "owner": {"reputation": 790, "user_id": 4547188, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/e319d369e2fef493e84cba2aeb53e815?s=128&d=identicon&r=PG&f=1", "display_name": "grabbag", "link": "https://stackoverflow.com/users/4547188/grabbag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1506730635, "creation_date": 1506550952, "last_edit_date": 1506605608, "question_id": 46458124, "link": "https://stackoverflow.com/questions/46458124/visual-c-component-vcbuild-exe", "title": "Visual C++ component &quot;VCBuild.exe&quot;", "body": "<p>I installed visual studio 2015 and able to compile and run c++ test application within the IDE.</p>\n\n<p>My npm installer is throwing the error</p>\n\n<pre><code>MSBUILD : error MSB3428: Could not load the Visual C++ component \"VCBuild.exe\".\n</code></pre>\n\n<p>When I install visual studio 2013, I don't get this error.  The libraries this npm project uses is based on visual studio 2015.</p>\n\n<p>Is there something extra I need to do after the Visual studio 2015 install that I don't need to do in visual studio 2013?</p>\n"}, {"tags": ["c++", "virtual"], "comments": [{"owner": {"reputation": 848, "user_id": 5941564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1916422a9c9c1aef25c1c3e886725781?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle A", "link": "https://stackoverflow.com/users/5941564/kyle-a"}, "edited": false, "score": 0, "creation_date": 1506550544, "post_id": 46457936, "comment_id": 79871605, "body": "Are the other functions using the same signature as the base class, or are others changing the parameter types as well? If the signatures change, then I don&#39;t see the benefit to having the virtual function declared in the base class. Also, by changing the signature, you are not overriding the base class&#39;s function. The warning you found was telling you that having both of those functions could lead to confusion about which is called."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1506554026, "post_id": 46457936, "comment_id": 79872560, "body": "Does anybody actually call <code>tTestModule::HandleCommand</code>?  If they do, since nothing seems to override it, the command will fail to be handled and the call might be removable.  Otherwise you can create overrides in the subclasses, perform the <code>dynamic_cast</code> in those, and call the superclass&#39;s <code>HandleCommand</code> if the dynamic cast succeeds."}], "answers": [{"tags": [], "owner": {"reputation": 2488, "user_id": 453436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8e7be51a9257fb1f08a7f01c9c29e3?s=128&d=identicon&r=PG", "display_name": "Bowie Owens", "link": "https://stackoverflow.com/users/453436/bowie-owens"}, "is_accepted": false, "score": 1, "last_activity_date": 1506553903, "creation_date": 1506553903, "answer_id": 46458574, "question_id": 46457936, "link": "https://stackoverflow.com/questions/46457936/subclassing-a-virtual-function-with-a-subclassed-type/46458574#46458574", "title": "Subclassing a virtual function with a subclassed type", "body": "<p>\"Is there another way to keep the virtual and ensure compile-time type correctness?\" The answer depends on how you utilise tCommand objects in the rest of your code. Lets say you have code similar to:</p>\n\n<pre><code>typedef std::vector&lt;std::shared_ptr&lt;tTestModule&gt;&gt; module_list;\n\nbool handle(tCommand&amp; c, module_list const&amp; m)\n{\n    bool fin = false;\n    for (auto i = m.begin(), e = m.end(); i != e &amp;&amp; !fin; ++i)\n        fin = (*i)-&gt;HandleCommand(c);\n\n    return fin;\n}\n</code></pre>\n\n<p>In this case you have a tCommand object of unknown final type that is passed to a variety of tTestModule objects also of unknown final type. In this case the answer is no. You cannot have runtime dispatch and compile time type safety with two unknown types.</p>\n\n<p>To get compile time safety you need to know at least one of the types involved as in the following:</p>\n\n<pre><code>template &lt;class C&gt;\nbool handle(C&amp; c, module_list const&amp; m)\n{\n    bool fin = false;\n    for (auto i = m.begin(), e = m.end(); i != e &amp;&amp; !fin; ++i)\n        fin = (*i)-&gt;HandleCommand(c);\n\n    return fin;\n}\n</code></pre>\n\n<p>But for type safety you actually need to overload HandleCommand() in tTestModule for every type derived from tCommand. If you could also know the types of the modules in m at compile time (ie using a std::tuple of modules by value instead of a vector of modules by reference), you would have type safety without the overloading headache.</p>\n"}], "owner": {"reputation": 6882, "user_id": 264822, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8d32aaf66676a77ad32a879a8e090887?s=128&d=identicon&r=PG", "display_name": "parsley72", "link": "https://stackoverflow.com/users/264822/parsley72"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506553903, "creation_date": 1506549919, "question_id": 46457936, "link": "https://stackoverflow.com/questions/46457936/subclassing-a-virtual-function-with-a-subclassed-type", "title": "Subclassing a virtual function with a subclassed type", "body": "<p>I turned on some compiler warnings (C4263 and C4264) and found this bug:</p>\n\n<pre><code>class tCommand\n{\n    ...\n};\n\nclass tTestModule\n{\npublic:\n    virtual bool HandleCommand(tCommand&amp;) { return false; }\n}\n\nclass tCommandADCReadings : public tCommand\n{\n    ...\n};\n\nclass tADCReadings : public tTestModule\n{\npublic:\n    tADCReadings();\n\n    bool HandleCommand(tCommandADCReadings&amp;);\n}\n\nbool tADCReadings::HandleCommand(tCommandADCReadings&amp; cmd)\n{\n    ...\n}\n</code></pre>\n\n<p>This shows a warning because the implementation of <code>tADCReadings::HandleCommand()</code> doesn't match <code>tTestModule::HandleCommand()</code>. So I fixed it like this:</p>\n\n<pre><code>class tADCReadings : public tTestModule\n{\npublic:\n    tADCReadings();\n\n    bool HandleCommand(tCommand&amp;) override;\n}\n\nbool tADCReadings::HandleCommand(tCommand&amp; cmd)\n{\n    tCommandADCReadings* pCmdADCReadings = dynamic_cast&lt;tCommandADCReadings*&gt;(&amp;cmd);\n}\n</code></pre>\n\n<p>But another team member says we should keep the type checking that using <code>tCommandADCReadings</code> in <code>tADCReadings::HandleCommand()</code> gives us, so just remove <code>tTestModule::HandleCommand()</code>. But this function is used in ~10 other subclasses as well so it seems a shame. Is there another way to keep the <code>virtual</code> and ensure compile-time type correctness?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 42750, "user_id": 189134, "user_type": "moderator", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jFsyb.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/189134/andy"}, "edited": false, "score": 0, "creation_date": 1506562758, "post_id": 46457804, "comment_id": 79874498, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/155467/discussion-on-question-by-vortico-construct-object-set-fields-and-return-objec\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "edited": false, "score": 0, "creation_date": 1506550643, "post_id": 46458066, "comment_id": 79871637, "body": "This is a good attempt, but unfortunately I require the parameters to be named, and unnamed parameters to be set to their defaults. Otherwise my constructor calls would look like the following, except 30 times more arguments. <code>MomentarySVGKnobWidget{Vec(0, 0), Vec(0, 0), 1.0, 0.0, 1.0, &quot;knob.svg&quot;, 0.0, 0.0, 2.0};</code>"}, {"owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "edited": false, "score": 0, "creation_date": 1506550701, "post_id": 46458066, "comment_id": 79871664, "body": "The construct-by-value method doesn&#39;t solve the problem either, since I <i>do</i> actually need them to be pointers, and it requires roughtly the same amount of code to fill them with values as my original code."}, {"owner": {"reputation": 9602, "user_id": 323547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f51bc514b2b5b32625104d8ba190028?s=128&d=identicon&r=PG", "display_name": "log0", "link": "https://stackoverflow.com/users/323547/log0"}, "reply_to_user": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "edited": false, "score": 0, "creation_date": 1506550985, "post_id": 46458066, "comment_id": 79871760, "body": "Ok I did not put foo on the heap for simplicity but this also applies when  you use pointers. regarding default values, just set them when you define the class. I will add an example."}, {"owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "edited": false, "score": 0, "creation_date": 1506551279, "post_id": 46458066, "comment_id": 79871863, "body": "This is essentially what I am already doing in the first code block of my question."}, {"owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "edited": false, "score": 0, "creation_date": 1506552932, "post_id": 46458066, "comment_id": 79872286, "body": "The Boost parameters looks the cleanest I&#39;ve seen so far, of course with the expensive of a lot of internal complexity."}], "tags": [], "owner": {"reputation": 9602, "user_id": 323547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f51bc514b2b5b32625104d8ba190028?s=128&d=identicon&r=PG", "display_name": "log0", "link": "https://stackoverflow.com/users/323547/log0"}, "is_accepted": false, "score": 0, "last_activity_date": 1506552835, "last_edit_date": 1506552835, "creation_date": 1506550547, "answer_id": 46458066, "question_id": 46457804, "link": "https://stackoverflow.com/questions/46457804/construct-object-set-fields-and-return-object-in-a-generic-way-in-c/46458066#46458066", "title": "Construct object, set fields, and return object in a generic way in C++", "body": "<p>C++11 brought uniform initialization to C++. i.e. you can do</p>\n\n<pre><code>Foo *foo = new Foo{\"Hello\", 4};\n</code></pre>\n\n<p>as suggested by user4581301. But this assumes you know the layout of Foo.</p>\n\n<p>You won't find the same kind of syntax as in C# because C++ does not support named parameters.\nYou can get something close (or even something close to named tuples) using some smart things see <a href=\"http://vitiy.info/named-tuple-for-cplusplus/\" rel=\"nofollow noreferrer\">http://vitiy.info/named-tuple-for-cplusplus/</a> or <a href=\"https://github.com/matt-42/iod\" rel=\"nofollow noreferrer\">IOD</a> or plenty of other attempts, but I find the syntax also often annoying, plus some, like IOD, requires that you predeclare named parameters names.</p>\n\n<p>--edit<br>\nI now remember that <a href=\"http://www.boost.org/doc/libs/1_62_0/libs/parameter/doc/html/index.html#parameter-enabled-constructors\" rel=\"nofollow noreferrer\">boost parameters</a> implements named parameters directly (using the same base concepts as in IOD). Although it requires quite a lot of boiler plate code:</p>\n\n<pre><code>myclass y(_index = 12, _name = \"sally\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1506555157, "post_id": 46458523, "comment_id": 79872830, "body": "That&#39;s not as bad as I thought it would look. Wandering way out of what I know here, but see if you can apply <a href=\"http://en.cppreference.com/w/cpp/language/parameter_pack\" rel=\"nofollow noreferrer\">varadic templates</a> to get rid of that number."}, {"owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1506555258, "post_id": 46458523, "comment_id": 79872853, "body": "I started doing that 2 minutes ago :) Will modify the second section"}], "tags": [], "owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "is_accepted": false, "score": 0, "last_activity_date": 1506563000, "last_edit_date": 1506563000, "creation_date": 1506553584, "answer_id": 46458523, "question_id": 46457804, "link": "https://stackoverflow.com/questions/46457804/construct-object-set-fields-and-return-object-in-a-generic-way-in-c/46458523#46458523", "title": "Construct object, set fields, and return object in a generic way in C++", "body": "<p>Here are my attempts so far. I've made this a public wiki, so improvements are welcome!</p>\n\n<h2>explicit macros</h2>\n\n<pre><code>#define construct0(_T, _N) _T *_N = new _T()\n#define construct1(_T, _N, _F1, _V1) construct0(_T, _N); _N._F1 = _V1\n#define construct2(_T, _N, _F1, _V1, _F2, _V2) construct1(_T, _N, _F1, _V1); _N._F2 = _V2\n#define construct3(_T, _N, _F1, _V1, _F2, _V2, _F3, _V3) construct2(_T, _N, _F1, _V1, _F2, _V2); _N._F3 = _V3\n#define construct4(_T, _N, _F1, _V1, _F2, _V2, _F3, _V3, _F4, _V4) construct3(_T, _N, _F1, _V1, _F2, _V2, _F3, _V3); _N._F4 = _V4\n\nconstruct3(Bar, bar, firstName, \"John\", lastName, \"Smith\", height, 5.6);\n// Expands to\nBar *bar = new Bar(); bar.firstName = \"John\"; bar.lastName = \"Smith\"; bar.height = 5.6;\n</code></pre>\n\n<p>Pros: Simple implementation.</p>\n\n<p>Cons: Doesn't return the instantiated value, so can't use <code>addChild(constructN(...))</code>, unless you use the GCC Statement Expr extension.\nReusing the same variable names within a scope results in a collision.\nOnly supports a bounded number of arguments.</p>\n\n<p>I don't think <code>__VA_ARGS__</code> can help here.</p>\n\n<h2>member pointer template</h2>\n\n<pre><code>template&lt;typename T&gt;\nT *construct() {\n    return new T();\n}\n\ntemplate&lt;typename T, typename F, typename V, typename... Args&gt;\nT *construct(F f, V v, Args... args) {\n    T *o = construct&lt;T&gt;(args...);\n    (o-&gt;*f) = v;\n    return o;\n}\n\nconstruct&lt;Bar&gt;(&amp;Bar::firstName, \"John\", &amp;Bar::lastName, \"Smith\", &amp;Bar::height, 5.6);\n</code></pre>\n\n<p>Pros: Returns value, doesn't clutter scope of caller.</p>\n\n<p>Cons: Requires repetitious <code>&amp;Bar::</code> before every field name.</p>\n\n<h2>member pointer template + explicit macros</h2>\n\n<p>To go further, since we know that identifiers cannot be used in as template parameters, we can let macros do that. We can also count arguments using the GCC ## trick.</p>\n\n<pre><code>#define CONSTRUCT_ARGS1(T, f, v) &amp;T::f, v\n#define CONSTRUCT_ARGS2(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS1(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS3(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS2(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS4(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS3(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS5(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS4(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS6(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS5(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS7(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS6(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS8(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS7(T, __VA_ARGS__)\n#define CONSTRUCT_ARGS9(T, f, v, ...) &amp;T::f, v, CONSTRUCT_ARGS8(T, __VA_ARGS__)\n#define ARG20(_1, _2, _3, _4, _5, _6, _7, _8, _9, _10, _11, _12, _13, _14, _15, _16, _17, _18_, _19, _arg, ...) _arg\n#define CONSTRUCT_COUNT(...) ARG20(__VA_ARGS__, 10, 9, 9, 8, 8, 7, 7, 6, 6, 5, 5, 4, 4, 3, 3, 2, 2, 1, 1)\n#define CONSTRUCT_JOIN(count, ...) CONSTRUCT_ARGS ## count(__VA_ARGS__)\n#define CONSTRUCT_MACRO(count, ...) CONSTRUCT_JOIN(count, __VA_ARGS__)\n#define CONSTRUCT_ARGS(T, ...) CONSTRUCT_MACRO(CONSTRUCT_COUNT(__VA_ARGS__), T, __VA_ARGS__)\n#define CONSTRUCT(T, ...) construct&lt;T&gt;(CONSTRUCT_ARGS(T, __VA_ARGS__))\n\n\nBar *bar = CONSTRUCT(Bar, x, 4, y, 6);\n</code></pre>\n\n<p>Pros: shortest yet</p>\n\n<p>Cons: Complicated implementation, only works up to N pairs of arguments.</p>\n"}], "owner": {"reputation": 2221, "user_id": 272642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6cd5090839b1021f85bd329e1ed09264?s=128&d=identicon&r=PG", "display_name": "Vortico", "link": "https://stackoverflow.com/users/272642/vortico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506563000, "creation_date": 1506549265, "last_edit_date": 1506550361, "question_id": 46457804, "link": "https://stackoverflow.com/questions/46457804/construct-object-set-fields-and-return-object-in-a-generic-way-in-c", "title": "Construct object, set fields, and return object in a generic way in C++", "body": "<p>I have the following pattern nearly a thousand times in my codebase.</p>\n\n<pre><code>Foo *foo = new Foo();\nfoo-&gt;greeting = \"Hello\";\nfoo-&gt;legs = 4;\n\nBar *bar = new Bar();\nbar-&gt;firstName = \"John\";\nbar-&gt;lastName = \"Smith\";\nbar-&gt;height = 5.6;\n</code></pre>\n\n<p>I would like to make this less verbose using a syntax like the following.</p>\n\n<pre><code>Foo *foo = construct&lt;Foo, greeting, legs&gt;(\"Hello\", 4);\nBar *bar = construct&lt;Bar, firstName, lastName, height&gt;(\"John\", \"Smith\", 5.6);\n</code></pre>\n\n<p>I would like to avoid using actual C++ constructors because writing <code>Foo(std::string greeting, int legs) : greeting(greeting), legs(legs) {}</code> for every class is lots of effort, is redundant, and is a mess when the class hierarchy is very tall and superclasses need to be called.\nI imagine this might be possible with a template function or a macro, but I can't figure it out. What's the closest that can be achieved?</p>\n\n<p>I should point out that C# has this unique feature build-in.</p>\n\n<pre><code>Foo *foo = new Foo{greeting = \"Hello\", legs = 4};\n</code></pre>\n\n<h2>Intention</h2>\n\n<p>Here is a small sample of my class hierarchy. In reality it contains 30 times more classes which many more fields and methods. I <em>do</em> use constructors, but I never use constructors with arguments, since it is expected that the caller construct it with default fields and set what they need after construction. Otherwise constructors would have 50+ arguments, and the caller would have to specify all the default values explicitly.</p>\n\n<pre><code>struct Widget {\n    Vec pos = Vec(0, 0);\n    Vec size = Vec(0, 0);\n    float zoom = 1.0;\n};\n\nstruct FramebufferWidget : Widget {\n    float padding = 0.0;\n    float oversampling = 1.0;\n};\n\nstruct SVGWidget : FramebufferWidget {\n    std::string filename;\n};\n\nstruct SVGKnobWidget : SVGWidget {\n    float value = 0.0;\n    float minValue = 0.0;\n    float maxValue = 1.0;\n};\n\nstruct MomentarySVGKnobWidget : SVGKnobWidget {\n    // No fields, just additional behavior in methods\n}\n\n...\n\naddChild(construct&lt;SVGKnobWidget, filename, maxValue&gt;(\"knob.svg\", 2.0))\n</code></pre>\n\n<p>Notice how that is much simpler and easier on the eyes than calling</p>\n\n<pre><code>addChild(SVGKnobWidget(Vec(0, 0), Vec(0, 0), 1.0, 0.0, 1.0, \"knob.svg\", 0.0, 0.0, 2.0));\n</code></pre>\n\n<p>I need to construct pointers because after construction, I immediately transfer ownership to the <code>addChild</code> function.</p>\n"}, {"tags": ["android", "c++", "makefile", "android-8.0-oreo"], "comments": [{"owner": {"reputation": 6821, "user_id": 1852164, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Nsqx5.png?s=128&g=1", "display_name": "GetSwifty", "link": "https://stackoverflow.com/users/1852164/getswifty"}, "edited": false, "score": 0, "creation_date": 1535051833, "post_id": 46457800, "comment_id": 90935287, "body": "Dealing with this in while trying to connect to a socket...are there any work arounds?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7463809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/edUDQ.png?s=128&g=1", "display_name": "mekostelecky", "link": "https://stackoverflow.com/users/7463809/mekostelecky"}, "edited": false, "score": 0, "creation_date": 1509634169, "post_id": 46841543, "comment_id": 81104926, "body": "Thanks for the reply! Looks like that is what is causing the issue."}, {"owner": {"reputation": 6821, "user_id": 1852164, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Nsqx5.png?s=128&g=1", "display_name": "GetSwifty", "link": "https://stackoverflow.com/users/1852164/getswifty"}, "reply_to_user": {"reputation": 23, "user_id": 7463809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/edUDQ.png?s=128&g=1", "display_name": "mekostelecky", "link": "https://stackoverflow.com/users/7463809/mekostelecky"}, "edited": false, "score": 1, "creation_date": 1535051279, "post_id": 46841543, "comment_id": 90935046, "body": "@mekostelecky did you find a fix/workaround for this?"}, {"owner": {"reputation": 373, "user_id": 9752602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dNxZO3c5rro/AAAAAAAAAAI/AAAAAAAAGgU/0tXLoVWHo-o/photo.jpg?sz=128", "display_name": "sneharc", "link": "https://stackoverflow.com/users/9752602/sneharc"}, "edited": false, "score": 0, "creation_date": 1576058844, "post_id": 46841543, "comment_id": 104772443, "body": "How to know which function is causing it and where to fix"}], "tags": [], "owner": {"reputation": 36, "user_id": 8804323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327c87d0e687d9f5a9776d900630f127?s=128&d=identicon&r=PG&f=1", "display_name": "Murphy Ma", "link": "https://stackoverflow.com/users/8804323/murphy-ma"}, "is_accepted": true, "score": 2, "last_activity_date": 1508466567, "creation_date": 1508466567, "answer_id": 46841543, "question_id": 46457800, "link": "https://stackoverflow.com/questions/46457800/android-oreo-8-0-native-c-crash-invalid-pthread-t-passed-to-libc/46841543#46841543", "title": "Android Oreo 8.0 Native C++ crash: invalid pthread_t passed to libc", "body": "<p>The problem is in <strong>__pthread_internal_find</strong> function.</p>\n\n<p>Before Android 8.0, if no thread can be found in the thread list, just a nullptr is returned. However, in Android 8.0, a fatal will be made.</p>\n\n<p>This is requiring more careful handling of the POSIX stuff anyway...</p>\n\n<p>See the last code block in <a href=\"https://github.com/aosp-mirror/platform_bionic/blob/master/libc/bionic/pthread_internal.cpp#L129\" rel=\"nofollow noreferrer\">pthread_internal.cpp</a> for reference.</p>\n"}], "owner": {"reputation": 23, "user_id": 7463809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/edUDQ.png?s=128&g=1", "display_name": "mekostelecky", "link": "https://stackoverflow.com/users/7463809/mekostelecky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3564, "favorite_count": 0, "accepted_answer_id": 46841543, "answer_count": 1, "score": 2, "last_activity_date": 1522131148, "creation_date": 1506549254, "question_id": 46457800, "link": "https://stackoverflow.com/questions/46457800/android-oreo-8-0-native-c-crash-invalid-pthread-t-passed-to-libc", "title": "Android Oreo 8.0 Native C++ crash: invalid pthread_t passed to libc", "body": "<p>I have an Android Application that uses Cmake to compile native code into my application, and it was working great on A Pixel device running Android 7.1. I decided to upgrade my Pixel device to Oreo 8.0 and now I cannot enter the native C++ code in my app. </p>\n\n<p>This is the logcat dump when it crashes:</p>\n\n<pre><code>A/DEBUG: *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***\nA/DEBUG: Build fingerprint: 'google/sailfish/sailfish:8.0.0/OPR3.170623.007/4286350:user/release-keys'\nA/DEBUG: Revision: '0'\nA/DEBUG: ABI: 'arm64'\nA/DEBUG: pid: 29454, tid: 30950, name: Thread-24  &gt;&gt;&gt; com.myapp.nativecppapp &lt;&lt;&lt;\nA/DEBUG: signal 6 (SIGABRT), code -6 (SI_TKILL), fault addr --------\nA/DEBUG: Abort message: 'invalid pthread_t 0x727d3004f0 passed to libc'\nA/DEBUG:     x0   0000000000000000  x1   00000000000078e6  x2   0000000000000006  x3   0000000000000008\nA/DEBUG:     x4   0000000000000000  x5   0000000000000000  x6   0000000000000000  x7   0000000000000030\nA/DEBUG:     x8   0000000000000083  x9   222b2e8c5b032e6a  x10  0000000000000000  x11  0000000000000001\nA/DEBUG:     x12  ffffffffffffffff  x13  0000000000000001  x14  0000000000000000  x15  000849a75d18b53a\nA/DEBUG:     x16  00000072a8aee2f8  x17  00000072a8a905d0  x18  00000072a70fef30  x19  000000000000730e\nA/DEBUG:     x20  00000000000078e6  x21  0000007286081ac0  x22  000000728609b998  x23  0000007286081a88\nA/DEBUG:     x24  0000007286081ac4  x25  000000727d3fcee0  x26  000000727d3fceb8  x27  00000000000001cc\nA/DEBUG:     x28  000000727fe6b000  x29  000000727d3fcc20  x30  00000072a8a44994\nA/DEBUG:     sp   000000727d3fcbe0  pc   00000072a8a905d8  pstate 0000000060000000\nA/DEBUG: backtrace:\nA/DEBUG:     #00 pc 00000000000695d8  /system/lib64/libc.so (tgkill+8)\nA/DEBUG:     #01 pc 000000000001d990  /system/lib64/libc.so (abort+88)\nA/DEBUG:     #02 pc 000000000002516c  /system/lib64/libc.so (__libc_fatal+116)\nA/DEBUG:     #03 pc 0000000000066470  /system/lib64/libc.so (_Z23__pthread_internal_findl+164)\nA/DEBUG:     #04 pc 0000000000065fa8  /system/lib64/libc.so (pthread_detach+16)\nA/DEBUG:     #05 pc 0000000000043528  /data/app/com.myapp.nativecppapp-SwBY2G1qycu-8Vec8QIe8w==/lib/arm64/libNativeLib.so\nA/DEBUG:     #06 pc 000000000002a6e4  /data/app/com.myapp.nativecppapp-SwBY2G1qycu-8Vec8QIe8w==/lib/arm64/libNativeLib.so\nA/DEBUG:     #07 pc 0000000000052430  /data/app/com.myapp.nativecppapp-SwBY2G1qycu-8Vec8QIe8w==/lib/arm64/libNativeLib.so\nA/DEBUG:     #08 pc 000000000005176c  /data/app/com.myapp.nativecppapp-SwBY2G1qycu-8Vec8QIe8w==/lib/arm64/libNativeLib.so\nA/DEBUG:     #09 pc 000000000004339c  /data/app/com.myapp.nativecppapp-SwBY2G1qycu-8Vec8QIe8w==/lib/arm64/libNativeLib.so\nA/DEBUG:     #10 pc 0000000000065f88  /system/lib64/libc.so (_ZL15__pthread_startPv+36)\nA/DEBUG:     #11 pc 000000000001ed24  /system/lib64/libc.so (__start_thread+68)\n</code></pre>\n\n<p>Here is the Cmake code that adds the shared library </p>\n\n<pre><code>add_library(NativeLib SHARED IMPORTED)\nset_property(TARGET NativeLib PROPERTY IMPORTED_LOCATION \"${PROJECT_SOURCE_DIR}/NativeLib/Android/Release/${ANDROID_ABI}/libNativeLib.so\")\n</code></pre>\n\n<p>The shared library then gets linked to the target. </p>\n\n<p>As I said, this was all running flawlessly on Android 7.1 and upgrading the device to 8.0 caused this crash, is this a new bug? I did read the \"Native Libraries\" changes for 8.0 here <a href=\"https://developer.android.com/about/versions/oreo/android-8.0-changes.html\" rel=\"nofollow noreferrer\">https://developer.android.com/about/versions/oreo/android-8.0-changes.html</a>. </p>\n\n<p>I also ran readelf on my library and got this back, which looks okay for 8.0:</p>\n\n<pre><code>LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x1b61c8 0x1b61c8 R E 0x10000\nLOAD           0x1b6750 0x00000000001c6750 0x00000000001c6750 0x015fc0 0x085260 RW  0x10000\nDYNAMIC        0x1c1010 0x00000000001d1010 0x00000000001d1010 0x0002c0 0x0002c0 RW  0x8\nGNU_EH_FRAME   0x1871a0 0x00000000001871a0 0x00000000001871a0 0x006bac 0x006bac R   0x4\nGNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x10\nGNU_RELRO      0x1b6750 0x00000000001c6750 0x00000000001c6750 0x00b8b0 0x00b8b0 R   0x1\n</code></pre>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["c++", "scanf"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1506548737, "post_id": 46457666, "comment_id": 79870982, "body": "<code>scanf</code> <code>%s</code> takes a <code>char *</code>, not a <code>std::string *</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1506548795, "post_id": 46457666, "comment_id": 79871014, "body": "<code>if (COND) { var = true; } else { var = false; }</code> better written as <code>var = COND;</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1506548861, "post_id": 46457666, "comment_id": 79871035, "body": "Never use <code>scanf</code> for user input. If you do use <code>scanf</code>, always check its return value."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1506548923, "post_id": 46457666, "comment_id": 79871055, "body": "<code>Persoenlichen</code> shouldn&#39;t be capitalized; it&#39;s an adjective. But <code>eingabe</code> should be because it&#39;s a noun."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1506548992, "post_id": 46457666, "comment_id": 79871083, "body": "Use cin and cout."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1506550117, "post_id": 46457666, "comment_id": 79871467, "body": "<i>Also i want to use scanf instead of std::cin to learn different methods of input.</i>  -- I want to learn to drive a car with the handbrake on instead of releasing it."}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 8268476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed8fd8e6cc7fd340d4397f9412ab788?s=128&d=identicon&r=PG&f=1", "display_name": "Dariel Rudt", "link": "https://stackoverflow.com/users/8268476/dariel-rudt"}, "is_accepted": false, "score": 0, "last_activity_date": 1506565890, "creation_date": 1506565890, "answer_id": 46460057, "question_id": 46457666, "link": "https://stackoverflow.com/questions/46457666/program-crashes-when-using-scanf-to-read-strings/46460057#46460057", "title": "Program crashes when using scanf to read strings", "body": "<p>The problem here is that you can't use <code>scanf</code> to read <code>std::string</code>. You will have to either convert your <code>std::string</code> to <code>char *</code>, or use <code>cin</code>. Another thing you could do, is to first read from scanf to a temporary <code>char *</code>, and then convert it to <code>std::string</code>, by doing something like:</p>\n\n<pre><code>scanf(\"%s\", &amp;someCharPointer);\nstd::string s = someCharPointer;\n</code></pre>\n\n<p>As a comment, there is nothing wrong with trying to learn how to use different things. Both <code>scanf</code> and <code>cin</code> have their own adventages and disadventages.</p>\n"}, {"tags": [], "owner": {"reputation": 2374, "user_id": 8491726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550562035006492/picture?type=large", "display_name": "Artemy Vysotsky", "link": "https://stackoverflow.com/users/8491726/artemy-vysotsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1506571394, "creation_date": 1506571394, "answer_id": 46460778, "question_id": 46457666, "link": "https://stackoverflow.com/questions/46457666/program-crashes-when-using-scanf-to-read-strings/46460778#46460778", "title": "Program crashes when using scanf to read strings", "body": "<p>To read string using scanf you actually have to have buffer big enough to read string.</p>\n\n<pre><code>char temp[100];\nstd::string vorname;\nif(scanf(\"%99s\", temp) ==1){\n    vorname = temp;\n}\n</code></pre>\n\n<p>With scanf you have to limit number of chars to read to match your temp buffer and check the return value before using buffer read. When reading from istream using getline or operator>> directly into std::string - your string variable will grow to match the user input</p>\n"}], "owner": {"reputation": 11, "user_id": 8685935, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4S2bs9O9Hvw/AAAAAAAAAAI/AAAAAAAAKzc/omZOvQH5lqo/photo.jpg?sz=128", "display_name": "Nick Dulabic", "link": "https://stackoverflow.com/users/8685935/nick-dulabic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1506571394, "creation_date": 1506548498, "last_edit_date": 1506549118, "question_id": 46457666, "link": "https://stackoverflow.com/questions/46457666/program-crashes-when-using-scanf-to-read-strings", "title": "Program crashes when using scanf to read strings", "body": "<p>My program always crashes after the 5th scanf in the class function.</p>\n\n<pre><code>class PersoenlicheDaten{\n    public:\n        void eingabe(){\n            printf(\"Bitte geben sie jetzt ihre Persoenlichen Daten ein: \\n\\n\");\n            printf(\"Vorname: \");\n            scanf(\"%s\", &amp;vorname);\n            printf(\"Nachname: \");\n            scanf(\"%s\", &amp;nachname);\n            printf(\"Alter: \");\n            scanf(\"%d\", &amp;alter);\n            printf(\"Geburtsdatum: \");\n            scanf(\"%s\", &amp;geburtsdatum);\n            printf(\"Addresse: \");\n            scanf(\"%s\", &amp;addresse);\n        }\n    private:\n        std::string vorname;\n        std::string nachname;\n        int alter;\n        std::string geburtsdatum;\n        std::string addresse;\n};\n</code></pre>\n\n<p>Inside <code>main</code>:</p>\n\n<pre><code>do{\n    pd.eingabe();\n    printf(\"Sind sie mit der eingabe zufrieden?\\n\\n\");\n    printf(\"Antwort(j/n): \");\n    scanf(\"%c\", &amp;v.antwiederholen);\n    if(v.antwiederholen == 'j'){\n        v.running = true;\n    }else{\n        v.running = false;\n    }\n}while(v.running);\n</code></pre>\n\n<p>Why is that because it should normally work. Also i want to use scanf instead of std::cin to learn different methods of input.</p>\n"}, {"tags": ["c++", "visual-c++", "dll"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506549215, "post_id": 46457647, "comment_id": 79871157, "body": "Getting a dependency on MFC in a console mode app is, cough, unusual.  First make sure you don&#39;t link it.  Then make sure that you know where your libraries came from.  Then use the linker&#39;s /VERBOSE option so you can double-check any assumptions."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 2, "creation_date": 1506549962, "post_id": 46457647, "comment_id": 79871404, "body": "Just statically link to MFC and you no longer need any DLL to run your program (apart from standard system DLLs ofc). You&#39;ll find this setting on the first page of your project configuration."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1506550076, "post_id": 46457647, "comment_id": 79871448, "body": "Strange close vote, this is by far not an opinion-based question."}, {"owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1506553269, "post_id": 46457647, "comment_id": 79872386, "body": "@zett42 , why don\u2019t you make that an aswer? i think this is correct."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "edited": false, "score": 0, "creation_date": 1506591290, "post_id": 46457647, "comment_id": 79886396, "body": "@Aganju I&#39;m sure this question is a duplicate but I didn&#39;t have time to search for a good one yet."}, {"owner": {"reputation": 970, "user_id": 1371217, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c52738ce7c2d66836cdf3dbf90a33c54?s=128&d=identicon&r=PG&f=1", "display_name": "Zoomzoom", "link": "https://stackoverflow.com/users/1371217/zoomzoom"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1506608705, "post_id": 46457647, "comment_id": 79898271, "body": "@zett42 You won&#39;t find the duplicate question. My reputation is only 467 but my google-fu is pretty good, trust me :)"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1506610538, "post_id": 46457647, "comment_id": 79899534, "body": "The <code>u</code> is typically a Unicode version (vs. wide character)."}, {"owner": {"reputation": 970, "user_id": 1371217, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c52738ce7c2d66836cdf3dbf90a33c54?s=128&d=identicon&r=PG&f=1", "display_name": "Zoomzoom", "link": "https://stackoverflow.com/users/1371217/zoomzoom"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1506611236, "post_id": 46457647, "comment_id": 79900004, "body": "@crashmstr is there some kind of encoding setting in a VC++ project that I can change to get rid of this dependency?"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1506611316, "post_id": 46457647, "comment_id": 79900058, "body": "@Zoomzoom don&#39;t use MFC? You still might need other C or C++ libraries either way."}], "owner": {"reputation": 970, "user_id": 1371217, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c52738ce7c2d66836cdf3dbf90a33c54?s=128&d=identicon&r=PG&f=1", "display_name": "Zoomzoom", "link": "https://stackoverflow.com/users/1371217/zoomzoom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506610404, "creation_date": 1506548397, "last_edit_date": 1506610404, "question_id": 46457647, "link": "https://stackoverflow.com/questions/46457647/how-to-make-a-console-application-created-with-visual-c-run-without-mfc140u-dl", "title": "How to make a console application created with Visual C++ run without mfc140u.dll?", "body": "<p>I have a console application created with Visual C++ (VS 2015), which builds an .exe executable file. It runs fine on my PC. However, when put on a PC that does not have VS installed, it throws this error:</p>\n\n<blockquote>\n  <p>The program can't start because mfc140u.dll is missing from your\n  computer. Try reinstalling the program to fix this problem.</p>\n</blockquote>\n\n<p>If I put the mfc140u.dll on that PC, next to the .exe file, then the executable works fine. However, I would like to avoid distributing this mfc140u.dll file if at all possible. I have not been able to figure out how to do so. My solution doesn't reference anything that remotely resembles \"mfc140u\".</p>\n\n<p>Update: I just learned that mfc140.dll is the MFC library introduced by VS 2015+. However, I'm still unsure what this mfc140u.dll (note the extra 'u' at the end) is about.</p>\n"}, {"tags": ["c++", "class", "polymorphism", "overloading", "virtual"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1506548253, "post_id": 46457539, "comment_id": 79870786, "body": "<code>void Derived::print(int value)</code> doesn&#39;t override <code>Base::print</code>."}, {"owner": {"reputation": 41, "user_id": 8685809, "user_type": "registered", "profile_image": "https://graph.facebook.com/1114037502024209/picture?type=large", "display_name": "Alexander Chun", "link": "https://stackoverflow.com/users/8685809/alexander-chun"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506548625, "post_id": 46457539, "comment_id": 79870929, "body": "@Jarod42 Why is that? Is it because I am missing <code>override</code>?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1506548966, "post_id": 46457539, "comment_id": 79871072, "body": "in <code>Base</code>: <code>void print()</code>. In <code>Derived</code>: <code>void print(int value)</code> different signatures. Slapping an <code>override</code> tag on it would help catch the error and totally be worth your time."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1506668188, "last_edit_date": 1506668188, "creation_date": 1506667495, "answer_id": 46483179, "question_id": 46457539, "link": "https://stackoverflow.com/questions/46457539/overloaded-function-in-derived-class-with-polymorphism-c/46483179#46483179", "title": "Overloaded function in derived class with Polymorphism (C++)", "body": "<p>In your code you have two different member functions, that have different signatures: </p>\n\n<ul>\n<li>a virtual <code>print()</code> that takes no argument.  It is declared and defined in <code>Base</code>, and inherited in <code>Derived</code></li>\n<li>a non-virtual <code>print()</code> that takes one <code>int</code> argument.  It is declared and defined ONLY for <code>Derived</code></li>\n</ul>\n\n<p>So the base object doesn't know a print function with an int parameter.  This is why you need to cast (which is by the way a symptom that should ring alarm bells if you need it). </p>\n\n<p><strong>How to improve ?</strong></p>\n\n<p>First, if you want to <strong>override</strong> a virtual function in a derived class, use the keyword <code>override</code>:  </p>\n\n<pre><code>class Derived : public Base\n{\npublic:\n    Derived():Base(){}\n    ~Derived(){}\n    void print(int value) override\n    {\n        ...\n    }\n};\n</code></pre>\n\n<p>This will ensure an error message in case of subtle mismatch in the function signature: </p>\n\n<pre><code>prog.cpp:23:10: error: \u2018void Derived::print(int)\u2019 marked \u2018override\u2019, but does not override\n     void print(int value) override\n          ^~~~~\n</code></pre>\n\n<p>Then make sure that the signatures are aligned in the base class and derived class (i.e. either both take an int argument or non of them.  </p>\n\n<p>Note that you can't access a <code>private</code> member of the base class in a derived class.  You have to define <code>number</code> as <code>protected</code> to print it in <code>Derived</code>.</p>\n\n<p>Finally, if you have a base class having a virtual member, it is a sound practice to systematically make the destructor virtual.  This will avoid subtle bugs for more complex classes: </p>\n\n<pre><code>class Base\n{\nprotected:\n    int number;   \npublic:\n    Base():number(10){}\n    virtual ~Base(){}\n    virtual void print(int value)\n    {\n        ...\n    }\n};\n</code></pre>\n\n<p>Here the <a href=\"https://ideone.com/lWf9TS\" rel=\"nofollow noreferrer\">online demo</a> </p>\n\n<p>Now that the things are working, here a short article making the <a href=\"http://www.geeksforgeeks.org/function-overloading-vs-function-overriding-in-cpp/\" rel=\"nofollow noreferrer\">difference between <strong>overload</strong> and <strong>override</strong></a>.</p>\n"}], "owner": {"reputation": 41, "user_id": 8685809, "user_type": "registered", "profile_image": "https://graph.facebook.com/1114037502024209/picture?type=large", "display_name": "Alexander Chun", "link": "https://stackoverflow.com/users/8685809/alexander-chun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506668188, "creation_date": 1506547918, "last_edit_date": 1506667742, "question_id": 46457539, "link": "https://stackoverflow.com/questions/46457539/overloaded-function-in-derived-class-with-polymorphism-c", "title": "Overloaded function in derived class with Polymorphism (C++)", "body": "<p>Considering this code example:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Base\n{\nprivate:\n    int number;\n\npublic:\n    Base():number(10){}\n    ~Base(){}\n    virtual void print()\n    {\n        cout &lt;&lt; \"Base class\" &lt;&lt; endl;\n    }\n};\n\nclass Derived : public Base\n{\npublic:\n    Derived():Base(){}\n    ~Derived(){}\n    void print(int value)\n    {\n        //printing number in Base class and paramter value\n        cout &lt;&lt; \"Derived with value \" &lt;&lt; value &lt;&lt; \" number is\" &lt;&lt; number &lt;&lt; endl; \n    }\n};\n</code></pre>\n\n<p>I wanted to use polymorphism and call theoverloaded  <code>print()</code> function.<br>\nSo use these classes as follows:  </p>\n\n<pre><code>void somewhere_else()\n{\n    Base* polymorphism = new Derived();\n    polymorphism-&gt;print(5); //Error indicating there are too many parameter\n                            //thinking that I am trying to use print in Base class\n    ((Derived*)polymorphism)-&gt;print(5) \n                       //This works as I am casting the variable as Derived variable\n}\n</code></pre>\n\n<p>Unfortunately, I can't call print() from the base class pointer (compilation error, see comment above).  I can only call it with a cast. \nIs there a better way to keep the polymorphism and still calls overloaded function based on derived class?</p>\n"}, {"tags": ["c++", "c++11", "memory-alignment", "alignof"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506547603, "post_id": 46457449, "comment_id": 79870537, "body": "For what architecture? What about for <code>char x[12]</code> or <code>int y[200]</code> or a <code>struct { int a; char b; float c; }</code>?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1506547649, "post_id": 46457449, "comment_id": 79870557, "body": "@tadman - for any architecture really. I&#39;m asking what the standard guarantees or implies. Clearly in those two examples <code>sizeof</code> (12 and I*200, respectively) is larger than alignof (1 and I respectively), where I is sizeof(I)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506547769, "post_id": 46457449, "comment_id": 79870606, "body": "There&#39;s no guarantee these will be the same. Older x86 processors didn&#39;t care where you put values. Newer ones are much more fussy. There&#39;s a <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">lot of history here</a>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1506547826, "post_id": 46457449, "comment_id": 79870622, "body": "@tadman - this isn&#39;t a question about x86 processors. When you say &quot;these will be the same&quot;, what are &quot;these&quot;?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506547859, "post_id": 46457449, "comment_id": 79870637, "body": "That <code>sizeof(T) == alignof(T)</code> for any given combination of T and architecture. The alignment value might be larger or smaller, it&#39;s impossible to say with any certainty. If you have a smaller list of types and one architecture you can run tests to find out."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1506547882, "post_id": 46457449, "comment_id": 79870649, "body": "Well, if you start with an assumption such as &quot;<code>float</code> is 4 bytes, <code>sizeof( float )</code> returns 4, but the system architecture requires that a <code>float</code> be on an 8-byte boundary&quot;, where does that lead?  Offhand, I think that means an array of <code>float</code> would be broken."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1506547971, "post_id": 46457449, "comment_id": 79870679, "body": "@tadman Of course is it not the case that <code>sizeof(T) == alignof(T)</code> in general. It is trivial to show that for example <code>struct S { char a,b; };</code> usually has size 2 and alignof 1. My question is about <code>&gt;=</code> not <code>==</code> though..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506548112, "post_id": 46457449, "comment_id": 79870737, "body": "In <a href=\"https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models\" rel=\"nofollow noreferrer\">the LP64 data model</a> <code>sizeof(long double)==8</code> while <code>alignof(long double)==16</code> depending on your compiler and OS combination. Likewise, <code>sizeof(long long)==8</code> while <code>alignof(long long)==4</code>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1506548249, "post_id": 46457449, "comment_id": 79870785, "body": "@tadman - do you have a concrete example? It seems like it would be impossible to properly even allocate an array of <code>long double</code> since in particular something like <code>malloc(N * sizeof(long double))</code> would allocate insufficient memory, and array indexing with <code>sizeof()</code> would also be broken."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506548449, "post_id": 46457449, "comment_id": 79870866, "body": "You&#39;ll have to do some testing here and find out, as you&#39;re getting into some gritty details. I&#39;m not sure if GCC aligns that way out of preference or as a hard requirement."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1506548624, "post_id": 46457449, "comment_id": 79870928, "body": "@tadman <i>In the LP64 data model <code>sizeof(long double)==8</code></i>  Not on my Centos 6 machine.  <code>sizeof( long double == alignof( long double ) == 16</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1506549610, "post_id": 46457449, "comment_id": 79871281, "body": "@AndrewHenle <code>gcc</code> or <code>clang</code>? To do a deeper investigation here a test script would be useful."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506549735, "post_id": 46457449, "comment_id": 79871323, "body": "@tadman <code>gcc version 4.4.7 20120313 (Red Hat 4.4.7-18)  (GCC)</code>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506549923, "post_id": 46457449, "comment_id": 79871390, "body": "You of course can&#39;t get a warranty.  But any processor designer that designed one where an array of T needed to intentionally leave extra space between the array elements did not hold on to his job for very long unless his first name was Seymour."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1506550038, "post_id": 46457449, "comment_id": 79871439, "body": "@HansPassant But suppose that such a designer existed, or for some other reason the alignment requirement was greater than the amount of data (eg, you want cache-aligned or page-aligned variables). Would the compiler increase <code>sizeof(T)</code> to match <code>alignof(T)</code>?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506550108, "post_id": 46457449, "comment_id": 79871463, "body": "Find the guy first.  Call him Bob."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506550200, "post_id": 46457449, "comment_id": 79871491, "body": "@HansPassant Suppose I go back in time and prevent anybody from hiring any of these Bobs. That still leaves non-processor reasons for over-aligned types."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506550405, "post_id": 46457449, "comment_id": 79871555, "body": "@hans - even in the world of really weird designs, I don&#39;t see how padding could be allowed by the standard. Isn&#39;t it required, for example that <code>sizeof(T[10]) == 10 * sizeof(T)</code>? That would seem to preclude padding. If it&#39;s not guaranteed, then we have a problem since almost any non-trivial C++ program would seem to assume this somewhere."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506550523, "post_id": 46457449, "comment_id": 79871599, "body": "@BeeOnRope As far as I\u2019ve been able to determine, arrays can be larger than (number of elements) * <code>sizeof(T)</code>, but no compiler does that and all the extra padding has to go at the end or subscripting won\u2019t work. That still means arrays of types with alignment greater than size would be problematic."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1506550613, "post_id": 46457449, "comment_id": 79871627, "body": "... so while at the hardware level you might have weird stuff like 10 byte values that need to be 16-byte aligned, from the C++ point of view I think this must simply have sizeof 16. That&#39;s why I was asking @tadman for an example of a platform where sizeof(long double) is less than alignof(long double) - since it seems impossible for this to be a compliant implementation!"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506550793, "post_id": 46457449, "comment_id": 79871694, "body": "@daniel that would break all sorts of common idioms like <code>sizeof(a)&#47;sizeof(a[0])</code> to calculate array sizes, as well as any use of <code>malloc()</code> or <code>operator new</code> to allocate arrays. It probably deserves a separate question though."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506550919, "post_id": 46457449, "comment_id": 79871735, "body": "It\u2019s already the case that <code>operator new[]</code> can allocate more memory than that, to allow for some bookkeeping. Since all the unread padding bytes would be at the end, <code>malloc</code>ing something smaller would be fine. I agree that the first would break, which is probably part of why nobody has built a compiler that way (the rest of the reason being that there would be little if any point)."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506551967, "post_id": 46457449, "comment_id": 79872064, "body": "@daniel, sure but I&#39;m not talking about invisible implementation details such as how many extra bytes memory allocation routines allocate under the cover. It&#39;s obvious there is going to be overhead, but it&#39;s invisible to the programmer. What I&#39;m asking is whether <code>sizeof(T[10])</code> can ever be unequal to <code>10 * sizeof(T)</code>. That&#39;s the programmer visible size of an array and it&#39;s the crux of the argument in the top answer below."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1506552633, "post_id": 46457449, "comment_id": 79872215, "body": "I asked about the array size question <a href=\"https://stackoverflow.com/questions/46458363/is-it-guaranteed-that-sizeoftn-n-sizeoft\">over here</a>.."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1506701411, "post_id": 46457449, "comment_id": 79940211, "body": "Please consider incorporating some of the clarifications and responses provided in the comments into the question proper."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1506706406, "post_id": 46457449, "comment_id": 79942620, "body": "@cody - I think the question is clear as it stands. The comments are mostly just discussions about possible answers, or in the case of of the first comment, something I consider obvious from the question and tags."}], "answers": [{"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1506549259, "post_id": 46457636, "comment_id": 79871168, "body": "I&#39;m not sure there are any cases where this argument doesn&#39;t apply. Maybe an object type you can&#39;t make instances of at all, or a type so huge you can&#39;t fit two of them in the same address space?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1506550937, "post_id": 46457636, "comment_id": 79871743, "body": "Well Hans in the comments on the question seems to imply that it is allowed that <code>sizeof(Foo[2]) &gt; 2*sizeof(Foo)</code> which would break your argument. I don&#39;t know if I believe it though."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1506576028, "post_id": 46457636, "comment_id": 79877683, "body": "@user2357112 You can&#39;t declare an array of an abstract class, or even a single instance. So its <code>sizeof</code> is not very useful."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1506579010, "post_id": 46457636, "comment_id": 79878906, "body": "@curiousguy: Well, you can have an instance of an abstract class as a base class subobject of an instance of a concrete subclass. I don&#39;t think there&#39;s any way to get an array of them, though, so that seems to be an example where the array argument fails even without compiler extensions."}, {"owner": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "edited": false, "score": 0, "creation_date": 1506587667, "post_id": 46457636, "comment_id": 79883854, "body": "&quot;I don&#39;t know whether that&#39;s strictly conformant behavior&quot; - it&#39;s not. Zalman&#39;s example uses a type attribute, <code>__attribute__ ((aligned (64)))</code>. Type attributes are a <a href=\"https://gcc.gnu.org/onlinedocs/gcc-7.2.0/gcc/Common-Type-Attributes.html\" rel=\"nofollow noreferrer\">GCC extension</a>, and not part of the C or C++ standards. I edited to clarify - hope that&#39;s ok."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "edited": false, "score": 0, "creation_date": 1506621729, "post_id": 46457636, "comment_id": 79906225, "body": "@sleske: I should have phrased that differently: there are restrictions on what kinds of extensions a conforming implementation is allowed to have, and I&#39;m not sure this extension&#39;s behavior is within the restrictions. I think it&#39;s allowed, but I&#39;m not sure."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 33, "last_activity_date": 1507776918, "last_edit_date": 1507776918, "creation_date": 1506548354, "answer_id": 46457636, "question_id": 46457449, "link": "https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-object-types-t/46457636#46457636", "title": "Is it always the case that sizeof(T) &gt;= alignof(T) for all object types T?", "body": "<p>At least in standard C++, for anything you can make an array of (with length > 1), this will have to be true. If you have</p>\n\n<pre><code>Foo arr[2];\n</code></pre>\n\n<p>and <code>alignof(Foo) &gt; sizeof(Foo)</code>, then <code>arr[0]</code> and <code>arr[1]</code> can't both be aligned.</p>\n\n<p>As <a href=\"https://stackoverflow.com/a/46457954\">Zalman Stern's example</a> shows, though, at least some compilers will allow you to declare a type with alignment greater than its size, with the result that the compiler simply won't let you declare an array of that type. This is not standards-compliant C++ (it uses type attributes, which <a href=\"https://gcc.gnu.org/onlinedocs/gcc-7.2.0/gcc/Common-Type-Attributes.html\" rel=\"noreferrer\">are a GCC extension</a>), but it means that you can have <code>alignof(T) &gt; sizeof(T)</code> in practice.</p>\n\n<p>The array argument assumes <code>sizeof(Foo) &gt; 0</code>, which is true for any type supported by the standard, but <a href=\"https://stackoverflow.com/a/46460970\">o11c shows</a> an example where compiler extensions break that guarantee: some compilers allow 0-length arrays, with 0 <code>sizeof</code> and positive <code>alignof</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1506550216, "post_id": 46457954, "comment_id": 79871495, "body": "Try <code>foo arr[2]; std::cout &lt;&lt; sizeof( arr ) &lt;&lt; &quot;\\n&quot;;</code>"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1506550354, "post_id": 46457954, "comment_id": 79871535, "body": "<a href=\"https://ideone.com/hKCQKy\" rel=\"nofollow noreferrer\"><code>error: alignment of array elements is greater than element size</code></a>, so you just can&#39;t make an array of these. I wonder if that&#39;s strictly conformant behavior."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 1, "creation_date": 1506550377, "post_id": 46457954, "comment_id": 79871547, "body": "Updated to include use of the attribute version on an actual decl, which indeed does collapse. Points stands however that you can make types that violate the constraint, which might be important to know if one were depending on this in e.g. metaprogramming."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1506551017, "post_id": 46457954, "comment_id": 79871778, "body": "<a href=\"https://ideone.com/QBPJAo\" rel=\"nofollow noreferrer\">If you declare an object of type <code>foo</code>, it keeps the 64-byte <code>alignof</code>.</a> It&#39;s interesting how the <code>aligned</code> attribute interacts differently with <code>alignof</code> if you attach it to a typedef and use the typedef compared to if you attach it to a variable declaration directly."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 2, "creation_date": 1506551375, "post_id": 46457954, "comment_id": 79871896, "body": "Is <code>__attribute__ ((aligned))</code> standard C++? Can you do the same trick with <code>alignof</code>?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1506553244, "post_id": 46457954, "comment_id": 79872379, "body": "no, wait, it looks like <code>baz</code> also has 64-byte <code>alignof</code>, but <code>decltype</code> interacts weirdly and removes the attribute, changing the alignment."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1506553433, "post_id": 46457954, "comment_id": 79872424, "body": "<code>__attribute__</code> is a GCC extension. I haven&#39;t found a way to get the same results with <code>alignof</code>; I can create an object with <code>alignof(obj) &gt; sizeof(obj)</code>, but not a type."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1506583050, "post_id": 46457954, "comment_id": 79880970, "body": "Yeah @user2357112 - it seems the use of <code>__attribute__ ((aligned))</code> allows you to use <code>typedef</code> to create a weird kind of half-type, like <code>foo</code>. A <code>typedef</code> should normally be a pure alias with the same characteristics as the aliased type, but here it&#39;s the aliased type + additional alignment information, so it&#39;s something like a new type. However, it <i>isn&#39;t</i> a new type in the C++ type system (e.g,. you can&#39;t overload a function taking a <code>double</code> with one taking a <code>foo</code>), and name mangling will result in <code>double</code> being used and there are various other ways to &quot;lose&quot; the alignment..."}], "tags": [], "owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "is_accepted": false, "score": 13, "last_activity_date": 1506550276, "last_edit_date": 1506550276, "creation_date": 1506550045, "answer_id": 46457954, "question_id": 46457449, "link": "https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-object-types-t/46457954#46457954", "title": "Is it always the case that sizeof(T) &gt;= alignof(T) for all object types T?", "body": "<pre><code>#include &lt;iostream&gt;\n\ntypedef double foo __attribute__ ((aligned (64)));\nalignas(64) double bar;\ndouble baz __attribute__ ((aligned (64)));\n\nint main(int argc, char *argv[]) {\n    std::cout &lt;&lt; \"foo sizeof: \" &lt;&lt; sizeof(foo) &lt;&lt; \" alignof: \" &lt;&lt; alignof(foo) &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"bar sizeof: \" &lt;&lt; sizeof(bar) &lt;&lt; \" alignof: \" &lt;&lt; alignof(decltype(bar)) &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"baz sizeof: \" &lt;&lt; sizeof(baz) &lt;&lt; \" alignof: \" &lt;&lt; alignof(decltype(baz)) &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Compile with:</p>\n\n<pre><code>clang++ -std=c++11 alignof_test.cpp -o alignof_test &amp;&amp; ./alignof_test\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>foo sizeof: 8 alignof: 64\nbar sizeof: 8 alignof: 8\nbaz sizeof: 8 alignof: 8\n</code></pre>\n\n<p>So strictly speaking, no, but the above argument re: arrays has to be preserved.</p>\n"}, {"comments": [{"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1506551250, "post_id": 46458123, "comment_id": 79871848, "body": "Yes, but note that <code>aligned_uinit32_t</code> is not a type, despite the way you&#39;ve named it. It&#39;s declaring a stack variable with different alignment. I know that in such a case the alignment is what you asked for and sizeof doesn&#39;t change. The question is whether you can make a type with this behavior wherever it is used."}, {"owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1506551540, "post_id": 46458123, "comment_id": 79871951, "body": "@BeeOnRope, you are right, I accidentally posted intermediate code. I have adjusted my answer to show that a type can be declared in such a way."}], "tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": false, "score": 8, "last_activity_date": 1506551800, "last_edit_date": 1506551800, "creation_date": 1506550950, "answer_id": 46458123, "question_id": 46457449, "link": "https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-object-types-t/46458123#46458123", "title": "Is it always the case that sizeof(T) &gt;= alignof(T) for all object types T?", "body": "<p>According to the <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf\" rel=\"noreferrer\">c++ 11 standard</a> that introduced the <code>alignof</code> operator, <code>sizeof</code> is defined as following (see 5.3.3 expr.sizeof):</p>\n\n<blockquote>\n  <p>The sizeof operator yields the number of bytes in the object representation of its operand</p>\n</blockquote>\n\n<p>Whereas <code>alignof</code> definition is (see 5.3.6 expr.alignof):</p>\n\n<blockquote>\n  <p>An alignof expression yields the alignment requirement of its operand type.</p>\n</blockquote>\n\n<p>Since the defintion of <code>alignof</code> specifies a requirement, possibly made by the user, rather than a specification of the language, we can manipulate the compiler:</p>\n\n<pre><code>typedef uint32_t __attribute__ ((aligned (64))) aligned_uint32_t;\nstd::cout &lt;&lt; sizeof(aligned_uint32_t) &lt;&lt; \" -&gt; \" &lt;&lt; alignof(aligned_uint32_t);\n// Output: 4 -&gt; 64\n</code></pre>\n\n<p><strong>Edited</strong></p>\n\n<p>As others have pointed out, such types cannot be used in arrays, e.g trying to compile the following:</p>\n\n<pre><code>aligned_uint32_t arr[2];\n</code></pre>\n\n<p>Results in <code>error: alignment of array elements is greater than element size</code></p>\n\n<p>Since arrays require the specified type to conform with the condition: <code>sizeof(T) &gt;= alignof(T)</code></p>\n"}, {"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1506574034, "post_id": 46460970, "comment_id": 79877124, "body": "Oh yeah, 0-length arrays are a thing on some compilers. Having types of size 0 screws with a lot of things."}], "tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": false, "score": 7, "last_activity_date": 1506572770, "creation_date": 1506572770, "answer_id": 46460970, "question_id": 46457449, "link": "https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-object-types-t/46460970#46460970", "title": "Is it always the case that sizeof(T) &gt;= alignof(T) for all object types T?", "body": "<p>Many compilers allow arrays of size <code>0</code>. The alignment remains the same as the alignment of the sole element.</p>\n\n<p>(Among other things, this is useful for forcing a particular alignment in cases when you can't use a bitfield)</p>\n"}], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2924, "favorite_count": 10, "accepted_answer_id": 46457636, "answer_count": 4, "score": 43, "last_activity_date": 1507776918, "creation_date": 1506547407, "last_edit_date": 1506621335, "question_id": 46457449, "link": "https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-object-types-t", "title": "Is it always the case that sizeof(T) &gt;= alignof(T) for all object types T?", "body": "<p>For any object type <code>T</code> is it always the case that <code>sizeof(T)</code> is at least as large as <code>alignof(T)</code>?</p>\n\n<p>Intuitively it seems so, since even when you adjust the alignment of objects like: </p>\n\n<pre><code>struct small {\n  char c;\n};\n</code></pre>\n\n<p>above what it would normally be, their \"size\" is also adjusted upwards so that the relationship between objects in an array makes sense while maintaining alignment (at least in my <a href=\"http://coliru.stacked-crooked.com/a/d27a419d81c12f2d\" rel=\"noreferrer\">testing</a>. For example:</p>\n\n<pre><code>struct alignas(16) small16 {\n  char c;\n};\n</code></pre>\n\n<p>Has both a size and alignment of 16.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 3, "creation_date": 1506547316, "post_id": 46457422, "comment_id": 79870426, "body": "what should <code>zz</code> do? should <code>aaa</code> produce <code>ab</code> or <code>ba</code>?"}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 0, "creation_date": 1506547500, "post_id": 46457422, "comment_id": 79870504, "body": "I noticed that you sort the string to start, that means that even if I gave you the string <code>abab</code> you are going to process it and modify it as if it was the string <code>aabb</code>, is that really what you intend?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1506547616, "post_id": 46457422, "comment_id": 79870542, "body": "The quick answer is you setup a while(1) loop around the whole thing. Have a boolean that tracks if a change is made (anytime a substitution occurs, set it to true, reset to false at beginning of loop).  If you get to the end and that bool is still false (unchanged), break out."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1506547660, "post_id": 46457422, "comment_id": 79870563, "body": "That big <code>if</code> /<code>else if</code> ghetto could be replaced with a 26 element array. If you want to assume a character set with contiguous letters, you can replace it all with a bit of math (and maybe a single if)."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1506547780, "post_id": 46457422, "comment_id": 79870614, "body": "BTW, setting the second character to 0 will NUL terminate your string.  Don&#39;t think that is what you want either.  You may need a memmove()"}, {"owner": {"reputation": 2308, "user_id": 5883832, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Emekr.jpg?s=128&g=1", "display_name": "PhotometricStereo", "link": "https://stackoverflow.com/users/5883832/photometricstereo"}, "edited": false, "score": 0, "creation_date": 1506547958, "post_id": 46457422, "comment_id": 79870673, "body": "What does <code>loopCount</code> do?"}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 0, "creation_date": 1506548149, "post_id": 46457422, "comment_id": 79870746, "body": "You should probably also change your for loop to condition from <code>i &lt; loc.length()</code> to <code>i &lt; loc.length() - 1</code>. The string class treats <code>[]</code> in a special way when you reference a position that is equal to the length and returns you the null terminator and so this piece of code works without throwing an exception <code>if(loc[i] == loc[i+1])</code>.  If you were working with a vector or something else, you would have a range error."}, {"owner": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1506551179, "post_id": 46457422, "comment_id": 79871828, "body": "@CoryKramer z is an exception. zz = zz."}, {"owner": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "reply_to_user": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 0, "creation_date": 1506551225, "post_id": 46457422, "comment_id": 79871840, "body": "@pstrjds Yes I do intend to sort it."}, {"owner": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1506551383, "post_id": 46457422, "comment_id": 79871899, "body": "@MichaelDorgan I will try that. I believe photometricstereo put that as the answer as well."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "edited": false, "score": 0, "creation_date": 1506554805, "post_id": 46457502, "comment_id": 79872743, "body": "I&#39;m sure this would work but the only problem is that my program doesn&#39;t send the new letters to a new string array. so for example in string  test = bbb after it goes through my code I end up with test[0]= c test[1] = 0 and test[2] = b.  is there a way I can write it so that instead of just replacing that character with a 0 it will completely erase the character so the index numbers rearrange? @PhotometricStereo"}, {"owner": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "edited": false, "score": 0, "creation_date": 1506557408, "post_id": 46457502, "comment_id": 79873356, "body": "I changed my code so that instead of <code>loc[i+1] = 0</code> It did <code>loc.erase(i+1, 1)</code> Then I added the while loop that you suggested and it worked perfectly! While not needed now I have to think about how to fix the if/if else ghetto that a user pointed out above. Thank you for your help!"}, {"owner": {"reputation": 2308, "user_id": 5883832, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Emekr.jpg?s=128&g=1", "display_name": "PhotometricStereo", "link": "https://stackoverflow.com/users/5883832/photometricstereo"}, "reply_to_user": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "edited": false, "score": 0, "creation_date": 1506561394, "post_id": 46457502, "comment_id": 79874185, "body": "I encourage you to debug this yourself, however you can open the wandbox link to see how I did it."}], "tags": [], "owner": {"reputation": 2308, "user_id": 5883832, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Emekr.jpg?s=128&g=1", "display_name": "PhotometricStereo", "link": "https://stackoverflow.com/users/5883832/photometricstereo"}, "is_accepted": true, "score": 0, "last_activity_date": 1506561358, "last_edit_date": 1506561358, "creation_date": 1506547716, "answer_id": 46457502, "question_id": 46457422, "link": "https://stackoverflow.com/questions/46457422/how-to-get-the-string-to-be-run-through-the-loop-a-second-time-with-the-adjusted/46457502#46457502", "title": "How to get the string to be run through the loop a second time with the adjusted string index?", "body": "<p>You can have a nested loop with a variable checking if something has been changed in the last loop iteration. For example, your code would look similar to this:</p>\n\n<pre><code>// Pseudocode\nbool changed = true; // This will keep track if previous loop has changed any values\nwhile (changed) {\n    changed = false; // Set to false at beginning of loop\n    for (size_t i = 0; i &lt; stringLength; ++i) {\n        if (/*two same characters in a row*/) {\n            // Change character to the next one in the alphabet\n            changed = true; // This will indicate the outer loop to run again\n        }\n    }\n}\n</code></pre>\n\n<p>This way, the program will only stop if all of the concurring characters have been changed.</p>\n\n<p>There are a few other issues in your code such as indexing errors, here is an example how I implemented your functionality: <a href=\"https://wandbox.org/permlink/n0hk8SOpNEo6iZV7\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/n0hk8SOpNEo6iZV7</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7718155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc67c9d69f3a693908dcd4b3f1b07378?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramos", "link": "https://stackoverflow.com/users/7718155/jose-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 46457502, "answer_count": 1, "score": 0, "last_activity_date": 1506561358, "creation_date": 1506547264, "question_id": 46457422, "link": "https://stackoverflow.com/questions/46457422/how-to-get-the-string-to-be-run-through-the-loop-a-second-time-with-the-adjusted", "title": "How to get the string to be run through the loop a second time with the adjusted string index?", "body": "<p>Trying to write code that will take an input string and \"abbreviate\" it. for example if aabb is given then the output should be bc. Basically if there's any double letters it goes up to the next letter in the alphabet so aa = b and so on. This works fine for the first run through but it won't loop through until completion. if the given string is aaaa the output should be c but instead the code outputs bb. how can I adjust my code to run the string an appropriate amount of times?</p>\n\n<pre><code>string abbreviate (string loc){\n\nint loopCount;\nsort(loc.begin(), loc.end());\n\nfor ( unsigned int i = 0; i &lt; loc.length() ; i++){\n\n\n    if(loc[i] == loc[i+1]) {\n        if(loc[i] == 'a'){\n            loc[i] = 'b';\n            loc[i+1] = 0;\n\n        }else if(loc[i] == 'b'){\n            loc[i] ='c';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'c'){\n            loc[i] ='d';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'd'){\n            loc[i] = 'e';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'e'){\n            loc[i] ='f';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'f'){\n            loc[i] ='g';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'g'){\n            loc[i] ='h';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'h'){\n            loc[i] ='i';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'i'){\n            loc[i] ='j';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'j'){\n            loc[i] ='k';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'k'){\n            loc[i] ='l';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'l'){\n            loc[i] ='m';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'm'){\n            loc[i] ='n';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'n'){\n            loc[i] ='o';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'o'){\n            loc[i] ='p';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'p'){\n            loc[i] ='q';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'q'){\n            loc[i] ='r';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'r'){\n            loc[i] ='s';\n            loc[i+1]= 0;\n        }else if(loc[i] == 's'){\n            loc[i] ='t';\n            loc[i+1]= 0;\n        }else if(loc[i] == 't'){\n            loc[i] ='u';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'u'){\n            loc[i] ='v';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'w'){\n            loc[i] ='x';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'x'){\n            loc[i] ='y';\n            loc[i+1]= 0;\n        }else if(loc[i] == 'y'){\n            loc[i] ='z';\n            loc[i+1]= 0;\n        }\n\n\n    }\n}\n\nreturn loc;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "memory-management", "alignment"], "answers": [{"comments": [{"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1506621217, "post_id": 46457745, "comment_id": 79905936, "body": "So the footnote &quot;2&quot; doesn&#39;t occur anywhere in the text right? What is weird though is that GCC does generally support extended alignments up to at least 128, but not here. I guess there is no constraints that extended alignment support  has be be <i>consistent</i> in any implementation, however."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1506548909, "creation_date": 1506548909, "answer_id": 46457745, "question_id": 46457386, "link": "https://stackoverflow.com/questions/46457386/how-can-stdaligned-storage-expose-correctly-aligned-storage-for-any-object/46457745#46457745", "title": "How can std::aligned_storage expose correctly aligned storage for any object?", "body": "<p>Per <a href=\"https://timsong-cpp.github.io/cppwp/meta.trans.other#2\" rel=\"nofollow noreferrer\">[meta.trans.other]/2</a>,</p>\n\n<blockquote>\n  <p>It is implementation-defined whether any extended alignment is supported.</p>\n</blockquote>\n\n<p>It's pretty annoying when they specify stuff like this after the big table without a pointer. I've just added the sentence to cppreference.</p>\n"}], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 46457745, "answer_count": 1, "score": 1, "last_activity_date": 1506548909, "creation_date": 1506547158, "last_edit_date": 1506547538, "question_id": 46457386, "link": "https://stackoverflow.com/questions/46457386/how-can-stdaligned-storage-expose-correctly-aligned-storage-for-any-object", "title": "How can std::aligned_storage expose correctly aligned storage for any object?", "body": "<p>The <code>std::aligned_storage</code> structure provides a <code>type</code> typedef that at least according to <a href=\"http://en.cppreference.com/w/cpp/types/aligned_storage\" rel=\"nofollow noreferrer\">cppreference</a>: </p>\n\n<blockquote>\n  <p>Provides the member typedef type, which is a PODType suitable for use\n  as uninitialized storage for any object whose size is at most Len and\n  whose alignment requirement is a divisor of Align.</p>\n  \n  <p>The default value of Align is the most stringent (the largest)\n  alignment requirement for any object whose size is at most Len.</p>\n</blockquote>\n\n<p>In particular, with the default value of <code>Align</code>, the suitably aligned for <em>any object</em> whose size is at most Len.</p>\n\n<p>Note that there are no caveats or exceptions for over-aligned types (and in any case the platform I'm using, gcc, supports at least some over-aligned types).</p>\n\n<p>How can such an implementation actually work? To satisfy the requirement of \"any object\" it would seem that it would either:</p>\n\n<ol>\n<li>On a platform where <code>alignof(T) &lt;= sizeof(T)</code> for types <code>T</code>, need to always align to roughly <code>Len</code> bytes, since an object of size <code>Len</code> could have an alignment of up to <code>Len</code>. Of course, this would waste a lot of memory for large <code>Len</code>!</li>\n<li>On a platform where <code>alignof(T)</code> may be larger than than <code>sizeof(T)</code>, I don't see how it could be implemented at all. However, it isn't <a href=\"https://stackoverflow.com/questions/46457449/is-it-always-the-case-that-sizeoft-alignoft-for-all-types-t\">clear to me</a> that such a type can even exist.</li>\n</ol>\n\n<p>Based on <a href=\"http://coliru.stacked-crooked.com/a/d27a419d81c12f2d\" rel=\"nofollow noreferrer\">my testing</a>, for default <code>Align</code> values, <code>gcc</code> simply always aligns to 16, regardless of len. This means the storage is <em>not</em> suitable for <em>any</em> object, but only objects of fundamental alignment (<code>alignof(max_align_t) == 16</code> on this platform).</p>\n"}, {"tags": ["c++", "c++11", "iterator", "set", "stdset"], "comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 177576, "user_id": 8620333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WSmLn.png?s=128&g=1", "display_name": "Temani Afif", "link": "https://stackoverflow.com/users/8620333/temani-afif"}, "edited": false, "score": 3, "creation_date": 1506547018, "post_id": 46457311, "comment_id": 79870309, "body": "@TemaniAfif How is this a duplicate of that question?"}, {"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506547035, "post_id": 46457311, "comment_id": 79870313, "body": "For completeness and generality, to comply with <a href=\"http://en.cppreference.com/w/cpp/concept/Container\" rel=\"nofollow noreferrer\">Container</a> concept."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506547126, "post_id": 46457311, "comment_id": 79870350, "body": "@yurikilochek how is it not general enough to only provide const methods for things that return const references to contained values?  Can you give an example of general code that will fail if those non const iterators methods are not present?  The only thing I can think of is something that has partial specializations that detect the presence of a non const begin() and end() method."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506547329, "post_id": 46457311, "comment_id": 79870433, "body": "@yurikilochek the container concept does not mention that a class must have non const qualified begin and end methods, it only says that a container must have them.  Which the sets do.  cbegin() and cend() are a different story and not entirely relevant here"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1506547567, "post_id": 46457311, "comment_id": 79870528, "body": "Before C++11, modifying operations which accepted iterators from the set (such as <code>erase</code> and the hint version of <code>insert</code>) required non-const iterators. So that could be one reason."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1506547611, "post_id": 46457311, "comment_id": 79870539, "body": "@BenjaminLindley I think that can be solved by keeping the alias <code>const_iterator</code> right?"}, {"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506547754, "post_id": 46457311, "comment_id": 79870597, "body": "@Curious, per <a href=\"http://eel.is/c++draft/container.requirements#tab:containers.container.requirements\" rel=\"nofollow noreferrer\">container.requirements.general/4</a> <code>a.begin()</code> must return <code>const_iterator</code> for const <code>a</code>, and <code>iterator</code> otherwise."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1506547771, "post_id": 46457311, "comment_id": 79870608, "body": "@Curious: It could, yes. I suspect they simply hadn&#39;t thought of that at the time of the original standard, just like they hadn&#39;t thought of the fact that it shouldn&#39;t be necessary to pass non-const iterators, even though the function is modifying the set (because the set itself is non-const)."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506547867, "post_id": 46457311, "comment_id": 79870643, "body": "@yurikilochek that just says <code>iterator; const_&#173;iterator for constant a</code>, so that will not matter if <code>iterator</code> and <code>const_iterator</code> are the same type.  C++ does not have strong aliases"}, {"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506548305, "post_id": 46457311, "comment_id": 79870801, "body": "@Curious if they were the same type, user code wouldn&#39;t be able to overload on them."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506548488, "post_id": 46457311, "comment_id": 79870883, "body": "@yurikilochek and user code shouldn&#39;t overload on them right?  The standard never specifies if those iterator classes are actually distinct types or whether they are aliased to the same underlying implementation.  In fact libstdc++ does exactly this <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_set.h#L138-L139\" rel=\"nofollow noreferrer\">github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/inclu&zwnj;&#8203;de/&hellip;</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1506548969, "post_id": 46457311, "comment_id": 79871073, "body": "I believe but am not 100% sure that early versions of <code>set</code> would allow you to modify the object at an iterator. Of course modifying the object in a way that reordered it would result in undefined behavior, but there are many cases where part of the object is a key and the rest could be safely modified. I honestly don&#39;t know why that&#39;s not allowed."}, {"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506549158, "post_id": 46457311, "comment_id": 79871137, "body": "<a href=\"http://eel.is/c++draft/set#overview-2\" rel=\"nofollow noreferrer\"><code>std::set::erase</code></a> is overloaded on them. Can we apply as-is rule here?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1506549711, "post_id": 46457311, "comment_id": 79871313, "body": "@yurikilochek not sure why the standard specifies those as two distinct functions.  libstdc++ again only has one of them <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_set.h#L627\" rel=\"nofollow noreferrer\">github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/inclu&zwnj;&#8203;de/&hellip;</a> I think it might be there in the standard as a guideline for implementations in which they are two distinct types."}], "answers": [{"tags": [], "owner": {"reputation": 2488, "user_id": 453436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8e7be51a9257fb1f08a7f01c9c29e3?s=128&d=identicon&r=PG", "display_name": "Bowie Owens", "link": "https://stackoverflow.com/users/453436/bowie-owens"}, "is_accepted": false, "score": -1, "last_activity_date": 1506551811, "creation_date": 1506551811, "answer_id": 46458252, "question_id": 46457311, "link": "https://stackoverflow.com/questions/46457311/why-does-stdmultiset-provide-non-const-iterator-methods/46458252#46458252", "title": "Why does std::(multi)set provide non const iterator methods", "body": "<p>While I can't say for certain, consistency (see comments by @yurikilochek) seems reasonable to me. \"Can you give an example of general code that will fail if those non const iterators methods are not present?\" The following code does not compile with libstdc++ (but does compile under Visual Studio) because set does not have the non-const methods. I acknowledge this is not code someone would write in the course of a day that is going well.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;set&gt;\n\ntemplate &lt;class C&gt; //C is some container\nvoid f(C&amp; c)\n{\n    typedef typename C::iterator iter;\n    typedef iter (C::*fn)(); // note non-const method\n\n    fn begin = &amp;C::begin; // will fail with set if begin() is const only\n    fn end = &amp;C::end;\n\n    for (iter i = (c.*begin)(), e = (c.*end)(); i != e; ++i)\n        std::cout &lt;&lt; *i &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n}\n\nint\nmain()\n{\n    std::vector&lt;int&gt; v;\n    std::set&lt;int&gt; s;\n\n    f(v);\n    f(s);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 2, "last_activity_date": 1506556469, "creation_date": 1506556469, "answer_id": 46458872, "question_id": 46457311, "link": "https://stackoverflow.com/questions/46457311/why-does-stdmultiset-provide-non-const-iterator-methods/46458872#46458872", "title": "Why does std::(multi)set provide non const iterator methods", "body": "<p>Note that in <a href=\"http://eel.is/c++draft/member.functions\" rel=\"nofollow noreferrer\">[member.functions]</a>, it's expressed that:</p>\n\n<blockquote>\n  <p>For a non-virtual member function described in the C++ standard library, an implementation may declare a different set of member function signatures, provided that any call to the member function that would select an overload from the set of declarations described in this document behaves as if that overload were selected.</p>\n</blockquote>\n\n<p>The standard defines behavior for each container in <a href=\"http://eel.is/c++draft/container.requirements#tab:containers.container.requirements\" rel=\"nofollow noreferrer\">[container.requirements.general]</a> which require that:</p>\n\n<ul>\n<li><code>a.begin()</code> yields an <code>iterator</code> (or <code>const_iterator</code> for constant <code>a</code>)</li>\n<li><code>a.end()</code> yields an <code>iterator</code> (or <code>const_iterator</code> for constant <code>a</code>)</li>\n<li>...</li>\n</ul>\n\n<p>The requirement for the implementations are that those types (<code>C::iterator</code> and <code>C::const_iterator</code>) exist and that those functions yield those types. The requirement is <strong>not</strong> specifically that those four overloads must exist (nor that the two iterator types must be different). The requirement is just the behavior.</p>\n\n<p>The following would be a perfectly conforming implementation for <code>set</code>:</p>\n\n<pre><code>template &lt;class Key, class Compare = std::less&lt;Key&gt;, class Allocator = std::allocator&lt;Key&gt;&gt;\nclass set {\npublic:\n    struct iterator { ... };\n    using const_iterator = iterator;\n\n    iterator begin() const { ... };\n    iterator end() const { ... };\n\n    // other stuff\n};    \n</code></pre>\n\n<p>With this implementation, all the requirements are satisfied. So it's sufficient. Indeed, this is how libstdc++ implements it - the two iterators are the <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_set.h#L138-L139\" rel=\"nofollow noreferrer\">same type</a> and there is just one <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_set.h#L334-L336\" rel=\"nofollow noreferrer\"><code>begin()</code></a> and just one <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_set.h#L343-L345\" rel=\"nofollow noreferrer\"><code>end()</code></a>. </p>\n\n<blockquote>\n  <p>Why introduce those extra overloads?</p>\n</blockquote>\n\n<p>There aren't extra overloads. Or at least, there don't have to be. It's up to to the implementer. </p>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1506556469, "creation_date": 1506546801, "last_edit_date": 1506548350, "question_id": 46457311, "link": "https://stackoverflow.com/questions/46457311/why-does-stdmultiset-provide-non-const-iterator-methods", "title": "Why does std::(multi)set provide non const iterator methods", "body": "<p>Why do the sets (<code>std::set</code> and <code>std::multiset</code>) in the C++ standard library provide non <code>const_iterator</code> methods (<a href=\"http://en.cppreference.com/w/cpp/container/set/begin\" rel=\"nofollow noreferrer\"><code>set::begin</code></a> and <a href=\"http://en.cppreference.com/w/cpp/container/multiset/begin\" rel=\"nofollow noreferrer\"><code>multiset::begin</code></a>)?</p>\n\n<p>Access to the keys through iterators is always <code>const</code>. It does not matter if the set itself is const or not. <strong>Why introduce those extra overloads?</strong></p>\n"}, {"tags": ["c++", "linux", "linker"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1506546348, "post_id": 46457177, "comment_id": 79870072, "body": "Use also <code>pkg-config --libs</code> at link time"}, {"owner": {"reputation": 23, "user_id": 5671940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a833bb242b1bc6a6368639eb1cbd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Baruffaldi", "link": "https://stackoverflow.com/users/5671940/leonardo-baruffaldi"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1506549140, "post_id": 46457177, "comment_id": 79871127, "body": "@BasileStarynkevitch, I&#39;ve done that as well. I edited the original question to include that information."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1506549895, "post_id": 46457177, "comment_id": 79871380, "body": "It seems that MBSim wants a different path than <code>&#47;usr&#47;local&#47;mbsim-env</code>"}, {"owner": {"reputation": 23, "user_id": 5671940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a833bb242b1bc6a6368639eb1cbd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Baruffaldi", "link": "https://stackoverflow.com/users/5671940/leonardo-baruffaldi"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1506550196, "post_id": 46457177, "comment_id": 79871490, "body": "@Ripi2 you mean it is hardcoded with a different path? Maybe ponting to the original compilation site?"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1506550300, "post_id": 46457177, "comment_id": 79871525, "body": "I don&#39;t know. That&#39;s a MBSim decision. Do they have a make or cmake script you can look into searching for hints?"}, {"owner": {"reputation": 23, "user_id": 5671940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a833bb242b1bc6a6368639eb1cbd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Baruffaldi", "link": "https://stackoverflow.com/users/5671940/leonardo-baruffaldi"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1506553439, "post_id": 46457177, "comment_id": 79872425, "body": "@Ripi2 I checked the make log on Github and they use <code>-Wl,-rpath -Wl,\\$ORIGIN&#47;..&#47;lib</code> as linker options. Can that be the problem?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5671940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a833bb242b1bc6a6368639eb1cbd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Baruffaldi", "link": "https://stackoverflow.com/users/5671940/leonardo-baruffaldi"}, "edited": false, "score": 0, "creation_date": 1506600396, "post_id": 46459415, "comment_id": 79892214, "body": "Thank you, @any1, that solved the issue. I added <code>-D_GCLIBXX_USE_CXX11_ABI=0</code> to my compile command and the undefined references to <code>std::__cxx11::basic_string</code> methods are gone."}], "tags": [], "owner": {"reputation": 301, "user_id": 4342691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc51a2c4dc428266b6100af6493d13b5?s=128&d=identicon&r=PG&f=1", "display_name": "any1", "link": "https://stackoverflow.com/users/4342691/any1"}, "is_accepted": true, "score": 1, "last_activity_date": 1506560939, "creation_date": 1506560939, "answer_id": 46459415, "question_id": 46457177, "link": "https://stackoverflow.com/questions/46457177/g-undefined-reference-error-when-linking-to-third-party-shared-libraries/46459415#46459415", "title": "g++ undefined reference error when linking to third party shared libraries", "body": "<p>Could it be that your 3rd party shared libraries are compiled using an older version of GCC? There was a new ABI introduced in GCC 5. It's probably enabled by default on your platform. See <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html</a>.</p>\n\n<p>You could try switching to the older ABI, but that might require your other libraries to have been compiled with the old ABI also. You might also be able to switch ABIs for the 3rd party libraries explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1506573369, "creation_date": 1506573369, "answer_id": 46461058, "question_id": 46457177, "link": "https://stackoverflow.com/questions/46457177/g-undefined-reference-error-when-linking-to-third-party-shared-libraries/46461058#46461058", "title": "g++ undefined reference error when linking to third party shared libraries", "body": "<blockquote>\n  <p>undefined reference to  <code>MBSim::RigidBody::RigidBody(std::__cxx11::basic_string&lt;std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)</code></p>\n</blockquote>\n\n<p>This is a reference to <code>MBSim::RigidBody::RigidBody(const string&amp;)</code>, compiled with <code>g++ -std=c++11</code> and <code>g++</code> version 5 or later.</p>\n\n<p>As any1 probably correctly guessed, the binary for <code>libmbsim.so</code> that you downloaded was built with g++ 4.x, and defines the same function with this signature:</p>\n\n<pre><code>MBSim::RigidBody::RigidBody(std::basic_string&lt;char, std::char_traits&lt;char&gt;,\n                                              std::allocator&lt;char&gt; &gt; const&amp;)\n</code></pre>\n\n<p>Note lack of <code>__cxx11</code> namespace. You can easily confirm or disprove this:</p>\n\n<pre><code>nm -C libmbsim.so | grep 'MBSim::RigidBody::RigidBody'\n</code></pre>\n\n<p>If this mismatch is indeed the cause, simply rebuild this project from source with <em>your</em> compiler. That's what open source <em>is for</em>.</p>\n"}], "owner": {"reputation": 23, "user_id": 5671940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a833bb242b1bc6a6368639eb1cbd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Baruffaldi", "link": "https://stackoverflow.com/users/5671940/leonardo-baruffaldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 46459415, "answer_count": 2, "score": 2, "last_activity_date": 1506573369, "creation_date": 1506546172, "last_edit_date": 1506549209, "question_id": 46457177, "link": "https://stackoverflow.com/questions/46457177/g-undefined-reference-error-when-linking-to-third-party-shared-libraries", "title": "g++ undefined reference error when linking to third party shared libraries", "body": "<p>I'm trying to link a c++ program that uses several shared libraries from 3rd parties. Mainly, these libraries come from a github project called MBSim and I downloaded the latest daily build with all its binaries, libraries and headers, which I installed on <code>/usr/local/mbsim-env</code>.</p>\n\n<p>The most important libraries called are <code>libmbsim</code>, <code>libopenmbvcppinterface</code>, <code>libfmatvec</code> and <code>libboost_filesystem</code> (the last one comes with the MBSim distro).</p>\n\n<p>I set up a simple code to test it and it compiles like a charm using</p>\n\n<pre><code>    g++ main.cpp -m64 -g3 -std=c++11 -Wall \n              -Wfatal-errors -Werror -Wno-unknown-pragmas -fopenmp \n              `pkg-config --cflags mbsim` -I. -c -o main.o\n</code></pre>\n\n<p>The <code>pkg-config</code> part calls, as you can wonder, the include directories and flags:</p>\n\n<pre><code>    -DHAVE_ANSICSIGNAL -DHAVE_OPENMBVCPPINTERFACE -DHAVE_BOOST_FILE_LOCK\n    -I/usr/local/mbsim-env/include \n    -I/usr/include/x86_64-linux-gnu\n    -I/usr/include/x86_64-linux-gnu/c++/5 \n    -I/usr/local/include\n</code></pre>\n\n<p>My problems appear when I try to link the objects with the pre-compiled libraries with:</p>\n\n<pre><code>    g++ system.o main.o -o teste -L/usr/local/mbsim-env/lib \n                  -lmbsim -lopenmbvcppinterface -lboost_system \n                  -lfmatvec -lm \n                  -Wl,-rpath,/usr/local/mbsim-env/lib\n</code></pre>\n\n<p><strong>Edit:</strong> On the above command, I've tried to use <code>pkg-config --libs</code> as well. The results remain the same.</p>\n\n<p>First of all, the linker issues a warning that I'm linking against an older boost library:</p>\n\n<pre><code>    /usr/bin/ld: warning: libboost_system.so.1.53.0,\n                 needed by /usr/local/mbsim-env/lib/libmbsim.so, \n                 may conflict with libboost_system.so.1.61.0\n</code></pre>\n\n<p>I'm aware of that, but I intentionally want to link against the old one because that's the one that was used to compile the MBSim libraries.</p>\n\n<p>After that, I got several <code>undefined reference</code> warnings for almost every method that I call from MBSim:</p>\n\n<pre><code>    system.cpp:59: undefined reference to\n       MBSim::RigidBody::RigidBody(std::__cxx11::basic_string&lt;char,\n       std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)'\n</code></pre>\n\n<p>It seems to me that this error means that the target libraries don't have the <code>RigidBody</code> method implemented. Well, I know they do.</p>\n\n<p>My first guess was that maybe the linker was looking at the wrong library path, so I set <code>LD_LIBRARY_PATH=/usr/local/mbsim-env/lib</code> and added the <code>-rpath</code> to the same folder. That didn't help at all.</p>\n\n<p>Some googling showed me that the problem could be compiling in 64bits and linking it against 32bits libs. I believe that's not the case: I've done everything in Ubuntu 16.04 64bits and the MBSim libraries are also 64bits.</p>\n\n<p>Could somebody point me out of this dead end?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1506546184, "post_id": 46457172, "comment_id": 79870008, "body": "Because <code>make_pair</code> uses forwarded arguments."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1506546368, "post_id": 46457172, "comment_id": 79870075, "body": "Very useful talk by STL: <a href=\"https://youtu.be/AKtHxKJRwp4?t=48m45s\" rel=\"nofollow noreferrer\">youtu.be/AKtHxKJRwp4?t=48m45s</a>"}], "owner": {"reputation": 1026, "user_id": 807307, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/decd3ea69d3387db2ffb5394ab7abebd?s=128&d=identicon&r=PG", "display_name": "Giovanni Mascellani", "link": "https://stackoverflow.com/users/807307/giovanni-mascellani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "closed_date": 1506546453, "answer_count": 0, "score": 0, "last_activity_date": 1506546137, "creation_date": 1506546137, "question_id": 46457172, "link": "https://stackoverflow.com/questions/46457172/why-does-make-pair-fail-when-template-arguments-are-explicited", "closed_reason": "Duplicate", "title": "Why does make_pair fail when template arguments are explicited?", "body": "<p>Why does this code compiles?</p>\n\n<pre><code>#include &lt;utility&gt;\n\nusing namespace std;\n\nint main()\n{\n    int i = 1, j = 2;\n    auto p = make_pair(i, j);\n    (void) p;\n}\n</code></pre>\n\n<p>And this does not?</p>\n\n<pre><code>#include &lt;utility&gt;\n\nusing namespace std;\n\nint main()\n{\n    int i = 1, j = 2;\n    auto p = make_pair&lt;int,int&gt;(i, j);\n    (void) p;\n}\n</code></pre>\n\n<p>The only difference is that I explicitly added the template parameters to <code>make_pair</code>. Why does this break the program? GCC gives the following errors:</p>\n\n<pre><code>main.cpp:\n In function 'int main()':\nmain.cpp:8:37: error: no matching function for call to 'make_pair&lt;int, int&gt;(int&amp;, int&amp;)'\n     auto p = make_pair&lt;int,int&gt;(i, j);\n                                     ^\nIn file included from /usr/local/include/c++/7.2.0/utility:70:0,\n                 from main.cpp:1:\n/usr/local/include/c++/7.2.0/bits/stl_pair.h:519:5: note: candidate: template&lt;class _T1, class _T2&gt; constexpr std::pair&lt;typename std::__decay_and_strip&lt;_Tp&gt;::__type, typename std::__decay_and_strip&lt;_T2&gt;::__type&gt; std::make_pair(_T1&amp;&amp;, _T2&amp;&amp;)\n     make_pair(_T1&amp;&amp; __x, _T2&amp;&amp; __y)\n     ^~~~~~~~~\n/usr/local/include/c++/7.2.0/bits/stl_pair.h:519:5: note:   template argument deduction/substitution failed:\nmain.cpp:8:37: note:   cannot convert 'i' (type 'int') to type 'int&amp;&amp;'\n     auto p = make_pair&lt;int,int&gt;(i, j);\n                                     ^\n</code></pre>\n\n<p>See for example <a href=\"http://coliru.stacked-crooked.com/view?id=15dfe1319882e904\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/view?id=15dfe1319882e904</a>.</p>\n\n<p>I know that one may use <code>pair</code> instead of <code>make_pair</code>, so the question is not on how to fix the program; what I am really curious about is why specifying the template parameters of <code>make_pair</code> turns a compiling program in a wrong one.</p>\n"}, {"tags": ["c++", "qt", "qtstylesheets", "qstylesheet", "qpalette"], "comments": [{"owner": {"reputation": 8160, "user_id": 1035613, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b4d6ce44848765d7b02e4309c9efe9bb?s=128&d=identicon&r=PG", "display_name": "Dmitry Sazonov", "link": "https://stackoverflow.com/users/1035613/dmitry-sazonov"}, "edited": false, "score": 0, "creation_date": 1506586630, "post_id": 46457107, "comment_id": 79883185, "body": "Qt generates special instance of <code>QProxyStyle</code> based on your QSS. There are no way to reverse it."}], "answers": [{"tags": [], "owner": {"reputation": 12209, "user_id": 1514983, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/953f9c2e14575db714293ea3dffebca8?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1514983/petr"}, "is_accepted": true, "score": 0, "last_activity_date": 1506547147, "creation_date": 1506547147, "answer_id": 46457385, "question_id": 46457107, "link": "https://stackoverflow.com/questions/46457107/how-to-get-qwidget-background-color-after-set-a-qstylesheet/46457385#46457385", "title": "How to get QWidget background-color after set a QStyleSheet", "body": "<p>You can't directly access individual properties of the style sheet. What you can do, is retrieve the style sheet and then you would need to parse it and find the property you are looking for (<code>some_widget-&gt;styleSheet()</code> would return it as a <code>QString</code>).</p>\n\n<p>If you don't want to do that, and want to access the palette directly, you must use that instead of style sheet to change the colors.</p>\n\n<p>Example code how you can style your code using palette instead of style sheet:</p>\n\n<pre><code>QPalette px;\npx.setColor(QPalette::Text, QColor(255, 255, 255)); // Set text color to white\npx.setColor(QPalette::Base, QColor(0, 0, 0)); // Set background to black\nsome_widget-&gt;setPalette(px);\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8685551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a69c8e348a1a9c76b8c23c94c4e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sneezeface", "link": "https://stackoverflow.com/users/8685551/sneezeface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "accepted_answer_id": 46457385, "answer_count": 1, "score": 1, "last_activity_date": 1506547147, "creation_date": 1506545834, "question_id": 46457107, "link": "https://stackoverflow.com/questions/46457107/how-to-get-qwidget-background-color-after-set-a-qstylesheet", "title": "How to get QWidget background-color after set a QStyleSheet", "body": "<p>I have my desktop QApplication (Qt 5.9) on which I successfully set a style using a stylesheet. At runtime every QWidget look correctly styled as intended.<br>\nWhat I need to know is the background-color of a specific styled widget, let's say a QTooltip.  </p>\n\n<p>I tried the <em>QWidget::palette</em> method but what I got looked like the system's default color for the <em>QPalette::ColorRole</em> I asked.<br>\nMoreover, <a href=\"http://doc.qt.io/qt-5/qwidget.html#palette-prop\" rel=\"nofollow noreferrer\">qt docs</a> recommend not to use this method when using stylesheets.  </p>\n\n<p>So... more generally, how can one query for a widget property defined via stylesheets?</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1506544783, "post_id": 46456828, "comment_id": 79869327, "body": "Worrying about details like this is over-complicating it. Just do it. You could do stuff with <a href=\"http://en.cppreference.com/w/cpp/container/vector/back\" rel=\"nofollow noreferrer\"><code>vector.back()</code></a>, but this will already be just fine"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1506546009, "post_id": 46456828, "comment_id": 79869925, "body": "Yes, what Justin said, but IMO <code>sumVals.back() = ...</code> would be clearer."}, {"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 0, "creation_date": 1506546491, "post_id": 46456828, "comment_id": 79870113, "body": "You may consider <a href=\"http://en.cppreference.com/w/cpp/algorithm/accumulate\" rel=\"nofollow noreferrer\"><code>std::accumulate</code></a> instead of <code>for_each</code>"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1506546713, "post_id": 46456828, "comment_id": 79870198, "body": "<code>std::vector</code> is helpful when amount of items to be stored is not fixed or is not known at compile time. In your case it would be better to use <code>::std::array</code> avoiding (potentially throwing) heap memory allocation."}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506546794, "post_id": 46457152, "comment_id": 79870232, "body": "Usually better than a <code>pair</code> is a custom <code>struct</code>: <code>struct Distances { Real64 original; Real64 mirrored; };</code> or similar. The names <code>first</code> and <code>second</code> are rarely the best options."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 3, "last_activity_date": 1506546527, "last_edit_date": 1506546527, "creation_date": 1506546049, "answer_id": 46457152, "question_id": 46456828, "link": "https://stackoverflow.com/questions/46456828/vector-pop-back/46457152#46457152", "title": "Vector pop_back", "body": "<p>In my opinion, using the vector is overcomplicating it.</p>\n\n<p>Write a distance function that you can use.<br>\nSomething like this:</p>\n\n<pre><code>Real64 distance(MyCartesian const &amp; i, MyCartesian const &amp; j)\n{\n    return std::sqrt(pow_2(i.x - j.x)\n                   + pow_2(i.y - j.y)\n                   + pow_2(i.z - j.z));\n}\n\nMyCartesian mirror(MyCartesian pt)\n{\n    pt.z *= -1;\n    return pt;\n}\n\nstd::vector&lt;Real64&gt;\ndistances(MyCartesian const &amp; i,\n          MyCartesian const &amp; j)\n{\n    return std::vector { distance(i, j), distance(i, mirror(j)) };\n}\n</code></pre>\n\n<p>Since there's always exactly two results, you might prefer to return a <code>pair</code> instead of a <code>vector</code>.</p>\n"}], "owner": {"reputation": 191, "user_id": 5965685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf72bb2c2a66a57dff9ed8e23039c145?s=128&d=identicon&r=PG&f=1", "display_name": "mitchute", "link": "https://stackoverflow.com/users/5965685/mitchute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 46457152, "answer_count": 1, "score": 0, "last_activity_date": 1506546527, "creation_date": 1506544642, "question_id": 46456828, "link": "https://stackoverflow.com/questions/46456828/vector-pop-back", "title": "Vector pop_back", "body": "<p>I have the following function to calculate the distance between two Cartesian points, and the mirror of one of the points about the z axis.</p>\n\n<pre><code>inline std::vector&lt; Real64 &gt;\ndistances(\n    MyCartesian const &amp; point_i,\n    MyCartesian const &amp; point_j\n)\n{\n    std::vector&lt; Real64 &gt; sumVals;\n\n    // Calculate the distance between points\n    sumVals.push_back( pow_2( point_i.x - point_j.x ) );\n    sumVals.push_back( pow_2( point_i.y - point_j.y ) );\n    sumVals.push_back( pow_2( point_i.z - point_j.z ) );\n\n    Real64 sumTot = 0;\n    std::vector&lt; Real64 &gt; retVals;\n    std::for_each( sumVals.begin(), sumVals.end(), [&amp;] ( Real64 n ) { sumTot += n; } );\n    retVals.push_back( std::sqrt( sumTot ) );\n\n    // Calculate distance to mirror point\n    sumVals.pop_back();\n    sumVals.push_back( pow_2( point_i.z - ( -point_j.z ) ) );\n    sumTot = 0;\n    std::for_each( sumVals.begin(), sumVals.end(), [&amp;] ( Real64 n ) { sumTot += n; } );\n    retVals.push_back( std::sqrt( sumTot ) );\n\n    return retVals;\n};\n</code></pre>\n\n<p>Are there any benefits from <code>pop_back</code>, then <code>push_back</code>, or is there a better way to replace the last element in the vector?</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2017"], "comments": [{"owner": {"reputation": 8345, "user_id": 421178, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9fa51d322613d477fd82330340c46ff3?s=128&d=identicon&r=PG", "display_name": "Casey", "link": "https://stackoverflow.com/users/421178/casey"}, "edited": false, "score": 0, "creation_date": 1568510685, "post_id": 46456642, "comment_id": 102295949, "body": "I&#39;ve been looking for an answer to this for over a decade. :("}], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1506625201, "creation_date": 1506543903, "last_edit_date": 1506625201, "question_id": 46456642, "link": "https://stackoverflow.com/questions/46456642/visual-studio-how-to-set-working-directory-in-property-sheets", "title": "Visual Studio: How to set Working Directory in Property Sheets?", "body": "<p>If I open up the Properties of any arbitrary project, I'm able to change the Working Directory of any target project:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FHS0X.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/FHS0X.png\" alt=\"Working Directory\"></a></p>\n\n<p>However, if I try to open up an individual Property Sheet for a project, the \"Debugging\" Category is missing, and I cannot find any field I can alter which would allow me to set the Working Directory for that Property Sheet (which would therefore allow me to change the Working Directory for multiple projects simultaneously):</p>\n\n<p><a href=\"https://i.stack.imgur.com/SFgG8.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/SFgG8.png\" alt=\"Missing &quot;Debugging&quot; Category\"></a></p>\n\n<p>What can I do to change this property at a Property Sheet level?</p>\n"}, {"tags": ["c++", "c++11", "datetime", "gcc", "time"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1506543870, "post_id": 46456606, "comment_id": 79868889, "body": "Is there a <code>-std=c++11</code> somewhere in your many configuration options?"}, {"owner": {"reputation": 183, "user_id": 1702529, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/263b3d3107a0b0ad8e1f68f5217878ad?s=128&d=identicon&r=PG", "display_name": "herteladrian", "link": "https://stackoverflow.com/users/1702529/herteladrian"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1506543970, "post_id": 46456606, "comment_id": 79868930, "body": "@StoryTeller How do I do that? I&#39;m a bit of a newbie."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1506544061, "post_id": 46456606, "comment_id": 79868977, "body": "It&#39;s a GCC compiler option. You didn&#39;t specify how the server invokes it, but you should make sure it is supplied that option."}, {"owner": {"reputation": 183, "user_id": 1702529, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/263b3d3107a0b0ad8e1f68f5217878ad?s=128&d=identicon&r=PG", "display_name": "herteladrian", "link": "https://stackoverflow.com/users/1702529/herteladrian"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1506558586, "post_id": 46456606, "comment_id": 79873593, "body": "i used g++ -std=c++11 my-file.cpp and it worked. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 1702529, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/263b3d3107a0b0ad8e1f68f5217878ad?s=128&d=identicon&r=PG", "display_name": "herteladrian", "link": "https://stackoverflow.com/users/1702529/herteladrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1506558746, "creation_date": 1506558746, "answer_id": 46459130, "question_id": 46456606, "link": "https://stackoverflow.com/questions/46456606/stdget-time-has-not-been-declared/46459130#46459130", "title": "\u2018std::get_time\u2019 has not been declared", "body": "<p>I was able to successfully compile my code on the server by adding \"-std=c++11\" to my compiling call. This works:</p>\n\n<pre><code>g++ -std=c++11 DateTime.cpp\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 1702529, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/263b3d3107a0b0ad8e1f68f5217878ad?s=128&d=identicon&r=PG", "display_name": "herteladrian", "link": "https://stackoverflow.com/users/1702529/herteladrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2148, "favorite_count": 0, "accepted_answer_id": 46459130, "answer_count": 1, "score": -2, "last_activity_date": 1506558816, "creation_date": 1506543781, "last_edit_date": 1506558816, "question_id": 46456606, "link": "https://stackoverflow.com/questions/46456606/stdget-time-has-not-been-declared", "title": "\u2018std::get_time\u2019 has not been declared", "body": "<p>I am using get_time() and mtkime() to convert the values of an object of my DateTime class to a unix timestamp so that I can easily compare two instances of my DateTime class. Here is my code for generating the time stamp</p>\n\n<h2>void DateTime::setTimeStamp()</h2>\n\n<pre><code>stringstream date_ss1;\ndate_ss1 &lt;&lt; (*this);\nistringstream date_iss(date_ss1.str());\nstruct tm date;\ndate_iss &gt;&gt; get_time( &amp;date, \"%Y/%m/%d-%H:%M\" );\ntimestamp = mktime( &amp;date );\n</code></pre>\n\n<p>This code compiles and works perfectly on my Mac.\nBUT it gives this as the only error when compiling it on a remote server.</p>\n\n<pre><code>DateTime.h:40:12: error: \u2018std::get_time\u2019 has not been declared\n using std::get_time;\n</code></pre>\n\n<p>The server's compiler has no problem finding mtkime in case that info is of help.</p>\n\n<h2>My Mac compiler version</h2>\n\n<blockquote>\n  <p>Configured with:\n  --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1 Apple LLVM version 9.0.0 (clang-900.0.37) Target: x86_64-apple-darwin16.7.0 Thread model: posix\n  InstalledDir:\n  /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</p>\n</blockquote>\n\n<h2>Server GNU compiler version</h2>\n\n<blockquote>\n  <p>gcc (GCC) 5.3.1 20160406 (Red Hat 5.3.1-6)</p>\n</blockquote>\n\n<p>I got the version of the compilers on both my Mac and the remote server by running</p>\n\n<pre><code>gcc --version\n</code></pre>\n\n<h2>DateTime.h</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;cstdlib&gt;\n#include &lt;sstream&gt;\n#include &lt;ctime&gt;\n#include &lt;exception&gt;    \n\nusing std::ostream;\nusing std::istream;\nusing std::string;\nusing std::setfill;\nusing std::setw;\nusing std::endl;\nusing std::stringstream;\nusing std::istringstream;\nusing std::cout;\nusing std::invalid_argument;\nusing std::exit;\nusing std::get_time;\n\n/*code*/\n</code></pre>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506543594, "post_id": 46456540, "comment_id": 79868757, "body": "Displays the contents of your .ui file"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506543716, "post_id": 46456540, "comment_id": 79868821, "body": "try adding: <code>#include &lt;QPushButton&gt;</code>"}, {"owner": {"reputation": 48, "user_id": 1467844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CSQFn.png?s=128&g=1", "display_name": "CanOSpam", "link": "https://stackoverflow.com/users/1467844/canospam"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506544434, "post_id": 46456540, "comment_id": 79869152, "body": "@eyllanesc I tried adding QPushButton, but it didn&#39;t solve the problem unfortunately."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506544547, "post_id": 46456540, "comment_id": 79869203, "body": "With the information you show it is impossible to help, first it shows the contents of the file ui, I think this project is small so you can easily upload it to drive, dropbox, github or similar and share the link to see what the problem is."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506544635, "post_id": 46456540, "comment_id": 79869248, "body": "Please improve your question, please read the following: <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 48, "user_id": 1467844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CSQFn.png?s=128&g=1", "display_name": "CanOSpam", "link": "https://stackoverflow.com/users/1467844/canospam"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506544789, "post_id": 46456540, "comment_id": 79869332, "body": "@eyllanesc <a href=\"https://gist.github.com/anonymous/75324053c64c4f82caba6232545170de\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/75324053c64c4f82caba6232545170de</a> that&#39;s my UI file, you can find the button in there. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 72, "user_id": 2879698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9033b3606898b6c79c93be96ecb5fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Will Murphy", "link": "https://stackoverflow.com/users/2879698/will-murphy"}, "is_accepted": true, "score": 3, "last_activity_date": 1506547269, "creation_date": 1506547269, "answer_id": 46457423, "question_id": 46456540, "link": "https://stackoverflow.com/questions/46456540/issue-with-qt-button-i-cant-find-it-in-ui/46457423#46457423", "title": "Issue with Qt button, I can&#39;t find it in UI", "body": "<p>Try rebuilding your solution, that should work.</p>\n"}, {"tags": [], "owner": {"reputation": 12209, "user_id": 1514983, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/953f9c2e14575db714293ea3dffebca8?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1514983/petr"}, "is_accepted": false, "score": 0, "last_activity_date": 1506547621, "creation_date": 1506547621, "answer_id": 46457480, "question_id": 46456540, "link": "https://stackoverflow.com/questions/46456540/issue-with-qt-button-i-cant-find-it-in-ui/46457480#46457480", "title": "Issue with Qt button, I can&#39;t find it in UI", "body": "<p>QtCreator sometimes \"forget\" to rerun qmake. Save all your files (especially .ui) and do Build -> Run QMake (or CMake depending on what you use).</p>\n\n<p>That will regenerate cpp files for your UI. Try rebuilding the project after that.</p>\n"}], "owner": {"reputation": 48, "user_id": 1467844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CSQFn.png?s=128&g=1", "display_name": "CanOSpam", "link": "https://stackoverflow.com/users/1467844/canospam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1101, "favorite_count": 0, "accepted_answer_id": 46457423, "answer_count": 2, "score": 2, "last_activity_date": 1506547621, "creation_date": 1506543490, "question_id": 46456540, "link": "https://stackoverflow.com/questions/46456540/issue-with-qt-button-i-cant-find-it-in-ui", "title": "Issue with Qt button, I can&#39;t find it in UI", "body": "<pre><code>#include \"DatacommAss1.h\"\n\nDatacommAss1::DatacommAss1(QWidget *parent)\n    : QMainWindow(parent)\n{\n    ui.setupUi(this);\n    connect(ui-&gt;pushButton, SIGNAL(released()), this, SLOT(handleButton()));\n}\n\nvoid DatacommAss1::handleButton()\n{\n    // change the text\n    ui-&gt;pushButton-&gt;setText(\"Ding Dong\");\n}\n</code></pre>\n\n<p>See my code above, I have a button in my ui file called pushButton, but I cannot access it.</p>\n\n<p>I get and error on 'ui' that says \"expression must have pointer type\".</p>\n\n<p>I'm new to Qt and have no idea how to fix this, any help is appreciated.</p>\n"}, {"tags": ["c++", "arrays", "string", "hex", "decimal"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1506543526, "post_id": 46456521, "comment_id": 79868714, "body": "Have you considered using <code>std::string</code> directly instead trying to build and convert your array?"}, {"owner": {"reputation": 33, "user_id": 8685565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6e1ec970ed208691d7e9049ba409ee?s=128&d=identicon&r=PG&f=1", "display_name": "TomHardy", "link": "https://stackoverflow.com/users/8685565/tomhardy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506543608, "post_id": 46456521, "comment_id": 79868764, "body": "i would prefer to write it without the &quot;std::&quot; because the whole program should be without them (don&#39;t asky me why because i don&#39;t know)"}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 2, "creation_date": 1506543643, "post_id": 46456521, "comment_id": 79868783, "body": "In addition to the above comment, you&#39;re putting characters into your array but then you do <code>arr[i]=rest;</code>. That should probably be <code>arr[i] = &#39;0&#39; + rest;</code>"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1506543829, "post_id": 46456521, "comment_id": 79868870, "body": "That whole switch can also be replaced. Values <code>10</code>-<code>15</code> (which are obviously consecutive) correspond to characters <code>&#39;A&#39;</code>-<code>&#39;F&#39;</code> (which are also consecutive)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1506546557, "post_id": 46456521, "comment_id": 79870138, "body": "@Kevin: whereas <code>&#39;0&#39;</code>, , <code>&#39;9&#39;</code> is guarantied to be consecutive, it is not the case for <code>&#39;A&#39;</code>, .., <code>&#39;F&#39;</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1506546689, "post_id": 46456521, "comment_id": 79870190, "body": "In your example, you have <code>&#39;K&#39;</code>, but that is not in your <code>switch</code> statement.  Please clarify."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506546703, "post_id": 46456521, "comment_id": 79870197, "body": "@Jarod42 You&#39;re right in general. In ASCII they are consecutive."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1506546855, "post_id": 46456521, "comment_id": 79870247, "body": "You could use a simple array lookup:  <code>static const char digits[] = &quot;0123456789ABCDEF&quot;;  cout &lt;&lt; &quot;Digit of 13 is: &quot; &lt;&lt; digits[13] &lt;&lt; &quot;\\n&quot;;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1506548160, "post_id": 46457226, "comment_id": 79870751, "body": "<code>&quot;0123456789ABCDEF&quot;[rest]</code> to really portable."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506549649, "post_id": 46457226, "comment_id": 79871294, "body": "@Jarod42, of course. Much better than my first suggestion."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 0, "last_activity_date": 1506549608, "last_edit_date": 1506549608, "creation_date": 1506546413, "answer_id": 46457226, "question_id": 46456521, "link": "https://stackoverflow.com/questions/46456521/c-array-to-one-int-variable/46457226#46457226", "title": "C++ Array to one Int variable", "body": "<blockquote>\n  <p>is there any way possible to pull the whole array (for example containig [4,2,K,8] into one single variable?</p>\n</blockquote>\n\n<p>You could use a <code>std::string</code> and pretend that it is one single variable but it is only an enhanced version of an array of <code>char</code>s.</p>\n\n<p>BTW, couple of points that are unrelated to the above question.</p>\n\n<ol>\n<li>You can simplify the <code>switch</code> statement. This was pointed out in a comment by @Kevin.</li>\n<li>Use of <code>arr[i]=rest;</code> is wrong. It needs to be <code>arr[i]=rest+'0';</code>. This was pointed out in a comment by @scohe001.</li>\n</ol>\n\n<p>Here's an updated version of the loop:</p>\n\n<pre><code>while ( N &gt; 0 ) {\n   rest = N%16;\n   if (rest &gt; 9){\n      arr[i] = 'A' + rest - 10;\n   }\n   else {\n      arr[i] = '0' + rest;\n   }\n   N = N/16;\n   i += i;\n}\n</code></pre>\n\n<p>You can make that still simpler by using the suggestion by @Jarod:</p>\n\n<pre><code>char const* hex_letters = \"0123456789ABCDEF\";\nwhile ( N &gt; 0 ) {\n   rest = N%16;\n   arr[i] = hex_letters[rest];\n   N = N/16;\n   i += i;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8685565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6e1ec970ed208691d7e9049ba409ee?s=128&d=identicon&r=PG&f=1", "display_name": "TomHardy", "link": "https://stackoverflow.com/users/8685565/tomhardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "closed_date": 1506546703, "accepted_answer_id": 46457226, "answer_count": 1, "score": -3, "last_activity_date": 1541861622, "creation_date": 1506543423, "last_edit_date": 1541861622, "question_id": 46456521, "link": "https://stackoverflow.com/questions/46456521/c-array-to-one-int-variable", "closed_reason": "Needs details or clarity", "title": "C++ Array to one Int variable", "body": "<p>I am curently working on one project, it's a converter... i am currently looking at Decimal to Hexadecimal. The code so far looks like this:</p>\n\n<pre><code>int rest;\nint arr[50];\nint i;\ncout &lt;&lt; N &lt;&lt; \" in decimal after conversation \";\nwhile (N&gt;0){\nrest=N%16;\nif (rest&gt;9){\n    switch (rest){\n    case 10:\n        arr[i]='A';\n        break;\n    case 11:\n        arr[i]='B';\n        break;\n    case 12:\n        arr[i]='C';\n        break;\n    case 13:\n        arr[i]='D';\n        break;\n    case 14:\n        arr[i]='E';\n        break;\n    case 15:\n        arr[i]='F';\n        break;\n    }\n}\nelse {\n    arr[i]=rest;\n}\nN=N/16;\ni+=i;\n}\ncout&lt;&lt;arr;\nreturn 1;\n</code></pre>\n\n<p>It's in function so dont be troubeled about the return 1...\nmy Question is:\nis there any way possible to pull the whole array (for example containig [4,2,K,8] into one single variable? In the same exact order!</p>\n\n<blockquote>\n  <p><em>EDIT</em></p>\n</blockquote>\n\n<p>aaaaaaaaaaaaaaaaaaaaaaaaaaand I'm back :D \ni made a few changes to the program and now it is working and it goes like this:</p>\n\n<pre><code>int DecToHex(long long N)       \n{\nint rest;                                           \nstring s=\"\";                   \nwhile (N&gt;0){                \nrest=N%16;            \nif (rest&gt;9){      \n    switch (rest){     \n    case 10:                \n        s=\"A\"+s;           \n        break;\n    case 11:\n        s=\"B\"+s;\n        break;\n    case 12:\n        s=\"C\"+s;\n        break;\n    case 13:\n        s=\"D\"+s;\n        break;\n    case 14:\n        s=\"E\"+s;\n        break;\n    case 15:\n        s=\"F\"+s;\n        break;\n        }\n}\nelse {\n    s = char(rest + 48) + s;\n    }\nN=N/16;\n}\n     if (s == \"\")\n         cout &lt;&lt; \"0\";\n     else\n         cout &lt;&lt; s;\nreturn 1;\n}\n</code></pre>\n\n<p>any idea how i could convert hexadecimal number to binary? the hexadecimal can be in string but the binary needs to be in    int.\nthe structure of the program shoud be simmiliar to the this one of mine. \nbud thnak's to everyone for the help! </p>\n"}, {"tags": ["c++", "linker", "tesseract", "codelite"], "comments": [{"owner": {"reputation": 959, "user_id": 888379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/14e6b3a51d70f73bfb9ff0c91046aa20?s=128&d=identicon&r=PG", "display_name": "user888379", "link": "https://stackoverflow.com/users/888379/user888379"}, "edited": false, "score": 0, "creation_date": 1506544275, "post_id": 46456445, "comment_id": 79869087, "body": "When you said &quot;both libs are there&quot; did you mean that the .lib files are in /usr/include? That might explain your problem, since presumably /usr/lib is the intended home."}, {"owner": {"reputation": 555, "user_id": 1334636, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f0ea7beb5bb56713cb4b182fc67eb302?s=128&d=identicon&r=PG", "display_name": "Xweque", "link": "https://stackoverflow.com/users/1334636/xweque"}, "reply_to_user": {"reputation": 959, "user_id": 888379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/14e6b3a51d70f73bfb9ff0c91046aa20?s=128&d=identicon&r=PG", "display_name": "user888379", "link": "https://stackoverflow.com/users/888379/user888379"}, "edited": false, "score": 0, "creation_date": 1506544352, "post_id": 46456445, "comment_id": 79869116, "body": "@user888379 Oh, no. Meant .h"}, {"owner": {"reputation": 555, "user_id": 1334636, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f0ea7beb5bb56713cb4b182fc67eb302?s=128&d=identicon&r=PG", "display_name": "Xweque", "link": "https://stackoverflow.com/users/1334636/xweque"}, "edited": false, "score": 0, "creation_date": 1506544585, "post_id": 46456445, "comment_id": 79869221, "body": "@BronislavElizavetin Edited post"}, {"owner": {"reputation": 555, "user_id": 1334636, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f0ea7beb5bb56713cb4b182fc67eb302?s=128&d=identicon&r=PG", "display_name": "Xweque", "link": "https://stackoverflow.com/users/1334636/xweque"}, "edited": false, "score": 0, "creation_date": 1506548027, "post_id": 46456445, "comment_id": 79870706, "body": "@BronislavElizavetin they&#39;re all in /usr/lib/"}, {"owner": {"reputation": 555, "user_id": 1334636, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f0ea7beb5bb56713cb4b182fc67eb302?s=128&d=identicon&r=PG", "display_name": "Xweque", "link": "https://stackoverflow.com/users/1334636/xweque"}, "edited": false, "score": 0, "creation_date": 1506548713, "post_id": 46456445, "comment_id": 79870970, "body": "@BronislavElizavetin Made edits answering your comment"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1508767728, "post_id": 46456445, "comment_id": 80729964, "body": "There are no references to <code>Magick::*</code> functions in your example code. Please post an accurate <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "owner": {"reputation": 555, "user_id": 1334636, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f0ea7beb5bb56713cb4b182fc67eb302?s=128&d=identicon&r=PG", "display_name": "Xweque", "link": "https://stackoverflow.com/users/1334636/xweque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 795, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506851855, "creation_date": 1506543096, "last_edit_date": 1506851855, "question_id": 46456445, "link": "https://stackoverflow.com/questions/46456445/tesseract-linking-issue", "title": "Tesseract Linking Issue", "body": "<p>I have an issue trying to run the very basic code example from the Tesseract GitHub. I don't know if it's my inability to express myself in searches queries or if I'm in too deep.</p>\n\n<p>I have the following code, copied and pasted from the API Example section on their page:</p>\n\n<pre><code>#include &lt;tesseract/baseapi.h&gt;\n#include &lt;leptonica/allheaders.h&gt;\n\nint main()\n{\n    char *outText;\n\n    tesseract::TessBaseAPI *api = new tesseract::TessBaseAPI();\n    // Initialize tesseract-ocr with English, without specifying tessdata path\n    if (api-&gt;Init(NULL, \"eng\")) {\n        fprintf(stderr, \"Could not initialize tesseract.\\n\");\n        exit(1);\n    }\n\n    // Open input image with leptonica library\n    Pix *image = pixRead(\"/usr/src/tesseract/testing/phototest.tif\");\n    api-&gt;SetImage(image);\n    // Get OCR result\n    outText = api-&gt;GetUTF8Text();\n    printf(\"OCR output:\\n%s\", outText);\n\n    // Destroy used object and release memory\n    api-&gt;End();\n    delete [] outText;\n    pixDestroy(&amp;image);\n\n    return 0;\n}\n</code></pre>\n\n<p>Running this produces the following error messages:</p>\n\n<pre><code>/home/xweque/Documents/home/docThor/main.cpp:8: undefined reference to `tesseract::TessBaseAPI::TessBaseAPI()'\n/home/xweque/Documents/home/docThor/main.cpp:16: undefined reference to `pixRead'\n/home/xweque/Documents/home/docThor/main.cpp:17: undefined reference to `tesseract::TessBaseAPI::SetImage(Pix*)'\n/home/xweque/Documents/home/docThor/main.cpp:19: undefined reference to `tesseract::TessBaseAPI::GetUTF8Text()'\n/home/xweque/Documents/home/docThor/main.cpp:23: undefined reference to `tesseract::TessBaseAPI::End()'\n/home/xweque/Documents/home/docThor/main.cpp:25: undefined reference to `pixDestroy'\n./Debug/main.cpp.o: In function `tesseract::TessBaseAPI::Init(char const*, char const*)':\n/usr/include/tesseract/baseapi.h:240: undefined reference to `tesseract::TessBaseAPI::Init(char const*, char const*, tesseract::OcrEngineMode, char**, int, GenericVector&lt;STRING&gt; const*, GenericVector&lt;STRING&gt; const*, bool)'\n</code></pre>\n\n<p>I'm using CodeLite 10 and <code>g++</code> as the compiler, officially supported. I'm using the following as my sole include path <code>/usr/include/</code>. Both .h are in there. I'm fairly certain it is a linking error since I've tried other code snippets, nothing official and nothing I've saved so not referenced but gives an indication.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p><code>g++</code> output:</p>\n\n<pre><code>/tmp/ccgCPJv6.o: In function `main':\nmain.cpp:(.text+0x38): undefined reference to `Magick::InitializeMagick(char const*)'\nmain.cpp:(.text+0x47): undefined reference to `Magick::Image::Image()'\nmain.cpp:(.text+0x84): undefined reference to `Magick::Image::read(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)'\nmain.cpp:(.text+0xcc): undefined reference to `Magick::Geometry::Geometry(unsigned int, unsigned int, unsigned int, unsigned int, bool, bool)'\nmain.cpp:(.text+0xe6): undefined reference to `Magick::Image::crop(Magick::Geometry const&amp;)'\nmain.cpp:(.text+0xf2): undefined reference to `Magick::Geometry::~Geometry()'\nmain.cpp:(.text+0x12f): undefined reference to `Magick::Image::write(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)'\nmain.cpp:(.text+0x15e): undefined reference to `Magick::Image::~Image()'\nmain.cpp:(.text+0x1bb): undefined reference to `Magick::Geometry::~Geometry()'\nmain.cpp:(.text+0x27b): undefined reference to `Magick::Image::~Image()'\n/tmp/ccgCPJv6.o:(.gcc_except_table+0x54): undefined reference to `typeinfo for Magick::Exception'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p><strong>EDIT 2</strong></p>\n\n<pre><code>xweque@LM-viktor /usr/lib $ ls -la /usr/lib | grep \"tesseract\"\n-rw-r--r--   1 root   root    6741822 Apr  8  2016 libtesseract.a\nlrwxrwxrwx   1 root   root         21 Apr  8  2016 libtesseract.so -&gt; libtesseract.so.3.0.4\nlrwxrwxrwx   1 root   root         21 Apr  8  2016 libtesseract.so.3 -&gt; libtesseract.so.3.0.4\n-rw-r--r--   1 root   root    3074104 Apr  8  2016 libtesseract.so.3.0.4\nxweque@LM-viktor /usr/lib $ ls -la /usr/lib | grep \"lept\"\n-rw-r--r--   1 root   root    4592626 Feb  4  2016 liblept.a\nlrwxrwxrwx   1 root   root         16 Feb  4  2016 liblept.so -&gt; liblept.so.5.0.0\nlrwxrwxrwx   1 root   root         16 Feb  4  2016 liblept.so.5 -&gt; liblept.so.5.0.0\n-rw-r--r--   1 root   root    2370000 Feb  4  2016 liblept.so.5.0.0\n</code></pre>\n\n<p>Full g++ command:</p>\n\n<pre><code>g++ -o main /home/xweque/Documents/home/docThor/main.cpp -I/usr/include/ -L/usr/lib/ -llept -ltesseract\n</code></pre>\n"}, {"tags": ["c++", "cmake", "executable", "macos-sierra"], "comments": [{"owner": {"reputation": 155, "user_id": 7153483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf1df704164b618c689c72c1745a64c?s=128&d=identicon&r=PG&f=1", "display_name": "camelCase", "link": "https://stackoverflow.com/users/7153483/camelcase"}, "edited": false, "score": 0, "creation_date": 1506541475, "post_id": 46455989, "comment_id": 79867646, "body": "Have you checked out <code>${CMAKE_BINARY_DIR}</code> already? Usually, the output is found in the same directory, you ran <code>cmake &lt;path&#47;to&#47;CMakeLists.txt&gt;</code> - except, you explicitely change it."}, {"owner": {"reputation": 452, "user_id": 5203369, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c4tyb3Rgy_E/AAAAAAAAAAI/AAAAAAAAAGU/yWbbayFY_20/photo.jpg?sz=128", "display_name": "Mads Marquart", "link": "https://stackoverflow.com/users/5203369/mads-marquart"}, "edited": false, "score": 0, "creation_date": 1506541483, "post_id": 46455989, "comment_id": 79867649, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18826789/cmake-output-build-directory\">CMake output/build directory</a>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1506541719, "post_id": 46455989, "comment_id": 79867770, "body": "Variable <code>CMAKE_ARCHIVE_OUTPUT_DIRECTORY</code> affects only on <i>static libraries</i>. For <b>executables</b> set <code>CMAKE_RUNTIME_OUTPUT_DIRECTORY</code>."}, {"owner": {"reputation": 1, "user_id": 8685395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e042769d4aabf8effac2e29bb03b1d0?s=128&d=identicon&r=PG&f=1", "display_name": "itsleo5", "link": "https://stackoverflow.com/users/8685395/itsleo5"}, "edited": false, "score": 0, "creation_date": 1506541991, "post_id": 46455989, "comment_id": 79867921, "body": "Thanks, the CMAKE_BINARY_DIRECTORY is not set (if I print it in a message, nothing is there) and I have also tried setting CMAKE_RUNTIME_OUTPUT_DIRECTORY but no effect."}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506542281, "post_id": 46455989, "comment_id": 79868071, "body": "Have you tried <code>message(STATUS &quot;Output: $&lt;TARGET_FILE:name_of_program&gt;&quot;)</code> (where <code>name_of_program</code> is the first thing in <code>add_executable</code>)?"}, {"owner": {"reputation": 1, "user_id": 8685395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e042769d4aabf8effac2e29bb03b1d0?s=128&d=identicon&r=PG&f=1", "display_name": "itsleo5", "link": "https://stackoverflow.com/users/8685395/itsleo5"}, "edited": false, "score": 0, "creation_date": 1506542939, "post_id": 46455989, "comment_id": 79868401, "body": "tried it - it only printed the excutable name (not sure if I did this right) the CMAKE_BINARY_DIR seems to be the build dir"}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506543770, "post_id": 46455989, "comment_id": 79868842, "body": "The <code>$&lt;TARGET_FILE:...&gt;</code> will give you the name of the file relative to <code>CMAKE_CURRENT_BINARY_DIR</code>. So <code>${CMAKE_CURRENT_BINARY_DIR}&#47;$&lt;TARGET_FILE:name_of_program&gt;</code> will be where the executable is built to. If you&#39;re so inclined, you can use <code>get_filename_component</code> (<a href=\"https://cmake.org/cmake/help/v3.9/command/get_filename_component.html\" rel=\"nofollow noreferrer\">cmake.org/cmake/help/v3.9/command/get_filename_component.ht&zwnj;&#8203;ml</a>) to give you the absolute path. But this is overkill -- the outputs are usually in whatever directory you ran <code>cmake</code> in."}, {"owner": {"reputation": 1, "user_id": 8685395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e042769d4aabf8effac2e29bb03b1d0?s=128&d=identicon&r=PG&f=1", "display_name": "itsleo5", "link": "https://stackoverflow.com/users/8685395/itsleo5"}, "edited": false, "score": 0, "creation_date": 1506544614, "post_id": 46455989, "comment_id": 79869235, "body": "Yes, that has been my experience too. Surprisingly here, although cmake/make say they did exactly that, the executable is nowhere to be found. I suspect MacOS may be &quot;eating&quot; it up but I am unsure."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1506585590, "post_id": 46455989, "comment_id": 79882499, "body": "Please, add <code>CMakeLists.txt</code> code (as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) into the question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8685395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e042769d4aabf8effac2e29bb03b1d0?s=128&d=identicon&r=PG&f=1", "display_name": "itsleo5", "link": "https://stackoverflow.com/users/8685395/itsleo5"}, "is_accepted": false, "score": 0, "last_activity_date": 1506640812, "creation_date": 1506640812, "answer_id": 46479639, "question_id": 46455989, "link": "https://stackoverflow.com/questions/46455989/cant-locate-c-executable-that-g-just-created/46479639#46479639", "title": "Can&#39;t locate c++ executable that g++ just created", "body": "<p>I think I have figured out the answer that took me VERY long time. The problem is the one little CMAKE_CXX_FLAG I had: <strong>\"-c\"</strong>. It should not be there at all. CMake (for unknown reasons) passes that flag on to the \"driver\" c++/g++ even during the linking phase causing the underlying compiler to be invoked instead of a linker and then the compiler complains BUT ONLY AS WARNINGS that it is getting all this non-sense like *.o files and -l flags. Linking never happens as a result and so executable is never generated. And on top of this, all this drama is hidden and never shown to the user unless one does make VERBOSE=1 and actually reads the last command and then tries to use the last command by themselves with -Wall or -Werror to reveal these compiler warnings that it is getting all these linker flags.</p>\n\n<p>I think this is a CMake bug but I am unsure. </p>\n"}], "owner": {"reputation": 1, "user_id": 8685395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e042769d4aabf8effac2e29bb03b1d0?s=128&d=identicon&r=PG&f=1", "display_name": "itsleo5", "link": "https://stackoverflow.com/users/8685395/itsleo5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506640812, "creation_date": 1506541243, "last_edit_date": 1506627740, "question_id": 46455989, "link": "https://stackoverflow.com/questions/46455989/cant-locate-c-executable-that-g-just-created", "title": "Can&#39;t locate c++ executable that g++ just created", "body": "<p>This is a baffling issue for me, will be glad if someone has an insight.</p>\n\n<p>I am tasked with converting an existing small c++ project that currently uses makefiles to one that is based on CMAKE. I am through the task, created CMakeLists.txt in all relevant folders and such. I then created a build folder inside the source tree and tried a build after running cmake. Everything builds correctly as it should (first builds 3 libs from other people's code, those are linked to this project's code etc.) and the status \"make\" command printed does show this. Finally, the command completes 100% with the last line saying <code>[100%] Built target XXXXX</code></p>\n\n<p>However, that target executable is nowhere to be found! I have tried explicitly setting <code>CMAKE_ARCHIVE_OUTPUT_DIRECTORY</code> to a directory in source (this is how we ideally want), some other folder, not setting it at all, etc. but to no avail. I create this executable using add_executable command and if I instead create a library from the same sources in the same location, the library (.a) gets created fine but I just cant seem to find this executable if I create it that make claims it built. </p>\n\n<p>If it helps, the same project, if built on Windows, creates the EXE fine and I can see/run it in the folder inside source if I so specify.</p>\n\n<p>(I am running g++/cmake on MacOS Sierra on the latest Macbook Pro that has SIP not turned off.)</p>\n\n<p>Here is my minimal CMakeLists. The external libnames are replaced with LLLL. They are external libs in LLLL.a format in the lib directory. </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.0)\nproject(my_exec C CXX)\ncmake_policy(SET CMP0010 NEW)\n\nset(CMAKE_MACOSX_RPATH TRUE)\n\nSET(ENABLE_WARNINGS TRUE)\n\nset(CMAKE_BUILD_TYPE Release)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -c -std=c++11 -w\")\n\n#Includes\ninclude_directories(SYSTEM ${CMAKE_SOURCE_DIR}/inc/)\n\n#External libs\nset (EXT_LIBS LLLL LLLL LLLL)\n\n#Where to find the libs above?\nlink_directories(${CMAKE_SOURCE_DIR}/lib/}) \n\n#Get all sources and headers\nfile(GLOB SOURCES ${CMAKE_SOURCE_DIR}/src/*.cpp)\n\n#Finally!\nadd_executable(my_exec ${SOURCES})\ntarget_link_libraries(my_exec ${EXT_LIBS})\n\nmessage(\"Target path should be ${CMAKE_BINARY_DIR}\")\n</code></pre>\n\n<p>Following is the cmake and build outputs and also find output which shows no exec</p>\n\n<pre><code>XXXX-MacBook-Pro:build XXXX$ rm -rf *\nXXXX-MacBook-Pro:build XXXX$ cmake ..\n-- The C compiler identification is AppleClang 9.0.0.9000037\n-- The CXX compiler identification is AppleClang 9.0.0.9000037\n-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc\n-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++\n-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\nTarget path should be /Users/XXXX/XXXX/XXXX/XXXX/build\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /Users/XXXX/XXXX/XXXX/XXXX/build\nXXXX-MacBook-Pro:build XXXX$ make -j34\nScanning dependencies of target my_exec\n[  9%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 18%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 27%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 36%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 45%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 54%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 72%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 72%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 81%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[ 90%] Building CXX object CMakeFiles/my_exec.dir/src/aaaa.cpp.o\n[100%] Linking CXX executable my_exec\n[100%] Built target my_exec\n\nXXXX-MacBook-Pro:build XXXX$ cd ..\nXXXX-MacBook-Pro:YYYY XXXX$ find . -name my*\n./build/CMakeFiles/my_exec.dir\n</code></pre>\n"}, {"tags": ["c++", "vector", "input", "output"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1506540915, "post_id": 46455881, "comment_id": 79867344, "body": "Why not add them all to the array, sort it, and peel off the first N?"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 2, "creation_date": 1506541937, "post_id": 46455881, "comment_id": 79867885, "body": "You push a value to vector when its length is 0 so your vector&#39;s length is maximally 1."}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 1, "creation_date": 1506541971, "post_id": 46455881, "comment_id": 79867902, "body": "Gotta get that rare use case for <code>std::partial_sort</code>!"}, {"owner": {"reputation": 21, "user_id": 8406047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5a957d1e655df39d1255aaadefe8fa?s=128&d=identicon&r=PG&f=1", "display_name": "thearabianbear", "link": "https://stackoverflow.com/users/8406047/thearabianbear"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1506543405, "post_id": 46455881, "comment_id": 79868650, "body": "Sleep deprivation has me not thinking straight. That makes this so much simpler. Thank you! @tadman"}], "answers": [{"tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": true, "score": 0, "last_activity_date": 1506547239, "creation_date": 1506547239, "answer_id": 46457414, "question_id": 46455881, "link": "https://stackoverflow.com/questions/46455881/max-numbers-in-a-list/46457414#46457414", "title": "Max numbers in a list", "body": "<p>Your output vector contains only a single number because of the implementation of <code>vectorAddCheck</code>. If the vector is empty you add an item, otherwise you either replace it or just skip the new item. So your vector will always contain a single object.</p>\n\n<p>You could fix it by changing the method to the following implementation:</p>\n\n<pre><code>vector&lt;long&gt; vectorAddCheck(vector&lt;long&gt; x, long value){\n    if(x.size() &lt; 2){\n        x.push_back(value);\n    }\n    else {\n        unsigned min = (x[0] &lt; x[1]) ? 0 : 1;\n        if (x[min] &lt; value){\n            x[min] = value;\n        }\n    }\n    return x;\n}\n</code></pre>\n\n<p>Though, a cleaner implementation is possible:</p>\n\n<pre><code>int main() {\n    long numLines, numOutputs, temp;\n    cin &gt;&gt; numLines &gt;&gt; numOutputs;\n\n    set&lt;long&gt; numbers;\n    for(int i = 0; i &lt; numLines; ++i){\n        cin &gt;&gt; temp;\n        numbers.insert(temp);\n    }\n\n\n    for (set&lt;long&gt;::reverse_iterator it = numbers.rbegin(); it != numbers.rend(); ++it)\n    {\n        cout &lt;&lt; *it &lt;&lt; endl;\n\n        --numOutputs;\n        if (numOutputs == 0) {\n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8406047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5a957d1e655df39d1255aaadefe8fa?s=128&d=identicon&r=PG&f=1", "display_name": "thearabianbear", "link": "https://stackoverflow.com/users/8406047/thearabianbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 46457414, "answer_count": 1, "score": 1, "last_activity_date": 1506547239, "creation_date": 1506540816, "question_id": 46455881, "link": "https://stackoverflow.com/questions/46455881/max-numbers-in-a-list", "title": "Max numbers in a list", "body": "<p>The first line has two values N and K. N is number of inputs following the initial line, and K is the number of max numbers being sought out.</p>\n\n<p>Example Input:</p>\n\n<p>5 2</p>\n\n<p>6</p>\n\n<p>7</p>\n\n<p>17</p>\n\n<p>11</p>\n\n<p>6</p>\n\n<p>(5 lines of inputs, 2 max values being sought)</p>\n\n<p>Example Output:</p>\n\n<p>17</p>\n\n<p>11</p>\n\n<p>For some reason I am only getting the first output but not the second one.</p>\n\n<pre><code>vector&lt;long&gt; vectorAddCheck(vector&lt;long&gt; x, long value){\n    if(x.empty()){\n        x.push_back(value);\n    }\n    else {\n        for(int i = 0; i &lt; x.size(); i++){\n            if(x[i] &lt; value){\n                x[i] = value;\n            }\n        }\n    }\n    return x;\n}\n\n\nint main() {\n    long numLines, numOutputs, temp;\n    vector&lt;long&gt; outputList = {};\n    cin &gt;&gt; numLines &gt;&gt; numOutputs;\n\n    for(int i = 0; i &lt; numLines; ++i){\n        cin &gt;&gt; temp;\n        outputList = vectorAddCheck(outputList, temp);\n    }\n\n    for(int i = 0; i &lt; outputList.size(); i++){\n        cout &lt;&lt; outputList[i] &lt;&lt; endl;;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "sparse-matrix", "linear-algebra", "intel-mkl"], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 5628078, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b03d3304e5f52a79bf0158423aae6f70?s=128&d=identicon&r=PG&f=1", "display_name": "mahmoud ayyad", "link": "https://stackoverflow.com/users/5628078/mahmoud-ayyad"}, "is_accepted": false, "score": 0, "last_activity_date": 1506622096, "creation_date": 1506622096, "answer_id": 46475705, "question_id": 46455800, "link": "https://stackoverflow.com/questions/46455800/using-the-intel-mkl-library-to-solve-linear-system-using-direct-solver-the-dss/46475705#46475705", "title": "using the intel mkl library to solve linear system using direct solver, the dss_create gives exception thrown", "body": "<p>I figured out the problem.\nThere was an mistake in some declaration in another class which affects this class I don't know why.</p>\n"}], "owner": {"reputation": 37, "user_id": 5628078, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b03d3304e5f52a79bf0158423aae6f70?s=128&d=identicon&r=PG&f=1", "display_name": "mahmoud ayyad", "link": "https://stackoverflow.com/users/5628078/mahmoud-ayyad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 748, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506622096, "creation_date": 1506540475, "question_id": 46455800, "link": "https://stackoverflow.com/questions/46455800/using-the-intel-mkl-library-to-solve-linear-system-using-direct-solver-the-dss", "title": "using the intel mkl library to solve linear system using direct solver, the dss_create gives exception thrown", "body": "<p>The following is a class in my code which solves FEM problem.</p>\n\n<p>The coefficient matrix of the linear system of equations is a sparse one so I am using the <a href=\"https://software.intel.com/en-us/mkl-developer-reference-c-direct-sparse-solver-dss-interface-routines#7C5F5C27-0E6D-4612-9460-E0F03A20DA83\" rel=\"nofollow noreferrer\">intel mkl direct solver for sparse matrices</a> to solve this system.</p>\n\n<p>The class is used to solve the linear system and I tried it before for a simple problem and it works well by comparing the results with matlab. I am sure that all the links are correct and the configuration is set to be x64</p>\n\n<pre><code>#pragma once\n#include &lt;iostream&gt;\n#include &lt;mkl.h&gt;\nusing namespace std;\n\nclass Solution\n{\nprivate:\n    int *row, *col, nelx, nely;\n    double *K, *b;\npublic:\n    Solution(double *x, double* xx, int* y, int* z, int ll, int nn) \n    {\n        K = x;\n        b = xx;\n        row = y;\n        col = z;\n        nelx = ll;\n        nely = nn;\n    }\n    double* f();\n};\n\ndouble* Solution::f()\n{\n    int n = (nelx + 1)*(nely + 1) * 2, m = 868, l=1;\n    double *sol = new double[n];\n    int *perm = new int[n];\n    _MKL_DSS_HANDLE_t handle;\n\n    MKL_INT opt = MKL_DSS_ZERO_BASED_INDEXING;\n    dss_create(handle, opt);\n\n    // dss_define_structure\n    opt = MKL_DSS_NON_SYMMETRIC;\n    dss_define_structure(handle, opt, row, n, n, col, m);\n\n    // dss_reorder\n    opt = MKL_DSS_AUTO_ORDER;\n    dss_reorder(handle, opt, perm);\n\n    // dss_factor_real, dss_factor_complex\n    opt = MKL_DSS_POSITIVE_DEFINITE;\n    dss_factor_real(handle, opt, K);\n\n    // dss_solve_real, dss_solve_complex\n    opt = MKL_DSS_REFINEMENT_ON;\n    dss_solve_real(handle, opt, b, l, sol);\n\n    return sol;\n}\n</code></pre>\n\n<p>When I use the class for the whole code it gives me the following message at the \"dss_create\" command:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x000000007750F7E7 (ntdll.dll) in top88_class.exe:\n  0xC0000005: Access violation reading location 0x00000E0111350228.</p>\n  \n  <p>If there is a handler for this exception, the program may be safely\n  continued.</p>\n</blockquote>\n"}, {"tags": ["android", "c++", "android-ndk", "android-gradle-plugin", "build.gradle"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1506588555, "post_id": 46455743, "comment_id": 79884517, "body": "Any particular readon for not using <code>externalNativeBuild</code>? (in which case you&#39;d specify the makefile with <code>android { externalNativeBuild { ndkBuild { path &quot;bla&#47;bla&#47;Android.mk&quot; } } }</code>"}, {"owner": {"reputation": 335, "user_id": 2255802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a5ebe83e1bd2d9942dda944c5aa004bf?s=128&d=identicon&r=PG", "display_name": "Yu-Chih", "link": "https://stackoverflow.com/users/2255802/yu-chih"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1506628197, "post_id": 46455743, "comment_id": 79909640, "body": "Hi externalNativeBuild will work. In my test externalNativeBuild use my Android.mk to compile. Thank you!"}], "owner": {"reputation": 335, "user_id": 2255802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a5ebe83e1bd2d9942dda944c5aa004bf?s=128&d=identicon&r=PG", "display_name": "Yu-Chih", "link": "https://stackoverflow.com/users/2255802/yu-chih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506540236, "creation_date": 1506540236, "question_id": 46455743, "link": "https://stackoverflow.com/questions/46455743/force-androidstudio-gradle-to-ndk-use-my-android-mk", "title": "Force AndroidStudio &amp; Gradle to ndk{} use my Android.mk?", "body": "<p>I am wondering if there is any to ask AndridStudio to use my own Android.mk file?</p>\n\n<p>I am asking this because my jni code is kind of massing up that inlcude source code of my other project (outside of the jni folder). I have managed it to work correctly by my own Android.mk file. However, after certain update, it seems Gradle's \"ndk {}\" will create their own version of Android.mk and ruin my project. </p>\n\n<p>For example, the following is the example of my jni code structure:</p>\n\n<pre><code>|- other_project/\n|   |- includes/\n|   |- other_code.cpp\n|\n|- android_project\n    |- app/src/main/\n                |- java/\n                |- jni/\n                    |- Android.mk\n                    |- Application.mk\n                    |- code.cpp\n</code></pre>\n\n<p>and my own Android.mk</p>\n\n<pre><code>// ... some other settings ...\nLOCAL_C_INCLUDES := \\\n    $(LOCAL_PATH) \\\n    $(LOCAL_PATH)/../../../../other_project/include/\nLOCAL_SRC_FILES := \\\n    ../../../../other_project/other_code.cpp \\\n    code.cpp\n</code></pre>\n\n<p>In my build.gradle:</p>\n\n<pre><code>ndk {\n        moduleName = \"xxxx\" // module for standalone processing\n        ldLibs \"log\"\n        stl \"stlport_shared\"\n        cFlags \"-DDEV_NDK=1 -v\"\n    }\n</code></pre>\n\n<p>I know this is using the other Android.mk (auto-generated based on the ndk setting) because some of my customized c flags (in my own Android.mk) is missing until I add the cFlags field in the ndk {}.</p>\n\n<p>So my question is: <strong>if there is any way I can force the ndk{} to use my Android.mk to build? or, how can I add a proper options in the ndk {} to generate a similar Android.mk that can include .cpp/.h files outside the jni folder?</strong></p>\n"}, {"tags": ["c++", "typechecking", "template-function"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540280, "post_id": 46455721, "comment_id": 79867028, "body": "Try to steer towards using <code>std::string</code> whenever you can. Bare, mutable character buffers are nothing but trouble."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540325, "post_id": 46455721, "comment_id": 79867047, "body": "Instead of using a template function, why not offer an implementation for <code>float</code> and one for <code>int</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540487, "post_id": 46455721, "comment_id": 79867130, "body": "I&#39;m trying to challenge myself to minimize the amount of code as much as possible. Why double the amount of code when I can put one check? I&#39;d use std::string but I end up at the same fault in the is_same check"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540618, "post_id": 46455721, "comment_id": 79867199, "body": "There&#39;s challenging yourself and there&#39;s missing the point of function overloading. Template functions aren&#39;t intended for this kind of use case. If the function you call to convert varies depending on the type you need to overload. Define functions that can handle the inputs you&#39;re expecting, don&#39;t have a catch-all that might catch garbage."}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506540643, "post_id": 46455721, "comment_id": 79867217, "body": "But you&#39;re also forgetting the cases where people specify <code>status</code> as something completely crazy like, say, a <code>std::vector&lt;std::map&lt;int, void*&gt;&gt;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540706, "post_id": 46455721, "comment_id": 79867252, "body": "@tadman they&#39;re used absolutely the same, just copied differently."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506540734, "post_id": 46455721, "comment_id": 79867272, "body": "@TravisGockel I&#39;m the one using them in my code, and I only read bool, int, float, double, and string/char from the ini file. No one will ever see my code :P"}, {"owner": {"reputation": 2487, "user_id": 5380314, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8924d6d1c2470b1d7c8190dc37ef517c?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Nasonov", "link": "https://stackoverflow.com/users/5380314/andrey-nasonov"}, "edited": false, "score": 0, "creation_date": 1506540741, "post_id": 46455721, "comment_id": 79867277, "body": "Templates are compile-time while you are trying to perform runtime check. Just create a function overload (template specialization)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540809, "post_id": 46455721, "comment_id": 79867301, "body": "@tempman You&#39;re making code that&#39;s overly ornate here, it&#39;s not a template problem. It&#39;s not even clear why you can&#39;t have a simple return type here that the caller can cast/convert/mangle as necessary."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506540933, "post_id": 46455721, "comment_id": 79867350, "body": "@tadman I have multiple variables I&#39;m reading from a config file, and this is the shortest way to read it. Setting a return would require me to retype hundreds of lines of code from just calling a function to setting some value to the return of that function"}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506540949, "post_id": 46455721, "comment_id": 79867366, "body": "@tempman: Your code still doesn&#39;t cover those cases -- why do you want to use <code>atof</code> to parse a <code>bool</code>, <code>int</code>, <code>string</code>, <code>char*</code> of arbitrary length, etc? Why <i>only</i> match mutable <code>char[]</code> of length <code>4</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506541011, "post_id": 46455721, "comment_id": 79867397, "body": "@tempman Arguably this code is a prime candidate for refactoring for a multitude of reasons. Why fossilize a bad design by doubling down on it? Fix it using function overloading. Refactor it later so that&#39;s not necessary. A return value is always going to be more understandable than passing in a mutable argument."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506541080, "post_id": 46455721, "comment_id": 79867436, "body": "At runtime, they&#39;ll automatically convert and any data I lose won&#39;t matter as round errors don&#39;t matter to the code. Char 4 is just to read the config version to make sure it&#39;s all formatted correctly to help specify reasons for failure when reading config. The version is currently 1.0 @TravisGockel"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506541193, "post_id": 46455721, "comment_id": 79867500, "body": "@tadman then I&#39;d need to check what I&#39;m reading as opposed to what I want to read. It&#39;d definitely make more sense, but my objective is to not have to rewrite every single variable being assigned"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "reply_to_user": {"reputation": 2487, "user_id": 5380314, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8924d6d1c2470b1d7c8190dc37ef517c?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Nasonov", "link": "https://stackoverflow.com/users/5380314/andrey-nasonov"}, "edited": false, "score": 0, "creation_date": 1506541268, "post_id": 46455721, "comment_id": 79867544, "body": "@AndreyNasonov Sounds like the correct answer as to why it won&#39;t compile - so regardless I&#39;ll just have to make a specialization. Please post it as a response so I can mark it as correct :)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506543331, "post_id": 46455721, "comment_id": 79868617, "body": "@tadman you can&#39;t overload functions based on return value. The OP&#39;s example uses an output parameter  and you can overload on that."}], "answers": [{"tags": [], "owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "is_accepted": true, "score": 2, "last_activity_date": 1506544617, "last_edit_date": 1506544617, "creation_date": 1506541578, "answer_id": 46456080, "question_id": 46455721, "link": "https://stackoverflow.com/questions/46455721/checking-datatypes-of-template-function/46456080#46456080", "title": "Checking Datatypes of Template Function", "body": "<p>Your code won't compile because an <code>if</code> statement is a runtime construct. Consider this code:</p>\n\n<pre><code>int foo(bool b)\n{\n    if (b)\n    {\n        // attempt to call a function that does not exist\n        function_that_does_not_exist();\n    }\n    else\n    {\n        return 1;\n    }\n}\n</code></pre>\n\n<p>You can talk to me all day about how <code>b</code> is <em>always</em> <code>false</code>, but the compiler still requires the code in the <code>true</code> case of the <code>if</code> block to compile. What's happening in your example for something like an <code>int</code> is this:</p>\n\n<pre><code>template&lt;&gt;\nvoid config::readConfig(char* setting, char* subsetting, int&amp; status) {\n    char temp[255];\n    if (!GetPrivateProfileStringA(setting, subsetting, nullptr, temp, 255, cfg)) {\n        error = true;\n    }\n\n    // if (std::is_same&lt;size, char [4]&gt;::value) {\n    if (false) {\n        sprintf_s(status, \"%s\", temp);\n    } else { status = atof(temp); }\n}\n</code></pre>\n\n<p>The compiler does not know how to make <code>sprintf_s</code> compile when <code>status</code> is an <code>int</code>.</p>\n\n<p>The solution is to use overloading:</p>\n\n<pre><code>template&lt;class size&gt;\nvoid config::readConfig(char * setting, char * subsetting, size &amp; status) {\n    char temp[255];\n    if (!GetPrivateProfileStringA(setting, subsetting, nullptr, temp, 255, cfg)) {\n        error = true;\n    }\n\n    status = atof(temp);\n}\n\ntemplate&lt;size_t N&gt;\nvoid config::readConfig(char* setting, char* subsetting, char (&amp;status)[N]) {\n    char temp[255];\n    if (!GetPrivateProfileStringA(setting, subsetting, nullptr, temp, 255, cfg)) {\n        error = true;\n    }\n\n    sprintf_s(status, \"%s\", temp);\n}\n</code></pre>\n\n<hr>\n\n<p>The thing you're looking for is usually referred to as <code>static_if</code> (similar to the D conditional compilation construct of a <a href=\"https://dlang.org/spec/version.html#staticif\" rel=\"nofollow noreferrer\">\"Static If Condition\"</a>). There is no support in C++17 and it isn't planned for C++2a (yet), but you can emulate it easily with the answer to <a href=\"https://stackoverflow.com/questions/37617677/\">this question</a>.</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\ntemplate &lt;typename T, typename F&gt;\nauto static_if(std::true_type, T t, F f) { return t; }\n\ntemplate &lt;typename T, typename F&gt;\nauto static_if(std::false_type, T t, F f) { return f; }\n\ntemplate &lt;bool B, typename T, typename F&gt;\nauto static_if(T t, F f) { return static_if(std::integral_constant&lt;bool, B&gt;{}, t, f); }\n\ntemplate &lt;class size&gt;\nvoid config::readConfig(char* setting, char* subsetting, size&amp; status)\n{\n    char temp[255];\n    if (!GetPrivateProfileStringA(setting, subsetting, nullptr, temp, 255, cfg))\n    {\n        error = true;\n    }\n\n    static_if&lt;std::is_same&lt;size, char [4]&gt;::value&gt;\n    (\n        [&amp;] (auto&amp; status) { sprintf_s(status, \"%s\", temp); },\n        [&amp;] (auto&amp; status) { status = atof(temp); }\n    )(status);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8685351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 46456080, "answer_count": 1, "score": 0, "last_activity_date": 1506544617, "creation_date": 1506540129, "last_edit_date": 1506540523, "question_id": 46455721, "link": "https://stackoverflow.com/questions/46455721/checking-datatypes-of-template-function", "title": "Checking Datatypes of Template Function", "body": "<p>I'm trying to make a function based on input Template. It reads a file.</p>\n\n<pre><code>template&lt;class size&gt; void config::readConfig(char * setting, char * subsetting, size &amp; status) {\n    char temp[255];\n    if (!GetPrivateProfileStringA(setting, subsetting, nullptr, temp, 255, cfg)) {\n        error = true;\n    }\n    if (std::is_same&lt;size, char [4]&gt;::value) {\n        sprintf_s(status, \"%s\", temp);\n    } else { status = atof(temp); }\n}\n</code></pre>\n\n<p>I'm basically just checking if the desired input is a char. If it is, then we'll copy the char read over, but if not, we'll copy the bool/int/float/double. Maybe I'm just using std::is_same incorrectly.</p>\n\n<p>My code won't compile because it doesn't look like it recognizes the check and seems like it always returns true.</p>\n"}, {"tags": ["c++", "std", "typetraits"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1506540002, "post_id": 46455614, "comment_id": 79866849, "body": "Somewhat related: <a href=\"https://stackoverflow.com/q/35652212/1896169\">stackoverflow.com/q/35652212/1896169</a>"}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 2, "creation_date": 1506540047, "post_id": 46455614, "comment_id": 79866881, "body": "I think you&#39;re asking how partial template specialization works. It&#39;s complicated, but this wiki is a decent overview: <a href=\"http://en.cppreference.com/w/cpp/language/partial_specialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/partial_specialization</a> . The short answer is <code>const int</code> is a closer match to <code>const T</code> than plain-old-<code>T</code>, so it is preferred."}, {"owner": {"reputation": 705, "user_id": 1057286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/vn0Mv.jpg?s=128&g=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/1057286/sanjay"}, "reply_to_user": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1506540639, "post_id": 46455614, "comment_id": 79867212, "body": "@TravisGockel Thanks for the link. I have read about the Template Specialization. But example I saw, use specialization for completely different type ( for e.g. int, float, short) but not with closely related types ( e.g. int and const int). Thanks for the info"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1506540938, "post_id": 46455614, "comment_id": 79867354, "body": "Of course there is a standard for it. An ISO standard to be exact. While the official publication is proprietary, the last drafts prior to publication are available to the public (and are nearly identical to the finished document)."}, {"owner": {"reputation": 726, "user_id": 7780772, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/51e914134e488de42999994a203e24ec?s=128&d=identicon&r=PG&f=1", "display_name": "quantik", "link": "https://stackoverflow.com/users/7780772/quantik"}, "edited": false, "score": 0, "creation_date": 1506544323, "post_id": 46455614, "comment_id": 79869103, "body": "On a related note you shouldn&#39;t really use <code>remove_const</code> in your code. 99 times out of 100, if you are then you&#39;re probably doing something wrong."}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1506540100, "creation_date": 1506540100, "answer_id": 46455713, "question_id": 46455614, "link": "https://stackoverflow.com/questions/46455614/how-does-stdremove-constt-work-internally/46455713#46455713", "title": "How does std::remove_const&lt;T&gt; work internally", "body": "<p>Specialization.</p>\n\n<p>The <code>const T</code> version is more specialized than the generic version (because if a type match <code>const T</code>, match the generic <code>T</code> also; <code>int</code> match <code>T</code> but not <code>const T</code>).</p>\n\n<p>The rule is that if a type match two or more versions, the compiler must choose the more specialized one.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 2, "last_activity_date": 1506540820, "last_edit_date": 1506540820, "creation_date": 1506540450, "answer_id": 46455795, "question_id": 46455614, "link": "https://stackoverflow.com/questions/46455614/how-does-stdremove-constt-work-internally/46455795#46455795", "title": "How does std::remove_const&lt;T&gt; work internally", "body": "<p>This is <em>not</em> two different versions of a template.  This is a single template (what you call the first version), with a specialization defined (what you call the second version).</p>\n\n<p>So when you use the template it always first finds the definition of the template, and then looks for preexisting specializations and instantiations of the template that match the type signature you are using.  If it finds a specialization (or instantiation) that matches, it uses that.  Only if there is no existing specialization or instantiation does it instatiate the template.</p>\n\n<p>So when you say <code>remove_const&lt;int&gt;</code> it matches the template, but does not match the specialization, so it instantiates the template.  <code>remove_const&lt;const int&gt;</code> matches the template and also matches the specialization, so it uses the specialization (which is also a template, so needs to be instantiated, but that is secondary).</p>\n\n<p>The thing that makes your \"second version\" a specialization rather than a new template is the <code>&lt;</code>..<code>&gt;</code> list after the name <code>remove_const</code>.</p>\n"}], "owner": {"reputation": 705, "user_id": 1057286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/vn0Mv.jpg?s=128&g=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/1057286/sanjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 1, "accepted_answer_id": 46455713, "answer_count": 2, "score": -3, "last_activity_date": 1506541515, "creation_date": 1506539747, "last_edit_date": 1506541515, "question_id": 46455614, "link": "https://stackoverflow.com/questions/46455614/how-does-stdremove-constt-work-internally", "title": "How does std::remove_const&lt;T&gt; work internally", "body": "<p><strong>Case 1</strong>\nThe possible implementation of std::remove_const is</p>\n\n<pre><code>template&lt; class T &gt; struct remove_const          { typedef T type; };\ntemplate&lt; class T &gt; struct remove_const&lt;const T&gt; { typedef T type; };\n</code></pre>\n\n<p>When i use them</p>\n\n<pre><code>std::remove_const&lt;int&gt; // use the first version\nstd::remove_const&lt;const int&gt; // use the second version\n</code></pre>\n\n<p><strong>Case 2</strong>\nIf i comment the second version</p>\n\n<pre><code>template&lt; class T &gt; struct remove_const          { typedef T type; };\n//template&lt; class T &gt; struct remove_const&lt;const T&gt; { typedef T type; };\n</code></pre>\n\n<p>And use them </p>\n\n<pre><code>std::remove_const&lt;int&gt; // use the first version\nstd::remove_const&lt;const int&gt; // use the first version\n</code></pre>\n\n<p>In the Case 1 , <strong>how does compiler decide to choose the second version for</strong> <strong>const int</strong> ?</p>\n"}, {"tags": ["c++", "variables", "static", "global"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1506539764, "post_id": 46455602, "comment_id": 79866708, "body": "It&#39;s legal C++. Whether or not it&#39;s &quot;correct&quot; depends on what one considers correct when asking."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1506539768, "post_id": 46455602, "comment_id": 79866713, "body": "It&#39;s legal to use, certainly."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 2, "creation_date": 1506539772, "post_id": 46455602, "comment_id": 79866718, "body": "Yes it&#39;s technically correct, but probably bad design."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506541679, "post_id": 46455602, "comment_id": 79867749, "body": "Generally global variables are a bad plan, so hopefully there&#39;s another way to accommodate this."}], "answers": [{"tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": true, "score": 0, "last_activity_date": 1506542092, "creation_date": 1506542092, "answer_id": 46456203, "question_id": 46455602, "link": "https://stackoverflow.com/questions/46455602/can-a-static-function-of-a-class-access-global-static-varaibles/46456203#46456203", "title": "Can a static function of a class access global static varaibles?", "body": "<p>Yes it is correct - there will be no symbol for isvalid, and other files will not be able to see it.  They can read it's current value by calling <code>abc::do_something()</code></p>\n\n<p>The member function does not need to be static.  All instances will be able to return the same current value of <code>isValid</code></p>\n\n<p>The normal way of hiding data in C++ is to make it private and static in the class...</p>\n\n<p>header file</p>\n\n<pre><code>class abc{\n    static bool isValid;  // can be seen, does not use space in an instance\npublic:\n    static bool do_something();\n\n}\n\n\n/*In other file */\nbool abc::isvalid=false; //global variable\n\nbool abc::do_something()\n{\n    return isValid;\n}\n</code></pre>\n"}], "owner": {"reputation": 120, "user_id": 5047664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fa1af55c2a5ef324582a885444abd17?s=128&d=identicon&r=PG&f=1", "display_name": "itsOkToAskStupidQus", "link": "https://stackoverflow.com/users/5047664/itsoktoaskstupidqus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 46456203, "answer_count": 1, "score": 0, "last_activity_date": 1506542092, "creation_date": 1506539672, "last_edit_date": 1506539944, "question_id": 46455602, "link": "https://stackoverflow.com/questions/46455602/can-a-static-function-of-a-class-access-global-static-varaibles", "title": "Can a static function of a class access global static varaibles?", "body": "<pre><code>/*In header file */\nclass abc{\npublic:\nstatic bool do_something();\n\n}\n\n/*In other file */\nstatic bool isvalid=false; //global variable\n\nbool abc::do_something()\n{\nreturn isValid;\n}\n</code></pre>\n\n<p>it is compiling fine.I want to know is it correct to use ?</p>\n"}, {"tags": ["c++", "c++11", "g++", "static-libraries", "standard-library"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1506545683, "post_id": 46455558, "comment_id": 79869794, "body": "Standard libraries are linked by default as far as I know."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1506545705, "post_id": 46455558, "comment_id": 79869804, "body": "Altough, If you want to statically link to it instead of dynamically, see this: <a href=\"https://stackoverflow.com/q/26103966/2104697\">stackoverflow.com/q/26103966/2104697</a>"}, {"owner": {"reputation": 769, "user_id": 1650630, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/kjCDJ.jpg?s=128&g=1", "display_name": "Adria Ciurana", "link": "https://stackoverflow.com/users/1650630/adria-ciurana"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1506546322, "post_id": 46455558, "comment_id": 79870064, "body": "The problem is that I am doing a wrapper of a code in C++ to be able to use it in C, in C I can not use the standard C++ libraries. The only way is to include inside the library the functions that I use from the standard library.  I do not have a program. To compile the code I should make a program and remove the g++ parameter &quot;-c&quot;, but if I do this I have to put the main function in the code. And then I can not use it as a library."}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1506765139, "post_id": 46455558, "comment_id": 79957384, "body": "Is the source you are compiling called library or library.c.  You should specify the filename with the extension."}], "answers": [{"tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": false, "score": 18, "last_activity_date": 1506763123, "creation_date": 1506763123, "answer_id": 46501394, "question_id": 46455558, "link": "https://stackoverflow.com/questions/46455558/compile-a-static-library-link-with-standard-library-static/46501394#46501394", "title": "Compile a static library link with standard library (static)", "body": "<blockquote>\n  <p>Is there any possibility of creating a static library by statically linking also standard libraries</p>\n</blockquote>\n\n<p>No, because you cannot link anything to a static library. You can link things only into\na file that is produced by the linker. Otherwise no linking is involved in its production.</p>\n\n<p>The linker can produce two kinds of files: programs and shared libraries. \nPrograms and shared libraries are similar: they're both composed of executable code\nthat the program loader can load into a process. They are <em>not</em> similar to a static\nlibrary. A static library is produced by the archiving program <code>ar</code>  and is just a\nbag of object files - an archive - from which the linker can extract the ones it\nneeds to complete the linkage of a program or shared library.</p>\n\n<p>A command like:</p>\n\n<pre><code>g++ -c library.cpp -static-libstdc++ -o library.o\n</code></pre>\n\n<p>just compiles <code>library.cpp</code> into <code>library.o</code> and ignores the linkage option <code>-static-libstdc++</code>\nbecause <code>-c</code> means <em>Just compile. Don't link</em>  </p>\n\n<p>Your real problem only comes to light in one of your later comments<sup>1</sup>:</p>\n\n<blockquote>\n  <p>The problem is that I am doing a wrapper of a code in C++ to be able to use it in C, \n  in C I can not use the standard C++ libraries. The only way is to include inside \n  the library the functions that I use from the standard library.</p>\n</blockquote>\n\n<p>Now since a <em>shared</em> library is something that the linker can produce, you can statically\nlink <code>libstdc++</code> into a shared library. So, instead of making your C wrapper library\na static library, you could make it a shared libary.</p>\n\n<p>It seems you already know how to wrap C++ code in a C API. So let's write such\na C wrapper that reverses the first N characters from an input buffer to an output buffer,\nusing the standard C++ library to do all the work:</p>\n\n<p><strong>reverse.h</strong></p>\n\n<pre><code>#ifndef REVERSE_H\n#define REVERSE_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid reverse(char const * in, char * out, unsigned len);\n\n#ifdef __cplusplus\n} // extern \"C\"\n#endif\n</code></pre>\n\n<p><strong>reverse.cpp</strong></p>\n\n<pre><code>#include \"reverse.h\"\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n\nextern \"C\" {\n\nvoid reverse(char const * in, char * out, unsigned len)\n{\n    std::string s{in,len};\n    std::reverse(s.begin(),s.end());\n    std::copy(s.begin(),s.end(),out);\n}\n\n} // extern \"C\"\n</code></pre>\n\n<p>Then a C program that calls <code>reverse</code>:</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;reverse.h&gt;\n\nint main()\n{\n    char in[] = \"dlrow olleH\";\n    reverse(in,in,sizeof(in) - 1);\n    puts(in);\n    return 0;\n}\n</code></pre>\n\n<p>Now we'll build our shared wrapper library.</p>\n\n<p>Compile our one library source file:</p>\n\n<pre><code>$ g++ -fPIC -Wall -Wextra -std=c++11 -c reverse.cpp\n</code></pre>\n\n<p>Notice <code>-fPIC</code>. All object files that we're going to link in a shared library\nmust be Position Independent Code. And as we're compiling one source file -\n<code>-c reverse.cpp</code> - we can skip the <code>-o</code> option and accept the default, <code>-o reverse.o</code> </p>\n\n<p>Then link our shared library:</p>\n\n<pre><code>$ g++ -shared -o libreverse.so reverse.o -static-libstdc++\n</code></pre>\n\n<p>Now the shared library is <code>./libreverse.so</code> and it has no runtime dependency\non <code>libstdc++</code>:</p>\n\n<pre><code>$ ldd libreverse.so \n    linux-vdso.so.1 =&gt;  (0x00007ffca98c9000)\n    libgcc_s.so.1 =&gt; /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007fa178862000)\n    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fa178498000)\n    /lib64/ld-linux-x86-64.so.2 (0x000055d17658c000)\n</code></pre>\n\n<p>Next compile our C program source file:</p>\n\n<pre><code>$ gcc -Wall -Wextra -I. -c main.c\n</code></pre>\n\n<p>And finally link the program with <code>libreverse</code>:</p>\n\n<pre><code>$ gcc -o prog main.o -L. -lreverse\n</code></pre>\n\n<p>This program <code>./prog</code> has a runtime dependency on the shared library <code>libreverse.so</code>.\nYou can't statically link with <code>libreverse.so</code> because it's not a static library.\nBut <code>libreverse.so</code> <em>has</em> been statically linked with <code>libstdc++.a</code>, and has\na C API.</p>\n\n<p>If <code>libreverse.so</code> was a serious library what we'd do now is is install it \none of the runtime loader's standard\nsearch directories, so that programs could load it automatically at runtime. We\ncould do that like:</p>\n\n<pre><code>$ sudo cp libreverse.so /usr/local/lib/\n$ sudo ldconfig\n</code></pre>\n\n<p>But since <code>libreverse.so</code> is just a toy library we won't modify our system for\nit.  Instead we'll just run <code>./prog</code> like:</p>\n\n<pre><code>$ export LD_LIBRARY_PATH=. # For now, tell the loader to look for libraries here\n$ ./prog\nHello world\n</code></pre>\n\n<p>So you can make a wrapper library with a C API and C++ internals, with <code>libstdc++</code>\nstatically linked, by making the wrapper library a <em>shared</em> library.</p>\n\n<p><strong>But why bother?</strong></p>\n\n<p>It seems that you want to bother because you believe that \"in C I can not use the standard C++ libraries\".</p>\n\n<p>That is a misconception. Here's how you can build the same program with a <em>static</em>\nwrapper library</p>\n\n<p>First make your static wrapper library</p>\n\n<pre><code>$ rm libreverse.so  # Better delete the old shared one just to avoid confusion.\n$ g++ -Wall -Wextra -std=c++11 -c reverse.cpp \n$ ar rcs libreverse.a reverse.o\n</code></pre>\n\n<p>Then compile your C source:</p>\n\n<pre><code>$ gcc -Wall -Wextra -I. -c main.c\n</code></pre>\n\n<p>At this point, you have an object file <code>main.o</code>, a static library <code>libreverse.a</code>\nthat contains (only) <code>reverse.o</code>, and to make <code>prog</code> you simply need to link <code>main.o</code>\nand <code>libreverse.a(reverse.o)</code> together with the standard C library and the standard C++\nlibrary. There is no question of <em>C not allowing you to do this</em>. You finished\nwith C when you compiled <code>main.c</code>. These object files and libraries will be \nlinked by your system linker, which will not know or care what language any of\nthem were compiled from.</p>\n\n<p>So you could invoke the linker via <code>g++</code>, like:</p>\n\n<pre><code>$ g++ -o prog main.o -L. -lreverse\n</code></pre>\n\n<p>and once more you have a program that does this:</p>\n\n<pre><code>$ ./prog\nHello world\n</code></pre>\n\n<p>Or you could invoke the linker via <code>gcc</code>, like:</p>\n\n<pre><code>$ gcc -o prog main.o -L. -lreverse -lstdc++\n</code></pre>\n\n<p>which is just the same linkage, with just the same result:</p>\n\n<pre><code>$ ./prog\nHello world\n</code></pre>\n\n<p>As you see, the one difference between linking via <code>g++</code> rather than <code>gcc</code> is that\n<code>g++</code> automatically adds both the standard C library and the standard C++ library\nto the linker's inputs, and <code>gcc</code> doesn't add the C++ library, so you have to\ndo it yourself.</p>\n\n<p>For that matter, if you happened to have GNU Fortran installed on your computer\nyou could do the same linkage with it:</p>\n\n<pre><code>$ $ gfortran -o prog main.o -L. -lreverse -lstdc++\n$ ./prog\nHello world \n</code></pre>\n\n<p>although nothing in <code>prog</code> was written in Fortran.</p>\n\n<p>C doesn't stop you from linking <code>libstdc++</code> with anything. A possible,\nbut unlikely, rational motive you might have for wishing to statically \nlink <code>libstdc++</code> into a <em>library</em> with a C API is that you want somebody else to \nbe able to link programs with this library on a system that doesn't have <code>libstdc++</code> or doesn't\nhave one that is <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"noreferrer\">ABI compatible</a> with yours. If that is your motivation, then \nmake your library a shared one as shown above. Otherwise, just link <code>libstdc++</code>\nwith any program that depends on it.</p>\n\n<p><hr>\n[1] On Stackoverflow, always state your <em>real</em> problem <em>in your question</em>.\nSee <a href=\"http://xyproblem.info/\" rel=\"noreferrer\">The XY Problem</a></p>\n"}], "owner": {"reputation": 769, "user_id": 1650630, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/kjCDJ.jpg?s=128&g=1", "display_name": "Adria Ciurana", "link": "https://stackoverflow.com/users/1650630/adria-ciurana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10282, "favorite_count": 4, "answer_count": 1, "score": 6, "last_activity_date": 1506763123, "creation_date": 1506539499, "last_edit_date": 1506541053, "question_id": 46455558, "link": "https://stackoverflow.com/questions/46455558/compile-a-static-library-link-with-standard-library-static", "title": "Compile a static library link with standard library (static)", "body": "<p>I'm trying to compile a static library (let's call it library.a). This library consumes resources of standard libraries. There is some way that the library can statically link a standard library.</p>\n\n<p>I have proven something like:</p>\n\n<pre><code>g++ -c library -static-libstdc++ -o library.o\nar rcs library.o library.a\n</code></pre>\n\n<p>But if I do so there is no link to the standard libraries.</p>\n\n<p>Then I have proved this way:</p>\n\n<pre><code>g++ library -static-stdlib -o library.o\nar rcs library.o library.a\n</code></pre>\n\n<p>But ask me to add a main function.</p>\n\n<p>Is there any possibility of creating a static library by statically linking also standard libraries (std :: string, std :: vector, std :: cin, etc ...).</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["c++", "memory", "malloc", "new-operator"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1506538205, "post_id": 46455186, "comment_id": 79865884, "body": "Have a look at <a href=\"http://en.cppreference.com/w/cpp/types/aligned_storage\" rel=\"nofollow noreferrer\">std::aligned_storage</a>."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506539353, "post_id": 46455186, "comment_id": 79866493, "body": "@Fran&#231;oisAndrieux: std::aligned_storage doesn&#39;t allocate memory"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 3, "creation_date": 1506539625, "post_id": 46455186, "comment_id": 79866640, "body": "@geza  That&#39;s true. The point of my comment was to suggest allocating instances of <code>std::aligned_storage</code> instead of raw memory. The example shows that we know the memory should be large enough to hold some number of objects of type <code>T</code>. It&#39;s the portable solution."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506539769, "post_id": 46455186, "comment_id": 79866715, "body": "@Fran&#231;oisAndrieux - <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">malloc</a> is defined to already allocate memory &quot;<i>suitably aligned for any built-in type</i>&quot;. Similarly, <code>operator new</code> is <a href=\"http://eel.is/c++draft/expr.unary#expr.new-11\" rel=\"nofollow noreferrer\">defined</a> as: &quot;<i>The pointer returned shall be suitably aligned so that it can be converted to a pointer of any complete object type</i>&quot;."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506539869, "post_id": 46455186, "comment_id": 79866779, "body": "@Fran&#231;oisAndrieux: I see. Now it is more clear what you wanted to say :)"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1506540244, "post_id": 46455186, "comment_id": 79867000, "body": "@Fran&#231;oisAndrieux: isn&#39;t <code>std::aligned_storage</code> mainly for non allocated things? Does <code>operator new</code> use information about the type it&#39;s allocating? For example, does it use alignment information when allocating the storage?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506540845, "post_id": 46455186, "comment_id": 79867316, "body": "@geza no operator new doesn&#39;t know what type it is allocating and so it can&#39;t return different alignments for different objects except based on what it knows from the size of the object (eg if all 8 byte objects need at most 8 byte alignment then it is free to  align to 8 in that case, even if larger object might need 16 byte alignment). In practice this means that new and malloc actually just always align to some &quot;big enough&quot; alignment which works for all types with standard alignment."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1506540940, "post_id": 46455186, "comment_id": 79867361, "body": "@BeeOnRope: yep, that&#39;s what I know about this too. So here, <code>std::aligned_storage</code> doesn&#39;t give us anything more than <code>new char[size];</code>, does it?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506542019, "post_id": 46455186, "comment_id": 79867935, "body": "@geza - I don&#39;t actually see how <code>std::aligned_storage</code> could be used to implement the <code>allocate()</code> function above at all, since you pass <code>Len</code> as a (compile-time) template argument, but <code>allocate</code> is taking a (runtime) function argument. In general, it seems like <code>std::aligned_storage</code> might give more guarantees than operator <code>new</code>: the former seems to guarantee that the storage is suitably aligned for <i>any</i> type with size up to <code>Len</code> (with the default <code>Align</code> value) while operator new only guarantees alignment for objects with  &quot;fundamental alignment.&quot;"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1506542246, "post_id": 46455186, "comment_id": 79868054, "body": "In practice though, I don&#39;t see how <code>std::aligned_storage</code> with default <code>Align</code> can satisfy it&#39;s &quot;any object&quot; guarantee in the presence of over-aligned types (which might live in other compilation units) since they could in principle have arbitrarily large alignments."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506547488, "post_id": 46455186, "comment_id": 79870499, "body": "@geza - I asked specifically about the <code>std::aligned_storage</code> behavior <a href=\"https://stackoverflow.com/questions/46457386/how-can-stdaligned-storage-expose-correctly-aligned-storage-for-any-object\">over here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1506541145, "creation_date": 1506541145, "answer_id": 46455958, "question_id": 46455186, "link": "https://stackoverflow.com/questions/46455186/which-one-is-the-most-idiomatic-way-to-allocate-uninitialized-memory-in-c/46455958#46455958", "title": "Which one is the most idiomatic way to allocate uninitialized memory in C++", "body": "<p>If at all possible, you should prefer to allocate memory in a type-safe way. If that's out of the question, prefer Option A, <code>operator new(size_t, std::nothrow)</code>  because:</p>\n\n<ul>\n<li>Operators <code>new</code> and <code>delete</code> can be overridden legally (this can be useful in custom allocator / leak detection scenarios).</li>\n<li>Can have an alternative allocator to deal with low memory (<code>set_new_handler</code>).</li>\n<li>Is much more C++.</li>\n</ul>\n\n<p>The only reason to prefer <code>malloc</code> / <code>free</code> is if you want to optimize <em>reallocations</em> with <code>realloc</code>, which isn't supported by <code>operator</code> <code>new</code> / <code>delete</code> (realloc is <a href=\"http://blog.httrack.com/blog/2014/04/05/a-story-of-realloc-and-laziness/\" rel=\"nofollow noreferrer\">not</a> a simple free+malloc).</p>\n"}], "owner": {"reputation": 761, "user_id": 7198015, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1045114908943982/picture?type=large", "display_name": "Jo&#227;o Pires", "link": "https://stackoverflow.com/users/7198015/jo%c3%a3o-pires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 46455958, "answer_count": 1, "score": 2, "last_activity_date": 1506541145, "creation_date": 1506538164, "last_edit_date": 1506539767, "question_id": 46455186, "link": "https://stackoverflow.com/questions/46455186/which-one-is-the-most-idiomatic-way-to-allocate-uninitialized-memory-in-c", "title": "Which one is the most idiomatic way to allocate uninitialized memory in C++", "body": "<p>Option A:</p>\n\n<p><code>T * address = static_cast&lt;T *&gt;(::operator new(capacity * sizeof(T), std::nothrow));</code></p>\n\n<p>Option B:</p>\n\n<p><code>T * address = static_cast&lt;T *&gt;(std::malloc(capacity * sizeof(T)));</code></p>\n\n<p>Context:</p>\n\n<pre><code>template &lt;typename T&gt;\nT * allocate(size_t const capacity) {\n    if (!capacity) {\n        throw some_exception;\n    }\n    //T * address = static_cast&lt;T *&gt;(std::malloc(capacity * sizeof(T)));\n    //T * address = static_cast&lt;T *&gt;(::operator new(capacity * sizeof(T), std::nothrow));\n    if (!address) {\n        throw some_exception;\n    }\n    return address;\n}\n</code></pre>\n\n<p><code>std::malloc</code> is shorter, but <code>::operator new</code> is clearly C++ and it's probably implemented in terms of <code>std::malloc</code>. Which one is better / more idiomatic to use in C++.</p>\n"}, {"tags": ["c++", "performance"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1506537962, "post_id": 46455086, "comment_id": 79865737, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array\" title=\"why is it faster to process a sorted array than an unsorted array\">stackoverflow.com/questions/11227809/&hellip;</a> ?"}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1506538051, "post_id": 46455086, "comment_id": 79865790, "body": "Are you using optimization flags when compiling?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 9, "creation_date": 1506538079, "post_id": 46455086, "comment_id": 79865799, "body": "Optimizer setting please. And have a read about &quot;branch prediction&quot;.  Writing meaningful benchmarks is both a skill and an art with modern CPUs: speculative execution. out of order instructions, branch prediction, 3 levels of cache etc."}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1506538804, "post_id": 46455086, "comment_id": 79866195, "body": "I really don&#39;t believe it is pure branch prediction case here. The loops seems to be equal - first and second should optimize to have the same time, and they don&#39;t... It appears to be some sort of compiling optimization."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1506539117, "post_id": 46455086, "comment_id": 79866357, "body": "I&#39;m almost sure optimization was off... With -O2 (and after fixing it so that the loops aren&#39;t optimized away) I&#39;m seeing opposite results."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1506545159, "post_id": 46455086, "comment_id": 79869540, "body": "A simple <code>if</code> statement consists of a compare instruction (which sets conditional status bits) followed by a conditional jump instruction.  The performance issue is that the processor has to change its instruction pointer if the jump is taken.  Since your loops are small, they will probably fit into the instruction cache and not need to be reloaded."}, {"owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "edited": false, "score": 0, "creation_date": 1506546161, "post_id": 46455086, "comment_id": 79869997, "body": "Thanks for the comments! Sorry, I forgot to add the compilation options. I have now edited them in. You are correct, I haven&#39;t used any compiler optimizations. Using the -O and -O2 flags, the results are consistent with what I&#39;d intuitively expect. This leaves me rather confused though. If all this depends on the type of optimizations the compiler performs, how can I know what to expect when thinking out the code?"}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 1, "creation_date": 1506546175, "post_id": 46455086, "comment_id": 79870003, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array\">Why is it faster to process a sorted array than an unsorted array?</a>"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1506555850, "post_id": 46455086, "comment_id": 79872973, "body": "&quot;Why was it happening when the optimizations were turned off&quot; The compiler still does basic optimizations even with all optimizations disabled. The flags merely control optimizations that are risky or slow. If an optimization is risk-free and fast, the compiler does it at all levels, including &quot;off&quot;."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1506555886, "post_id": 46455086, "comment_id": 79872980, "body": "Also, when you run the program multiple times, what&#39;s the deviation/variance?"}, {"owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "edited": false, "score": 1, "creation_date": 1506557229, "post_id": 46455086, "comment_id": 79873310, "body": "Running it 676 times, I got the following average values, by order, 0.257923, 0.292771 and 0.238236, with the standard deviations 0.001564, 0.002633 and  0.002267."}], "owner": {"reputation": 117, "user_id": 8384325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ztxC.jpg?s=128&g=1", "display_name": "Sermal", "link": "https://stackoverflow.com/users/8384325/sermal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506558299, "creation_date": 1506537831, "last_edit_date": 1506558299, "question_id": 46455086, "link": "https://stackoverflow.com/questions/46455086/c-if-branching-runs-faster-with-more-branches", "title": "C++ &#39;if&#39; branching: runs faster with more branches?", "body": "<p>EDIT: I know about failed branch predictions, that's the main reason that led me to ask this question. If there's more branches, I'd expect there to be more failed predictions. The first and second parts of my code are precisely the same, apart from an extra branch in the second part. This extra branch will always evaluate to <code>true</code>, but still requires the evaluation of i%2. Why is it faster? Compiler optimizations solve the issue, but a new one question arises. Why was it happening when the optimizations were turned off?</p>\n\n<p>Original post:\nI am trying to understand just how <code>if</code> and <code>else</code> statements affect the performance of my codes in C++. These are the parameters and code I've used:\nCompiler: <code>g++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609</code>\nCompilation: <code>g++ -Wall ifs_comparison.cpp -o ifs_comparison</code></p>\n\n<pre><code>int main(){\n    clock_t t; \n    int N = 100000000;\n    int even_odd[2];\n\n    // Using if statements and being stupid with the else statement.\n    // This uses more calculations than the ones that should be needed.\n    even_odd[0] = 0;\n    even_odd[1] = 0;\n    t = clock();\n    for(int i = 0; i &lt; N; i++){\n        if(i%2==0)\n            even_odd[0]++;\n        else\n        {\n            if(i%2==1)\n                even_odd[1]++;\n        }\n    }\n    t = clock() - t;\n    std::cout &lt;&lt; \"Using 'if' statements and being stupid with the 'else' statement.\\n\";\n    std::cout &lt;&lt; \"This took \" &lt;&lt; ((float)t)/CLOCKS_PER_SEC &lt;&lt; \"seconds\\n\";\n    std::cout &lt;&lt; \"Repeat the task but with a simpler 'else' statement\\n\";\n\n\n\n\n    // Using if statements but simplifying the else statement\n    // Reset the variables\n    even_odd[0] = 0;\n    even_odd[1] = 0;    \n    t = clock();\n    for(int j = 0; j &lt; N; j++)\n    {\n        if(j%2==0)\n            even_odd[0]++;\n        else\n            even_odd[1]++;\n    }   \n    t = clock() - t;\n    std::cout &lt;&lt; \"This took \" &lt;&lt; ((float)t)/CLOCKS_PER_SEC &lt;&lt; \"seconds\\n\";\n    std::cout &lt;&lt; \"Repeat the task but without 'if' statements\\n\";\n\n\n\n    // Not using 'if' statements\n    // Reset the variables\n    even_odd[0] = 0;\n    even_odd[1] = 0;\n    t = clock();    \n    for(int k = 0; k &lt; N; k++)\n            even_odd[k%2]++;\n    t = clock()-t;\n    std::cout &lt;&lt; \"This took \" &lt;&lt; ((float)t)/CLOCKS_PER_SEC &lt;&lt; \"seconds\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Using 'if' statements and being stupid with the 'else' statement.\nThis took 0.262272seconds\nRepeat the task but with a simpler 'else' statement\nThis took 0.294445seconds\nRepeat the task but without 'if' statements\nThis took 0.238543seconds\n</code></pre>\n\n<p>As expected, the part without <code>if</code> statements runs faster. So I thought I'd see just how much faster it'd be if I simplified the else statement by removing the evaluation <code>i%2</code>. To my surprise, it was actually slower! What's going on? Can someone point me to a good reference on just how these <code>if</code> and <code>else</code> statements work? </p>\n"}, {"tags": ["c++", "linked-list", "nested-lists", "doubly-linked-list"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1506537631, "post_id": 46455001, "comment_id": 79865569, "body": "You could argue that the best way is <code>std::list&lt;std::list&lt;std::string&gt;&gt;</code> for the general case."}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 3, "creation_date": 1506537673, "post_id": 46455001, "comment_id": 79865592, "body": "Consider making your list a template if you&#39;re committed on using your own implementation."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1506537731, "post_id": 46455001, "comment_id": 79865626, "body": "Not much to go on here, but an interesting problem. <code>string data;</code> should be replaced by <code>LinkedList sublist;</code> or similar, but you&#39;ll likely need to work around the circular dependency this would result in."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8062897, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/918d7b81d78579038332a5cde2db0850?s=128&d=identicon&r=PG&f=1", "display_name": "Zachary Collins", "link": "https://stackoverflow.com/users/8062897/zachary-collins"}, "edited": false, "score": 0, "creation_date": 1506622593, "post_id": 46456923, "comment_id": 79906682, "body": "How would you go about creating a list and then putting that list into the list of lists? I can&#39;t seem to figure out application of the objects."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 1, "user_id": 8062897, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/918d7b81d78579038332a5cde2db0850?s=128&d=identicon&r=PG&f=1", "display_name": "Zachary Collins", "link": "https://stackoverflow.com/users/8062897/zachary-collins"}, "edited": false, "score": 0, "creation_date": 1506622799, "post_id": 46456923, "comment_id": 79906795, "body": "Use <code>template</code> for the data type.  See my first example.  Use assignment operator. :-)  You may want to start using <code>std::list</code> instead of rolling your own."}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": true, "score": 0, "last_activity_date": 1506545051, "creation_date": 1506545051, "answer_id": 46456923, "question_id": 46455001, "link": "https://stackoverflow.com/questions/46455001/nested-doubly-linked-lists-in-c/46456923#46456923", "title": "Nested Doubly Linked Lists in C++", "body": "<p>Your node consists of data and links.</p>\n\n<p>You could insert a linked list as part of the data section:  </p>\n\n<pre><code>struct Node\n{\n  std::string Data\n  std::list&lt;/*...*/&gt; nested_list;\n  Node * previous;\n  Node * next;\n};\n</code></pre>\n\n<p>If you don't like using <code>std::list</code> you could go with this:  </p>\n\n<pre><code>struct Nested_Node\n{\n  Nested_Node * previous;\n  Nested_Node * next;\n  /* add data if necessary */\n};\n\nstruct Node\n{\n  std::string data;\n  Nested_Node * nested_head;\n  Nested_Node * nested_tail;\n  Node *        previous;\n  Node *        next;\n};\n</code></pre>\n\n<p>The above structures depend on how you want your nested linked list organized.  </p>\n\n<p>Each <code>Node</code> contains the head and tail of a linked list.  If you declare the nested list as a separate structure, you could replace the <code>Nested_Node</code> pointers with the list class.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8062897, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/918d7b81d78579038332a5cde2db0850?s=128&d=identicon&r=PG&f=1", "display_name": "Zachary Collins", "link": "https://stackoverflow.com/users/8062897/zachary-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 46456923, "answer_count": 1, "score": -1, "last_activity_date": 1506545051, "creation_date": 1506537514, "question_id": 46455001, "link": "https://stackoverflow.com/questions/46455001/nested-doubly-linked-lists-in-c", "title": "Nested Doubly Linked Lists in C++", "body": "<p>What is the best way to go about storing doubly linked lists inside of one doubly linked list? Preferably, I would like to use only one struct, like so:</p>\n\n<pre><code>struct node{\n    string data;\n    node* next = NULL;\n    node* prev = NULL;\n};\n</code></pre>\n\n<p>and use this to be able to store a doubly linked list inside of a doubly linked list to hold all of my doubly linked lists.</p>\n\n<p>I have an ordinary insert function, but that wouldn't work because the parameters are <code>(node*&amp; start, string data)</code>. So I've created another insertion method that attempts to store a doubly linked list into a node of a larger doubly linked list, but it gets cloudy from there. Any help would be appreciated. </p>\n"}, {"tags": ["c++", "casting"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1506537139, "post_id": 46454801, "comment_id": 79865284, "body": "if you are using polymorphism, you should specify the destructor of the base class as virtual - <code>virtual ~CBaseClass() = default;</code>. Also - read about <code>static_cast</code> and <code>dynamic_cast</code>"}, {"owner": {"reputation": 217, "user_id": 1774084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50caaf8e5b6670b3c64e695f79157d0?s=128&d=identicon&r=PG", "display_name": "Actarus", "link": "https://stackoverflow.com/users/1774084/actarus"}, "edited": false, "score": 2, "creation_date": 1506541955, "post_id": 46454801, "comment_id": 79867894, "body": "I suppose the second and third loops are inserting element in m_secondItem and m_thirdItem arrays respectively (not in m_firstItem as in your example). But if m_firstItem array contains only pointers on CFirstItem and m_secondItem pointers on CSecondItem and so on, why don&#39;t you have pointers of the good type CFirstItem* m_firstItem[5] etc... in which case you don&#39;t need any cast."}, {"owner": {"reputation": 163, "user_id": 4071670, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6d4dc2d8f1c4a0b4251eb604a46448eb?s=128&d=identicon&r=PG&f=1", "display_name": "Aniss Be", "link": "https://stackoverflow.com/users/4071670/aniss-be"}, "edited": false, "score": 0, "creation_date": 1506542098, "post_id": 46454801, "comment_id": 79867981, "body": "Yes you are right i will edit it..."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1506544801, "post_id": 46454978, "comment_id": 79869336, "body": "Since <code>m_firstItem[]</code> contains only <code>CFirstItem</code> pointers, the <code>dynamic_cast</code> should be replaced with <code>static_cast</code>. Same with the other arrays. Using <code>dynamic_cast</code> would make sense only if the arrays are merged together into a single array that can hold pointers to different derived types."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506545265, "post_id": 46454978, "comment_id": 79869597, "body": "@RemyLebeau, makes sense."}, {"owner": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 1, "creation_date": 1506545666, "post_id": 46454978, "comment_id": 79869788, "body": "@RSahu Actually, no. Not What RemyLebeau said but OP&#39;s example. It doesn&#39;t make sense to use an array of <code>CBaseClass*</code> pointers if you&#39;re only every going to use it for <code>CFirstItem*</code> pointers."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 1, "creation_date": 1506545884, "post_id": 46454978, "comment_id": 79869877, "body": "@n.caillou, we can only speculate why the OP chose to use an array of <code>CBaseClass*</code> and chose to store only pointers to objects of type <code>CFirstItem</code> in it. I see that they could have used an array of <code>CFirstItem*</code> and obviated the need for casting in the first place."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1506545516, "last_edit_date": 1506545516, "creation_date": 1506537434, "answer_id": 46454978, "question_id": 46454801, "link": "https://stackoverflow.com/questions/46454801/how-to-cast-array-of-base-class-pointer-to-derived-class/46454978#46454978", "title": "How to cast array of base class pointer to derived class", "body": "<pre><code>CFirstClass* wFirstClass = static_cast&lt;wFirstClass*&gt;(m_firstItem);\n</code></pre>\n\n<p>is wrong since <code>w_firstItem</code> decays to <code>CBaseClass**</code> in the above expression.</p>\n\n<p>You will be better off if you can design your program such that you don't need to cast. If you must cast, you will need to use <code>dynamic_cast</code>.</p>\n\n<pre><code>CFirstClass* wFirstClass = dynamic_cast&lt;CFirstClass*&gt;(m_firstItem[0]);\nif ( wFirstClass )\n{\n   // Use the pointer.\n}\nelse\n{\n   // Deal with other cases\n}\n</code></pre>\n\n<p>If you need to cast every pointer in <code>m_firstItem</code>, you need to use a loop.</p>\n\n<pre><code>for ( auto item : m_firstItem )\n{\n   CFirstClass* wFirstClass = dynamic_cast&lt;CFirstClass*&gt;(item);\n   if ( wFirstClass )\n   {\n      // Use the pointer.\n   }\n   else\n   {\n      // Deal with other cases\n   }\n}\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>@RemyLebeau makes a good point. You should use <code>dynamic_cast</code> only if <code>m_firstItem</code> holds pointers to different sub-types of <code>CBaseClass</code>. In your posted code, since it holds only pointers to <code>CFirstClass</code>, it's ok to use <code>static_cast</code> instead of <code>dynamic_cast</code>:</p>\n\n<pre><code>CFirstClass* wFirstClass = static_cast&lt;CFirstClass*&gt;(m_firstItem[0]);\n</code></pre>\n\n<p>The loop version can similarly use <code>static_cast&lt;CFirstClass*&gt;(item)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 0, "creation_date": 1506545686, "post_id": 46456816, "comment_id": 79869797, "body": "@n.caillou: If you type-cast a <code>CBaseClass*[]</code> array itself to a <code>CFirstClass*[]</code> array, the object pointers WILL NOT be correct. They will still be pointing at <code>CBaseClass</code> objects in memory, and will be <i>misinterpretted</i> as <code>CFirstClass</code> objects when accessed from the casted array. Think of what would happen if you have a <code>CBaseClass*</code> pointer misinterpreted as a <code>CFirstClass*</code> pointer and you try to access the <code>firstValue</code> member. It won&#39;t work, it will actually be accessing <code>CommonValue</code> instead (if you are lucky). You need a <i>proper</i> <code>CFirstClass*</code> pointer to a real <code>CFirstClass</code> object."}, {"owner": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 0, "creation_date": 1506546064, "post_id": 46456816, "comment_id": 79869947, "body": "Oh, I see. If VMT pointers were introduced in the middle of the hierarchy."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 0, "creation_date": 1506546510, "post_id": 46456816, "comment_id": 79870121, "body": "@n.caillou: the issue I have described has nothing to do with VMTs, which only apply to virtual methods, not to data members. Data members are just positive offsets from the start of the declaring class, and at negative offsets from derived classes. So having proper pointers to proper object types is important so the compiler can calculate the offsets correctly. Accessing <code>CommonValue</code> from a <code>CBaseClass*</code> pointer is different than accessing it from a <code>CFirstClass*</code> pointer. <code>firstValue</code> can&#39;t be accessed from a <code>CBaseClass*</code> pointer, only a <code>CFirstClass*</code> (or derived) pointer."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1070, "user_id": 6074306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd660b5800c023de3b30c914112f09c3?s=128&d=identicon&r=PG&f=1", "display_name": "n.caillou", "link": "https://stackoverflow.com/users/6074306/n-caillou"}, "edited": false, "score": 0, "creation_date": 1506546561, "post_id": 46456816, "comment_id": 79870140, "body": "@n.caillou: You need to read up on how polymorphic classes are actually laid out in memory, and how polymorphic pointers actually work."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1506544598, "creation_date": 1506544598, "answer_id": 46456816, "question_id": 46454801, "link": "https://stackoverflow.com/questions/46454801/how-to-cast-array-of-base-class-pointer-to-derived-class/46456816#46456816", "title": "How to cast array of base class pointer to derived class", "body": "<p>You can't simply type-cast an array of base pointers to an array of derived pointers.  The pointers will not be pointing at the correct addresses.  If you need an array of derived pointers, you have to create a separate array and type-cast the source items correctly, eg:</p>\n\n<pre><code>CFirstClass* wFirstClass[5];\nfor (int i = 0; i &lt; 5; ++i)\n    wFirstClass[i] = static_cast&lt;CFirstClass*&gt;(m_firstItem[i]);\n</code></pre>\n\n<p>Same with the other arrays:</p>\n\n<pre><code>CSecondClass* wSecondClass[10];\nfor (int i = 0; i &lt; 10; ++i)\n    wSecondClass[i] = static_cast&lt;CSecondClass*&gt;(m_secondItem[i]);\n</code></pre>\n\n<p></p>\n\n<pre><code>CThirdClass* wThirdClass[12];\nfor (int i = 0; i &lt; 12; ++i)\n    wThirdClass[i] = static_cast&lt;CThirdClass*&gt;(m_thirdItem[i]);\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4071670, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6d4dc2d8f1c4a0b4251eb604a46448eb?s=128&d=identicon&r=PG&f=1", "display_name": "Aniss Be", "link": "https://stackoverflow.com/users/4071670/aniss-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506545516, "creation_date": 1506536774, "last_edit_date": 1506542215, "question_id": 46454801, "link": "https://stackoverflow.com/questions/46454801/how-to-cast-array-of-base-class-pointer-to-derived-class", "title": "How to cast array of base class pointer to derived class", "body": "<p>How we could cast an Array of base class pointer to an array of derived class pointer. The following code show an simple example of what i'am trying to do :</p>\n\n<pre><code>class CBaseClass\n{\n    public :\n        int CommonValue;\n};\n\nclass CFirstItem : public CBaseClass\n{\n    public :\n        int firtValue;      \n};\n\nclass CSecondItem : public CBaseClass\n{\n    public :\n        int secondValue;        \n};\n\nclass CThirdItem : public CBaseClass\n{\n    public :\n        int thirdValue;     \n};\n\n\nclass Manager\n{\n    public :\n        Manager()\n        {\n            for (unsigned int index = 0; index &lt; 5; ++index)\n            {\n                m_firstItem[index] = new CFirstItem();\n            }\n            for (unsigned int index = 0; index &lt; 10; ++index)\n            {\n                m_secondItem[index] = new CSecondItem();\n            }\n            for (unsigned int index = 0; index &lt; 12; ++index)\n            {\n                m_thirdItem[index] = new CThirdItem();\n            }\n        }\n\n    private :\n        CBaseClass* m_firstItem[5];\n        CBaseClass* m_secondItem[10];   \n        CBaseClass* m_thirdItem[12];    \n};\n</code></pre>\n\n<p>My main question here is how could i cast from <code>CBaseClass</code> to an <code>CFirstClass</code> or <code>CSecondClass</code>, i tried </p>\n\n<pre><code>CFirstClass* wFirstClass = static_cast&lt;wFirstClass*&gt;(m_firstItem);\n</code></pre>\n\n<p>And that doesn't seems to work, there is any way to how this cast should be made ?</p>\n"}, {"tags": ["c++", "string", "binary-data"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1506536819, "post_id": 46454772, "comment_id": 79865105, "body": "Just use a direct representation of the decimal digits. Go through the binary digits and add and double (operations on decimal digits) as appropriate."}, {"owner": {"reputation": 35, "user_id": 4157726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z_U-OmRVjDo/AAAAAAAAAAI/AAAAAAAACO8/4PGqIu3of9M/photo.jpg?sz=128", "display_name": "quietsamurai98", "link": "https://stackoverflow.com/users/4157726/quietsamurai98"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1506536856, "post_id": 46454772, "comment_id": 79865134, "body": "Doesn&#39;t std::bitset require a predetermined number of bits at compile time? My class will have a varying number of bits, to conserve memory."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506536977, "post_id": 46454772, "comment_id": 79865200, "body": "Yeah, noticed I was looking at the problem wrong.  Would <a href=\"https://stackoverflow.com/questions/29210120/binary-string-to-hex-c\">this</a> work for you?"}, {"owner": {"reputation": 35, "user_id": 4157726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z_U-OmRVjDo/AAAAAAAAAAI/AAAAAAAACO8/4PGqIu3of9M/photo.jpg?sz=128", "display_name": "quietsamurai98", "link": "https://stackoverflow.com/users/4157726/quietsamurai98"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506537097, "post_id": 46454772, "comment_id": 79865267, "body": "@NathanOliver I think that question is about binary to hex, not binary to decimal."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506537448, "post_id": 46454772, "comment_id": 79865470, "body": "@quietsamurai98 Dang it.  Sorry again.  Not sure why I searched for hex"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1506537873, "post_id": 46454772, "comment_id": 79865689, "body": "Sadly I&#39;m not finding an old code I had made that does this exact thing. I wrote this basic &quot;bigint&quot; class in JavaScript that would handle virtually any integer number, and perform any arithmetic operation with it. It was so long ago I don&#39;t even remember how I did it."}], "answers": [{"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1506537439, "post_id": 46454959, "comment_id": 79865468, "body": "There are two general ways to convert from base A to base B. You can use base B to calculate the value of the base A spec. That&#39;s simple and efficient. Or you can use base A to calculate the base B digits, which involves inefficient division, and complexity. You&#39;ve chosen the inefficient and complex way."}, {"owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1506537684, "post_id": 46454959, "comment_id": 79865598, "body": "It&#39;s general and will work for arbitrary numbers of bits. As I wrote, optimization is left as an exercise..."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1506538554, "post_id": 46454959, "comment_id": 79866070, "body": "Also, appending data to the beginning of the string like that is very expensive. It would be cheaper to just append to the end, and then invert the whole string. You can also use <code>stringstream</code> instead of <code>string</code> so you don&#39;t have to create a temporary <code>string</code> object with <code>to_string</code> just to be able to insert it in the result. And instead of dividing by 10 you can divide by the highest power of 10 that fits in a regular int (I guess that would be 1000000000), and pad with leading zeros if <code>i &#47;= 1000000000 &gt; 0</code>."}], "tags": [], "owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1506537378, "creation_date": 1506537378, "answer_id": 46454959, "question_id": 46454772, "link": "https://stackoverflow.com/questions/46454772/convert-an-array-of-more-than-64-bits-to-a-base-10-string/46454959#46454959", "title": "Convert an array of more than 64 bits to a base-10 string", "body": "<p>Pseudo code:</p>\n\n<pre><code>string s;\nyour_bitlist_class i;\nif ( i &gt; 0 )\n{\n    while ( i &gt; 0 )\n    {\n        s.insert( 0, std::to_string( i % 10 ) );\n        i /= 10;   \n    }\n}\nelse\n{\n    s = \"0\";\n}\n</code></pre>\n\n<p>Optimization is left as an exercise for the reader.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 4157726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z_U-OmRVjDo/AAAAAAAAAAI/AAAAAAAACO8/4PGqIu3of9M/photo.jpg?sz=128", "display_name": "quietsamurai98", "link": "https://stackoverflow.com/users/4157726/quietsamurai98"}, "is_accepted": false, "score": 0, "last_activity_date": 1506727501, "last_edit_date": 1506727501, "creation_date": 1506547560, "answer_id": 46457471, "question_id": 46454772, "link": "https://stackoverflow.com/questions/46454772/convert-an-array-of-more-than-64-bits-to-a-base-10-string/46457471#46457471", "title": "Convert an array of more than 64 bits to a base-10 string", "body": "<p>EDIT: Please, do NOT use this code! It sucks! I ended up using binary division by 10 with remainder.</p>\n\n<p>Here's the algorithm I found that works well. It's not super efficient, but it gets the job done.</p>\n\n<pre><code>BigInt num_copy(this);\nstd::vector&lt;unsigned short&gt; digits;\ndigits.push_back(0);\nwhile(num_copy!=0){\n    num_copy--;\n    digits[0]++;\n    unsigned long long i = 0LL;\n    while(digits[i]==10){\n        if(digits.size()==(i+1LL)){\n            digits.push_back(0);\n        }\n        digits[i]=0;\n        i++;\n        digits[i]++;\n    }\n}\nstd::string outstr = \"\";\nfor(unsigned long long i=0LL; i &lt; digits.size(); i++){\n    outstr = std::to_string(digits[i]) + outstr;\n}\nreturn outstr;\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4157726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z_U-OmRVjDo/AAAAAAAAAAI/AAAAAAAACO8/4PGqIu3of9M/photo.jpg?sz=128", "display_name": "quietsamurai98", "link": "https://stackoverflow.com/users/4157726/quietsamurai98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 46454959, "answer_count": 2, "score": 0, "last_activity_date": 1506727501, "creation_date": 1506536644, "question_id": 46454772, "link": "https://stackoverflow.com/questions/46454772/convert-an-array-of-more-than-64-bits-to-a-base-10-string", "title": "Convert an array of more than 64 bits to a base-10 string", "body": "<p>I am trying to roll my own arbitrary size unsigned integer class, but I am having trouble finding a way to convert the <code>std::vector&lt;bool&gt;</code> I am using to store the bits into a base 10 string. Currently, my algorithm is</p>\n\n<pre><code>unsigned long long sum = 0LL;\nfor(unsigned long long i=0; i&lt;64LL &amp;&amp; i&lt;bit_list.size(); i++){\n    if(bit_list[i]){\n        sum |= 1LL &lt;&lt; i;\n    }\n}\nreturn std::to_string(sum);\n</code></pre>\n\n<p>However, this only works for numbers below 2^64, because of the limitations of <code>std::to_string</code> and the built in <code>unsigned long long</code>. How would I go about converting, a many bit unsigned int to a string representation of the base 10 conversion? Preferably, I would like the algorithm to be extendable to any number of bits.</p>\n"}, {"tags": ["c++", "algorithm", "heap"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1506536845, "post_id": 46454667, "comment_id": 79865127, "body": "Won&#39;t the largest element be in the front, making &#39;pop_back()&#39; incorrect?"}, {"owner": {"reputation": 57, "user_id": 7361200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca91852b464ee50991d7b2d9e14315a1?s=128&d=identicon&r=PG&f=1", "display_name": "cjlovering", "link": "https://stackoverflow.com/users/7361200/cjlovering"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1506538906, "post_id": 46454667, "comment_id": 79866246, "body": "Yes - thanks. My &#39;test&#39; had an extra pop_heap statement I didn&#39;t see."}], "answers": [{"tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": true, "score": 2, "last_activity_date": 1506540949, "creation_date": 1506540949, "answer_id": 46455911, "question_id": 46454667, "link": "https://stackoverflow.com/questions/46454667/single-heapify-call-when-removing-max-and-adding-a-new-element-c-stdmake-h/46455911#46455911", "title": "Single &#39;Heapify&#39; call when removing max and adding a new element c++ std::make_heap", "body": "<p>In a max heap created via <a href=\"http://en.cppreference.com/w/cpp/algorithm/make_heap\" rel=\"nofollow noreferrer\"><code>make_heap</code></a>, the maximum element will be on the front, and the appropriate way to remove it is with <a href=\"http://en.cppreference.com/w/cpp/algorithm/pop_heap\" rel=\"nofollow noreferrer\"><code>std::pop_heap</code></a>, period.</p>\n\n<p>A <code>pop_front</code> (not <code>pop_back</code> like you posit) would indeed remove the maximum element from the heap, but you are no longer guaranteed to have a heap. That is, popping the first element effectively moves the heaps <em>left</em> child into the root. If the <em>right</em> child was bigger, then the heap property is lost (and even if it worked for the first set of children, it may invalidate any subtree on account of the shift in the array).</p>\n\n<p>Additionally, if you're using a contiguous container like a <code>std::vector</code>, then a <code>pop_front</code> (calling <a href=\"http://en.cppreference.com/w/cpp/container/vector/erase\" rel=\"nofollow noreferrer\"><code>std::vector::erase</code></a> on <a href=\"http://en.cppreference.com/w/cpp/container/vector/begin\" rel=\"nofollow noreferrer\"><code>vector::begin</code></a>) has the misfortune to cost you O(N) time, which is much worse than the O(log N) complexity of <code>pop_heap</code>. </p>\n\n<p>The one scenario that you may (prematurely) optimize for is if you simply want to <em>swap</em> the maximum element with another element that is at least as big as the existing maximum element, or failing that, >= to the maximum element's largest child. In that case you may achieve O(1) complexity, but this is unlikely in the general case.</p>\n\n<p>It's better to just have two O(log N) operations. The function grows so slowly that there will hardly be a difference between 1000 and 1 million element heaps.</p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 0, "last_activity_date": 1531336237, "creation_date": 1531336237, "answer_id": 51292654, "question_id": 46454667, "link": "https://stackoverflow.com/questions/46454667/single-heapify-call-when-removing-max-and-adding-a-new-element-c-stdmake-h/51292654#51292654", "title": "Single &#39;Heapify&#39; call when removing max and adding a new element c++ std::make_heap", "body": "<p>What you are asking for is nearly an exact duplicate of the linked question in your post body.</p>\n\n<pre><code>// Precondition is that v is already a heap.\nint get_max_element_add_new (std::vector&lt;int&gt; &amp;v, int value) {\n    v.push_back(value);\n    std::pop_heap(v.begin(), v.end());\n    value = v.back();\n    v.pop_back();\n    return value;\n}\n</code></pre>\n\n<p>Since <code>pop_heap</code> will swap the first and last values, the <code>back</code> will contain the max that you want to remove.</p>\n"}], "owner": {"reputation": 57, "user_id": 7361200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca91852b464ee50991d7b2d9e14315a1?s=128&d=identicon&r=PG&f=1", "display_name": "cjlovering", "link": "https://stackoverflow.com/users/7361200/cjlovering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 46455911, "answer_count": 2, "score": 1, "last_activity_date": 1531336237, "creation_date": 1506536302, "last_edit_date": 1506541155, "question_id": 46454667, "link": "https://stackoverflow.com/questions/46454667/single-heapify-call-when-removing-max-and-adding-a-new-element-c-stdmake-h", "title": "Single &#39;Heapify&#39; call when removing max and adding a new element c++ std::make_heap", "body": "<p>Is it possible to pop the max, push a new element, and then call push_heap, maintaining the heap and only calling the bubble down algorithm once?</p>\n\n<pre><code>    // What I think is correct:\n    heap.push_back(new_element);\n    std::push_heap(heap.begin(), heap.end());\n    std::pop_heap(heap.begin(), heap.end());\n    heap.pop_back();\n\n    // What I hope is correct:\n    heap.pop_back();        \n    heap.push_back(new_element);\n    std::push_heap(heap.begin(), heap.end());\n</code></pre>\n\n<p>Is it 'safe' to remove the max and push a new element to a heap? I have tested it and it seems to be the case. Is there a reason I should not do this?</p>\n\n<p>Very related question:\n<a href=\"https://stackoverflow.com/questions/29662820/how-to-change-max-element-in-a-heap-in-c-standard-library\">How to change max element in a heap in C++ standard library?</a></p>\n"}, {"tags": ["c++", "operator-overloading", "c++17"], "comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1506604522, "post_id": 46454659, "comment_id": 79895254, "body": "this <a href=\"https://wandbox.org/permlink/h2NGXRT88q18q8m5\" rel=\"nofollow noreferrer\">could be a soultion</a>, but I don&#39;t like it, since it touches <code>std</code> name space."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "edited": false, "score": 0, "creation_date": 1506538595, "post_id": 46454850, "comment_id": 79866086, "body": "thanks, stupid me - accepted. However: do we need to pollute the namespace by inserting the stream operator into it, or give up here?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "edited": false, "score": 0, "creation_date": 1506539109, "post_id": 46454850, "comment_id": 79866351, "body": "@argonaut6x Adding new functions into namespace std is UB, so don&#39;t do that."}, {"owner": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "edited": false, "score": 0, "creation_date": 1506539430, "post_id": 46454850, "comment_id": 79866536, "body": "so we&#39;re giving up? No alternatives to make operator &lt;&lt; with std::pair working?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "edited": false, "score": 1, "creation_date": 1506539988, "post_id": 46454850, "comment_id": 79866837, "body": "@argonaut6x Don&#39;t use <code>std::pair</code>? Use a for loop instead of <code>copy</code> and <code>make_ostream_joiner</code>?"}, {"owner": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "edited": false, "score": 0, "creation_date": 1506579406, "post_id": 46454850, "comment_id": 79879069, "body": "well, I was asking for the reason why this did not work, and got a proper answer to that question. However, the suggestion to not use std::pair and / or running a loop instead of reusing stl code is counterproductive, imo."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1506581322, "post_id": 46454850, "comment_id": 79880030, "body": "but it works for me under <a href=\"https://wandbox.org/permlink/QuippPuOcgKe6k9g\" rel=\"nofollow noreferrer\">clang</a> and <a href=\"https://wandbox.org/permlink/5Pc0hvAojfSrzxwm\" rel=\"nofollow noreferrer\">gcc</a>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1506600137, "post_id": 46454850, "comment_id": 79892034, "body": "@MarekR Change your <code>#if 1</code> to <code>#if 0</code>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "edited": false, "score": 1, "creation_date": 1506600601, "post_id": 46454850, "comment_id": 79892352, "body": "@argonaut6x Those are the two options. Not sure why you consider that &quot;counterproductive.&quot;"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1506604580, "post_id": 46454850, "comment_id": 79895289, "body": "@Barry I&#39;ve missed that, sorry. Anyway this <a href=\"https://wandbox.org/permlink/h2NGXRT88q18q8m5\" rel=\"nofollow noreferrer\">could be a soultion</a>, but I don&#39;t like it, since it touches <code>std</code> name space."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1506600499, "last_edit_date": 1506600499, "creation_date": 1506536962, "answer_id": 46454850, "question_id": 46454659, "link": "https://stackoverflow.com/questions/46454659/stdexperimentalostream-joiner-and-stdpair/46454850#46454850", "title": "std::experimental::ostream_joiner and std::pair", "body": "<p>Somewhere inside of the implementation of <code>ostream_joiner</code>, there will be an attempt to something like:</p>\n\n<pre><code>os &lt;&lt; value;\n</code></pre>\n\n<p>where <code>os</code> is a <code>std::basic_ostream</code> and value is your <code>pair</code> type. In order to determine what to do for that <code>operator&lt;&lt;</code> call, we lookup all the overloads <code>operator&lt;&lt;()</code> visible at the point of definition of this template as well as as the overloads in the <em>associated namespaces</em> of the arguments (this is known as <a href=\"http://en.cppreference.com/w/cpp/language/adl\" rel=\"nofollow noreferrer\">argument-dependent lookup</a>). </p>\n\n<p>When you use <em>your</em> <code>struct pair</code>, the associated namespace of <code>pair</code> is <code>::</code>, so ADL will find your <code>::operator&lt;&lt;(std::ostream&amp;, pair const&amp;)</code>. This overload works, is chosen, everything is happy.</p>\n\n<p>When you use <code>std::pair</code>, the associated namespace of <code>pair</code> is <code>std</code> and there is no <code>operator&lt;&lt;()</code> that can be found that takes a <code>std::pair</code>. Hence the error. </p>\n\n<hr />\n\n<p>You could instead create your own type in your own namespace for which you can add an overloaded <code>operator&lt;&lt;</code>, this can be fully your own type (the way it is in the question) or you could inherit the one in <code>std</code>:</p>\n\n<pre><code>struct pair : std::pair&lt;string,string&gt; {\n    using std::pair&lt;string,string&gt;::pair;\n};\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp;, my_pair const&amp; ) {...}\n</code></pre>\n\n<p>Alternatively, you could just not use <code>make_ostream_joiner</code>. Could replace this:</p>\n\n<pre><code>std::copy(std::begin(pairs),\n      std::end(pairs),\n      std::experimental::make_ostream_joiner(std::cout, \", \"));\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>const char* delim = \"\";\nfor (auto const&amp; pair : pairs) {\n    std::cout &lt;&lt; delim &lt;&lt; pair; // now, our point of definition does include\n                                // our operator&lt;&lt;() declaration, we don't need ADL\n    delim = \", \";\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86654, "user_id": 102441, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cf1b41a0f134b54597bf8a618be7880f?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/102441/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1560042917, "creation_date": 1560042917, "answer_id": 56511273, "question_id": 46454659, "link": "https://stackoverflow.com/questions/46454659/stdexperimentalostream-joiner-and-stdpair/56511273#56511273", "title": "std::experimental::ostream_joiner and std::pair", "body": "<blockquote>\n  <p>Is it possible to make the stream operator work without polluting the std namespace?</p>\n</blockquote>\n\n<p>If you're willing to replace your <code>copy</code> with a <code>transform</code>, then yes - with <code>put_invocation</code> taken from <a href=\"https://stackoverflow.com/a/56511236/102441\">my answer here</a>, you can use:</p>\n\n<pre><code>std::transform(\n    std::begin(pairs), std::end(pairs),\n    std::experimental::make_ostream_joiner(std::cout, \", \"),\n    [](auto&amp; p) {\n        return put_invocation([&amp;p = p](auto&amp; os) {\n            // adl works just fine here\n            return os &lt;&lt; p;\n            // or `os &lt;&lt; p.first &lt;&lt; \"=\" &lt;&lt; p.second;`\n        });\n    }\n);\n</code></pre>\n\n<p>This should optimize to exactly the same code as the version that injects into the std namespace.</p>\n"}], "owner": {"reputation": 85, "user_id": 3149302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6987cbbdc4b3d59ad36cf98b51da2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "argonaut6x", "link": "https://stackoverflow.com/users/3149302/argonaut6x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 46454850, "answer_count": 2, "score": 4, "last_activity_date": 1560042917, "creation_date": 1506536275, "last_edit_date": 1592644375, "question_id": 46454659, "link": "https://stackoverflow.com/questions/46454659/stdexperimentalostream-joiner-and-stdpair", "title": "std::experimental::ostream_joiner and std::pair", "body": "<p>In c++17/g++7, there's finally the long missed ostream_joiner. It enables proper output to ostreams, separating collection elements with infix delimiters.</p>\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;experimental/iterator&gt;\n#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nusing string = std::string;\n#if 1\nstruct pair {\n    string first;\n    string second;\n};\n#else\nusing pair = std::pair&lt;string,string&gt;;\n#endif\n\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; lhs, const pair &amp;p) {\n    return lhs &lt;&lt; p.first &lt;&lt; &quot;=&quot; &lt;&lt; p.second;\n}\n\nint main()\n{\n    std::vector&lt;pair&gt; pairs = {{&quot;foo&quot;, &quot;bar&quot;}, {&quot;baz&quot;, &quot;42&quot;}};\n    std::copy(std::begin(pairs),\n          std::end(pairs),\n          std::experimental::make_ostream_joiner(std::cout, &quot;, &quot;));\n}\n</code></pre>\n<p>Whilst the code piece succesfully compiles and outputs ...</p>\n<pre><code>foo=bar, baz=42\n</code></pre>\n<p>... changing the #if 1 to a #if 0 in the snippet makes the compiler complaining about missing the proper shift operator:</p>\n<pre><code>main.cpp:29:70:   required from here\n/usr/local/include/c++/7.2.0/experimental/iterator:88:10: error: no match for \n'operator&lt;&lt;' (operand types are \n'std::experimental::fundamentals_v2::ostream_joiner&lt;const char*, char, \nstd::char_traits&lt;char&gt; &gt;::ostream_type {aka std::basic_ostream&lt;char&gt;}' and \n'const std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, \nstd::__cxx11::basic_string&lt;char&gt; &gt;')\n  *_M_out &lt;&lt; __value;\n</code></pre>\n<p>Does somebody have a clue why?</p>\n<h1>update</h1>\n<p>Barry has given the right answer to the question. It however does not solve the problem, and running a manual loop is not in the sense of reusing existing stl code, so the question gets extended to:</p>\n<p>Is it possible to make the stream operator work without polluting the std namespace?</p>\n"}, {"tags": ["c++", "visual-c++", "alignment", "memory-alignment"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1506543838, "post_id": 46454530, "comment_id": 79868875, "body": "Why not just shadow the element in the base class?  Are you trying to match some specific binary format?"}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1506606012, "post_id": 46454530, "comment_id": 79896347, "body": "@stark, what do you mean by shadow the element in the base class?"}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506606156, "post_id": 46454530, "comment_id": 79896456, "body": "@RemyLebeau, so you are saying use a has-a rather than a is-a relationship?  I&#39;ll give that a go."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506631795, "post_id": 46454530, "comment_id": 79911281, "body": "@Adrian: Your <code>old_t</code> struct itself is not byte-aligned, you are only byte-aligning the <code>internal</code> member of <code>new_t</code>. You are not taking into account that the compiler may be adding padding between <code>stuff</code> and <code>data</code>, or more likely adding padding after <code>data</code> to align the total size of <code>old_t</code>. So, <code>sizeof(old_t)</code> is likely not 5 like you are expecting, it may actually be 8+ instead, depending on the actual alignment. That extra padding would throw off your <code>&amp;extended.data[x] == &amp;internal.data[y]</code> calculations without affecting your <code>offsetof</code> calculations."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506696027, "post_id": 46454530, "comment_id": 79936875, "body": "@RemyLebeau, Hmmm, I see what you mean."}], "answers": [{"comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506622932, "post_id": 46472117, "comment_id": 79906876, "body": "Not my class to modify."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506696565, "post_id": 46472117, "comment_id": 79937223, "body": "Yeah, I&#39;ve tried that already.  That is why I posted this question.  <code>data</code> and <code>rest_of_data</code> are still not contiguous memory locations. :(  Also, your calculation <code>DATA_SIZE - sizeof(win32_struct)</code> is wrong."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506697054, "post_id": 46472117, "comment_id": 79937543, "body": "... unless you are referring to the actual size of the entire data structure, but then you&#39;ve introduced a potential -ve value as a dimension which will either cause an error or potentially a very large array.  This is also not as easy to understand as just specifying the size of the end array."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506703609, "post_id": 46472117, "comment_id": 79941337, "body": "I clarified in my 2nd comment.  It depends on what your <code>DATA_SIZE</code> is representing.  You appear to be representing the size of the entire structure, including the additional text."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506710117, "post_id": 46472117, "comment_id": 79944467, "body": "@Adrian: That is what your original code in your question is doing. <code>DATA_SIZE</code> is the full byte size of the derived struct data, including the base and derived fields together."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506971073, "post_id": 46472117, "comment_id": 80018707, "body": "Sorry, no. <code>rest_of_data[DATA_SIZE - 1]</code> is the size of the data - 1 character as it was already allocated in the base class."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506971107, "post_id": 46472117, "comment_id": 80018728, "body": "@Adrian that is exactly what I said in my last comment. Since <code>sizeof(char)</code> is always 1, and <code>DATA_SIZE</code> wants the combined size of the two fields acting together"}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506971271, "post_id": 46472117, "comment_id": 80018801, "body": "Um, what comment are you referring to?  You said in the answer you gave <code>rest_of_data[DATA_SIZE - sizeof(win32_struct)]</code>, not <code>rest_of_data[DATA_SIZE - 1]</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506971327, "post_id": 46472117, "comment_id": 80018827, "body": "@Adrian I changed it to <code>sizeof(win32_struct::data)</code> now"}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506971911, "post_id": 46472117, "comment_id": 80019121, "body": "Um, not quite correct either.  It is a member variable not a static member variable, so the syntax for what you are trying to do would be <code>sizeof(std::declval&lt;win32_struct&gt;().data)</code>.  In any case, this still doesn&#39;t work.  As I said before, the <code>data</code> and <code>rest_of_data</code> are not in contiguous addresses.  There&#39;s padding in between."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506972078, "post_id": 46472117, "comment_id": 80019183, "body": "Good that you are trying not to  assume the size of the extension char though."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506973273, "post_id": 46472117, "comment_id": 80019752, "body": "@Adrian: &lt;sigh&gt; <code>char rest_of_data[DATA_SIZE - (sizeof(win32_struct) - offsetof(win32_struct, data))];</code> takes alignment padding after <code>win32_struct::data</code> into account so the total <code>DATA_SIZE</code> consists of <code>win32_struct::data + padding + my_struct::rest_of_data</code>."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506974240, "post_id": 46472117, "comment_id": 80020244, "body": "Yes, I&#39;ve been down this route before too.  What would happen if <code>DATA_SIZE</code> is 3?  And even though you compensated for the padding, it still doesn&#39;t answer the original question.  Also note that even though I wrote an answer, I&#39;m not even going to accept that because it is also a workaround, not an answer to the question."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506975259, "post_id": 46472117, "comment_id": 80020796, "body": "@Adrian: how does this not answer the original question? If you specify <code>DATA_SIZE=3</code>, but the alignment padding is 2+, <code>rest_of_data</code> would have a size of 0 or even negative, which is undefined behavior, or at least a compiler error. You have to have SOME knowledge about the total size of <code>win32_struct</code> when specifying a value for <code>DATA_SIZE</code> so <code>rest_of_data</code> can be 1+ bytes in size. Otherwise, use <code>static_assert()</code> to ensure <code>DATA_SIZE</code> is not too small."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506976389, "post_id": 46472117, "comment_id": 80021369, "body": "Allowing <code>DATA_SIZE</code> to be less than a valid size is a bad idea in general.  Even if the structure is known, it shouldn&#39;t be allowed to put it into that state.  This, of course could be stopped with a <code>static_assert</code> and stating that such a value is invald because... yada yada yada.   Yet, your answer still doesn&#39;t answer the question of <code>How to align derived class members such that the first member comes immediately after the last member of the base class?</code>.  You are simply working around the problem not answering the question."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1506976974, "post_id": 46472117, "comment_id": 80021658, "body": "I did address that question, actually. By setting the alignment of <code>my_struct</code> to 1, <code>base</code> and <code>rest_of_data</code> are right up against each other without any padding between them. But the issue is that <code>win32_struct</code> itself may have its own inner padding after its <code>data</code> member, to align its total size to an even multiple of its alignment, and nothing you can do in your own code can change that size. Win32 API structs have a specific alignment at the OS layer, you can&#39;t change their alignments. So, all you can do is include that inner padding in your <code>DATA_SIZE</code> calculation"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1506973269, "last_edit_date": 1506973269, "creation_date": 1506610113, "answer_id": 46472117, "question_id": 46454530, "link": "https://stackoverflow.com/questions/46454530/how-to-align-derived-class-members-such-that-the-first-member-comes-immediately/46472117#46472117", "title": "How to align derived class members such that the first member comes immediately after the last member of the base class?", "body": "<p>The short answer is, you can't do what you are asking for.  The compiler is free to insert padding between <code>base_struct</code> and <code>my_struct</code> as it sees fit, and you can't tell it not to do so.</p>\n\n<p>If you are going to use templates anyway, consider passing a template parameter to specify the desired type of <code>data</code>, instead of using <code>char[1]</code>, eg:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct base_struct\n{\n    ...\n    T data;\n};\n</code></pre>\n\n<p>And then define types for <code>data</code> to use, eg:</p>\n\n<pre><code>template &lt;size_t DATA_SIZE&gt;\nstruct data_buffer\n{\n    char buffer[DATA_SIZE];\n};\n</code></pre>\n\n<p>Or, in C++11 and later:</p>\n\n<pre><code>template &lt;size_t DATA_SIZE&gt;\nusing data_buffer = char[DATA_SIZE];\n</code></pre>\n\n<p>Then you can use <code>base_struct&lt;data_buffer&lt;...&gt; &gt;</code>, eg:</p>\n\n<pre><code>template &lt;size_t DATA_SIZE&gt;\nstruct my_struct : base_struct&lt;data_buffer&lt;DATA_SIZE&gt; &gt;\n{\n};\n</code></pre>\n\n<p>Or, at the very least, specify the full size of <code>base_struct::data[]</code> as a template parameter:</p>\n\n<pre><code>template &lt;size_t DATA_SIZE&gt;\nstruct base_struct\n{\n    ...\n    char data[DATA_SIZE];\n};\n\ntemplate &lt;size_t DATA_SIZE&gt;\nstruct my_struct : base_struct&lt;DATA_SIZE&gt;\n{\n};\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong>:</p>\n\n<blockquote>\n  <p><code>base_struct</code> is not my struct. It is any number of struct that are part of the <code>WINAPI</code></p>\n</blockquote>\n\n<p>In that case, consider using a approach similar to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb775514.aspx\" rel=\"nofollow noreferrer\"><code>NMHDR</code></a> and its descendants (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb774773.aspx\" rel=\"nofollow noreferrer\"><code>NMLISTVIEW</code></a>, <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773411.aspx\" rel=\"nofollow noreferrer\"><code>NMTREEVIEW</code></a>, etc). Instead of <em>deriving</em> <code>my_struct</code> from <code>base_struct</code>, have <code>my_struct</code> <em>contain</em> a <code>base_struct</code> member.  Then you can byte-align an additional data member up against the end of the <code>base_struct</code> member:</p>\n\n<pre><code>struct win32_struct\n{\n  DWORD stuff;\n  char data[1];\n};\n\n#pragma pack(push, 1)\ntemplate &lt;size_t DATA_SIZE&gt;\nstruct my_struct\n{\n  win32_struct base;\n  char rest_of_data[DATA_SIZE - (sizeof(win32_struct) - offsetof(win32_struct, data))];\n};\n#pragma pack(pop)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1506700543, "last_edit_date": 1506700543, "creation_date": 1506699241, "answer_id": 46492298, "question_id": 46454530, "link": "https://stackoverflow.com/questions/46454530/how-to-align-derived-class-members-such-that-the-first-member-comes-immediately/46492298#46492298", "title": "How to align derived class members such that the first member comes immediately after the last member of the base class?", "body": "<p>Looks like the best I can do is to use a template struct with an anonymous union containing the old type and an anonymous struct with padding and the actual data.</p>\n\n<pre><code>template &lt;typename OLD_T, size_t DATA_START, size_t SIZE&gt;\nstruct new_t\n{\n    union\n    {\n        OLD_T internal;\n        struct\n        {\n            char  __declspec(align(1)) padding[DATA_START];\n            char  __declspec(align(1)) extended_data[SIZE];\n        };\n    };\n\n    operator OLD_T&amp;() { return internal; }\n    OLD_T* operator&amp;() { return &amp;internal; }\n};\n\nnew_t&lt;old_t, offsetof(old_t, data), 5&gt; object_with_5_char_array_at_end;\n</code></pre>\n\n<p>Here, <code>extended_data</code> is actually placed at the same location as <code>data</code>.  I could have placed it after it to answer this question as asked, but the anonymous struct really isn't used anyway, so I went with cleaner calculations.</p>\n\n<p>This doesn't use the <code>#pragma pack</code> so that the entire struct can be properly aligned for speed.  It's unfortunate that I have to have a level of indirection to access the original object, but at least I can define the conversion operator so I can at least pass this as if it was the original object type and addressof operator so I can get the address of the original type as the original type pointer.</p>\n\n<p>Too bad a union couldn't inherit from a struct to remove the extra layer of indirection.  Of course that could open up a whole other can of worms. :)</p>\n"}], "owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506973269, "creation_date": 1506535781, "last_edit_date": 1592644375, "question_id": 46454530, "link": "https://stackoverflow.com/questions/46454530/how-to-align-derived-class-members-such-that-the-first-member-comes-immediately", "title": "How to align derived class members such that the first member comes immediately after the last member of the base class?", "body": "<p>To start with, I'm using VC++ 2015 U3 and I am looking for an answer that is specific to that compiler.</p>\n<p>I have a struct that has a <code>char data[1]</code> as its last member, which is a placeholder for embedded data.  I'd like to make it cleaner to just derive a template struct from that which takes a <code>size_t</code> indicating how much data is after it.  Like so:</p>\n<pre><code>// This is a placeholder for any WINAPI structs that has this form\nstruct base_struct\n{\n  DWORD stuff;\n  char data[1];\n};\n\ntemplate &lt;size_t DATA_SIZE&gt;\nstruct my_struct : base_struct\n{\n  char rest_of_data[DATA_SIZE - 1];\n};\n</code></pre>\n<p>However, there is an alignment issue.  The <code>rest_of_data</code> is located 4 bytes away from <code>data</code> of the base class.  This is annoying.  I've tried to use <a href=\"https://msdn.microsoft.com/en-us/library/83ythb65.aspx\" rel=\"nofollow noreferrer\"><code>#pragma pack(push,1)</code>/<code>#pragma pack(pop)</code>, <code>__declspec(align(1))</code></a>, but I can't seem to get the derived data to immediately follow the base data.</p>\n<p>Perhaps I'm not using them correctly?  Is there a way of doing this?</p>\n<p>P.S., I already know I can do a lot of tricks to manage the memory and use <code>reinterpret_cast</code>, but I would like to see if this is a viable option first.</p>\n<p>P.P.S.  <code>base_struct</code> is not my struct.  It is any number of struct that are part of the <code>WINAPI</code>.  It is not up to me to update or modify it, that is why I am attempting to make something that I can build on top of the already defined structs for.</p>\n<h1>EDIT</h1>\n<p>I've attempted using the has-a rather than the is-a relationship, and I got something odd happening.  <code>offsetof()</code> is saying that the position is correct, but when I get the actual address position, it is aligned. <em>sigh</em></p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;windows.h&gt;\n\n#define report_success(x) (!(x) ? (void)0 : (void)(std::cout &lt;&lt; #x &lt;&lt; std::endl))\nint main()\n{\n    struct old_t\n    {\n        DWORD                      stuff;\n        CHAR                       data[1];\n    };\n    struct new_t\n    {\n        old_t __declspec(align(1)) internal;\n        char  __declspec(align(1)) extended_data[1];\n    };\n    new_t x;\n\n    ///////////////////////////////////////////////////////////////////////////// padded //////////// not padded /////\n    //////////////////////////////////////////////////////////////////////// should | actually || should | actually //\n    report_success(offsetof(new_t, extended_data) == sizeof(old_t) + 0);   //   T   |     T    ||    T   |     T    //\n    report_success(offsetof(new_t, extended_data) == sizeof(old_t) + 1);   //   F   |     F    ||    F   |     F    //\n    report_success(offsetof(new_t, extended_data) == sizeof(old_t) + 2);   //   F   |     F    ||    F   |     F    //\n    report_success(offsetof(new_t, extended_data) == sizeof(old_t) + 3);   //   F   |     F    ||    F   |     F    //\n    report_success(&amp;x.extended_data[0] == &amp;x.internal.data[1]);            //   T   |     F    ||    T   |     F    //\n    report_success(&amp;x.extended_data[0] == &amp;x.internal.data[2]);            //   F   |     F    ||    F   |     F    //\n    report_success(&amp;x.extended_data[0] == &amp;x.internal.data[3]);            //   F   |     F    ||    F   |     F    //\n    report_success(&amp;x.extended_data[0] == &amp;x.internal.data[4]);            //   F   |     T    ||    F   |     T    //\n    return 0;\n}\n</code></pre>\n<p>Expected output:</p>\n<pre><code>offsetof(new_t, extended_data) == sizeof(old_t) + 0\n&amp;x.extended_data[0] == &amp;x.internal.data[1]\n</code></pre>\n<p>Actual output:</p>\n<pre><code>offsetof(new_t, extended_data) == sizeof(old_t) + 0\n&amp;x.extended_data[0] == &amp;x.internal.data[4]\n</code></pre>\n<p><kbd><a href=\"http://rextester.com/SMZZF50497\" rel=\"nofollow noreferrer\">Demo</a></kbd></p>\n"}, {"tags": ["c++", ".net", "vb.net", "dll"], "answers": [{"comments": [{"owner": {"reputation": 17362, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 2, "creation_date": 1506540619, "post_id": 46454900, "comment_id": 79867200, "body": "Considering these facts: <b>1)</b> The parameter is called <code>buf</code> (which probably is short for <i>buffer</i>) <b>2)</b> The parameter is casted into an <code>unsigned char*</code> (which is usually mapped to a byte array) <b>3)</b> The function internally calls another function called <i>BDLL_Read <b>Block</b></i> -- ...I think that the parameter should at the very least be an array of some sort. If had to guess <code>BDLL_ReadBlock()</code> fills the <code>buf</code> &quot;array&quot; with the bytes read from (whatever)."}], "tags": [], "owner": {"reputation": 11547, "user_id": 832052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VA1xt.png?s=128&g=1", "display_name": "djv", "link": "https://stackoverflow.com/users/832052/djv"}, "is_accepted": true, "score": 0, "last_activity_date": 1506537173, "creation_date": 1506537173, "answer_id": 46454900, "question_id": 46454529, "link": "https://stackoverflow.com/questions/46454529/vb-net-error-value-of-type-ushort-cannot-be-converted-to-ushort-reading/46454900#46454900", "title": "VB.NET error &quot;Value of type &#39;Ushort&#39; cannot be converted to &#39;Ushort()&#39;&quot; reading two-dimensional array of bytes from a native C++ DLL", "body": "\n\n<p>The dll import function</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>..., ByVal params As UShort()\n</code></pre>\n\n<p>calls for a <code>UShort()</code> as the second argument, while the c++ has</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>..., unsigned short *buf)\n</code></pre>\n\n<p>Change the dll import to <code>UShort</code></p>\n"}, {"tags": [], "owner": {"reputation": 17362, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "is_accepted": false, "score": 0, "last_activity_date": 1506554377, "last_edit_date": 1506554377, "creation_date": 1506553151, "answer_id": 46458451, "question_id": 46454529, "link": "https://stackoverflow.com/questions/46454529/vb-net-error-value-of-type-ushort-cannot-be-converted-to-ushort-reading/46458451#46458451", "title": "VB.NET error &quot;Value of type &#39;Ushort&#39; cannot be converted to &#39;Ushort()&#39;&quot; reading two-dimensional array of bytes from a native C++ DLL", "body": "<p>After reading the question properly ( <em>:)</em> ) I think I understand what you're trying to do... The C++ function is expecting a byte array for its <code>buf</code> parameter, which is then filled with 256 bytes by the <code>BDLL_ReadBlock()</code> function.</p>\n\n<p>Why you have declared the parameter as <code>unsigned short*</code> rather than <code>unsigned byte*</code> I don't understand, since <code>BDLL_ReadBlock()</code> clearly expects the latter.</p>\n\n<p>Anyway, to fix the issue you would have to switch from a <em>two-dimensional array</em> to a <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/arrays/#BKMK_JaggedArrays\" rel=\"nofollow noreferrer\"><em><strong>jagged array</strong></em></a>. This is because they do different things:</p>\n\n<ul>\n<li>In a two-dimensional array you have all items laid out in a grid, pretty much like a fixed coordinate system:</li>\n</ul>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Array(3, 3):\n        0  1  2  3\n     0  A  B  C  D\n     1  E  F  G  H\n     2  I  J  K  L\n     3  M  N  O  P\n</code></pre>\n\n<ul>\n<li><p>However, a <em>jagged array</em> is an <em><strong>array of arrays</strong></em>, which means you have a set of columns and rows where the columns doesn't necessarily have to be of the same amount for every row:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Array(3)(3):\n     0   1   2   3\n 0  {A,  B,  C,  D}\n 1  {E,  F,  G,  H}\n 2  {I,  J,  K,  L}\n 3  {M,  N,  O,  P}\n\nArray(3)(x):\n     0   1   2   3   4\n 0  {A,  B}\n 1  {C,  D,  E,  F,  G}\n 2  {H,  I,  J}\n 3  {K}\n</code></pre></li>\n</ul>\n\n<p>The difference when accessing items is that in a 2D array you can only get <em><strong>ONE item</strong></em> at a time:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Array(1, 3) = H\n</code></pre>\n\n<p>...whereas in a jagged array you don't necessarily have to access <em>only one</em> item, but you can also reference an entire row:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Single item.\nArray(1)(3) = H\n\n'Entire row.\nArray(1) = {E, F, G, H}\n</code></pre>\n\n<hr>\n\n<p>Moving on...</p>\n\n<p>Since <code>BDLL_ReadBlock()</code> seems to expect an array of bytes you should change your C++ method to take one as well (if you have access to the source, that is):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>extern \"C\" BASICDLL_API int __stdcall My_Read_High_Speed_Data(unsigned char ptr, unsigned char *buf)\n{\n    return BDLL_ReadBlock(0x00300000 + ptr, buf);\n}\n</code></pre>\n\n<p>Then change the VB.NET declaration:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>&lt;DllImport(\"MyDll.dll\", CallingConvention:=CallingConvention.StdCall)&gt;\nPublic Function My_Read_High_Speed_Data(ByVal ptr As Byte, ByVal buf As Byte()) As Integer\nEnd Function\n</code></pre>\n\n<p>Finally, change your VB.NET array to a jagged one, instead of a 2D array:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim input_page_buffer(64 - 1)() As Byte\n'In VB.NET you specify the upper bound INDEX of an array, not how many items it should contain.\n'Thus \"Dim Array(64)\" creates an array of 65 items (since indexes are zero-based), and \"Dim Array(64 - 1)\" or \"Dim Array(63)\" creates an array of 64 items.\n</code></pre>\n\n<p>The only backside to this is that you must initialize the inner arrays of a jagged array separately:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For x = 0 To input_page_buffer.Length - 1\n    input_page_buffer(x) = New Byte(256 - 1) {}\nNext\n</code></pre>\n\n<p><strong>And finally</strong>, calling the function:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function poll()\n    Dim page_index As Byte = 1\n\n    'input_page_buffer(0) gives you the first 256-byte array.\n    Dim success As Integer = My_Read_High_Speed_Data(page_index, input_page_buffer(0))\n\n    ...\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>If you <strong>cannot</strong> change the source of the C++ code then just replace every <code>Byte(...)</code> in my code with <code>UShort(...)</code> and you should be good to go!</p>\n"}], "owner": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 46454900, "answer_count": 2, "score": 1, "last_activity_date": 1506554377, "creation_date": 1506535775, "last_edit_date": 1506536325, "question_id": 46454529, "link": "https://stackoverflow.com/questions/46454529/vb-net-error-value-of-type-ushort-cannot-be-converted-to-ushort-reading", "title": "VB.NET error &quot;Value of type &#39;Ushort&#39; cannot be converted to &#39;Ushort()&#39;&quot; reading two-dimensional array of bytes from a native C++ DLL", "body": "<p>I'm getting VB error:  \"Value of type 'Ushort' cannot be converted to 'Ushort()'\".</p>\n\n<p>I have a VB.NET windows app that calls a function in a native (C++) DLL, to read a specific 256 byte page from an array of the pages within the DLL.</p>\n\n<p>VISUAL-C++ declaration within the DLL source, of the function....</p>\n\n<pre><code>extern \"C\" BASICDLL_API int __stdcall My_Read_High_Speed_Data(unsigned char ptr, unsigned short *buf)\n{\n    return BDLL_ReadBlock(0x00300000 + ptr, (unsigned char *)buf);\n}\n</code></pre>\n\n<p>VB.NET Declaration of the function in the DLL................</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>&lt;DllImport(\"MyDll.dll\", CallingConvention:=CallingConvention.Cdecl, CharSet:=CharSet.Ansi)&gt;\nPublic Function My_Read_Parameters(ByVal board As Byte, ByVal params As UShort()) As Int32\nEnd Function\n</code></pre>\n\n<p>Declaration of the VB.NET buffer to hold the 64 pages of 256 bytes each, from DLL...............</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim input_page_buffer( 64, 256 ) As UInt16\n</code></pre>\n\n<p>VB.NET function to read the page from the DLL...................  </p>\n\n<pre><code>function poll()                         \n    dim page_index = 1\n    dim success = My_Read_High_Speed_Data( page_index, input_page_buffer(1, 1)  )\nend function\n</code></pre>\n"}, {"tags": ["c++", "cmake", "c++17", "clang++"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1506536237, "post_id": 46454326, "comment_id": 79864811, "body": "Did you try to set  <code>CXX_STANDARD_REQUIRED</code> to on?"}, {"owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1506536387, "post_id": 46454326, "comment_id": 79864879, "body": "Yes. No change unfortunately."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1506540827, "post_id": 46454326, "comment_id": 79867307, "body": "Can you please add the output of <code>message(&quot;CMAKE_CXX17_STANDARD_COMPILE_OPTION = ${CMAKE_CXX17_STANDARD_COMPILE_OPTION}&quot;)</code>? If it&#39;s <code>-std=c++1z</code> you can try <code>set(CMAKE_CXX17_STANDARD_COMPILE_OPTION &quot;-std=c++17&quot;)</code> (the <a href=\"https://clang.llvm.org/cxx_status.html#cxx17\" rel=\"nofollow noreferrer\">documentation</a> mentions a change to clang 5 which probably is not reflected yet in CMake)."}, {"owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "edited": false, "score": 0, "creation_date": 1506546068, "post_id": 46454326, "comment_id": 79869950, "body": "The ${CMAKE_CXX_STANDARD_COMPILE_OPTION} variable is empty when printed &quot;CMAKE_CXX17_STANDARD_COMPILE_OPTION =&quot;."}, {"owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "edited": false, "score": 0, "creation_date": 1506546160, "post_id": 46454326, "comment_id": 79869994, "body": "Using     set(CMAKE_CXX17_STANDARD_COMPILE_OPTION &quot;-std=c++17&quot;) does not seem to result in any observable change for me."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1506583541, "post_id": 46454326, "comment_id": 79881267, "body": "Strange. Can you please give more details about your environment? Which OS, IDE, ...?"}, {"owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "edited": false, "score": 0, "creation_date": 1506594680, "post_id": 46454326, "comment_id": 79888645, "body": "Using OSX Sierra. Not using an IDE. CMake is version 3.9.2. Compiler is Clang 5.0.0."}, {"owner": {"reputation": 1070, "user_id": 5232529, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-Y79GfOk6GSg/AAAAAAAAAAI/AAAAAAAAAC4/d9Pnt9T4rcI/photo.jpg?sz=128", "display_name": "Artalus", "link": "https://stackoverflow.com/users/5232529/artalus"}, "edited": false, "score": 1, "creation_date": 1511024455, "post_id": 46454326, "comment_id": 81689670, "body": "Same here. CMake 3.9.5, Clang 5.0.0, when checking compile_commands.json I always see that clang is called with <code>-std=gnu++1z</code> option"}], "owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1051, "favorite_count": 1, "answer_count": 0, "score": 6, "last_activity_date": 1506535019, "creation_date": 1506535019, "question_id": 46454326, "link": "https://stackoverflow.com/questions/46454326/unable-to-set-c-standard-c17-in-cmake-3-9-2", "title": "Unable to set c++ standard (c++17) in cmake 3.9.2", "body": "<p>When using cmake (3.9.2) the command:</p>\n\n<pre><code>set(CMAKE_CXX_STANDARD 17)\n</code></pre>\n\n<p>does not correctly add the flag -std=c++17.</p>\n\n<p>The macro __cplusplus expands to 199711. I also get errors with regards to c++11 features like initalization_lists.</p>\n\n<p>I am using clang++ 5.0.0. I would also like to be able to use clang-tidy from cmake via:</p>\n\n<pre><code>set(CMAKE_CXX_CLANG_TIDY \"clang-tidy;-checks=*\")\n</code></pre>\n\n<p>This only seems to be an issue after upgrading cmake from version 3.7.1.</p>\n\n<p>I can't seem to locate any documentation on a relevant change between the versions. Am I missing something? Do clang 5.0 and cmake 3.9.2 have some compatibility issues?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506537202, "post_id": 46454174, "comment_id": 79865317, "body": "Do you want to show the content of the cell while the mouse is on top? and where do you want to show it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8167852"}, "edited": false, "score": 0, "creation_date": 1506537431, "post_id": 46454174, "comment_id": 79865463, "body": "eyllanesc, i would like to show it like reference like in browser if it is possible  on the bottom of the cell"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506537889, "post_id": 46454174, "comment_id": 79865698, "body": "If you look at the browser that widget is similar to a QStatusBar, so that&#39;s what you could do, another option is to add a custom widget below the QTableWidget. Which one do you want?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506538218, "post_id": 46454174, "comment_id": 79865895, "body": "the answer is not simple, we can get the row and column, but getting the text will depend on the type of widget you want to get the text since the methods are different. You could tell me the widgets you use for each column."}, {"owner": {"reputation": 8160, "user_id": 1035613, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b4d6ce44848765d7b02e4309c9efe9bb?s=128&d=identicon&r=PG", "display_name": "Dmitry Sazonov", "link": "https://stackoverflow.com/users/1035613/dmitry-sazonov"}, "edited": false, "score": 0, "creation_date": 1506586726, "post_id": 46454174, "comment_id": 79883256, "body": "<code>v-&gt;model()-&gt;data( index, Qt::TextRole ).toString()</code>. Btw, read this: <a href=\"http://doc.qt.io/qt-5/model-view-programming.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/model-view-programming.html</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user8167852"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506537011, "creation_date": 1506534458, "last_edit_date": 1506537011, "question_id": 46454174, "link": "https://stackoverflow.com/questions/46454174/how-to-get-full-qtablewidget-cell-content-while-hovering-it", "title": "how to get full qtablewidget cell content while hovering it", "body": "<p>Do you have any ideas how to get full qtablewidget cell content while hovering it, the column size is smaller than content size so i would like to get all cell content while hovering the cell like we get link while hovering reference on Internet</p>\n\n<p><a href=\"https://i.stack.imgur.com/XPPPY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XPPPY.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/FMdY1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FMdY1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "opencv", "image-processing", "colors"], "comments": [{"owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 1, "creation_date": 1506537713, "post_id": 46454153, "comment_id": 79865613, "body": "This is not the correct way of matching color range. A good way of matching color range is to convert it to HSV color space. Provide your code where you achieve these colors and how are you using them, to determine best method."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1506555562, "post_id": 46454153, "comment_id": 79872923, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5906693/how-to-reduce-the-number-of-colors-in-an-image-with-opencv\">How to reduce the number of colors in an image with OpenCV?</a>"}, {"owner": {"reputation": 29472, "user_id": 4253437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/bcBpJ.jpg?s=128&g=1", "display_name": "CodeBender", "link": "https://stackoverflow.com/users/4253437/codebender"}, "reply_to_user": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1506567259, "post_id": 46454153, "comment_id": 79875540, "body": "@Zindarod Thanks, I suspected I needed to operate in a different color space. I did explore using HSV, but was able to assemble something based off of what Kamil posted using the Delta E algorithm to find the closest match for a color."}], "answers": [{"comments": [{"owner": {"reputation": 29472, "user_id": 4253437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/bcBpJ.jpg?s=128&g=1", "display_name": "CodeBender", "link": "https://stackoverflow.com/users/4253437/codebender"}, "edited": false, "score": 0, "creation_date": 1506567038, "post_id": 46455596, "comment_id": 79875501, "body": "Thanks, I was able to implement something just now using your suggestion that properly maps the colors."}], "tags": [], "owner": {"reputation": 698, "user_id": 8682088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ol8Oh.jpg?s=128&g=1", "display_name": "Kamil Szelag", "link": "https://stackoverflow.com/users/8682088/kamil-szelag"}, "is_accepted": true, "score": 4, "last_activity_date": 1506554705, "last_edit_date": 1506554705, "creation_date": 1506539641, "answer_id": 46455596, "question_id": 46454153, "link": "https://stackoverflow.com/questions/46454153/map-a-pixel-color-found-in-opencv-to-a-pre-determined-list-of-colors/46455596#46455596", "title": "Map a pixel color found in OpenCV to a pre-determined list of colors", "body": "<p>I think you should represent and compare colors in different color space. I suggest space, that represent human color perception. Therefore L*a*b color space will be the best.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Lab_color_space/\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Lab_color_space/</a></p>\n\n<p>Color distances in that coordinate space are represented by <em>delta e</em> value. You could find different standards for <em>delta e</em> below:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Color_difference#CIELAB_Delta_E.2A/\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Color_difference#CIELAB_Delta_E.2A/</a></p>\n\n<p>In order to change color space you have to use <code>cv::cvtColor()</code> method. Color conversion for single pixel is described below:</p>\n\n<p><a href=\"https://stackoverflow.com/a/35737319/8682088/\">https://stackoverflow.com/a/35737319/8682088/</a></p>\n\n<p>After calculating pixel coordinates in L*a*b space, you could easily calculate <em>delta e</em> and compare colors with any reference and pick the one with the smallest error.</p>\n"}], "owner": {"reputation": 29472, "user_id": 4253437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/bcBpJ.jpg?s=128&g=1", "display_name": "CodeBender", "link": "https://stackoverflow.com/users/4253437/codebender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 1, "accepted_answer_id": 46455596, "answer_count": 1, "score": 0, "last_activity_date": 1506567105, "creation_date": 1506534377, "last_edit_date": 1506567105, "question_id": 46454153, "link": "https://stackoverflow.com/questions/46454153/map-a-pixel-color-found-in-opencv-to-a-pre-determined-list-of-colors", "title": "Map a pixel color found in OpenCV to a pre-determined list of colors", "body": "<p>I have a scenario where I have obtained one or more colors from an image, but now I need to determine which one of my existing color options it is closest to.</p>\n\n<p>For example, I may have red(255,0,0), green(0,255,0) and blue(0,0,255) as my three choices, but the image may contain orange(255,165,0).</p>\n\n<p>What I need then is a way to determine which one of those three values I should choose as my output color to replace orange.</p>\n\n<p>One approach I have considered is to measure the range from those three values and see which one is the smallest &amp; select that color.</p>\n\n<p>Example:</p>\n\n<p><strong>orange -> red</strong></p>\n\n<pre><code>abs(255 - 255) = 0, abs(165 - 0) = 165, abs(0 - 0) = 0 \n0 + 165 + 0 = 165\n</code></pre>\n\n<p><strong>orange -> green</strong></p>\n\n<pre><code>abs(255 - 0) = 255, abs(165 - 255) = 90, abs(0 - 0) = 0\n255 + 90 + 0 = 345\n</code></pre>\n\n<p><strong>orange -> blue</strong></p>\n\n<pre><code>abs(255 - 0) = 255, abs(165 - 0) = 165, abs(0 - 255) = 255 \n255 + 165 + 255 = 675 \n</code></pre>\n\n<p>Under this approach, I would pick red.</p>\n\n<p>However, I am not sure if this is the best, or even a particularly valid, one so was wondering if there is something out there that is more accurate &amp; would scale better to an increased color pallete.</p>\n\n<p><em>Update</em> The reduction answer linked in here does not help as it reduces things across the board. I need the ability to link a broad range of colors to several specific options.</p>\n"}, {"tags": ["c++", "constructor", "compiler-errors", "most-vexing-parse"], "comments": [{"owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "edited": false, "score": 1, "creation_date": 1506534522, "post_id": 46454134, "comment_id": 79863915, "body": "You tried to specify the default value of x (in the Learn ctor) in the .cpp. You should instead define it in the header."}, {"owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "reply_to_user": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "edited": false, "score": 0, "creation_date": 1506534637, "post_id": 46454134, "comment_id": 79863965, "body": "@ZeroUltimax is correct about the default parameter, but the real reason the compiler is complaining is that it thinks you&#39;re trying to define a function named <code>Learn</code>. You can&#39;t call a constructor quite like you&#39;re trying to. You need to use <code>Learn some_name(x);</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1506535091, "post_id": 46454134, "comment_id": 79864209, "body": "[OT]: <code>Learn::Learn(int x=0)</code> is useless in your cpp, as the default value is only available in that cpp file. Remove it, or place it in your header."}], "answers": [{"comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1506535112, "post_id": 46454275, "comment_id": 79864223, "body": "Maybe better give it a name: <code>Learn tmp{x};</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1506535299, "post_id": 46454275, "comment_id": 79864320, "body": "@RustyX: That is no longer a temporary, and the print of <code>&quot;Destructor&quot;</code> will happen after the pause. Possibly using extra scope <code>{Learn tmp{x};}</code> if you want absolutely name it."}, {"owner": {"reputation": 292, "user_id": 6692365, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-5s2iBe1V27w/AAAAAAAAAAI/AAAAAAAAAzY/pIxxjTfkAxU/photo.jpg?sz=128", "display_name": "Osama Kawish", "link": "https://stackoverflow.com/users/6692365/osama-kawish"}, "edited": false, "score": 0, "creation_date": 1506551092, "post_id": 46454275, "comment_id": 79871800, "body": "@Jarod42 What&#39;s a temporary? Sorry, a little new to C++. Also, bit confused as to why the change in brackets made a difference here."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 8, "last_activity_date": 1539199582, "last_edit_date": 1539199582, "creation_date": 1506534817, "answer_id": 46454275, "question_id": 46454134, "link": "https://stackoverflow.com/questions/46454134/visual-c-no-default-constructor/46454275#46454275", "title": "Visual C++: No default constructor", "body": "<p>Parsing issue:</p>\n\n<pre><code>Learn(x);\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>Learn x;\n</code></pre>\n\n<p>You should use</p>\n\n<pre><code>Learn{x};\n</code></pre>\n\n<p>to build your temporary or</p>\n\n<pre><code>Learn some_name{x};\n//or\nLearn some_name(x);\n</code></pre>\n\n<p>if you want an actual object.</p>\n"}, {"tags": [], "owner": {"reputation": 292, "user_id": 6692365, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-5s2iBe1V27w/AAAAAAAAAAI/AAAAAAAAAzY/pIxxjTfkAxU/photo.jpg?sz=128", "display_name": "Osama Kawish", "link": "https://stackoverflow.com/users/6692365/osama-kawish"}, "is_accepted": false, "score": 0, "last_activity_date": 1506556253, "last_edit_date": 1506556253, "creation_date": 1506555449, "answer_id": 46458773, "question_id": 46454134, "link": "https://stackoverflow.com/questions/46454134/visual-c-no-default-constructor/46458773#46458773", "title": "Visual C++: No default constructor", "body": "<p>Okay, I figured out the problem I was having. I didn't realize that the call is done as part of an object assignment. The notation in C++ seems to be a bit different that way.</p>\n\n<p>So <code>Learn(x)</code> should be replaced with <code>Learn obj(x)</code> apparently.</p>\n\n<p>This notation is a little off from other programming languages where you can usually write <code>className(inputs) variableName</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 547, "user_id": 4955133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86cbc56bf6db8c370d9c9ea06050c0bd?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/4955133/jake"}, "is_accepted": false, "score": 0, "last_activity_date": 1539201707, "creation_date": 1539201707, "answer_id": 52747940, "question_id": 46454134, "link": "https://stackoverflow.com/questions/46454134/visual-c-no-default-constructor/52747940#52747940", "title": "Visual C++: No default constructor", "body": "<p>I had similar code and came up with a different errors because I was compiling with Linux in a terminal. My errors were:</p>\n\n<pre><code>error: conflicting declaration 'myObject str' \nerror: 'str' has a previous declaration as 'const string  str'\n</code></pre>\n\n<p>when I tried <code>myObject(str);</code></p>\n\n<p>Sure <code>Learn{x};</code> (and in my case <code>myObject{str};</code>) will successfully compile, but it creates a temporary object, then destroys it in the same line.</p>\n\n<p>This is not what I wanted to do. So an alternative solution is to create a new object like:</p>\n\n<p><code>Learn var_name = new Learn(x);</code> </p>\n\n<p>This way you can reference it for future use. </p>\n"}], "owner": {"reputation": 292, "user_id": 6692365, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-5s2iBe1V27w/AAAAAAAAAAI/AAAAAAAAAzY/pIxxjTfkAxU/photo.jpg?sz=128", "display_name": "Osama Kawish", "link": "https://stackoverflow.com/users/6692365/osama-kawish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "accepted_answer_id": 46454275, "answer_count": 3, "score": 2, "last_activity_date": 1539201707, "creation_date": 1506534318, "last_edit_date": 1506534923, "question_id": 46454134, "link": "https://stackoverflow.com/questions/46454134/visual-c-no-default-constructor", "title": "Visual C++: No default constructor", "body": "<p>I've looked at a couple other questions asking this, but mine seems to be a lot simpler of a case then the ones I've been through, so I'll ask my case for this.</p>\n\n<p>Learn.h:</p>\n\n<pre><code>#ifndef LEARN_H\n#define LEARN_H\n\nclass Learn\n{\npublic:\n    Learn(int x);\n    ~Learn();\n\nprivate:\n    const int favourite;\n};\n\n#endif\n</code></pre>\n\n<p>Learn.cpp:</p>\n\n<pre><code>#include \"Learn.h\"\n#include &lt;iostream&gt;\nusing namespace std;\n\nLearn::Learn(int x=0): favourite(x)\n{\n    cout &lt;&lt; \"Constructor\" &lt;&lt; endl;\n}\n\nLearn::~Learn()\n{\n    cout &lt;&lt; \"Destructor\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Source.cpp:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Learn.h\"\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"What's your favourite integer? \"; \n    int x; cin &gt;&gt; x;\n    Learn(0);\n\n    system(\"PAUSE\");\n}\n</code></pre>\n\n<p>The above code in itself does not output any error. </p>\n\n<p>However, I do get a couple errors after I replace <code>Learn(0)</code> with <code>Learn(x)</code>. They are:</p>\n\n<ul>\n<li>Error E0291: <code>no default constructor exists for class Learn</code></li>\n<li><a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-1/compiler-error-c2371?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(C2371)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">Error C2371</a>: <code>'x' : redefinition; different basic types</code></li>\n<li><a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-2/compiler-error-c2512?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(C2512)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">Error C2512</a>: <code>'Learn' : no appropriate default constructor available</code></li>\n</ul>\n\n<p>Any reason for this? I really want to actually input the integer variable <code>x</code> inside it rather than the <code>0</code>. I know this is only practice and I'm new to this, but really, I'm a little confused as to why this doesn't work.</p>\n\n<p>Any help would be appreciated, thanks.</p>\n"}, {"tags": ["c++", "string", "try-catch"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1506533755, "post_id": 46453976, "comment_id": 79863542, "body": "If you are throwing a <code>const char*</code> what are you catching a <code>std::string</code>?"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1506533842, "post_id": 46453976, "comment_id": 79863583, "body": "Conversions are not considered for exception catching."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1506533895, "post_id": 46453976, "comment_id": 79863604, "body": "The claim \u201cUsing std::invalid_argument(&quot;text...&quot;) works fine\u201d appears to concern code not shown here."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1506533905, "post_id": 46453976, "comment_id": 79863610, "body": "Throwing anything else which isn&#39;t derived from <code>std::exception</code> is usually a bad idea."}, {"owner": {"reputation": 319, "user_id": 8305281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpcZQ.jpg?s=128&g=1", "display_name": "Homunculus", "link": "https://stackoverflow.com/users/8305281/homunculus"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1506534096, "post_id": 46453976, "comment_id": 79863706, "body": "@Cheersandhth.-Alf It is now shown explicitly. It tried to say that, replacing the throw as it is written in the code for the one in the note, does not show any problem. But, you are true, it is not helping the problem. Got rid of it"}, {"owner": {"reputation": 319, "user_id": 8305281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpcZQ.jpg?s=128&g=1", "display_name": "Homunculus", "link": "https://stackoverflow.com/users/8305281/homunculus"}, "edited": false, "score": 0, "creation_date": 1506534217, "post_id": 46453976, "comment_id": 79863767, "body": "I did not know that it could not convert it. Sorry for taking your time"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1506534680, "post_id": 46453976, "comment_id": 79863979, "body": "[OT]: <code>s &gt; 24 || s &lt; 0</code> seems more a limitation of hour than second."}], "answers": [{"tags": [], "owner": {"reputation": 319, "user_id": 8305281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpcZQ.jpg?s=128&g=1", "display_name": "Homunculus", "link": "https://stackoverflow.com/users/8305281/homunculus"}, "is_accepted": false, "score": 0, "last_activity_date": 1506535917, "creation_date": 1506535917, "answer_id": 46454568, "question_id": 46453976, "link": "https://stackoverflow.com/questions/46453976/throwing-a-const-char-in-a-try-catch-block/46454568#46454568", "title": "Throwing a const char* in a Try-Catch block", "body": "<p>The people in the commentary assisted me for this answer:</p>\n\n<p>When using throw with an text, the compiler sees that as a <code>const char*</code>. In the code, the catch was expecting a <code>string const&amp;</code>. The error occurs because, as said from <em>Cheers and hth. - Alf</em></p>\n\n<blockquote>\n  <p>Conversions are not considered for exception catching</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 8684511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b845abf2dd61b4ef3397d6b4cde03bc?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8684511/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1506536770, "last_edit_date": 1506536770, "creation_date": 1506535962, "answer_id": 46454581, "question_id": 46453976, "link": "https://stackoverflow.com/questions/46453976/throwing-a-const-char-in-a-try-catch-block/46454581#46454581", "title": "Throwing a const char* in a Try-Catch block", "body": "<p>Your <em>catch</em> statement needs to specify <code>const char*</code>:</p>\n\n<pre><code>catch(const char* a)\n{\n. . .\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1506550152, "last_edit_date": 1506550152, "creation_date": 1506549833, "answer_id": 46457921, "question_id": 46453976, "link": "https://stackoverflow.com/questions/46453976/throwing-a-const-char-in-a-try-catch-block/46457921#46457921", "title": "Throwing a const char* in a Try-Catch block", "body": "<p>You are throwing a <code>char*</code> pointer but trying to catch a <code>std::string</code> object instead.  So the thrown exception is not caught.  An uncaught exception causes <code>terminate()</code> to be called, killing the process.</p>\n\n<p>So, you need to either:</p>\n\n<ul>\n<li><p>throw a <code>std::string</code> to begin with:</p>\n\n<pre><code>void Time::setSeconds(int s){\n    if (s &gt; 60 || s &lt; 0)\n        throw std::string(\"The value inside seconds has to be valid\");\n    _s = s;\n}\n</code></pre></li>\n</ul>\n\n<p>or </p>\n\n<ul>\n<li><p>catch a <code>const char*</code> pointer:</p>\n\n<pre><code>catch(const char *a)\n</code></pre></li>\n</ul>\n\n<p>That being said, a better approach is to throw a <a href=\"http://en.cppreference.com/w/cpp/header/stdexcept\" rel=\"nofollow noreferrer\">standard STL exception class</a> instead, such as <a href=\"http://en.cppreference.com/w/cpp/error/out_of_range\" rel=\"nofollow noreferrer\"><code>std::out_of_range</code></a>, eg:</p>\n\n<pre><code>#include &lt;stdexcept&gt;\n\n//set the value of _s (seconds)\nvoid Time::setSeconds(int s){\n    if (s &gt; 60 || s &lt; 0)\n        throw std::out_of_range(\"The value inside seconds has to be valid\");\n    _s = s;\n}\n\n...\n\ntry {\n    Time t(12,4,-12);\n    t.printStandard();\n}\ncatch(std::exception const &amp;a) {\n    cerr &lt;&lt; a.what();\n}\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 8305281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpcZQ.jpg?s=128&g=1", "display_name": "Homunculus", "link": "https://stackoverflow.com/users/8305281/homunculus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1352, "favorite_count": 0, "accepted_answer_id": 46457921, "answer_count": 3, "score": 0, "last_activity_date": 1506550152, "creation_date": 1506533656, "last_edit_date": 1506535565, "question_id": 46453976, "link": "https://stackoverflow.com/questions/46453976/throwing-a-const-char-in-a-try-catch-block", "title": "Throwing a const char* in a Try-Catch block", "body": "<p>In my code I want to throw a message, so it appears in screen when an input is spotted. I wanted to do this way, but it did not work. So, I would like your help to see if is there anything that I don't know, or if it is an illegal action in C++.</p>\n\n<p>This is where in my code the throw appears (a class function-member implementation)</p>\n\n<pre><code>//set the value of _s (seconds)\nvoid Time::setSeconds(int s){\n    if (s &gt; 60 || s &lt; 0)\n        throw (\"The value inside seconds has to be valid\");\n    else\n        _s = s;\n}\n</code></pre>\n\n<p>And this is how I manage to make a simple try-catch block</p>\n\n<pre><code>try{\n    Time t(12,4,-12);\n\n    t.printStandard();\n\n    }catch(string const &amp;a){\n        cerr &lt;&lt; a;\n    }\n</code></pre>\n\n<p>However, when the program is run, I get the following error message:</p>\n\n<pre><code>terminate called after throwing an instance of 'char const*'\nAborted (core dumped)\n</code></pre>\n\n<p>Which is obviously not the intended.</p>\n"}, {"tags": ["c++", "ffmpeg", "mp4", "dts"], "comments": [{"owner": {"reputation": 12172, "user_id": 2057709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0R41X.png?s=128&g=1", "display_name": "VC.One", "link": "https://stackoverflow.com/users/2057709/vc-one"}, "edited": false, "score": 0, "creation_date": 1506612781, "post_id": 46453963, "comment_id": 79901096, "body": "Can you link an mp4 for analysis? (make sure it has public access permission)."}, {"owner": {"reputation": 111, "user_id": 8684511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b845abf2dd61b4ef3397d6b4cde03bc?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8684511/alex"}, "reply_to_user": {"reputation": 12172, "user_id": 2057709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0R41X.png?s=128&g=1", "display_name": "VC.One", "link": "https://stackoverflow.com/users/2057709/vc-one"}, "edited": false, "score": 0, "creation_date": 1506617834, "post_id": 46453963, "comment_id": 79904054, "body": "The generated mp4 files are in this dropbox location: <a href=\"https://www.dropbox.com/sh/jtc3g6syx8umhri/AAAaTDZFu22vVKSDrYyPLilCa?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/sh/jtc3g6syx8umhri/AAAaTDZFu22vVKSDrYyPLilCa?dl=&zwnj;&#8203;0</a>  I also put there the source file containing H264-encoded data.  The videos in mp4 files are upside down - it&#39;s just the way the camera was installed."}, {"owner": {"reputation": 111, "user_id": 8684511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b845abf2dd61b4ef3397d6b4cde03bc?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8684511/alex"}, "reply_to_user": {"reputation": 12172, "user_id": 2057709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0R41X.png?s=128&g=1", "display_name": "VC.One", "link": "https://stackoverflow.com/users/2057709/vc-one"}, "edited": false, "score": 0, "creation_date": 1506618207, "post_id": 46453963, "comment_id": 79904242, "body": "My latest iteration of code to generate the mp4 file is different somewhat from the original post. I modified the av_rescal_q() logic a little bit. Currently it looks like the following:     int nReadResult = av_read_frame(m_pInputFormatContext, &amp;packet);     while (nReadResult == 0)     {     . . .     AVRational f;     f.num = 1;     f.den = AV_TIME_BASE;      packet.dts = av_rescale_q(nCurrentDts, f, oc-&gt;streams[0]-&gt;time_base);     ret = av_interleaved_write_frame(oc, &amp;packet);     . . .     nReadResult = av_read_frame(m_pInputFormatContext, &amp;packet);     }"}, {"owner": {"reputation": 111, "user_id": 8684511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b845abf2dd61b4ef3397d6b4cde03bc?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8684511/alex"}, "reply_to_user": {"reputation": 12172, "user_id": 2057709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0R41X.png?s=128&g=1", "display_name": "VC.One", "link": "https://stackoverflow.com/users/2057709/vc-one"}, "edited": false, "score": 0, "creation_date": 1506618258, "post_id": 46453963, "comment_id": 79904264, "body": "With that code, the generated video is now 47 seconds long (vs 17 seconds if mp4 is generated by mp4box), and the quality is crappy. I do not understand why this particular code works better than my previous attempts :-)"}, {"owner": {"reputation": 12172, "user_id": 2057709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0R41X.png?s=128&g=1", "display_name": "VC.One", "link": "https://stackoverflow.com/users/2057709/vc-one"}, "edited": false, "score": 0, "creation_date": 1507322126, "post_id": 46453963, "comment_id": 80179241, "body": "Is this solved? I only managed to get video to play at correct speed with correct duration. However still bad picture quality, and media players report wrong frame rate (though plays at normal rate)."}, {"owner": {"reputation": 111, "user_id": 8684511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b845abf2dd61b4ef3397d6b4cde03bc?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8684511/alex"}, "reply_to_user": {"reputation": 12172, "user_id": 2057709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0R41X.png?s=128&g=1", "display_name": "VC.One", "link": "https://stackoverflow.com/users/2057709/vc-one"}, "edited": false, "score": 0, "creation_date": 1507519054, "post_id": 46453963, "comment_id": 80225851, "body": "No, it is not solved. I probably should have been more precise in describing the video quality I received from mp4box - it&#39;s not great, but it&#39;s far better than whatever I get from ffmpeg. I would still be interested in your solution using ffmpeg API."}], "owner": {"reputation": 111, "user_id": 8684511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b845abf2dd61b4ef3397d6b4cde03bc?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8684511/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1506533607, "creation_date": 1506533607, "question_id": 46453963, "link": "https://stackoverflow.com/questions/46453963/assigning-of-dts-values-to-encoded-packets", "title": "Assigning of dts values to encoded packets", "body": "<p>I have a dump of H264-encoded data, which I need to put in mp4 container. I verified the validity of the encoded data by using mp4box utility against it. The mp4 file created by mp4box contained a proper 17 seconds long video. It is interesting that if I try ffmpeg to achieve the same, the resulting video is 34 seconds long and rather crappy (probably ffmpeg tries to decode video and then encode it, which results in the loss of video quality?) Anyway, for my project I can't use command line approach and need to come up wit a programmatic way to embed the data in the mp4 container.</p>\n\n<p>Below is the code I use (I removed error checking for brevity. During execution all the calls succeed):</p>\n\n<pre><code>AVFormatContext* pInputFormatContext = avformat_alloc_context();\navformat_open_input(&amp;pInputFormatContext, \"Data.264\", NULL, NULL);\navformat_find_stream_info(pInputFormatContext, NULL);\nAVRational* pTime_base = &amp;pInputFormatContext-&gt;streams[0]-&gt;time_base;\n\nint nFrameRate = pInputFormatContext-&gt;streams[0]-&gt;r_frame_rate.num / pFormatCtx-&gt;streams[0]-&gt;r_frame_rate.den;\nint nWidth = pInputFormatContext-&gt;streams[0]-&gt;codecpar-&gt;width;\nint nHeight = pInputFormatContext-&gt;streams[0]-&gt;codecpar-&gt;height;\n// nWidth = 1920, nHeight = 1080, nFrameRate = 25\n\n// Create output objects\nAVFormatContext* pOutputFormatContext = NULL;\navformat_alloc_output_context2(&amp;pOutputFormatContext, NULL, NULL, \"Destination.mp4\");\n\nAVCodec* pVideoCodec = avcodec_find_encoder(pOutputFormatContext-&gt;oformat-&gt;video_codec/*AV_CODEC_ID_264*/);\nAVStream* pOutputStream = avformat_new_stream(pOutputFormatContext, NULL);\npOutputStream-&gt;id = pOutputFormatContext-&gt;nb_streams - 1;\nAVCodecContext* pCodecContext = avcodec_alloc_context3(pVideoCodec);\n\nswitch (pVideoCodec-&gt;type) {\ncase AVMEDIA_TYPE_VIDEO:\n  pCodecContext-&gt;codec_id = codec_id;\n  pCodecContext-&gt;bit_rate = 400000;\n  /* Resolution must be a multiple of two. */\n  pCodecContext-&gt;width = nFrameWidth;\n  pCodecContext-&gt;height = nFrameHeight;\n  /* timebase: This is the fundamental unit of time (in seconds) in terms\n  * of which frame timestamps are represented. For fixed-fps content,\n  * timebase should be 1/framerate and timestamp increments should be\n  * identical to 1. */\n  pOutputStream-&gt;time_base.num = 1;\n  pOutputStream-&gt;time_base.den = nFrameRate;\n  pCodecContext-&gt;time_base = pOutputStream-&gt;time_base;\n  pCodecContext-&gt;gop_size = 12; /* emit one intra frame every twelve frames at most */\n  pCodecContext-&gt;pix_fmt = STREAM_PIX_FMT;\n  break;\ndefault:\n  break;\n}\n\n/* copy the stream parameters to the muxer */\navcodec_parameters_from_context(pOutputStream-&gt;codecpar, pCodecContext);\n\navio_open(&amp;pOutputFormatContext-&gt;pb, \"Destination.mp4\", AVIO_FLAG_WRITE);\n\n// Start writing\nAVDictionary* pDict = NULL;\navformat_write_header(pOutputFormatContext, &amp;pDict);\n\n// Process packets\nAVPacket packet;\nint64_t nCurrentDts = 0;\nint64_t nDuration = 0;\nint nReadResult = 0;\n\nwhile (nReadResult == 0)\n{\n  nReadResult = av_read_frame(m_pInputFormatContext, &amp;packet);\n// At this point, packet.dts == AV_NOPTS_VALUE. \n// The duration field of the packet contains valid data\n\n  packet.flags |= AV_PKT_FLAG_KEY;\n  nDuration = packet.duration;\n  packet.dts = nCurrentDts;\n  packet.dts = av_rescale_q(nCurrentDts, pOutputFormatContext-&gt;streams[0]-&gt;codec-&gt;time_base, pOutputFormatContext-&gt;streams[0]-&gt;time_base);\n  av_interleaved_write_frame(pOutputFormatContext, &amp;packet);\n  nCurrentDts += nDuration;\n  nDuration += packet.duration;\n  av_free_packet(&amp;packet);\n}\n\nav_write_trailer(pOutputFormatContext);\n</code></pre>\n\n<p>The properties for the <em>Destination.mp4</em> file I receive indicate it is about 1 hour long with frame rate 0. I am sure the culprit is in the way I calculate dts values for each packet and use av_rescale_q(), but I do not have sufficient understanding of the avformat library to figure out the proper way to do it. Any help will be appreciated!</p>\n"}, {"tags": ["c++", "linux"], "comments": [{"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 3, "creation_date": 1506532622, "post_id": 46453690, "comment_id": 79862972, "body": "Well, you probably meant C++ compiler version"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 10, "creation_date": 1506532713, "post_id": 46453690, "comment_id": 79863028, "body": "GCC 5.4.0 is from June 2016. You will be missing out on the latest C++17 features but I&#39;m sure none of those features will be taught anyway yet. C++14 support is fine."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1506533042, "post_id": 46453690, "comment_id": 79863178, "body": "<code>std::cout &lt;&lt; __cplusplus &#47; 100 % 100 &lt;&lt; &#39;\\n&#39;;</code>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1506533159, "post_id": 46453690, "comment_id": 79863235, "body": "You could update (or replace) your distribution with Ubuntu 17.10 in a few days, in october 2017."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506533634, "post_id": 46453690, "comment_id": 79863481, "body": "Similarly, your version of <i>Ubuntu</i> and your version of <i>Linux</i> are different. Ubuntu is a <i>distribution</i> of GNU/Linux, meaning it provides a bunch of programs and configuration files and stuff. Linux is one of the components (depending on how you look at it, the primary component) of Ubuntu, but it has a different version number. This is relevant because there are other distributions of Linux, and they have different version numbers (or sometimes no version number)."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1506533420, "post_id": 46453809, "comment_id": 79863361, "body": "You can use <a href=\"https://gcc.gnu.org/projects/cxx-status.html\" rel=\"nofollow noreferrer\">this table</a> to see which version first introduces support for each new c++ feature."}], "tags": [], "owner": {"reputation": 1522, "user_id": 8157511, "user_type": "registered", "profile_image": "https://graph.facebook.com/638941339628236/picture?type=large", "display_name": "James Maa", "link": "https://stackoverflow.com/users/8157511/james-maa"}, "is_accepted": false, "score": 12, "last_activity_date": 1506533005, "creation_date": 1506533005, "answer_id": 46453809, "question_id": 46453690, "link": "https://stackoverflow.com/questions/46453690/checking-the-c-version-on-my-laptop/46453809#46453809", "title": "Checking the C++ version on my laptop", "body": "<p>C++ version (Or usually called c++ standard) is different than compiler version.</p>\n\n<p><code>g++</code> is your compiler, and your current version is <code>g++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609</code></p>\n\n<p>You can use different command to compile your program using different C++ version. </p>\n\n<pre><code>g++ -std=c++11 yourFile .....\ng++ -std=c++14 yourFile .....\n</code></pre>\n\n<p>As mentioned in the comments, this version of compiler may not support c++17 features yet</p>\n"}, {"tags": [], "owner": {"reputation": 1457, "user_id": 2068931, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/hUTV7.png?s=128&g=1", "display_name": "wfgeo", "link": "https://stackoverflow.com/users/2068931/wfgeo"}, "is_accepted": false, "score": -3, "last_activity_date": 1592683383, "creation_date": 1592683383, "answer_id": 62491042, "question_id": 46453690, "link": "https://stackoverflow.com/questions/46453690/checking-the-c-version-on-my-laptop/62491042#62491042", "title": "Checking the C++ version on my laptop", "body": "<p>To get the c++ version use</p>\n<pre><code>c++ --version\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8062387, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/647ebaef34d29cf62ca757a32585da4c?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Brian Tierney III", "link": "https://stackoverflow.com/users/8062387/thomas-brian-tierney-iii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19067, "favorite_count": 2, "answer_count": 2, "score": 9, "last_activity_date": 1592683383, "creation_date": 1506532541, "question_id": 46453690, "link": "https://stackoverflow.com/questions/46453690/checking-the-c-version-on-my-laptop", "title": "Checking the C++ version on my laptop", "body": "<p>I am currently in a CS class where we use C++, and I run Linux on my laptop. So the problem is that I think I don't have the most up to date version of C++. I've read online for several commands to get the version and this is my result. Also my Linux version is 16.04, and I am compiling in my terminal </p>\n\n<pre><code>tom@TBT-XPS-13-9360:~/Documents/Subjects/CS/OOP$ g++ --version\ng++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There \nis NO warranty; not even for MERCHANTABILITY or FITNESS FOR A \nPARTICULAR PURPOSE.\n</code></pre>\n\n<p>I don' know what part of this is my actual version of C++. If my version is not the most up to date, can someone please give me DETAILED instructions on how to do it. Still getting my Linux legs.</p>\n"}, {"tags": ["c++", "arrays", "shared-ptr", "reference-counting"], "comments": [{"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 2, "creation_date": 1506533300, "post_id": 46453585, "comment_id": 79863296, "body": "I&#39;d recommend using <code>std::array</code> instead of a raw array.  That let&#39;s you use <code>std::make_shared</code> and avoid the custom deleter: <code>auto p = std::make_shared&lt;std::array&lt;int, 10&gt;&gt;(); std::shared_ptr&lt;int&gt; p2{ p, &amp;p-&gt;at(n) };</code>"}, {"owner": {"reputation": 3285, "user_id": 2548187, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e0d2521a9b76a040ff10d08c3c1efc?s=128&d=identicon&r=PG&f=1", "display_name": "u3l", "link": "https://stackoverflow.com/users/2548187/u3l"}, "reply_to_user": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 0, "creation_date": 1506533662, "post_id": 46453585, "comment_id": 79863497, "body": "Ah okay that&#39;s more convenient yeah"}, {"owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "edited": false, "score": 1, "creation_date": 1506534933, "post_id": 46453585, "comment_id": 79864115, "body": "That question is a really good question. I never had the problem before but I&#39;m thankful for the future."}], "answers": [{"tags": [], "owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "is_accepted": true, "score": 18, "last_activity_date": 1506532719, "creation_date": 1506532719, "answer_id": 46453735, "question_id": 46453585, "link": "https://stackoverflow.com/questions/46453585/assigning-a-shared-ptr-to-an-offset-of-an-array/46453735#46453735", "title": "Assigning a shared_ptr to an offset of an array", "body": "<p>You should be able to use the <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/shared_ptr\" rel=\"noreferrer\">aliasing constructor</a>:</p>\n\n<pre><code>template&lt; class Y &gt; \nshared_ptr( const shared_ptr&lt;Y&gt;&amp; r, element_type* ptr ) noexcept;\n</code></pre>\n\n<p>This shares the ownership with the given <code>shared_ptr</code>, but makes sure to clean up according to that one, not the pointer you give it.</p>\n\n<pre><code>shared_ptr&lt;T&gt; ptr_at_offset(int offset) {\n    return {sp, sp.get() + offset};\n}\n</code></pre>\n"}], "owner": {"reputation": 3285, "user_id": 2548187, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e0d2521a9b76a040ff10d08c3c1efc?s=128&d=identicon&r=PG&f=1", "display_name": "u3l", "link": "https://stackoverflow.com/users/2548187/u3l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 1, "accepted_answer_id": 46453735, "answer_count": 1, "score": 10, "last_activity_date": 1506532842, "creation_date": 1506532180, "question_id": 46453585, "link": "https://stackoverflow.com/questions/46453585/assigning-a-shared-ptr-to-an-offset-of-an-array", "title": "Assigning a shared_ptr to an offset of an array", "body": "<p>Let's say I have a <code>shared_ptr</code> to an array:</p>\n\n<pre><code>std::shared_ptr&lt;int&gt; sp(new T[10], [](T *p) { delete[] p; });\n</code></pre>\n\n<p>And a method:</p>\n\n<pre><code>shared_ptr&lt;T&gt; ptr_at_offset(int offset) {\n    // I want to return a shared_ptr to (sp.get() + offset) here\n    // in a way that the reference count to sp is incremented...\n}\n</code></pre>\n\n<p>Basically, what I'm trying to do is return a new <code>shared_ptr</code> that increments the reference count, but point to an offset of the original array; I want to avoid having the array deleted while a caller is using the array at some offset. If I just return <code>sp.get() + offset</code> that may happen, right? And I think initializing a new <code>shared_ptr</code> to contain <code>sp.get() + offset</code> doesn't make sense either.</p>\n\n<p>New to C++, so not sure if I'm approaching this correctly.</p>\n"}, {"tags": ["c++", "optimization", "memory-management"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1506531238, "post_id": 46453231, "comment_id": 79862249, "body": "The C API should document what is that string, and who is responsible for <code>free</code>-ing it if it has been <code>malloc</code>-ed somehow."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1506531354, "post_id": 46453231, "comment_id": 79862307, "body": "<code>std::string</code> doesn&#39;t take ownership of the buffer pointed to by <code>chString</code>. It copies it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 7, "creation_date": 1506531387, "post_id": 46453231, "comment_id": 79862327, "body": "<code>strValue.swap(string (chString));</code> is an unnecessary complication of <code>strValue = chString;</code>."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 1, "creation_date": 1506531438, "post_id": 46453231, "comment_id": 79862355, "body": "The <code>unique_ptr</code> approach is wrong because it uses <code>delete []</code> when it should be using <code>releaseMemory</code>. Also there is no taking ownership. The <code>GetString</code> creates a copy of the <code>const char *</code> and then destroys the original, in a weird way. <code>chString = NULL;</code> is also completely pointless."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506531526, "post_id": 46453231, "comment_id": 79862399, "body": "Creating a temporary <code>unique_ptr</code> will not help extend the life-time of your buffer in any way. It will be destroyed at the end of the expression."}, {"owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "edited": false, "score": 0, "creation_date": 1506531540, "post_id": 46453231, "comment_id": 79862409, "body": "From the original code it seems clear the caller is responsible for <code>releaseMemory</code>-ing the string."}, {"owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "edited": false, "score": 0, "creation_date": 1506531787, "post_id": 46453231, "comment_id": 79862545, "body": "To be precise, is it the temporary string copying chString, and then strValue is swapping buffer with the temporary string?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1506531862, "post_id": 46453231, "comment_id": 79862592, "body": "@MattChambers Yes. And like molbdnilo said, you get essentially the same result if you just assign <code>chString</code> directly to <code>strValue</code>."}, {"owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "edited": false, "score": 0, "creation_date": 1506533594, "post_id": 46453231, "comment_id": 79863457, "body": "To address the last question, could I just copy the string_view source code and replace the pointers with a shared_ptr&lt;char*&gt;, or does something like that already exist?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506550791, "post_id": 46453231, "comment_id": 79871692, "body": "@MattChambers: that would not address the issue of needing to release the original pointer after using its data."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506551174, "post_id": 46457996, "comment_id": 79871825, "body": "&quot;<i>Does this seem like a good solution for my last question</i>&quot; - No.  First off, this should have been added to your question instead of posted as an answer.  And second, it doesn&#39;t address the issue of releasing the original <code>char*</code> memory properly with <code>releaseMemory()</code>.  In fact, this code would take ownership of the <code>char*</code> and try to release it with <code>delete[]</code> instead. You can&#39;t use <code>delete</code> with memory from a C-based API."}, {"owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506551446, "post_id": 46457996, "comment_id": 79871921, "body": "Taking ownership is the purpose. The C API is giving the caller ownership; a class like this would take it and return it rather than being required to make a copy and free the original before returning. I made it templated especially so I could use the <code>releaseMemory()</code> custom deleter. (this IS an attempt to answer my last question, but I will certainly prefer other anwers to my own if they are more comprehensive)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506551577, "post_id": 46457996, "comment_id": 79871972, "body": "In the template you showed, you are accepting a custom <code>deleter</code> <i>type</i> as a template parameter, but you are not constructing the <code>std::unique_ptr</code> with an actual <code>deleter</code> <i>object</i>. If you read the <code>std:::unique_ptr</code> documentation , you should pass the actual deleter as a constructor parameter, not just a template parameter (which defines the constructor parameter&#39;s type)"}, {"owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506551952, "post_id": 46457996, "comment_id": 79872060, "body": "Are you sure about that? GCC seems to use the deleter without passing it explicitly (I don&#39;t use custom deleters very often!); will edit answer with test code"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1506552684, "post_id": 46457996, "comment_id": 79872226, "body": "<a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\">read the <code>std::unique_ptr</code> documentation</a>. If you don&#39;t pass a deleter in the constructor, a default one is value-initialized using the type specified in the template. That is fine when the deleter is a struct/class with an overridden <code>operator()</code>, but that is not fine when the deleter is a plain function or a lambda. So it is best to always pass a custom deleter as a constructor parameter so you know what you are getting."}, {"owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506553387, "post_id": 46457996, "comment_id": 79872412, "body": "Ah, so there is some actually an advantage to using the functor instead of a plain function. Thanks for the clarification. I did read the unique_ptr documentation, but it doesn&#39;t make it clear that default value-initialization is  a problem for function pointers but not functors."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1506556447, "post_id": 46457996, "comment_id": 79873110, "body": "When using a plain function as the deleter, how do you expect the compiler to value-initialize a default function? It can&#39;t. So you have to explicitly pass in the function pointer in the constructor"}], "tags": [], "owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "is_accepted": false, "score": 0, "last_activity_date": 1506552068, "last_edit_date": 1506552068, "creation_date": 1506550227, "answer_id": 46457996, "question_id": 46453231, "link": "https://stackoverflow.com/questions/46453231/converting-a-char-returned-by-c-api-to-c-string/46457996#46457996", "title": "Converting a char* returned by C API to C++ string", "body": "<p>Does this seem like a good solution for my last question (and ultimate goal of being able to use a char* like a string without copying it)?</p>\n\n<pre><code>template &lt;typename DeleterT = std::default_delete&lt;const char*&gt;&gt;\nclass c_str_view\n{\n    public:\n    unique_ptr&lt;const char*, DeleterT&gt; strPtr_;\n    size_t len_;\n\n    c_str_view() {}\n    c_str_view(const char* charPtr) : strPtr_(charPtr), len_(strlen(charPtr)) {}\n    c_str_view(const char* charPtr, size_t len) : strPtr_(charPtr), len_(len) {}\n\n    operator std::string_view () const\n    {\n        return string_view(strPtr_.get(), len_);\n    }\n};\n</code></pre>\n\n<p>If so, is there a good reason this isn't in the upcoming standard since string_view is coming? It only makes sense with string_view of course, since any conversion to std::string would cause a copy and make the whole exercise pointless.</p>\n\n<p>Here's a test:\n<a href=\"http://coliru.stacked-crooked.com/a/9046eb22b10a1d87\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/9046eb22b10a1d87</a></p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1506551417, "last_edit_date": 1506551417, "creation_date": 1506550716, "answer_id": 46458088, "question_id": 46453231, "link": "https://stackoverflow.com/questions/46453231/converting-a-char-returned-by-c-api-to-c-string/46458088#46458088", "title": "Converting a char* returned by C API to C++ string", "body": "<blockquote>\n  <p>I suppose the author is trying to give the string <code>strValue</code> ownership of <code>chString</code> and then free the empty buffer.</p>\n</blockquote>\n\n<p>No.  It makes an (inefficient and error-prone) copy of the character data pointed to by <code>chString</code>, then releases the memory pointed to by <code>chString</code> (which will be skipped if the copy throws an exception), and then returns the copy.</p>\n\n<blockquote>\n  <p>Assuming that the C API and the C++ library are using the same heap</p>\n</blockquote>\n\n<p>That is not a correct assumption, or even a necessary one.  The copy can use whatever heap it wants.</p>\n\n<blockquote>\n  <p>is there a way to properly achieve this? How about this?</p>\n</blockquote>\n\n<p>You are on the right track to use a <code>std::unique_ptr</code> with a custom <code>deleter</code>, but there is no reason to use the <code>T[]</code> array specialization of <code>std::unique_ptr</code>.</p>\n\n<p>The code can be simplified to something more like this:</p>\n\n<pre><code>void Deleter(char* o) { releaseMemory((void*&amp;)o); }\n\nstatic std::string GetString(char* chString)\n{\n    std::string strValue;\n    if (chString) {\n        std::unique_ptr&lt;char, decltype(&amp;Deleter)&gt;(chString, &amp;Deleter);\n        strValue = chString;\n    }\n    return strValue;\n}\n</code></pre>\n\n<p>Or, just get rid of the check for <code>chString</code> being null, it is not actually needed.  <code>std::string</code> can be constructed from a null <code>char*</code>, and <code>std::unique_ptr</code> will not call its <code>deleter</code> with a null pointer:</p>\n\n<pre><code>void Deleter(char* o) { releaseMemory((void*&amp;)o); }\n\nstatic std::string GetString(char* chString)\n{\n    std::unique_ptr&lt;char, decltype(&amp;Deleter)&gt;(chString, &amp;Deleter);\n    return std::string(chString);\n}\n</code></pre>\n"}], "owner": {"reputation": 1984, "user_id": 638445, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1af75f7c77e2a4962fd908d311f0f0c?s=128&d=identicon&r=PG", "display_name": "Matt Chambers", "link": "https://stackoverflow.com/users/638445/matt-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 46458088, "answer_count": 2, "score": 0, "last_activity_date": 1506552068, "creation_date": 1506530883, "question_id": 46453231, "link": "https://stackoverflow.com/questions/46453231/converting-a-char-returned-by-c-api-to-c-string", "title": "Converting a char* returned by C API to C++ string", "body": "<p>I found this code in a C++ header-only wrapper around a C API I'm working with:</p>\n\n<pre><code>static string GetString(const char* chString)\n{\n    string strValue;\n    if (NULL != chString)\n    {\n        strValue.swap(string (chString));\n        releaseMemory((void*&amp;)chString);\n        chString = NULL;\n    }\n    return strValue;\n}\n</code></pre>\n\n<p>I suppose the author is trying to give the string <code>strValue</code> ownership of <code>chString</code> and then free the empty buffer. I suspect this is very wrong (including it being const char*), but it actually seems to work with MSVC 12. At least I haven't seen it crash spectacularly yet.</p>\n\n<p>Assuming that the C API and the C++ library are using the same heap (so that the string can reallocate the buffer if necessary and eventually release it), is there a way to properly achieve this? How about this?</p>\n\n<pre><code>template &lt;typename T&gt; struct Deleter { void operator()(T o) { releaseMemory((void*&amp;)o); } };\n\nstatic std::string GetString(char* chString)\n{\n    if (NULL == chString)\n        return std::string();\n    return std::string(std::unique_ptr&lt;char[], Deleter&lt;char[]&gt;&gt;(chString).get());\n}\n</code></pre>\n\n<p>Again, assuming the C API is using the same heap as std::string.</p>\n\n<p>If that's also very wrong, then is there an immutable, owning C-style string wrapper? Something like <code>string_view</code> but immutable (so <code>const char*</code> input would be ok) and owning (so it deletes the C string, possibly with a custom deleter, in its dtor)?</p>\n"}, {"tags": ["c++", "unordered-map"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1506530355, "post_id": 46453051, "comment_id": 79861795, "body": "Definitely (2). The (1) is slow and doesn&#39;t look good."}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1506532353, "post_id": 46453051, "comment_id": 79862838, "body": "I cannot modify my class definition, Is it still possible to use method 2 ?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1506532808, "post_id": 46453051, "comment_id": 79863063, "body": "Yes. You don&#39;t need to change the class to specialize <code>std::hash</code> for it (as your link shows), and you can <a href=\"http://en.cppreference.com/w/cpp/utility/functional/equal_to\" rel=\"nofollow noreferrer\">specialize <code>std::equal_to</code></a> instead of overloading <code>==</code>."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1506540538, "post_id": 46453051, "comment_id": 79867154, "body": "@HolyBlackCat - <code>operator ==</code> can be overloaded as a non-member. I think that would be a better addition."}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 4603361, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51009e2c589f766b22ab9099649e9852?s=128&d=identicon&r=PG&f=1", "display_name": "g4s0l1n", "link": "https://stackoverflow.com/users/4603361/g4s0l1n"}, "edited": false, "score": 1, "creation_date": 1615639602, "post_id": 46455707, "comment_id": 117756603, "body": "best solution of all internet, really thanks :)"}], "tags": [], "owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "is_accepted": true, "score": 2, "last_activity_date": 1506540734, "last_edit_date": 1506540734, "creation_date": 1506540078, "answer_id": 46455707, "question_id": 46453051, "link": "https://stackoverflow.com/questions/46453051/using-custom-classes-with-unordered-map-in-cpp/46455707#46455707", "title": "using custom classes with unordered_map in cpp", "body": "<p>Why would you want to convert the time to string first? Your goal should be a wide spreading of hash values with an inexpensive hash function, right? Also this is real time? In which case you get away with <code>unsigned short</code> for the members.</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n#include &lt;functional&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nclass Time {\npublic:\n\n  Time(unsigned short h = 0, unsigned short m = 0, unsigned short s = 0) :\n    hours(h), minutes(m), seconds(s) {}\n\n  bool operator==(Time const&amp; other) const {\n    return (seconds==other.seconds &amp;&amp;\n            minutes==other.minutes &amp;&amp;\n            hours==other.hours);\n  }\n\n  unsigned short hours, minutes, seconds;\n\n};\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; o, Time const&amp; t) {\n  o &lt;&lt; t.hours &lt;&lt; \":\" &lt;&lt; t.minutes &lt;&lt; \":\" &lt;&lt; t.seconds;\n  return o;\n}\n\nnamespace std {\n  template&lt;&gt; struct hash&lt;Time&gt; {\n    size_t operator()(Time const&amp; t) const {\n      return size_t(((t.seconds * 37 + t.minutes) * 37 + t.hours) * 37);\n    }\n  };\n}\n\nint main() {\n  std::unordered_map&lt;Time, std::string&gt; u;\n  u[Time(3,15,31)] = std::string(\"Hello world\");\n  u[Time(3,15,32)] = std::string(\"foo\");\n  u[Time(3,15,32)] = std::string(\"bar\");\n  for (auto const&amp; i : u) {\n    std::cout &lt;&lt; i.first &lt;&lt; \" - \" &lt;&lt; i.second &lt;&lt; std::endl; \n  } \n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "accepted_answer_id": 46455707, "answer_count": 1, "score": 0, "last_activity_date": 1506540734, "creation_date": 1506530245, "question_id": 46453051, "link": "https://stackoverflow.com/questions/46453051/using-custom-classes-with-unordered-map-in-cpp", "title": "using custom classes with unordered_map in cpp", "body": "<p>I have class like this .</p>\n\n<pre><code>class Time\n{\n  public:\n    int seconds, minutes, hours;\n};\n</code></pre>\n\n<p>I want to use unordered_map with key as Time. What is a better way of doing this :</p>\n\n<p>1) use unordered_map  where string is concatenation of fields of class. Eg convert 56:12:1 to a string and use this as key</p>\n\n<p>2) Defining something like discussed <a href=\"https://stackoverflow.com/questions/17016175/c-unordered-map-using-a-custom-class-type-as-the-key\">here</a></p>\n\n<p>Please help me choose based on current use case :) </p>\n"}, {"tags": ["python", "c++", "node.js", "autoconf", "node-gyp"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1506543026, "post_id": 46453029, "comment_id": 79868452, "body": "Do you have any particular reason to use node-gyp and mix it with autotools?"}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 4275911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/ZIyiU.png?s=128&g=1", "display_name": "kpalatzky", "link": "https://stackoverflow.com/users/4275911/kpalatzky"}, "is_accepted": true, "score": 0, "last_activity_date": 1506581379, "creation_date": 1506581379, "answer_id": 46462672, "question_id": 46453029, "link": "https://stackoverflow.com/questions/46453029/node-gyp-handling-h-in-files/46462672#46462672", "title": "node-gyp - Handling &quot;.h.in&quot; files", "body": "<p>The best solution to solve the problem of <code>.h.in</code> in files is to build it once using the <code>autotools</code> and to copy the created <code>.h</code> files to an other directory of the project (So the submodule will not be affected). Furthermore, you may have to build these files for several platforms or architectures. After that you can add a new folder to your includes. A pretty nice solution for that is available here:</p>\n\n<p><a href=\"https://github.com/albanm/node-libxslt/tree/master/deps\" rel=\"nofollow noreferrer\">Github DEMO</a></p>\n"}], "owner": {"reputation": 930, "user_id": 4275911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/ZIyiU.png?s=128&g=1", "display_name": "kpalatzky", "link": "https://stackoverflow.com/users/4275911/kpalatzky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 46462672, "answer_count": 1, "score": 0, "last_activity_date": 1506581379, "creation_date": 1506530143, "question_id": 46453029, "link": "https://stackoverflow.com/questions/46453029/node-gyp-handling-h-in-files", "title": "node-gyp - Handling &quot;.h.in&quot; files", "body": "<p>I created a project which contains a git submodule <a href=\"https://github.com/GNOME/libxml2\" rel=\"nofollow noreferrer\"><code>libxml2</code></a>. I want to use this files inside my <code>binding.gyp</code>, but i get errors while running <code>node-gyp build</code>. The problem here is that there is only a <code>xmlversion.h.in</code> file but an <code>xmlversion.h</code> file is needed. </p>\n\n<p>When i am running the <a href=\"https://github.com/GNOME/libxml2/blob/master/autogen.sh\" rel=\"nofollow noreferrer\"><code>autogen.sh</code></a> script of <code>libxml2</code> first everything is working fine, because the <code>autotools</code> will create the <code>xmlversion.h</code> file out of the <code>xmlversion.h.in</code>.</p>\n\n<p>Is there a way to create the <code>xmlversion.h</code> file using <code>node-gyp</code>?</p>\n\n<p>My current <code>bindings.gyp</code> looks like that:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>{\n    'targets': [{\n        'target_name': 'library',\n        'product_extension': 'node',\n        'type': 'shared_library',\n        'include_dirs': [\n            'libxml2/include',\n            'libxml2',\n            \"&lt;!(node -e \\\"require('nan')\\\")\"\n        ],\n        'cflags': [ '-Wall' ],\n        'xcode_settings': {\n            'OTHER_CFLAGS': [ '-Wall' ]\n        },\n        'sources': [\n            # src/my_files.cc\n            # libxml2/libxml2_files.c\n        ]\n    }]\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "mutex", "c++17"], "comments": [{"owner": {"reputation": 15161, "user_id": 1067003, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e3af2bd4b5604b0b661b5e6646544eba?s=128&d=identicon&r=PG", "display_name": "hanshenrik", "link": "https://stackoverflow.com/users/1067003/hanshenrik"}, "edited": false, "score": 0, "creation_date": 1535645922, "post_id": 46452973, "comment_id": 91153790, "body": "an easy way to think of it is: a shared_mutex is like a flock()"}], "answers": [{"tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 17, "last_activity_date": 1506530143, "creation_date": 1506530143, "answer_id": 46453028, "question_id": 46452973, "link": "https://stackoverflow.com/questions/46452973/difference-between-stdmutex-and-stdshared-mutex/46453028#46453028", "title": "difference between std::mutex and std::shared_mutex", "body": "<p>As noted in <a href=\"http://en.cppreference.com/w/cpp/thread/shared_mutex\" rel=\"noreferrer\">the documentation</a></p>\n\n<blockquote>\n  <p>The shared_mutex class is a synchronization primitive that can be used to protect shared data from being simultaneously accessed by multiple threads. In contrast to other mutex types which facilitate exclusive access, a shared_mutex has two levels of access:  </p>\n  \n  <ul>\n  <li>shared - <strong>several threads can share ownership of the same mutex</strong>.  </li>\n  <li>exclusive - only one thread can own the mutex.  </li>\n  </ul>\n  \n  <p>Shared mutexes are usually used in situations when multiple readers can access the same resource at the same time without causing data races, but only one writer can do so.</p>\n</blockquote>\n\n<p>This has a variety of uses, but one common one is to implement a <a href=\"https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock\" rel=\"noreferrer\">Read Write Lock</a> where you could have multiple threads reading shared data, but only one thread exclusively writing at any time. So when you have multiple readers the mutex acts in \"shared mode\", but when a write is requested it changes into \"exclusive mode\".</p>\n"}, {"tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1506533023, "last_edit_date": 1506533023, "creation_date": 1506531167, "answer_id": 46453301, "question_id": 46452973, "link": "https://stackoverflow.com/questions/46452973/difference-between-stdmutex-and-stdshared-mutex/46453301#46453301", "title": "difference between std::mutex and std::shared_mutex", "body": "<p><code>std::shared_mutex</code> can be useful especially in cases where data structure (like DNS cache) gets <strong>rarely updated</strong>. Using a <code>std::mutex</code> to protect the data structure could be overly pessimistic, because it eliminates the possible concurrency in reading the data structure\nwhen it isn\u2019t undergoing modification. Multiple threads can have a shared lock on the same <code>std::shared_mutex</code> at the same time.</p>\n\n<p>One such example from Anthony Williams book:</p>\n\n<pre><code>class dns_cache\n{\n    std::map&lt;std::string,dns_entry&gt; entries;\n    mutable boost::shared_mutex entry_mutex;\n\npublic:\n\n    dns_entry find_entry(std::string const&amp; domain) const\n    {\n        boost::shared_lock&lt;boost::shared_mutex&gt; lk(entry_mutex);\n        std::map&lt;std::string,dns_entry&gt;::const_iterator const it = entries.find(domain);\n        return (it==entries.end()) ? dns_entry() : it-&gt;second;\n    }\n\n    void update_or_add_entry(std::string const&amp; domain,\n                            dns_entry const&amp; dns_details)\n    {\n        std::lock_guard&lt;boost::shared_mutex&gt; lk(entry_mutex);\n        entries[domain] = dns_details;\n    }\n};\n</code></pre>\n\n<p>Here, function <code>find_entry</code> basically does the Read operation, whereas <code>update_or_add_entry</code> performs the Write operation.</p>\n\n<p>So, it can said that <code>std::shared_mutex</code> is a typical <em>reader-writer mutex</em>, because it allows for\ntwo different kinds of usage: exclusive access by a single \u201cwriter\u201d thread or shared,\nconcurrent access by multiple \u201creader\u201d threads.</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 8, "last_activity_date": 1506535813, "creation_date": 1506535813, "answer_id": 46454536, "question_id": 46452973, "link": "https://stackoverflow.com/questions/46452973/difference-between-stdmutex-and-stdshared-mutex/46454536#46454536", "title": "difference between std::mutex and std::shared_mutex", "body": "<p>A <code>mutex</code> is either locked or not.</p>\n\n<p>A <code>shared_mutex</code> is either locked exclusively, or locked shared, or not.</p>\n\n<p>Any number of clients can shared lock a shared mutex.</p>\n\n<p>If anyone has it exclusive locked, nobody else can hold <em>any</em> locks.</p>\n\n<p>On windows, this is the <code>SWRLOCK</code> type -- and in fact, this lock is typically used to implement read-write locks; many readers allowed, but writing must be exclusive.</p>\n\n<p>Here is some sample code to create two template wrappers for shared and non-shared mutexes.  In one case, we have read and write operations that aquire different locks.  In the other, we just have access:</p>\n\n<pre><code>template&lt;class T, class M=std::mutex&gt;\nstruct mutex_guarded {\n  template&lt;class F&gt;\n  auto access( F&amp;&amp; f ) {\n    auto l = lock();\n    return std::forward&lt;F&gt;(f)(t);\n  }\n  template&lt;class F&gt;\n  auto access( F&amp;&amp; f ) const {\n    auto l = lock();\n    return std::forward&lt;F&gt;(f)(t);\n  }\n  mutex_guarded(mutex_guarded const&amp;)=delete;\n  mutex_guarded&amp; operator=(mutex_guarded const&amp;)=delete;\n  template&lt;class...Ts&gt;\n  mutex_guarded( Ts&amp;&amp;...ts ):t(std::forward&lt;Ts&gt;(ts)...){}\n  mutex_guarded()=default;\nprotected:\n  mutable M m;\n  T t;\n  auto lock() { return std::unique_lock&lt;M&gt;(m); }\n};\ntemplate&lt;class T, class M=std::shared_mutex&gt;\nstruct shared_mutex_guarded:private mutex_guarded&lt;T, M&gt; {\n  using base = mutex_guarded&lt;T, M&gt;;\n  template&lt;class F&gt;\n  auto read( F&amp;&amp; f ) const { return access(std::forward&lt;F&gt;(f)); }\n  template&lt;class F&gt;\n  auto write( F&amp;&amp; f ) { return access(std::forward&lt;F&gt;(f)); }\n\n  using base::base;\nprotected:\n  using base::access;\n  template&lt;class F&gt;\n  auto access( F&amp;&amp; f ) const {\n    auto l = lock();\n    return std::forward&lt;F&gt;(f)(this-&gt;t);\n  }\n  using base::lock;\n  auto lock() const { return std::shared_lock&lt;M&gt;(this-&gt;m); }\n};\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 5066038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rdJwa.jpg?s=128&g=1", "display_name": "asad_nitp", "link": "https://stackoverflow.com/users/5066038/asad-nitp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9107, "favorite_count": 4, "accepted_answer_id": 46453028, "answer_count": 3, "score": 17, "last_activity_date": 1506535813, "creation_date": 1506529976, "last_edit_date": 1506530642, "question_id": 46452973, "link": "https://stackoverflow.com/questions/46452973/difference-between-stdmutex-and-stdshared-mutex", "title": "difference between std::mutex and std::shared_mutex", "body": "<p>I came across an <code>std::shared_mutex</code> in <code>C++17</code>. what exactly is <code>std::shared_mutex</code> and how it is different from <code>std::mutex</code>?  </p>\n"}, {"tags": ["c++", "destructor"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506530294, "post_id": 46452962, "comment_id": 79861763, "body": "Do you have a <code>MyString(const char *cp)</code> constructor you are not showing?"}, {"owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506530329, "post_id": 46452962, "comment_id": 79861787, "body": "@Yes. I will add right now"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 3, "creation_date": 1506530370, "post_id": 46452962, "comment_id": 79861804, "body": "With <code>clang++ -Wall -Wextra</code>: <i>warning: field &#39;data&#39; will be initialized after field &#39;data_length&#39; [-Wreorder]     :data(new char[str.data_length]),</i>"}, {"owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506530514, "post_id": 46452962, "comment_id": 79861866, "body": "@NathanOliver hello, <code>MyString(const char *cp)</code> constr. added"}, {"owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1506530603, "post_id": 46452962, "comment_id": 79861908, "body": "@chris hello, can&#39;t get where is the problem?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1506530671, "post_id": 46452962, "comment_id": 79861936, "body": "@axcelenator, Fields are initialized in declaration order. The compiler&#39;s helping out by pointing out that you&#39;re using an uninitialized field."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 2, "creation_date": 1506530755, "post_id": 46452962, "comment_id": 79861983, "body": "@chris He isn&#39;t actually using an uninitialized field.  It is just telling him it is ignoring the order in the list."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506530933, "post_id": 46452962, "comment_id": 79862086, "body": "@NathanOliver, Woops, my brain switched the order."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1506531275, "post_id": 46452962, "comment_id": 79862267, "body": "Your <code>operator+=</code> looks suspect.  You never expand the storage for the new string to be added to so your overwriting memory you do not own.  That could definitely cause this issue."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1506531389, "post_id": 46452962, "comment_id": 79862331, "body": "[Off Topic] <code>if (data != nullptr){ delete[] data; }</code> is not needed.  <code>delete</code> on a <code>nullptr</code> is a non op so you can just use <code>delete[] data;</code>."}, {"owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506602073, "post_id": 46452962, "comment_id": 79893389, "body": "@NathanOliver Hello, I work with the debugger and <code>operator+=</code> looks to work nicely. What do you mean I have to expand the storage? <code>data_length</code> is grow like this <code>data_length += s.data_length;</code> and <code>std::copy</code> adds the two strings. In addition, all arrays are guaranteed to be null terminated"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1506602246, "post_id": 46452962, "comment_id": 79893528, "body": "You increased <code>data_length</code> but didn&#39;t allocate more space in <code>data</code>. Another issue is that your copy constructor doesn&#39;t allocate room for the null terminator."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506603096, "post_id": 46452962, "comment_id": 79894146, "body": "Please just use <code>data</code> instead of <code>stdext::checked_array_iterator&lt;char*&gt;(data, data_length)</code>  . It&#39;s equally safe, and more portable and easier to read"}, {"owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506603179, "post_id": 46452962, "comment_id": 79894218, "body": "@M.M Visual Studio compiler says it is not safe"}, {"owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1506603581, "post_id": 46452962, "comment_id": 79894567, "body": "@interjay hello how can I allocate more space for a string that it&#39;s data array exists? Do I need to delete the old data and create a new extra storage?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506604324, "post_id": 46452962, "comment_id": 79895106, "body": "@axcelenator disable that warning, it&#39;s just trying to lock you into MS specific code"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506604529, "post_id": 46452962, "comment_id": 79895259, "body": "agree that <code>operator+=</code> is badly broken"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1506606724, "post_id": 46452962, "comment_id": 79896906, "body": "@axcelenator if the string <code>cp</code> changes (say, mutated by another thread), the <code>checked_array_iterator</code> will prevent the buffer overflow. This makes the difference between a denial of service and a remote code execution."}], "owner": {"reputation": 1269, "user_id": 1501608, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e677965759e1b9096c8376c1f2384bc?s=128&d=identicon&r=PG&f=1", "display_name": "axcelenator", "link": "https://stackoverflow.com/users/1501608/axcelenator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506601749, "creation_date": 1506529935, "last_edit_date": 1506601749, "question_id": 46452962, "link": "https://stackoverflow.com/questions/46452962/following-the-rule-of-three-but-still-compiler-breaks-inside-destructor-c", "title": "following the rule of three but still compiler breaks inside destructor c++", "body": "<p>Hello here some of the main member function that constructs my own string class. </p>\n\n<p>When compilers return the new object from <code>friend MyString operator+</code> function it calls the destructor and then it breaks in the <code>delete[] data</code>; </p>\n\n<p>This how looks part of the class:</p>\n\n<pre><code>class MyString\n{\npublic:\n\n    ...\n\n//create a string from a null-terminated array\nMyString(const char *cp):data(new char[std::strlen(cp)+1]), data_length(std::strlen(cp))\n{\n    std::copy(cp, cp + std::strlen(cp), stdext::checked_array_iterator&lt;char*&gt;(data, data_length));\n    data[data_length] = '\\0';\n}       \n\n    //copy constructor\n    MyString(const MyString&amp; str) \n        :data(new char[str.data_length]), \n        data_length(str.data_length)\n    {\n        std::copy(str.data, str.data + str.data_length, \n        stdext::checked_array_iterator&lt;char*&gt;(data, data_length));\n        data[data_length] = '\\0';\n    }\n\n    //assignment operator #1\n    MyString&amp; operator=(const char *cp)\n    {\n        if (cp != data)\n        {\n            data_length = std::strlen(cp);\n            delete[] data;//delete the old data\n            data = new char[std::strlen(cp) + 1];//create new data array\n            std::copy(cp, cp + std::strlen(cp), stdext::checked_array_iterator&lt;char*&gt;(data, data_length));\n            data[data_length] = '\\0';\n        }\n\n        return *this;\n    }\n\n\n    //assignment operator #2 with self-assignment check\n    MyString&amp; operator=(const MyString&amp; str)\n    {\n        if (&amp;str != this)\n        {\n            data_length = std::strlen(str.data);\n            delete[] data;//delete the old data\n            data = new char[str.size() + 1];//create new data array\n            std::copy(str.data, str.data + str.size(), stdext::checked_array_iterator&lt;char*&gt;(data, data_length));\n            data[data_length] = '\\0';\n        }\n\n        return *this;\n    }\n\n\n    //destructor\n    ~MyString()\n    {\n        //free the array\n        if (data != nullptr)\n        {\n            delete[] data;\n        }           \n    };\n\n\n    MyString&amp; operator+=(MyString&amp; s)\n    {\n        std::copy(s.data, s.data + data_length, \n            stdext::checked_array_iterator&lt;char*&gt;(data+data_length, data_length));\n        data[data_length + s.data_length] = '\\0';\n        data_length += s.data_length;\n        return *this;\n    }\n\n    friend MyString operator+(MyString&amp; s1, MyString&amp; s2)\n    {\n        MyString str = s1;\n        str += s2;\n        return str;\n    }\n\n\nprivate:\n    size_t data_length;\n    char* data;\n\n};\n\n\nint main()\n{\n\n    MyString mystr1 = \"hello\";  \n    MyString s_con = mystr1 + mystr1;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "debugging", "gdb", "qt-creator"], "owner": {"reputation": 3747, "user_id": 1280794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/acaf89e21130377466e0caa60c839ec8?s=128&d=identicon&r=PG", "display_name": "spin_eight", "link": "https://stackoverflow.com/users/1280794/spin-eight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1507215107, "creation_date": 1506529882, "last_edit_date": 1507215107, "question_id": 46452943, "link": "https://stackoverflow.com/questions/46452943/debugging-is-not-working-in-qt-creator-4-0-2", "title": "Debugging is not working in Qt creator 4.0.2", "body": "<p>I have installed a new Qt Creator recently (4.0.2) and have faced with the issue that debugging stoped working:<br>\nI put breakpoint in main and it isn't being hit.<br>\nI build in debug mode &amp; run in debug.<br>\nI have gcc installed and Qt creator have found gdb from it.  </p>\n\n<p>When I start application from Qt creator in debugging mode I got:  </p>\n\n<pre><code>Debugging starts\nDebugging has finished\n</code></pre>\n\n<p>When I use gdb and start it from command line, gdb finds debugging symbols and everything works fine.  </p>\n\n<p>I have stumbled upon that latest versions of Qt creator requires python extensions:  </p>\n\n<blockquote>\n  <p>\"Starting with version 3.1, Qt Creator requires the Python scripting\n  extension. GDB builds without Python scripting are not supported\n  anymore and will not work. The minimum supported version is GDB 7.5\n  using Python version 2.7, or 3.3, or newer.\"</p>\n</blockquote>\n\n<p>but I haven't find any directions how to use/install that extensions.</p>\n"}, {"tags": ["c++", "c++11", "for-loop"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1506529819, "post_id": 46452896, "comment_id": 79861526, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506529905, "post_id": 46452896, "comment_id": 79861573, "body": "@NathanOliver Thanks! An answer here will be very helpful also."}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 5, "creation_date": 1506529996, "post_id": 46452896, "comment_id": 79861626, "body": "The range based for does not work as you expect: It does not iterate with a running index, but the elements of the container. In your case, the actual characters of the string"}, {"owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "reply_to_user": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 0, "creation_date": 1506531313, "post_id": 46452896, "comment_id": 79862280, "body": "@king_nak Can you kindly elaborate it a bit and recommend a fix, please? A reference to another webpage where I can find a clear instruction of how to do it will also be very helpful."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506531386, "post_id": 46452896, "comment_id": 79862325, "body": "Since you don&#39;t really benefit from the range based for loop I would just use a regular for loop with <code>j</code> being the index. for(int j = 0; j &lt; S.length(); ++j) { ... }"}, {"owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506531555, "post_id": 46452896, "comment_id": 79862417, "body": "@drescherjm I did that. See the commented part in the code. But Bjarne was suggesting using range-based for loop in <a href=\"https://www.youtube.com/watch?v=fX2W3nNjJIo\" rel=\"nofollow noreferrer\">CPPCON 2017 keynote</a>. I was trying to do that."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506531648, "post_id": 46452896, "comment_id": 79862477, "body": "Was the suggestion for this specific problem? A range based for is not the best solution for all situations."}, {"owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506531825, "post_id": 46452896, "comment_id": 79862568, "body": "@drescherjm he explained that too. but one compelling reason to use it, as i understood from his talk, over natural for is it is less clumsy and thus has lower chances of committing errors while writing it. certainly it is less general, Bjarne mentions that. If you have some time, listen to the lecture, it is so good! :)"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506532027, "post_id": 46452896, "comment_id": 79862671, "body": "I think the range based for it is more clumsy in this situation. There is an alternate way to fix your original code however. Declare <code>j</code> outside the range based for and increment it inside. Then adjust your range based loop <code>for (auto ch : S){</code> and use ch instead of <code>S[j]</code> in your push_back() calls."}, {"owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506532325, "post_id": 46452896, "comment_id": 79862827, "body": "@drescherjm I am too newbie in C++ to understand what you are suggesting. Can you write a code snippet in the answer to clarify it? If you get time, of course, thank you. To me it seems you are suggesting a method similar to Peter&#39;s answer, but probably I am misunderstanding."}], "answers": [{"comments": [{"owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "edited": false, "score": 0, "creation_date": 1506531661, "post_id": 46453323, "comment_id": 79862485, "body": "That is a very clever implementation of even and odd, imo! Thank you! Yes, it clarified my confusion also."}], "tags": [], "owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "is_accepted": true, "score": 1, "last_activity_date": 1506531289, "creation_date": 1506531289, "answer_id": 46453323, "question_id": 46452896, "link": "https://stackoverflow.com/questions/46452896/confusion-regarding-range-based-for-loop-in-c/46453323#46453323", "title": "Confusion regarding range-based for loop in C++", "body": "<p>The range-based for loop iterates over the elements of a container.  'j' in your code is a character in the string, not an index.  Try this:</p>\n\n<pre><code>for (auto character : S)\n{\n  if (even.length() &gt; odd.length())\n  {\n    odd.push_back(character);\n  }\n  else\n  {\n    even.push_back(character);\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 538, "user_id": 7252065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee425f022d98bd19a1a2268c12d3f33?s=128&d=identicon&r=PG&f=1", "display_name": "anotherone", "link": "https://stackoverflow.com/users/7252065/anotherone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 46453323, "answer_count": 1, "score": 1, "last_activity_date": 1506531289, "creation_date": 1506529727, "question_id": 46452896, "link": "https://stackoverflow.com/questions/46452896/confusion-regarding-range-based-for-loop-in-c", "title": "Confusion regarding range-based for loop in C++", "body": "<p>This code takes a string and then write outs the even and odd-positioned characters of the string as 2 separate strings separated by a space. I have solved the problem using standard for loop. But I am trying to use range-based for loop in it instead of the normal for loop (after getting fired up by Bjarne's 2017 CPPCON keynote). The normal for loop works fine and I have commented it in the following code-block.</p>\n\n<p>Problem is: The code compiles with g++ -std=c+11 command, but the even and odd strings are coming out garbled and reads like binary files. Can you please explain what I am doing wrong and exactly what is happening here? A clear explanation will be much appreciated. Thank you. </p>\n\n<pre><code>    string S,even,odd;\n    cout &lt;&lt; \"Enter a string:\\n\";\n    cin.ignore();   // So that getline does not catch \n    //the eol character\n    getline(cin,S);\n    // for (int j=0; j&lt;S.length(); j++){\n    //     if(j==0 || j%2==0){even.push_back(S[j]);}\n    //     else {odd.push_back(S[j]);}\n    // }\n    for (auto j : S){\n        if(j==0 || j%2==0){even.push_back(S[j]);}\n        else {odd.push_back(S[j]);}\n    }\n    cout &lt;&lt; \"You wrote: \" &lt;&lt; S &lt;&lt;'\\n';\n    cout &lt;&lt; \"Even(including 0) positioned character(s) \n    of \" &lt;&lt; S &lt;&lt; \" is(are) \" &lt;&lt; even &lt;&lt;'\\n';\n    cout &lt;&lt; \"Odd positioned character(s) of \" &lt;&lt; S &lt;&lt; \n    \" is(are) \" &lt;&lt; odd &lt;&lt;'\\n';\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1506529766, "post_id": 46452883, "comment_id": 79861496, "body": "Showing the errors would help."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1506529782, "post_id": 46452883, "comment_id": 79861506, "body": "What exactly do you want <code>for_each(circleList.begin(), circleList.end(), returnRadius);</code> to return since each circle has it&#39;s own radius?"}, {"owner": {"reputation": 83, "user_id": 4864459, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/62b3e353f88f8eba2d342e6244f2eb40?s=128&d=identicon&r=PG&f=1", "display_name": "jaryl", "link": "https://stackoverflow.com/users/4864459/jaryl"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506529951, "post_id": 46452883, "comment_id": 79861598, "body": "@NathanOliver the radius of each circle... for_each iterates through the circles list and returnRadius returns each radius"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1506530106, "post_id": 46452883, "comment_id": 79861680, "body": "@jaryl <code>for_each</code> returns <b>just once</b>. It calls <code>returnRadius</code> multiple times, but it (<code>for_each</code>) returns just once. So when you say you want <code>for_each</code> to return each circle that doesn&#39;t make any sense."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506530149, "post_id": 46452883, "comment_id": 79861703, "body": "@jaryl And what do you want to do with those?  Are you trying to build a list of the radii?"}, {"owner": {"reputation": 83, "user_id": 4864459, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/62b3e353f88f8eba2d342e6244f2eb40?s=128&d=identicon&r=PG&f=1", "display_name": "jaryl", "link": "https://stackoverflow.com/users/4864459/jaryl"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1506530218, "post_id": 46452883, "comment_id": 79861738, "body": "@RichardCritten but that&#39;s the thing. There are errors because I&#39;m trying to make for_each return the radius, but what I really want is for the callback function to return the radius, but I don&#39;t know how to do that. Anyway, I updated the question with the errors"}, {"owner": {"reputation": 83, "user_id": 4864459, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/62b3e353f88f8eba2d342e6244f2eb40?s=128&d=identicon&r=PG&f=1", "display_name": "jaryl", "link": "https://stackoverflow.com/users/4864459/jaryl"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1506530552, "post_id": 46452883, "comment_id": 79861889, "body": "@bolov Exactly! I know it doesn&#39;t make sense to make for_each return each radius. The callback should do this, it&#39;s the one that&#39;s iterating through the circles, after all. My question is how to do this. How do I get the value returned by the callbak?"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1506530554, "post_id": 46452883, "comment_id": 79861890, "body": "@jaryl you have 3 circles in the list. One has radius <code>10</code>, another has the radius <code>20</code> and the last one has the radius <code>40</code>. <code>float radius = for_each(...)</code>. What value do you expect the variable <code>radius</code> to have after executing this code?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4864459, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/62b3e353f88f8eba2d342e6244f2eb40?s=128&d=identicon&r=PG&f=1", "display_name": "jaryl", "link": "https://stackoverflow.com/users/4864459/jaryl"}, "edited": false, "score": 0, "creation_date": 1506530850, "post_id": 46452936, "comment_id": 79862031, "body": "To be honest here, I was only using for_each because I tried to iterate through the list, but I couldn&#39;t access the struct data and I got a lot of errors. But this worked. It&#39;s strange, because the syntax I used was very much like this one."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 83, "user_id": 4864459, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/62b3e353f88f8eba2d342e6244f2eb40?s=128&d=identicon&r=PG&f=1", "display_name": "jaryl", "link": "https://stackoverflow.com/users/4864459/jaryl"}, "edited": false, "score": 2, "creation_date": 1506530901, "post_id": 46452936, "comment_id": 79862061, "body": "@jaryl: <code>for_each</code> is neat, but in reality, I&#39;ve never found a use for it. A regular <code>for</code> loop is almost always better."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 5, "last_activity_date": 1506529870, "creation_date": 1506529870, "answer_id": 46452936, "question_id": 46452883, "link": "https://stackoverflow.com/questions/46452883/is-it-possible-to-make-a-callback-function-in-c-return-a-value/46452936#46452936", "title": "Is it possible to make a callback function in c++ return a value?", "body": "<p>I'd say you're overcomplicating things.</p>\n\n<pre><code>for (const auto &amp;it : circleList)\n{\n    // Do whatever you wand with `it.r` here.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1506531449, "last_edit_date": 1506531449, "creation_date": 1506529901, "answer_id": 46452950, "question_id": 46452883, "link": "https://stackoverflow.com/questions/46452883/is-it-possible-to-make-a-callback-function-in-c-return-a-value/46452950#46452950", "title": "Is it possible to make a callback function in c++ return a value?", "body": "<blockquote>\n  <p>Is it possible to make a callback function in c++ return a value?</p>\n</blockquote>\n\n<p>Your title is not much related to the question's body, but I am focusing on it, and understand <a href=\"https://en.wikipedia.org/wiki/Callback_(computer_programming)\" rel=\"nofollow noreferrer\">callbacks</a> in a usual way.</p>\n\n<p>It could depend upon your C++ version. I hope you use at least C++11, then you can have <a href=\"http://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">lambda expressions</a> and <a href=\"http://en.cppreference.com/w/cpp/utility/functional/function\" rel=\"nofollow noreferrer\"><code>std::function</code></a>-s and <a href=\"http://en.cppreference.com/w/cpp/algorithm\" rel=\"nofollow noreferrer\"><code>&lt;algorithm&gt;</code></a></p>\n\n<p>Here is how to get a list (actually <code>std::list&lt;float&gt;</code>) of areas using <a href=\"http://en.cppreference.com/w/cpp/algorithm/transform\" rel=\"nofollow noreferrer\">std::transform</a> (often called <a href=\"https://en.wikipedia.org/wiki/Map_(higher-order_function)\" rel=\"nofollow noreferrer\">map</a> in other programming languages) with a lambda expression:</p>\n\n<pre><code> auto areaList = std::transform(circleList.begin(), circleList.end(),\n                                [] (const circle&amp;c) \n                                { return c.r*c.r*M_PI; });\n</code></pre>\n\n<p><sup>(you should be able to adapt that to your TinyXML thing)</sup></p>\n\n<p>You should read a good C++11 <a href=\"http://stroustrup.com/Programming/\" rel=\"nofollow noreferrer\">programming book</a>.</p>\n\n<p>You could read <a href=\"https://mitpress.mit.edu/sicp/\" rel=\"nofollow noreferrer\">SICP</a> and the <a href=\"https://en.wikipedia.org/wiki/Closure_(computer_programming)\" rel=\"nofollow noreferrer\">closure</a> and <a href=\"https://en.wikipedia.org/wiki/Anonymous_function\" rel=\"nofollow noreferrer\">anonymous functions</a> wikipages</p>\n"}, {"tags": [], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "is_accepted": false, "score": 1, "last_activity_date": 1506531147, "creation_date": 1506531147, "answer_id": 46453292, "question_id": 46452883, "link": "https://stackoverflow.com/questions/46452883/is-it-possible-to-make-a-callback-function-in-c-return-a-value/46453292#46453292", "title": "Is it possible to make a callback function in c++ return a value?", "body": "<pre><code>float radius = for_each(circleList.begin(), circleList.end(), returnRadius);\n</code></pre>\n\n<p><code>for_each</code> doesn't return anything. It called <code>returnRadius</code> for each value, and it's now done. Exactly what you told it to do. If you want to do more than simply call <code>returnRadius</code> for each, then you've lied to the compiler about what you want it to do for each item.</p>\n\n<pre><code>auto print_radius = [](const circle &amp;data) {\n    std::cout &lt;&lt; returnRadius(data) &lt;&lt; '\\n';\n};\nstd::for_each(circleList.begin(), circleList.end(), print_radius);\n</code></pre>\n\n<p>In general, I avoid <code>std::for_each</code>. It's super neat, but makes code confusing to read.</p>\n\n<p><hr>\nIf you're playing around with <code>std::for_each</code>, it can also be interesting to learn about <code>boost::transform_iterator</code>. It goes something like this:</p>\n\n<pre><code>//make iterators that transform circles to radius' on the fly\nauto first = boost::make_transform_iterator(circleList.begin(), returnRadius); \nauto last = boost::make_transform_iterator(circleList.end(), returnRadius);\n//copy these radius' to cout.\nstd::copy(first, last, std::ostream_iterator(std::cout);\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4864459, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/62b3e353f88f8eba2d342e6244f2eb40?s=128&d=identicon&r=PG&f=1", "display_name": "jaryl", "link": "https://stackoverflow.com/users/4864459/jaryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 0, "accepted_answer_id": 46452936, "answer_count": 3, "score": 0, "last_activity_date": 1506531449, "creation_date": 1506529649, "last_edit_date": 1506530342, "question_id": 46452883, "link": "https://stackoverflow.com/questions/46452883/is-it-possible-to-make-a-callback-function-in-c-return-a-value", "title": "Is it possible to make a callback function in c++ return a value?", "body": "<p>I have a circle struct and a list to store circles:</p>\n\n<pre><code>struct circle\n{\n    float r;\n    int id;\n};\nlist&lt;circle&gt; circleList;\n</code></pre>\n\n<p>I'm using Tinyxml to parse an xml document with information about circles (radius and id) and store then in the list: (this is in the main function)</p>\n\n<pre><code>circle c;\n\nfor(TiXmlElement* e = objectTree; e != NULL; e = e-&gt;NextSiblingElement())\n{\n    c.r = atof(e-&gt;Attribute(\"r\"));\n    c.id = atoi(e-&gt;Attribute(\"id\"));\n\n    circleList.push_back(c);\n}\n</code></pre>\n\n<p>It's working fine, I used for_each to print the values and it works, the circles are being stored in the list. But at some point in the code I need to get the radius of each circle. I tried to do this in the main function, just after the for loop which stores the circles in a list:</p>\n\n<pre><code>float radius = for_each(circleList.begin(), circleList.end(), returnRadius);\n</code></pre>\n\n<p>Here is the callback function:</p>\n\n<pre><code>float returnRadius(circle &amp;data)\n{\n    return data.r;\n}\n</code></pre>\n\n<p>But I'm getting a lot of errors, probably because of that line in which I create a value called radius and try to store the value returned by for_each in it, which is totally wrong, I know. But my intention is finding a way to get the values returned by the callback function returnRadius. Is there a way to do this?</p>\n\n<p>When I try to do this:</p>\n\n<pre><code>float radius = for_each(circleList.begin(), circleList.end(), returnRadius);\n</code></pre>\n\n<p>I get these errors:</p>\n\n<pre><code>error: cannot convert \u2018float (*)(circle&amp;)\u2019 to \u2018float\u2019 in initialization\nfloat radius = for_each(circleList.begin(), circleList.end(), returnRadius);\n</code></pre>\n\n<p>Which I understand because I'm trying to make the for_each function return the radius, but what I really want (and don't know how to do) is for the callback function to return the radius, after all, it's the callback that's retrieving this information</p>\n"}, {"tags": ["c++", "inheritance"], "answers": [{"tags": [], "owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "is_accepted": true, "score": 4, "last_activity_date": 1506529864, "creation_date": 1506529864, "answer_id": 46452934, "question_id": 46452788, "link": "https://stackoverflow.com/questions/46452788/any-purpose-of-using-base-class-pointers-to-derived-class-if-virtual-function-is/46452934#46452934", "title": "Any purpose of using base class pointers to derived class if virtual function is not used", "body": "<p>Using a base class pointer or reference allows you to write functions that accept <em>all</em> derived classes of the base generically so you can call common non-virtual functions on them. Otherwise, you'd have to write the same function multiple times for the different derived classes, or use templates.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass base_t {\npublic:\n    void non_virtual() const { std::cout &lt;&lt; \"Hello, World!\\n\"; }\n};\n\nclass derived_1_t : public base_t { };\nclass derived_2_t : public base_t { };\n\nvoid do_something(const base_t&amp; obj) {\n    obj.non_virtual();\n}\n\nint main() {\n    derived_1_t var1;\n    derived_2_t var2;\n    do_something(var1);\n    do_something(var2);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "is_accepted": false, "score": 1, "last_activity_date": 1506530034, "creation_date": 1506530034, "answer_id": 46452989, "question_id": 46452788, "link": "https://stackoverflow.com/questions/46452788/any-purpose-of-using-base-class-pointers-to-derived-class-if-virtual-function-is/46452989#46452989", "title": "Any purpose of using base class pointers to derived class if virtual function is not used", "body": "<p>While you can intentionally hide functions from the base class, it is most often an unintentional mistake (or poor design) to do so. The C++11 <code>override</code> keyword was introduced to help prevent this mistake.</p>\n\n<p>There are other use cases for inheritance beyond virtual functions and polymorphism. For instance: (1) one might put a bunch of objects in a heterogeneous container such as <code>std::vector&lt;Employee*&gt;</code> where it doesn't need access to the derived class data, though this is probably suspect without polymorphism also, (2) inheriting behavior or POD data members (also questionable practice), or (3) inheriting for policy-based design (see Alexandrescu's <em>Modern C++ Design</em>).</p>\n\n<p>Generally, you also want a destructor for inheritance roots. <a href=\"http://www.gotw.ca/publications/mill18.htm\" rel=\"nofollow noreferrer\">Herb Sutter says</a>, \"A base class destructor should be either public and virtual, or protected and nonvirtual.\"</p>\n\n<p>You might also consider not using inheritance in this way. See \"<a href=\"https://www.youtube.com/watch?v=QGcVXgEVMJg\" rel=\"nofollow noreferrer\">Better Code: Runtime Polymorphism</a>\" by Sean Parent, which may just blow your mind.</p>\n"}], "owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 1, "accepted_answer_id": 46452934, "answer_count": 2, "score": 3, "last_activity_date": 1506530034, "creation_date": 1506529322, "question_id": 46452788, "link": "https://stackoverflow.com/questions/46452788/any-purpose-of-using-base-class-pointers-to-derived-class-if-virtual-function-is", "title": "Any purpose of using base class pointers to derived class if virtual function is not used", "body": "<p>I was looking at several SO posts (listed below) regarding the benefit of using base class  pointer to a derived class object.  But in most of the cases, virtual function is the ultimate purpose of using base class pointer. I added comments to some of these posts, but I guess since the posts are old, responses were not received. \nNow my question is, if we do not use virtual function concept, are there any purpose of using base class pointer in some other case? </p>\n\n<p>In the code below, </p>\n\n<blockquote>\n  <p>pEmp->computeTotalSalary</p>\n</blockquote>\n\n<p>calls base class function since virtual function is missing. This is expected behavior.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nclass Employee\n{\npublic:\n\n    void computeTotalSalary ()\n    {\n        cout&lt;&lt;\"Computing Employee Salary in Base Class:\"&lt;&lt;endl;\n    }\n};\n\nclass TeachingStaff : public Employee\n{\npublic:\n    // Override the function\n\n    void computeTotalSalary ()\n    {\n        cout&lt;&lt;\"Computing Teacher's Salary in Sub class: \"&lt;&lt;endl;\n    }\n};\n\nint main()\n{\n    TeachingStaff *pTeacher = new TeachingStaff() ;\n    pTeacher-&gt;computeTotalSalary();\n    Employee *pEmp;\n    pEmp = pTeacher;\n    pEmp-&gt;computeTotalSalary();\n    pTeacher-&gt;Employee::computeTotalSalary();\n}\n</code></pre>\n\n<p>Links:\n1. <a href=\"https://stackoverflow.com/questions/9425822/why-use-base-class-pointers-for-derived-classes/9425976#comment79821615_9425976\">Why use base class pointers for derived classes</a></p>\n\n<ol start=\"2\">\n<li><p><a href=\"https://stackoverflow.com/questions/4937180/a-base-class-pointer-can-point-to-a-derived-class-object-why-is-the-vice-versa/4937234#comment79818713_4937234\">A Base Class pointer can point to a derived class object. Why is the vice-versa not true?</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/13450570/assigning-derived-class-pointer-to-base-class-pointer-in-c/13450662#comment79818220_13450662\">assigning derived class pointer to base class pointer in C++</a></p></li>\n</ol>\n"}, {"tags": ["c++", "qt", "qlist"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1506529260, "post_id": 46452704, "comment_id": 79861191, "body": "<b><i>Is that because I am not allowed to make a QList of QAbstractListModel ?</i></b> No. You have a bug somewhere in your code. Perhaps <code>this</code> is a nullptr."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506529809, "post_id": 46452704, "comment_id": 79861517, "body": "@drescherjm say what?"}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 1, "creation_date": 1506529844, "post_id": 46452704, "comment_id": 79861545, "body": "@highvoltage379 no, you can have a list of pointers to anything.. or even to nothing. The problem probably lies elsewhere."}, {"owner": {"reputation": 25, "user_id": 8289087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cea715243963332359827c6ea70684bf?s=128&d=identicon&r=PG&f=1", "display_name": "highvoltage379", "link": "https://stackoverflow.com/users/8289087/highvoltage379"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506529929, "post_id": 46452704, "comment_id": 79861583, "body": "@drescherjm Yeah, I&#39;m sorry but I am not quite sure I see what you mean."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506530274, "post_id": 46452704, "comment_id": 79861754, "body": "<b><i>I&#39;m sorry but I am not quite sure I see what you mean</i></b> Your bug is somewhere else in your code. Time to use your debugger to try to figure out where."}], "owner": {"reputation": 25, "user_id": 8289087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cea715243963332359827c6ea70684bf?s=128&d=identicon&r=PG&f=1", "display_name": "highvoltage379", "link": "https://stackoverflow.com/users/8289087/highvoltage379"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506529027, "creation_date": 1506529027, "question_id": 46452704, "link": "https://stackoverflow.com/questions/46452704/is-it-possible-to-make-qlistqabstractlistmodel", "title": "Is it possible to make QList&lt;QAbstractListModel&gt;?", "body": "<p>I have a custom C++ class, called CPage, which inherits of QAbstractListModel.</p>\n\n<pre><code>class CPage : public QAbstractListModel\n</code></pre>\n\n<p>In another class called CSession, I want to have a set of CPage. For this purpose, CSession have a private attribute called Q_PageSet:</p>\n\n<pre><code>QList&lt;CPage*&gt; Q_PageSet;\n</code></pre>\n\n<p>My problem is: when I try to do the following, my program crashes:</p>\n\n<pre><code>Q_PageSet.size() or Q_PageSet.count()\n</code></pre>\n\n<p>So my question is: Is that because I am not allowed to make a QList of QAbstractListModel ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 0, "creation_date": 1506528850, "post_id": 46452554, "comment_id": 79860967, "body": "Fails to compile: <code>error: unknown type name &#39;uint64_t&#39;</code> and <code>error: use of undeclared identifier &#39;cout&#39;</code>. Also, GCC 4.7.3 is ancient, you should upgrade."}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1506529006, "post_id": 46452554, "comment_id": 79861054, "body": "50000 on my MinGW-w64 (no idea what version) w/ gcc 7.1"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 0, "creation_date": 1506529018, "post_id": 46452554, "comment_id": 79861062, "body": "@tambre Yes, technically it isn\u2019t a minimal, <i>complete</i>, and verifiable example. You are well aware that those are in <code>&lt;cstdint&gt;</code> and <code>iostream</code>, respectively, and this is probably not an include file error."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506529141, "post_id": 46452554, "comment_id": 79861129, "body": "What compiler flags are you using?"}, {"owner": {"reputation": 369, "user_id": 3476183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a7dda5864aa1b7c18ec44452576bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Albjenow", "link": "https://stackoverflow.com/users/3476183/albjenow"}, "edited": false, "score": 0, "creation_date": 1506529219, "post_id": 46452554, "comment_id": 79861163, "body": "You could try printing out the binary representation of <code>0.01</code> on each platform since this is not representable in base 2 with a finite number of digits."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1506529221, "post_id": 46452554, "comment_id": 79861165, "body": "Calculate <code>raw</code> as a double, print it out to at least 6 decimal places."}, {"owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "edited": false, "score": 0, "creation_date": 1506529270, "post_id": 46452554, "comment_id": 79861198, "body": "<a href=\"https://stackoverflow.com/questions/2100490/floating-point-inaccuracy-examples\" title=\"floating point inaccuracy examples\">stackoverflow.com/questions/2100490/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506529322, "post_id": 46452554, "comment_id": 79861238, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\" title=\"is floating point math broken\">stackoverflow.com/questions/588004/&hellip;</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1506529475, "post_id": 46452554, "comment_id": 79861316, "body": "Using <code>double raw</code>, do <code>std::cout &lt;&lt; std::setiosflags(std::ios::fixed) &lt;&lt;  std::setprecision(24) &lt;&lt; raw &lt;&lt; std::endl</code> to find out more."}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1506529578, "post_id": 46452554, "comment_id": 79861380, "body": "<code>0.01</code> is a &quot;repeating decimal&quot;., when you convert to binary (I believe it would be a repeating binary then). The outdated compilers usually  fails due to lack of precision..."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506529828, "post_id": 46452554, "comment_id": 79861533, "body": "The value of <code>0.01</code> as a double is actually <i>very</i> slightly more than 0.01, because there is no <code>double</code> which precisely represents that value. However, there is also no <code>double</code> which precisely represents 500 divided by the double <code>0.01</code>, and the closest is precisely <code>50000</code>. I don\u2019t know why any compiler would give <code>49999</code>. These details depend on using IEEE-754 doubles, but I would be shocked if gcc 4.7.3 on x86 or x64 didn\u2019t."}, {"owner": {"reputation": 1228, "user_id": 891624, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-seU1VV49VN0/AAAAAAAAAAI/AAAAAAAAAag/jWjaDxnkV8A/photo.jpg?sz=128", "display_name": "mxcd", "link": "https://stackoverflow.com/users/891624/mxcd"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506530245, "post_id": 46452554, "comment_id": 79861744, "body": "@DanielH I didnt set any additional compiler flags in my cmake file"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506530898, "post_id": 46452554, "comment_id": 79862060, "body": "The difference could be because of SSE vs. FPU. FPU calculates with an internal precision of 80-bit. You should not depend on the calculation of floating point preciseness, when a number (in this case, 0.01) cannot be represented in binary. (usually, FPU is used for floating point calculations in 32-bit mode, in 64-bit mode SSE is used)"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506531214, "post_id": 46452554, "comment_id": 79862229, "body": "@geza But would it do a different calculation only if it were going to immediately truncate the result? To me this looks like it\u2019s more likely a one-ulp compiler bug; I think C++ does specify that <code>rawInt</code> and <code>static_cast&lt;unsigned long&gt;(rawDouble)</code> should have the same value, and given the output in the question the latter should be <code>50000</code>."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506531323, "post_id": 46452554, "comment_id": 79862287, "body": "@maximilian009 Can you verify what <code>static_cast&lt;unsigned long&gt;(rawDouble)</code> is?"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506531591, "post_id": 46452554, "comment_id": 79862436, "body": "@DanielH: in the FPU case, division result stored in a 80-bit internal register, then it is popped out to long. In the SSE case, division result stored in a 64-bit internal register, then converted to long. It is enough to make a difference. I&#39;m not saying it is 100% sure this is the case here, but this can happen."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506531718, "post_id": 46452554, "comment_id": 79862510, "body": "I think if you set FPU internal precision to 64-bit, you might get 50000."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1506533218, "post_id": 46452554, "comment_id": 79863261, "body": "@geza In 80-bit format, the division and truncation seem to result in 49999 (although I\u2019m having trouble finding the exact intermediate values). I\u2019m just surprised GCC is allowed to give different answers depending on when you do the cast; I thought it was forced to do intermediate rounding. Is that a GNU extension or something?"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1506536361, "post_id": 46452554, "comment_id": 79864866, "body": "@DanielH: GCC cannot solve this issue at all. If division is done with 80-bit precision, you cannot &quot;convert&quot; it to 64-bit to simulate 64-bit division. 2 rounding vs. 1 rounding. Btw, there is &quot;-ffloat-store&quot; option which forces GCC to put 80-bit results to 64-bit/32-bit variables. Maybe it fixes the current issue. But as far as I know, this cannot fix all cases (because of the extra rounding)."}], "owner": {"reputation": 1228, "user_id": 891624, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-seU1VV49VN0/AAAAAAAAAAI/AAAAAAAAAag/jWjaDxnkV8A/photo.jpg?sz=128", "display_name": "mxcd", "link": "https://stackoverflow.com/users/891624/mxcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506529970, "creation_date": 1506528547, "last_edit_date": 1506529970, "question_id": 46452554, "link": "https://stackoverflow.com/questions/46452554/c-different-numeric-results-across-platforms", "title": "C++ Different numeric results across platforms", "body": "<p>I have the following piece of code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main() {\n\n    double value = 0;\n    double gain = 0.01;\n    double offset = -500;\n\n    value -= offset;\n    unsigned long raw = value / gain;\n    cout &lt;&lt; raw;\n\n    return 0; \n}\n</code></pre>\n\n<p>On my Windows machine with MinGW 5.0 and gcc 4.7.3 the console output of this programm is 49999 instead of 50000. Using some random online IDE (<a href=\"https://ideone.com/uDhPFM\" rel=\"nofollow noreferrer\">https://ideone.com/uDhPFM</a>) as well as my linux machine, the result is 50000 as expected.</p>\n\n<p>Why is that so? </p>\n\n<p><strong>EDIT:</strong> On both, Windows and Linux, I am using the default installation of CLion to run the program.</p>\n\n<p><strong>UPDATE:</strong>  </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    double value = 0;\n    double gain = 0.01;\n    double offset = -500;\n\n    value = value - offset;\n    double rawDouble = value / gain;\n    unsigned long rawInt = value / gain;\n    cout &lt;&lt; rawDouble &lt;&lt; endl;\n    cout &lt;&lt; rawInt &lt;&lt; endl;\n    cout &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(24) &lt;&lt; rawDouble &lt;&lt; endl;\n    cout &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(24) &lt;&lt; (value / gain) &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Using this code the output is</p>\n\n<pre><code>50000\n49999\n50000.000000000000000000000000\n50000.000000000000000000000000\n</code></pre>\n\n<p>Only the division in direct relation to the assignment / inplicit cast seems to fail.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1506529083, "post_id": 46452535, "comment_id": 79861101, "body": "Try to shorten the code so that the problem still occurs. No one will read through 200 lines of code"}], "answers": [{"comments": [{"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 3, "creation_date": 1506529284, "post_id": 46452744, "comment_id": 79861209, "body": "Might be worth recommending he use his already made <code>pop</code> member function for the destructor (would make the code maybe 3-5 lines max and far more readable)."}], "tags": [], "owner": {"reputation": 217, "user_id": 1774084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50caaf8e5b6670b3c64e695f79157d0?s=128&d=identicon&r=PG", "display_name": "Actarus", "link": "https://stackoverflow.com/users/1774084/actarus"}, "is_accepted": true, "score": 2, "last_activity_date": 1506529174, "creation_date": 1506529174, "answer_id": 46452744, "question_id": 46452535, "link": "https://stackoverflow.com/questions/46452535/tortoise-and-hare-dont-have-adresses-c/46452744#46452744", "title": "Tortoise and Hare don&#39;t have adresses, C++", "body": "<p>You have an issue in <code>LinkedList</code> destructor.\nWhen you assign the <code>next</code> element of <code>l[4]</code> to be <code>l[1]</code>, basically you have cycle (which seems what you wanted).\nBut the last element (<code>l[4]</code>) points on an existing element.\nSo in the destructor you are trying to destroy <code>l[1]</code> twice : the first time just after delete <code>l[0]</code>, and the second time after deleting <code>l[4]</code>.\nYou should review the design of your list, and in particular the way you destroy it.</p>\n"}], "owner": {"reputation": 3, "user_id": 8684181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8257681546a220bac08254a57b5dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Majilee", "link": "https://stackoverflow.com/users/8684181/majilee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 46452744, "answer_count": 1, "score": -3, "last_activity_date": 1506529174, "creation_date": 1506528451, "question_id": 46452535, "link": "https://stackoverflow.com/questions/46452535/tortoise-and-hare-dont-have-adresses-c", "title": "Tortoise and Hare don&#39;t have adresses, C++", "body": "<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass Element\n{\npublic:\n    Element* next;\n    double field;\n};\n\nclass LinkedList\n{\nprotected:\n    Element* begin;\n    int num;\npublic:\n    int Number() {return num;}\n    LinkedList() \n    {\n        begin = NULL;\n        num = 0;\n    }\n    LinkedList(LinkedList&amp; L) \n    {\n        begin = new Element;\n        num = L.Number();\n        begin = L.begin;\n    }\n\n    virtual void push(double a)\n    {\n        Element* cur = begin;\n        if(begin==NULL)\n        {\n            num = 1;\n            begin = new Element;\n            begin-&gt;field = a;\n            begin-&gt;next = NULL;\n            return;\n        }\n\n        while(cur-&gt;next!=NULL)\n        {\n            cur = cur-&gt;next;\n        }\n        num ++ ;\n\n        cur-&gt;next = new Element;\n        cur-&gt;next-&gt;field = a;\n        cur-&gt;next-&gt;next = NULL;\n    }\n    virtual double pop()\n    {\n        Element* cur = begin;\n        Element* prev = NULL;\n\n        if(begin==NULL)\n        {\n            return -1;\n        }\n        if(num==1)\n        {\n            double res = begin-&gt;field;\n            num--;\n            return res;\n        }\n\n        while(cur-&gt;next!=NULL)\n        {\n            prev = cur;\n            cur = cur-&gt;next;\n        }\n        double res = cur-&gt;field;\n        prev-&gt;next = NULL;\n        delete cur;\n        num--;\n        return res;\n    }\n\n    ~LinkedList()\n    {\n        num = 0;\n        Element* cur = begin;\n        if(cur!=NULL)\n            cur = cur-&gt;next;\n        while(cur!=NULL)\n        {\n            Element* prev = cur;\n            cur = cur-&gt;next;\n            delete prev;\n        }\n        if(begin!=NULL)\n            delete begin;\n    }\n    Element* operator[](int i)\n    {\n        if(i&lt;0 || i&gt;num) return NULL;\n        int k = 0;\n        Element* cur = begin;\n        for(k=0;k&lt;i;k++)\n        {\n            cur = cur-&gt;next;\n        }\n        return cur;\n    }\n};\n\nclass R_LinkedList: public LinkedList{\npublic:\n\n    double pop() {\n        double res = begin-&gt;field;\n        begin = begin-&gt;next;\n        num--;\n        return res;\n    }\n    bool cycle_search() {\n        Element* tortoise = begin, *hare = begin;\n\n        while(tortoise &amp;&amp; hare &amp;&amp; hare-&gt;next) {\n            tortoise = tortoise-&gt;next;\n            hare = hare-&gt;next-&gt;next;\n            if(tortoise == hare) {\n                cout &lt;&lt; \"Got loop\" &lt;&lt; endl;\n                return 1;\n            }           \n        }\n        cout &lt;&lt; \"No loop\" &lt;&lt; endl; return 0;\n    }\n};\n\nint main()\n{\n    R_LinkedList l;\n    l.push(2); l.push(3); l.push(6);l.push(3);l.push(6);\n    cout  &lt;&lt; l[2]-&gt;field &lt;&lt; endl;\n    l[4]-&gt;next = l[1];\n    l.cycle_search();\n    return 0;\n}\n</code></pre>\n\n<p>Scroll down, then up.</p>\n\n<p>So I have this code and trying to implement classic \"tortoise and hare\" cycle finding algorythm (and also overload virtual function, but that's not the problem [yet]). And it works fine! It prints value, it says happily \"Got loop!\"\nAnd then it breaks, screaming</p>\n\n<pre><code>HEAP[TestConsole2.exe]: Invalid address specified to RtlValidateHeap( 002E0000, 002EF8F0 )\n</code></pre>\n\n<p>An adress problem. Favorite. Honestly tried to debug, and he worked it all throught the end and broke again. So it's something with the destructor, but - hell - have no idea what exactly.\nOr maybe it's about the algorythm itself. Or I am the problem 'cause don't see something obvious or lack fundamentals.</p>\n"}, {"tags": ["c++", "c++14", "move-semantics"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506528002, "post_id": 46452310, "comment_id": 79860412, "body": "related: <a href=\"https://stackoverflow.com/questions/2139224/how-to-pass-objects-to-functions-in-c\" title=\"how to pass objects to functions in c\">stackoverflow.com/questions/2139224/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 0, "creation_date": 1506528452, "post_id": 46452385, "comment_id": 79860719, "body": "That&#39;s an good one, but there is one small problem for me with it. For now I don&#39;t relate on <code>A</code> constructor parameters anywhere in <code>B</code> header file. And with your solution it would require to give more information (that I think is more related to <code>A</code> than <code>B</code>) in <code>B</code> header file. It&#39;s more the matter of the appearance tho."}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 0, "creation_date": 1506528672, "post_id": 46452385, "comment_id": 79860861, "body": "@PolGraphic I didn&#39;t get what you mean, you meant adding <code>#include &quot;A.h&quot;</code> in <code>B.h</code>? No, it should be same with the one using <code>push_back</code>, if the member fucntion is defined in <code>B.cpp</code>, it&#39;s not needed."}, {"owner": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 0, "creation_date": 1506529008, "post_id": 46452385, "comment_id": 79861057, "body": "No, I mean that inside of <code>B.h</code> I will have to know &amp; remember about <code>A</code> constructor parameters order. And in case of changes with it, I will also have to modify <code>B.h</code>."}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": false, "score": 1, "last_activity_date": 1506528354, "last_edit_date": 1506528354, "creation_date": 1506528015, "answer_id": 46452385, "question_id": 46452310, "link": "https://stackoverflow.com/questions/46452310/avoiding-copy-constructor-during-populating-member-vector/46452385#46452385", "title": "Avoiding copy constructor during populating member vector", "body": "<p>You might change the parameter type of <code>addObject</code> and use <code>emplace_back</code>, to avoid constructing an object of <code>A</code> which won't be used later and copying it into the <code>vector</code>. e.g.</p>\n\n<pre><code>void addObject(int value1, int value2, std::string text) {\n  objects.emplace_back(value1, value2, text);\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>B b;\nb.addObject(2, 5, \"test\"); // construct the element directly into the vector without constructing A\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 0, "creation_date": 1506528332, "post_id": 46452399, "comment_id": 79860624, "body": "Thank you :) One question: is the <code>text(std::move(text))</code> from your side note completely safe in all cases? Also, isn&#39;t it something that the compiler would do automatically either way (move instead of copy there because of optimization)?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 1, "creation_date": 1506530065, "post_id": 46452399, "comment_id": 79861663, "body": "@PolGraphic Yes - the constructor owns <code>text</code> so it&#39;s safe to move from. And no, it won&#39;t."}, {"owner": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 0, "creation_date": 1506535660, "post_id": 46452399, "comment_id": 79864517, "body": "thanks for the further explanation. It&#39;s a bit around the topic but does <code>A a(2,5,&quot;test&quot;); b.addObject(std::move(a));</code> in second solution is any different from<code>b.addObject(A{2,5,&quot;test&quot;});</code> in case of performance (the second one creates <code>A</code> and than moves it or not really)?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "edited": false, "score": 0, "creation_date": 1506537127, "post_id": 46452399, "comment_id": 79865277, "body": "@PolGraphic The moved-from <code>A</code> will destroyed within <code>addObject()</code> in the second case, but at the end of the scope of <code>a</code> in the first case. But, basically the same."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 5, "last_activity_date": 1506528054, "creation_date": 1506528054, "answer_id": 46452399, "question_id": 46452310, "link": "https://stackoverflow.com/questions/46452310/avoiding-copy-constructor-during-populating-member-vector/46452399#46452399", "title": "Avoiding copy constructor during populating member vector", "body": "<p>There are many answers to this question. You could just change your <code>B</code> function to <code>move()</code>, and <code>move()</code> into that function:</p>\n\n<pre><code>void addObject(A a) { objects.push_back(std::move(a)); }\n\nb.addObject(std::move(a)); // two moves\n</code></pre>\n\n<p>You could add overloads of <code>addObject</code> that take by const lvalue reference and by rvalue reference</p>\n\n<pre><code>void addObject(A const&amp; a) { objects.push_back(a); }\nvoid addObject(A&amp;&amp; a) { objects.push_back(std::move(a)); }\n\nb.addObject(std::move(a)); // one move\n</code></pre>\n\n<p>You could add a function template for <code>addObject</code> that emplaces:</p>\n\n<pre><code>template &lt;class... Args&gt;\nvoid addObject(Args&amp;&amp;... args) { objects.emplace_back(std::forward&lt;Args&gt;(args)...); }\n\nb.addObject(2, 5, \"test\"); // zero moves\n</code></pre>\n\n<hr />\n\n<p>Either way, there's a completely unnecessary copy here:</p>\n\n<pre><code>A(int value1, int value2, std::string text) \n: value1(value1), value2(value2), text(text) { }\n</code></pre>\n\n<p>you want:</p>\n\n<pre><code>A(int value1, int value2, std::string text) \n: value1(value1), value2(value2), text(std::move(text)) { }\n</code></pre>\n"}], "owner": {"reputation": 2901, "user_id": 1437164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2d9ca2232be88e55f3268bc3b8f871a?s=128&d=identicon&r=PG", "display_name": "PolGraphic", "link": "https://stackoverflow.com/users/1437164/polgraphic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 46452399, "answer_count": 2, "score": 3, "last_activity_date": 1506528354, "creation_date": 1506527806, "question_id": 46452310, "link": "https://stackoverflow.com/questions/46452310/avoiding-copy-constructor-during-populating-member-vector", "title": "Avoiding copy constructor during populating member vector", "body": "<p>I have an class <code>A</code>:</p>\n\n<pre><code>class A {\n  int value1;\n  int value2;\n  std::string text;\n\npublic:\n  A(int value1, int value2, std::string text) \n   : value1(value1), value2(value2), text(text) { }\n};\n</code></pre>\n\n<p>And some \"container\" class <code>B</code>:</p>\n\n<pre><code>class B {\n  std::vector&lt;A&gt; objects;\n  ...\n\npublic:\n  ...\n  void addObject(A a) {\n    objects.push_back(a);\n  }\n};\n</code></pre>\n\n<p>And code:</p>\n\n<pre><code>B b;\nA a(2, 5, \"test\");\nb.addObject(a);\n//I no longer need a from now on\n</code></pre>\n\n<p>My problem is, how to optimize <code>B::addObject(A a)</code> to avoid any copying. What I want to achive is to add new object of type <code>A</code> to <code>B.objects</code> via <code>B</code>'s method.</p>\n"}, {"tags": ["c++", "exception", "hash", "language-lawyer"], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1506527721, "last_edit_date": 1506527721, "creation_date": 1506527388, "answer_id": 46452188, "question_id": 46452012, "link": "https://stackoverflow.com/questions/46452012/stdhashoperator-where-is-exception-guarantee/46452188#46452188", "title": "std::hash::operator() - where is exception guarantee?", "body": "<p>This covered under [unord.hash]/4</p>\n\n<blockquote>\n  <p>satisfy the requirement that the expression <code>h(k)</code>, where <code>h</code> is an object of type <code>hash&lt;Key&gt;</code> and <code>k</code> is an object of type <code>Key</code>, shall not throw an exception unless <code>hash&lt;Key&gt;</code> is a user-defined specialization that depends on at least one user-defined type.</p>\n</blockquote>\n\n<p>So, as long as you are using one of the standard supplied specializations for <a href=\"http://en.cppreference.com/w/cpp/language/types\" rel=\"nofollow noreferrer\">fundamental types</a>, <code>operator()</code> will not throw.</p>\n"}], "owner": {"reputation": 7392, "user_id": 1555823, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b69fc6d16ff23e3509b2f3602838acd?s=128&d=identicon&r=PG", "display_name": "vladon", "link": "https://stackoverflow.com/users/1555823/vladon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506527721, "creation_date": 1506526785, "last_edit_date": 1506527421, "question_id": 46452012, "link": "https://stackoverflow.com/questions/46452012/stdhashoperator-where-is-exception-guarantee", "title": "std::hash::operator() - where is exception guarantee?", "body": "<p>Where in the standard does it specify that</p>\n\n<pre><code>std::hash&lt;T&gt;::operator()\n</code></pre>\n\n<p>will not throw any exception?</p>\n"}, {"tags": ["c++", "c", "qt", "variables", "global"], "answers": [{"comments": [{"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1506528056, "post_id": 46452209, "comment_id": 79860450, "body": "Would a brutal inclusion of the testcode in a number of namespaces be a solution? E.g. <code>namespace cpu1 { #include &quot;mycode.c&quot; }</code>. You would at least not be forced to change the test code and with some luck the C++ will produce logically the same code like the C compiler."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1506537499, "post_id": 46452209, "comment_id": 79865495, "body": "Yes, that is another option, if you can get the code to compile as C++. You could even wrap your C  module up in a C++ wrapper module file that declares the namespace (perhaps using a command-line macro for the name) and #includes the C file."}, {"owner": {"reputation": 45, "user_id": 5449145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770b4000355d2b56186290e1ad4adc7c?s=128&d=identicon&r=PG&f=1", "display_name": "metty", "link": "https://stackoverflow.com/users/5449145/metty"}, "edited": false, "score": 0, "creation_date": 1506603163, "post_id": 46452209, "comment_id": 79894202, "body": "This is the first time I read about &quot;forks&quot; or &quot;monitor scripts&quot;. That&#39;s why I don&#39;t understand exactly what I can do.  I created a small test project after the example above: <a href=\"https://github.com/mettym/parallel_c_testproject\" rel=\"nofollow noreferrer\">github.com/mettym/parallel_c_testproject</a>.  In order for the error to appear, I had to increment several times in the function &quot;inc_a&quot;, with a time delay. I tried to make a brutal inclusion like this: <code>namespace cpu1 {extern &quot;C&quot;{ #include &quot;c_module.h&quot;} }</code> and calling the functions with: <code>cpu1::set_a(somevalue);</code> Unfortunately, it is not working. How would you do that in this example project?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1506608293, "post_id": 46452209, "comment_id": 79897966, "body": "You will find lots of information about process forks &quot;out there&quot; The &quot;monitor scripts&quot; idea is simply that another program, probably written in a scripting language with good threading support, simply launches multiple copies of your actual test program, and monitors and merges their output, so the problem of parallel execution is taken outside your program space."}, {"owner": {"reputation": 45, "user_id": 5449145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770b4000355d2b56186290e1ad4adc7c?s=128&d=identicon&r=PG&f=1", "display_name": "metty", "link": "https://stackoverflow.com/users/5449145/metty"}, "edited": false, "score": 0, "creation_date": 1506668624, "post_id": 46452209, "comment_id": 79921227, "body": "These forks look a bit complicated at first glance, but seem to be a powerful tool. Thanks to your example (Gem Taylor) the sample program is now running correctly. Never crossed my mind to include a c-file via #include. It even works with a c-submodule that is only called from the c-modul. I updated the example to GitHub. Unfortunately it doesn&#39;t work on my test code, which is of course much more complicated. The functions still seem to have a problem. I still have to go behind that."}, {"owner": {"reputation": 45, "user_id": 5449145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770b4000355d2b56186290e1ad4adc7c?s=128&d=identicon&r=PG&f=1", "display_name": "metty", "link": "https://stackoverflow.com/users/5449145/metty"}, "edited": false, "score": 0, "creation_date": 1506681167, "post_id": 46452209, "comment_id": 79928299, "body": "A problem in my code was that the header files (in C) have a <code>#ifdef HEADER_H</code>, followed by a <code>#define HEADER_H</code> in it. If there are several namespaces, I have to mark all these headers as undefined each time. Especially with library headers, this becomes immediately enormously confusing and unclean. I have to look for another solution. And I will, if I get around to it, take a closer look at the forks."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1506977924, "post_id": 46452209, "comment_id": 80022075, "body": "You could use several cpp files to include your c code multiple times, but I fear your problem with globals may also be in some of the other c modules?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1507218904, "post_id": 46452209, "comment_id": 80132907, "body": "If they are standard C headers that you know do not have globals issues, just #include them all before starting the namespaces, and your C test code then won&#39;t include them again because of the #ifdef."}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": true, "score": 1, "last_activity_date": 1506609194, "last_edit_date": 1506609194, "creation_date": 1506527468, "answer_id": 46452209, "question_id": 46451931, "link": "https://stackoverflow.com/questions/46451931/parallelizing-c-code-module-in-c-program/46452209#46452209", "title": "Parallelizing C-Code Module in C++ Program", "body": "<p>You are out of luck.\nIdeally, rewrite your testable asset so that it carries round a state struct containing all those pesky globals, and maybe you will get away with it.</p>\n\n<p>Vroomfondel also suggests that wrapping the offending C code in a namespace might hide the issue, if the code can be made to compile as C++.\nYou could create as many namespaces as you want parallel threads:</p>\n\n<pre><code> namespace TEST1\n {\n    #include \"offender.c\"\n }\n namespace TEST2\n {\n    #include \"offender.c\"\n }\n RetCode DoTest(int instance, TestId testid)\n {\n     switch (instance)\n     {\n     case 1: return TEST1::DoTest(testid);\n     case 2: return TEST2::DoTest(testid);\n     }\n     return OUT_OF_RANGE;\n }\n</code></pre>\n\n<p>If your target really uses global state and can't be changed, then you could consider using forks.</p>\n\n<p>In a fork, a complete copy of the current state is made for the child to run in, and they both resume with just enough info so you know which is the child and which is the owner. You can also set up a pipe for them to communicate with each other. When a test completes, it transmits its status and exits its forked process.</p>\n\n<p>Forks can be really good for test suites because each fork starts with a completely clean environment.</p>\n\n<p>There is a /lot/ more to getting forking right than I think is reasonable to put as an answer to this question.</p>\n\n<p>The third option is to drive the program externally, so that some monitor script or program launches multiple parallel instances that each run linearly through a subset of the test list. Ideally build in features so the monitor can dispatch tests on demand and load-balance.</p>\n"}], "owner": {"reputation": 45, "user_id": 5449145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770b4000355d2b56186290e1ad4adc7c?s=128&d=identicon&r=PG&f=1", "display_name": "metty", "link": "https://stackoverflow.com/users/5449145/metty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 46452209, "answer_count": 1, "score": 1, "last_activity_date": 1506609194, "creation_date": 1506526544, "question_id": 46451931, "link": "https://stackoverflow.com/questions/46451931/parallelizing-c-code-module-in-c-program", "title": "Parallelizing C-Code Module in C++ Program", "body": "<p>My situation:\nI have C code running on a microcontroller. To test this code I have written a test program in C++ that checks the C-functions. Since the test functions are very slow, I wanted to do the whole thing in parallel. However, I don't have much experience.</p>\n\n<p>For example, I have a program module in C that looks like this:</p>\n\n<pre><code>/* c-code: */\nstatic int a=0;\nvoid set_a(int value){\n    a = value;\n}\nvoid inc_a(void){\n    a++;\n}\nint get_a(void){\nreturn a;\n}\n</code></pre>\n\n<p>Now I want to parallelize these functions in C++. However, I am bothered by the global variable a, which cannot be avoided in my situation.\nIn the QT environment I want to perform an \"asynchronous run\" of the function inc_a. This works but does not improve:</p>\n\n<pre><code>int foo(int somevalue){\n   set_a(somevalue);\n   inc_a();\n   return get_a();\n}\n\nint myinput = 1,myoutput;\nQFuture&lt;int&gt; future = QtConcurrent::run(foo,myinput);\nfuture.waitForFinished();\nmyoutput = future.result();\n</code></pre>\n\n<p>This is what I want:</p>\n\n<pre><code>int myinput1 = 1,myoutput1;\nint myinput2 = 8,myoutput2;\nQFuture&lt;int&gt; future1 = QtConcurrent::run(foo,myinput1);\nQFuture&lt;int&gt; future2 = QtConcurrent::run(foo,myinput2);\nfuture1.waitForFinished();\nfuture2.waitForFinished();\nmyoutput1 = future1.result();\nmyoutput2 = future2.result();\n</code></pre>\n\n<p>So my first question is (to be sure): is it correct that the variable a (in C) is now the same in both threads? If not, I have to look over my code again.If yes, how do I solve the problem as elegantly as possible? I thought of creating two C-program modules with the same functionality. However, this makes the program very maintenance-unfriendly:</p>\n\n<pre><code>/* c-code: */\nstatic int a1=0;\nvoid set_a1(int value){\n    a1 = value;\n}\nvoid inc_a1(void){\n    a1++;\n}\nint get_a1(void){\nreturn a1;\n}\n\n\nstatic int a2=0;\nvoid set_a2(int value){\n    a2 = value;\n}\nvoid inc_a2(void){\n    a2++;\n}\nint get_a2(void){\nreturn a2;\n}\n</code></pre>\n\n<p>Is there a better way?</p>\n"}, {"tags": ["c++", "controls", "structure", "choice"], "comments": [{"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 1, "creation_date": 1506526524, "post_id": 46451887, "comment_id": 79859425, "body": "Considering there are only three states for each choice, it&#39;s really not that bad..."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1506526543, "post_id": 46451887, "comment_id": 79859442, "body": "Evidently asking someone else to do it for you is easier."}, {"owner": {"reputation": 4567, "user_id": 1320751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eee0011ba2ca995b31e464fc2e2ad885?s=128&d=identicon&r=PG", "display_name": "Anon Mail", "link": "https://stackoverflow.com/users/1320751/anon-mail"}, "edited": false, "score": 0, "creation_date": 1506526594, "post_id": 46451887, "comment_id": 79859469, "body": "There are only six combinations so it&#39;s not that large.  But for solutions to problems with larger datasets, use a lookup table.  Which container to use for a lookup table would depend on the size of the dataset."}, {"owner": {"reputation": 162, "user_id": 6623266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6Dn2.png?s=128&g=1", "display_name": "loading...", "link": "https://stackoverflow.com/users/6623266/loading"}, "reply_to_user": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1506526627, "post_id": 46451887, "comment_id": 79859494, "body": "@Charles You are right, I could just turn it in with all the text but it&#39;s not laziness that makes me want to do it easier, I want to to it in a more managable way. What if I want to add &quot;gun&quot; and &quot;bowling ball&quot; to the game?"}, {"owner": {"reputation": 162, "user_id": 6623266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6Dn2.png?s=128&g=1", "display_name": "loading...", "link": "https://stackoverflow.com/users/6623266/loading"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1506526692, "post_id": 46451887, "comment_id": 79859548, "body": "@stark I&#39;m not trying to make someone else do it for me. I want to find a better way to do it, which I can&#39;t do myself. What if I want to add more options?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1506527185, "post_id": 46451887, "comment_id": 79859879, "body": "An additional option was already listed. <b><i>a lookup table</i></b> This answer shows one way using a lookup table: <a href=\"https://stackoverflow.com/a/45313894/487892\">stackoverflow.com/a/45313894/487892</a>"}], "owner": {"reputation": 162, "user_id": 6623266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6Dn2.png?s=128&g=1", "display_name": "loading...", "link": "https://stackoverflow.com/users/6623266/loading"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1506526787, "answer_count": 0, "score": 0, "last_activity_date": 1506526409, "creation_date": 1506526409, "question_id": 46451887, "link": "https://stackoverflow.com/questions/46451887/how-do-i-program-a-circular-comparison", "closed_reason": "Duplicate", "title": "How do I program a circular comparison?", "body": "<p>I am trying to create a Rock Paper Scissors game for a school project. The most straightforward way to compare the winner (for me at least) would be to do the following:</p>\n\n<pre><code>int rock = 1, paper = 2, scissors = 3;\nint computerChoice = randomNum();\nint playerChoice;\nif (playerChoice == computerChoice)\n    return \"Tie\";\nelse if (playerChoice == rock and computerChoice == paper)\n    return \"Computer wins\";\n// And so on\n</code></pre>\n\n<p>This would get very large very quickly, and I wonder if there is an easier way to do it?</p>\n"}, {"tags": ["c++", "if-statement", "output", "logical-operators"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1506525544, "post_id": 46451564, "comment_id": 79858755, "body": "<code>2&lt;=type_i&lt;=5</code> is always <code>true</code> because it is the same as <code>(2 &lt;= type_i) &lt;= 5</code> is the same as <code>(true) &lt;= 5</code> is the same as <code>true</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1506525659, "post_id": 46451564, "comment_id": 79858844, "body": "you need to check two conditions <code>2 &lt;= type_i and type_i &lt;= 5</code>"}, {"owner": {"reputation": 726, "user_id": 7780772, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/51e914134e488de42999994a203e24ec?s=128&d=identicon&r=PG&f=1", "display_name": "quantik", "link": "https://stackoverflow.com/users/7780772/quantik"}, "edited": false, "score": 0, "creation_date": 1506533214, "post_id": 46451564, "comment_id": 79863258, "body": "Not entirely relevant to the question itself. But for a problem like this I&#39;d construct a CD <code>class</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2078, "user_id": 835611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da9a8208412d5ddba0103adb1519725?s=128&d=identicon&r=PG&f=1", "display_name": "user835611", "link": "https://stackoverflow.com/users/835611/user835611"}, "is_accepted": true, "score": 1, "last_activity_date": 1506525971, "creation_date": 1506525971, "answer_id": 46451727, "question_id": 46451564, "link": "https://stackoverflow.com/questions/46451564/logical-errors-and-incorrect-output-when-testing-if-an-integer-is-in-a-range/46451727#46451727", "title": "Logical errors and incorrect output when testing if an integer is in a range", "body": "<p>You need to write these conditions, <code>(11&lt;=type_c&lt;=15)</code> as <code>(11&lt;=type_c &amp;&amp; type_c&lt;=15)</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8684045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038059b7fdb7f01a95060357e2aa43b8?s=128&d=identicon&r=PG&f=1", "display_name": "Misaki", "link": "https://stackoverflow.com/users/8684045/misaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1506526067, "accepted_answer_id": 46451727, "answer_count": 1, "score": -5, "last_activity_date": 1530218797, "creation_date": 1506525450, "last_edit_date": 1530218797, "question_id": 46451564, "link": "https://stackoverflow.com/questions/46451564/logical-errors-and-incorrect-output-when-testing-if-an-integer-is-in-a-range", "closed_reason": "Duplicate", "title": "Logical errors and incorrect output when testing if an integer is in a range", "body": "<p>I would like to ask which logical error am I facing? Even though I enter number 1 for every type of CD, the output will have 5% discount, but 5% discount is only for 2 to 5 purchases of CD.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    int type_i,type_l,type_o,type_c;\n    float cost_i,cost_l,cost_o,cost_c,discount_i,discount_l,discount_o,discount_c,discounted_i,discounted_l,discounted_o,discounted_c,total_dis,amount;\n    float price_i=39.9,price_l=29.9,price_o=49.9,price_c=59.9;\n\n    cout&lt;&lt;\"\\t\\t\\tPower House\\n\";\n    cout&lt;&lt;\"Quantity of International CD:\";\n    cin&gt;&gt;type_i;\n    cout&lt;&lt;\"Quantity of Local CD:\";\n    cin&gt;&gt;type_l;\n    cout&lt;&lt;\"Quantity of Oldies CD:\";\n    cin&gt;&gt;type_o;\n    cout&lt;&lt;\"Quantity of Classic CD:\";\n    cin&gt;&gt;type_c;\n\n    cost_i=type_i*price_i;\n    cost_l=type_l*price_l;\n    cost_o=type_o*price_o;\n    cost_c=type_c*price_c;\n\n    if (2&lt;=type_i&lt;=5){\n\n        discount_i=cost_i*0.05;\n        discounted_i=cost_i*0.95;\n        }\n        else if(6&lt;=type_i&lt;=10){\n\n            discount_i=cost_i*0.1;\n            discounted_i=cost_i*0.9;\n        }\n        else if(11&lt;=type_i&lt;=15){\n\n            discount_i=cost_i*0.15;\n            discounted_i=cost_i*0.85;\n        }\n        else if(16&lt;=type_i&lt;=20){\n\n            discount_i=cost_i*0.2;\n            discounted_i=cost_i*0.8;\n        }\n        else if(type_i&gt;20){\n\n            discount_i=cost_i*0.25;\n            discounted_i=cost_i*0.75;\n        }\n        else if(0&lt;=type_i&lt;=1){\n        discounted_i=cost_i;\n    }\n    if (2&lt;=type_l&lt;=5){\n\n        discount_l=cost_l*0.05;\n        discounted_l=cost_l*0.95;\n        }\n        else if(6&lt;=type_l&lt;=10){\n\n            discount_l=cost_l*0.1;\n            discounted_l=cost_l*0.9;\n        }\n        else if(11&lt;=type_l&lt;=15){\n\n            discount_l=cost_l*0.15;\n            discounted_l=cost_l*0.85;\n        }\n        else if(16&lt;=type_l&lt;=20){\n\n            discount_l=cost_l*0.2;\n            discounted_l=cost_l*0.8;\n        }\n        else if(type_l&gt;20){\n\n            discount_l=cost_l*0.25;\n            discounted_l=cost_l*0.75;\n        }\n        else if(0&lt;=type_l&lt;=1){\n        discounted_l=cost_l;\n    }\n    if (2&lt;=type_o&lt;=5){\n\n        discount_o=cost_o*0.05;\n        discounted_o=cost_o*0.95;\n        }\n        else if(6&lt;=type_o&lt;=10){\n\n            discount_o=cost_o*0.1;\n            discounted_o=cost_o*0.9;\n        }\n        else if(11&lt;=type_o&lt;=15){\n\n            discount_o=cost_o*0.15;\n            discounted_o=cost_o*0.85;\n        }\n        else if(16&lt;=type_o&lt;=20){\n\n            discount_o=cost_o*0.2;\n            discounted_o=cost_o*0.8;\n        }\n        else if(type_o&gt;20){\n\n            discount_o=cost_o*0.25;\n            discounted_o=cost_o*0.75;\n        }\n        else if (0&lt;=type_o&lt;=1){\n        discounted_o=cost_o;\n    }\n    if (2&lt;=type_c&lt;=5){\n\n        discount_c=cost_c*0.05;\n        discounted_c=cost_c*0.95;\n        }\n        else if(6&lt;=type_c&lt;=10){\n\n            discount_c=cost_c*0.1;\n            discounted_c=cost_c*0.9;\n        }\n        else if(11&lt;=type_c&lt;=15){\n\n            discount_c=cost_c*0.15;\n            discounted_c=cost_c*0.85;\n        }\n        else if(16&lt;=type_c&lt;=20){\n\n            discount_c=cost_c*0.2;\n            discounted_c=cost_c*0.8;\n        }\n        else if(type_c&gt;20){\n\n            discount_c=cost_c*0.25;\n            discounted_c=cost_c*0.75;\n        }\n        else if(0&lt;=type_c&lt;=1){\n        discounted_c=cost_c;\n    }\n\n    total_dis=discount_i+discount_l+discount_o+discount_c;\n    amount=discounted_i+discounted_l+discounted_o+discounted_c;\n\n    cout&lt;&lt;\"Total discount:\"&lt;&lt;total_dis;\n    cout&lt;&lt;\"\\nAmount due:\"&lt;&lt;amount;\n\n\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qEPgK.png\" rel=\"nofollow noreferrer\">This is the assignment I'm working on for this program.</a></p>\n"}, {"tags": ["c++", "multithreading", "qt", "qsqlquery"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506526162, "post_id": 46451560, "comment_id": 79859176, "body": "Have you tried it? Try it and tell us about your experience."}, {"owner": {"reputation": 103, "user_id": 1249287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64959c6a50a6b78c78c48cac2b00bcc3?s=128&d=identicon&r=PG", "display_name": "Pascalau Razvan", "link": "https://stackoverflow.com/users/1249287/pascalau-razvan"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1506589226, "post_id": 46451560, "comment_id": 79884976, "body": "I haven&#39;t tried it but I want to. The code being multi-threaded it might take some time until it crashes randomly and I am more curious if the QSqlQuery architecture supports it"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 1249287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64959c6a50a6b78c78c48cac2b00bcc3?s=128&d=identicon&r=PG", "display_name": "Pascalau Razvan", "link": "https://stackoverflow.com/users/1249287/pascalau-razvan"}, "edited": false, "score": 0, "creation_date": 1506589031, "post_id": 46452533, "comment_id": 79884838, "body": "I&#39;m referring to the usage of QSqlQuery after the execution. Does it cache the entire result? Does it use the connection if i&#39;m just going through the records and read all the values?"}, {"owner": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "reply_to_user": {"reputation": 103, "user_id": 1249287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64959c6a50a6b78c78c48cac2b00bcc3?s=128&d=identicon&r=PG", "display_name": "Pascalau Razvan", "link": "https://stackoverflow.com/users/1249287/pascalau-razvan"}, "edited": false, "score": 0, "creation_date": 1506598718, "post_id": 46452533, "comment_id": 79891184, "body": "@PascalauRazvan. So are you asking whether its possible to pass an active <code>QSqlQuery</code> object between threads? What problem are you trying to solve by doing that? Are you hoping to somehow avoid sending all the results back to the main thread?"}, {"owner": {"reputation": 103, "user_id": 1249287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64959c6a50a6b78c78c48cac2b00bcc3?s=128&d=identicon&r=PG", "display_name": "Pascalau Razvan", "link": "https://stackoverflow.com/users/1249287/pascalau-razvan"}, "edited": false, "score": 0, "creation_date": 1506605070, "post_id": 46452533, "comment_id": 79895617, "body": "@ ekhumoro I don&#39;t want to do the parsing of the result on the same thread the db connection was created on (I&#39;ve serialized the access to happen on one thread instead of having multiple connections). And yes I want to know if I can use that active QSqlQuery on the caller thread."}, {"owner": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "reply_to_user": {"reputation": 103, "user_id": 1249287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64959c6a50a6b78c78c48cac2b00bcc3?s=128&d=identicon&r=PG", "display_name": "Pascalau Razvan", "link": "https://stackoverflow.com/users/1249287/pascalau-razvan"}, "edited": false, "score": 0, "creation_date": 1506608314, "post_id": 46452533, "comment_id": 79897975, "body": "@PascalauRazvan. I think it might be possible, but I have not tried it myself. Unfortunately, despite a lot of searching, I have not been able to find any official Qt statement on whether it is explicitly supported. It just does not seem to be something that is done very often. I have seen a few hints that iterating over the results in a different thread should be okay - but nothing really concrete. So it looks like you will have to find a way to experiment with it yourself."}], "tags": [], "owner": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "is_accepted": false, "score": 0, "last_activity_date": 1506528438, "creation_date": 1506528438, "answer_id": 46452533, "question_id": 46451560, "link": "https://stackoverflow.com/questions/46451560/interrogate-qsqlquery-on-another-thread/46452533#46452533", "title": "Interrogate QSqlQuery on another thread", "body": "<p>According to the <a href=\"https://doc.qt.io/qt-5/threads-modules.html#threads-and-the-sql-module\" rel=\"nofollow noreferrer\">Qt docs</a>, this is <strong>not</strong> supported:</p>\n\n<blockquote>\n  <p>A connection can only be used from within the thread that created it.\n  Moving connections between threads or creating queries from a\n  different thread is not supported.</p>\n  \n  <p>In addition, the third party libraries used by the QSqlDrivers can\n  impose further restrictions on using the SQL Module in a multithreaded\n  program. Consult the manual of your database client for more\n  information</p>\n</blockquote>\n\n<p>So at the very least, you must <a href=\"https://doc.qt.io/qt-5/qsqldatabase.html#addDatabase\" rel=\"nofollow noreferrer\">add a new database connection</a> (with a unique name) for each thread that you want to run a query from.</p>\n"}], "owner": {"reputation": 103, "user_id": 1249287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64959c6a50a6b78c78c48cac2b00bcc3?s=128&d=identicon&r=PG", "display_name": "Pascalau Razvan", "link": "https://stackoverflow.com/users/1249287/pascalau-razvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506528468, "creation_date": 1506525444, "last_edit_date": 1506528468, "question_id": 46451560, "link": "https://stackoverflow.com/questions/46451560/interrogate-qsqlquery-on-another-thread", "title": "Interrogate QSqlQuery on another thread", "body": "<p>Can you interrogate an QSqlQuery (eg. query.value) on a thread other than the one the connection/execution was made?</p>\n"}, {"tags": ["c++", "microservices", "desktop"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1506525620, "post_id": 46451544, "comment_id": 79858819, "body": "You could use <a href=\"http://www.boost.org/doc/libs/1_65_1/doc/html/boost_dll.html#boost_dll.introduction\" rel=\"nofollow noreferrer\">dynamic library modules</a>."}, {"owner": {"reputation": 97, "user_id": 5721304, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qVI6o.jpg?s=128&g=1", "display_name": "Piter _OS", "link": "https://stackoverflow.com/users/5721304/piter-os"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1506525832, "post_id": 46451544, "comment_id": 79858952, "body": "I&#39;m thinking about main process and from this process run others. Is it good? I don&#39;t know boost but from quick reading it could be good solution."}, {"owner": {"reputation": 97, "user_id": 5721304, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qVI6o.jpg?s=128&g=1", "display_name": "Piter _OS", "link": "https://stackoverflow.com/users/5721304/piter-os"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1506526000, "post_id": 46451544, "comment_id": 79859069, "body": "@rex is it problem if application does not use boost at all?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1506526141, "post_id": 46451544, "comment_id": 79859158, "body": "With separate processes you would need some type of <a href=\"http://www.boost.org/doc/libs/1_65_1/doc/html/interprocess.html\" rel=\"nofollow noreferrer\">IPC</a> to make them work together. Maybe threads are enough? You can use the OS API to do the same thing without boost. It seems like this question doesn&#39;t fit here. Perhaps better to discuss this in a <a href=\"https://chat.stackoverflow.com/\">chat</a>."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1506527008, "post_id": 46451544, "comment_id": 79859769, "body": "In Microsoft world, the answer would be COM or .NET ... Unsure if relevant here, but it can even tranparently use services (servers) on different machines."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1506543445, "post_id": 46451544, "comment_id": 79868673, "body": "It is not clear what exactly are you asking. Are you looking to reduce application size? With microservices it will become even bigger. That&#39;s for sure."}, {"owner": {"reputation": 97, "user_id": 5721304, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qVI6o.jpg?s=128&g=1", "display_name": "Piter _OS", "link": "https://stackoverflow.com/users/5721304/piter-os"}, "edited": false, "score": 0, "creation_date": 1506556902, "post_id": 46451544, "comment_id": 79873215, "body": "No i&#39;m not trying to reduce app size. I try to make separate modules to work independently but they have to communicate."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5721304, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qVI6o.jpg?s=128&g=1", "display_name": "Piter _OS", "link": "https://stackoverflow.com/users/5721304/piter-os"}, "edited": false, "score": 0, "creation_date": 1506694953, "post_id": 46461962, "comment_id": 79936165, "body": "Maybe you know something like OSGi to C++? Cause I read that most popular for Java is OSGi."}, {"owner": {"reputation": 1080, "user_id": 5021151, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5de0c97535ae6723b49a5ceabfa9a685?s=128&d=identicon&r=PG&f=1", "display_name": "Loreno", "link": "https://stackoverflow.com/users/5021151/loreno"}, "edited": false, "score": 5, "creation_date": 1557213281, "post_id": 46461962, "comment_id": 98678530, "body": "Why do you think micro services need to span across multiple machines? I don&#39;t agree with that"}], "tags": [], "owner": {"reputation": 14518, "user_id": 2575224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXLfW.jpg?s=128&g=1", "display_name": "Constantin Galbenu", "link": "https://stackoverflow.com/users/2575224/constantin-galbenu"}, "is_accepted": true, "score": 0, "last_activity_date": 1506578382, "creation_date": 1506578382, "answer_id": 46461962, "question_id": 46451544, "link": "https://stackoverflow.com/questions/46451544/c-microservices-with-desktop-application/46461962#46461962", "title": "C++ MicroServices with desktop application", "body": "<p>Desktop application and microservices <strong>are mutually exclusive</strong> because Desktop means one machine and microservices implies multiple machines (physical or virtual) that communicate through network using a technology agnostic protocol. </p>\n\n<p>What you can do is to use <a href=\"https://www.oreilly.com/ideas/modules-vs-microservices\" rel=\"nofollow noreferrer\">modularization</a>. This is an alternative to microservices that can work in some scenarios like yours.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 3855405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0db783f4d5bdce6bd1208554c4ee7d01?s=128&d=identicon&r=PG", "display_name": "punkstarman", "link": "https://stackoverflow.com/users/3855405/punkstarman"}, "is_accepted": false, "score": 5, "last_activity_date": 1553583977, "last_edit_date": 1553583977, "creation_date": 1540240070, "answer_id": 52937300, "question_id": 46451544, "link": "https://stackoverflow.com/questions/46451544/c-microservices-with-desktop-application/52937300#52937300", "title": "C++ MicroServices with desktop application", "body": "<p>A microservice-like architecture for the desktop is feasible. In fact, many OSes use services, which are often called daemons. For instance, the X Window system uses a client/server architecture. More recently, IDEs can now use the Language Server Protocol to communicate with one or more language servers that provide syntax highlighting, code completion, compilation feedback, etc.</p>\n\n<p>There are a few things to consider:</p>\n\n<ul>\n<li>What communication protocols are already available on the target system? On many systems, you can use a D-Bus (<a href=\"https://en.wikipedia.org/wiki/D-Bus\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/D-Bus</a>)</li>\n<li>What performance do you need? If performance is highly critical, you will need to use a highly optimized protocol for communicating between services, and startup times will need to be small. For good performance, something similar to the Language Server Protocol is probably good enough and will be easier to write, maintain and debug.</li>\n<li>Can you handle the added complexity of splitting processes up? In a monolith, the whole thing is either up or down. With microservices, parts of the system that are running can attempt to call parts that are not. This situation must be handled.</li>\n<li>What are the seams in your applications? Where can you split it up easily? Take a look at Domain Driven Design. Identify potential independent modules, and refactor to confirm. If the refactoring makes sense then split the module into its own process.</li>\n</ul>\n"}], "owner": {"reputation": 97, "user_id": 5721304, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qVI6o.jpg?s=128&g=1", "display_name": "Piter _OS", "link": "https://stackoverflow.com/users/5721304/piter-os"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4233, "favorite_count": 3, "closed_date": 1551838874, "accepted_answer_id": 46461962, "answer_count": 2, "score": 3, "last_activity_date": 1553583977, "creation_date": 1506525398, "question_id": 46451544, "link": "https://stackoverflow.com/questions/46451544/c-microservices-with-desktop-application", "closed_reason": "Needs more focus", "title": "C++ MicroServices with desktop application", "body": "<p>I got a desktop application and it's getting bigger and bigger. And i wonder if i can make something like microservices with desktop application? I want to application for now stays desktop. Application it's written in C++.\nI can exclude some of the modules with some preparations.\nBut is it possible and if anybody have idea how to start with this?</p>\n"}, {"tags": ["c++", "algorithm", "median"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506525798, "post_id": 46451427, "comment_id": 79858930, "body": "I think now i get it... e.g. for <code>[ 1 2 359 358 ]</code> median would be <code>360</code>, right?"}, {"owner": {"reputation": 795, "user_id": 7118258, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/83f34172a5465f688a9c72b8da58f045?s=128&d=identicon&r=PG&f=1", "display_name": "Soo", "link": "https://stackoverflow.com/users/7118258/soo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506526975, "post_id": 46451427, "comment_id": 79859743, "body": "@tobi303: To be precise, the converted data will be [1,  2, -1, -2] and the sorted data will be [-2,-1, 1, 2] and the median will be (-1+1)/2 = 0 (or equivalently 360 as you rightly said)"}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1506527114, "post_id": 46451427, "comment_id": 79859843, "body": "Reopen. This certainly is NOT a duplicate of <a href=\"https://stackoverflow.com/q/491738/733637\">stackoverflow.com/q/491738/733637</a> \u2013 MEDIAN and AVERAGE are different notions."}, {"owner": {"reputation": 795, "user_id": 7118258, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/83f34172a5465f688a9c72b8da58f045?s=128&d=identicon&r=PG&f=1", "display_name": "Soo", "link": "https://stackoverflow.com/users/7118258/soo"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1506527539, "post_id": 46451427, "comment_id": 79860108, "body": "@Bathsheba: I have edited the question. The suggestion in the link provided by you, is to find the unit vector corresponding to each angle and find the average. However, median requires sorting the data and sorting of vectors don&#39;t make any sense in this context. Hence I don&#39;t think we can use the proposed scheme to find median!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1506527969, "post_id": 46451427, "comment_id": 79860389, "body": "actually I dont think the concept of median has a natural extension to this case. I think you need an extra condition, something like: the median such that the spread around it is minimal"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1506528020, "post_id": 46451427, "comment_id": 79860428, "body": "consider eg <code>[ 0 180]</code> for which <code>90</code> would be just as good as <code>270</code>... or with <code>[0 60 120 180 270]</code> there are 5 possible solutions and even a &quot;minimum spread&quot; condition wont help to uniquely choose one of them"}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 1, "creation_date": 1506528356, "post_id": 46451427, "comment_id": 79860640, "body": "Could you show a definition for median of circular values and explain its sense?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1506528417, "post_id": 46451427, "comment_id": 79860686, "body": "maybe you will have more luck on <a href=\"https://math.stackexchange.com/\">math.stackexchange.com</a>"}, {"owner": {"reputation": 795, "user_id": 7118258, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/83f34172a5465f688a9c72b8da58f045?s=128&d=identicon&r=PG&f=1", "display_name": "Soo", "link": "https://stackoverflow.com/users/7118258/soo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506530248, "post_id": 46451427, "comment_id": 79861748, "body": "@tobi303 If you carefully notice, my example describes angle in [0, 360) where 360 is not included. Hence, median of 0 &amp; 180 should be 90 only and 270 is no longer a good candidate!"}, {"owner": {"reputation": 154, "user_id": 4415080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I-LTTG-kW3Q/AAAAAAAAAAI/AAAAAAAAAoQ/GX8PuDqHwsU/photo.jpg?sz=128", "display_name": "aLoneStrider", "link": "https://stackoverflow.com/users/4415080/alonestrider"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1506530458, "post_id": 46451427, "comment_id": 79861843, "body": "But there is no difference between 360 and 0 and I think @tobi303 is right."}, {"owner": {"reputation": 795, "user_id": 7118258, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/83f34172a5465f688a9c72b8da58f045?s=128&d=identicon&r=PG&f=1", "display_name": "Soo", "link": "https://stackoverflow.com/users/7118258/soo"}, "reply_to_user": {"reputation": 154, "user_id": 4415080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I-LTTG-kW3Q/AAAAAAAAAAI/AAAAAAAAAoQ/GX8PuDqHwsU/photo.jpg?sz=128", "display_name": "aLoneStrider", "link": "https://stackoverflow.com/users/4415080/alonestrider"}, "edited": false, "score": 0, "creation_date": 1506530593, "post_id": 46451427, "comment_id": 79861905, "body": "@aLoneStrider: I agree that 0 and 360 are the same. But I just wanted to point out that I am not interested in angles &gt;= 360!"}, {"owner": {"reputation": 154, "user_id": 4415080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I-LTTG-kW3Q/AAAAAAAAAAI/AAAAAAAAAoQ/GX8PuDqHwsU/photo.jpg?sz=128", "display_name": "aLoneStrider", "link": "https://stackoverflow.com/users/4415080/alonestrider"}, "edited": false, "score": 0, "creation_date": 1506530839, "post_id": 46451427, "comment_id": 79862024, "body": "I know that but for [0, 180] in a whole circle, there are two candidates for the median."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1506532918, "post_id": 46453706, "comment_id": 79863111, "body": "Ingenious but sadly not true. Your arctan(sum_y / sum_x) is the average point, and there is no statistical justification for your assertion that the median value is the one closest to that point."}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1506533192, "post_id": 46453706, "comment_id": 79863247, "body": "I see your point but I&#39;m not entirely certain if that is true. Median and average are much more closely related in circular data."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1506533496, "post_id": 46453706, "comment_id": 79863405, "body": "To me, taking the point opposite the average as the origin, rotationally transforming your data so that that origin has the value zero, taking the median of that set, then transforming back is a good definition. But I don&#39;t have a citation for that approach."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1506534442, "post_id": 46453706, "comment_id": 79863878, "body": "But I think there&#39;s enough material here now for an upvote. Here it comes."}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1506542258, "post_id": 46453706, "comment_id": 79868059, "body": "That&#39;s a great idea. I&#39;ll modify my answer now."}], "tags": [], "owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "is_accepted": false, "score": 3, "last_activity_date": 1506597818, "last_edit_date": 1506597818, "creation_date": 1506532589, "answer_id": 46453706, "question_id": 46451427, "link": "https://stackoverflow.com/questions/46451427/finding-median-of-a-set-of-circular-data/46453706#46453706", "title": "Finding median of a set of circular data", "body": "<p>With your vector of angular datapoints (i.e. vector of numbers from 0 to 259), create two new vectors, I'll call them <code>x</code> and <code>y</code>. These two new vectors are the sine and cosine respectively of your angular datapoints.</p>\n\n<p>That is, <code>x[n] = cos(data[n])</code> and <code>y[n] = sin(data[n])</code> where <code>data</code> is your angular data vector and <code>n</code> is however many datapoints there are.</p>\n\n<p>Next, add up all the values in the <code>x</code> vector to get a single value, call it say <code>sum_x</code> and add up all the values in the <code>y</code> vector to get a another single value, call it <code>sum_y</code>.</p>\n\n<p>Now you can do tangent-inverse (e.g. <code>atan(sum_y/sum_x)</code>) to get a new value. And this value is very meaningful. This value is basically telling you which direction your data is \"pointing\", i.e. where the majority of your data exists. NOTE: You must be careful of dividing by 0 (when <code>sum_x</code>=0) and when the indeterminate forms occurs (when both <code>sum_x</code>=0 and <code>sum_y</code>=0). The indeterminate form just means your data is evenly distributed, in which case the median is meaningless, and when <code>sum_x</code>=0 but <code>sum_y</code>!=0, then it is effectively <code>atan(inf)</code> or <code>atan(-inf)</code>, both of which are known.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>My previous answer needed some tweaking after this point.</p>\n\n<p>From here, it is easy. Take the value you got in the previous step (<code>atan(sum_y/sum_x)</code>) and add 180 degrees to that value. This is your reference point of where your data starts and ends. From here, you can sort your angular data with this reference point as both the starting and ending point, and find the median of that data.</p>\n"}, {"tags": [], "owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "is_accepted": false, "score": 3, "last_activity_date": 1506534814, "creation_date": 1506534814, "answer_id": 46454271, "question_id": 46451427, "link": "https://stackoverflow.com/questions/46451427/finding-median-of-a-set-of-circular-data/46454271#46454271", "title": "Finding median of a set of circular data", "body": "<p>Two properties of median allow inventing two distinct algorithms for median finding.</p>\n\n<p>1) Median minimizes sum of absolute distance to all other elements -- O(n^2) algo:</p>\n\n<pre><code>for (i = 0; i &lt; N; i++)\n{\n     sum = 0;\n     for (j = 0; j &lt; N; j++)\n        sum += abs(item[i] - item[j]) % 360;\n     if (sum &lt; best_so_far) { best_so_far = sum; index = i; }\n}\n</code></pre>\n\n<p>2) Median satisfies that half of items are less and half are greater</p>\n\n<ul>\n<li>sort the items</li>\n<li>locate the first set of items (i=0...I), satisfying either that\nI &lt;= N/2, OR item[I] > i + 180</li>\n<li>if the condition for median is not satisfied, advance either i, or I.</li>\n<li>requires O(N*log N) for sorting and O(N) for the next scan</li>\n</ul>\n\n<p>Of course in cyclical data all items (and all items inbetween data points) can be a proper candidate for the median.</p>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1506587810, "last_edit_date": 1506587810, "creation_date": 1506535136, "answer_id": 46454357, "question_id": 46451427, "link": "https://stackoverflow.com/questions/46451427/finding-median-of-a-set-of-circular-data/46454357#46454357", "title": "Finding median of a set of circular data", "body": "<p>It is not possible to canonically extend the concept of median to circular data. For the sake of simplicity lets consider numbers in <code>[0 10)</code> and as an example the (already ordered) set <code>{ 1 3 5 7 8 }</code>. Depending on how you rotate the array you get different values for the median:</p>\n\n<pre><code>1 3 5 7 8    -&gt; 5\n3 5 7 8 1    -&gt; 7\n5 7 8 1 3    -&gt; 8\n...etc...\n</code></pre>\n\n<p>and any is as good as the other.</p>\n\n<p>I am <strong>not</strong> claiming that it is not possible to define a median on circular data. I am just claiming that the \"normal\" median cannot be extended to that case in a meaningful way without adding additional constraints or making an arbitrary choice.</p>\n"}, {"tags": [], "owner": {"reputation": 484, "user_id": 7468479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dc0ff8222b98f98a0472886d8bc3057?s=128&d=identicon&r=PG&f=1", "display_name": "PM.", "link": "https://stackoverflow.com/users/7468479/pm"}, "is_accepted": false, "score": 4, "last_activity_date": 1564481863, "creation_date": 1564481863, "answer_id": 57269406, "question_id": 46451427, "link": "https://stackoverflow.com/questions/46451427/finding-median-of-a-set-of-circular-data/57269406#57269406", "title": "Finding median of a set of circular data", "body": "<p>For definition and discussion of circular median see</p>\n\n<p>N.I. Fisher's 'Statistical Analysis of Circular Data', Cambridge Univ. Press 1993</p>\n\n<p>and the discussion surrounding equations 2.32 and 2.33. For multi-modal or isotropic data a unique median may not exist. </p>\n\n<p>Find an axis that divides the data into 2 equal groups and choose the end of the axis at the smaller value of the angle. If the sample size is odd the median will be a data point, otherwise it will be the midpoint of 2 data points.</p>\n\n<p>There are packages in other languages (e.g. R, MatLab) that would help provide test values for any function you write.</p>\n\n<p>e.g.\n<a href=\"https://www.rdocumentation.org/packages/circular/versions/0.4-93\" rel=\"nofollow noreferrer\">https://www.rdocumentation.org/packages/circular/versions/0.4-93</a></p>\n\n<p>See in particular <code>median.circular</code> and <code>medianHL.circular</code></p>\n\n<p>or</p>\n\n<p>Berens, Philipp. \u2018CircStat: A MATLAB Toolbox for Circular Statistics\u2019. Journal of Statistical Software 31, no. 1 (23 September 2009): 1\u201321. <a href=\"https://doi.org/10.18637/jss.v031.i10\" rel=\"nofollow noreferrer\">https://doi.org/10.18637/jss.v031.i10</a>.</p>\n\n<p>and see <code>circ_median</code></p>\n"}, {"comments": [{"owner": {"reputation": 3192, "user_id": 4247453, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a1c7a7acd5e7be626b72746196af107?s=128&d=identicon&r=PG&f=1", "display_name": "relatively_random", "link": "https://stackoverflow.com/users/4247453/relatively-random"}, "edited": false, "score": 0, "creation_date": 1604305237, "post_id": 63843172, "comment_id": 114296548, "body": "In the topic on averages the OP mentioned, there is an algorithm that could probably be paired nicely with the arc median method I presented, for the final averaging of multiple cadidates: <a href=\"https://stackoverflow.com/a/3651941/4247453\">stackoverflow.com/a/3651941/4247453</a> Unlike the circular mean method, the algorithm picks the mean by arc length instead of by straight line distances. But I haven&#39;t really studied the algorithm and I&#39;m not sure if it&#39;s guaranteed to produce a single unique point from the candidates given by the arc median."}], "tags": [], "owner": {"reputation": 3192, "user_id": 4247453, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a1c7a7acd5e7be626b72746196af107?s=128&d=identicon&r=PG&f=1", "display_name": "relatively_random", "link": "https://stackoverflow.com/users/4247453/relatively-random"}, "is_accepted": false, "score": 3, "last_activity_date": 1599811692, "creation_date": 1599811692, "answer_id": 63843172, "question_id": 46451427, "link": "https://stackoverflow.com/questions/46451427/finding-median-of-a-set-of-circular-data/63843172#63843172", "title": "Finding median of a set of circular data", "body": "<p>I've actually given this topic way more thought than is healthy so I'll share my thoughts and findings here. Maybe someone will have a similar problem and find this useful.</p>\n<p>I haven't used C++ in many years so please forgive me if I write all the code in C#. I believe a fluent C++ speaker can pretty easily translate the algorithms.</p>\n<h3>Circular mean</h3>\n<p>First, let's define the <a href=\"https://en.wikipedia.org/wiki/Mean_of_circular_quantities\" rel=\"nofollow noreferrer\">circular mean</a>. It's calculated by converting your points to radians, where your period (256, 360 or whatever - the value that is interpreted to be the same as zero) is scaled to <code>2*pi</code>. You then calculate the sine and cosine of those radian values. Those are the y and x coordinates of your values on a unit circle. You then sum up all the sines and cosines and calculate atan2. This gives you the average angle, which can be easily converted back to your data point by dividing with the scaling factor.</p>\n<pre><code>var scalingFactor = 2 * Math.PI / period;\n\nvar sines = 0.0;\nvar cosines = 0.0;\nforeach (var value in inputs)\n{\n    var radians = value * scalingFactor;\n    sines += Math.Sin(radians);\n    cosines += Math.Cos(radians);\n}\n\nvar circularMean = Math.Atan2(sines, cosines) / scalingFactor;\n\nif (circularMean &gt;= 0)\n    return circularMean;\nelse\n    return circularMean + period;\n</code></pre>\n<h3>Marginal circular median</h3>\n<p>The simplest approach to a circular median is just a modified way of handling the circular mean.</p>\n<p>The circular median can be calculated in a similar way, by just finding the median of the sines and cosines instead of the sums, and calculating the atan2 of that. This way, you are finding the <a href=\"https://en.wikipedia.org/wiki/Median#Marginal_median\" rel=\"nofollow noreferrer\">marginal median</a> of the circle points and taking its angle as a result.</p>\n<pre><code>var scalingFactor = 2 * Math.PI / period;\n\nvar sines = new List&lt;double&gt;();\nvar cosines = new List&lt;double&gt;();\nforeach (var value in inputs)\n{\n    var radians = value * scalingFactor;\n    sines.Add(Math.Sin(radians));\n    cosines.Add(Math.Cos(radians));\n}\n\nvar circularMedian = Math.Atan2(Median(sines), Median(cosines)) / scalingFactor;\n\nif (circularMedian &gt;= 0)\n    return circularMedian;\nelse\n    return circularMedian + period;\n</code></pre>\n<p>This approach is O(n), robust to outliers and very simple to implement. It may suit your purposes well enough, but it has a problem: rotating the input points will give you different results. Depending on the distribution of your input data, it may or may not be a problem.</p>\n<h3>Circular arc median</h3>\n<p>To understand this other approach, you need to stop thinking of means and medians in terms of &quot;this is how it's calculated&quot;, but in terms of what the resulting values actually represent.</p>\n<p>For non-cyclic data, you get the mean by summing up all the values and dividing by the number of elements. What this number represents, though, is the value with the minimal sum of all squared distances to data elements. (I hear statisticians call this value the L2 estimate of location, but a statistician should probably confirm or deny this.)</p>\n<p>Likewise for median. You get it by finding the data element that would end up in the middle if all data were sorted (ideally, using an O(n) <a href=\"https://en.wikipedia.org/wiki/Selection_algorithm\" rel=\"nofollow noreferrer\">selection algorithm</a>, like <a href=\"https://en.cppreference.com/w/cpp/algorithm/nth_element\" rel=\"nofollow noreferrer\">nth_element</a> in C++). What this number is, though, is a value that has the minimal sum of all absolute (non-squared!) distances to data elements. (Supposedly, this value is called an L1 estimate of location.)</p>\n<p>Sorting circular data doesn't help you find a middle, so the usual way of thinking about medians doesn't work, but you can still find this point that minimizes the sum of absolute distances from all data points. Here's the algorithm that I came up with, that runs in O(n) time assuming the input data is normalized to &gt;= 0 and &lt; period, and then sorted. (If you need to do this sorting as part of your calculation, then the runtime is O(n log n).)</p>\n<p>It works by going through all the data points and keeping track of the sum of distances. When you shift to the right data point by a distance D, the sum of distances to all the left points increases by <code>D*LeftCount</code> and the sum of all distances to all the right points decreases by <code>D*RightCount</code>. Then, if some of the left points are now actually the right points, because their left distance is larger than <code>period/2</code>, you subtract their previous distance and add the new, correct distance.</p>\n<p>For comparing the current sum to the best sum, I added a bit of tolerance to guard against inexact floating point arithmetic.</p>\n<p>There may be multiple or infinitely many points that satisfy the minimum distances condition. With non-circular medians with even number of values, the median can be any value between the two central values. It's usually taken to be the average of those two central values, so I took the similar approach with this median algorithm. I find all data points that minimize the distances and then just calculate the circular mean of those points.</p>\n<pre><code>// Requires a sorted list with values normalized to [0,period).\n\n// Doing an initialization pass:\n//   * candidate is the lowest number\n//   * finding the index where the circle with this candidate starts\n//   * calculating the score for this candidate - the sum of absolute distances\n//   * counting the number of values to the left of the candidate\nint i;\nvar candidate = list[0];\nvar distanceSum = 0.0;\nfor (i = 1; i &lt; list.Count; ++i)\n{\n    if (list[i] &gt;= candidate + period / 2)\n        break;\n    distanceSum += list[i] - candidate;\n}\nvar leftCount = list.Count - i;\nvar circleStart = i;\nif (circleStart == list.Count)\n    circleStart = 0;\nelse\n    for (; i &lt; list.Count; ++i)\n        distanceSum += candidate + period - list[i];\n\nvar previousCandidate = candidate;\nvar bestCandidates = new List&lt;double&gt; { candidate };\nvar bestDistanceSum = distanceSum;\nvar equalityTolerance = period * 1e-10;\n\nfor (i = 1; i &lt; list.Count; ++i)\n{\n    candidate = list[i];\n\n    // A formula for correcting the distance given the movement to the right.\n    // It doesn't take into account that some values may have wrapped to the other side of the circle.\n    ++leftCount;\n    distanceSum += (2 * leftCount - list.Count) * (candidate - previousCandidate);\n\n    // Counting all the values that wrapped to the other side of the circle\n    // and correcting the sum of distances from the candidate.\n    if (i &lt;= circleStart)\n        while (list[circleStart] &lt; candidate + period / 2)\n        {\n            --leftCount;\n            distanceSum += 2 * (list[circleStart] - candidate) - period;\n            ++circleStart;\n            if (circleStart == list.Count)\n            {\n                circleStart = 0;\n                break; // Letting the next loop continue.\n            }\n        }\n    if (i &gt; circleStart)\n        while (list[circleStart] &lt; candidate - period / 2)\n        {\n            --leftCount;\n            distanceSum += 2 * (list[circleStart] - candidate) + period;\n            ++circleStart;\n        }\n\n    // Comparing current sum to the best one, using the given tolerance.\n    if (distanceSum &lt;= bestDistanceSum + equalityTolerance)\n    {\n        if (distanceSum &gt;= bestDistanceSum - equalityTolerance)\n        {\n            // The numbers are close, so using their average as the next best.\n            bestDistanceSum = (bestCandidates.Count * bestDistanceSum + distanceSum) / (bestCandidates.Count + 1);\n        }\n        else\n        {\n            // The new number is significantly better, clearing.\n            bestDistanceSum = distanceSum;\n            bestCandidates.Clear();\n        }\n        bestCandidates.Add(candidate);\n    }\n\n    previousCandidate = candidate;\n}\n\nif (bestCandidates.Count == 1)\n    return bestCandidates[0];\nelse\n    return CircularMean(bestCandidates, period);\n</code></pre>\n<h3>Geometric circular median</h3>\n<p>There is an inconsistency in the previous algorithm, in the way the median is defined in relation to the circular mean. The circular mean minimizes the sum of squared euclidian distances between points on a circle. In other words, it looks at the straight lines connecting points on a circle, cutting through the circle.</p>\n<p>The arc median, as I calculate it above, looks at the arc distances: how far the points are to each other by moving on the perimeter of the circle, not by taking a straight line between them.</p>\n<p>I have thought about how to address this issue, if it bothers you, but I haven't really done any experiments so I can't claim the following method works. In short, I believe you could use a modification of the <a href=\"https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares\" rel=\"nofollow noreferrer\">Iteratively reweighted least squares algorithm (IRLS)</a>, which is what is usually used to calculate <a href=\"https://en.wikipedia.org/wiki/Geometric_median\" rel=\"nofollow noreferrer\">geometric medians</a>.</p>\n<p>The idea is to pick a starting value (for instance, the circular mean or the arc median presented above), and calculate the euclidean distance to each point: Di = sqrt(dxi^2 + dyi^2). Circular mean will minimize the squares of those distances, so the weights of each point should cancel out the square and reset to just D: Wi = Di / Di^2, which is just Wi = 1 / Di.</p>\n<p>With these weights, calculate the weighted circular mean (same as the circular mean, but multiply each sine and cosine by the weight of that point before summing them up) and repeat the process. Repeat until enough iterations have passed or until the result stops changing much.</p>\n<p>The problem with this algorithm is that it has a division by zero if the current solution falls exactly on a data point. Even if the distance isn't exactly zero, the solution will stop moving if you hit close enough to the point because the weight will become enormous compared to all the other ones. This can be fixed by adding a small fixed offset to the distance before dividing by it. This will make the solution suboptimal, but at least it won't stop on a wrong point.</p>\n<p>It will still take some number of iterations to dig itself out of that wrong point unless the offset is relatively large, and the final solution is worse the bigger the offset is. So the best way would probably be to start with a fairly large offset and then progressively making it smaller for each next iteration.</p>\n"}], "owner": {"reputation": 795, "user_id": 7118258, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/83f34172a5465f688a9c72b8da58f045?s=128&d=identicon&r=PG&f=1", "display_name": "Soo", "link": "https://stackoverflow.com/users/7118258/soo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1490, "favorite_count": 3, "answer_count": 5, "score": 3, "last_activity_date": 1599811692, "creation_date": 1506525078, "last_edit_date": 1506527411, "question_id": 46451427, "link": "https://stackoverflow.com/questions/46451427/finding-median-of-a-set-of-circular-data", "title": "Finding median of a set of circular data", "body": "<p>I would like to write a C++ function which finds the median of an array of circular data. \nFor example, consider the reading from a compass where the readings are assumed to be in [0,360). Though 1 &amp; 359 appears to be far away, they are very close due to the circular nature of the reading.</p>\n\n<p>Finding median of N-elements in ordinary data is as follows.\n1. sort the data of N-elements (ascending or descending order)\n2. If N is odd, median is the (N+1)/2 th element in the sorted array.\n3. If N is even, median is the average of the N/2 th and N/2+1 th elements in the sorted array. </p>\n\n<p>However, the wrap around problem in the circular data takes the problem to a different dimension and the solution non-trivial.</p>\n\n<p>A similar question to find mean from circular data is explained here <a href=\"https://stackoverflow.com/questions/491738/how-do-you-calculate-the-average-of-a-set-of-circular-data\">How do you calculate the average of a set of circular data?</a>\nThe suggestion in the above link is to find the unit vector corresponding to each angle and find the average. However, median requires sorting the data and sorting of vectors don't make any sense in this context. Hence I don't think we can use the proposed scheme to find median!</p>\n"}, {"tags": ["c++", "loops", "vector", "iterator"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1506525318, "post_id": 46451418, "comment_id": 79858605, "body": "It is not possible to use a range-based <code>for</code> loop to iterate over elements of a <code>std::vector&lt;bool&gt;</code> by a simple reference.   You will need to use another type to hold the information if you want to use a range-based loop with a reference.   You can use <code>auto &amp;&amp;</code> though."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1506525716, "last_edit_date": 1506525716, "creation_date": 1506525412, "answer_id": 46451553, "question_id": 46451418, "link": "https://stackoverflow.com/questions/46451418/start-value-for-vector-loop/46451553#46451553", "title": "Start value for vector loop", "body": "<p>A range based for loop will always run the entire range, you cant change that unless you adapt the range.  What you can do though is use <a href=\"http://en.cppreference.com/w/cpp/algorithm/count\" rel=\"nofollow noreferrer\"><code>std::count</code>/<code>std::count_if</code></a> to count the instances for you like</p>\n\n<pre><code>auto count = std::count(container.begin(), container.end(), true);\n</code></pre>\n\n<p>and to change the start and stop positions you can use <code>std::next</code> to move the iterator like</p>\n\n<pre><code>auto count = std::count(std::next(container.begin(), some_value),\n                        std::next(container.end(), -some_other_value),\n                        true);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1506526193, "creation_date": 1506526193, "answer_id": 46451811, "question_id": 46451418, "link": "https://stackoverflow.com/questions/46451418/start-value-for-vector-loop/46451811#46451811", "title": "Start value for vector loop", "body": "<blockquote>\n  <p>Is there a better way to count the populated fields in the vector?</p>\n</blockquote>\n\n<p>You can simplify the body of the <code>for</code> loop to:</p>\n\n<pre><code>    numFields += (!isFieldBlank);\n</code></pre>\n\n<p>The complete <code>for</code> loop will be</p>\n\n<pre><code>for ( auto &amp; isFieldBlank : InputProcessor::numericFields_isBlank ) {\n    numFields += (!isFieldBlank);\n}\n</code></pre>\n\n<blockquote>\n  <p>Is there a way to provide a starting index to the for loop iterator?</p>\n</blockquote>\n\n<p>You certainly can. However, you will need to use a normal <code>for</code> loop, not a range-<code>for</code> loop.</p>\n"}], "owner": {"reputation": 191, "user_id": 5965685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf72bb2c2a66a57dff9ed8e23039c145?s=128&d=identicon&r=PG&f=1", "display_name": "mitchute", "link": "https://stackoverflow.com/users/5965685/mitchute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 46451553, "answer_count": 2, "score": 0, "last_activity_date": 1506526972, "creation_date": 1506525048, "question_id": 46451418, "link": "https://stackoverflow.com/questions/46451418/start-value-for-vector-loop", "title": "Start value for vector loop", "body": "<p>Say I have the following:</p>\n\n<pre><code>int numFields = 0;   \nfor ( auto &amp; isFieldBlank : InputProcessor::numericFields_isBlank ) {\n    if ( !isFieldBlank ) {\n        numFields += 1;\n    }\n}\n</code></pre>\n\n<p><code>InputProcessor::numericFields_isBlank</code> is a <code>bool</code> vector of all numeric input values indicating whether the input values are empty <code>true</code> or populated <code>false</code>.</p>\n\n<p>I have two related questions:</p>\n\n<ol>\n<li>Is there a better way to count the populated fields in the vector?</li>\n<li>Is there a way to provide a starting index to the for loop iterator?</li>\n</ol>\n"}, {"tags": ["c++", "performance", "qt", "opengl", "scroll"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8683985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163bdffc6574b25a7f5b122dc3d6da04?s=128&d=identicon&r=PG&f=1", "display_name": "merlinko", "link": "https://stackoverflow.com/users/8683985/merlinko"}, "edited": false, "score": 0, "creation_date": 1506599126, "post_id": 46451833, "comment_id": 79891435, "body": "Thanks for the answer but, ...  I always test in release builds, I tried it on multiple devices even on ios but its not perfect anywhere. My implementation is 100% correct. Mostly I test the scrolling in my side program only for this problem, so there is nothing else than screen with images. They are really downscaled and they have really slow size. The second thing is that i need to use the images as objects with labels and user should be able to click them, so they are not only images. I am really desperate now :/"}], "tags": [], "owner": {"reputation": 753, "user_id": 6229173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20c8a9b53939417106f864f2d347038?s=128&d=identicon&r=PG&f=1", "display_name": "markus-nm", "link": "https://stackoverflow.com/users/6229173/markus-nm"}, "is_accepted": false, "score": 0, "last_activity_date": 1506526260, "creation_date": 1506526260, "answer_id": 46451833, "question_id": 46451192, "link": "https://stackoverflow.com/questions/46451192/how-to-solve-slow-scrolling-in-qt-android-app/46451833#46451833", "title": "How to solve slow scrolling in QT android app", "body": "<p>Neither approach should have problems when scrolling when compared to a native application on the same device. Check the following:</p>\n\n<ol>\n<li>Make sure to measure performance only in release-builds, with QML debugging disabled and no debugger attached.</li>\n<li>Maybe your device simply can't keep up with so many images in one view - then it's not a Qt problem. Compare with a 'native' java-App to see if this is the case.</li>\n<li>Check if you implemented everything correctly; e.g. check if theres anything running in your main-loop or some events happenening repeatedly which consumes CPU time</li>\n</ol>\n\n<p>And some more general advice:</p>\n\n<ol>\n<li>Downscale your images to the appropriate view-size before giving them to the UI, as they might have to be re-scaled on every frame-update and/or consume graphics memory otherwise. E.g. dont set the source to a 1024x1024 image when it's going to show in a 64x64 view</li>\n<li>Remove transparency from the images if they are going to display on solid-colored background anyway.</li>\n<li>Dont overlay the images with other widgets/controls</li>\n<li>If you're still getting a 'slow' UI, maybe try to merge all or multiple images and their surrounding UI/Controls into one or more bigger images</li>\n<li>Very long views are not user-friendly. Maybe implement a pager or tab-view etc. to divide your list into multiple views. This way you can also decrease load-time</li>\n<li>Dont try to implement an interface in openGL yourself. It's unlikely you'll  make a better one than you already get with QtWidgets and QtQuick.</li>\n</ol>\n"}], "owner": {"reputation": 51, "user_id": 8683985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163bdffc6574b25a7f5b122dc3d6da04?s=128&d=identicon&r=PG&f=1", "display_name": "merlinko", "link": "https://stackoverflow.com/users/8683985/merlinko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506526260, "creation_date": 1506524396, "question_id": 46451192, "link": "https://stackoverflow.com/questions/46451192/how-to-solve-slow-scrolling-in-qt-android-app", "title": "How to solve slow scrolling in QT android app", "body": "<p>I am trying to make a simple QT android app, but basically my problem is that on my main screen I have about 250 little images that i want to scroll. But I really need the scrolling to be fluent and fast. First I tried it using QML but it wasnt really fast, then I tried to make the app in qt designer and use widgets but that was very slow. Then I tried using openGL but on android I can only use openGL ES and I cant find so much examples because every example that I find is much more advanced than I need.</p>\n\n<p>But basically my main question is, what do you think is the best way to solve my problem and if its openGL which way of using it is the best that could solve it?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "winapi", "bluetooth-lowenergy"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506524945, "post_id": 46451135, "comment_id": 79858360, "body": "The driver is unhappy about your code.  Nobody could run this code so you&#39;ll have to figure it out yourself.   A crucial first step is to fix the bugs in the error reporting code .  Calling GetLastError() is not correct, the error code is already embedded in the hr value.  Use if (FAILED(hr)) to decide to display it."}, {"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1506525456, "post_id": 46451135, "comment_id": 79858699, "body": "Util.getLastError() generates a readable error from the HR int value. So i don&#39;t see the bug that you see."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1506601334, "post_id": 46451135, "comment_id": 79892890, "body": "@DerekGn except that <a href=\"https://stackoverflow.com/a/7008111/332733\"><code>HRESULT</code> has a way of getting readable errors</a>"}, {"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1506628971, "post_id": 46451135, "comment_id": 79909984, "body": "@Mgetz I did not want to mix com api calls in with winapi for no other reason than i thought it was bad practice. This may be a misguided view. My Util.getLastError() basically does the whole FormatMessage routine. If using HRESULT is ok then less LOC would be better. Thanks for the pointer."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1506683673, "post_id": 46451135, "comment_id": 79929587, "body": "side note: it&#39;s undefined behavior to <code>delete</code> <code>malloc</code>d memory, you need to use <code>free</code> or use <code>new</code>. But honestly you don&#39;t need to do either as you have a pointer to data... and shouldn&#39;t need to make a copy."}, {"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506699265, "post_id": 46451135, "comment_id": 79938896, "body": "@megtz  delete my bad, thanks I will fix  The BTH_LE_GATT_CHARACTERISTIC_VALUE is defined as   typedef struct _BTH_LE_GATT_CHARACTERISTIC_VALUE {     ULONG DataSize;  #ifdef MIDL_PASS     [size_is(DataSize)] UCHAR Data[*]; #else    _Field_size_bytes_(DataSize) UCHAR Data[1]; #endif } BTH_LE_GATT_CHARACTERISTIC_VALUE, *PBTH_LE_GATT_CHARACTERISTIC_VALUE;  You cant assign the payload data to the Data array field, not an lvalue error C3863: array type &#39;UCHAR [1]&#39; is not assignable It looks like the example in the ms docs are incorrect with respect to assigning the Data field."}], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506629996, "post_id": 46468884, "comment_id": 79910451, "body": "yes the code is definitely using service handle. The enumeration of the characteristic uses the standard mechanism as per the <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/hh450795(v=vs.85).aspx\" rel=\"nofollow noreferrer\">docs</a>. I am doing the same thing with different error handling."}, {"owner": {"reputation": 141, "user_id": 4637412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1706fef6353de4ea4f1f76f0cb6c716c?s=128&d=identicon&r=PG", "display_name": "adanteny", "link": "https://stackoverflow.com/users/4637412/adanteny"}, "reply_to_user": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506667372, "post_id": 46468884, "comment_id": 79920660, "body": "@DerekGn did you find your solution? About getting the required size, I&#39;m using the snippet from msdn <a href=\"https://social.msdn.microsoft.com/Forums/en-US/bad452cb-4fc2-4a86-9b60-070b43577cc9/is-there-a-simple-example-desktop-programming-c-for-bluetooth-low-energy-devices?forum=wdk\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a> The memory buffer is then allocated and <b>still alive</b> before and after every call to ::BluetoothGATTSetCharacteristicValue... which is a bit different than your (local) allocation method..."}, {"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506699369, "post_id": 46468884, "comment_id": 79938950, "body": "Ok I miss understood your original point, I incorrectly thought you where referring to the characteristic itself not the value. If I understand you are saying read the characteristic value first, using the double read method, and use that instance as the value to write to the characteristic, modifying the instance to contain the data I wish to send to the device. Is this what you meant?"}, {"owner": {"reputation": 141, "user_id": 4637412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1706fef6353de4ea4f1f76f0cb6c716c?s=128&d=identicon&r=PG", "display_name": "adanteny", "link": "https://stackoverflow.com/users/4637412/adanteny"}, "reply_to_user": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506699735, "post_id": 46468884, "comment_id": 79939176, "body": "No problem, after reading my answer, I can see that I didn&#39;t explain myself clearly. There&#39;s nothing like getting the needed size of the Value : just compute and allocate the proper size according to the data expected :("}], "tags": [], "owner": {"reputation": 141, "user_id": 4637412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1706fef6353de4ea4f1f76f0cb6c716c?s=128&d=identicon&r=PG", "display_name": "adanteny", "link": "https://stackoverflow.com/users/4637412/adanteny"}, "is_accepted": false, "score": 0, "last_activity_date": 1506600857, "creation_date": 1506600857, "answer_id": 46468884, "question_id": 46451135, "link": "https://stackoverflow.com/questions/46451135/bluetoothgattsetcharacteristicvalue-returns-e-invalidarg-or-error-invalid-functi/46468884#46468884", "title": "BluetoothGATTSetCharacteristicValue returns E_INVALIDARG or ERROR_INVALID_FUNCTION", "body": "<p>1- You have to use the Service Handle, right.<br>\n2- I don't know how you designed your class, and then how you allocate some memory for the Characteristic's Value itself.<br>\nWhat I do (to be sure to have enough and proper memory for Value's data):<br>\na) at init of the Value object, call ::BluetoothGATTGetCharacteristicValue twice, to get the needed size and then actually allocate some internal memory for it.<br>\nb) when using it, set the inner memory to what it may , then call ::BluetoothGATTSetCharacteristicValue  </p>\n\n<p>hr=::BluetoothGATTSetCharacteristicValue(<br>\n  handle,<br>\n  (PBTH_LE_GATT_CHARACTERISTIC)Characteristic,<br>\n  value,//actually a (PBTH_LE_GATT_CHARACTERISTIC_VALUE) to allocated memory<br>\n  0,//BTH_LE_GATT_RELIABLE_WRITE_CONTEXT ReliableWriteContext,<br>\n  BLUETOOTH_GATT_FLAG_NONE)  </p>\n"}, {"comments": [{"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506629262, "post_id": 46469355, "comment_id": 79910105, "body": "in my haste I pasted in the one hack to far version of the snippet. I have updated to the latest version."}, {"owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "edited": false, "score": 0, "creation_date": 1506629936, "post_id": 46469355, "comment_id": 79910418, "body": "I simplified the call to write one byte to the device not multiple bytes as in the original version. I am sure that there are no other writes on going when attempting this write. The test harness basically opens the device, enumerates services etc. Reads the manufactures name characteristic, then attempts to write to a proprietary characteristic value. I have tried creating a reliable write context and using in call without any additional success. I will give the retry a shot"}], "tags": [], "owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "is_accepted": false, "score": 0, "last_activity_date": 1506602164, "creation_date": 1506602164, "answer_id": 46469355, "question_id": 46451135, "link": "https://stackoverflow.com/questions/46451135/bluetoothgattsetcharacteristicvalue-returns-e-invalidarg-or-error-invalid-functi/46469355#46469355", "title": "BluetoothGATTSetCharacteristicValue returns E_INVALIDARG or ERROR_INVALID_FUNCTION", "body": "<p>So a few things:</p>\n\n<pre><code>typedef struct _BTH_LE_GATT_CHARACTERISTIC_VALUE {\n   ULONG DataSize;\n   UCHAR Data[];\n} BTH_LE_GATT_CHARACTERISTIC_VALUE, *PBTH_LE_GATT_CHARACTERISTIC_VALUE;\n</code></pre>\n\n<p>is how the <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/hh450842(v=vs.85).aspx\" rel=\"nofollow noreferrer\">data structure used in the parameter <code>CharacteristicValue</code></a> is defined. Please note that <code>Data</code> is <strong>NOT</strong> an allocated array, but rather a pointer. So accessing <code>Data[0]</code> is undefined behavior and could be accessing anywhere in memory. Rather you need to do <code>gatt_value.Data = &amp;data;</code> setting the pointer to the address of the input parameter.</p>\n\n<p>Secondly <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/hh450806(v=vs.85).aspx\" rel=\"nofollow noreferrer\">the documentation is quite clear</a> as to why you might get <code>ERROR_INVALID_FUNCTION</code>; if another reliable write is already pending then this write will fail. You should consider retry logic in that case.</p>\n\n<p>As for <code>E_INVALIDARG</code> I'd assume it's related to the undefined behavior but I'd check after fixing the other issues previously mentioned.</p>\n"}], "owner": {"reputation": 604, "user_id": 993313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0db2fdba7eb045705bad7197945e71?s=128&d=identicon&r=PG", "display_name": "DerekGn", "link": "https://stackoverflow.com/users/993313/derekgn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1506699567, "creation_date": 1506524227, "last_edit_date": 1506699567, "question_id": 46451135, "link": "https://stackoverflow.com/questions/46451135/bluetoothgattsetcharacteristicvalue-returns-e-invalidarg-or-error-invalid-functi", "title": "BluetoothGATTSetCharacteristicValue returns E_INVALIDARG or ERROR_INVALID_FUNCTION", "body": "<p>I have build a set C++ containing classes on top of the BluetoothAPIs apis.</p>\n\n<p>I can enumerate open handles to services, characteristics and descriptors. I can read characteristic values. The issue that I have is that I cannot write to a characteristic value.</p>\n\n<p>Below is the code use to write the characteristic value</p>\n\n<pre><code>void BleGattCharacteristic::setValue(UCHAR * data, ULONG size){\nif (pGattCharacteristic-&gt;IsSignedWritable || pGattCharacteristic-&gt;IsWritable || pGattCharacteristic-&gt;IsWritableWithoutResponse)\n{\n    size_t required_size = sizeof(BTH_LE_GATT_CHARACTERISTIC_VALUE) + size;\n\n    PBTH_LE_GATT_CHARACTERISTIC_VALUE gatt_value = (PBTH_LE_GATT_CHARACTERISTIC_VALUE)malloc(required_size);\n\n    ZeroMemory(gatt_value, required_size);\n\n    gatt_value-&gt;DataSize = (ULONG)size;\n    memcpy(gatt_value-&gt;Data, data, size);\n\n    HRESULT hr = BluetoothGATTSetCharacteristicValue(bleDeviceContext.getBleServiceHandle(), pGattCharacteristic, gatt_value, NULL, BLUETOOTH_GATT_FLAG_NONE);\n\n    free(gatt_value);\n\n    if (HRESULT_FROM_WIN32(S_OK) != hr)\n    {\n        stringstream msg;\n        msg &lt;&lt; \"Unable to write the characeristic value. Reason: [\"\n            &lt;&lt; Util.getLastError(hr) &lt;&lt; \"]\";\n\n        throw BleException(msg.str());\n    }\n}\nelse\n{\n    throw BleException(\"characteristic is not writable\");\n}}\n</code></pre>\n\n<p>The call to bleDeviceContext.getBleServiceHandle() returns the open handle to the device info service.</p>\n\n<p>pGattCharacteristics is the pointer to the characteristic to write too. It was opened with a call to BluetoothGATTGetCharacteristics.</p>\n\n<p>I have tried different combinations of the flags with no difference in the return code.</p>\n\n<p>I have also tried using the handle to the device not to the service. In that case I get an ERROR_INVALID_FUNCTION return error code.</p>\n\n<p>I would appreciate any pointers as to what I am doing wrong or what other possible options I could try.</p>\n"}, {"tags": ["c++", "include", "mathgl"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1506524469, "post_id": 46451133, "comment_id": 79858029, "body": "Installation is one thing, importing the headers is another one. You should configure import paths in XCode."}, {"owner": {"reputation": 403, "user_id": 5752719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/jus9h.jpg?s=128&g=1", "display_name": "DevX10", "link": "https://stackoverflow.com/users/5752719/devx10"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1506524709, "post_id": 46451133, "comment_id": 79858199, "body": "Could you explain better how I could do it in XCode?"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1506524844, "post_id": 46451133, "comment_id": 79858286, "body": "take a look at <a href=\"https://stackoverflow.com/questions/14134064/how-to-set-include-path-in-xcode-project\">this SO question</a>. Also, XCode has a help system built-in."}, {"owner": {"reputation": 403, "user_id": 5752719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/jus9h.jpg?s=128&g=1", "display_name": "DevX10", "link": "https://stackoverflow.com/users/5752719/devx10"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1506525858, "post_id": 46451133, "comment_id": 79858973, "body": "Thanks for the link, but I have tried using Xcode and adding the search path for the header but it still does to find the file. Maybe I add the wrong path.. if you could explain how I can make it work describing in detail what I have to do I will mark you&#39;re answer and upvote it. I really lost the hope, and you would help me a lot with that"}], "owner": {"reputation": 403, "user_id": 5752719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/jus9h.jpg?s=128&g=1", "display_name": "DevX10", "link": "https://stackoverflow.com/users/5752719/devx10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506524223, "creation_date": 1506524223, "question_id": 46451133, "link": "https://stackoverflow.com/questions/46451133/mathgl-for-c-doesnt-find-file-fatal-error", "title": "MathGl for C++ doesn&#39;t find file: fatal error", "body": "<p>Its hours that I'm trying to install mathgl but I'm having a lot of problems.</p>\n\n<p>I tried compiling a simple c++ program just by including <em>mgl2/mgl.h</em> but I have errors.</p>\n\n<p>It gives me <strong>fatal error: 'mgl2/mgl.h' file not found</strong>.</p>\n\n<p>I have tried installing it with brew, and also downloading the single folder and placing it inside <em>usr/local/include</em> but it still doesn't work.</p>\n\n<p>How can I install it cleanly and without having these errors?</p>\n"}, {"tags": ["c#", "c++", ".net", "native", "corert"], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 4474638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e67668b8b7bd50802fd18e8c8a85ce9?s=128&d=identicon&r=PG&f=1", "display_name": "pix", "link": "https://stackoverflow.com/users/4474638/pix"}, "is_accepted": true, "score": 3, "last_activity_date": 1506546087, "creation_date": 1506546087, "answer_id": 46457162, "question_id": 46451090, "link": "https://stackoverflow.com/questions/46451090/how-do-i-build-using-the-native-corert-preview/46457162#46457162", "title": "How do I build using the native corert preview?", "body": "<p>The issue is caused by using the Developer Command Prompt instead of the x64 Native Tools Command Prompt. The former one targets x86 by default, but the latter one targets x64 and will link against the x64 libraries.</p>\n"}], "owner": {"reputation": 784, "user_id": 3461650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BaUzM.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/3461650/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 1, "accepted_answer_id": 46457162, "answer_count": 1, "score": 2, "last_activity_date": 1540199663, "creation_date": 1506524139, "last_edit_date": 1540199663, "question_id": 46451090, "link": "https://stackoverflow.com/questions/46451090/how-do-i-build-using-the-native-corert-preview", "title": "How do I build using the native corert preview?", "body": "<p>I have tried to get a .NET core 2.0 console application targeting win-x86 to build using the <a href=\"https://github.com/dotnet/corert\" rel=\"nofollow noreferrer\">corert</a> ilc compiler and microsoft linker.</p>\n\n<p>So far I downloaded the latest version of the corert libraries and successfully built a preview using the release target as of commit c7781a90f00645f6bd06ef57e5d3fd879fe3e9a0.</p>\n\n<p>I added build scripts rd.xml, ilc.rsp, and link.rsp, but I keep getting the message from ilc:</p>\n\n<pre><code>Error: Target architecture is not supported\nInternal.CommandLine.CommandLineException: Target architecture is not supported\n   at ILCompiler.Program.Run(String[] args)\n   at ILCompiler.Program.Main(String[] args)\n</code></pre>\n\n<p><strong>UPDATE:</strong> I was able to resolve the issue with the architecture, but now it is failing with a missing file reference:</p>\n\n<pre><code>C:\\testapp&gt;call \"..\\corert\\bin\\Windows_NT.x64.Release\\tools\\ilc.exe\" \".\\ilc.rsp\"\nError: [TEMPORARY EXCEPTION MESSAGE] FileLoadErrorGeneric: Microsoft.Extensions.Options\nInternal.TypeSystem.TypeSystemException+FileNotFoundException: [TEMPORARY EXCEPTION MESSAGE] FileLoadErrorGeneric: Microsoft.Extensions.Options\n   at Internal.TypeSystem.ThrowHelper.ThrowFileNotFoundException(ExceptionStringID id, String fileName)\n   at ILCompiler.CompilerTypeSystemContext.GetModuleForSimpleName(String simpleName, Boolean throwIfNotFound)\n   at Internal.TypeSystem.CustomAttributeTypeNameParser.GetTypeByCustomAttributeTypeName(ModuleDesc module, String name, Boolean throwIfNotFound, Func`4 resolver)\n   at Internal.TypeSystem.CustomAttributeTypeNameParser.GetTypeByCustomAttributeTypeName(ModuleDesc module, String name, Boolean throwIfNotFound, Func`4 resolver)\n   at ILCompiler.RdXmlRootProvider.ProcessTypeDirective(IRootingServiceProvider rootProvider, ModuleDesc containingModule, XElement typeElement)\n   at ILCompiler.RdXmlRootProvider.ProcessAssemblyDirective(IRootingServiceProvider rootProvider, XElement assemblyElement)\n   at ILCompiler.RdXmlRootProvider.AddCompilationRoots(IRootingServiceProvider rootProvider)\n   at ILCompiler.Compilation..ctor(DependencyAnalyzerBase`1 dependencyGraph, NodeFactory nodeFactory, IEnumerable`1 compilationRoots, DebugInformationProvider debugInformationProvider, Logger logger)\n   at ILCompiler.ILScannerBuilder.ToILScanner()\n   at ILCompiler.Program.Run(String[] args)\n   at ILCompiler.Program.Main(String[] args)\n</code></pre>\n\n<p><strong>UPDATE 2:</strong> I was able to resolve the issues by finding references for all the missing files, but in the end I realized I needed to switch the architecture target to x64, however now it fails at the linker:</p>\n\n<pre><code>C:\\testapp&gt;call link @\".\\link.rsp\"\nlibcpmt.lib(nothrow.obj) : fatal error LNK1112: module machine type 'x86' conflicts with target machine type 'x64'\n</code></pre>\n"}, {"tags": ["c#", "c++", "windows", "opengl", "cuda"], "comments": [{"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1506534082, "post_id": 46450524, "comment_id": 79863697, "body": "Shot in the dark: Maybe there is internal padding. What happens if you double texture depth from 32 to 64?"}, {"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1506534483, "post_id": 46450524, "comment_id": 79863898, "body": "I see no reason why glGetInteger and cuMemGetInfo would return the same value. The former asks for &quot;dedicated video memory, total size (in kb) of the GPU memory&quot;, the latter &quot;free and total amount of memory available for allocation by the CUDA context, in bytes&quot;."}, {"owner": {"reputation": 39, "user_id": 8683572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3832291b1121833918cbd5d92bd9130e?s=128&d=identicon&r=PG&f=1", "display_name": "tormund", "link": "https://stackoverflow.com/users/8683572/tormund"}, "reply_to_user": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 1, "creation_date": 1506538958, "post_id": 46450524, "comment_id": 79866273, "body": "I haven&#39;t tried double texture depth.  I&#39;ll give that a shot.  However, I did notice that if I make the textures sufficiently large, 256 MB on the K2000 and 512 MB on the M2200 that the doubling disappears.  I&#39;ve tried various powers of 2, and it doesn&#39;t seem to correlate with either.  I understand that the two functions wont return the same value (even with factoring in the conversion), but I&#39;d expect the amount of available memory to decrease at the same rate."}, {"owner": {"reputation": 39, "user_id": 8683572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3832291b1121833918cbd5d92bd9130e?s=128&d=identicon&r=PG&f=1", "display_name": "tormund", "link": "https://stackoverflow.com/users/8683572/tormund"}, "reply_to_user": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 1, "creation_date": 1506631084, "post_id": 46450524, "comment_id": 79910962, "body": "I changed the number of color bits from 32 to 64, and the issue did not go away."}], "owner": {"reputation": 39, "user_id": 8683572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3832291b1121833918cbd5d92bd9130e?s=128&d=identicon&r=PG&f=1", "display_name": "tormund", "link": "https://stackoverflow.com/users/8683572/tormund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1506522748, "creation_date": 1506522592, "last_edit_date": 1506522748, "question_id": 46450524, "link": "https://stackoverflow.com/questions/46450524/windows-10-cuda-opengl-interop-memory-issue", "title": "Windows 10 CUDA OpenGL interop memory issue", "body": "<p>After switching from Windows 7 to Windows 10 I've noticed that calls to <code>cuGraphicsGLRegisterImage</code> to register an OpenGL texture now take double memory.  i.e. after creating a texture that's 200 MB, the register call consumes 400 MB of CUDA memory.  I'm currently running CUDA 8.0.61 (with Patch 2) and OpenGL 4.5 on an M2200 GPU.</p>\n\n<p>This was not the case with Windows 7 on either the K2000 and M2200 GPUs I've ran this code on.</p>\n\n<p>The OpenGL context is using a simple hardware accelerated 32 bit RGBA color, 24 bit depth, 8 bit stencil, double buffered pixel format with no multisampling.</p>\n\n<p>There also appears to be a difference in the amount of available memory returned from \n<code>glGetInteger(GL_GPU_MEMORY_INFO_CURRENT_AVAILABLE_VIDMEM_NVX)</code> vs <code>cuMemGetInfo_v2</code> that grows in size with each register call.</p>\n\n<p>Does anybody know the cause of the additional memory consumption?  Is it the Windows 10 / CUDA driver?  Is there a way I can fix this or a workaround so that I'm not consuming double memory with my OpenGL / CUDA interops? </p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1506522785, "post_id": 46450521, "comment_id": 79856822, "body": "Note you are passing parameters <i>by value</i> into your various functions."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 6, "creation_date": 1506522819, "post_id": 46450521, "comment_id": 79856851, "body": "calling <code>&amp;x</code> a &quot;reference&quot; is a bit confusing. it is the address of <code>x</code> not a reference"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1506523197, "post_id": 46450521, "comment_id": 79857135, "body": "In your functions, <code>&amp;x</code> is the address of the parameter.  It&#39;s not the address of the value you passed to the function."}, {"owner": {"reputation": 403, "user_id": 1438603, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qzoMn.jpg?s=128&g=1", "display_name": "Jackstine", "link": "https://stackoverflow.com/users/1438603/jackstine"}, "edited": false, "score": 0, "creation_date": 1506523442, "post_id": 46450521, "comment_id": 79857304, "body": "Are you saying that because I passed through a function, the x variable of the function deferences the passed parameter?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1506523608, "post_id": 46450521, "comment_id": 79857435, "body": "apart from <code>*x</code> there is no dereferencing and you dont have references. What they are trying to tell you is that the <code>x</code> in each of your functions is completely different from the <code>x</code> in the <code>main</code> (or in the other functions). They have the same value because it gets copied when you call the function, but thats all. Comparing their addresses wont give you much insight other than they are not the same"}, {"owner": {"reputation": 403, "user_id": 1438603, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qzoMn.jpg?s=128&g=1", "display_name": "Jackstine", "link": "https://stackoverflow.com/users/1438603/jackstine"}, "edited": false, "score": 0, "creation_date": 1506524097, "post_id": 46450521, "comment_id": 79857774, "body": "so are these the addresses on the stack? Thats why the addresses are the same for all the functions, and the double pointer is acting like a queue."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506524222, "post_id": 46450521, "comment_id": 79857861, "body": "yes they live in the stack, though i dont understand what you mean with the double pointer"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1506524323, "post_id": 46450521, "comment_id": 79857924, "body": "If you also print <code>&amp;x</code> in <code>main</code>, you&#39;ll see that it&#39;s not in the same location as any of the parameters."}, {"owner": {"reputation": 403, "user_id": 1438603, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qzoMn.jpg?s=128&g=1", "display_name": "Jackstine", "link": "https://stackoverflow.com/users/1438603/jackstine"}, "edited": false, "score": 0, "creation_date": 1506524327, "post_id": 46450521, "comment_id": 79857926, "body": "The reference of the pointer is the same for both the double pointer and the pointer.0062FBB78.  This must be the first memory element in the stack."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506524490, "post_id": 46450521, "comment_id": 79858044, "body": "please stop confusing the words. There is no reference in your code!"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1506524530, "post_id": 46450521, "comment_id": 79858076, "body": "The ampersand, <code>&amp;</code>, only means &quot;reference&quot; when it&#39;s part of a type (such as <code>int&amp;</code>). When it&#39;s part of an expression, such as <code>&amp;x</code>, it&#39;s the address-of operator. <code>&amp;x</code> is usually read &quot;the address of x&quot; or &quot;a pointer to x&quot;, never &quot;a reference to x&quot; (because it isn&#39;t)."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506524708, "post_id": 46450521, "comment_id": 79858198, "body": "...and please dont get offended. Just trying to help and I find it super akward myself that <code>int&amp;</code> is a reference type while <code>operator&amp;</code> is the <code>addressof</code> operator (which has little to do with c++ references). What adds more to the possible confusion is that in other languages &quot;reference&quot; is sometimes used as a general term that can mean e.g. a pointer, but in c++ a pointer and a reference are two very different concepts"}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1563208549, "post_id": 46450521, "comment_id": 100615520, "body": "A &quot;double pointer&quot; is not a thing in C++. What you&#39;re playing with here is a &quot;pointer to pointer&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": true, "score": 2, "last_activity_date": 1506526428, "creation_date": 1506526428, "answer_id": 46451896, "question_id": 46450521, "link": "https://stackoverflow.com/questions/46450521/referencing-a-double-pointer-what-is-the-value/46451896#46451896", "title": "Referencing a Double Pointer, what is the value?", "body": "<p>Before going over you problem, let's first agree that after calling <code>y= &amp;x</code>, y is not a reference to <code>x</code>, but rather the address of <code>x</code>.</p>\n\n<p>Now, let's examine the call to <code>print</code></p>\n\n<p>If you pay close attention, we pass the variable by-value, so this method will actually print the value <code>19</code>, but the address will belong to a temp copy of <code>x</code>.</p>\n\n<p>If we would have changed the prototype to the following one, the address of <code>x</code> printed here will be equal to the address of <code>y</code> printed in the method <code>printPointer</code></p>\n\n<pre><code>void print(int &amp; x) {\n    std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"value: \" &lt;&lt; (x) &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"reference: \" &lt;&lt; (&amp;x) &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Regarding your other concern, these too occur because you pass the pointers by-value and not by-reference.</p>\n\n<p>This simple program shows that everything works just fine:</p>\n\n<pre><code>int main()\n{\n    int x = 19;\n    int *y = &amp;x;\n    int **z = &amp;y;\n\n    std::cout &lt;&lt; x &lt;&lt; \"\\t\" &lt;&lt; &amp;x &lt;&lt; std::endl;\n    std::cout &lt;&lt; y &lt;&lt; \"\\t\" &lt;&lt; &amp;y &lt;&lt; \"\\t\" &lt;&lt; *y &lt;&lt; std::endl;\n    std::cout &lt;&lt; z &lt;&lt; \"\\t\" &lt;&lt; &amp;z &lt;&lt; \"\\t\" &lt;&lt; *z &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 1438603, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qzoMn.jpg?s=128&g=1", "display_name": "Jackstine", "link": "https://stackoverflow.com/users/1438603/jackstine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 46451896, "answer_count": 1, "score": 0, "last_activity_date": 1506526428, "creation_date": 1506522590, "last_edit_date": 1506522688, "question_id": 46450521, "link": "https://stackoverflow.com/questions/46450521/referencing-a-double-pointer-what-is-the-value", "title": "Referencing a Double Pointer, what is the value?", "body": "<p>I cant figure out why the output of this program is what it is.  Maybe some one can help me out.</p>\n\n<p>And why does the reference of double Pointer: 0062FB78?</p>\n\n<p>Why does the reference of dereferenced double pointer = 0062FAA0?</p>\n\n<p>Should'nt these be flipped?</p>\n\n<p>0062FB78 is the address of x</p>\n\n<p>I am guess 0062FAA0 is the address of the double Pointer?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\nvoid print(int x) {\n    std::cout &lt;&lt; \"value: \" &lt;&lt; (x) &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"reference: \" &lt;&lt; (&amp;x) &lt;&lt; \"\\n\";\n    //std::cout &lt;&lt; (*x) &lt;&lt; \"\\n\";\n}\n\nvoid printPointer(int *x) {\n    std::cout &lt;&lt; \"value: \" &lt;&lt; x &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"reference: \" &lt;&lt; &amp;x &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"dereference:\" &lt;&lt; *x &lt;&lt; \"\\n\";\n}\n\nvoid printDoublePointer(int **x) {\n    std::cout &lt;&lt; \"value: \" &lt;&lt; x &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"reference: \" &lt;&lt; &amp;x &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"dereference:\" &lt;&lt; *x &lt;&lt; \"\\n\";\n    printPointer(*x);\n}\n\nvoid printTripplePointer(int ***x) {\n    std::cout &lt;&lt; \"value:\" &lt;&lt; x &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"reference:\" &lt;&lt; &amp;x &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"dereference:\" &lt;&lt; *x &lt;&lt; \"\\n\";\n    printDoublePointer(*x);\n}\n\nvoid print(char* string) {\n    std::cout &lt;&lt; \"\\n\" &lt;&lt; string &lt;&lt; \"\\n\";\n}\n\n\nint main()\n{\n    int x = 19;\n    int *y; // y is a address space\n    y = &amp;x; // &amp;y now points to the address of x, *y now has the value of x\n    int **doublePointer = &amp;y;\n    print(x);\n    printPointer(y);\n    printDoublePointer(doublePointer);\n    print(\"doublePointer\");\n    std::cin &gt;&gt; x;\n}\n\nx\nvalue: 19\nreference: 0062FBB78\n\ny\nvalue: 0062FC7C\nreference: 0062FBB78\ndefererence: 19\n\ndoublePointer\nvalue: 0062FC58\nreference of double Pointer: 0062FB78\ndereference of doble Pointer: 0062FC7C\nvalue of dereferenced double pointer: 0062FC7C\nreference of dereferenced double pointer: 0062FAA0\ndereference: 19\n</code></pre>\n"}, {"tags": ["c#", "c++", "sizeof", "pure-virtual"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 6, "creation_date": 1506522110, "post_id": 46450317, "comment_id": 79856351, "body": "Why are you surprised that the behavior of objects in C++ and C# differs? They are completely different languages with different specifications and implementations. In any case <a href=\"https://stackoverflow.com/questions/4766323/how-to-determine-sizeof-class-with-virtual-functions\">yes the change in <code>sizeof</code> is because of the virtual function(s)</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1506522551, "post_id": 46450317, "comment_id": 79856649, "body": "In C++, the size of structures - in general terms - depends on specifics of how the compiler is implemented. According to the C++ standard, it is implementation defined so different compilers can - and practically will - give different results.      You&#39;ve claimed that the different sizes cause you &quot;way too many problems&quot; - the only way that can happen is if you write code that relies on (or makes assumptions about) objects having particular sizes.  And, except in some very special cases, that is a sign of poor program design."}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1506522570, "post_id": 46450317, "comment_id": 79856661, "body": "Why don&#39;t you make your math operations using data on attributes of each class, instead of worrying with the size in bits of the class that holds the data you need?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1506522606, "post_id": 46450317, "comment_id": 79856691, "body": "&quot;My math library heavily uses interfaces.&quot; maybe thats the problem you have to fix. Virtuals taking space is not a &quot;problem&quot; but just a fact. Dont get inspired by C#  (or java?) when you write C++"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1506522771, "post_id": 46450317, "comment_id": 79856810, "body": "<code>#define PRINT(thing) cout &lt;&lt; thing &lt;&lt; endl</code>, you should use (inline) function instead of MACRO."}, {"owner": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "edited": false, "score": 1, "creation_date": 1506523098, "post_id": 46450317, "comment_id": 79857052, "body": "Does it even make sense to try to take the size of a C# interface - it is a definition of methods/properties/etc that a class or struct implementing it must have. You cannot create an instance of an interface - so it&#39;s size is meaningless. You say that the size issue causes you problems - what problems exactly."}, {"owner": {"reputation": 29, "user_id": 8543729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145651076949a510933e1b89a9dc29f9?s=128&d=identicon&r=PG&f=1", "display_name": "Or Aviram", "link": "https://stackoverflow.com/users/8543729/or-aviram"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1506523398, "post_id": 46450317, "comment_id": 79857271, "body": "@Peter Why is depending on the size a bad design? I have it so my 2 by 2 matrix has a union with a float[4] and a float[2][2], and I have a GetRow method returning a reference. What I wanted to do is just &quot;<i>(Vector2D</i>)(elements2x2[index])&quot;. I don&#39;t see anything wrong with depending on the size."}, {"owner": {"reputation": 29, "user_id": 8543729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145651076949a510933e1b89a9dc29f9?s=128&d=identicon&r=PG&f=1", "display_name": "Or Aviram", "link": "https://stackoverflow.com/users/8543729/or-aviram"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506523405, "post_id": 46450317, "comment_id": 79857280, "body": "@tobi303 Maybe you are right. The problem is that it just makes my life so much easier. I will stop using virtual functions if I find out it just has to be like that, but is there a way to do what I did in C#, or I just have to not use it?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506524377, "post_id": 46450317, "comment_id": 79857963, "body": "if you use more templates instead you can make your life harder, but also more fun ;) why build a hierachy of interfaces when you can use ducktyping?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1506524621, "post_id": 46450317, "comment_id": 79858137, "body": "@Or Aviram - your example in comment (equivalences between the size of arrays (e.g. a <code>float [4]</code> is the same size as a <code>float[2][2]</code> - for a given compiler) is one of the few cases where that works.   That is a special case - there are many more cases where you CANNOT rely on equivalences of sizes, and sizes of data structures - which is what your original question is about - is one of the many cases where you cannot safely rely on consistent sizes."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1506525376, "post_id": 46450317, "comment_id": 79858637, "body": "I think this would be a very good question if you asked how it is possible to have a <code>SizeOf&lt;Stuff&gt;</code> of <code>1</code> in the C# version, given that it has interface methods. It feels like the type information is not part of the object &quot;size&quot; in C#."}, {"owner": {"reputation": 29, "user_id": 8543729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145651076949a510933e1b89a9dc29f9?s=128&d=identicon&r=PG&f=1", "display_name": "Or Aviram", "link": "https://stackoverflow.com/users/8543729/or-aviram"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1506525708, "post_id": 46450317, "comment_id": 79858875, "body": "@Peter But can&#39;t I just <b>not</b> rely on the size wherever it won&#39;t work? Is there a problem with using it at all?"}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1506529348, "post_id": 46450317, "comment_id": 79861257, "body": "It does not make much sense to use virtual functions for a math library as it will make your code slower..."}, {"owner": {"reputation": 29, "user_id": 8543729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145651076949a510933e1b89a9dc29f9?s=128&d=identicon&r=PG&f=1", "display_name": "Or Aviram", "link": "https://stackoverflow.com/users/8543729/or-aviram"}, "reply_to_user": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1506529624, "post_id": 46450317, "comment_id": 79861409, "body": "@Phil1970 Why would it make my code slower? Since you will most likely make objects, and not use pointers, the part where you go to the correct implementation of the function doesn&#39;t happen (since the compiler can figure out which version to call). But that memory thing and tobi303&#39;s idea (which seems pretty good, so I am trying to implement it now) will probably make me stop using them anyways."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1506588399, "post_id": 46450317, "comment_id": 79884402, "body": "@OrAviram - sure.  But your original question was because you were seeking to rely on sizes when there is no guarantee."}], "answers": [{"tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 1, "last_activity_date": 1506542708, "creation_date": 1506542708, "answer_id": 46456346, "question_id": 46450317, "link": "https://stackoverflow.com/questions/46450317/c-pure-virtual-functions-make-class-size-larger/46456346#46456346", "title": "C++ Pure Virtual Functions Make Class Size Larger", "body": "<p>The marshal size of a C# class describes the amount of bytes needed to store it.  That is independent of the interface.</p>\n\n<p>The sizeof a C++ class describes the amount of memory needed in order to implement it.</p>\n\n<p>These are 2 different concepts, and explain the difference you are observing</p>\n"}], "owner": {"reputation": 29, "user_id": 8543729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145651076949a510933e1b89a9dc29f9?s=128&d=identicon&r=PG&f=1", "display_name": "Or Aviram", "link": "https://stackoverflow.com/users/8543729/or-aviram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506542708, "creation_date": 1506521971, "question_id": 46450317, "link": "https://stackoverflow.com/questions/46450317/c-pure-virtual-functions-make-class-size-larger", "title": "C++ Pure Virtual Functions Make Class Size Larger", "body": "<p>My math library heavily uses interfaces. It works in a way that I have an interface, for example IVector, and then child classes can derive/implement it. The reason for that is that all vectors need to be able to take a dot product with another vector, and I don't want to forget it for some reason, so it's good to have it there.\nThose are not exactly interfaces, though. For example, the implementation for getting the magnitude of a vector is not specific to each vector struct, so I just put it in IVector. I also have a Vector namespaces that calls functions from the IVector interface, so I will also be able to do Vector::Dot(a, b), instead of a.Dot(b).</p>\n\n<p>That setup works really well, but there is a big problem: The size of the structs implementing the interfaces is bigger. After doing some testing, I found out the reason for that is the pure virtual functions:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n#define PRINT(thing) cout &lt;&lt; thing &lt;&lt; endl\n\nstruct A\n{\n    virtual void F() = 0;\n};\n\nclass B final : public A\n{\n\n};\n\nclass C\n{\n    void F()\n    {\n\n    }\n};\n\nclass D : public C\n{\n\n};\n\n\nvoid main()\n{\n    PRINT(sizeof(A)); // 4\n    PRINT(sizeof(B)); // 4\n    PRINT(sizeof(C)); // 1\n    PRINT(sizeof(D)); // 1\n    cin.get();\n}\n</code></pre>\n\n<p>What I assumed is that the cause for that is the vpointer, but I am not sure.</p>\n\n<p>But even if it makes sense that it happens, why do struct sizes not get any bigger when implementing interfaces in C#? That's a test I ran (not that I get the same result with Marshal.SizeOf for Stuff, but it doesn't work with the interfaces):</p>\n\n<pre><code>using System;\nusing DotNetCross.Memory;\n\ninterface IStuff\n{\n    void DoStuff();\n}\n\ninterface IPlsStop : IStuff\n{\n    void Whatevah();\n}\n\nstruct Stuff : IPlsStop\n{\n    public void DoStuff()\n    {\n\n    }\n\n    public void Whatevah()\n    {\n\n    }\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        Console.WriteLine(Unsafe.SizeOf&lt;Stuff&gt;());    // 1\n        Console.WriteLine(Unsafe.SizeOf&lt;IStuff&gt;());   // 8\n        Console.WriteLine(Unsafe.SizeOf&lt;IPlsStop&gt;()); // 8\n\n        Console.ReadKey();\n    }\n}\n</code></pre>\n\n<p>I thought interfaces were just sugar for pure abstract classes, but apparently they are not. I assume the size of the interfaces themselves is larger because they are reference types.</p>\n\n<p>So why do C# interfaces not take more memory while C++ pure-virtual functions do take up more memory?</p>\n\n<p>That problem causes me way too many problems, and I must fix it. The thing I want to know the most is what I can do to make C# like interfaces in C++ (so I can implement them without the class becoming larger).</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1506521840, "post_id": 46450221, "comment_id": 79856166, "body": "As for your problem, can you please tell us the input you give the program, as well as the actual and expected output? Please take some time to <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 1, "creation_date": 1506522031, "post_id": 46450221, "comment_id": 79856300, "body": "<code>getline</code> gets a whole line - including spaces. A space s a perfectly valid character to have in a string..."}], "answers": [{"tags": [], "owner": {"reputation": 118, "user_id": 8649909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6eb5ce7d1584371058639003a1d39?s=128&d=identicon&r=PG&f=1", "display_name": "nachmr", "link": "https://stackoverflow.com/users/8649909/nachmr"}, "is_accepted": false, "score": 0, "last_activity_date": 1506522039, "creation_date": 1506522039, "answer_id": 46450338, "question_id": 46450221, "link": "https://stackoverflow.com/questions/46450221/c-store-string-sentences-from-user-input-into-a-vector/46450338#46450338", "title": "C++ store string sentences from user input into a vector", "body": "<p>Did you try to put cin.clear(); cin.sync(); before getline function? cin and getline give you problems when you use them at the same time.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8682532, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cBIibx7Xdvg/AAAAAAAAAAI/AAAAAAAAABQ/PA_bNdN52XU/photo.jpg?sz=128", "display_name": "D_Cozy14", "link": "https://stackoverflow.com/users/8682532/d-cozy14"}, "edited": false, "score": 0, "creation_date": 1506522961, "post_id": 46450402, "comment_id": 79856958, "body": "thanks! it actually fixed it. Also, thanks for the explanation why it happens"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1506522226, "creation_date": 1506522226, "answer_id": 46450402, "question_id": 46450221, "link": "https://stackoverflow.com/questions/46450221/c-store-string-sentences-from-user-input-into-a-vector/46450402#46450402", "title": "C++ store string sentences from user input into a vector", "body": "<p>The problem is the <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/ignore\" rel=\"nofollow noreferrer\"><code>ignore</code></a> call inside the loop.</p>\n\n<p>The <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\"><code>std::getline</code></a> will silently eat up the trailing newline, but since you then call <code>ignore</code> you must enter a <em>second</em> line for <code>ignore</code> to be satisfied.</p>\n\n<p>Simply remove the <code>ignore</code> call from the loop and it should work as you expect.</p>\n"}], "owner": {"reputation": 3, "user_id": 8682532, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cBIibx7Xdvg/AAAAAAAAAAI/AAAAAAAAABQ/PA_bNdN52XU/photo.jpg?sz=128", "display_name": "D_Cozy14", "link": "https://stackoverflow.com/users/8682532/d-cozy14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 0, "accepted_answer_id": 46450402, "answer_count": 2, "score": 0, "last_activity_date": 1506522647, "creation_date": 1506521696, "last_edit_date": 1506522647, "question_id": 46450221, "link": "https://stackoverflow.com/questions/46450221/c-store-string-sentences-from-user-input-into-a-vector", "title": "C++ store string sentences from user input into a vector", "body": "<p>I am a beginner at C++ and currently learning vectors. Here is a simple code where program gets the user input and stores it in a vector then proceed to print the stored values from each element:</p>\n\n<pre><code>int main(){\nvector&lt;string&gt; myVector;\nstring myInput;\nint n;\ncin&gt;&gt;n;\ncin.ignore(numeric_limits&lt;streamsize&gt;::max(),'\\n');\nfor(int i = 1; i &lt;= n;i++){\n  cout&lt;&lt;\"loop count: \"&lt;&lt;i&lt;&lt;endl; //added for checking the current loop\n  getline(cin, myInput);\n  cin.ignore(numeric_limits&lt;streamsize&gt;::max(),'\\n');\n  myVector.push_back(myInput);\n  }\nfor(unsigned int j = 0;j &lt; myVector.size(); j++){\ncout&lt;&lt;myVector[j]&lt;&lt;endl;\n}\nreturn 0;\n}\n</code></pre>\n\n<p>but when I run my code, during the user string input, it lets me enter two strings before finally going to the next loop. the program only prints out the first entered string for each loop though. So my questions are:</p>\n\n<p>1) What is the reason behind this? Why does user need to enter two strings before going to next loop? Can someone explain to me.</p>\n\n<p>2) how can this be fixed?</p>\n\n<p>EDIT: Here are my sample inputs and the output:</p>\n\n<p>input:</p>\n\n<pre><code>3\ninput loop count: 1\nwe are\nthe champions\ninput loop count: 2\nno time\nfor losers\ninput loop count: 3\nwe are\nthe champions\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>we are\nno time\nwe are\n</code></pre>\n"}, {"tags": ["c++", "rvalue", "lvalue"], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1506521925, "creation_date": 1506521925, "answer_id": 46450302, "question_id": 46450142, "link": "https://stackoverflow.com/questions/46450142/are-r-l-values-relative-to-its-context/46450302#46450302", "title": "Are R &amp; L-values relative to its context?", "body": "<p>This depends.  The built in <code>operator=</code> returns an lvalue reference to the left hand side of the assignment.  So, if <code>a</code> and <code>b</code> are <code>int</code>'s then <code>(b = 5)</code> is an lvalue expression and you assign that lvalue to <code>a</code>, with <code>a</code> and <code>b</code> both being lvalues and <code>5</code> being a prvalue.</p>\n\n<p>This is generally the same for overloaded <code>operator=</code> as well since most people return a lvalue reference but it does not have to be.</p>\n\n<p>If you want to cast a lvalue into a rvalue then you use <a href=\"http://en.cppreference.com/w/cpp/utility/move\" rel=\"nofollow noreferrer\"><code>std::move</code></a>.</p>\n"}], "owner": {"reputation": 835, "user_id": 587680, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b4f918d7b845dfb3e430d05d1f0361ee?s=128&d=identicon&r=PG", "display_name": "xotix", "link": "https://stackoverflow.com/users/587680/xotix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 46450302, "answer_count": 1, "score": 0, "last_activity_date": 1506521925, "creation_date": 1506521497, "question_id": 46450142, "link": "https://stackoverflow.com/questions/46450142/are-r-l-values-relative-to-its-context", "title": "Are R &amp; L-values relative to its context?", "body": "<p>so assume we write the following in C++: <code>a=b=5;</code> which basically means <code>a=(b=5);</code></p>\n\n<p>If we have <code>a=5;</code> I know that 5 is a literal and thus it is an R-Value. <code>a</code> is an L-Value. Same goes for <code>b=5;</code></p>\n\n<p>I'm wondering now, what happens, if we write <code>a=b=5;</code> respectively <code>a=(b=5);</code></p>\n\n<p>Can I now say the following?</p>\n\n<p>For <code>a</code>, <code>b=5</code> is an R-Value with <code>a</code> being an L-Value. Also, <code>b</code> is an L-Value and <code>5</code> is an R-Value.</p>\n\n<p>What's the R-Value of <code>a</code>?</p>\n"}, {"tags": ["c++", "c++17", "fold", "fold-expression"], "comments": [{"owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "edited": false, "score": 0, "creation_date": 1506522721, "post_id": 46450054, "comment_id": 79856774, "body": "Since all your <code>typename Pairs::second_type...</code> are different, I think you can do it only with recursion."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "edited": false, "score": 0, "creation_date": 1506522939, "post_id": 46450054, "comment_id": 79856935, "body": "@j6t: but all <code>decltype(ps.second)()</code> are the same. My intention is generating a set of <code>if</code> statements with a <i>fold expression</i>"}, {"owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "edited": false, "score": 0, "creation_date": 1506525580, "post_id": 46450054, "comment_id": 79858791, "body": "They are not the same. Each of the lambdas in your example invocation is a different type. They cannot be the same because each lambda&#39;s operater() implementation is different even though they look like they have the same signature."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "edited": false, "score": 0, "creation_date": 1506527106, "post_id": 46450054, "comment_id": 79859839, "body": "@j6t: sorry, I screwed up my comment. I meant that they all return <code>int</code>. (i.e. <code>decltype(ps.second())</code> is the same)"}], "answers": [{"tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 0, "last_activity_date": 1506522817, "creation_date": 1506522817, "answer_id": 46450600, "question_id": 46450054, "link": "https://stackoverflow.com/questions/46450054/retrieve-value-out-of-cascading-ifs-fold-expression/46450600#46450600", "title": "Retrieve value out of &quot;cascading ifs&quot; fold expression", "body": "<p>This is not possible. In order to use a fold expression, you would need to define a binary operator on your <code>Pairs</code>.</p>\n\n<p>In your case, such a binary operator cannot exist since:</p>\n\n<ul>\n<li>it would need to be statefull (i.e. capture x since it compares <code>Pairs::first</code> with <code>x</code>)</li>\n<li><em>and</em> an operator must be either a (i) non-static member function or a (ii) non-member function.</li>\n</ul>\n\n<p>Furthermore:</p>\n\n<ul>\n<li>(i) a non-static member operator implicitly takes <code>this</code> as a first argument, and you could not make <code>this</code> a pointer to a <code>Pairs</code> or a derived of <code>Pairs</code>;</li>\n<li>(ii) a non-member function could not capture the value of <code>x</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1506527195, "post_id": 46451790, "comment_id": 79859886, "body": "Interesting. Any way to generalize this to <code>T</code> instead of <code>int</code>, supporting types that only provide construction?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1506527734, "post_id": 46451790, "comment_id": 79860242, "body": "@VittorioRomeo I have some ideas, will do the code in a moment."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1506532635, "post_id": 46451790, "comment_id": 79862980, "body": "@HolyBlackCat - what about <code>( (ret = ps.second(), ps.first == x) || ... );</code>?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1506533107, "post_id": 46451790, "comment_id": 79863212, "body": "@max66 It&#39;s shorter, but less efficient (unless the compiler optimizes it, and I wouldn&#39;t want to rely on it)."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1506533228, "post_id": 46451790, "comment_id": 79863266, "body": "@HolyBlackCat - yes... it&#39;s a bad idea; impose a lot of assignments that should be avoided."}, {"owner": {"reputation": 918, "user_id": 3818946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc61d637f0b25ffe8562e43aee03cab?s=128&d=identicon&r=PG&f=1", "display_name": "deltacrux", "link": "https://stackoverflow.com/users/3818946/deltacrux"}, "edited": false, "score": 0, "creation_date": 1554417519, "post_id": 46451790, "comment_id": 97755856, "body": "This answer is brilliant, wish I could upvote twice. I used this technique to implement a dynamic dispatch function using cascading <code>if (dynamic_cast&lt;Ts*&gt;) ...</code>. The only gotcha I ran into was that <a href=\"https://stackoverflow.com/questions/21975812/should-stdcommon-type-use-stddecay\"><code>std::common_type_t</code> does not preserve references</a>, so if you want to have a <code>using</code> declaration instead of a template parameter and return a reference you have to play some games with <code>std::is_reference</code> and <code>std::decay</code>. Still, it works great \u2013 thanks @HolyBlackCat!"}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 17, "last_activity_date": 1506529306, "last_edit_date": 1592644375, "creation_date": 1506526148, "answer_id": 46451790, "question_id": 46450054, "link": "https://stackoverflow.com/questions/46450054/retrieve-value-out-of-cascading-ifs-fold-expression/46451790#46451790", "title": "Retrieve value out of &quot;cascading ifs&quot; fold expression", "body": "<p>I'm surprised it wasn't suggested yet:</p>\n<pre><code>template &lt;typename ...Pairs&gt; auto make_switch(Pairs ...ps)\n{\n    return [=](int x)\n    {\n        int ret;\n        ((x == ps.first &amp;&amp; (void(ret = ps.second()), 1)) || ...)\n            /* || (throw whatever, 1) */ ;\n        return ret;\n    };\n}\n</code></pre>\n<p><a href=\"http://coliru.stacked-crooked.com/a/0bc79a0ee10a7c0b\" rel=\"noreferrer\">(try it online)</a></p>\n<p>It requires an additional variable, but it seems the only alternatives are recursion and a wrapper class with an overloaded binary operator, and both look less elegant to me.</p>\n<p>The short-circuiting of <code>||</code> is used to stop the function when a match is found.</p>\n<p><sub>(For the above code GCC 7.2 gives me <code>warning: suggest parentheses around '&amp;&amp;' within '||'</code>. Probably a bug?)</sub></p>\n<h3>Edit:</h3>\n<p>Here's a version generalized for any types: <sub>(credits to @Barry for suggesting <code>std::optional</code>)</sub></p>\n<pre><code>template &lt;typename InputType, typename ReturnType, typename ...Pairs&gt; auto make_switch(Pairs ...ps)\n{\n    /* You could do\n     *   using InputType  = std::common_type_t&lt;typename Pairs::first_type...&gt;;\n     *   using ReturnType = std::common_type_t&lt;decltype(ps.second())...&gt;;\n     * instead of using template parameters.\n     */\n    \n    return [=](InputType x)\n    {\n        std::optional&lt;ReturnType&gt; ret /* (default_value) */;\n        ( ( x == ps.first &amp;&amp; (void(ret.emplace(std::move(ps.second()))), 1) ) || ...)\n            /* || (throw whatever, 1) */;\n        return *ret;\n    };\n}\n</code></pre>\n<p><a href=\"http://coliru.stacked-crooked.com/a/257d0a072ffadc56\" rel=\"noreferrer\">(try it online)</a></p>\n<p>I decided to use template parameters for parameter and return types, but you can deduce them if you want.</p>\n<p>Note that if you decide to not have a default value nor <code>throw</code>, then passing an invalid value to the switch will give you UB.</p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 0, "last_activity_date": 1506531886, "creation_date": 1506531886, "answer_id": 46453502, "question_id": 46450054, "link": "https://stackoverflow.com/questions/46450054/retrieve-value-out-of-cascading-ifs-fold-expression/46453502#46453502", "title": "Retrieve value out of &quot;cascading ifs&quot; fold expression", "body": "<p>I think the solution from HolyBlackCat is better but... what about using a sum?</p>\n\n<pre><code>template &lt;typename ... Pairs&gt;\nauto make_switch (Pairs ... ps)\n {\n   return [=](int x)\n    { return ( (ps.first == x ? ps.second() : 0) + ... ); };\n }\n</code></pre>\n\n<p>Unfortunately, works only for types where the sum is defined.</p>\n"}], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 1, "accepted_answer_id": 46451790, "answer_count": 3, "score": 9, "last_activity_date": 1506531886, "creation_date": 1506521254, "last_edit_date": 1506522537, "question_id": 46450054, "link": "https://stackoverflow.com/questions/46450054/retrieve-value-out-of-cascading-ifs-fold-expression", "title": "Retrieve value out of &quot;cascading ifs&quot; fold expression", "body": "<p>Let's assume that I want to create my own <em>lambda</em>-based switch with the following syntax:</p>\n\n<pre><code>auto s = make_switch(std::pair{0, []{ return 0;   }},\n                     std::pair{1, []{ return 50;  }},\n                     std::pair{2, []{ return 100; }});\n\nassert( s(0) == 0   );\nassert( s(1) == 50  );\nassert( s(2) == 100 );\n</code></pre>\n\n<p>I would like to use a <em>fold expression</em> in order to have a terse implementation that does not require recursion. The idea is to generate something similar to a bunch of nested <code>if</code> statements:</p>\n\n<pre><code>if(x == 0) return 0;\nif(x == 1) return 50;\nif(x == 2) return 100;\n</code></pre>\n\n<p>I would like to write this:</p>\n\n<pre><code>// pseudocode\ntemplate &lt;typename... Pairs&gt;\nauto make_switch(Pairs... ps)\n{\n    return [=](int x)\n    {\n        ( if(ps.first == x) return ps.second(), ... );\n    };\n}\n</code></pre>\n\n<p>The code above doesn't work as <code>if(...){...}</code> is not an expression. I then tried to use the <code>&amp;&amp;</code> operator:</p>\n\n<pre><code>template &lt;typename... Pairs&gt;\nauto make_switch(Pairs... ps)\n{\n    return [=](int x)\n    {\n        return ((ps.first == x &amp;&amp; ps.second()), ...);\n    };\n}\n</code></pre>\n\n<p>This does compile, but returns the result of <code>ps.first == x &amp;&amp; ps.second()</code>, which is a <code>bool</code> and not the <code>int</code> value that I want. </p>\n\n<p>I would like some kind of operator that is a combination between the <em>comma operator</em> and <code>&amp;&amp;</code>: it should evaluate and evaluate to the <em>right hand side</em> of the operator iff the <em>left hand side</em> evaluates to <code>true</code>. </p>\n\n<p>I cannot think of any technique that would allow me to implement this in such a way I can get <code>ps.second()</code>'s return value and propagate it to the caller of the lambda returned by <code>make_switch</code>.</p>\n\n<p><strong>Is it possible to implement this kind of \"cascading <code>if</code>s\" pattern with a <em>fold expression</em>?</strong> I would like to evaluate only as many expressions as required until a matching branch is found.</p>\n"}, {"tags": ["c++", "windows", "sockets", "tcp", "winsock2"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 1, "creation_date": 1506521313, "post_id": 46450006, "comment_id": 79855773, "body": "Flaky connection, connection lost, ignored error code."}, {"owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1506522795, "post_id": 46450006, "comment_id": 79856831, "body": "@CodeCaster Maybe I have much homework to do. Is it OK if I ignore this error and try to send again later? I have changed my code to improve it and will test more to see whether it works in my tomorrow&#39;s work."}, {"owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1506523774, "post_id": 46450006, "comment_id": 79857573, "body": "@CodeCaster I think I missing some important context about my error.  The connection to server, the send thread start and my fisrt try to send login packet to server is line by line.  By now, if first send failed, no more packet will send.  So I have the question in my first reply.  More work need wait until tomorrow. Thank you for your reply."}], "answers": [{"tags": [], "owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "is_accepted": false, "score": -1, "last_activity_date": 1507624121, "last_edit_date": 1507624121, "creation_date": 1506995421, "answer_id": 46536080, "question_id": 46450006, "link": "https://stackoverflow.com/questions/46450006/why-did-my-winsocks2-send-result-in-10057-error-sometimes/46536080#46536080", "title": "Why did my winsocks2 send result in 10057 error sometimes?", "body": "<p>Hope my shallow answer will help someone.</p>\n\n<p>It turns out to be that I <code>ioctlsocket</code> client socket to <strong>nonblocking mode</strong> before <code>connect</code>. Connection maynot completed when <code>connect</code> returns, but I immediately start <strong>send thread</strong>. There is a chance that <strong>send thread</strong> <code>send</code> data to an <strong>unconnected soeckt</strong>. </p>\n\n<p>Like <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms737625(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN</a> says, <strong>With a nonblocking socket, the connection attempt cannot be completed immediately.</strong> </p>\n\n<p>PS: <code>send</code> may <strong>send</strong> bytes that less than <strong>expected bytes</strong> specified via the third argument of <code>send</code>.     </p>\n\n<pre><code>int remain_size = pakcet_size;\nint this_read_cnt = 0;\nfor (;;) {\n    if ((this_read_cnt = ::send(g_client_fd, addr+ pakcet_size - remain_size, remain_size, 0)) != SOCKET_ERROR) {\n        remain_size = pakcet_size - this_read_cnt;\n    }\n    else {\n        LOGFMTT(\"send last err[%d].\", GetLastError());\n    }\n\n    if (remain_size == 0) {\n        delete[]addr;\n        g_send_queue.erase(g_send_queue.begin());\n        break;\n    }\n}   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "edited": false, "score": 0, "creation_date": 1507604033, "post_id": 46536248, "comment_id": 80264698, "body": "Thank you for figuring it out, I have detailed my answer. This is my first edition. I had changed <code>send</code> part to a <code>loop</code> like my answer shown when I encountered this question. Hope that you can make me more clear about when <b>10057 error</b> could appear and what should my code do."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1507604137, "post_id": 46536248, "comment_id": 80264720, "body": "This is correct.  <code>send</code> returns a value that must be checked without exception."}, {"owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "edited": false, "score": 0, "creation_date": 1507604931, "post_id": 46536248, "comment_id": 80264891, "body": "No matter how bad is my code, send can result in <b>10057 error</b> and it is the point in my case that <b>I shoudn&#39;t stop sending after 10057 error</b>."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "edited": false, "score": 0, "creation_date": 1507605490, "post_id": 46536248, "comment_id": 80265006, "body": "@JandunCN It happens when the socket is not connected, as per your quotation from MSDN: in other words, when you haven&#39;t succeeded in calling <code>connect()</code> in prior code. If it happens, it means you either omitted a <code>connect()</code> call or ignored its failure. It is therefore evidence of a prior bug, which must be fixed. Merely mindlessly repeating the <code>send()</code> is pointless. It won&#39;t fix your bug, or magically connect your unconnected socket. Your remark about &#39;shouldn&#39;t stop sending&#39; is incorrect."}, {"owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "edited": false, "score": 0, "creation_date": 1507608147, "post_id": 46536248, "comment_id": 80265575, "body": "@EJP Thanks. But I am confused, I didn&#39;t do anything except changing <code>send</code> part code. And my accident bug disappeared after the change. More information will be appended after I catch the culprit."}, {"owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "edited": false, "score": 0, "creation_date": 1507623273, "post_id": 46536248, "comment_id": 80271922, "body": "@EJP Yes, it is just not connected, because I <code>ioctlsocket</code> client socket to <b>nonblocking mode</b> before <code>connect</code>. Connection maynot completed when <code>connect</code> returns, but I immediately start <b>send thread</b>. There is a chance that <b>send thread</b> <code>send</code> data to an unconnected soeckt.  Thank you again for your reply, without which I wouldn&amp;#39;t have reviewed the problem."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1506997389, "last_edit_date": 1506997389, "creation_date": 1506996897, "answer_id": 46536248, "question_id": 46450006, "link": "https://stackoverflow.com/questions/46450006/why-did-my-winsocks2-send-result-in-10057-error-sometimes/46536248#46536248", "title": "Why did my winsocks2 send result in 10057 error sometimes?", "body": "<blockquote>\n  <p>Why did my winsocks2 send result in 10057 error sometimes?</p>\n</blockquote>\n\n<p>It didn't. At least, there is no evidence that it did.</p>\n\n<pre><code>::send(g_client_fd, addr, pakcet_size, 0);\n/* ------------!Attention begin------------ */\nLOGFMTT(\"send last err[%d].\", GetLastError());--------&gt; sometimes got 10057 error.\n</code></pre>\n\n<p>It isn't valid to call <code>WSAGetLastError()</code> <em>unless</em> there <em>was</em> an error, which in this case would have been signalled by <code>send()</code> returning -1. But as you aren't checking for that, there is no evidence here of a problem to be solved, except for your poor coding around <code>send()</code>. It should read:</p>\n\n<pre><code>if (::send(g_client_fd, addr, pakcet_size, 0) == -1)\n{\n    /* ------------!Attention begin------------ */\n    LOGFMTT(\"send last err[%d].\", GetLastError());--------&gt; sometimes got 10057 error.\n}\n</code></pre>\n\n<p>NB The word is spelt 'packet', not 'pakcet'.</p>\n"}], "owner": {"reputation": 482, "user_id": 3136752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/XHoZm.jpg?s=128&g=1", "display_name": "waterd", "link": "https://stackoverflow.com/users/3136752/waterd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1507624121, "creation_date": 1506521139, "last_edit_date": 1506997037, "question_id": 46450006, "link": "https://stackoverflow.com/questions/46450006/why-did-my-winsocks2-send-result-in-10057-error-sometimes", "title": "Why did my winsocks2 send result in 10057 error sometimes?", "body": "<p>I did tcp socket connection with normal(?) steps as the code shows below. But send <strong>sometimes</strong> result in <strong>10057</strong> error while server-end printed some log which says connection is in, I have no idea about what's wrong with my code. Any help is appreciated.\n Any information about stable and robust windows socket programming is appreciated.</p>\n\n<p>MSDN description about 10057 error:</p>\n\n<blockquote>\n  <p>Socket is not connected.A request to send or receive data was disallowed because the socket is not connected and (when sending on a datagram socket using sendto) no address was supplied. Any other type of operation might also return this error\u2014for example, setsockopt setting SO_KEEPALIVE if the connection has been reset.</p>\n</blockquote>\n\n<hr>\n\n<p>PS: Real ip address in below code snippet is replaced by <em>127.0.0.1</em>. Code isn't runnable.</p>\n\n<pre><code>int connect_to_server() {\nSOCKET soc;\nSOCKADDR_IN serveraddr;\nSOCKADDR_IN clientaddr;\nunsigned char buf[1024];\n\nWSADATA wsa;\nWSAStartup(MAKEWORD(2, 2), &amp;wsa);\n\n/* create a tcp socket; */  \nif ((soc = socket(AF_INET, SOCK_STREAM, 0/*IPPROTO_TCP*/)) &lt;= 0)\n{\n    LOGFMTF(\"errcode[-1], create socket fail!\");\n    return -1;\n}\n\nserveraddr.sin_family = AF_INET;\n\nserveraddr.sin_port = htons(9102);\nserveraddr.sin_addr.S_un.S_addr = inet_addr(\"127.0.0.1\");\n\nunsigned long mode = 1;  // 1 to enable non-blocking socket\nif (ioctlsocket(soc, FIONBIO, &amp;mode) == SOCKET_ERROR) {\n    LOGFMTF(\"errcode[-2], ioctlsocket fail.\");\n    return -2;\n}\n\nif (::connect(soc, (SOCKADDR *)&amp;serveraddr, sizeof(serveraddr)) != 0)\n{\n    /* FIONBIO socket enters here can go run; non-FIONBIO socket enters here stands for real error;*/\n    if (WSAGetLastError() != WSAEWOULDBLOCK) {\n        LOGFMTF(\"errcode[-3], connect fail.\");\n        //return -3;\n    }\n\n    //return -1;\n}\n\ng_client_fd = soc;\n\nLOGFMTT(\"client_fd[%d]\", g_client_fd);\nLOGFMTT(\"connect to server last err[%d].\", WSAGetLastError());\n\nreturn 0;\n}\n\n/** send loop; */\nDWORD WINAPI send_thread_loop(LPVOID pM) {\nLOGFMTT(\"send thread[%d] start.\", GetCurrentThreadId());\n\nfor (;!g_to_exit;) \n{\n    QMutexLocker locker(&amp;g_send_queue_lock);\n    if (g_send_queue.count() == 0) {\n        Sleep(Send_Thread_Gap);\n    }else {\n        LOGFMTT(\"send one packet.\");\n        int pakcet_size = g_send_queue.begin()-&gt;size;\n        char *addr = g_send_queue.begin()-&gt;data;\n        ::send(g_client_fd, addr, pakcet_size, 0);\n\n        /* ------------!Attention begin------------ */\n        LOGFMTT(\"send last err[%d].\", GetLastError());--------&gt; sometimes got 10057 error.\n        /* ------------!Attention end------------ */\n\n        delete[]addr;\n        g_send_queue.erase(g_send_queue.begin());\n    }\n}\n\nLOGFMTT(\"send thread[%d] exit.\", GetCurrentThreadId());\n\nreturn 0;\n}\n\nint start_net_thread() {\ng_recv_thread = CreateThread(NULL, 0, recv_thread_loop, NULL, 0, NULL);\n\ng_send_thread = CreateThread(NULL, 0, send_thread_loop, NULL, 0, NULL);\n\nreturn 0;\n}\n\nint main(){\nif(connect_to_server() != 0) \n{\n    QMessageBox msgBox;\n    msgBox.setText(\"failed.\");\n    msgBox.exec();\n    return -1;\n}\n\nstart_net_thread();\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "cocos2d-x", "cocos2d-x-3.0"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1506523480, "post_id": 46449811, "comment_id": 79857335, "body": "I couldn&#39;t figure it out, but take a look at <code>EventListenerFocus::create()</code>"}, {"owner": {"reputation": 1034, "user_id": 7260358, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/89816826f8b210b236daa1e42e5b55e6?s=128&d=identicon&r=PG", "display_name": "Star_Man", "link": "https://stackoverflow.com/users/7260358/star-man"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1506525015, "post_id": 46449811, "comment_id": 79858410, "body": "@Acidic, thank you! But I want to know about  focus event of windows, not a scene or node."}], "owner": {"reputation": 1034, "user_id": 7260358, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/89816826f8b210b236daa1e42e5b55e6?s=128&d=identicon&r=PG", "display_name": "Star_Man", "link": "https://stackoverflow.com/users/7260358/star-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506520647, "creation_date": 1506520647, "question_id": 46449811, "link": "https://stackoverflow.com/questions/46449811/cocoa2d-x-3-15-how-to-detect-the-focus-and-unfocus-event-in-window", "title": "Cocoa2d-x 3.15, How to detect the focus and unfocus event in window", "body": "<p>I am developing windows game by using cocos2d-x 3.15 version.</p>\n\n<p>By the way, how to detect the event of focus and unfocus of window?</p>\n\n<p><a href=\"http://blog.cocos2d-x.org/2017/01/cocos2d-x-v3-14-released/\" rel=\"nofollow noreferrer\">http://blog.cocos2d-x.org/2017/01/cocos2d-x-v3-14-released/</a></p>\n\n<p>It says:</p>\n\n<pre><code>[NEW] Desktop: add events for window resize, focus and unfocus\n</code></pre>\n\n<p>But I don't find the reference about its usage.</p>\n\n<p>Somebody help me?\nThank you for your time.</p>\n"}, {"tags": ["c++", "c++11", "bit-manipulation", "c++14"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1506520725, "post_id": 46449595, "comment_id": 79855369, "body": "The last bullet implies that you can return false OR return an attribute by reference. Let&#39;s get a little more concrete and say it should return an <code>optional</code>"}, {"owner": {"reputation": 2602, "user_id": 4341534, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001c92ef74cb305ff8318eebeaa04ab3?s=128&d=identicon&r=PG&f=1", "display_name": "patatahooligan", "link": "https://stackoverflow.com/users/4341534/patatahooligan"}, "edited": false, "score": 0, "creation_date": 1506520885, "post_id": 46449595, "comment_id": 79855476, "body": "You say you need to track the existence of an attribute, but you want to return a reference to it if it exists. A data structure that only holds the existence of the attributes is therefore insufficient. Why do you need to track if the attribute is in the XML when you can make query the object for that information?"}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1506520935, "post_id": 46449595, "comment_id": 79855502, "body": "@andyg updated the statement accordingly."}, {"owner": {"reputation": 2602, "user_id": 4341534, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001c92ef74cb305ff8318eebeaa04ab3?s=128&d=identicon&r=PG&f=1", "display_name": "patatahooligan", "link": "https://stackoverflow.com/users/4341534/patatahooligan"}, "edited": false, "score": 1, "creation_date": 1506521010, "post_id": 46449595, "comment_id": 79855547, "body": "Regarding your edit: is anyone forcing this interface on you? It is a way inferior way to <code>optional</code>. If you have the choice, it is better to redesign the class interface."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506521149, "post_id": 46449595, "comment_id": 79855639, "body": "I need to check the presence of an attribute before I could use it. And obviously I don&#39;t want to keep the Xml parser for program lifetime. Any better design solution would be appreciated. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506523756, "post_id": 46450678, "comment_id": 79857556, "body": "The solution looks cool but unfortunately std::optional is c++17 utility and we are using c++11 at the moment and I am not seeing any  upgrade to c++17 very soon"}, {"owner": {"reputation": 2602, "user_id": 4341534, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001c92ef74cb305ff8318eebeaa04ab3?s=128&d=identicon&r=PG&f=1", "display_name": "patatahooligan", "link": "https://stackoverflow.com/users/4341534/patatahooligan"}, "reply_to_user": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506523857, "post_id": 46450678, "comment_id": 79857626, "body": "Then change the first line to <code>using boost::optional</code>. If that is also not an option, write your own optional class that implements the same interface."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506523949, "post_id": 46450678, "comment_id": 79857682, "body": "how does changing the first line would work? Could you please explain? Is std optional available in c++11 as well?"}, {"owner": {"reputation": 2602, "user_id": 4341534, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001c92ef74cb305ff8318eebeaa04ab3?s=128&d=identicon&r=PG&f=1", "display_name": "patatahooligan", "link": "https://stackoverflow.com/users/4341534/patatahooligan"}, "reply_to_user": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506524232, "post_id": 46450678, "comment_id": 79857865, "body": "My bad, I assumed you&#39;d be familiar with the boost library. In short it is an extensive experimental C++ library. Most standard C++ features have been first implemented and tried out in boost; <code>optional</code> is no exception. Download boost and include the appropriate header file to use <code>boost::optional</code> in older C++ versions."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506524558, "post_id": 46450678, "comment_id": 79858092, "body": "Thanks. Any specific reason u find this solution better than what I have proposed? Bit manipulation will always be faster and efficient though we are giving some space for manual mistakes while writing setters and getters."}, {"owner": {"reputation": 2602, "user_id": 4341534, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001c92ef74cb305ff8318eebeaa04ab3?s=128&d=identicon&r=PG&f=1", "display_name": "patatahooligan", "link": "https://stackoverflow.com/users/4341534/patatahooligan"}, "reply_to_user": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "edited": false, "score": 0, "creation_date": 1506525197, "post_id": 46450678, "comment_id": 79858529, "body": "Bits will be more space-efficient but they will be slower on every platform that I&#39;m aware of. The processor does not work with bits. Forcing it to do so will actually incur extra costs of bit-masking for every read/write operation. You should trust the compiler to choose the appropriate size rather than force it to use bits, unless you have severe memory restrictions and at least tens of millions of <code>bool</code>s."}], "tags": [], "owner": {"reputation": 2602, "user_id": 4341534, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001c92ef74cb305ff8318eebeaa04ab3?s=128&d=identicon&r=PG&f=1", "display_name": "patatahooligan", "link": "https://stackoverflow.com/users/4341534/patatahooligan"}, "is_accepted": true, "score": 1, "last_activity_date": 1506523012, "creation_date": 1506523012, "answer_id": 46450678, "question_id": 46449595, "link": "https://stackoverflow.com/questions/46449595/attribute-presence-generic-check/46450678#46450678", "title": "Attribute presence generic check", "body": "<p>From your comment I gather that you <em>can</em> change the design, so this is what I would do:</p>\n\n<p>Replace all optional members with the aptly-named <code>std::optional</code> or the boost equivalent if the former is not available.</p>\n\n<pre><code>using std::optional;    // facilitates easy switching between std and boost if needed\n\nclass MyClass {\n    optional&lt;int&gt; some_value;\n    // Similarly for rest of attributes\n\n    void set_some_value(int value_to_store) { some_value = value_to_store; }\n\n    optional&lt;int&gt; get_some_value() { return some_value; }\n}\n</code></pre>\n\n<p>To read from it do as follows</p>\n\n<pre><code>MyClass instance;\n// ... parse XML and set attributes\nauto some_value = instance.get_some_value;\nif (some_value) {\n    do_something_with_int(*some_value);\n}\n</code></pre>\n\n<p>Some notes on <code>optional</code>:</p>\n\n<ul>\n<li><p>Default-constructed <code>optional</code>s are empty. This means that every attribute you don't explicitly set is empty by default.</p></li>\n<li><p>Dereferencing an empty optional is undefined behavior. There are safer ways to access it. In this example it is safe because we manually checked for it since I assume you'd like to branch on the existence of your attribute anyway.</p></li>\n<li><p>The managed object is guaranteed to be inside the allocated <code>optional</code> object. This means no dynamic allocation which is great for speed. If you have any huge objects, however, this can cause stack overflow issues. It's not likely, though, as most real world scenarios of large objects are using a <code>string</code> or some STL container/wrapper that holds its data on the heap anyway.</p></li>\n<li><p>I couldn't find a mention of the space cost in the standard. I believe it is typically implemented with a single <code>bool</code> inside every optional object. <code>sizeof(bool)</code> is often <code>sizeof(int)</code>. This makes it more space consuming than necessary, but it's as fast as possible. This is generally a good trade-off, but if you encounter memory usage problems and you have a lot of objects holding <code>optional</code>s you might need to find a more space-optimal solution. If you can use sentinel values to signal non-existence, look up implementations of compact optional objects.</p></li>\n</ul>\n"}], "owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 46450678, "answer_count": 1, "score": 0, "last_activity_date": 1506523012, "creation_date": 1506520125, "last_edit_date": 1506520879, "question_id": 46449595, "link": "https://stackoverflow.com/questions/46449595/attribute-presence-generic-check", "title": "Attribute presence generic check", "body": "<p>My requirement is to parse on XML and populate an object. How do I automatically track if attribute xyz is present once the object is populated from the Xml. Please note that I will no longer have access to the parsed buffer after the object is populated. Hence I need some mechanism to know whether the attribute was present in XML and the same is populated in the object.</p>\n\n<p>I have the below solution in my mind but not sure if anything more efficient possible. Also I am looking for a generic solution for this problem.</p>\n\n<ul>\n<li><p>define a bit for each of the attribute in a class.</p></li>\n<li><p>setter function should set that bit while parsing XML when attribute is present</p></li>\n<li><p>getter function should check the bit before returning the attribute value by reference argument . It should return false when bit is not set. ( The getter function return type should be boolean and it accepts one argument which is of type attribute and populate it when present)</p></li>\n</ul>\n"}, {"tags": ["c++", "vector", "insert", "2d-vector"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506520256, "post_id": 46449434, "comment_id": 79854963, "body": "what is <code>k</code> ? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 5, "user_id": 5799152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iiGHY.jpg?s=128&g=1", "display_name": "Mary Dee", "link": "https://stackoverflow.com/users/5799152/mary-dee"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506520340, "post_id": 46449434, "comment_id": 79855032, "body": "added a coment for k"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1506520373, "post_id": 46449434, "comment_id": 79855059, "body": "cant you add a definition? comments can say anything and dont relate at all to the error message you get"}], "answers": [{"tags": [], "owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "is_accepted": true, "score": 1, "last_activity_date": 1506520151, "creation_date": 1506520151, "answer_id": 46449606, "question_id": 46449434, "link": "https://stackoverflow.com/questions/46449434/how-to-insert-a-vector-in-the-defined-place-of-2d-vector/46449606#46449606", "title": "How to insert a vector in the defined place of 2D vector?", "body": "<p>Use iterator:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;std::string&gt; &gt; vec;\nstd::vector&lt;std::string&gt; v;\nvec.insert(vec.begin(), v);\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>vec.insert(vec.begin() + 2, v);\n</code></pre>\n\n<p>to insert at position 2, but make sure there is index 2 - ie. resize your vector : <code>vec.resize(3);</code></p>\n\n<p>From your error I see k is of type int : <code>insert(int,</code>, and you need an iterator.</p>\n"}], "owner": {"reputation": 5, "user_id": 5799152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iiGHY.jpg?s=128&g=1", "display_name": "Mary Dee", "link": "https://stackoverflow.com/users/5799152/mary-dee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 46449606, "answer_count": 1, "score": 0, "last_activity_date": 1506520321, "creation_date": 1506519668, "last_edit_date": 1506520321, "question_id": 46449434, "link": "https://stackoverflow.com/questions/46449434/how-to-insert-a-vector-in-the-defined-place-of-2d-vector", "title": "How to insert a vector in the defined place of 2D vector?", "body": "<p>I have a simple and two-dimensional vectors of std::string.</p>\n\n<pre><code>std::vector&lt;std::vector&lt;std::string&gt; &gt; vec;\nstd::vector&lt;std::string&gt; v;\n</code></pre>\n\n<p>Now how to insert v in defined position of vec?</p>\n\n<p>I've tried to use <code>insert()</code> , but there was an error:</p>\n\n<pre><code> vec.insert(k,v); //k -is an position of vec for inserting\n\n\nno matching function for call to std::vector&lt;std::vector&lt;std::basic_string&lt;char&gt; &gt; &gt;::insert(int, std::vector&lt;std::basic_string&lt;char&gt; &gt;&amp;)\n</code></pre>\n"}, {"tags": ["c++", "reference", "copy-constructor", "lifetime"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1506519792, "post_id": 46449394, "comment_id": 79854594, "body": "Your static function returns a temporary object <i>by reference</i>. So it is destroyed before it is used."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506519809, "post_id": 46449394, "comment_id": 79854610, "body": "If gcc wont compile just stop and listen to its error messages.  MSVS has a <a href=\"https://stackoverflow.com/questions/16380966/non-const-reference-bound-to-temporary-visual-studio-bug\">&quot;feature&quot;</a> that allows this to compile."}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506520173, "post_id": 46449394, "comment_id": 79854906, "body": "@NathanOliver This is truly evil, I want this warning"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1506520508, "post_id": 46449394, "comment_id": 79855177, "body": "@Zebrafish: Use the <code>&#47;Za</code> flag. If you&#39;re in the IDE, go to the main menu <code>Project-&gt;Properties-&gt;C&#47;C++-&gt;Language-&gt;Disable Language Extensions-&gt;Yes</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1506520658, "post_id": 46449394, "comment_id": 79855315, "body": "For simple value-types like <code>Number</code>, in general you should pass them around by value, not by reference. (Note that the <b>copy constructor</b> must take its argument by reference; otherwise you get an infinite recursion)"}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1506520763, "post_id": 46449394, "comment_id": 79855392, "body": "@Benjamin Lindley Oh nothing will compile now, it&#39;s got stuff like illegal declaration of anonymous struct in wingdi.h, whatever that is."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506520877, "post_id": 46449394, "comment_id": 79855470, "body": "@Zebrafish Beware that disabling language extensions in MSVS will prevent platform specific headers such as <code>windows.h</code> from compiling. Disabling the language extensions is a great idea unless you are doing something Windows-specific."}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1506521223, "post_id": 46449394, "comment_id": 79855692, "body": "@Francois Andrieux No I&#39;m doing an OpenGL project, but all the other windows headers seem to be dependencies for some reason. The compiling errors are still applying to them."}], "answers": [{"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 0, "last_activity_date": 1506519924, "last_edit_date": 1506519924, "creation_date": 1506519831, "answer_id": 46449485, "question_id": 46449394, "link": "https://stackoverflow.com/questions/46449394/i-cant-understand-this-copy-constructor-behaviour/46449485#46449485", "title": "I can&#39;t understand this copy constructor behaviour", "body": "<p>The function <code>static Number&amp; getNumber() { return Number(555); }</code> creates a temporary <code>Number</code> and returns a reference to it. The temporary object ceases to exist at the end of the function, meaning the reference you are returning now refers to a destroyed object. This is undefined behavior, which means the behavior could be anything, including appearing to work sometimes. The compiler is not required to diagnose this error, but some (such as GCC) do. If you intend to return a mutable reference to a shared instance, declare a static local object in the body of the function and return a reference to it.</p>\n\n<pre><code>static Number&amp; getNumber() \n{ \n    static Number my_instance{555}; \n    return my_instance;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1506520387, "post_id": 46449643, "comment_id": 79855077, "body": "No I knew that num2 uses the assignment operator in that case. So, I knew the temporary local gets destroyed, but I thought that if it gets assigned directly on the same line it&#39;ll assign the correct value. I&#39;m wrong about this? In other words, the local is no good the very second it returns, whether it&#39;s assigned or not."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1506520689, "post_id": 46449643, "comment_id": 79855341, "body": "@Zebrafish Yes.  The function local argument gets destroyed as soon as you get the reference to assign to <code>num2</code> with.  Temporary values that are created in an expression last until the end of the full expression but that does not cover function local arguments.  Those are always destroyed when the function returns and before the execution proceeds."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 2, "last_activity_date": 1506520816, "last_edit_date": 1506520816, "creation_date": 1506520245, "answer_id": 46449643, "question_id": 46449394, "link": "https://stackoverflow.com/questions/46449394/i-cant-understand-this-copy-constructor-behaviour/46449643#46449643", "title": "I can&#39;t understand this copy constructor behaviour", "body": "<p><code>getNumber</code> has undefined behavior.  You are returning a reference to a local object.  When the function returns that object is destroyed so now you have a reference to a object that no longer exists.  To fix this we can just return by value like</p>\n\n<pre><code>static Number getNumber() { return {555}; }\n</code></pre>\n\n<p>And now you the number that is returned is directly constructed from the return value.</p>\n\n<p>All function local variables are destroyed after the return value is created but before execution proceeds.  That means returning any type of reference or pointer to a local object will leave you with a dangling reference/pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506555129, "post_id": 46451057, "comment_id": 79872822, "body": "You <b>cannot</b> return a function local variable by const ref"}, {"owner": {"reputation": 1341, "user_id": 138170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/99ddc9f7351f298e7dbcd897e9ac98b7?s=128&d=identicon&r=PG", "display_name": "Jack V.", "link": "https://stackoverflow.com/users/138170/jack-v"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506592650, "post_id": 46451057, "comment_id": 79887343, "body": "Thank you. Mea culpa. Do you know which bit of the standard to quote?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1506598504, "post_id": 46451057, "comment_id": 79891032, "body": "Not off hand, it is covered by the scoping and lifetime rules.  <a href=\"https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope\">Here</a> is a great post about it though."}], "tags": [], "owner": {"reputation": 1341, "user_id": 138170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/99ddc9f7351f298e7dbcd897e9ac98b7?s=128&d=identicon&r=PG", "display_name": "Jack V.", "link": "https://stackoverflow.com/users/138170/jack-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1506592423, "last_edit_date": 1506592423, "creation_date": 1506524024, "answer_id": 46451057, "question_id": 46449394, "link": "https://stackoverflow.com/questions/46449394/i-cant-understand-this-copy-constructor-behaviour/46451057#46451057", "title": "I can&#39;t understand this copy constructor behaviour", "body": "<p>I learned something trying to answer this.</p>\n\n<p>What are the possible ways you could return an object from your static function?</p>\n\n<p><strong>By value</strong></p>\n\n<p>This is usually the correct way. Often the compiler will use a Return-Value-Optimisation or otherwise avoid actually copying the object multiple times. If you're not sure this is probably what you want.</p>\n\n<p>If the default copy constructor isn't sufficient for you, make sure you define your own, remembering to define it to take a const ref argument. If you're using C++11, defining a separate move constructor may be useful.</p>\n\n<p><strong>By non-const reference</strong></p>\n\n<p>This is incorrect because it's a reference (effectively a pointer) to a memory location that used to contain a variable which doesn't exist any more.</p>\n\n<p>It's an error in gcc. It used to be allowed in Visual Studio although I hear it may not be any more. You can compile with compiler option /Za to turn off various microsoft specific extensions if you want to.</p>\n\n<p><strong>By const reference</strong></p>\n\n<p>This is not an error, but is a warning and is undefined behaviour [citation needed]</p>\n\n<p>You <em>can</em> bind a const ref to a temporary object. See Herb Sutter's article: <a href=\"https://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/\" rel=\"nofollow noreferrer\">https://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/</a></p>\n\n<p>e.g. \"const Number&amp; num = get_number_by_value()\" will often return a copy of a temporary object, and elide the copy, and then the temporary object will be bound to the reference and have its lifetime extended in way that works specifically for const ref (but not other ref, or pointers).</p>\n\n<p><strike>However, I just learned now looking it up, that this technically applies to returning a temporary from a function, but that lifetime is not further lengthened if that is then assigned to another const ref.</p>\n\n<p>So your case</p>\n\n<pre><code>Number num = get_number_by_const_ref()\n</code></pre>\n\n<p>may work ok but</p>\n\n<pre><code>const Number&amp; num = get_number_by_const_ref()\n</code></pre>\n\n<p>may not.</strike></p>\n\n<p><strong>Return a const reference to a static member variable</strong></p>\n\n<p>This is not usually helpful, but if your class is very expensive to construct (requires a lot of calculation or uses GB of memory) and you want to return a particular instance of it multiple times, you might have a private const static member variable of the class which stores an instance you can return by ref.</p>\n\n<p>Remember, if you have a static member variable containing an instance variable of the class, it needs to be initialised <em>outside</em> the class in a .c file so the constructor function is available.</p>\n"}], "owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1506592423, "creation_date": 1506519530, "question_id": 46449394, "link": "https://stackoverflow.com/questions/46449394/i-cant-understand-this-copy-constructor-behaviour", "title": "I can&#39;t understand this copy constructor behaviour", "body": "<p>I'm having some weird behaviour with the following:</p>\n\n<pre><code>using namespace std;\nstruct Number\n{\n    Number(int init) : a(init) {}\n    Number() {};\n    int a;\n    static Number&amp; getNumber() { return Number(555); }\n\n    //Number(const Number&amp; other)\n    //{\n    //  a = other.a;\n    //}  // I've commented this out you'll see why\n};\n\nint main()\n{\n    Number num1;  // Is now junk\n    Number num2;  // Is now junk\n    num2 = Number::getNumber(); // num 2 is still junk\n\n    Number num3 = Number::getNumber(); // num3 has been assigned 555. \n                                       // If I define my own copy constructor\n                                       // (uncomment it), it stays junk.\n    cout &lt;&lt; num3.a;\n}\n</code></pre>\n\n<p>When I make my own copy constructor, whether it takes a const or not, the value coming in in the \"other\" argument is junk. I don't get this behaviour if the copy constructor is the default one. I tried it on IDEOne using GCC and this code doesn't compile. However on my Visual Studio it runs as I described.</p>\n\n<p>I find it really hard to understand the rules of how long a temporary is still valid. For example, I thought that if getNumber() returns a reference to a local temporary, it's OK if it's assigned directly on the same line. I was wrong. </p>\n"}, {"tags": ["c++", "macos-sierra", "auto-vectorization"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 2, "creation_date": 1506519740, "post_id": 46449353, "comment_id": 79854550, "body": "And does clang have a option &#39;-no-vec&#39;?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1506520077, "post_id": 46449353, "comment_id": 79854827, "body": "Why did you add the <code>-no-vec</code> and <code>-vec-report</code> argument and why do you think you need to use them ? Since clang does not understand these arguments, remove them."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1506526829, "post_id": 46449353, "comment_id": 79859644, "body": "clang is not g++, it doesn&#39;t have the same command line arguments"}, {"owner": {"reputation": 45, "user_id": 1903647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d676db3dc90b8f03f5d416ca8f35ea?s=128&d=identicon&r=PG&f=1", "display_name": "Chernabog", "link": "https://stackoverflow.com/users/1903647/chernabog"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1506585608, "post_id": 46449353, "comment_id": 79882506, "body": "@nos I\u2019m trying these options because I want to work with auto-vectorisation. I\u2019m following this guide: [link] (<a href=\"https://software.intel.com/sites/default/files/8c/a9/CompilerAutovectorizationGuide.pdf\" rel=\"nofollow noreferrer\">software.intel.com/sites/default/files/8c/a9/&hellip;</a>) and some examples from my teacher.   I added <code>-no-vec</code> to verify that the execution time is slower without auto-vectorisation. And I added <code>-vec-report</code> just to have a confirmation whether auto-vectorisation is happening or not.  I don\u2019t really need any of them, I just wanted to see them at work, because I\u2019m trying to learn, so I would like to understand what I&#39;m doing wrong."}, {"owner": {"reputation": 45, "user_id": 1903647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d676db3dc90b8f03f5d416ca8f35ea?s=128&d=identicon&r=PG&f=1", "display_name": "Chernabog", "link": "https://stackoverflow.com/users/1903647/chernabog"}, "edited": false, "score": 0, "creation_date": 1506585640, "post_id": 46449353, "comment_id": 79882523, "body": "@manni66, @Caleth  Sorry for my noobness but I\u2019m not sure what you mean. I\u2019m compiling like this: <code>g++ -std=c++11 -march=native -O3 -o prog code.cpp -g</code> and adding the mentioned options to this. I\u2019m doing so thinking I\u2019m passing options to <code>g++</code>, are you saying that I\u2019m actually passing options to <code>clang</code>? Why so and what can I do to achieve what I wanted?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1506586325, "post_id": 46449353, "comment_id": 79882972, "body": "macOS uses clang as compiler. g++ is only another name to make old build scripts happy. Try <code>g++ --version</code>"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1506587099, "post_id": 46449353, "comment_id": 79883512, "body": "@Pandi The documentation you found at <a href=\"https://software.intel.com/sites/default/files/8c/a9/CompilerAutovectorizationGuide.pdf\" rel=\"nofollow noreferrer\">software.intel.com/sites/default/files/8c/a9/&hellip;</a> is for ICC, the C++ compiler made by Intel, it is a different product/compiler than what you have, that documentation does not apply to the clang (the default compiler in OSX) nor the gcc compiler. perhaps you have better luck with this documentation: <a href=\"https://llvm.org/docs/Vectorizers.html\" rel=\"nofollow noreferrer\">llvm.org/docs/Vectorizers.html</a>"}, {"owner": {"reputation": 45, "user_id": 1903647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d676db3dc90b8f03f5d416ca8f35ea?s=128&d=identicon&r=PG&f=1", "display_name": "Chernabog", "link": "https://stackoverflow.com/users/1903647/chernabog"}, "edited": false, "score": 0, "creation_date": 1506594491, "post_id": 46449353, "comment_id": 79888515, "body": "Ok, I got it!! Thank you all :)"}], "owner": {"reputation": 45, "user_id": 1903647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d676db3dc90b8f03f5d416ca8f35ea?s=128&d=identicon&r=PG&f=1", "display_name": "Chernabog", "link": "https://stackoverflow.com/users/1903647/chernabog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506519433, "creation_date": 1506519433, "question_id": 46449353, "link": "https://stackoverflow.com/questions/46449353/clang-error-unknown-argument-no-vec", "title": "clang: error: unknown argument: &#39;-no-vec&#39;", "body": "<p>I'm trying to compile some things in c++ (on macOS 10.12.6) using different options and receive this kind of error with options like <code>-no-vec</code>, <code>-vec-report</code> but also more common things like <code>g++-6</code>.\nI'm not new to c++ but I used to code some years ago (on linux, never mac or any other thing), I'm currently using geany and just compiling it on the terminal. I tried to look for other questions on <code>clang</code> errors but they just don't seem to fit this, maybe I need some very elementary help to understand where I should look to fix this.</p>\n"}, {"tags": ["c++", "algorithm", "math", "g++", "implementation"], "comments": [{"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 1, "creation_date": 1506519488, "post_id": 46449311, "comment_id": 79854366, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11114548/storing-numbers-with-higher-precision-in-c\">Storing numbers with higher precision in C</a>"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 3, "creation_date": 1506519831, "post_id": 46449311, "comment_id": 79854624, "body": "&quot;Fibonnacci(A) exceeds long long int types&quot; -- irrelevant, you only need to compute it modulo B in the first place."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1506519889, "post_id": 46449311, "comment_id": 79854664, "body": "@harold +1: and then, it&#39;s a question for mathoverflow."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1506520109, "post_id": 46449311, "comment_id": 79854863, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41679802/huge-fibonacci-modulo-m-c\">Huge fibonacci modulo m C++</a> or you could choose some other algorithm"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1506520326, "post_id": 46449311, "comment_id": 79855017, "body": "Clear explanation (but no code): <a href=\"https://stackoverflow.com/questions/40556760/calculating-a-huge-fibonacci-number-modulo-m-in-python/40557219#40557219\" title=\"calculating a huge fibonacci number modulo m in python\">stackoverflow.com/questions/40556760/&hellip;</a>"}, {"owner": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1575666472, "post_id": 46449311, "comment_id": 104656022, "body": "@harold: if you have read my question you should have noticed that it&#39;s not possible to use modulos in intermediate calculs inside the the algorithm and the scholar fibonacci recursion algorithm is unusable to compute fib(10^18) in reasonable time."}, {"owner": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1575666617, "post_id": 46449311, "comment_id": 104656066, "body": "@YSC: the use of 64bits ints , 128bits ints 128bits float 80bits long double or 256 bits ints is not a question for mathoverflow."}], "answers": [{"comments": [{"owner": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "edited": false, "score": 0, "creation_date": 1506520945, "post_id": 46449749, "comment_id": 79855510, "body": "It&#39;s the same problem as with Fibonacci Fast Doubling algorithm I mention in my post. The problem is more on the types I can use to compute it. I have seen __float128 but I don&#39;t think I can implement all int variables with this float one."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1506522486, "post_id": 46449749, "comment_id": 79856602, "body": "The question mentions g++. Assuming x86_64, <code>__int128</code> would make multiplication easier. Or use a Boost.Multiprecision type."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1506529468, "post_id": 46449749, "comment_id": 79861312, "body": "Note: this is <i>essentially</i> the same algorithm as the fast doubling one provided in the question, with the same performance."}, {"owner": {"reputation": 8279, "user_id": 4759200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqFYM.jpg?s=128&g=1", "display_name": "DAle", "link": "https://stackoverflow.com/users/4759200/dale"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 1, "creation_date": 1506582009, "post_id": 46449749, "comment_id": 79880408, "body": "@JamesKPolk, that&#39;s right. The earlier version of the question did not contain any code or implementation details, and I proposed the matrix approach that seems to be more obvious to me personally."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 1, "creation_date": 1506606606, "post_id": 46449749, "comment_id": 79896821, "body": "<a href=\"https://math.stackexchange.com/a/2368738/552\">Here</a> is another interesting formulation."}], "tags": [], "owner": {"reputation": 8279, "user_id": 4759200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqFYM.jpg?s=128&g=1", "display_name": "DAle", "link": "https://stackoverflow.com/users/4759200/dale"}, "is_accepted": true, "score": 2, "last_activity_date": 1506608821, "last_edit_date": 1506608821, "creation_date": 1506520499, "answer_id": 46449749, "question_id": 46449311, "link": "https://stackoverflow.com/questions/46449311/how-can-i-calculate-fibonaccia-mod-b-with-a-b-1018-in-c-g/46449749#46449749", "title": "How can I calculate Fibonacci(A) mod B with A,B&lt;=10^18 in C++ (g++)", "body": "<p>You don't need any floating point type for the calculations. You can use <code>long long</code> type only. First, you need a function that multiplicates two <code>long long</code> numbers (that are less than <code>10^18</code>) modulo <code>B</code>. This can be done with the similar to <a href=\"https://en.wikipedia.org/wiki/Exponentiation_by_squaring\" rel=\"nofollow noreferrer\">exponentiation by squaring</a> method:</p>\n\n<pre><code>long long multiply(long long a, long long b, long long M) {\n    long long res = 0;\n    long long d = a;\n\n    while (b &gt; 0) {\n        if (b &amp; 1) {\n            res = (res + d) % M;\n        }\n        b /= 2;\n        d = (d + d) % M;\n    }\n    return res;\n}\n</code></pre>\n\n<p>Second, you need to add modulo operation to almost all of your arithmetic operations. And you definitely need to replace these loops <code>while(c&gt;=mod)c-=mod</code> (they could be very slow) with the addition of <code>% mod</code> to the corresponding operations. </p>\n\n<p>Your code with <code>__float_128</code> replaced with <code>long long</code> and with proper modular arithmetic: <a href=\"https://ideone.com/t6R7Tf\" rel=\"nofollow noreferrer\">https://ideone.com/t6R7Tf</a></p>\n\n<hr>\n\n<p>Another thing you can do is to use (as was mentioned in the comments) <code>Boost.Multiprecision</code> or non-standard <code>__int128</code> type (if supported) instead of <code>long long</code> type with complicated multiplication.</p>\n\n<hr>\n\n<p>Also, you could use a slightly different (but using the same math actually) approach that seems more obvious to me - the Fibonacci numbers matrix formula</p>\n\n<p><a href=\"https://i.stack.imgur.com/s3c3u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s3c3u.png\" alt=\"enter image description here\"></a> </p>\n\n<p>To calculate the <code>N</code>th power of matrix you can use exponentiation by squaring doing all operations modulo <code>B</code>. </p>\n"}], "owner": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "closed_date": 1506521546, "accepted_answer_id": 46449749, "answer_count": 1, "score": -4, "last_activity_date": 1575665911, "creation_date": 1506519273, "last_edit_date": 1575665911, "question_id": 46449311, "link": "https://stackoverflow.com/questions/46449311/how-can-i-calculate-fibonaccia-mod-b-with-a-b-1018-in-c-g", "closed_reason": "Not suitable for this site", "title": "How can I calculate Fibonacci(A) mod B with A,B&lt;=10^18 in C++ (g++)", "body": "<p>For example, A=10^17, B=10^17 (&lt;64bits) <br>\nTypically, in the algorithm above, the calculs to compute F(2n) and those to compute F(2n+1) exceeds long long int types and we can't use modular computation in it. <br>\nThe best algorithm to compute it I talk is fibonacci fast doubling:</p>\n\n<blockquote>\n  <p>F(0) = 0, F(1) = 1.<br>\n  F(2n) = F(n)(2*F(n+1) \u2013 F(n)).<br>\n  F(2n + 1) = F(n)<sup>2</sup> + F(n+1)<sup>2</sup>.</p>\n</blockquote>\n\n<p>Do you know some types in new C++14 (g++8.3.0 or llvm-clang C++) to use to avoid overflow. <br>\nI tried __float128 that is best than long double with no success. (see the g++ code above)<br>\nI have heard of the existence of __int128 and __int256 with no printf possibilities but I haven't try it.<br> \nAre they availailable in g++ 8.3.0 or are there other fast means to handle 128bits ints to do intermediate calculs you can think of? \n(time perfs are important) </p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\n__float128 a,b,c,d;\nlong long mod;\n\nvoid fast_fib(long long n,long long ans[]){\n    if(n == 0){\n        ans[0] = 0;\n        ans[1] = 1;\n        return;\n    }\n    fast_fib((n/2),ans);\n    a = ans[0];             /* F(n) */\n    b = ans[1];             /* F(n+1) */\n    c = 2*b - a;\n    if(c &lt; 0) c += mod;\n    c = (a * c);      /* F(2n) */\n    while(c&gt;=mod)c-=mod;\n    d = (a*a + b*b);  /* F(2n + 1) */\n    while(d&gt;=mod)d-=mod;\n    if(n%2 == 0){\n        ans[0] = c;\n        ans[1] = d;\n    }\n    else{\n        ans[0] = d;\n        ans[1] = c+d;\n    }\n}\n\nint main(){\n  int T=1000;\n  long long n;\n  while(T--){\n    scanf(\"%lld %lld\",&amp;n,&amp;mod);\n    long long ans[2]={0};\n    fast_fib(n,ans);\n    printf(\"%lld\\n\", ans[0]);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>with __float128 I can't implement the modulo efficiently and a,b,c,d must store 128 bits data.</p>\n"}, {"tags": ["c++", "linux", "boost", "tcp", "server"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1506520114, "post_id": 46449276, "comment_id": 79854866, "body": "When thing network-related don&#39;t work, I find it necessary to debug them with a tcpdump. At some point, you <i>need</i> to know what went through the pipe."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1506522341, "post_id": 46449276, "comment_id": 79856515, "body": "What do you think should happen with the connection after you write your message? You&#39;re not doing any subsequent read or write on the socket."}, {"owner": {"reputation": 448, "user_id": 6623954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2804751db270f6e9acaaa7800710864?s=128&d=identicon&r=PG&f=1", "display_name": "Hcetipe", "link": "https://stackoverflow.com/users/6623954/hcetipe"}, "edited": false, "score": 0, "creation_date": 1506523852, "post_id": 46449276, "comment_id": 79857622, "body": "I think the socket is close but I dont know why..."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1506525897, "post_id": 46449276, "comment_id": 79859003, "body": "@Hcetipe can you not debug and break on the destructor. Most likely you fail to hold a reference to the <code>Connection</code> shared_ptr during an asynchronous operation"}, {"owner": {"reputation": 448, "user_id": 6623954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2804751db270f6e9acaaa7800710864?s=128&d=identicon&r=PG&f=1", "display_name": "Hcetipe", "link": "https://stackoverflow.com/users/6623954/hcetipe"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1506526686, "post_id": 46449276, "comment_id": 79859544, "body": "I don&#39;t understand what do you mean @sehe"}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1506545222, "post_id": 46452319, "comment_id": 79869575, "body": "A version with a send loop as well as a request loop: <a href=\"http://coliru.stacked-crooked.com/a/95e2000e49b4db1d\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/95e2000e49b4db1d</a>. Clients get disconnected if a request isn&#39;t received within timeout (2s)"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1506538253, "last_edit_date": 1506538253, "creation_date": 1506527839, "answer_id": 46452319, "question_id": 46449276, "link": "https://stackoverflow.com/questions/46449276/connection-lost-just-after-connection-server-tcp-boost-asio/46452319#46452319", "title": "Connection lost just after connection -&gt; Server TCP boost.ASIO", "body": "<p>Crux: Shared pointers employ keep the object alive until the reference count reaches zero.</p>\n\n<p>You write the message to the client here. When it's complete, you will execute <code>callback_send</code>:</p>\n\n<pre><code>boost::asio::async_write(socket, boost::asio::buffer(message),\n                         boost::bind(&amp;Connection::callback_send, shared_from_this()));\n</code></pre>\n\n<p>So what do we do next?</p>\n\n<pre><code>void Connection::callback_send() {}\n</code></pre>\n\n<p>Oh. That's... not a lot. So. Nothing? </p>\n\n<p><em>Well. Almost nothing</em>.</p>\n\n<p>It's a case of \"not doing something is also doing something\". By <strong>not</strong> posting another operation that keeps the socket/connection alive, this means that the connection is going to be released.</p>\n\n<p>Because nothing else keeps the shared_ptr to the connection, shared_ptr will delete the connection (invoking the destructor, which you could see because it prints <code>destructeur Connection</code> every time).</p>\n\n<p>So. What is the solution? <strong>We Don't Know</strong>. It's up to you what you want to do after you said \"welcome\". In most likely-hood you will want to wait for some kind of message from the client. This would involve some <code>async_read*</code> call which happily keeps the connection alive (<code>shared_from_this()</code> again).</p>\n\n<h2>Demo</h2>\n\n<p>Let's assume you want to keep receiving lines, and you send the same lines back, reversed:</p>\n\n<pre><code>void Connection::callback_send() {\n    boost::asio::async_read_until(socket, request, \"\\n\",\n                             boost::bind(&amp;Connection::on_request_received, shared_from_this(),\n                                 boost::asio::placeholders::error,\n                                 boost::asio::placeholders::bytes_transferred));\n}\n\nvoid Connection::on_request_received(boost::system::error_code ec, size_t n) {\n    if (ec &amp;&amp; !((ec == boost::asio::error::eof) &amp;&amp; n))\n        std::cout &lt;&lt; \"Receive error: \" &lt;&lt; ec.message() &lt;&lt; \"\\n\";\n    else\n    {\n        std::cout &lt;&lt; \"Received request\\n\";\n\n        {\n            std::istream is(&amp;request);\n            std::getline(is, message);\n        }\n\n        std::reverse(message.begin(), message.end());\n\n        std::cout &lt;&lt; \"Sending response: \" &lt;&lt; message &lt;&lt; \"\\n\";\n\n        message += '\\n';\n\n        if (!ec) boost::asio::async_write(socket, boost::asio::buffer(message),\n               boost::bind(&amp;Connection::callback_send, shared_from_this()));\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 448, "user_id": 6623954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2804751db270f6e9acaaa7800710864?s=128&d=identicon&r=PG&f=1", "display_name": "Hcetipe", "link": "https://stackoverflow.com/users/6623954/hcetipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 46452319, "answer_count": 1, "score": 1, "last_activity_date": 1506538253, "creation_date": 1506519165, "last_edit_date": 1506520155, "question_id": 46449276, "link": "https://stackoverflow.com/questions/46449276/connection-lost-just-after-connection-server-tcp-boost-asio", "title": "Connection lost just after connection -&gt; Server TCP boost.ASIO", "body": "<p>I did the boost tutorial : An asynchronous TCP daytime server <a href=\"http://think-async.com/Asio/asio-1.1.1/doc/asio/tutorial/tutdaytime3.html\" rel=\"nofollow noreferrer\">http://think-async.com/Asio/asio-1.1.1/doc/asio/tutorial/tutdaytime3.html</a> \nWhen I want to test it, the server is running so that's good but if I do <code>nc -C localhost 4242</code> the client got the message of the server but the client is directly disconnected after.</p>\n\n<p>Here my code :</p>\n\n<pre><code>#include \"server.h\"\n#include \"connection.h\"\n\nServer::Server(boost::asio::io_service&amp; io_service) : accept(io_service, boost::asio::ip::tcp::endpoint(boost::asio::ip::tcp::v4(), 4242))\n{\n  wait_connection();\n}\n\nServer::~Server()\n{\n\n}\n\nvoid Server::wait_connection()\n{\n  std::cout &lt;&lt; \"wait_connection\" &lt;&lt; std::endl;\n  boost::shared_ptr&lt;Connection&gt; new_connection =\n  Connection::start_connection(accept.get_io_service());\n\n  accept.async_accept(new_connection-&gt;getSocket(), boost::bind(&amp;Server::callback_accept, this, new_connection, boost::asio::placeholders::error));\n}\n\nvoid Server::callback_accept(boost::shared_ptr&lt;Connection&gt; new_connection, const boost::system::error_code &amp;error)\n{\n  if (!error)\n  {\n    new_connection-&gt;send_message_to_client();\n    wait_connection();\n  }\n}\n\n\nConnection::Connection(boost::asio::io_service&amp; io_service) : socket(io_service)\n{\n\n}\n\nConnection::~Connection()\n{\n  std::cout &lt;&lt; \"destructeur Connection\" &lt;&lt; std::endl;\n}\n\nboost::shared_ptr&lt;Connection&gt; Connection::start_connection(boost::asio::io_service&amp; io_service)\n{\n  return (boost::shared_ptr&lt;Connection&gt;(new Connection(io_service)));\n}\n\nboost::asio::ip::tcp::socket&amp; Connection::getSocket()\n{\n  return (this-&gt;socket);\n}\n\nvoid Connection::send_message_to_client()\n{\n  message = \"Bienvenue!\\n\";\n\n  boost::asio::async_write(socket, boost::asio::buffer(message), boost::bind(&amp;Connection::callback_send, shared_from_this()));\n}\n\nvoid Connection::callback_send()\n{\n\n}\n\nint main()\n{\n  try {\n\n    boost::asio::io_service io_service;\n    Server server(io_service);\n    io_service.run();\n  }\n  catch (std::exception&amp; e) {\n    std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n  }\n\n  return (0);\n}\n</code></pre>\n\n<hr>\n\n<pre><code>#ifndef SERVER_H\n#define SERVER_H\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/bind.hpp&gt;\n#include &lt;boost/shared_ptr.hpp&gt;\n#include &lt;boost/enable_shared_from_this.hpp&gt;\n#include &lt;boost/asio.hpp&gt;\n#include \"connection.h\"\n\nclass Server {\nprivate:\n  boost::asio::ip::tcp::acceptor accept;\n\npublic:\n  Server (boost::asio::io_service&amp;);\n ~Server ();\n\n  void wait_connection();\n  void callback_accept(boost::shared_ptr&lt;Connection&gt; new_connection, const boost::system::error_code&amp; error);\n\n};\n\n#endif /* end of include guard: SERVER_H */\n\n\n#ifndef CONNECTION_H\n#define CONNECTION_H\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/bind.hpp&gt;\n#include &lt;boost/shared_ptr.hpp&gt;\n#include &lt;boost/enable_shared_from_this.hpp&gt;\n#include &lt;boost/asio.hpp&gt;\n\nclass Connection : public boost::enable_shared_from_this&lt;Connection&gt;\n{\nprivate:\n  boost::asio::ip::tcp::socket socket;\n  std::string message;\npublic:\n  Connection (boost::asio::io_service&amp;);\n  ~Connection ();\n\n  static boost::shared_ptr&lt;Connection&gt; start_connection(boost::asio::io_service&amp;);\n  boost::asio::ip::tcp::socket&amp; getSocket();\n  void send_message_to_client();\n  void callback_send();\n};\n\n#endif /* end of include guard: CONNECTION_H */\n</code></pre>\n"}, {"tags": ["c++", "polymorphism"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1506519030, "post_id": 46449141, "comment_id": 79854017, "body": "That kind of what &quot;hiding&quot; <i>means</i>. Also, another way around the hiding is with the <code>using</code> keyword, like e.g. <code>using A::foo;</code> inside the <code>B</code> class definition."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1506519039, "creation_date": 1506519039, "answer_id": 46449225, "question_id": 46449141, "link": "https://stackoverflow.com/questions/46449141/why-overridden-method-hides-all-methods-with-same-name-regardless-of-its-argumen/46449225#46449225", "title": "Why overridden method hides all methods with same name regardless of its arguments", "body": "<p>The short answer is 'because that's what the rules say'.</p>\n\n<p>You can achieve what you want like this:</p>\n\n<pre><code>struct A{\n        void foo(A a){}\n        virtual void foo(int c=1){}\n};\nstruct B : public A{\n        using A::foo;\n        void foo(int c){}\n};\n\nint main(){\n        A* object = new B();\n        object-&gt;foo();\n        ((B*)(object))-&gt;foo(*object);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 367, "user_id": 1079475, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1419ed4575a5b8c082bd4726cd4bd0?s=128&d=identicon&r=PG", "display_name": "user1079475", "link": "https://stackoverflow.com/users/1079475/user1079475"}, "edited": false, "score": 0, "creation_date": 1506519594, "post_id": 46449232, "comment_id": 79854447, "body": "I&#39;m still not convinced why it shouldn&#39;t nest the lookup down the chain. By which i mean why someone decided that this is how it should stay. What pitfalls made it to live it up to current standard"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 367, "user_id": 1079475, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1419ed4575a5b8c082bd4726cd4bd0?s=128&d=identicon&r=PG", "display_name": "user1079475", "link": "https://stackoverflow.com/users/1079475/user1079475"}, "edited": false, "score": 0, "creation_date": 1506519842, "post_id": 46449232, "comment_id": 79854630, "body": "@user1079475 Suppose you call the member function <code>foo</code> in another member function of <code>B</code>, like <code>foo(0);</code>, and sb defined a global <code>foo(int)</code> too. Now you have to tell the compiler which one you want invoke; the one of <code>B</code>, or <code>A</code>, or the global one."}, {"owner": {"reputation": 367, "user_id": 1079475, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1419ed4575a5b8c082bd4726cd4bd0?s=128&d=identicon&r=PG", "display_name": "user1079475", "link": "https://stackoverflow.com/users/1079475/user1079475"}, "edited": false, "score": 0, "creation_date": 1506521435, "post_id": 46449232, "comment_id": 79855871, "body": "I don&#39;t think that is a part of the issue because it just goes with B::foo(int)"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 367, "user_id": 1079475, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1419ed4575a5b8c082bd4726cd4bd0?s=128&d=identicon&r=PG", "display_name": "user1079475", "link": "https://stackoverflow.com/users/1079475/user1079475"}, "edited": false, "score": 0, "creation_date": 1506521966, "post_id": 46449232, "comment_id": 79856262, "body": "@user1079475 Suppose you have a member function <code>foo(int)</code> and calling it as <code>foo(&#39;c&#39;);</code> in another member function. You&#39;re passing a <code>char</code> to it but you&#39;re sure and this is your intent, <code>char</code> will be converted to <code>int</code>. Then sb add a globle <code>foo(char)</code>; you won&#39;t get any compile error or warning but you&#39;ll find the behavior changed. A kind of <i>surprise</i>. Anyway, it&#39;s just a sort of tradeoff of design."}, {"owner": {"reputation": 367, "user_id": 1079475, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1419ed4575a5b8c082bd4726cd4bd0?s=128&d=identicon&r=PG", "display_name": "user1079475", "link": "https://stackoverflow.com/users/1079475/user1079475"}, "edited": false, "score": 0, "creation_date": 1506525744, "post_id": 46449232, "comment_id": 79858897, "body": "Yes i&#39;m familiar with this ambiguity and i know that it is still there for example in try catch sections. This is the one of the reasons i don&#39;t understand why it does not work the same in this case since we are already dealing with such problems in c++"}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": false, "score": 3, "last_activity_date": 1506519568, "last_edit_date": 1506519568, "creation_date": 1506519051, "answer_id": 46449232, "question_id": 46449141, "link": "https://stackoverflow.com/questions/46449141/why-overridden-method-hides-all-methods-with-same-name-regardless-of-its-argumen/46449232#46449232", "title": "Why overridden method hides all methods with same name regardless of its arguments", "body": "<blockquote>\n  <p>i would like to hear the story behind why it is behaving like that.</p>\n</blockquote>\n\n<p>Because this is the rule of <a href=\"https://en.cppreference.com/w/cpp/language/unqualified_lookup\" rel=\"nofollow noreferrer\">name lookup</a>. If the name is found at the current scope (e.g. the class <code>B</code>), the name lookup stops, the further outer scope (e.g. the class <code>A</code>) won't be examined. The process of name lookup would not consider the parameters of the functioin, but only the names. </p>\n\n<p>After the name lookup overload resolution is performed based on the names found, then you got the error showed.</p>\n"}], "owner": {"reputation": 367, "user_id": 1079475, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1419ed4575a5b8c082bd4726cd4bd0?s=128&d=identicon&r=PG", "display_name": "user1079475", "link": "https://stackoverflow.com/users/1079475/user1079475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1506519149, "answer_count": 2, "score": 2, "last_activity_date": 1506519568, "creation_date": 1506518840, "question_id": 46449141, "link": "https://stackoverflow.com/questions/46449141/why-overridden-method-hides-all-methods-with-same-name-regardless-of-its-argumen", "closed_reason": "Duplicate", "title": "Why overridden method hides all methods with same name regardless of its arguments", "body": "<pre><code>struct A{\n        void foo(A a){}\n        virtual void foo(int c=1){}\n};\nstruct B : public A{\n        void foo(int c){}\n};\n\nint main(){\n        A* object = new B();\n        object-&gt;foo();\n        ((B*)(object))-&gt;foo(*object);\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>test_test.cpp: In function \u2018int main()\u2019:\ntest_test.cpp:14:36: error: no matching function for call to \u2018B::foo(A&amp;)\u2019\n         ((B*)(object))-&gt;foo(*object);\n                                    ^\ntest_test.cpp:8:14: note: candidate: virtual void B::foo(int)\n         void foo(int c){}\n              ^\ntest_test.cpp:8:14: note:   no known conversion for argument 1 from \u2018A\u2019 to \u2018int\u2019\n</code></pre>\n\n<p>Though i'm able to still use <strong>A::foo</strong> via <code>((B*)object)-&gt;A::foo(*object)</code> i would like to hear the story behind why it is behaving like that.</p>\n"}, {"tags": ["c++", "tensorflow", "deep-learning"], "answers": [{"tags": [], "owner": {"reputation": 1028, "user_id": 2130551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd2a2785ef046e43eb2cd31707b92a4?s=128&d=identicon&r=PG&f=1", "display_name": "suharshs", "link": "https://stackoverflow.com/users/2130551/suharshs"}, "is_accepted": true, "score": 0, "last_activity_date": 1508276253, "creation_date": 1508276253, "answer_id": 46799625, "question_id": 46449022, "link": "https://stackoverflow.com/questions/46449022/tensorflow-output-shape-with-shape-function/46799625#46799625", "title": "TensorFlow output shape with Shape Function", "body": "<p>The <code>InferenceContext</code> allows getting attributes via the <code>GetAttr</code> method. So you can get <code>output_dim</code> like this:</p>\n\n<pre><code>int output_dim;\nc-&gt;GetAttr(\"output_dim\", &amp;output_dim);\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 2106, "user_id": 588959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a95696a0bc1b7e3c9e7c0fc6778dcaf?s=128&d=identicon&r=PG", "display_name": "Jack H", "link": "https://stackoverflow.com/users/588959/jack-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 46799625, "answer_count": 1, "score": 0, "last_activity_date": 1508276253, "creation_date": 1506518556, "question_id": 46449022, "link": "https://stackoverflow.com/questions/46449022/tensorflow-output-shape-with-shape-function", "title": "TensorFlow output shape with Shape Function", "body": "<p>I am writing a custom TensorFlow Op in C++ and CUDA as per the <a href=\"https://www.tensorflow.org/extend/adding_an_op\" rel=\"nofollow noreferrer\">guide</a> and am confused about the setting of the ops output shape. I wish to be able to provide the desired output dimensions as an attribute and use this attribute to set the shape with <code>SetShapeFn</code></p>\n\n<p>My op code is very much a straight adaptation of the example linked above, however, I am not sure how to use the provided attribute in this way.</p>\n\n<pre><code>REGISTER_OP(\"GaussianProcess\")\n.Attr(\"output_dim: int\") //This is the desired output dimension.\n.Input(\"data_points: float32\")\n.Input(\"query_point: float32\")\n.Input(\"alpha: float32\")\n.Input(\"hyp: float32\")\n.Output(\"shape_descriptor: float32\")\n.SetShapeFn([](::tensorflow::shape_inference::InferenceContext* c) {\n      /*\n       Use attribute 'output_dim' here.\n      */\n});\n</code></pre>\n\n<p>For the above Op registration, how would one access the <code>output_dim</code> attribute in the lambda passed to <code>SetShapeFn</code>?</p>\n\n<p>I need to be able to pass it to a call like so:</p>\n\n<pre><code>c-&gt;set_output(0, output_dim);\n</code></pre>\n"}]