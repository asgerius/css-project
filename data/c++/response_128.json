[{"tags": ["c++", "vector", "arduino", "esp8266", "arduino-esp8266"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1498090218, "post_id": 44688010, "comment_id": 76360132, "body": "all of this seems to happen in some private implementation of the package, except a few standard calls like &#39;memmove&#39; . you need to look at the line numbers provided in the stack dump. Or at least provide them."}, {"owner": {"reputation": 2409, "user_id": 1252334, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/6VDvz.jpg?s=128&g=1", "display_name": "Defozo", "link": "https://stackoverflow.com/users/1252334/defozo"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1498091081, "post_id": 44688010, "comment_id": 76360335, "body": "I added them to the question."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1498093480, "post_id": 44688010, "comment_id": 76360828, "body": "difficult to say without real playing with the program.  I have 3 possibilities in mind (1) On the top it looks like some kind of initialization order, i.e. it does clean() before constructing your vectors. Why does it &#39;clear&#39; at all? (2) Another possibility is a memory corruption. I do not like the 1151 line. It looks like the malloc list is corrupted. (3) there is an extra &#39;free&#39; for already freed memory which could probably also explain 1151."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1498166436, "post_id": 44688010, "comment_id": 76401996, "body": "This looks like a heap corruption error.  It could come from a write to this, or another array being out of bounds."}, {"owner": {"reputation": 2409, "user_id": 1252334, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/6VDvz.jpg?s=128&g=1", "display_name": "Defozo", "link": "https://stackoverflow.com/users/1252334/defozo"}, "edited": false, "score": 0, "creation_date": 1498227781, "post_id": 44688010, "comment_id": 76429878, "body": "Is it possible to write something out of bounds of vector using only <code>push_back</code> method?"}, {"owner": {"reputation": 161, "user_id": 3141797, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8520ccf2e25cfdb31fff058b4c8a6a60?s=128&d=identicon&r=PG&f=1", "display_name": "kubaork", "link": "https://stackoverflow.com/users/3141797/kubaork"}, "edited": false, "score": 0, "creation_date": 1505320045, "post_id": 44688010, "comment_id": 79367996, "body": "@Defozo have you managed to solve this problem?"}, {"owner": {"reputation": 2409, "user_id": 1252334, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/6VDvz.jpg?s=128&g=1", "display_name": "Defozo", "link": "https://stackoverflow.com/users/1252334/defozo"}, "edited": false, "score": 0, "creation_date": 1505329454, "post_id": 44688010, "comment_id": 79373354, "body": "Initially, I simply got rid of the vectors by replacing them with arrays. However, later on, I noticed that I might or might not exceed limit of PWM value in <code>analogWrite()</code> function. So, maybe that was the problem? Never checked again with vectors."}], "owner": {"reputation": 2409, "user_id": 1252334, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/6VDvz.jpg?s=128&g=1", "display_name": "Defozo", "link": "https://stackoverflow.com/users/1252334/defozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498130272, "creation_date": 1498089559, "last_edit_date": 1498130272, "question_id": 44688010, "link": "https://stackoverflow.com/questions/44688010/exception-3-thrown-during-clear-or-when-destroying-vectors", "title": "Exception 3 thrown during clear() or when destroying vectors", "body": "<h3>Description</h3>\n\n<p>Sometimes I get exception 3 when trying to clear() a std::vector.</p>\n\n<h3>Hardware</h3>\n\n<ul>\n<li>Hardware: ESP-07S</li>\n<li>ESP8266-Arduino library core version: 2.4.0-rc1</li>\n</ul>\n\n<h3>Settings in IDE</h3>\n\n<ul>\n<li>Module: Generic ESP8266 Module</li>\n<li>Flash Size: 4MB</li>\n<li>CPU Frequency:   160Mhz</li>\n<li>Flash Mode:  qio</li>\n<li>Flash Frequency: 40Mhz</li>\n<li>Upload Using:    OTA / SERIAL</li>\n<li>Reset Method:    ck</li>\n</ul>\n\n<h3>Stacktrace</h3>\n\n<p>This is stacktrace from Arduino's Exception Decoder:</p>\n\n<pre><code>Exception 3: LoadStoreError: Processor internal physical address or data error during load or store\nDecoding 30 results\n0x401000b7: umm_disconnect_from_free_list at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266\\umm_malloc/umm_malloc.c line 1151\n0x4021e9bc: memmove at /Users/igrokhotkov/e/newlib-xtensa/xtensa-lx106-elf/newlib/libc/string/../../../.././newlib/libc/string/memmove.c line 69 (discriminator 1)\n0x40217464: Print::write(unsigned char const*, unsigned int) at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266/Print.cpp line 38\n0x4010020c: _umm_free at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266\\umm_malloc/umm_malloc.c line 1287\n0x4010068c: free at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266\\umm_malloc/umm_malloc.c line 1733\n0x40215b04: operator delete(void*) at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266/abi.cpp line 57\n0x40207940: std::_Vector_base   &gt;::_M_deallocate(double*, unsigned int) at C:\\Users\\Defozo\\Documents\\Arduino\\jeszcze nowsza wersja laser_na_stacje_v2\\laser_na_stacje_v2/laser_na_stacje_v2.ino line 565\n0x402088ac: std::_Vector_base   &gt;::~_Vector_base() at c:\\users\\defozo\\appdata\\local\\arduino15\\packages\\esp8266\\tools\\xtensa-lx106-elf-gcc\\1.20.0-26-gb404fb9-2\\xtensa-lx106-elf\\include\\c++\\4.8.2\\bits/stl_vector.h line 161\n0x40209748: std::vector   &gt;::_M_erase_at_end(double*) at c:\\users\\defozo\\appdata\\local\\arduino15\\packages\\esp8266\\tools\\xtensa-lx106-elf-gcc\\1.20.0-26-gb404fb9-2\\xtensa-lx106-elf\\include\\c++\\4.8.2\\bits/stl_vector.h line 1353\n:  (inlined by) std::vector   &gt;::clear() at c:\\users\\defozo\\appdata\\local\\arduino15\\packages\\esp8266\\tools\\xtensa-lx106-elf-gcc\\1.20.0-26-gb404fb9-2\\xtensa-lx106-elf\\include\\c++\\4.8.2\\bits/stl_vector.h line 1126\n:  (inlined by) loop at C:\\Users\\Defozo\\Documents\\Arduino\\jeszcze nowsza wersja laser_na_stacje_v2\\laser_na_stacje_v2/laser_na_stacje_v2.ino line 412\n0x40217082: std::default_delete ::operator()(TransportTraits*) const at c:\\users\\defozo\\appdata\\local\\arduino15\\packages\\esp8266\\tools\\xtensa-lx106-elf-gcc\\1.20.0-26-gb404fb9-2\\xtensa-lx106-elf\\include\\c++\\4.8.2\\bits/unique_ptr.h line 68\n0x4010020c: _umm_free at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266\\umm_malloc/umm_malloc.c line 1287\n0x401020ea: wDev_ProcessFiq at ?? line ?\n0x40215d84: loop_wrapper at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266/core_esp8266_main.cpp line 124\n0x4010070c: cont_norm at C:\\Users\\Defozo\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.4.0-rc1\\cores\\esp8266/cont.S line 109\n</code></pre>\n\n<p>This is reset cause:</p>\n\n<pre><code>Hardware Watchdog\nFatal exception:4 flag:1 (WDT) epc1:0x40000f83 epc2:0x00000000 epc3:0x4000dd3b excvaddr:0x40023c5c depc:0x00000000\n</code></pre>\n\n<h3>Code</h3>\n\n<p>I'm initializing vectors like that:</p>\n\n<pre><code>std::vector&lt;double&gt; dhtTempVector, dhtHumidityVector;\nstd::vector&lt;double&gt; dhtTempMedianVector, dhtHumidityMedianVector;\nstd::vector&lt;double&gt; bmpTempVector, bmpPressureVector;\nstd::vector&lt;double&gt; bmpTempMedianVector, bmpPressureMedianVector;\ndhtTempVector.reserve(5);\ndhtHumidityVector.reserve(5);\nbmpTempVector.reserve(5);\nbmpPressureVector.reserve(5);\ndhtTempMedianVector.reserve(6);\ndhtHumidityMedianVector.reserve(6);\nbmpPressureMedianVector.reserve(6);\nbmpTempMedianVector.reserve(6);\n</code></pre>\n\n<p>Inserting new values like that:</p>\n\n<pre><code>if (!isnan(temp) &amp;&amp; !isnan(hum)) {\n    dhtTempVector.push_back(temp);\n    dhtHumidityVector.push_back(hum);\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>if (!dhtTempVector.empty()) {\n    dhtTempMedianVector.push_back(median(dhtTempVector));\n    dhtTempVector.clear();\n}\nif (!dhtHumidityVector.empty()) {\n    dhtHumidityMedianVector.push_back(median(dhtHumidityVector));\n    dhtHumidityVector.clear(); //line number 412\n}\n</code></pre>\n\n<p>This is the median function:</p>\n\n<pre><code>double median(std::vector&lt;double&gt; v)\n{\n    size_t n = v.size() / 2;\n    std::nth_element(v.begin(), v.begin()+n, v.end());\n    double vn = v[n];\n    if(v.size()%2 == 1) {\n        return vn;\n    } else  {\n        std::nth_element(v.begin(), v.begin()+n-1, v.end());\n        return 0.5*(vn+v[n-1]);\n    }\n}\n</code></pre>\n\n<h3>Additional debug information</h3>\n\n<p>This is a result:</p>\n\n<pre><code>dhtTempVector size: 4\ndhtTempMedianVector size: 5\ndhtHumidityVector size: 4\ndhtHumidityMedianVector size: 5\n29.00 29.00 29.00 29.00 --\n28.70 28.75 28.80 28.90 28.90 --\n41.20 41.30 41.80 41.40 --\n42.65 42.55 41.80 42.30 41.75 --\n</code></pre>\n\n<p>of these lines of code:</p>\n\n<pre><code>Serial.print(\"dhtTempVector size: \");\nSerial.println(dhtTempVector.size());\nSerial.print(\"dhtTempMedianVector size: \");\nSerial.println(dhtTempMedianVector.size());\nSerial.print(\"dhtHumidityVector size: \");\nSerial.println(dhtHumidityVector.size());\nSerial.print(\"dhtHumidityMedianVector size: \");\nSerial.println(dhtHumidityMedianVector.size());\nfor (int k = 0; k &lt; dhtTempVector.size(); ++k) {\n    Serial.print(dhtTempVector.at(k));\n    Serial.print(\" \");\n}\nSerial.println(\"--\");\nfor (int k = 0; k &lt; dhtTempMedianVector.size(); ++k) {\n    Serial.print(dhtTempMedianVector.at(k));\n    Serial.print(\" \");\n}\nSerial.println(\"--\");\nfor (int k = 0; k &lt; dhtHumidityVector.size(); ++k) {\n    Serial.print(dhtHumidityVector.at(k));\n    Serial.print(\" \");\n}\nSerial.println(\"--\");\nfor (int k = 0; k &lt; dhtHumidityMedianVector.size(); ++k) {\n    Serial.print(dhtHumidityMedianVector.at(k));\n    Serial.print(\" \");\n}\nSerial.println(\"--\");\n</code></pre>\n\n<p>just before the exception is thrown.</p>\n\n<h3>Summary</h3>\n\n<p>It looks like the exception is thrown during clearing the vector. I think I experienced exceptions thrown at the end of the loop() function too - so at the time when destructors of the vectors are fired. I'd think it's a problem with destroying the elements of the vectors but they're just double numbers.</p>\n\n<p>What could be the problem?</p>\n\n<p><strong>@Edit</strong></p>\n\n<p>The <strong>Arduino-ESP8266 library</strong> that I'm using is available here:\n<a href=\"https://github.com/esp8266\" rel=\"nofollow noreferrer\">https://github.com/esp8266</a></p>\n\n<p>Here is <strong>umm_malloc.c</strong>:\n<a href=\"https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c</a></p>\n\n<p><strong>Print.cpp</strong>:\n<a href=\"https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/Print.cpp\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/Print.cpp</a></p>\n\n<p><strong>cont.S</strong>:\n<a href=\"https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/cont.S\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/cont.S</a></p>\n\n<p>Specific <strong>lines from umm_malloc.c</strong>:</p>\n\n<p>1151:</p>\n\n<pre><code>UMM_NFREE(UMM_PFREE(c)) = UMM_NFREE(c);\n</code></pre>\n\n<p><a href=\"https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c#L1151\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c#L1151</a></p>\n\n<p>1287:</p>\n\n<pre><code>if( UMM_NBLOCK(UMM_PBLOCK(c)) &amp; UMM_FREELIST_MASK ) {\n</code></pre>\n\n<p><a href=\"https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c#L1287\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c#L1287</a></p>\n\n<p>1733:</p>\n\n<pre><code>void umm_free( void *ptr ) {\n\n  ptr = GET_UNPOISONED(ptr);\n\n  /* check poison of each blocks, if poisoning is enabled */\n  if (!CHECK_POISON_ALL_BLOCKS()) {\n    return;\n  }\n\n  /* check full integrity of the heap, if this check is enabled */\n  if (!INTEGRITY_CHECK()) {\n    return;\n  }\n\n  _umm_free( ptr );\n} //1733\n</code></pre>\n\n<p><a href=\"https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c#L1733\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/master/cores/esp8266/umm_malloc/umm_malloc.c#L1733</a></p>\n\n<p>Specific <strong>line from Print.cpp</strong>:</p>\n\n<pre><code>size_t Print::write(const uint8_t *buffer, size_t size) {\n    size_t n = 0;\n    while(size--) {\n        n += write(*buffer++); //line number 38\n    }\n    return n;\n}\n</code></pre>\n\n<p><a href=\"https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/Print.cpp#L38\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/Print.cpp#L38</a></p>\n\n<p>Specific <strong>line from core_esp8266_main.cpp</strong>:</p>\n\n<pre><code>static void loop_wrapper() {\n    static bool setup_done = false;\n    preloop_update_frequency();\n    if(!setup_done) {\n        setup();\n#ifdef DEBUG_ESP_PORT\n        DEBUG_ESP_PORT.setDebugOutput(true);\n#endif\n        setup_done = true;\n    }\n    loop();\n    run_scheduled_functions(); //line number 124\n    esp_schedule();\n}\n</code></pre>\n\n<p>Line number 109 from cont.S:</p>\n\n<p><a href=\"https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/cont.S#L109\" rel=\"nofollow noreferrer\">https://github.com/esp8266/Arduino/blob/4897e0006b5b0123a2fa31f67b14a3fff65ce561/cores/esp8266/cont.S#L109</a></p>\n"}, {"tags": ["c++", "enums", "using"], "answers": [{"comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1498090210, "post_id": 44688065, "comment_id": 76360129, "body": "@Amadeus I guess he does not want to use the name of the namespace with enumerators."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1498090350, "post_id": 44688065, "comment_id": 76360162, "body": "@Amadeus He made a typo. E is not a namespace.:)"}, {"owner": {"reputation": 213, "user_id": 1801530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0dcfc5625a32d621dab5f4972a1f6dd?s=128&d=identicon&r=PG", "display_name": "HazySmoke", "link": "https://stackoverflow.com/users/1801530/hazysmoke"}, "edited": false, "score": 1, "creation_date": 1498090355, "post_id": 44688065, "comment_id": 76360163, "body": "Thanks Amadeus. I was going to say the same. I&#39;m wondering if there&#39;s a way other than what I mentioned for (1) and (2) in my question."}, {"owner": {"reputation": 213, "user_id": 1801530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0dcfc5625a32d621dab5f4972a1f6dd?s=128&d=identicon&r=PG", "display_name": "HazySmoke", "link": "https://stackoverflow.com/users/1801530/hazysmoke"}, "edited": false, "score": 0, "creation_date": 1498090428, "post_id": 44688065, "comment_id": 76360182, "body": "@Vlad OK. I just edited my question to fix the typo."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 213, "user_id": 1801530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0dcfc5625a32d621dab5f4972a1f6dd?s=128&d=identicon&r=PG", "display_name": "HazySmoke", "link": "https://stackoverflow.com/users/1801530/hazysmoke"}, "edited": false, "score": 0, "creation_date": 1498090618, "post_id": 44688065, "comment_id": 76360229, "body": "@HazySmoke It is a good idea to use the name of the enumeration before enumerators.:)"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1498090569, "last_edit_date": 1498090569, "creation_date": 1498090006, "answer_id": 44688065, "question_id": 44687998, "link": "https://stackoverflow.com/questions/44687998/c-using-declaration-with-enums-how-to-import-all-the-enum-items/44688065#44688065", "title": "C++ using-declaration with enums: how to import all the enum items?", "body": "<p>Use a qualified name</p>\n\n<pre><code>E e = E::A;\n</code></pre>\n\n<p>For example</p>\n\n<pre><code>namespace N {\n    enum E { A, B, C, D };\n}\n\nint main() \n{\n    using N::E;\n    E e = E::A;\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1498090404, "post_id": 44688107, "comment_id": 76360178, "body": "Now that&#39;s clever!"}, {"owner": {"reputation": 213, "user_id": 1801530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0dcfc5625a32d621dab5f4972a1f6dd?s=128&d=identicon&r=PG", "display_name": "HazySmoke", "link": "https://stackoverflow.com/users/1801530/hazysmoke"}, "edited": false, "score": 0, "creation_date": 1498090647, "post_id": 44688107, "comment_id": 76360234, "body": "@aschelpler Your answer does seem to be a solution to my problem. I&#39;m wondering what the `inline&#39; keyword does to a namespace though. I tried to compile the code without the inline and that works just fine."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1498090726, "post_id": 44688107, "comment_id": 76360252, "body": "Without the <code>inline</code>, you can no longer say <code>N::E</code> or <code>N::A</code> in a context that doesn&#39;t have that using directive.  I figured you wouldn&#39;t want to force everyone to use it."}, {"owner": {"reputation": 213, "user_id": 1801530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0dcfc5625a32d621dab5f4972a1f6dd?s=128&d=identicon&r=PG", "display_name": "HazySmoke", "link": "https://stackoverflow.com/users/1801530/hazysmoke"}, "edited": false, "score": 0, "creation_date": 1498090892, "post_id": 44688107, "comment_id": 76360290, "body": "@aschepler I see. Thank you for the explanation."}], "tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 7, "last_activity_date": 1498090359, "creation_date": 1498090359, "answer_id": 44688107, "question_id": 44687998, "link": "https://stackoverflow.com/questions/44687998/c-using-declaration-with-enums-how-to-import-all-the-enum-items/44688107#44688107", "title": "C++ using-declaration with enums: how to import all the enum items?", "body": "<p>If you can change the header where <code>E</code> is defined, try an <a href=\"http://en.cppreference.com/w/cpp/language/namespace#Inline_namespaces\" rel=\"noreferrer\">inline namespace</a>.</p>\n\n<pre><code>namespace N {\n    inline namespace Enums {\n        enum E { A, B, C, D };\n    }\n}\n\nint main() {\n    using namespace N::Enums;\n    E e = A;\n}\n</code></pre>\n\n<p>All the names in the inline namespace are visible in the enclosing namespace <code>N</code> as though the inline namespace weren't there, but this allows you to import all the names and just the names you want.</p>\n"}], "owner": {"reputation": 213, "user_id": 1801530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0dcfc5625a32d621dab5f4972a1f6dd?s=128&d=identicon&r=PG", "display_name": "HazySmoke", "link": "https://stackoverflow.com/users/1801530/hazysmoke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 1, "accepted_answer_id": 44688107, "answer_count": 2, "score": 4, "last_activity_date": 1498091272, "creation_date": 1498089507, "last_edit_date": 1498091272, "question_id": 44687998, "link": "https://stackoverflow.com/questions/44687998/c-using-declaration-with-enums-how-to-import-all-the-enum-items", "title": "C++ using-declaration with enums: how to import all the enum items?", "body": "<p>Here's a code snippet to demonstrate my question.</p>\n\n<pre><code>namespace N{\n    enum E { A, B, C, D };\n}\n\nint main(){\n    using N::E;\n    E e = A; // syntax error: 'A' is not declared\n}\n</code></pre>\n\n<p>The last line gives me a syntax error. I'd like to use the names <code>N::A</code>, <code>N::B</code>, <code>N::C</code> and <code>N::D</code> in the main function without the namespace qualifier <code>N::</code>. But I <em>don't</em> want to do the following two things</p>\n\n<p>(1) I don't want to say <code>using namespace N</code>, because that would import <em>everything else</em> in N.</p>\n\n<p>(2) I don't want say <code>using N::A</code>, <code>using N::B</code>, etc for every member of the enum. Because then if I want to modify the enum, I'll have to change my main function as well. Not to mention that the extra typing is tedious and error-prone.</p>\n\n<p>I tried searching for an answer myself but couldn't. Any help is appreciated.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1498090591, "post_id": 44687994, "comment_id": 76360224, "body": "For totals, you are both looping 0...3 AND calculating the sum of all columns at once.  So:  how many elements did your first loop of i add to totals?  Hint: not just 1.  How many elements does total have when you&#39;re done?  Hint: not 5."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 7021812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bd0fd041af52b42a8d011956ccffa6?s=128&d=identicon&r=PG&f=1", "display_name": "Raghavendra Bableshwar", "link": "https://stackoverflow.com/users/7021812/raghavendra-bableshwar"}, "is_accepted": false, "score": 0, "last_activity_date": 1498090740, "creation_date": 1498090740, "answer_id": 44688151, "question_id": 44687994, "link": "https://stackoverflow.com/questions/44687994/how-to-calculate-sum-of-each-row-in-2d-array-and-place-in-vector/44688151#44688151", "title": "How to calculate sum of each row in 2D array and place in vector?", "body": "<pre><code>for(int i=0; i&lt;5; i++){\n        for(int c=0; c&lt;4; c++){\n            totals.push_back((pay[i][0]+pay[i][1]+pay[i][2]+pay[i][3]));\n            }\n        cout&lt;&lt;totals[i]&lt;&lt;\"  \";\n    }\n</code></pre>\n\n<p>Try removing the inner loop (the one with variable c). Should work.</p>\n"}, {"tags": [], "owner": {"reputation": 302, "user_id": 4017815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/343434eac9b5fa8c41933546fa570161?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Chou", "link": "https://stackoverflow.com/users/4017815/jerry-chou"}, "is_accepted": false, "score": 0, "last_activity_date": 1498099617, "creation_date": 1498099617, "answer_id": 44689306, "question_id": 44687994, "link": "https://stackoverflow.com/questions/44687994/how-to-calculate-sum-of-each-row-in-2d-array-and-place-in-vector/44689306#44689306", "title": "How to calculate sum of each row in 2D array and place in vector?", "body": "<p>You add the sum <code>pay[i][0]+pay[i][1]+pay[i][2]+pay[i][3]</code> to the vector four times due to your inner loop c.</p>\n\n<p>What you really want is the following,</p>\n\n<pre><code>for(int i=0; i&lt;5; i++){\n    int sum = 0;\n    for(int c=0; c&lt;4; c++)\n        sum += pay[i][c];\n    totals.push_back(sum);\n    cout&lt;&lt;totals[i]&lt;&lt;\"  \";\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7954284, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-D9lt8afukU8/AAAAAAAAAAI/AAAAAAAADHA/IGXGSwzagQI/photo.jpg?sz=128", "display_name": "indecisive", "link": "https://stackoverflow.com/users/7954284/indecisive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1092, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498106582, "creation_date": 1498089458, "last_edit_date": 1498106582, "question_id": 44687994, "link": "https://stackoverflow.com/questions/44687994/how-to-calculate-sum-of-each-row-in-2d-array-and-place-in-vector", "title": "How to calculate sum of each row in 2D array and place in vector?", "body": "<p>I am trying to calculate the sum of each row in the array and place it in a vector,\nYou can find my attempt below,</p>\n\n<p>For that, it prints the same values for the first 4 and a different for the last 1, <code>215 215 215 215 316</code></p>\n\n<p>What I want is for example </p>\n\n<pre><code>x1 2 4 4 6 7  Sumx1=??\nx2 1 2 3 4 5  etc\nx3 1 2 3 4 5 \nx4 1 2 4 5 6\n</code></pre>\n\n<p>and place the value Sumx1 in a vector.</p>\n\n<p>Here's my attempt </p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nint main()\n{\n    string name;\n    srand(time(NULL));\n\n    int pay[5][4];\n\n    vector&lt;string&gt; names;\n\n    for (int i = 0; i &lt; 5; i++)\n    {\n        for (int j = 0; j &lt; 4; j++)\n        {\n            pay[i][j] = rand() % 51 + 50;\n            cout &lt;&lt; pay[i][j] &lt;&lt; \"  \";\n        }\n        cout &lt;&lt; endl;\n    }\n\n    cout &lt;&lt; endl &lt;&lt; endl;\n\n    vector&lt;int&gt; totals;\n\n    for (int i = 0; i &lt; 5; i++) {\n        for (int c = 0; c &lt; 4; c++) {\n            totals.push_back((pay[i][0] + pay[i][1] + pay[i][2] + pay[i][3]));\n        }\n        cout &lt;&lt; totals[i] &lt;&lt; \"  \";\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "templates", "thread-safety"], "answers": [{"comments": [{"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1498094915, "post_id": 44688136, "comment_id": 76361184, "body": "Upvoted for the observation at the end.  It points to the real reason why this doesn&#39;t quite work."}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 2, "last_activity_date": 1498090648, "creation_date": 1498090648, "answer_id": 44688136, "question_id": 44687901, "link": "https://stackoverflow.com/questions/44687901/c-templates-generalized-operations-and-visibility-of-members-between-instant/44688136#44688136", "title": "C++ templates - Generalized operations and visibility of members between instantations", "body": "<p>Make <code>ThreadSafeStack&lt;U&gt;</code> a friend of <code>ThreadSafeStack&lt;T&gt;</code>:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass ThreadsafeStack {\npublic:\n    template &lt;typename U&gt;\n    friend class ThreadSafeStack;\n    //...\n};\n\ntemplate &lt;typename T&gt;\ntemplate &lt;typename U&gt;\nThreadsafeStack&lt;T&gt;&amp; ThreadsafeStack&lt;T&gt;::operator=(ThreadsafeStack&lt;U&gt; const&amp; o)\n{\n  if ((void*) this == (void*) &amp;o) {\n    return *this;\n  }\n\n  std::lock(m, o.m);\n  std::lock_guard&lt;std::mutex&gt; lock1(m, std::adopt_lock);\n  std::lock_guard&lt;std::mutex&gt; lock2(o.m, std::adopt_lock);\n\n  //...\n\n  return *this;\n}\n</code></pre>\n\n<p>Now <code>ThreadSafeStack&lt;T&gt;</code> can access the private members of <code>ThreadSafeStack&lt;U&gt;</code>.  How you go about actually copying a <code>std::stack&lt;T&gt;</code> to a <code>std::stack&lt;U&gt;</code> is still up in the air though; there is no copy constructor or assignment operator that does that.</p>\n"}, {"tags": [], "owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "is_accepted": false, "score": 1, "last_activity_date": 1498091595, "creation_date": 1498091595, "answer_id": 44688254, "question_id": 44687901, "link": "https://stackoverflow.com/questions/44687901/c-templates-generalized-operations-and-visibility-of-members-between-instant/44688254#44688254", "title": "C++ templates - Generalized operations and visibility of members between instantations", "body": "<p>If you had implemented the converting constructor (as suggested in you class declaration):</p>\n\n<pre><code>template &lt;typename U&gt;\nThreadsafeStack(ThreadsafeStack&lt;U&gt; const&amp;);\n</code></pre>\n\n<p>You just need to implement the assingment operator declared as:</p>\n\n<pre><code>ThreadsafeStack&lt;T&gt;&amp; operator=(ThreadsafeStack&lt;T&gt; o);\n</code></pre>\n\n<p>using the <a href=\"https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom\">copy and swap idiom</a> and let the converting constructor do the hard work</p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 1660823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pH8G.jpg?s=128&g=1", "display_name": "laszlzso", "link": "https://stackoverflow.com/users/1660823/laszlzso"}, "edited": false, "score": 0, "creation_date": 1498137301, "post_id": 44688332, "comment_id": 76383771, "body": "A quite different approach, but a great idea. Thank you for pointing out."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 1, "last_activity_date": 1498094651, "last_edit_date": 1498094651, "creation_date": 1498092184, "answer_id": 44688332, "question_id": 44687901, "link": "https://stackoverflow.com/questions/44687901/c-templates-generalized-operations-and-visibility-of-members-between-instant/44688332#44688332", "title": "C++ templates - Generalized operations and visibility of members between instantations", "body": "<p>Have you considered adding <code>lock()</code> and <code>unlock()</code> to your template class ?</p>\n\n<p>I did something very similar before, the difference being that locking was the responsibility of the caller.  Still, this may help you solve your access issue.</p>\n\n<p>The idea behind my code was to find an easy way to make any struct/class thread-safe, in an non-intrusive way.</p>\n\n<p>Exporting  <code>lock()</code> and <code>unlock()</code> makes your template class compatible with std::lock_guard as well, which is nice.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;mutex&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename T, typename _Mutex = std::mutex&gt;\nclass Lockable : public T\n{\npublic:\n    typedef _Mutex Mutex;\n\nprivate:\n   Mutex mtx_;\n\npublic:    \n    Lockable() = default;\n    Lockable(T&amp;&amp; x) : T(std::move(x)), mtx_() {}\n\n    Lockable(Lockable&amp;&amp; x) = default;\n\n    Lockable(const T&amp; t) : T(t), mtx_() {}\n\n    template&lt;typename M&gt;\n    Lockable(const Lockable&lt;T,M&gt;&amp; x) : T(x), mtx_() { }\n\n    //  needs few common operators, =, ==, !=\n    T&amp; operator = (const T&amp; x) { return T::operator=(x); }\n\n    template&lt;typename M&gt;\n    Lockable&amp; operator = (const Lockable&lt;T,M&gt;&amp; x) \n    {\n        T::operator=(static_cast&lt;const T&amp;&gt;(x));\n        return *this;\n    } \n\n    void lock() const   { const_cast&lt;Mutex&amp;&gt;(mtx_).lock(); }\n    void unlock() const { const_cast&lt;Mutex&amp;&gt;(mtx_).unlock(); }\n};\n\n\nint main()\n{\n    using LV = Lockable&lt;std::vector&lt;int&gt;&gt;;\n    LV vec = std::vector&lt;int&gt;(10, 42);\n\n    // this doesn't work, unfortunately \n    //Lockable&lt;int&gt; z{2};\n\n    std::lock_guard&lt;LV&gt; lock{ vec };\n\n    for (auto&amp; x : vec)\n    {\n        std::cout &lt;&lt; \"x: \" &lt;&lt; x &lt;&lt; '\\n';\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 293, "user_id": 1660823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pH8G.jpg?s=128&g=1", "display_name": "laszlzso", "link": "https://stackoverflow.com/users/1660823/laszlzso"}, "is_accepted": true, "score": 0, "last_activity_date": 1498137252, "creation_date": 1498137252, "answer_id": 44700459, "question_id": 44687901, "link": "https://stackoverflow.com/questions/44687901/c-templates-generalized-operations-and-visibility-of-members-between-instant/44700459#44700459", "title": "C++ templates - Generalized operations and visibility of members between instantations", "body": "<p>I saw multiple approaches and answers for the problem, and am very grateful for all your time.\nSince all of them are partial in a sense, but still useful, I venture to provide a comprehensive answer based on your suggestions.</p>\n\n<p>Here is the upgraded class declaration (with friend declaration of other instantiations of the template) suggested by another answer:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass ThreadsafeStack {\npublic:\n    template &lt;typename U&gt;\n    friend class ThreadsafeStack;\n    //...\n};\n</code></pre>\n\n<p>However, the definition of the generalized assignment operator was not complete. Here is the way I finished it:</p>\n\n<pre><code>template &lt;typename T&gt;\ntemplate &lt;typename U&gt;\nThreadsafeStack&lt;T&gt;&amp; ThreadsafeStack&lt;T&gt;::operator=(ThreadsafeStack&lt;U&gt; const&amp; o)\n{\n  if ((void*) this == (void*) &amp;o) {\n    return *this;\n  }\n\n  std::lock(m, o.m);\n  std::lock_guard&lt;std::mutex&gt; lock1(m, std::adopt_lock);\n  std::lock_guard&lt;std::mutex&gt; lock2(o.m, std::adopt_lock);\n\n  data = std::stack&lt;T&gt;{};  // Note that the interface of std::stack doesn't provide a clear() member function.\n  auto tmp = o.data;\n  while (!tmp.empty()) {\n    data.push((T) tmp.top());\n    tmp.pop();\n  }\n\n  return *this;\n}\n</code></pre>\n\n<p>Note that this implementation was similar to the copy-and-swap idiom but unfortunately,\nthe swap part must have been performed in a longer way because of the potential differing types.\n(Of course, the checking and conversion of the types could be further improved, but is not essential for the actual problem.)</p>\n\n<p>Finally, to be complete, here is the implementation of the rest of the members (copy constructors and the \"normal\" assignment operator):</p>\n\n<pre><code>template &lt;typename T&gt;\nThreadsafeStack&lt;T&gt;::ThreadsafeStack(ThreadsafeStack&lt;T&gt; const&amp; o)\n{\n  std::lock_guard&lt;std::mutex&gt; lock(o.m);\n  data = o.data;\n}\n\ntemplate &lt;typename T&gt;\ntemplate &lt;typename U&gt;\nThreadsafeStack&lt;T&gt;::ThreadsafeStack(ThreadsafeStack&lt;U&gt; const&amp; o)\n{\n  std::lock_guard&lt;std::mutex&gt; lock(o.m);\n\n  data = std::stack&lt;T&gt;{};\n  auto tmp = o.data;\n  while (!tmp.empty()) {\n    data.push((T) tmp.top());\n    tmp.pop();\n  }\n}\n\ntemplate &lt;typename T&gt;\nThreadsafeStack&lt;T&gt;&amp; ThreadsafeStack&lt;T&gt;::operator=(ThreadsafeStack&lt;T&gt; const&amp; o)\n{\n  if ((void*) this == (void*) &amp;o) {\n    return *this;\n  }\n\n  std::lock(m, o.m);\n  std::lock_guard&lt;std::mutex&gt; lock1(m, std::adopt_lock);\n  std::lock_guard&lt;std::mutex&gt; lock2(o.m, std::adopt_lock);\n\n  data = o.data;\n\n  return *this;\n}\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 1660823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pH8G.jpg?s=128&g=1", "display_name": "laszlzso", "link": "https://stackoverflow.com/users/1660823/laszlzso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 44700459, "answer_count": 4, "score": 0, "last_activity_date": 1498137252, "creation_date": 1498088856, "question_id": 44687901, "link": "https://stackoverflow.com/questions/44687901/c-templates-generalized-operations-and-visibility-of-members-between-instant", "title": "C++ templates - Generalized operations and visibility of members between instantations", "body": "<p>As some practice, I decided to implement a non-complete threadsafe and generic stack.\nYou can see an initial declaration of the class template below:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass ThreadsafeStack {\npublic:\n  ThreadsafeStack() = default;\n\n  ThreadsafeStack(ThreadsafeStack&lt;T&gt; const&amp;);\n  template &lt;typename U&gt;\n  ThreadsafeStack(ThreadsafeStack&lt;U&gt; const&amp;);\n\n  ~ThreadsafeStack() = default;\n\n  ThreadsafeStack&lt;T&gt;&amp; operator=(ThreadsafeStack&lt;T&gt; const&amp;);\n  template &lt;typename U&gt;\n  ThreadsafeStack&lt;T&gt;&amp; operator=(ThreadsafeStack&lt;U&gt; const&amp;);\n\n  void push(T new_value);\n  std::shared_ptr&lt;T&gt; pop();\n  void pop(T&amp; value);\n  bool empty() const;\nprivate:\n  std::stack&lt;T&gt; data;\n  mutable std::mutex m;\n};\n</code></pre>\n\n<p>My problem is about the generalized copy operations\n(for simplicity, I left out the move operations for now).\nAs an example, see the definition of the \"normal\" and generalized assignment operators:</p>\n\n<pre><code>// \"Normal\"\ntemplate &lt;typename T&gt;\nThreadsafeStack&lt;T&gt;&amp; ThreadsafeStack&lt;T&gt;::operator=(ThreadsafeStack&lt;T&gt; const&amp; o)\n{\n  if ((void*) this == (void*) &amp;o) {\n    return *this;\n  }\n\n  std::lock(m, o.m);\n  std::lock_guard&lt;std::mutex&gt; lock1(m, std::adopt_lock);\n  std::lock_guard&lt;std::mutex&gt; lock2(o.m, std::adopt_lock);\n\n  data = o.data;\n\n  return *this;\n}\n\n// \"Generalized\"\ntemplate &lt;typename T&gt;\ntemplate &lt;typename U&gt;\nThreadsafeStack&lt;T&gt;&amp; ThreadsafeStack&lt;T&gt;::operator=(ThreadsafeStack&lt;U&gt; const&amp; o)\n{\n  if ((void*) this == (void*) &amp;o) {\n    return *this;\n  }\n\n  // ... ?\n\n  return *this;\n}\n</code></pre>\n\n<p>With this code, the problem is that the member <code>std::mutex m</code> of <code>ThreadsafeStack&lt;U&gt;</code> is not\nvisible from <code>ThreadsafeStack&lt;T&gt;</code> - so I can lock <code>m</code> but not <code>o.m</code> (unlike in the \"normal\" case).</p>\n\n<p>(Note that I have to lock the mutex of the data structure to be copied without breaks during\nthe whole copying process. I don't think that locking and releasing by elements would be either efficient\nor logically correct. Consider that I have a stack consisting of values 5, 6, 7; first, I copy 5 but after that\nanother thread pops 6 so the next element I copy is 7...)</p>\n\n<p><strong>So, how would you solve the problem above?</strong></p>\n\n<p>I already considered the following solutions:</p>\n\n<ul>\n<li>make the mutex member public (worst idea, don't want to do that). (Returning a reference to them with a member function is a similar bad OO design idea in my opinion.)</li>\n<li>Second one: create a public member function that returns a copy of the complete underlying data (note that this way locking must be performed only once). I think a longer, but similar workaround could be to use the already present interface.</li>\n<li>Doesn't exist there any language provided, more natural way to do this? (For example, some special syntax that denotes that all instantiations of a specific template see each other's private and protected members for such purposes.)</li>\n</ul>\n\n<p>Also tried to do some research in the topic:</p>\n\n<ul>\n<li><p>in <em>C++ Templates - The Complete Guide</em> the authors also pointed out\nin Chapter 5 that because of this problem they had to use the public\ninterface to make the copy. Despite I find this a great book,\nunfortunately it's a little bit old so there might be more efficient\nsolutions for this nowadays.</p></li>\n<li><p>This might be also true (in connection with certain items) for Scott\nMeyer's <em>Effective C++</em>: Item 45 mentioned \"normal\" and generalized\ncopy constructors/assignment operators, but it wasn't deep enough in\nthis specific direction.</p></li>\n<li><p>Read similar questions on SO but didn't find such a specific one in\nconnection with generalized operations.</p></li>\n</ul>\n\n<p>(Note: the basics of the threadsafe stack example came from Anthony Williams' <em>C++ Concurrency in Action</em>.)</p>\n\n<p>Thank you very much for any help in advance.</p>\n\n<p>Regards,\nZsolt</p>\n"}, {"tags": ["c++", "pointers", "fork"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1498088959, "post_id": 44687802, "comment_id": 76359858, "body": "You will not get a useful answer unless you explain to us exactly what it is that you are trying to do."}, {"owner": {"reputation": 81, "user_id": 3750554, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b5a74788d438f6150e6e2242f2520f47?s=128&d=identicon&r=PG&f=1", "display_name": "John Nunley", "link": "https://stackoverflow.com/users/3750554/john-nunley"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1498089053, "post_id": 44687802, "comment_id": 76359879, "body": "I am writing a server that needs to handle multiple clients at once."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1498089117, "post_id": 44687802, "comment_id": 76359898, "body": "That&#39;s not very helpful. Do you need shared state? Is the server I/O intensive? CPU intensive? How many clients? Are you familiar with C++ libraries like boost? We need lots more information than just something that vague as there are tons of ways to handle multiple clients."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1498089201, "post_id": 44687802, "comment_id": 76359919, "body": "Also, if the code you wrote above worked any differently, <code>fork</code> would be totally unusable. Imagine if each process received a different block of data and, to parse it, did <code>foo *bar = new foo (data_received)</code>. If those two operations interacted in any way, the data from each client couldn&#39;t be correctly processed. Sharing has to be <i>very</i> carefully managed!"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1498090783, "post_id": 44687802, "comment_id": 76360264, "body": "Your new code is quite pointless. You create a thread and then wait for it to finish. What&#39;s the point of that? You haven&#39;t arranged any data sharing."}], "answers": [{"tags": [], "owner": {"reputation": 94918, "user_id": 25050, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6ec78954391f88681b2a5b97ef958d08?s=128&d=identicon&r=PG", "display_name": "Mr Fooz", "link": "https://stackoverflow.com/users/25050/mr-fooz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498088596, "creation_date": 1498088596, "answer_id": 44687871, "question_id": 44687802, "link": "https://stackoverflow.com/questions/44687802/modify-data-in-a-pointer-across-fork/44687871#44687871", "title": "Modify data in a pointer across fork()?", "body": "<p>Once you fork, the new child process has an independent address space.  Any changes in the parent are invisible to the child and any changes in the child are invisible to the parent.  Now behind the scenes, most fork implementations use copy-on-write so that it only duplicates a page of physical RAM once either the parent or child starts writing to it, but this is all hidden from the user processes.</p>\n\n<p>You'll need to either use threads or some sort of <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">interprocess communication</a>.  There are many ways to do this, all with their own tradeoffs.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 3750554, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b5a74788d438f6150e6e2242f2520f47?s=128&d=identicon&r=PG&f=1", "display_name": "John Nunley", "link": "https://stackoverflow.com/users/3750554/john-nunley"}, "edited": false, "score": 0, "creation_date": 1498088755, "post_id": 44687875, "comment_id": 76359815, "body": "The whole reason why I need this is because I&#39;m writing for a server that needs to handle multiple clients at once. Will threads work for that?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 81, "user_id": 3750554, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b5a74788d438f6150e6e2242f2520f47?s=128&d=identicon&r=PG&f=1", "display_name": "John Nunley", "link": "https://stackoverflow.com/users/3750554/john-nunley"}, "edited": false, "score": 0, "creation_date": 1498089042, "post_id": 44687875, "comment_id": 76359876, "body": "@JohnNunley There are many different ways to write servers that need to handle multiple clients. Thread per connection, thread pool, process per connection, select loop, and many more. Why not ask the best way to do whatever it is you&#39;re actually trying to do and give as much information about what you&#39;re trying to do as you can."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1498093666, "post_id": 44687875, "comment_id": 76360892, "body": "if you insist on forks, then you have to look into possible inter-process communication techniques,  like shared memory, mailboxes, fifos, sockets, ..."}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": true, "score": 1, "last_activity_date": 1498088628, "creation_date": 1498088628, "answer_id": 44687875, "question_id": 44687802, "link": "https://stackoverflow.com/questions/44687802/modify-data-in-a-pointer-across-fork/44687875#44687875", "title": "Modify data in a pointer across fork()?", "body": "<p>as soon as you do fork, you go spawn a completely different process with a completely separate (but initially duplicated) memory. Whatever you modify there is not going to be reflected in the main process or vice versa (after the fork).</p>\n\n<p>You need to use <strong>threads</strong> for this.</p>\n"}], "owner": {"reputation": 81, "user_id": 3750554, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b5a74788d438f6150e6e2242f2520f47?s=128&d=identicon&r=PG&f=1", "display_name": "John Nunley", "link": "https://stackoverflow.com/users/3750554/john-nunley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 44687875, "answer_count": 2, "score": -1, "last_activity_date": 1498244135, "creation_date": 1498088104, "last_edit_date": 1498244135, "question_id": 44687802, "link": "https://stackoverflow.com/questions/44687802/modify-data-in-a-pointer-across-fork", "title": "Modify data in a pointer across fork()?", "body": "<p>Let's say I have a class declared...</p>\n\n<pre><code>class foo {\n  public:\n    int i;\n    foo(int j) { i = j; }\n};\n</code></pre>\n\n<p>Then, I use it in code like this:</p>\n\n<pre><code>foo *bar = new foo(17);\n\ncout &lt;&lt; \"Bar is \" &lt;&lt; bar-&gt;i &lt;&lt; endl;\n\nif (!fork()) {\n  bar-&gt;i = 2;\n  exit(0);\n}\n\ncout &lt;&lt; \"Bar is now \" &lt;&lt; bar-&gt;i &lt;&lt; endl;\n</code></pre>\n\n<p>I compile this with <code>g++</code> and run the executable. And I get the following output:</p>\n\n<pre><code>me@computer:~$ ./a.out\nBar is 17\nBar is now 17\n</code></pre>\n\n<p>I have a similar problem, where I need a pointer to a class (slightly more complex than the example) modified within an <code>if (!fork())</code> block. Is there any way to do this?</p>\n\n<p>I am able to convert this class to and from a string, if that makes it easier. I am using C++11 and <code>cmake</code>, should that be relevant.</p>\n\n<p>Update: Threads are working wonders for me right now. Thanks you, everybody. Here's what I did, essentially:</p>\n\n<pre><code>void blob(foo *bar)\n{\n  bar-&gt;i = 2;\n}\n\nint main()\n{\n  foo *bar = new foo(17);\n  thread th (blob,bar);\n  th.detach();\n  delete bar;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "game-engine", "particle-system", "transform-feedback"], "comments": [{"owner": {"reputation": 1930, "user_id": 1890396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812a06bb3f81c24479cc1b65112723?s=128&d=identicon&r=PG", "display_name": "Hugh Fisher", "link": "https://stackoverflow.com/users/1890396/hugh-fisher"}, "edited": false, "score": 1, "creation_date": 1498557482, "post_id": 44687794, "comment_id": 76535144, "body": "I have a particle system program from a few years back implemented using transform feedback. I put a comment in the code saying that glEnable(GL_RASTERIZER_DISCARD) must be <i>before</i> binding the shader program, setting up uniforms, setting up buffers, etc. Maybe try that?"}], "owner": {"reputation": 121, "user_id": 5719743, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208462382303048/picture?type=large", "display_name": "Marcel ", "link": "https://stackoverflow.com/users/5719743/marcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498088057, "creation_date": 1498088057, "question_id": 44687794, "link": "https://stackoverflow.com/questions/44687794/opengl-c-transform-feedback-values-do-not-update", "title": "OpenGL c++ Transform Feedback values do not update", "body": "<p>We are currently working on a GPU Particle System. Something on my implementation is wrong, it seems the Buffers do not get updated or drawn to.</p>\n\n<p>I would be very grateful for any help!</p>\n\n<p><strong>Particle system init</strong>:</p>\n\n<pre><code>Particle Particles[MaxParticles];\n\nParticles[0].Type = 0;\nParticles[0].Pos = glm::vec3(12.f, 14.f, 17.f);// getCamPos();\nParticles[0].Vel = glm::vec3(0.0f, 0.0341f, 0.0f);\nParticles[0].LifetimeMillis = 0.0f;\n\ncurrTransFeedBuffer = 1;\ncurrVertBuffer = 0;\n\nglGenTransformFeedbacks(2, transFeedBackBuffers);\nglGenBuffers(2, particleBuffers);\n\nfor (unsigned int i = 0; i &lt; 2; i++) {\n    glBindTransformFeedback(GL_TRANSFORM_FEEDBACK, transFeedBackBuffers[i]);\n    glBindBuffer(GL_ARRAY_BUFFER, particleBuffers[i]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(Particles), Particles, GL_DYNAMIC_DRAW);\n    glBindBufferBase(GL_TRANSFORM_FEEDBACK_BUFFER, 0, particleBuffers[i]);\n}\n</code></pre>\n\n<p><strong>particle system update</strong>:</p>\n\n<pre><code>particleShader.useShader();\n\n\nauto m_deltaTimeMillisLocation      = glGetUniformLocation(particleShader.programHandle, \"gDeltaTimeMillis\");\nauto m_timeLocation                     = glGetUniformLocation(particleShader.programHandle, \"gTime\");\nauto m_launcherLifetimeLocation         = glGetUniformLocation(particleShader.programHandle, \"gLauncherLifetime\");\nauto m_shellLifetimeLocation                = glGetUniformLocation(particleShader.programHandle, \"gShellLifetime\");\nauto m_secondaryShellLifetimeLocation   = glGetUniformLocation(particleShader.programHandle, \"gSecondaryShellLifetime\");\n\nglUniform1f(m_deltaTimeMillisLocation, (float)delta);\nglUniform1f(m_timeLocation, (float)glfwGetTime());\nglUniform1f(m_launcherLifetimeLocation, 10.f);\nglUniform1f(m_shellLifetimeLocation, 3.f);\nglUniform1f(m_secondaryShellLifetimeLocation, 1.5f);\n\nglEnable(GL_RASTERIZER_DISCARD);\n\nglBindBuffer(GL_ARRAY_BUFFER, particleBuffers[currVertBuffer]);\nglBindTransformFeedback(GL_TRANSFORM_FEEDBACK, transFeedBackBuffers[currTransFeedBuffer]);\n\ncout &lt;&lt; \"update bind buffer \" &lt;&lt; \"particleBuffers\" &lt;&lt; \" -&gt; \" &lt;&lt; currVertBuffer &lt;&lt; endl;\ncout &lt;&lt; \"update bind TF \" &lt;&lt; \"transFeedBackBuffers\" &lt;&lt; \" -&gt; \" &lt;&lt; currTransFeedBuffer &lt;&lt; endl;\n\nglEnableVertexAttribArray(0);\nglEnableVertexAttribArray(1);\nglEnableVertexAttribArray(2);\nglEnableVertexAttribArray(3);\n\nglVertexAttribPointer(0, 1, GL_FLOAT, GL_FALSE, sizeof(Particle), 0);                          // type\nglVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, sizeof(Particle), (const GLvoid*)4);         // position\nglVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, sizeof(Particle), (const GLvoid*)16);        // velocity\nglVertexAttribPointer(3, 1, GL_FLOAT, GL_FALSE, sizeof(Particle), (const GLvoid*)28);          // lifetime\n\nglBeginTransformFeedback(GL_POINTS);\n\nif (firstParticles) {\n    glDrawArrays(GL_POINTS, 0, 1);\n\n    firstParticles = false;\n}\nelse {\n    glDrawTransformFeedback(GL_POINTS, transFeedBackBuffers[currVertBuffer]);\n}\n\nglEndTransformFeedback();\n\nglDisableVertexAttribArray(0);\nglDisableVertexAttribArray(1);\nglDisableVertexAttribArray(2);\nglDisableVertexAttribArray(3);\n\nglDisable(GL_RASTERIZER_DISCARD);\n</code></pre>\n\n<p>I did not spent much time on the <strong>Draw call</strong>. My  Initial plan was to draw instanced, need more research for this, thats why i tried to get the particle simulation to run first.</p>\n\n<pre><code>    shader-&gt;useShader();\n    glBindBuffer(GL_ARRAY_BUFFER, particleBuffers[currTransFeedBuffer]);\nglDrawTransformFeedback(GL_POINTS,transFeedBackBuffers[currTransFeedBuffer]);\n\n    GLuint temp = currVertBuffer;\n    currVertBuffer = currTransFeedBuffer;\n    currTransFeedBuffer = temp;\n</code></pre>\n\n<p>I have also have troubles <strong>debugging</strong> this code, i used </p>\n\n<pre><code>glBindTransformFeedback(GL_TRANSFORM_FEEDBACK, transFeedBackBuffers[currTransFeedBuffer]); \nGLfloat feedback[20];\nglGetBufferSubData(GL_TRANSFORM_FEEDBACK_BUFFER, 0, sizeof(feedback), feedback);\ncout &lt;&lt; currTransFeedBuffer &lt;&lt; \"-------------\"&lt;&lt; endl;\nfor (int i = 0; i &lt; 20; i++) {\n    cout &lt;&lt; feedback[i] &lt;&lt; \" - \";\n}\ncout &lt;&lt; endl;\n</code></pre>\n\n<p>to check the buffer data, it seems to be always just the one element i set in the init, not changing.</p>\n\n<p><strong>Shader class</strong>:</p>\n\n<pre><code>Shader::Shader(const string&amp; vertexShader, const string&amp; geoShader, const string&amp; fragmentShader)\n: programHandle(0){\nprogramHandle = glCreateProgram();\n\nif (programHandle == 0) {\n    cerr &lt;&lt; \"ERROR: Failed to create programm\" &lt;&lt; endl;\n    system(\"PAUSE\");\n    exit(EXIT_FAILURE);\n}\n\nGLuint vertexHandle;\nGLuint fragmentHandle;\nGLuint geoHandle;\n\nloadShader(vertexShader, GL_VERTEX_SHADER, vertexHandle);\nloadShader(geoShader, GL_GEOMETRY_SHADER, geoHandle);\nloadShader(fragmentShader, GL_FRAGMENT_SHADER, fragmentHandle);\n\nglAttachShader(programHandle, vertexHandle);\nglAttachShader(programHandle, fragmentHandle);\nglAttachShader(programHandle, geoHandle);\n\nconst GLchar* Varyings[4];\nVaryings[0] = \"Type1\";\nVaryings[1] = \"Position1\";\nVaryings[2] = \"Velocity1\";\nVaryings[3] = \"Age1\";\n\nglTransformFeedbackVaryings(programHandle, 4, Varyings, GL_INTERLEAVED_ATTRIBS);\n\nglLinkProgram(programHandle);\n</code></pre>\n\n<p>}</p>\n\n<p><strong>vert shader</strong>:</p>\n\n<pre><code>#version 330                                                                        \n\nlayout (location = 0) in float Type;                                                \nlayout (location = 1) in vec3 Position;                                             \nlayout (location = 2) in vec3 Velocity;                                             \nlayout (location = 3) in float Age;                                                 \n\nout float Type0;                                                                    \nout vec3 Position0;                                                                 \nout vec3 Velocity0;                                                                 \nout float Age0;                                                                     \n\nvoid main()                                                                         \n{                                                                                   \n    Type0 = Type;                                                                   \n    Position0 = Position;                                                           \n    Velocity0 = Velocity;                                                           \n    Age0 = Age;                                                                     \n}\n</code></pre>\n\n<p><strong>GeometryShader</strong>:</p>\n\n<pre><code>#version 330                                                                        \n\nlayout(points) in;                                                                  \nlayout(points) out;                                                                 \nlayout(max_vertices = 30) out;                                                      \n\nin float Type0[];                                                                   \nin vec3 Position0[];                                                                \nin vec3 Velocity0[];                                                                \nin float Age0[];                                                                    \n\nout float Type1;                                                                    \nout vec3 Position1;                                                                 \nout vec3 Velocity1;                                                                 \nout float Age1;                                                                     \n\n#define PARTICLE_TYPE_LAUNCHER 0.0f                                                 \n\nvec3 GetRandomDir(float TexCoord)                                                   \n{                                                                                   \n     return vec3(0.5, 0.5, 0.5);                                                                     \n}                                \n\nvoid main() {\n\n        float Age = Age0[0] + gDeltaTimeMillis;\n\n        Type1       = PARTICLE_TYPE_LAUNCHER;                                             \n        Position1   = Position0[0];                                                   \n        Velocity1   = Velocity0[0];                                                   \n        Age1        = Age;                                                                 \n        EmitVertex();                                                               \n        EndPrimitive(); \n\n}   \n</code></pre>\n\n<p>Maybe my tunnel Vision is to strong already, but i worked myself to a lot of tuts, threads and examples, i don't get whats wrong!\nI hope someone can help me out, greetings!</p>\n"}, {"tags": ["c++", "opengl", "point-cloud-library"], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 7342870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/666f7b11da2373893634c385d25fd0fd?s=128&d=identicon&r=PG&f=1", "display_name": "user19318", "link": "https://stackoverflow.com/users/7342870/user19318"}, "is_accepted": false, "score": 0, "last_activity_date": 1498083687, "creation_date": 1498083687, "answer_id": 44687171, "question_id": 44687061, "link": "https://stackoverflow.com/questions/44687061/how-to-draw-points-efficiently/44687171#44687171", "title": "How to draw points efficiently", "body": "<p>Yes definitely, the code you are showing is from a quite old version of OpenGL.\nIn more recent versions you can pack your data together and send it to the GPU in one call. The code becomes a little bit more complex but it is worth it. \nI suggest you to look at this website : <a href=\"https://learnopengl.com/\" rel=\"nofollow noreferrer\">https://learnopengl.com/</a>\nIt gathers everything you need to start using modern opengl.\nHope it helped.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 9304804, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rg4HjQ3XNtU/AAAAAAAAAAI/AAAAAAAAAVQ/6zjuospqa7I/photo.jpg?sz=128", "display_name": "Sid133", "link": "https://stackoverflow.com/users/9304804/sid133"}, "edited": false, "score": 0, "creation_date": 1577363858, "post_id": 44687218, "comment_id": 105151602, "body": "@genpfault: How can I read an external file ,say .csv of structure x1,y1,z1 (newline) x2,y2,z2... etc. directly to a VB ? Is there a way or do we always have to use a vector (like vert) in between. Can you provide some insight"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "reply_to_user": {"reputation": 129, "user_id": 9304804, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rg4HjQ3XNtU/AAAAAAAAAAI/AAAAAAAAAVQ/6zjuospqa7I/photo.jpg?sz=128", "display_name": "Sid133", "link": "https://stackoverflow.com/users/9304804/sid133"}, "edited": false, "score": 0, "creation_date": 1577501329, "post_id": 44687218, "comment_id": 105188129, "body": "@Sid133: You can <a href=\"http://www.songho.ca/opengl/gl_vbo.html#update\" rel=\"nofollow noreferrer\">use <code>glMapBuffer()</code></a> to grab a writable pointer corresponding to the VBO storage &amp; avoid the vector."}], "tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": false, "score": 7, "last_activity_date": 1548685451, "last_edit_date": 1548685451, "creation_date": 1498083942, "answer_id": 44687218, "question_id": 44687061, "link": "https://stackoverflow.com/questions/44687061/how-to-draw-points-efficiently/44687218#44687218", "title": "How to draw points efficiently", "body": "<p>Jam all the points into a big <a href=\"http://www.songho.ca/opengl/gl_vbo.html\" rel=\"noreferrer\">VBO</a> when the point-cloud changes &amp; draw 'em all in one go using a single <code>glDrawArrays()</code> call.  That way OpenGL can <a href=\"https://en.wikipedia.org/wiki/Direct_memory_access\" rel=\"noreferrer\">shift</a> all the vertex data to GPU once instead of you <a href=\"https://en.wikipedia.org/wiki/Programmed_input/output\" rel=\"noreferrer\">spoon-feeding</a> the driver geometry one <code>glVertex()</code> at a time <em>every frame</em>.</p>\n\n<p>Heck, even vertex arrays will buy you a huge speed-up by avoiding hundreds of thousands of function-calls into the GL driver.</p>\n\n<p><strong>EDIT</strong>: Comparison:</p>\n\n<p>10 million random points, using vertex buffer objects:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bsAjg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/bsAjg.png\" alt=\"vertex buffer object\"></a></p>\n\n<p>Vertex arrays:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0LixD.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/0LixD.png\" alt=\"vertex array\"></a></p>\n\n<p>Display lists:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RwHcX.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/RwHcX.png\" alt=\"display list\"></a></p>\n\n<p>And using immediate-mode:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HFBZK.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/HFBZK.png\" alt=\"immediate-mode\"></a></p>\n\n<p>Code (hit 'n' to cycle between drawing methods):</p>\n\n<pre><code>// http://glew.sourceforge.net/\n#include &lt;GL/glew.h&gt;\n\n// http://freeglut.sourceforge.net/\n#include &lt;GL/freeglut.h&gt;\n\n// http://glm.g-truc.net/\n#include &lt;glm/glm.hpp&gt;\n#include &lt;glm/gtc/random.hpp&gt;\n#include &lt;glm/gtc/type_ptr.hpp&gt;\n\n#include &lt;vector&gt;\n#include &lt;sstream&gt;\n#include &lt;chrono&gt;\n#include &lt;cstddef&gt;\n\nstruct Vertex\n{\n    glm::vec4 pos;\n    glm::vec4 color;\n};\nstd::vector&lt; Vertex &gt; verts;\nGLuint vbo = 0;\nGLuint dlist = 0;\n\nvoid init()\n{\n    // init geometry\n    for( size_t i = 0; i &lt; 10000000; i++ )\n    {\n        Vertex vert;\n        vert.pos = glm::vec4( glm::linearRand( glm::vec3( -1.0f, -1.0f, -1.0f ), glm::vec3( 1.0f, 1.0f, 1.0f ) ), 1.0f );\n        vert.color = glm::vec4( glm::linearRand( glm::vec3( 0.00f, 0.0f, 0.0f ), glm::vec3( 1.0f, 1.0f, 1.0f ) ), 1.0f );\n        verts.push_back( vert );\n    }\n\n    // create display list\n    dlist = glGenLists( 1 );\n    glNewList( dlist, GL_COMPILE );\n    glBegin( GL_POINTS );\n    for( size_t i = 0; i &lt; verts.size(); ++i )\n    {\n        glColor4fv( glm::value_ptr( verts[i].color) );\n        glVertex4fv( glm::value_ptr( verts[i].pos) );\n    }\n    glEnd();\n    glEndList();\n\n    // create VBO\n    glGenBuffers( 1, &amp;vbo );\n    glBindBuffer( GL_ARRAY_BUFFER, vbo );\n    glBufferData( GL_ARRAY_BUFFER, sizeof( Vertex ) * verts.size(), verts.data(), GL_STATIC_DRAW );\n}\n\nunsigned int method = 0;\nvoid keyboard( unsigned char key, int x, int y )\n{\n    if( 'n' == key )\n    {\n        method++;\n        if( method &gt; 3 ) method = 0;\n    }\n}\n\nvoid display()\n{\n    // timekeeping\n    static std::chrono::steady_clock::time_point prv = std::chrono::steady_clock::now();\n    std::chrono::steady_clock::time_point cur = std::chrono::steady_clock::now();\n    const float dt = std::chrono::duration&lt; float &gt;( cur - prv ).count();\n    prv = cur;\n\n    glClearColor( 0, 0, 0, 1 );\n    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );\n\n    glMatrixMode( GL_PROJECTION );\n    glLoadIdentity();\n    double w = glutGet( GLUT_WINDOW_WIDTH );\n    double h = glutGet( GLUT_WINDOW_HEIGHT );\n    gluPerspective( 60.0, w / h, 0.1, 10.0 );\n\n    glMatrixMode( GL_MODELVIEW );\n    glLoadIdentity();\n    gluLookAt( 2, 2, 2, 0, 0, 0, 0, 0, 1 );\n\n    static float angle = 0.0f;\n    angle += dt * 6.0f;\n    glRotatef( angle, 0, 0, 1 );\n\n    // render\n    switch( method )\n    {\n    case 0:\n        // VBO\n        glBindBuffer( GL_ARRAY_BUFFER, vbo );\n        glEnableClientState( GL_VERTEX_ARRAY );\n        glEnableClientState( GL_COLOR_ARRAY );\n        glVertexPointer( 4, GL_FLOAT, sizeof( Vertex ), (void*)offsetof( Vertex, pos ) );\n        glColorPointer( 4, GL_FLOAT, sizeof( Vertex ), (void*)offsetof( Vertex, color ) );\n        glDrawArrays( GL_POINTS, 0, verts.size() );\n        glDisableClientState( GL_VERTEX_ARRAY );\n        glDisableClientState( GL_COLOR_ARRAY );\n        glBindBuffer( GL_ARRAY_BUFFER, 0 );\n        break;\n\n    case 1:\n        // vertex array\n        glEnableClientState( GL_VERTEX_ARRAY );\n        glEnableClientState( GL_COLOR_ARRAY );\n        glVertexPointer( 4, GL_FLOAT, sizeof( Vertex ), &amp;verts[0].pos );\n        glColorPointer( 4, GL_FLOAT, sizeof( Vertex ), &amp;verts[0].color );\n        glDrawArrays( GL_POINTS, 0, verts.size() );\n        glDisableClientState( GL_VERTEX_ARRAY );\n        glDisableClientState( GL_COLOR_ARRAY );\n        break;\n\n    case 2:\n        // display list\n        glCallList( dlist );\n        break;\n\n    case 3:\n        // immediate mode\n        glBegin( GL_POINTS );\n        for( size_t i = 0; i &lt; verts.size(); ++i )\n        {\n            glColor4fv( glm::value_ptr( verts[i].color) );\n            glVertex4fv( glm::value_ptr( verts[i].pos) );\n        }\n        glEnd();\n        break;\n    }\n\n    // info/frame time output\n    std::stringstream msg;\n    msg &lt;&lt; \"Using \";\n    switch( method )\n    {\n    case 0: msg &lt;&lt; \"vertex buffer object\"; break;\n    case 1: msg &lt;&lt; \"vertex array\"; break;\n    case 2: msg &lt;&lt; \"display list\"; break;\n    case 3: msg &lt;&lt; \"immediate mode\"; break;\n    }\n    msg &lt;&lt; std::endl;\n    msg &lt;&lt; \"Frame time: \" &lt;&lt; (dt * 1000.0f) &lt;&lt; \" ms\";\n    glColor3ub( 255, 255, 0 );\n    glWindowPos2i( 10, 25 );\n    glutBitmapString( GLUT_BITMAP_9_BY_15, (unsigned const char*)( msg.str().c_str() ) );\n\n    glutSwapBuffers();\n}\n\nint main(int argc, char **argv)\n{\n    glutInit( &amp;argc, argv );\n    glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );\n    glutInitWindowSize( 600, 600 );\n    glutCreateWindow( \"GLUT\" );\n    glewInit();\n    init();\n    glutDisplayFunc( display );\n    glutKeyboardFunc( keyboard );\n    glutIdleFunc( display );\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8196678, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bf96d06c900fed1335b747f4a47d5a76?s=128&d=identicon&r=PG&f=1", "display_name": "orsonl", "link": "https://stackoverflow.com/users/8196678/orsonl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2837, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1548685451, "creation_date": 1498082954, "last_edit_date": 1498084487, "question_id": 44687061, "link": "https://stackoverflow.com/questions/44687061/how-to-draw-points-efficiently", "title": "How to draw points efficiently", "body": "<p>My program receives PCL pointcloud and plot each point one by one using:</p>\n\n<pre><code>glBegin(GL_POINTS);\nglVertex3f(point.x, point.y, point].z);\nglEnd();\n</code></pre>\n\n<p>It works but due to the large number of points the program is pretty slow. Is there a more efficient way to do this?</p>\n"}, {"tags": ["python", "c++", "cython", "boost-python"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498089337, "post_id": 44686590, "comment_id": 76359945, "body": "Does <code>return dereference(self.c.at(index).get())</code> work?  I.e. retrieve the <code>shared_ptr</code> from the vector, <code>get()</code> the stored pointer and <code>dereference</code> it.  Or maybe simply <code>return dereference(self.c.at(index))</code> (in C++ you can dereference the shared pointer directly)."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498089588, "post_id": 44686590, "comment_id": 76359998, "body": "This however gives you a <code>mystruct</code> instead of a <code>MyStruct</code>.  I guess you would need a second constructor <code>def __cinit__(MyStruct self, new_ptr): self.ptr.reset(new_ptr)</code> and then do <code>return MyStruct(self.c.at(index))</code>."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498092961, "post_id": 44686590, "comment_id": 76360712, "body": "Yeah, there&#39;s just a few issues unfortunately @HenriMenke. Cython won&#39;t let me use C types as arguments in a <code>def</code> (unlike a <code>cdef</code>), and initialization functions cannot be <code>cdef</code>-only.  If Cython let me define custom constructors with <code>cdef</code>, that would solve everything. Unfortunately, it does not.  It&#39;s probably doable via the Python C-API, or by overloading <code>__init__</code>, but the docs pretty clearly state the object should be valid when <code>__init__</code> is called, and <code>__init__</code> may not be called at all.  <a href=\"https://cython.readthedocs.io/en/latest/src/userguide/special_methods.html\" rel=\"nofollow noreferrer\">cython.readthedocs.io/en/latest/src/userguide/&hellip;</a>"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498093215, "post_id": 44686590, "comment_id": 76360777, "body": "Overloaded <code>__cinit__</code> plus <a href=\"https://cython.readthedocs.io/en/latest/src/userguide/extension_types.html#fast-instantiation\" rel=\"nofollow noreferrer\"><code>return MyStruct.__new__(self.c.at(index))</code></a> could work."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498100723, "post_id": 44686590, "comment_id": 76362537, "body": "&#187;this would have risky memory safety if <code>__new__</code> was used from the Python layer&#171; You are raising your standards to an unreasonable and ridiculous level.  If somebody calls <code>__new__</code> on the Python level they better know what they are doing.  If you want memory safety just rewrite your whole code in Python."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498151292, "post_id": 44686590, "comment_id": 76393977, "body": "@HenriMenke, A). That actually won&#39;t work, it only works because the existing object is a Python object: if it was a C struct, it would raise an error (tested). In fact, I get the exact error the question is about: <code>Cannot convert &#39;type&#39; to Python object</code>.  B). Expecting memory safety from choices made in a memory-safe language is <b>not</b> a trivial concern. It&#39;s essential."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498151447, "post_id": 44686590, "comment_id": 76394060, "body": "@HenriMenke  If I try the same from boost::python, I get ` Boost.Python.instance.__new__(): not enough arguments<code>, which highlights how it prevents initialization without required data (in this case, it needs to know the type). If I force the type with </code>c = a.MyStruct.__new__(MyStruct)`, and then try to use c, it automatically checks that the struct is invalid before I access any member functions. That is useful memory safety."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498152122, "post_id": 44686590, "comment_id": 76394409, "body": "@HenriMenke Ok, last thing, it works with <code>cdef struct</code>, but not with <code>cdef cppclass</code> so maybe I should change the title? Either way, it does not work unless I do manual memory management, since <code>shared_ptr</code> is clearly a cppclass. Either way, this seems to be a major design flaw that I don&#39;t see an obvious solution to...."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1498681681, "post_id": 44686590, "comment_id": 76604541, "body": "@HenriMenke After looking at the documentation closer, it appears there is a @nonecheck setting you can use to prevent null dereferences in Cython I believe. If you write that as an answer, along with the <code>__init__</code> override, I can give you the answer."}], "answers": [{"tags": [], "owner": {"reputation": 4536, "user_id": 4165324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d50177f8e05b2c515b26455ba250ce?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/4165324/danny"}, "is_accepted": true, "score": 6, "last_activity_date": 1513659516, "last_edit_date": 1513659516, "creation_date": 1499786644, "answer_id": 45038660, "question_id": 44686590, "link": "https://stackoverflow.com/questions/44686590/initializing-cython-objects-with-existing-c-objects/45038660#45038660", "title": "Initializing Cython objects with existing C Objects", "body": "<p>The way this works in Cython is by having a factory class to create Python objects out of the shared pointer. This gives you access to the underlying C/C++ structure without copying.</p>\n\n<p>Example Cython code:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&lt;..&gt;\n\ncdef class MyStruct:\n    cdef shared_ptr[mystruct] ptr\n\n    def __cinit__(self):\n        # Do not create new ref here, we will\n        # pass one in from Cython code\n        self.ptr = NULL\n\n    def __dealloc__(self):\n        # Do de-allocation here, important!\n        if self.ptr is not NULL:\n            &lt;de-alloc&gt;\n\n    &lt;rest per MyStruct code above&gt;\n\ncdef object PyStruct(shared_ptr[mystruct] MyStruct_ptr):\n    \"\"\"Python object factory class taking Cpp mystruct pointer\n    as argument\n    \"\"\"\n    # Create new MyStruct object. This does not create\n    # new structure but does allocate a null pointer\n    cdef MyStruct _mystruct = MyStruct()\n    # Set pointer of cdef class to existing struct ptr\n    _mystruct.ptr = MyStruct_ptr\n    # Return the wrapped MyStruct object with MyStruct_ptr\n    return _mystruct\n\ndef make_structure():\n    \"\"\"Function to create new Cpp mystruct and return\n    python object representation of it\n    \"\"\"\n    cdef MyStruct mypystruct = PyStruct(new mystruct)\n    return mypystruct\n</code></pre>\n\n<p>Note the type for the argument of <code>PyStruct</code> is a <em>pointer</em> to the Cpp struct.</p>\n\n<p><code>mypystruct</code> then is a python object of class <code>MyStruct</code>, as returned by the factory class, which refers to the\nCpp mystruct without copying. <code>mypystruct</code> can be safely returned in <code>def</code> cython functions and used in python space, per <code>make_structure</code> code. </p>\n\n<p>To return a Python object of an existing Cpp <code>mystruct</code> pointer just wrap it with <code>PyStruct</code> like </p>\n\n<p><code>return PyStruct(my_cpp_struct_ptr)</code> </p>\n\n<p>anywhere in your Cython code.</p>\n\n<p>Obviously only <code>def</code> functions are visible there so the Cpp function calls would need to be wrapped as well inside MyStruct if they are to be used in Python space, at least if you want the Cpp function calls inside the Cython class to let go of the GiL (probably worth doing for obvious reasons).</p>\n\n<p>For a real-world example see this <a href=\"https://github.com/NodeTrie/NodeTrie_Py/blob/master/nodetrie/nodetrie.pyx#L49-L53\" rel=\"noreferrer\">Cython extension code</a> and the <a href=\"https://github.com/NodeTrie/NodeTrie_C/blob/master/extensions/python/cnode.pxd\" rel=\"noreferrer\">underlying C code bindings in Cython</a>. Also see <a href=\"https://github.com/NodeTrie/NodeTrie_Py/blob/master/nodetrie/nodetrie.pyx#L139-L147\" rel=\"noreferrer\">this code for Python function wrapping of C function calls that let go of GIL</a>. Not Cpp but same applies.</p>\n\n<p>See also <a href=\"http://cython.readthedocs.io/en/latest/src/reference/extension_types.html?highlight=factory#initialization-cinit-and-init\" rel=\"noreferrer\">official Cython documentation on when a factory class/function is needed</a> (<code>Note that all constructor arguments will be passed as Python objects</code>). For built in types, Cython does this conversion for you but for custom structures or objects a factory class/function is needed. </p>\n\n<p>The Cpp structure initialisation could be handled in <code>__new__</code> of <code>PyStruct</code> if needed, per suggestion above, if you want the factory class to actually create the C++ structure for you (depends on the use case really).</p>\n\n<p>The benefit of a factory class with pointer arguments is it allows you to use existing pointers of C/C++ structures and wrap them in a Python extension class, rather than always having to create new ones. It would be perfectly safe to, for example, have multiple Python objects referring to the same underlying C struct. Python's ref counting ensures they won't be de-allocated prematurely. You should still check for null when deallocating though as the shared pointer could already had been de-allocated explicitly (eg, by <code>del</code>).</p>\n\n<p>Note that there is, however, some overhead in creating new python objects even if they do point to the same C++ structure. Not a lot, but still.</p>\n\n<p>IMO this auto de-allocation and ref counting of C/C++ pointers is one of the greatest features of Python's C extension API. As all that acts on Python objects (alone), the C/C++ structures need to be wrapped in a compatible Python <code>object</code> class definition.</p>\n\n<p>Note - My experience is mostly in C, the above may need adjusting as I'm more familiar with regular C pointers than C++'s shared pointers.</p>\n"}], "owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1877, "favorite_count": 3, "accepted_answer_id": 45038660, "answer_count": 1, "score": 8, "last_activity_date": 1513659516, "creation_date": 1498080628, "last_edit_date": 1498093816, "question_id": 44686590, "link": "https://stackoverflow.com/questions/44686590/initializing-cython-objects-with-existing-c-objects", "title": "Initializing Cython objects with existing C Objects", "body": "<p><strong>C++ Model</strong></p>\n\n<p>Say I have the following C++ data structures I wish to expose to Python.</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;vector&gt;\n\nstruct mystruct\n{\n    int a, b, c, d, e, f, g, h, i, j, k, l, m;\n};\n\ntypedef std::vector&lt;std::shared_ptr&lt;mystruct&gt;&gt; mystruct_list;\n</code></pre>\n\n<p><strong>Boost Python</strong></p>\n\n<p>I can wrap these fairly effectively using boost::python with the following code, easily allowing me to use the existing mystruct (copying the shared_ptr) rather than recreating an existing object.</p>\n\n<pre><code>#include \"mystruct.h\"\n#include &lt;boost/python.hpp&gt;\n\nusing namespace boost::python;\n\n\nBOOST_PYTHON_MODULE(example)\n{\n    class_&lt;mystruct, std::shared_ptr&lt;mystruct&gt;&gt;(\"MyStruct\", init&lt;&gt;())\n        .def_readwrite(\"a\", &amp;mystruct::a);\n        // add the rest of the member variables\n\n    class_&lt;mystruct_list&gt;(\"MyStructList\", init&lt;&gt;())\n        .def(\"at\", &amp;mystruct_list::at, return_value_policy&lt;copy_const_reference&gt;());\n        // add the rest of the member functions\n}\n</code></pre>\n\n<p><strong>Cython</strong></p>\n\n<p>In Cython, I have no idea how to extract an item from mystruct_list, without copying the underlying data. I have no idea how I could initialize <code>MyStruct</code> from the existing <code>shared_ptr&lt;mystruct&gt;</code>, without copying all the data over in one of various forms.</p>\n\n<pre><code>from libcpp.memory cimport shared_ptr\nfrom cython.operator cimport dereference\n\n\ncdef extern from \"mystruct.h\" nogil:\n    cdef cppclass mystruct:\n        int a, b, c, d, e, f, g, h, i, j, k, l, m\n\n    ctypedef vector[v] mystruct_list\n\n\ncdef class MyStruct:\n    cdef shared_ptr[mystruct] ptr\n\n    def __cinit__(MyStruct self):\n        self.ptr.reset(new mystruct)\n\n    property a:\n        def __get__(MyStruct self):\n            return dereference(self.ptr).a\n\n        def __set__(MyStruct self, int value):\n            dereference(self.ptr).a = value\n\n\ncdef class MyStructList:\n    cdef mystruct_list c\n    cdef mystruct_list.iterator it\n\n    def __cinit__(MyStructList self):\n        pass\n\n    def __getitem__(MyStructList self, int index):\n        # How do return MyStruct without copying the underlying `mystruct` \n        pass\n</code></pre>\n\n<p>I see many possible workarounds, and none of them are very satisfactory:</p>\n\n<p>I could initialize an empty <code>MyStruct</code>, and in Cython assign over the shared_ptr. However, this would result in wasting an initalized struct for absolutely no reason.</p>\n\n<pre><code>MyStruct value\nvalue.ptr = self.c.at(index)\nreturn value\n</code></pre>\n\n<p>I also could copy the data from the existing <code>mystruct</code> to the new <code>mystruct</code>. However, this suffers from similar bloat.</p>\n\n<pre><code>MyStruct value\ndereference(value.ptr).a = dereference(self.c.at(index)).a\nreturn value\n</code></pre>\n\n<p>I could also expose a <code>init=True</code> flag for each <code>__cinit__</code> method, which would prevent reconstructing the object internally if the C-object exists already (when init is False). However, this could cause <strong>catastrophic</strong> issues, since it would be exposed to the Python API and would allow dereferencing a null or uninitialized pointer.</p>\n\n<pre><code>def __cinit__(MyStruct self, bint init=True):\n    if init:\n        self.ptr.reset(new mystruct)\n</code></pre>\n\n<p>I could also overload <code>__init__</code> with the Python-exposed constructor (which would reset <code>self.ptr</code>), but this would have risky memory safety if <code>__new__</code> was used from the Python layer.</p>\n\n<p><strong>Bottom-Line</strong></p>\n\n<p>I would love to use Cython, for compilation speed, syntactical sugar, and numerous other reasons, as opposed to the fairly clunky boost::python. I'm looking at pybind11 right now, and it may solve the compilation speed issues, but I would still prefer to use Cython.</p>\n\n<p>Is there any way I can do such a simple task idiomatically in Cython? Thanks.</p>\n"}, {"tags": ["c++", "vector", "reference", "containers", "overhead"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1498078427, "post_id": 44686067, "comment_id": 76356241, "body": "There are no references here, only pointers.  But more importantly, your <code>modify</code> function doesn&#39;t actually do anything useful."}, {"owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1498078498, "post_id": 44686067, "comment_id": 76356283, "body": "@OliverCharlesworth sorry, I corrected my snippet just now"}, {"owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1498078527, "post_id": 44686067, "comment_id": 76356301, "body": "@Fran&#231;oisAndrieux sorry, I corrected my snippet just now"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498078760, "post_id": 44686067, "comment_id": 76356421, "body": "You may want to do some research on the concept of move semantics. It allows you to transfer the value of an object to another compatible object (usually of the same type) with low constant complexity."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1498078841, "post_id": 44686067, "comment_id": 76356469, "body": "There&#39;s probably no &quot;overhead&quot; from doing this via a reference, at least not in the code you have shown."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498080266, "post_id": 44686110, "comment_id": 76357074, "body": "Thinking that might actually be a lot cheaper. Since nothing useful happens, the compiler may be able to optimize the call out."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498080312, "post_id": 44686110, "comment_id": 76357097, "body": "Yeah if the optimization flags are enabled!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1498081193, "post_id": 44686110, "comment_id": 76357436, "body": "Accepting vector by value would change the semantic of the function."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1498081529, "post_id": 44686110, "comment_id": 76357568, "body": "Indeed @SergeyA, updated, thank you! However I though OP was confused and tried to clear that out."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1498081503, "last_edit_date": 1498081503, "creation_date": 1498078493, "answer_id": 44686110, "question_id": 44686067, "link": "https://stackoverflow.com/questions/44686067/what-is-the-overhead-of-this-operation-to-modify-by-reference-in-c/44686110#44686110", "title": "What is the overhead of this operation to modify by reference in C++?", "body": "<p>Yes, this will <em>copy</em> the <em>entire vector</em>, and the complexity is linear in size of <code>second</code>, as stated in the <a href=\"http://www.cplusplus.com/reference/vector/vector/operator=/\" rel=\"nofollow noreferrer\">ref</a>.</p>\n\n<p>What you did avoid by passing a reference as the function parameter is copying <code>first</code> into the parameter <code>i</code>. In other words, if your function was this (passing the vector by value-which would change the semantic of the function):</p>\n\n<pre><code>// more expensive!\nvoid modify(std::vector&lt;int&gt; i) {\n  i = second;\n}\n</code></pre>\n\n<p>then you would pay the cost of copying <code>first</code> to <code>i</code>, plus the cost of copying <code>second</code> to <code>i</code>. Of course in your code, this would make no difference, since <code>i</code> is tiny, but in general it's a good practice to pass large objects by reference, in order to avoid unnecessary copies.</p>\n\n<hr>\n\n<p>Tip: Study move semantics.</p>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 44686110, "answer_count": 1, "score": 1, "last_activity_date": 1498081503, "creation_date": 1498078353, "last_edit_date": 1498078956, "question_id": 44686067, "link": "https://stackoverflow.com/questions/44686067/what-is-the-overhead-of-this-operation-to-modify-by-reference-in-c", "title": "What is the overhead of this operation to modify by reference in C++?", "body": "<p>Let's say there is a large vector called <code>second</code>, and now I want my own vector <code>first</code> to point to the large vector. I wrote this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nstd::vector&lt;int&gt; second (100000,100);\nvoid modify(std::vector&lt;int&gt;&amp; i) {\n  i = second;\n}\nint main ()\n{\n  std::vector&lt;int&gt; first(1, 1); \n  modify(first);    \n  return 0;\n}\n</code></pre>\n\n<p>Is it true that there is an overhead for <code>modify</code> function? Will the content of <code>second</code> to be cloned into a new array and then passed into <code>first</code>, or is it just passed by reference with negligible overhead?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1139, "user_id": 4954434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/820014a12e2c692ff8cd170a33a60141?s=128&d=identicon&r=PG", "display_name": "Jithin Pavithran", "link": "https://stackoverflow.com/users/4954434/jithin-pavithran"}, "edited": false, "score": 0, "creation_date": 1498103645, "post_id": 44685954, "comment_id": 76363249, "body": "Expecting some effort from you. Go through C++ basics."}, {"owner": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "reply_to_user": {"reputation": 1139, "user_id": 4954434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/820014a12e2c692ff8cd170a33a60141?s=128&d=identicon&r=PG", "display_name": "Jithin Pavithran", "link": "https://stackoverflow.com/users/4954434/jithin-pavithran"}, "edited": false, "score": 0, "creation_date": 1498420970, "post_id": 44685954, "comment_id": 76481155, "body": "@JithinPavithran I&#39;ve rethought the whole thing and I&#39;ve realized the whole choose a character thing is unnecessary. However, I&#39;ve found a solution anyway; have a look: <a href=\"https://pastebin.com/LbuZwTK6\" rel=\"nofollow noreferrer\">pastebin.com/LbuZwTK6</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "edited": false, "score": 0, "creation_date": 1498077998, "post_id": 44685967, "comment_id": 76356017, "body": "Alright, that&#39;s better, thanks. However, when I type &#39;r&#39; it just exits. What can I do for that?"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "edited": false, "score": 0, "creation_date": 1498078115, "post_id": 44685967, "comment_id": 76356083, "body": "Fix the logic under <code>case &#39;r&#39;</code>"}, {"owner": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "edited": false, "score": 0, "creation_date": 1498078314, "post_id": 44685967, "comment_id": 76356186, "body": "How, exactly? How am I supposed to make it return to the menu and ask for user input?"}, {"owner": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "edited": false, "score": 0, "creation_date": 1498078439, "post_id": 44685967, "comment_id": 76356253, "body": "more specifically, I want it to break and loop back to the choice menu."}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "edited": false, "score": 0, "creation_date": 1498081715, "post_id": 44685967, "comment_id": 76357635, "body": "Instead of a bunch of functions that take no arguments are don&#39;t return anything (<code>void</code>) you should refactor your code. Have functions return variables (e.g. <code>std::string</code>, <code>bool</code>, as appropriate), then you pass things in and out of functions. It is better to do flow control in this way rather than a bunch of carefully nested loops with <code>break</code>s"}, {"owner": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "edited": false, "score": 0, "creation_date": 1498420986, "post_id": 44685967, "comment_id": 76481161, "body": "I&#39;ve rethought the whole thing and I&#39;ve realized the whole choose a character thing is unnecessary. However, I&#39;ve found a solution anyway; have a look: pastebin.com/LbuZwTK6"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 1, "last_activity_date": 1498077937, "creation_date": 1498077937, "answer_id": 44685967, "question_id": 44685954, "link": "https://stackoverflow.com/questions/44685954/loop-not-doing-its-job/44685967#44685967", "title": "Loop not doing its job", "body": "<p>Your condition should be</p>\n\n<pre><code>while (a != 'e' &amp;&amp; a != 'r')\n</code></pre>\n\n<p>Otherwise it is always <code>true</code> no matter what value of <code>a</code> you enter.</p>\n"}], "owner": {"reputation": 5, "user_id": 8167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91047c359bf87668a58924778d101647?s=128&d=identicon&r=PG&f=1", "display_name": "NNmJYwg", "link": "https://stackoverflow.com/users/8167378/nnmjywg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 44685967, "answer_count": 1, "score": -5, "last_activity_date": 1498078241, "creation_date": 1498077874, "last_edit_date": 1498078241, "question_id": 44685954, "link": "https://stackoverflow.com/questions/44685954/loop-not-doing-its-job", "title": "Loop not doing its job", "body": "<p>Newbie here. Don't be surprised if it's a simple problem.</p>\n\n<p>Here is this snippet of code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;cstdlib&gt;\n\nchar a;\n\nint c = 0;\n\nvoid mva()\n{\n    std::cout &lt;&lt; \"Nothing here yet, move along.\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Press \\\"e\\\" to exit or \\\"r\\\" to return\" &lt;&lt; std::endl;\n}\n\nvoid cho()\n{\n    std::cout &lt;&lt; \"Choose a valid option noob!\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Press \\\"e\\\" to exit or \\\"r\\\" to return\" &lt;&lt; std::endl;\n}\n\nvoid menu()\n{\n    std::cout &lt;&lt; \"Welcome.\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Choose an option\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"1.\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"2. \" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"3.\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"4.\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"5.\" &lt;&lt; std::endl; //5 is exit\n}\nint main()\n{\n    menu();\n    std::cin &gt;&gt; c;\n    switch (c)\n    {\n    case 1:\n        mva();\n        std::cin &gt;&gt; a;\n        while (a != 'e' || a != 'r')\n        {\n            switch (a)\n            {\n                 case 'e':\n                     exit(0);\n                     break;\n\n                 case 'r':\n                     break;\n\n                 default:\n                     cho();\n                     std::cin &gt;&gt; a;\n                     break;\n            }\n        }\n        break;\n    case 5:\n        exit(0);\n        break;\n    default:\n        cho();\n        std::cin &gt;&gt; a;\n        while (a != 'e' || a != 'r') {\n            switch (a)\n            {\n            case 'e':\n                exit(0);\n                break;\n\n            case 'r':\n                break;\n\n            default:\n                cho();\n                std::cin &gt;&gt; a;\n                break;\n            }\n\n        }\n        break;\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>It has the user choose from 5 options. When an option is finished (just printing text for now), the user is supposed to choose 'e' (to exit; this DOES work) or 'r' to return to the menu (which would just print the options and take the user input again). However, pressing 'r' and then enter doesn't print the options again and ask the user for input; it does... nothing? I have no idea how to do this. I suspect I need to implement <code>menu()</code> somewhere, but I don't know where. This problem has been very confusing and I'd appreciate help.</p>\n"}, {"tags": ["c++", "xcode", "git", "version-control", "xcode9-beta"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1498087459, "post_id": 44685727, "comment_id": 76359467, "body": "Why is this tagged for C++ when your problem doesn&#39;t have anything to do the language itself?"}, {"owner": {"reputation": 425, "user_id": 4064263, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Wh3i.jpg?s=128&g=1", "display_name": "Fine Man", "link": "https://stackoverflow.com/users/4064263/fine-man"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1498089176, "post_id": 44685727, "comment_id": 76359911, "body": "@CaptainObvlious -- Correct me if I&#39;m wrong, but I think there wouldn&#39;t be the same issue when using Swift."}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 4064263, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Wh3i.jpg?s=128&g=1", "display_name": "Fine Man", "link": "https://stackoverflow.com/users/4064263/fine-man"}, "edited": false, "score": 0, "creation_date": 1498089228, "post_id": 44687412, "comment_id": 76359924, "body": "Isn&#39;t this via terminal? I&#39;m hoping for a solution regarding Xcode 9."}], "tags": [], "owner": {"reputation": 638, "user_id": 6223051, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59bbca2606da0b4d5ac28a9157b6a5e4?s=128&d=identicon&r=PG&f=1", "display_name": "rowana", "link": "https://stackoverflow.com/users/6223051/rowana"}, "is_accepted": false, "score": 0, "last_activity_date": 1498085294, "creation_date": 1498085294, "answer_id": 44687412, "question_id": 44685727, "link": "https://stackoverflow.com/questions/44685727/xcode-9-initial-commit-so-only-adds-source-files/44687412#44687412", "title": "Xcode 9 Initial Commit so only adds source files", "body": "<p>I think when you are adding files to the repository, you could add only a specific file by specifying the name of the file...</p>\n\n<pre><code>git add file_name\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 425, "user_id": 4064263, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Wh3i.jpg?s=128&g=1", "display_name": "Fine Man", "link": "https://stackoverflow.com/users/4064263/fine-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498085294, "creation_date": 1498076956, "last_edit_date": 1498077296, "question_id": 44685727, "link": "https://stackoverflow.com/questions/44685727/xcode-9-initial-commit-so-only-adds-source-files", "title": "Xcode 9 Initial Commit so only adds source files", "body": "<p>I made a new C++ project, then created a repo, and Xcode 9 automatically creates an Inital Commit.\nAll I want to have in the initial commit is \"main.cpp\". (I managed to get rid of the metadata with Xcode>SourceControl>Git>IgnoredFiles by adding \"*.xcodeproj\".)\nHowever, it added \"._main.cpp\", which is a garbage file that I don't need.</p>\n\n<p><strong>How can I avoid adding this \"._main.cpp\" into git?</strong> \nBetter yet, how can I avoid Xcode creating an Initial Commit, so then I can just select the files to add myself?</p>\n"}, {"tags": ["c++", "standard-library"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 2, "creation_date": 1498077083, "post_id": 44685718, "comment_id": 76355570, "body": "There are some DSPs that just don&#39;t have octects - typically, they can only access memory in some bigger word size -, so you may have 16-bit <code>char</code> and no <code>uint8_t</code> at all. Edit: but re-reading your question  I see that you already excluded this case (you are requiring <code>uint8_t</code>)."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 2, "creation_date": 1498077432, "post_id": 44685718, "comment_id": 76355722, "body": "This <a href=\"https://twitter.com/shafikyaghmour/status/822174071412510720\" rel=\"nofollow noreferrer\">twitter convo</a> and <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=66110#c13\" rel=\"nofollow noreferrer\">gcc bug report comment</a>  may be helpful depending on context"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1498078370, "post_id": 44685718, "comment_id": 76356216, "body": "Why would you not just use <code>unsigned char*</code> to portably access individual bytes?"}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1498079113, "post_id": 44685718, "comment_id": 76356584, "body": "@Brian: Because it is shorter ;). Mainly, because the project I&#39;m working in does it that way."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1498079353, "post_id": 44685718, "comment_id": 76356689, "body": "Also - while still not ideal - I do think the name is better for talking about classig 8 bit bytes (I doubt it would be safe to use my code on a machine where <code>CHAR_BIT != 8</code>)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1498081472, "post_id": 44685718, "comment_id": 76357545, "body": "The answer to such a generic question is &#39;Yes&#39;. Given there are about 8 billion ppl, everything which is physically possible, is likely to exist. :)."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1498081892, "post_id": 44685718, "comment_id": 76357708, "body": "@SergeyA: you got me there. I wanted to add the adjective &quot;relevant&quot;, but would have opened a whole different discussion ;)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1498083004, "post_id": 44685718, "comment_id": 76358144, "body": "I don&#39;t know of any such toolchain. (Should this be an answer or a comment?)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1498083051, "post_id": 44685718, "comment_id": 76358162, "body": "I think it&#39;s a safe practical assumption that if there ever was such a toolchain it would allow uint8_t to alias other types to avoid breaking existing code"}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1498103882, "post_id": 44685718, "comment_id": 76363296, "body": "@user2079303: l was asking about std::uint8_t."}, {"owner": {"reputation": 16565, "user_id": 3235496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ea8f12cc0983b9b878120f7d052e42?s=128&d=identicon&r=PG", "display_name": "manlio", "link": "https://stackoverflow.com/users/3235496/manlio"}, "edited": false, "score": 0, "creation_date": 1498120523, "post_id": 44685718, "comment_id": 76371587, "body": "<a href=\"https://stackoverflow.com/q/16138237/3235496\">stackoverflow.com/q/16138237/3235496</a> is related to the second question. Making <code>uint8_t</code> a special extended integer type, so that it could be optimized more aggressively, is an idea that periodically pops up (I&#39;m sure this was discussed by the GCC team many years ago)... eventually it&#39;s always rejected."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1498126971, "post_id": 44685718, "comment_id": 76376320, "body": "I think I misread part of the question :)"}], "answers": [{"tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1498115251, "creation_date": 1498115251, "answer_id": 44692451, "question_id": 44685718, "link": "https://stackoverflow.com/questions/44685718/underlying-type-for-stduint8-t/44692451#44692451", "title": "Underlying type for std::uint8_t", "body": "<ol>\n<li><code>char</code> is not an <em>unsigned integer type</em>, even if it is, in fact, unsigned. Since <code>uint8_t</code> must be a <em>unsigned integer type</em>, it never can be <code>char</code>.</li>\n<li><code>CHAR_BIT</code> must be at least 8, while the next smallest standard unsigned integer type, <code>unsigned short</code>, must have at least 16 bits. If <code>uint8_t</code> exists, then it must be \"an unsigned integer type with width 8 and no padding bits.\" If <code>uint8_t</code> denotes a <em>standard unsigned integer type</em>, then it can only be <code>unsigned char</code>.</li>\n<li>However, nothing in the wording prevents <code>uint8_t</code> from denoting an implementation-defined <em>extended unsigned integer type</em>. I don't know of any implementations that do this, however.</li>\n</ol>\n"}], "owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1498115251, "creation_date": 1498076936, "last_edit_date": 1498104003, "question_id": 44685718, "link": "https://stackoverflow.com/questions/44685718/underlying-type-for-stduint8-t", "title": "Underlying type for std::uint8_t", "body": "<p><strong>Question</strong>:<br>\nIs there any c++ toolchain, where <code>std::uint8_t</code> exists, but is <strong>not</strong> a typedef for <code>unsigned char</code> (or <code>char</code>, if it is unsigned)? </p>\n\n<p>EDIT: \nConversely: Is such a thing even possible in a standards conforming implementation?</p>\n\n<p><strong>Background / Motivation</strong>:<br>\nI'm mainly asking because I want to know if <code>std::uint8_t*</code> can be used portably to access individual bytes (just like <code>unsigned char*</code>). And yes, I'm aware of <code>std::byte</code>, but thats not relevant here. I'm mainly interested in toolchains for x86, arm and mips, but out of curiosity I'd also like to hear about other examples.</p>\n"}, {"tags": ["c++", "mfc"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "edited": false, "score": 0, "creation_date": 1498078417, "post_id": 44686047, "comment_id": 76356234, "body": "My time zone is UTC-5. and I don&#39;t see the 5hrous time difference between system time and time returned by GetCurrentTime()."}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "edited": false, "score": 1, "creation_date": 1498079001, "post_id": 44686047, "comment_id": 76356540, "body": "@Geek please check your localtime and systime using <code>GetSystemTime</code> and <code>GetLocalTime</code> as in my second example"}, {"owner": {"reputation": 5025, "user_id": 297451, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e6f5424b11b05ad9177ca07bae142f24?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/297451/jon"}, "edited": false, "score": 0, "creation_date": 1587530353, "post_id": 44686047, "comment_id": 108544113, "body": "You don&#39;t need to convert COleDateTime to local time. It already does this in functions like COleDateTime::GetHour()"}], "tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": true, "score": 2, "last_activity_date": 1498078929, "last_edit_date": 1498078929, "creation_date": 1498078284, "answer_id": 44686047, "question_id": 44685681, "link": "https://stackoverflow.com/questions/44685681/getcurrenttime-doesnot-return-correct-time/44686047#44686047", "title": "GetCurrentTime() doesnot return correct time", "body": "<p><code>COleDateTime::GetCurrentTime();</code> is in UTC, so you need to convert it to your localtime, see <a href=\"http://forums.codeguru.com/showthread.php?298477-COleDateTime-and-conversion-from-UTC-to-local-time\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>COleDateTime dt;  // yor UTC time\n..........\nTIME_ZONE_INFORMATION timeZoneInformation;\nDWORD dwTZ = GetTimeZoneInformation(&amp;timeZoneInformation);\nif(dwTZ == TIME_ZONE_ID_STANDARD || dwTZ == TIME_ZONE_ID_DAYLIGHT)\n{\n    SYSTEMTIME timeUTC \n    dt.GetAsSystemTime(&amp;timeUTC);\n    SYSTEMTIME timeLocal;\n    SystemTimeToTzSpecificLocalTime(&amp;timeZoneInformation, &amp;timeUTC, &amp;timeLocal);\n    dt = COleDateTime(&amp;timeLocal);\n}\nelse\n{\n    //error handling\n}\n</code></pre>\n\n<p>Also you can check this using the following <a href=\"https://msdn.microsoft.com/en-us/library/ms724950(v=vs.120).aspx\" rel=\"nofollow noreferrer\">program</a>:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid main()\n{\n    SYSTEMTIME st, lt;\n\n    GetSystemTime(&amp;st);\n    GetLocalTime(&amp;lt);\n\n    printf(\"The system time is: %02d:%02d\\n\", st.wHour, st.wMinute);\n    printf(\" The local time is: %02d:%02d\\n\", lt.wHour, lt.wMinute);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 0, "creation_date": 1608362520, "post_id": 65367514, "comment_id": 115565441, "body": "You are quoting the wrong documentation. The question is about the MFC <a href=\"https://docs.microsoft.com/en-us/cpp/atl-mfc-shared/reference/coledatetime-class?view=msvc-160#getcurrenttime\" rel=\"nofollow noreferrer\">COleDateTime::GetCurrentTime</a>, which is not based on <code>GetTickCount</code>."}, {"owner": {"reputation": 67, "user_id": 6801759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ac6e7dc98fbd5cabc9ee25dd83c36d?s=128&d=identicon&r=PG&f=1", "display_name": "user6801759", "link": "https://stackoverflow.com/users/6801759/user6801759"}, "reply_to_user": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 0, "creation_date": 1608381157, "post_id": 65367514, "comment_id": 115569263, "body": "I guess you are correct. Let it as note to another one who got confused as I am."}], "tags": [], "owner": {"reputation": 67, "user_id": 6801759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ac6e7dc98fbd5cabc9ee25dd83c36d?s=128&d=identicon&r=PG&f=1", "display_name": "user6801759", "link": "https://stackoverflow.com/users/6801759/user6801759"}, "is_accepted": false, "score": 0, "last_activity_date": 1608361857, "creation_date": 1608361857, "answer_id": 65367514, "question_id": 44685681, "link": "https://stackoverflow.com/questions/44685681/getcurrenttime-doesnot-return-correct-time/65367514#65367514", "title": "GetCurrentTime() doesnot return correct time", "body": "<p>Short answer: GetCurrentTime is NOT returning current time, it's identical with GetTickCount, returning time in milliseconds since the windows has started (basically: uptime).</p>\n<p>From Windows' Help File:</p>\n<p>The GetCurrentTime is obsolete. This function is provided only for compatibility with 16-bit versions of Windows. Win32-based applications should use the GetTickCount function or look up the System Up Time counter in the performance data in the registry key HKEY_PERFORMANCE_DATA.</p>\n<p>DWORD GetTickCount(VOID)</p>\n<p>The GetTickCount function retrieves the number of milliseconds that have elapsed since Windows was started.</p>\n<p>The elapsed time is stored as a DWORD value. Therefore, the time will wrap around to zero if Windows is run continuously for 49.7 days</p>\n<p>WINNT 0x0600 and later should use GetTickCount64 instead</p>\n"}], "owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 1, "accepted_answer_id": 44686047, "answer_count": 2, "score": 0, "last_activity_date": 1608361857, "creation_date": 1498076809, "question_id": 44685681, "link": "https://stackoverflow.com/questions/44685681/getcurrenttime-doesnot-return-correct-time", "title": "GetCurrentTime() doesnot return correct time", "body": "<p>I am using below api in my code</p>\n\n<pre><code>COleDateTime  timeStamp = COleDateTime::GetCurrentTime();\n</code></pre>\n\n<p>And it is giving incorrect value</p>\n\n<p>When system time was 12:36:08 this was returning 03:36:08.</p>\n\n<p>I checked my system time setting and it is using US regional settings.</p>\n\n<p>Had anyone experienced similar behavior?</p>\n"}, {"tags": ["c++", "sockets", "server"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498079471, "post_id": 44685665, "comment_id": 76356746, "body": "What is the problem? Can&#39;t exit because the program is blocked on the <code>select</code> or is this purely polling for opinions on best pracittices?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1498087736, "post_id": 44685665, "comment_id": 76359550, "body": "<code>close(masterSocket); exit(0);</code> Unclear what you&#39;re asking."}], "answers": [{"tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": true, "score": 1, "last_activity_date": 1498087054, "last_edit_date": 1498087054, "creation_date": 1498086622, "answer_id": 44687602, "question_id": 44685665, "link": "https://stackoverflow.com/questions/44685665/closing-master-socket-from-server-side/44687602#44687602", "title": "Closing master socket from server side", "body": "<p>If you are planning to exit your application gracefully by adding a <code>break</code>statement in your app by something <em>similar</em> to this:</p>\n\n<pre><code>if (exit_condition)\n{\n    break;\n}\n</code></pre>\n\n<p>You can place this loop at the end of your main function:</p>\n\n<pre><code>  /* close connections gracefully */\n    closesocket(masterSocket);\n    masterSocket = 0;                 /* optional, see comment below */\n    for(int i = 0; i &lt; maxClients; i++)\n    {\n        if (clientSockets[i] != 0)\n        {\n            shutdown(clientSockets[i]);\n            closesocket(clientSockets[i]);\n            clientSockets[i] = 0;     /* optional, except if you also have a SIGINT handler */\n        }\n    }\n</code></pre>\n\n<p>If you want to do the same to handle an exit with Ctrl-C, you will find details on how to setup a SIGINT handler to handle Ctr-C here:\n<a href=\"https://stackoverflow.com/questions/4217037/catch-ctrl-c-in-c\">Catch Ctrl-C in C</a>.  Place the above loop in your handler, then.  Your sockets-related variables will have to be declared at global scope, since your sockets are only visible from main() in your current code.</p>\n"}], "owner": {"reputation": 22, "user_id": 8012258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea65db081214ee5cad6008f42d72fd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Olsson", "link": "https://stackoverflow.com/users/8012258/adam-olsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 44687602, "answer_count": 1, "score": -1, "last_activity_date": 1498087054, "creation_date": 1498076758, "question_id": 44685665, "link": "https://stackoverflow.com/questions/44685665/closing-master-socket-from-server-side", "title": "Closing master socket from server side", "body": "<p>So I'm writing a very basic TCP server which just echoes back the messages sent from the client back to the client. I have a setup where the server is running in a while loop and waiting for either a new client to connect or for a message from one of the existing clients using the select() method. \nMy question is:\nHow do i, from the server side, close the master socket and basically shutting down the server. Im not asking for exact code but more for standard practice.</p>\n\n<p>For some context:\nIn the long run I am imagining multiple clients connected to my server and I need to shutdown the server gracefully from the server side.</p>\n\n<p>Even more context: The server code.</p>\n\n<pre><code>#define TRUE 1\n#define FALSE 0\n#define PORT 55555\n\nint main(int argc, char* argv[])\n{\n    int opt = TRUE;\n    int masterSocket, addrlen, newSocket, maxClients = 10, clientSockets[maxClients], \n        activity, valread, sd, maxSd;\n    struct sockaddr_in address;\n    char buffer[1025];\n\n    fd_set readfds;\n\n    const char *message = \"ECHO DAMON v1.0 \\r\\n\";\n\n    /* Initialize array with 0 so it's not read */\n    for(int i = 0; i &lt; maxClients ; i++)\n    {\n        clientSockets[i] = 0;\n    }\n\n    /* Create master socket */\n    if((masterSocket = socket(AF_INET, SOCK_STREAM,0)) == 0)\n    {\n        perror(\"Error when trying to create master socket.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    /* Set master socket to allow multiple connections */\n    if( setsockopt(masterSocket, SOL_SOCKET, SO_REUSEADDR, (char*)&amp;opt, sizeof(opt)) &lt; 0)\n    {\n        perror(\"Could not set sockopt\");\n        exit(EXIT_FAILURE);\n    }\n\n    /* Socket type */\n    address.sin_family = AF_INET;\n    address.sin_addr.s_addr = INADDR_ANY;\n    address.sin_port = htons(PORT);\n\n    if( bind(masterSocket, (struct sockaddr*)&amp;address, sizeof(address)) &lt; 0)\n    {\n        perror(\"Error, could not bind master socket. \\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Listening on %d. \\n\", PORT);\n\n    if( listen(masterSocket, 3) &lt; 0)\n    {\n        perror(\"Error, could not listen.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    addrlen = sizeof(address);\n    puts(\"Waiting for connections...\\n\"); //just a printf variant\n\n    /* END INIT */\n\n    while(TRUE)\n    {\n        /* Clear socket set */\n        FD_ZERO(&amp;readfds);\n        /* Add master socket to set */\n        FD_SET(masterSocket, &amp;readfds);\n\n        /* Add child sockets to set, will be 0 first iteration */\n        for(int i = 0; i &lt; maxClients ; i++)\n        {\n            sd = clientSockets[i]; // sd = socket descriptor\n            /* If valid socket descriptor */\n            if(sd &gt; 0)\n            {\n                FD_SET(sd, &amp;readfds);\n            }\n            /* Get highest fd number, needed for the select function (later) */\n            if(sd &gt; maxSd)\n            {\n                maxSd = sd;\n            }\n        }//end for-loop\n\n        /* Wait for activity on any socket */\n        activity = select(maxSd +1, &amp;readfds, NULL, NULL, NULL);\n\n        if((activity &lt; 0) &amp;&amp; (errno != EINTR))\n        {\n            printf(\"Error on select.\\n\"); //no need for exit.\n        }\n\n        /* If the bit for the file descriptor fd is set in the \n        file descriptor set pointed to by fdset */\n        /* If something happend in the master socket, its a new connection */\n        if(FD_ISSET(masterSocket, &amp;readfds))\n        {\n            if((newSocket = accept(masterSocket, (struct sockaddr*)&amp;address, (socklen_t*)&amp;addrlen)) &lt; 0)\n            {\n                perror(\"Could not accept new socket.\\n\");\n                exit(EXIT_FAILURE);\n            }\n            /* Print info about connector */\n            printf(\"New connection, socket fd is %d, ip is: %s, port: %d\\n\", newSocket, inet_ntoa(address.sin_addr), ntohs(address.sin_port));\n\n            if( send(newSocket, message, strlen(message), 0) != strlen(message))\n            {\n                perror(\"Could not sent welcome message to new socket.\\n\");\n            }\n\n            puts(\"Welcome message sen successfully.\\n\");\n\n            /* Add new socket to array of clients */\n            for(int i = 0; i &lt; maxClients; i++)\n            {\n                if(clientSockets[i] == 0)\n                {\n                    clientSockets[i] = newSocket;\n                    printf(\"Adding socket to list of client at index %d\\n\", i);\n                    break;\n                }\n            }\n        }//end masterSocket if\n\n        /* Else something happend at client side */\n        for(int i = 0; i &lt; maxClients; i++)\n        {\n            sd = clientSockets[i];\n\n            if(FD_ISSET(sd, &amp;readfds))\n            {   /* Read socket, if it was closing, else read value */\n                if((valread = read( sd, buffer, 1024)) == 0)\n                {\n                    getpeername( sd, (struct sockaddr*)&amp;address, (socklen_t*)&amp;addrlen);\n                    printf(\"Host disconnected, ip %s, port %d.\\n\", inet_ntoa(address.sin_addr), ntohs(address.sin_port));\n\n                    close(sd);\n                    clientSockets[i] = 0;\n                }\n            }\n            else\n            {\n                buffer[valread] = '\\0';\n                send(sd, buffer, strlen(buffer), 0);\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "gcc", "openmp", "gpgpu", "offloading"], "comments": [{"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1498079020, "post_id": 44685568, "comment_id": 76356546, "body": "Can you upload a minimum working example showing what you are trying to do?"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1498080354, "post_id": 44685568, "comment_id": 76357119, "body": "Welcome to Stack Overflow! Your post is unfortunately missing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Please visit the <a href=\"http://stackoverflow.com/help\">help center</a> and read the section <a href=\"http://stackoverflow.com/help/how-to-ask\">how do I ask a good question</a>."}, {"owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498082115, "post_id": 44685568, "comment_id": 76357790, "body": "I added my testing code."}, {"owner": {"reputation": 627, "user_id": 1566099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd78f0484d050f006b916d4aba2ad95?s=128&d=identicon&r=PG", "display_name": "Ilya Verbin", "link": "https://stackoverflow.com/users/1566099/ilya-verbin"}, "edited": false, "score": 0, "creation_date": 1498138101, "post_id": 44685568, "comment_id": 76384402, "body": "Where did you get the <code>-omptargets=</code> from? It&#39;s a clang&#39;s option, not gcc&#39;s."}, {"owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498138692, "post_id": 44685568, "comment_id": 76384854, "body": "I have tried using clang as well to get this working, so that&#39;s probably where I came up with the <code>-omptargets=</code>. I can remove it, but removing it does not change my ability to connect to the GPU."}, {"owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498139161, "post_id": 44685568, "comment_id": 76385255, "body": "@Shadow The goal of this code is not performance or functionality, but to prove that I am using the GPUs. I&#39;ve come across the presentation you linked in your comment before, so I have been using <code>omp_get_num_devices()</code> as my primary test to see that I can detect the GPUs. Aside from that, I am intentionally killing performance to attempt to exaggerate the difference between the (supposedly) offloaded calculation and the other one. The only purpose of dummyvar is to ensure that the code isn&#39;t optimized away by the compiler. I don&#39;t even care what the output is."}, {"owner": {"reputation": 725, "user_id": 7968757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febedd8312ee6b7f6559b765f27da3e6?s=128&d=identicon&r=PG&f=1", "display_name": "BlameTheBits", "link": "https://stackoverflow.com/users/7968757/blamethebits"}, "edited": false, "score": 0, "creation_date": 1498139396, "post_id": 44685568, "comment_id": 76385466, "body": "Ah, now I understand what your problem is. I was thinking in the wrong direction. So you are mainly complaining about that <code>omp_get_num_devices()</code> never returns <code>1</code>? Then why don&#39;t make your code really minimal with just that simple call? If that&#39;s working you should be able to do the rest on your own."}, {"owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498140668, "post_id": 44685568, "comment_id": 76386500, "body": "Hopefully the statement I changed made it more clear now."}, {"owner": {"reputation": 627, "user_id": 1566099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd78f0484d050f006b916d4aba2ad95?s=128&d=identicon&r=PG", "display_name": "Ilya Verbin", "link": "https://stackoverflow.com/users/1566099/ilya-verbin"}, "edited": false, "score": 1, "creation_date": 1498143886, "post_id": 44685568, "comment_id": 76389150, "body": "I guess your GCC doesn&#39;t support offloading to GPU. Actually this feature requires 2 different GCCs installed (gcc targeting host and gcc targeting gpu). I&#39;m not sure whether there are such packages in your distro, I&#39;d prefer to build both from sources as described <a href=\"https://gist.github.com/kristerw/4e9a735f2d755ffa73f9bf27edbf3c29\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 370, "user_id": 8038786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bbc15ced990d16d2a9963f4c4a840b?s=128&d=identicon&r=PG&f=1", "display_name": "M. Chinoune", "link": "https://stackoverflow.com/users/8038786/m-chinoune"}, "edited": false, "score": 0, "creation_date": 1498496676, "post_id": 44685568, "comment_id": 76510820, "body": "That should be an answer"}], "answers": [{"comments": [{"owner": {"reputation": 681, "user_id": 4575505, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204940618347955/picture?type=large", "display_name": "Thecave3", "link": "https://stackoverflow.com/users/4575505/thecave3"}, "edited": false, "score": 0, "creation_date": 1498087238, "post_id": 44687295, "comment_id": 76359408, "body": "Why don&#39;t you provide a link reference? It sounds a good answer and with that it&#39;ll sounds even better"}, {"owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498138101, "post_id": 44687295, "comment_id": 76384400, "body": "I will add the results of running the deviceQuery sample CUDA code."}, {"owner": {"reputation": 64, "user_id": 3518406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5921623bacc2982ded4ab467f986f89b?s=128&d=identicon&r=PG&f=1", "display_name": "Clark Lee", "link": "https://stackoverflow.com/users/3518406/clark-lee"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1498155043, "post_id": 44687295, "comment_id": 76395999, "body": "@MarkSetchell  Thx. I didn&#39;t know AMD GPU also need this."}], "tags": [], "owner": {"reputation": 64, "user_id": 3518406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5921623bacc2982ded4ab467f986f89b?s=128&d=identicon&r=PG&f=1", "display_name": "Clark Lee", "link": "https://stackoverflow.com/users/3518406/clark-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1498155535, "last_edit_date": 1498155535, "creation_date": 1498084467, "answer_id": 44687295, "question_id": 44685568, "link": "https://stackoverflow.com/questions/44685568/how-do-i-use-the-gpu-available-with-openmp/44687295#44687295", "title": "How do I use the GPU available with OpenMP?", "body": "<p>Maybe I'm in a wrong direction. but I want to help, </p>\n\n<p>since I've ever in a weird situation using GPU.</p>\n\n<p>You need to be in the \"video\" group of linux, so you can using GPU.</p>\n\n<p>or all the results returned from GPU will be 0. </p>\n\n<p>So I would advise you run a sample CUDA code to check if you are in the situation I used to be stuck.</p>\n\n<p>It's weird. I'm not sure I describe it properly. \nhope it helps. </p>\n\n<hr>\n\n<p>according to this: <a href=\"https://wiki.gentoo.org/wiki/NVidia/nvidia-drivers\" rel=\"nofollow noreferrer\">https://wiki.gentoo.org/wiki/NVidia/nvidia-drivers</a></p>\n\n<blockquote>\n  <p>The user(s) needing to access the video card will need to be added to\n  the video group</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498150913, "post_id": 44702869, "comment_id": 76393785, "body": "I tried to profile it with <code>nvprof</code> as you suggested. After the program completes its execution, I receive an error <code>======== Warning: No CUDA application was profiled, exiting</code>. When I add in <code>omp_is_initial_device()</code>, it returns a 1 each time."}, {"owner": {"reputation": 81, "user_id": 7979812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b1a07ee6ae1e727ec347c6719c24ac?s=128&d=identicon&r=PG&f=1", "display_name": "Arpith Jacob", "link": "https://stackoverflow.com/users/7979812/arpith-jacob"}, "reply_to_user": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "edited": false, "score": 0, "creation_date": 1498154056, "post_id": 44702869, "comment_id": 76395464, "body": "This seems to strongly suggest that your kernel is running on the CPU.  As  Ilya mentioned, you probably need to compile gcc with gpu support."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1520595377, "post_id": 44702869, "comment_id": 85390431, "body": "Why do you need to use an array of one element rather than just a simple integer? I tried your code and it only works with an array but I don&#39;t understand why."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1520601227, "post_id": 44702869, "comment_id": 85393848, "body": "I figured it out. Scalar values default to <code>firstprivate</code>. So the pointer is effectively shared. <code>#pragma omp target defaultmap(tofrom:scalar)</code> lets scalars be shared."}], "tags": [], "owner": {"reputation": 81, "user_id": 7979812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b1a07ee6ae1e727ec347c6719c24ac?s=128&d=identicon&r=PG&f=1", "display_name": "Arpith Jacob", "link": "https://stackoverflow.com/users/7979812/arpith-jacob"}, "is_accepted": false, "score": 3, "last_activity_date": 1498143183, "creation_date": 1498143183, "answer_id": 44702869, "question_id": 44685568, "link": "https://stackoverflow.com/questions/44685568/how-do-i-use-the-gpu-available-with-openmp/44702869#44702869", "title": "How do I use the GPU available with OpenMP?", "body": "<p>I may be wrong, but I think you need a few corrections to the code as posted (maybe you already know it).  To actually run on the GPU target with OpenMP you need to replace:</p>\n\n<pre><code>#pragma omp for collapse(4) private(i, j, k, l)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>#pragma omp target teams distribute parallel for collapse(4) private(i, j, k, l)\n</code></pre>\n\n<p>You can verify if the kernel is actually running on the GPU by profiling your executable with 'nvprof'.  It should show a kernel executing on the GPU.  You can also change the number of teams and threads in your target region using the 'num_teams' and 'thread_limit' clauses and you should see corresponding changes in your profile.</p>\n\n<p>To actually check programmatically if a target region is running on a target device I use the 'omp_is_initial_device()' call, which returns 0 when called from the accelerator.  Here's an example:</p>\n\n<pre><code>int A[1] = {-1};\n#pragma omp target\n{\n  A[0] = omp_is_initial_device();\n}\n\nif (!A[0]) {\n  printf(\"Able to use offloading!\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 1566099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd78f0484d050f006b916d4aba2ad95?s=128&d=identicon&r=PG", "display_name": "Ilya Verbin", "link": "https://stackoverflow.com/users/1566099/ilya-verbin"}, "is_accepted": true, "score": 3, "last_activity_date": 1498600341, "creation_date": 1498600341, "answer_id": 44790553, "question_id": 44685568, "link": "https://stackoverflow.com/questions/44685568/how-do-i-use-the-gpu-available-with-openmp/44790553#44790553", "title": "How do I use the GPU available with OpenMP?", "body": "<p>GCC 4.9.3 and 5.1.0 definitely do not support OpenMP offloading to GPU.\nGCC 7.1.0 does support it, however it should be built with special configure options, <a href=\"https://kristerw.blogspot.ru/2017/04/building-gcc-with-support-for-nvidia.html\" rel=\"nofollow noreferrer\">as described here</a>.</p>\n"}], "owner": {"reputation": 53, "user_id": 8121744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f247fce2bb630e41b73f0ea901022e2?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah", "link": "https://stackoverflow.com/users/8121744/josiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6476, "favorite_count": 1, "accepted_answer_id": 44790553, "answer_count": 3, "score": 5, "last_activity_date": 1498600341, "creation_date": 1498076376, "last_edit_date": 1498162728, "question_id": 44685568, "link": "https://stackoverflow.com/questions/44685568/how-do-i-use-the-gpu-available-with-openmp", "title": "How do I use the GPU available with OpenMP?", "body": "<p>I am trying to get some code to run on the GPU using OpenMP, but I am not succeeding. In my code, I am performing a matrix multiplication using <code>for</code> loops: once using OpenMP pragma tags and once without. (This is so that I can compare the execution time.) After the first loop I call <code>omp_get_num_devices()</code> (this is my main test to see if I'm actually connecting to a GPU.) No matter what I try, <strong><code>omp_get_num_devices()</code> always returns 0.</strong> </p>\n\n<p>The computer I am using has two <strong>NVIDIA Tesla K40M GPUs</strong>. CUDA 7.0 and CUDA 7.5 are available on the computer as modules, and the CUDA 7.5 module is typically active. gcc 4.9.3, 5.1.0, and 7.1.0 are all available as modules, with gcc 7.1.0 module typically active. I am compiling my code with <code>$ g++ -fopenmp -omptargets=nvptx64sm_35-nvidia-linux ParallelExperimenting.cpp -o ParallelExperimenting</code>. I've had OpenMP code successfully parallelized using the CPU, but not with GPUs. </p>\n\n<p><strong>My main goal here is to get <code>omp_get_num_devices()</code> to return 2 as proof that I can detect and use the GPUs with OpenMP.</strong> Any help I recieve here would be greatly appreciated.</p>\n\n<p>Here is the code I am using to check if the GPU is being used correctly or not:</p>\n\n<pre><code>#include &lt;omp.h&gt;\n#include &lt;fstream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;iomanip&gt;\n#include &lt;cstdio&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;iostream&gt;\n#include &lt;time.h&gt;\nusing namespace std;\n\ndouble A [501][501];\ndouble B [501][501];\ndouble C [501][501][501];\ndouble D [501][501];\ndouble E [501][501];\ndouble F [501][501][501];\ndouble dummyvar;\nint Mapped [501];\n\nint main() {\n    int i, j, k, l, N, StallerGPU, StallerCPU;\n\n    //\n    N = 500;\n\n    // Variables merely uses to make the execution take longer and to\n    //   exaggurate the difference in performance between first and second\n    //   calculation\n    StallerGPU = 200;\n    StallerCPU = 200;\n\n    std::cout &lt;&lt; \" N = \" &lt;&lt; N &lt;&lt; \"\\n\";\n    // generate matrix to be used in first calculation\n    for (i=0; i&lt;N; i++) {\n        for (k=0; k&lt;N; k++) {\n            if (i == k) {\n                A[i][k] = i+1;\n            } else {\n                A[i][k] = i * k / N;\n            }\n        }\n    }\n    // generate other matrix to be used for the first calculation\n    for (k=0; k&lt;N; k++) {\n        for (j=0; j&lt;N; j++) {\n            B[k][j] = 2*(N-1)-k-j;\n        }\n    }\n\n//    Slightly adjusted matrices for second calculation\n    for (i=0; i&lt;N; i++) {\n        for (k=0; k&lt;N; k++) {\n            if (i == k) {\n                D[i][k] = i+2;\n            } else {\n                D[i][k] = i * k / N - 1;\n            }\n        }\n    }\n\n    for (k=0; k&lt;N; k++) {\n        for (j=0; j&lt;N; j++) {\n            E[k][j] = 2*(N+1)-k-j;\n        }\n    }\n\n    dummyvar = 0;\n\n    //Run the multiplication in parallel using GPUs\n\n    double diff;\n    time_t time1;\n    time1 = time( NULL ); // CPU time counter\n    cout &lt;&lt; endl &lt;&lt; \" GPU section begins at \" &lt;&lt; ctime(&amp;time1) &lt;&lt; endl;\n\n        //    This pragma is frequently changed to try different tags\n        #pragma omp for collapse(4) private(i, j, k, l)\n\n        for (i=0; i&lt;N; i++) {\n//            Mapped[i] = omp_is_initial_device();\n            for (j=0; j&lt;N; j++) {\n                for (k=0; k&lt;N; k++) {\n                    for(l = 0; l &lt; StallerGPU; l++ ) {\n                        C[i][j][k] = A[i][k] * B[k][j] ;\n                        dummyvar += A[i][k] * B[k][j] * (l + 1);\n                    }\n                }\n//            cout &lt;&lt; \" i \" &lt;&lt; i &lt;&lt; endl;\n            }\n        }\n\n\n    //record the time it took to run the multiplication    \n    time_t time2 = time( NULL );\n    cout &lt;&lt; \" number of devices: \" &lt;&lt; omp_get_num_devices() &lt;&lt; endl;\n    cout &lt;&lt; \" dummy variable: \" &lt;&lt; dummyvar &lt;&lt; endl;\n\n    float cpumin = difftime(time2,time1);\n    diff = difftime(time2,time1);\n    cout &lt;&lt; \" stopping at delta GPU time: \" &lt;&lt; cpumin &lt;&lt; endl; \n    cout &lt;&lt; \" terminating at \" &lt;&lt; ctime(&amp;time2) &lt;&lt; endl;\n    cout &lt;&lt; \" GPU time elasped \" &lt;&lt; diff &lt;&lt; \" s\" &lt;&lt; endl;\n    cout &lt;&lt; endl;\n\n    dummyvar = 0;\n    time_t time3 = time( NULL );\n    cout &lt;&lt; endl &lt;&lt; \" CPU section begins at \" &lt;&lt; ctime(&amp;time3) &lt;&lt; endl;\n//    #pragma omp single\n    for (i=0; i&lt;N; i++) {\n        for (j=0; j&lt;N; j++) {\n            for (k=0; k&lt;N; k++) {\n                for (int l=0; l&lt;StallerCPU; l++) {\n                    F[i][j][k] = D[i][k] * E[k][j];\n                    dummyvar += D[i][k] * E[k][j] * (l - 1);\n                }\n            }\n        }\n    }\n    // the sum to complete the matrix calculation is left out here, but would\n    // only be used to check if the result of the calculation is correct\n\n    time_t time4 = time( NULL );\n    cpumin = difftime(time4,time3);\n    diff = difftime(time4,time3);\n    cout &lt;&lt; \" dummy variable: \" &lt;&lt; dummyvar &lt;&lt; endl;\n    cout &lt;&lt; \" stopping at delta CPU time: \" &lt;&lt; cpumin &lt;&lt; endl; \n    cout &lt;&lt; \" terminating at \" &lt;&lt; ctime(&amp;time4) &lt;&lt; endl;\n    cout &lt;&lt; \" CPU time elasped \" &lt;&lt; diff &lt;&lt; \" s\" &lt;&lt; endl;\n    //Compare the time it took to confirm that we actually used GPUs to parallelize.\n}\n</code></pre>\n\n<p>Here is the result of running the deviceQuery sample CUDA code.</p>\n\n<pre><code>./deviceQuery Starting...\n\n CUDA Device Query (Runtime API) version (CUDART static linking)\n\nDetected 2 CUDA Capable device(s)\n\nDevice 0: \"Tesla K40m\"\n  CUDA Driver Version / Runtime Version          7.5 / 7.5\n  CUDA Capability Major/Minor version number:    3.5\n  Total amount of global memory:                 11520 MBytes (12079136768 bytes)\n  (15) Multiprocessors, (192) CUDA Cores/MP:     2880 CUDA Cores\n  GPU Max Clock rate:                            745 MHz (0.75 GHz)\n  Memory Clock rate:                             3004 Mhz\n  Memory Bus Width:                              384-bit\n  L2 Cache Size:                                 1572864 bytes\n  Maximum Texture Dimension Size (x,y,z)         1D=(65536), 2D=(65536, 65536), 3D=(4096, 4096, 4096)\n  Maximum Layered 1D Texture Size, (num) layers  1D=(16384), 2048 layers\n  Maximum Layered 2D Texture Size, (num) layers  2D=(16384, 16384), 2048 layers\n  Total amount of constant memory:               65536 bytes\n  Total amount of shared memory per block:       49152 bytes\n  Total number of registers available per block: 65536\n  Warp size:                                     32\n  Maximum number of threads per multiprocessor:  2048\n  Maximum number of threads per block:           1024\n  Max dimension size of a thread block (x,y,z): (1024, 1024, 64)\n  Max dimension size of a grid size    (x,y,z): (2147483647, 65535, 65535)\n  Maximum memory pitch:                          2147483647 bytes\n  Texture alignment:                             512 bytes\n  Concurrent copy and kernel execution:          Yes with 2 copy engine(s)\n  Run time limit on kernels:                     No\n  Integrated GPU sharing Host Memory:            No\n  Support host page-locked memory mapping:       Yes\n  Alignment requirement for Surfaces:            Yes\n  Device has ECC support:                        Enabled\n  Device supports Unified Addressing (UVA):      Yes\n  Device PCI Domain ID / Bus ID / location ID:   0 / 130 / 0\n  Compute Mode:\n     &lt; Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) &gt;\n\nDevice 1: \"Tesla K40m\"\n  CUDA Driver Version / Runtime Version          7.5 / 7.5\n  CUDA Capability Major/Minor version number:    3.5\n  Total amount of global memory:                 11520 MBytes (12079136768 bytes)\n  (15) Multiprocessors, (192) CUDA Cores/MP:     2880 CUDA Cores\n  GPU Max Clock rate:                            745 MHz (0.75 GHz)\n  Memory Clock rate:                             3004 Mhz\n  Memory Bus Width:                              384-bit\n  L2 Cache Size:                                 1572864 bytes\n  Maximum Texture Dimension Size (x,y,z)         1D=(65536), 2D=(65536, 65536), 3D=(4096, 4096, 4096)\n  Maximum Layered 1D Texture Size, (num) layers  1D=(16384), 2048 layers\n  Maximum Layered 2D Texture Size, (num) layers  2D=(16384, 16384), 2048 layers\n  Total amount of constant memory:               65536 bytes\n  Total amount of shared memory per block:       49152 bytes\n  Total number of registers available per block: 65536\n  Warp size:                                     32\n  Maximum number of threads per multiprocessor:  2048\n  Maximum number of threads per block:           1024\n  Max dimension size of a thread block (x,y,z): (1024, 1024, 64)\n  Max dimension size of a grid size    (x,y,z): (2147483647, 65535, 65535)\n  Maximum memory pitch:                          2147483647 bytes\n  Texture alignment:                             512 bytes\n  Concurrent copy and kernel execution:          Yes with 2 copy engine(s)\n  Run time limit on kernels:                     No\n  Integrated GPU sharing Host Memory:            No\n  Support host page-locked memory mapping:       Yes\n  Alignment requirement for Surfaces:            Yes\n  Device has ECC support:                        Enabled\n  Device supports Unified Addressing (UVA):      Yes\n  Device PCI Domain ID / Bus ID / location ID:   0 / 131 / 0\n  Compute Mode:\n     &lt; Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) &gt;\n&gt; Peer access from Tesla K40m (GPU0) -&gt; Tesla K40m (GPU1) : Yes\n&gt; Peer access from Tesla K40m (GPU1) -&gt; Tesla K40m (GPU0) : Yes\n\ndeviceQuery, CUDA Driver = CUDART, CUDA Driver Version = 7.5, CUDA Runtime Version = 7.5, NumDevs = 2, Device0 = Tesla K40m, Device1 = Tesla K40m\nResult = PASS\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "c++11", "atomic", "stdatomic"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 2, "creation_date": 1498081088, "post_id": 44685403, "comment_id": 76357396, "body": "&quot;it appears my code is spending a fair amount of time in <code>std::atomic_bool::operator bool</code>&quot; Are you compiling with optimizations on? That thing should be fully inlined."}], "answers": [{"comments": [{"owner": {"reputation": 2043, "user_id": 1053577, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/504273631/picture?type=large", "display_name": "John S", "link": "https://stackoverflow.com/users/1053577/john-s"}, "edited": false, "score": 0, "creation_date": 1498077461, "post_id": 44685689, "comment_id": 76355736, "body": "Thank you for the detailed answer! Much appreciated."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1498080089, "post_id": 44685689, "comment_id": 76357009, "body": "@ShadowRanger  About your statement (<i>x86 is strongly ordered, so once the write finishes, the next read will see it</i>).. That&#39;s not entirely accurate because <code>X86</code> does not prevent #StoreLoad reordering by default.. If you need that guarantee, a full fence (or <code>xchg</code>) is required."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1498081243, "post_id": 44685689, "comment_id": 76357457, "body": "On typical x86 implementations, there&#39;s no performance difference between a SC load and a non-SC load. The only difference is in the store, which only happens once in this code."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1498084264, "post_id": 44685689, "comment_id": 76358572, "body": "+1 for the correct answer, but probably worth mentioning that sequential consistency is much easier to reason about, so best advice is to go for that until the customers are bitching about performance and profiling confirms that it&#39;s the fault of memory fences (it won&#39;t be)."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1498090470, "post_id": 44685689, "comment_id": 76360192, "body": "@RichardHodges: True, it&#39;s harder to get it wrong with sequential consistency. I suspect in this case even relaxed ordering would work, but my paranoia makes me use <code>release</code>/<code>acquire</code> semantics just in case there is really data that must be visible from the parent thread during the shutdown process. I agree it&#39;s highly unlikely to be a performance issue; unless the loop is nigh empty, the cost of a full memory fence is likely to be small in the context of any real work."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 15, "last_activity_date": 1498078821, "last_edit_date": 1498078821, "creation_date": 1498076849, "answer_id": 44685689, "question_id": 44685403, "link": "https://stackoverflow.com/questions/44685403/do-i-need-stdatomicbool-or-is-pod-bool-good-enough/44685689#44685689", "title": "Do I need std::atomic&lt;bool&gt; or is POD bool good enough?", "body": "<p>You need to use <code>std::atomic</code> to avoid undesired optimizations (compiler reading the value once and either always looping or never looping) and to get correct behavior on systems without a strongly ordered memory model (x86 is strongly ordered, so once the write finishes, the next read will see it; on other systems, if the threads don't flush CPU cache to main RAM for other reasons, the write might not be seen for a long time, if ever).</p>\n\n<p>You can improve the performance though. Default use of <code>std::atomic</code> uses <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"noreferrer\">a sequential consistency model</a> that's overkill for a single flag value. You can speed it up by using <code>load</code>/<code>store</code> with an explicit (and less strict) memory ordering, so each <code>load</code> isn't required to use the most paranoid mode to maintaining consistency.</p>\n\n<p>For example, you could do:</p>\n\n<pre><code>// global\nstd::atomic&lt;bool&gt; run = true;\n\n// thread 1\nwhile (run.load(std::memory_order_acquire)) { /* do stuff */ }\n\n// thread 2\n/* do stuff until it's time to shut down */\nrun.store(false, std::memory_order_release);\n</code></pre>\n\n<p>On an x86 machine, any ordering less strict than the (default, most strict) sequential consistency ordering typically ends up doing nothing but ensuring instructions are executed in a specific order; no bus locking or the like is required, because of the strongly ordered memory model. Thus, aside from guaranteeing the value is actually read from memory, not cached to a register and reused, using atomics this way on x86 is free, and on non-x86 machines, it makes your code correct (which it otherwise wouldn't be).</p>\n"}], "owner": {"reputation": 2043, "user_id": 1053577, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/504273631/picture?type=large", "display_name": "John S", "link": "https://stackoverflow.com/users/1053577/john-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1975, "favorite_count": 2, "accepted_answer_id": 44685689, "answer_count": 1, "score": 8, "last_activity_date": 1498081067, "creation_date": 1498075750, "last_edit_date": 1498081067, "question_id": 44685403, "link": "https://stackoverflow.com/questions/44685403/do-i-need-stdatomicbool-or-is-pod-bool-good-enough", "title": "Do I need std::atomic&lt;bool&gt; or is POD bool good enough?", "body": "<p>Consider this code:</p>\n\n<pre><code>// global\nstd::atomic&lt;bool&gt; run = true;\n\n// thread 1\nwhile (run) { /* do stuff */ }\n\n// thread 2\n/* do stuff until it's time to shut down */\nrun = false;\n</code></pre>\n\n<p>Do I need the overhead associated with the atomic variable here? My intuition is that the read/write of a boolean variable is more or less atomic anyway (this is a common g++/Linux/Intel setup) and if there is some write/read timing weirdness, and my run loop on thread 1 stops one pass early or late as a result, I'm not super worried about it for this application. </p>\n\n<p>Or is there some other consideration I am missing here? Looking at perf, it appears my code is spending a fair amount of time in <code>std::atomic_bool::operator bool</code> and I'd rather have it in the loop instead.</p>\n"}, {"tags": ["c++", "pointers", "reference", "stl"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1498075687, "post_id": 44685361, "comment_id": 76354872, "body": "Can you &quot;modify&quot; an <code>int</code> by &quot;changing its pointer&quot; in the same way? Maybe it has nothing to do with vectors?"}], "answers": [{"comments": [{"owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "edited": false, "score": 0, "creation_date": 1498075838, "post_id": 44685411, "comment_id": 76354967, "body": "Thanks! Is this copy-by-value or copy-by-reference?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "edited": false, "score": 0, "creation_date": 1498075921, "post_id": 44685411, "comment_id": 76355021, "body": "@HanfeiSun My suggest is to pass by reference instead of by pointer by value."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "edited": false, "score": 0, "creation_date": 1498076035, "post_id": 44685411, "comment_id": 76355077, "body": "@HanfeiSun its called pass by reference. Copies are always &quot;by value&quot; if you want to call it like that"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1498075876, "last_edit_date": 1498075876, "creation_date": 1498075780, "answer_id": 44685411, "question_id": 44685361, "link": "https://stackoverflow.com/questions/44685361/modify-a-vector-by-changing-its-pointer-doesnt-work-in-c/44685411#44685411", "title": "Modify a vector by changing its pointer doesn&#39;t work in c++?", "body": "<p>You're passing the pointer by value.  That means anything you change the pointer to point to in the function will not be seen outside the function.  What you need to do is pass the pointer by reference if you want to see the changes in the call site.  This won't work in this case though since </p>\n\n<pre><code>modify(&amp;first);\n</code></pre>\n\n<p>is a rvalue pointer and cannot be bound to a non const lvalue reference.</p>\n\n<p>All of this though is not needed.  We can just change the function to take a reference like </p>\n\n<pre><code>void modify(std::vector&lt;int&gt;&amp; i) {\n  i = second;\n}\n</code></pre>\n\n<p>and then <code>modify(&amp;first);</code> becomes <code>modify(first);</code> and now the changes will be reflected in <code>main()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1498076273, "creation_date": 1498076273, "answer_id": 44685536, "question_id": 44685361, "link": "https://stackoverflow.com/questions/44685361/modify-a-vector-by-changing-its-pointer-doesnt-work-in-c/44685536#44685536", "title": "Modify a vector by changing its pointer doesn&#39;t work in c++?", "body": "<p>Looks like you wanted this instead:</p>\n\n<pre><code>void modify(std::vector&lt;int&gt;* i) {\n  *i = second;\n}\n</code></pre>\n\n<p>it is \"old\" way to modify value through parameter and it may have an issue:</p>\n\n<pre><code>void modify(std::vector&lt;int&gt;* i) {\n  if( !i ) {\n      // what should I do?\n      throw std::runtime_exception( \"cannot modify vector through nullptr\" );\n  }\n  *i = second;\n}\n</code></pre>\n\n<p>this additional check can be avoided using reference instead which also would make your intention clearer to the reader of the code, unless you really want to pass <code>nullptr</code> sometimes for some reason (tell function not to change value, but do something else for example).</p>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 44685411, "answer_count": 2, "score": -3, "last_activity_date": 1498076273, "creation_date": 1498075575, "last_edit_date": 1498076147, "question_id": 44685361, "link": "https://stackoverflow.com/questions/44685361/modify-a-vector-by-changing-its-pointer-doesnt-work-in-c", "title": "Modify a vector by changing its pointer doesn&#39;t work in c++?", "body": "<p>Below is the snippet, I want to point the <code>first</code> variable to the <code>second</code> variable without copying the vector:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nstd::vector&lt;int&gt; second (4,100);\nvoid modify(std::vector&lt;int&gt;* i) {\n  i = &amp;second;\n}\nint main ()\n{\n  std::vector&lt;int&gt; first;                                // empty vector of ints\n  modify(&amp;first);\n  for (std::vector&lt;int&gt;::iterator it = first.begin(); it != first.end(); ++it)\n    std::cout &lt;&lt; ' ' &lt;&lt; *it;\n\n  std::cout &lt;&lt; '\\n';\n\n  return 0;\n}\n</code></pre>\n\n<p>The output is empty, while I expected the output to be <code>100 100 100 100</code>.</p>\n\n<p>Does anyone have ideas about why can't I modify the vector like this?</p>\n"}, {"tags": ["c++", "c", "cblas"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1498074238, "post_id": 44684970, "comment_id": 76354089, "body": "Don&#39;t cast the result of <code>malloc</code> &amp; friends in C!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1498074282, "post_id": 44684970, "comment_id": 76354114, "body": "how do you print your result on the C side? if your <code>printf</code> format is wrong, that would explain a lot."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1498074327, "post_id": 44684970, "comment_id": 76354141, "body": "@Olaf don&#39;t shoot the guy: he&#39;s using <code>vector</code> in C++ instead of <code>new</code>, that&#39;s a good start!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498074397, "post_id": 44684970, "comment_id": 76354167, "body": "@Jean-Fran&#231;oisFabre: How is your comment in any way related to mine?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1498074456, "post_id": 44684970, "comment_id": 76354207, "body": "@Olaf: Your sentence was in the imperative and included an exclamation mark! Which might be interpreted as shouting! You see?!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1498074474, "post_id": 44684970, "comment_id": 76354223, "body": "@Olaf don&#39;t take it the wrong way. I was just pointing out that OP uses correct C++ code. And casting the return of <code>malloc</code> in C is not a very serious offence, it&#39;s just useless."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1498074491, "post_id": 44684970, "comment_id": 76354229, "body": "Maybe I&#39;m missing something but I can&#39;t see how this is printed in the C version"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1498074512, "post_id": 44684970, "comment_id": 76354238, "body": "@4386427 exactly, and that&#39;s probably the key of the difference."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1498074589, "post_id": 44684970, "comment_id": 76354273, "body": "As in <i>there&#39;s literally no code that outputs anything</i>? Well, yeah. Must be missing :)"}, {"owner": {"reputation": 171, "user_id": 2336748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuTKW.gif?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2336748/madhatter"}, "edited": false, "score": 0, "creation_date": 1498074806, "post_id": 44684970, "comment_id": 76354400, "body": "I have the code in an &#39;extern c&#39;. So I still use c++ std::cout to print. So its the same code that I use to print in c++"}, {"owner": {"reputation": 171, "user_id": 2336748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuTKW.gif?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2336748/madhatter"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498074810, "post_id": 44684970, "comment_id": 76354407, "body": "@Jean-Fran&#231;oisFabre for (unsigned int i = 0; i &lt; bMatSize; ++i) { \t\t\t\t\tstd::cout &lt;&lt; bMat[i] &lt;&lt; &#39; &#39;; \t\t\t\t} \t\t\t\tstd::cout &lt;&lt; std::endl;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498074823, "post_id": 44684970, "comment_id": 76354413, "body": "@Jean-Fran&#231;oisFabre not <i>just useless</i>, I think it is <i>a bit</i> harmful in that it makes casting of pointer types look like a normal thing to do. But indeed, nothing to &quot;shout&quot; about ;)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498074943, "post_id": 44684970, "comment_id": 76354477, "body": "where is <code>queueTest</code> defined/allocated in the C version? also does  <code>simgms_math_ddot</code> has a valid prototype in the C version?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1498075032, "post_id": 44684970, "comment_id": 76354522, "body": "note that it&#39;s not just rounded. Some values don&#39;t match their rounded counterparts (ex: 1.11 vs 0)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1498075231, "post_id": 44684970, "comment_id": 76354634, "body": "@Jean-Fran&#231;oisFabre: Such caasts can shadow errors, e.g. typos or missing headers. It is very well considered harmful. It also is a good indicator if the code is <b>really</b> compiled with a C compiler or not. There are way too many people thinking compiling C coding style with a C++ compiler is identical to C code.  Oh, and shouting is more LIKE THIS!"}, {"owner": {"reputation": 171, "user_id": 2336748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuTKW.gif?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2336748/madhatter"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498075239, "post_id": 44684970, "comment_id": 76354638, "body": "@Jean-Fran&#231;oisFabre std::deque&lt; double* &gt; queueTest; ....Its filled with errorMatrix elements, which are 2d arrays, e.g:  queueTest.push_front(errorMatrix);"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1498075322, "post_id": 44684970, "comment_id": 76354690, "body": "@einpoklum: The Exclamation mark just adds some emphasis to the sentence. Shouting would be ALL UPPERCASE."}, {"owner": {"reputation": 171, "user_id": 2336748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuTKW.gif?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2336748/madhatter"}, "edited": false, "score": 0, "creation_date": 1498075352, "post_id": 44684970, "comment_id": 76354701, "body": "And the error matrix contains values,                                                                         ,1.78e-15 0.387 1.3 -0.48 -17.5 2.28 -0.387 -1.78e-15 1.48 -0.33 -17.3 2.4 -1.3 -1.48 -1.11e-16 1.08 -0.926 2.41 0.48 0.33 -1.08 0 0.551 0.74 17.5 17.3 0.926 -0.551 0 -0.384 -2.28 -2.4 -2.41 -0.74 0.384 0"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1498075507, "post_id": 44684970, "comment_id": 76354780, "body": "@MadHatter - Don&#39;t put information in comments - update the question using the <code>edit</code> link just below the question"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1498075654, "post_id": 44684970, "comment_id": 76354848, "body": "@4386427 put &quot;edit&quot; between square brackets to provide the <a href=\"https://stackoverflow.com/posts/44684970/edit\">edit</a> link."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498075698, "post_id": 44684970, "comment_id": 76354877, "body": "@MadHatter correct me if I&#39;m wrong, but a double ended queue isn&#39;t contiguous in memory. So in C it will fail."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1498075956, "post_id": 44684970, "comment_id": 76355042, "body": "@4386427: like this <code>[edit]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 2336748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuTKW.gif?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2336748/madhatter"}, "edited": false, "score": 0, "creation_date": 1498076178, "post_id": 44685459, "comment_id": 76355153, "body": "I&#39;ll try this and get back to you, thanks!"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1498076254, "last_edit_date": 1498076254, "creation_date": 1498075925, "answer_id": 44685459, "question_id": 44684970, "link": "https://stackoverflow.com/questions/44684970/i-converted-a-c-vector-data-set-into-a-c-array-i-pass-the-same-data-set-into/44685459#44685459", "title": "I converted a c++ vector data-set into a c array. I pass the same data-set into a function that should give the same output", "body": "<p>The problem is probably because of the way you're storing <code>queueTest</code> in a <code>deque</code>.</p>\n\n<pre><code>queueTest.at(ii).data()\n</code></pre>\n\n<p>reaches the iith element without problem (but with <code>O(n)</code> complexity, and can make you think that it's indexed access whereas it's not), but if you pass the address of the first element of the <code>std::deque</code> to your C program, adding an offset won't work because, unlike <code>std::vector</code> memory, <code>std::deque</code> memory isn't contiguous (it's a linked list) so you're getting random data for your coefficients.</p>\n\n<p>From <a href=\"http://www.cplusplus.com/reference/deque/deque/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/deque/deque/</a>:</p>\n\n<blockquote>\n  <p>unlike vectors, deques are not guaranteed to store all its elements in contiguous storage locations: accessing elements in a deque by offsetting a pointer to another element causes <strong>undefined behavior</strong>.</p>\n</blockquote>\n\n<p>The quickfix to be able to use it from the C side is to convert your <code>deque</code> to a <code>vector</code>.</p>\n"}], "owner": {"reputation": 171, "user_id": 2336748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuTKW.gif?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2336748/madhatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1498089971, "answer_count": 1, "score": 2, "last_activity_date": 1498076254, "creation_date": 1498074111, "last_edit_date": 1498075705, "question_id": 44684970, "link": "https://stackoverflow.com/questions/44684970/i-converted-a-c-vector-data-set-into-a-c-array-i-pass-the-same-data-set-into", "closed_reason": "Not suitable for this site", "title": "I converted a c++ vector data-set into a c array. I pass the same data-set into a function that should give the same output", "body": "<p>This code should generate the same output. But the c output seems to be rounded up while c++ is not. I don't understand what is going on here. \nPlease explain.</p>\n\n<p>Upto the point where I show the code, same values are passed to both c and c++ code.</p>\n\n<p>c code:</p>\n\n<pre><code>unsigned int sz1=sz+1; \ndouble* bMat = (double*)calloc(bMatSize,bMatSize * sizeof(double));\n\nfor (unsigned int ii = 0; ii&lt;sz; ii++)\n    for (unsigned int jj = 0; jj &lt;= ii; jj++)\n    {\n       bMat[jj*sz1 + ii] = simgms_math_ddot(numBFunc, queueTest[ii], queueTest[jj] );\n       bMat[ii*sz1 + jj] = bMat[jj*sz1 + ii];\n    }\n</code></pre>\n\n<p>c++ code:</p>\n\n<pre><code>std::vector&lt;double&gt; bMat;\nunsigned int sz1=sz+1;\nbMat.resize(sz1*sz1);\nfor(unsigned int ii=0; ii&lt;sz; ii++)\n    for(unsigned int jj=0; jj&lt;=ii; jj++)\n    {\n        bMat.at(jj*sz1+ii)=simgms_math_ddot(numBFunc, queueTest.at(ii).data(), queueTest.at(jj).data());\n        bMat.at(ii*sz1+jj)=bMat.at(jj*sz1+ii);\n    }\n\nfor (int i = 0; i &lt; bMat.size(); ++i) {\n   std::cout &lt;&lt; bMat[i] &lt;&lt; ' ';\n}\nstd::cout &lt;&lt; std::endl;\n</code></pre>\n\n<p>common function</p>\n\n<pre><code>double simgms_math_ddot(unsigned int numElements, double aMat[], double bMat[])\n\n{\n    const MKL_INT n=numElements;\n\n    double res = cblas_ddot(n, aMat, 1, bMat, 1);\n\n    return res;\n}\n</code></pre>\n\n<p>c coutput (bMat)</p>\n\n<pre><code>0 0 -1 0 0 -1 -1 -1 0  \n</code></pre>\n\n<p>c++ coutput (bMat)</p>\n\n<pre><code> 1.05e-05 0.00134 -1 0.00134 1.11 -1 -1 -1 0 \n</code></pre>\n\n<p>And the error matrix contains values:</p>\n\n<pre><code>1.78e-15 0.387 1.3 -0.48 -17.5 2.28 -0.387 -1.78e-15 1.48 -0.33 -17.3 2.4 -1.3 -1.48 -1.11e-16 1.08 -0.926 2.41 0.48 0.33 -1.08 0 0.551 0.74 17.5 17.3 0.926 -0.551 0 -0.384 -2.28 -2.4 -2.41 -0.74 0.384 0\n\nstd::deque&lt; double* &gt; queueTest;\n</code></pre>\n\n<p>....Its filled with errorMatrix elements, which are 2d arrays,</p>\n\n<pre><code> e.g: queueTest.push_front(errorMatrix);\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2013"], "comments": [{"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1498089875, "post_id": 44684603, "comment_id": 76360057, "body": "I do not know about the returned value. Regarding the uppercase problem, check your add-ons. I am using an output colorized that detects the words &quot;error&quot; and &quot;warning&quot; and changes the color of the whole line. It does not check the syntax of the line: is only looking for error/warning."}, {"owner": {"reputation": 187, "user_id": 2566111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVh2m.jpg?s=128&g=1", "display_name": "Kevin Dill", "link": "https://stackoverflow.com/users/2566111/kevin-dill"}, "reply_to_user": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1498153797, "post_id": 44684603, "comment_id": 76395310, "body": "I&#39;m pretty sure that Visual Assist is my only addon.  Though that sounds like a nice one - somewhere way down on my &quot;nuts to have&quot; list is trying to colorize the output. :)"}], "owner": {"reputation": 187, "user_id": 2566111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVh2m.jpg?s=128&g=1", "display_name": "Kevin Dill", "link": "https://stackoverflow.com/users/2566111/kevin-dill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498072862, "creation_date": 1498072862, "question_id": 44684603, "link": "https://stackoverflow.com/questions/44684603/vs2013-build-fails-if-i-output-error-in-the-post-build-step-i-think", "title": "VS2013 build fails if I output &quot;ERROR&quot; in the post build step - I think", "body": "<p>This is a bit of an odd one, and I tried to Google it but didn't have much luck.  Also, I apologize for the long lead-in... but I think it's all info necessary to understand what's happening?</p>\n\n<p>I'm working in C++, using Visual Studio 2013, and I have my own unit test implementation.  The test project is part of the solution, and there is a post build event which runs them (using the executable which was just built), and if that even returns non-0 then the build fails (as it should).  </p>\n\n<p>I also have my own macro-based output system which uses OutputDebugString to print to the output window in the development environment, so I can use statements like these:</p>\n\n<pre><code>AI_ERROR(\"Some ERROR message with C-style %s\", \"arguments\");\nAI_WARN(\"Some ERROR message with C-style %s\", \"arguments\");\nAI_LOG(\"Some ERROR message with C-style %s\", \"arguments\");\nAI_ERROR_CONFIG(\"Some ERROR message with C-style %s\", \"arguments\");\nAI_WARN_CONFIG(\"Some ERROR message with C-style %s\", \"arguments\");\nAI_LOG_CONFIG(\"Some ERROR message with C-style %s\", \"arguments\");\n</code></pre>\n\n<p>Which will result in this output when I run the executable directly:</p>\n\n<pre><code>(0.0000) tesaitest.cpp:87 ERROR: Some ERROR message with C-style arguments\n(0.0000) tesaitest.cpp:88 WARNING: Some ERROR message with C-style arguments\n(0.0000) tesaitest.cpp:89 LOG: Some ERROR message with C-style arguments\n(0.0000) tesaitest.cpp:90 ERROR (CONFIGURATION): Some ERROR message with C-style arguments\n(0.0000) tesaitest.cpp:91 WARNING (CONFIGURATION): Some ERROR message with C-style arguments\n(0.0000) tesaitest.cpp:92 LOG (CONFIGURATION): Some ERROR message with C-style arguments\n</code></pre>\n\n<p>That all works - so far so good.</p>\n\n<p>Here's where it gets a little weird.  If I run the executable for the tests directly, then it runs, and it prints the messages I showed above, and it returns 0 - which is expected, since I never wrote any code to do anything different.  However, when I compile and the tests are run as a post build event, it returns -1.  If I comment out the two error messages (the AI_ERROR and the AI_ERROR_CONFIG) then it returns 0, even though the output string still has the word \"ERROR\" in it.  This is actually the behavior I want - but this is a multi-compiler project, and I want to make sure that execution is consistent, so I want to make sure that I'm the one making it happen, not just the dev environment doing it for me.</p>\n\n<p>Another thing that I notice is that in the output that I get when I compile, the words \"error\" and \"warning\" are lower case, but \"log\" is not - and they are not lowercase in the original code.  Here's what that output looks like:</p>\n\n<pre><code>1&gt;(0.0000) tesaitest.cpp : 87 error : Some ERROR message with C-style arguments\n1&gt;(0.0000) tesaitest.cpp : 88 warning : Some ERROR message with C-style arguments\n1&gt;  (0.0000) tesaitest.cpp:89 LOG: Some ERROR message with C-style arguments\n1&gt;(0.0000) tesaitest.cpp : 90 error (CONFIGURATION): Some ERROR message with C-style arguments\n1&gt;(0.0000) tesaitest.cpp : 91 warning (CONFIGURATION): Some ERROR message with C-style arguments\n1&gt;  (0.0000) tesaitest.cpp:92 LOG (CONFIGURATION): Some ERROR message with C-style arguments\n</code></pre>\n\n<p>That part of the string is passed into the print function as an enum (either Error or ConfigError), but then I use vsnprintf_s to compile the whole message into a single char buffer before I pass it into OutputDebugString.</p>\n\n<p>Of course, for added fun, because this only happens during compile, and not when I run the executable directly, I can't catch it in the debugger.</p>\n\n<p>So... does anybody understand how/why MS is determining that these are errors and changing the return value?  Is there a setting where I can turn that off?  As I said, since this is a multi-compiler project, and also because I might want to be able to have cases where error messages don't actually represent failed tests (i.e. I want to test that error messages to get generated on bad input) I'd rather that I had full control over the return value...</p>\n"}, {"tags": ["python", "c++", "visual-studio", "anaconda", "pygraphviz"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1498073128, "post_id": 44684445, "comment_id": 76353458, "body": "The error message is pretty clear, you&#39;re missing <code>graphviz&#47;cgraph.h</code>. Solution - Install Graphviz. Duh"}, {"owner": {"reputation": 179, "user_id": 3984898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f6a446f77d4bbb10f807f6d9163362?s=128&d=identicon&r=PG&f=1", "display_name": "Zhida Deng", "link": "https://stackoverflow.com/users/3984898/zhida-deng"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1498073458, "post_id": 44684445, "comment_id": 76353640, "body": "Thanks, I have already installed Graphviz."}, {"owner": {"reputation": 13412, "user_id": 2449192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62cb5b405dc090d45eed0498dec02f52?s=128&d=identicon&r=PG", "display_name": "darthbith", "link": "https://stackoverflow.com/users/2449192/darthbith"}, "edited": false, "score": 0, "creation_date": 1498138645, "post_id": 44684445, "comment_id": 76384812, "body": "Why are you trying to build this yourself? Why not <code>conda install pygraphviz</code>?"}, {"owner": {"reputation": 179, "user_id": 3984898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f6a446f77d4bbb10f807f6d9163362?s=128&d=identicon&r=PG&f=1", "display_name": "Zhida Deng", "link": "https://stackoverflow.com/users/3984898/zhida-deng"}, "edited": false, "score": 0, "creation_date": 1498142200, "post_id": 44684445, "comment_id": 76387787, "body": "Thank you for the suggestion. But the following statements shown:                                                                                                          <code>Fetching package metadata</code> <code>PackageNotFoundError: Package missing in current win-64 channels:   - pygraphviz</code>  <code>Close matches found; did you mean one of these?</code>  <code>pygraphviz: graphviz, python-graphviz, pyqtgraph</code>"}, {"owner": {"reputation": 750, "user_id": 2431772, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Wb494.jpg?s=128&g=1", "display_name": "Nisar", "link": "https://stackoverflow.com/users/2431772/nisar"}, "edited": false, "score": 0, "creation_date": 1502172431, "post_id": 44684445, "comment_id": 78080194, "body": "Hi! @zdeng Did u get solution for this???"}, {"owner": {"reputation": 179, "user_id": 3984898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f6a446f77d4bbb10f807f6d9163362?s=128&d=identicon&r=PG&f=1", "display_name": "Zhida Deng", "link": "https://stackoverflow.com/users/3984898/zhida-deng"}, "edited": false, "score": 0, "creation_date": 1502287207, "post_id": 44684445, "comment_id": 78144943, "body": "Sorry, I didn&#39;t get the solution."}], "owner": {"reputation": 179, "user_id": 3984898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f6a446f77d4bbb10f807f6d9163362?s=128&d=identicon&r=PG&f=1", "display_name": "Zhida Deng", "link": "https://stackoverflow.com/users/3984898/zhida-deng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503778711, "creation_date": 1498072285, "last_edit_date": 1503778711, "question_id": 44684445, "link": "https://stackoverflow.com/questions/44684445/why-i-cant-install-the-pygraphviz-package-in-python", "title": "Why I can&#39;t install the pygraphviz package in Python?", "body": "<p>I used Anaconda3 to install pygraphviz package. First time, the error occurred which said the Microsoft Visual C++ 14.0 is required, so I installed the Visual Studio Community 2015(in the programming language the C++ module is also installed). However, the following error appeared:</p>\n\n<pre><code>  Collecting pygraphviz\n  Using cached pygraphviz-1.3.1.zip\n  Building wheels for collected packages: pygraphviz\n  Running setup.py bdist_wheel for pygraphviz ... error\n  Complete output from command C:\\ProgramData\\Anaconda3\\python.exe -u -c \"import setuptools, tokenize;__file__='C:\\\\Users\\\\zd1n14\\\\AppData\\\\Local\\\\Temp\\\\pip-build-pao661qp\\\\pygraphviz\\\\setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" bdist_wheel -d C:\\Users\\zd1n14\\AppData\\Local\\Temp\\tmp29u6yzrxpip-wheel- --python-tag cp36:\n  running bdist_wheel\n  running build\n  running build_py\n  creating build\n  creating build\\lib.win-amd64-3.6\n  creating build\\lib.win-amd64-3.6\\pygraphviz\n  copying pygraphviz\\agraph.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  copying pygraphviz\\graphviz.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  copying pygraphviz\\release.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  copying pygraphviz\\version.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  copying pygraphviz\\__init__.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  creating build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_attributes.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_attribute_defaults.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_clear.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_drawing.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_edge_attributes.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_graph.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_html.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_layout.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_node_attributes.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_readwrite.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_string.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_subgraph.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\test_unicode.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  copying pygraphviz\\tests\\__init__.py -&gt; build\\lib.win-amd64-3.6\\pygraphviz\\tests\n  running egg_info\n  writing pygraphviz.egg-info\\PKG-INFO\n  writing dependency_links to pygraphviz.egg-info\\dependency_links.txt\n  writing top-level names to pygraphviz.egg-info\\top_level.txt\n  warning: manifest_maker: standard file '-c' not found`\n\n  reading manifest file 'pygraphviz.egg-info\\SOURCES.txt'\n  reading manifest template 'MANIFEST.in'\n  warning: no previously-included files matching '*~' found anywhere in distribution\n  warning: no previously-included files matching '*.pyc' found anywhere in distribution\n  warning: no previously-included files matching '.svn' found anywhere in distribution\n  no previously-included directories found matching 'doc\\build'\n  writing manifest file 'pygraphviz.egg-info\\SOURCES.txt'\n  copying pygraphviz\\graphviz.i -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  copying pygraphviz\\graphviz_wrap.c -&gt; build\\lib.win-amd64-3.6\\pygraphviz\n  running build_ext\n  building 'pygraphviz._graphviz' extension\n  creating build\\temp.win-amd64-3.6\n  creating build\\temp.win-amd64-3.6\\Release\n  creating build\\temp.win-amd64-3.6\\Release\\pygraphviz\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -IC:\\ProgramData\\Anaconda3\\include -IC:\\ProgramData\\Anaconda3\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.10586.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6\\include\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.10586.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.10586.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.10586.0\\winrt\" /Tcpygraphviz/graphviz_wrap.c /Fobuild\\temp.win-amd64-3.6\\Release\\pygraphviz/graphviz_wrap.obj\n  graphviz_wrap.c\n  pygraphviz/graphviz_wrap.c(2954): fatal error C1083: Cannot open include file: 'graphviz/cgraph.h': No such file or directory\n  error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 14.0\\\\VC\\\\BIN\\\\x86_amd64\\\\cl.exe' failed with exit status 2\n</code></pre>\n\n<p>Can anyone help me? Many thanks in advance.</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "edited": false, "score": 0, "creation_date": 1498071438, "post_id": 44684103, "comment_id": 76352427, "body": "You don&#39;t need strings as non-type template arguments to make this work. (I&#39;ve done it) You can iterate your string literal using a recursive constexpr function."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "edited": false, "score": 0, "creation_date": 1498071749, "post_id": 44684103, "comment_id": 76352642, "body": "@erenon That forgoes the compile erorr part doesn&#39;t it? And also, that is just an example, my main issue is stated as in the title. I&#39;ve ran into this more than once by now."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 6, "creation_date": 1498072551, "post_id": 44684103, "comment_id": 76353119, "body": "String literals don&#39;t have linkage since only names have linkage and string literals don&#39;t have names. In your example <code>__foo</code> is not a string literal. <code>&quot;foo&quot;</code> is."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1498206097, "post_id": 44684103, "comment_id": 76415213, "body": "@VTT I&#39;m not suggesting <code>__foo</code> is a string literal, I&#39;m saying the behaviour be <i>as if</i> the bottom code is generated. And also, the double underscore is there to imply that that is not actually a real variable"}], "answers": [{"comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1498072087, "post_id": 44684334, "comment_id": 76352844, "body": "I appreciate this, but seriously, the question isn&#39;t stated as <i>how do I parse things at compile time</i>. I do want to know if having external linkage string literals is a Bad Idea"}, {"owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1498072169, "post_id": 44684334, "comment_id": 76352893, "body": "@PasserBy: please elaborate your use-case. This technique is suitable to do the printf check you mention in the question, including the compile errors."}], "tags": [], "owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "is_accepted": false, "score": 2, "last_activity_date": 1498071943, "creation_date": 1498071943, "answer_id": 44684334, "question_id": 44684103, "link": "https://stackoverflow.com/questions/44684103/is-there-a-reason-string-literals-cant-have-external-linkage/44684334#44684334", "title": "Is there a reason string literals can&#39;t have external linkage?", "body": "<p>It's possible to parse strings using constexpr functions only.\nHere's a very simple example:</p>\n\n<pre><code>constexpr int placeholder_count(const char* s, size_t i = 0, int result = 0)\n{\n    return s[i] == 0\n        ? result\n        : (s[i] == '%')\n        ? placeholder_count(s, i + 1, result + 1)\n        : placeholder_count(s, i + 1, result);\n}\n\nint main()\n{\n  static_assert(placeholder_count(\"foo %s bar %d\") == 2, \"\");\n  return 0;\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/TwN0UALpp0e6qfqr\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/TwN0UALpp0e6qfqr</a></p>\n\n<p>You can implement a lot of practical stuff using this, especially if C++14 is allowed, much less recursion is needed then.</p>\n\n<p>For more advanced use-cases, check-out metaparse:\n<a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/metaparse.html\" rel=\"nofollow noreferrer\">http://www.boost.org/doc/libs/1_64_0/doc/html/metaparse.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1498207857, "post_id": 44716940, "comment_id": 76416351, "body": "I&#39;ll clarify a bit more, but I&#39;m not asking what the standard says <i>now</i>, I&#39;m asking whether changing it will be bad"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1498208446, "post_id": 44716940, "comment_id": 76416736, "body": "In response to your statement of the actual issue, I argue that if there were strings with external linkage, they would have different semantics, most likely including it must yield the same object when evaluated"}], "tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1498207869, "last_edit_date": 1498207869, "creation_date": 1498207382, "answer_id": 44716940, "question_id": 44684103, "link": "https://stackoverflow.com/questions/44684103/is-there-a-reason-string-literals-cant-have-external-linkage/44716940#44716940", "title": "Is there a reason string literals can&#39;t have external linkage?", "body": "<blockquote>\n  <p>\u00a7 3.5 Program and linkage [basic.link]</p>\n  \n  <ol start=\"2\">\n  <li><strong>A name</strong> is said to have <em>linkage</em> when it might denote the same object, reference, function, type, template, namespace or value as a\n  name introduced by a declaration in another scope</li>\n  </ol>\n</blockquote>\n\n<p>As mentioned in the comments, only names have linkage. String literals aren't names.</p>\n\n<blockquote>\n  <p>\u00a7 2.13.5 String literals [lex.string]</p>\n  \n  <ol start=\"16\">\n  <li>Evaluating a string-literal results in a string literal object with static storage duration, initialized from the given characters as\n  specified above. <strong>Whether all string literals are distinct (that is,\n  are stored in nonoverlapping objects) and whether successive\n  evaluations of a string-literal yield the same or a different object\n  is unspecified</strong>.</li>\n  </ol>\n</blockquote>\n\n<p>So the actual issue is that different string literals with equal value can be stored in different objects. Even more, successive evaluations of the same literal can yield different objects.</p>\n"}, {"tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 5, "last_activity_date": 1521454328, "last_edit_date": 1521454328, "creation_date": 1521453488, "answer_id": 49360096, "question_id": 44684103, "link": "https://stackoverflow.com/questions/44684103/is-there-a-reason-string-literals-cant-have-external-linkage/49360096#49360096", "title": "Is there a reason string literals can&#39;t have external linkage?", "body": "<p>The question is about to become moot in C++20 due to <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0732r0.pdf\" rel=\"nofollow noreferrer\">P0732 class types in non-type template parameters</a>.</p>\n\n<p>Non-type template parameters are the last vestiges of an asymmetry between fundamental types and class types. It was there not through choice but by necessity: it wasn't clear how linkers are supposed to deal with them.</p>\n\n<p>Linkers need to be able to differentiate between two template class and in order to do that, it needs to answer whether two objects, <code>a</code> and <code>b</code> are equal. It was trivial for fundamental types, but unsolvable for class types with the tools available prior C++20.</p>\n\n<p><a href=\"http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0515r0.pdf\" rel=\"nofollow noreferrer\">P0515 consistent comparison</a> gave the mechanism for determining whether two class type objects are equal, provided they have trivial <code>operator&lt;=&gt;</code>, which has the semantics of memberwise comparison.</p>\n\n<p>If <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0732r0.pdf\" rel=\"nofollow noreferrer\">P0732</a> goes through, you would be able to write</p>\n\n<pre><code>template&lt;size_t N&gt;\nstruct fixed_string\n{\n    constexpr fixed_string(const char (&amp;str)[N]) { std::copy(str, str + N, data); }\n    auto operator&lt;=&gt;(const fixed_string&amp;, const fixed_string&amp;) = default;\n    char data[N];\n};\n\ntemplate&lt;size_t N&gt;\nfixed_string(const char(&amp;)[N]) -&gt; fixed_string&lt;N&gt;;\n\ntemplate&lt;fixed_string&gt; struct S {};\nS&lt;\"foo\"&gt; s;\n</code></pre>\n\n<p>See also <a href=\"http://zverovich.net/2018/03/17/text-formatting-jacksonville.html\" rel=\"nofollow noreferrer\">thoughts on the text formatting library</a> that is favored to go into C++20 as well.</p>\n"}], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 2, "accepted_answer_id": 49360096, "answer_count": 3, "score": 5, "last_activity_date": 1521454328, "creation_date": 1498071271, "last_edit_date": 1521454053, "question_id": 44684103, "link": "https://stackoverflow.com/questions/44684103/is-there-a-reason-string-literals-cant-have-external-linkage", "title": "Is there a reason string literals can&#39;t have external linkage?", "body": "<p>The main motivation behind wanting a string literal with external linkage is <a href=\"https://stackoverflow.com/questions/5547852/string-literals-not-allowed-as-non-type-template-parameters\">to use string literals as non-type template parameters</a>.</p>\n\n<p>I would imagine a string literal with external linkage having a definition similar to</p>\n\n<blockquote>\n  <p>A <em>string-literal</em> that has an e in the prefix is a <em>string-literal</em> with external linkage.</p>\n\n<pre><code>template&lt;auto&amp;&gt; struct S{};\nvoid bar()\n{\n    S&lt;e\"foo\"&gt; s;\n}\n</code></pre>\n  \n  <p>will have behaviour equivalent to</p>\n\n<pre><code>template&lt;auto&amp;&gt; struct S{};\nconstexpr char __foo[] = \"foo\";\nvoid bar\n{\n    S&lt;__foo&gt; s;\n}\n</code></pre>\n</blockquote>\n\n<p>Is there a reason not to have external linkage string literals?\nDoes somehow adding another prefix (like <code>e\"Lorem Ipsum\"</code>) to make a string literal have external linkage detrimental?</p>\n\n<p>Note: it is already possible to achieve an external linkage string, but it is a god awful way to do things.</p>\n\n<pre><code>#include&lt;boost/metaparse/v1/string.hpp&gt;\n\ntemplate&lt;typename&gt;\nstruct hack;\n\ntemplate&lt;char... Cs&gt;\nstruct hack&lt;boost::metaparse::v1::string&lt;Cs...&gt;&gt;\n{\n    static constexpr char arr[] = {Cs..., '\\0'};\n};\n\n#define E(str) hack&lt;BOOST_METAPARSE_STRING(str)&gt;::arr\n\ntemplate&lt;auto&amp;&gt; struct S{};\nS&lt;E(\"I'm an external linkage string\")&gt; s;  // compiles\n</code></pre>\n\n<p>Boost uses a python script to generate the implementation of <code>BOOST_METAPARSE_STRING</code>, and that is terrible.</p>\n"}, {"tags": ["c++", "vector", "stl"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1498071079, "post_id": 44683962, "comment_id": 76352208, "body": "You can&#39;t add items to a collection in the middle of a range based for. what are you trying to do overall?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498071173, "post_id": 44683962, "comment_id": 76352254, "body": "&quot;The reason why I did ... &quot; a warning is just a warning, not an error. It just means the compiler tells you: &quot;I am not sure this is correct, are you?&quot;. Using emplace just for that reason doesnt make much sense"}, {"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1498071253, "post_id": 44683962, "comment_id": 76352303, "body": "std::vector &lt; std::unique_ptr&lt;Boid&gt; &gt; m_boid ;  is the type for m_boid @Rabbid76"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498071258, "post_id": 44683962, "comment_id": 76352309, "body": "...also its not clear why you actually want to achieve. If you iterate over a vector and add another element on each iteration your loop will never end"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498071290, "post_id": 44683962, "comment_id": 76352331, "body": "@Eubs I see you <code>resize</code> before the loop. Did you intend to fill those newly allocated elements with elements, or are you trying to save space at the front of <code>m_boid</code>? It looks like you are trying to do the latter."}, {"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 0, "creation_date": 1498071344, "post_id": 44683962, "comment_id": 76352363, "body": "I want to add plently of objects into the vector container at the end of the day. For example.. creating 5 objects and putting them in a vector container."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1498071363, "post_id": 44683962, "comment_id": 76352376, "body": "Maybe you just need <code>bird.reset(new Boid);</code> ? (and forget everything else in the loop)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498071431, "post_id": 44683962, "comment_id": 76352422, "body": "after you resized, there are already <code>size</code> objects in the container, no need to put even more"}, {"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498071470, "post_id": 44683962, "comment_id": 76352447, "body": "I intend to fill my vector with objects the moment the class Boid is created in the main() function. @Fran&#231;oisAndrieux"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1498071490, "post_id": 44683962, "comment_id": 76352460, "body": "Either <code>resize()</code> <b>or</b> <code>emplace_back()</code> but not both I think."}, {"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498071687, "post_id": 44683962, "comment_id": 76352587, "body": "I want to set the size of my vector so it&#39;s determined during compile time. Do you think I should do a push_back() instead? I just thought emplace_back() is C++11 so I could use that @Galik"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1498071746, "post_id": 44683962, "comment_id": 76352638, "body": "a vectors size isnt determined at compile time, even if you call <code>resize</code>, maybe you wanted a <code>std::array</code> instead"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498071846, "post_id": 44683962, "comment_id": 76352692, "body": "sorry but your motivations for coding seem a bit odd. My advise: dont use something just because it is C++11, and dont change your code to the worse just because of a compiler warning"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498071851, "post_id": 44683962, "comment_id": 76352698, "body": "Also by creating <code>Boid</code> objects inside the constructor of a <code>Boid</code> you are in danger of infinite looping."}, {"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498072565, "post_id": 44683962, "comment_id": 76353126, "body": "I&#39;ve made some changes, can you help me to have a look please? Is that better now? @Galik"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498073951, "post_id": 44683962, "comment_id": 76353940, "body": "<a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">xy problem</a>?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1498087080, "post_id": 44683962, "comment_id": 76359369, "body": "Why are you creating the <code>Boid</code> objects dynamically at all?  <code>std:vector&lt;Boid&gt; m_boid;</code> or <code>std::array&lt;Boid, size&gt; m_boid;</code> would create the <code>Boid</code> objects automatically when <code>m_boid</code>&#39;s size is established."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 0, "creation_date": 1498071545, "post_id": 44684095, "comment_id": 76352495, "body": "What would you suggest then? Thank you in advance."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 0, "creation_date": 1498072264, "post_id": 44684095, "comment_id": 76352943, "body": "@Eubs A simple <code>for</code> loop from 0 to <code>size</code>?"}, {"owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 0, "creation_date": 1498072512, "post_id": 44684095, "comment_id": 76353099, "body": "Yes I could do that but I&#39;m trying to follow the C++11 standard @skypjack"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 2, "creation_date": 1498072569, "post_id": 44684095, "comment_id": 76353129, "body": "@Eubs And why on the Earth you think that a <code>for</code> loop isn&#39;t standard C++11?"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 0, "creation_date": 1498073018, "post_id": 44684095, "comment_id": 76353395, "body": "@Eubs Then put the new elements in a secondary vector and append it to the one you were looping on at the end of the loop. It doesn&#39;t make much sense, but if you want to use a range-based for..."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "edited": false, "score": 1, "creation_date": 1498074123, "post_id": 44684095, "comment_id": 76354028, "body": "@Eubs range based for loops are <i>great</i>. But they are not suitable for <i>every</i> situation. &quot;Old-style&quot; for loops are still useful in a number of different situations, and should be used when they are the correct/best solution. Don&#39;t use new features <i>just because they are new and shiny</i> and you <i>want</i> to use them - use them where they <i>make sense</i>."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 518, "user_id": 8161208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEwnK.png?s=128&g=1", "display_name": "Volodymyr Lashko", "link": "https://stackoverflow.com/users/8161208/volodymyr-lashko"}, "edited": false, "score": 0, "creation_date": 1498075499, "post_id": 44684095, "comment_id": 76354776, "body": "@VolodymyrLashko I&#39;d suggest you to look at the equivalent form of a range-based for loop once more. To invalidate the end iterator isn&#39;t exactly what you want while iterating."}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 5, "last_activity_date": 1498071219, "creation_date": 1498071219, "answer_id": 44684095, "question_id": 44683962, "link": "https://stackoverflow.com/questions/44683962/what-is-the-correct-way-to-emplace-back-an-object-into-a-vector-using-the-range/44684095#44684095", "title": "What is the correct way to emplace_back an object into a vector using the range-based for loop? C++", "body": "<blockquote>\n  <p>What is the correct way to emplace_back an object into a vector using the range-based for loop?</p>\n</blockquote>\n\n<p>I'd say none. <code>emplace_back</code> could invalidate iterators in case of a reallocation, thus you'd get an UB in that case.</p>\n"}], "owner": {"reputation": 19, "user_id": 8196022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad4be48ec2aa4d19ae80b95c417faa?s=128&d=identicon&r=PG&f=1", "display_name": "Eubs", "link": "https://stackoverflow.com/users/8196022/eubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1498072444, "creation_date": 1498070883, "last_edit_date": 1498072444, "question_id": 44683962, "link": "https://stackoverflow.com/questions/44683962/what-is-the-correct-way-to-emplace-back-an-object-into-a-vector-using-the-range", "title": "What is the correct way to emplace_back an object into a vector using the range-based for loop? C++", "body": "<p>I have an object that I want to add it to the vector container, but I would like to know is that 2 ways I did the same thing? And what is the correct way to do it? </p>\n\n<p>The reason why I did <code>m_boid.emplace_back(std::move(bird));</code> is because <code>bird</code> is a range-based-for-loop variable and if I don't use <code>bird</code> it will prompt me a warning saying <b>Unsed variable bird</b> But program is still able to run as it's not an error.</p>\n\n<p>What is the correct way to emplace_back an object into a vector using the range-based for loop? </p>\n\n<p>Thank you in advance.</p>\n\n<pre class=\"lang-or-tag-here prettyprint-override\"><code>Boid::Boid(int size)\n{\n    m_boid.resize(size);  //vector of unique pointer\n\n    for(auto &amp;bird : m_boid)\n    {\n        //Create an object\n        m_obj.reset(new Boid); //unique pointer\n\n            // Add object to vector. Is this 2 below the same thing?\n            m_boid.emplace_back(std::move(bird));  //Should I do this?\n            m_boid.emplace_back(std::move(m_obj)); //Or should I do this?\n    }\n}\n</code></pre>\n\n<p><br>\n<br></p>\n\n<p><b>EDITED. HOW ABOUT THIS? is this ok? </b></p>\n\n<pre class=\"lang-or-tag-here prettyprint-override\"><code>void Boid::initBoid(unsigned int containSize)\n{\n\n    m_boid.resize(containSize);\n\n    for(auto &amp;bird : m_boid)\n    {\n        bird.reset(new Boid);\n        bird-&gt;createVAO();\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "template-meta-programming"], "answers": [{"tags": [], "owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "is_accepted": true, "score": 2, "last_activity_date": 1498071914, "last_edit_date": 1498071914, "creation_date": 1498071185, "answer_id": 44684081, "question_id": 44683961, "link": "https://stackoverflow.com/questions/44683961/templated-equality-operator-for-template-class-does-not-compile/44684081#44684081", "title": "Templated Equality Operator for Template Class Does Not Compile", "body": "<p>By making both arguments to <code>operator==</code> templated, you are redefining this exact function template for <code>mytype&lt;true&gt;</code> and <code>mytype&lt;false&gt;</code>.  Simply remove the templating from the first (or second, but not both) argument to make this work:</p>\n\n<pre><code>template&lt;bool Raw2&gt;    \nfriend bool operator==(mytype const&amp; a, mytype&lt;Raw2&gt; const&amp; b) {    \n    // ...   \n}\n</code></pre>\n\n<p>It also appears that your <code>choose</code> is just an implementation of <code>std::conditional</code> and you could instead have</p>\n\n<pre><code>using array_t = typename std::conditional&lt;ArrayIsRaw, int[50], std::array&lt;int, 50&gt;&gt;::type;\n</code></pre>\n\n<p>or for c++14</p>\n\n<pre><code>using array_t = std::conditional_t&lt;ArrayIsRaw, int[50], std::array&lt;int, 50&gt;&gt;;\n</code></pre>\n"}], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 44684081, "answer_count": 1, "score": 1, "last_activity_date": 1498071914, "creation_date": 1498070881, "question_id": 44683961, "link": "https://stackoverflow.com/questions/44683961/templated-equality-operator-for-template-class-does-not-compile", "title": "Templated Equality Operator for Template Class Does Not Compile", "body": "<p>I've written the following code intended to allow my class, <code>mytype</code>, to select at compile-time whether to use a C-style array or a C++ STL array, like so:</p>\n\n<pre><code>#include&lt;array&gt;\n#include&lt;cassert&gt;\n\ntemplate&lt;bool IsTrue, typename IfTrue, typename IfFalse&gt;\nstruct choose;\n\ntemplate&lt;typename IfTrue, typename IfFalse&gt;\nstruct choose&lt;true, IfTrue, IfFalse&gt; {\n    typedef IfTrue type;\n};\n\ntemplate&lt;typename IfTrue, typename IfFalse&gt;\nstruct choose&lt;false, IfTrue, IfFalse&gt; {\n    typedef IfFalse type;\n};\n\ntemplate&lt;bool ArrayIsRaw&gt;\nstruct mytype {\n    typedef typename choose&lt;ArrayIsRaw, int[50], std::array&lt;int, 50&gt;&gt;::type array_t;\n    array_t data{};\n};\n\nint main() {\n    mytype&lt;true&gt; raw_version;\n    mytype&lt;false&gt; stl_version;\n    raw_version.data[5] = 15;\n    stl_version.data[15] = 5;\n    raw_version.data[10] = stl_version.data[15];\n    assert(raw_version.data[10] == 5);\n    return 0;\n}\n</code></pre>\n\n<p>This works just fine. However, I want to add an equality operator to this class that is agnostic of the underlying types involved: basically, I want <code>raw_version == stl_version</code> to be valid, compileable code which will return <code>true</code> if each element is identical.</p>\n\n<p>But when I add the following code to my class definition:</p>\n\n<pre><code>template&lt;bool Raw1, bool Raw2&gt;\nfriend bool operator==(mytype&lt;Raw1&gt; const&amp; a, mytype&lt;Raw2&gt; const&amp; b) {\n    for(size_t i = 0; i &lt; 50; i++) if(a.data[i] != b.data[i]) return false;\n    return true;\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>prog.cpp: In instantiation of \u2018struct mytype&lt;false&gt;\u2019:\nprog.cpp:32:16:   required from here\nprog.cpp:24:14: error: redefinition of \u2018template&lt;bool Raw1, bool Raw2&gt; bool operator==(const mytype&lt;Raw1&gt;&amp;, const mytype&lt;Raw2&gt;&amp;)\u2019\n  friend bool operator==(mytype&lt;Raw1&gt; const&amp; a, mytype&lt;Raw2&gt; const&amp; b) {\n              ^~~~~~~~\nprog.cpp:24:14: note: \u2018template&lt;bool Raw1, bool Raw2&gt; bool operator==(const mytype&lt;Raw1&gt;&amp;, const mytype&lt;Raw2&gt;&amp;)\u2019 previously defined here\n</code></pre>\n\n<p>What do I need to do to fix this error?</p>\n"}, {"tags": ["c++", "iterator", "brackets"], "comments": [{"owner": {"reputation": 3118, "user_id": 1253415, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87096d37b6aed093f1b142c6a9bfae91?s=128&d=identicon&r=PG", "display_name": "jcai", "link": "https://stackoverflow.com/users/1253415/jcai"}, "edited": false, "score": 2, "creation_date": 1498070401, "post_id": 44683813, "comment_id": 76351781, "body": "The syntax is called &quot;uniform initialization&quot; and here it just (implicitly) calls the constructor. The complexity here is linear in the size of the string."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1498070463, "post_id": 44683813, "comment_id": 76351821, "body": "This is <a href=\"http://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">copy list initialization</a>. See syntax #8 <i><code>return { arg1, arg2, ... } ;</code></i>"}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1498070852, "post_id": 44683813, "comment_id": 76352083, "body": "You are invoking <code>std::string</code> constructor with bracket notation"}], "answers": [{"tags": [], "owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "is_accepted": false, "score": 4, "last_activity_date": 1498071220, "creation_date": 1498071220, "answer_id": 44684097, "question_id": 44683813, "link": "https://stackoverflow.com/questions/44683813/curly-bracket-syntax-and-iterator-in-c/44684097#44684097", "title": "Curly bracket syntax and iterator in c++", "body": "<p>This code can be also written as:</p>\n\n<pre><code>string reverseString(string str){\n    return string(str.rbegin(), str.rend());\n}\n</code></pre>\n\n<p>It uses range constructor which creates new string from two iterators (beginning and end).</p>\n\n<p>Thanks to uniform initialization you can write it as:</p>\n\n<pre><code>string reverseString(string str){\n    return string{str.rbegin(), str.rend()};\n}\n</code></pre>\n\n<p>And since the compiler already knows that the return type is <code>string</code>, you don't have to specify it explicitly, which leads to this \"weird\" syntax:</p>\n\n<pre><code>string reverseString(string str){\n    return {str.rbegin(), str.rend()};\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 2, "last_activity_date": 1498080599, "last_edit_date": 1498080599, "creation_date": 1498072411, "answer_id": 44684483, "question_id": 44683813, "link": "https://stackoverflow.com/questions/44683813/curly-bracket-syntax-and-iterator-in-c/44684483#44684483", "title": "Curly bracket syntax and iterator in c++", "body": "<p>What's being used is called <a href=\"https://stackoverflow.com/questions/7612075/how-to-use-c11-uniform-initialization-syntax\">Uniform Initialization</a>.</p>\n\n<p>Looks a bit odd, I admit. The function knows it needs to return a <code>string</code>, but it's been fed a pair of iterators. The curly braces allow the compiler to attempt to construct a <code>string</code> based on the contents of the braces, and sure enough, <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/basic_string\" rel=\"nofollow noreferrer\">constructor number six listed here</a> will attempt to construct a string from a begin and end iterator. </p>\n\n<p>So </p>\n\n<pre><code>return {str.rbegin(), str.rend()};\n</code></pre>\n\n<p>is in more familiar syntax</p>\n\n<pre><code>return string(str.rbegin(), str.rend());\n</code></pre>\n\n<p>The next bit of magic is <code>rbegin</code> and <code>rend</code> provide reverse iterators, so the input <code>string</code> will be read backward into the output <code>string</code>. </p>\n\n<p><code>string</code> iterators <a href=\"http://en.cppreference.com/w/cpp/concept/RandomAccessIterator\" rel=\"nofollow noreferrer\">are Random Access Iterators</a>, so the iterator will be traversed in O(N) time. There isn't that much magic in building the new string, copying the old string and maybe some buffer resizing, the new string will be built in O(N) time PLUS any time required to size the buffer backing the new <code>string</code>. </p>\n\n<p>This results in either </p>\n\n<ul>\n<li>O(N) complexity because the buffer is presized before copying copying N elements from one <code>string</code> to the other, or </li>\n<li><a href=\"https://stackoverflow.com/questions/15079327/amortized-complexity-in-laymans-terms\">Amortized</a> O(N) complexity because the buffer is resized on demand, resulting in some additional allocating and copying of old buffer to new as well as copying from one <code>string</code> to the other.</li>\n</ul>\n\n<p>The second option is possible because the <code>string</code> constructor does not require the input iterator to be random access, making computing the size of the required buffer for presizing potentially more expensive than resizing. But it might have a special case testing for random access and presizing.</p>\n"}], "owner": {"reputation": 389, "user_id": 6586313, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh3.googleusercontent.com/-xrP8eHXD3FQ/AAAAAAAAAAI/AAAAAAAAAao/TvUMR0_6eoA/photo.jpg?sz=128", "display_name": "Mohammad Roohitavaf", "link": "https://stackoverflow.com/users/6586313/mohammad-roohitavaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 44684483, "answer_count": 2, "score": 2, "last_activity_date": 1498080599, "creation_date": 1498070276, "question_id": 44683813, "link": "https://stackoverflow.com/questions/44683813/curly-bracket-syntax-and-iterator-in-c", "title": "Curly bracket syntax and iterator in c++", "body": "<p>I have question about C++11. I know the function below reverses a string, but I don't know what is {} syntax? What type of structure is that? I usually code in Java. I cannot figure it out that what is this?   </p>\n\n<pre><code>string reverseString(string str){\n    return{ str.rbegin(), str.rend() };\n}\n</code></pre>\n\n<p>I also have another question, how efficient is this method to reverse a string? Because I think to reverse we should change the location of characters if we want to have string that is continuous on the memory. </p>\n"}, {"tags": ["c++", "arduino", "mqtt", "publish-subscribe"], "comments": [{"owner": {"reputation": 105, "user_id": 6200254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ORk7w.png?s=128&g=1", "display_name": "Rezniaq", "link": "https://stackoverflow.com/users/6200254/rezniaq"}, "edited": false, "score": 0, "creation_date": 1498070892, "post_id": 44683769, "comment_id": 76352101, "body": "What is the output of the for-loop when the payload is 11? Also, you should put a separator to differentiate payload[0] from payload[1] in the for-loop."}, {"owner": {"reputation": 1278, "user_id": 4521119, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-d5MalwUTJx0/AAAAAAAAAAI/AAAAAAAALvs/IcVyHG71750/photo.jpg?sz=128", "display_name": "Ansjovis86", "link": "https://stackoverflow.com/users/4521119/ansjovis86"}, "reply_to_user": {"reputation": 105, "user_id": 6200254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ORk7w.png?s=128&g=1", "display_name": "Rezniaq", "link": "https://stackoverflow.com/users/6200254/rezniaq"}, "edited": false, "score": 0, "creation_date": 1498071322, "post_id": 44683769, "comment_id": 76352350, "body": "The forloop is showing the payload properly."}, {"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 1, "creation_date": 1498076466, "post_id": 44683769, "comment_id": 76355293, "body": "Output your <code>payload</code> data once more after the first <code>if &#47; elseif</code>. I have a feeling that your <code>client.publish()</code> destroys your <code>payload</code> pointer? If it outputted <code>11</code> after the first <code>for</code> loop, I see no reason in the code why the second <code>if&#47;else</code> would not fire. Can you also remove all <code>client.publish()</code> calls and just look at the GPIO output pins with LEDs?"}, {"owner": {"reputation": 1278, "user_id": 4521119, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-d5MalwUTJx0/AAAAAAAAAAI/AAAAAAAALvs/IcVyHG71750/photo.jpg?sz=128", "display_name": "Ansjovis86", "link": "https://stackoverflow.com/users/4521119/ansjovis86"}, "edited": false, "score": 0, "creation_date": 1498078829, "post_id": 44683769, "comment_id": 76356464, "body": "Hi Maximillian, you are absolutely right. I&#39;ve fixed the issue by saving the payload to another variable, so that the payload buffer is not destroyed. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1278, "user_id": 4521119, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-d5MalwUTJx0/AAAAAAAAAAI/AAAAAAAALvs/IcVyHG71750/photo.jpg?sz=128", "display_name": "Ansjovis86", "link": "https://stackoverflow.com/users/4521119/ansjovis86"}, "is_accepted": false, "score": 0, "last_activity_date": 1498078963, "creation_date": 1498078963, "answer_id": 44686238, "question_id": 44683769, "link": "https://stackoverflow.com/questions/44683769/callback-function-not-executing-second-statement-c-mqtt/44686238#44686238", "title": "Callback function not executing second statement - C++ MQTT", "body": "<p>The client.publish destroys the payload buffer. So I had to catch the payloads into new variables to overcome the problem.</p>\n\n<pre><code> void callback(char* topic, byte* payload, unsigned int length) {\n      char p0 = (char)payload[0];\n      char p1 = (char)payload[1];\n      Serial.print(\"Message arrived [\");\n      Serial.print(topic);\n      Serial.print(\"] \");\n      for (int i = 0; i &lt; length; i++) {\n        Serial.print((char)payload[i]);\n      }\n\n       //Set GPIO0 to HIGH or LOW on first character received in message\n      if (p0 == '1') {\n        digitalWrite(GPIO0, HIGH);   // Turn the relay on\n        client.publish(getOutTopic().c_str(), \"GPIO0 set to HIGH\");\n      } else if (p0 == '0') {\n        digitalWrite(GPIO0, LOW);  // Turn the relay off\n        client.publish(getOutTopic().c_str(), \"GPIO0 set to LOW\");\n      }\n\n      //Set GPIO2 to HIGH or LOW on first character received in message\n      if (p1 == '1') {\n        digitalWrite(GPIO2, HIGH);   // turn LED off. With High it is inactive  on the ESP-01)\n        client.publish(getOutTopic().c_str(), \"GPIO2 set to HIGH\");\n      } else if (p1 == '0') {\n        digitalWrite(GPIO2, LOW);  // Turn the LED on by making the voltage LOW\n        client.publish(getOutTopic().c_str(), \"GPIO2 set to LOW\");\n      } \n}\n</code></pre>\n"}], "owner": {"reputation": 1278, "user_id": 4521119, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-d5MalwUTJx0/AAAAAAAAAAI/AAAAAAAALvs/IcVyHG71750/photo.jpg?sz=128", "display_name": "Ansjovis86", "link": "https://stackoverflow.com/users/4521119/ansjovis86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1498078963, "creation_date": 1498070128, "last_edit_date": 1498071377, "question_id": 44683769, "link": "https://stackoverflow.com/questions/44683769/callback-function-not-executing-second-statement-c-mqtt", "title": "Callback function not executing second statement - C++ MQTT", "body": "<p>I've programmed a callback function that handles MQTT messages (payload). I want to switch of pins not based on an incoming payload. The problem I have now is that the first statement is executed nicely when sending 11. However the second statement is not working. Strangely when I send two messages one containing 1x and the other x1 I can again toggle both pins. It's a very strange problem!\nCould anyone help me with this, thanks very much. I'm using the PubSubClient library.</p>\n\n<pre><code> void callback(char* topic, byte* payload, unsigned int length) {\n      Serial.print(\"Message arrived [\");\n      Serial.print(topic);\n      Serial.print(\"] \");\n      for (int i = 0; i &lt; length; i++) {\n        Serial.print((char)payload[i]);\n      }\n\n       //Set GPIO0 to HIGH or LOW on first character received in message\n      if (payload[0] == '1') {\n        digitalWrite(GPIO0, HIGH);   // Turn the relay on\n        client.publish(getOutTopic().c_str(), \"GPIO0 set to HIGH\");\n      } else if (payload[0] == '0') {\n        digitalWrite(GPIO0, LOW);  // Turn the relay off\n        client.publish(getOutTopic().c_str(), \"GPIO0 set to LOW\");\n      }\n\n      //Set GPIO2 to HIGH or LOW on first character received in message\n      if (payload[1] == '1') {\n        digitalWrite(GPIO2, HIGH);   // turn LED off. With High it is inactive  on the ESP-01)\n        client.publish(getOutTopic().c_str(), \"GPIO2 set to HIGH\");\n      } else if (payload[1] == '0') {\n        digitalWrite(GPIO2, LOW);  // Turn the LED on by making the voltage LOW\n        client.publish(getOutTopic().c_str(), \"GPIO2 set to LOW\");\n      } \n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1498069900, "post_id": 44683620, "comment_id": 76351472, "body": "You aren&#39;t forced to initialize the value of <code>b</code> in the declaration. <code>const int B::b = 20;</code> will work fine. I suspect you forgot to add <code>;</code> at the end of your <code>struct</code> declaration."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1498069950, "post_id": 44683620, "comment_id": 76351501, "body": "What happens when you try to initialize <code>b</code> outside of <code>B</code>? Do you get a compiler error? What is the error?"}, {"owner": {"reputation": 31, "user_id": 8192201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfe8330a2e0cdaa2d11d7bdfbb7a6ca?s=128&d=identicon&r=PG&f=1", "display_name": "Mbeginner", "link": "https://stackoverflow.com/users/8192201/mbeginner"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498070058, "post_id": 44683620, "comment_id": 76351557, "body": "@Fran&#231;oisAndrieux if the static variable is of <code>const static</code> type, why can I give the value of the variable inside unlike normal <code>static</code> variable?"}, {"owner": {"reputation": 1457, "user_id": 2638548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mkJxQ.jpg?s=128&g=1", "display_name": "dlasalle", "link": "https://stackoverflow.com/users/2638548/dlasalle"}, "edited": false, "score": 0, "creation_date": 1498070105, "post_id": 44683620, "comment_id": 76351588, "body": "Can you make your bottom chunk of code complete by adding the <code>int B::b = 20;</code>, or whatever you used to initialize it?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1498070147, "post_id": 44683620, "comment_id": 76351607, "body": "@Mbeginner That question has been asked here : <a href=\"https://stackoverflow.com/questions/9656941/why-cant-i-initialize-non-const-static-member-or-static-array-in-class\" title=\"why cant i initialize non const static member or static array in class\">stackoverflow.com/questions/9656941/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498070201, "post_id": 44683620, "comment_id": 76351640, "body": "Voting to close as the problem can&#39;t be reproduced."}, {"owner": {"reputation": 31, "user_id": 8192201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfe8330a2e0cdaa2d11d7bdfbb7a6ca?s=128&d=identicon&r=PG&f=1", "display_name": "Mbeginner", "link": "https://stackoverflow.com/users/8192201/mbeginner"}, "edited": false, "score": 0, "creation_date": 1498070795, "post_id": 44683620, "comment_id": 76352048, "body": "I&#39;m so sorry everyone. I did it wrong in initlaising. Its working perfect as Francois told."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 8196013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be63d9afa444e35a4c7240b62bffc1c5?s=128&d=identicon&r=PG&f=1", "display_name": "user8196013", "link": "https://stackoverflow.com/users/8196013/user8196013"}, "is_accepted": false, "score": 2, "last_activity_date": 1498070119, "creation_date": 1498070119, "answer_id": 44683759, "question_id": 44683620, "link": "https://stackoverflow.com/questions/44683620/why-should-const-static-variables-initialised-inside-struct/44683759#44683759", "title": "Why should const static variables initialised inside struct?", "body": "<p>You misread the error. The error should be something like \"you have a <strong>conflicting</strong> declaration\", meaning you declared it inline const but the definition doesn't have a const. So just do this:</p>\n\n<pre><code>const int B::b = 20;\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8192201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfe8330a2e0cdaa2d11d7bdfbb7a6ca?s=128&d=identicon&r=PG&f=1", "display_name": "Mbeginner", "link": "https://stackoverflow.com/users/8192201/mbeginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498070119, "creation_date": 1498069692, "last_edit_date": 1498069819, "question_id": 44683620, "link": "https://stackoverflow.com/questions/44683620/why-should-const-static-variables-initialised-inside-struct", "title": "Why should const static variables initialised inside struct?", "body": "<p>I'm a Cpp beginner and couldn't understand the following:</p>\n\n<pre><code>struct A{\nint i;\nstatic int j;\n}\n\nint A::j = 20;\n</code></pre>\n\n<p>Here,\n    I understood why static varible cannot be initialised inside <code>A</code> and it has to be initialised outised of <code>A</code> using scope resolution. (That is the point memory for <code>j</code> will be allocated and value is initialised) and <code>j</code> here doesn't add to the <code>sizeof(A)</code> as it is a static varible and has static storage for all the objects.</p>\n\n<p>Consider the following script:</p>\n\n<pre><code>struct B{\nint a;\nconst static int b = 20;\n}\n</code></pre>\n\n<p>Here,\n    I'm forced to initialize the value of <code>b</code> in the struct declaration directly. Why it is like this if static variable is of <code>const</code> type?\nIf I try to define this variable outside the scope of <code>B</code>, then it is throwing a compiler error stating that there is a previous declaration of <code>b</code>. Here when the memory for <code>b</code> is actually allocated and why  it has to be initialized within the declaration and why can't it cannot be initialized using a <code>::</code> operator like normal static variable?</p>\n"}, {"tags": ["c++", "recursion", "range-v3"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1498069963, "post_id": 44683591, "comment_id": 76351509, "body": "How do you handle end of recursion ?"}, {"owner": {"reputation": 356, "user_id": 1827360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e11ea4b5d604a4e093de7194cbb62482?s=128&d=identicon&r=PG", "display_name": "Timtro", "link": "https://stackoverflow.com/users/1827360/timtro"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1498070176, "post_id": 44683591, "comment_id": 76351630, "body": "@Jarod42 Oh my, I got so hung up on the fact that I made the compiler crash, I forgot to write the conditional return. I&#39;ll amend it. Thanks a lot for pointing out my gaffe quickly."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1498070500, "post_id": 44683591, "comment_id": 76351848, "body": "Your second branch still force instantiation of infinite number of function <code>rec_map_sum</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1498070655, "post_id": 44683591, "comment_id": 76351968, "body": "You should have <code>if constexpr (ranges::begin(r) == ranges::end(r))</code> (which is not possible) to have given code to compile."}, {"owner": {"reputation": 356, "user_id": 1827360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e11ea4b5d604a4e093de7194cbb62482?s=128&d=identicon&r=PG", "display_name": "Timtro", "link": "https://stackoverflow.com/users/1827360/timtro"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1498070843, "post_id": 44683591, "comment_id": 76352078, "body": "@Jarod42 You&#39;re obviously correct, but forgive me: I&#39;m not sure why, unless the size of the range is somehow part of the signature. From my (obviously flawed) understanding, in <code>main()</code>, I should be instantiating <code>int rec_map_sum(std::function&lt;int(int)&gt;, some_range_type, int)</code>, and the return statement should fit the same signature."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1498070982, "post_id": 44683591, "comment_id": 76352151, "body": "<code>r</code> and <code>r | view::drop(1)</code> and <code>r | view::drop(1) | view::drop(1)</code> are 3 different types. Which each generate its own <code>rec_map_sum</code>."}, {"owner": {"reputation": 356, "user_id": 1827360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e11ea4b5d604a4e093de7194cbb62482?s=128&d=identicon&r=PG", "display_name": "Timtro", "link": "https://stackoverflow.com/users/1827360/timtro"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1498071339, "post_id": 44683591, "comment_id": 76352359, "body": "@Jarod42 RE <code>r</code> vs <code>r | view::drop(1)</code>\u2014Oh... man. Now I see why you suggested <code>if constexpr</code>. The recursion is getting sorted out at compile time. That&#39;s not what I wanted. Do you know of any way for me to construct a range from the tail that doesn&#39;t change the type?"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 8196013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be63d9afa444e35a4c7240b62bffc1c5?s=128&d=identicon&r=PG&f=1", "display_name": "user8196013", "link": "https://stackoverflow.com/users/8196013/user8196013"}, "is_accepted": true, "score": 2, "last_activity_date": 1498071374, "creation_date": 1498071374, "answer_id": 44684145, "question_id": 44683591, "link": "https://stackoverflow.com/questions/44683591/recursive-function-of-range-from-range-v3-causes-compilation-to-diverge-why/44684145#44684145", "title": "Recursive function of range (from range-v3) causes compilation to diverge: why?", "body": "<p>The problem is pointed out by Jarod42, but the solution is pretty simple. You need a <strong>type-erased view</strong> that can take any range. Luckily, <a href=\"https://ericniebler.github.io/range-v3/structranges_1_1v3_1_1any__view.html\" rel=\"nofollow noreferrer\">such a thing exists</a>. Change your code to:</p>\n\n<pre><code>template &lt;typename F, typename R, typename T&gt;\nT rec_map_sum(F f, R r, T tally) {\n  auto r2 = any_view&lt;T&gt;{r};\n  if (ranges::begin(r2) == ranges::end(r2))\n    return tally;\n  else {\n    auto r_head = *ranges::begin(r2);\n    auto r_tail = r2 | view::drop(1);\n    return rec_map_sum(f, r_tail, tally + f(r_head));\n  }\n}\n</code></pre>\n\n<p>This prints 285.</p>\n"}], "owner": {"reputation": 356, "user_id": 1827360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e11ea4b5d604a4e093de7194cbb62482?s=128&d=identicon&r=PG", "display_name": "Timtro", "link": "https://stackoverflow.com/users/1827360/timtro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 44684145, "answer_count": 1, "score": 3, "last_activity_date": 1498071374, "creation_date": 1498069610, "last_edit_date": 1498070513, "question_id": 44683591, "link": "https://stackoverflow.com/questions/44683591/recursive-function-of-range-from-range-v3-causes-compilation-to-diverge-why", "title": "Recursive function of range (from range-v3) causes compilation to diverge: why?", "body": "<p>For some reason, the code in the listing below causes clang++ and g++ to use 100% CPU, and fill up memory until my system hangs.</p>\n\n<p><strong>Please note</strong>, this is a toy example for a talk. I'm aware that <code>accumulate</code> and <code>transform</code> are the standard way to do this, but this code is an intermediate point in a chain of reasoning.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;range/v3/all.hpp&gt;\n\nusing namespace ranges;\n\ntemplate &lt;typename F, typename R, typename T&gt;\nT rec_map_sum(F f, R r, T tally) {\n  if (ranges::begin(r) == ranges::end(r))\n    return tally;\n  else {\n    auto r_head = *ranges::begin(r);\n    auto r_tail = r | view::drop(1);\n    return rec_map_sum(f, r_tail, tally + f(r_head));\n\n    // this also crashes:\n    // return rec_map_sum(f, r[{1, end}], tally + f(r_head));\n  }\n}\n\nint main() {\n  std::cout &lt;&lt; rec_map_sum([](int x) { return x * x; }, view::iota(0, 10), 0)\n            &lt;&lt; std::endl;\n\n  return 0;\n}\n</code></pre>\n\n<p>The <code>rec_map_sum</code> function is meant to implement a recursion that takes a range of integers and a unary function, applies the function element-wise to the range, and produces the sum of the mapped elements.</p>\n\n<p>I have two questions: (1) what is the cause of the divergent behaviour, and (2) how should I make and pass down the tail view so that the compilation doesn't crash?</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "memory-leaks", "mutex"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498070223, "post_id": 44683557, "comment_id": 76351660, "body": "Is there a reason you&#39;re using a <code>std::bitset&lt;BITSET_SIZE&gt;*</code> instead of just a <code>std::bitset&lt;BITSET_SIZE&gt;</code>?"}, {"owner": {"reputation": 39, "user_id": 1906041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d1f97e98ff2a0a8aaf02f8ad855da?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/1906041/aref"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498071314, "post_id": 44683557, "comment_id": 76352343, "body": "I want to be able to keep this map and bitset for the entire life of the program, and I assume it should be allocated from heap since once the scope of the threaded function goes out, I can no longer trust the bitset allocated on the stack for that function."}, {"owner": {"reputation": 822, "user_id": 783868, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ca2b237e4b5f2a5a74a96a2a44fb700?s=128&d=identicon&r=PG", "display_name": "Soroosh Bateni", "link": "https://stackoverflow.com/users/783868/soroosh-bateni"}, "edited": false, "score": 0, "creation_date": 1498074184, "post_id": 44683557, "comment_id": 76354064, "body": "Usually there is no reason for a pointer inside a map. Can you please double check if you absolutely need it? You won&#39;t need the original memory address of a bitset when you insert it in the map. The map is accessible by everyone, hence, the bitset will be accessible by everyone. Also, if it is guaranteed that two threads won&#39;t access the same key, then there won&#39;t be any memory leakage as well."}, {"owner": {"reputation": 39, "user_id": 1906041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d1f97e98ff2a0a8aaf02f8ad855da?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/1906041/aref"}, "reply_to_user": {"reputation": 822, "user_id": 783868, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ca2b237e4b5f2a5a74a96a2a44fb700?s=128&d=identicon&r=PG", "display_name": "Soroosh Bateni", "link": "https://stackoverflow.com/users/783868/soroosh-bateni"}, "edited": false, "score": 0, "creation_date": 1498075204, "post_id": 44683557, "comment_id": 76354619, "body": "@SorooshBateni Well in the first phase there is no such guarantee so memory leakage can occur! Imagine I have a bunch of files that are read concurrently and for simplicity, each file has lines of the format: key -&gt; metadata . same key can appear in all those files. but I just want to insert the key to map and associate a bitset for it only once it has been seen for the first time. If another thread reads the same key from another file, after the first occurrence, simply it is ignored! Now if two threads come across the same key which does not exist, I would have leakage issue."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 1906041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d1f97e98ff2a0a8aaf02f8ad855da?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/1906041/aref"}, "edited": false, "score": 0, "creation_date": 1498077683, "post_id": 44685635, "comment_id": 76355847, "body": "So, I guess I misunderstood what the const member function entails. I knew it&#39;s the way of saying that member function does not mess with the state of the object at all. But, I read somewhere explaining the difference between [] operator and std::map::at or count and maybe mistakenly they have mentioned it is thread-safe because it&#39;s const. locking does not give as much performance as I need, running on a single thread with test data takes 25 minutes with 6 threads it takes 14 minutes."}], "tags": [], "owner": {"reputation": 2876, "user_id": 7958961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9fc6004eafe9f7b473927ecfd65646?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Cybulski", "link": "https://stackoverflow.com/users/7958961/rados%c5%82aw-cybulski"}, "is_accepted": false, "score": 0, "last_activity_date": 1498112593, "last_edit_date": 1498112593, "creation_date": 1498076632, "answer_id": 44685635, "question_id": 44683557, "link": "https://stackoverflow.com/questions/44683557/how-to-populate-c11-stdmapstdstring-stdbitsetn-concurrently-thread/44685635#44685635", "title": "How to populate c++11 std::map&lt;std::string,std::bitset&lt;N&gt;*&gt; concurrently (thread-safe) without memory leakage?", "body": "<p>First thing first - const function is not thread-safe. Consider:</p>\n\n<pre><code>struct A {\n  int q;\n  void set(int qq) { q = qq; }\n  int get() const { return q; }\n};\n</code></pre>\n\n<p>get() is not thread-safe - on the other thread set might be called, which will modify q. If you want thread-safety, you must either lock or update using atomic structures (there're other multithreading issues, which will happen if you dont lock / use atomics, but those are out of scope of your questions - you absolutely need either of those!).</p>\n\n<p>Now to solution:\nsince you need to explicitly synchronize access to your map structure your problem becomes non-issue:</p>\n\n<pre><code>std::mutex m; // since c++11\n...\n{\n    std::lock_guard _l(m); // since c++11\n    if (!my_map.emplace(key, bitset_ptr).second)\n        delete bitset_ptr;\n}\n</code></pre>\n\n<p>this will insert element into <em>my_map</em> with key <em>key</em> and value <em>bitset_ptr</em>, but only if it doesnt exist. It will return tuple of two elements - first being iterator to either created element and previously existing and second being boolean flag, which will be true, if element was created and false if it existed before. So you simply delete <em>bitset_ptr</em> if element was already insterted and no memory leak for you. Note, that due to amount of synchronization this might be slow.</p>\n\n<p>UPDATE:\nyou obviously need to synchronize using mutex m any access to my_map as long as you keep updating in multiple threads.</p>\n\n<p>UPDATE2:\nop has tried the easiest solution and found it not fast enough. Let's go deeper. (Note: the most optimal course of action is to measure performance of the application and find, where code is spending most of its time, but i cant do that ;)). There're few \"obvious\" (read: probable) causes of slowdown: </p>\n\n<ul>\n<li>inserting into map - insterting into sorted map has O(ln n) runtime performance and in reality might be very slow due to cache mismatches. in 1 milion elements map on average you will need to compare against 10 different string, lying (probably) in completely different areas of memory, thus purging each other from processor cache all the time.</li>\n<li>reading from files - reading small chunks from multiple files might (or might not!) be unhealthy to the overall speed.</li>\n<li>multiple allocations - in general memory allocation is slow. Also lot of allocations increase memory fragmentation and decrease locality.</li>\n<li>locking for synchronization - this aint healthy for anything...</li>\n</ul>\n\n<p>I'll assume, that you cant easily (cheaply) determine amount of elements, that are in single file and in total. First the code:</p>\n\n<pre><code>using etype = pair&lt;string, bitset&lt;N&gt;*&gt;;\nvector&lt;etype&gt; all_elements;\nmutex all_elements_mutex;\nvoid parse_single_file_in_thread(...) {\n    vector&lt;etype&gt; tmp;\n    for(auto element : parse_element_from_file()) \n        tmp.push_back(move(element));\n    lock_guard _l(all_elements_mutex);\n    for(auto &amp;a : tmp) all_elements.push_back(move(a));\n}\nmap&lt;string, bitset&lt;N&gt;*&gt; parse_all_files() {\n    // create threads, parse files in them and wait for them to finish\n    std::sort(all_elements.begin(), all_elements.end(), \n        [](const etype &amp;a, const etype &amp;b) { return a.first &lt; b.first; });\n    map&lt;string, bitset&lt;N&gt;*&gt; tmp;\n    for(auto &amp;a : all_elements) if (!tmp.insert(tmp.end(), etype(move(a.first), a.second)).second) delete a.second;\n    all_elements.clear();\n    return tmp;\n}\n</code></pre>\n\n<p>What it does is few things:\n- insert keys into vector first (ignore checking for duplicates), later on this will be sorted and inserted into map with placement hint (they are sorted, so we always know correct place to insert next element - end of the map), this is MUCH faster, than directly inserting into map\n- every file's items are first put into it's own vector and moved into global one after parsing whole file, this minimizes locking</p>\n\n<p>This should be enough for performance gain. Next thing would be replace string with something else to avoid so many string to string sorting comparisions. But this would get out of scope easily. ;)</p>\n\n<p>Note: i've written whole code from memory, so it might not compile and it might require c++17.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 1906041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d1f97e98ff2a0a8aaf02f8ad855da?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/1906041/aref"}, "edited": false, "score": 0, "creation_date": 1498078998, "post_id": 44685659, "comment_id": 76356538, "body": "Yeah, one solution could be a divide and conquer type of procedure and try to merge local maps and simply free the memory allocated in heap from either of lhs or rhs if they both have the same key. Others have also suggested Intel TBB, or mutex infrastructure by boost, but I&#39;d like to have minimal dependency and only stick to c++11 standard library."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 1, "last_activity_date": 1498076742, "creation_date": 1498076742, "answer_id": 44685659, "question_id": 44683557, "link": "https://stackoverflow.com/questions/44683557/how-to-populate-c11-stdmapstdstring-stdbitsetn-concurrently-thread/44685659#44685659", "title": "How to populate c++11 std::map&lt;std::string,std::bitset&lt;N&gt;*&gt; concurrently (thread-safe) without memory leakage?", "body": "<p><code>const</code> access to a <code>std::</code> container (like <code>map</code>) is guaranteed to be legal from different threads even without synchronization.</p>\n\n<p>Any non-<code>const</code> access without synchronization makes any other access (<code>const</code> or non-<code>const</code>) illegal (the programs behavior becomes undefined).</p>\n\n<p>Some operations are <em>not</em> <code>const</code>, but as far as synchronization are concerned is <code>const</code>.  For example, non-const <code>find</code> is treated \"as <code>const</code>\", as is <code>[]</code> on a <code>vector</code>.</p>\n\n<p><code>[]</code> on a map isn't <code>const</code> and isn't treated as <code>const</code>.  I am unsure if <code>[]</code> that does not create an element is treated as <code>const</code>, I would have to double-check the standard.  And as <code>find</code> exists and solves the same problem with well defined semantics, I wouldn't use it in code in any case.</p>\n\n<p><code>const</code> doesn't mean <em>thread-safe</em>, it means <em>thread-safe with other <code>const</code> operations</em>.  Thread-safe is a relation between two or more bits of code, it isn't an absolute.  So calling <code>.count</code> while someone else is inserting is not legal.</p>\n\n<p>In general, sharing is the bane of thread safety.  The easier way to solve this would be to give each \"task\" its own <code>map</code> to work with.  Then you merge these <code>map</code>s back into a master map.</p>\n\n<p>How complex and how often that merging happens becomes a matter of the specific application and how much replication there is.</p>\n\n<p>The easiest solution is:</p>\n\n<pre><code>std::map&lt;std::string, std::unique_ptr&lt;std::bitset&lt;BITSET_SIZE&gt;&gt;&gt;\nparse_file( some_file_handle );\n</code></pre>\n\n<p>then </p>\n\n<pre><code>std::map&lt;std::string, std::unique_ptr&lt;std::bitset&lt;BITSET_SIZE&gt;&gt;&gt;\nparse_files( gsl::span&lt;some_file_handle&gt; handles ) {\n  if (handles.size()==0) return {};\n  if (handles.size()==1) return parse_file(handles.front());\n  auto lhs = parse_files( handles.first(handles.size()/2) );\n  auto rhs = parse_files( handles.last(handles.size()-handles.size()/2) );\n  return merge_maps(std::move(lhs), std::move(rhs));\n}\n</code></pre>\n\n<p>gives us our single-threaded version.  We multithread it by:</p>\n\n<pre><code>std::map&lt;std::string, std::unique_ptr&lt;std::bitset&lt;BITSET_SIZE&gt;&gt;&gt;\nparse_files( gsl::span&lt;some_file_handle&gt; handles, executor exec ) {\n  if (handles.size()==0) return {};\n  if (handles.size()==1) return parse_file(handles.front());\n  auto lhs = exec( [handles]{parse_files(handles.first(handles.size()/2) )} );\n  auto rhs = exec( [handles]{parse_files(handles.last(handles.size()-handles.size()/2) )} );\n  auto retval = exec( [lhs=std::move(lhs], rhs=std::move[rhs]]()mutable{\n    return merge_maps(std::move(lhs).get(), std::move(rhs).get() );\n  }\n  return std::move(retval).get();\n}\n</code></pre>\n\n<p>where <code>executor</code> is takes an object of type <code>T()</code> and return a <code>future&lt;T&gt;</code>.  The naive executor simply runs the function and returns a ready future.  A fancier executor uses <code>std::async</code> to thread it off.  An even fancier one uses a thread pool, and when waited upon uses the waiting thread to run the task if it isn't already running.</p>\n\n<p>Now, concurrency libraries like ppl or Intel's TBB provide ways to do this pretty easily.</p>\n"}], "owner": {"reputation": 39, "user_id": 1906041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d1f97e98ff2a0a8aaf02f8ad855da?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/1906041/aref"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 44685659, "answer_count": 2, "score": 2, "last_activity_date": 1498112593, "creation_date": 1498069459, "last_edit_date": 1498088638, "question_id": 44683557, "link": "https://stackoverflow.com/questions/44683557/how-to-populate-c11-stdmapstdstring-stdbitsetn-concurrently-thread", "title": "How to populate c++11 std::map&lt;std::string,std::bitset&lt;N&gt;*&gt; concurrently (thread-safe) without memory leakage?", "body": "<p>Basically, I need to populate a <code>std::map</code> with millions of key entries (orders of 50 million more or less) from thousands of files that are read concurrently. The value that these keys will point to will be allocated from heap (<code>std::bitset</code> type).</p>\n\n<pre><code>std::map&lt;std::string,std::bitset&lt;BITSET_SIZE&gt;*&gt; my_map;\n</code></pre>\n\n<ol>\n<li><p>My 1st concern is: I do not want two threads (that first check if a\nkey exists and if it does not,) allocate space from heap.\nBecause I only can hold one pointer and the other allocations would\nlead to memory leakage since I can't keep track of them.</p>\n\n<pre><code>//count should be thread-safe, since it's defined as const in &lt;map&gt; header file\nif(my_map.count(key) == 0){\n    //some other thread may have initialized the key in the mean time\n    my_map[key] = new std::bitset&lt;BITSET_SIZE&gt;();\n    //Now I will lose the pointer to previous heap allocation from other thread\n}\n</code></pre>\n\n<p>One solution would be to have some mutex mechanism like\n<code>boost::unique_lock</code> or some smart combination of <code>boost::shared_lock</code>\nand boost::unique_lock for the sake of performance,  which I'd be happy to hear your ideas.</p></li>\n<li>Imagining I'm done with the first part, meaning; initializing keys of my_map without memory leakage concurrently, Second part of the quest is to manipulate the values (<code>std::bitset</code>) concurrently. To this end, I assume there should not be any problem since it's guaranteed no two threads will be working on the same key at the same time according to my setup. (No new keys will be added or keys removed from the underlying tree structure for the keys of my_map by any of the threads)</li>\n</ol>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 8, "creation_date": 1498068289, "post_id": 44683222, "comment_id": 76350548, "body": "Sounds more like a vague riddle than a proper interview question to me."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 2, "creation_date": 1498068373, "post_id": 44683222, "comment_id": 76350600, "body": "Make an array of the objects and compare the memory address of the first and of the second entry. May still not get the size of int, if the class or a superclass has virtual member functions / constructors."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1498068449, "post_id": 44683222, "comment_id": 76350647, "body": "Point out that sizeof is exactly the tool to do that job and that no professional code should try to implement it again. Then offer pseudo code <code>int array[2]; print &amp;(a[1])-&amp;(a[0]);</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1498068472, "post_id": 44683222, "comment_id": 76350662, "body": "You dont necessarily need a proper array, simple point arithmetic can deduce the answer."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1498068587, "post_id": 44683222, "comment_id": 76350724, "body": "What a stupid interview question. If it was one of 100 - fine. If it was one of less than 10 - screw that interview."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1498068714, "post_id": 44683222, "comment_id": 76350795, "body": "I think the idea of the question is whether the candidate spots that the idea itself is unhelpful and only on the second order, whether the cadidate can come up with any method. Also I consider the whole class thing is a decoy, because the actual question is about size of int, not size of class containing int. The difference might be target of the question, too."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1498068878, "post_id": 44683222, "comment_id": 76350889, "body": "Could also be about the candidates ability to clarify incomplete, misleading, unnecesserarily restrictive, requirements by starting a suitable communication with the customer. I.e. this question is not about C, it is about being a professional being able to look beyond the programming."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1498069161, "post_id": 44683222, "comment_id": 76351030, "body": "<i>@CuriousKrish</i> <a href=\"https://www.youtube.com/watch?v=UnBlst3T7bY\" rel=\"nofollow noreferrer\">Run, run, run away</a>. You won&#39;t like to work for a company that asks such interview questions."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498069226, "post_id": 44683222, "comment_id": 76351068, "body": "@Jesper I would have immediately left at that point, and wished them good luck for their further business."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498069391, "post_id": 44683222, "comment_id": 76351163, "body": "Would <code>const auto int_size = (char*)((int*)(nullptr) + 1) - (char*)nullptr;</code> be defined behavior? I feel it would violate some rule, but I&#39;m not sure which."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498070365, "post_id": 44683222, "comment_id": 76351747, "body": "@Fran&#231;oisAndrieux Arithmetic on a null pointer is undefined."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498072471, "post_id": 44683222, "comment_id": 76353075, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 because I got the invite on my phone and never really figured out how to join/participate yet."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498074008, "post_id": 44683222, "comment_id": 76353973, "body": "@jesper I&#39;ve invited you again."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1498077173, "post_id": 44683222, "comment_id": 76355614, "body": "@Yunnosch developers, especially junior should not directly communicate to the customer, especially one that gives misleading, unnecessary restrictive requirements."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498078226, "post_id": 44683222, "comment_id": 76356147, "body": "@Slava That is true. But when you interview, you want to know whether they know to ask, which is different from letting them do it to your money cows. But you are right, I should have said &quot;customer contact responsible&quot;  or &quot;requirement manager&quot;, instead of &quot;customer&quot;."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1498078937, "post_id": 44683222, "comment_id": 76356513, "body": "@Yunnosch maybe then their questions should be more straightforward &quot;do you really want to work in a company, where PM are idiots?&quot; or &quot;have you prepared to be inside &quot;office space&quot; movie?&quot; - you know, those people are juniors, they may not understand such indirect tip like question above."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498079120, "post_id": 44683222, "comment_id": 76356587, "body": "@slava I <i>so</i> agree."}, {"owner": {"reputation": 11, "user_id": 7144414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b099dd3bef302f66986e435300b2488?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousKrish", "link": "https://stackoverflow.com/users/7144414/curiouskrish"}, "edited": false, "score": 0, "creation_date": 1498079406, "post_id": 44683222, "comment_id": 76356714, "body": "Thanks everybody for your responses. The interviewer was leading me to think on lines of overflow and underflow. I did finally suggest the pointer arithmetic solution which he half heatedly agreed on. I just wanted to reaffirm if my line of thinking was correct."}], "answers": [{"comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1498070137, "post_id": 44683648, "comment_id": 76351600, "body": "<code>n1--</code> is undefined. You can only do pointer arithmetic with pointers belonging to the same array (or one-past-the-end)."}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498070369, "post_id": 44683648, "comment_id": 76351752, "body": "@Fran&#231;oisAndrieux, molbdnilo thanks, just declaring <code>A a1;</code> to don&#39;t invoke UB"}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498070737, "post_id": 44683648, "comment_id": 76352020, "body": "@Galik, thanks for pointing it. I think it may depend on architecture/implementation, added <code>std::abs</code>..."}], "tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": false, "score": 0, "last_activity_date": 1498070899, "last_edit_date": 1498070899, "creation_date": 1498069774, "answer_id": 44683648, "question_id": 44683222, "link": "https://stackoverflow.com/questions/44683222/size-of-an-object-without-using-sizeof-in-c/44683648#44683648", "title": "Size of an object without using sizeof in C++", "body": "<p>Using pointer algebra:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass A\n{\n    int a;\n};\n\nint main() {\n    A a1;\n    A * n1 = &amp;a1;\n    A * n2 = n1+1;\n    std::cout &lt;&lt; int((char *)n2 - (char *)n1) &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498075346, "post_id": 44683851, "comment_id": 76354699, "body": "I am not sure that requirement to avoid <code>sizeof()</code> coud be considered &quot;valid&quot;"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1498076757, "post_id": 44683851, "comment_id": 76355419, "body": "@Slava, I think that&#39;s fair game for homework and interview questions."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498077021, "post_id": 44683851, "comment_id": 76355542, "body": "I wonder if they would ask &quot;how will you write a text on a piece of paper in case pen or pencil is prohibited to use?&quot; on secretary interview."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498080234, "post_id": 44683851, "comment_id": 76357062, "body": "I bet using <code>offsetof</code> whould be more &quot;efficient&quot; as does not require any memory allocation."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498080912, "post_id": 44683851, "comment_id": 76357332, "body": "@Slava, <code>offsetof</code> computes the offset of a member from the start of a <code>struct</code>. I am not sure how that will work for what the OP wants to do."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498081071, "post_id": 44683851, "comment_id": 76357388, "body": "@Slava: <code>offsetof</code> also counts padding, right? Can you provide a solution based on <code>offsetof</code>which does not depend on compiler/platform-specific padding?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1498081214, "post_id": 44683851, "comment_id": 76357442, "body": "@R Sahu: I think that <code>p1+1</code> is valid due to the &quot;points one after the last element of an array&quot;, right? But just to be picky: is a single object instance considered as an array, or is there any other reason why <code>p1+1</code> is guaranteed to be legal?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498137702, "post_id": 44683851, "comment_id": 76384078, "body": "Create a structure with 2 ints and difference of offsets is == <code>sizeof(int)</code>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 4, "last_activity_date": 1498070465, "creation_date": 1498070465, "answer_id": 44683851, "question_id": 44683222, "link": "https://stackoverflow.com/questions/44683222/size-of-an-object-without-using-sizeof-in-c/44683851#44683851", "title": "Size of an object without using sizeof in C++", "body": "<p>The following program demonstrates a valid technique to compute the size of an object.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Foo\n{\n   int f;\n};\n\nint main()\n{\n   // Create an object of the class.\n   Foo foo;\n\n   // Create a pointer to it.\n   Foo* p1 = &amp;foo;\n\n   // Create another pointer, offset by 1 object from p1\n   // It is legal to compute (p1+1) but it is not legal\n   // to dereference (p1+1)\n   Foo* p2 = p1+1;\n\n   // Cast both pointers to char*.\n   char* cp1 = reinterpret_cast&lt;char*&gt;(p1);\n   char* cp2 = reinterpret_cast&lt;char*&gt;(p2);\n\n   // Compute the size of the object.\n   size_t size = (cp2-cp1);\n\n   std::cout &lt;&lt; \"Size of Foo: \" &lt;&lt; size &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": -1, "last_activity_date": 1498087515, "creation_date": 1498087515, "answer_id": 44687717, "question_id": 44683222, "link": "https://stackoverflow.com/questions/44683222/size-of-an-object-without-using-sizeof-in-c/44687717#44687717", "title": "Size of an object without using sizeof in C++", "body": "<p>Pointer arithmetic can be used without actually creating any objects:</p>\n\n<pre><code>class c {\n    int member;\n};\n\nc *ptr = 0;\n++ptr;\nint size = reinterpret_cast&lt;int&gt;(ptr);\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>int size = reinterpret_cast&lt;int&gt;( static_cast&lt;c*&gt;(0) + 1 );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1498245790, "last_edit_date": 1498245790, "creation_date": 1498090594, "answer_id": 44688128, "question_id": 44683222, "link": "https://stackoverflow.com/questions/44683222/size-of-an-object-without-using-sizeof-in-c/44688128#44688128", "title": "Size of an object without using sizeof in C++", "body": "<p>Yet another alternative without using pointers. You can use it if in the next interview they also forbid pointers. Your comment <em>\"The interviewer was leading me to think on lines of overflow and underflow\"</em> might also be pointing at this method or similar.</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main() {\n    unsigned int x = 0, numOfBits = 0;\n    for(x--; x; x /= 2) numOfBits++;\n    std::cout &lt;&lt; \"number of bits in an int is: \" &lt;&lt; numOfBits;\n    return 0;\n}\n</code></pre>\n\n<p>It gets the maximum value of an <code>unsigned int</code> (decrementing zero in unsigned mode) then subsequently divides by 2 until it reaches zero. To get the number of <em>bytes</em>, divide by <code>CHAR_BIT</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7144414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b099dd3bef302f66986e435300b2488?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousKrish", "link": "https://stackoverflow.com/users/7144414/curiouskrish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1498245790, "creation_date": 1498068212, "last_edit_date": 1498087228, "question_id": 44683222, "link": "https://stackoverflow.com/questions/44683222/size-of-an-object-without-using-sizeof-in-c", "title": "Size of an object without using sizeof in C++", "body": "<p>This was an interview question:</p>\n\n<blockquote>\n  <p>Say there is a class having only an int member. You do not know how many bytes the int will occupy. And you cannot view the class implementation (say it's an API). But you can create an object of it. How would you find the size needed for int without using sizeof.</p>\n</blockquote>\n\n<p>He wouldn't accept using <code>bitset</code>, either. </p>\n\n<p>Can you please suggest the most efficient way to find this out?</p>\n"}, {"tags": ["c++", "mfc"], "comments": [{"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1498068162, "post_id": 44683166, "comment_id": 76350475, "body": "What is the difference between <code>Persons</code> and <code>PERSONS</code>?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498070069, "post_id": 44683166, "comment_id": 76351570, "body": "Did the error message tell you, which private member of class <code>CObject</code> cannot be accessed?"}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 2, "last_activity_date": 1498070668, "creation_date": 1498070668, "answer_id": 44683908, "question_id": 44683166, "link": "https://stackoverflow.com/questions/44683166/adding-data-to-carray-gives-error-cannot-access-private-member-declared-in-clas/44683908#44683908", "title": "Adding data to CArray gives error &quot;cannot access private member declared in class &#39;CObject&#39;&quot;", "body": "<p>The error boils down to class <code>CPtrArray</code> not defining a copy constructor, which your code uses when adding to <code>oCArr</code>.  The compiler generated default copy constructor will try to call the copy constructor for <code>CObject</code>, which is declared <code>private</code>.</p>\n\n<p>You should probably add the elements into <code>oCArr</code> directly, rather than adding them to local variables then making copies.</p>\n"}, {"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498120829, "post_id": 44684775, "comment_id": 76371775, "body": "<i>&quot;it&#39;s a massive headache&quot;</i> - Only, if you do not understand, why things are the way they are. The copy constructor is declared <code>private</code>, to save developers from doing the wrong thing. In the great majority of cases, copying a container with pointers to objects needs custom logic (e.g. storing pointers to copies). If you want your copy to point to the same objects and don&#39;t want to implement that custom logic yourself, use a <code>CArray</code> with a <code>std::shared_ptr</code> instead of <code>CPtrArray</code>."}, {"owner": {"reputation": 419, "user_id": 8075321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZRWka.png?s=128&g=1", "display_name": "Mercury Dime", "link": "https://stackoverflow.com/users/8075321/mercury-dime"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498160800, "post_id": 44684775, "comment_id": 76399181, "body": "I understand why they did it - it doesn&#39;t make me feel any less annoyed when I go to do trivial tasks (copy/assign/return) with a CArray&lt;int&gt;, CList&lt;NonCObjectType&gt;, etc and they don&#39;t work."}], "tags": [], "owner": {"reputation": 419, "user_id": 8075321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZRWka.png?s=128&g=1", "display_name": "Mercury Dime", "link": "https://stackoverflow.com/users/8075321/mercury-dime"}, "is_accepted": false, "score": 1, "last_activity_date": 1498073476, "creation_date": 1498073476, "answer_id": 44684775, "question_id": 44683166, "link": "https://stackoverflow.com/questions/44683166/adding-data-to-carray-gives-error-cannot-access-private-member-declared-in-clas/44684775#44684775", "title": "Adding data to CArray gives error &quot;cannot access private member declared in class &#39;CObject&#39;&quot;", "body": "<p>1201 is correct, and it's a massive headache. If you're forced to use the MFC collections, you could derive from them and create custom copy constructors/assignment operators. (and move + initializer_list) The array collections have a Copy function you can use to make life simple.</p>\n\n<pre><code>class CPtrArrayEx : public CPtrArray\n{\npublic:\n    CPtrArrayEx() = default;\n    CPtrArrayEx(CPtrArrayEx const&amp; rhs)\n    {\n        Copy(rhs);\n    }\n\n    CPtrArrayEx&amp; operator=(CPtrArrayEx const&amp; rhs)\n    {\n        if (this != &amp;rhs)\n            Copy(rhs);\n        return *this;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 846, "user_id": 872902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/11bf971a140fc8b7870f7cace4b52297?s=128&d=identicon&r=PG", "display_name": "AlexSavAlexandrov", "link": "https://stackoverflow.com/users/872902/alexsavalexandrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 44683908, "answer_count": 2, "score": 1, "last_activity_date": 1498073476, "creation_date": 1498068063, "question_id": 44683166, "link": "https://stackoverflow.com/questions/44683166/adding-data-to-carray-gives-error-cannot-access-private-member-declared-in-clas", "title": "Adding data to CArray gives error &quot;cannot access private member declared in class &#39;CObject&#39;&quot;", "body": "<p>I have a structure called <code>PERSONS</code> and then I have defined a type <code>CTypedPtrArray&lt;CPtrArray, PERSONS*&gt; PersonsTable;</code></p>\n\n<pre><code>struct Persons { ... };\ntypedef CTypedPtrArray&lt;CPtrArray, PERSONS*&gt; PersonsTable;\n</code></pre>\n\n<p>Later in the code I try to make a <code>PersonTable</code> <code>CArray</code>:</p>\n\n<pre><code>void CArrayTesting()\n{\n    CArray&lt;PersonsTable, PersonsTable&gt; oCArr;\n    oCArr.SetSize(3);\n    PersonsTable perTableA;\n    PersonsTable perTableB;\n    PersonsTable perTableC;\n    for (int i = 0; i &lt; 10; i++)\n    {\n        if (i &lt; 3)      addPerson(perTableA, i);\n        else if (i &lt; 8) addPerson(perTableB, i);\n        else            addPerson(perTableC, i);\n    }\n    oCArr.Add(perTableA);\n    oCArr.Add(perTableB);\n    oCArr.Add(perTableC);\n    for (int nArrCnt = 0; nArrCnt &lt; oCArr.GetSize(); nArrCnt++)\n        for (int i = 0; i &lt; oCArr.ElementAt(nArrCnt).GetSize(); i++)\n        {\n            cout&lt;&lt;\"Table \"&lt;&lt; nArrCnt &lt;&lt; \" - \" &lt;&lt; oCArr.ElementAt(nArrCnt)[i]-&gt;nID &lt;&lt; endl;\n            delete oCArr.ElementAt(nArrCnt)[i];\n        }\n}\n</code></pre>\n\n<p>The <code>addPerson()</code> function adds data to <code>PersonTable</code>.</p>\n\n<p>However, this causes an error during the compilation: <code>cannot access private member declared in class 'CObject</code> . The error appears to be related to <code>oCArr.Add()</code>, because it gets 'fixed' when I delete the respected rows.</p>\n\n<p>Why does the error appear? How can I fix it? And how does CArray work?</p>\n"}, {"tags": ["c++", "c", "memory", "opencl", "gpgpu"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1498074259, "post_id": 44683163, "comment_id": 76354101, "body": "What are you getting when you check the value of <code>errcode_ret</code>? Normally functions like this will fail by setting a value in that variable, not by crashing the program or throwing an exception."}, {"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1498074722, "post_id": 44683163, "comment_id": 76354351, "body": "@Xirema errcode_ret is 0 after all of these calls which is CL_SUCCESS"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1498075403, "post_id": 44683163, "comment_id": 76354722, "body": "Could you edit in a full program which reproduces this issue? A sample program on my computer produced the error code <code>-61</code>, which corresponds to <code>CL_INVALID_BUFFER_SIZE</code>."}, {"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1498076136, "post_id": 44683163, "comment_id": 76355118, "body": "@Xirema thank you for your attention. Problem actually &quot;solved&quot; now. I just proceeded at writing my first OpenCL app and discovered that upon enqueing the kernel which receives that buffer as parameter (passed with clSetKernelArg()) <b>pfn_notify()</b> invoked with CL_MEM_OBJECT_ALLOCATION_FAILURE error. Aquiring less memory at call to <b>clCreateBuffer()</b> solves the problem. I am trying all of these at my attic PC with OpenCL v1.1 and 12 years old GPU - I doubt you can reproduce that :)"}, {"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1498076340, "post_id": 44683163, "comment_id": 76355223, "body": "@Xirema as I expected at the beginning, you actually <b>cannot</b> allocate CL_DEVICE_GLOBAL_MEM_SIZE amount of memory. Probably because some of that memory already used by something at Ubuntu_server? or is <b>constant/local</b>? etc. There is CL_DEVICE_MAX_MEM_ALLOC_SIZE, but, magically, it <b>does</b> allocate more than that with single call. Scouting the web now in search for answers to how allocate as much memory as possible."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 1, "creation_date": 1498076823, "post_id": 44683163, "comment_id": 76355446, "body": "<code>CL_DEVICE_MAX_MEM_ALLOC_SIZE</code> is the limit on individual buffers, and is required to be the larger of either 128Mb, or <code>CL_DEVICE_GLOBAL_MEM_SIZE &#47; 4</code>. So in most real-world scenarios, you should assume you cannot allocate buffers taking up more than 25% of total device memory. <a href=\"https://www.khronos.org/registry/OpenCL/sdk/2.0/docs/man/xhtml/clGetDeviceInfo.html\" rel=\"nofollow noreferrer\">See the Specification on how <code>CL_DEVICE_MAX_MEM_ALLOC_SIZE</code> is defined</a>. I don&#39;t know where you&#39;re observing that someone is allocating more than that, unless total memory is less than 512Mb."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 1, "creation_date": 1498078358, "post_id": 44683163, "comment_id": 76356204, "body": "I should emphasize that it&#39;s required to <i>at least be</i> the number I specified; Implementations are allowed to set the limit higher if the hardware can properly support it. I&#39;ve seen very few sets of hardware that support more than 33% memory use in a single buffer, but it&#39;s possible that it has happened."}, {"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1498079270, "post_id": 44683163, "comment_id": 76356655, "body": "@Xirema I see, thank you. I guess, to allocate all the CL_DEVICE_GLOBAL_MEM_SIZE of GPU memory I need just create 4 buffers of CL_DEVICE_MAX_MEM_ALLOC_SIZE ... and pass 4 similar (but pointing to different buffers) params to kernel ..."}], "answers": [{"comments": [{"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "edited": false, "score": 0, "creation_date": 1498118439, "post_id": 44693143, "comment_id": 76370141, "body": "My OpenCL version is 1.1, NVIDIA 340 driver, Ubuntu 16.04."}, {"owner": {"reputation": 321, "user_id": 1015320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4aca5081702d525d01a971937000cdb?s=128&d=identicon&r=PG", "display_name": "haahh", "link": "https://stackoverflow.com/users/1015320/haahh"}, "reply_to_user": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "edited": false, "score": 0, "creation_date": 1498119031, "post_id": 44693143, "comment_id": 76370538, "body": "Try to do a write to that 100GB buffer. It should fail. IIRC, also in other cases NVIDIA OpenCL platform sometimes tends to set error not in the actual failing function, but later, for example if <code>clEnqueueNDRangeKernel</code> call fails, error can be returned in the next <code>clFinish</code> or <code>clWaitForEvents</code> call (that&#39;s not related to lazy memory allocation)."}, {"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "edited": false, "score": 0, "creation_date": 1498119460, "post_id": 44693143, "comment_id": 76370839, "body": "<b>clEnqueueNDRangeKernel()</b> actually fails with <b>CL_MEM_OBJECT_ALLOCATION_FAILURE</b> error, yes, thank you. As I was expecting, it indeed fails even when I try allocate <b>CL_DEVICE_GLOBAL_MEM_SIZE</b> memory, due to some limit per single allocation. Have to somehow allocate the whole global memory with several calls to <b>clCreateBuffer()</b>, sigh ..."}], "tags": [], "owner": {"reputation": 321, "user_id": 1015320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4aca5081702d525d01a971937000cdb?s=128&d=identicon&r=PG", "display_name": "haahh", "link": "https://stackoverflow.com/users/1015320/haahh"}, "is_accepted": true, "score": 2, "last_activity_date": 1498117244, "creation_date": 1498117244, "answer_id": 44693143, "question_id": 44683163, "link": "https://stackoverflow.com/questions/44683163/clcreatebuffer-never-fails/44693143#44693143", "title": "clCreateBuffer() never fails", "body": "<p>I may happen if OpenCL platform has lazy memory allocation (almost every platform does that). I guess some OpenCL platforms just check if what you requested can be allocated on <code>clCreateBuffer</code>, and maybe yours doesn't. You will probably get an error on the first OpenCL functions that actually uses your buffer, like <code>clEnqueueWriteBuffer()</code> etc. What is your OpenCL platform?</p>\n"}], "owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 1, "accepted_answer_id": 44693143, "answer_count": 1, "score": 0, "last_activity_date": 1498117244, "creation_date": 1498068059, "question_id": 44683163, "link": "https://stackoverflow.com/questions/44683163/clcreatebuffer-never-fails", "title": "clCreateBuffer() never fails", "body": "<p>Intending to use ALL the available on-GPU memory for my algorithm, so retrieving it's amount with:</p>\n\n<pre><code>clGetDeviceInfo( ..., CL_DEVICE_GLOBAL_MEM_SIZE, ... );\n</code></pre>\n\n<p>which is <strong>536543232</strong> bytes, and then allocate it on GPU with:</p>\n\n<pre><code>clCreateBuffer( gpuContext, CL_MEM_READ_WRITE, 536543232, NULL, &amp; errcode_ret );\n</code></pre>\n\n<p>Wondered why it worked and if it would fail if try to allocate some more memory? Tried out 100 gigs and it still worked!</p>\n\n<pre><code>clCreateBuffer( gpuContext, CL_MEM_READ_WRITE, 100000000000, NULL, &amp; errcode_ret );\n</code></pre>\n\n<p>So the question is why it works with whatever amount of memory specified?</p>\n"}, {"tags": ["c++", "c++11", "constructor"], "answers": [{"comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498069374, "post_id": 44683385, "comment_id": 76351148, "body": "Can you give me a standard reference to support this? I&#39;m having trouble backing up the claim. The standard appears to me to specify otherwise (N3337 12.8/11, 9/6, 12.8/12)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498069554, "post_id": 44683385, "comment_id": 76351263, "body": "@AndyG The linked to answer has all the quotes to back up my assertion.  Also what about 12.8/11 makes you think it is not allowed?"}, {"owner": {"reputation": 117, "user_id": 6118236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df6c3e9ff1d1cd390d620506674943c8?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Guo", "link": "https://stackoverflow.com/users/6118236/andy-guo"}, "edited": false, "score": 0, "creation_date": 1498069695, "post_id": 44683385, "comment_id": 76351354, "body": "I find that &quot;a non-static data member of class type M (or array thereof) that cannot be <b>copied/moved</b> because overload resolution&quot;."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498070524, "post_id": 44683385, "comment_id": 76351870, "body": "@NathanOliver: The part about references in the linked answer clears things up, but honestly it reads to me like there&#39;s a contradiction in the standard. 12.8/11 states that a defaulted move constructor is deleted if <code>X</code> has a non-static data member that does not have a move constructor and is not trivially copyable. Of course it doesn&#39;t have a move ctor because it has a user-provided copy ctor. And it&#39;s not trivially copyable (9/6) because it has a user-provided copy ctor (12.8/12)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498070660, "post_id": 44683385, "comment_id": 76351972, "body": "@AndyG I think your reading 12.8/11 wrong.  It states <i>a non-static data member of class type M (or array thereof) that cannot be copied/moved because overload resolution[...]</i>  It says <i>copied/moved</i>. There is no requirement that it be trivial."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498071042, "post_id": 44683385, "comment_id": 76352184, "body": "@AndyG Never mind,  it was me.  I think the line you are referencing was removed with a DR.  <i>for the move constructor, a non-static data member or direct or virtual base class with a type that does not have a move constructor and is not trivially copyable.</i> does not exist starting in at least N3690."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498071183, "post_id": 44683385, "comment_id": 76352260, "body": "Found a DR from <a href=\"https://stackoverflow.com/a/20609313/4342498\">this answer</a>"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498071224, "post_id": 44683385, "comment_id": 76352287, "body": "@NathanOliver: You are, of course, correct. The bullet point I cited is a few down from the one you just mentioned. The two have no stated precedence, but I think that it&#39;s clear the one you cited should take precedence over the one I cited."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498071332, "post_id": 44683385, "comment_id": 76352356, "body": "@NathanOliver: Wow 2 comments in the time it took me to write that last one! So it seems that the wording was changed between N3337 and the published standard?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1498071403, "post_id": 44683385, "comment_id": 76352401, "body": "@AndyG Yes.  It was a defect on the standard and has been recitifed.  IIRC DR&#39;s backdated to the standard they are for so it applies to the C++11 standard."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498071567, "post_id": 44683385, "comment_id": 76352505, "body": "@NathanOliver: Excellent research. Maybe the book that OP cites was not wrong when it was written :-)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498071653, "post_id": 44683385, "comment_id": 76352563, "body": "@AndyG Could be.  Think I should change that part?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498076814, "post_id": 44683385, "comment_id": 76355444, "body": "@NathanOliver: Nah, your statement is technically correct."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 3, "last_activity_date": 1498068871, "creation_date": 1498068871, "answer_id": 44683385, "question_id": 44683115, "link": "https://stackoverflow.com/questions/44683115/move-constructor-is-automatic-generated-even-a-member-doesnt-have-a-move-constr/44683385#44683385", "title": "Move constructor is automatic generated even a member doesn&#39;t have a move constructor?", "body": "<p>Your book seems to be wrong.  <a href=\"https://stackoverflow.com/questions/33939644/understanding-stdis-move-constructible\">Copying is a valid move operation</a> so as long as the member has a copy constructor in the form of <code>const type&amp;</code>, so it can bind to rvalues, the move operation will fall back to a copy.</p>\n\n<p>In your example</p>\n\n<pre><code>hasX(hasX &amp;&amp;) = default;\n</code></pre>\n\n<p>Can be replaced with</p>\n\n<pre><code>hasX(hasX &amp;&amp;rhs) : mem(std::move(rhs.mem)) {}\n</code></pre>\n\n<p>as that is what the default does and it will compile just fine.</p>\n"}], "owner": {"reputation": 117, "user_id": 6118236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df6c3e9ff1d1cd390d620506674943c8?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Guo", "link": "https://stackoverflow.com/users/6118236/andy-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "accepted_answer_id": 44683385, "answer_count": 1, "score": 5, "last_activity_date": 1498068871, "creation_date": 1498067894, "question_id": 44683115, "link": "https://stackoverflow.com/questions/44683115/move-constructor-is-automatic-generated-even-a-member-doesnt-have-a-move-constr", "title": "Move constructor is automatic generated even a member doesn&#39;t have a move constructor?", "body": "<p>Quoted from <em>C++ Primer</em></p>\n\n<blockquote>\n  <p>if we explicitly ask the compiler to generate a move operation by\n  using <code>= default</code>, and the compiler is unable to move all the\n  members, then the move operation will be defined as deleted</p>\n  \n  <p>the move constructor is defined as deleted <strong>if the\n  class has a member that defines its own copy constructor but does not also\n  define a move constructor</strong>, or if the class has a member that doesn\u2019t define its\n  own copy operations and for which the compiler is unable to synthesize a move\n  constructor</p>\n</blockquote>\n\n<p>Some code seems to violate this rule:</p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;iostream&gt;\n\nstruct X {\n    X() = default;\n    X(const X&amp;) { std::cout &lt;&lt; \"X(const X&amp;)\" &lt;&lt; std::endl; }\n    int i;\n};\n\nstruct hasX {\n    hasX() = default;\n    hasX(const hasX &amp;) = delete;\n    hasX(hasX &amp;&amp;) = default;\n    X mem;\n};\n\n\nint main()\n{\n    hasX hx, hx2 = std::move(hx);  //output is X(const X&amp;)\n}\n</code></pre>\n\n<p><code>X</code> doesn't define move constructor and compiler can't synthesize one for it.</p>\n\n<p>According to the rule above, <code>hasX</code>'s move constructor is deleted.</p>\n\n<p>However, because <code>hasX</code>'s copy constructor is deleted, <code>hx2 = std::move(hx)</code> must call move constructor to output <code>\"X(const X&amp;)\"</code>, which shows <code>hasX</code>'s move constructor is defined and it use <code>X</code>'s copy constructor to \"move\". This seems to violate the rule above.</p>\n\n<p>So, is't defined in C++ standard or just a compiler implementation? </p>\n\n<p>Compiler I tested: VS2015 and <a href=\"http://cpp.sh/7rwdy\" rel=\"noreferrer\">a online compiler</a></p>\n\n<p>Thank you for help!</p>\n"}, {"tags": ["c++", "while-loop"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1498067948, "post_id": 44683047, "comment_id": 76350353, "body": "If your entering a <code>0</code> at the end then <code>cin &gt;&gt; number_entered;</code> is going to store it into <code>number_entered</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1498068130, "post_id": 44683047, "comment_id": 76350455, "body": "You might want to delete this then."}], "answers": [{"comments": [{"owner": {"reputation": 13028, "user_id": 1401351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993d07ca1cd59dd11d96a896e7c804d0?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1401351/peter"}, "edited": false, "score": 0, "creation_date": 1498068418, "post_id": 44683264, "comment_id": 76350629, "body": "They are unconditionally assigned by the extra input statement before the loop begins."}], "tags": [], "owner": {"reputation": 24, "user_id": 8195883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d822abbe83c3d0acbca21cd390a9d65?s=128&d=identicon&r=PG", "display_name": "klocur", "link": "https://stackoverflow.com/users/8195883/klocur"}, "is_accepted": false, "score": -2, "last_activity_date": 1498068361, "creation_date": 1498068361, "answer_id": 44683264, "question_id": 44683047, "link": "https://stackoverflow.com/questions/44683047/c-accepting-0-into-while-loop-illegally/44683264#44683264", "title": "c++ accepting 0 into while loop illegally", "body": "<p>Because your initial values are zeros. There is no way that you will enter number lower (for positives) and higher (for negatives) than zero.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7993579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ae2b73c32819e16bea4971979930a27?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Lemur", "link": "https://stackoverflow.com/users/7993579/lee-lemur"}, "is_accepted": false, "score": 0, "last_activity_date": 1498071911, "creation_date": 1498071911, "answer_id": 44684324, "question_id": 44683047, "link": "https://stackoverflow.com/questions/44683047/c-accepting-0-into-while-loop-illegally/44684324#44684324", "title": "c++ accepting 0 into while loop illegally", "body": "<p>I figured it out finally, but maybe I posted the answer badly and that was why I didn't get the answer I needed.</p>\n\n<p>in order to get a max that wasn't 0 for the negative values, I simply needed to move my || (negmax == 0) condition to the correct if statement (it was on the minimum branch).</p>\n\n<p>There were no other issues with the program.</p>\n"}], "owner": {"reputation": 31, "user_id": 7993579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ae2b73c32819e16bea4971979930a27?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Lemur", "link": "https://stackoverflow.com/users/7993579/lee-lemur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1498071911, "creation_date": 1498067701, "last_edit_date": 1498067913, "question_id": 44683047, "link": "https://stackoverflow.com/questions/44683047/c-accepting-0-into-while-loop-illegally", "title": "c++ accepting 0 into while loop illegally", "body": "<p>Here is the objective: \"Write a c++ program which prompts the user to enter some numbers and finds the minimum, maximum, and count\n(number) of the entered numbers separately for the positive and negative numbers. It then prints out this information\nin the correct format. Entering 0 should terminate the input sequence and cause the results to be displayed.</p>\n\n<p>My problem is, when I run the code through www.cpp.sh, it seems to be storing the 0 that I use to end the sequence to a maximum or a minimum variable (posmax and negmax or posmin and negmin). My while loop's condition is number_entered !=0, so 0 shouldn't even be going into the loop...\n<a href=\"https://i.stack.imgur.com/K3MuY.png\" rel=\"nofollow noreferrer\">if the first 3 in the sequence are negative and the last 3 are positive;  </a> <a href=\"https://i.stack.imgur.com/aj1z5.png\" rel=\"nofollow noreferrer\">if the first 3 in the sequence are positive and the last 3 are negative</a></p>\n\n<p>Stranger still, the 0 being stored as a minimum or negative only seems to happen to the last sequence of variables entered. </p>\n\n<p>Relevant code:</p>\n\n<pre><code>int main()\n{\n\ndouble number_entered, posmax, posmin, negmax, negmin;\nint positive_count, negative_count;\npositive_count = 0;\nnegative_count = 0;\nposmax = 0;\nposmin = 0;\nnegmax = 0;\nnegmin = 0;\n\n//before it goes into a loop it will do the following:\ncout &lt;&lt; \"Entering 0 will terminate the sequence of values.\\n\" &lt;&lt; endl; \ncout &lt;&lt; \"Enter a number: \";                                 \ncin &gt;&gt; number_entered;   //stores input to number_entered\n\n if (number_entered &gt; 0) //if positive  \n { \n    posmax = number_entered;   //needs to be initialized before use in loop\n    posmin = number_entered;   //needs to be initialized before use in loop\n }\n else if (number_entered &lt; 0) //if negative\n {\n    negmax = number_entered;   //needs to be initialized before use in loop\n    negmin = number_entered;   //needs to be intiialized before use in loop\n }\n\nwhile (number_entered !=0) //will keep looping as long as the while condition is true\n{ \n  if (number_entered &gt; 0) //branch if number_entered is positive \n  {  \n        if ( number_entered &gt; posmax) //sub-branch to compare to get max \n    { \n        posmax = number_entered; //if number is larger than the current max, it gets stored as the new max \n    } \n    else if ((number_entered &lt; posmin)||(posmin == 0)) //sub-branch to compare to get min; since posmin is initialized to 0 it needs to be updated\n    {  \n        posmin = number_entered; //if number is less than min than it gets stored as the new min\n    }\n  positive_count++; //under main if branch for if the number is positive, add to positive_count\n}\nelse if (number_entered &lt; 0) //branch for if number_entered is negative\n{  \n    if ( number_entered &gt; negmax) //sub-branch if number_entered is more than the max\n    { \n        negmax = number_entered; //it then gets stored as the new negmax\n    } \n    else if ((number_entered &lt; negmin)||(negmin == 0)) //sub-branch if number_entered is less than min; since negmin is initialized to 0 it needs to be updated\n    {  \n        negmin = number_entered; //it then gets stored as the new negmin\n    }\n    negative_count++;\n}\ncout &lt;&lt; \"Enter a number: \"; //prompts for input again after it is done counting, and comparing to store a max and min\ncin &gt;&gt; number_entered;\n} //end of while loop\n\nif (number_entered == 0) \n{\n    cout &lt;&lt; endl;\n    if ((negative_count &gt; 0) &amp;&amp; (positive_count &gt; 0))   //for situations where it received both positive and negative values\n    {\n    cout &lt;&lt; \"There were \" &lt;&lt; negative_count &lt;&lt; \" negative values entered, with minimum \"&lt;&lt; negmin &lt;&lt; \" and maximum \" &lt;&lt; negmax &lt;&lt; endl &lt;&lt; endl;\n    cout &lt;&lt; \"There were \" &lt;&lt; positive_count &lt;&lt; \" positive values entered, with minimum \"&lt;&lt; posmin &lt;&lt; \" and maximum \" &lt;&lt; posmax &lt;&lt; endl&lt;&lt; endl;\n} \nelse if (negative_count &gt; 0 &amp;&amp; positive_count == 0) //for sitautions where only negative input was received\n{\n    cout &lt;&lt; \"There were \" &lt;&lt; negative_count &lt;&lt; \" negative values entered, with minimum \"&lt;&lt; negmin &lt;&lt; \" and maximum \" &lt;&lt; negmax &lt;&lt; endl &lt;&lt; endl;\n    cout &lt;&lt; \"No positive numbers were entered\" &lt;&lt; endl;\n} \nelse if (positive_count &gt; 0 &amp;&amp; negative_count == 0) //for situations where only positive input was received \n{ \n  cout &lt;&lt; \"There were \" &lt;&lt; positive_count &lt;&lt; \" positive values entered, with minimum \"&lt;&lt; posmin &lt;&lt; \" and maximum \" &lt;&lt; posmax &lt;&lt; endl&lt;&lt; endl;\n  cout &lt;&lt; \"No negative numbers were entered\" &lt;&lt; endl;\n} \nelse if (negative_count == 0 &amp;&amp; positive_count == 0) //for if only 0 was received\n{\ncout &lt;&lt; \"No positive numbers were entered.\\n\"\n      &lt;&lt; endl\n      &lt;&lt; \"No negative numbers were entered.\\n\"\n      &lt;&lt; endl;\n} //end of nested branching if-else if statement\n} //end of if statement\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "sql-delete", "qsqldatabase"], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 8195883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d822abbe83c3d0acbca21cd390a9d65?s=128&d=identicon&r=PG", "display_name": "klocur", "link": "https://stackoverflow.com/users/8195883/klocur"}, "is_accepted": true, "score": 1, "last_activity_date": 1498068869, "last_edit_date": 1498068869, "creation_date": 1498068685, "answer_id": 44683338, "question_id": 44682940, "link": "https://stackoverflow.com/questions/44682940/trying-to-delete-from-database-on-qt-table/44683338#44683338", "title": "Trying to delete from database on QT table", "body": "<p>Try this in your function:    </p>\n\n<pre><code>DELETE FROM student WHERE studentid=....\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3304341, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FzrrV.jpg?s=128&g=1", "display_name": "foutzos", "link": "https://stackoverflow.com/users/3304341/foutzos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 0, "accepted_answer_id": 44683338, "answer_count": 1, "score": 0, "last_activity_date": 1540832442, "creation_date": 1498067303, "last_edit_date": 1540832442, "question_id": 44682940, "link": "https://stackoverflow.com/questions/44682940/trying-to-delete-from-database-on-qt-table", "title": "Trying to delete from database on QT table", "body": "<p>I have a database named student with 4 fields (<code>name</code> , <code>lastname</code>, <code>semester</code> and <code>studentid</code>). </p>\n\n<p>I have an application connected that lets the user inserts students in the database having an option to show them on a table after the inserts. </p>\n\n<p>Table has a <code>DELETE</code> button for every insert-student which I have connected to separate function to let the user having the option to delete individually students based on the <code>studentid</code>.</p>\n\n<p>Problem is that I seem to do something wrong as the delete button doesn't work when its clicked. I get no error though so I need your help finding the bug.</p>\n\n<p>Database created code:</p>\n\n<pre><code>Database::Database()\n{\n    db = QSqlDatabase::addDatabase(\"QSQLITE\");\n    db.setDatabaseName(\"students.db\");\n    db.open();\n    QSqlQuery q(db);\n    q.exec(QString(\"DROP TABLE student;\"));\n\n    q.exec(QString(\"create table if not exists student(\")+\n                        QString(\"id integer primary key autoincrement,\")+\n                        QString(\"name varchar(1024),lastname varchar(1024),semester integer,\")+\n                        QString(\"studentid integer)\"));\n}\n</code></pre>\n\n<p>Delete from database called in database.cpp</p>\n\n<pre><code>void    Database::deleteStudent(int id)\n{\n    QSqlQuery query(db);\n    query.exec(\"DELETE student where studentid=\"+QString::number(id));\n}\n</code></pre>\n\n<p>MainWindow.cpp</p>\n\n<p>//Creating the Table-LIST of the inserts</p>\n\n<pre><code>    void    MainWindow::makeDisplayForm()\n    {\n        QWidget *tab2=new QWidget;\n        panel-&gt;addWidget(tab2);\n        tab2-&gt;setFixedSize(95*this-&gt;size().width()/100,this-&gt;size().height()/2);\n        QVBoxLayout *tab2layout=new QVBoxLayout;\n        tab2-&gt;setLayout(tab2layout);\n        table=new QTableWidget;\n        table-&gt;setRowCount(1);\n        table-&gt;setColumnCount(5);\n        QStringList header;\n        header&lt;&lt;\"NAME\"&lt;&lt;\"LASTNAME\"&lt;&lt;\"SEMESTER\"&lt;&lt;\"ID\"&lt;&lt;\"DELETE\";\n        table-&gt;setHorizontalHeaderLabels(header);\n        tab2layout-&gt;addWidget(table);\n    }\n\nvoid    MainWindow::reloadTable()\n{\n    QVector&lt;Student&gt; p=mydb-&gt;students();\n    table-&gt;clearContents();\n    table-&gt;setRowCount(p.size());\n    for(int i=0;i&lt;p.size();i++)\n    {\n        Student pt=p[i];\n        QLineEdit *tableName=new QLineEdit;\n        tableName-&gt;setText(pt.getname());\n        table-&gt;setCellWidget(i,0,tableName);\n\n        QLineEdit *tableLastName=new QLineEdit;\n        tableLastName-&gt;setText(pt.getlastname());\n        table-&gt;setCellWidget(i,1,tableLastName);\n\n\n        table-&gt;setItem(i,2,new QTableWidgetItem(QString::number(pt.getsemester())));\n        table-&gt;setItem(i,3,new QTableWidgetItem(QString::number(pt.getstudentid())));\n\n        //DELETE BUTTON CREATE\n        QPushButton *deleteButton=new QPushButton;\n        deleteButton-&gt;setText(\"DELETE\");\n        connect(deleteButton,SIGNAL(clicked(bool)),this,SLOT(deleteSlot()));\n        deleteButton-&gt;setProperty(\"STUDENTID\",pt.getstudentid());\n        table-&gt;setCellWidget(i,4,deleteButton);\n\n    }\n}\n</code></pre>\n\n<p>//DELETE button connect function.</p>\n\n<pre><code>void    MainWindow::deleteSlot()\n{\n    QPushButton *b=(QPushButton *)sender();\n    int studtid=b-&gt;property(\"STUDENTID\").toInt();\n    mydb-&gt;deleteStudent(studtid);\n    reloadTable();\n}\n</code></pre>\n\n<p>//Reload table is called after the delete function in order to show the new database without the deleted student.</p>\n\n<p>Student.cpp</p>\n\n<pre><code>#include \"student.h\"\n\nStudent::Student()\n{\n    name=\"\";\n    lastname=\"\";\n    studentid=0;\n    semester=0;\n}\n\nStudent::Student(QString n,QString l,int s,int p)\n{\n    name=n;\n    lastname=l;\n    semester=s;\n    studentid=p;\n}\n\nint Student::getstudentid()\n{\n    return studentid;\n}\n</code></pre>\n\n<p>UPDATE: if I change <code>void    Database::deleteStudent(int id)</code>query to: </p>\n\n<pre><code>query.exec(QString(\"DROP TABLE student;\"));\n</code></pre>\n\n<p>Table is deleted just fine after the delete button so its something wrong with studentid or the query? I need to delete individual inserts not all the table.</p>\n"}, {"tags": ["c++", "gcc", "linker", "custom-sections"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 1543085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5818618e52c3f48557b23110811f66e6?s=128&d=identicon&r=PG&f=1", "display_name": "EThome", "link": "https://stackoverflow.com/users/1543085/ethome"}, "edited": false, "score": 0, "creation_date": 1498166409, "post_id": 44707291, "comment_id": 76401983, "body": "Thanks! Indeed it&#39;s an effective way to discard the references to the discarded section. I couldn&#39;t find proper semantics for gas section groups beyond the terse binutils doc. It&#39;s not entirely clear to me when merging happens or does not happen, and whether I have full control of it."}], "tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": true, "score": 1, "last_activity_date": 1498157577, "creation_date": 1498157577, "answer_id": 44707291, "question_id": 44682732, "link": "https://stackoverflow.com/questions/44682732/weak-symbols-and-custom-sections-in-inline-assembly/44707291#44707291", "title": "weak symbols and custom sections in inline assembly", "body": "<p>g++ (5,6, at least) compiles an inline function with external linkage - such as\n<code>template&lt;&gt; inline int frob&lt;int&gt;(int x)</code> - at a weak global\nsymbol in a <a href=\"https://stackoverflow.com/q/1834597/1362568\">[COMDAT]</a> <a href=\"https://stackoverflow.com/q/4274804/1362568\">[function-section]</a> in\nits own section-group. See:-</p>\n\n<pre><code>g++ -S -O0 bar.cpp\n</code></pre>\n\n<p><strong>bar.s</strong></p>\n\n<pre><code>    .file   \"bar.cpp\"\n    .section    .text._Z4frobIiET_S0_,\"axG\",@progbits,_Z4frobIiET_S0_,comdat\n    .weak   _Z4frobIiET_S0_\n    .type   _Z4frobIiET_S0_, @function\n_Z4frobIiET_S0_:\n.LFB0:\n    .cfi_startproc\n    pushq   %rbp\n    .cfi_def_cfa_offset 16\n    .cfi_offset 6, -16\n    movq    %rsp, %rbp\n    .cfi_def_cfa_register 6\n    movl    %edi, -4(%rbp)\n#APP\n# 8 \"frob.hpp\" 1\n    1: nop\n.pushsection \"extra\",\"a\"\n.quad 1b\n.popsection\n\n# 0 \"\" 2\n#NO_APP\n    movl    -4(%rbp), %eax\n    addl    $1, %eax\n    popq    %rbp\n    .cfi_def_cfa 7, 8\n    ret\n    .cfi_endproc\n...\n...\n</code></pre>\n\n<p>The relevant directives are:</p>\n\n<pre><code>    .section    .text._Z4frobIiET_S0_,\"axG\",@progbits,_Z4frobIiET_S0_,comdat\n    .weak   _Z4frobIiET_S0_\n</code></pre>\n\n<p>(The compiler-generated <code>#APP</code> and <code>#NO_APP</code> delimit your inline assembly). </p>\n\n<p>Do as the compiler does by making <code>extra</code> likewise a COMDAT section in\na section-group:</p>\n\n<p><strong>frob.hpp (fixed)</strong></p>\n\n<pre><code>template&lt;typename T&gt; T frob(T x);\n\ntemplate&lt;&gt; inline int frob&lt;int&gt;(int x) {\n    asm(\"1: nop\\n\"\n            \".pushsection \\\"extra\\\", \\\"axG\\\", @progbits,extra,comdat\" \"\\n\"\n            \".quad 1b\\n\"\n            \".popsection\\n\");\n    return x+1;\n}\n</code></pre>\n\n<p>and the linkage error will be cured:</p>\n\n<pre><code>$ g++ -O0 foo.cpp  bar.cpp \n$ ./a.out; echo $?\n61\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 1543085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5818618e52c3f48557b23110811f66e6?s=128&d=identicon&r=PG&f=1", "display_name": "EThome", "link": "https://stackoverflow.com/users/1543085/ethome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "accepted_answer_id": 44707291, "answer_count": 1, "score": 2, "last_activity_date": 1498157577, "creation_date": 1498066622, "last_edit_date": 1498066765, "question_id": 44682732, "link": "https://stackoverflow.com/questions/44682732/weak-symbols-and-custom-sections-in-inline-assembly", "title": "weak symbols and custom sections in inline assembly", "body": "<p>I'm stuck with a problem which is illustrated by the following g++ code:</p>\n\n<p>frob.hpp:</p>\n\n<pre><code>template&lt;typename T&gt; T frob(T x);\n\ntemplate&lt;&gt; inline int frob&lt;int&gt;(int x) {\n    asm(\"1: nop\\n\"\n            \".pushsection \\\"extra\\\",\\\"a\\\"\\n\"\n            \".quad 1b\\n\"\n            \".popsection\\n\");\n    return x+1;\n}\n</code></pre>\n\n<p>foo.cpp:</p>\n\n<pre><code>#include \"frob.hpp\"\n\nextern int bar();\n\nint foo() { return frob(17); }\n\nint main() { return foo() + bar(); }\n</code></pre>\n\n<p>bar.cpp:</p>\n\n<pre><code>#include \"frob.hpp\"\nint bar() { return frob(42); }\n</code></pre>\n\n<p>I'm doing these quirky custom section things as a way to mimick <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/tree/Documentation/x86/exception-tables.txt\" rel=\"nofollow noreferrer\">the mechanism here in the linux kernel</a> (but in a userland and C++ way).</p>\n\n<p>My problem is that the instantiation of <code>frob&lt;int&gt;</code> is recognized as a weak symbol, which is fine, and one of the two is eventually elided by the linker, which is fine too. Except that the linker is not disturbed by the fact that the <code>extra</code> section has references to that symbol (via <code>.quad 1b</code>), and the linker want to resolve them locally. I get:</p>\n\n<pre><code>localhost /tmp $ g++ -O3 foo.cpp  bar.cpp \nlocalhost /tmp $ g++ -O0 foo.cpp  bar.cpp \n`.text._Z4frobIiET_S0_' referenced in section `extra' of /tmp/ccr5s7Zg.o: defined in discarded section `.text._Z4frobIiET_S0_[_Z4frobIiET_S0_]' of /tmp/ccr5s7Zg.o\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>(<code>-O3</code> is fine because no symbol is emitted altogether).</p>\n\n<p>I don't know how to work around this.</p>\n\n<ol>\n<li>would there be a way to tell the linker to also pay attention to symbol resolution in the <code>extra</code> section too ?</li>\n<li><p>perhaps one could trade the local labels for <code>.weak</code> global labels ? E.g. like in:</p>\n\n<pre><code>asm(\".weak exception_handler_%=\\n\"\n    \"exception_handler_%=: nop\\n\"\n    \".pushsection \\\"extra\\\",\\\"a\\\"\\n\"\n    \".quad exception_handler_%=\\n\"\n    \".popsection\\n\"::);\n</code></pre>\n\n<p>However I fear that if I go this way, distinct asm statements in distinct compilation units may get the same symbol via this mechanism (may they ?).</p></li>\n</ol>\n\n<p>Is there a way around that I've overlooked ?</p>\n"}, {"tags": ["c++", "loops", "dictionary", "iterator", "segmentation-fault"], "comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498066514, "post_id": 44682645, "comment_id": 76349601, "body": "This is a typical <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. Your complications arise because of the strange design of nested maps. Why don&#39;t you simply use a single map, for example <code>std::map&lt;std::pair&lt;int,int&gt;,float&gt;</code>?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498070520, "post_id": 44682645, "comment_id": 76351866, "body": "@Walter no, it&#39;s your <i>answer</i> that&#39;s the XY problem. There&#39;s nothing wrong with using nested maps, even if there&#39;s an easier way of doing things - it shouldn&#39;t cause a crash."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498121694, "post_id": 44682645, "comment_id": 76372428, "body": "Have you tried to insert the new inner value pair <b>without</b> giving the hint? That is <code>pi_matrix.at(lj).insert(std::make_pair(li,1.f));</code>"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498124103, "post_id": 44682645, "comment_id": 76374232, "body": "Have you checked whether the error occurs in <code>numb_lj[it_lj-&gt;first]</code> or in <code>max_pi[it_lj-&gt;first]</code>? As you failed to produce a MVCE, I cannot tell. Perhaps replace <code>[i]</code> here with <code>.at(i)</code> to check for access violation."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498146430, "post_id": 44682645, "comment_id": 76391030, "body": "@Walter if the hint is incorrect it shouldn&#39;t matter, it&#39;s just an optimization - the correct insertion point should always be used regardless of the hint."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7227911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b6e6d57323f217c66199fe8b2024d3?s=128&d=identicon&r=PG&f=1", "display_name": "mbuffier", "link": "https://stackoverflow.com/users/7227911/mbuffier"}, "edited": false, "score": 0, "creation_date": 1498082495, "post_id": 44682775, "comment_id": 76357949, "body": "Thank you for your answer ! Indeed it was simpler .. I rewrote it with your method, it does what it&#39;s suppose to do but, once again, crashes with a segmentation fault after few iterations.."}, {"owner": {"reputation": 11, "user_id": 7227911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b6e6d57323f217c66199fe8b2024d3?s=128&d=identicon&r=PG&f=1", "display_name": "mbuffier", "link": "https://stackoverflow.com/users/7227911/mbuffier"}, "edited": false, "score": 0, "creation_date": 1498082705, "post_id": 44682775, "comment_id": 76358032, "body": "We agree that everythig i&#39;m using here will be detroyed at the end of the function as i&#39;m not using any &quot;new&quot; ?"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 11, "user_id": 7227911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b6e6d57323f217c66199fe8b2024d3?s=128&d=identicon&r=PG&f=1", "display_name": "mbuffier", "link": "https://stackoverflow.com/users/7227911/mbuffier"}, "edited": false, "score": 0, "creation_date": 1498121175, "post_id": 44682775, "comment_id": 76372024, "body": "@mbuffier Which function? You don&#39;t have a function! So nothing will be destroyed. I though that this map is a member of a class, and hence its lifetime that of the corresponding class object."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 11, "user_id": 7227911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b6e6d57323f217c66199fe8b2024d3?s=128&d=identicon&r=PG&f=1", "display_name": "mbuffier", "link": "https://stackoverflow.com/users/7227911/mbuffier"}, "edited": false, "score": 1, "creation_date": 1498146604, "post_id": 44682775, "comment_id": 76391175, "body": "@mbuffier Please post and <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. As it stands, we cannot really help you. Moreover, the post is useless for others, so is liable to being closed. From your remark, it appears that the bug is not in the usage of <code>map</code>, but elsewhere (as I suggested in the comments to the question)."}], "tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 2, "last_activity_date": 1498069516, "last_edit_date": 1498069516, "creation_date": 1498066790, "answer_id": 44682775, "question_id": 44682645, "link": "https://stackoverflow.com/questions/44682645/bad-acces-iterator-on-map-c/44682775#44682775", "title": "BAD_ACCES iterator on map c++", "body": "<p>It appears that your design of a nested <code>map</code> is causing all sorts of unnecessary complications. More natural appears a single map with a <code>pair&lt;int,int&gt;</code> as key:</p>\n\n<pre><code>using key_type = std::pair&lt;int,int&gt;;\nusing map_type = std::map&lt;key_type,float&gt;;\n\nvoid add_to_map(map_type&amp;map, key_type const&amp;key)\n{\n    map[key] += 1.f;   // also works as desired if map.count(key)==0\n}\n\n// find key and value of first element with maximum value\nmap_type::value_type find_max(map_type const&amp;map)\n{\n    auto max = map.begin();\n    for(auto it=max; it!=map.end(); ++it)\n        if(it.second &gt; max.second)\n            max = it;\n    return *max;\n}\n</code></pre>\n\n<p>no need to juggle with <code>map::count</code> or <code>map::iterator</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7227911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b6e6d57323f217c66199fe8b2024d3?s=128&d=identicon&r=PG&f=1", "display_name": "mbuffier", "link": "https://stackoverflow.com/users/7227911/mbuffier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498069516, "creation_date": 1498066302, "question_id": 44682645, "link": "https://stackoverflow.com/questions/44682645/bad-acces-iterator-on-map-c", "title": "BAD_ACCES iterator on map c++", "body": "<p>I'm trying to implement a function using a map in a map like that :  </p>\n\n<pre><code>typedef std::map&lt;int, float&gt; inner_map;\ntypedef std::map&lt;int, inner_map&gt; outer_map;\n</code></pre>\n\n<p>I'm filling the map this way. The idea is the first map contains a int key and an other map which contains another key and a float. If the pair I obtain is known, I increment the value otherwise I fill the map. </p>\n\n<pre><code>for (int y = 2; y &lt; imgSize.y - 2; y++){\n    for (int x = 2; x &lt; imgSize.x - 2; x++) {\n        thisPos = x + y*imgSize.x ;\n\n        {SOME CODE}\n\n        lj = labelMap[thisPos] ;\n\n        if (condition) {\n            // get the 2 label \n            li = pro_label_mod[thisPos] ; \n\n            // look if it lj is in the map \n            is_lj = pi_matrix.count(lj) ;\n\n            // this lj has already been observed \n            if (is_lj == 1) {\n                is_li = pi_matrix[lj].count(li);\n\n                // this pair is known -&gt; I increment \n                if (is_li==1) {\n                    pi_matrix[lj][li] +=  1.0f ;\n                }\n                else {\n                     pi_matrix.at(lj).insert(pi_matrix[lj].end(), std::make_pair(li, 1.0f)) ;\n                }\n            }\n            else {\n                inner_map inter ; inter.insert(std::make_pair(li, 1.0f)) ;\n                pi_matrix.emplace(lj, inter) ;\n            }\n        }\n        numb_lj[lj] += 1.0f ;\n    }\n}\n</code></pre>\n\n<p>And then, I would like to iterate throught the map in my code. I did that with iterators such as : </p>\n\n<pre><code>std::vector&lt;std::pair&lt;int,float&gt; &gt; max_pi(size_lj) ;\n\nfloat maxValue, thisValue ; int label_max ; \n\nfor (outer_map::iterator it_lj = pi_matrix.begin(), it_lj_end = pi_matrix.end(); it_lj != it_lj_end; ++it_lj) {\n    maxValue = 0.0f ;\n    label_max = 0 ;\n\n    inner_map &amp;innerMap = it_lj-&gt;second;\n\n    for(inner_map::iterator it_li = innerMap.begin(), it_li_end = innerMap.end(); it_li != it_li_end; ++it_li) {\n        thisValue = it_li-&gt;second / numb_lj[it_lj-&gt;first] ;\n\n        if (thisValue &gt;= maxValue) {\n            maxValue = thisValue ;\n            label_max = it_li-&gt;first ;\n        }\n    }\n\n    max_pi[it_lj-&gt;first] = std::make_pair(label_max, maxValue) ;\n    i+=1;\n}\n</code></pre>\n\n<p>However, i'm getting a segmentation fault at the lines of the for loop (either the first one or the second one). BUT ! Not every time. I'm calling this function at each frame and I can have 5 calls without a BAD_ACCESS and suddenly, it crashes.. Sometimes after the first call and then the 10th.</p>\n\n<p>I really can't see why and how to solve it..</p>\n\n<p>Thank you in advance for any clues/comments which could be helpful ! </p>\n"}, {"tags": ["c++", "c", "pointers", "syntax"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 2, "creation_date": 1498065867, "post_id": 44682501, "comment_id": 76349241, "body": "So that you can write <code>int a, *b = &amp;a</code>."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1498065870, "post_id": 44682501, "comment_id": 76349243, "body": "Because the standard says so. Are you interested in the history behind this syntax decision?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1498065870, "post_id": 44682501, "comment_id": 76349242, "body": "How did this get +3 ??"}, {"owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "edited": false, "score": 0, "creation_date": 1498065886, "post_id": 44682501, "comment_id": 76349251, "body": "because the pointer somehow belongs to the variable, so it should be specified as: <code>int *left, *right, nopointer_just_int</code>"}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1498065950, "post_id": 44682501, "comment_id": 76349283, "body": "<code>node* left, right;</code> is same as <code>node *left, *right;</code> throught first one prefered. read a book first, its basic."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 1, "creation_date": 1498065982, "post_id": 44682501, "comment_id": 76349310, "body": "@rootTraveller, can you back up that assertion?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 1, "creation_date": 1498065983, "post_id": 44682501, "comment_id": 76349311, "body": "@rootTraveller Are you sure?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1498065995, "post_id": 44682501, "comment_id": 76349324, "body": "Variable declaration syntax is not <code>typename varname1, varname2</code>. The type information doesn&#39;t all go in one block on the left. (Arguably, it should have; C variable declaration syntax is confusing.)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 5, "creation_date": 1498066021, "post_id": 44682501, "comment_id": 76349342, "body": "@rootTraveller That is 100% wrong.  <code>node* left, right;</code> is the same as <code>node* left; node right;</code>"}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498066156, "post_id": 44682501, "comment_id": 76349415, "body": "@NathanOliver I did not get it, would you share some links ?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 1, "creation_date": 1498066231, "post_id": 44682501, "comment_id": 76349456, "body": "@rootTraveller Just look at the answers on the question this is closed as a duplicate of."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498066276, "post_id": 44682501, "comment_id": 76349478, "body": "@NathanOliver <code>node* left, right;</code> from here how do you guys getting this  <code>node right;</code>???"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 2, "creation_date": 1498066278, "post_id": 44682501, "comment_id": 76349479, "body": "@rootTraveller Would this link be good enough: <a href=\"https://ideone.com/sI2j2v\" rel=\"nofollow noreferrer\">ideone.com/sI2j2v</a> ?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1498066308, "post_id": 44682501, "comment_id": 76349498, "body": "And the reason for spamming tags of two different languages is?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1498066345, "post_id": 44682501, "comment_id": 76349516, "body": "@rootTraveller The pointer is attached to the variable name, not the type name.  In <code>node* left, right;</code> <code>right</code> is not a pointer.  That&#39;s just how pointers and references work."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 1, "creation_date": 1498066418, "post_id": 44682501, "comment_id": 76349555, "body": "@rootTraveller read a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good book</a> please."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1498066459, "post_id": 44682501, "comment_id": 76349583, "body": "@EugeneSh. I got it."}], "answers": [{"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1498065962, "post_id": 44682543, "comment_id": 76349292, "body": "This logic breaks with <code>decltype(i) k</code>."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1498066149, "post_id": 44682543, "comment_id": 76349411, "body": "@MaximEgorushkin I didn&#39;t realize the question was also tagged c++"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1498066356, "last_edit_date": 1498066356, "creation_date": 1498065903, "answer_id": 44682543, "question_id": 44682501, "link": "https://stackoverflow.com/questions/44682501/why-node-left-right-and-not-node-left-right/44682543#44682543", "title": "Why node *left,*right and not node* left,right?", "body": "<p>When programming in C, if you get in the habit of attaching the * to the variable names it will make more sense to you.</p>\n\n<pre><code>int *i,j;\n</code></pre>\n\n<p>i is an int* and j is an int.</p>\n"}, {"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1498066086, "post_id": 44682571, "comment_id": 76349377, "body": "Many would contest the assertion that this way is less awful."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1498066186, "post_id": 44682571, "comment_id": 76349429, "body": "True, but the point is that it&#39;s a choice between two schemes that each have their advantages and disadvantages."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1498066269, "post_id": 44682571, "comment_id": 76349472, "body": "<code>int[10] a;</code> What?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498067231, "post_id": 44682571, "comment_id": 76349976, "body": "@NathanOliver That&#39;s how you&#39;d declare an array if the rule was the one the OP suggests. Just like <code>int* a, b;</code> instead of <code>int *a, *b;</code> you&#39;d have <code>int[10] a, b;</code> instead of <code>int a[10], b[10];</code>. Unless you&#39;re suggesting something even more bizarre."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498067304, "post_id": 44682571, "comment_id": 76350013, "body": "@DavidSchwartz Oh.  I didn&#39;t get that you were showing how it would look if it was attached to the type."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1498074025, "last_edit_date": 1498074025, "creation_date": 1498066006, "answer_id": 44682571, "question_id": 44682501, "link": "https://stackoverflow.com/questions/44682501/why-node-left-right-and-not-node-left-right/44682571#44682571", "title": "Why node *left,*right and not node* left,right?", "body": "<p>You have to pick one way or the other, and this way is less awful. For an example of how awful the other way would be, compare:</p>\n\n<pre><code>int a[10], b[20], c[30];\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int[10] a;\nint[20] b;\nint[30] c;\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5327659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vxtCL.jpg?s=128&g=1", "display_name": "tejal567", "link": "https://stackoverflow.com/users/5327659/tejal567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "closed_date": 1498065983, "answer_count": 2, "score": -3, "last_activity_date": 1498074025, "creation_date": 1498065768, "question_id": 44682501, "link": "https://stackoverflow.com/questions/44682501/why-node-left-right-and-not-node-left-right", "closed_reason": "Duplicate", "title": "Why node *left,*right and not node* left,right?", "body": "<p>The type of left and right is node* so like other types they should be declared as node* left,right; Example int a,b; </p>\n"}, {"tags": ["c++", "class", "templates"], "comments": [{"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498064948, "post_id": 44682118, "comment_id": 76348686, "body": "why don&#39;t you put whole class buffer_view under template? Why only constructor?"}, {"owner": {"reputation": 1014, "user_id": 5090527, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3bc0e62835e7e6e91fff7a9e89a361e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/5090527/ramon"}, "reply_to_user": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498065264, "post_id": 44682118, "comment_id": 76348855, "body": "@MarekVitek I want to use <code>buffer_view</code> as a single type, so that I don&#39;t have to template functions or classes that use it. It&#39;s completely unrelated to my actual issue though (what I now know as Most vexing parse)"}, {"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498065352, "post_id": 44682118, "comment_id": 76348909, "body": "It looks, that is is compiling just fine <a href=\"https://godbolt.org/g/C2KkEJ\" rel=\"nofollow noreferrer\">godbolt.org/g/C2KkEJ</a> Any compiler options you have enabled? EDIT:I have changed wrong numbers. Now the link is correct."}, {"owner": {"reputation": 1014, "user_id": 5090527, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3bc0e62835e7e6e91fff7a9e89a361e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/5090527/ramon"}, "reply_to_user": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498065541, "post_id": 44682118, "comment_id": 76349049, "body": "Yeah that part works fine, this <code>buffer_view bview(buffer&lt;16&gt;()); foo(bview);</code> doesn&#39;t - unless I add another set of brackets <code>buffer_view bview((buffer&lt;16&gt;()));</code>"}, {"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498066151, "post_id": 44682118, "comment_id": 76349412, "body": "Answer to your problem is probably here <a href=\"https://stackoverflow.com/questions/3960849/c-template-constructor\">C++ template constructor</a>"}, {"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498067284, "post_id": 44682118, "comment_id": 76350003, "body": "I guess, it is because first and second bview in main are of different type. Try to change those lines to this  <code>buffer_view bview2=buffer_view(buffer&lt;16&gt;());</code>    <code>foo(bview2);</code> <a href=\"https://godbolt.org/g/tijoww\" rel=\"nofollow noreferrer\">godbolt.org/g/tijoww</a>"}, {"owner": {"reputation": 1014, "user_id": 5090527, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3bc0e62835e7e6e91fff7a9e89a361e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/5090527/ramon"}, "reply_to_user": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498071263, "post_id": 44682118, "comment_id": 76352314, "body": "<code>buffer_view</code> doesn&#39;t, and shouldn&#39;t, have a default constructor so that wouldn&#39;t work. The problem is that <code>buffer_view bview(buffer&lt;16&gt;())</code> is parsed as a function pointer, not as a <code>buffer_view</code> constructed with a temporary <code>buffer&lt;16&gt;</code> object - it&#39;s not a problem per se, that&#39;s how the standard defines it. See the question marked as a duplicate of, and <a href=\"https://en.wikipedia.org/wiki/Most_vexing_parse\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498075307, "post_id": 44682118, "comment_id": 76354680, "body": "Well I finally got it. See <a href=\"https://godbolt.org/g/NJDG8p\" rel=\"nofollow noreferrer\">this code</a> Due to my habit to instantiate by assignment I have made your problem go away. And by incorrectly modifying your code I did create myself completely new problem. Rather simple bug, I would say. I definitely learned something Today. I hope I didn&#39;t made too much confusion around."}, {"owner": {"reputation": 1014, "user_id": 5090527, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3bc0e62835e7e6e91fff7a9e89a361e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/5090527/ramon"}, "reply_to_user": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498082247, "post_id": 44682118, "comment_id": 76357840, "body": "In my actual code there wasn&#39;t a name conflict, I&#39;ve edited the question to show the second variable as <code>bview2</code>. What you are suggesting shouldn&#39;t work because <code>buffer_view</code> doesn&#39;t have a default constructor and the compiler can&#39;t generate one because I am defining one. So something like <code>buffer_view bview;</code> complains that there isn&#39;t a default constructor."}, {"owner": {"reputation": 1014, "user_id": 5090527, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3bc0e62835e7e6e91fff7a9e89a361e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/5090527/ramon"}, "reply_to_user": {"reputation": 1435, "user_id": 8113019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1b7cb4133be670ac94023c9fcc6816?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Vitek", "link": "https://stackoverflow.com/users/8113019/marek-vitek"}, "edited": false, "score": 0, "creation_date": 1498082255, "post_id": 44682118, "comment_id": 76357844, "body": "What is happening in your code is interesting though, because doing something like <code>buffer_view bview = buffer_view(buffer&lt;16&gt;());</code> allows the compiler to only <a href=\"http://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">call the constructor once and omit the copy</a>. So it uses the provided constructor and we get around the syntax. Nothing is really solved though as the syntax <code>buffer_view bview2(buffer&lt;16&gt;());</code> not working is the &quot;problem&quot; - not really one, as per the standard."}], "owner": {"reputation": 1014, "user_id": 5090527, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3bc0e62835e7e6e91fff7a9e89a361e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/5090527/ramon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1498064667, "answer_count": 0, "score": 0, "last_activity_date": 1498079424, "creation_date": 1498064409, "last_edit_date": 1592644375, "question_id": 44682118, "link": "https://stackoverflow.com/questions/44682118/unexpected-type-when-using-non-template-class-with-template-constructor", "closed_reason": "Duplicate", "title": "Unexpected type when using non-template class with template constructor", "body": "<p>I have defined a template <code>class buffer</code> and  another <code>class buffer_view</code> with a template constructor to take any definition of <code>class buffer</code>. The idea is for <code>buffer_view</code> to act as a single type reference-ish to any <code>buffer</code> type.</p>\n<pre><code>template&lt;size_t N&gt; class buffer\n{\nprivate:\n    friend class buffer_view;\n};\n\nclass buffer_view\n{\npublic:\n    template&lt;size_t N&gt;\n    buffer_view(const buffer&lt;N&gt;&amp; bfr)\n        :m_size(N) {}\n\n    size_t size() const { return m_size; }\n    \nprivate:\n    size_t m_size;\n};\n</code></pre>\n<p>It seems to work as expected:</p>\n<pre><code>void foo(const buffer_view&amp; bview)\n{\n    std::cout &lt;&lt; bview.size() &lt;&lt; &quot; _ &quot; &lt;&lt; std::flush;\n}\n\nint main() {\n    buffer&lt;8&gt; bfr;\n    buffer_view bview(bfr);\n\n    foo(bview);\n    foo(buffer_view(bfr));\n    foo(buffer_view(buffer&lt;32&gt;()));\n}\n</code></pre>\n<blockquote>\n<p>8 _ 8 _ 32 _</p>\n</blockquote>\n<p>However, this doesn't work:</p>\n<pre><code>buffer_view bview2(buffer&lt;16&gt;());\nfoo(bview2);\n</code></pre>\n<p><code>bview2</code> gets type <code>buffer_view (buffer&lt;16U&gt; (*)())</code> or <code>buffer_view (* )(buffer&lt;16u&gt; (*)())</code>?. See error messages:</p>\n<p>MSVC 15.1</p>\n<blockquote>\n<p>Error (active)    E0415   no suitable constructor exists to convert from &quot;buffer_view (buffer&lt;16U&gt; (*)())&quot; to &quot;buffer_view&quot;</p>\n</blockquote>\n<p>gcc 5.3.0</p>\n<blockquote>\n<p>error: invalid initialization of reference of type 'const buffer_view&amp;' from expression of type 'buffer_view (* )(buffer&lt;16u&gt; (*)())'</p>\n<p>note: in passing argument 1 of 'bool foo(const buffer_view&amp;)'</p>\n</blockquote>\n<p>Best I can tell the type <code>buffer_view (* )(buffer&lt;16u&gt; (*)())</code> is a function pointer to a function that returns <code>buffer_view</code> and takes as argument a function pointer to a function that takes no arguments and returns <code>buffer&lt;16u&gt;</code>?</p>\n<p>My question then is, what's going on? Why does it not work as expected when used in a named variable but it does when used in a temporary <code>foo(buffer_view(buffer&lt;32&gt;()))</code>? - the syntax seems similar to me.</p>\n"}, {"tags": ["c#", "c++", "dll", "native-code"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1498064650, "post_id": 44682077, "comment_id": 76348509, "body": "Well, i guess you have to go to the next round with the vendor of that library. The P/Invoke stuff you have shown in your question  doesn&#39;t reveal anything with regard to your problem. AccessViolation very much points towards a bug in that library (and if it were only you providing invalid argument values and the library failing to properly check the validity of the those values...)"}, {"owner": {"reputation": 11, "user_id": 7654385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea3de6babb294bb346260305929802a?s=128&d=identicon&r=PG&f=1", "display_name": "Harvey", "link": "https://stackoverflow.com/users/7654385/harvey"}, "edited": false, "score": 0, "creation_date": 1498064812, "post_id": 44682077, "comment_id": 76348601, "body": "Is there any more information I can show you that might help? I will post more of the .DLL"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1498065065, "post_id": 44682077, "comment_id": 76348747, "body": "No, unfortunately probably not. I don&#39;t know anything about that library. Your best chance is to either work with the vendor&#39;s technical support or visit a forum (if such exist) that is concerned with the boards and/or software you are using and where you hopefully could find people knowing the library, knowing about possible issues and possible workarounds/fixes..."}, {"owner": {"reputation": 11, "user_id": 7654385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea3de6babb294bb346260305929802a?s=128&d=identicon&r=PG&f=1", "display_name": "Harvey", "link": "https://stackoverflow.com/users/7654385/harvey"}, "edited": false, "score": 0, "creation_date": 1498065235, "post_id": 44682077, "comment_id": 76348831, "body": "All right, thank you so much for the tip."}], "owner": {"reputation": 11, "user_id": 7654385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea3de6babb294bb346260305929802a?s=128&d=identicon&r=PG&f=1", "display_name": "Harvey", "link": "https://stackoverflow.com/users/7654385/harvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498064999, "creation_date": 1498064300, "last_edit_date": 1498064999, "question_id": 44682077, "link": "https://stackoverflow.com/questions/44682077/calling-c-dll-from-c-getting-a-system-accessviolationexception", "title": "Calling C++ dll from C# Getting a System.AccessViolationException", "body": "<p>I'm working on a project that I need to control DC motors. These DC motors are connected to 2 boards. I statically linked the native code. Here is the code that I need to get called it is written in C++ from the manufacture.     </p>\n\n<pre><code>// system defs\ntypedef int (Sys_Initialise)();             // find all devices connected and open USB paths to them\ntypedef int (Sys_GetMotorHawkCount)();      // find number of motor hawks connected\ntypedef int (Sys_GetSwitchingHawkCount)();  // find number of switching hawks connected\ntypedef int (Sys_GetServoHawkCount)();      // find number of servo hawks connected\ntypedef int (Sys_GetAn128Count)();          // find number of analogue 128's connected\ntypedef int (Sys_GetDiyHawkCount)();            // find number of DIY hawks connected\ntypedef int (Sys_CloseAllDevices)();            // close all open paths to USB devices\n\n// motor hawk defs\ntypedef int (Motor_SetType)(int devnum, int type);              // choose motor type (stepper or DC Motors)\ntypedef int (Motor_RunSteps)(int devnum, int steps);                // set the number of steps to execute\ntypedef int (Motor_SetDCMotors)(int devnum, int M1Speed, int M1Dir, int M2Speed, int M2Dir);        // set the speed and direction of both DC motors\ntypedef int (Motor_GetDCMotors)(int devnum, int M1Speed, int M1Dir, int M2Speed, int M2Dir);    // get the speed and direction of both DC motors from the specified board\ntypedef int (Motor_GetType)(int devnum, int motor_type);                                            // get the type of motor currently configured for from the specified board\ntypedef int (Motor_GetStepper)(int devnum, int direction, int interval, int step_mode, int power, int steps, int run_mode, int paused);         // get the current stepper motor settings from the specified board\ntypedef int (Motor_GetStepsRemaining)(int devnum, int steps_remaining);         // get the current steps remaining from the specified board\ntypedef int (Motor_SetDigitalOutputs)(int devnum, int outputs);                 // set the digital outputs\ntypedef int (Motor_GetDigitalOutputs)(int devnum, int outputs);                 // get the current settings of the digital outputs\ntypedef int (Motor_GetDigitalInputs)(int devnum, int inputs);                   // get the current digital inputs\ntypedef int (Motor_SetLimitEnables)(int devnum, int m1_forward, int m1_reverse, int m2_forward, int m2_reverse);            // set the limit switch enables\ntypedef int (Motor_GetLimitEnables)(int devnum, int m1_forward, int m1_reverse, int m2_forward, int m2_reverse);        // get the current limit switch enable settings\ntypedef int (Motor_SetStepper)(int devnum, int direction, int interval, int step_mode, int power);                  // configure the stepper motor\ntypedef int (Motor_PauseStepper)(int devnum);                                       // temporarily pause the stepper motor\ntypedef int (Motor_ResumeStepper)(int devnum);                                  // resume running of the stepper motor\ntypedef int (Motor_StopStepper)(int devnum);                                        // stop the stepper motor and clear any remaining steps\ntypedef int (Motor_SetRunMode)(int devnum, int run_mode);                           // set the stepper running mode (once or continuous)\ntypedef int (Motor_ResetBoard)(int devnum);                                     // reset board\n\n// switching hawk defs\ntypedef int (Switching_SetOutputs)(int devnum, int outputs);        // set the outputs\ntypedef int (Switching_GetOutputs)(int devnum, int outputs);        // get the current outputs\n\n// servo hawk defs\ntypedef int (Servo_SetServos)(int devnum, int Servo1, int Servo2, int Servo3, int Servo4, int Servo5, int Servo6, int Servo7, int Servo8);          // set the servos\ntypedef int (Servo_GetServos)(int devnum, int Servo1, int Servo2, int Servo3, int Servo4, int Servo5, int Servo6, int Servo7, int Servo8);  // get the current servo positions\ntypedef int (Servo_SetOutputs)(int devnum, int outputs);        // set the outputs\ntypedef int (Servo_GetOutputs)(int devnum, int outputs);        // get the current outputs\n\n// analogue 128 defs\ntypedef int (An128_GetAnalogueInputs)(int devnum, int *AnInputs);       // get the current analogue inputs\ntypedef int (An128_SetSensitivities)(int devnum, int Sens1to16,int Sens17to32,int Sens33to48,int Sens49to64,int Sens65to80,int Sens81to96,int Sens97to112,int Sens113to128 );               // set the individual sensitivities required on all inputs\ntypedef int (An128_GetSensitivities)(int devnum, int Sens1to16,int Sens17to32,int Sens33to48,int Sens49to64,int Sens65to80,int Sens81to96,int Sens97to112,int Sens113to128 );       // get the individual sensitivities currently set on all inputs\n\n// DIY hawk defs\ntypedef int (Diy_SetOutputs)(int devnum, int outputs);          // set the outputs\ntypedef int (Diy_GetOutputs)(int devnum, int outputs);          // get the current outputs\ntypedef int (Diy_GetDigitalInputs)(int devnum, int inputs);     // get the current digital inputs\ntypedef int (Diy_GetAnalogueInputs)(int devnum, int inputs);        // get the current analogue inputs\n\n\n///////////////////////////////////////////////\n// other defs\n#define STEP_MODE_FULL  1\n#define STEP_MODE_HALF  2\n\n#define POWER_ZERO          1\n#define POWER_FRACTIONAL    2\n#define POWER_MAX           3\n\n#define MHK_STOPPED         0\n#define MHK_FORWARD         1       // direction of DC motors\n#define MHK_REVERSE         2\n\n#define STEPPER 0           // motor hawk is driving a stepper motor\n#define DCMOTORS    1           // motor hawk is driving two DC motors\n\n#define STEPPER_RUN_ONCE        0   // run the specified steps once\n#define STEPPER_RUN_CONTINUOUS  1   // run stepper continuously\n</code></pre>\n\n<p>When I run the debugger and I put a breakpoint on these two lines of code I get the System.AccessViolationException. When I spoke to the manufacturer they mentioned to change the target platform to a 32-bit which I did and it didn't fix anything. They also mentioned changing the Calling Conventions to a \"stdcall\" insead of \"fastcall\" or \"__cdecl\". Which I think I did right by putting the CallingConvention = CallingConvention.StdCall next to the .dll import. I wanted to know if you guys knew how I could fix this problem. </p>\n\n<pre><code>[DllImport(\"hawk.dll\", CallingConvention = CallingConvention.StdCall)]\npublic static extern int Motor_GetStepsRemaining(int devnum, int steps_remaining); \n\n[DllImport(\"hawk.dll\", CallingConvention = CallingConvention.StdCall)]\npublic static extern int Motor_SetDigitalOutputs(int devnum, int outputs);\n\nMotor_GetStepsRemaining(boardOneSetRunMode, stepsRemaining);\n\nshutterSensor = Motor_SetDigitalOutputs(boardTwoShutter, CLOSE);\npressureSensor = Motor_SetDigitalOutputs(boardThreeDc, DOWN);\n</code></pre>\n"}, {"tags": ["c++", "dll", "java-native-interface", "loadlibrary"], "comments": [{"owner": {"reputation": 389, "user_id": 4660406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fNN5s.jpg?s=128&g=1", "display_name": "Zannith", "link": "https://stackoverflow.com/users/4660406/zannith"}, "edited": false, "score": 0, "creation_date": 1498064345, "post_id": 44682046, "comment_id": 76348345, "body": "If your going to downvote so quickly, at least give me a way to improve please and thank you."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498071126, "post_id": 44682046, "comment_id": 76352230, "body": "0xcccccccc = uninitialized stack memory: <a href=\"https://stackoverflow.com/a/127404/487892\">stackoverflow.com/a/127404/487892</a>"}, {"owner": {"reputation": 389, "user_id": 4660406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fNN5s.jpg?s=128&g=1", "display_name": "Zannith", "link": "https://stackoverflow.com/users/4660406/zannith"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498077047, "post_id": 44682046, "comment_id": 76355556, "body": "Isn&#39;t LoadLibrary supposed to take care of that upon being called? Figured that was just because it had not actually been executed yet"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498077268, "post_id": 44682046, "comment_id": 76355651, "body": "You are correct. If LoadLibrary would have finished then <code>test</code> would have been initialized. I believe your dll is the problem."}, {"owner": {"reputation": 389, "user_id": 4660406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fNN5s.jpg?s=128&g=1", "display_name": "Zannith", "link": "https://stackoverflow.com/users/4660406/zannith"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498077855, "post_id": 44682046, "comment_id": 76355936, "body": "Yes it is, funny thing, from debugging in the IDE i could not get any helpful errors. I ran the built exe however and the jet internal runtime told me the reason it is not working. Which has to do with having to package the dll with whatever source file is accessing it when building the project and requires it be built from jet. This makes debugging and editing issues within reasonable time next to impossible"}], "answers": [{"tags": [], "owner": {"reputation": 389, "user_id": 4660406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fNN5s.jpg?s=128&g=1", "display_name": "Zannith", "link": "https://stackoverflow.com/users/4660406/zannith"}, "is_accepted": true, "score": 0, "last_activity_date": 1499099312, "creation_date": 1499099312, "answer_id": 44890292, "question_id": 44682046, "link": "https://stackoverflow.com/questions/44682046/c-loadlibrary-causes-program-to-quit/44890292#44890292", "title": "c++ LoadLibrary() causes program to quit", "body": "<p>The solution to my problem is relatively simple. I am testing a utility called Jet Excelsior to precompile my java code for native use. This utility creates a .dll for use in c++ or c projects. The issue I was having is that it is required for the invocation dll to be packed with Jet Pack along with the Jet runtime. Check the docs on it <a href=\"https://www.excelsior-usa.com/doc/jet/jetw013.html\" rel=\"nofollow noreferrer\">here</a>. The Jet sample invocation dlls/ cmain will be the most helpful to you if you have downloaded Jet.</p>\n"}], "owner": {"reputation": 389, "user_id": 4660406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fNN5s.jpg?s=128&g=1", "display_name": "Zannith", "link": "https://stackoverflow.com/users/4660406/zannith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 44890292, "answer_count": 1, "score": 1, "last_activity_date": 1499099312, "creation_date": 1498064176, "last_edit_date": 1498070625, "question_id": 44682046, "link": "https://stackoverflow.com/questions/44682046/c-loadlibrary-causes-program-to-quit", "title": "c++ LoadLibrary() causes program to quit", "body": "<p>I have a .dll generated by Jet excelsior which I am trying to pull classes from their generated invocation dll. I was following their example script originally done in c. Despite hours of research and troubleshooting I can not get the beginning LoadLibrary call to work. I am running visual studio 2017 community doing a blank c++ project.  Here is my call and the little bit of debug info I have been able to get. Any solutions or debugging advice is welcome as I am becoming desperate, also any tips on my c++ usage is welcome as I am still a novice:  </p>\n\n<pre><code>1. HINSTANCE test = LoadLibrary(L\"C:\\\\Full Path\\\\myDll.dll\");\n2. //Code exits before reaching this point.\n3. int er = (int)GetLastError();\n</code></pre>\n\n<p>Yes, I have tried moving my dll to my project directory and just calling the file name.\nUnfortunately I cannot see what the getlasterror returns because the code crashes.\nWhen debugging, before Line 1 gets executed. Its expanded info is:<br>\n<code>Name: test           Value: 0xcccccccc{unused=???}\n      unused                 &lt;Unable to read memory&gt;</code><br>\nI assume that is irrelevant because It has not actually been executed?<br>\nHere is the full code if it happens to be relevant (It fails at the bottom In the beginning of main():  </p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;string&gt;\n#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;C:\\Program Files (x86)\\Java\\jdk1.8.0_131\\include\\jni.h&gt;\n\nHINSTANCE loadDll(LPCWSTR name)\n{\n    HINSTANCE hDll = LoadLibrary(name);\n    int thing = (int)GetLastError();\n    if (!hDll) {\n        thing = (int)GetLastError();\n        printf(\"Unable to load %s\\n\", name);\n        exit(1);\n    }\n\n    printf(\"%s loaded\\n\", name);\n\n    return hDll;\n}\n\ntypedef jint(JNICALL * JNI_GetDefaultJavaVMInitArgs_func) (void *args);\ntypedef jint(JNICALL * JNI_CreateJavaVM_func) (JavaVM **pvm, void **penv, void *args);\n\n/*\n* Initialize JET run-time.\n*/\nvoid initJavaRT(HINSTANCE myDllHandle, JavaVM** pjvm, JNIEnv** penv)\n{\n    JavaVMInitArgs args;\n    JNI_GetDefaultJavaVMInitArgs_func JNI_Init_Args = (jint(JNICALL *) (void *args)) GetProcAddress(myDllHandle, \"JNI_GetDefaultJavaVMInitArgs\");\n    JNI_CreateJavaVM_func JNI_Create_VM = (jint(JNICALL *) (JavaVM **pvm, void **penv, void *args)) GetProcAddress(myDllHandle, \"JNI_CreateJavaVM\");\n\n    if (!JNI_Init_Args) {\n        std::cerr &lt;&lt; \"!JNI_Init_Args\\n\";\n        printf(\"%s doesn't contain public JNI_GetDefaultJavaVMInitArgs\\n\", dllName);\n        exit(1);\n    }\n\n    if (!JNI_Create_VM) {\n        printf(\"%s doesn't contain public JNI_CreateJavaVM\\n\", dllName);\n        exit(1);\n    }\n\n    memset(&amp;args, 0, sizeof(args));\n\n    /*args.version = JNI_VERSION_1_2;\n    if (JNI_GetDefaultJavaVMInitArgs_func(&amp;args) != JNI_OK) {\n        printf(\"JNI_GetDefaultJavaVMInitArgs() failed with result %d\\n\", JNI_GetDefaultJavaVMInitArgs_func(&amp;args));\n        exit(1);\n    }*/\n\n    /*\n    * NOTE: no JVM is actually created\n    * this call to JNI_CreateJavaVM is intended for JET RT initialization\n    */\n    /*if (JNI_CreateJavaVM_func(pjvm, (void **)penv, &amp;args) != JNI_OK) {\n        printf(\"JNI_CreateJavaVM() failed with result %d\\n\", JNI_CreateJavaVM_func(pjvm, (void **)penv, &amp;args));\n        exit(1);\n    }*/\n\n    printf(\"JET RT initialized\\n\");\n    fflush(stdout);\n}\n\n\n/*\n* Look for class.\n*/\njclass lookForClass(JNIEnv* env, char* name)\n{\n    jclass clazz = env-&gt;FindClass(name);\n\n    if (!clazz) {\n        printf(\"Unable to find class %s\\n\", name);\n        exit(1);\n    }\n\n    printf(\"Class %s found\\n\", name);\n    fflush(stdout);\n\n    return clazz;\n}\n\n\n/*\n* Create an object and invoke the \"ifoo\" instance method\n*/\nvoid invokeInstanceMethod(JNIEnv* env, jclass myClassInDll)\n{\n    jmethodID MID_init, MID_ifoo;\n    jobject obj;\n\n    MID_init = env-&gt;GetMethodID(myClassInDll, \"&lt;init&gt;\", \"()V\");\n    if (!MID_init) {\n        printf(\"Error: MyClassInDll.&lt;init&gt;() not found\\n\");\n        return;\n    }\n\n    obj = env-&gt;NewObject(myClassInDll, MID_init);\n    if (!obj) {\n        printf(\"Error: failed to allocate an object\\n\");\n        return;\n    }\n\n    MID_ifoo = env-&gt;GetMethodID(myClassInDll, \"ifoo\", \"()V\");\n\n    if (!MID_ifoo) {\n        printf(\"Error: MyClassInDll.ifoo() not found\\n\");\n        return;\n    }\n\n    env-&gt;CallVoidMethod(obj, MID_ifoo);\n}\n\n\n\n/*\n* Invoke the \"foo\" static method\n*/\nvoid invokeStaticMethod(JNIEnv* env, jclass myClassInDll)\n{\n    jmethodID MID_foo;\n\n    MID_foo = env-&gt;GetStaticMethodID(myClassInDll, \"parse\", \"()V\");\n    if (!MID_foo) {\n        printf(\"\\nError: MyClassInDll.foo() not found\\n\");\n        return;\n    }\n\n    env-&gt;CallStaticVoidMethod(myClassInDll, MID_foo);\n}\n\n\nvoid finalizeJavaRT(JavaVM* jvm)\n{\n    jvm-&gt;DestroyJavaVM();\n}\n\n\nint main()\n{\n    //Actually just trouble shooting code, not used in full program\n    HINSTANCE test = LoadLibrary(L\"C:\\\\Full Path\\\\stgNativeProject.dll\");\n    int er = (int)GetLastError();\n\n    //Actual program code\n    HINSTANCE myDllHandle;\n    JNIEnv *env;\n    JavaVM *jvm;\n    jclass  myClassInDll;\n\n    /*\n    * First of all, load required component.\n    * By the time of JET initialization, all components should be loaded.\n    */\n    std::cerr &lt;&lt; dllName &lt;&lt; \"\\n\";\n    myDllHandle = loadDll(dllName);\n\n    /*\n    * Initialize JET run-time.\n    * The handle of loaded component is used to retrieve Invocation API.\n    */\n    initJavaRT(myDllHandle, &amp;jvm, &amp;env);\n\n    /*\n    * Look for class.\n    */\n    myClassInDll = lookForClass(env, \"MyClassInDll\");\n\n    /*\n    * Create an object and invoke instance method.\n    */\n    invokeInstanceMethod(env, myClassInDll);\n\n    /*\n    * Invoke static method.\n    */\n    invokeStaticMethod(env, myClassInDll);\n\n    /*\n    * Finalize JET run-time.\n    */\n    finalizeJavaRT(jvm);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "makefile", "cmake"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498064194, "post_id": 44681948, "comment_id": 76348273, "body": "Don&#39;t link to error messages (or anything else that&#39;s relevant to the question). Put them directly <i>in</i> the question, as <i>text</i>."}, {"owner": {"reputation": 15, "user_id": 8195515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031a85a7ed86abd62538f5b05a8be5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sprenger", "link": "https://stackoverflow.com/users/8195515/ben-sprenger"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498064900, "post_id": 44681948, "comment_id": 76348657, "body": "Sorry about that. I edited it to change that. This was my first post ever, so I wasn&#39;t aware of the proper way to post things."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498065115, "post_id": 44681948, "comment_id": 76348771, "body": "No harm done. Thank you for the edit. You may want to read : <a href=\"https://stackoverflow.com/tour\">stackoverflow.com/tour</a> ,    <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1498075660, "post_id": 44681948, "comment_id": 76354853, "body": "Unlike to shell scripts, in CMake assignments do not uses equal sign (see assignment to <code>CMAKE_PREFIX_PATH</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8195515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031a85a7ed86abd62538f5b05a8be5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sprenger", "link": "https://stackoverflow.com/users/8195515/ben-sprenger"}, "edited": false, "score": 0, "creation_date": 1498078073, "post_id": 44685342, "comment_id": 76356055, "body": "This fixed the problem. Thank you so much! I tried to vote up your answer but since I have less than 15 reputation score it won&#39;t show publicly."}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 0, "last_activity_date": 1498075510, "creation_date": 1498075510, "answer_id": 44685342, "question_id": 44681948, "link": "https://stackoverflow.com/questions/44681948/cmake-with-qt-clang-error-no-such-file-or-directory-bin-sh-comman/44685342#44685342", "title": "Cmake with Qt: Clang: error: no such file or directory &#39; &quot; &#39;, /bin/sh: &quot;: command not found", "body": "<p>In CMake only <em>standard</em> double quotes (<code>\"</code>) have special meaning. Non-standard ones (<code>\u201c</code>) are treated as usual character.</p>\n\n<p>In other words, <strong>do not use non-standard double quotes</strong> in CMake scripts.</p>\n"}], "owner": {"reputation": 15, "user_id": 8195515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031a85a7ed86abd62538f5b05a8be5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sprenger", "link": "https://stackoverflow.com/users/8195515/ben-sprenger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 44685342, "answer_count": 1, "score": 0, "last_activity_date": 1498075510, "creation_date": 1498063836, "last_edit_date": 1498064834, "question_id": 44681948, "link": "https://stackoverflow.com/questions/44681948/cmake-with-qt-clang-error-no-such-file-or-directory-bin-sh-comman", "title": "Cmake with Qt: Clang: error: no such file or directory &#39; &quot; &#39;, /bin/sh: &quot;: command not found", "body": "<p>After using CMake to generate a makefile for the Qt project I am working on, when I use the make command to build the program, it cannot find the files that it needs. Here are the error messages:</p>\n\n<pre><code>clang: error: no such file or directory: ' \" '\nclang: error: no input files\n/bin/sh \": command not found\nmake[2]: *** [CMakeFiles/2d_cell_sim_2d_cell_sim.dir/main.cpp.o] Error 127\nmake[1]: *** [CMakeFiles/2d_cell_sim_2d_cell_sim.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre>\n\n<p>and here is the CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8.3)\n\nproject(2d_cell_sim)\n\n# Find includes in corresponding build directories\nset(CMAKE_INCLUDE_CURRENT_DIR ON)\n# Instruct CMake to run moc automatically when needed.\nset(CMAKE_AUTOMOC ON)\n\nset(CMAKE_PREFIX_PATH=/usr/local/Cellar/qt/5.9.0)\n\n# Find the QtWidgets library\nfind_package(Qt5Widgets)\n\ninclude_directories(${Qt5Widgets_INCLUDE_DIRS})\n\nadd_definitions(${Qt5Widgets_DEFINITIONS})\n\nset(CMAKE_CXX_FLAGS \u201c${CMAKE_CXX_FLAGS} ${Qt5Widgets_EXECUTABLE_COMPILE_FLAGS}\u201d)\n\nadd_executable(${PROJECT_NAME}_2d_cell_sim\n    main.cpp\n    root.cpp\n    cell.cpp\n    view.cpp\n    mainwindow.cpp\n    scene.cpp\n    robot.cpp\n    startupdialog.cpp)\n\ntarget_link_libraries(${PROJECT_NAME}_2d_cell_sim Qt5::Widgets)\n</code></pre>\n\n<p>I'm not sure why it seems to be looking for a folder titled \"... or maybe I am misinterpreting the error messages. I would appreciate any help, as I am a beginner to CMake!</p>\n"}, {"tags": ["c++", "windows", "qt", "qmake"], "comments": [{"owner": {"reputation": 734, "user_id": 2442002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qONGd.png?s=128&g=1", "display_name": "aatwo", "link": "https://stackoverflow.com/users/2442002/aatwo"}, "edited": false, "score": 1, "creation_date": 1498072310, "post_id": 44681808, "comment_id": 76352974, "body": "Your first three lines look fine except they are missing the PWD variable as part of the file path which seems to break it on Windows. Try changing the beginning of all your paths to -L$$PWD/../Library ($PWD prints the working directory as part of the path which is the folder containing the .pro file)."}, {"owner": {"reputation": 91, "user_id": 6162409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92520aa20f3d2ff3e43c56865e68a98a?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/6162409/stanislav"}, "reply_to_user": {"reputation": 734, "user_id": 2442002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qONGd.png?s=128&g=1", "display_name": "aatwo", "link": "https://stackoverflow.com/users/2442002/aatwo"}, "edited": false, "score": 0, "creation_date": 1498080611, "post_id": 44681808, "comment_id": 76357219, "body": "Thank you, but I&#39;ve already tried LIBS += -L$$OUT_PWD/../Library/release -lLibrary and the log shows that the resolved path is correct"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1498121445, "post_id": 44681808, "comment_id": 76372250, "body": "Make sure you <i>export</i> the class. See <a href=\"https://stackoverflow.com/questions/34663527/how-do-i-export-and-link-to-a-dll-using-qt-creator-on-windows\">https://stackoverflow.com/questions/34663527/how-do-i-export&zwnj;&#8203;-and-link-to-a-dll-u&zwnj;&#8203;sing-qt-creator-on-w&zwnj;&#8203;indows</a>."}, {"owner": {"reputation": 91, "user_id": 6162409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92520aa20f3d2ff3e43c56865e68a98a?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/6162409/stanislav"}, "edited": false, "score": 0, "creation_date": 1498143911, "post_id": 44681808, "comment_id": 76389171, "body": "Thank you, It seems to have reduced the number of errors, when I&#39;d used Q_DECL_EXPORT and Q_DECL_IMPORT for one class. But I have a lot, it&#39;s stupid to do this for every class, why it works on Linux without this?"}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1547039927, "post_id": 44681808, "comment_id": 95054269, "body": "<code>it&#39;s stupid to do this for every class, why it works on Linux without this?</code> Although it seems too late to comment on this issue, but anyway: it works like this, simply because *nixes and Windows treat this situation differently. Under Linux all &quot;public&quot; symbols are also automatically made visible (&quot;exported&#39;) inside the shared object (dynamic library), while under Windows only ones specially marked as &quot;exported&quot; (which is different from &quot;public&quot;) are visible after DLL is linked. So your complains go directly to the MS."}], "owner": {"reputation": 91, "user_id": 6162409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92520aa20f3d2ff3e43c56865e68a98a?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/6162409/stanislav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498063337, "creation_date": 1498063337, "question_id": 44681808, "link": "https://stackoverflow.com/questions/44681808/how-to-correctly-link-your-own-library-to-your-project-in-qt-on-windows", "title": "How to correctly link your own library to your project in Qt on Windows?", "body": "<p>In my QtCreator C++ project I'm using subdirs template and have several subprojects including lib-project. In app-project I'm trying this:</p>\n\n<pre><code>win32:CONFIG(release, debug|release): LIBS += -L../Library/release -lLibrary\nelse:win32:CONFIG(debug, debug|release): LIBS += -L../Library/debug -lLibrary\nelse:unix: LIBS += -L../Library -lLibrary\n</code></pre>\n\n<p>On Linux it works well, but on Windows library compiles (there're .dll and .a files), linker links it (if I change the path to wrong, like -L../Library/debugg I have an error - can't find -lLibrary), but then I have \"undefined reference to [my_classes]\". INCLUDEPATH and DEPENDPATH are also correct (because it works on Linux):</p>\n\n<pre><code>INCLUDEPATH += $$PWD/.. $$PWD/../Library\nDEPENDPATH += $$PWD/.. $$PWD/../Library\n</code></pre>\n\n<p>Also tried this:</p>\n\n<pre><code>LIBS += -L$$OUT_PWD/../Library/release -lLibrary\n</code></pre>\n\n<p>Same result, so what should I do?</p>\n"}, {"tags": ["c++", "parsing", "antlr", "antlr4"], "answers": [{"tags": [], "owner": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "is_accepted": false, "score": 0, "last_activity_date": 1498114428, "creation_date": 1498114428, "answer_id": 44692193, "question_id": 44681259, "link": "https://stackoverflow.com/questions/44681259/retaining-order-in-antlr4-grammars/44692193#44692193", "title": "Retaining order in ANTLR4 grammars", "body": "<p>Once you determined that your input is syntactically correct (by parsing it) you can simply use your token stream to walk over all incoming tokens. They are in the exact order as given originally. Use <code>CommonTokenStream::getTokens()</code> for the list.</p>\n"}, {"tags": [], "owner": {"reputation": 1220, "user_id": 423031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c41bc7ecd015f611e7684dde10d9c94a?s=128&d=identicon&r=PG", "display_name": "apriori", "link": "https://stackoverflow.com/users/423031/apriori"}, "is_accepted": true, "score": 0, "last_activity_date": 1498467718, "creation_date": 1498467718, "answer_id": 44756191, "question_id": 44681259, "link": "https://stackoverflow.com/questions/44681259/retaining-order-in-antlr4-grammars/44756191#44756191", "title": "Retaining order in ANTLR4 grammars", "body": "<p>I solved the primary example using the following modifications to the grammar:</p>\n\n<pre><code>grammar T;\n\nsequence: direction*;\n\ndirection: a | b;\n\na: FORWARD;\nb: RIGHT;\n\nFORWARD: 'f';\nRIGHT: 'r';\n</code></pre>\n\n<p>which gives a vector of <code>direction</code> rule contexts in the <code>sequence</code> context. In the <code>direction</code> rule context, either <code>a</code> or <code>b</code> is set (<code>a() != nullptr</code> or <code>b() != nullptr</code>).</p>\n\n<p>For the latter example, the grammar can be modified using a special function of the ANTLR grammar that allows us to name the different <code>expr</code> parts:</p>\n\n<pre><code>grammar U;\n\nfor_statement: 'for' '(' first_expr=expr? ';' second_expr=expr? ';' third_expr=expr? ')' statement\n</code></pre>\n\n<p>The <code>for_statement</code> context then has <code>first_expr() != nullptr</code> if the first expression was given. <code>first_expr()</code> returns a pointer to type <code>UParser::First_exprContext</code> and provides a normal <code>expr</code> context. There are a couple of such helpful functions in the ANTLR4 grammar that can make walking the parse tree more robust in terms of only having to change small parts in the code that uses the parse tree when the grammar changes.</p>\n"}], "owner": {"reputation": 1220, "user_id": 423031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c41bc7ecd015f611e7684dde10d9c94a?s=128&d=identicon&r=PG", "display_name": "apriori", "link": "https://stackoverflow.com/users/423031/apriori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 1, "accepted_answer_id": 44756191, "answer_count": 2, "score": 0, "last_activity_date": 1498467718, "creation_date": 1498061473, "last_edit_date": 1498467046, "question_id": 44681259, "link": "https://stackoverflow.com/questions/44681259/retaining-order-in-antlr4-grammars", "title": "Retaining order in ANTLR4 grammars", "body": "<p>For the ANTLR4 grammar (just an MWE)</p>\n\n<pre><code>grammar T;\n\nsequence: ( a | b )*;\n\na: FORWARD;\nb: RIGHT;\n\nFORWARD: 'f';\nRIGHT: 'r';\n</code></pre>\n\n<p>the ANTLR4 C++ backend generates the parser <code>TParser</code> deriving from <code>antlr4::Parser</code>. I am interested in the class <code>TParser::SequenceContext</code>, derived from <code>antlr4::ParserRuleContext</code>:</p>\n\n<pre><code>class  SequenceContext : public antlr4::ParserRuleContext {\npublic:\n    SequenceContext(antlr4::ParserRuleContext *parent, size_t invokingState);\n    virtual size_t getRuleIndex() const override;\n    antlr4::tree::TerminalNode *EOF();\n    std::vector&lt;AContext *&gt; a();\n    AContext* a(size_t i);\n    std::vector&lt;BContext *&gt; b();\n    BContext* b(size_t i);\n\n    virtual void enterRule(antlr4::tree::ParseTreeListener *listener) override;\n    virtual void exitRule(antlr4::tree::ParseTreeListener *listener) override;\n\n    virtual antlrcpp::Any accept(antlr4::tree::ParseTreeVisitor *visitor) override;\n};\n</code></pre>\n\n<p>My problem is that the <em>order</em> of the occurrences of <code>a</code> and <code>b</code> gets lost when I use only the <code>std::vector&lt;&gt;</code>s returned by the <code>SequenceContext::a()</code> and <code>SequenceContext::b()</code> member functions. What is the <em>best practice</em> in ANTLR4 grammar formulation to retain the order? Or is there another way to get the order from the parse tree? Note that I don't want to use the visitor or listener interfaces extensively, but rather walk through the parse tree myself.</p>\n\n<p>A similar example would be a grammar like (only relevant parts shown):</p>\n\n<pre><code>grammar U;\n\nfor_statement: 'for' '(' expr? ';' expr? ';' expr? ')' statement\n</code></pre>\n\n<p>The context for the rule would present only a list of expressions to the user. If only the last expression is given, the context gives us only a vector of <code>expr</code> with a size of 1 and without an easy why to determine whether the first, second or third expression was given.</p>\n"}, {"tags": ["c++", "shift"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1498061552, "post_id": 44681247, "comment_id": 76346790, "body": "Have you tried to evaluate it manually according to the parentheses precedence rule?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 5, "creation_date": 1498061669, "post_id": 44681247, "comment_id": 76346858, "body": "Why did you expect it give 8?"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1498061723, "post_id": 44681247, "comment_id": 76346886, "body": "@MartinBonner I think the expectation was shifting one more time, instead of having it raised to the power of something."}], "answers": [{"tags": [], "owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "is_accepted": false, "score": 8, "last_activity_date": 1498061595, "creation_date": 1498061595, "answer_id": 44681296, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c/44681296#44681296", "title": "Regarding left shift operator in C++", "body": "<pre><code>int n=(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1));\n=&gt; int n=(1&lt;&lt;(1&lt;&lt;2));\n=&gt; int n=(1&lt;&lt;4); // which is to say, 2 to the power of 4\n=&gt; 1 -&gt; 2 -&gt; 4 -&gt; 8 -&gt; 16\n</code></pre>\n\n<p>So it should display 16.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 4271788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0504576a2b37e74ecf470c308e1ac102?s=128&d=identicon&r=PG&f=1", "display_name": "jgolfman", "link": "https://stackoverflow.com/users/4271788/jgolfman"}, "is_accepted": false, "score": 2, "last_activity_date": 1498061715, "creation_date": 1498061715, "answer_id": 44681336, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c/44681336#44681336", "title": "Regarding left shift operator in C++", "body": "<p>This is a basic case of operator precedence. The innermost parentheses will be evaluated first, and this will chain up to the outermost one. So, for the last case, it will go</p>\n\n<pre><code>(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1))) =&gt; (1&lt;&lt;(1&lt;&lt;2)) =&gt; (1&lt;&lt;4) = 16\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1618, "user_id": 4507489, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/4915f939fee361e28d5cc134475e926c?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek kumar", "link": "https://stackoverflow.com/users/4507489/vivek-kumar"}, "edited": false, "score": 0, "creation_date": 1498066073, "post_id": 44681337, "comment_id": 76349374, "body": "How will you evaluate (4&lt;&lt;16) ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1618, "user_id": 4507489, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/4915f939fee361e28d5cc134475e926c?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek kumar", "link": "https://stackoverflow.com/users/4507489/vivek-kumar"}, "edited": false, "score": 1, "creation_date": 1498066161, "post_id": 44681337, "comment_id": 76349420, "body": "<code>x &lt;&lt; y = x * (2^y)</code>"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 5, "last_activity_date": 1498061716, "creation_date": 1498061716, "answer_id": 44681337, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c/44681337#44681337", "title": "Regarding left shift operator in C++", "body": "<p>Since <code>1 &lt;&lt; n = 2^n</code> it is easy to evaluate:</p>\n\n<pre><code>(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1)) = 2^(2^(2^1)) = 2^4 = 16\n</code></pre>\n\n<ul>\n<li>Here <code>x^y</code> denotes <code>x</code> raised to the power of <code>y</code>, and not the <code>C++</code> XOR operator.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": false, "score": 2, "last_activity_date": 1498063150, "last_edit_date": 1498063150, "creation_date": 1498062086, "answer_id": 44681444, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c/44681444#44681444", "title": "Regarding left shift operator in C++", "body": "<p>Maybe you grouped it backwards:</p>\n\n<p>If you do:</p>\n\n<pre><code>int n=(((1&lt;&lt;1)&lt;&lt;1)&lt;&lt;1);\ncout&lt;&lt;n;\n</code></pre>\n\n<p>Output will be <code>(((1&lt;&lt;1)&lt;&lt;1)&lt;&lt;1) = (((2)&lt;&lt;1)&lt;&lt;1) = ((4)&lt;&lt;1) = 8</code></p>\n\n<p>Remember that left operand of shift operator <code>&lt;&lt;</code> is the number you want to apply the shift, and the right operand is the <code>n</code> bits you want to shift.</p>\n\n<p>So, if you group it backwards, you are shifting the rigth operand (the <code>n</code> bits you want to shift).</p>\n\n<pre><code>int n=(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1)));\ncout&lt;&lt;n;\n</code></pre>\n\n<p>Output will be <code>(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1))) = (1&lt;&lt;(1&lt;&lt;(2))) = (1&lt;&lt;(4)) = 16</code></p>\n"}, {"tags": [], "owner": {"reputation": 2998, "user_id": 1723954, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/qM3Yc.jpg?s=128&g=1", "display_name": "Stewart", "link": "https://stackoverflow.com/users/1723954/stewart"}, "is_accepted": false, "score": 1, "last_activity_date": 1498062666, "creation_date": 1498062666, "answer_id": 44681610, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c/44681610#44681610", "title": "Regarding left shift operator in C++", "body": "<p>Every time you shift to the left, you are incrementing the number to the power of 2. </p>\n\n<p>The first expression <code>(1&lt;&lt;1)</code> was <code>2^1</code> which is <code>2</code>.<br>\nThe second expression <code>(1&lt;&lt;(1&lt;&lt;1))</code> was <code>( 1&lt;&lt; (2) )</code> which is <code>2^2</code> or <code>4</code></p>\n\n<p>The last expression <code>(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1)))</code> was just <code>(1&lt;&lt;(4))</code> which is <code>4^2</code> or <code>16</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 158, "user_id": 8001232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19144a63ff4f6e431b5d234b1f1985da?s=128&d=identicon&r=PG&f=1", "display_name": "George Pasquali", "link": "https://stackoverflow.com/users/8001232/george-pasquali"}, "is_accepted": false, "score": 0, "last_activity_date": 1498489156, "creation_date": 1498489156, "answer_id": 44762642, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c/44762642#44762642", "title": "Regarding left shift operator in C++", "body": "<p>The decimal number 1 in binary is : 1 ; 2^0 </p>\n\n<p>when you shift it to the left it becomes : 10 ; (1&lt;&lt;1) </p>\n\n<p>The next executed operation would be 1&lt;&lt;2 which results in : 100 = 4 ; (1&lt;&lt;2) </p>\n\n<p>And the one after that : 1 &lt;&lt; 4 which makes...you guessed it - 10000 = 16 ; (1&lt;&lt;4)</p>\n\n<p>I hope this helped somebody.</p>\n"}], "owner": {"reputation": 1618, "user_id": 4507489, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/4915f939fee361e28d5cc134475e926c?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek kumar", "link": "https://stackoverflow.com/users/4507489/vivek-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 6, "score": -1, "last_activity_date": 1498489156, "creation_date": 1498061435, "last_edit_date": 1498061461, "question_id": 44681247, "link": "https://stackoverflow.com/questions/44681247/regarding-left-shift-operator-in-c", "title": "Regarding left shift operator in C++", "body": "<p>I have this doubt regarding left shift operator, when I perform-</p>\n\n<pre><code>int n=(1&lt;&lt;1);\ncout&lt;&lt;n;\n</code></pre>\n\n<p><strong>Output: 2</strong></p>\n\n<pre><code>int n=(1&lt;&lt;(1&lt;&lt;1));\ncout&lt;&lt;n;\n</code></pre>\n\n<p><strong>Output: 4</strong></p>\n\n<p>But when, I do-</p>\n\n<pre><code>int n=(1&lt;&lt;(1&lt;&lt;(1&lt;&lt;1));\ncout&lt;&lt;n;\n</code></pre>\n\n<p><strong>Output: 16</strong></p>\n\n<p>Shouldn't the output be 8 in the last case? Why it is giving 16?</p>\n"}, {"tags": ["c++", "c++11", "vector"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 3, "creation_date": 1498061302, "post_id": 44681180, "comment_id": 76346644, "body": "Is <code>fixed size</code> available at compile time?"}, {"owner": {"reputation": 9429, "user_id": 1264018, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c0338476eea2e564d77246b7234773e1?s=128&d=identicon&r=PG&f=1", "display_name": "feelfree", "link": "https://stackoverflow.com/users/1264018/feelfree"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1498061390, "post_id": 44681180, "comment_id": 76346696, "body": "@dasblinkenlight yes, it is available."}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 3624795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iMfXm.png?s=128&g=1", "display_name": "athul.sure", "link": "https://stackoverflow.com/users/3624795/athul-sure"}, "edited": false, "score": 1, "creation_date": 1498061737, "post_id": 44681249, "comment_id": 76346901, "body": "There should be a space in &quot;&gt;&gt;&quot;. It should be <code>std::vector&lt;std::array&lt;int,10&gt; &gt; matNby10;</code>. Else you&#39;ll get a <a href=\"https://stackoverflow.com/questions/29331315/double-closing-angle-brackets-generate-syntax-error-in-specific-case\">compile time error</a>."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 318, "user_id": 3624795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iMfXm.png?s=128&g=1", "display_name": "athul.sure", "link": "https://stackoverflow.com/users/3624795/athul-sure"}, "edited": false, "score": 3, "creation_date": 1498061903, "post_id": 44681249, "comment_id": 76347005, "body": "@athul.sure that&#39;s true, but only if you use ancient compilers. Starting with C++11 language parsers are required to handle this case properly."}, {"owner": {"reputation": 318, "user_id": 3624795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iMfXm.png?s=128&g=1", "display_name": "athul.sure", "link": "https://stackoverflow.com/users/3624795/athul-sure"}, "edited": false, "score": 0, "creation_date": 1498062145, "post_id": 44681249, "comment_id": 76347157, "body": "True. But please specify it in the answer. If you compile the above code in g++ with no <code>std</code> flag, you&#39;ll get an error."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 318, "user_id": 3624795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iMfXm.png?s=128&g=1", "display_name": "athul.sure", "link": "https://stackoverflow.com/users/3624795/athul-sure"}, "edited": false, "score": 3, "creation_date": 1498062352, "post_id": 44681249, "comment_id": 76347278, "body": "@athul.sure <code>std::array</code> is not available prior C++11, so OP would not be able to use this solution with an older compiler anyway."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1498061439, "creation_date": 1498061439, "answer_id": 44681249, "question_id": 44681180, "link": "https://stackoverflow.com/questions/44681180/can-we-define-a-2d-matrix-of-fixed-width-using-stdvector/44681249#44681249", "title": "Can we define a 2D matrix of fixed width using std::vector?", "body": "<p>Since the width of the matrix is known at compile time, you can use a vector of <a href=\"http://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a>s:</p>\n\n<pre><code>std::vector&lt;std::array&lt;int,10&gt;&gt; matNby10;\n</code></pre>\n\n<p>Now the width of the matrix is controlled by the array, which has fixed size. Other than that, it is nearly a drop-in replacement for a vector-of-vectors, as long as you do not try expanding row width.</p>\n\n<p>Moreover, there is a decent chance that this approach would be more cache-friendly, because arrays would be stored next to each other inside the vector.</p>\n"}, {"tags": [], "owner": {"reputation": 657, "user_id": 2811109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb0064340ebbc4a5ac3effeac5493b30?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek", "link": "https://stackoverflow.com/users/2811109/jacek"}, "is_accepted": false, "score": 0, "last_activity_date": 1498062643, "last_edit_date": 1498062643, "creation_date": 1498062283, "answer_id": 44681500, "question_id": 44681180, "link": "https://stackoverflow.com/questions/44681180/can-we-define-a-2d-matrix-of-fixed-width-using-stdvector/44681500#44681500", "title": "Can we define a 2D matrix of fixed width using std::vector?", "body": "<p>If you need to have underlying std::vector you can write custom wrapper like this:</p>\n\n<pre><code>template &lt;typename T, int N&gt;\nstruct vec \n{\n    vec() \n        : _c {std::vector&lt;T&gt;(N)}\n    {\n    }\n\n    vec(int default_val) \n        : _c {std::vector&lt;T&gt;(N, default_val)}\n    {\n    }\n\n    T const&amp; operator[](int index) const\n    {\n        return _c[index];\n    }\n\n    std::vector&lt;T&gt;&amp; container() { return _c; }\n\nprivate:\n    std::vector&lt;T&gt; _c;\n};\n</code></pre>\n\n<p>And you end up with this:</p>\n\n<pre><code>std::vector&lt;vec&lt;int,10&gt;&gt; asd;\n</code></pre>\n"}], "owner": {"reputation": 9429, "user_id": 1264018, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c0338476eea2e564d77246b7234773e1?s=128&d=identicon&r=PG&f=1", "display_name": "feelfree", "link": "https://stackoverflow.com/users/1264018/feelfree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 44681249, "answer_count": 2, "score": 1, "last_activity_date": 1498062643, "creation_date": 1498061215, "question_id": 44681180, "link": "https://stackoverflow.com/questions/44681180/can-we-define-a-2d-matrix-of-fixed-width-using-stdvector", "title": "Can we define a 2D matrix of fixed width using std::vector?", "body": "<p>I use the following example to illustrate my question: </p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt; &gt; abc;\nabc.push_back(std::vector&lt;int&gt;(9,0));\nabc.push_back(std::vector&lt;int&gt;(9,2));\n...\nabc.push_back(std::vector&lt;int&gt;(9,20));\n</code></pre>\n\n<p>As you can see from the example each time a vector is put in the 2D vector, its dimension is the same. Variable <code>abc</code> represents a matrix of fixed width, and its height may increase or decrease based on the requirement. Therefore, I want to define something like <code>std::vector&lt;std::vector(with fixed size)&gt;</code>. How can I do it? </p>\n"}, {"tags": ["c++", "pointers", "memory"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498060427, "post_id": 44680877, "comment_id": 76346092, "body": "<b><i>or is there any need to call a delete on pA</i></b> You don&#39;t delete it. <b><i>Will the return value go out of scope at the end of bar()</i></b> Before that. You can&#39;t do this."}], "answers": [{"comments": [{"owner": {"reputation": 320, "user_id": 2282275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c6a695cb8b289dd54e63d2163e5e516?s=128&d=identicon&r=PG", "display_name": "Dooggy", "link": "https://stackoverflow.com/users/2282275/dooggy"}, "edited": false, "score": 0, "creation_date": 1498060535, "post_id": 44680902, "comment_id": 76346173, "body": "Thank you very much, this is very clear."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1498060361, "creation_date": 1498060361, "answer_id": 44680902, "question_id": 44680877, "link": "https://stackoverflow.com/questions/44680877/store-pointer-to-function-return-value/44680902#44680902", "title": "Store pointer to function return value", "body": "<p><strong>It's much worse than that!</strong></p>\n\n<p>The behaviour on dereferencing <code>pA</code> in <code>bar</code> will be <em>undefined</em>. That's because <code>foo()</code> returns an anonymous temporary whose lifetime is limited to the statement at the call site.</p>\n\n<p>You only <strong>ever</strong> call <code>delete</code> on a pointer that's attained by the result of an allocation using <code>new</code>.</p>\n"}], "owner": {"reputation": 320, "user_id": 2282275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c6a695cb8b289dd54e63d2163e5e516?s=128&d=identicon&r=PG", "display_name": "Dooggy", "link": "https://stackoverflow.com/users/2282275/dooggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "closed_date": 1498060437, "answer_count": 1, "score": 1, "last_activity_date": 1498060421, "creation_date": 1498060262, "question_id": 44680877, "link": "https://stackoverflow.com/questions/44680877/store-pointer-to-function-return-value", "closed_reason": "Duplicate", "title": "Store pointer to function return value", "body": "<p>Assume that I have a function foo() that returns object of class A by value</p>\n\n<pre><code>A foo() {\n    A a(...);\n    return A;\n}\n</code></pre>\n\n<p>Now in function bar() I store a pointer to the return value of A</p>\n\n<pre><code>void bar() {\n    A* pA = &amp;foo();\n}\n</code></pre>\n\n<p>Will the return value go out of scope at the end of bar(), or is there any need to call a delete on pA ?</p>\n"}, {"tags": ["c++", "linked-list", "copy-constructor", "deep-copy"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1498060696, "post_id": 44680873, "comment_id": 76346279, "body": "First off, you should not rely on side-effects within copy constructors, because copy-elision is a thing. Copy-assignment should not be elided, though. /OT: <code>I&#39;ve been building on a template Linked List</code> I appreciate that you are most likely doing this as an exercise, whether for a class or your own research, but ideally one should never need to implement something like this in C++ because it has a rich Standard Library that should provide such common things out-of-the-box, in this case as <code>std::list</code> (unless you have extremely specific requirements and have determined that to be a bottleneck."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5738920"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1498060841, "post_id": 44680873, "comment_id": 76346367, "body": "Could you elaborate on what you mean by side-effects?  Completely agree with your comment regarding the utilization of <code>std::list</code>, I&#39;m pursuing this purely as an academic exercise."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1498060918, "post_id": 44680873, "comment_id": 76346411, "body": "Side effects: a copy-constructor doing anything that could be observable outwith itself. See <a href=\"https://stackoverflow.com/questions/28659879/copy-elision-visible-side-effect\" title=\"copy elision visible side effect\">stackoverflow.com/questions/28659879/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5738920"}, "edited": false, "score": 0, "creation_date": 1498061298, "post_id": 44681106, "comment_id": 76346642, "body": "Thanks, this works very well.  Would you happen to have any insight into why my implementation would prevent the call to the copy constructor from happening (or, why I wouldn&#39;t see my string message when the copy constructor is called)."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1498061471, "post_id": 44681106, "comment_id": 76346749, "body": "On my machine it crashes because you get out of the loop with condition <code>curListNode-&gt;next != nullptr</code> being false, then you executes <code>curNode-&gt;next = new Node{curListNode-&gt;next-&gt;data, nullptr};</code> after that everything is possible as <code>curListNode-&gt;next</code> is null."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5738920"}, "edited": false, "score": 0, "creation_date": 1498061595, "post_id": 44681106, "comment_id": 76346817, "body": "I see - thank you.  I&#39;m currently using cpp.sh in my browser and it must not be able to handle such a thing."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1498061616, "post_id": 44681106, "comment_id": 76346824, "body": "You may correct the code by setting <code>curNode-&gt;next =  nullptr; tail = curNode;</code> just after the loop."}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": true, "score": 0, "last_activity_date": 1498061031, "creation_date": 1498061031, "answer_id": 44681106, "question_id": 44680873, "link": "https://stackoverflow.com/questions/44680873/linked-list-copy-constructor-undefined-behavior/44681106#44681106", "title": "Linked List Copy Constructor | Undefined Behavior", "body": "<p>A simple copy constructor like this one should suffice:</p>\n\n<pre><code>template&lt;typename T&gt;\nLinkedList&lt;T&gt;::LinkedList(const LinkedList&lt;T&gt; &amp;list)\n    : head{ nullptr }, tail{ nullptr }, size{0}\n{\n    std::cout &lt;&lt; \"In the copy constructor\\n\";\n   Node* curNode = list.head;\n\n    while (curNode != nullptr)\n    {\n      this-&gt;push(curNode-&gt;data);\n        curNode = curNode-&gt;next;\n    }\n\n}\n</code></pre>\n\n<p>Note that this is just your <code>display</code> method rewritten to insert elements in the current list.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5738920"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 44681106, "answer_count": 1, "score": 0, "last_activity_date": 1498061031, "creation_date": 1498060253, "question_id": 44680873, "link": "https://stackoverflow.com/questions/44680873/linked-list-copy-constructor-undefined-behavior", "title": "Linked List Copy Constructor | Undefined Behavior", "body": "<p>I've been building on a template Linked List and recently implemented a user-defined copy constructor to handle deep copies of my Linked List.  My current solution compiles just fine but when I execute, nothing is displayed.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nclass LinkedList\n{\nprivate:\n    struct Node\n    {\n        T data;\n        Node* next;\n    };\n\n    Node* head;\n    Node* tail;\n    int size;\n\npublic:\n    LinkedList();\n    LinkedList(const LinkedList&lt;T&gt; &amp;list);\n    ~LinkedList();\n    LinkedList&lt;T&gt;&amp; operator=(const LinkedList&lt;T&gt; list);\n    int getSize() const;\n    void display() const;\n    void push(const T &amp;data);\n    void insert(const int pos, const T &amp;data);\n    void remove(const int pos);\n\n};\n\ntemplate&lt;typename T&gt;\nLinkedList&lt;T&gt;::LinkedList() : head{ nullptr }, tail{ nullptr }, size{ 0 }\n{\n}\n\n// TODO: User-defined copy constructor\ntemplate&lt;typename T&gt;\nLinkedList&lt;T&gt;::LinkedList(const LinkedList&lt;T&gt; &amp;list)\n    : head{ nullptr }, tail{ nullptr }, size{list.size}\n{\n    std::cout &lt;&lt; \"In the copy constructor\\n\";\n    if (list.head == nullptr)\n    {\n        return;\n    }\n    else\n    {\n        Node* curNode = new Node{list.head-&gt;data, nullptr};\n        head = curNode; // sets the head member variable to first node in Linked List\n\n        Node* curListNode = list.head;      \n\n        while (curListNode-&gt;next != nullptr)\n        {\n            curNode-&gt;next = new Node{curListNode-&gt;next-&gt;data, nullptr};\n\n            curListNode = curListNode-&gt;next;\n            curNode = curNode-&gt;next;\n        }\n\n        curNode-&gt;next = new Node{curListNode-&gt;next-&gt;data, nullptr};\n        tail = curNode-&gt;next;\n    }\n\n}\n\ntemplate&lt;typename T&gt;\nLinkedList&lt;T&gt;::~LinkedList()\n{\n    Node* prevNode = head;\n    Node* curNode = head;\n\n    while(curNode != nullptr)\n    {\n        prevNode = curNode;\n        curNode = curNode-&gt;next;\n\n        delete prevNode;\n    }\n\n    head = nullptr;\n    tail = nullptr;\n}\n\ntemplate&lt;typename T&gt;\nLinkedList&lt;T&gt;&amp; LinkedList&lt;T&gt;::operator=(const LinkedList&lt;T&gt; list)\n{\n    // make a copy of each node - much like the copy constructor\n    std::cout &lt;&lt; \"In the overloaded assignment\\n\";\n}\n\ntemplate&lt;typename T&gt;\nint LinkedList&lt;T&gt;::getSize() const\n{\n    return size;\n}\n\ntemplate&lt;typename T&gt;\nvoid LinkedList&lt;T&gt;::display() const\n{\n    Node* curNode = head;\n\n    while (curNode != nullptr)\n    {\n        std::cout &lt;&lt; curNode-&gt;data &lt;&lt; '\\n';\n        curNode = curNode-&gt;next;\n    }\n\n    std::cout &lt;&lt; '\\n';\n}\n\ntemplate&lt;typename T&gt;\nvoid LinkedList&lt;T&gt;::push(const T &amp;data)\n{\n    Node* newNode = new Node{data, nullptr};\n\n    if (size == 0)\n    {\n        head = newNode;\n        tail = newNode;\n    }\n    else \n    {\n        tail-&gt;next = newNode;\n        tail = newNode;\n    }\n\n    ++size;\n}\n\ntemplate&lt;typename T&gt;\nvoid LinkedList&lt;T&gt;::insert(const int pos, const T &amp;data)\n{\n    if (pos &lt; 0 || pos &gt; size)\n    {\n        throw \"Index is out of range!\";   \n    }\n    else if (pos == size)\n    {\n        push(data);   \n    }\n    else\n    {\n        Node* newNode = new Node{data, nullptr};\n        Node* prevNode = head;\n        Node* curNode = head;\n\n        int i = 0;\n        while (i != pos)\n        {\n            prevNode = curNode;\n            curNode = curNode-&gt;next;\n            ++i;\n        }\n\n        prevNode-&gt;next = newNode;\n        newNode-&gt;next = curNode;\n\n        ++size;\n    }\n}\n\ntemplate&lt;typename T&gt;\nvoid LinkedList&lt;T&gt;::remove(const int pos)\n{\n    if (pos &lt; 0 || pos &gt; size)\n    {\n        throw \"Index is out of range!\";   \n    }\n    else if (size == 0)\n    {\n        throw \"List is empty!\";   \n    }\n    else\n    {\n        Node* prevNode = head;\n        Node* curNode = head;\n\n        int i = 1;\n        while (i != pos)\n        {\n            prevNode = curNode;\n            curNode = curNode-&gt;next;\n            ++i;\n        }\n\n        prevNode-&gt;next = curNode-&gt;next;\n        delete curNode;\n\n        if (pos == size)\n        {\n            tail = prevNode;   \n        }\n\n        --size;\n    }\n}\n\nint main()\n{\n    LinkedList&lt;int&gt; list;\n\n    list.push(1);\n    list.push(3);\n    list.push(6);\n\n    list.display();\n\n    LinkedList&lt;int&gt; copyList{list};\n\n    copyList.display();\n\n    return 0;\n}\n</code></pre>\n\n<p>The first <code>LinkedList&lt;int&gt; list</code> doesn't even display when I add the the <code>copyList</code> statement to <code>main()</code>.  However, when I comment out the two <code>copyList</code> statements, <code>list</code> displays as normal.</p>\n\n<p>I added print statements to see if either the copy constructor or the <code>operator=</code> functions were being called and neither of those are printed to the console when the <code>copyList</code> statements are added to my program (the code compiles just fine).</p>\n\n<p>I could use any help to help diagnose what's causing this behavior.</p>\n"}, {"tags": ["c++", "sparse-matrix", "eigen"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "edited": false, "score": 0, "creation_date": 1498124347, "post_id": 44686066, "comment_id": 76374398, "body": "Sorry forgot to add the initialization of the matrix to the code shown becuase it was in another function. I believe initializing with <code>Eigen::SparseMatrix&lt;double, Eigen::RowMajor&gt; data_matrix(rows, cols);</code> already set the size, right?"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "reply_to_user": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "edited": false, "score": 0, "creation_date": 1498220884, "post_id": 44686066, "comment_id": 76425034, "body": "Indeed, so could you confirm that it does work for you if using a <code>ColMajor</code> matrix?"}, {"owner": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "edited": false, "score": 0, "creation_date": 1498221347, "post_id": 44686066, "comment_id": 76425346, "body": "In the meantime I&#39;ve found an alternative solution in one of your answer on another forum (funny :) ). At the moment I&#39;m doing <code>Eigen::SparseMatrix&lt;double, Eigen::RowMajor&gt; data_matrix(cur_rows, cols);    data_matrix.reserve(cur_rows * 100000);</code> and filling it with <code>data_matrix.insert(row_iter, words[word_freq[0]]) = std::stoi(word_freq[1]);</code>  and it seems to work fine. Do you know if there is any noticeable performance difference between the two alternatives?"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "reply_to_user": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "edited": false, "score": 0, "creation_date": 1498221409, "post_id": 44686066, "comment_id": 76425376, "body": "But it should still work with the setFromTriplets, and my self-contained example shows."}, {"owner": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "edited": false, "score": 0, "creation_date": 1498221547, "post_id": 44686066, "comment_id": 76425465, "body": "Ok when I have a second to test, I&#39;ll try with the triplets method and let you know. In the meantime I&#39;ll select your answer as accepted :)"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "reply_to_user": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "edited": false, "score": 0, "creation_date": 1498221632, "post_id": 44686066, "comment_id": 76425512, "body": "I think I found the root of your issue in the prototype of <code>get_data</code>, see my updated answer."}], "tags": [], "owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "is_accepted": true, "score": 1, "last_activity_date": 1498221591, "last_edit_date": 1498221591, "creation_date": 1498078353, "answer_id": 44686066, "question_id": 44680704, "link": "https://stackoverflow.com/questions/44680704/eigen-fill-up-sparse-rowmajor-matrix-with-triplets/44686066#44686066", "title": "Eigen fill up Sparse RowMajor matrix with triplets", "body": "<p>Works for me, here is a selfcontained example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Eigen/SparseCore&gt;\n#include &lt;vector&gt;\nusing namespace Eigen;\nusing namespace std;\n\nint main()\n{\n  int m = 3, n = 7;\n  SparseMatrix&lt;double, RowMajor&gt; M(m,n);\n  typedef Triplet&lt;double,int&gt; T;\n  vector&lt;T&gt; entries;\n  for(int k=1; k&lt;=9;++k)\n    entries.push_back( T(internal::random&lt;int&gt;(0,m-1), internal::random&lt;int&gt;(0,n-1), k) );\n  M.setFromTriplets(entries.begin(), entries.end());\n  cout &lt;&lt; MatrixXd(M) &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>that produces:</p>\n\n<pre><code> 1  0  0  8  4  0  0\n 0  3  0  6  0  0  0\n16  0  0  2  0  0  5\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>So the problem is in the structure of your code, I see that <code>get_data</code> gets the triplet list and the sparse matrix by value, whereas they are modified by this function, so you most likely want to pass them by reference.</p>\n"}], "owner": {"reputation": 359, "user_id": 7443737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a17313ac61ea72168955ed991478e0f7?s=128&d=identicon&r=PG&f=1", "display_name": "ClonedOne", "link": "https://stackoverflow.com/users/7443737/clonedone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "accepted_answer_id": 44686066, "answer_count": 1, "score": 0, "last_activity_date": 1498221591, "creation_date": 1498059822, "last_edit_date": 1498123882, "question_id": 44680704, "link": "https://stackoverflow.com/questions/44680704/eigen-fill-up-sparse-rowmajor-matrix-with-triplets", "title": "Eigen fill up Sparse RowMajor matrix with triplets", "body": "<p>I am trying to fill up a Sparse RowMajor matrix. Following the guide I was using the triplets method:</p>\n\n<pre><code>Eigen::SparseMatrix&lt;double, Eigen::RowMajor&gt; data_matrix(rows, cols);\n....\n\nvoid get_data(const char *dir_name, std::vector&lt;T&gt; tripletList, Eigen::SparseMatrix&lt;double, Eigen::RowMajor&gt; data_matrix) {\nuint64_t row_iter = 0;\n\nfor (std::string file_n : sorted_files) {\n   ...\n   if (words.find(word_freq[0]) != words.end())\n       tripletList.push_back(T(row_iter, words[word_freq[0]], std::stoi(word_freq[1])));\n   }\n\n   row_iter++;\n\n}\n\ndata_matrix.setFromTriplets(tripletList.begin(), tripletList.end());\n</code></pre>\n\n<p>However, this approach generates an empty matrix. I couldn't find examples of filling RowMajor matrices with the triplet list method, is it not possible? </p>\n"}, {"tags": ["c++", "rsa", "public-key-encryption", "crypto++"], "comments": [{"owner": {"reputation": 602, "user_id": 4179728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3GLsH.jpg?s=128&g=1", "display_name": "puzzlepalace", "link": "https://stackoverflow.com/users/4179728/puzzlepalace"}, "edited": false, "score": 0, "creation_date": 1498068138, "post_id": 44680703, "comment_id": 76350460, "body": "RNG is needed as <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\" rel=\"nofollow noreferrer\">OAEP padding</a> requires generation of a random bitstring (if you use no random values e.g. NullRNG you lose some major security properties of RSA OAEP). I&#39;m not sure why decoding needs the RNG though as the random string is recovered by the algorithm, so there&#39;s no need to generate fresh random bits."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 602, "user_id": 4179728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3GLsH.jpg?s=128&g=1", "display_name": "puzzlepalace", "link": "https://stackoverflow.com/users/4179728/puzzlepalace"}, "edited": false, "score": 3, "creation_date": 1498101486, "post_id": 44680703, "comment_id": 76362725, "body": "@puzzlepalace - <i>&quot;I&#39;m not sure why decoding needs the RNG though as the random string is recovered by the algorithm...&quot;</i> - Blinding during private key operations."}, {"owner": {"reputation": 602, "user_id": 4179728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3GLsH.jpg?s=128&g=1", "display_name": "puzzlepalace", "link": "https://stackoverflow.com/users/4179728/puzzlepalace"}, "edited": false, "score": 0, "creation_date": 1498144615, "post_id": 44680703, "comment_id": 76389708, "body": "Yup that would be it, good catch."}], "answers": [{"tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": false, "score": 4, "last_activity_date": 1498242220, "last_edit_date": 1498242220, "creation_date": 1498100398, "answer_id": 44689418, "question_id": 44680703, "link": "https://stackoverflow.com/questions/44680703/randomnumbergenerator-requirement-during-rsa-encryption-and-decryption/44689418#44689418", "title": "RandomNumberGenerator requirement during RSA encryption and decryption?", "body": "<blockquote>\n  <p>Why is a random number generator (RNG) needed for EncryptorFilter/DecryptorFilter?</p>\n</blockquote>\n\n<p>The signing and verification classes are abstract interfaces setup in <a href=\"https://github.com/weidai11/cryptopp/blob/master/cryptlib.h\" rel=\"nofollow noreferrer\"><code>cryptlib.h</code></a>. Some cryptosystems use them, others do not. A class will specialize and can forgo using a generator. Sometimes a class does not need a generator for one of the operations. <code>NullRNG</code> can be used if not needed.</p>\n\n<p>The reason RSA needs a RNG during public key operations is message padding. Padding is often part of the message formatting function. As @PuzzlePalace pointed out, OAEP padding is randomized and not deterministic.</p>\n\n<p>The reason RSA needs a RNG during private key operations is blinding. For RSA and other RSA-like schemes (like Rabin-Williams), blinding is just a multiplication by a random value to mask the inversion by the priavte key to recover the original value. Later, after signing or decryption, the blinding value is removed and the result of the operation remains.</p>\n\n<p>Related, a reason DSA or ECDSA would <strong><em>not</em></strong> need a RNG during private key operations is <a href=\"https://tools.ietf.org/html/rfc6979\" rel=\"nofollow noreferrer\">RFC 6979, Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)</a>. Deterministic signatures don't use randomized formatting or randomized <code>k</code>'s.</p>\n\n<p>Another reason a RNG is needed for public key and private key operations is validation checks on the key. For example, a key might be checked to ensure a particular constraint holds, like its prime or it has a particular Jacobi symbol.</p>\n\n<hr>\n\n<blockquote>\n  <p>The RNG has to be the same for encryption/decryption, right? So, how to share between processes?</p>\n</blockquote>\n\n<p>No, the generators can be different. The only requirements is they produce a random stream for some reasonable definition of what it means to be \"random\". Without splitting too many hairs, it means the generator produces a uniform distribution.</p>\n\n<p>You can find more reading on Crypto++ generators at <a href=\"https://www.cryptopp.com/wiki/RandomNumberGenerator\" rel=\"nofollow noreferrer\"><code>RandomNumberGenerator</code></a> on the wiki.</p>\n\n<hr>\n\n<blockquote>\n  <p>If I use this code in a unit test with a global RNG, everything works fine.</p>\n</blockquote>\n\n<p>One quick word of caution... <code>GlobalRNG</code> is part of the <code>Test</code> namespace. It is defined in <a href=\"https://github.com/weidai11/cryptopp/blob/master/test.cpp\" rel=\"nofollow noreferrer\"><code>test.cpp : 115</code></a>:</p>\n\n<pre><code>NAMESPACE_BEGIN(CryptoPP)\nNAMESPACE_BEGIN(Test)\n\nANONYMOUS_NAMESPACE_BEGIN\nOFB_Mode&lt;AES&gt;::Encryption s_globalRNG;\nNAMESPACE_END\n\nRandomNumberGenerator &amp; GlobalRNG()\n{\n    return dynamic_cast&lt;RandomNumberGenerator&amp;&gt;(s_globalRNG);\n}\n\nNAMESPACE_END  // Test\nNAMESPACE_END  // CryptoPP\n</code></pre>\n\n<p><code>GlobalRNG</code> is a deterministic generator and its not part of the library proper. Your code will fail to compile in the field if you depend on it.</p>\n\n<p>Use one of the other generators discussed at <a href=\"https://www.cryptopp.com/wiki/RandomNumberGenerator\" rel=\"nofollow noreferrer\"><code>RandomNumberGenerator</code></a> on the wiki. <code>AutoSeededRandomPool</code> is a good choice.</p>\n\n<hr>\n\n<blockquote>\n  <p>Using the NullRNG() as recommended by <a href=\"https://stackoverflow.com/users/608639/jww\">https://stackoverflow.com/users/608639/jww</a> in Unable to do RSA\n  Encrption/Decryption using Crypto++ (isValidCoding is false) leads to</p>\n\n<pre><code>std::exception NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes.\n</code></pre>\n</blockquote>\n\n<p>That information is incorrect. I need to fix it. Thanks.</p>\n\n<hr>\n\n<p>Interestingly (in a morbid sort of way), Crypto++ took <a href=\"https://www.cvedetails.com/cve/CVE-2015-2141/\" rel=\"nofollow noreferrer\">CVE-2015-2141</a> due to blinding in Rabin-Williams. The blinding value needed to be a quadratic residue; otherwise an attacker could prepare special messages to reveal the private key.</p>\n\n<p>The full paper by Evgeny Sidorov is available at <a href=\"https://eprint.iacr.org/2015/368.pdf\" rel=\"nofollow noreferrer\">Breaking the Rabin-Williams digital signature system implementation in the Crypto++ library</a>. Here's what the new and improved inverse function looks like after fixing Sidorov's attack (from <a href=\"https://github.com/weidai11/cryptopp/blob/master/rw.cpp\" rel=\"nofollow noreferrer\"><code>rw.cpp</code></a>):</p>\n\n<pre><code>ModularArithmetic modn(m_n), modp(m_p), modq(m_q);\nInteger r, rInv;\n\ndo\n{\n    // Do this in a loop for people using small numbers for testing\n    r.Randomize(rng, Integer::One(), m_n - Integer::One());\n    // Fix for CVE-2015-2141. Thanks to Evgeny Sidorov for reporting.\n    // Squaring to satisfy Jacobi requirements suggested by Jean-Pierre Munch.\n    r = modn.Square(r);\n    rInv = modn.MultiplicativeInverse(r);\n} while (rInv.IsZero());\n</code></pre>\n\n<p>If you read Section 6 of Sidorov's paper, he suggests generating a random <code>r</code>, and then checking the Jacobi symbol of <code>r</code> to ensure its a quadratic residue. If it was not a QR, then try a new random <code>r</code>. The triage used the method, but it showed the scheme slowed down considerably because a random <code>r</code> satisfies the condition with probability 1/16.</p>\n\n<p>However, we knew squaring <code>r</code> ensured we satisfied Jacobi on the first try because <em>r<sup>2</sup> mod n</em> was always a quadratic residue. The squaring/multiplication only takes <code>log (exp)</code> (not <code>n log (n)</code>), so it turned out to be a significant speedup over trial and error. Before we released the next version of the library, we switched to the squaring method.</p>\n"}], "owner": {"reputation": 61, "user_id": 8195086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f031ec19a4d4a19c9a734561e50e99?s=128&d=identicon&r=PG&f=1", "display_name": "maersk", "link": "https://stackoverflow.com/users/8195086/maersk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1498242220, "creation_date": 1498059821, "last_edit_date": 1498100586, "question_id": 44680703, "link": "https://stackoverflow.com/questions/44680703/randomnumbergenerator-requirement-during-rsa-encryption-and-decryption", "title": "RandomNumberGenerator requirement during RSA encryption and decryption?", "body": "<p>I'm trying to encrypt a message with a public key and decrypt the cipher with the private key using crypto++ like this in the shell:</p>\n\n<pre><code>openssl rsautl -encrypt -inkey id_rsa.pub.pem -pubin -in message -out message.enc\n</code></pre>\n\n<p>and</p>\n\n<pre><code>openssl rsautl -decrypt -inkey id_rsa.pem -in message.enc -out message.dec\n</code></pre>\n\n<p>Encryption/Decryption is done in separate applications. I started with the example from <a href=\"https://www.cryptopp.com/wiki/RSA_Cryptography\" rel=\"nofollow noreferrer\">https://www.cryptopp.com/wiki/RSA_Cryptography</a>.\nMy code:</p>\n\n<pre><code>std::string publicEncrypt(std::string const&amp; plain) {\n    auto cipher = std::string{};\n    CryptoPP::RSAES_OAEP_SHA_Encryptor e(getPublicKey());\n    CryptoPP::StringSource(plain, true,\n        new CryptoPP::PK_EncryptorFilter(CryptoPP::NullRNG(), e,\n                new CryptoPP::StringSink(cipher)));\n   return cipher;\n}\n\nstd::string privateDecrypt(std::string const&amp; cipher) {\n    auto decrypted = std::string{};\n    CryptoPP::RSAES_OAEP_SHA_Decryptor d(getPrivateKey());\n    CryptoPP::StringSource(cipher, true,\n        new CryptoPP::PK_DecryptorFilter(CryptoPP::NullRNG(), d,\n                new CryptoPP::StringSink(decrypted)));\n    return decrypted;\n}\n</code></pre>\n\n<p>My questions: </p>\n\n<ol>\n<li>Why is a random number generator (RNG) needed for EncryptorFilter/DecryptorFilter?</li>\n<li>The RNG has to be the same for encryption/decription, right? So, how to share between processes?</li>\n</ol>\n\n<p>Using the NullRNG() as recommended by <a href=\"https://stackoverflow.com/users/608639/jww\">https://stackoverflow.com/users/608639/jww</a> in <a href=\"https://stackoverflow.com/questions/17028444/unable-to-do-rsa-encrption-decryption-using-crypto-isvalidcoding-is-false\">Unable to do RSA Encrption/Decryption using Crypto++ (isValidCoding is false)</a> leads to </p>\n\n<pre><code>std::exception NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes.\n</code></pre>\n\n<p>I guess I fundamentally miss something. Thanks for hints and advices.</p>\n\n<p>If I use this code in a unit test with a global RNG, everything works fine.</p>\n"}, {"tags": ["c++", "boost", "zlib", "boost-iostreams"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1498131627, "post_id": 44680590, "comment_id": 76379448, "body": "Why not use <code>read()</code> instead"}, {"owner": {"reputation": 2569, "user_id": 1922763, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75228956a9f2a90a98b473672b91d807?s=128&d=identicon&r=PG", "display_name": "Takatoshi Kondo", "link": "https://stackoverflow.com/users/1922763/takatoshi-kondo"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1498135709, "post_id": 44680590, "comment_id": 76382562, "body": "Thank you for the comment. I realized that I misunderstood <code>istream::read()</code> and <code>istream::readsome()</code>  behave like as <code>boost asio</code>&#39;s <code>read()</code> and <code>socket::read_some()</code>.  I replaced          <code>std::size_t read_size = is.readsome(buf, buf_size);</code>         <code>std::cout &lt;&lt; &quot;read_size:&quot; &lt;&lt; read_size &lt;&lt; std::endl;</code>  with         <code>is.read(buf, buf_size);</code>         <code>std::size_t read_size = is.gcount();</code>         <code>std::cout &lt;&lt; &quot;read_size:&quot; &lt;&lt; read_size &lt;&lt; std::endl;</code>  then my code work as I expected."}], "answers": [{"tags": [], "owner": {"reputation": 2569, "user_id": 1922763, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75228956a9f2a90a98b473672b91d807?s=128&d=identicon&r=PG", "display_name": "Takatoshi Kondo", "link": "https://stackoverflow.com/users/1922763/takatoshi-kondo"}, "is_accepted": true, "score": 5, "last_activity_date": 1498200932, "creation_date": 1498200932, "answer_id": 44714942, "question_id": 44680590, "link": "https://stackoverflow.com/questions/44680590/how-to-streaming-decompress-using-boost-iostreams/44714942#44714942", "title": "How to streaming decompress using boost iostreams", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/questions/44680590/how-to-streaming-decompress-using-boost-iostreams?noredirect=1#comment76379448_44680590\">sehe's comment</a>, the problem is solved.</p>\n\n<p>I wrote <a href=\"https://stackoverflow.com/questions/44680590/how-to-streaming-decompress-using-boost-iostreams?noredirect=1#comment76382562_44680590\">the response</a> for the comment but it is difficult to read because codes are not well formatted. So I answer by myself. I hope it will help for other people who have similar problem.</p>\n\n<p>I replaced </p>\n\n<pre><code>std::size_t read_size = is.readsome(buf, buf_size);\n</code></pre>\n\n<p>with </p>\n\n<pre><code>is.read(buf, buf_size);\nstd::size_t read_size = is.gcount();\n</code></pre>\n\n<p>, then problem is solved.</p>\n\n<p>I had misunderstood that <code>std::istream::read</code> blocks until reading <code>buf_size</code> length data. It is not true. Even if the actual read size is less than buf_size, the function returns. See <a href=\"http://www.cplusplus.com/reference/istream/istream/read/\" rel=\"noreferrer\">http://www.cplusplus.com/reference/istream/istream/read/</a>. In order to get <code>read_size</code>, I call <code>std::istream::gcount()</code>. See <a href=\"http://www.cplusplus.com/reference/istream/istream/gcount/\" rel=\"noreferrer\">http://www.cplusplus.com/reference/istream/istream/gcount/</a>.</p>\n\n<p>NOTE: I had gotten confused with <a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/boost_asio/reference/read/overload1.html\" rel=\"noreferrer\"><code>boost::asio::read</code></a> and <a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/boost_asio/reference/basic_stream_socket/read_some/overload1.html\" rel=\"noreferrer\"><code>boost::asio::ip::tcp::socket::read_some</code></a>. But their behavior are different from <code>std::istream</code>'s one.</p>\n\n<p>Here is the complete code of the fixed version:</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\n#include &lt;boost/iostreams/filtering_streambuf.hpp&gt;\n#include &lt;boost/iostreams/copy.hpp&gt;\n#include &lt;boost/iostreams/filter/zlib.hpp&gt;\n\nint main() {\n    // Compress\n    std::stringstream sender;\n    boost::iostreams::filtering_streambuf&lt;boost::iostreams::input&gt; out;\n    out.push(boost::iostreams::zlib_compressor());\n    out.push(sender);\n    sender &lt;&lt; \"Hello World\";\n    std::stringstream compressed;\n    boost::iostreams::copy(out, compressed);\n\n    // Decompress\n    boost::iostreams::filtering_streambuf&lt;boost::iostreams::input&gt; in;\n    in.push(boost::iostreams::zlib_decompressor());\n    in.push(compressed);\n    std::istream is(&amp;in);\n    std::size_t const buf_size = 256;\n    char buf[buf_size] = { '\\0' };\n    is.read(buf, buf_size);\n    std::size_t read_size = is.gcount();\n    std::cout &lt;&lt; \"read_size:\" &lt;&lt; read_size &lt;&lt; std::endl;\n    // http://www.cplusplus.com/reference/ios/ios/rdstate/\n    std::cout &lt;&lt; \"rdstate:\" &lt;&lt; is.rdstate() &lt;&lt; std::endl;\n    std::cout &lt;&lt; buf &lt;&lt; std::endl;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2569, "user_id": 1922763, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75228956a9f2a90a98b473672b91d807?s=128&d=identicon&r=PG", "display_name": "Takatoshi Kondo", "link": "https://stackoverflow.com/users/1922763/takatoshi-kondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 2, "accepted_answer_id": 44714942, "answer_count": 1, "score": 3, "last_activity_date": 1498200932, "creation_date": 1498059526, "last_edit_date": 1498081340, "question_id": 44680590, "link": "https://stackoverflow.com/questions/44680590/how-to-streaming-decompress-using-boost-iostreams", "title": "How to streaming decompress using boost iostreams", "body": "<p>I'm using boost iostreams (1.64.0) in order to decompress zlib data.\nI want to do streaming decompression. That means the compressed data are unpredictable size.\nI wrote the following code example.</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\n#include &lt;boost/iostreams/filtering_streambuf.hpp&gt;\n#include &lt;boost/iostreams/copy.hpp&gt;\n#include &lt;boost/iostreams/filter/zlib.hpp&gt;\n\nint main() {\n    // Compress\n    std::stringstream sender;\n    boost::iostreams::filtering_streambuf&lt;boost::iostreams::input&gt; out;\n    out.push(boost::iostreams::zlib_compressor());\n    out.push(sender);\n    sender &lt;&lt; \"Hello World\";\n    std::stringstream compressed;\n    boost::iostreams::copy(out, compressed);\n\n    // Decompress\n    boost::iostreams::filtering_streambuf&lt;boost::iostreams::input&gt; in;\n    in.push(boost::iostreams::zlib_decompressor());\n    in.push(compressed);\n    std::istream is(&amp;in);\n    std::size_t const buf_size = 256;\n    char buf[buf_size] = { '\\0' };\n#if 0\n    is.getline(buf, buf_size); // works fine\n#else\n    std::size_t read_size = is.readsome(buf, buf_size);\n    std::cout &lt;&lt; \"read_size:\" &lt;&lt; read_size &lt;&lt; std::endl;\n#endif\n    // http://www.cplusplus.com/reference/ios/ios/rdstate/\n    std::cout &lt;&lt; \"rdstate:\" &lt;&lt; is.rdstate() &lt;&lt; std::endl;\n    std::cout &lt;&lt; buf &lt;&lt; std::endl;\n\n}\n</code></pre>\n\n<p>I use <code>readsome()</code> because the size of data is unpredictable.\nI got the following output:</p>\n\n<pre><code>read_size:0\nrdstate:0\n</code></pre>\n\n<p>It was unexpected for me.</p>\n\n<p>If I use <code>getline()</code> instead of <code>readsome()</code>, I got the following output:</p>\n\n<pre><code>rdstate:2\nHello World\n</code></pre>\n\n<p>It was expected output.</p>\n\n<p>I think that when I use <code>readsome()</code>, the out put should be the same.\nI can't use <code>getline()</code> my in actual code because the original data is binary format.</p>\n\n<p>Is there any way to use <code>readsome()</code> with <code>filtering_streambuf</code> or any good way to streaming decompress unpredictable length binary data?</p>\n"}, {"tags": ["c++", "qt", "qml", "qtquick2", "qqmlcontext"], "answers": [{"tags": [], "owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "is_accepted": true, "score": 1, "last_activity_date": 1498059378, "creation_date": 1498059378, "answer_id": 44680526, "question_id": 44680457, "link": "https://stackoverflow.com/questions/44680457/can-i-access-from-c-the-qqmlcontext-in-which-a-qtobject-is-contained/44680526#44680526", "title": "Can I access, from C++, the QQmlContext in which a QtObject is contained?", "body": "<p>I just found a way:</p>\n\n<pre><code>QQmlEngine::contextForObject(myQObject)\n</code></pre>\n\n<p>Haven't tried it yet.</p>\n\n<p>Equivalently:</p>\n\n<pre><code>#include &lt;QtQml&gt;\n\n// ...\n\nqmlContext(myQObject);\n</code></pre>\n"}], "owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 1, "accepted_answer_id": 44680526, "answer_count": 1, "score": 2, "last_activity_date": 1498059378, "creation_date": 1498059197, "question_id": 44680457, "link": "https://stackoverflow.com/questions/44680457/can-i-access-from-c-the-qqmlcontext-in-which-a-qtobject-is-contained", "title": "Can I access, from C++, the QQmlContext in which a QtObject is contained?", "body": "<p>I have a sorta-singleton helper object that, however, I don't want to be actually a singleton, because I prefer to put things on the stack/heap. So I created it on the heap and set it as a contextProperty of my root QQmlContext. I also have a QObject subclass in C++, which is instantiated within the QQmlContext's object tree.</p>\n\n<p><strong>Can I access, from C++, the QQmlContext in which the QObject is contained</strong>, to get to the contextProperty in question?</p>\n\n<p>I know I can do something like this:</p>\n\n<pre><code>// in main.cpp\nengine.rootContext()-&gt;setContextProperty(\"_cp\", cp);\n\n// in foo.qml\nMyQObjectSubclass {\n    cp: _cp\n}\n\n// in myqobjectsubclass.h:\n// (macro from http://syncor.blogspot.bg/2014/11/qt-auto-property.html)\nAUTO_PROPERTY(MyQObjectSubclass*, cp)\n</code></pre>\n\n<p>But that means I must always clog my MyQObjectSubclass QML instances with the \"cp: _cp\" boilerplate.</p>\n"}, {"tags": ["c++", "windows", "data-extraction"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 1, "creation_date": 1498059709, "post_id": 44680439, "comment_id": 76345565, "body": "Write data in app A and read it in app B? Can&#39;t you do this on your own? Or use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365574(v=vs.85).aspx\" rel=\"nofollow noreferrer\">IPC</a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498060024, "post_id": 44680439, "comment_id": 76345798, "body": "This answer may (or may not) be of use <a href=\"https://stackoverflow.com/questions/11757304/how-to-read-a-growing-text-file-in-c/31977550#31977550\" title=\"how to read a growing text file in c\">stackoverflow.com/questions/11757304/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 7635879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed90007cd2412a420f65446e197ad9e?s=128&d=identicon&r=PG&f=1", "display_name": "zrendy", "link": "https://stackoverflow.com/users/7635879/zrendy"}, "edited": false, "score": 0, "creation_date": 1498061234, "post_id": 44680439, "comment_id": 76346598, "body": "ill look into IPC, along the lines of what i want, thank you."}], "owner": {"reputation": 23, "user_id": 7635879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed90007cd2412a420f65446e197ad9e?s=128&d=identicon&r=PG&f=1", "display_name": "zrendy", "link": "https://stackoverflow.com/users/7635879/zrendy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498059133, "creation_date": 1498059133, "question_id": 44680439, "link": "https://stackoverflow.com/questions/44680439/get-live-data-from-export-option-on-program", "title": "Get live data from export option on program.", "body": "<p>I want to know if there's a way, or if its even possible, to get live data from another program. So there's this software that logs data in real time, you then have the option to retrieve that data through a csv file that contains a time stamp and value by exporting it. I want that data live, basically to be exported continually into that text file so I can use it in a C++ program. I know this a vague question, but is there any possible way of doing this? </p>\n"}, {"tags": ["c++", "char"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 3, "creation_date": 1498058852, "post_id": 44680285, "comment_id": 76344938, "body": "<code>a</code> is an array, not a pointer. It can be used as a pointer to the first element because of a thing called <i>array decay</i>. This was answered countless times already..."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1498058954, "post_id": 44680285, "comment_id": 76345015, "body": "Here&#39;s the link: <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">What is array decaying?</a>"}, {"owner": {"reputation": 649, "user_id": 3600124, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/122fd539f60a59dd354d9e30f8be7253?s=128&d=identicon&r=PG&f=1", "display_name": "user3600124", "link": "https://stackoverflow.com/users/3600124/user3600124"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1498059002, "post_id": 44680285, "comment_id": 76345050, "body": "a holds a number (seems like it when printed out with std::cout). How is a number an array? Looks like an address to me and nothing more"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1498059101, "post_id": 44680285, "comment_id": 76345120, "body": "Read the link please. <code>(int)a</code> makes <code>a</code> decay from <code>int [5]</code> to <code>int *</code> (pointer to the first element), which is then converted to int."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498059103, "post_id": 44680285, "comment_id": 76345121, "body": "@user3600124 It&#39;s clear from your comments you did not read the provided link. <code>a</code> will often decay to a pointer when it&#39;s used where a pointer is expected. In <i>those cases</i> it will behave as a pointer. In every other case, it&#39;s an array. Your <code>cout</code> statement is one of those cases that will treat it as a pointer."}, {"owner": {"reputation": 21641, "user_id": 96780, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PPilI.jpg?s=128&g=1", "display_name": "Daniel Daranas", "link": "https://stackoverflow.com/users/96780/daniel-daranas"}, "edited": false, "score": 0, "creation_date": 1498059117, "post_id": 44680285, "comment_id": 76345141, "body": "Because <code>char variable_name[size];</code> is the official syntax of a char array declaration in C++?"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1498059810, "post_id": 44680626, "comment_id": 76345638, "body": "1 is incorrect."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498070093, "post_id": 44680626, "comment_id": 76351582, "body": "@Slava: Thank you, I corrected it!"}, {"owner": {"reputation": 649, "user_id": 3600124, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/122fd539f60a59dd354d9e30f8be7253?s=128&d=identicon&r=PG&f=1", "display_name": "user3600124", "link": "https://stackoverflow.com/users/3600124/user3600124"}, "edited": false, "score": 0, "creation_date": 1498127009, "post_id": 44680626, "comment_id": 76376349, "body": "sizeof(&amp;a) gives 4. If &amp;a is of type char (*)[5] it shouldn&#39;t give 4 isn&#39;t it?"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 649, "user_id": 3600124, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/122fd539f60a59dd354d9e30f8be7253?s=128&d=identicon&r=PG&f=1", "display_name": "user3600124", "link": "https://stackoverflow.com/users/3600124/user3600124"}, "edited": false, "score": 0, "creation_date": 1498130172, "post_id": 44680626, "comment_id": 76378459, "body": "@user3600124: I extend my answer... Don&#39;t forget it is a pointer to an array note the <code>(*)</code>, so the size will be the pointer size which is on your system 4."}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": false, "score": 0, "last_activity_date": 1498130918, "last_edit_date": 1498130918, "creation_date": 1498059614, "answer_id": 44680626, "question_id": 44680285, "link": "https://stackoverflow.com/questions/44680285/weird-behaviour-of-char/44680626#44680626", "title": "Weird behaviour of char[]", "body": "<blockquote>\n  <p>I am confused... what a actually is? It is said to be of type char*</p>\n</blockquote>\n\n<p>If you define an array like you do: <code>char a[5] = \"hill;\"</code>.\nThen the following holds:</p>\n\n<pre><code>1. a     implicitly decayed to char *: decayed to a pointer to the first element\n2. &amp;a[0] is of type char *:            pointer to the first element\n3. &amp;a    is of type char (*)[5]:       pointer to an array which starts at the first element\n</code></pre>\n\n<p>All of them points to the same memory address but they are of a different type. Note that in case 1 the array name will be <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">decayed</a>.</p>\n\n<blockquote>\n  <p>Oh well, the exact same address is printed out. Please explain me, what is happening here</p>\n</blockquote>\n\n<p>That  means if you print out the address of either <code>a</code> or <code>&amp;a</code> it will be the same. Also remember that if you want to print an address you cast the pointer to a <code>void*</code> and not just to an <code>int</code>.</p>\n\n<blockquote>\n  <p>It is a pointer, its value must be an address of the first character. And a itself must have an address. Surely these two addresses have to be different as a is of type char* and the address it hold points to char.</p>\n</blockquote>\n\n<p>With your assumption that the <code>a</code> points implicitly to the first element you're right. Also this variable has an address where the value that point to something is stored.</p>\n\n<hr>\n\n<p><strong>Edit #1:</strong></p>\n\n<p><strong>Proof of the above:</strong></p>\n\n<p>Becaue several comments challenged, what I explained about <code>a</code>, <code>&amp;a[0]</code> and <code>&amp;a</code> here is the proof. Therefore I wrote this little not compiling C code:</p>\n\n<pre><code>int main()\n{\n    char a[5];\n    double b;\n\n    /* the following fails */\n    b = a;     /* decay to char * */\n    b = &amp;a[0]; /* char *          */\n    b = &amp;a;    /* char (*)[5]     */\n}\n</code></pre>\n\n<p>The compiler will fail and output errors and the expected type.</p>\n\n<pre><code>../src/SO_Test_C.c:6:7: error: incompatible types when assigning to type \u2018double\u2019 from type \u2018char *\u2019\n     b = a;\n       ^\n../src/SO_Test_C.c:7:7: error: incompatible types when assigning to type \u2018double\u2019 from type \u2018char *\u2019\n     b = &amp;a[0];\n       ^\n../src/SO_Test_C.c:8:7: error: incompatible types when assigning to type \u2018double\u2019 from type \u2018char (*)[5]\u2019\n     b = &amp;a;\n       ^\n</code></pre>\n\n<p><strong>sizeof():</strong></p>\n\n<p>Here is what the different <code>sizeof()</code> operations are returning:</p>\n\n<pre><code>sizeof(a)     --&gt; Array size:   5\nsizeof(&amp;a[0]) --&gt; Pointer size: 8 (64bit) / 4 (32bit)\nsizeof(&amp;a))   --&gt; Pointer size: 8 (64bit) / 4 (32bit)\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 3600124, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/122fd539f60a59dd354d9e30f8be7253?s=128&d=identicon&r=PG&f=1", "display_name": "user3600124", "link": "https://stackoverflow.com/users/3600124/user3600124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1498059985, "answer_count": 1, "score": -4, "last_activity_date": 1498130918, "creation_date": 1498058707, "last_edit_date": 1498058745, "question_id": 44680285, "link": "https://stackoverflow.com/questions/44680285/weird-behaviour-of-char", "closed_reason": "Duplicate", "title": "Weird behaviour of char[]", "body": "<pre><code>char a[5] = \"hill\";\n</code></pre>\n\n<p>I am confused... what <em>a</em> actually is? It is said to be of type <em>char*</em>. It is a pointer, its value must be an address of the first character. And <em>a</em> itself must have an address. Surely these two addresses have to be different as <em>a</em> is of type <em>char*</em> and the address it hold points to <em>char</em>.</p>\n\n<pre><code>std::cout &lt;&lt; (int)&amp;a &lt;&lt; ' ' &lt;&lt; (int)a &lt;&lt; std::endl;\n</code></pre>\n\n<p>Oh well, the exact same address is printed out. Please explain me, what is happening here</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7533668"}, "edited": false, "score": 0, "creation_date": 1498059133, "post_id": 44680326, "comment_id": 76345152, "body": "Would this still capture the normal output (if there are no errors) into the buffer?"}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 1, "creation_date": 1498059329, "post_id": 44680326, "comment_id": 76345272, "body": "@DramaticStackoverflowPirate yes. <code>2&gt;&amp;1</code> means write stderr (2) to stdout (1) but it doesn&#39;t drop stdout, it effectively combines combines the two."}], "tags": [], "owner": {"reputation": 4513, "user_id": 955526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wY7X3.png?s=128&g=1", "display_name": "Anew", "link": "https://stackoverflow.com/users/955526/anew"}, "is_accepted": true, "score": 3, "last_activity_date": 1498058804, "creation_date": 1498058804, "answer_id": 44680326, "question_id": 44680190, "link": "https://stackoverflow.com/questions/44680190/c-read-popen-error-output-into-string/44680326#44680326", "title": "C++ read popen error output into string", "body": "<p>You can specify redirection in the <code>popen</code> method call:</p>\n\n<pre><code>popen(\"mkdir x 2&gt;&amp;1\", \"r\")\n</code></pre>\n\n<p>You'd then be able to read the error message from the buffer.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7533668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1593, "favorite_count": 0, "closed_date": 1498061754, "accepted_answer_id": 44680326, "answer_count": 1, "score": 0, "last_activity_date": 1498058804, "creation_date": 1498058489, "question_id": 44680190, "link": "https://stackoverflow.com/questions/44680190/c-read-popen-error-output-into-string", "closed_reason": "Duplicate", "title": "C++ read popen error output into string", "body": "<p>I'm opening a process via the posix <code>popen()</code> function. E.g. git push, mkdir x, etc.</p>\n\n<p>I can read the output from these commands easily by storing it into a buffer like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nint main() {\n\nFILE *in;\nchar buff[512];\n\nif(!(in = popen(\"mkdir x\", \"r\"))){\n    return 1;\n}\n\n// fgets stores the output into buff\nwhile(fgets(buff, sizeof(buff), in)!=NULL){\n    cout &lt;&lt; buff;\n}\npclose(in);\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>But then if there is an error with the process, e.g. mkdir fails, then I want to read the error into a string or character buffer.</p>\n\n<p>However, with the code above, if it fails, the error isn't stored in the buffer. I think it is because the error is redirected to standard error instead of standard input.</p>\n\n<p>How do I modify the code above to get the error message returned by bash/the process?</p>\n"}, {"tags": ["c++", "xcode", "list", "vector", "binary"], "comments": [{"owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "edited": false, "score": 0, "creation_date": 1498058544, "post_id": 44680175, "comment_id": 76344722, "body": "The binary codewords in a string form? Or integer form?"}, {"owner": {"reputation": 3, "user_id": 8195116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf1e2ff67ed1812cf6346da923a3ed7?s=128&d=identicon&r=PG&f=1", "display_name": "confused_math", "link": "https://stackoverflow.com/users/8195116/confused-math"}, "reply_to_user": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "edited": false, "score": 0, "creation_date": 1498058568, "post_id": 44680175, "comment_id": 76344740, "body": "the binary codewords are in string form"}, {"owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "edited": false, "score": 0, "creation_date": 1498058653, "post_id": 44680175, "comment_id": 76344800, "body": "Use a for loop or while loop to go over the string, and take to vectors, one to store the indexes of 1&#39;s and the other to store the indexes of 0&#39;s"}], "answers": [{"comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1498058960, "post_id": 44680320, "comment_id": 76345018, "body": "According to the OP, the binary code word is a string of ones and zeros."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1498059114, "post_id": 44680320, "comment_id": 76345137, "body": "@ForceBru answer updated. Thanks."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 0, "last_activity_date": 1498059089, "last_edit_date": 1498059089, "creation_date": 1498058792, "answer_id": 44680320, "question_id": 44680175, "link": "https://stackoverflow.com/questions/44680175/want-to-find-the-positions-of-1-or-0-occurring-in-a-binary-codeword/44680320#44680320", "title": "Want to find the positions of 1 or 0 occurring in a binary codeword", "body": "<p>You can easily test if a specific bit is set by using binary and <code>&amp;</code>.</p>\n\n<p>For example, to test if bit 3 is set in <code>foo</code> you can do</p>\n\n<pre><code>bool is_set = foo &amp; 0b100;\n</code></pre>\n\n<p>Then <code>is_set</code> will be <code>true</code> if the third bit is set or <code>false</code> otherwise.</p>\n\n<p>Wrapping that in a function where you can pass in an integer and the bit number you are interested in and get a bool back saying if it is set or not is trivial.</p>\n\n<p>Using such a function it should be easy to build your lists of all set and all unset bits.</p>\n\n<p>If your codeword is a string you can either a) convert it to integer first then do as outlined above or b) just iterate the string and test each character against '0' or '1' and based on the result add the current position to the right set.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8195116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf1e2ff67ed1812cf6346da923a3ed7?s=128&d=identicon&r=PG&f=1", "display_name": "confused_math", "link": "https://stackoverflow.com/users/8195116/confused-math"}, "edited": false, "score": 0, "creation_date": 1498059387, "post_id": 44680389, "comment_id": 76345313, "body": "This is probably a stupid question, but how do you get the vectors to then print out? Because I am putting your code into my program but getting no output. Thanks!"}, {"owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "reply_to_user": {"reputation": 3, "user_id": 8195116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf1e2ff67ed1812cf6346da923a3ed7?s=128&d=identicon&r=PG&f=1", "display_name": "confused_math", "link": "https://stackoverflow.com/users/8195116/confused-math"}, "edited": false, "score": 0, "creation_date": 1498059609, "post_id": 44680389, "comment_id": 76345473, "body": "There. I updated it. Now the code prints the output too"}, {"owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "reply_to_user": {"reputation": 3, "user_id": 8195116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf1e2ff67ed1812cf6346da923a3ed7?s=128&d=identicon&r=PG&f=1", "display_name": "confused_math", "link": "https://stackoverflow.com/users/8195116/confused-math"}, "edited": false, "score": 0, "creation_date": 1498059724, "post_id": 44680389, "comment_id": 76345571, "body": "<a href=\"http://www.cplusplus.com/reference/vector/vector/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/vector/vector</a> You can visited this link for learning vectors"}], "tags": [], "owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "is_accepted": true, "score": -1, "last_activity_date": 1498059584, "last_edit_date": 1498059584, "creation_date": 1498058986, "answer_id": 44680389, "question_id": 44680175, "link": "https://stackoverflow.com/questions/44680175/want-to-find-the-positions-of-1-or-0-occurring-in-a-binary-codeword/44680389#44680389", "title": "Want to find the positions of 1 or 0 occurring in a binary codeword", "body": "<p>I think this might help you.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nusing namespace std;\nint main(){\n    string binary_string;\n    cin &gt;&gt; binary_string;\n    vector &lt;int&gt; position_of_ones,position_of_zeroes;\n    for(int i = 0; i &lt; binary_string.length(); i++){\n        if(binary_string[i] == '0'){\n            position_of_zeroes.push_back(i+1);\n        }\n        else{\n            position_of_ones.push_back(i+1);\n        }\n    }\n\n    cout &lt;&lt; \"Position of 0s\" &lt;&lt; endl;\n    for(int i = 0; i &lt; position_of_zeroes.size(); i++){\n        if(i != 0)    cout &lt;&lt; \",\";\n        cout &lt;&lt; position_of_zeroes[i];\n    }\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"Position of 1s\" &lt;&lt; endl;\n    for(int i = 0; i &lt; position_of_ones.size(); i++){\n        if(i != 0)    cout &lt;&lt; \",\";\n        cout &lt;&lt; position_of_ones[i];\n    }\n    cout &lt;&lt; endl;\n }\n</code></pre>\n\n<p>And now you can use those vectors.</p>\n"}, {"tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": false, "score": 0, "last_activity_date": 1498060080, "last_edit_date": 1498060080, "creation_date": 1498059166, "answer_id": 44680448, "question_id": 44680175, "link": "https://stackoverflow.com/questions/44680175/want-to-find-the-positions-of-1-or-0-occurring-in-a-binary-codeword/44680448#44680448", "title": "Want to find the positions of 1 or 0 occurring in a binary codeword", "body": "<p>You can do something like this: <a href=\"http://thispointer.com/find-all-occurrences-of-a-sub-string-in-a-string-c-both-case-sensitive-insensitive/\" rel=\"nofollow noreferrer\">Link</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n\nusing namespace std;\n\n/*\n *Find all positions of the a SubString in given String\n */\nvoid findAllOccurances(std::vector&lt;size_t&gt; &amp; vec, std::string data, std::string toSearch)\n{\n    // Get the first occurrence\n    size_t pos = data.find(toSearch);\n\n    // Repeat till end is reached\n    while( pos != std::string::npos)\n    {\n        // Add position to the vector\n        vec.push_back(pos+1); //Added 1, we start to count positions at 1 instead of 0\n\n        // Get the next occurrence from the current position\n        pos =data.find(toSearch, pos + toSearch.size());\n    }\n}\n\nint main()\n{\n    std::string data = \"1001101\";\n\n    std::vector&lt;size_t&gt; vec;\n\n    // Get All occurrences of the '1' in the vector 'vec'\n    findAllOccurances(vec, data , \"1\");\n\n    std::cout&lt;&lt;\"All Index Position of '1' in given string are,\"&lt;&lt;std::endl;\n\n    for(size_t pos : vec)\n        std::cout&lt;&lt;pos&lt;&lt;std::endl;\n\n    std::vector&lt;size_t&gt; vec0;\n    // Get All occurrences of the '0' in the vector 'vec0' backwards\n    findAllOccurances(vec0, data , \"0\");\n\n    std::cout&lt;&lt;\"All Index Position of '0' in given string backwards are,\"&lt;&lt;std::endl;\n\n    std::reverse_copy(vec0.begin(), vec0.end(), std::ostream_iterator&lt;int&gt;(std::cout, \"\\n\"));\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/BwqIUd\" rel=\"nofollow noreferrer\">Live sample!</a></p>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>All Index Position of '1' in given string are, <br> 1 <br> 4 <br> 5\n  <br> 7 <br> All Index Position of '0' in given string backwards are,\n  <br> 6 <br> 3 <br> 2 <br></p>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 8195116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf1e2ff67ed1812cf6346da923a3ed7?s=128&d=identicon&r=PG&f=1", "display_name": "confused_math", "link": "https://stackoverflow.com/users/8195116/confused-math"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1498060285, "accepted_answer_id": 44680389, "answer_count": 3, "score": -1, "last_activity_date": 1498060080, "creation_date": 1498058446, "last_edit_date": 1498058677, "question_id": 44680175, "link": "https://stackoverflow.com/questions/44680175/want-to-find-the-positions-of-1-or-0-occurring-in-a-binary-codeword", "closed_reason": "Needs more focus", "title": "Want to find the positions of 1 or 0 occurring in a binary codeword", "body": "<p>I have made a program in which I retain a string that is random binary codeword (1001101 for example) and I want to be able to create a list or vector in which it tells me the positions of the 1s or 0s. For example, the list of positions of 1s would be {1,4,5,7}. And I would also like to find out how to do the reverse. For example, the list of positions of 0s could be {6,3,2}. I don't have a code to show because I really cannot figure this out. And I couldnt find anything on here that exactly helped me. Thank you!</p>\n"}, {"tags": ["c#", "c++", "uwp", "mpeg-dash", "direct3d11"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3948724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f8fb8db04e558fd11e7bd70c7a31a4?s=128&d=identicon&r=PG&f=1", "display_name": "Glen Rhodes", "link": "https://stackoverflow.com/users/3948724/glen-rhodes"}, "edited": false, "score": 0, "creation_date": 1498072759, "post_id": 44683848, "comment_id": 76353237, "body": "Thank you very much.  I will give this a try!"}, {"owner": {"reputation": 3005, "user_id": 6517621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1408058762542854/picture?type=large", "display_name": "Hasan Emrah S&#252;ng&#252;", "link": "https://stackoverflow.com/users/6517621/hasan-emrah-s%c3%bcng%c3%bc"}, "reply_to_user": {"reputation": 1, "user_id": 3948724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f8fb8db04e558fd11e7bd70c7a31a4?s=128&d=identicon&r=PG&f=1", "display_name": "Glen Rhodes", "link": "https://stackoverflow.com/users/3948724/glen-rhodes"}, "edited": false, "score": 0, "creation_date": 1498072983, "post_id": 44683848, "comment_id": 76353376, "body": "@GlenRhodes, I am also curios to see if it works :) Let me know of the results, and if it solves the problem do not forget to check as answered so other people can see"}], "tags": [], "owner": {"reputation": 3005, "user_id": 6517621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1408058762542854/picture?type=large", "display_name": "Hasan Emrah S&#252;ng&#252;", "link": "https://stackoverflow.com/users/6517621/hasan-emrah-s%c3%bcng%c3%bc"}, "is_accepted": false, "score": 0, "last_activity_date": 1498070455, "creation_date": 1498070455, "answer_id": 44683848, "question_id": 44680049, "link": "https://stackoverflow.com/questions/44680049/sending-id3d11texture2d-from-c-into-c-uwp-mediaplayer/44683848#44683848", "title": "Sending ID3D11Texture2D from C++ into C# UWP MediaPlayer", "body": "<p>There is no problem with the <code>DllImport</code>.</p>\n\n<pre><code>[DllImport(\"VideoPlayer\")]\nprivate static extern IntPtr GetVideoTextureSurface();\n</code></pre>\n\n<p>You need to marshall the returned pointer to ID3D11Texture2D type of struct. Please have look at the layout of the struct <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ff476635(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a>. When you search for the underlying texture resource type, you will end up <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ff476521(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a>. So it is a pointer to a <code>D3D11_TEXTURE2D_DESC</code> structure that describes a 2D texture resource.</p>\n\n<pre><code>typedef struct D3D11_TEXTURE2D_DESC {\n  UINT             Width;\n  UINT             Height;\n  UINT             MipLevels;\n  UINT             ArraySize;\n  DXGI_FORMAT      Format;\n  DXGI_SAMPLE_DESC SampleDesc;\n  D3D11_USAGE      Usage;\n  UINT             BindFlags;\n  UINT             CPUAccessFlags;\n  UINT             MiscFlags;\n} D3D11_TEXTURE2D_DESC;\n</code></pre>\n\n<p>Lets define our own managed Struct</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct MyStruct : IDirect3DSurface {\n    public int Width { get; set; }\n    public int Height { get; set; }\n    public int MipLevels { get; set; }\n    public uint ArraySize { get; set; }\n    public DirectXPixelFormat Format { get; set; }\n    public Direct3DMultisampleDescription SampleDesc { get; set; }\n    public Direct3DUsage Usage { get; set; }\n    public uint BindFlags { get; set; }\n    public uint CPUAccessFlags { get; set; }\n    public uint MiscFlags { get; set; }\n\n    #region I Do not know about this part\n    public Action Disposer { get; set; }\n    public void Dispose() {\n        Disposer();\n    }\n    #endregion I Do not know about this part\n\n    public Direct3DSurfaceDescription Description =&gt; new Direct3DSurfaceDescription {\n        Format = Format,\n        Height = Height,\n        Width = Width,\n        MultisampleDescription = SampleDesc\n    };\n}\n</code></pre>\n\n<p>Here is a simple wrapper from native to managed struct:</p>\n\n<pre><code>public static MyStruct TestWrapper() {\n        var ptr = GetVideoTextureSurface();\n        var myStruct = Marshal.PtrToStructure&lt;MyStruct&gt;(ptr);\n        myStruct.Disposer = () =&gt; Marshal.FreeHGlobal(ptr);\n        return myStruct;\n    }\n</code></pre>\n\n<p>Now you can use</p>\n\n<pre><code>MediaPlayer.CopyFrameToVideoSurface(myStruct);\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 3948724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f8fb8db04e558fd11e7bd70c7a31a4?s=128&d=identicon&r=PG&f=1", "display_name": "Glen Rhodes", "link": "https://stackoverflow.com/users/3948724/glen-rhodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498070455, "creation_date": 1498058121, "question_id": 44680049, "link": "https://stackoverflow.com/questions/44680049/sending-id3d11texture2d-from-c-into-c-uwp-mediaplayer", "title": "Sending ID3D11Texture2D from C++ into C# UWP MediaPlayer", "body": "<p>I've got a C++ unmanaged DLL that is basically a video playback engine. It streams video using the WMF and draws frames using TransferVideoFrame to a ID3D11Texture2D.</p>\n\n<p>That's all working fine.  </p>\n\n<p>However, I've been tasked with implementing MPEG_DASH stream switching, and so I'm creating a C# wrapper that uses the MediaPlayer and the AdaptiveStreaming classes, to get DASH and HLS streaming working.</p>\n\n<p>What I'm trying to figure out is, how do I send the frame pixel data from the MediaPlayer, into the C++ DLL to draw it to the ID3DTexture2D.</p>\n\n<p>In C++, I have a function that returns a pointer to the ID3D11Texture2D, </p>\n\n<pre><code>ID3D11Texture2D* VideoPlayer::GetVideoTextureSurface()\n{\n    if (_ctxt.m_spVideoTexSRV) // ComPtr&lt;ID3D11ShaderResourceView&gt;\n    {\n        return _ctxt.m_spVideoTex.Get(); // ComPtr&lt;ID3D11Texture2D&gt;\n    }\n    else return nullptr;\n}\n</code></pre>\n\n<p>which I call from C# and get as an IntPtr.</p>\n\n<pre><code>[DllImport(\"VideoPlayer\")]\nprivate static extern IntPtr GetVideoTextureSurface();\n</code></pre>\n\n<p>And in C# the MediaPlayer has a method:</p>\n\n<pre><code>MediaPlayer.CopyFrameToVideoSurface(IDirect3DSurface destination)\n</code></pre>\n\n<p>Which I want to use to make MediaPlayer draw its frame into the C++ ID3D11Texture3D. But I am not sure how to pass an IntPtr into that. I'm trying to avoid copying frame buffers multiple times by drawing straight to the Texture.</p>\n\n<p>I'm not even sure if this is the best approach. I could use MediaPlayer directly from C++, but I'm not even sure how to instantiate it. In C# it's simply:</p>\n\n<pre><code>MediaPlayer _mediaPlayer = new MediaPlayer();\n</code></pre>\n\n<p>But when I try to create it in C++, I get the error, \"Incomplete Type is not allowed\".  Any ideas, insight or help is appreciated.</p>\n"}, {"tags": ["c++", "asynchronous", "boost-asio"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1498058607, "post_id": 44679921, "comment_id": 76344770, "body": "This is a matter of design. Asynchronous means that your call is not blocked until completion of the operation, thus if IOs are longer than logical code, you can simply use async IOs to accelerate the whole. But doing so doesn&#39;t means concurrency as with threads. With async there is concurrency in between IOs and logical code, while with threads you have a full concurrency even between logical code. Roughly. With async you can have the &quot;system&quot; writing an answer while reading a request, accepting a connection or computing something, a light form of concurrency."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498059272, "post_id": 44679921, "comment_id": 76345236, "body": "A multi-threaded server doesn&#39;t have to use async IO, it usually makes little sense to do so."}], "answers": [{"comments": [{"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 1, "creation_date": 1498059692, "post_id": 44680164, "comment_id": 76345548, "body": "<code>there will be no concurrency at all</code> - actually, it makes sense it will be. you&#39;ll just open up small number of threads, usually as the number of logical cores on you machine."}, {"owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "edited": false, "score": 0, "creation_date": 1498062538, "post_id": 44680164, "comment_id": 76347376, "body": "So, you mean that an async server always perform async operations, but if the server is busy because an operation&#39;s callback is being executed (for instance, a heavy IO operation), no other operation will be able to be performed, right?"}], "tags": [], "owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "is_accepted": true, "score": 4, "last_activity_date": 1498059112, "last_edit_date": 1498059112, "creation_date": 1498058412, "answer_id": 44680164, "question_id": 44679921, "link": "https://stackoverflow.com/questions/44679921/i-dont-understand-how-to-async-operations-can-make-a-http-server-concurrent/44680164#44680164", "title": "I don&#39;t understand how to async operations can make a HTTP server concurrent", "body": "<p>The meaning of the word \"concurrent\" is ambiguous.</p>\n\n<p>You are right, an asynchronous server is not concurrent at all. It can process only one request at a time. But the key insight is that what most servers do is actually they take a request, do some light processing (parsing, serialization, validation, some light business logic, etc.) and then call external resources (e.g. some database). The server can then process other requests while waiting for the external resource. So it's only an illusion of being concurrent (processing happens one after another but really fast). And it works as long as the processing is relatively fast compared to io.</p>\n\n<p>If your server is supposed to do some hard cpu computations then obviously there will be no concurrency at all. In that case the only way to make it concurrent is to add threads or processes (possibly on multiple machines).</p>\n"}, {"tags": [], "owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "is_accepted": false, "score": 1, "last_activity_date": 1498059286, "creation_date": 1498059286, "answer_id": 44680494, "question_id": 44679921, "link": "https://stackoverflow.com/questions/44679921/i-dont-understand-how-to-async-operations-can-make-a-http-server-concurrent/44680494#44680494", "title": "I don&#39;t understand how to async operations can make a HTTP server concurrent", "body": "<p>Asynchronous IO does not make the server concurrent. </p>\n\n<p>In fact, Asynchronous IO does not mean \"multi-threaded\" or \"multi-processed\" at all. Node.js servers are mono-threaded and using asynchronous IO.</p>\n\n<p>Asynchronous IO just means your thread does not wait for the IO to finish, but does other stuff meanwhile (like accepting and processing new incoming requests).</p>\n\n<p>So no, the premise that Asynchronous IO makes the server concurrent is wrong. it does not make it concurrent, it makes it <strong>scalable</strong>, as thread-per-request is not so scalable, but a proper thread-pool + event queue/coroutines are. the threads only deal with CPU bound tasks and the event queue/coroutines manages enqueuing and dequeuing started/finished IO operations.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 3910497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bb617a5e5ad12a0ea8e7b073b7ce05?s=128&d=identicon&r=PG&f=1", "display_name": "user3910497", "link": "https://stackoverflow.com/users/3910497/user3910497"}, "is_accepted": false, "score": 0, "last_activity_date": 1498077774, "creation_date": 1498077774, "answer_id": 44685929, "question_id": 44679921, "link": "https://stackoverflow.com/questions/44679921/i-dont-understand-how-to-async-operations-can-make-a-http-server-concurrent/44685929#44685929", "title": "I don&#39;t understand how to async operations can make a HTTP server concurrent", "body": "<p>Not sure if you're only looking for a theoretical answer or a design example, but have you seen the <a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/boost_asio/examples/cpp03_examples.html#boost_asio.examples.cpp03_examples.http_server_3\" rel=\"nofollow noreferrer\">HTTP Server 3</a> example for boost.asio?</p>\n\n<p>Concurrency is achieved by having a small thread pool to execute the work. When callbacks need to be handled, all threads calling <code>io_service.run()</code> can be chosen to execute the task.</p>\n"}], "owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 44680164, "answer_count": 3, "score": 2, "last_activity_date": 1498077774, "creation_date": 1498057807, "question_id": 44679921, "link": "https://stackoverflow.com/questions/44679921/i-dont-understand-how-to-async-operations-can-make-a-http-server-concurrent", "title": "I don&#39;t understand how to async operations can make a HTTP server concurrent", "body": "<p>I am developing a HTTP server using boost asio. So far, I have been using async operations (<code>aync_read</code>, <code>async_write</code> etc.), but I want to make my server concurrent, that is, the same as a server that creates a new thread per each new client connected.</p>\n\n<p>I have read some forums etc. and, apparently, a concurrent server can be made only by using the mentioned async operations. <strong>I do not understand how is this possible.</strong></p>\n\n<p>I mean, taking into account that the async operations' handlers are executed in the thread that called to <code>io_service.run()</code>, lets take that a client is being responsed at this moment. How can another client make a petition and been answered while the main thread is busy with the first client?</p>\n"}, {"tags": ["c++", "data-structures"], "comments": [{"owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1498057251, "post_id": 44679700, "comment_id": 76343692, "body": "overload the operator &lt;&lt;"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1498057274, "post_id": 44679700, "comment_id": 76343715, "body": "Everything you want to know: <a href=\"https://stackoverflow.com/questions/4421706/operator-overloading\">stackoverflow.com/questions/4421706/operator-overloading</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498057292, "post_id": 44679700, "comment_id": 76343725, "body": "You have to overload the <code>std::ostream&amp; Operator&lt;&lt;(std::ostream&amp;, const node&amp;)</code> operator to do so."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1498059555, "post_id": 44679700, "comment_id": 76345430, "body": "An alternative to overloading <code>&lt;&lt;</code> is to create a <code>toString()</code> class method so you can do <code>cout &lt;&lt; n.toString();</code>"}, {"owner": {"reputation": 39554, "user_id": 4667835, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1046586602022805/picture?type=large", "display_name": "D&#225;vid P&#225;sztor", "link": "https://stackoverflow.com/users/4667835/d%c3%a1vid-p%c3%a1sztor"}, "edited": false, "score": 1, "creation_date": 1498061582, "post_id": 44679700, "comment_id": 76346812, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4421706/operator-overloading\">Operator overloading</a>"}], "answers": [{"tags": [], "owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "is_accepted": false, "score": 0, "last_activity_date": 1498057573, "creation_date": 1498057573, "answer_id": 44679839, "question_id": 44679700, "link": "https://stackoverflow.com/questions/44679700/how-do-i-print-a-strucure-in-c/44679839#44679839", "title": "How do I print a strucure in c++?", "body": "<p>Yes. You should override the &lt;&lt; operator for the object <code>cout</code>. But <code>cout</code> is an object of class ostream so you cannot just simply overload the &lt;&lt; operator for that class. You have to use a friend function. The function body would look like this:</p>\n\n<pre><code>friend ostream&amp; operator&lt;&lt; (ostream &amp; in, const node&amp; n){\n    in &lt;&lt; \"(\" &lt;&lt; n.next &lt;&lt; \",\" &lt;&lt; n.data &lt;&lt; \")\" &lt;&lt; endl;\n    return in;\n}\n</code></pre>\n\n<p>The function is friend, in case if you have private data in your class.</p>\n"}, {"tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": true, "score": 0, "last_activity_date": 1498057691, "creation_date": 1498057691, "answer_id": 44679879, "question_id": 44679700, "link": "https://stackoverflow.com/questions/44679700/how-do-i-print-a-strucure-in-c/44679879#44679879", "title": "How do I print a strucure in c++?", "body": "<p>You need to overload the &lt;&lt; operator properly:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\nstruct node {\n    int next;\n    std::string data;\n    friend std::ostream&amp; operator&lt;&lt; (std::ostream&amp; stream, const node&amp; myNode) {\n        stream &lt;&lt; \"next: \" &lt;&lt; myNode.next &lt;&lt; \", Data: \" &lt;&lt; myNode.data &lt;&lt; std::endl;\n        return stream;\n    }\n};\n\nint main(int argc, char** argv) {\n    node n{1, \"Hi\"};\n\n    std::cout &lt;&lt; n &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8171468, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oB8xWwNF1Z4/AAAAAAAAAAI/AAAAAAAADpE/qQremy1VyuU/photo.jpg?sz=128", "display_name": "Rishi Chauhan", "link": "https://stackoverflow.com/users/8171468/rishi-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 44679879, "answer_count": 2, "score": 0, "last_activity_date": 1498057691, "creation_date": 1498057211, "question_id": 44679700, "link": "https://stackoverflow.com/questions/44679700/how-do-i-print-a-strucure-in-c", "title": "How do I print a strucure in c++?", "body": "<p>We can print elements of a structure using <code>structure.element</code>. But I want to print a complete structure at once.</p>\n\n<p>Is there a method something like <code>cout&lt;&lt;strucutre</code>, the same way we can print a list or tuple in Python.</p>\n\n<p>This is what I want:</p>\n\n<pre><code>struct node {\n  int next;\n  string data;\n};\n\nmain()\n{\n  node n;\n  cout&lt;&lt;n;\n}\n</code></pre>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1498057188, "post_id": 44679575, "comment_id": 76343631, "body": "Use the erase and remove idiom.  It makes this stuff safe."}, {"owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498058163, "post_id": 44679575, "comment_id": 76344414, "body": "@NathanOliver I&#39;m sorry, I don&#39;t understand how to apply that to this situation.  I don&#39;t need to remove elements matching a condition.  I have an operation that <i>could</i> result in removal of the element from the container, but that removal may be buried in several levels of code.  Poor design probably, but that&#39;s what I have :)  Could you give an example?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498058287, "post_id": 44679575, "comment_id": 76344516, "body": "<a href=\"https://stackoverflow.com/questions/347441/erasing-elements-from-a-vector\">Here are some examples</a>.  Really though it sounds like you need a design change."}, {"owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498058691, "post_id": 44679575, "comment_id": 76344824, "body": "@NathanOliver So the solution might be that operation() could return whether or not the element should be removed, rather than removing from the global list?  And yes, I think &quot;design change&quot; every time I type &quot;global&quot;."}, {"owner": {"reputation": 3797, "user_id": 4022608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27c9e8430426724a1f39c98b268f0a98?s=128&d=identicon&r=PG&f=1", "display_name": "Baldrickk", "link": "https://stackoverflow.com/users/4022608/baldrickk"}, "edited": false, "score": 1, "creation_date": 1498058903, "post_id": 44679575, "comment_id": 76344982, "body": "<i>I think &quot;design change&quot; every time I type &quot;global&quot;</i>  I like that"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498059006, "post_id": 44679575, "comment_id": 76345053, "body": "@Rakurai That sounds like an acceptable solution."}], "owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498058462, "creation_date": 1498056899, "last_edit_date": 1498058462, "question_id": 44679575, "link": "https://stackoverflow.com/questions/44679575/iterating-over-a-mutable-container", "title": "Iterating over a mutable container", "body": "<p>I am working with an older C (compiling with clang++) codebase that used some global variables to store the heads of linked lists, with many points throughout the code that iterate over those lists.</p>\n\n<pre><code>struct global_st *global_list; // awful global\n\n// ... somewhere down in the code\nfor (struct global_st *it = global_list; it; it = it-&gt;next)\n    operation(it);\n</code></pre>\n\n<p>At some point, some geniuses figured out that operation() could result in the removal of items from the list, especially (but not limited to) current object of iteration.  So some loops look more like this:</p>\n\n<pre><code>for (struct global_st *it = global_list, *next_it; it; it = next_it) {\n    next_it = it-&gt;next;\n    operation_that_could_remove_object(it);\n}\n</code></pre>\n\n<p>However, many of the less safe loops use the other method, especially if using a relatively \"safe\" operation (this codebase suffers from almost complete lack of const).  I have located a few bugs with this, which are masked by the use of object pooling for the allocated structs that never have their next pointers cleared.</p>\n\n<p>I have been tasked with changing this linked list to a std::vector or std::list.  From <a href=\"https://stackoverflow.com/questions/2062956/checking-if-an-iterator-is-valid\">this question</a>, which is 7 years old but I assume is still true, I can't check if the iterator is still valid for dereferencing.  <strong>Assuming that the current object of iteration is the only element that can be removed by an operation in the loop</strong>, would this loop be considered safe?</p>\n\n<pre><code>for (auto it = global_list.begin(), next_it; it != global_list.end(); it = next_it) {\n    next_it = it;\n    next_it++;\n    operation_that_could_remove_object(*it);\n}\n</code></pre>\n\n<p>If so, is there a simpler way (or a safer data structure) that would help prevent programmer error?  I would like to use the ranged-for semantics, but that doesn't seem possible when the iterator could be removed.</p>\n\n<p>My alternative option would be to utilize the object pool and set an 'is_valid' flag, and then defer removal to a later time.  However, I don't particularly want to require every loop to check if the object is still valid.</p>\n\n<p>EDIT: To clarify, the container is filled with unique pointers to objects, and the possible removal (by operation(Obj *obj)) will be by matching the pointer to a member of the container.  Since they're unique, are there semantics that could be applied to iteration/potential removal from a std::set that would work?</p>\n"}, {"tags": ["c++", "c", "c++11"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 1, "creation_date": 1498056499, "post_id": 44679361, "comment_id": 76342995, "body": "@tilz0R: The user is asking about interfacing with C code. That involves knowing about C code."}, {"owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "edited": false, "score": 0, "creation_date": 1498056506, "post_id": 44679361, "comment_id": 76343003, "body": "I am calling a API that is written in C from a c++ code"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1498056509, "post_id": 44679361, "comment_id": 76343009, "body": "The pointer you gave <code>unique_ptr</code> to <code>delete</code> later is not the pointer that was allocated. Also using <code>delete</code> when you were supposed to use <code>free</code> is not correct."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1498056580, "post_id": 44679361, "comment_id": 76343078, "body": "Could you add the declaration of the <code>C</code> function you are trying to call? Is it a <code>int**</code> because it is going to allocate an array of <code>int</code> for you, or is int a <code>int**</code> because it is going to use an array of pointer you allocated before?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498056701, "post_id": 44679361, "comment_id": 76343181, "body": "Your question is contradicted: if you pass array, then memory already allocated, if memory is allocated inside C call, then you pass pointer, not array. You need to be more clear."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1498056743, "post_id": 44679361, "comment_id": 76343217, "body": "Still the tag <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> should be appropriate when the question is about <i>interfacing</i> with C code. Don&#39;t be too quick removing tags."}], "owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "closed_date": 1498056570, "answer_count": 0, "score": 2, "last_activity_date": 1498057708, "creation_date": 1498056316, "last_edit_date": 1498057708, "question_id": 44679361, "link": "https://stackoverflow.com/questions/44679361/solution-for-wrapping-a-pointer-in-a-stdunique-ptr", "closed_reason": "Duplicate", "title": "solution for wrapping a pointer in a std::unique_ptr?", "body": "<p>I need to have <code>int**</code> to pass to API function call written in C. Based on the description of the API, it uses <code>malloc</code> to allocate memory, and it requires the user to free the memory after it is returned.</p>\n\n<p>How to create a <code>std::unique_ptr&lt;int*&gt;</code> ? If I have one, does <code>.get()</code> function return a <code>int**</code>. I was thinking if I could wrap my pointer in a <code>unique_ptr</code> and make sure it will be freed when out of scope. I am not sure if the following implementation ensures that memory is freed after allocation? Is there a better way of achieving this?</p>\n\n<pre><code>int ** get_double_ptr()\n{\n    int ** ids;\n    return ids;\n}\n\nint main(int argc, char **argv)\n{\n\n    std::unique_ptr&lt;int*&gt; i_ptr(get_double_ptr());\n\n    int ** idx = i_ptr.get();\n    // allocate ids using malloc ....\n\n}\n</code></pre>\n\n<p>The C function is declared as below:</p>\n\n<pre><code>int MeshToNodal(int *ne, int *nn, int *eptr, int *eind, int *numflag,\nint **xadj, int **adjncy)\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498056882, "post_id": 44679312, "comment_id": 76343354, "body": "If you have read another answer and didn&#39;t understand something there, <i>ask about the thing you didn&#39;t understand</i>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498057033, "post_id": 44679312, "comment_id": 76343490, "body": "In addition, you should be using <code>std::thread</code>, not pthreads (you can think of std::thread as a C++-friendly wrapper around pthreads)."}, {"owner": {"reputation": 21, "user_id": 8164998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67da0d96d6d23d3e7528b811993fce71?s=128&d=identicon&r=PG&f=1", "display_name": "AnTran", "link": "https://stackoverflow.com/users/8164998/antran"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498441749, "post_id": 44679312, "comment_id": 76485369, "body": "I used <code>std::thread</code>, but it had same error, some one advice me that use a function wrapper from non-static function to static function, but I don&#39;t know how to do that,  because non-static function need a parameter. Example: <code>reinterpret_cast&lt;parallelmatchglobal*&gt;(object)-&gt;matchAndAddR&zwnj;&#8203;esult()</code>;"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498451156, "post_id": 44679312, "comment_id": 76487155, "body": "<a href=\"https://stackoverflow.com/questions/ask\">Here&#39;s the link you click to ask questions</a>."}], "owner": {"reputation": 21, "user_id": 8164998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67da0d96d6d23d3e7528b811993fce71?s=128&d=identicon&r=PG&f=1", "display_name": "AnTran", "link": "https://stackoverflow.com/users/8164998/antran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1498056653, "answer_count": 0, "score": 0, "last_activity_date": 1498056184, "creation_date": 1498056184, "question_id": 44679312, "link": "https://stackoverflow.com/questions/44679312/pthread-function-from-a-class-invalid-use-of-non-static-member-function-pthread", "closed_reason": "Duplicate", "title": "pthread function from a class, invalid use of non-static member function pthread_create", "body": "<p>This question may be repeat again, I had read a lot answers, but I can't solve my problem because I'm a beginer program with C++, help me, please.\nMy header: parallelmatchglobal.h</p>\n\n<pre><code>class parallelmatchglobal\n{\n    public:\n        struct du_lieu{\n           std::vector&lt;KeyPoint&gt; keypoints;\n           Mat descriptors;\n        };\n\n        parallelmatchglobal(Matcher matcher,vector&lt;Point2f&gt; &amp;ppoints_matched,\n                            vector&lt;int&gt; &amp;classes_matched);\n        void p_matchGlobal( vector&lt;KeyPoint&gt;  &amp;keypoints,  Mat descriptors);\n        void *matchAndAddResult(void* thamso);\n        static void *matchAndAddResult_wrapper(void* object);\n    private:\n        Matcher pmatcher;\n        pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;\n        std::vector&lt;Point2f&gt;  ppoints_matched;\n        std::vector&lt;int&gt;  pclasses_matched;\n};\n</code></pre>\n\n<p>My class implement: parallelmatchglobal.cpp</p>\n\n<pre><code>    #include \"parallelmatchglobal.h\"\nusing namespace cv;\nusing namespace std;\nparallelmatchglobal::parallelmatchglobal(Matcher matcher,\n                    vector&lt;Point2f&gt; &amp;points_matched,\n                    vector&lt;int&gt; &amp;classes_matched)\n    {\n        this-&gt;pmatcher=matcher;\n        this-&gt;ppoints_matched=points_matched;\n        this-&gt;pclasses_matched=classes_matched;\n    }\n    void parallelmatchglobal::p_matchGlobal(vector&lt;KeyPoint&gt;&amp; keypoints, Mat descriptors)\n    {\n    Mat des[SO_THREAD];\n    vector&lt;KeyPoint&gt; keyp[SO_THREAD];\n    for (int i=0; i&lt;descriptors.rows;i++){\n            des[i%SO_THREAD].push_back(descriptors.row(i));\n            keyp[i%SO_THREAD].push_back(keypoints[i]);\n    }\n    pthread_t threads[SO_THREAD];\n    struct du_lieu td[SO_THREAD];\n    int rc;\n    for(int i=0;i&lt;SO_THREAD;i++){\n        td[i].keypoints=keyp[i];\n        td[i].descriptors=des[i];\n        rc=pthread_create(&amp;threads[i], NULL,matchAndAddResult, (void *)&amp;td[i]);\n    }\n    if(rc==-1){\n        FILE_LOG(logDEBUG) &lt;&lt; \"thread error\";\n    }\n    }\n    void* parallelmatchglobal::matchAndAddResult(void* thamso){\n    struct du_lieu *data;\n    data = (struct du_lieu *) thamso;\n    vector&lt;Point2f&gt; points_matched;\n    vector&lt;int&gt; classes_matched;\n    pmatcher.matchGlobal(data-&gt;keypoints,data-&gt;descriptors, points_matched,classes_matched);\n    for(size_t j = 0;j &lt; points_matched.size(); j++){\n        pthread_mutex_lock(&amp;mutex1);\n        ppoints_matched.push_back(points_matched[j]);\n        pclasses_matched.push_back(classes_matched[j]);\n        pthread_mutex_unlock(&amp;mutex1);\n    }\n    }\n}\n</code></pre>\n\n<p>when I run, isue error:</p>\n\n<pre><code>.../parallelmatchglobal.cpp:28: error: invalid use of non-static member function\n         rc=pthread_create(&amp;threads[i], NULL,matchAndAddResult, (void *)&amp;td[i]);\n                                                                              ^\n</code></pre>\n"}, {"tags": ["c++", "language-lawyer", "c++17", "unary-operator"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 3, "creation_date": 1498056056, "post_id": 44679200, "comment_id": 76342622, "body": "That is not a logical negation operator, its the member function <code>A::operator!</code>, is my guess anyways. I believe this is the same thing with <code>operator,</code>, the comma operator has an inherent meaning even without an overload, but is well defined when provided with an overload"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498056252, "post_id": 44679200, "comment_id": 76342803, "body": "Try changing <code>bool t(a);</code> to <code>bool t(!a);</code> in your 1st example.  As in how can the compiler guess it needs to apply <code>operator!</code>."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 4, "creation_date": 1498056491, "post_id": 44679200, "comment_id": 76342988, "body": "<a href=\"http://eel.is/c++draft/expr#3.sentence-1\" rel=\"nofollow noreferrer\">Clause &#91;expr&#93; defines the effects of operators when applied to types for which they have not been overloaded.</a>"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498056654, "post_id": 44679200, "comment_id": 76343135, "body": "@Rakete1111 It does in C++1z"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1498056807, "post_id": 44679200, "comment_id": 76343282, "body": "@PasserBy What, really. Good to know, thanks for pointing that out."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498057380, "post_id": 44679200, "comment_id": 76343794, "body": "@Rakete1111 Wait, I&#39;m doubing myself now, can&#39;t find it in the standard. Forgot where I got the information from in the first place"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1498058986, "post_id": 44679200, "comment_id": 76345034, "body": "@PasserBy Jup, I can&#39;t find it either. <a href=\"http://coliru.stacked-crooked.com/a/3cfec95397b2c2f3\" rel=\"nofollow noreferrer\">It looks like you&#39;re wrong</a>. You&#39;ll have to check out your source :)"}], "answers": [{"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1498063528, "post_id": 44679576, "comment_id": 76347901, "body": "@T.C. You never cease to amaze. Also Johannes has apparently submitted every core issue."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 7, "last_activity_date": 1498063513, "last_edit_date": 1498063513, "creation_date": 1498056902, "answer_id": 44679576, "question_id": 44679200, "link": "https://stackoverflow.com/questions/44679200/expr-unary-op-9-seems-to-imply-that-the-operator-could-not-be-applied-to/44679576#44679576", "title": "[expr.unary.op]/9 seems to imply that the `operator !()` could not be applied to the type A below. But compilers disagree with that", "body": "<p><a href=\"http://eel.is/c++draft/expr#3.sentence-1\" rel=\"nofollow noreferrer\">[expr]</a> as a whole applies to built-in operators:</p>\n\n<blockquote>\n  <p>Clause [expr] defines the effects of operators when applied to types for which they have not been overloaded. </p>\n</blockquote>\n\n<p>The definition in [expr.unary.op] is simply the definition of the <em>built-in</em> <code>operator!</code>. Additionally, <a href=\"http://eel.is/c++draft/over.match.oper#3\" rel=\"nofollow noreferrer\">[over.match.oper]</a> describes how to look up overloaded operators:</p>\n\n<blockquote>\n  <p>For a unary operator @ with an operand of a type whose cv-unqualified version is T1, [...], three sets of candidate functions, designated member candidates, non-member candidates and built-in candidates, are constructed as follows: [...]</p>\n</blockquote>\n\n<p>For <code>!a</code>, you'd have two candidates: your overload <code>A::operator!()</code> and the built-in defined in <a href=\"http://eel.is/c++draft/over.built#24\" rel=\"nofollow noreferrer\">[over.built]</a>:</p>\n\n<blockquote>\n  <p>There also exist candidate operator functions of the form</p>\n\n<pre><code>bool operator!(bool);\n</code></pre>\n</blockquote>\n\n<p>For the built-in to be selected by overload resolution, the type would have to be contextually converted to <code>bool</code><sup>&dagger;</sup> as your argument suggests. However, this candidate is not viable - but the overloaded member operator is. </p>\n\n<hr />\n\n<p><sup>&dagger;</sup><a href=\"https://stackoverflow.com/questions/44679200/expr-unary-op-9-seems-to-imply-that-the-operator-could-not-be-applied-to/44679576?noredirect=1#comment76347693_44679576\">T.C.</a> is on top of it as usual, pointing out <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1919\" rel=\"nofollow noreferrer\">cwg issue 1919</a> which indicates that a type that <em>is</em> contextually convertible to <code>bool</code> still shouldn't use the builtin <code>operator!</code> due to a wording issue. Although, both gcc and clang permit it (which is what we all want to happen, probably).</p>\n"}], "owner": {"reputation": 6126, "user_id": 1042389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LgLxA.jpg?s=128&g=1", "display_name": "Belloc", "link": "https://stackoverflow.com/users/1042389/belloc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 44679576, "answer_count": 1, "score": 7, "last_activity_date": 1498063513, "creation_date": 1498055951, "last_edit_date": 1498056257, "question_id": 44679200, "link": "https://stackoverflow.com/questions/44679200/expr-unary-op-9-seems-to-imply-that-the-operator-could-not-be-applied-to", "title": "[expr.unary.op]/9 seems to imply that the `operator !()` could not be applied to the type A below. But compilers disagree with that", "body": "<p><a href=\"http://eel.is/c++draft/conv#4\" rel=\"noreferrer\">[conv]/4</a>:</p>\n\n<blockquote>\n  <p>Certain language constructs require that an expression be converted to\n  a Boolean value. An expression <code>e</code> appearing in such a context is said\n  to be <em>contextually converted to <code>bool</code></em> and is well-formed if and\n  only if the declaration <code>bool t(e);</code> is well-formed, for some invented\n  temporary variable <code>t</code> (11.6).</p>\n</blockquote>\n\n<p>Consider now the snippet below. It doesn't compile, neither in <a href=\"http://coliru.stacked-crooked.com/a/866ba3623fba4dc8\" rel=\"noreferrer\">clang</a>, <a href=\"http://coliru.stacked-crooked.com/a/049a411350ef8cd6\" rel=\"noreferrer\">GCC</a> or <a href=\"http://rextester.com/WMHEMU15817\" rel=\"noreferrer\">VS</a>.</p>\n\n<pre><code>struct A{ bool operator!() { return true; } };\nint main(){\n    A a;\n    bool t(a);\n}\n</code></pre>\n\n<p>Thus, from [conv]/4 we conclude that the type <code>A</code> is <strong>not</strong> contextually converted to <code>bool</code>.</p>\n\n<p><a href=\"http://eel.is/c++draft/expr.unary.op#9\" rel=\"noreferrer\">[expr.unary.op]/9</a>:</p>\n\n<blockquote>\n  <p>The operand of the logical negation operator <code>!</code> is contextually\n  converted to <code>bool</code> (Clause 7); its value is <code>true</code> if the converted\n  operand is <code>false</code> and <code>false</code> otherwise. The type of the result is\n  <code>bool</code>.</p>\n</blockquote>\n\n<p>My understanding of the paragraph above is that the operand of the logical negation operator <code>!</code> must be contextually converted to <code>bool</code>. We have just concluded that the type <code>A</code> is <strong>not</strong> contextually converted to <code>bool</code>. Therefore, from [expr.unary.op]/9, we can say that the following code should <strong>not</strong> compile. But it does, in <a href=\"http://coliru.stacked-crooked.com/a/7ea19016164fa08b\" rel=\"noreferrer\">clang</a>, <a href=\"http://coliru.stacked-crooked.com/a/8900f6d1a76aac88\" rel=\"noreferrer\">GCC</a> and <a href=\"http://rextester.com/YUX54013\" rel=\"noreferrer\">VS</a>.</p>\n\n<pre><code>struct A{ bool operator!() { return true; } };\nint main(){\n    A a;\n    bool t = !a;\n}\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c++", "tensorflow", "xor", "tensor"], "answers": [{"tags": [], "owner": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1498056852, "creation_date": 1498056852, "answer_id": 44679552, "question_id": 44679069, "link": "https://stackoverflow.com/questions/44679069/bitwisexor-for-tensorflow/44679552#44679552", "title": "BitwiseXOR for Tensorflow", "body": "<p>If you don't want to implement your own C++ op, you can try with <a href=\"https://www.tensorflow.org/api_docs/python/tf/py_func\" rel=\"nofollow noreferrer\">tf.py_func</a> which allows you to define a python function that operates on <code>numpy</code> arrays and is then used as a Tensorflow operation in the graph.</p>\n\n<p>For your problem you can use <a href=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.bitwise_xor.html\" rel=\"nofollow noreferrer\"><code>numpy</code>'s bitwise_xor()</a>:</p>\n\n<pre><code>import tensorflow as tf\nimport numpy as np\n\nt1 = tf.constant([2,4,6], dtype=tf.int64)\nt2 = tf.constant([1,3,5], dtype=tf.int64)\n\nt_xor = tf.py_func(np.bitwise_xor, [t1, t2], tf.int64, stateful=False)\n\nwith tf.Session() as sess:\n  val = sess.run(t_xor)\n  print(val)\n</code></pre>\n\n<p>which prints <code>[3,7,3]</code> as expected.</p>\n\n<p>Please take care of the known limitations of this function (taken from the link above):</p>\n\n<blockquote>\n  <p><strong>N.B.</strong> The <code>tf.py_func()</code> operation has the following known limitations:</p>\n  \n  <ul>\n  <li>The body of the function (i.e. func) will not be serialized in a\n  <code>GraphDef</code>. Therefore, you should not use this function if you need to\n  serialize your model and restore it in a different environment. </li>\n  <li>The operation must run in the same address space as the Python program\n  that calls <code>tf.py_func()</code>. If you are using distributed TensorFlow, you\n  must run a tf.train.Server in the same process as the program that\n  calls <code>tf.py_func()</code> and you must pin the created operation to a device\n  in that server (e.g. using <code>with tf.device():</code>).</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 2607264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8783b31c49fc28319e97986c61f5b1e5?s=128&d=identicon&r=PG", "display_name": "user2607264", "link": "https://stackoverflow.com/users/2607264/user2607264"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498056852, "creation_date": 1498055645, "question_id": 44679069, "link": "https://stackoverflow.com/questions/44679069/bitwisexor-for-tensorflow", "title": "BitwiseXOR for Tensorflow", "body": "<p>My project requests a new layer, which needs the new operator of Tensor to compute bitwiseXOR between input x and constant Key k.\nE.g. x = 4 (bit form: 100), k = 7 (111), the bitwiseXOR(x, k) expects as 3 (011).</p>\n\n<p>As far as I know, Tensor only has LogicXOR operator for bool type. Luckily, Tensorflow has the extended ability to have a new Op. However, I read the document in <a href=\"https://www.tensorflow.org/extend/adding_an_op\" rel=\"nofollow noreferrer\">https://www.tensorflow.org/extend/adding_an_op</a>, I can get the basic idea, but that is far from the implementation, maybe because of the lack of c++ knowledge. Any suggestions for implementation the new operator that will be helpful. Then I can use that new Op of Tensor to build the new layers.</p>\n"}, {"tags": ["c++", "linux", "qt", "shared-libraries", "code-injection"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1498055509, "post_id": 44678866, "comment_id": 76342160, "body": "Try RTLD_DEFAULT?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498055793, "post_id": 44678866, "comment_id": 76342393, "body": "It is possible that for RTLD_NEXT to work properly you have to define <code>qt_startup_hook</code> in your lib."}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "edited": false, "score": 0, "creation_date": 1498165615, "post_id": 44678866, "comment_id": 76401659, "body": "I assume you&#39;re using LD_PRELOAD to preload your version of <code>qt_startup_hook</code>, and then offloading it to the real <code>qt_startup_hook</code>?  If you haven&#39;t defined your own <code>qt_startup_hook</code> then <code>RTLD_NEXT</code> won&#39;t find the real one (ie: the <i>next</i> one), since your own one isn&#39;t the <i>first</i> one. See <a href=\"http://samanbarghi.com/blog/2014/09/05/how-to-wrap-a-system-call-libc-function-in-linux/\" rel=\"nofollow noreferrer\">here</a> for more details."}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "edited": false, "score": 0, "creation_date": 1498165754, "post_id": 44678866, "comment_id": 76401721, "body": "If you don&#39;t want to use LD_PRELOAD you can actually inject your own function into a dynamically linked library (eg Qt) using a utility called <a href=\"https://www.codeproject.com/Articles/70302/Redirecting-functions-in-shared-ELF-libraries\" rel=\"nofollow noreferrer\">elfhook</a>"}, {"owner": {"reputation": 51, "user_id": 1817746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6a643717971a0089bd939eeccbcc8e?s=128&d=identicon&r=PG", "display_name": "dburchardt", "link": "https://stackoverflow.com/users/1817746/dburchardt"}, "edited": false, "score": 0, "creation_date": 1498481160, "post_id": 44678866, "comment_id": 76500708, "body": "Ok it&#39;s working but now how i can find function in other namespace like foo::bar::baz ?"}], "owner": {"reputation": 51, "user_id": 1817746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6a643717971a0089bd939eeccbcc8e?s=128&d=identicon&r=PG", "display_name": "dburchardt", "link": "https://stackoverflow.com/users/1817746/dburchardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 728, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498214876, "creation_date": 1498055085, "last_edit_date": 1498214876, "question_id": 44678866, "link": "https://stackoverflow.com/questions/44678866/inject-shared-library-into-a-running-process", "title": "Inject shared library into a running process", "body": "<p>I just started to learn injection techniques in Linux and want to write a simple program to inject a shared library into a running process (app using QT). However, after a couple of hours research, I couldn't find any complete example.</p>\n\n<p>Why dlsym can't find qt_startup_hook?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n\n\nvoid hello()\n{\n    printf(\"Call hello\\n\");\n    void *func = dlsym(RTLD_NEXT, \"qt_startup_hook\");\n\n    if (!func) {\n        printf(\"Error\\n\");\n    }\n}\n</code></pre>\n\n<p>Gdb:</p>\n\n<pre><code>b main\nrun\ncall dlopen(\"/linux-inject/sample-library.so\",2)\n&gt;&gt; $1 = 108781344\ncall hello()\n&gt;&gt; Call hello\n&gt;&gt; Error\n</code></pre>\n\n<p>Gdb found qt_startup_hook:</p>\n\n<pre><code>info functions qt_startup_hook\n&gt;&gt; Non-debugging symbols:\n&gt;&gt; 0x00007ffff7b0ae40  qt_startup_hook\n</code></pre>\n"}, {"tags": ["c++", "qt", "c++11", "macros"], "comments": [{"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 3, "creation_date": 1498055037, "post_id": 44678815, "comment_id": 76341756, "body": "It would help if you include the actual, complete warning message, but I bet the warning is caused by a missing space after a macro name."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1498055074, "post_id": 44678815, "comment_id": 76341789, "body": "And a few lines of code around the source of the error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2321437"}, "edited": false, "score": 0, "creation_date": 1498056129, "post_id": 44678815, "comment_id": 76342690, "body": "The compiler is not giving the exact location of code (file name and line number). Actually the total warnings are as follows &quot;&lt;command-line&gt;:0:19: warning: missing terminating &quot; character &lt;command-line&gt;:0:3: warning: missing terminating &quot; character &lt;command-line&gt;:0:3: warning: ISO C++11 requires whitespace after the macro name&quot;. I don&#39;t know if that helps to give a solution."}, {"owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 0, "creation_date": 1498057212, "post_id": 44678815, "comment_id": 76343657, "body": "Does it not even include the name of the macro (assuming the macro isn&#39;t called &#39;name&#39;)?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1498062143, "post_id": 44678815, "comment_id": 76347153, "body": "In line with my answer, it would help to have some details about how you are trying to build your executable."}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1498152598, "post_id": 44681390, "comment_id": 76394675, "body": "@NarsiReddyAnugu: As I said, it&#39;s impossible to be more precise without knowing more. If you could paste the actual <code>g++</code> command into your question, that would help a lot."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 3, "last_activity_date": 1498062233, "last_edit_date": 1498062233, "creation_date": 1498061888, "answer_id": 44681390, "question_id": 44678815, "link": "https://stackoverflow.com/questions/44678815/command-line03-warning-iso-c11-requires-whitespace-after-the-macro-name/44681390#44681390", "title": "&lt;command-line&gt;:0:3: warning: ISO C++11 requires whitespace after the macro name", "body": "<p>You probably have a <code>g++</code> command line with an invalid <code>-D</code> option. (Or perhaps more than one of those.)</p>\n\n<p>The second two warnings can be triggered by</p>\n\n<pre><code>g++ '-DFOO\"unterminated' ...\n</code></pre>\n\n<p>(Note the missing <code>=</code> after <code>FOO</code>.)</p>\n\n<p>Since you're probably using some build system, the likely cause is an incorrect build configuration which gives rise to an unterminated quote in the <code>-D</code> argument. (Although it is also not unlikely that the quote itself was unintentional.)</p>\n"}, {"comments": [{"owner": {"reputation": 525, "user_id": 7446465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m5caP.jpg?s=128&g=1", "display_name": "Addison Klinke", "link": "https://stackoverflow.com/users/7446465/addison-klinke"}, "edited": false, "score": 0, "creation_date": 1547073243, "post_id": 46845519, "comment_id": 95071327, "body": "Additional discussion of valid C++ characters which might be useful: <a href=\"https://stackoverflow.com/questions/35977940/valid-characters-for-file-name-in-the-include-directive\" title=\"valid characters for file name in the include directive\">stackoverflow.com/questions/35977940/&hellip;</a>"}], "tags": [], "owner": {"reputation": 272, "user_id": 2903605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723f06ea00ae94b51e4affeefc292f97?s=128&d=identicon&r=PG&f=1", "display_name": "foddex", "link": "https://stackoverflow.com/users/2903605/foddex"}, "is_accepted": false, "score": 2, "last_activity_date": 1508489373, "creation_date": 1508489373, "answer_id": 46845519, "question_id": 44678815, "link": "https://stackoverflow.com/questions/44678815/command-line03-warning-iso-c11-requires-whitespace-after-the-macro-name/46845519#46845519", "title": "&lt;command-line&gt;:0:3: warning: ISO C++11 requires whitespace after the macro name", "body": "<p>This error is also caused by invalid characters in your define name. I had the same error trying to do this: </p>\n\n<pre><code>g++ -Dsomedefine++=1\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2321437"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10234, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1508489373, "creation_date": 1498054935, "last_edit_date": 1498152670, "question_id": 44678815, "link": "https://stackoverflow.com/questions/44678815/command-line03-warning-iso-c11-requires-whitespace-after-the-macro-name", "title": "&lt;command-line&gt;:0:3: warning: ISO C++11 requires whitespace after the macro name", "body": "<p>I am compiling qt sources (C++) on different version of Ubuntu OS (14.04 and 16.04 LTS). The sources compile (g++) on 14.04 LTS without warnings. But on 16.04 gives following warnings \"&lt;command-line&gt;:0:3: warning: ISO C++11 requires whitespace after the macro name warnings\". </p>\n\n<p>I am wondering what causes this error? Thanks in advance.</p>\n\n<p>g++ --version: 5.4.0 20160609.</p>\n"}, {"tags": ["c++", "dictionary", "member-function-pointers"], "comments": [{"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1498055245, "post_id": 44678806, "comment_id": 76341922, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24325612/how-do-i-call-a-member-function-pointer\">How do I call a member function pointer?</a>"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1498055868, "post_id": 44678806, "comment_id": 76342453, "body": "Did the proposed duplicate question or searching for &quot;calling pointer to member function&quot; help you solve the problem?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1498056130, "post_id": 44678806, "comment_id": 76342692, "body": "There is issue with using <code>const char *</code> as key in a map. And there is no reason to make it worse casting it to <code>char *</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1498057102, "post_id": 44678806, "comment_id": 76343550, "body": "Using pointers as map keys is very unlikely to work well. And iterating over a map looking for a key is not the way to use a map."}, {"owner": {"reputation": 6356, "user_id": 284285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8lZ5E.jpg?s=128&g=1", "display_name": "Ghislain Fourny", "link": "https://stackoverflow.com/users/284285/ghislain-fourny"}, "edited": false, "score": 0, "creation_date": 1498057107, "post_id": 44678806, "comment_id": 76343557, "body": "I don&#39;t think that&#39;s an exact duplicate of the above question. There are two operators <code>-&gt;*</code> and <code>.*</code>, and these two questions cover each one of them."}, {"owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 0, "creation_date": 1498057563, "post_id": 44678806, "comment_id": 76343933, "body": "what about std::function? Also, why using new?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1498062149, "post_id": 44678806, "comment_id": 76347160, "body": "You need a <code>std::unordered_map&lt;std::string, m_PlayerFunction&gt;</code>, and hold it by value!  That way you can just do <code>auto it = m_FunctionMap.find(chPlayerCommand);  if (it != m_FunctionMap.end()) (this-&gt;*(it-&gt;second))();</code>"}, {"owner": {"reputation": 33, "user_id": 8194634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7N2w.jpg?s=128&g=1", "display_name": "georgb&#252;chner", "link": "https://stackoverflow.com/users/8194634/georgb%c3%bcchner"}, "edited": false, "score": 0, "creation_date": 1498117828, "post_id": 44678806, "comment_id": 76369686, "body": "Reason I&#39;m using char*, is that the player Command might also contain people, items, door or room names, which are also char*, as they might change during the game, thus char* not const char."}], "answers": [{"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498056623, "post_id": 44679223, "comment_id": 76343108, "body": "Yes, but you don&#39;t need the nested ones: <code>(this-&gt;*it-&gt;second)()</code> is ok too."}, {"owner": {"reputation": 6356, "user_id": 284285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8lZ5E.jpg?s=128&g=1", "display_name": "Ghislain Fourny", "link": "https://stackoverflow.com/users/284285/ghislain-fourny"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498056769, "post_id": 44679223, "comment_id": 76343243, "body": "That&#39;s a good point. <code>-&gt;</code> is documented to have a higher precedence than <code>-&gt;*</code> indeed. I added it, but still personally prefer the extra parentheses for readability."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1498062233, "post_id": 44679223, "comment_id": 76347213, "body": "Actually, I would split it:  <code>const auto fp = it-&gt;second; (this-&gt;*fp)();</code>, pointers-to-member-functions are so insanely complicated, that it is worth spelling it out."}], "tags": [], "owner": {"reputation": 6356, "user_id": 284285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8lZ5E.jpg?s=128&g=1", "display_name": "Ghislain Fourny", "link": "https://stackoverflow.com/users/284285/ghislain-fourny"}, "is_accepted": true, "score": 2, "last_activity_date": 1498056893, "last_edit_date": 1498056893, "creation_date": 1498056006, "answer_id": 44679223, "question_id": 44678806, "link": "https://stackoverflow.com/questions/44678806/c-calling-function-when-using-map-of-function-pointer/44679223#44679223", "title": "c++ calling function when using map of function pointer", "body": "<p>The difficulty may be that it is at the same time a map, and it involves pointer-to-members, which makes the syntax to invoke more complicated with lots of parentheses that must be at the right positions. I think it should be something like this:</p>\n\n<pre><code>(this-&gt;*(it-&gt;second))()\n</code></pre>\n\n<p>Alternatively, as Rakete1111 points out, the following works as well:</p>\n\n<pre><code>(this-&gt;*it-&gt;second)()\n</code></pre>\n\n<p>(Note that the latter is less verbose, but also less easy to read for people who do not have the operator precedence on the top of their minds).</p>\n"}], "owner": {"reputation": 33, "user_id": 8194634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7N2w.jpg?s=128&g=1", "display_name": "georgb&#252;chner", "link": "https://stackoverflow.com/users/8194634/georgb%c3%bcchner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1814, "favorite_count": 0, "accepted_answer_id": 44679223, "answer_count": 1, "score": 3, "last_activity_date": 1498056893, "creation_date": 1498054911, "last_edit_date": 1498055843, "question_id": 44678806, "link": "https://stackoverflow.com/questions/44678806/c-calling-function-when-using-map-of-function-pointer", "title": "c++ calling function when using map of function pointer", "body": "<p>I set up this account mainly because I couldn't find answers elsewhere. I checked, various tutorials or questions/ answers on stackoverflow and different pages.</p>\n\n<p>I'm programming a terminal based textadventure and need a map of functions. This is what I got (I left out all the stuff that isn't of interesting for the problem)</p>\n\n<pre><code>#include &lt;map&gt;\n\nusing namespace std;\n\nclass CPlayer\n{\nprivate:\n\n    //Players functions:\n    typedef void(CPlayer::*m_PlayerFunction)(void); //Function-pointer points to various player \n                                                    //functions\n    map&lt;char*, m_PlayerFunction&gt; *m_FunctionMap;    //Map containing all player functions\n\npublic:\n    //Constructor\n    CPlayer(char* chName, CRoom* curRoom, CInventory* Inventory);\n\n\n    //Functions:\n    bool useFunction(char* chPlayerCommand);\n    void showDoors(); //Function displaing all doors in the room\n    void showPeople(); //Function displaying all people in the room\n\n\n};\n\n#endif\n</code></pre>\n\n\n\n<pre><code>#include \"CPlayer.h\"\n#include &lt;iostream&gt;\n\n\nCPlayer::CPlayer(char chName[128], CRoom* curRoom, CInventory *Inventory)\n{\n    //Players functions\n    m_FunctionMap = new map&lt;char*, CPlayer::m_PlayerFunction&gt;;\n    m_FunctionMap-&gt;insert(std::make_pair((char*)\"show doors\", &amp;CPlayer::showDoors));\n    m_FunctionMap-&gt;insert(std::make_pair((char*)\"show people\", &amp;CPlayer::showPeople));\n}\n\n\n\n\n\n\n//Functions\n\n//useFunction, calls fitting function, return \"false\", when no function ist found\nbool CPlayer::useFunction(char* chPlayerCommand)\n{\n    CFunctions F;\n    map&lt;char*, m_PlayerFunction&gt;::iterator it = m_FunctionMap-&gt;begin();\n\n    for(it; it!=m_FunctionMap-&gt;end(); it++)\n    {\n        if(F.compare(chPlayerCommand, it-&gt;first) == true)\n        {\n            cout &lt;&lt; \"Hallo\" &lt;&lt; endl;\n            (it-&gt;*second)();\n        }\n    }\n\n    return false;\n}\n</code></pre>\n\n<p>Now, the problem is the following:</p>\n\n<p>If I call the function this way:\n<code>(it-&gt;*second)();</code>\nwhich seems to be how it is supposed to be done, I get the following error:\n<code>error: \u2018second\u2019 was not declared in this scope</code></p>\n\n<p>If I call the function this way:\n <code>(*it-&gt;second)();</code>\nwhich is what I got from this thread: <a href=\"http://stackoverflow.com/questions/2136998/using-a-stl-map-of-function-pointers\">Using a STL map of function pointers</a>, I get following error: \n<code>error: invalid use of unary \u2018 * \u2019 on pointer to member</code></p>\n\n<p>I'd be very glad if someone could help me. Thanks ahead for all the upcoming answers. </p>\n\n<p>PS: It would also be interesting to know whether \"map\" or \"unordered_map\" is the better way of solving this problem.</p>\n\n<p>As I said, thanks ahead:\nGB</p>\n"}, {"tags": ["c++", "cmake", "wxwidgets"], "comments": [{"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498056561, "post_id": 44678699, "comment_id": 76343060, "body": "can&#39;t you use a plain old <code>wx-config</code> script to compile you software? Something like <code>g++ -o &lt;my_binary&gt; </code>wx-config --cxxflags --libs` &lt;my_source.cpp&gt;?"}, {"owner": {"reputation": 46, "user_id": 7746056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40ef232b1fc46eeab84681b19e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7746056/tristan"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498116579, "post_id": 44678699, "comment_id": 76368884, "body": "Hi! no, I can&#39;t, my project is too big to do that. I know that my project is actualy working, I know that wxwidgets  3.1 is working to (thanks to the samples) but my cmake failed to find wxwidgets 3.1"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498136124, "post_id": 44678699, "comment_id": 76382846, "body": "then if you don&#39;t want to use IDE (Anjuta for example), the easiest and simplest solution is to gewt rid of 3.0 and install 3.1."}, {"owner": {"reputation": 46, "user_id": 7746056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40ef232b1fc46eeab84681b19e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7746056/tristan"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498138945, "post_id": 44678699, "comment_id": 76385078, "body": "I&#39;ve already installed 3.1 from github (cd build-gtk &amp;&amp; ../configure &amp;&amp; make &amp;&amp; sudo make install), I tried to move 3.0 files from where they are to another location, but hen, cmake only find nothing (thank&#39;s for your help btw)"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498139737, "post_id": 44678699, "comment_id": 76385753, "body": "don&#39;t move it anywhere. Uninstall it first, then install 3.1 and then run cmake. I guess the order is important."}, {"owner": {"reputation": 46, "user_id": 7746056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40ef232b1fc46eeab84681b19e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7746056/tristan"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498141219, "post_id": 44678699, "comment_id": 76386960, "body": "not better, I just have <code>missing: wxWidgets_LIBRARIES wxWidgets_INCLUDE_DIRS</code> (as before, the only difference is that 3.0.2 is no more found =) )"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498146459, "post_id": 44678699, "comment_id": 76391050, "body": "Did you uninstall 3.0.2 and then install 3.1?"}, {"owner": {"reputation": 46, "user_id": 7746056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40ef232b1fc46eeab84681b19e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7746056/tristan"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498204100, "post_id": 44678699, "comment_id": 76413978, "body": "yes, as you suggested me to do =)"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 1, "creation_date": 1498226401, "post_id": 44678699, "comment_id": 76428826, "body": "than I&#39;m out of ideas. Sorry. Try to compile with g++ command I proposed earlier. If that works and the command produced will be using 3.1 and not failing - something weird is going on with the setup. Try to install everything from scratch, slipping wx 3.0."}, {"owner": {"reputation": 46, "user_id": 7746056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40ef232b1fc46eeab84681b19e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7746056/tristan"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1498229879, "post_id": 44678699, "comment_id": 76431401, "body": "It sems that as wxwidget 3.1 is in developpement state, it&#39;s not yet compatible with cmake. Other users of wxwidgets use the wx-config script to compile their program  But thank you to have taken some times to reply to me =)  And I&#39;m out of ideas too, so I upvoted your last comment"}, {"owner": {"reputation": 4873, "user_id": 709683, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/f11fa.png?s=128&g=1", "display_name": "Stefano Mtangoo", "link": "https://stackoverflow.com/users/709683/stefano-mtangoo"}, "edited": false, "score": 0, "creation_date": 1499506914, "post_id": 44678699, "comment_id": 76944132, "body": "did you inspect the CMake module that finds wxWidgets to make sure it looks in right directories?"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 14030123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-myWtjpUf2ck/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnnjrtFMCBzHnolp9L_LgkbUZQjZQ/photo.jpg?sz=128", "display_name": "Avihai Shalom", "link": "https://stackoverflow.com/users/14030123/avihai-shalom"}, "is_accepted": false, "score": -2, "last_activity_date": 1596221377, "creation_date": 1596221377, "answer_id": 63197541, "question_id": 44678699, "link": "https://stackoverflow.com/questions/44678699/how-to-use-compiled-wxwidgets-with-cmake/63197541#63197541", "title": "How to use compiled wxwidgets with cmake", "body": "<p>CMake saying that your minumum version of cmake, <code>3.0.2</code>, is lower than the wxWidgets minimum cmake version, <code>3.1.0</code>.</p>\n<p>Try putting the command: <code>cmake_minimum_required(VERSION 3.1.0)</code>.</p>\n<p>That way your minimum cmake version required will be <code>3.1.0</code> so it will be fine.</p>\n"}], "owner": {"reputation": 46, "user_id": 7746056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40ef232b1fc46eeab84681b19e47cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7746056/tristan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1596221377, "creation_date": 1498054642, "question_id": 44678699, "link": "https://stackoverflow.com/questions/44678699/how-to-use-compiled-wxwidgets-with-cmake", "title": "How to use compiled wxwidgets with cmake", "body": "<p>I'm getting some trouble while trying to use wxwidgets in my project (I'm on linux). It worked well when I was with wxWidget 3.02, but when I tried to use 3.1.0 it stopped to work. </p>\n\n<p>I still have the 3.0.2 (so I can have something working) but I want to use the wxlistctrl::EnableCheckBoxes(), so I get the 3.1.0.</p>\n\n<p>In my CMakeList, I change <code>FIND_PACKAGE(wxWidgets REQUIRED)</code>to <code>FIND_PACKAGE(wxWidgets 3.1.0 REQUIRED)</code></p>\n\n<p>When i try to <code>cmake ..</code>in my build directory, I got the following error:</p>\n\n<pre><code>... could NOT find wxWidgets: Found unsuitable version \"3.0.2\", but required is \nat least `3.1.0`(found\n-L/usr/local/lib//lib/x86_64-linux-gnu; ...\n</code></pre>\n\n<p>I know that the library is located at <code>/usr/local/lib</code> I tried to ln to the directory, I tried many commands in my cmake, but I don't know how to tell cmake to search in the good library to find th wxWidgets version I want.</p>\n\n<p>I'm pretty sure it's a cmake mistake, but it can be an installation problem too (even if I followed the tutorial <a href=\"https://wiki.wxwidgets.org/Compiling_and_getting_started\" rel=\"nofollow noreferrer\"> here</a>). More, when I type <code>gtk-config --version</code>I got \"3.1.1\" (that's what I expected as version number, I get the git version)</p>\n\n<p>If anyone has a question or an idea to solve my problem, I would be haappy to read it =)</p>\n\n<p>Thank's!</p>\n"}, {"tags": ["c++", "linked-list", "segmentation-fault", "singly-linked-list"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1498054529, "post_id": 44678609, "comment_id": 76341355, "body": "Where/how are you learning C++?  Besides <code>cout</code> this is C code and not how you should be using C++."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1498054710, "post_id": 44678609, "comment_id": 76341476, "body": "There should never be a reason to use malloc in C++ unless you are maintaining some code that was ported from C."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 2, "creation_date": 1498055638, "post_id": 44678609, "comment_id": 76342267, "body": "Don&#39;t include &lt;bits/stdc++.h&gt;. Don&#39;t use malloc in C++."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498056133, "post_id": 44678609, "comment_id": 76342695, "body": "Get one of these <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">books</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5751046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AgOeiahrRNw/AAAAAAAAAAI/AAAAAAAAARU/sIQ61kjd9Mg/photo.jpg?sz=128", "display_name": "Rohit Pal", "link": "https://stackoverflow.com/users/5751046/rohit-pal"}, "edited": false, "score": 0, "creation_date": 1498055134, "post_id": 44678647, "comment_id": 76341825, "body": "But why did this ran successfully on ideone <a href=\"https://ideone.com/IbPspC\" rel=\"nofollow noreferrer\">ideone.com/IbPspC</a>. Default value for such pointer is NULL?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1, "user_id": 5751046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AgOeiahrRNw/AAAAAAAAAAI/AAAAAAAAARU/sIQ61kjd9Mg/photo.jpg?sz=128", "display_name": "Rohit Pal", "link": "https://stackoverflow.com/users/5751046/rohit-pal"}, "edited": false, "score": 0, "creation_date": 1498055742, "post_id": 44678647, "comment_id": 76342354, "body": "@RohitPal It means as I wrote in my answer that the program has undefined behavior."}, {"owner": {"reputation": 1, "user_id": 5751046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AgOeiahrRNw/AAAAAAAAAAI/AAAAAAAAARU/sIQ61kjd9Mg/photo.jpg?sz=128", "display_name": "Rohit Pal", "link": "https://stackoverflow.com/users/5751046/rohit-pal"}, "edited": false, "score": 0, "creation_date": 1498057018, "post_id": 44678647, "comment_id": 76343484, "body": "I&#39;m getting <code>error: expected &#39;;&#39; at end of declaration         Node *b = new Node {2, nullptr};</code>. same error for init of <code>a</code> and <code>start</code> node."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1, "user_id": 5751046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AgOeiahrRNw/AAAAAAAAAAI/AAAAAAAAARU/sIQ61kjd9Mg/photo.jpg?sz=128", "display_name": "Rohit Pal", "link": "https://stackoverflow.com/users/5751046/rohit-pal"}, "edited": false, "score": 0, "creation_date": 1498057333, "post_id": 44678647, "comment_id": 76343755, "body": "@RohitPal Maybe your compiler does not support this syntax of initialization. In this case write for example Node *b = new Node; b-&gt;data = 3; b-&gt;next = nullptr; or b-&gt;bext = NULL;"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1498054973, "last_edit_date": 1498054973, "creation_date": 1498054510, "answer_id": 44678647, "question_id": 44678609, "link": "https://stackoverflow.com/questions/44678609/getting-segmentation-fault-while-traversing-linked-list/44678647#44678647", "title": "Getting Segmentation fault while traversing linked list", "body": "<p>You forgot this statement</p>\n\n<pre><code>b-&gt;next = nullptr;\n</code></pre>\n\n<p>Otherwise the program has undefined behavior due to the condition in this while statement in the function <code>traverseLinkedList</code></p>\n\n<pre><code>while(start)\n</code></pre>\n\n<p>Take into account that in C++ you should use the operator <code>new</code> instead of the C function <code>malloc</code>.</p>\n\n<p>For example</p>\n\n<pre><code>Node *b = new Node { 3, nullptr };\nNode *a = new Node { 2, b };\nNode *start = new Node { 1, a };\n</code></pre>\n\n<p>And you should free the allocated memory before exiting the program.</p>\n"}], "owner": {"reputation": 1, "user_id": 5751046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AgOeiahrRNw/AAAAAAAAAAI/AAAAAAAAARU/sIQ61kjd9Mg/photo.jpg?sz=128", "display_name": "Rohit Pal", "link": "https://stackoverflow.com/users/5751046/rohit-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 44678647, "answer_count": 1, "score": -1, "last_activity_date": 1498055813, "creation_date": 1498054411, "last_edit_date": 1498055813, "question_id": 44678609, "link": "https://stackoverflow.com/questions/44678609/getting-segmentation-fault-while-traversing-linked-list", "title": "Getting Segmentation fault while traversing linked list", "body": "<p>I've simple C++ program to traverse a linked list.\nIt runs perfectly in <a href=\"https://ideone.com/IbPspC\" rel=\"nofollow noreferrer\">ideone</a> .\nWhen I run this in my mac terminal it throws segmentation fault.\nWhen I uncomment <code>//printf(\"Node\");</code> line from traverse function it runs perfectly. I'm not able to understand this behavior.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef struct node {\n    int data;\n    struct node *next;\n} Node;\n\nvoid traverseLinkedList(Node *start) {\n    while(start) {\n        //printf(\"Node\");\n        cout &lt;&lt; start-&gt;data &lt;&lt; \"-&gt;\";\n        start = start-&gt;next;\n    }\n    cout &lt;&lt; \"NULL\" &lt;&lt; endl;\n}\nint main() {\n    Node *start = (Node*) malloc(sizeof(Node));\n    Node *a = (Node*) malloc(sizeof(Node));\n    Node *b = (Node*) malloc(sizeof(Node));\n    start-&gt;data = 0;\n    a-&gt;data = 1;\n    b-&gt;data = 2;\n    start-&gt;next = a;\n    a-&gt;next = b;\n    traverseLinkedList(start);\n    traverseLinkedList(a);\n    traverseLinkedList(b);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 4294, "user_id": 2826421, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/digYw.png?s=128&g=1", "display_name": "MrLeeh", "link": "https://stackoverflow.com/users/2826421/mrleeh"}, "edited": false, "score": 0, "creation_date": 1498054712, "post_id": 44678602, "comment_id": 76341479, "body": "Please provide some code."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8194555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03151d5f7044f4c1486b5e31af64e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Ram&#237;rez", "link": "https://stackoverflow.com/users/8194555/adrian-ram%c3%adrez"}, "is_accepted": false, "score": 2, "last_activity_date": 1498080179, "last_edit_date": 1498080179, "creation_date": 1498057012, "answer_id": 44679622, "question_id": 44678602, "link": "https://stackoverflow.com/questions/44678602/qdateedit-validations/44679622#44679622", "title": "QDateEdit validations", "body": "<p>I found what my problem is. I connected the slot to <code>dateChanged(QDate)</code> signal, so, by default the <code>QDateEdit</code> set the first allowed date as selected, so if you select it again the signal it's not emited and by result the date it's not set. My solution is use <code>editingFinished()</code> signal instead <code>dateChanged(QDate)</code> signal. I hope has been helpful. Regards,  </p>\n"}], "owner": {"reputation": 31, "user_id": 8194555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03151d5f7044f4c1486b5e31af64e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Ram&#237;rez", "link": "https://stackoverflow.com/users/8194555/adrian-ram%c3%adrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498080179, "creation_date": 1498054396, "last_edit_date": 1498080144, "question_id": 44678602, "link": "https://stackoverflow.com/questions/44678602/qdateedit-validations", "title": "QDateEdit validations", "body": "<p>I'm trying validate two QDateEdits. I have two fields, <code>startdate</code> and <code>enddate</code> and i want to validate that the minimum date of <code>enddate</code> be the selected <code>startdate</code> date. But also, i want give the user opportunity that the <code>enddate</code> field can be empty. \nI conected both fields</p>\n\n<pre><code>connect(startDate,SIGNAL(dateChanged(QDate)),endDate,SLOT(setMinDate(QDate)));\n</code></pre>\n\n<p><code>startDate</code> and <code>endDate</code> are <code>QDateEdit</code> with a popup calendar.</p>\n\n<p>So, where is the problem here?? When i click over endDate the minimun date it's ok but the next day (fisrt valid date) appears in blue color like it was selected, but when i clicked over that date the popup close and the date it's not set. For example: </p>\n\n<p>When i open the form the <code>startdate</code> field have by default the current date. Latter i click over <code>endDate</code> field and the minimum allowed date is one more day  wich it's ok, but this minimum allowed date it's blue marked and when i clicked the date it's not set. </p>\n\n<p>Sorry if my english it's so bad, i hope that you can help me. Thanks any way</p>\n"}, {"tags": ["c++", "pointers", "object", "dynamic"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1498054279, "post_id": 44678457, "comment_id": 76341143, "body": "<code>a</code> is a pointer that holds the address of a dynamically allocated instance of class <code>A</code>. In general you don&#39;t need to use <code>new</code> to create new instances (and should avoid that like the plague)."}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1498054423, "post_id": 44678457, "comment_id": 76341266, "body": "For starters I think it is better if you understand stack vs heap memory allocation of C++. Which you can find in the following link. <a href=\"http://www.learncpp.com/cpp-tutorial/79-the-stack-and-the-heap/\" rel=\"nofollow noreferrer\">learncpp.com/cpp-tutorial/79-the-stack-and-the-heap</a>"}, {"owner": {"reputation": 2652, "user_id": 4564515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90733097a656c664a472c437678aad42?s=128&d=identicon&r=PG&f=1", "display_name": "jschultz410", "link": "https://stackoverflow.com/users/4564515/jschultz410"}, "edited": false, "score": 1, "creation_date": 1498055323, "post_id": 44678457, "comment_id": 76341997, "body": "Overloading operator[] on a class has nothing to do with using [] on a raw pointer.  If you want to invoke the class&#39; operator[] then you&#39;d have to first dereference the pointer."}, {"owner": {"reputation": 2652, "user_id": 4564515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90733097a656c664a472c437678aad42?s=128&d=identicon&r=PG&f=1", "display_name": "jschultz410", "link": "https://stackoverflow.com/users/4564515/jschultz410"}, "edited": false, "score": 0, "creation_date": 1498055777, "post_id": 44678457, "comment_id": 76342382, "body": "There isn&#39;t much of a difference between A *a = new A; and A *a = new A[1];  The differences, I <i>think</i>, are that in the latter version you need to call delete [] on it and you can probably only invoke the default constructor of the type."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498054541, "post_id": 44678560, "comment_id": 76341362, "body": "This is a great answer! I would suggest adding a bit addressing the confusion between pointers and arrays. It seems like a significant part of the question to me."}, {"owner": {"reputation": 71, "user_id": 8175859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1034f6901cf729a3eb62b2165d85be0f?s=128&d=identicon&r=PG&f=1", "display_name": "icegas", "link": "https://stackoverflow.com/users/8175859/icegas"}, "edited": false, "score": 0, "creation_date": 1498054840, "post_id": 44678560, "comment_id": 76341565, "body": "I&#39;m sorry, maybe you don&#39;t understand my question. I mean how dynamic object is represented? Is it an array? And if we create object like that A *a = new A(); can we write like that a[1]-&gt;data = 0;?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498054971, "post_id": 44678560, "comment_id": 76341693, "body": "It&#39;s not an array. It&#39;s a single instance. If it were an array, how many elements would you expect it to contain? Arrays do not expand automatically when you access elements out of bounds."}, {"owner": {"reputation": 2652, "user_id": 4564515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90733097a656c664a472c437678aad42?s=128&d=identicon&r=PG&f=1", "display_name": "jschultz410", "link": "https://stackoverflow.com/users/4564515/jschultz410"}, "edited": false, "score": 0, "creation_date": 1498055091, "post_id": 44678560, "comment_id": 76341799, "body": "Your comment about run-time versus static (compiler) allocation is a bit off.  If I declare a variable inside a function it is allocated at run time when that object&#39;s scope is entered.  Only if an object is global (or namespace) or static of various stripes is it allocated statically by the compiler."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 6, "last_activity_date": 1498054300, "creation_date": 1498054300, "answer_id": 44678560, "question_id": 44678457, "link": "https://stackoverflow.com/questions/44678457/dynamic-objects-in-c/44678560#44678560", "title": "Dynamic objects in c++", "body": "<p>A pointer is just about what it sounds like, it's something which <em>points</em> somewhere else.</p>\n\n<p>Take your example</p>\n\n<pre><code>A* a = new A;\n</code></pre>\n\n<p>That declares the variable <code>a</code> as a pointer. It points to an instance (an object) of the <code>A</code> class.</p>\n\n<p>Somewhat graphically it can be seen as</p>\n\n<pre>\n+---+      +---------------+\n| a | ---> | instance of A |\n+---+      +---------------+\n</pre>\n\n<p>In C# (and Java) this is basically the only way to create instances of classes. All variables are (a little simplified) pointers.</p>\n\n<p>In C++ you have other alternatives as well:</p>\n\n<pre><code>A a;\n</code></pre>\n\n<p>The definition above says that the variable <code>a</code> <em>is</em> an instance of the <code>A</code> class. It's not a reference, it's not a pointers, it <em>is</em> an <code>A</code> object.</p>\n\n<p>Now for another difference between the two above definitions: In the first case the instance of <code>A</code> is created at <em>run-time</em>. The memory is allocated for the instance when the program is running. In the second case, the space for the instance is allocated by the <em>compiler</em>, at the time of compilation. However in both cases the constructor is called at run-time.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 8175859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1034f6901cf729a3eb62b2165d85be0f?s=128&d=identicon&r=PG&f=1", "display_name": "icegas", "link": "https://stackoverflow.com/users/8175859/icegas"}, "edited": false, "score": 0, "creation_date": 1498055050, "post_id": 44678702, "comment_id": 76341769, "body": "So and how to overload operator [] on pointers? For example if you use uniq_ptr?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 71, "user_id": 8175859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1034f6901cf729a3eb62b2165d85be0f?s=128&d=identicon&r=PG&f=1", "display_name": "icegas", "link": "https://stackoverflow.com/users/8175859/icegas"}, "edited": false, "score": 0, "creation_date": 1498055440, "post_id": 44678702, "comment_id": 76342098, "body": "@icegas <code>std::unique_ptr</code> is a class, not a pointer. As such, you can overload <code>operator []</code> for it just fine (and <code>std::unique_ptr&lt;T[]&gt;</code> actually does that). You might want to read through a <a href=\"https://stackoverflow.com/q/388242/1782465\">good C++ book</a> to get a firmer grasp on basic C++ concepts and how they differ (or not) from C#."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1498065157, "post_id": 44678702, "comment_id": 76348799, "body": "pointer is not an object. Most of the operators can be overloaded in objects only. There are few which can be overloaded statically, but not &#39;[]&#39;; If you need to overload [], you need to do in in your object. In this case you can use references as a more convenient way then pointers. or use pointers, but you will need this kind of syntax to use it: (*pointer)[index]."}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 1, "last_activity_date": 1498054654, "creation_date": 1498054654, "answer_id": 44678702, "question_id": 44678457, "link": "https://stackoverflow.com/questions/44678457/dynamic-objects-in-c/44678702#44678702", "title": "Dynamic objects in c++", "body": "<p>'a' is a pointer (memory address) to the memory where object 'A' is allocated. Yest it behaves as an array. However you have only one element in it, so 'a[0]' will be equivalent to '*a'. Do not try a[1] in your case. It will compile, but most likely crash at run. If you overload [], it is your problem now :-). Though you cannot overload [] on pointers. </p>\n\n<p>BTW, in c# 'a' would also be a pointer (reference) to the object, not the object itself. </p>\n\n<p>The biggest difference between the languages is that c++ does <strong>not</strong> manage memory allocation. So, if you said 'new', make sure that you also say 'delete' when you do not need the object any longer. </p>\n\n<p>In 'c+' you can also create references instead of the pointers. </p>\n"}, {"comments": [{"owner": {"reputation": 2652, "user_id": 4564515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90733097a656c664a472c437678aad42?s=128&d=identicon&r=PG&f=1", "display_name": "jschultz410", "link": "https://stackoverflow.com/users/4564515/jschultz410"}, "edited": false, "score": 1, "creation_date": 1498055555, "post_id": 44678941, "comment_id": 76342200, "body": "&quot;It creates one object of the class A, and writing a[0] it gives the first element of the inside array, or maybe something else which the subscript operator was overloaded to mean.&quot;  This isn&#39;t (typically) correct.  Writing a[0] dereferences the pointer a to give a reference to the underlying class.  It doesn&#39;t invoke the operator[]() on the class.  Your second example looks correct."}, {"owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "reply_to_user": {"reputation": 2652, "user_id": 4564515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90733097a656c664a472c437678aad42?s=128&d=identicon&r=PG&f=1", "display_name": "jschultz410", "link": "https://stackoverflow.com/users/4564515/jschultz410"}, "edited": false, "score": 0, "creation_date": 1498055772, "post_id": 44678941, "comment_id": 76342377, "body": "Oh. Sorry. I did not know that. I learned it now though. Thanks. Should I remove it from my answer? Although, what if I wanted to invoke operator[]() ? Will I have to call it manually like this -&gt; <code>a-&gt;operator[0]</code> ?"}, {"owner": {"reputation": 71, "user_id": 8175859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1034f6901cf729a3eb62b2165d85be0f?s=128&d=identicon&r=PG&f=1", "display_name": "icegas", "link": "https://stackoverflow.com/users/8175859/icegas"}, "edited": false, "score": 0, "creation_date": 1498056534, "post_id": 44678941, "comment_id": 76343029, "body": "Yes, but it looks terrible."}, {"owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "edited": false, "score": 0, "creation_date": 1498056697, "post_id": 44678941, "comment_id": 76343177, "body": "Yes. Pretty much. I don&#39;t think there is any other way,"}, {"owner": {"reputation": 2282, "user_id": 6646408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6BakX.png?s=128&g=1", "display_name": "besc", "link": "https://stackoverflow.com/users/6646408/besc"}, "edited": false, "score": 0, "creation_date": 1498058280, "post_id": 44678941, "comment_id": 76344511, "body": "Because it looks so terrible you usually wouldn\u2019t write <code>a-&gt;operator[](0)</code> but <code>(*a)[0]</code>. It\u2019s still not pretty, but shorter and more idiomatic. Both syntaxes do exactly the same thing."}], "tags": [], "owner": {"reputation": 533, "user_id": 3957430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f79192c478198ff5571a9a65fb52097?s=128&d=identicon&r=PG&f=1", "display_name": "Redwanul Haque Sourave", "link": "https://stackoverflow.com/users/3957430/redwanul-haque-sourave"}, "is_accepted": true, "score": 4, "last_activity_date": 1498056449, "last_edit_date": 1498056449, "creation_date": 1498055277, "answer_id": 44678941, "question_id": 44678457, "link": "https://stackoverflow.com/questions/44678457/dynamic-objects-in-c/44678941#44678941", "title": "Dynamic objects in c++", "body": "<p>If you write <code>A * a = new A()</code> the default constructor of the class <code>A</code> is called and it dynamically allocates memory for one object of the class <code>A</code> and the address of the memory allocated is assigned to the pointer <code>a</code>. So <code>a</code> points an object of the class <code>A</code> and not an array. However, if you want an array of <code>A</code> objects dynamically, then you'll have to write something like this <code>A * a = new A[10]</code>. This will allocate memory of 10 objects of <code>A</code>. And you can write <code>a[0], a[1], ... a[9]</code> to access the objects of the array. </p>\n\n<p>Now, what would happen if we overload the <code>[]</code> operator? If we overload <code>[]</code> operator, then it should mean that the class <code>A</code> has some sort of array inside, and by writing <code>a[1]</code>, where <code>a</code> is an object of class <code>A</code>, we want to get the element situated at second index. (Speaking generally, you can mean anything else using the subscript operator, but you should try to stick to the original meaning of the subscript operator). But we cannot invoke <code>[]</code> operator on pointers as it would mean to dereference the pointer. So to invoke the subscript operator on a pointer of an object, we have to explicitly call the subscript operator. Like this: </p>\n\n<pre><code>A * a = new A;\ncout &lt;&lt; a-&gt;operator[](0) &lt;&lt; endl;\n</code></pre>\n\n<p>It creates one object of the class <code>A</code>, and writing <code>a-&gt;operator[](0)</code>. It explicitly calls the overloaded subscript operator. What if we create an array dynamically?</p>\n\n<pre><code>A * a = new A[6];\ncout &lt;&lt; a[0][0] &lt;&lt; endl;\n</code></pre>\n\n<p>The first subscript operator is for getting the first object in the array of objects. The second subscript operator is calling the overloaded subscript operator of the object <code>a[0]</code></p>\n\n<p>EDIT: I was wrong about invoking subscript operator of a class A. Thanks to  jschultz410, who corrected me. </p>\n"}], "owner": {"reputation": 71, "user_id": 8175859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1034f6901cf729a3eb62b2165d85be0f?s=128&d=identicon&r=PG&f=1", "display_name": "icegas", "link": "https://stackoverflow.com/users/8175859/icegas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16337, "favorite_count": 2, "closed_date": 1498064832, "accepted_answer_id": 44678941, "answer_count": 3, "score": 5, "last_activity_date": 1498056449, "creation_date": 1498054047, "last_edit_date": 1498054131, "question_id": 44678457, "link": "https://stackoverflow.com/questions/44678457/dynamic-objects-in-c", "closed_reason": "Needs details or clarity", "title": "Dynamic objects in c++", "body": "<p>I come to c++ from c# and I don't understand what dynamic object is. So imagine you have class A and to create object like A *a = new A() is Normal but what is object a? It's the same thing like an array or what? We can write like a[0] or a[1]?  But what going on if we overload operator [] and want to create dynamic object if we have data there and want to get data normally?</p>\n"}, {"tags": ["c++", "string", "math", "symbols"], "comments": [{"owner": {"reputation": 796429, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 5, "creation_date": 1498053793, "post_id": 44678343, "comment_id": 76340748, "body": "You&#39;re looking for Unicode."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1498054112, "post_id": 44678343, "comment_id": 76340971, "body": "Decide on your <i>encoding</i> and away you go. <code>std::wstring</code> might be the way forward. See <a href=\"http://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/basic_string</a>. Also research UTF-16."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1498054748, "post_id": 44678343, "comment_id": 76341505, "body": "Unicode will have code points. However you also need to be able to display the symbols. Whilst a modern computer will certainly have fonts installed, actually finding and accessing the display facilities might be quite difficult."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1498064211, "post_id": 44678343, "comment_id": 76348278, "body": "@Malcolm, what&#39;s &quot;difficult&quot; about <code>std::wcout &lt;&lt; L&quot;\u2229\\n&quot;;</code>?"}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1498167444, "post_id": 44678343, "comment_id": 76402382, "body": "<code>std::cout &lt;&lt; &quot;\u2229\\n&quot;;</code> is simpler and works on sane systems (meaning not Windows)"}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498054632, "post_id": 44678420, "comment_id": 76341426, "body": "An answer to the question absolutely, positively needs to mention character encodings. And the &#39;new&#39; C++11 <a href=\"http://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">string literal</a> types. Sorry, -1 for being incomplete. And wrong."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1498055059, "post_id": 44678420, "comment_id": 76341777, "body": "<code>std::string unionChar2 = u8&quot;\\u222A&quot;;</code> would be better. At least that way you know you can accommodate all the unicode characters in the string. But you&#39;ll <a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">need conversions</a>. If I try <code>std::string unionChar = &quot;\\u222A&quot;;</code> on my platform it tries to stuff the character into an 8 bit char and converts it to <code>0x3f</code> i.e. <code>?</code>. But with <code>std::string unionChar2 = u8&quot;\\u222A&quot;;</code> I get <code>0xe2 0x88 0xaa</code> <a href=\"http://www.fileformat.info/info/unicode/char/222a/index.htm\" rel=\"nofollow noreferrer\">which is good UTF8 for this character</a>."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498055245, "post_id": 44678420, "comment_id": 76341923, "body": "It is wrong because you are assuming an execution character set that is compatible with your string literal. Try <code>std::string unionChar = &quot;\\u222A&quot;;</code> in Visual Studio and see what&#39;s coming out of it. (Hint: <a href=\"https://stackoverflow.com/questions/43739267/set-execution-character-set-for-visual-c-compiler#comment74523463_43739267\">You are trying to hammer 16-bit pigeons into 8-bit holes</a>)."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498307596, "post_id": 44678420, "comment_id": 76454141, "body": "@IInspectable in theory, it&#39;s not wrong to assume it&#39;s not 1994 anymore and &quot;multibyte&quot; means UTF-8. In practice, there&#39;s Visual Studio."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1498308630, "post_id": 44678420, "comment_id": 76454478, "body": "@Cubbi: The problem isn&#39;t Visual Studio. The problem is the code in this proposed answer, which is wrong (and can be made correct, for Visual Studio and any other compiler). I have posted a link to the C++11 <a href=\"http://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">string literals</a> in my first comment already."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498309033, "post_id": 44678420, "comment_id": 76454605, "body": "@IInspectable The code is correct. C++11 attempted to work around Visual Studio&#39;s defects, with mixed success."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1498329434, "post_id": 44678420, "comment_id": 76460732, "body": "@Cubbi: Which <i>&quot;defect&quot;</i> do you have in mind, specifically? It sounds a fair bit unlikely, that the C++ committee would vote for changes, that are meant to fix a single compiler only. References to the specific language rule(s) that Microsoft&#39;s compiler violates (pertaining to the discussion at hand) would help make a convincing point."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498331231, "post_id": 44678420, "comment_id": 76461240, "body": "@IInspectable no multibyte strings (the point you brought up here, finally fixed with the non-default(!) option /utf-8), no wide strings (wchar_t cannot be 16-bit as of 1996, and wstring cannot use UTF-16 ever -  see lex.ccon etc).. And because neither kind of strings were supported, there are no Unicode locales or standard I/O, until C++11 patched a few (far too few) things with &lt;codecvt&gt; and u8/u/U literals. Arguably, C++98 was wrong in making much of it implementation-defined. Anyway, this is going too far off-topic"}], "tags": [], "owner": {"reputation": 113, "user_id": 8048763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e212f9e3516fee9acea082cbd8268168?s=128&d=identicon&r=PG&f=1", "display_name": "RithvikK", "link": "https://stackoverflow.com/users/8048763/rithvikk"}, "is_accepted": false, "score": 2, "last_activity_date": 1504747364, "last_edit_date": 1504747364, "creation_date": 1498053933, "answer_id": 44678420, "question_id": 44678343, "link": "https://stackoverflow.com/questions/44678343/storing-math-symbols-into-string-c/44678420#44678420", "title": "Storing math symbols into string c++", "body": "<p>Yes, you can, as follows:</p>\n\n<pre><code>std::string unionChar = \"\u222a\";\nstd::string intersectionChar = \"\u2229\";\n</code></pre>\n\n<p>They are just characters but don't expect this code to be portable. You could also use Unicode, as follows:</p>\n\n<pre><code>std::string unionChar = u8\"\\u222A\";\nstd::string intersectionChar = u8\"\\u2229\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 2, "last_activity_date": 1498064654, "creation_date": 1498064654, "answer_id": 44682191, "question_id": 44678343, "link": "https://stackoverflow.com/questions/44678343/storing-math-symbols-into-string-c/44682191#44682191", "title": "Storing math symbols into string c++", "body": "<p>This seemingly simple question is actual a tangle of multiple questions:</p>\n\n<blockquote>\n  <p>What character set to use?</p>\n</blockquote>\n\n<p>Unicode is almost certainly the best choice nowadays.</p>\n\n<blockquote>\n  <p>What encoding to use?</p>\n</blockquote>\n\n<p>C++ <code>std::strings</code> are strings of <code>char</code>s, but you can decide how those <code>char</code>s correspond to \"characters\" in your character set.  The default representation assumed by the language and the system is could be ASCII, some random code page like Latin-1 or Windows-1252, or UTF-8.</p>\n\n<p>If you're on Linux or Mac, your best bet is to use UTF-8.  If you're on Windows, you might choose to use wide strings instead (<code>std::wstring</code>), and to use UTF-16 as the encoding.  But many people suggest that you <a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">always use UTF-8</a> in <code>std::string</code>s even on Windows, and simply convert from and to UTF-16 as needed to do I/O.</p>\n\n<blockquote>\n  <p>How to specify string literals in the code?</p>\n</blockquote>\n\n<p>To store UTF-8 in older versions of C++ (before C++11), you could manually encode your string literals like this:</p>\n\n<pre><code>const std::string subset = \"\\xE2\\x8A\\x82\";\n</code></pre>\n\n<p>To store UTF-8 in C++11 or newer, you use the <code>u8</code> prefix to tell the compiler you want UTF-8 encoding.  You can use escaped characters:</p>\n\n<pre><code>const std::string subset = u8\"\\u2282\";\n</code></pre>\n\n<p>Or you can enter the character directly into the source code:</p>\n\n<pre><code>const std::string subset = u8\"\u2282\";\n</code></pre>\n\n<p>I tend to use the escaped versions to avoid worrying about the encoding of the source file and whether all the editors and viewers and IDEs I use will consistently understand the source file encoding.</p>\n\n<p>If you're on Windows and you choose to use UTF-16 instead, then, regardless of C++ version, you can specify wide string literals in your code like this:</p>\n\n<pre><code>const std::wstring subset = L\"\\u2282\";  // or L\"\u2282\";\n</code></pre>\n\n<blockquote>\n  <p>How to display these strings?</p>\n</blockquote>\n\n<p>This is very system dependent.</p>\n\n<p>On Mac and Linux, I suspect things will generally just work.</p>\n\n<p>In a console program on Windows (e.g., one that just uses <code>&lt;iostreams&gt;</code> or <code>printf</code> to display in a command prompt), you're probably in trouble because the legacy command prompts don't have good Unicode and font support.  (Maybe this is better on Windows 10?)</p>\n\n<p>In a GUI program on Windows, you have to make sure you use the \"Unicode\" version of the API and to give it the wide string.  (\"Unicode\" is in quotation marks here because the Windows API documentation often uses \"Unicode\" to mean a UTF-16 encoded wide character string, which isn't exactly what Unicode means.)  So if you want to use an API like <code>TextOut</code> or <code>MessageBox</code> to display your string, you have to make sure you do two things:  (1) call the \"wide\" version of the API, and (2) pass a UTF-16 encoded string.</p>\n\n<p>You solve (1) by explicitly calling the wide versions (e.g., <code>TextOutW</code> or <code>MessageBoxW</code>) or by making your you compile with \"Unicode\" selected in your project settings.  (You can also do it by defining several C++ preprocessor macros instead, but this answer is already long enough.)</p>\n\n<p>For (2), if you are using <code>std::wstring</code>s, you're already done.  If you're using UTF-8, you'll need to make a wide copy of the string to pass to the output function.  Windows provides <code>MultiByteToWideChar</code> for making such a copy.  Make sure you specify <code>CP_UTF8</code>.</p>\n\n<p>For (2), do <em>not</em> try to call the narrow versions of the API functions themselves (e.g., <code>TextOutA</code> or <code>MessageBoxA</code>).  These will convert your string to a wide string automatically, but they do so assuming the string is encoded in the user's current code page.  If the string is really in UTF-8, then these will do the wrong thing for all of the \"interesting\" (non-ASCII) characters.</p>\n\n<blockquote>\n  <p>How to read these strings from a file, a socket, or the user?</p>\n</blockquote>\n\n<p>This is very system specific and probably worth a separate question.</p>\n"}], "owner": {"reputation": 213, "user_id": 6404688, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/273b39cd3526bc3f5dd0396f5480459c?s=128&d=identicon&r=PG&f=1", "display_name": "Batmax", "link": "https://stackoverflow.com/users/6404688/batmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1504747364, "creation_date": 1498053730, "question_id": 44678343, "link": "https://stackoverflow.com/questions/44678343/storing-math-symbols-into-string-c", "title": "Storing math symbols into string c++", "body": "<p>Is there a way to store math symbols into strings in c++ ? \nI notably need the union/intersection symbols.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "qt", "qgraphicsview"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1498053814, "post_id": 44678298, "comment_id": 76340768, "body": "<code>graphicsView-&gt;setMouseTracking(true);</code> might help, though. You should track mouse on graphics view, but you enabled tracking on your wizard page only."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8183713"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1498055057, "post_id": 44678298, "comment_id": 76341774, "body": "@vahancho: Not working."}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1498055524, "post_id": 44678298, "comment_id": 76342177, "body": "Last chance - try the same for the viewport: <code>graphicsView-&gt;viewport()-&gt;setMouseTracking(true);</code>, because graphics view is a scroll area."}], "owner": {"user_type": "does_not_exist", "display_name": "user8183713"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498053614, "creation_date": 1498053614, "question_id": 44678298, "link": "https://stackoverflow.com/questions/44678298/not-calling-mousemove-event-on-widgets-and-graphics-view", "title": "not calling mousemove event on widgets and graphics view", "body": "<p>I have created a set of wizard pages inherited from qwizardpage. in one of my wizard page i have a graphics view and in that using graphics scene and a qrect a rectangle has been created and now i am trying to catch the callback event of mouse move when the mouse is in the graphicsview area, but outside this area only call back is happening. But mouse press event is functioning properly. could anyone suggest me any solution.</p>\n\n<pre><code>WizardPage::WizardPage(QWidget* parent)\n{\n    m_pScene = new QGraphicsScene(this);\n    graphicsView-&gt;setScene(m_pScene);\n\n    m_pRect = new QRect(-25, 25, 100, 40);\n    m_pScene-&gt;addRect(*m_pRect);\n     setMouseTracking(true);\n}\n\nvoid EgoLeverWizardPage::mouseMoveEvent(QMouseEvent *event)\n{\n    qDebug() &lt;&lt; \"move\";\n}\n</code></pre>\n"}, {"tags": ["c++", "constexpr"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 5, "creation_date": 1498053764, "post_id": 44678277, "comment_id": 76340725, "body": "<i>&quot;The constexpr specifier declares that it is <b>possible</b> to evaluate the value of the function or variable at compile time&quot;</i> source: <a href=\"http://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/constexpr</a> . Not that it is required to be evaluate at compile time.  Try changing <code>Rect rect = Rect(1,2.0f);</code> to <code>constexpr Rect rect{1,2.0f};</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1498053805, "post_id": 44678277, "comment_id": 76340761, "body": "Why the downvote? This is well written and <i>not</i> obvious (at least, not to me)."}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 4, "creation_date": 1498054158, "post_id": 44678277, "comment_id": 76341018, "body": "I mean, there&#39;s not going to be a difference when you turn optimization on because you don&#39;t do anything with <code>rect</code>, so <a href=\"https://godbolt.org/g/hQxTnU\" rel=\"nofollow noreferrer\">it will get removed</a> whether or not you use <code>constexpr</code>. You can&#39;t get more efficient than no code!"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 6, "creation_date": 1498054553, "post_id": 44678277, "comment_id": 76341373, "body": "When compiling without optimizations, <a href=\"https://godbolt.org/g/tB7kRG\" rel=\"nofollow noreferrer\">there is a substantial difference</a> in the generated code. So I&#39;m going to call this question flawed because you&#39;re likely compiling with optimizations enabled and comparing output where all of your code is removed as dead anyway. If you want us to look further into this, please provide your compiler version and options (or just a link to your compiler explorer sample)."}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1498056403, "post_id": 44678277, "comment_id": 76342920, "body": "@cdhowie yes the code from the compiler is not exactly the same with no optimizations but I was expecting there would be lot less code for <code>constexpr</code> only some <code>mov</code> instructions since the compiler only need to fill the data for the object."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1498057056, "post_id": 44678277, "comment_id": 76343508, "body": "@PetarVelev cdhowie&#39;s point was that the code is removed completely because it doesn&#39;t do anything, so obviously <code>constexpr</code> doesn&#39;t make a difference."}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1498057243, "post_id": 44678277, "comment_id": 76343687, "body": "@interjay i know that it will generate the same instructions with optimizations cause there is nothing happening in <code>main()</code> but i expected a drastic difference between the both cases and what I&#39;m seeing some lines for the constructor. Regardless. Thanks for the comments they helped me figure out some of the things that I&#39;m asking."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1498057392, "post_id": 44678277, "comment_id": 76343805, "body": "@PetarVelev But cdhowie&#39;s link shows a substantial difference between the two in an unoptimized build."}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1498057756, "post_id": 44678277, "comment_id": 76344103, "body": "@interjay Whoah yeah thats a different story. In my example I&#39;m using <code>x86-64 gcc 7.1</code> without any compiler options and the things look different. cdhowie&#39;s results are the things that I was expecting to see. Should I remove the question since this is because of the compiler?"}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "edited": false, "score": 0, "creation_date": 1498058122, "post_id": 44678277, "comment_id": 76344379, "body": "It turned out that I had some headers included  from previous example. Most of the code generated came from them.  Now it looks like cdhowie&#39;s example. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "is_accepted": true, "score": 0, "last_activity_date": 1498059099, "creation_date": 1498059099, "answer_id": 44680429, "question_id": 44678277, "link": "https://stackoverflow.com/questions/44678277/constexpr-for-creating-objects/44680429#44680429", "title": "Constexpr for creating objects", "body": "<p>It turned out that I had some headers included which were responsible for the similarity of the code.</p>\n\n<p>The answer is that there is a big difference between both cases.</p>\n\n<blockquote>\n  <p>When compiling without optimizations, <a href=\"https://godbolt.org/#g:!((g:!((g:!((g:!((h:codeEditor,i:(j:1,source:%27class+Rect%0A%7B%0A++++int+a%3B%0A++++float+b%3B%0Apublic:%0A++++constexpr+Rect(int+a,+float+b)%0A++++:+a(a),b(b)%7B%7D%0A%7D%3B%0A%0Aint+main()%0A%7B%0A++++constexpr+Rect+rect+%3D+Rect(1,2.0f)%3B%0A%7D%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%231%27,t:%270%27)),k:100,l:%274%27,m:51.694915254237294,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:codeEditor,i:(j:2,source:%27class+Rect%0A%7B%0A++++int+a%3B%0A++++float+b%3B%0Apublic:%0A++++Rect(int+a,+float+b)%0A++++:+a(a),b(b)%7B%7D%0A%7D%3B%0A%0Aint+main()%0A%7B%0A++++Rect+rect+%3D+Rect(1,2.0f)%3B%0A%7D%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%232%27,t:%270%27)),header:(),k:100,l:%274%27,m:48.30508474576271,n:%270%27,o:%27%27,s:0,t:%270%27)),k:34.75791334251309,l:%273%27,n:%270%27,o:%27%27,t:%270%27),(g:!((h:compiler,i:(compiler:g63,filters:(b:%270%27,commentOnly:%270%27,directives:%270%27,intel:%270%27),options:%27-std%3Dc%2B%2B11+-O0%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+gcc+6.3+(Editor+%231,+Compiler+%231)%27,t:%270%27)),header:(),k:28.154966278965773,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:g63,filters:(b:%270%27,commentOnly:%270%27,directives:%270%27,intel:%270%27),options:%27-std%3Dc%2B%2B11+-O0%27,source:2),l:%275%27,n:%270%27,o:%27x86-64+gcc+6.3+(Editor+%232,+Compiler+%232)%27,t:%270%27)),header:(),k:37.08712037852113,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4\" rel=\"nofollow noreferrer\">there is a substantial difference</a> in the generated code...\n                                                                    -cdhowie </p>\n</blockquote>\n"}], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 44680429, "answer_count": 1, "score": 5, "last_activity_date": 1498059251, "creation_date": 1498053567, "last_edit_date": 1498059251, "question_id": 44678277, "link": "https://stackoverflow.com/questions/44678277/constexpr-for-creating-objects", "title": "Constexpr for creating objects", "body": "<p>I'm trying to figure out if there is a performance gain of creating objects with <code>constexpr</code> instead of normally.</p>\n\n<p>Here is the code snippet for <code>constexpr</code>.</p>\n\n<pre><code>class Rect\n{\n    const int a;\n    const float b;\npublic:\n    constexpr Rect(const int a,const float b)\n    : a(a),b(b){}\n};\n\nint main()\n{\n     constexpr Rect rect = Rect(1,2.0f);\n}\n</code></pre>\n\n<p>And without <code>constexpr</code>.</p>\n\n<pre><code>class Rect\n{\n    int a;\n    float b;\npublic:\n    Rect(int a, float b)\n    : a(a),b(b){}\n};\n\nint main()\n{\n    Rect rect = Rect(1,2.0f);\n}\n</code></pre>\n\n<p>I was expecting there will be a lot less code for <code>constexpr</code> since the memory should be initialized at compile-time.</p>\n\n<p>Am I using <code>constexpr</code> properly? And if that is not true, can you use <code>constexpr</code> to create the objects at compile-time and then use them without any runtime overhead?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "header"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498053666, "post_id": 44678183, "comment_id": 76340648, "body": "Doesn&#39;t answer why they did it but... <a href=\"https://stackoverflow.com/questions/34502661/c-tlhelp32-h-not-working\" title=\"c tlhelp32 h not working\">stackoverflow.com/questions/34502661/c-tlhelp32-h-not-workin&zwnj;&#8203;g</a>"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1498054340, "post_id": 44678183, "comment_id": 76341190, "body": "It is considered good style that in a .cpp you can include any selection of headers in any order. Someone at microsoft either didn&#39;t know or didn&#39;t care or had more important things to do. Particularly <code>windows.h</code> will also <code>#define</code> macros such as <code>max</code> which then mess up the standard library. Don&#39;t take those headers as an example of what headers in C++ should look like."}], "answers": [{"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 2, "last_activity_date": 1498054838, "last_edit_date": 1498054838, "creation_date": 1498054473, "answer_id": 44678630, "question_id": 44678183, "link": "https://stackoverflow.com/questions/44678183/c-header-does-not-include-dependent-header-on-its-own/44678630#44678630", "title": "c++ header does not include dependent header on its own", "body": "<p>Most of the other Windows headers don't <code>#include &lt;windows.h&gt;</code>, but take for granted that you've done so. </p>\n\n<p>As far as I can tell, the \"why\" is that they basically assume the first line of every file other than Windows.h (and the headers it includes) is <code>#include &lt;windows.h&gt;</code>, so checking for it would be a waste of time.</p>\n\n<p>This basically comes down to a collision of two different styles. What I'd call the \"traditional\" C view was that each header <em>just</em> defined its own entities. If it used entities from other files, the person writing the source was expected to know all the headers, and the order in which they needed to be included. This kept life simple for library <em>authors</em>, at the expense of (frequently) making the libraries they produced more difficult for users to actually use.</p>\n\n<p>When the C committee started to standardize C, they more or less rejected this approach, opting instead for an approach where each header looked independent from a user's point of view, and (in nearly all cases) inclusion of a header was idempotent (i.e., repeatedly including the same header, directly or indirectly, didn't cause a problem). This generally makes life simpler for the person using a library, at the expense of making the library author's life a little more difficult.</p>\n\n<p>Windows.h itself sort of leans toward the latter, but many of the other headers that depend on it lean more toward the former (at least in the specific case of windows.h).</p>\n"}], "owner": {"reputation": 75, "user_id": 7120033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1c0bffec09b369d5a014a0fb59c194d5?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Grant", "link": "https://stackoverflow.com/users/7120033/jason-grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498054838, "creation_date": 1498053348, "question_id": 44678183, "link": "https://stackoverflow.com/questions/44678183/c-header-does-not-include-dependent-header-on-its-own", "title": "c++ header does not include dependent header on its own", "body": "<p>Is there a reason why tlhelp32.h does not include windows.h itself ? I was fighting with tons of compiler errors because I included windows.h after including tlhelp32.h. Is it a design decision or for what reason ? I am new to c++ so i dont get it. If a header has dependencies it should include them.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;tlhelp32.h&gt;\n#include &lt;tchar.h&gt;\n\nstd::vector&lt;unsigned long&gt; GetProcessIdsHelper()\n{\nstd::vector&lt;ULONG&gt; result;\nauto snapshotHandle = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);\n\nif (snapshotHandle == INVALID_HANDLE_VALUE)\n    return result;\n\nPROCESSENTRY32 processEntry;\nif (!Process32First(snapshotHandle, &amp;processEntry))\n    return result;\n\ndo\n    result.push_back(processEntry.th32ProcessID);\nwhile (Process32Next(snapshotHandle, &amp;processEntry));\n\nreturn result;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "constructor", "pass-by-reference", "destructor"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1498053262, "post_id": 44678089, "comment_id": 76340366, "body": "Can&#39;t you use a <code>std::vector&lt;unsigned char&gt;</code> for an easy life? Otherwise you&#39;ll have to pass the size in to the ICON constructor, and use <code>::memcpy</code> or similar."}, {"owner": {"reputation": 17, "user_id": 2771445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8048991078a264067112b7cbecd849f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vishnu M S", "link": "https://stackoverflow.com/users/2771445/vishnu-m-s"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1498053366, "post_id": 44678089, "comment_id": 76340437, "body": "I am new to C syntax can you share an example please."}, {"owner": {"reputation": 3797, "user_id": 4022608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27c9e8430426724a1f39c98b268f0a98?s=128&d=identicon&r=PG&f=1", "display_name": "Baldrickk", "link": "https://stackoverflow.com/users/4022608/baldrickk"}, "edited": false, "score": 0, "creation_date": 1498053728, "post_id": 44678089, "comment_id": 76340696, "body": "What is the exact issue you are getting? does it compile without warnings with <code>-Wall -Werror</code>?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1498053763, "post_id": 44678089, "comment_id": 76340723, "body": "<b>C++ is not C is not C++!</b> If you think this is C code, you are either in the wrong course or reading the wrong book. And we are not a tutoring/&quot;gimme teh codez&quot; site"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 8167488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c097592c40efc5d42e63b3e1f3fb6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Dabi\u0161a Kelava", "link": "https://stackoverflow.com/users/8167488/dabi%c5%a1a-kelava"}, "is_accepted": false, "score": 0, "last_activity_date": 1498058278, "creation_date": 1498058278, "answer_id": 44680114, "question_id": 44678089, "link": "https://stackoverflow.com/questions/44678089/passing-and-assigning-value-for-a-static-unsigned-char-in-class/44680114#44680114", "title": "Passing and assigning value for a static unsigned char in class", "body": "<p>You can't assign value to an array type. You can:</p>\n\n<ul>\n<li>make it a pointer <code>static unsigned char* _update_icon_bits;</code></li>\n<li>keep it as an array but copy content to this array using a for loop or something</li>\n<li>use <code>std::vector</code> instead (preferred)</li>\n</ul>\n"}], "owner": {"reputation": 17, "user_id": 2771445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8048991078a264067112b7cbecd849f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vishnu M S", "link": "https://stackoverflow.com/users/2771445/vishnu-m-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 855, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1498058278, "creation_date": 1498053094, "last_edit_date": 1498053602, "question_id": 44678089, "link": "https://stackoverflow.com/questions/44678089/passing-and-assigning-value-for-a-static-unsigned-char-in-class", "title": "Passing and assigning value for a static unsigned char in class", "body": "<p>I have this code, I am not able to copy the unsigned char passed to the class constructor to unsinged char variable in the class.</p>\n\n<p>Main File</p>\n\n<pre><code>static unsigned char ic_opacity_black_24dp_bits[] = {\n   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x1f, 0x00, 0x00,\n};\nString cc=\"hello\"\nICON a(cc,ic_opacity_black_24dp_bits);\n</code></pre>\n\n<p>Icon.h</p>\n\n<pre><code>#ifndef ICON_H\n#define ICON_H\nclass ICON\n{\n  private:\n    String title;\n    static unsigned char _update_icon_bits[];\n\n  public:\n    ICON(String,unsigned char*,U8G2 u8);\n    ~ICON();\n};\n\n#endif\n</code></pre>\n\n<p>ICON.CPP</p>\n\n<pre><code>#include\"ICON.h\"\n#define DHEIGHT 128\n#define DWIDTH 64\n\nICON::ICON(String _title,unsigned char *ic, U8G2 u8)\n{\n//initializing values \n title=_title;\n_update_icon_bits=ic;\n\n\n}\n\nICON::~ICON() ///default distructor\n{\n}\n</code></pre>\n\n<p>I am not getting the value of passsed char array in my class variable.What should be the way to pass char array to assing value to a variable in the class?</p>\n"}, {"tags": ["c++", "gcc", "linker", "dynamic-library"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1498053678, "post_id": 44678029, "comment_id": 76340665, "body": "This is the kind of grunt work you should always leave up to a machine to figure out.  Not because it is hard to do, but because it is tedious and you&#39;ll lose an hour of your life when you don&#39;t pay attention enough.  Lots and lots of build systems out there, pick one."}, {"owner": {"reputation": 35, "user_id": 5904689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da52bc2984632a9436be722807817f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin van As", "link": "https://stackoverflow.com/users/5904689/kevin-van-as"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1498055626, "post_id": 44678029, "comment_id": 76342256, "body": "@HansPassant I am using a build system, <a href=\"https://cfd.direct/openfoam/user-guide/compiling-applications/\" rel=\"nofollow noreferrer\">wmake</a>, which is custom to the open-source Computational Fluid Dynamics software called OpenFoam. The reason for asking is that OpenFoam consists of many different executables (&quot;solvers&quot;) which rely on many dynamic libraries to do the work. I adapted one such library (<i>bar</i>) for my purposes, and I had figured that by simply overwriting the existing dynamic library all solvers would simply work: but they gave me segfaults. That&#39;s why I am asking <i>what exactly</i> should be relinked."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 5904689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da52bc2984632a9436be722807817f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin van As", "link": "https://stackoverflow.com/users/5904689/kevin-van-as"}, "is_accepted": false, "score": 0, "last_activity_date": 1498053395, "creation_date": 1498053395, "answer_id": 44678202, "question_id": 44678029, "link": "https://stackoverflow.com/questions/44678029/does-my-executable-need-relinking-when-a-library-used-by-a-library-that-i-use-ch/44678202#44678202", "title": "Does my executable need relinking when a library used by a library that I use changes?", "body": "<p>Until an expert answers, these are my own hypotheses:</p>\n\n<ol>\n<li><p>Given that the linker does not require \"-lbar\" for <em>exe</em>, I'm inclined to conclude that <em>exe</em> does not need re-linking as the linker apparently does not need <em>bar</em>. However, I am very unsure about this, as this assumes that the linker does not find <em>bar</em> via <em>foo</em>. (After all, <code>ldd libfoo.so</code> will show me <em>bar</em>, so I'd say that the linker may possess the knowledge that it needs <em>bar</em>.)</p></li>\n<li><p>No, they do not. The sources are compatible, so the symbols inside the compiled (object) files should still be correct/compatible. The executable does, however, need relinking, because the location of those symbols inside the object files has changed.</p></li>\n<li><p>It appears that that is allowed... But I'm not sure. Also: any executable/library that depends on <em>foo</em> other than <em>exe</em> will still face segmentation faults, so this would be bad-practice, would it not?</p></li>\n</ol>\n"}], "owner": {"reputation": 35, "user_id": 5904689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da52bc2984632a9436be722807817f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin van As", "link": "https://stackoverflow.com/users/5904689/kevin-van-as"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 552, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1498053395, "creation_date": 1498052961, "question_id": 44678029, "link": "https://stackoverflow.com/questions/44678029/does-my-executable-need-relinking-when-a-library-used-by-a-library-that-i-use-ch", "title": "Does my executable need relinking when a library used by a library that I use changes?", "body": "<p>Imagine we have an executable <em>exe</em> that depends on shared library <em>foo</em>, which in turn depends on shared library <em>bar</em>: <strong><em>exe</em> needs <em>libfoo.so</em> and <em>foo</em> needs <em>libbar.so</em></strong>.\nThen, <em>bar</em> is changed in a source-compatible manner (i.e. API unchanged), but not in a binary-compatible manner (i.e. ABI changed). We must therefore relink (or face segmentation faults).</p>\n\n<p>The question is: <strong>What exactly should be recompiled/relinked?</strong></p>\n\n<hr>\n\n<p>Let me make that a little more specific. To link <em>exe</em>, we need not add the compiler option \"-lbar\", whereas we do need that option for linking <em>foo</em>:</p>\n\n<pre><code>gcc -fPIC -shared -I. -Ibar -lbar -o libfoo.so foo.o\ngcc -fPIC -I. -Ifoo -Ibar -lfoo -o exe exe.o\n</code></pre>\n\n<ol>\n<li><p>Therefore, is it sufficient to relink <em>foo</em>, and leave <em>exe</em> as is?</p></li>\n<li><p>Do <em>foo</em> and <em>exe</em> also need recompilation (if <em>bar</em> is changed, but its API was unchanged)?</p></li>\n</ol>\n\n<p>Lastly, I have tried leaving <em>foo</em> unchanged, but relinked <em>exe</em> with the added \"-lbar\" compiler option:</p>\n\n<pre><code>gcc -fPIC -I. -Ifoo -Ibar -lfoo -lbar -o exe exe.o\n</code></pre>\n\n<p>This did eliminate the segmentation fault, which could imply that everything is then correctly linked... or it could by <em>shear luck</em> (because segmentation faults do not always occur, even though there is an inherit memory problem).</p>\n\n<ol start=\"3\">\n<li>Is it allowed to do that, i.e. leave <em>foo</em> unchanged, but explicitly link <em>exe</em> against <em>bar</em>?</li>\n</ol>\n\n<hr>\n\n<p>Somewhat related readings: [<a href=\"http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html\" rel=\"nofollow noreferrer\">1</a>][<a href=\"https://stackoverflow.com/questions/10268858/why-should-i-recompile-an-entire-program-just-for-a-library-update\">2</a>][<a href=\"https://stackoverflow.com/questions/4417989/relinking-applications-that-use-updated-shared-library-with-implicit-linking\">3</a>][<a href=\"https://stackoverflow.com/questions/2171177/what-is-application-binary-interface-abi\">4</a>][<a href=\"https://stackoverflow.com/questions/10269776/should-i-rebuild-a-dependent-lib-after-system-update/10269818#10269818\">5</a>]</p>\n"}, {"tags": ["c++", "templates", "inner-classes", "decltype"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498052751, "post_id": 44677931, "comment_id": 76340011, "body": "What compiler error do you get?"}, {"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498052785, "post_id": 44677931, "comment_id": 76340039, "body": "error C2227: left of &#39;-&gt;m_list&#39; must point to class/struct/union/generic type"}, {"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 0, "creation_date": 1498052818, "post_id": 44677931, "comment_id": 76340062, "body": "In VS2015 everything is OK. Please show the includes."}, {"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "edited": false, "score": 0, "creation_date": 1498052864, "post_id": 44677931, "comment_id": 76340104, "body": "Also, I forgot to mention that I can&#39;t just use <code>std::vector&lt;T&gt;::iterator</code> as my real class is more complex than the one above"}, {"owner": {"reputation": 4122, "user_id": 3951525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/hix21.jpg?s=128&g=1", "display_name": "Starl1ght", "link": "https://stackoverflow.com/users/3951525/starl1ght"}, "edited": false, "score": 0, "creation_date": 1498052981, "post_id": 44677931, "comment_id": 76340173, "body": "try cbegin instead of begin..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1498053103, "post_id": 44677931, "comment_id": 76340257, "body": "GCC (minGW) accepted without complaint - after fixing <code>m_iter(source-&gt;m_list.begin())</code>"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1498053109, "post_id": 44677931, "comment_id": 76340259, "body": "<a href=\"http://cpp.sh/2y4sn\" rel=\"nofollow noreferrer\">Cannot reproduce with g++</a>"}, {"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "edited": false, "score": 0, "creation_date": 1498053164, "post_id": 44677931, "comment_id": 76340298, "body": "Nope, constness is not the issue, cbegin doesn&#39;t solve. My suspect is that it&#39;s a compiler limitation. Anyone can suggest workarounds?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1498053243, "post_id": 44677931, "comment_id": 76340351, "body": "Could you <code>typedef</code> the iterator in the outer class and use that one in the inner?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498053277, "post_id": 44677931, "comment_id": 76340377, "body": "Visual Studio 2015 compiles this fine if you change <code>m_iter(source-&gt;begin())</code> to <code>m_iter(source-&gt;m_list.begin())</code> which isn&#39;t the line you are reporting as causing you problems."}, {"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "edited": false, "score": 0, "creation_date": 1498053835, "post_id": 44677931, "comment_id": 76340785, "body": "Thanks for your feedback everyone.  even <code>std::vector&lt;T&gt; m_list; using IteratorType = decltype(m_list.cbegin());</code>  doesn&#39;t work unfortunately"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1498064341, "post_id": 44677931, "comment_id": 76348341, "body": "To help people answer your question, you&#39;ll need to be more specific about the error.  Please <a href=\"https://stackoverflow.com/posts/44677931/edit\">edit</a> your post to incorporate the exact errors you get from your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (preferably using copy+paste to avoid transcription errors)."}], "answers": [{"tags": [], "owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "is_accepted": true, "score": 0, "last_activity_date": 1498125756, "creation_date": 1498125756, "answer_id": 44696204, "question_id": 44677931, "link": "https://stackoverflow.com/questions/44677931/c-decltype-in-template-inner-class/44696204#44696204", "title": "C++ decltype in template inner class", "body": "<p>To close the issue. This is a shortcoming of MSVC2013. It will resolve <code>decltype()</code> before \"working out\" the full type of members so inside decltype any access to methods is a compiler error.\nEven using global template functions (e.g. <code>decltype(std::begin(m_list))</code>) won't work.\nOther, more modern, compilers work.</p>\n"}], "owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 44696204, "answer_count": 1, "score": 2, "last_activity_date": 1498125756, "creation_date": 1498052677, "last_edit_date": 1498053656, "question_id": 44677931, "link": "https://stackoverflow.com/questions/44677931/c-decltype-in-template-inner-class", "title": "C++ decltype in template inner class", "body": "<p>My problem is illustrated by the example below:</p>\n\n<pre><code>#include &lt;vector&gt;\n\n    template &lt;class T&gt;\n    class TestNest{\n    public:\n        std::vector&lt;T&gt; m_list;\n        class InsideNest{\n            const TestNest&lt;T&gt;* m_test;\n            decltype(m_test-&gt;m_list.begin()) m_iter;\n        public:\n            InsideNest(const TestNest&lt;T&gt;* source)\n                :m_test(source)\n                ,m_iter(source-&gt;m_list.begin())\n            {}\n        };\n    };\n\nint main(int argc, char *argv[])\n{\n    TestNest&lt;int&gt; outside;\n    TestNest&lt;int&gt;::InsideNest inside(&amp;outside);\n}\n</code></pre>\n\n<p>the part that does not compile (at least not in MSVC2013) is <code>decltype(m_test-&gt;m_list.begin())</code>. Any idea how I can get around the problem?</p>\n\n<p>EDIT: changed code to show main() and #include</p>\n"}, {"tags": ["c++", "for-loop", "smart-pointers"], "comments": [{"owner": {"reputation": 1066, "user_id": 3359878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/9WfKf.jpg?s=128&g=1", "display_name": "Amadeusz", "link": "https://stackoverflow.com/users/3359878/amadeusz"}, "edited": false, "score": 1, "creation_date": 1498052573, "post_id": 44677862, "comment_id": 76339888, "body": "std::cout&lt;&lt; *info &lt;&lt;endl;"}, {"owner": {"reputation": 1, "user_id": 8194506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bc1ab834c93e9ecad116c6da7b1391?s=128&d=identicon&r=PG&f=1", "display_name": "Eusto", "link": "https://stackoverflow.com/users/8194506/eusto"}, "reply_to_user": {"reputation": 1066, "user_id": 3359878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/9WfKf.jpg?s=128&g=1", "display_name": "Amadeusz", "link": "https://stackoverflow.com/users/3359878/amadeusz"}, "edited": false, "score": 0, "creation_date": 1498052671, "post_id": 44677862, "comment_id": 76339948, "body": "It doesn&#39;t work, it prompts an error saying Invalid operands binary expression"}, {"owner": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "edited": false, "score": 1, "creation_date": 1498052720, "post_id": 44677862, "comment_id": 76339991, "body": "You have to write a <code>print()</code> function to your object <code>Bird</code>"}, {"owner": {"reputation": 1066, "user_id": 3359878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/9WfKf.jpg?s=128&g=1", "display_name": "Amadeusz", "link": "https://stackoverflow.com/users/3359878/amadeusz"}, "edited": false, "score": 0, "creation_date": 1498052795, "post_id": 44677862, "comment_id": 76340047, "body": "Could you provide definition of Bird class then?"}, {"owner": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "reply_to_user": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "edited": false, "score": 1, "creation_date": 1498052809, "post_id": 44677862, "comment_id": 76340057, "body": "@RoiHatam it doesn&#39;t need a <code>print</code> function, but there does need to be an operator <code>&lt;&lt;</code> which takes type <code>Bird</code>"}, {"owner": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "reply_to_user": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "edited": false, "score": 0, "creation_date": 1498052905, "post_id": 44677862, "comment_id": 76340133, "body": "@JamesElderfield Sure, function overloading is just another way to do it."}, {"owner": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "reply_to_user": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "edited": false, "score": 0, "creation_date": 1498052996, "post_id": 44677862, "comment_id": 76340188, "body": "@RoiHatam A <code>print</code> function would certainly be sensible, but I was just making the point that the above code won&#39;t work as written if you just add a <code>print</code> function"}, {"owner": {"reputation": 1066, "user_id": 3359878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/9WfKf.jpg?s=128&g=1", "display_name": "Amadeusz", "link": "https://stackoverflow.com/users/3359878/amadeusz"}, "reply_to_user": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "edited": false, "score": 0, "creation_date": 1498053101, "post_id": 44677862, "comment_id": 76340255, "body": "@James Elderfield Other way is to define Bird conversion to ex.: const char*"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1498053251, "post_id": 44677862, "comment_id": 76340354, "body": "It should also be <code>for (auto const &amp;info : fullData)</code>"}, {"owner": {"reputation": 1, "user_id": 8194506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bc1ab834c93e9ecad116c6da7b1391?s=128&d=identicon&r=PG&f=1", "display_name": "Eusto", "link": "https://stackoverflow.com/users/8194506/eusto"}, "edited": false, "score": 0, "creation_date": 1498053379, "post_id": 44677862, "comment_id": 76340448, "body": "<code>void fillFlock(std::vector&lt; std::unique_ptr&lt;Bird&gt;&gt;&amp; cage) {     size_t cageSize;     std::string name;          std::cout &lt;&lt; &quot;Bird cage size: &quot; &lt;&lt;std::endl;     std::cin &gt;&gt; cageSize;          &#47;&#47;set container size     cage.resize(cageSize);          for(auto &amp;bird : cage)     {         std::cout&lt;&lt;&quot;Bird Name &quot; &lt;&lt;std::endl;         std::cin &gt;&gt; name;              bird.reset(new Bird(name));     } } </code>"}, {"owner": {"reputation": 1, "user_id": 8194506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bc1ab834c93e9ecad116c6da7b1391?s=128&d=identicon&r=PG&f=1", "display_name": "Eusto", "link": "https://stackoverflow.com/users/8194506/eusto"}, "edited": false, "score": 0, "creation_date": 1498053486, "post_id": 44677862, "comment_id": 76340516, "body": "<code>int main() {     std::vector&lt; std::unique_ptr&lt;Bird&gt; &gt; m_flock;     fillFlock(m_flock);     printInfo(m_flock); }</code>"}, {"owner": {"reputation": 1050, "user_id": 4534275, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/671721deaa074d660cc7a13bfbd6b397?s=128&d=identicon&r=PG", "display_name": "nefas", "link": "https://stackoverflow.com/users/4534275/nefas"}, "edited": false, "score": 0, "creation_date": 1498053505, "post_id": 44677862, "comment_id": 76340527, "body": "@Eusto please do not put code in comment, it&#39;s hard to read. If it&#39;s relevant, edit your question."}, {"owner": {"reputation": 1, "user_id": 8194506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bc1ab834c93e9ecad116c6da7b1391?s=128&d=identicon&r=PG&f=1", "display_name": "Eusto", "link": "https://stackoverflow.com/users/8194506/eusto"}, "edited": false, "score": 0, "creation_date": 1498054170, "post_id": 44677862, "comment_id": 76341026, "body": "I&#39;ve edited my question, please have a look at it. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8194506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bc1ab834c93e9ecad116c6da7b1391?s=128&d=identicon&r=PG&f=1", "display_name": "Eusto", "link": "https://stackoverflow.com/users/8194506/eusto"}, "edited": false, "score": 0, "creation_date": 1498054995, "post_id": 44677944, "comment_id": 76341719, "body": "I have edited my question to make it clearer, please have a look at it. Thank you in advance."}, {"owner": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 0, "creation_date": 1498058398, "post_id": 44677944, "comment_id": 76344605, "body": "As a very minor point, you don&#39;t really need to define the operator as a friend, assuming <code>getName</code> is public."}], "tags": [], "owner": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "is_accepted": false, "score": 1, "last_activity_date": 1498056364, "last_edit_date": 1498056364, "creation_date": 1498052711, "answer_id": 44677944, "question_id": 44677862, "link": "https://stackoverflow.com/questions/44677862/how-do-i-print-out-the-values-in-a-vector-of-unique-pointer-objectsrange-based/44677944#44677944", "title": "How do I print out the values in a vector of unique pointer objects(Range based for loops)? C++", "body": "<p>You're actually making a new pointer to your unique pointers, and then printing the address of that. Use <code>&amp;</code> to make a pointer and <code>*</code> to dereference (get the value). In other words,</p>\n\n<pre><code>std::cout &lt;&lt; *info &lt;&lt; std::endl;\n</code></pre>\n\n<p><strong>EDIT: Question was changed and extra context added</strong></p>\n\n<p>If you want to call the function on <code>info</code>, then call the function,</p>\n\n<pre><code>std::cout &lt;&lt; info-&gt;getName() &lt;&lt; std::endl;\n</code></pre>\n\n<p>The type of <code>info</code> is just <code>std::unique_ptr&lt;Bird&gt;&amp;</code> if that is what is throwing you.</p>\n\n<p>Perhaps you want this to happen automatically with the streaming operator. A way of doing this is to define a <code>operator&lt;&lt;</code> that takes your <code>Bird</code> class. You can do this by adding the following declaration to your <code>Bird</code> class,</p>\n\n<pre><code>class Bird {\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const Bird&amp; bird);\n};\n</code></pre>\n\n<p>and then in your source file add the definition,</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const Bird&amp; bird) {\n    return out &lt;&lt; bird.getName();\n}\n</code></pre>\n\n<p>This assumes that your <code>getName</code> function is const-qualified, which it really should be.</p>\n"}], "owner": {"reputation": 1, "user_id": 8194506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bc1ab834c93e9ecad116c6da7b1391?s=128&d=identicon&r=PG&f=1", "display_name": "Eusto", "link": "https://stackoverflow.com/users/8194506/eusto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1498056364, "creation_date": 1498052485, "last_edit_date": 1498054907, "question_id": 44677862, "link": "https://stackoverflow.com/questions/44677862/how-do-i-print-out-the-values-in-a-vector-of-unique-pointer-objectsrange-based", "title": "How do I print out the values in a vector of unique pointer objects(Range based for loops)? C++", "body": "<p>I have a snippet of code here and I have a vector of smart pointers objects that are filled, how would I be able to print all the values of all the objects using <b>range based for loops?</b> I do not want the addresses, but the value. Thank you in advance.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void printInfo(const std::vector&lt; std::unique_ptr&lt;Bird&gt; &gt;&amp;fullData )\n{\n    for(auto &amp;info : fullData)\n    {\n        std::cout&lt;&lt; &amp;info &lt;&lt;endl; //I want this to print getName() for each object, but how do I do that with range-based-for-loop? Something like this.. info-&gt;getName()\n\n    }\n}\n</code></pre>\n\n<pre class=\"lang-or-tag-here prettyprint-override\"><code>void fillFlock( std::vector&lt; std::unique_ptr&lt;Bird&gt; &gt; &amp;cage)  \n{\n\n  size_t cageSize;\n  std::string name;\n\n  std::cout &lt;&lt; \"Bird cage size: \" &lt;&lt;std::endl;\n  std::cin &gt;&gt; cageSize;\n\n  //set container size\n  cage.resize(cageSize);\n\n    for(auto &amp;bird : cage)\n    {\n        std::cout&lt;&lt;\"Bird Name \" &lt;&lt;std::endl;\n        std::cin &gt;&gt; name;\n\n        bird.reset(new Bird(name));\n    }\n}\n</code></pre>\n\n<pre class=\"lang-or-tag-here prettyprint-override\"><code>int main()  \n{\n    std::vector&lt; std::unique_ptr&lt;Bird&gt; &gt; m_flock;\n    fillFlock(m_flock);\n    printInfo(m_flock);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "type-conversion", "rvalue-reference", "lvalue"], "comments": [{"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 9, "creation_date": 1498052435, "post_id": 44677825, "comment_id": 76339786, "body": "Thought experiment: <code>int x = 1;</code> -- 1 is an rvalue here. Does the literal 1 have a memory address? Can you do <code>&amp;1</code> to obtain its address?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498052520, "post_id": 44677825, "comment_id": 76339857, "body": "Pass an rvalue into a function.  Seriously though the rvalue would cease to exist at the end of the expression where it&#39;s access was obtained, leaving you with a dangling pointer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8194556"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1498057108, "post_id": 44677825, "comment_id": 76343558, "body": "@cdhowie why is <code>const int&amp; bon = 2;</code> possible then?"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 2, "creation_date": 1498061461, "post_id": 44677825, "comment_id": 76346744, "body": "@OfT Because temporaries are allowed to bind to const references, which extends the lifetime of the temporary. That doesn&#39;t change the fact that 2 is an rvalue. My comment is meant to make you think twice about your pondering <i>&quot;technically, rvalues do have a memory address, right?&quot;</i> The answer is that <i>not all</i> rvalues have a memory address."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8194556"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1498063174, "post_id": 44677825, "comment_id": 76347686, "body": "@cdhowie Ahh then it makes sense why it is not allowed to do the conversion, thanks man! But you said &quot;Because temporaries are allowed to bind to const references&quot;, but what is <code>bon</code> then referring to, address-wise?"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1498063444, "post_id": 44677825, "comment_id": 76347847, "body": "@OfT The temporary has the same storage duration as the reference. Typically this is going to be implemented as a stack allocation to hold the temporary (if this line of code appears in a function) and the reference becomes a compile-time detail that is erased. So the reference is referring to the lifetime-extended temporary, and at that point you can take the address. Note that this is different from saying that &quot;2 has an address.&quot; Rather, the rvalue 2 was used to construct a temporary <code>int</code> object -- this temporary has an obtainable address only after it is bound to a reference."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8194556"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1498066650, "post_id": 44677825, "comment_id": 76349667, "body": "Wow nice explanation, thanks again! So just to confirm, when doing <code>const int&amp; bon = 2;</code>, the compiler creates a temporary integer that is assigned the given literal at the right-hand-side of the assignment statement. This temporary, in opposite to the literal, has an address that assigned to the const reference anddd the temporary then has a life time equal to the reference. Did I get it right? I really appreciate your time bud, :)) @cdhowie"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 1, "creation_date": 1498077242, "post_id": 44677825, "comment_id": 76355634, "body": "@OfT That&#39;s correct. The trick is that you can&#39;t take the address of something without a name (an rvalue). But by binding that temporary to a reference, <i>you&#39;ve given it a name</i> (recall that a reference is just another name for an object) and so you&#39;re allowed to take its address."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1549376913, "post_id": 44677825, "comment_id": 95874582, "body": "@cdhowie You can&#39;t do <code>&amp;*&quot;hello&quot;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "is_accepted": false, "score": 14, "last_activity_date": 1549376592, "last_edit_date": 1549376592, "creation_date": 1538654079, "answer_id": 52646051, "question_id": 44677825, "link": "https://stackoverflow.com/questions/44677825/rvalue-to-lvalue-conversion/52646051#52646051", "title": "Rvalue to lvalue conversion?", "body": "<p>You can:</p>\n\n<pre><code>int&amp;&amp; x = 3;\n</code></pre>\n\n<p><code>x</code> is now an lvalue. A so called 'rvalue-reference' can <strong>bind to a temporary</strong>,\nbut anything with a name <strong>is an lvalue</strong>, so you need to <code>forward&lt;&gt;()</code> it if you need it's rvalueness back.</p>\n\n<p>Note that by binding a temporary to a rvalue-reference (or a const reference) you extend its lifetime. Technically a cast is possible,\nbut not recommended, since temporaries have short lifetime, so you\ntypically get a dangling reference.</p>\n"}, {"tags": [], "owner": {"reputation": 1003, "user_id": 2528436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e1d4385a3ac2f060b4fea2bba1f6e5a?s=128&d=identicon&r=PG", "display_name": "Kai Petzke", "link": "https://stackoverflow.com/users/2528436/kai-petzke"}, "is_accepted": false, "score": 2, "last_activity_date": 1618234179, "creation_date": 1618234179, "answer_id": 67059296, "question_id": 44677825, "link": "https://stackoverflow.com/questions/44677825/rvalue-to-lvalue-conversion/67059296#67059296", "title": "Rvalue to lvalue conversion?", "body": "<p>It is rather straightforward to write a template function <code>unmove()</code>, that does the opposite of <code>std::move()</code>:</p>\n<pre><code>template&lt;class T&gt; T&amp; unmove(T&amp;&amp; t) { return t; }\n</code></pre>\n<p>Please note that, according to the standard since C++11:</p>\n<p>a temporary bound to a reference parameter in a function call exists until the end of the full expression containing that function call: if the function returns a reference, which outlives the full expression, it becomes a dangling reference.</p>\n<p>So it is safe to use <code>unmove()</code> within a single full expression, but after the expression has been fully evaluated, the temporaries go away.</p>\n<p>My common use for <code>unmove()</code> is to call functions / methods, that return values through references, when I don't need those values.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8194556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9183, "favorite_count": 1, "answer_count": 2, "score": 16, "last_activity_date": 1618234179, "creation_date": 1498052397, "last_edit_date": 1514350290, "question_id": 44677825, "link": "https://stackoverflow.com/questions/44677825/rvalue-to-lvalue-conversion", "title": "Rvalue to lvalue conversion?", "body": "<p>Why it is not possible to convert rvalues to lvalues?  It is possible to do a conversion in the opposite direction though. Technically rvalues do have a memory address, isn't it?</p>\n"}, {"tags": ["c++", "unit-testing", "build", "cmake", "catch-unit-test"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498051841, "post_id": 44677412, "comment_id": 76339275, "body": "You are missing some Catch library(s) obviously.  If you can&#39;t find them in the linker section of your VS project; then try looking in the headers of Catch for <code>#pragma comment( lib, &quot;name-of-catch-library&quot; )</code>  which will cause the named library to be automatically picked up by the linker."}, {"owner": {"reputation": 2782, "user_id": 853791, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0oVE.jpg?s=128&g=1", "display_name": "bobeff", "link": "https://stackoverflow.com/users/853791/bobeff"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1498051927, "post_id": 44677412, "comment_id": 76339360, "body": "@Richard Critten As I said the catch library is header only and there is no <b>libs</b> for it."}, {"owner": {"reputation": 1143, "user_id": 2466572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3de0d3fe056a4e5b6285244fd531e4a?s=128&d=identicon&r=PG", "display_name": "k.v.", "link": "https://stackoverflow.com/users/2466572/k-v"}, "edited": false, "score": 2, "creation_date": 1498051934, "post_id": 44677412, "comment_id": 76339367, "body": "Did you use &quot;official&quot; instruction for CMake integration? <a href=\"https://github.com/philsquared/Catch/blob/master/docs/build-systems.md\" rel=\"nofollow noreferrer\">github.com/philsquared/Catch/blob/master/docs/build-systems.&zwnj;&#8203;md</a> (see CMake section)"}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 2, "creation_date": 1498056259, "post_id": 44677412, "comment_id": 76342805, "body": "Could you please give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including some <code>CMakeLists.txt</code> code?"}], "answers": [{"comments": [{"owner": {"reputation": 2782, "user_id": 853791, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0oVE.jpg?s=128&g=1", "display_name": "bobeff", "link": "https://stackoverflow.com/users/853791/bobeff"}, "edited": false, "score": 0, "creation_date": 1498053263, "post_id": 44677758, "comment_id": 76340367, "body": "+1 Thank you for pointing me to the official <b>Catch</b> documentation about <b>CMake</b> integration, but I didn&#39;t find there anything useful about my problem. Defining <b>Catch</b> as interface library and adding it as dependency in <b>target_link_libraries</b> is pointless because <b>Catch</b> is header only library and no separate build and linking are required. Nevertheless I tried it and this didn&#39;t change anything."}, {"owner": {"reputation": 1143, "user_id": 2466572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3de0d3fe056a4e5b6285244fd531e4a?s=128&d=identicon&r=PG", "display_name": "k.v.", "link": "https://stackoverflow.com/users/2466572/k-v"}, "reply_to_user": {"reputation": 2782, "user_id": 853791, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0oVE.jpg?s=128&g=1", "display_name": "bobeff", "link": "https://stackoverflow.com/users/853791/bobeff"}, "edited": false, "score": 0, "creation_date": 1498112672, "post_id": 44677758, "comment_id": 76366606, "body": "@bobeff Did you try to create a catch unit testing project in your new CMake environment <i>from scratch</i> using exact instructions? Maybe it will help you to find the exact problem, because currently there is not enough information. And doing it from scratch may help you to find a step where it breaks."}], "tags": [], "owner": {"reputation": 1143, "user_id": 2466572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3de0d3fe056a4e5b6285244fd531e4a?s=128&d=identicon&r=PG", "display_name": "k.v.", "link": "https://stackoverflow.com/users/2466572/k-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1498052232, "creation_date": 1498052232, "answer_id": 44677758, "question_id": 44677412, "link": "https://stackoverflow.com/questions/44677412/unresolved-external-symbol-with-catch-library/44677758#44677758", "title": "Unresolved external symbol with Catch library", "body": "<p>It's a little bit hard to deduce a concrete problem from the context you provided, but <a href=\"https://github.com/philsquared/Catch/blob/master/docs/build-systems.md\" rel=\"nofollow noreferrer\">here</a> is an official Catch instruction for CMake integration.</p>\n\n<p>In my experience using it with Visual Studio - integration went smoothly.</p>\n"}, {"tags": [], "owner": {"reputation": 2782, "user_id": 853791, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0oVE.jpg?s=128&g=1", "display_name": "bobeff", "link": "https://stackoverflow.com/users/853791/bobeff"}, "is_accepted": true, "score": 3, "last_activity_date": 1500975924, "creation_date": 1500975924, "answer_id": 45299591, "question_id": 44677412, "link": "https://stackoverflow.com/questions/44677412/unresolved-external-symbol-with-catch-library/45299591#45299591", "title": "Unresolved external symbol with Catch library", "body": "<p>In one of my files I have:</p>\n\n<pre><code>#define CATCH_CONFIG_MAIN\n#include &lt;catch.hpp&gt;\n</code></pre>\n\n<p>but I also using <strong>CMake</strong> macro for adding precompiled header to the project:</p>\n\n<pre><code>add_precompiled_header (${TARGET_NAME}\n  ${CMAKE_CURRENT_SOURCE_DIR}/StdAfx.h\n  ${CMAKE_CURRENT_SOURCE_DIR}/StdAfx.cpp)\n</code></pre>\n\n<p>This macro forcefully includes precompiled header in all files, but in it I have <code>#include &lt;catch.hpp&gt;</code> without <code>#define CATCH_CONFIG_MAIN</code> which is needed by all files except one.</p>\n\n<p>I added option to the macro to pass list of files in which not to be included precompiled header and this resolves the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 549, "user_id": 2641418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JOHZv.png?s=128&g=1", "display_name": "IUnknown", "link": "https://stackoverflow.com/users/2641418/iunknown"}, "is_accepted": false, "score": 0, "last_activity_date": 1533536938, "creation_date": 1533536938, "answer_id": 51701706, "question_id": 44677412, "link": "https://stackoverflow.com/questions/44677412/unresolved-external-symbol-with-catch-library/51701706#51701706", "title": "Unresolved external symbol with Catch library", "body": "<p>When I try to use Catch with the Precompiled Header option enabled in my test project, I end up with linker errors LNK2019. </p>\n\n<p>I still use stdafx.h in my project and disable the Precompiled header option in order for the project to build.</p>\n\n<p>Right-click project -> Configuration Properties -> C/C++->Precompiled Headers -> Precompiled Header -> Not Using Precompiled Headers.</p>\n"}], "owner": {"reputation": 2782, "user_id": 853791, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0oVE.jpg?s=128&g=1", "display_name": "bobeff", "link": "https://stackoverflow.com/users/853791/bobeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1909, "favorite_count": 0, "accepted_answer_id": 45299591, "answer_count": 3, "score": 3, "last_activity_date": 1533536938, "creation_date": 1498051335, "last_edit_date": 1498054436, "question_id": 44677412, "link": "https://stackoverflow.com/questions/44677412/unresolved-external-symbol-with-catch-library", "title": "Unresolved external symbol with Catch library", "body": "<p>I'm migrating some projects to use <a href=\"https://cmake.org/\" rel=\"nofollow noreferrer\">CMake</a> build system. Now I'm adding project with some unit tests using the <a href=\"https://github.com/philsquared/Catch\" rel=\"nofollow noreferrer\">Catch</a> library. It is header only library. The old <strong>Visual Studio</strong> project builds fine, but the new <a href=\"https://cmake.org/\" rel=\"nofollow noreferrer\">CMake</a> project gives unresolved external symbol linker error. I have defined <strong>CATCH_CONFIG_MAIN</strong> in one of my source files. There are added all <strong>cpp</strong> files from other projects which are needed for the tests and all libraries on which other tested projects depend are linked. Despite this I have unresolved external symbol error only with generated from <a href=\"https://cmake.org/\" rel=\"nofollow noreferrer\">CMake</a> project:</p>\n\n<pre><code>ChipCountTests.obj : error LNK2019: unresolved external symbol \"public: __thiscall Catch::SourceLineInfo::SourceLineInfo(char const *,unsigned int)\" (??0SourceLineInfo@Catch@@QAE@PBDI@Z) referenced in function \"void __cdecl `anonymous namespace'::`dynamic initializer for 'autoRegistrar1''(void)\" (??__EautoRegistrar1@?A0xb4291ec5@@YAXXZ)\n1&gt;FlyingChipRewardCalculatorUT.obj : error LNK2001: unresolved external symbol \"public: __thiscall Catch::SourceLineInfo::SourceLineInfo(char const *,unsigned int)\" (??0SourceLineInfo@Catch@@QAE@PBDI@Z)\n</code></pre>\n\n<p>Obviously I'm missing to add some configuration from <strong>vcxproj</strong> to <code>CMakeLists.txt</code> but I'm currently can't figure it out.</p>\n"}, {"tags": ["c++", "visual-c++", "dynamic-cast"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 10, "creation_date": 1498050220, "post_id": 44676957, "comment_id": 76337897, "body": "Please show how you call <code>func</code>.  (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1498050286, "post_id": 44676957, "comment_id": 76337963, "body": "Do <code>B</code> have any virtual functions? I.e. is <code>B</code> <i>polymorphic</i>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1498050331, "post_id": 44676957, "comment_id": 76338021, "body": "We&#39;re gonna need an example right back from <code>int main()</code>. Not enough here."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 1, "creation_date": 1498050444, "post_id": 44676957, "comment_id": 76338123, "body": "Please <a href=\"https://stackoverflow.com/help/mcve\">create an MCVE</a>."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1498050473, "post_id": 44676957, "comment_id": 76338152, "body": "Please post actual code. We can <i>assume</i> you have accurately presented your bug in <i>hypothetical pseudocode</i>."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1498050533, "post_id": 44676957, "comment_id": 76338208, "body": "NB it doesn&#39;t need to be your <i>oiginal</i> code, just <i>real</i> code that exhibits the bug."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498051582, "post_id": 44676957, "comment_id": 76339064, "body": "<a href=\"http://ideone.com/gKgTRh\" rel=\"nofollow noreferrer\">Not reproducible</a> on your example. This can happen if D inherits from C <a href=\"http://ideone.com/7P0THQ\" rel=\"nofollow noreferrer\">more than once</a> or if C is an <a href=\"http://ideone.com/32PtFS\" rel=\"nofollow noreferrer\">inaccessible base for D</a>, but not with your type of hierarchy."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1498052159, "post_id": 44676957, "comment_id": 76339563, "body": "AFAIK there must be a virtual function in your class for this to work."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1498052430, "post_id": 44676957, "comment_id": 76339782, "body": "@RetiredNinja: Indeed, <code>B</code> needs to be a polymorphic type. See my answer which took some tweaking to get right ;-)."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498051718, "post_id": 44677434, "comment_id": 76339176, "body": "You are casting in the opposite direction."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498052129, "post_id": 44677434, "comment_id": 76339535, "body": "@n.m. Oops. All fixed. Indeed the &quot;source&quot; type - <code>B</code> in this instance needs to be polymorphic."}, {"owner": {"reputation": 2516, "user_id": 756290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7162dbc5c24688265d001fecf8f1c9f6?s=128&d=identicon&r=PG", "display_name": "Scrontch", "link": "https://stackoverflow.com/users/756290/scrontch"}, "edited": false, "score": 0, "creation_date": 1498052740, "post_id": 44677434, "comment_id": 76340005, "body": "Thanks a lot for taking your time. It confirms that i don&#39;t do something fundamentally wrong with the cast. I have myself written a test with the real classes and it shows it works well within that test environment too. I still have the problem in the real app though and i dont know how to track it down. It might be VC++ playing tricks on me and the object isn&#39;t really what VC++ wants to make me belief."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2516, "user_id": 756290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7162dbc5c24688265d001fecf8f1c9f6?s=128&d=identicon&r=PG", "display_name": "Scrontch", "link": "https://stackoverflow.com/users/756290/scrontch"}, "edited": false, "score": 0, "creation_date": 1498052802, "post_id": 44677434, "comment_id": 76340052, "body": "@Scrontch: I really doubt its MSVC2013. Microsoft&#39;s compiler has improved a lot since the bad days of version 5."}, {"owner": {"reputation": 2516, "user_id": 756290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7162dbc5c24688265d001fecf8f1c9f6?s=128&d=identicon&r=PG", "display_name": "Scrontch", "link": "https://stackoverflow.com/users/756290/scrontch"}, "edited": false, "score": 0, "creation_date": 1498054501, "post_id": 44677434, "comment_id": 76341335, "body": "I didn&#39;t want to say MSVC is bugged. But rather that i may not read its output correctly. in Debug mode, how do i find out what is the concrete type of an object pointed to via a base pointer?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1498092675, "post_id": 44677434, "comment_id": 76360659, "body": "I&#39;ve used many versions of Visual Studio on many huge games and never had a problem with dynamic cast. There&#39;s a much greater chance something is wrong in your project than for dynamic cast to be broken in Visual Studio.  Since you have not shared a real example with us I&#39;m afraid you&#39;re on your own."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1498052487, "last_edit_date": 1498052487, "creation_date": 1498051395, "answer_id": 44677434, "question_id": 44676957, "link": "https://stackoverflow.com/questions/44676957/c-dynamic-cast-returning-null-although-object-is-of-a-derived-type/44677434#44677434", "title": "C++ dynamic_cast returning NULL although object is of a derived type", "body": "<p>Your problem is elsewhere.</p>\n\n<p>Consider</p>\n\n<pre><code>#include &lt;iostream&gt;\nstruct A {};\nstruct B {virtual ~B() = default;};\nstruct C : A, B {};\nstruct D : C {};\nint main()\n{\n    D d;\n    D* pd = &amp;d;\n    B* pb = dynamic_cast&lt;B*&gt;(pd);\n    C* pc = dynamic_cast&lt;C*&gt;(pb);\n    std::cout &lt;&lt; pc; // this is not nullptr\n}\n</code></pre>\n\n<p>This proves that <code>C*</code> is reachable from <code>B*</code> for an pointer to an object of type <code>D</code>, when only <code>B</code> (the <em>source type</em> in the second cast) is explicitly polymorphic.</p>\n\n<p>See <a href=\"https://ideone.com/ifxYgV\" rel=\"nofollow noreferrer\">https://ideone.com/ifxYgV</a></p>\n"}], "owner": {"reputation": 2516, "user_id": 756290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7162dbc5c24688265d001fecf8f1c9f6?s=128&d=identicon&r=PG", "display_name": "Scrontch", "link": "https://stackoverflow.com/users/756290/scrontch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 1, "closed_date": 1498052362, "answer_count": 1, "score": 0, "last_activity_date": 1498052487, "creation_date": 1498050159, "question_id": 44676957, "link": "https://stackoverflow.com/questions/44676957/c-dynamic-cast-returning-null-although-object-is-of-a-derived-type", "closed_reason": "Not suitable for this site", "title": "C++ dynamic_cast returning NULL although object is of a derived type", "body": "<p>I have a strange problem, where a dynamic_cast is returning a NULL pointer although the object given in the expression is of a derived type with an inheritance path to the type of the cast.</p>\n\n<p>Unfortunately, i cannot post original code, so here is the situation roughly reconstructed:</p>\n\n<p>I have a clas hierarchy of the following type:</p>\n\n<pre><code>class A\nclass B\nclass C : public A, B\nclass D : public C\n</code></pre>\n\n<p>All classes have virtual members.</p>\n\n<p>Now assume I have an object of concrete type D.</p>\n\n<p>In a function where this object is passed in as a B*, i have a cast of this type:</p>\n\n<pre><code>C* func(B* pObject)\n{\n  return dynamic_cast&lt;C*&gt;(pObject);\n}\n</code></pre>\n\n<p>The cast returns NULL although the object seems well defined.\nVC++ reports it as being a D when looking at the object in debugger when hovering over pObject. (might this be misleading?)</p>\n\n<p>Is this cast supposed to work?\nImo this cast should be allowed. Am i missing something?\nWhat can i do to analyse this issue?\nCould there be an issue with the multiple inheritance?</p>\n\n<p>This is on Visual C++ 2013 Pro if it makes any difference.</p>\n"}, {"tags": ["c++", "include", "friend"], "answers": [{"comments": [{"owner": {"reputation": 1239, "user_id": 5209610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/doSfi.jpg?s=128&g=1", "display_name": "Vladislav Martin", "link": "https://stackoverflow.com/users/5209610/vladislav-martin"}, "edited": false, "score": 0, "creation_date": 1498051110, "post_id": 44677009, "comment_id": 76338657, "body": "Thanks for the simple answer. By any chance do you know why C++(XX/11) allows you to forward-declare a class like that? For whatever reason, in my mind it seems to challenge the notion that data must be strongly typed... (<b>NOTE:</b> Apologies for my &quot;unsigned double&quot; typo)"}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "reply_to_user": {"reputation": 1239, "user_id": 5209610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/doSfi.jpg?s=128&g=1", "display_name": "Vladislav Martin", "link": "https://stackoverflow.com/users/5209610/vladislav-martin"}, "edited": false, "score": 1, "creation_date": 1498051516, "post_id": 44677009, "comment_id": 76339002, "body": "@VladislavMartin This is exactly to solve problems like yours (mutual-include). In c++ you code is (in general) parsed from top to bottom which creates a lot of problems when you need to use e.g. function which is defined after the call. Thats why declaration was implemented. In your case compiler need to know only the name of the class, so declaration will suffice. However, you cannot create object of class which is only declared or call any of its methods."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "reply_to_user": {"reputation": 1239, "user_id": 5209610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/doSfi.jpg?s=128&g=1", "display_name": "Vladislav Martin", "link": "https://stackoverflow.com/users/5209610/vladislav-martin"}, "edited": false, "score": 0, "creation_date": 1498051727, "post_id": 44677009, "comment_id": 76339180, "body": "@VladislavMartin It&#39;s also noteworthy that using declaration everywhere where it is possible speeds up the compilation because parsing a definition obviously takes some time."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "reply_to_user": {"reputation": 1239, "user_id": 5209610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/doSfi.jpg?s=128&g=1", "display_name": "Vladislav Martin", "link": "https://stackoverflow.com/users/5209610/vladislav-martin"}, "edited": false, "score": 0, "creation_date": 1498051990, "post_id": 44677009, "comment_id": 76339421, "body": "Ok, but only if you&#39;ll fix this typo in the question ;)"}], "tags": [], "owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "is_accepted": true, "score": 1, "last_activity_date": 1498052264, "last_edit_date": 1498052264, "creation_date": 1498050305, "answer_id": 44677009, "question_id": 44676910, "link": "https://stackoverflow.com/questions/44676910/selectively-hide-member-of-member-of-class/44677009#44677009", "title": "Selectively hide member of member of class", "body": "<p>You don't have to include <code>People.h</code> in <code>PhysicalTraits.h</code>. Full definition of class <code>People</code> is not required there. You can just declare that class.</p>\n\n<p><code>PhysicalTraits.h</code> would look like that:</p>\n\n<pre><code>class People;  // Forward declaration\n\nstruct PhysicalTraits {\n    double height; // meters\nprivate:\n    unsigned int age; // years\n    friend class People; // Objects of type `People` can access age\n};\n</code></pre>\n\n<hr>\n\n<p>Forward declarations was created exactly in order to solve problems like yours (mutual-include). In c++ you code is (in general) parsed from top to bottom which creates a lot of problems when you need to use e.g. function which is defined after the call. Thats why declaration was implemented.\nIn your case compiler need to know only the name of the class, so declaration will suffice. However, you cannot create object of class which is only declared or call any of its methods.</p>\n\n<p>It's also noteworthy that using declaration everywhere where it is possible speeds up the compilation because parsing a definition obviously takes some time.</p>\n"}], "owner": {"reputation": 1239, "user_id": 5209610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/doSfi.jpg?s=128&g=1", "display_name": "Vladislav Martin", "link": "https://stackoverflow.com/users/5209610/vladislav-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 44677009, "answer_count": 1, "score": 0, "last_activity_date": 1498053854, "creation_date": 1498050045, "last_edit_date": 1498053854, "question_id": 44676910, "link": "https://stackoverflow.com/questions/44676910/selectively-hide-member-of-member-of-class", "title": "Selectively hide member of member of class", "body": "<pre><code>// PhysicalTraits.h\nstruct PhysicalTraits {\n     unsigned int age; // years\n     double height; // meters\n\n     PhysicalTraits(const double H = 0.0, const unsigned int A = 0u) : age (A), height(H) {};\n     ~PhysicalTraits() {};\n};\n\n// People.h\n#include &lt;PhysicalTraits.h&gt;\nclass People {\n    PhysicalTraits traits;\n\npublic:\n    People(const double H = 0.0, const double A = 0u) : traits(H, A);\n    ~People() {};\n\n    void displayAge() { std::cout &lt;&lt; \"You are \" &lt;&lt; traits.age &lt;&lt; \" years old.\" &lt;&lt; std::endl; }\n    void displayHeight() { std::cout &lt;&lt; \"You are \" &lt;&lt; traits.height &lt;&lt; \" meters tall.\" &lt;&lt; std::endl; }\n};\n\n// Me.h\n#include &lt;PhysicalTraits.h&gt;\nclass Me {\n    PhysicalTraits traits;\n\npublic:\n    Me(const double H = 0.0) : traits(H);\n    ~Me() {};\n\n    void displayAge() {\n        // I want `traits.age` to throw an error \n        std::cout &lt;&lt; \"You are \" &lt;&lt; traits.age &lt;&lt; \" years old.\" &lt;&lt; \n    }\n    void displayHeight() { \n        std::cout &lt;&lt; \"You are \" &lt;&lt; traits.height &lt;&lt; \" meters tall.\" &lt;&lt; std::endl; \n    }\n};\n</code></pre>\n\n<p>I intend to allow objects of type <code>People</code> to access <code>traits.age</code>. However, I don't want to know my age, so I want to restrict objects of type <code>Me</code> from accessing <code>traits.age</code>. </p>\n\n<p>To do this, I modified <code>PhysicalTraits.h</code>:</p>\n\n<pre><code>#include &lt;People.h&gt;\nstruct PhysicalTraits {\n    double height; // meters\nprivate:\n    unsigned int age; // years\n    friend class People; // Objects of type `People` can access age\n};\n</code></pre>\n\n<p>With <code>age</code> as a private member variable and as a friend with <code>People</code>, but not <code>Me</code>. I've solved the problem... kind of.</p>\n\n<p>However, the <em>new</em> problem is that I've included <code>People.h</code> in <code>PhysicalTraits.h</code> and <code>PhysicalTraits.h</code> in <code>People.h</code>. So, when <code>PhysicalTraits.h</code> is compiled, before defining the <code>PhysicalTraits</code> object it will jump to the definition of the <code>People</code> object, which requires that the <code>PhysicalTraits</code> object is defined.</p>\n\n<p><strong>How can I avoid this \"mutual-include\" problem while still ensuring that an object of type <code>Me</code> cannot access <code>traits.age</code>?</strong></p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1498049550, "post_id": 44676668, "comment_id": 76337358, "body": "Are these key values pairs in a string separated by spaces? Why do you want to use regex?"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1498049666, "post_id": 44676668, "comment_id": 76337458, "body": "Have you tried something specific? Or are you hoping someone codes it up fo you? What are you stuck on? Regex? User input?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1498049693, "post_id": 44676668, "comment_id": 76337474, "body": "Welcome to Stack Overflow. This is not a code or regex writing service. We&#39;re more than happy to help, but you&#39;re expected to make an effort to figure things out yourself. You should spend some time taking the <a href=\"https://stackoverflow.com/tour\">tour</a> and reading through the <a href=\"https://stackoverflow.com/help\">help center</a> pages, in particular <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1498049773, "creation_date": 1498049773, "answer_id": 44676808, "question_id": 44676668, "link": "https://stackoverflow.com/questions/44676668/regular-expression-in-c-for-searching-string-pattern/44676808#44676808", "title": "Regular expression in c++ for searching string pattern", "body": "<p>Ditch the reg-ex. Write some code instead. Use something of the form</p>\n\n<pre><code>int main()\n{\n    std::map&lt;std::string, int&gt; m = {{\"one\", 1}, {\"two\", 2}, {\"three\", 3}};\n    std::string input;\n    std::cin &gt;&gt; input\n    std::cout &lt;&lt; m[input];\n}\n</code></pre>\n\n<p>Note the fancy initialisation: valid from C++11 onwards.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7539179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bd82a8bc49b0c76c7af5bcae656ac7?s=128&d=identicon&r=PG&f=1", "display_name": "Vishwas", "link": "https://stackoverflow.com/users/7539179/vishwas"}, "edited": false, "score": 0, "creation_date": 1498065179, "post_id": 44677367, "comment_id": 76348812, "body": "Thank you so much k-five. Appreciate your patience in giving detailed explanation."}, {"owner": {"reputation": 13460, "user_id": 4643584, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d2144be3b64be35ece8bff8f02c606a6?s=128&d=identicon&r=PG&f=1", "display_name": "Shakiba Moshiri", "link": "https://stackoverflow.com/users/4643584/shakiba-moshiri"}, "reply_to_user": {"reputation": 25, "user_id": 7539179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bd82a8bc49b0c76c7af5bcae656ac7?s=128&d=identicon&r=PG&f=1", "display_name": "Vishwas", "link": "https://stackoverflow.com/users/7539179/vishwas"}, "edited": false, "score": 1, "creation_date": 1498065405, "post_id": 44677367, "comment_id": 76348947, "body": "@vishwa Not a problem, please accept the answer if it satisfies you. thank you."}], "tags": [], "owner": {"reputation": 13460, "user_id": 4643584, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d2144be3b64be35ece8bff8f02c606a6?s=128&d=identicon&r=PG&f=1", "display_name": "Shakiba Moshiri", "link": "https://stackoverflow.com/users/4643584/shakiba-moshiri"}, "is_accepted": false, "score": 4, "last_activity_date": 1498052624, "last_edit_date": 1498052624, "creation_date": 1498051247, "answer_id": 44677367, "question_id": 44676668, "link": "https://stackoverflow.com/questions/44676668/regular-expression-in-c-for-searching-string-pattern/44677367#44677367", "title": "Regular expression in c++ for searching string pattern", "body": "<p>very easy:  </p>\n\n<pre><code>std::string s = \"one 1 two 2 three 3\";\n\nstd::regex rx( \"([a-z]+) (\\\\d+)\" );\nstd::match_results&lt; std::string::const_iterator &gt; mr;\n\nstd::regex_search( s, mr, rx );\nstd::cout &lt;&lt; mr.str( 1 ) &lt;&lt; '\\n';  // one\nstd::cout &lt;&lt; mr.str( 2 ) &lt;&lt; '\\n';  // 1  \n</code></pre>\n\n<p>and for the whole match:  </p>\n\n<pre><code>std::string temp = s;\nwhile( std::regex_search( temp, mr, rx ) ){\n    std::cout &lt;&lt; mr.str( 1 ) &lt;&lt; '\\n';\n    std::cout &lt;&lt; mr.str( 2 ) &lt;&lt; '\\n';\n    temp = mr.suffix().str();\n}  \n</code></pre>\n\n<p>the output:  </p>\n\n<pre><code>one\n1\ntwo\n2\nthree\n3\n</code></pre>\n\n<p>and eventually: </p>\n\n<pre><code>std::string ui; //user_input\n\nstd::string temp = s;\nwhile( std::regex_search( temp, mr, rx ) ){\n\n    std::getline( std::cin, ui );\n\n    if( ui == mr.str( 1 ) ){\n       std::cout &lt;&lt; mr.str( 2 ) &lt;&lt; '\\n';\n    }\n\n    temp = mr.suffix().str();\n}  \n</code></pre>\n\n<p>NOTE: this is not a perfect solution since <code>regex_search</code> match the items one by one. So you should enter <code>one</code> then <code>two</code> then <code>three</code>  </p>\n\n<p><strong>test</strong>  </p>\n\n<pre><code> ideas $  ./temp \none\n1\ntwo\n2\nthree\n3\n ideas $  \n</code></pre>\n\n<hr>\n\n<p>May as you want, but I put it just for learning to see how it works:  </p>\n\n<pre><code>std::string s = \"one 1 two 2 three 3\";\n\nstd::string ui; //user_input\nstd::getline( std::cin, ui );\n\nstd::string pt = \"(\" + ui + \")\" + \" \";\nstd::regex rx( pt + \"(\\\\d)\" );\nstd::match_results&lt; std::string::const_iterator &gt; mr;\n\nstd::regex_search( s, mr, rx );\nif( ui == mr.str( 1 ) ){\n   std::cout &lt;&lt; mr.str( 2 ) &lt;&lt; '\\n';\n}   \n</code></pre>\n\n<p><strong>test</strong>  </p>\n\n<pre><code> ideas $  ./temp\none\n1\n ideas $  ./temp\ntwo\n2\n ideas $  ./temp\nthree\n3\n ideas $  \n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7539179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bd82a8bc49b0c76c7af5bcae656ac7?s=128&d=identicon&r=PG&f=1", "display_name": "Vishwas", "link": "https://stackoverflow.com/users/7539179/vishwas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1485, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498069848, "creation_date": 1498049454, "last_edit_date": 1498069848, "question_id": 44676668, "link": "https://stackoverflow.com/questions/44676668/regular-expression-in-c-for-searching-string-pattern", "title": "Regular expression in c++ for searching string pattern", "body": "<p>I have a string like this:</p>\n\n<pre><code>string s =\"one 1 two 2 three 3\";\n</code></pre>\n\n<p>I want to write a regular expression such that when the user inputs \"one\" i should print 1, if the input given as \"two\"...any suggestions or help would greatly appreciated.</p>\n"}, {"tags": ["c++", "algorithm", "performance", "unit-testing", "time"], "comments": [{"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1498049777, "post_id": 44676535, "comment_id": 76337548, "body": "If I recall correctly, people working on compilers mentioned that single operations are &quot;unobservable&quot;, meaning that it won&#39;t be possible to actually measure it exactly when it ends. Though if the difference is big enough, it will be negligible. Probably looking at assembly will be good to check if the compiler did move some statements around."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1498050382, "post_id": 44676535, "comment_id": 76338083, "body": "@Incomputable: A unit test is likely not a single operation (assuming you are referring to a single CPU instruction). So while correct for some architectures, it doesn&#39;t apply here."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498050441, "post_id": 44676535, "comment_id": 76338122, "body": "@IInspectable, that&#39;s why I mentioned if the difference is big enough part. The difference between small datasets might not be that stable, this is what I meant."}, {"owner": {"reputation": 2089, "user_id": 7778713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QIG81.png?s=128&g=1", "display_name": "D.J. Klomp", "link": "https://stackoverflow.com/users/7778713/d-j-klomp"}, "reply_to_user": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1498083973, "post_id": 44676535, "comment_id": 76358471, "body": "@Incomputable: The unit test and algorithms are not single operations, I thought about looking at the assembly code, but the algorithms are to big for me to make sense of the assembly code."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 1, "creation_date": 1498084177, "post_id": 44676535, "comment_id": 76358543, "body": "@D.J.Klomp I probably exaggerated a problem. Just watch out for weird things. Static analysis of compilers do wonders these days. Also you might want to consider google benchmark library. C time() uses cpu time, whereas C++ chrono uses more or less real time. It might be worth considering which one is important."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1498050616, "creation_date": 1498050616, "answer_id": 44677133, "question_id": 44676535, "link": "https://stackoverflow.com/questions/44676535/reliability-of-algorithm-performance-testing-based-on-unit-framework/44677133#44677133", "title": "Reliability of algorithm performance testing based on unit framework", "body": "<p>First of, Boost is not needed for this task; there are numerous ways to do that with standard C++, I have some ways in <a href=\"https://gsamaras.wordpress.com/code/1651-2/\" rel=\"nofollow noreferrer\">Time measurements</a>, where <code>std::crhono</code> seems to do the trick.</p>\n\n<p>A DEM requires a number of points as input, so I would run my algorithm on different inputs, and then take the <em>average</em> execution time.</p>\n\n<p>I would the same thing for the other algorithm, but in a different program, since you do not know what the OS is doing under the hood. Moreover you want both algorithms to do a cold start regarding caching, and executing both algorithms in the same program may give a slight advantage for the second algorithm, in certain cases. </p>\n\n<p>So I would do something like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;ratio&gt;\n#include &lt;chrono&gt;\n\n#define UTN 10 // Unit tests number\n\nint main ()\n{\n  // populate `unitTest` vector\n  ...\n  using namespace std::chrono;\n\n  high_resolution_clock::time_point t1 = high_resolution_clock::now();\n\n  for(int i = 0; i &lt; UTN; ++i\n      unitTest[i](algorithm1);\n\n  high_resolution_clock::time_point t2 = high_resolution_clock::now();\n\n  duration&lt;double&gt; time_span = duration_cast&lt;duration&lt;double&gt;&gt;(t2 - t1);\n\n  std::cout &lt;&lt; \"It took me \" &lt;&lt; time_span.count()/UTN &lt;&lt; \" seconds.\";\n  std::cout &lt;&lt; std::endl;\n\n  return 0;\n}\n</code></pre>\n\n<p>Now I wrote down the reported time and then executed the above program again, but now with <code>algorithm2()</code> in place, measure the average time it took and compare.</p>\n"}], "owner": {"reputation": 2089, "user_id": 7778713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QIG81.png?s=128&g=1", "display_name": "D.J. Klomp", "link": "https://stackoverflow.com/users/7778713/d-j-klomp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 44677133, "answer_count": 1, "score": 1, "last_activity_date": 1498050632, "creation_date": 1498049092, "last_edit_date": 1498050632, "question_id": 44676535, "link": "https://stackoverflow.com/questions/44676535/reliability-of-algorithm-performance-testing-based-on-unit-framework", "title": "Reliability of algorithm performance testing based on unit framework", "body": "<p>For my PhD I am writing a DEM (Discrete Element Method) simulation in c++ describing particle flow which is computational intensive. I have a lot of different algorithms in place for the calculation of different parameters. The run time per algorithm can vary significantly based on the configuration of points (where the number of points stay the same). For testing, a good amount of unit tests are in place with different configurations and number of points.</p>\n\n<p>For optimization and performance testing it seems easiest to run the specific unit tests multiple times, under the assumption that the time required by the unit testing framework is constant I can compare different algorithm performances against each other. So in pseudo code I want to do this, where algorithm1 and algorithm2 are different implementations of a single algorithm and the different unitTests are different input configurations:</p>\n\n<pre><code>//Preformance test algorithm1\ntimer = 0;\nstartTimer();\nfor(n = 1000) {\n     unitTest1(algorithm1);\n     unitTest2(algorithm1);\n     .....\n }\n print(timer);\n\n//Performance test algorithm2\ntimer = 0;\nstartTimer();\nfor(n = 1000) {\n     unitTest1(algorithm2);\n     unitTest2(algorithm2);\n     .....\n }\n print(timer);\n</code></pre>\n\n<p><strong>Question:</strong> Is this a valid way to do performance testing that will yield reliable and comparable results or can the unit testing framework invalidate my results in some way? Also can this method be extended to test performance when the code is written for parallel processing.</p>\n\n<p>Additional information: The unit framework I am using is the Boost Test Library and due to long run times I cannot efficiently performance test the code as a whole with different configurations.</p>\n"}, {"tags": ["c++", "qt", "sockets", "qtcpsocket"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 2, "creation_date": 1498048765, "post_id": 44676364, "comment_id": 76336751, "body": "Profile your application and see where the bottleneck is."}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1498049310, "post_id": 44676364, "comment_id": 76337151, "body": "I&#39;m actually using a mini-project to test it so its pretty much just the client running. Profiling shows that the event loop takes a lot of the time, but can it be avoided?"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1498050416, "post_id": 44676364, "comment_id": 76338105, "body": "You are calling <code>socket-&gt;read(packetLength)</code> without knowing whether or not <code>packetLength</code> bytes are available.  If they aren&#39;t then the next read will be out of sync with the data stream."}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "edited": false, "score": 0, "creation_date": 1498050569, "post_id": 44676364, "comment_id": 76338242, "body": "Even if I check this using <code>if (socket-&gt;bytesAvailable() &gt;= packetLength){ b = socket-&gt;read(packetLength); }</code> it changes nothing"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1498051019, "post_id": 44676364, "comment_id": 76338572, "body": "When you say &quot;the event loop takes a lot of time&quot; can you tell us the specific function name?"}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "edited": false, "score": 0, "creation_date": 1498051286, "post_id": 44676364, "comment_id": 76338803, "body": "you can look at the profiling results for 30 seconds of reading here- <a href=\"http://imgur.com/a/8kjUV\" rel=\"nofollow noreferrer\">imgur.com/a/8kjUV</a>"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1498055584, "post_id": 44676364, "comment_id": 76342220, "body": "When you say &quot;the event loop takes a lot of time&quot; you realize that your read handler <i>is</i> part of the event loop?  To diagnose the problem any further you&#39;ll need to show more of your <code>handleReadyRead</code> implementation."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1498055991, "post_id": 44676364, "comment_id": 76342557, "body": "Note also that checking for <code>socket-&gt;bytesAvailable() &gt;= packetLength</code> before reading isn&#39;t sufficient.  If the test fails then the next <code>handleReadyRead</code> invocation will probably interpret the packet body as a new header."}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "edited": false, "score": 0, "creation_date": 1498112719, "post_id": 44676364, "comment_id": 76366629, "body": "This is all of the handler-  <code>QByteArray b = socket-&gt;read(12);     int packetLength = (unsigned char)b[6] &lt;&lt; CHAR_BIT;     packetLength |=  (unsigned char)b[7];     if (socket-&gt;bytesAvailable() &gt;= packetLength){         b = socket-&gt;read(packetLength);     }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "edited": false, "score": 0, "creation_date": 1498131722, "post_id": 44694974, "comment_id": 76379506, "body": "This really works, thank you. Now I just have find out why I&#39;m getting the packets in a wrong order...."}], "tags": [], "owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1498312018, "last_edit_date": 1498312018, "creation_date": 1498122415, "answer_id": 44694974, "question_id": 44676364, "link": "https://stackoverflow.com/questions/44676364/using-qtcpsocket-for-continuous-fast-usage/44694974#44694974", "title": "Using QTcpSocket for continuous fast usage", "body": "<p>Your current <code>handleReadyRead</code> assumes that a complete packet is available to read and that packet boundaries are preserved.  TCP doesn't work that way -- it's just a byte stream.</p>\n\n<p>A better approach might be to accumulate data into a <code>QByteArray</code> and read packets from that <code>QByteArray</code> as and when they become available.</p>\n\n<p>So, assuming your <code>client</code> class has a data member...</p>\n\n<pre><code>QByteArray m_data;\n</code></pre>\n\n<p>I would expect the logic to be something like...</p>\n\n<pre><code>void handleReadyRead ()\n{\n\n  /*\n   * Append all available data to m_data.\n   */\n  m_data.append(socket-&gt;readAll());\n\n  /*\n   * Now work our way through m_data processing complete\n   * packets as we find them.  At any given point offset\n   * is the total size of all complete packets (including\n   * headers) processed thus far.\n   */\n  int offset = 0;\n  while (m_data.length() &gt;= offset + 12) {\n\n    /*\n     * We have enough data for a header so read the packet length.\n     */\n    int packetLength  = (unsigned char)m_data[offset + 6] &lt;&lt; CHAR_BIT;\n    packetLength     |= (unsigned char)m_data[offset + 7];\n\n    /*\n     * Check to see if we have sufficient data for the packet\n     * body.  If not then we're done for the time being.\n     */\n    if (m_data.length() &lt; offset + 12 + packetLength)\n      break;\n\n    /*\n     * There is enough data for the complete packet so read it.\n     * Note that the following will include the header data in the\n     * packet variable.  If that's not desired then change it to...\n     *\n     *   auto packet = m_data.mid(offset + 12, packetLength);\n     */\n    auto packet = m_data.mid(offset, 12 + packetLength);\n\n    /*\n     * Do whatever you want with the packet.\n     */\n    do_something_with_the_packet(packet);\n\n    /*\n     * Update the offset according to the amount of data read.\n     */\n    offset += 12 + packetLength;\n  }\n\n  /*\n   * Finally, remove the data processed from the beginning of\n   * the QByteArray.\n   */\n  if (offset)\n    m_data = m_data.right(data.size() - offset);\n}\n</code></pre>\n\n<p>The above is untested but is certainly along the lines of code I've used in the past.</p>\n"}], "owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 44694974, "answer_count": 1, "score": 0, "last_activity_date": 1498312018, "creation_date": 1498048643, "last_edit_date": 1498050220, "question_id": 44676364, "link": "https://stackoverflow.com/questions/44676364/using-qtcpsocket-for-continuous-fast-usage", "title": "Using QTcpSocket for continuous fast usage", "body": "<p>I need to implement a client that reads data at 300 Hz (300 samples per second). When working with C sockets, everything was ok accept for the fact that I need to run a continuous while loop to get the data from the server (which blocks the client from handling anything else).\nSo, I've decided trying to move to QTcpsocket, in order to handle signals that are coming from other object to the client object. But when I connect the Qtcpsocket, and connect the signal for reading </p>\n\n<pre><code>connect(socket,&amp;QTcpSocket::readyRead, this, &amp;client::handleReadyRead, Qt::ConnectionType::QueuedConnection);\n</code></pre>\n\n<p>this is my handler - </p>\n\n<pre><code>QByteArray b = socket-&gt;read(12);\nint packetLength = (unsigned char)b[6] &lt;&lt; CHAR_BIT;\npacketLength |=  (unsigned char)b[7];\nb = socket-&gt;read(packetLength);\n</code></pre>\n\n<p>(I get a 12 byte long header for each packet)\nNow I get a very slow client - It handles about maybe 3 samples per second...I've checked to see how much <code>bytesavailable()</code> returns, and it looks like data is piling up in the sockets buffer.\nWhat am I doing wrong? I have to get a very fast client, but I'm not sure that the way I'm reading is optimal. \nIs there a more efficient way to do it?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "c++11", "memory-leaks", "shared-ptr"], "comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1498048310, "post_id": 44676051, "comment_id": 76336377, "body": "Did you mean to write <code>*sp = 10</code>? It would make more sense if you meant <code>sp=std::make_shared&lt;int&gt;(10);</code>."}, {"owner": {"reputation": 11, "user_id": 6315896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be010170f325d315e14aecd5e4c694e?s=128&d=identicon&r=PG&f=1", "display_name": "JD.gg", "link": "https://stackoverflow.com/users/6315896/jd-gg"}, "edited": false, "score": 0, "creation_date": 1498048683, "post_id": 44676051, "comment_id": 76336687, "body": "yea sorry forgot those lines"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 2, "creation_date": 1498049052, "post_id": 44676051, "comment_id": 76336970, "body": "Of course there&#39;s no leak, Since <code>sp2</code> is the sole owner of the int containing 400, it&#39;ll be destroyed before <code>sp2</code> takes shared ownership of the memory owned by <code>sp</code>."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1498049692, "post_id": 44676051, "comment_id": 76337473, "body": "The whole point of smart pointers is to prevent memory leaks."}], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1498049003, "creation_date": 1498049003, "answer_id": 44676505, "question_id": 44676051, "link": "https://stackoverflow.com/questions/44676051/reassign-a-shared-pointer-with-operator-causes-memory-leak/44676505#44676505", "title": "Reassign a shared pointer with operator = causes memory leak?", "body": "<p>After your edits, no there's no leaks. The memory allocated for the <code>int</code> with the value <code>400</code> will simply be deleted for you in the assignment.</p>\n"}], "owner": {"reputation": 11, "user_id": 6315896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be010170f325d315e14aecd5e4c694e?s=128&d=identicon&r=PG&f=1", "display_name": "JD.gg", "link": "https://stackoverflow.com/users/6315896/jd-gg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 44676505, "answer_count": 1, "score": -2, "last_activity_date": 1498049003, "creation_date": 1498047835, "last_edit_date": 1498048717, "question_id": 44676051, "link": "https://stackoverflow.com/questions/44676051/reassign-a-shared-pointer-with-operator-causes-memory-leak", "title": "Reassign a shared pointer with operator = causes memory leak?", "body": "<p>I have a basic question about shared pointers, in the next example code:</p>\n\n<pre><code>int main() {\n std::shared_ptr&lt;int&gt; sp;  // empty\n std::shared_ptr&lt;int&gt; sp2;\n sp.reset (new int);\n sp2.reset (new int);\n *sp=10;\n *sp2=400;\n  sp2=sp;\n\n std::shared_ptr&lt;int&gt; sp3;\n sp3=sp1;\n //what happens with the int of value 400?\n //more code\n}\n</code></pre>\n\n<p>what happens with the int of value 400? is this a memory leak? this is a basic example but if instead of int the pointers were pointing to a big class, then it would be problematic if there was a memory leak, and more if sp2 is reasigned more times.\nthanks!</p>\n"}, {"tags": ["c++", "g++"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 7, "creation_date": 1498046894, "post_id": 44675654, "comment_id": 76335288, "body": "Hm, isn&#39;t that obvious? 64-bit pads to 64-bit (8 byte, 2*8 in that case) alignment, 32-bit to 32-bit (4 byte, 3*4 in that case) alignment"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 6, "creation_date": 1498046967, "post_id": 44675654, "comment_id": 76335338, "body": "Why do you care? Let the compiler do its job."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1498047035, "post_id": 44675654, "comment_id": 76335383, "body": "You have alignment which might differ between 32/64."}, {"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1498047043, "post_id": 44675654, "comment_id": 76335390, "body": "@Ctx, AFAIK, the byte alignment/padding of the structure should correspond to the byte alignment of its strictest member i.e double in this case. &quot;double&quot; is 8 bytes both in 32 bit and 64 bit system."}, {"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1498047122, "post_id": 44675654, "comment_id": 76335448, "body": "@Bathsheba, I care because I want to understand why the compiler wants to do what it is doing."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1498047497, "post_id": 44675654, "comment_id": 76335733, "body": "@AbdusSalamKhazi But you do not have a double there, instead you have another structure (SimpleStructure). gcc obviously does not resolve that recursively. However, you are right that for most intel 32-bit processors it might be desirable to have double values aligned at 8-byte boundaries, there are usually compiler-specific ways to force that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1498047669, "post_id": 44675654, "comment_id": 76335874, "body": "<i>&quot;double&quot; is 8 bytes both in 32 bit and 64 bit system</i> Size and alignment are different things. It&#39;s perfectly OK for <code>double</code> to be 8 bytes long and 4 byte aligned <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment#Typical_alignment_of_C_structs_on_x86\" rel=\"nofollow noreferrer\">see</a>."}, {"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1498047742, "post_id": 44675654, "comment_id": 76335926, "body": "@Ctx, I tried replacing SimpleStructure with double and the difference still exist."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1498048012, "post_id": 44675654, "comment_id": 76336145, "body": "@AbdusSalamKhazi -malign-double probably does what you expect"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1498048261, "post_id": 44675654, "comment_id": 76336333, "body": "The answer is: because C++ does not guarantee the same alignment and padding between 32 and 64 bit architectures. And insofar as to why the alignment and padding has to be different, it&#39;s the same reason why water is wet and the sky is blue: because that&#39;s what it is. This is the compiler&#39;s worry to deal with. As far as the C++ code itself goes, it must be aware of the fact that it has no padding/alignment guarantees, and adjust its logic to accomodate that."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498049236, "post_id": 44675654, "comment_id": 76337093, "body": "Don&#39;t change your question after you have received an answer."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1498049860, "post_id": 44675654, "comment_id": 76337614, "body": "Read about padding: <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment#Data_structure_padding\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1498050133, "post_id": 44675654, "comment_id": 76337832, "body": "By accident or otherwise, please don&#39;t change your question into a different question, after you have received an answer that answers your question. I have rolled back your edits again."}], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "edited": false, "score": 0, "creation_date": 1498047989, "post_id": 44676039, "comment_id": 76336130, "body": "I am aware of everything the you wrote. My confusion arouse when I replaced struct SimpleStructure u with char ch[5] and got identical answers for 32 bit and 64 bit processes."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "edited": false, "score": 0, "creation_date": 1498050360, "post_id": 44676039, "comment_id": 76338059, "body": "@AbdusSalamKhazi Did you read the alignmeht link (and maybe more about alignment)? (You said you did, but apparently you have no idea of it)"}], "tags": [], "owner": {"reputation": 10089, "user_id": 294813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33c092532e11d12bd14f4fbe564560fb?s=128&d=identicon&r=PG", "display_name": "petersohn", "link": "https://stackoverflow.com/users/294813/petersohn"}, "is_accepted": false, "score": -1, "last_activity_date": 1498047794, "creation_date": 1498047794, "answer_id": 44676039, "question_id": 44675654, "link": "https://stackoverflow.com/questions/44675654/sizeof-behaving-differently-between-32-bit-and-64-bit-processes/44676039#44676039", "title": "sizeof() behaving differently between 32 bit and 64 bit processes", "body": "<p>First, the sizes of integer types can vary between architectures. There is a nice table here: <a href=\"http://en.cppreference.com/w/cpp/language/types\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/types</a></p>\n\n<p>Second, pointers have different sizes depending on architecture. 32 bit machines have 32 bit pointers, and 64 bit machines have 64 bit pointers. If you are interested in older architectures, 8 bit machines had 16 bit pointers, and 16 bit machines had 32 bit pointers, though they worked weirdly on the 8086.</p>\n\n<p>Finally, what's the case in your struct, is probably alignment. For efficiency reasons, varaibles are aligned to word boundaries, and word size may differ between architectures. See more information here: <a href=\"http://en.cppreference.com/w/cpp/language/object#Alignment\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/object#Alignment</a></p>\n"}, {"comments": [{"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "edited": false, "score": 0, "creation_date": 1498052152, "post_id": 44677016, "comment_id": 76339555, "body": "thanks, loved your answer.. tested it as well. Just wanted another clarification. The above explanation seems consistent with g++ compiler with an exception of <code>long double</code>. In case 32 bit process, g++ seems to align <code>long double</code> to a 4 word boundary which is consistent with 64 bit process ( 64 bit process aligns <code>long double</code> in a 2 word boundary)."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "edited": false, "score": 0, "creation_date": 1498052887, "post_id": 44677016, "comment_id": 76340126, "body": "@AbdusSalamKhazi 64 and 32-bit are different ABIs with different requirements. On x86 Linux in 32-bit mode, <code>sizeof(long double)</code> is 12 and <code>alignof(long double)</code> is 4, for 64-bit mode they are 16 and 16."}, {"owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "edited": false, "score": 0, "creation_date": 1498053527, "post_id": 44677016, "comment_id": 76340544, "body": "OK, I get it. It is the ABI specification that defines the sizeof()/alignof and compilers conform to it by it by default lest they should be used in cross binary communication. We can change it at the cost of making it non conformant with the ABI specification."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1498050318, "creation_date": 1498050318, "answer_id": 44677016, "question_id": 44675654, "link": "https://stackoverflow.com/questions/44675654/sizeof-behaving-differently-between-32-bit-and-64-bit-processes/44677016#44677016", "title": "sizeof() behaving differently between 32 bit and 64 bit processes", "body": "<p>On a 32-bit platform <code>alignof(double) == 4</code>. See <code>man gcc</code>:</p>\n\n<blockquote>\n<pre><code>  -malign-double\n  -mno-align-double\n       Control whether GCC aligns \"double\", \"long double\", and \"long long\"\n       variables on a two-word boundary or a one-word boundary.  Aligning\n       \"double\" variables on a two-word boundary produces code that runs\n       somewhat faster on a Pentium at the expense of more memory.\n       On x86-64, -malign-double is enabled by default.\n\n      Warning: if you use the -malign-double switch, structures\n       containing the above types are aligned differently than the\n       published application binary interface specifications for the\n       x86-32 and are not binary compatible with structures in code\n       compiled without that switch.\n</code></pre>\n</blockquote>\n\n<p>The size of a structure is a multiple of alignment of a member with the largest alignment requirement. Here, such a member is of type <code>double</code>, so <code>sizeof(struct Composite) == N * alignof(double)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1498052055, "post_id": 44677171, "comment_id": 76339474, "body": "There is no requirement on a C implementation to document its alignment requirements. However, if you consider <code>printf</code> family of functions, they all accept pointer arguments for <code>%n</code> conversion. Such a pointer must point to an object that is properly aligned, otherwise that would be UB. Hence, the compiler is not free to choose the alignment, no. It must adhere to the platform ABI."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1498490216, "post_id": 44677171, "comment_id": 76506921, "body": "@MaximEgorushkin Clarified the first sentence."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1498578175, "post_id": 44677171, "comment_id": 76549826, "body": "<i>Memory can be accessed in word-size chunks</i> does not make much sense in this age. You may like to consult &quot;&#167;2.5.5.1 Efficient Handling of Alignment Hazards&quot; in &quot;Intel 64 and IA-32 Architectures Optimization Reference Manual&quot;."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1498490159, "last_edit_date": 1498490159, "creation_date": 1498050722, "answer_id": 44677171, "question_id": 44675654, "link": "https://stackoverflow.com/questions/44675654/sizeof-behaving-differently-between-32-bit-and-64-bit-processes/44677171#44677171", "title": "sizeof() behaving differently between 32 bit and 64 bit processes", "body": "<p>As far as the C standard is concerned, the compiler is free to choose any alignment. The following is a description on how the compilers I have used implemented alignment.</p>\n\n<p>Often, the word size is chosen (32 bits on a 32 bit system, 64 bits on a 64 bit system) because it is usually an efficient choice in terms of tradeoff between memory usage and performance on the target platform. Usually the memory can be accessed in word-size chunks and the cpu instructions assumes that the data is aligned, so if the data is misaligned the cpu would need to access 2 chunks of memory and shift the data into alignment. This wastes valuable cpu cycles.</p>\n\n<p>Entities smaller than the word size are aligned by their size. Word-sized and larger entities are aligned on word boundaries.</p>\n\n<p>Structs members are aligned separately and then the entire struct is padded and aligned the same as its largest member.</p>\n\n<p>The default alignment can often be overriden with pragmas. Please refer to the documentation for your compiler for details. </p>\n\n<p>Example:</p>\n\n<pre><code>/* Override the default alignment and pack everything tight. */\n#pragma pack(1)\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 6286927, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-2wZb-DGd3jk/AAAAAAAAAAI/AAAAAAAAAE4/8DEgZnxLvZk/photo.jpg?sz=128", "display_name": "Abdus Khazi", "link": "https://stackoverflow.com/users/6286927/abdus-khazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 44677016, "answer_count": 3, "score": -2, "last_activity_date": 1498490159, "creation_date": 1498046775, "last_edit_date": 1498050079, "question_id": 44675654, "link": "https://stackoverflow.com/questions/44675654/sizeof-behaving-differently-between-32-bit-and-64-bit-processes", "title": "sizeof() behaving differently between 32 bit and 64 bit processes", "body": "<p>Consider the following program</p>\n\n<pre><code>#include&lt;iostream&gt;\n\nstruct SimpleStructure\n{\n    double obj;\n};\n\nstruct Composite\n{\n    struct SimpleStructure u;\n    char ch;\n};\n\nint main()\n{\n    using namespace std;\n\n    cout &lt;&lt; \"sizeof(double)                 : \" &lt;&lt; sizeof(double) &lt;&lt; endl;\n    cout &lt;&lt; \"sizeof(struct SimpleStructure) : \" &lt;&lt; sizeof(struct SimpleStructure) &lt;&lt; endl;\n    cout &lt;&lt; \"sizeof(struct Composite)       : \" &lt;&lt; sizeof(struct Composite) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>When I compile the above with <code>g++ -m64 &lt;filename&gt;.cpp</code>, I get the following output</p>\n\n<pre><code>sizeof(double)                 : 8\nsizeof(struct SimpleStructure) : 8\nsizeof(struct Composite)       : 16\n</code></pre>\n\n<p>But the same code when I compile using <code>g++ -m32 &lt;filename&gt;.cpp</code>, I get the following output</p>\n\n<pre><code>sizeof(double)                 : 8\nsizeof(struct SimpleStructure) : 8\nsizeof(struct Composite)       : 12\n</code></pre>\n\n<p>Why is there a difference in the padding in the structure in a 32 bit and 64 bit process?</p>\n"}, {"tags": ["c++", "matrix", "linear-algebra", "eigen", "eigen3"], "comments": [{"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 0, "creation_date": 1498049873, "post_id": 44675143, "comment_id": 76337627, "body": "The LU factorization alone can only extract an arbitrary basis of the null space. To get an orthonormal one you need some QR decomposition or SVD."}, {"owner": {"reputation": 21, "user_id": 8137281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/731c8f8c37f31e74ad5a26ac1e3ffc54?s=128&d=identicon&r=PG&f=1", "display_name": "jifeng", "link": "https://stackoverflow.com/users/8137281/jifeng"}, "reply_to_user": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1498050303, "post_id": 44675143, "comment_id": 76337980, "body": "@ggael  But I don&#39;t know how to use QR decomposition or SVD to  compute orthonormal basis for the null space..."}], "answers": [{"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 0, "last_activity_date": 1605627287, "creation_date": 1605627287, "answer_id": 64878324, "question_id": 44675143, "link": "https://stackoverflow.com/questions/44675143/c-eigencompute-the-orthonormal-basis-for-the-null-space/64878324#64878324", "title": "c++/eigen:compute the orthonormal basis for the null space", "body": "<p>You can get an orthonormal basis of the null space with <code>CompleteOrthogonalDecomposition</code>:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename Number&gt; // 'Number' can be 'double' or 'std::complex&lt;double&gt;'\nEigen::Matrix&lt;Number, Eigen::Dynamic, Eigen::Dynamic&gt; kernel_COD(\n    const Eigen::Matrix&lt;Number, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; M) {\n  Eigen::CompleteOrthogonalDecomposition&lt;\n      Eigen::Matrix&lt;Number, Eigen::Dynamic, Eigen::Dynamic&gt;&gt;\n      cod;\n  cod.compute(M);\n  unsigned rk = cod.rank();\n  Eigen::Matrix&lt;Number, Eigen::Dynamic, Eigen::Dynamic&gt; P =\n      cod.colsPermutation();\n  Eigen::Matrix&lt;Number, Eigen::Dynamic, Eigen::Dynamic&gt; V =\n      cod.matrixZ().transpose();\n  Eigen::Matrix&lt;Number, Eigen::Dynamic, Eigen::Dynamic&gt; Kernel =\n      P * V.block(0, rk, V.rows(), V.cols() - rk);\n  return Kernel;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8137281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/731c8f8c37f31e74ad5a26ac1e3ffc54?s=128&d=identicon&r=PG&f=1", "display_name": "jifeng", "link": "https://stackoverflow.com/users/8137281/jifeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1605627440, "creation_date": 1498045462, "last_edit_date": 1605627440, "question_id": 44675143, "link": "https://stackoverflow.com/questions/44675143/c-eigencompute-the-orthonormal-basis-for-the-null-space", "title": "c++/eigen:compute the orthonormal basis for the null space", "body": "<p>Matlab has a function:</p>\n\n<pre><code>Z = null(A);\n</code></pre>\n\n<p>This MATLAB function is an orthonormal basis for the null space of A obtained\n from the singular value decomposition.</p>\n\n<p>I have to convert the MATLAB code to C++ on eigen library,but I don't know how to do this.\nI have tried:</p>\n\n<pre><code>MatrixXf m = MatrixXf::Random(3,5);\ncout &lt;&lt; \"Here is the matrix m:\" &lt;&lt; endl &lt;&lt; m &lt;&lt; endl;\nMatrixXf ker = m.fullPivLu().kernel();\ncout &lt;&lt; \"Here is a matrix whose columns form a basis of the kernel of m:\"\n&lt;&lt; endl &lt;&lt; ker &lt;&lt; endl;\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Here is the matrix m:\n0.68   0.597   -0.33   0.108   -0.27\n-0.211   0.823   0.536 -0.0452  0.0268\n 0.566  -0.605  -0.444   0.258   0.904\nHere is a matrix whose columns form a basis of the kernel of m:\n-0.219   0.763\n0.00335  -0.447\n  0       1\n  1       0\n -0.145  -0.285\n</code></pre>\n\n<p>It's not the \"orthonormal\" basis for the null space.</p>\n"}, {"tags": ["c++", "qt", "qcoreapplication"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498051232, "post_id": 44675055, "comment_id": 76338749, "body": "Can you post the compiler error? Perhaps you needed <code>Q_COREAPP_STARTUP_FUNCTION(&amp;MyClass::registerMetaType)</code>"}, {"owner": {"reputation": 3190, "user_id": 1798015, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52308759088ab744fdca3fe619dde41d?s=128&d=identicon&r=PG", "display_name": "feedc0de", "link": "https://stackoverflow.com/users/1798015/feedc0de"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498051762, "post_id": 44675055, "comment_id": 76339205, "body": "There are compiling errors with and without the <code>&amp;</code>. See the update in my question."}], "answers": [{"tags": [], "owner": {"reputation": 475, "user_id": 542452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fa10a221b6c03584e0323c142e26daae?s=128&d=identicon&r=PG", "display_name": "Vincas Dargis", "link": "https://stackoverflow.com/users/542452/vincas-dargis"}, "is_accepted": false, "score": 1, "last_activity_date": 1520340858, "creation_date": 1520340858, "answer_id": 49131380, "question_id": 44675055, "link": "https://stackoverflow.com/questions/44675055/q-coreapp-startup-function-with-static-class-member-method/49131380#49131380", "title": "Q_COREAPP_STARTUP_FUNCTION with static class member method", "body": "<p>I have reported feature request for Qt to add support for member functions:\n<a href=\"https://bugreports.qt.io/browse/QTBUG-66902\" rel=\"nofollow noreferrer\">https://bugreports.qt.io/browse/QTBUG-66902</a></p>\n\n<p>Looks like issue is with <code>::</code> in static member function and usage of macros.</p>\n\n<p>Anyway, alternative solution to overcome \"polluting root namespace\" and duplicate symbols, is to use namespaces:</p>\n\n<pre><code>namespace { // no duplicate symbol across units\nnamespace detail { // avoid \"polluting\" global namespace of this .cpp file\n\n    void registerMetaTypes() {\n        qRegisterMetaType(MyClass*);\n    }\n\n    Q_COREAPP_STARTUP_FUNCTION(registerMetaTypes)\n} // namespace detail\n} // anonymous namespace\n</code></pre>\n"}], "owner": {"reputation": 3190, "user_id": 1798015, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52308759088ab744fdca3fe619dde41d?s=128&d=identicon&r=PG", "display_name": "feedc0de", "link": "https://stackoverflow.com/users/1798015/feedc0de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1520340858, "creation_date": 1498045147, "last_edit_date": 1498051808, "question_id": 44675055, "link": "https://stackoverflow.com/questions/44675055/q-coreapp-startup-function-with-static-class-member-method", "title": "Q_COREAPP_STARTUP_FUNCTION with static class member method", "body": "<p>I need to register my class using <code>qRegisterMetaType()</code> and wanted to use <a href=\"http://doc.qt.io/qt-5/qcoreapplication.html#Q_COREAPP_STARTUP_FUNCTION\" rel=\"nofollow noreferrer\">Q_COREAPP_STARTUP_FUNCTION</a>.</p>\n\n<p>I dont want to register it in <code>main()</code> because I need this in a (not statically linked) library.</p>\n\n<pre><code>void someUniqueMethodName()\n{\n    qRegisterMetaType(MyClass*);\n}\n\nQ_COREAPP_STARTUP_FUNCTION(someUniqueMethodName)\n</code></pre>\n\n<p>I have multiple cases for this and I dont want to pollute the root namespace. The compiler does not want multiple methods with the same name and I dont want to think about unique method names every time I am adding a new one.</p>\n\n<p>Hence the static member method in my classes!</p>\n\n<p>But this example does not compile:</p>\n\n<pre><code>class MyClass {\npublic:\n    // ...\n    static void registerMetaType();\n}\n</code></pre>\n\n<p>with the implemention in .cpp file:</p>\n\n<pre><code>MyClass::registerMetaType() {}\n\nQ_COREAPP_STARTUP_FUNCTION(MyClass::registerMetaType)\n</code></pre>\n\n<p>Why can't I use static member methods and if this isn't the correct way to solve this, what would be a better one?</p>\n\n<p><strong>UPDATE</strong>\nCompiler error messages:</p>\n\n<pre><code>/path/to/myclass.cpp:183:1: error: no \u2018void MyClass::registerMetaType_ctor_function()\u2019 member function declared in class \u2018MyClass\u2019\n Q_COREAPP_STARTUP_FUNCTION(MyClass::registerMetaType)\n ^\nIn file included from /path/to/qt5-5.6.0/include/QtCore/QtGlobal:1:0,\n                 from /path/to/myclass.h:18,\n                 from /path/to/myclass.cpp:15:\n/path/to/myclass.cpp:183:1: error: qualified name does not name a class before \u2018{\u2019 token\n Q_COREAPP_STARTUP_FUNCTION(MyClass::registerMetaType)\n ^\n/path/to/myclass.cpp:183:1: error: invalid type in declaration before \u2018;\u2019 token\n Q_COREAPP_STARTUP_FUNCTION(MyClass::registerMetaType)\n ^\n/path/to/myclass.cpp:183:1: error: definition of \u2018MyClass::registerMetaType_ctor_function_ctor_instance_\u2019 is not in namespace enclosing \u2018MyClass\u2019 [-fpermissive]\n/path/to/myclass.cpp:183:1: error: \u2018static\u2019 may not be used when defining (as opposed to declaring) a static data member [-fpermissive]\n/path/to/myclass.cpp:183:1: error: \u2018const int MyClass::registerMetaType_ctor_function_ctor_instance_\u2019 is not a static member of \u2018class MyClass\u2019\n/path/to/myclass.cpp:183:28: error: uninitialized const \u2018MyClass::registerMetaType_ctor_function_ctor_instance_\u2019 [-fpermissive]\n Q_COREAPP_STARTUP_FUNCTION(MyClass::registerMetaType)\n</code></pre>\n"}, {"tags": ["c++", "amazon-web-services", "amazon-ec2", "aws-sdk"], "comments": [{"owner": {"reputation": 2476, "user_id": 38210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gteee.jpg?s=128&g=1", "display_name": "Colwin", "link": "https://stackoverflow.com/users/38210/colwin"}, "edited": false, "score": 0, "creation_date": 1498044946, "post_id": 44674885, "comment_id": 76333821, "body": "Can you please post the error you are seeing and what command you are running?"}, {"owner": {"reputation": 2476, "user_id": 38210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gteee.jpg?s=128&g=1", "display_name": "Colwin", "link": "https://stackoverflow.com/users/38210/colwin"}, "edited": false, "score": 0, "creation_date": 1498047673, "post_id": 44674885, "comment_id": 76335878, "body": "Can you please edit your question and add then required command there?"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1498089367, "post_id": 44674885, "comment_id": 76359954, "body": "Does the machine where this code is running have Internet access?  <code>Unable to connect to endpoint</code> sounds like maybe not."}, {"owner": {"reputation": 7598, "user_id": 734691, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/QywkD.jpg?s=128&g=1", "display_name": "Jonathan Henson", "link": "https://stackoverflow.com/users/734691/jonathan-henson"}, "edited": false, "score": 0, "creation_date": 1498107425, "post_id": 44674885, "comment_id": 76364307, "body": "could also be tls related, could you upload a trace level log?"}, {"owner": {"reputation": 141, "user_id": 8193859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f07d46d9dbea98407b88a06df2bc9f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/8193859/sandeep"}, "edited": false, "score": 0, "creation_date": 1498545141, "post_id": 44674885, "comment_id": 76527603, "body": "If there is internet connection problem ,it won&#39;t work with AWS CLI ,but its working"}], "owner": {"reputation": 141, "user_id": 8193859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f07d46d9dbea98407b88a06df2bc9f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/8193859/sandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498548708, "creation_date": 1498044680, "last_edit_date": 1498548708, "question_id": 44674885, "link": "https://stackoverflow.com/questions/44674885/unable-to-create-aws-t2-micro-instance-with-c-sdk", "title": "Unable to create Aws t2 micro instance with C++ SDK", "body": "<p>I am new to AWS. I compiled AWS sdk and below program for creating instance. I am able to create instance through aws CLI using <strong>aws ec2 run-instances --image-id ami-xxxxxx --count 1 --instance-type t2.micro  --security-group-ids sg-abcdefg --key-name Keypair</strong> ,but I am unable to create the instance with below program:</p>\n\n<pre><code>    void StartInstance(const Aws::String&amp; instanceName, const Aws::String&amp; ami_id)\n    {\n        Aws::EC2::EC2Client ec2;\n\n        Aws::EC2::Model::RunInstancesRequest run_request;\n        run_request.SetImageId(ami_id);\n        run_request.SetInstanceType(Aws::EC2::Model::InstanceType::t2_micro);\n        run_request.SetMinCount(1);\n        run_request.SetMaxCount(1);\n\n        auto run_outcome = ec2.RunInstances(run_request);\n        if (!run_outcome.IsSuccess()) {\n            std::cout &lt;&lt; \"Failed to start ec2 instance \" &lt;&lt; instanceName &lt;&lt;\n                \" based on ami \" &lt;&lt; ami_id &lt;&lt; \":\" &lt;&lt;\n                run_outcome.GetError().GetMessage() &lt;&lt; std::endl;\n            return;\n        }\n\n        const auto&amp; instances = run_outcome.GetResult().GetInstances();\n        if (instances.size() == 0) {\n            std::cout &lt;&lt; \"Failed to start ec2 instance \" &lt;&lt; instanceName &lt;&lt;\n                \" based on ami \" &lt;&lt; ami_id &lt;&lt; \":\" &lt;&lt;\n                run_outcome.GetError().GetMessage() &lt;&lt; std::endl;\n            return;\n        }\n\n        auto instance_id = instances[0].GetInstanceId();\n        Aws::EC2::Model::Tag name_tag;\n        name_tag.SetKey(\"Name\");\n        name_tag.SetValue(instanceName);\n\n        Aws::EC2::Model::CreateTagsRequest create_request;\n        create_request.AddResources(instance_id);\n        create_request.AddTags(name_tag);\n\n        auto create_outcome = ec2.CreateTags(create_request);\n        if (!create_outcome.IsSuccess()) {\n            std::cout &lt;&lt; \"Failed to tag ec2 instance \" &lt;&lt; instance_id &lt;&lt;\n                \" with name \" &lt;&lt; instanceName &lt;&lt; \":\" &lt;&lt;\n                create_outcome.GetError().GetMessage() &lt;&lt; std::endl;\n            return;\n        }\n\n    std::cout &lt;&lt; \"Successfully started ec2 instance \" &lt;&lt; instanceName &lt;&lt;\n        \" based on ami \" &lt;&lt; ami_id &lt;&lt; std::endl;\n}\n\n/**\n * Creates an ec2 instance based on command line input\n */\nint main(int argc, char** argv)\n{\n    if (argc != 3) {\n        std::cout &lt;&lt; \"Usage: ec2_create_instance &lt;instance_name&gt; &lt;ami_image_id&gt;\"\n            &lt;&lt; std::endl;\n        return 1;\n    }\n\n    Aws::String instanceName = argv[1];\n    Aws::String ami_id = argv[2];\n    Aws::SDKOptions options;\n    Aws::InitAPI(options);\n    StartInstance(instanceName, ami_id);\n    Aws::ShutdownAPI(options);\n    return 0;\n}\n</code></pre>\n\n<p>**./create_instance t2_instance1 ami-xxxxxxx **\nThe error I am getting is\n** Failed to start ec2 instance t2_instance based on ami ami-xxxxxx:Unable to connect to endpoint **</p>\n\n<p>strace log: </p>\n\n<pre><code>`restart_syscall(&lt;... resuming interrupted futex ...&gt;) = -1 ETIMEDOUT (Connection timed out)\nfutex(0xd88d50, FUTEX_WAKE_PRIVATE, 1)  = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = 4\nfcntl(4, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(4, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\nconnect(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, 16) = -1 EINPROGRESS (Operation now in progress)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 1)    = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 198)  = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 1)    = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 799)  = 1 ([{fd=4, revents=POLLOUT}])\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 1 ([{fd=4, revents=POLLOUT|POLLWRNORM}])\ngetsockopt(4, SOL_SOCKET, SO_ERROR, [0], [4]) = 0\ngetpeername(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, [16]) = 0\ngetsockname(4, {sa_family=AF_INET, sin_port=htons(53934), sin_addr=inet_addr(\"192.168.22.37\")}, [16]) = 0\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nopen(\"/usr/lib/x86_64-linux-gnu/nss/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nreadlink(\"/usr/lib/x86_64-linux-gnu/libnss3.so\", 0xe1dc70, 1023) = -1 EINVAL (Invalid argument)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 7\nfcntl(7, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(7, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\ngetpeername(7, 0x7ffc9c1b89a0, 0x7ffc9c1b8974) = -1 ENOTCONN (Transport endpoint is not connected)\nstat(\"/etc/ssl/certs/ca-certificates.crt\", {st_mode=S_IFREG|0644, st_size=274340, ...}) = 0\nclose(7)                                = 0\nclose(4)                                = 0\nfutex(0xd88d7c, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 15, {1498547921, 241359171}, ffffffff) = -1 ETIMEDOUT (Connection timed out)\nfutex(0xd88d50, FUTEX_WAKE_PRIVATE, 1)  = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = 4\nfcntl(4, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(4, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\nconnect(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, 16) = -1 EINPROGRESS (Operation now in progress)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 1)    = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 198)  = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 1)    = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 800)  = 1 ([{fd=4, revents=POLLOUT}])\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 1 ([{fd=4, revents=POLLOUT|POLLWRNORM}])\ngetsockopt(4, SOL_SOCKET, SO_ERROR, [0], [4]) = 0\ngetpeername(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, [16]) = 0\ngetsockname(4, {sa_family=AF_INET, sin_port=htons(53936), sin_addr=inet_addr(\"192.168.22.37\")}, [16]) = 0\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nopen(\"/usr/lib/x86_64-linux-gnu/nss/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nreadlink(\"/usr/lib/x86_64-linux-gnu/libnss3.so\", 0xe1e090, 1023) = -1 EINVAL (Invalid argument)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 7\nfcntl(7, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(7, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\ngetpeername(7, 0x7ffc9c1b89a0, 0x7ffc9c1b8974) = -1 ENOTCONN (Transport endpoint is not connected)\nstat(\"/etc/ssl/certs/ca-certificates.crt\", {st_mode=S_IFREG|0644, st_size=274340, ...}) = 0\nclose(7)                                = 0\nclose(4)                                = 0\nfutex(0xd88d7c, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 17, {1498547927, 890392565}, ffffffff) = -1 ETIMEDOUT (Connection timed out)\nfutex(0xd88d50, FUTEX_WAKE_PRIVATE, 1)  = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = 4\nfcntl(4, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(4, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\nconnect(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, 16) = -1 EINPROGRESS (Operation now in progress)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 1)    = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 199)  = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 799)  = 1 ([{fd=4, revents=POLLOUT}])\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 1 ([{fd=4, revents=POLLOUT|POLLWRNORM}])\ngetsockopt(4, SOL_SOCKET, SO_ERROR, [0], [4]) = 0\ngetpeername(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, [16]) = 0\ngetsockname(4, {sa_family=AF_INET, sin_port=htons(53938), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, [16]) = 0\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nopen(\"/usr/lib/x86_64-linux-gnu/nss/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nreadlink(\"/usr/lib/x86_64-linux-gnu/libnss3.so\", 0xe1e350, 1023) = -1 EINVAL (Invalid argument)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 7\nfcntl(7, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(7, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\ngetpeername(7, 0x7ffc9c1b89a0, 0x7ffc9c1b8974) = -1 ENOTCONN (Transport endpoint is not connected)\nstat(\"/etc/ssl/certs/ca-certificates.crt\", {st_mode=S_IFREG|0644, st_size=274340, ...}) = 0\nclose(7)                                = 0\nclose(4)                                = 0\nfutex(0xd88d7c, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 19, {1498547940, 897383152}, ffffffff) = -1 ETIMEDOUT (Connection timed out)\nfutex(0xd88d50, FUTEX_WAKE_PRIVATE, 1)  = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = 4\nfcntl(4, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(4, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\nconnect(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, 16) = -1 EINPROGRESS (Operation now in progress)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 1)    = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 199)  = 0 (Timeout)\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 0 (Timeout)\npoll([{fd=4, events=POLLOUT}], 1, 799)  = 1 ([{fd=4, revents=POLLOUT}])\npoll([{fd=4, events=POLLOUT|POLLWRNORM}], 1, 0) = 1 ([{fd=4, revents=POLLOUT|POLLWRNORM}])\ngetsockopt(4, SOL_SOCKET, SO_ERROR, [0], [4]) = 0\ngetpeername(4, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(\"xx.xx.xx.xx\")}, [16]) = 0\ngetsockname(4, {sa_family=AF_INET, sin_port=htons(53940), sin_addr=inet_addr(\"192.168.22.37\")}, [16]) = 0\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nopen(\"/usr/lib/x86_64-linux-gnu/nss/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nreadlink(\"/usr/lib/x86_64-linux-gnu/libnss3.so\", 0xe1ea20, 1023) = -1 EINVAL (Invalid argument)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-ec2/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/home/gaian/aws-sdk-cpp/build/aws-cpp-sdk-core/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 7\nfstat(7, {st_mode=S_IFREG|0644, st_size=52699, ...}) = 0\nmmap(NULL, 52699, PROT_READ, MAP_PRIVATE, 7, 0) = 0x7fe6219cd000\nclose(7)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/x86_64-linux-gnu/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/usr/lib/libnsspem.so\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nmunmap(0x7fe6219cd000, 52699)           = 0\nsocket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 7\nfcntl(7, F_GETFL)                       = 0x2 (flags O_RDWR)\nfcntl(7, F_SETFL, O_RDWR|O_NONBLOCK)    = 0\ngetpeername(7, 0x7ffc9c1b89a0, 0x7ffc9c1b8974) = -1 ENOTCONN (Transport endpoint is not connected)\nstat(\"/etc/ssl/certs/ca-certificates.crt\", {st_mode=S_IFREG|0644, st_size=274340, ...}) = 0\nclose(7)                                = 0\nclose(4)                                = 0\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0\nwrite(1, \"Failed to start ec2 instance t2_\"..., 97Failed to start ec2 instance t2_instance based on ami ami-848405e7:Unable to connect to endpoint\n) = 97\nfstat(5, {st_mode=S_IFREG|0644, st_size=9216, ...}) = 0\nstat(\"/etc/pki/nssdb/cert9.db\", {st_mode=S_IFREG|0644, st_size=9216, ...}) = 0\nclose(5)                                = 0\nfstat(6, {st_mode=S_IFREG|0644, st_size=11264, ...}) = 0\nstat(\"/etc/pki/nssdb/key4.db\", {st_mode=S_IFREG|0644, st_size=11264, ...}) = 0\nclose(6)                                = 0\nbrk(0xe42000)                           = 0xe42000\nbrk(0xe3f000)                           = 0xe3f000\nmunmap(0x7fe613b37000, 2647864)         = 0\nmunmap(0x7fe613dbe000, 2366064)         = 0\nbrk(0xe3e000)                           = 0xe3e000\nbrk(0xe3d000)                           = 0xe3d000\nclose(3)                                = 0\nexit_group(0)                           = ?\n+++ exited with 0 +++\n`\n</code></pre>\n"}, {"tags": ["c++", "string", "visual-studio", "new-operator"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 10, "creation_date": 1498044866, "post_id": 44674800, "comment_id": 76333753, "body": "Why are you using <code>std::allocator</code> and placement <code>new</code>? What is the use-case for it? What is the actual problem you try to solve with it? Why can&#39;t you use ordinary <code>new[]</code>? Why can&#39;t you use <code>std::vector</code> instead? Your question is a good example of <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">the XY problem</a>, where you ask for help with a solution to an (for us) unknown problem."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498046197, "post_id": 44674800, "comment_id": 76334758, "body": "Isn&#39;t your <code>T[N]</code> non-standard C++? (since <code>N</code> is not a compile-time constant). Btw, also works using clang compiler under OSX"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498046401, "post_id": 44674800, "comment_id": 76334918, "body": "@Walter You can use variables when using <code>new[]</code>."}, {"owner": {"reputation": 13, "user_id": 2298972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87d3fde682acdee0d39dc183073da6a?s=128&d=identicon&r=PG", "display_name": "UlfW", "link": "https://stackoverflow.com/users/2298972/ulfw"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498049355, "post_id": 44674800, "comment_id": 76337188, "body": "@Some programmer dude: The original code was tangled in thousands of lines of recursive templates."}, {"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 0, "creation_date": 1498219089, "post_id": 44674800, "comment_id": 76423825, "body": "@UlfW don&#39;t forget to accept an answer if it sufficiently answers your question :P"}], "answers": [{"comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498046697, "post_id": 44675549, "comment_id": 76335115, "body": "The <code>construct</code> function will become deprecated in the C++17 standard."}, {"owner": {"reputation": 13, "user_id": 2298972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87d3fde682acdee0d39dc183073da6a?s=128&d=identicon&r=PG", "display_name": "UlfW", "link": "https://stackoverflow.com/users/2298972/ulfw"}, "edited": false, "score": 0, "creation_date": 1498118275, "post_id": 44675549, "comment_id": 76370014, "body": "Using construct instead of new gives me the same crash (i.e. initializing with the default constructor, then assign values to the strings using <code>operator=</code>)."}, {"owner": {"reputation": 13, "user_id": 2298972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87d3fde682acdee0d39dc183073da6a?s=128&d=identicon&r=PG", "display_name": "UlfW", "link": "https://stackoverflow.com/users/2298972/ulfw"}, "edited": false, "score": 0, "creation_date": 1498119641, "post_id": 44675549, "comment_id": 76370979, "body": "My bad. Using construct seems to work (both Visual C and gcc/linux). I am still not sure what is incorrect about using <code>new(...)T[]</code>."}, {"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "reply_to_user": {"reputation": 13, "user_id": 2298972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87d3fde682acdee0d39dc183073da6a?s=128&d=identicon&r=PG", "display_name": "UlfW", "link": "https://stackoverflow.com/users/2298972/ulfw"}, "edited": false, "score": 0, "creation_date": 1498123920, "post_id": 44675549, "comment_id": 76374092, "body": "@UlfW see <a href=\"https://stackoverflow.com/questions/8720425/array-placement-new-requires-unspecified-overhead-in-the-buffer\" title=\"array placement new requires unspecified overhead in the buffer\">stackoverflow.com/questions/8720425/&hellip;</a> the length is prepended. So <code>data = new(data)T[N]();</code> works, if you allocate more than N elements (unspecified overhead)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "is_accepted": false, "score": 0, "last_activity_date": 1498046497, "creation_date": 1498046497, "answer_id": 44675549, "question_id": 44674800, "link": "https://stackoverflow.com/questions/44674800/crash-when-initializing-a-stdstring-array-in-visual-studio-c/44675549#44675549", "title": "Crash when initializing a std::string array in Visual Studio C++", "body": "<p>Aren't you supposed to use construct?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct S {\n  int a,b;\n  S() : a(99), b(299) {}\n  S &amp; operator=(const char * rhs) { a = 100; b = 300; return *this; }\n};\nstd::ostream &amp; operator&lt;&lt;(std::ostream &amp; os, const S &amp; s) { os &lt;&lt; \"(\" &lt;&lt; s.a &lt;&lt; \",\" &lt;&lt; s.b &lt;&lt; \")\"; return os; }\n\n\ntypedef std::string T;\n//typedef S T;\nint main(int argc, char ** argv) {\n    size_t N = 100;\n    std::allocator&lt;T&gt; mem;\n    T * data = mem.allocate(N);\n    //new(data)T[N]();\n\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        mem.construct(data + i, \"HELLO WORLD\");\n        //data[i] = \"HELLO WORLD\";\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        std::cout &lt;&lt; data[i] &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1498054270, "post_id": 44678519, "comment_id": 76341130, "body": "Hmm, this seems to be more of a code review than an answer.  But I hope it provides some insight, anyway.  What does Valgrind say on the failing platforms?  That should help diagnose any memory errors."}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": true, "score": 0, "last_activity_date": 1498054203, "last_edit_date": 1592644375, "creation_date": 1498054203, "answer_id": 44678519, "question_id": 44674800, "link": "https://stackoverflow.com/questions/44674800/crash-when-initializing-a-stdstring-array-in-visual-studio-c/44678519#44678519", "title": "Crash when initializing a std::string array in Visual Studio C++", "body": "<p>The claim that it &quot;works&quot; with GCC is something of an exaggeration:</p>\n<pre class=\"lang-none prettyprint-override\"><code>g++ -std=c++17 -fPIC -g -Wall -Wextra -Wwrite-strings -Wno-parentheses -Wpedantic -Warray-bounds -Weffc++      16486983.cpp    -o 16486983\n16486983.cpp: In member function \u2018S&amp; S::operator=(const char*)\u2019:\n16486983.cpp:7:30: warning: unused parameter \u2018rhs\u2019 [-Wunused-parameter]\n   S &amp; operator=(const char * rhs) { a = 100; b = 300; return *this; }\n                              ^~~\n16486983.cpp: In function \u2018int main(int, char**)\u2019:\n16486983.cpp:20:10: error: \u2018ptrdiff_t\u2019 was not declared in this scope\n     for (ptrdiff_t i = 0; i &lt; N; ++i)\n          ^~~~~~~~~\n16486983.cpp:20:10: note: suggested alternatives:\nIn file included from /usr/include/c++/6/iostream:38:0,\n                 from 16486983.cpp:1:\n/usr/include/x86_64-linux-gnu/c++/6/bits/c++config.h:202:28: note:   \u2018std::ptrdiff_t\u2019\n   typedef __PTRDIFF_TYPE__ ptrdiff_t;\n                            ^~~~~~~~~\n/usr/include/x86_64-linux-gnu/c++/6/bits/c++config.h:202:28: note:   \u2018std::ptrdiff_t\u2019\n16486983.cpp:20:27: error: \u2018i\u2019 was not declared in this scope\n     for (ptrdiff_t i = 0; i &lt; N; ++i)\n                           ^\n16486983.cpp:22:10: error: \u2018ptrdiff_t\u2019 was not declared in this scope\n     for (ptrdiff_t i = 0; i &lt; N; ++i)\n          ^~~~~~~~~\n16486983.cpp:22:10: note: suggested alternatives:\nIn file included from /usr/include/c++/6/iostream:38:0,\n                 from 16486983.cpp:1:\n/usr/include/x86_64-linux-gnu/c++/6/bits/c++config.h:202:28: note:   \u2018std::ptrdiff_t\u2019\n   typedef __PTRDIFF_TYPE__ ptrdiff_t;\n                            ^~~~~~~~~\n/usr/include/x86_64-linux-gnu/c++/6/bits/c++config.h:202:28: note:   \u2018std::ptrdiff_t\u2019\n16486983.cpp:22:27: error: \u2018i\u2019 was not declared in this scope\n     for (ptrdiff_t i = 0; i &lt; N; ++i)\n                           ^\n16486983.cpp:14:14: warning: unused parameter \u2018argc\u2019 [-Wunused-parameter]\n int main(int argc, char ** argv) {\n              ^~~~\n16486983.cpp:14:28: warning: unused parameter \u2018argv\u2019 [-Wunused-parameter]\n int main(int argc, char ** argv) {\n                            ^~~~\n</code></pre>\n<p>These need to be fixed; thankfully that's not hard:</p>\n<pre><code>#include &lt;cstddef&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct S {\n  int a,b;\n  S() : a(99), b(299) {}\n  S &amp; operator=(const char*) { a = 100; b = 300; return *this; }\n};\nstd::ostream &amp; operator&lt;&lt;(std::ostream &amp; os, const S &amp; s) { os &lt;&lt; &quot;(&quot; &lt;&lt; s.a &lt;&lt; &quot;,&quot; &lt;&lt; s.b &lt;&lt; &quot;)&quot;; return os; }\n\n\n//typedef std::string T;\ntypedef S T;\nint main() {\n    std::size_t N = 100;\n    std::allocator&lt;T&gt; mem;\n    T * data = mem.allocate(N);\n    new(data)T[N]();\n\n    for (std::size_t i = 0; i &lt; N; ++i)\n        data[i] = &quot;HELLO WORLD&quot;;\n    for (std::size_t i = 0; i &lt; N; ++i)\n        std::cout &lt;&lt; data[i] &lt;&lt; std::endl;\n}\n</code></pre>\n<p>Now it runs, almost\u00b9 Valgrind-clean.  But the naked placement-new looks strange - if you're using an allocator, you should use its <code>construct()</code>:</p>\n<pre><code>for (std::size_t i = 0; i &lt; N; ++i)\n    mem.construct(data+i);\n</code></pre>\n<hr />\n<h3>\u00b9Don't forget to release the memory:</h3>\n<pre><code>for (std::size_t i = 0; i &lt; N; ++i)\n    mem.destroy(data+i);\nmem.deallocate(data, N);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1498125381, "last_edit_date": 1498125381, "creation_date": 1498124120, "answer_id": 44695595, "question_id": 44674800, "link": "https://stackoverflow.com/questions/44674800/crash-when-initializing-a-stdstring-array-in-visual-studio-c/44695595#44695595", "title": "Crash when initializing a std::string array in Visual Studio C++", "body": "<p>The issue is with the unspecified overhead as described here very well: <a href=\"https://stackoverflow.com/questions/8720425/array-placement-new-requires-unspecified-overhead-in-the-buffer\">Array placement-new requires unspecified overhead in the buffer?</a></p>\n\n<p>A quick fix would be </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct S {\n  int a,b;\n  S() : a(99), b(299) {}\n  S &amp; operator=(const char * rhs) { a = 100; b = 300; return *this; }  \n};\nstd::ostream &amp; operator&lt;&lt;(std::ostream &amp; os, const S &amp; s) { os &lt;&lt; \"(\" &lt;&lt; s.a &lt;&lt; \",\" &lt;&lt; s.b &lt;&lt; \")\"; return os; }  \n\n\ntypedef std::string T;\n//typedef S T;\nint main(int argc, char ** argv) {\n    size_t N = 100;\n    std::allocator&lt;T&gt; mem;\n    T * datastor = mem.allocate(N+1);\n    T * data = new(datastor)T[N]();\n\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        data[i] = \"HELLO WORLD\";\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        std::cout &lt;&lt; data[i] &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>But this is not guaranteed to work always since the \"unspecified overhead\" might theoretically be larger than <code>sizeof(std::string)</code>.</p>\n\n<p>The version without unspecified behavior would new up the elements individually like so:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct S {\n  int a,b;\n  S() : a(99), b(299) {}\n  S &amp; operator=(const char * rhs) { a = 100; b = 300; return *this; }  \n};\nstd::ostream &amp; operator&lt;&lt;(std::ostream &amp; os, const S &amp; s) { os &lt;&lt; \"(\" &lt;&lt; s.a &lt;&lt; \",\" &lt;&lt; s.b &lt;&lt; \")\"; return os; }  \n\n\ntypedef std::string T;\n//typedef S T;\nint main(int argc, char ** argv) {\n    size_t N = 100;\n    std::allocator&lt;T&gt; mem;\n    T * data = mem.allocate(N);\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        new(&amp;data[i]) T();\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        data[i] = \"HELLO WORLD\";\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        std::cout &lt;&lt; data[i] &lt;&lt; std::endl;\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        data[i].~T();\n    mem.deallocate(data, N);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2298972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87d3fde682acdee0d39dc183073da6a?s=128&d=identicon&r=PG", "display_name": "UlfW", "link": "https://stackoverflow.com/users/2298972/ulfw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 44678519, "answer_count": 3, "score": 0, "last_activity_date": 1498208319, "creation_date": 1498044381, "last_edit_date": 1498208319, "question_id": 44674800, "link": "https://stackoverflow.com/questions/44674800/crash-when-initializing-a-stdstring-array-in-visual-studio-c", "title": "Crash when initializing a std::string array in Visual Studio C++", "body": "<p>The problem: I am trying to allocate memory for an array of <code>std::string</code>, then using <code>new(...)[]()</code> to initialize it. Then I try to assign values to the array elements and this causes the application to crash (Access violation). Question is: Am I missing some compiler flag or something obvious?</p>\n\n<p>Compiling this with </p>\n\n<pre><code>cl.exe /DEBUG /EHsc /MTd /Zi test.cc\n</code></pre>\n\n<p>produces an executable that crashes (tested in VS 2017 and VS 2012). On a side note it works as expected on Linux with GCC.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct S {\n  int a,b;\n  S() : a(99), b(299) {}\n  S &amp; operator=(const char * rhs) { a = 100; b = 300; return *this; }  \n};\nstd::ostream &amp; operator&lt;&lt;(std::ostream &amp; os, const S &amp; s) { os &lt;&lt; \"(\" &lt;&lt; s.a &lt;&lt; \",\" &lt;&lt; s.b &lt;&lt; \")\"; return os; }  \n\n\ntypedef std::string T;\n//typedef S T;\nint main(int argc, char ** argv) {\n    size_t N = 100;\n    std::allocator&lt;T&gt; mem;\n    T * data = mem.allocate(N);\n    new(data)T[N]();\n\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        data[i] = \"HELLO WORLD\";\n    for (ptrdiff_t i = 0; i &lt; N; ++i)\n        std::cout &lt;&lt; data[i] &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I tried using the other <code>typedef</code>, and in that case the initialization works exactly as expected.</p>\n\n<p>EDIT: I see the same crash if I use C <code>calloc</code> for allocation instead of <code>std::allocator</code>.</p>\n\n<p>SOLVED. It turns out that the problem is this: The C++ standard says that the <code>new T[N]</code> expression allocates <em>at least</em> <code>sizeof(T)*N</code> bytes. Visual C allocates an extra overhead. The placement new <code>new(ptr)T[N]</code> assumes that the extra overhead is available in <code>ptr</code>.\nThe solution from the answer below is to loop and construct each item separately.</p>\n"}, {"tags": ["c++", "compilation", "exe"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1498043963, "post_id": 44674613, "comment_id": 76333143, "body": "Then you should statically link the runtime."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 3, "creation_date": 1498044138, "post_id": 44674613, "comment_id": 76333253, "body": "2 problems (1): <code>VCRUNTIME140D.dll</code> is the debug C-runtime support dll - even if you wanted to you are not allow to distribute this; (2) change the compiler switches to use the statically linked C-runtime support. See here: <a href=\"https://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/2kzt1wy3.aspx</a>"}, {"owner": {"reputation": 684, "user_id": 6451802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-kAirbmmbfM0/AAAAAAAAAAI/AAAAAAAAACU/kuuL8JMyeQM/photo.jpg?sz=128", "display_name": "97amarnathk", "link": "https://stackoverflow.com/users/6451802/97amarnathk"}, "edited": false, "score": 0, "creation_date": 1498044332, "post_id": 44674613, "comment_id": 76333387, "body": "Do not use dynamic linking. Instead link statically. Google static linking. That should help."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1498044503, "post_id": 44674613, "comment_id": 76333515, "body": "I don&#39;t think this is a duplicate of the linked question.  The answer is that the OP needs to use /MT or /MTd to create his program.  He will <i>probably</i> find that compiling in release mode is enough to make it work (because somebody else will have installed VCTRUNTIME140.dll)."}], "owner": {"reputation": 149, "user_id": 6557067, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-_Cefp6LFB9A/AAAAAAAAAAI/AAAAAAAAAKw/cdlV-zxxWvw/photo.jpg?sz=128", "display_name": "Mine_Stone", "link": "https://stackoverflow.com/users/6557067/mine-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1134, "favorite_count": 1, "closed_date": 1498044192, "answer_count": 0, "score": 2, "last_activity_date": 1498044549, "creation_date": 1498043901, "question_id": 44674613, "link": "https://stackoverflow.com/questions/44674613/compile-c-application-to-standalone-executable-running-without-having-to-insta", "closed_reason": "Duplicate", "title": "Compile c++ application to standalone executable running without having to install it", "body": "<p>I have a small C++ application that only creates some files, and I want to export it as an .exe file. I tried to copy the <em>PROJECT\\Debug\\PROJECT.exe</em> but when I run it on an other computer it says \"This file needs VCRUNTIME140D.dll to run which was not found on your system\".</p>\n\n<p>I just need a way of creating an exe that works on any Windows system when you simply click run it.</p>\n"}, {"tags": ["c++", "c++11", "templates", "c++14", "variadic-templates"], "comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498044257, "post_id": 44674563, "comment_id": 76333336, "body": "the answer is so obvious, that 3 equivalent answers were given simultaneously."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498044364, "post_id": 44674563, "comment_id": 76333415, "body": "@Walter: but only one complete answer."}, {"owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498052654, "post_id": 44674563, "comment_id": 76339935, "body": "I have to agree with @walter - I was kind of blind."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 5, "last_activity_date": 1498044435, "last_edit_date": 1498044435, "creation_date": 1498044019, "answer_id": 44674677, "question_id": 44674563, "link": "https://stackoverflow.com/questions/44674563/dynamically-build-a-template-parameter-pack/44674677#44674677", "title": "Dynamically build a template parameter pack", "body": "<p>How about something like:</p>\n\n<pre><code>using ClassList = pack&lt;\n#if defined(USE_A) \n    A,\n#endif\n#if defined (USE_B)\n    B,\n#endif\n#if defined (USE_C)\n    C,\n#endif\n    struct dummy // For comma\n&gt;;\n</code></pre>\n\n<p>And then provide an helper class to drop last element.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 6, "creation_date": 1498044221, "post_id": 44674690, "comment_id": 76333311, "body": "Indeed, easier to drop first type than last one."}, {"owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "edited": false, "score": 0, "creation_date": 1498052722, "post_id": 44674690, "comment_id": 76339993, "body": "That is a very extensive answer to my rather stupid question. Could have seen that trick myself\u2026 thanks a lot! (Also to the two other respondents)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 11, "last_activity_date": 1498069031, "last_edit_date": 1498069031, "creation_date": 1498044050, "answer_id": 44674690, "question_id": 44674563, "link": "https://stackoverflow.com/questions/44674563/dynamically-build-a-template-parameter-pack/44674690#44674690", "title": "Dynamically build a template parameter pack", "body": "<p>Exploit the whitespace flexibility of C++ and check for each separately.</p>\n\n<pre><code>template&lt;class, class...Ts&gt;\nusing pack_helper = pack&lt;Ts...&gt;;\n\nusing ClassList = pack_helper&lt;void\n#ifdef USE_A\n  ,A\n#endif\n#ifdef USE_B\n  ,B\n#endif\n#ifdef USE_C\n  ,C\n#endif\n&gt;;\n</code></pre>\n\n<p><code>pack_helper</code> drops its first type, then generates a <code>pack</code> with the rest.  We pass <code>void</code> for it.</p>\n\n<p>We do this so each of the other pack elements can all <em>start</em> with a comma, including the first one.</p>\n\n<hr>\n\n<p>But that isn't as fun as it could be.</p>\n\n<pre><code>template&lt;class...&gt;struct pack{using type=pack; constexpr pack(){}};\ntemplate&lt;class...Ts&gt;constexpr pack&lt;Ts...&gt; pack_v{};\n\ntemplate&lt;class...Ts, class...Us&gt;\nconstexpr pack&lt;Ts...,Us...&gt;\noperator+( pack&lt;Ts...&gt;, pack&lt;Us...&gt; )\n{ return {}; }\n\nconstexpr auto Classes = pack_v&lt;&gt;\n#ifdef USE_A\n  +pack_v&lt;A&gt;\n#endif\n#ifdef USE_B\n  +pack_v&lt;B&gt;\n#endif\n#ifdef USE_C\n  +pack_v&lt;C&gt;\n#endif\n;\nusing ClassList = decltype(Classes);\n</code></pre>\n\n<p>in which we add together type packs to get our answer.</p>\n\n<p>In C++11, replace <code>pack_v&lt;?&gt;</code> with <code>pack&lt;?&gt;{}</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 2, "last_activity_date": 1498044765, "last_edit_date": 1498044765, "creation_date": 1498044136, "answer_id": 44674722, "question_id": 44674563, "link": "https://stackoverflow.com/questions/44674563/dynamically-build-a-template-parameter-pack/44674722#44674722", "title": "Dynamically build a template parameter pack", "body": "<p>Just add them one after the other</p>\n\n<pre><code>using ClassList = pack&lt;void\n#ifdef USE_A\n                      ,A\n#endif\n#ifdef USE_B\n                      ,B\n#endif\n#ifdef USE_C\n                      ,C\n#endif\n                        &gt;;\n</code></pre>\n\n<p>The <code>void</code> is necessary so that the comma works with the first non-void parameter. There are two ways to deal with this first <code>void</code> element. Either amend your <code>do_something</code> to do nothing for <code>T=void</code> or remove it using a helper <code>template</code> as explained in <a href=\"https://stackoverflow.com/a/44674690/1023390\">Yakk's answer</a>.</p>\n"}], "owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "accepted_answer_id": 44674690, "answer_count": 3, "score": 2, "last_activity_date": 1498069031, "creation_date": 1498043733, "last_edit_date": 1498047526, "question_id": 44674563, "link": "https://stackoverflow.com/questions/44674563/dynamically-build-a-template-parameter-pack", "title": "Dynamically build a template parameter pack", "body": "<p>I'm trying to have my code call a method on a list of classes, and I want to be able to configure this list at compile time. To make matters more clear (I hope), this is approximately what I'm currently doing:</p>\n\n<pre><code>template &lt;class...&gt; class pack {};\n\nclass A {\npublic:\n    static void foo() {};\n};\nclass B {\npublic:\n    static void foo() {};\n};\nclass C {\npublic:\n    static void foo() {};\n};\n\nusing ClassList = pack&lt;A, B, C&gt;;\n\ntemplate&lt;class T, class ...Remaining&gt;\nvoid do_something(pack&lt;T, Remaining...&gt;) {\n  // do something with T\n  T::foo();\n  do_something(pack&lt;Remaining...&gt;());\n}\n\nvoid do_something(pack&lt;&gt;) {\n  // do nothing, recursion ends\n}\n\nint main() {\n  do_something(ClassList());\n}\n</code></pre>\n\n<p>Basically, it calls do_something() witch each of A, B and C as template argument T.</p>\n\n<p>Here's the twist: I want to be able to dynamically en- or disable A, B and C based on '#ifdef's. I could obviously use something like</p>\n\n<pre><code>#if defined(USE_A) &amp;&amp; defined (USE_B) &amp;&amp; defined (USE_C)\nusing ClassList = pack&lt;A, B, C&gt;;\n#elif defined(USE_A) &amp;&amp; defined (USE_B)\nusing ClassList = pack&lt;A, B&gt;;\n\u2026\n</code></pre>\n\n<p>but that results in 2^n statements (if n is the number of potential classes).</p>\n\n<h2>My Solution Attempt</h2>\n\n<p>My solution attempt would be to have for each class T that I want to add to the class list an 'AddT' class that derives from pack, matches the parameter pack \"inside\" the pack class in its template definition, and then adds T. Something along the lines of:</p>\n\n<pre><code>using BaseClassList = pack&lt;A, B&gt;;\n\n#ifdef USE_C\n\ntemplate &lt;template &lt;class ...Others&gt; class oldpack&gt;\nclass AddC : public pack&lt;C, Others...&gt; {};\nusing ClassesWithC = AddC&lt;BaseClassList&gt;; \n\n#else\n\nusing ClassesWithC = BaseClassList;\n\n#endif\n</code></pre>\n\n<p>However, it looks like the 'inner' template parameter (pack) 'Others' is not accessible when defining AddC, the error I get is: </p>\n\n<pre><code>error: 'Others' was not declared in this scope\n</code></pre>\n\n<p>Am I doing something completely stupid here? Is there a nicer way of doing it? Or can the problem above be fixed? I'd happily use C++14 (or even C++1z, as far as it's implemented by a reasonable version of GCC and clang), if that helps in any way.</p>\n"}, {"tags": ["c++", "makefile", "compilation", "installation"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8193750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4b9dbc8a984faf54cc06c0d34783b1?s=128&d=identicon&r=PG&f=1", "display_name": "PatyKerry", "link": "https://stackoverflow.com/users/8193750/patykerry"}, "edited": false, "score": 0, "creation_date": 1498043782, "post_id": 44674514, "comment_id": 76333025, "body": "i already tried -lgmp and -lntl. It did not work. Any other suggestion ?"}, {"owner": {"reputation": 3, "user_id": 8193750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4b9dbc8a984faf54cc06c0d34783b1?s=128&d=identicon&r=PG&f=1", "display_name": "PatyKerry", "link": "https://stackoverflow.com/users/8193750/patykerry"}, "edited": false, "score": 0, "creation_date": 1498045808, "post_id": 44674514, "comment_id": 76334460, "body": "that was useful. Right now it says: attempt to open /usr/local/lib/libntl.so failed attempt to open /usr/local/lib/libntl.a succeeded it looks like a libntl.so file is missing. I guess i have to try another version of the lib. I am trying to use <a href=\"http://www.shoup.net/ntl/download.html\" rel=\"nofollow noreferrer\">shoup.net/ntl/download.html</a>."}, {"owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "reply_to_user": {"reputation": 3, "user_id": 8193750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4b9dbc8a984faf54cc06c0d34783b1?s=128&d=identicon&r=PG&f=1", "display_name": "PatyKerry", "link": "https://stackoverflow.com/users/8193750/patykerry"}, "edited": false, "score": 0, "creation_date": 1498045940, "post_id": 44674514, "comment_id": 76334557, "body": "Yes, beware of auto-deployed libraries, sometimes you just forget to very accurately install the library for the proper system architecture. I am glad I was somehow helpful to you!"}], "tags": [], "owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "is_accepted": true, "score": 0, "last_activity_date": 1498045412, "last_edit_date": 1498045412, "creation_date": 1498043608, "answer_id": 44674514, "question_id": 44674387, "link": "https://stackoverflow.com/questions/44674387/c-makefile-doesnt-find-library/44674514#44674514", "title": "c++ Makefile doesn&#39;t find library", "body": "<p>Try to modify your Makefile for -lgmp rather than -libgmp </p>\n\n<p>In background the compiler adds the 'lib' onto the name as well as the extension .so and similar stuff.</p>\n\n<p>Try running the following to get an overview of what the linker is trying to do:</p>\n\n<pre><code>ld -L [yourincludepath] -lgmp --verbose\n</code></pre>\n\n<p>Such resolution issues might be due to the fact you are trying to link a 64bit library with a 32bit application? Try installing a proper XX-bits of the lib  maybe?</p>\n\n<p>Try to add -m option (machine dependency):</p>\n\n<pre><code>ld -melf_i386 -L /usr/lib/i386-linux-gnu/ -lgmp --verbose\n</code></pre>\n\n<p>Other values which might be supported on your side:</p>\n\n<blockquote>\n  <p>elf_x86_64 elf32_x86_64 elf_i386 elf_iamcu i386linux elf_l1om elf_k1om i386pep i386pe</p>\n</blockquote>\n\n<p>More info:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16710047/usr-bin-ld-cannot-find-lnameofthelibrary\">usr/bin/ld: cannot find -l&lt;nameOfTheLibrary&gt;</a></p>\n"}], "owner": {"reputation": 3, "user_id": 8193750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4b9dbc8a984faf54cc06c0d34783b1?s=128&d=identicon&r=PG&f=1", "display_name": "PatyKerry", "link": "https://stackoverflow.com/users/8193750/patykerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1323, "favorite_count": 0, "accepted_answer_id": 44674514, "answer_count": 1, "score": 0, "last_activity_date": 1498048533, "creation_date": 1498043269, "last_edit_date": 1498048533, "question_id": 44674387, "link": "https://stackoverflow.com/questions/44674387/c-makefile-doesnt-find-library", "title": "c++ Makefile doesn&#39;t find library", "body": "<p>i want to run a \"make\" command in linux terminal in order to use some c++ libs.\nUnluckily while running the \"make\" an error appears saying it cannot find the requested libs.</p>\n\n<p>Here the relevant makefiles:\n<img src=\"https://i.stack.imgur.com/MR1Sj.png\" alt=\"enter image description here\"></p>\n\n<p>Here are the files in my filesystem which should be linked.\n<img src=\"https://i.stack.imgur.com/EqNaT.png\" alt=\"enter image description here\"></p>\n\n<p>Why does makefile not find the libraries ?\nThanks for all answers in advance</p>\n"}, {"tags": ["c++", "bazel"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498044359, "post_id": 44674163, "comment_id": 76333409, "body": "<code>bazel</code> is build system; what tool chain are you using with it?"}, {"owner": {"reputation": 1015, "user_id": 3553155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rClwo.jpg?s=128&g=1", "display_name": "MD. Nazmul Kibria", "link": "https://stackoverflow.com/users/3553155/md-nazmul-kibria"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498045331, "post_id": 44674163, "comment_id": 76334101, "body": "using c++ tool chain"}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 3076118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d176029656f0507fb41a815ab4ef844?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Schuh", "link": "https://stackoverflow.com/users/3076118/austin-schuh"}, "is_accepted": false, "score": 0, "last_activity_date": 1498063659, "creation_date": 1498063659, "answer_id": 44681891, "question_id": 44674163, "link": "https://stackoverflow.com/questions/44674163/alternate-to-whole-archive-in-bazel/44681891#44681891", "title": "Alternate to &quot;`--whole-archive`&quot; in bazel", "body": "<p><a href=\"https://bazel.build/versions/master/docs/be/c-cpp.html#cc_library.alwayslink\" rel=\"nofollow noreferrer\">https://bazel.build/versions/master/docs/be/c-cpp.html#cc_library.alwayslink</a></p>\n\n<blockquote>\n  <p>alwayslink</p>\n  \n  <p>Boolean; optional; nonconfigurable; default is 0</p>\n  \n  <p>If 1, any binary that depends (directly or indirectly) on this C++\n  library will link in all the object files for the files listed in\n  srcs, even if some contain no symbols referenced by the binary. This\n  is useful if your code isn't explicitly called by code in the binary,\n  e.g., if your code registers to receive some callback provided by some\n  service.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2542, "user_id": 1009896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4871abd0c41343cb16346aa9729b9873?s=128&d=identicon&r=PG", "display_name": "hlopko", "link": "https://stackoverflow.com/users/1009896/hlopko"}, "is_accepted": false, "score": 2, "last_activity_date": 1498138575, "creation_date": 1498138575, "answer_id": 44701005, "question_id": 44674163, "link": "https://stackoverflow.com/questions/44674163/alternate-to-whole-archive-in-bazel/44701005#44701005", "title": "Alternate to &quot;`--whole-archive`&quot; in bazel", "body": "<p>Sadly, alwayslink doesn't work with precompiled libraries, only with <code>cc_library</code> compiled and linked by Bazel. There is one undocumented hack (I guess I'm just documenting it by mentioning it here), and it's to rename .a file to .lo file. Then Bazel will link it as whole archive.</p>\n\n<p>Beware that this is a hack, and will stop working without warning. We have plans for some variation of <code>cc_import</code> rule exactly for this use case, to import a precompiled binary into the workspace with the ability to set whole archiveness on it. It's just not there yet.</p>\n"}], "owner": {"reputation": 1015, "user_id": 3553155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rClwo.jpg?s=128&g=1", "display_name": "MD. Nazmul Kibria", "link": "https://stackoverflow.com/users/3553155/md-nazmul-kibria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1394, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1498138575, "creation_date": 1498042623, "question_id": 44674163, "link": "https://stackoverflow.com/questions/44674163/alternate-to-whole-archive-in-bazel", "title": "Alternate to &quot;`--whole-archive`&quot; in bazel", "body": "<p>I want to link an external static lib in one of my bazel based c++ project. I need \"<code>whole-archive</code>\" option for linking the library like gcc or g++ build:</p>\n\n<pre><code>g++ main.cc -Wl,--whole-archive -lhttp -Wl,--no-whole-archive\n</code></pre>\n\n<p>Can anybody suggest what is the alternate to \"<code>--whole-archive</code>\" in bazel?</p>\n"}, {"tags": ["c++", "com", "ocx"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1498042388, "post_id": 44673965, "comment_id": 76332081, "body": "Shot in the dark: 32/64 bit issue? Like, you are registering it with the &quot;wrong&quot; regsvr32, or it&#39;s a 32 bit component but you are trying to use it from a 64 bit application or something similar?"}, {"owner": {"reputation": 913, "user_id": 84629, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zDZF7.jpg?s=128&g=1", "display_name": "Mel Padden", "link": "https://stackoverflow.com/users/84629/mel-padden"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1498042551, "post_id": 44673965, "comment_id": 76332180, "body": "Actually that could be it. I popped open the OCX in Dependency Walker and it&#39;s showing a lot of issues with library functions missing.Only thing is, it&#39;s working on some of my colleagues&#39; machines, so it must be possible somehow to configure the thing to run correctly."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1498042994, "post_id": 44673965, "comment_id": 76332486, "body": "Maybe you installed 64 bit Access, while they installed the 32 bit version?"}, {"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "edited": false, "score": 0, "creation_date": 1498053033, "post_id": 44673965, "comment_id": 76340215, "body": "Did you call regsvr32 from an elevated (administrator) command prompt?  Is it possible there is another copy of the OCX in your path?  I ask because regsvr32 searches the path (believe it or not) and will choose a file in the path over the one in the local directory unless you qualify the path to your OCX.  Where exactly is the TLB for this OCX?  It&#39;s a big red flag that it can&#39;t be opened in OLE/COM Object Viewer. Of course be sure to use the right bitness version of oleview.exe."}, {"owner": {"reputation": 913, "user_id": 84629, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zDZF7.jpg?s=128&g=1", "display_name": "Mel Padden", "link": "https://stackoverflow.com/users/84629/mel-padden"}, "edited": false, "score": 0, "creation_date": 1498054146, "post_id": 44673965, "comment_id": 76341005, "body": "Hmm not sure what bitness I&#39;m using actually. Must check for that. And yes I&#39;m running the command prompt as admin."}, {"owner": {"reputation": 913, "user_id": 84629, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zDZF7.jpg?s=128&g=1", "display_name": "Mel Padden", "link": "https://stackoverflow.com/users/84629/mel-padden"}, "edited": false, "score": 0, "creation_date": 1498054310, "post_id": 44673965, "comment_id": 76341164, "body": "I can&#39;t find a 64-bit version of oleview, actually. Anyone have any ideas?"}, {"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "edited": false, "score": 0, "creation_date": 1498056346, "post_id": 44673965, "comment_id": 76342871, "body": "It&#39;s in the Windows SDK (8.1 for me)."}, {"owner": {"reputation": 913, "user_id": 84629, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zDZF7.jpg?s=128&g=1", "display_name": "Mel Padden", "link": "https://stackoverflow.com/users/84629/mel-padden"}, "edited": false, "score": 0, "creation_date": 1498123849, "post_id": 44673965, "comment_id": 76374041, "body": "Thanks, I&#39;ll look into the SDK."}], "owner": {"reputation": 913, "user_id": 84629, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zDZF7.jpg?s=128&g=1", "display_name": "Mel Padden", "link": "https://stackoverflow.com/users/84629/mel-padden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498043371, "creation_date": 1498042075, "last_edit_date": 1498043371, "question_id": 44673965, "link": "https://stackoverflow.com/questions/44673965/ocx-file-registered-but-not-registered", "title": "OCX File registered, but.. not registered?", "body": "<p>So the setup is as follows:</p>\n\n<ol>\n<li>I have an Access VBA project which I have to maintain until we move everything over onto a new shiny platform. </li>\n<li>This VBA project contains numerous reports, which use a .OCX charting component. This component was written about 15 years ago in C++. I have access to the code, but it won't compile right now because I can't get my hands on the correct version of the toolchain used to create it. At some point I may end up actually reworking the code just to get it to compile. </li>\n<li>I can register the OCX using regsvr32, BUT:\n\n<ul>\n<li>Curious Thing. If I use the /i switch with regsvr32 like you're supposed to, it doesn't work. It says something about not finding an entry point.</li>\n<li>If I use it without the /i switch, it seems to go off without a hitch. I see entries in the registry for the ocx file with the correct location etc.</li>\n</ul></li>\n<li>When I run the Access code and generate a report, I get a \"this control does not contain an Object\" error when I attempt to call into a property of the OCX class I'm using called \"Object\".</li>\n</ol>\n\n<p>Does anyone have any ideas?</p>\n\n<p>What I have tried:</p>\n\n<ul>\n<li>I've tried removing and re-adding the reference. Still no go.</li>\n<li>I've used OLEViewer to peek at the component, but when I try to View Type Information it gives me \"Library not loaded\".</li>\n</ul>\n"}, {"tags": ["c++", "wininet"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498041931, "post_id": 44673876, "comment_id": 76331754, "body": "If you program in C++, why don&#39;t you use <code>std::string</code> for the &quot;data&quot;? Or use a <code>std::ostringstream</code> for formatting? And why do you dynamically allocate <code>list</code> instead of just defining it as a simple object instance?"}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1498042076, "post_id": 44673876, "comment_id": 76331870, "body": "@Someprogrammerdude, the IDE in the question will answer all of your questions :)"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1498042514, "post_id": 44673876, "comment_id": 76332162, "body": "Compiler from 2002 <i>facepalm</i>. Well, it&#39;s newer than TurboC++ 3 at least."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1498042592, "post_id": 44673876, "comment_id": 76332215, "body": "It appears your learning material is extremely out of date. You should get a good, modern C++ book."}, {"owner": {"reputation": 425, "user_id": 4168281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-OjHjqrWCdz8/AAAAAAAAAAI/AAAAAAAAAE0/DOjBxJvItnM/photo.jpg?sz=128", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/4168281/ivan-ivanov"}, "edited": false, "score": 0, "creation_date": 1498042797, "post_id": 44673876, "comment_id": 76332350, "body": "It&#39;s simple: It&#39;s very old code and working from ancient times for one small task :)"}, {"owner": {"reputation": 425, "user_id": 4168281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-OjHjqrWCdz8/AAAAAAAAAAI/AAAAAAAAAE0/DOjBxJvItnM/photo.jpg?sz=128", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/4168281/ivan-ivanov"}, "edited": false, "score": 1, "creation_date": 1498043140, "post_id": 44673876, "comment_id": 76332582, "body": "It&#39;s very funny to read your comments, but I&#39;m realy need to upload files with Wininet. (not Indy and so on)"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1498044736, "post_id": 44673876, "comment_id": 76333669, "body": "Instead of <code>HttpSendRequest</code> call <code>HttpSendRequestEx()</code> with <code>HSR_INITIATE</code> flag , call <code>InternetWriteFile()</code> in a loop to upload big file in small pieces, call <code>HttpEndRequest()</code> when you are done. Basic flow can be seen in <a href=\"https://stackoverflow.com/q/8951220/7571258\">this question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 10084797, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qlQ0QjJM2CU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rBjeojbv-Hx_cQ6JXNuM0ToQqBoQ/mo/photo.jpg?sz=128", "display_name": "yeah_well", "link": "https://stackoverflow.com/users/10084797/yeah-well"}, "edited": false, "score": 1, "creation_date": 1587891664, "post_id": 44712998, "comment_id": 108682444, "body": "Can you please edit and add the example function call to it,i cannot figure out what exactly is szparam and szvalue"}], "tags": [], "owner": {"reputation": 425, "user_id": 4168281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-OjHjqrWCdz8/AAAAAAAAAAI/AAAAAAAAAE0/DOjBxJvItnM/photo.jpg?sz=128", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/4168281/ivan-ivanov"}, "is_accepted": true, "score": 2, "last_activity_date": 1498191612, "creation_date": 1498191612, "answer_id": 44712998, "question_id": 44673876, "link": "https://stackoverflow.com/questions/44673876/sending-file-to-http-server-c-wininet/44712998#44712998", "title": "Sending file to HTTP server (C++ Wininet)", "body": "<p>This is working example for one file uploading:</p>\n\n<pre><code>void http_upload_file(PCHAR szServer, PCHAR szScript, PCHAR szParam, PCHAR szValue, PCHAR szFile)\n{\n    PCHAR szHeaders = \"Content-Type: multipart/form-data; boundary=----qwerty\";\n    PCHAR szData    = \"------qwerty\\r\\n\"\n                      \"Content-Disposition: form-data; name=\\\"%s\\\"\\r\\n\\r\\n%s\\r\\n\"\n                      \"------qwerty\\r\\n\"\n                      \"Content-Disposition: form-data; name=\\\"files[]\\\"; filename=\\\"%s\\\"\\r\\n\"\n                      \"Content-Type: application/octet-stream\\r\\n\"\n                      \"Content-Transfer-Encoding: binary\\r\\n\\r\\n\";\n    PCHAR szDataEnd = \"\\r\\n------qwerty--\\r\\n\";\n    char  szHeader[512];\n\n    HINTERNET hSession, hConnect, hRequest;\n    DWORD     dwFileSize, dwBytesRead, dwContentLength,dwBytesWritten;\n\n    hSession = InternetOpen(NULL, INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0);\n\n    if (hSession)\n    {\n        hConnect = InternetConnect(hSession, szServer, INTERNET_DEFAULT_HTTP_PORT, NULL, NULL, INTERNET_SERVICE_HTTP,0, 0);\n\n        if (hConnect)\n        {\n            hRequest = HttpOpenRequest(hConnect, \"POST\", szScript, NULL, NULL, 0, 0, 0);\n\n            if (hRequest)\n            {\n                HANDLE hFile = CreateFile(szFile, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);\n\n                if (hFile != INVALID_HANDLE_VALUE)\n                {\n                    dwFileSize      = GetFileSize(hFile, NULL);\n                    wsprintf(szHeader, szData, szParam, szValue, szFile);\n                    dwContentLength = lstrlen(szHeader) + dwFileSize + lstrlen(szDataEnd);\n                    LPBYTE pBuf     = (LPBYTE)malloc(dwContentLength);\n                    CopyMemory(&amp;pBuf[0], szHeader, lstrlen(szHeader));\n                    ReadFile(hFile, &amp;pBuf[lstrlen(szHeader)], dwFileSize, &amp;dwBytesRead, NULL);\n                    CopyMemory(&amp;pBuf[lstrlen(szHeader) + dwFileSize], szDataEnd, lstrlen(szDataEnd));\n                    HttpSendRequest(hRequest, szHeaders, lstrlen(szHeaders), pBuf, dwContentLength);\n                    CloseHandle(hFile);\n                    free(pBuf);\n                }\n            }\n\n            InternetCloseHandle(hRequest);\n        }\n\n        InternetCloseHandle(hConnect);\n    }\n\n    InternetCloseHandle(hSession);\n}\n</code></pre>\n"}], "owner": {"reputation": 425, "user_id": 4168281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-OjHjqrWCdz8/AAAAAAAAAAI/AAAAAAAAAE0/DOjBxJvItnM/photo.jpg?sz=128", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/4168281/ivan-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 0, "accepted_answer_id": 44712998, "answer_count": 1, "score": 0, "last_activity_date": 1523965689, "creation_date": 1498041786, "question_id": 44673876, "link": "https://stackoverflow.com/questions/44673876/sending-file-to-http-server-c-wininet", "title": "Sending file to HTTP server (C++ Wininet)", "body": "<p>I have code for uploading small <code>.txt</code> files on my HTTP-server:</p>\n\n<pre><code>#include &lt;wininet.h&gt;\n#define BUF_SIZE 4096\n\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\n TStringList * list = new TStringList();\n AnsiString Path = \"\";\n\n if(OpenDialog1-&gt;Execute()) {\n\n    Path =  \"filename=\\\"\"+OpenDialog1-&gt;FileName+\"\\\"\";\n    list-&gt;LoadFromFile(OpenDialog1-&gt;FileName);\n\n }\n\n char data[BUF_SIZE] = \"\";\n static char hdrs[] = \"Content-Type: multipart/form-data; boundary=---------------------------7d82751e2bc0858\";\n\n strcat(data,\"-----------------------------7d82751e2bc0858\");\n strcat(data,\"\\n\");\n strcat(data,\"Content-Disposition: form-data; name=\\\"files[]\\\"; \");\n strcat(data,Path.c_str());\n strcat(data,\"\\n\");\n strcat(data,\"Content-Type: application/octet-stream\");\n strcat(data,\"\\n\\n\");\n strcat(data,list-&gt;Text.c_str());\n strcat(data,\"\\n\");\n strcat(data,\"-----------------------------7d82751e2bc0858\");\n strcat(data,\"\\n\");\n strcat(data,\"Content-Disposition: form-data; name=\\\"user\\\"\");\n strcat(data,\"\\r\\n\\r\\n\");\n strcat(data,\"username\");\n strcat(data,\"\\r\\n\");\n strcat(data,\"-----------------------------7d82751e2bc0858\");\n strcat(data,\"\\n\");\n\n HINTERNET hSession = InternetOpen(\"MyAgent\",INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);\n HINTERNET hConnect = InternetConnect(hSession, \"localhost\",INTERNET_DEFAULT_HTTP_PORT, NULL, NULL, INTERNET_SERVICE_HTTP, 0, 1);\n HINTERNET hRequest = HttpOpenRequest(hConnect, \"POST\", \"new_upltest.php\", NULL, NULL, NULL, 0, 1);\n\n HttpSendRequest(hRequest, hdrs, strlen(hdrs), data, strlen(data));\n\n delete list;\n}\n</code></pre>\n\n<p>It's working fine, but now I'm needing to upload big files (over 70-100 mb), that can be images (.jpg, .png, .bmp) and other document types (.pdf, .docx, etc).</p>\n\n<p>Is it possible to solve my task with this code? I will be grateful for each advices...</p>\n\n<p><strong>P.S.</strong> My IDE is C++ Builder 6, but I think it doesn't matter.</p>\n"}, {"tags": ["c++", "matlab", "matlab-compiler", "matlab-coder"], "answers": [{"comments": [{"owner": {"reputation": 810, "user_id": 2798895, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/17c7c0abc2ee628bbec25a4d33ed532c?s=128&d=identicon&r=PG&f=1", "display_name": "flor1an", "link": "https://stackoverflow.com/users/2798895/flor1an"}, "edited": false, "score": 0, "creation_date": 1498058051, "post_id": 44677197, "comment_id": 76344330, "body": "hmm thats bad :/ Do you suggest any other way to use this code &quot;outsite&quot; of the matlab IDE?"}, {"owner": {"reputation": 4299, "user_id": 156525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b540a59cb2b0902d0410fa84f437379b?s=128&d=identicon&r=PG", "display_name": "Navan", "link": "https://stackoverflow.com/users/156525/navan"}, "reply_to_user": {"reputation": 810, "user_id": 2798895, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/17c7c0abc2ee628bbec25a4d33ed532c?s=128&d=identicon&r=PG&f=1", "display_name": "flor1an", "link": "https://stackoverflow.com/users/2798895/flor1an"}, "edited": false, "score": 0, "creation_date": 1498059338, "post_id": 44677197, "comment_id": 76345283, "body": "You can try MATLAB compiler to compile this code and create a standalone executable. That would run outside MATLAB."}], "tags": [], "owner": {"reputation": 4299, "user_id": 156525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b540a59cb2b0902d0410fa84f437379b?s=128&d=identicon&r=PG", "display_name": "Navan", "link": "https://stackoverflow.com/users/156525/navan"}, "is_accepted": false, "score": 0, "last_activity_date": 1498050803, "creation_date": 1498050803, "answer_id": 44677197, "question_id": 44673744, "link": "https://stackoverflow.com/questions/44673744/using-matlab-coder-to-export-code-from-registration-estimator-app-to-c/44677197#44677197", "title": "Using MATLAB coder to export code from Registration Estimator app to C++", "body": "<p>Based on the supported functions for code generation list at <a href=\"https://www.mathworks.com/help/coder/ug/functions-supported-for-code-generation--categorical-list.html#bsl0arh-1\" rel=\"nofollow noreferrer\">https://www.mathworks.com/help/coder/ug/functions-supported-for-code-generation--categorical-list.html#bsl0arh-1</a>, imregconfig is not supported for code generation. Which explains the issue you got first. Adding coder.extrinsic means that MATLAB Coder generated file will call into MATLAB to run that function. You can do this only for a mex target that needs MATLAB to run. imregconfig is not going to generate any C code. Standalone C code generation for use from external application is not possible with this code.</p>\n\n<p>When functions declared as coder.extrinsic call into MATLAB they return an mxArray. The rest of the code can handle this mxArray only by passing it to MATLAB i.e. similar extrinsic functions. From Coder's point of view these are opaque types and hence the error about attempting extract fields from mxArray.</p>\n"}], "owner": {"reputation": 810, "user_id": 2798895, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/17c7c0abc2ee628bbec25a4d33ed532c?s=128&d=identicon&r=PG&f=1", "display_name": "flor1an", "link": "https://stackoverflow.com/users/2798895/flor1an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498050803, "creation_date": 1498041444, "last_edit_date": 1592644375, "question_id": 44673744, "link": "https://stackoverflow.com/questions/44673744/using-matlab-coder-to-export-code-from-registration-estimator-app-to-c", "title": "Using MATLAB coder to export code from Registration Estimator app to C++", "body": "<p>Hi I'm trying to export &quot;the default code&quot; that is automatic generated from the Registration Estimator app within MATLAB to C++ using the <code>MATLAB Coder</code> tool.</p>\n<p>This is an sample code I generated today:</p>\n<pre class=\"lang-matlab prettyprint-override\"><code>function [MOVINGREG] = registerImages(MOVING,FIXED)\n%registerImages  Register grayscale images using auto-generated code from Registration Estimator app.\n%  [MOVINGREG] = registerImages(MOVING,FIXED) Register grayscale images\n%  MOVING and FIXED using auto-generated code from the Registration\n%  Estimator App. The values for all registration parameters were set\n%  interactively in the App and result in the registered image stored in the\n%  structure array MOVINGREG.\n\n% Auto-generated by registrationEstimator app on 21-Jun-2017\n%-----------------------------------------------------------\n\n\n% Convert RGB images to grayscale\nFIXED = rgb2gray(FIXED);\nMOVING = rgb2gray(MOVING);\n\n% Default spatial referencing objects\nfixedRefObj = imref2d(size(FIXED));\nmovingRefObj = imref2d(size(MOVING));\n\n% Intensity-based registration\n[optimizer, metric] = imregconfig('monomodal');\noptimizer.GradientMagnitudeTolerance = 1.00000e-04;\noptimizer.MinimumStepLength = 1.00000e-05;\noptimizer.MaximumStepLength = 6.25000e-02;\noptimizer.MaximumIterations = 100;\noptimizer.RelaxationFactor = 0.500000;\n\n% Align centers\nfixedCenterXWorld = mean(fixedRefObj.XWorldLimits);\nfixedCenterYWorld = mean(fixedRefObj.YWorldLimits);\nmovingCenterXWorld = mean(movingRefObj.XWorldLimits);\nmovingCenterYWorld = mean(movingRefObj.YWorldLimits);\ntranslationX = fixedCenterXWorld - movingCenterXWorld;\ntranslationY = fixedCenterYWorld - movingCenterYWorld;\n\n% Coarse alignment\ninitTform = affine2d();\ninitTform.T(3,1:2) = [translationX, translationY];\n\n% Apply transformation\ntform = imregtform(MOVING,movingRefObj,FIXED,fixedRefObj,'similarity',optimizer,metric,'PyramidLevels',3,'InitialTransformation',initTform);\nMOVINGREG.Transformation = tform;\nMOVINGREG.RegisteredImage = imwarp(MOVING, movingRefObj, tform, 'OutputView', fixedRefObj, 'SmoothEdges', true);\n\n% Store spatial referencing object\nMOVINGREG.SpatialRefObj = fixedRefObj;\n\nend\n</code></pre>\n<p>Within the Coder Tool in the section <code>Run-Time Issues</code> I received a couple of issues e.g. that coder need to <a href=\"https://mathworks.com/help/simulink/slref/coder.extrinsic.html\" rel=\"nofollow noreferrer\">declare the extrinsic</a> . So far so good. I added for instance: <code>coder.extrinsic('imregconfig'); </code> and <code>coder.extrinsic('optimizer');</code>. But I still getting errors like:</p>\n<blockquote>\n<p>Attempt to extract field 'GradientMagnitudeTolerance' from 'mxArray'.</p>\n<p>Attempt to extract field 'MinimumStepLength' from 'mxArray'.</p>\n<p>Attempt to extract field 'MaximumStepLength' from 'mxArray'.</p>\n<p>...</p>\n</blockquote>\n<p>Pointing to the line with <code>optimizer.GradientMagnitudeTolerance = 1.00000e-04;</code> (and below).</p>\n<p>I found out that usually the initialisation of variables is missing. But I don't know how to initialise the property <code>optimizer.GradientMagnitudeTolerance</code> in advanced. Can anyone help me with this?</p>\n<p>PS: I'm using <code>MATLAB R2017a</code> and <code>Microsoft Visual C++ 2017 (C)</code> Compiler</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1498041209, "post_id": 44673548, "comment_id": 76331249, "body": "The key is that output starts at the second element. Then when the input comes to the second it is 1, so the next output will be 2. And so on."}, {"owner": {"reputation": 41806, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "edited": false, "score": 0, "creation_date": 1498041587, "post_id": 44673548, "comment_id": 76331507, "body": "Not sure what&#39;s the confusion, if you can look into code that easily, you could always take a pen and paper to see it why as well."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1498041752, "post_id": 44673548, "comment_id": 76331635, "body": "usually it is better to pair what P0w said with debugger, since sometimes one can mistaken about code due to tiredness or simple confusion."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1498041990, "post_id": 44673548, "comment_id": 76331802, "body": "Also, you can use <code>auto</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1498049303, "post_id": 44673548, "comment_id": 76337146, "body": "This doesn&#39;t address the question, but do you really need the extra stuff that <code>std::endl</code> does? <code>&#39;\\n&#39;</code> ends a line."}], "answers": [{"tags": [], "owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "is_accepted": true, "score": 4, "last_activity_date": 1498041375, "creation_date": 1498041375, "answer_id": 44673724, "question_id": 44673548, "link": "https://stackoverflow.com/questions/44673548/stdtransform-operating-till-end-and-strange-output/44673724#44673724", "title": "std::transform operating till --end() and strange output", "body": "<p>I think the easiest way to understand this is to write up some iterations of the loop:</p>\n\n<p><strong>1st iteration:</strong></p>\n\n<pre><code>0 1 0 0 0 \n^ input\n  ^ output\n</code></pre>\n\n<p><strong>2nd iteration:</strong></p>\n\n<pre><code>0 1 2 0 0\n  ^ input\n    ^ output\n</code></pre>\n\n<p><strong>3rd iteration:</strong></p>\n\n<pre><code>0 1 2 3 0\n    ^ input\n      ^ output\n</code></pre>\n\n<p>And so on.</p>\n\n<p>It is possible to see then than an element next to the input is incremented.</p>\n\n<p>Also note that <code>std::distance()</code> between begin and end of input range (it doesn't include last one) is exactly the same (4) as output range , which is from second element to the last (4).</p>\n\n<p>To illustrate:</p>\n\n<p>Input: indexes 0 1 2 3</p>\n\n<p>Output: indexes 1 2 3 4</p>\n"}], "owner": {"reputation": 37, "user_id": 2399741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8eb1d19a257324a4de8d612d6051eac?s=128&d=identicon&r=PG", "display_name": "user2399741", "link": "https://stackoverflow.com/users/2399741/user2399741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 44673724, "answer_count": 1, "score": 1, "last_activity_date": 1498041375, "creation_date": 1498040897, "question_id": 44673548, "link": "https://stackoverflow.com/questions/44673548/stdtransform-operating-till-end-and-strange-output", "title": "std::transform operating till --end() and strange output", "body": "<p>I'm trying to learn C++11 &amp; STL, and I cannot understand this code:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;list&gt;\n\nint main()\n{\n    typedef std::list&lt;int&gt; L;\n    L l(5);\n\n    typedef L::const_iterator CI;\n    CI cb = l.begin(), ce = l.end();\n    typedef L::iterator I;\n    I b = l.begin();\n\n    std::transform(cb, --ce, ++b, [] (CI::value_type n) { return ++n; });\n    std::copy(l.begin(), l.end(), std::ostream_iterator&lt;CI::value_type&gt;(std::cout));\n    std::cout &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>The array at the end is 0, 1, 2, 3, 4 and I expected it to be 0, 1, 1, 1, 0</p>\n\n<p>1> Why isn't the last skipped because of \"--ce\"? I already read the implementation of std::transform and I still don't understand why it wouldn't skip the last: <a href=\"http://llvm.org/svn/llvm-project/libcxx/trunk/include/algorithm\" rel=\"nofollow noreferrer\">http://llvm.org/svn/llvm-project/libcxx/trunk/include/algorithm</a></p>\n\n<p>2> How is it possible that the array in the end is 0, 1, 2, 3, 4? I don't see how that ++n adds up to 2, I thought that since before the values were 0, 0, 0, 0, 0 then it will increment every zero with ++ leading to 0, 1, 1, 1, 0. I see that the first is skipped because of \"++b\".</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "conditional-statements", "lazy-evaluation"], "comments": [{"owner": {"reputation": 1143, "user_id": 2466572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3de0d3fe056a4e5b6285244fd531e4a?s=128&d=identicon&r=PG", "display_name": "k.v.", "link": "https://stackoverflow.com/users/2466572/k-v"}, "edited": false, "score": 1, "creation_date": 1498040208, "post_id": 44673268, "comment_id": 76330516, "body": "You can use operator <code>&amp;=</code>"}, {"owner": {"reputation": 41, "user_id": 8193470, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154709962756305/picture?type=large", "display_name": "Stefan Evertz", "link": "https://stackoverflow.com/users/8193470/stefan-evertz"}, "reply_to_user": {"reputation": 1143, "user_id": 2466572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3de0d3fe056a4e5b6285244fd531e4a?s=128&d=identicon&r=PG", "display_name": "k.v.", "link": "https://stackoverflow.com/users/2466572/k-v"}, "edited": false, "score": 0, "creation_date": 1498040982, "post_id": 44673268, "comment_id": 76331064, "body": "So I&#39;m just wondering with the answers below aren&#39;t these evaluating the expressions at the assignment and not the if statements? I am looking for functionality that evaluates at the if statement."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1498041079, "post_id": 44673268, "comment_id": 76331148, "body": "Interesting. Why? i.e. why do  you care when things are evaulated? Is there a threading context we don&#39;t know about?"}, {"owner": {"reputation": 41, "user_id": 8193470, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154709962756305/picture?type=large", "display_name": "Stefan Evertz", "link": "https://stackoverflow.com/users/8193470/stefan-evertz"}, "edited": false, "score": 0, "creation_date": 1498041442, "post_id": 44673268, "comment_id": 76331424, "body": "Well its just a really simple program, but what I&#39;m doing is going through several For-loops and avoiding certain situations. But I keep finding more of these situations and it would be easier to just have them set in one place. <b>Example</b>: moving through pixels in a window and avoiding certain areas of the window. But overall I&#39;m just interested to see if this is possible."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1498042970, "post_id": 44673268, "comment_id": 76332466, "body": "If you&#39;re moving, write a move function, like move left etc and jump over these bits - or stay still, or whatever?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8193470, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154709962756305/picture?type=large", "display_name": "Stefan Evertz", "link": "https://stackoverflow.com/users/8193470/stefan-evertz"}, "edited": false, "score": 0, "creation_date": 1498042736, "post_id": 44673372, "comment_id": 76332312, "body": "I think something along the lines of this is what I am after. I could create a recursive function and make it test all the conditions."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "reply_to_user": {"reputation": 41, "user_id": 8193470, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154709962756305/picture?type=large", "display_name": "Stefan Evertz", "link": "https://stackoverflow.com/users/8193470/stefan-evertz"}, "edited": false, "score": 0, "creation_date": 1498042854, "post_id": 44673372, "comment_id": 76332380, "body": "The lack of short circuit may slow you down... it depends on your context."}], "tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 0, "last_activity_date": 1498042808, "last_edit_date": 1498042808, "creation_date": 1498040421, "answer_id": 44673372, "question_id": 44673268, "link": "https://stackoverflow.com/questions/44673268/is-it-possible-to-define-boolean-expressions-that-can-be-evaluated-later/44673372#44673372", "title": "Is it possible to define boolean expressions that can be evaluated later?", "body": "<p>A common way to do something in one place, so  you don't repeat yourself everywhere is to make a function.</p>\n\n<p>For example, </p>\n\n<pre><code>bool special_condition(bool current_condition, int x)\n{\n    return current_condition &amp;&amp; (x&lt;75 &amp;&amp; y&lt;250);\n}\n</code></pre>\n\n<p>allows this whenever needed.</p>\n\n<pre><code>if (special_condition(conditions))\n    do_something();\nelse\n    do_something_else();\n</code></pre>\n\n<p>This will be evaulated when the if is encountered, however, this won't short circuit if current_condition is false when the function will still be called.</p>\n"}, {"comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 3, "creation_date": 1498040786, "post_id": 44673448, "comment_id": 76330913, "body": "Not to mention there are types contextually convertible to <code>bool</code> that might explode with <code>&amp;=</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1498040948, "post_id": 44673448, "comment_id": 76331039, "body": "@PasserBy: Indeed. Added that to the end."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1498048574, "post_id": 44673448, "comment_id": 76336596, "body": "IIRC short circuiting applies only to non user defined types, no? So if one where to make a deferred_bool then there won&#39;t be any issues regarding <code>&amp;=</code> vs <code>&amp;&amp;</code> if implemented properly"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1498048627, "post_id": 44673448, "comment_id": 76336640, "body": "Not correct. Short circuiting is only dropped if &amp;&amp; is <i>overloaded</i> for the type. Rather than do all that, you may as well write <code>foo(condition, condition2)</code> that takes the conditions by reference and const reference respectively, modifies the first argument, and returns <code>condition</code>."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1498041300, "last_edit_date": 1498041300, "creation_date": 1498040609, "answer_id": 44673448, "question_id": 44673268, "link": "https://stackoverflow.com/questions/44673268/is-it-possible-to-define-boolean-expressions-that-can-be-evaluated-later/44673448#44673448", "title": "Is it possible to define boolean expressions that can be evaluated later?", "body": "<p><strong>Be very careful when working with &amp;&amp; and &amp;</strong></p>\n\n<p><hr>\nReason 1</p>\n\n<p>Expanding the postulated (and syntactically invalid)</p>\n\n<pre><code>condition &amp;&amp;= condition2;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>condition = condition &amp;&amp; condition2;\n</code></pre>\n\n<p>reveals a subtlety: <code>condition2</code> will <strong>not</strong> be evaluated if <code>condition</code> is <code>false</code>.</p>\n\n<p><hr>\nReason 2</p>\n\n<p><code>&amp;</code> and <code>&amp;&amp;</code> also have differing behaviour for integral types, e.g. <code>0b01 &amp; 0b10</code> is <code>0</code> but <code>0b01 &amp;&amp; 0b10</code> is <code>true</code> (here I'm using C++14 binary literals).</p>\n\n<p><hr>\nConclusion</p>\n\n<p>So I'd favour the compaction</p>\n\n<pre><code>if (condition = condition &amp;&amp; condition2){\n    // do this\n} else {\n    // do this\n}\n</code></pre>\n\n<p>where <code>condition2</code> is only evaluated if <code>condition</code> is <code>true</code></p>\n"}, {"comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1498042903, "post_id": 44673950, "comment_id": 76332420, "body": "Indeed. I was trying not to think of the M word."}], "tags": [], "owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "is_accepted": false, "score": 1, "last_activity_date": 1498054167, "last_edit_date": 1498054167, "creation_date": 1498042037, "answer_id": 44673950, "question_id": 44673268, "link": "https://stackoverflow.com/questions/44673268/is-it-possible-to-define-boolean-expressions-that-can-be-evaluated-later/44673950#44673950", "title": "Is it possible to define boolean expressions that can be evaluated later?", "body": "<p>In order to address the use case, you've mentioned in a comment:</p>\n\n<blockquote>\n  <p>Example: moving through pixels in a window and avoiding certain areas of the window.</p>\n</blockquote>\n\n<p>For reasons of readability, I'd recommend you define a function, e.g., like this (pseudocode) example:</p>\n\n<pre><code>bool is_in_rect(point2i p, rect2i rect) {\n    // check x range\n    if (p.x &gt;= rect.x1 &amp;&amp; p.x &lt; rect.x2)\n        return true;\n    // check y range\n    if (p.y &gt;= rect.y1 &amp;&amp; p.y &lt; rect.y2)\n        return true;\n    return false;\n}\n</code></pre>\n\n<p>You can add functions for specialized situations as you wish:</p>\n\n<pre><code>bool is_in_monkey_rect(point2i p, rect2i rect) {\n    return rect.type == MONKEY &amp;&amp; is_in_rect(p, rect);\n}\n</code></pre>\n\n<blockquote>\n  <p>But overall I'm just interested to see if this is possible.</p>\n</blockquote>\n\n<p>Other than delegating to a function, you'd probably use macros to simulate this kind of lazy evaluation. But I wouldn't recommend that.</p>\n\n<p>Note that, depending on the actual nature of the problem, it might make more sense to adapt the iteration pattern, rather than iterating all the data and check every single pixel for relevance.</p>\n"}, {"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 2, "last_activity_date": 1498049508, "creation_date": 1498049508, "answer_id": 44676684, "question_id": 44673268, "link": "https://stackoverflow.com/questions/44673268/is-it-possible-to-define-boolean-expressions-that-can-be-evaluated-later/44676684#44676684", "title": "Is it possible to define boolean expressions that can be evaluated later?", "body": "<p>The sensible solution here is to create named functions for those conditions and call them whenever necessary.</p>\n\n<hr>\n\n<p>That said ...</p>\n\n<blockquote>\n  <p>Is it possible [..]</p>\n</blockquote>\n\n<p><em>Of course</em>. To defer evaluation, just wrap your conditions in (lambda) functions. Proof of concept:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename F, typename G&gt;\nauto and_also (F f, G g) {\n  return [=]() {\n    bool first = f();\n    if (! first) return false;\n    return static_cast&lt;bool&gt;(g());\n  };\n}\n\nint main () {\n  int dummy = -1;\n  std::function&lt;bool()&gt; condition = [&amp;](){return dummy &gt; 0;};\n  condition = and_also(condition, [&amp;](){return dummy &lt; 42;});\n  dummy = 21;\n  if (condition()) std::cout &lt;&lt; \"in range\" &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 239486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dd570a904630e79384cce61ac1927?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/239486/anders"}, "is_accepted": false, "score": 0, "last_activity_date": 1498060490, "creation_date": 1498060490, "answer_id": 44680941, "question_id": 44673268, "link": "https://stackoverflow.com/questions/44673268/is-it-possible-to-define-boolean-expressions-that-can-be-evaluated-later/44680941#44680941", "title": "Is it possible to define boolean expressions that can be evaluated later?", "body": "<p>Short answer Stefan, in C++ no.</p>\n\n<p>The expression is evaluated during <code>&amp;=</code>.</p>\n\n<p>Short circuiting expressions e.g. ignoring <code>b</code> if <code>a</code> is false in expressions such as <code>a &amp;&amp; b</code>, is usually configurable in your environment and normally on.</p>\n\n<p>If you still wish to do so, create an evaluation function instead.</p>\n\n<p>/Anders</p>\n"}], "owner": {"reputation": 41, "user_id": 8193470, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154709962756305/picture?type=large", "display_name": "Stefan Evertz", "link": "https://stackoverflow.com/users/8193470/stefan-evertz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "answer_count": 5, "score": 4, "last_activity_date": 1498060490, "creation_date": 1498040167, "last_edit_date": 1498043831, "question_id": 44673268, "link": "https://stackoverflow.com/questions/44673268/is-it-possible-to-define-boolean-expressions-that-can-be-evaluated-later", "title": "Is it possible to define boolean expressions that can be evaluated later?", "body": "<p>Looking to achieve a sort of dynamic expression where I can later evaluate the booleans if called.</p>\n\n<pre><code>condition &amp;&amp;= condition2; //not evaluated just yet\ncondition ||= condition3;    \n\nif (condition)    //evaluated now\n   do this;\nelse\n   do this;\n</code></pre>\n\n<p>for example I am the using the same conditions throughout my code and it would be easier if I could just adjust the one statement or add more to it even when the programs running.</p>\n\n<pre><code>conditions = (x&gt;50 &amp;&amp; y&gt;200) &amp;&amp; (type == MONKEY);\nconditions &amp;&amp;= (x&lt;75 &amp;&amp; y&lt;250);\n</code></pre>\n\n<p>and later on in the code</p>\n\n<pre><code>if (conditions)\n    cout&lt;&lt;\"Hello!\";\n</code></pre>\n\n<p>edit: The conditions should be evaluated at the if statement.</p>\n"}]