[{"tags": ["java", "c++", "recursion", "stack-overflow", "flood-fill"], "comments": [{"owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "edited": false, "score": 4, "creation_date": 1544659304, "post_id": 53753141, "comment_id": 94359258, "body": "There is no equivalent of <code>screen[x][y] = newC;</code> in the Java code"}, {"owner": {"reputation": 1606, "user_id": 7944978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VLMC.jpg?s=128&g=1", "display_name": "LuminousNutria", "link": "https://stackoverflow.com/users/7944978/luminousnutria"}, "reply_to_user": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "edited": false, "score": 0, "creation_date": 1544662287, "post_id": 53753141, "comment_id": 94359899, "body": "@TheDark I&#39;m sorry, I told you it worked, but it doesn&#39;t do the entire array. it only seems to work for the node itself, and the nodes to the top, bottom, left, and right of it."}, {"owner": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 3, "creation_date": 1544662512, "post_id": 53753141, "comment_id": 94359929, "body": "When you recurse, you are using suffix operators <code>row++</code>, etc.  Those increment AFTER use - so you are actually passing in the unchanged <code>row</code> value (not to mention changing the value on the following calls).   Use the row + 1 as you do in your C++.."}, {"owner": {"reputation": 1606, "user_id": 7944978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VLMC.jpg?s=128&g=1", "display_name": "LuminousNutria", "link": "https://stackoverflow.com/users/7944978/luminousnutria"}, "reply_to_user": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 0, "creation_date": 1544662915, "post_id": 53753141, "comment_id": 94360004, "body": "@racraman This seems to help, but I am still not filling all of the connected nodes. Rather, now I seem to be filling three instead of two. Most of the nodes around the initial &quot;fill-point&quot; are not of the same int value."}, {"owner": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 2, "creation_date": 1544663603, "post_id": 53753141, "comment_id": 94360137, "body": "Also in your base conditions, you should have either &quot;&gt;= N&quot;, or compare against &quot;N -1&quot;.  By having both as in &quot;&gt;= N -1&quot;, you&#39;re missing out the upper bound."}, {"owner": {"reputation": 1606, "user_id": 7944978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VLMC.jpg?s=128&g=1", "display_name": "LuminousNutria", "link": "https://stackoverflow.com/users/7944978/luminousnutria"}, "reply_to_user": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 0, "creation_date": 1544663776, "post_id": 53753141, "comment_id": 94360162, "body": "@racraman Sorry, I had already removed those in my IDE, but I forgot to do it here. I have updated the question."}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1544704502, "post_id": 53753141, "comment_id": 94375594, "body": "show how is pic populated"}, {"owner": {"reputation": 1606, "user_id": 7944978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VLMC.jpg?s=128&g=1", "display_name": "LuminousNutria", "link": "https://stackoverflow.com/users/7944978/luminousnutria"}, "reply_to_user": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 0, "creation_date": 1544830229, "post_id": 53753141, "comment_id": 94427916, "body": "@racraman Sorry everyone, racraman&#39;s suggestions worked for me. I didn&#39;t think they worked because I mistyped it. I&#39;m sorry for all the confusion with this question. I&#39;m going to wait 24 hours for people who tried to help to post their own solutions if they want the points. Otherwise, I&#39;ll post my own solution."}], "answers": [{"tags": [], "owner": {"reputation": 1606, "user_id": 7944978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VLMC.jpg?s=128&g=1", "display_name": "LuminousNutria", "link": "https://stackoverflow.com/users/7944978/luminousnutria"}, "is_accepted": true, "score": 1, "last_activity_date": 1545410332, "last_edit_date": 1545410332, "creation_date": 1544982750, "answer_id": 53804931, "question_id": 53753141, "link": "https://stackoverflow.com/questions/53753141/translating-c-recursive-floodfill-implementation-for-2d-array-without-any-loop/53804931#53804931", "title": "Translating C++ recursive floodfill implementation for 2D array without any loops, into Java?", "body": "<p>I needed to put the line <code>pic[row][col] = newC</code> in the program. Another problem was that I didn't know <code>variableName++</code> is a different command from <code>variableName + 1</code> so the recursion didn't work as expected. <code>variableName++</code> returns the value of <code>variableName</code> <em>before</em> it was incremented.</p>\n\n<p><strong>This code allowed my program to work:</strong></p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public void floodFill(int[][] pic, int row, int col, int oldC, int newC) {\n\n  // Base Cases\n  if(row &lt; 0 || col &lt; 0 || row &gt;= pic.length || col &gt;= pic[row].length) {\n     return;\n  }\n  if(pic[row][col] != oldC) {\n     return;\n  }\n\n  pic[row][col] = newC;\n\n  // recursion\n  floodFill(pic, row + 1, col, oldC, newC);\n  floodFill(pic, row - 1, col, oldC, newC);\n  floodFill(pic, row, col + 1, oldC, newC);\n  floodFill(pic, row, col - 1, oldC, newC);\n}\n</code></pre>\n"}], "owner": {"reputation": 1606, "user_id": 7944978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VLMC.jpg?s=128&g=1", "display_name": "LuminousNutria", "link": "https://stackoverflow.com/users/7944978/luminousnutria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 53804931, "answer_count": 1, "score": 2, "last_activity_date": 1545410332, "creation_date": 1544658838, "last_edit_date": 1544982843, "question_id": 53753141, "link": "https://stackoverflow.com/questions/53753141/translating-c-recursive-floodfill-implementation-for-2d-array-without-any-loop", "title": "Translating C++ recursive floodfill implementation for 2D array without any loops, into Java?", "body": "<p>I am trying to translate a recursive flood-fill implementation that doesn't use any loops. I keep getting a stack overflow error, and I'm not sure why. I have been trying to translate the C++ code <a href=\"https://www.geeksforgeeks.org/flood-fill-algorithm-implement-fill-paint/\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>How can I fix my Java translation of this code?</p>\n\n<p><strong>C++ original code:</strong></p>\n\n<pre><code>// A recursive function to replace previous color 'prevC' at  '(x, y)'  \n// and all surrounding pixels of (x, y) with new color 'newC' and \nvoid floodFillUtil(int screen[][N], int x, int y, int prevC, int newC) \n{ \n// Base cases \nif (x &lt; 0 || x &gt;= M || y &lt; 0 || y &gt;= N) \n    return; \nif (screen[x][y] != prevC) \n    return; \n\n// Replace the color at (x, y) \nscreen[x][y] = newC; \n\n// Recur for north, east, south and west \nfloodFillUtil(screen, x+1, y, prevC, newC); \nfloodFillUtil(screen, x-1, y, prevC, newC); \nfloodFillUtil(screen, x, y+1, prevC, newC); \nfloodFillUtil(screen, x, y-1, prevC, newC); \n} \n</code></pre>\n\n<p><strong>my Java floodFill() method:</strong></p>\n\n<pre><code>public void floodFill(int[][] pic, int row, int col, int oldC, int newC) {\n\n  // Base Cases\n  if(row &lt; 0 || col &lt; 0 || row &gt;= pic.length - 1 || col &gt;= pic[row].length - 1) {\n     return;\n  }\n  if(pic[row][col] != oldC) {\n     return;\n  }\n\n  // recursion\n  floodFill(pic, row++, col, oldC, newC);\n  floodFill(pic, row--, col, oldC, newC);\n  floodFill(pic, row, col++, oldC, newC);\n  floodFill(pic, row, col--, oldC, newC);\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "glsl"], "comments": [{"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1544659325, "post_id": 53753139, "comment_id": 94359264, "body": "I&#39;m going to go through in steps. First of all The cross product from the two vector (BA x BC) should be the correct normal of a triangle if in your setup front is CCW."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1544659469, "post_id": 53753139, "comment_id": 94359313, "body": "Aren&#39;t you pushing positions into your normal&#39;s buffer in ModMesh::generateVBO_Normals()?"}, {"owner": {"reputation": 117, "user_id": 7270040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc0f25cec2c3bffd045b3b9c61234f9?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/7270040/joseph"}, "reply_to_user": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1544660072, "post_id": 53753139, "comment_id": 94359441, "body": "No, im pushing the value of <code>glm::normalize(glm::cross(verta - vertb, vertc - vertb));</code> in the vector normals."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1544660516, "post_id": 53753139, "comment_id": 94359531, "body": "But you&#39;re loading into the VBO from the positions array! See: &quot;void ModMesh::generateVBO_Normals()&quot;"}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1544661237, "post_id": 53753139, "comment_id": 94359688, "body": "You&#39;re possibly going to have errors about normal VBO being shorter than positions VBO and its natural, see my answer."}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 1, "creation_date": 1544680588, "post_id": 53753139, "comment_id": 94363937, "body": "In your fragment shader the light calculations are done in worldspace, so you a have to transform the normal vector to worldspace too (as you do it with the fragment position. <code>normal = transpose(inverse (mat3(iModel))) * iNormal;</code> or at least <code>normal = mat3(iModel) * iNormal;</code>. For now this is no problem, because your model matrix is the identity matrix, but this will become an issue later."}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1544680928, "post_id": 53753139, "comment_id": 94364062, "body": "To direct the normal vectors always to the camera, try <code>vec3 norm = normalize(normal) * sign(dot(normal,viewdir));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 7270040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc0f25cec2c3bffd045b3b9c61234f9?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/7270040/joseph"}, "edited": false, "score": 1, "creation_date": 1544661948, "post_id": 53753332, "comment_id": 94359841, "body": "Aw darn, I thought I was generating vertex normals. As for the positions being pushed into the normals in <code>ModMesh::generateVBO_Normals</code>, I have fixed that. Here is the result I have currently. (Have not yet fixed vertex normals, I have to figure out how to do that now...) <a href=\"https://gyazo.com/7edb2fa481ccdb73ca390a054ac2b649\" rel=\"nofollow noreferrer\">gyazo.com/7edb2fa481ccdb73ca390a054ac2b649</a>"}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "reply_to_user": {"reputation": 117, "user_id": 7270040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc0f25cec2c3bffd045b3b9c61234f9?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/7270040/joseph"}, "edited": false, "score": 0, "creation_date": 1544662410, "post_id": 53753332, "comment_id": 94359918, "body": "Since it seems you&#39;re investigating the subject, I decided not to give you code but a hint into the algorithm... Its just a tiny tad more complicated than what you&#39;ve already accomplished, just a few extra steps looking out for which triangles use each given position (by looking at the indices), and add up the normals you&#39;ve already generated for those triangles and re-normalize them! Ok I shut up now and let you do your work =]"}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "reply_to_user": {"reputation": 117, "user_id": 7270040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc0f25cec2c3bffd045b3b9c61234f9?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/7270040/joseph"}, "edited": false, "score": 0, "creation_date": 1544662590, "post_id": 53753332, "comment_id": 94359950, "body": "By the way it looks way better now, I believe because some of the normals are actually matching the normals each position should have if you were using flat shading, but It should be completely fixed after you code the rest of the algorithm."}, {"owner": {"reputation": 117, "user_id": 7270040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc0f25cec2c3bffd045b3b9c61234f9?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/7270040/joseph"}, "edited": false, "score": 1, "creation_date": 1544662753, "post_id": 53753332, "comment_id": 94359973, "body": "Thank you for taking time out of your day to help me out :)"}], "tags": [], "owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "is_accepted": false, "score": 1, "last_activity_date": 1544660865, "last_edit_date": 1544660865, "creation_date": 1544660531, "answer_id": 53753332, "question_id": 53753139, "link": "https://stackoverflow.com/questions/53753139/glsl-lighting-math-is-messed-up-cannot-find-error/53753332#53753332", "title": "GLSL Lighting math is messed up, cannot find error", "body": "<p>First and foremost you're on the right track with this procedure:\n\"void ModMesh::generateVertexNormals()\". You're generating the front facing normal of each triangle for a front = CCW setup of OpenGL. The thing is, you're generating one normal per triangle and in your vertex shader the normal is passed per vertex. But in your case you generate 1 normal per triangle! What you should after is go through each vertex position, and for each triangle which uses that position get their normal, and then average that normal. That way you smooth out the normals of the triangles at each vertex. Let me explain in a more graphical manner:\n<a href=\"https://i.stack.imgur.com/wX6Fl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wX6Fl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I must add that you're also currently uploading the positions into the VBO normals, but that's what i was telling you about in the comments.</p>\n\n<p>If you actually want flat shading, then, as far as I can think of right now, you gotta ditch the indices and use 3 positions per triangle, each with normals taken from your current normal generation method, triplicated into each position just like in step two of my paint drawing. Pardon my paint by the way.</p>\n"}], "owner": {"reputation": 117, "user_id": 7270040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc0f25cec2c3bffd045b3b9c61234f9?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/7270040/joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544660865, "creation_date": 1544658823, "question_id": 53753139, "link": "https://stackoverflow.com/questions/53753139/glsl-lighting-math-is-messed-up-cannot-find-error", "title": "GLSL Lighting math is messed up, cannot find error", "body": "<p>I have been following the lighting tutorial from learnopengl.com, but for some reason my lighting as been screwed up badly and I don't know why. I have got ambient light to work easily, diffuse is kind of bugged, and specular light is all over the place and I have no idea where to look to fix it.\n<a href=\"https://gyazo.com/f66efc10d41806504e9e34f45415bcfe\" rel=\"nofollow noreferrer\">https://gyazo.com/f66efc10d41806504e9e34f45415bcfe</a>\nI also am unsure if my normals have been made correctly. Here is how I generate them with an <code>std::vector&lt;glm::vec3&gt;</code> of positions and a <code>std::vector&lt;unsigned int&gt;</code> of indices.</p>\n\n<pre><code>void ModMesh::generateVertexNormals() {\n    if(!positions.empty() || !indices.empty()) {\n        normals.clear();\n        for(unsigned int i = 0; i &lt; indices.size(); i += 3) {\n            auto const a = indices[i + 0];\n            auto const b = indices[i + 1];\n            auto const c = indices[i + 2];\n            auto const verta = positions[a];\n            auto const vertb = positions[b];\n            auto const vertc = positions[c];\n            auto const norm = glm::normalize(glm::cross(verta - vertb, vertc - vertb));\n            normals.push_back(norm);\n        }\n    }\n}\n</code></pre>\n\n<p>Here is how I bind my data:</p>\n\n<pre><code>void ModMesh::generateVBO_Positions() {\n    if(positions.empty()) \n        return;\n    glBindBuffer(GL_ARRAY_BUFFER, vbo[VBO::POS]);\n    std::vector&lt;float&gt; p;\n    for(int i = 0; i &lt; positions.size(); i++) {\n        p.push_back(positions[i].x);\n        p.push_back(positions[i].y);\n        p.push_back(positions[i].z);\n    }\n    glBufferData(GL_ARRAY_BUFFER, p.size() * sizeof(float), &amp;p[0], GL_STATIC_DRAW);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);\n    glEnableVertexAttribArray(0);\n}\n\nvoid ModMesh::generateVBO_Normals() {\n    if(normals.empty()) \n        return;\n    glBindBuffer(GL_ARRAY_BUFFER, vbo[VBO::NORM]);\n    std::vector&lt;float&gt; n;\n    for(int i = 0; i &lt; positions.size(); i++) {\n        n.push_back(positions[i].x);\n        n.push_back(positions[i].y);\n        n.push_back(positions[i].z);\n    }\n    glBufferData(GL_ARRAY_BUFFER, n.size() * sizeof(float), &amp;n[0], GL_STATIC_DRAW);\n    glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, 0, 0);\n    glEnableVertexAttribArray(2);\n}\n</code></pre>\n\n<p>Here is my code.</p>\n\n<p>Vertex</p>\n\n<pre><code>#version 330 core\n\nlayout(location = 0) in vec3 iPosition;\nlayout(location = 1) in vec2 iTexcoord;\nlayout(location = 2) in vec3 iNormal;\n\nuniform mat4 iProjection;\nuniform mat4 iView;\nuniform mat4 iModel;\n\nout vec2 texcoord;\nout vec3 normal;\nout vec3 fragpos;\n\nvoid main() {\n   gl_Position = iProjection * iView * iModel * vec4(iPosition, 1.0);\n   texcoord = iTexcoord;\n   normal = iNormal;\n   fragpos = vec3(iModel * vec4(iPosition, 1.0));\n}\n</code></pre>\n\n<p>Fragment </p>\n\n<pre><code>#version 330 core\n\nin vec2 texcoord;\nin vec3 normal;\nin vec3 fragpos;\n\nuniform sampler2D iTexture;\nuniform vec3 iCameraView;\nuniform int iUseTexture = 0;\nout vec4 outputcolor;\n\nstruct Light {\n    vec3 position;\n    vec3 ambient;\n    vec3 diffuse;\n    vec3 specular;\n};\nuniform Light iLight;\n\nstruct Material {\n    vec3 ambient;\n    vec3 diffuse;\n    vec3 specular;\n    float shininess;\n};\nuniform Material iMaterial;\n\nvoid main() {\n\n   float ambientstrength = 0.15;\n   float specularstrength = 0.75;\n\n   vec3 norm = normalize(normal);\n   vec3 lightdir = normalize(iLight.position - fragpos);\n\n   vec3 ambient = iLight.ambient * iMaterial.ambient;\n   vec3 viewdir = normalize(iCameraView - fragpos);\n   vec3 reflectdir = reflect(-lightdir, norm);\n\n   float diff = max(dot(norm, lightdir), 0.0);\n   float spec = pow(max(dot(viewdir, reflectdir), 0.0), iMaterial.shininess);\n\n   vec3 diffuse = (diff * iMaterial.diffuse) * iLight.diffuse;\n   vec3 specular = specularstrength * spec * iLight.specular;\n   vec4 light = vec4(ambient + diffuse + specular, 1.0);\n\n\n   outputcolor = mix(vec4(0.0, 1.0, 0.0, 1.0) * light, texture2D(iTexture, texcoord) * light, iUseTexture); \n}\n</code></pre>\n\n<p>C++ snippet, main.cpp:</p>\n\n<pre><code>olib::Camera cam(0.0f, 0.5, -3.0f); // My camera object, just the position XYZ\nglm::mat4 proj(1.0);\nglm::mat4 view(1.0);\nglm::mat4 model(1.0);\nproj = glm::perspective(glm::radians(45.0f), (float)win.getWidth() / (float)win.getHeight(), 0.1f, 500.0f);\n\nwhile(win.isOpen()) {\n    sh.enable();\n    sh.uniformMat4(\"iProjection\", proj);\n    sh.uniformMat4(\"iView\", view);\n    sh.uniformMat4(\"iModel\", model);\n    sh.uniform3f(\"iCameraView\", cam.getPosition());\n\n    sh.uniform3f(\"iLight.position\", 0, 0.5, -3);\n    sh.uniform3f(\"iLight.ambient\", 0.14, 0.14, 0.14);\n    sh.uniform3f(\"iLight.diffuse\", 0.64, 0.64, 0.64);\n    sh.uniform3f(\"iLight.specular\", 0.84, 0.84, 0.84);    \n    view = cam.getViewMatrix();\n    // Then drawing\n}\n</code></pre>\n\n<p>That's as much data that I believe is important. Incase it's not here is a github. <a href=\"https://github.com/LoneC/OpenGL-Project/tree/master\" rel=\"nofollow noreferrer\">https://github.com/LoneC/OpenGL-Project/tree/master</a></p>\n"}, {"tags": ["c++", "qt", "openmp", "multicore", "fractals"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1544660014, "post_id": 53753076, "comment_id": 94359432, "body": "I think that QImage can not work on several threads at once, you should use a mutex or something similar."}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1544664246, "post_id": 53753076, "comment_id": 94360234, "body": "As a heads up, people generally watch the C++ tag rather than the C++11 tag. You might want to remove one of your tags and replace it with the C++ tag, so more people see your question."}, {"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 1, "creation_date": 1544720140, "post_id": 53753076, "comment_id": 94385170, "body": "Consider the scope of your scalar doubles (newRe,OldRe,...). Is it OK that they are being updated concurrenty by many threads? In C/C++ it is generally preferable to declare variables in the minimal required scope..."}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1548422063, "last_edit_date": 1548422063, "creation_date": 1545302147, "answer_id": 53866940, "question_id": 53753076, "link": "https://stackoverflow.com/questions/53753076/openmp-fractal-generator/53866940#53866940", "title": "OpenMP Fractal Generator", "body": "<p>As pointed in comments, you have two main problems:</p>\n\n<ul>\n<li><code>newRe</code> and <code>newIm</code> are shared, but should not be</li>\n<li><code>r</code>, <code>gr</code> and <code>b</code>'s access is not specified (shared by default I think)</li>\n<li>There is concurrent calls to <code>QImage::setPixel</code></li>\n</ul>\n\n<p>To correct this, do not hesitate to make a <code>omp for</code> loop nested in a <code>omp parallel</code> block.</p>\n\n<p>Declare private variable just before the <code>for</code> loop:</p>\n\n<p>To prevent concurrent calls to <code>QImage::setPixel</code>, <a href=\"https://stackoverflow.com/a/50366141/1212012\">since this function is not thread safe</a>, you can put it in a critical region, with <code>#pragma omp critical</code>.</p>\n\n<hr>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int imageWidth=1000, imageHeight=1000, maxIterations=3000;\n\n    double cRe = -0.7;\n    double cIm = 0.27015;\n\n    QElapsedTimer time;\n    QImage img(imageHeight, imageWidth, QImage::Format_RGB888);//Qimagetesting\n    img.fill(Qt::black);\n    time.start();\n\n    #pragma omp parallel\n    {\n        /* all folowing values will be private */\n        int i,x,y;\n        int r, gr, b;\n        double newRe, newIm, oldRe, oldIm;\n\n        #pragma omp for\n        for(y = 0; y &lt; imageHeight; y++)\n        {            \n            for(x = 0; x &lt; imageWidth; x++)\n            {\n                newRe = newReal(x,imageWidth);\n                newIm = newImaginary(y,imageHeight);\n                i= julia(newRe, newIm, oldRe, oldIm, cRe, cIm, maxIterations);\n\n                r = (3*i % 256);\n                gr = (2*(int)sqrtf(i) % 256);\n                b = (i % 256);\n\n                #pragma omp critical\n                    img.setPixel(x, y, qRgb(r, gr, b));\n             }\n        }\n    }\n\n    img.save(\"julia.png\",\"PNG\", 100);\n\n    cout&lt;&lt;time.elapsed()/1000.00&lt;&lt;\" seconds\"&lt;&lt;endl;\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>To go further, you can save some cpu time replacing <code>::setPixel</code> by <code>::scanLine</code>:</p>\n\n<pre><code>    #pragma omp for\n    for(y = 0; y &lt; imageHeight; y++)\n    {                        \n        uchar *line = img.scanLine(y);\n        for(x = 0; x &lt; imageWidth; x++)\n        {\n            newRe = newReal(x,imageWidth);\n            newIm = newImaginary(y,imageHeight);\n            i= julia(newRe, newIm, oldRe, oldIm, cRe, cIm, maxIterations);\n\n            r = (3*i % 256);\n            gr = (2*(int)sqrtf(i) % 256);\n            b = (i % 256);\n\n            *line++ = r;\n            *line++ = gr;\n            *line++ = b;\n         }\n    }\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Since the julia set seems to have a central symetry around <code>(0,0)</code> point, you can perfom only half of calculus:</p>\n\n<pre><code>int half_heigt = imageHeight / 2;\n#pragma omp for\n\n// compute only for first half of image\nfor(y = 0; y &lt; half_heigt; y++)\n{            \n    for(x = 0; x &lt; imageWidth; x++)\n    {\n        newRe = newReal(x,imageWidth);\n        newIm = newImaginary(y,imageHeight);\n        i= julia(newRe, newIm, oldRe, oldIm, cRe, cIm, maxIterations);\n\n        r = (3*i % 256);\n        gr = (2*(int)sqrtf(i) % 256);\n        b = (i % 256);\n\n        #pragma omp critical\n        {\n            // set the point  \n            img.setPixel(x, y, qRgb(r, gr, b));\n\n            // set the symetric point\n            img.setPixel(imageWidth-1-x, imageHeight-1-y, qRgb(r, gr, b));\n        }\n     }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10783445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MYItYGW4ZyM/AAAAAAAAAAI/AAAAAAAAnPc/5LhyMI-6UQg/photo.jpg?sz=128", "display_name": "Niranjan Rakesh", "link": "https://stackoverflow.com/users/10783445/niranjan-rakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548422063, "creation_date": 1544658318, "last_edit_date": 1544678631, "question_id": 53753076, "link": "https://stackoverflow.com/questions/53753076/openmp-fractal-generator", "title": "OpenMP Fractal Generator", "body": "<p>I've been trying to create an openMP variant of the julia set, but I'm unable to create a coherent image when running more than one thread, I've been trying to solve what looks like a race condition but cannot find the error. \nThe offending output looks like the required output along with \"scanlines\" across the entirety of the picture. </p>\n\n<p>I've attached the code as well if its not clear enough.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;math.h&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;omp.h&gt;\n#include &lt;QtWidgets&gt;\n#include &lt;QElapsedTimer&gt;\nusing namespace std;\n\n\n\ndouble newReal(int x, int imageWidth){\n    return 1.5*(x - imageWidth / 2)/(0.5 * imageWidth);\n}\n\ndouble newImaginary(int y, int imageHeight){\n    return (y - imageHeight / 2) / (0.5 * imageHeight);\n}\n\nint julia(double&amp; newReal, double&amp; newImaginary, double&amp; oldReal, double&amp; oldImaginary, double cRe, double cIm,int maxIterations){\n    int i;\n    for(i = 0; i &lt; maxIterations; i++){\n      oldReal = newReal;\n      oldImaginary = newImaginary;\n      newReal = oldReal * oldReal - oldImaginary * oldImaginary + cRe;\n      newImaginary = 2 * oldReal * oldImaginary + cIm;\n      if((newReal * newReal + newImaginary * newImaginary) &gt; 4) break;\n    }\n    return i;\n}\nint main(int argc, char *argv[])\n{\n    int fnum=atoi(argv[1]);\n    int numThr=atoi(argv[2]);\n//    int imageHeight=atoi(argv[3]);\n//    int imageWidth=atoi(arg[4]);\n//    int maxIterations=atoi(argv[5]);\n//    double cRe=atof(argv[3]);\n//    double cIm=atof(argv[4]);\n    //double cRe, cIm;\n    int imageWidth=10000, imageHeight=10000, maxIterations=3000;\n    double newRe, newIm, oldRe, oldIm,cRe,cIm;\n    cRe = -0.7;\n    cIm = 0.27015;\n    string fname;\n    QElapsedTimer time;\n    QImage img(imageHeight, imageWidth, QImage::Format_RGB888);//Qimagetesting\n    img.fill(QColor(Qt::black).rgb());//Qimagetesting\n    time.start();\n    int i,x,y;\n    int r, gr, b;\n#pragma omp parallel for shared(imageHeight,imageWidth,newRe,newIm) private(x,y,i) num_threads(3)\n        for(y = 0; y &lt; imageHeight; y++)\n        {\n            for(x = 0; x &lt; imageWidth; x++)\n            {\n                newRe = newReal(x,imageWidth);\n                newIm = newImaginary(y,imageHeight);\n                i= julia(newRe, newIm, oldRe, oldIm, cRe, cIm, maxIterations);\n\n                r = (3*i % 256);\n                gr = (2*(int)sqrt(i) % 256);\n                b = (i % 256);\n                img.setPixel(x, y, qRgb(r, gr, b));\n             }\n        }\n\n    //stringstream s;\n    //s &lt;&lt; fnum;\n    //fname= \"julia\" + s.str();\n    //fname+=\".png\";\n    //img.save(fname.c_str(),\"PNG\", 100);\n    img.save(\"julia.png\",\"PNG\", 100);\n    cout&lt;&lt; \"Finished\"&lt;&lt;endl;\n    cout&lt;&lt;time.elapsed()/1000.00&lt;&lt;\" seconds\"&lt;&lt;endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "access-modifiers"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1544658484, "post_id": 53753074, "comment_id": 94359036, "body": "Because of <code>protected</code> inheritance, only <code>D</code> and classes derived from <code>D</code> know that <code>D</code> is a <code>B</code> and can access <code>B</code> and <code>A</code> members. <code>main</code> is not derived from <code>D</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1544658683, "post_id": 53753074, "comment_id": 94359097, "body": "<i>&quot;So, I think D can access A class member&quot;</i> You are correct, but it&#39;s <code>main</code> that is trying to access <code>A::w</code>, not a member function of <code>D</code>."}], "answers": [{"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 3, "last_activity_date": 1544658801, "creation_date": 1544658801, "answer_id": 53753135, "question_id": 53753074, "link": "https://stackoverflow.com/questions/53753074/i-cant-understand-this-access-modifier/53753135#53753135", "title": "I cant understand this access modifier", "body": "<p><code>D</code> can see members of <code>A</code> and <code>B</code>, but because of <code>protected</code> inheritance, only <code>D</code> and classes derived from <code>D</code> know that <code>D</code> is a <code>B</code> and can access <code>B</code> and <code>A</code> members. <code>main</code> is not derived from <code>D</code>, so <code>main</code> is not aware of <code>D</code>'s inheritance of <code>B</code> and thus cannot access the inherited <code>A</code> and <code>B</code> members.</p>\n"}], "owner": {"reputation": 61, "user_id": 10752744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uBo4vJZ7ig0/AAAAAAAAAAI/AAAAAAAAADE/PdR0mwodCnU/photo.jpg?sz=128", "display_name": "Samuel", "link": "https://stackoverflow.com/users/10752744/samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53753135, "answer_count": 1, "score": 4, "last_activity_date": 1544658801, "creation_date": 1544658314, "question_id": 53753074, "link": "https://stackoverflow.com/questions/53753074/i-cant-understand-this-access-modifier", "title": "I cant understand this access modifier", "body": "<p>I am the beginner of C++. And I have a programming test today. But I cant understand this examples. </p>\n\n<pre><code>class A\n{\npublic:\n    int w;\n};\n\nclass B : public A\n{\npublic:\n    int x;\n};\n\nclass C : private A\n{\npublic: int y;\n};\n\nclass D : protected B\n{\npublic: int z;\n};\n\nint main()\n{\n    D d;\n    d.w = 10; // compile error\n}\n</code></pre>\n\n<p>I thought (D d; d.w = 10) is correct, but it has compile error. </p>\n\n<p>D derived by B (protected), and B derived by A (public). \nSo, I think D can access A class member, because </p>\n\n<p>Class B : public A\n{ public:int x} \n==>\nClass B\n{ public: int w; int x;}</p>\n\n<p>and Class D : protected B \n{ public: int z}\n==>\nclass D\n{public: int z; protected: int w, int x;}</p>\n\n<p>Why I am wrong?? Thank you!</p>\n"}, {"tags": ["c++", "opengl", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 3, "creation_date": 1544659997, "post_id": 53752944, "comment_id": 94359428, "body": "Why? <code>Object* obj1 = new Object();</code> No need to call new here."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 2, "creation_date": 1544660041, "post_id": 53752944, "comment_id": 94359436, "body": "This is not closed: <code>FILE *f = popen()</code>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1544660096, "post_id": 53752944, "comment_id": 94359447, "body": "If this code is running. i.e. it basically works. You can get a review at <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1544660197, "post_id": 53752944, "comment_id": 94359475, "body": "Why? <code>SphereMesh* sphere = new SphereMesh();</code> Just do this: <code>SphereMesh sphere{};</code>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 3, "creation_date": 1544660448, "post_id": 53752944, "comment_id": 94359520, "body": "<code>the program never really releases any memory</code>. That;s pretty normal. Once an application get memory from the OS it never gives it back. It will manage that memory internally until it dies."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 3, "creation_date": 1544660639, "post_id": 53752944, "comment_id": 94359556, "body": "Stop doing: <code>typedef struct { &#47;* STUFF*&#47; } StructName;</code> this is just C. Simply do: <code>struct StructName { &#47;* STUFF*&#47; };</code> In C++ (unlike C) the structures are in the same name space as other identifiers (don&#39;t confuse with C++ namespace)."}, {"owner": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1544660861, "post_id": 53752944, "comment_id": 94359611, "body": "wouah thank you ,a lot of good infos here :)"}, {"owner": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1544660907, "post_id": 53752944, "comment_id": 94359625, "body": "so am I seeing an issue where there&#39;s none , memory wise ?"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1544661323, "post_id": 53752944, "comment_id": 94359699, "body": "I don&#39;t think you have an issue based on this sample. I do think your code needs a review from an experienced C++ engineer. Your usage of new is very none typical (also bad as it leaves you vulnerable to leaks when there are exceptions). Looking at your project. I would pick a class get it reviewed. Apply the review to your whole code base yourself. Then get the next class reviewed. Repeat until the whole project is reviewed."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1544661477, "post_id": 53752944, "comment_id": 94359735, "body": "You can also have code review badges added to your README.md on the github repo. See: <a href=\"https://github.com/Loki-Astari/ThorsSerializer/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/Loki-Astari/ThorsSerializer/blob/master/README.md</a>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1544661938, "post_id": 53752944, "comment_id": 94359837, "body": "Looking at your code. Application/Object/Texture/Window all leak (destructor is not incorrect). None of them obey the rule of three or five. As a result your other classes that use them don&#39;t obey the rule of zero. Does not seem like you know about move semantics or RAII."}, {"owner": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1544664224, "post_id": 53752944, "comment_id": 94360228, "body": "Alright ... I have a lot of work to do :) , I started removing some &#39;new&#39; calls already.  No I don&#39;t know anyting about the rules you&#39;re talking about. I will check this right away.  Woua , C++ can be pretty overwhelming I would say, not easy to grasp, but I will slowly get there. thanks a lot."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "edited": false, "score": 0, "creation_date": 1545165150, "post_id": 53754096, "comment_id": 94529601, "body": "Hi, I\u2019m afraid it\u2019s a little too complicated for me. Too many concepts I don\u2019t yet have a grasp on. l wouldn\u2019t know where to begin."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "reply_to_user": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "edited": false, "score": 0, "creation_date": 1545169957, "post_id": 53754096, "comment_id": 94531440, "body": "@gui2one Yeah it does take time and effort to learn them, and when you think you have a handle on it and you think you know all you need to know; you will realize just how much of a beginner you are."}], "tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": false, "score": 0, "last_activity_date": 1544667084, "creation_date": 1544667084, "answer_id": 53754096, "question_id": 53752944, "link": "https://stackoverflow.com/questions/53752944/struggling-with-memory-management-in-c-and-opengl/53754096#53754096", "title": "struggling with memory management in c++ and opengl", "body": "<p>It's quite hard to tell just by reading your source without sitting there and stepping through a debugger looking at all of the dynamic memory allocation and deallocation of objects manually. This is a quite cumbersome task. It can be quite difficult to give a decisive answer. One thing I can do here is to provide you with some suggestions as I have built 3D graphics engines in the past. </p>\n\n<p>You have already mentioned the fact of eliminating or minimizing the use of <code>new</code> and <code>delete</code> which is a very good start. What I'm about to propose is a design pattern and is mostly pseudo code of the structure. What you can do here is create a class that is responsible for all of the 3D Engines Assets that will manage your memory. This is not an easy task to achieve, but once you have the framework in place and working correctly it will help to make your code base and code management much easier. </p>\n\n<p>You can create a class that will store all of your assets. However, to do so you will need common structures or classes for different objects. It may look something like this:</p>\n\n<pre><code>class AssetStorageManager {\nprivate:\n    std::vector&lt;std::shared_ptr&lt;Texture&gt;&gt; textures_;\n    std::vector&lt;std::shared_ptr&lt;Font&gt;&gt;    fonts_;\n    std::vector&lt;std::shared_ptr&lt;Model&gt;&gt;   models_;\n    std::vector&lt;std::shard_ptr&lt;GUI&gt;&gt;      guiObjects_; // Text Boxes, Buttons etc.\n    // other possible containers: Music(BGM), SoundEffects etc.\n    // shaders (Vertex, Fragment, Geometry &amp; OpenGL Programs)...\npublic:\n    AssetStorageManager() = default;\n    ~AssetStorageManager() = default;\n\n    void addTexture( const Texture&amp; texture ) { /* ... ; */ }\n    void removeTexture( unsigned int textureID ) { /* ... ; */ }\n    void clearTextures() { /* remove all textures in container; */ }\n    Texture* getTexture( unsigned int texureID );\n\n    // basically the same 4 for all of your individual containers.\n};\n</code></pre>\n\n<p>Sometimes a <code>vector</code> may not suffice, you may need a <code>map</code>, <code>unordered map</code>, <code>multimap</code>, <code>list</code>, <code>queue</code>(with priority), etc. It all depends on the need for which container you need. </p>\n\n<p>This class will be responsible for managing memory. Another thing to consider is this; while the application is running you will only ever need a single instance of this class object, This is where a <code>Singleton</code> type object can be useful. If you make this class a <code>Singleton</code> object it would need to be created and initialized before you load any kind of objects from files to store them. </p>\n\n<hr>\n\n<p>In my engine these are the types of singletons that I have, however, they inherit from a <code>Singleton</code> base class:</p>\n\n<p><em>-Singleton.h-</em></p>\n\n<pre><code>namespace /* namespace name here*/ {\n\n#ifndef SINGELTON_H\n#define SINGLETON_H\n\nclass Singleton {\npublic:\n    enum SingletonType {\n        LOGGER = 0, // Must be first!\n        SETTINGS,\n        ENGINE,\n        ANIMATION_MANAGER,\n        SHADER_MANGER,\n        ASSET_STORAGE,\n        AUDIO_MANAGER,\n        FONT_MANAGER,\n        BATCH_MANAGER\n    };\nprivate:\n    SingletonType type_;\npublic:\n     virtual ~Singleton();\nprotected:\n     explicit Singleton( SingletonType eType );\n\n     void logMemoryAllocation( bool isAllocated ) const;\nprivate:\n     Singleton( const Singleton&amp; c ); // not implemented\n     Singleton&amp; operator=( const Singleton&amp; c ); // not implemented            \n}; \n\n} // /*namespace name here */\n\n#endif // SINGLETON_H\n</code></pre>\n\n<p><em>-Singelton.cpp-</em></p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"Singleton.h\"\n\n#include \"Logger.h\"\n#include \"Settings.h\"\n\nnamespace /* namespace name here*/ {\n\nstruct SingletonInfo {\n    const std::string strSingletonName;\n    bool              isConstructed;\n\n    SingletonInfo( const std::string&amp; strSingletonNameIn ) :\n        strSingletonName( strSingletonNameIn ),\n        isConstructed( false )\n    {}\n};\n\n// Order Must Match Types Defined In Singleton::SingeltonType enum\nstatic std::array&lt;SingletonInfo, 9&gt; s_aSingletons = { SingletonInfo( \"Logger\" ),\n                                                      SingletonInfo( \"Settings\" ),\n                                                      SingletonInfo( \"Engine\" ),\n                                                      SingletonInfo( \"AnimationManager\" ),\n                                                      SingletonInfo( \"ShaderManager\" ),\n                                                      SingletonInfo( \"AssetStorage\" ),                                                  \n                                                      SingletonInfo( \"AudioManager\" ), \n                                                      SingletonInfo( \"FontManager\" ),\n                                                      SingletonInfo( \"BatchManager\" ) };\n\nSingleton::Singleton( SingletonType eType ) :\nm_eType( eType ) {\n    bool bSaveInLog = s_aSingletons.at( TYPE_LOGGER ).isConstructed;\n\n    try {\n        if ( !s_aSingletons.at( eType ).isConstructed ) {\n            // Test Initialization Order\n            for ( int i = 0; i &lt; eType; ++i ) {\n                if ( !s_aSingletons.at( i ).isConstructed ) {\n                    throw ExceptionHandler( s_aSingletons.at( i ).strSingletonName + \" must be constructued before constructing \" + s_aSingletons.at( eType ).strSingletonName, bSaveInLog );\n                }\n            }\n            s_aSingletons.at( eType ).isConstructed = true;\n\n            if ( s_aSingletons.at( TYPE_ENGINE ).isConstructed &amp;&amp; \n                 Settings::get()-&gt;isDebugLoggingEnabled( Settings::DEBUG_MEMORY ) ) {\n                logMemoryAllocation( true );\n            }\n\n        } else {\n            throw ExceptionHandler( s_aSingletons.at( eType ).strSingletonName + \" can only be constructed once.\", bSaveInLog );\n        }\n    } catch ( std::exception&amp; ) {\n        // eType Is Out Of Range\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" Invalid Singelton Type sepcified: \" &lt;&lt; eType;\n        throw ExceptionHandler( strStream, bSaveInLog );\n    }\n}    \n\nSingleton::~Singleton() {\n    if ( s_aSingletons.at( TYPE_ENGINE ).isConstructed &amp;&amp;\n         Settings::get()-&gt;isDebugLoggingEnabled( Settings::DEBUG_MEMORY ) ) {\n        logMemoryAllocation( false );\n    }\n    s_aSingletons.at( m_eType ).isConstructed = false;\n}    \n\nvoid Singleton::logMemoryAllocation( bool isAllocated ) const {\n    if ( isAllocated ) {\n        Logger::log( \"Created \" + s_aSingletons.at( m_eType ).strSingletonName );\n    } else {\n        Logger::log( \"Destroyed \" + s_aSingletons.at( m_eType ).strSingletonName );\n    }\n}\n\n} // /*namespace name here */\n</code></pre>\n\n<p>This is the base class for all of my <code>Singleton</code> objects that manages different components of my engine. There are other classes involved such as a <code>Logger</code>, <code>Settings</code>, <code>BatchManager</code>, etc. all of which are <code>Singleton</code>s themselves that I won't show here. This will not compile on your machine. </p>\n\n<p>My <code>AssetStorage</code> class that inherits from this looks as such:</p>\n\n<p><em>-AssetStorage.h</em>-</p>\n\n<pre><code>#ifndef ASSET_STORAGE_H\n#define ASSET_STORAGE_H\n\n#include \"Singleton.h\"\n#include \"CommonStructs.h\"\n\nnamespace /*namespace name here*/ {\n\nclass BaseMko;\nclass GuiElement;\nenum GuiType;\n\nstruct Texture {\n    bool        hasAlphaChannel;\n    bool        generateMipMap;\n    bool        wrapRepeat;\n    unsigned    uWidth;\n    unsigned    uHeight;\n    TextureInfo::FilterQuality filterQuality;\n    std::vector&lt;unsigned char&gt; vPixelData;\n\n    Texture( TextureInfo::FilterQuality filterQualityIn, bool generateMipMapIn, bool wrapRepeatIn ) :\n        hasAlphaChannel( false ),\n        generateMipMap( generateMipMapIn ),\n        wrapRepeat( wrapRepeatIn ),\n        uWidth( 0 ),\n        uHeight( 0 ),\n        filterQuality( filterQualityIn )\n    {}\n}; // Texture\n\nclass AssetStorage sealed : public Singleton {\nprivate:\n    typedef std::unordered_map&lt;std::string, std::shared_ptr&lt;BaseMko&gt;&gt;       MapMkoAssets;\n    typedef std::unordered_map&lt;std::string, TextureInfo&gt;                    MapTextureInfos;\n    typedef std::unordered_map&lt;std::string, std::shared_ptr&lt;GuiElement&gt;&gt;    MapGuiAssets;\n\n    MapMkoAssets    m_mkoAssets;\n    MapTextureInfos m_textureInfos;\n    MapGuiAssets    m_guiScreenAssets;\n    MapGuiAssets    m_guiRenderableAssets;\n\n    std::vector&lt;std::string&gt; m_vGuiForRemoval;\n\npublic:\n    AssetStorage();\n    virtual ~AssetStorage();\n\n    static AssetStorage* const get();\n\n    // Mko Objects\n    BaseMko*    getMko( const std::string&amp; strId ) const;\n    void        add( BaseMko* pMko );\n    bool        removeMko( const std::string&amp; strId, bool removeTexture = false );\n    void        showLoadedMkoObjects() const;\n\n    // Texture Objects\n    TextureInfo getTextureInfo( const std::string&amp; strFilename ) const;\n    TextureInfo add( const Texture&amp; texture, const std::string&amp; strFilename );\n    bool        removeTextureInfo( const std::string&amp; strFilename );\n    bool        removeTextureInfo( unsigned uTextureId );\n    void        showLoadedTextureInfo() const;\n\n    // Gui Objects\n    GuiElement* getGuiElement( const std::string&amp; strId, GuiType type ) const;\n    void        add( GuiElement* pGui, GuiType type );\n    bool        removeGuiElement( const std::string&amp; strId, bool removeTextures = false );\n    template&lt;typename T&gt;\n    bool        removeGuiElement( T* pGui, bool removeTextures = false );\n    void        markGuiForRemoval( const std::string&amp; strId );\n    void        cleanOrphanedGuiObjects();\n    void        showLoadedGuiObjects() const;\n\nprivate:\n    AssetStorage( const AssetStorage&amp; c ) = delete; // Not Implemented\n    AssetStorage&amp; operator=( const AssetStorage&amp; c ) = delete; // Not Implemented\n\n    // Gui Objects\n    GuiElement* getGuiElement( const std::string&amp; strId, const MapGuiAssets&amp; guiMap ) const;\n    void        add( GuiElement* pGui, MapGuiAssets&amp; guiMap );\n    bool        removeGuiElement( const std::string&amp; strId, MapGuiAssets&amp; guiMap, bool removeTextures );\n}; // AssetStorage\n\ntemplate&lt;typename T&gt;\ninline bool AssetStorage::removeGuiElement( T * pGui, bool removeTextures ) {\n    return false;\n}\n\n} // /*namespace name here*/\n\n#endif // ASSET_STORAGE_H\n</code></pre>\n\n<p><em>-AssetStorage.cpp-</em></p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"AssetStorage.h\"\n\n#include \"BaseMko.h\"\n#include \"BlockThread.h\"\n#include \"Logger.h\"\n#include \"Settings.h\"\n#include \"GuiScreen.h\"\n#include \"GuiRenderable.h\"\n\nnamespace /*namespace name here*/ {\n\n// Core OpenGL API Found In Opengl32.lib\n#ifdef __cplusplus\n    extern \"C\" {\n#endif\nGLAPI void APIENTRY glBindTexture( GLenum target, GLuint texture );\nGLAPI void APIENTRY glDeleteTextures( GLsizei n, const GLuint *textures );\nGLAPI void APIENTRY glGenTextures( GLsizei n, GLuint *textures );\nGLAPI void APIENTRY glTexImage2D( GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, const GLvoid *pixels );\nGLAPI void APIENTRY glTexParameteri( GLenum target, GLenum pname, GLint param );\n#ifdef __cplusplus\n    }\n#endif\n\n// OpenGl Texture API\nstatic PFNGLGENERATEMIPMAPPROC glGenerateMipmap = nullptr;\n\nstatic Settings*        s_pSettings     = nullptr;\nstatic AssetStorage*    s_pAssetStorage = nullptr;\n\nstatic CRITICAL_SECTION s_criticalSection;\n\nstatic void defineOpenglApi() {\n    std::ostringstream strStream;\n    strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" Can not initialize function pointer named: \";\n    std::string strApiName;\n\n    if ( Settings::get()-&gt;getOpenglVersion().x &gt;= 3 ) {\n        strApiName = \"glGenerateMipmap\";\n        if ( ( glGenerateMipmap = (PFNGLGENERATEMIPMAPPROC)wglGetProcAddress( strApiName.c_str() ) ) == nullptr ) {\n            strStream &lt;&lt; strApiName;\n            throw ExceptionHandler( strStream );\n        }\n    }\n\n}    \n\nAssetStorage::AssetStorage() :\nSingleton( TYPE_ASSET_STORAGE ) {\n    InitializeCriticalSection( &amp;s_criticalSection );    \n    defineOpenglApi();    \n    s_pSettings = Settings::get();\n    s_pAssetStorage = this;\n}\n\nAssetStorage::~AssetStorage() {\n    s_pAssetStorage = nullptr;\n\n    m_mkoAssets.clear();\n    m_guiRenderableAssets.clear();\n    m_guiScreenAssets.clear();\n\n    for( MapTextureInfos::iterator itTexture = m_textureInfos.begin(); itTexture != m_textureInfos.end(); ++itTexture ) {\n        if ( s_pSettings-&gt;isDebugLoggingEnabled( Settings::DEBUG_MEMORY ) ) {\n            Logger::log( std::string( \"Destroyed \" ) + itTexture-&gt;first );\n        }\n        glDeleteTextures( 1, &amp;(itTexture-&gt;second.uTextureId ) );\n    }\n    m_textureInfos.clear();\n\n    DeleteCriticalSection( &amp;s_criticalSection );\n}    \n\nAssetStorage* const AssetStorage::get() {\n    if ( nullptr == s_pAssetStorage ) {\n        throw ExceptionHandler( __FUNCTION__ + std::string( \" failed, AssetStorage has not been constructed yet\" ) );\n    }\n    return s_pAssetStorage;\n} \n\nBaseMko* AssetStorage::getMko( const std::string&amp; strId ) const {\n    BlockThread blockThread( s_criticalSection );\n\n    MapMkoAssets::const_iterator itMkoAssets = m_mkoAssets.find( strId );\n    if ( itMkoAssets == m_mkoAssets.cend() ) {\n        return nullptr;\n    }\n    return itMkoAssets-&gt;second.get();\n}\n\nvoid AssetStorage::add( BaseMko* pMko ) {\n    if ( nullptr == pMko ) {\n        throw ExceptionHandler( __FUNCTION__ + std::string( \" pMko==nullptr passed in\" ) );\n    }\n    if ( nullptr != getMko( pMko-&gt;getId() ) ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" attempting to store \" &lt;&lt; pMko-&gt;getId() &lt;&lt; \" multiple times\";\n        throw ExceptionHandler( strStream );\n    }\n\n    BlockThread blockThread( s_criticalSection );\n    m_mkoAssets.insert( MapMkoAssets::value_type( pMko-&gt;getId(), std::shared_ptr&lt;BaseMko&gt;( pMko ) ) );\n}    \n\nbool AssetStorage::removeMko( const std::string&amp; strId, bool removeTexture ) {\n    BlockThread blockThread( s_criticalSection );\n    MapMkoAssets::iterator itMkoAsset = m_mkoAssets.find( strId );\n    if ( itMkoAsset == m_mkoAssets.end() ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed. \" &lt;&lt; strId &lt;&lt; \" was not found in Asset Storage\";\n        Logger::log( strStream );\n        return false;\n    }\n\n    if ( removeTexture ) {\n        itMkoAsset-&gt;second-&gt;clearTextureInfos();        \n    }\n    m_mkoAssets.erase( itMkoAsset );\n\n    return true;\n}     \n\nvoid AssetStorage::showLoadedMkoObjects() const {\n    BlockThread blockThread( s_criticalSection );\n    if ( m_mkoAssets.size() &gt; 0 ) {\n        Logger::log( \"Loaded mko objects listed below: \", Logger::TYPE_CONSOLE );\n        for each( const std::pair&lt;std::string, std::shared_ptr&lt;BaseMko&gt;&gt;&amp; mko in m_mkoAssets ) {\n            std::ostringstream strStream;\n            strStream &lt;&lt; \"mkoId(\" &lt;&lt; mko.first &lt;&lt; \") \";\n            Logger::log( strStream, Logger::TYPE_CONSOLE );\n        }\n    } else {\n        Logger::log( \"There are no loaded mko objects.\", Logger::TYPE_CONSOLE );\n    }\n    Logger::log( \" \", Logger::TYPE_CONSOLE );\n}\n\nTextureInfo AssetStorage::getTextureInfo( const std::string&amp; strFilename ) const {\n    BlockThread blockThread( s_criticalSection );\n    MapTextureInfos::const_iterator itTexture = m_textureInfos.find( strFilename );\n    if ( itTexture == m_textureInfos.cend() ) {\n        return TextureInfo();\n    }\n    return itTexture-&gt;second;\n}\n\n// This Can Only Be Called From The Main OpenGL Thread\nTextureInfo AssetStorage::add( const Texture&amp; texture, const std::string&amp; strFilename ) {\n    if ( INVALID_UNSIGNED != getTextureInfo( strFilename ).uTextureId ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" can not store \" &lt;&lt; strFilename &lt;&lt; \" multiple times\";\n        throw ExceptionHandler( strStream );\n    }\n\n    TextureInfo textureInfo;\n    textureInfo.hasTransparency = texture.hasAlphaChannel;\n    textureInfo.size = glm::uvec2( texture.uWidth, texture.uHeight );\n\n    glGetError(); // Clear Errors\n\n    glGenTextures( 1, &amp;textureInfo.uTextureId );\n\n    GLenum err = glGetError();\n    if ( err != GL_NO_ERROR ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed glGenTextures with error code 0x\" &lt;&lt; std::hex &lt;&lt; err;\n        throw ExceptionHandler( strStream );\n    }\n\n    glBindTexture( GL_TEXTURE_2D, textureInfo.uTextureId );\n\n    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, ( texture.wrapRepeat ? GL_REPEAT : GL_CLAMP_TO_EDGE ) );\n    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, ( texture.wrapRepeat ? GL_REPEAT : GL_CLAMP_TO_EDGE ) );\n\n    const glm::uvec2&amp; openglVersion = s_pSettings-&gt;getOpenglVersion();\n\n    if ( texture.generateMipMap ) {\n        switch ( texture.filterQuality ) {\n            case TextureInfo::FILTER_NONE : {\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST );\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST_MIPMAP_NEAREST );\n                break;\n            }\n            case TextureInfo::FILTER_GOOD: {\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST );\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST_MIPMAP_LINEAR );\n                break;\n            }\n            case TextureInfo::FILTER_BEST: {\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR );\n                break;\n            }\n            default: {\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_NEAREST );\n            }\n        } // Switch\n\n        if ( openglVersion.x &lt; 3 ) {\n            // In OpenGL v3 GL_GENERATE_MIPMAP Is Deprecated, And In 3.1+ It Was Removed\n            // So For Those Versions We Use glGenerateMipmap below\n            static const unsigned int GL_GENERATE_MIPMAP = 0x8191;\n            glTexParameteri( GL_TEXTURE_2D, GL_GENERATE_MIPMAP, GL_TRUE );\n        }\n    } else { // No MipMaps\n        switch( texture.filterQuality ) {\n            case TextureInfo::FILTER_NONE:\n            case TextureInfo::FILTER_GOOD: {\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST );\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST );\n                break;\n            }\n            default: {\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );\n                glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );\n            }\n        } \n    }\n\n    // Load Texture Into Video Memory\n    glPixelStorei( GL_UNPACK_ALIGNMENT, texture.hasAlphaChannel ? 4 : 1 );\n    glTexImage2D( GL_TEXTURE_2D,\n        0,\n        ( texture.hasAlphaChannel ? GL_RGBA8 : GL_RGB8 ),\n        texture.uWidth,\n        texture.uHeight,\n        0,\n        ( texture.hasAlphaChannel ? GL_RGBA : GL_RGB ),\n        GL_UNSIGNED_BYTE,\n        &amp;texture.vPixelData[0] );\n\n    if ( texture.generateMipMap &amp;&amp; openglVersion.x &gt;= 3 ) {\n        glGenerateMipmap( GL_TEXTURE_2D );\n    }\n\n    // Store TextureId\n    BlockThread blockThread( s_criticalSection );\n    m_textureInfos.insert( MapTextureInfos::value_type( strFilename, textureInfo ) );\n\n    if ( s_pSettings-&gt;isDebugLoggingEnabled( Settings::DEBUG_MEMORY ) ) {\n        Logger::log( std::string( \"Created \" ) + strFilename );\n    }\n\n    return textureInfo;\n}    \n\nbool AssetStorage::removeTextureInfo( const std::string&amp; strFilename ) {\n    MapTextureInfos::iterator itTexture = m_textureInfos.find( strFilename );\n    if ( itTexture == m_textureInfos.end() ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed. \" &lt;&lt; strFilename &lt;&lt; \" was not found in Asset Storage\";\n        Logger::log( strStream );\n\n        return false;\n    }\n\n    if ( s_pSettings-&gt;isDebugLoggingEnabled( Settings::DEBUG_MEMORY ) ) {\n        Logger::log( std::string( \"Destroyed \" ) + strFilename );\n    }\n\n    glDeleteTextures( 1, &amp;(itTexture-&gt;second.uTextureId) );\n    m_textureInfos.erase( itTexture );\n\n    return true;\n}     \n\nbool AssetStorage::removeTextureInfo( unsigned uTextureId ) {\n    for ( MapTextureInfos::iterator itTexture = m_textureInfos.begin(); itTexture != m_textureInfos.end(); ++itTexture ) {\n        if ( uTextureId == itTexture-&gt;second.uTextureId ) {\n            if ( s_pSettings-&gt;isDebugLoggingEnabled( Settings::DEBUG_MEMORY ) ) {\n                Logger::log( std::string( \"Destroyed \" ) + itTexture-&gt;first );\n            }\n\n            glDeleteTextures( 1, &amp;uTextureId );\n            m_textureInfos.erase( itTexture );\n\n            return true;\n        }\n    }\n\n    std::ostringstream strStream;\n    strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed. TextureId[\" &lt;&lt; uTextureId &lt;&lt; \"] was not found in AssetStorage\";\n    Logger::log( strStream, Logger::TYPE_WARNING );\n\n    return false;\n}     \n\nvoid AssetStorage::showLoadedTextureInfo() const {\n    BlockThread blockThread( s_criticalSection );\n    Logger::log( \"Loaded textures listed below: \", Logger::TYPE_CONSOLE );\n    for each ( const std::pair&lt;std::string, TextureInfo&gt;&amp; texture in m_textureInfos ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; \"textureId(\" &lt;&lt; texture.second.uTextureId &lt;&lt; \") \"\n            &lt;&lt; \"transparency(\" &lt;&lt; ( texture.second.hasTransparency ? \"Y\" : \"N\" ) &lt;&lt; \") \"\n            &lt;&lt; \"size\" &lt;&lt; texture.second.size &lt;&lt; \" \"\n            &lt;&lt; texture.first &lt;&lt; std::endl;\n        Logger::log( strStream, Logger::TYPE_CONSOLE );\n    }\n    Logger::log( \" \", Logger::TYPE_CONSOLE );\n}     \n\nGuiElement* AssetStorage::getGuiElement( const std::string&amp; strId, GuiType type ) const {\n    switch( type ) {\n        case GUI_SCREEN: {\n            return getGuiElement( strId, m_guiScreenAssets );\n        }\n        case GUI_RENDERABLE: {\n            return getGuiElement( strId, m_guiRenderableAssets );   \n        }\n        default : {\n            std::ostringstream strStream;\n            strStream &lt;&lt; __FUNCTION__ &lt;&lt; \"Unrecognzied guiType = \" &lt;&lt; type;\n            throw ExceptionHandler( strStream );\n        }\n    }\n    return nullptr; \n\n}     \n\nGuiElement* AssetStorage::getGuiElement( const std::string&amp; strId, const MapGuiAssets&amp; guiMap ) const {\n    BlockThread blockThread( s_criticalSection );\n    MapGuiAssets::const_iterator itGuiAsset = guiMap.find( strId );\n    if ( itGuiAsset == guiMap.cend() ) {\n        return nullptr;\n    }\n    return itGuiAsset-&gt;second.get();\n}\n\nvoid AssetStorage::add( GuiElement* pGui, GuiType type ) {\n    if ( nullptr == pGui ) {\n        throw ExceptionHandler( __FUNCTION__ + std::string( \" pGui==nullptr passed in\" ) );\n    }\n\n    // Make Sure Name Is Unique Across All GuiElement Types\n    for ( int i = 0; i &lt; GUI_UKNOWN; ++i ) {\n        if ( getGuiElement( pGui-&gt;getId(), (GuiType)i ) != nullptr ) {\n            std::ostringstream strStream;\n            strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" attempting to store \" &lt;&lt; pGui-&gt;getId() &lt;&lt; \" multiple times\";\n            throw ExceptionHandler( strStream );\n        }\n    }\n\n    switch( type ) {\n        case GUI_SCREEN: {\n            add( pGui, m_guiScreenAssets );\n            break;\n        }\n        case GUI_RENDERABLE: {\n            add( pGui, m_guiRenderableAssets );\n            break;\n        }\n        default: {\n            std::ostringstream strStream;\n            strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" unrecognized GuiType = \" &lt;&lt; type;\n        }\n    }\n}     \n\nvoid AssetStorage::add( GuiElement* pGui, MapGuiAssets&amp; guiMap ) {\n    BlockThread blockThread( s_criticalSection );\n    guiMap.insert( MapGuiAssets::value_type( pGui-&gt;getId(), std::shared_ptr&lt;GuiElement&gt;( pGui ) ) );\n}\n\ntemplate&lt;&gt;\nbool AssetStorage::removeGuiElement( GuiScreen* pGui, bool removeTextures ) {\n    return removeGuiElement( pGui-&gt;getId(), m_guiScreenAssets, removeTextures );\n}     \n\ntemplate&lt;&gt;\nbool AssetStorage::removeGuiElement( GuiRenderable* pGui, bool removeTextures ) {\n    return removeGuiElement( pGui-&gt;getId(), m_guiRenderableAssets, removeTextures );\n}     \n\nbool AssetStorage::removeGuiElement( const std::string&amp; strId, bool removeTextures ) {\n    // Find Which Type This Gui Element Is In\n    for ( int i = 0; i &lt; GUI_UKNOWN; ++i ) {\n        GuiElement* pGui = getGuiElement( strId, (GuiType)i );\n        if ( pGui != nullptr ) {\n            // Found It\n            switch( static_cast&lt;GuiType&gt;( i ) ) {\n                case GUI_SCREEN: {\n                    return removeGuiElement( pGui-&gt;getId(), m_guiScreenAssets, removeTextures );\n                }\n                case GUI_RENDERABLE: {\n                    return removeGuiElement( pGui-&gt;getId(), m_guiRenderableAssets, removeTextures );\n                }\n                default: {\n                    std::ostringstream strStream;\n                    strStream &lt;&lt; __FUNCTION__  &lt;&lt; \" unrecognized GuiType = \" &lt;&lt; i;\n                    throw ExceptionHandler( strStream );\n                }\n            }\n        }\n    }\n\n    std::ostringstream strStream;\n    strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed. \" &lt;&lt; strId &lt;&lt; \" was not found in AssetStorage\";\n    Logger::log( strStream, Logger::TYPE_WARNING );\n    return false;\n}     \n\nbool AssetStorage::removeGuiElement( const std::string&amp; strId, MapGuiAssets&amp; guiMap, bool removeTextures ) {\n    BlockThread blockThread( s_criticalSection );\n    MapGuiAssets::iterator itGuiAsset = guiMap.find( strId );\n    if ( itGuiAsset == guiMap.end() ) {\n        std::ostringstream strStream;\n        strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed. \" &lt;&lt; strId &lt;&lt; \" was not found in AssetStorage\";\n        Logger::log( strStream, Logger::TYPE_WARNING );\n        return false;\n\n    } else {\n        itGuiAsset-&gt;second.get()-&gt;setRemoveTextures( removeTextures );\n        guiMap.erase( itGuiAsset );\n\n        // When The Above Gui Was Deleted, There Might Have Been Some Children\n        // That Also Got Marked For Removal. We Can Remove Them Now Here\n        for ( unsigned i = 0; i &lt; m_vGuiForRemoval.size(); ++i ) {\n            itGuiAsset = m_guiRenderableAssets.find( m_vGuiForRemoval[i] );\n            if ( itGuiAsset != m_guiRenderableAssets.end() ) {\n                // Remove This Gui\n                itGuiAsset-&gt;second.get()-&gt;setRemoveTextures( false );\n                m_guiRenderableAssets.erase( itGuiAsset );\n\n            } else {\n                std::ostringstream strStream;\n                strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" failed to find \" &lt;&lt; m_vGuiForRemoval[i] &lt;&lt; \" for removal from the m_guiRenderableAssets\";\n                Logger::log( strStream, Logger::TYPE_WARNING );\n            }\n        }\n        m_vGuiForRemoval.clear();\n\n        return true;    \n    }\n}     \n\nvoid AssetStorage::markGuiForRemoval( const std::string&amp; strId ) {\n    m_vGuiForRemoval.push_back( strId );\n}     \n\nvoid AssetStorage::cleanOrphanedGuiObjects() {\n} \n\nvoid AssetStorage::showLoadedGuiObjects() const {\n    BlockThread blockThread( s_criticalSection );\n\n    // Reset Print Flags\n    for each( const std::pair&lt;std::string, std::shared_ptr&lt;GuiElement&gt;&gt;&amp; gui in m_guiRenderableAssets ) {\n        GuiRenderable* pGui = dynamic_cast&lt;GuiRenderable*&gt;( gui.second.get() );\n        if ( pGui != nullptr ) {\n             pGui-&gt;resetPrinted();\n        }\n    }\n\n    if ( m_guiScreenAssets.size() &gt; 0 ) {\n        Logger::log( \"Loaded gui screen's: \", Logger::TYPE_CONSOLE );\n        for each ( const std::pair&lt;std::string, std::shared_ptr&lt;GuiElement&gt;&gt;&amp; gui in m_guiScreenAssets ) {\n            gui.second.get()-&gt;print();\n            Logger::log( \" \", Logger::TYPE_CONSOLE );\n        }\n    } else {\n        Logger::log( \"There are no loaded gui screens.\", Logger::TYPE_CONSOLE );\n    }\n    Logger::log( \" \", Logger::TYPE_CONSOLE );\n\n    bool isMessageShown = false;\n    for each( const std::pair&lt;std::string, std::shared_ptr&lt;GuiElement&gt;&gt;&amp; gui in m_guiRenderableAssets ) {\n        GuiRenderable* pGui = dynamic_cast&lt;GuiRenderable*&gt;( gui.second.get() );\n        if ( !pGui-&gt;wasPrinted() ) {\n            if ( !isMessageShown ) {\n                 isMessageShown = true;\n                 Logger::log( \"Loaded gui renderables not attached to a screen: \", Logger::TYPE_CONSOLE );\n            }\n            pGui-&gt;print();\n        }\n    }\n    if ( isMessageShown ) {\n        Logger::log( \" \", Logger::TYPE_CONSOLE );\n    }\n} \n\n} // /*namespace name here*/\n</code></pre>\n\n<p>This was originally built in Visual Studio 2010 &amp; 12 and has been ported over to VS 2015 so this doesn't utilize all of <code>modern c++</code> techniques but does use many features from <code>C++11</code>. Hopefully one day I will port this over to <code>2017</code> version to utilize <code>C++17</code>. </p>\n\n<hr>\n\n<p>I had initially proposed to have all of your stored objects into a single class, however with any kind of 3D Engine the memory class will explode in size very quickly as you can see from the <code>AssetStorage</code> class above, so to help keep things simple and more modular, I have broken them down into individual Managing classes. </p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "is_accepted": false, "score": 0, "last_activity_date": 1545165706, "creation_date": 1545165706, "answer_id": 53840743, "question_id": 53752944, "link": "https://stackoverflow.com/questions/53752944/struggling-with-memory-management-in-c-and-opengl/53840743#53840743", "title": "struggling with memory management in c++ and opengl", "body": "<p>I finally found what was the issue in my code.\nI was loading data inside a persistent object with some</p>\n\n<pre><code>glGenBuffers() \n</code></pre>\n\n<p>but I was never using any </p>\n\n<pre><code>glDeleteBuffers(1,&amp;m_id)\n</code></pre>\n\n<p>I imagine that every time I called glGenBuffers(1,&amp;m_id); opengl creates a totally new buffer, so I have to clear the one before.</p>\n\n<p>My program is now consumming a normal amount of memory.</p>\n"}], "owner": {"reputation": 49, "user_id": 4270469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7e634d47ff9ae75b3f73ceeeca2553?s=128&d=identicon&r=PG&f=1", "display_name": "gui2one", "link": "https://stackoverflow.com/users/4270469/gui2one"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1545165706, "creation_date": 1544657254, "question_id": 53752944, "link": "https://stackoverflow.com/questions/53752944/struggling-with-memory-management-in-c-and-opengl", "title": "struggling with memory management in c++ and opengl", "body": "<p>I am struggling with memory management on a c++ project I have. ( just a fun project, to learn)\nFor now, it's basically a 3d file viewer built with glfw, opengl, glm and assimp. \nI am able to succesfully load some mesh files and display them in a window, with a shader, even display a texture ! whaou<br>\nI can even display multiple objects, which was not a simple as I though.</p>\n\n<p>The \"code base\" is still pretty small, but large enough for me to make a lot of mistakes.</p>\n\n<p>So basically it works as expected but for the fact that when loading a new mesh file, the program never really releases any memory;\nit sometimes comes down 1 or 2 Mb, but apart from that the ram footprint keeps growing ( only when I load an object though, not continuously during program execution of course)</p>\n\n<p>I have tried almost everything I can think of to manage the memory. But nothing I do has any effect.\nI tried to limit a lot the use of \"new\" as I understand it's a little trickier to manage ( i.e need to manually delete )\nI also tried everywhere I can to clear std::vectors when i don't need them anymore with the clear() function</p>\n\n<p>I will put my main.cpp here\nmaybe the issue is in there.\nAll source files can be found at <a href=\"https://github.com/gui2one/angine\" rel=\"nofollow noreferrer\">https://github.com/gui2one/angine</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"application.h\"\n#include \"pch.h\"\n\n#include \"generators/gridmesh.h\"\n#include \"generators/spheremesh.h\"\n\nObject* obj1 = new Object();\n\nint nCols = 4;\nApplication app ;\n\nMesh loadNewObject(){\n    char file[1024];\n    FILE *f = popen(\"zenity --file-selection --title='choose a 3d file' \", \"r\");\n    fgets(file, 1024, f);   \n    std::cout &lt;&lt; \"Loading -&gt; \"&lt;&lt;file &lt;&lt; \"\\n\";           \n    ObjLoader loader;\n    Mesh mesh;\n    std::string str(file);\n\n    str.erase(std::remove(str.begin(), str.end(), '\\n'), str.end());\n\n    mesh = loader.assimp_load(str);\n\n    return mesh;\n}\n\nvoid key_callback(GLFWwindow* window, int key, int scancode, int action, int mods)\n{\n    std::cout &lt;&lt; \"key -&gt;\" &lt;&lt; key &lt;&lt; \", scancode --&gt; \"&lt;&lt; scancode &lt;&lt; \"\\n\";\n    if (key == GLFW_KEY_UP &amp;&amp; action == GLFW_PRESS){\n\n        nCols +=3;\n\n        obj1-&gt;mesh.clearAll();\n\n        SphereMesh* sphere = new SphereMesh();\n        sphere-&gt;generate(obj1-&gt;mesh,20,nCols);\n\n        delete sphere;\n\n        std::cout &lt;&lt; nCols &lt;&lt; \"\\n\";\n        obj1-&gt;buildVbo();\n\n    }else if (key == GLFW_KEY_DOWN &amp;&amp; action == GLFW_PRESS){\n        if( nCols &gt; 4){\n            nCols -=3;\n            obj1-&gt;mesh.clearAll();\n\n            SphereMesh* sphere = new SphereMesh();\n            sphere-&gt;generate(obj1-&gt;mesh,20,nCols);\n\n            delete sphere;\n            std::cout &lt;&lt; nCols &lt;&lt; \"\\n\";\n            obj1-&gt;buildVbo();\n\n        }\n    }else if (key == 79 /* letter o*/ &amp;&amp; action == GLFW_PRESS){\n\n        nCols -=3;\n        obj1-&gt;mesh.clearAll();\n        obj1-&gt;mesh = loadNewObject();\n        std::cout &lt;&lt; nCols &lt;&lt; \"\\n\";\n        obj1-&gt;buildVbo();\n    }\n}\n\nint main(){\n\n\n\n    std::cout &lt;&lt; \"angine PROJECT\\n\";\n\n    //obj1-&gt;mesh = loadNewObject();\n\n    SphereMesh* sphere = new SphereMesh();\n    sphere-&gt;generate(obj1-&gt;mesh,20,nCols);        \n    delete sphere;\n\n    obj1-&gt;color-&gt;x = 0.9;\n    obj1-&gt;color-&gt;y = 0.8;\n    obj1-&gt;color-&gt;z = 0.5;\n    obj1-&gt;color-&gt;w = 1.0;\n\n    obj1-&gt;position-&gt;x = 1.2f;\n\n    obj1-&gt;shader.loadVertexShaderSource(\"../src/res/shaders/basic_shader.vert\");\n    obj1-&gt;shader.loadFragmentShaderSource(\"../src/res/shaders/basic_shader.frag\");  \n\n    obj1-&gt;buildVbo();\n    obj1-&gt;buildTexture();\n    obj1-&gt;shader.createShader();\n\n\n    app.objects.push_back(obj1);\n\n\n\n\n    app.window.objects = app.objects;\n\n    glfwSetKeyCallback(app.window.win, key_callback);\n    while(!app.window.shouldClose()){\n\n\n\n        app.window.refresh();\n        obj1-&gt;rotation-&gt;x = glfwGetTime()*0.2;\n        obj1-&gt;rotation-&gt;y = glfwGetTime()*0.13;\n        obj1-&gt;rotation-&gt;z = glfwGetTime()*0.11;\n\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>the class responsible for loading mesh data ObjLoader :  </p>\n\n<p>ObjLoader.h :  </p>\n\n<pre><code>#ifndef OBJLOADER_H\n#define OBJLOADER_H\n#include &lt;string&gt;\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;stdio.h&gt;\n\n#include \"../mesh.h\"\n#include \"../vector3.h\"\n\n#include \"../include/assimp/cimport.h\"\n#include \"../include/assimp/scene.h\"\n#include \"../include/assimp/postprocess.h\"\n\nclass ObjLoader{\n    public:\n        Mesh assimp_load(std::string file_path);\n\n};\n\n#endif\n</code></pre>\n\n<p>ObjLoader.cpp :  </p>\n\n<pre><code>Mesh ObjLoader::assimp_load(std::string file_path){\n\n    const struct aiScene* scene = NULL;\n    scene = aiImportFile(file_path.c_str(), aiProcessPreset_TargetRealtime_MaxQuality);\n\n    if(scene){\n\n\n        std::vector&lt;Vertex&gt; vertices;\n        std::vector&lt;float&gt; positions;\n        std::vector&lt;float&gt; normals;\n        for (int i = 0; i &lt; scene-&gt;mMeshes[0]-&gt;mNumFaces; i++)\n        {\n            Vertex vertex;\n\n            for (int j = 0; j &lt; scene-&gt;mMeshes[0]-&gt;mFaces[i].mNumIndices; j++)\n            {\n                    int index = scene-&gt;mMeshes[0]-&gt;mFaces[i].mIndices[j];\n\n                    vertex.position.x = scene-&gt;mMeshes[0]-&gt;mVertices[index].x;\n                    vertex.position.y = scene-&gt;mMeshes[0]-&gt;mVertices[index].y;\n                    vertex.position.z = scene-&gt;mMeshes[0]-&gt;mVertices[index].z;\n\n                    vertex.normal.x = scene-&gt;mMeshes[0]-&gt;mNormals[index].x;\n                    vertex.normal.y = scene-&gt;mMeshes[0]-&gt;mNormals[index].y;\n                    vertex.normal.z = scene-&gt;mMeshes[0]-&gt;mNormals[index].z;\n\n\n\n                    if(scene-&gt;mMeshes[0]-&gt;HasTextureCoords(0)){\n\n                        //~ std::cout &lt;&lt; scene-&gt;mMeshes[0]-&gt;mTextureCoords[0][index].x  &lt;&lt; \"-------------\"&lt;&lt; \"\\n\";\n                        vertex.t_coords.x = scene-&gt;mMeshes[0]-&gt;mTextureCoords[0][index].x;\n                        vertex.t_coords.y = scene-&gt;mMeshes[0]-&gt;mTextureCoords[0][index].y;\n                    }\n\n\n                    vertices.push_back(vertex);\n\n                    positions.push_back(scene-&gt;mMeshes[0]-&gt;mVertices[index].x);\n                    positions.push_back(scene-&gt;mMeshes[0]-&gt;mVertices[index].y);\n                    positions.push_back(scene-&gt;mMeshes[0]-&gt;mVertices[index].z);\n            }\n\n        }\n        Mesh mesh;\n\n        mesh.vertices = vertices;\n\n        //// trying to delete everything I can\n        delete scene;\n        vertices.clear();\n        positions.clear();\n        normals.clear();\n\n        return mesh;\n    }else{\n        Mesh empty_mesh;\n        return empty_mesh;\n    }\n\n\n}\n</code></pre>\n\n<p>the fact is that issue remains even when not using this class to load a mesh, but generating the mesh procedurally.\nI can't really post everything here, but I also have some opengl code to draw these meshes. Here I try also to \"clear\" everything and to unbind gl buffers after using them. </p>\n\n<p>I'm out of ideas. \nI realize this question is pretty vague. i will try to make it more precise as I investigate more, but i really need some help to understand.</p>\n"}, {"tags": ["c++", "templates", "lambda", "compilation", "capture"], "answers": [{"tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 0, "last_activity_date": 1544656448, "creation_date": 1544656448, "answer_id": 53752827, "question_id": 53752784, "link": "https://stackoverflow.com/questions/53752784/why-i-got-compile-error-when-trying-to-use-a-vector-or-map-to-keep-the-list-of-f/53752827#53752827", "title": "Why I got compile error when trying to use a vector or map to keep the list of function pointer with lambda", "body": "<p>C++ makes a distinction between types for function pointers and types for lambdas that have capture lists. The lambda you've made is callable as a function, but its type isn't \"pointer to a function taking no arguments and returning void.\" More specifically, the type of that lambda expression will be some anonymous object type.</p>\n\n<p>If you want to store a list of objects that can be called as a function that takes in no arguments and returns a string, consider making a vector of <code>std::function&lt;string()&gt;</code>, which can store a wider assortment of types callable as functions.</p>\n\n<p>If you do this, to call those functions, you'd use the syntax</p>\n\n<pre><code>cout &lt;&lt; myvector[0]() &lt;&lt; endl;\n</code></pre>\n\n<p>rather than</p>\n\n<pre><code>cout &lt;&lt; *(myvector[0])() &lt;&lt; endl;\n</code></pre>\n\n<p>as you're no longer storing function pointers. (Fun fact - you don't actually have to dereference function pointers to call them!)</p>\n"}], "owner": {"reputation": 1, "user_id": 10783305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260b6ae8f076cd2a2cd94a110eae761?s=128&d=identicon&r=PG&f=1", "display_name": "littlemike", "link": "https://stackoverflow.com/users/10783305/littlemike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1544656465, "answer_count": 1, "score": 0, "last_activity_date": 1544656509, "creation_date": 1544656178, "question_id": 53752784, "link": "https://stackoverflow.com/questions/53752784/why-i-got-compile-error-when-trying-to-use-a-vector-or-map-to-keep-the-list-of-f", "closed_reason": "Duplicate", "title": "Why I got compile error when trying to use a vector or map to keep the list of function pointer with lambda", "body": "<p>I'm trying to create a list of function pointers, and these functions is passed as lambda.</p>\n\n<pre><code>    string msg = \"hello\";\n    vector&lt;string (*)() &gt; myvector;\n    auto f = [=]() -&gt; string {return msg; };\n    myvector.push_back(f);\n    cout &lt;&lt; (*myvector[0])();\n</code></pre>\n\n<p>However, I got error in compiling when tried to capture variable and it successed when i didn't capture anything.\nThis problem occur when i use map, pair or sth similar.</p>\n\n<pre><code>funtionPointer.cc:36:22: error: no matching function for call to \u2018std::vector&lt;std::__cxx11::basic_string&lt;char&gt; (*)()&gt;::push_back(main()::&lt;lambda()&gt;&amp;)\u2019\n  myvector.push_back(f);\n</code></pre>\n\n<p>Thank for any help.</p>\n"}, {"tags": ["python", "c++", "numpy", "eigen", "pybind11"], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 1, "last_activity_date": 1544657238, "creation_date": 1544657238, "answer_id": 53752941, "question_id": 53752699, "link": "https://stackoverflow.com/questions/53752699/how-with-pybind11-to-bind-a-function-that-takes-as-argument-a-numpy-array-with/53752941#53752941", "title": "How with pybind11 to bind a function that takes as argument a numpy.array() with, for instance, a shape (10, 10, 3)?", "body": "<p>From the pybind information, you can extract the dimension information.</p>\n\n<p>For instance, this is what I do inside <a href=\"https://github.com/mbrucher/AudioTK/blob/master/Python/ATK/Core/Core.cpp#L76\" rel=\"nofollow noreferrer\">Audio ToolKit</a> with <code>m</code> the current Python module you want to build:</p>\n\n<pre><code>py::class_&lt;MyClass&gt;(m,\"name\")\n.def(\"set_pointer\", [](MyClass&amp; instance, const py::array_t&lt;DataType&gt;&amp; array)\n{\n  gsl::index channels = 1;\n  gsl::index size = array.shape(0);\n  if(array.ndim() == 2)\n  {\n    channels = array.shape(0);\n    size = array.shape(1);\n  }\n  // Call using array.data() and possibly add more dimension information, this is specific to my use case\n  instance.set_pointer(array.data(), channels, size);\n});\n</code></pre>\n\n<p>From this, you can create the <a href=\"https://eigen.tuxfamily.org/dox/group__TutorialMapClass.html\" rel=\"nofollow noreferrer\"><code>Eigen::Map</code></a> call instead to create an Eigen-like matrix that you can use in your templated code.</p>\n\n<p>Basically, pybind11 allows you to create a lambda where you can create your wrapper for your use case. The same works for return, you can get the Eigen class, create a pybind array that you populate with the Eigen data.</p>\n\n<p>Eigen has the Tensor class that you can use as well.</p>\n"}], "owner": {"reputation": 1127, "user_id": 1278365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/33tk1.jpg?s=128&g=1", "display_name": "gmagno", "link": "https://stackoverflow.com/users/1278365/gmagno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544657238, "creation_date": 1544655629, "question_id": 53752699, "link": "https://stackoverflow.com/questions/53752699/how-with-pybind11-to-bind-a-function-that-takes-as-argument-a-numpy-array-with", "title": "How with pybind11 to bind a function that takes as argument a numpy.array() with, for instance, a shape (10, 10, 3)?", "body": "<p>I would like to write a function that can take a multidimensional numpy array, not just 2D.</p>\n\n<pre><code>void compute(Eigen::Ref&lt;Eigen::MatrixXd&gt; array3d) {\n    // change the array in-place\n    // ...\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Eigen::MatrixXd &amp;compute() {\n    // create array\n    // ...\n    // and return it\n}\n</code></pre>\n\n<p>I am using Eigen here just to depict the goal, I believe Eigen does not support 3D, or more dimensions, arrays.</p>\n\n<p>I appreciate your feedback and patience since I am not familiar with Pybind11 nor Eigen.</p>\n"}, {"tags": ["c++", "cmake", "visual-studio-2017", "pthreads", "webrtc"], "comments": [{"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1544658843, "post_id": 53752689, "comment_id": 94359126, "body": "For pthreads, take a look at this answer: <a href=\"https://stackoverflow.com/a/2150957/1076479\">stackoverflow.com/a/2150957/1076479</a>  I don&#39;t know enough to say for sure, but I suspect pthreads is only the tip of this iceberg."}, {"owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "edited": false, "score": 1, "creation_date": 1544688587, "post_id": 53752689, "comment_id": 94367090, "body": "It is not just a matter of compilers when you port a project from linux to windows. Thread s are a good example of what you need to change in your code. Look if you can find some define like WIN32 or LINUX inside your code, maybe who wrote it provided this option"}], "answers": [{"comments": [{"owner": {"reputation": 15897, "user_id": 11722, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b0124a12d060a036500e83ec44972492?s=128&d=identicon&r=PG", "display_name": "Zitrax", "link": "https://stackoverflow.com/users/11722/zitrax"}, "edited": false, "score": 0, "creation_date": 1552156828, "post_id": 53758214, "comment_id": 96907310, "body": "Last release listed following that link is from 2012, they seem to have newer (2018) releases at <a href=\"https://sourceforge.net/projects/pthreads4w/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/pthreads4w</a>"}], "tags": [], "owner": {"reputation": 3365, "user_id": 4895359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b12929ef5d2ad7df9f674bcf09b617b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4895359/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1544691600, "creation_date": 1544691600, "answer_id": 53758214, "question_id": 53752689, "link": "https://stackoverflow.com/questions/53752689/error-lnk1104-cannot-open-file-pthread-lib/53758214#53758214", "title": "Error : LNK1104 cannot open file &#39;pthread.lib&#39;", "body": "<p>If 'missing pthread library' is the only error, you can use <a href=\"http://sourceware.org/pthreads-win32/\" rel=\"nofollow noreferrer\">pthread-w32</a>. We have successfully used it in some of our cross-platform apps requiring pthread. </p>\n\n<p>They have libraries for both 64-bit and 32-bit. You can download and add it into your project. You haven't mentioned your toolset - their libraries are named differently depending on your toolset (MSVC or GNU) so you need to pick the right one. Check out their <a href=\"https://sourceware.org/pthreads-win32/faq.html\" rel=\"nofollow noreferrer\">FAQ</a>. </p>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 3228, "user_id": 848419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf2a4a3abac652c91148d8e12e5268a?s=128&d=identicon&r=PG", "display_name": "VoteCoffee", "link": "https://stackoverflow.com/users/848419/votecoffee"}, "is_accepted": false, "score": 1, "last_activity_date": 1600223406, "creation_date": 1600223406, "answer_id": 63912289, "question_id": 53752689, "link": "https://stackoverflow.com/questions/53752689/error-lnk1104-cannot-open-file-pthread-lib/63912289#63912289", "title": "Error : LNK1104 cannot open file &#39;pthread.lib&#39;", "body": "<p>You need to us the actual lib file which is typically not &quot;pthread.lib&quot;.  It's most likely &quot;pthreadVC3.lib&quot; or &quot;pthreadVC2.lib&quot;.  Find the actual name by looking in the lib directory of your source package.  You might see other lib files in there like &quot;pthreadVCE3.lib&quot; and &quot;pthreadVSE3.lib&quot;, but you want to link &quot;pthreadVC3.lib&quot;.</p>\n<p>You can either add this in the project settings, or add the following code:</p>\n<pre><code>#pragma comment(lib,&quot;pthreadVC3.lib&quot;)\n</code></pre>\n<p>To add it to the project settings:</p>\n<ul>\n<li>Go to project properties-&gt;Configuration Properties-&gt;Linker-&gt;General and add your library path to Additional Library Directories</li>\n<li>Go to project properties-&gt;Configuration Properties-&gt;Linker-&gt;Input and add the lib file (such as &quot;pthreadVC3.lib&quot;) to Additional Dependencies</li>\n</ul>\n<p>Make sure you have the correct version of pthread to match your compile settings, ie x86/x64.</p>\n<p>In my case, I am using VCPkg for package management and I installed pthreads using the following commands:</p>\n<pre><code>vcpkg install pthread:x86-windows\nvcpkg install pthread:x64-windows\n</code></pre>\n<p>And my package lib directory is &quot;C:\\vcpkg\\installed\\x64-windows\\lib&quot;\nI additionally had to add the following to my project settings as vcpkg wasn't integrating automatically:</p>\n<ul>\n<li>Go to project properties-&gt;Configuration Properties-&gt;VC++ Directories and add &quot;C:\\vcpkg\\installed\\x64-windows\\include&quot; to Include Directories</li>\n<li>Go to project properties-&gt;Configuration Properties-&gt;VC++ Directories and add &quot;C:\\vcpkg\\installed\\x64-windows\\lib&quot; to Library Directories</li>\n</ul>\n"}], "owner": {"reputation": 195, "user_id": 4032153, "user_type": "registered", "profile_image": "https://graph.facebook.com/641105111/picture?type=large", "display_name": "Kazi Hasan", "link": "https://stackoverflow.com/users/4032153/kazi-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1553, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1600223406, "creation_date": 1544655574, "question_id": 53752689, "link": "https://stackoverflow.com/questions/53752689/error-lnk1104-cannot-open-file-pthread-lib", "title": "Error : LNK1104 cannot open file &#39;pthread.lib&#39;", "body": "<p>I am trying to compile a native Linux C++ application in Windows using Visual Studio 2017. The app uses WebRtc's Acoustic Echo Cancellation(AEC) APIs to negate echo on wav files. Following is the CmakeLists.txt file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\nproject(wav-aec)\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS}\")\nset(CMAKE_INSTALL_RPATH_USE_LINK_PATH TRUE)\nadd_subdirectory(gflags)\nadd_definitions(\"-DWEBRTC_NS_FLOAT -DWEBRTC_WIN -DNOMINMAX\")\n\n#-DWEBRTC_UNTRUSTED_DELAY -DWEBRTC_LINUX -DWEBRTC_POSIX \n\ninclude_directories(\n    webrtc\n    webrtc/webrtc/common_audio/signal_processing/include\n    webrtc/webrtc/modules/audio_coding/codecs/isac/main/include\n)\n\nset(WEBRTC_SRC_\n    base/buffer.cc\n    base/checks.cc\n    ...\n    ...\n    #system_wrappers/source/rw_lock_posix.cc\n    system_wrappers/source/trace_impl.cc\n    #system_wrappers/source/trace_posix.cc\n)\n\nfunction(prepend_path var prefix)\n   set(listVar \"\")\n   foreach(f ${ARGN})\n      list(APPEND listVar \"${prefix}/${f}\")\n   endforeach(f)\n   set(${var} \"${listVar}\" PARENT_SCOPE)\nendfunction(prepend_path)\n\nprepend_path(WEBRTC_SRC webrtc/webrtc ${WEBRTC_SRC_})\n\nadd_executable(webrtc-audioproc webrtc-audioproc.cpp ${WEBRTC_SRC})\ntarget_link_libraries(webrtc-audioproc gflags pthread)\n</code></pre>\n\n<p>When I try to build it, I get the following errror:\n<strong>Error : LNK1104 cannot open file 'pthread.lib'</strong></p>\n\n<p>Here is the link to the only linux dependent source file(cpp) of the project:\n<a href=\"https://github.com/lschilli/wav-aec/blob/master/webrtc-audioproc.cpp\" rel=\"nofollow noreferrer\">https://github.com/lschilli/wav-aec/blob/master/webrtc-audioproc.cpp</a></p>\n\n<p>What will be the right approach to port the code from Linux to windows?\nWhats is Windows equivalent of gflags and pthread? And what necessary changes needs to go to CmakeLists.txt?</p>\n\n<p>P.S: I have already added pthread header, dll and libs to Visual Studio directory manually.</p>\n"}, {"tags": ["c++", "parsing", "boost", "ebnf", "boost-spirit-x3"], "comments": [{"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1544655982, "post_id": 53752605, "comment_id": 94358309, "body": "Hm. I haven&#39;t used X3 a lot, but I think the <code>%</code> operator is really meant to be used with lists rather than such expressions."}, {"owner": {"reputation": 9937, "user_id": 125601, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5a3cd2f90c4c12b75ed2d0b814a5787a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Fraser", "link": "https://stackoverflow.com/users/125601/robert-fraser"}, "reply_to_user": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1544656181, "post_id": 53752605, "comment_id": 94358364, "body": "@Asu edited the example to be clearer. There can be 3 or more elements in a single expression, so it needs to be a list &quot;hello and world and Asu&quot; is a perfectly valid 3-element expression."}], "answers": [{"tags": [], "owner": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "is_accepted": true, "score": 1, "last_activity_date": 1544711524, "creation_date": 1544711524, "answer_id": 53764153, "question_id": 53752605, "link": "https://stackoverflow.com/questions/53752605/boost-spirit-x3-collapsing-one-element-lists/53764153#53764153", "title": "Boost Spirit X3: Collapsing one-element lists", "body": "<pre><code>#include &lt;boost/spirit/home/x3.hpp&gt;\n#include &lt;boost/spirit/home/x3/support/ast/variant.hpp&gt;\n#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n#include &lt;iostream&gt;\n\nnamespace x3 = boost::spirit::x3;\n\nnamespace burningmime::setmatch::ast\n{\n    // an expression node (either an AND or an OR)\n    struct Expr;\n\n    // child of an expression -- either another expression, or a terminal\n    struct Node : x3::variant&lt;std::string, x3::forward_ast&lt;Expr&gt;&gt;\n    {\n        using base_type::base_type;\n        using base_type::operator=;\n    };\n\n    // tags for expression type\n    enum OPER\n    {\n        OPER_AND = 1,\n        OPER_OR = 2\n    };\n\n    // see above\n    struct Expr\n    {\n        OPER op;\n        std::vector&lt;Node&gt; children;\n    };\n\n    // for debugging purposes; this will print all the expressions\n    struct AstPrinter\n    {\n        void operator()(const Expr&amp; node) const\n        {\n            std::cout &lt;&lt; (node.op == OPER_AND ? \"And(\" : \"Or(\");\n            bool first = true;\n            for(const auto&amp; child : node.children)\n            {\n                if(!first) std::cout &lt;&lt; \", \";\n                first = false;\n                boost::apply_visitor(*this, child);\n            }\n            std::cout &lt;&lt; \")\";\n        }\n\n        void operator()(const std::string&amp; node) const\n        {\n            std::cout &lt;&lt; node;\n        }\n    };\n}\n\n // these need to be at top-level scope\n // basically this adds compile-time type information, so the parser knows where to put various attributes\nBOOST_FUSION_ADAPT_STRUCT(burningmime::setmatch::ast::Expr, op, children)\n\n#define DECLARE_RULE(NAME, TYPE) static const x3::rule&lt;class NAME##_r, TYPE&gt; NAME = #NAME;\n#define KEYWORD(X) static const auto kw_##X = x3::no_case[#X];\n#define DEFINE_RULE(NAME, GRAMMAR) \\\n    static const auto NAME##_def = GRAMMAR; \\\n    BOOST_SPIRIT_DEFINE(NAME)\n\nnamespace burningmime::setmatch::parser\n{\n    // we need to pre-declare the rules so they can be used recursively\n    DECLARE_RULE(Phrase,    std::string)\n    DECLARE_RULE(Term,      ast::Node)\n    DECLARE_RULE(AndExpr,   ast::Node)\n    DECLARE_RULE(OrExpr,    ast::Node)\n    DECLARE_RULE(ParenExpr, ast::Node)\n\n    // keywords\n    KEYWORD(and)\n    KEYWORD(or)\n\n    static const auto lparen = x3::lit('(');\n    static const auto rparen = x3::lit(')');\n\n    // helper parsers\n    static const auto keywords = kw_and | kw_or | lparen | rparen;\n    static const auto word = x3::lexeme[+(x3::char_ - x3::ascii::space - lparen - rparen)];\n    static const auto bareWord = word - keywords;\n    static const auto quotedString = x3::lexeme[x3::char_('\"') &gt;&gt; *(x3::char_ - '\"') &gt;&gt; x3::char_('\"')];\n\n    DEFINE_RULE(Phrase,     quotedString | bareWord)\n    DEFINE_RULE(Term,       ParenExpr | Phrase)\n    DEFINE_RULE(ParenExpr,  lparen &gt;&gt; OrExpr &gt;&gt; rparen)\n    template &lt;ast::OPER Op&gt;\n    struct make_node\n    {\n        template &lt;typename Context &gt;\n        void operator()(Context const&amp; ctx) const\n        {\n            if (_attr(ctx).size() == 1)\n                _val(ctx) = std::move(_attr(ctx)[0]);\n            else\n                _val(ctx) = ast::Expr{ Op, std::move(_attr(ctx)) };\n        }\n    };\n    DEFINE_RULE(AndExpr,    (Term % kw_and)[make_node&lt;ast::OPER_AND&gt;{}])\n    DEFINE_RULE(OrExpr,     (AndExpr % kw_or)[make_node&lt;ast::OPER_OR&gt;{}])\n}\n\nnamespace burningmime::setmatch\n{\n    void parseRuleFluent(const char* buf)\n    {\n        ast::Node root;\n        auto start = buf, end = start + strlen(buf);\n        bool success = x3::phrase_parse(start, end, parser::OrExpr, x3::ascii::space, root);\n        if (!success || start != end)\n            throw std::runtime_error(std::string(\"Could not parse rule: \") + buf);\n        printf(\"Result of parsing: %s\\n=========================\\n\", start);\n        boost::apply_visitor(ast::AstPrinter(), root);\n    }\n}\n\nint main()\n{\n    burningmime::setmatch::parseRuleFluent(R\"#(\"hello\" and (\"world\" or \"planet\" or \"globe\"))#\");\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/kMSHOHG0pgwGr0zv\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/kMSHOHG0pgwGr0zv</a></p>\n\n<h3>Output:</h3>\n\n<pre><code>Result of parsing: \n=========================\nAnd(\"hello\", Or(\"world\", \"planet\", \"globe\"))\n</code></pre>\n"}], "owner": {"reputation": 9937, "user_id": 125601, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5a3cd2f90c4c12b75ed2d0b814a5787a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Fraser", "link": "https://stackoverflow.com/users/125601/robert-fraser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 53764153, "answer_count": 1, "score": 1, "last_activity_date": 1544711524, "creation_date": 1544655040, "last_edit_date": 1544666134, "question_id": 53752605, "link": "https://stackoverflow.com/questions/53752605/boost-spirit-x3-collapsing-one-element-lists", "title": "Boost Spirit X3: Collapsing one-element lists", "body": "<p>Say I have a (simplified) recursive grammar like this:</p>\n\n<pre><code>OrExpr    := AndExpr % \"or\"\nAndExpr   := Term % \"and\"\nTerm      := ParenExpr | String\nParenExpr := '(' &gt;&gt; OrExpr &gt;&gt; ')'\nString    := lexeme['\"' &gt;&gt; *(char_ - '\"') &gt;&gt; '\"']\n</code></pre>\n\n<p>So this works, but the problem is that it will wrap everything in multiple layers of expression. For example, the string <code>\"hello\" and (\"world\" or \"planet\" or \"globe\")</code> would parse as <code>OrExpr(AndExpr(\"hello\", OrExpr(AndExpr(\"world\"), AndExpr(\"planet\"), AndExpr(\"globe\"))))</code> (playing fast and loose with the syntax, but hopefully you understand). What I'd like is for the one-element nodes to be collapsed into their parent, so it would end up as <code>AndExpr(\"hello\", OrExpr(\"world\", \"parent\", \"globe\"))</code></p>\n\n<p>This can be solved with actions and using a state machine that only constructs the outer object if there's more than one child inside it. But I'm wondering if there's a way to fix this problem without using parser actions?</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> Almost minimal example</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/ed66ba050cefee72\" rel=\"nofollow noreferrer\">Coliru</a></p>\n\n<pre><code>#include &lt;boost/spirit/home/x3.hpp&gt;\n#include &lt;boost/spirit/home/x3/support/ast/variant.hpp&gt;\n#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n#include &lt;iostream&gt;\n\nnamespace x3 = boost::spirit::x3;\n\nnamespace burningmime::setmatch::ast\n{\n    // an expression node (either an AND or an OR)\n    struct Expr;\n\n    // child of an expression -- either another expression, or a terminal\n    struct Node : x3::variant&lt;std::string, x3::forward_ast&lt;Expr&gt;&gt;\n    {\n        using base_type::base_type;\n        using base_type::operator=;\n    };\n\n    // tags for expression type\n    enum OPER\n    {\n        OPER_AND = 1,\n        OPER_OR = 2\n    };\n\n    // see above\n    struct Expr\n    {\n        OPER op;\n        std::vector&lt;Node&gt; children;\n    };\n\n    // for debugging purposes; this will print all the expressions\n    struct AstPrinter\n    {\n        void operator()(const Expr&amp; node) const\n        {\n            std::cout &lt;&lt; (node.op == OPER_AND ? \"And(\" : \"Or(\");\n            bool first = true;\n            for(const auto&amp; child : node.children)\n            {\n                if(!first) std::cout &lt;&lt; \", \";\n                first = false;\n                boost::apply_visitor(*this, child);\n            }\n            std::cout &lt;&lt; \")\";\n        }\n\n        void operator()(const std::string&amp; node) const\n        {\n            std::cout &lt;&lt; node;\n        }\n    };\n}\n\n // these need to be at top-level scope\n // basically this adds compile-time type information, so the parser knows where to put various attributes\nBOOST_FUSION_ADAPT_STRUCT(burningmime::setmatch::ast::Expr, op, children)\n\n#define DECLARE_RULE(NAME, TYPE) static const x3::rule&lt;class NAME, TYPE&gt; NAME = #NAME;\n#define KEYWORD(X) static const auto kw_##X = x3::no_case[#X];\n#define DEFINE_RULE(NAME, GRAMMAR) \\\n    static const auto NAME##_def = GRAMMAR; \\\n    BOOST_SPIRIT_DEFINE(NAME)\n\nnamespace burningmime::setmatch::parser\n{\n    // we need to pre-declare the rules so they can be used recursively\n    DECLARE_RULE(Phrase, std::string)\n    DECLARE_RULE(Term, ast::Node)\n    DECLARE_RULE(AndExpr, ast::Expr)\n    DECLARE_RULE(OrExpr, ast::Expr)\n    DECLARE_RULE(ParenExpr, ast::Expr)\n\n    // keywords\n    KEYWORD(and)\n    KEYWORD(or)\n\n    static const auto lparen = x3::lit('(');\n    static const auto rparen = x3::lit(')');\n\n    // helper parsers\n    static const auto keywords = kw_and | kw_or | lparen | rparen;\n    static const auto word = x3::lexeme[+(x3::char_ - x3::ascii::space - lparen - rparen)];\n    static const auto bareWord = word - keywords;\n    static const auto quotedString = x3::lexeme[x3::char_('\"') &gt;&gt; *(x3::char_ - '\"') &gt;&gt; x3::char_('\"')];\n\n    DEFINE_RULE(Phrase,     quotedString | bareWord)\n    DEFINE_RULE(Term,       ParenExpr | Phrase)\n    DEFINE_RULE(ParenExpr,  lparen &gt;&gt; OrExpr &gt;&gt; rparen)\n    DEFINE_RULE(AndExpr,    x3::attr(ast::OPER_AND) &gt;&gt; (Term % kw_and))\n    DEFINE_RULE(OrExpr,     x3::attr(ast::OPER_OR) &gt;&gt; (AndExpr % kw_or))\n}\n\nnamespace burningmime::setmatch\n{\n    void parseRuleFluent(const char* buf)\n    {\n        ast::Expr root;\n        auto start = buf, end = start + strlen(buf);\n        bool success = x3::phrase_parse(start, end, parser::OrExpr, x3::ascii::space, root);\n        if(!success || start != end)\n            throw std::runtime_error(std::string(\"Could not parse rule: \") + buf);\n        printf(\"Result of parsing: %s\\n=========================\\n\", start);\n        ast::Node root2(root);\n        boost::apply_visitor(ast::AstPrinter(), root2);\n    }\n}\n\nint main()\n{\n    burningmime::setmatch::parseRuleFluent(R\"#(\"hello\" and (\"world\" or \"planet\" or \"globe\"))#\");\n}\n</code></pre>\n"}, {"tags": ["c++", "string", "type-conversion", "std", "const-char"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1544654653, "post_id": 53752505, "comment_id": 94357858, "body": "Do you get an error? If so what is the exact text of the error message?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1544654759, "post_id": 53752505, "comment_id": 94357895, "body": "Note: when you get a compiler error, you can copy-paste it into google and most likely find a solution."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1544654792, "post_id": 53752505, "comment_id": 94357907, "body": "<i>I&#39;m clearly missing something simple.</i> -- What you&#39;re missing is calling the correct version of the <code>std::string</code> constructor that takes a char and a count."}, {"owner": {"reputation": 2078, "user_id": 1184801, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/03bdf23b59e23cfd6e479e4b0ba1eb35?s=128&d=identicon&r=PG", "display_name": "Dan James Palmer", "link": "https://stackoverflow.com/users/1184801/dan-james-palmer"}, "edited": false, "score": 0, "creation_date": 1544663518, "post_id": 53752505, "comment_id": 94360117, "body": "Thanks guys, duplicate link above worked a charm"}], "owner": {"reputation": 2078, "user_id": 1184801, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/03bdf23b59e23cfd6e479e4b0ba1eb35?s=128&d=identicon&r=PG", "display_name": "Dan James Palmer", "link": "https://stackoverflow.com/users/1184801/dan-james-palmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1544654760, "answer_count": 0, "score": 1, "last_activity_date": 1544654577, "creation_date": 1544654577, "question_id": 53752505, "link": "https://stackoverflow.com/questions/53752505/converting-const-char-to-string-isnt-working", "closed_reason": "Duplicate", "title": "converting const char to string isn&#39;t working", "body": "<p>Trying to convert type <code>const char</code> to type <code>std::string</code>. All the examples I've seen are for <code>const char *</code>. If I change my type to * the <code>dc.at</code> will fail.</p>\n\n<p>The conversion to string is failing. I've been trawling for an hour, it can't be that hard, I'm clearly missing something simple.</p>\n\n<pre><code>std::string dc = \"fdsda4w4bfd*4t4vwrsv\";\nconst char dcchar = dc.at(11);\nstd::string ms_char = dcchar;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qovD9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qovD9.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><code>std::string ms_char(dchar);</code> also fails</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1544654043, "post_id": 53752360, "comment_id": 94357624, "body": "You can&#39;t insert into an input stream.  You are supposed to extract from input streams.  What are you actually trying to accomplish?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1544654106, "post_id": 53752360, "comment_id": 94357649, "body": "Maybe you could use <code>std::stringstream</code> and treat as both input and output stream."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1544654273, "post_id": 53752360, "comment_id": 94357714, "body": "Next time, please provide code that compiles, i.e. with all the necessary #includes. That makes it much more likely that someone provides an answer."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1544657525, "post_id": 53752360, "comment_id": 94358789, "body": "What is your actual objective here? Do you want to expand the range your input is supposed to use? If so, you <i>could</i> add the character using something like <code>is.str(is.str() + c)</code> although I&#39;m not sure if the read position is appropriately positioned and it would be hideously inefficient. The proper approach to expand the input sequence would probably be a custom <code>std::streambuf</code> with the corresponding functionality and use that to initialise an <code>std::istream</code>."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1544654315, "post_id": 53752421, "comment_id": 94357733, "body": "Or <code>std::stringstream</code> for mixed operations."}, {"owner": {"reputation": 807, "user_id": 1910890, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9871372bb6d3926c1a7d79add5dad507?s=128&d=identicon&r=PG", "display_name": "headbanger", "link": "https://stackoverflow.com/users/1910890/headbanger"}, "edited": false, "score": 0, "creation_date": 1544721439, "post_id": 53752421, "comment_id": 94385837, "body": "Hi RS - I&#39;ll give you the tick - but Thomas Matthews and SergeyA are the ones with the answer that works for me.  Just not written in a way I can vote for!"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 807, "user_id": 1910890, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9871372bb6d3926c1a7d79add5dad507?s=128&d=identicon&r=PG", "display_name": "headbanger", "link": "https://stackoverflow.com/users/1910890/headbanger"}, "edited": false, "score": 0, "creation_date": 1544721907, "post_id": 53752421, "comment_id": 94386076, "body": "@headbanger, you also have option of posting an answer that works for you, with due credit given to Thomas Matthews and SergeyA, and accept that answer."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 5, "last_activity_date": 1544654101, "creation_date": 1544654101, "answer_id": 53752421, "question_id": 53752360, "link": "https://stackoverflow.com/questions/53752360/how-can-i-add-a-char-to-an-istringstream/53752421#53752421", "title": "How can I add a char to an istringstream?", "body": "<blockquote>\n  <p>I'm trying to add a char to an <code>istringstream</code></p>\n</blockquote>\n\n<p>You cannot do that. It does not make sense either.</p>\n\n<p>You are expected to read from an <code>istringstream</code> and write to an <code>ostringstream</code>.</p>\n\n<p>Use <code>ostringstream</code> instead.</p>\n\n<pre><code>ostringstream output_buffer;    \n\nwhile (is.get(c)) {\n    output_buffer &lt;&lt; c;\n}\n</code></pre>\n"}], "owner": {"reputation": 807, "user_id": 1910890, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9871372bb6d3926c1a7d79add5dad507?s=128&d=identicon&r=PG", "display_name": "headbanger", "link": "https://stackoverflow.com/users/1910890/headbanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 53752421, "answer_count": 1, "score": 0, "last_activity_date": 1544705921, "creation_date": 1544653775, "question_id": 53752360, "link": "https://stackoverflow.com/questions/53752360/how-can-i-add-a-char-to-an-istringstream", "title": "How can I add a char to an istringstream?", "body": "<p>I'm trying to add a char to an istringstream - as so:</p>\n\n<pre><code>using namespace std;\nistringstream input_buffer;    \nchar c;\n\nwhile (is.get(c)) {\n    input_buffer &lt;&lt; c;\n}\n</code></pre>\n\n<p>Sadly, this results in:</p>\n\n<pre><code> error: invalid operands to binary expression ('std::__1::istringstream' (aka 'basic_istringstream&lt;char&gt;') and 'int')\n</code></pre>\n\n<p>What am I doing wrong?  How can I do it right?</p>\n"}, {"tags": ["c++", "templates", "c++17", "clang++", "generic-lambda"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1544654481, "post_id": 53752341, "comment_id": 94357796, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 1, "creation_date": 1544654834, "post_id": 53752341, "comment_id": 94357932, "body": "What&#39;s the point of your <code>void_bind</code> call here?  Why not just use a lambda capture:  <code>[this, playerID = ch-&gt;GetPlayerID()]() { return this-&gt;RefreshCommentForce(playerID); }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1544656108, "last_edit_date": 1544656108, "creation_date": 1544654700, "answer_id": 53752542, "question_id": 53752341, "link": "https://stackoverflow.com/questions/53752341/no-type-named-argument-type/53752542#53752542", "title": "No type named &#39;argument_type&#39;", "body": "<p>If I understand correctly, you're using in <code>void_bind()</code> the type derived from the first template argument, <code>F</code>,</p>\n\n<pre><code>F::argument_type\n</code></pre>\n\n<p>that is a typename (deprecated, in C++17) defined in <code>std::function&lt;R(Args...)&gt;</code> but only when <code>Args...</code> is only one type (only when the function receive only one argument).</p>\n\n<p>But you pass to <code>void_bind()</code> a generic lambda</p>\n\n<pre><code>FuncAfterQuery(void_bind([this](auto&amp;&amp; data) { return this-&gt;RefreshCommentForce(data); }, [...]\n</code></pre>\n\n<p>that isn't a <code>std::function</code> and doesn't define a <code>argument_type</code></p>\n\n<p>So I suggest (but I can't prove... your example is sub-optimal) to save the lambda in an appropriate <code>std::function</code> and pass the <code>std::function</code> to <code>void_bind()</code></p>\n\n<p>Something as</p>\n\n<pre><code>std::function&lt;RetType(ArgType)&gt;\n   f { [this](auto&amp;&amp; data) { return this-&gt;RefreshCommentForce(data); } };\n\nFuncAfterQuery(void_bind(f, ch-&gt;GetPlayerID()), [...]\n</code></pre>\n\n<p>with the appropriate (?) <code>RetType</code> and <code>ArgType</code> types.</p>\n"}], "owner": {"reputation": 467, "user_id": 6549471, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-W5J7u3jfRFU/AAAAAAAAAAI/AAAAAAAAABc/cClQMZezKig/photo.jpg?sz=128", "display_name": "Dev", "link": "https://stackoverflow.com/users/6549471/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544656108, "creation_date": 1544653676, "last_edit_date": 1544656021, "question_id": 53752341, "link": "https://stackoverflow.com/questions/53752341/no-type-named-argument-type", "title": "No type named &#39;argument_type&#39;", "body": "<p>I have this function:</p>\n\n<pre><code>void CGuild::AddComment(LPCHARACTER ch, const std::string&amp; str)\n{   if (str.length() &gt; GUILD_COMMENT_MAX_LEN)\n        return;\n\n    char text[GUILD_COMMENT_MAX_LEN * 2 + 1];\n    DBManager::instance().EscapeString(text, sizeof(text), str.c_str(), str.length());\n\n    DBManager::instance().FuncAfterQuery(void_bind([this](auto&amp;&amp; data) { return this-&gt;RefreshCommentForce(data); }, ch-&gt;GetPlayerID()),\n            \"INSERT INTO guild_comment%s(guild_id, name, notice, content, time) VALUES(%u, '%s', %d, '%s', NOW())\", \n            get_table_postfix(), m_data.guild_id, ch-&gt;GetName(), (str[0] == '!') ? 1 : 0, text);\n}\n</code></pre>\n\n<p>and I'm compiling with clang++-devel in C++1z, at a Linux enviroment. The file generates this error:</p>\n\n<pre><code>./any_function.h:41:15: error: no type named 'argument_type' in '(lambda at\n      guild.cpp:1023:49)'\n                typename F::argument_type value;\n                ~~~~~~~~~~~~^~~~~~~~~~~~~\nguild.cpp:1023:39: note: in instantiation of template class 'void_binder&lt;(lambda\n      at guild.cpp:1023:49)&gt;' requested here\n        DBManager::instance().FuncAfterQuery(void_bind([this](auto&amp;&amp; dat...\n                                             ^\n</code></pre>\n\n<p>and here is the any_function.h:</p>\n\n<pre><code>template &lt;class F&gt;\nclass void_binder\n{\n    protected:\n        F f;\n        typename F::argument_type value;\n    public:\n        void_binder(const F&amp; f, const typename F::argument_type x)\n            : f(f), value(x) {}\n        void operator()() const {\n            return f(value);\n        }\n};\n\ntemplate &lt;class F, class Arg&gt; \ninline void_binder&lt;F&gt; void_bind(const F&amp; f, const Arg&amp; arg)\n{\n    typedef typename F::argument_type arg_type;\n    return void_binder&lt;F&gt;(f, arg_type(arg));\n}\n</code></pre>\n\n<p>How can I resolve this error?</p>\n\n<p>Thank you for your comments.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1544653711, "post_id": 53752248, "comment_id": 94357482, "body": "<code>int* test[10];</code> declares an array of 10 pointers. These pointers have not been pointed at valid storage, so trying to Read them or write to them is an adventure in the lands of Undefined Behaviour where ANYTHING can happen."}, {"owner": {"reputation": 356, "user_id": 10772072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb79441d39cbdf6cd725ecfa1d42c65?s=128&d=identicon&r=PG&f=1", "display_name": "Xion", "link": "https://stackoverflow.com/users/10772072/xion"}, "edited": false, "score": 0, "creation_date": 1544653744, "post_id": 53752248, "comment_id": 94357498, "body": "A short answer is there is only one value in test which is 5 the first value so [0][0] = 5, there is no other value store after that so [0][1] will give seg fault"}, {"owner": {"reputation": 1, "user_id": 10783099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MTD_iKY5pbU/AAAAAAAAAAI/AAAAAAAAAwo/UpAQJo5xCwg/photo.jpg?sz=128", "display_name": "Dominic Barker", "link": "https://stackoverflow.com/users/10783099/dominic-barker"}, "edited": false, "score": 0, "creation_date": 1544653861, "post_id": 53752248, "comment_id": 94357545, "body": "Hi why does [0][0] give 5? I thought the syntax was *test[0] ? Cheers Dom"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 356, "user_id": 10772072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb79441d39cbdf6cd725ecfa1d42c65?s=128&d=identicon&r=PG&f=1", "display_name": "Xion", "link": "https://stackoverflow.com/users/10772072/xion"}, "edited": false, "score": 0, "creation_date": 1544653951, "post_id": 53752248, "comment_id": 94357578, "body": "I&#39;m afraid that&#39;s not correct, @Xion. There is no valid <code>[0][0]</code> either. It&#39;s only through dumb luck and the magic of undefined behaviour that <code>*(test[0]) = 5;</code> stored a 5 where it could be read back."}, {"owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "edited": false, "score": 0, "creation_date": 1544655810, "post_id": 53752248, "comment_id": 94358249, "body": "If p is a pointer to a non-void type, then <i>*p and p[0]</i> are exactly equivalent.  So is <i>*(p+1) and p[1]</i>,  <i>*(p+2) and p[2]</i>, etc."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10783099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MTD_iKY5pbU/AAAAAAAAAAI/AAAAAAAAAwo/UpAQJo5xCwg/photo.jpg?sz=128", "display_name": "Dominic Barker", "link": "https://stackoverflow.com/users/10783099/dominic-barker"}, "edited": false, "score": 0, "creation_date": 1544655038, "post_id": 53752372, "comment_id": 94357999, "body": "Thanks for the post. I think it&#39;s the first line that I struggle with because int* test[10] looks like it test is array of 10 pointers to ints but it&#39;s an array of pointers to an array of ints. is the syntax the same for both cases?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 1, "user_id": 10783099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MTD_iKY5pbU/AAAAAAAAAAI/AAAAAAAAAwo/UpAQJo5xCwg/photo.jpg?sz=128", "display_name": "Dominic Barker", "link": "https://stackoverflow.com/users/10783099/dominic-barker"}, "edited": false, "score": 0, "creation_date": 1544655242, "post_id": 53752372, "comment_id": 94358072, "body": "<code>int *x</code> is a pointer to a single int or a pointer to the first of a sequence of ints, it&#39;s the same. Similarily, <code>int test[10]</code> is an array of 10 such pointers, each pointing either to a single int or to the first one in a sequence of ints."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1544654136, "last_edit_date": 1544654136, "creation_date": 1544653832, "answer_id": 53752372, "question_id": 53752248, "link": "https://stackoverflow.com/questions/53752248/understanding-c-syntax-for-array-pointers-double-brackets/53752372#53752372", "title": "Understanding C++ syntax for array pointers double brackets", "body": "<p>Already the first part </p>\n\n<pre><code>int* test[10];\n*(test[0]) = 5;\n</code></pre>\n\n<p>is undefined behaviour, because you dereference an uninitialized pointer value.</p>\n\n<p>Explanation:</p>\n\n<ul>\n<li><p><code>int* test[10]</code> is an array of 10 pointers to ints, each pointer\nbeing not initialized and definitely not pointing to a memory that\nyou reserved to store ints.</p></li>\n<li><p><code>test[0]</code> gives an uninitialized pointer; already this statement is\nUB</p></li>\n<li><p><code>*(test[0]) = 5</code> dereferences an arbitrary pointer value, definitely\nUB</p></li>\n</ul>\n\n<p>Try:</p>\n\n<pre><code>int* test[10];\nint  firstLine[5] = { 1,2,3,4,5 };\ntest[0] = firstLine;\ncout &lt;&lt; test[0][0]; // gives 1, firstLine[0]\ncout &lt;&lt; test[0][1]; // gives 2, is the same as firstLine[1]\n// cout &lt;&lt; test[1][0]; // undefined behaviour, the second pointer in array test is not initialized\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1544654372, "post_id": 53752400, "comment_id": 94357753, "body": "Also, <code>x[ptr]</code> :)"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1544654958, "post_id": 53752400, "comment_id": 94357972, "body": "True, however since the OP is a new poster, I purposely left out that construction since it&#39;s likely to cause confusion, and do more harm than good.  I fully agree that it is technically correct, but at the same time there is wisdom (in my extremely humble opinion) in avoiding it in production code simply as a means to help keep the code clear and easily understood."}], "tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": false, "score": 1, "last_activity_date": 1544653960, "creation_date": 1544653960, "answer_id": 53752400, "question_id": 53752248, "link": "https://stackoverflow.com/questions/53752248/understanding-c-syntax-for-array-pointers-double-brackets/53752400#53752400", "title": "Understanding C++ syntax for array pointers double brackets", "body": "<p>C++ permits the use of array notation <code>[</code> <code>]</code> when dereferencing a pointer.</p>\n\n<p>In the simplest case, you can say something like:</p>\n\n<pre><code>char *ptr = new char[10];\n</code></pre>\n\n<p>That creates a pointer to char, which points to the first character in an array of ten characters allocated with <code>new[]</code>.</p>\n\n<p>After doing this:</p>\n\n<pre><code>char ch = *ptr;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>char ch = ptr[0];\n</code></pre>\n\n<p>do the exact same thing.  However since there are 10 characters in the array, you can also say:</p>\n\n<pre><code>char ch5 = ptr[5];\n</code></pre>\n\n<p>to access an element further up the array.</p>\n\n<p>This leads to an eqivalence in C++ (and C, where it originated) that:</p>\n\n<pre><code>ptr[x];\n</code></pre>\n\n<p>is identical to:</p>\n\n<pre><code>*(ptr + x);\n</code></pre>\n\n<p>for any pointer / array referenced by <code>ptr</code> and any index <code>x</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10783099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MTD_iKY5pbU/AAAAAAAAAAI/AAAAAAAAAwo/UpAQJo5xCwg/photo.jpg?sz=128", "display_name": "Dominic Barker", "link": "https://stackoverflow.com/users/10783099/dominic-barker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1544654136, "creation_date": 1544653117, "last_edit_date": 1544653929, "question_id": 53752248, "link": "https://stackoverflow.com/questions/53752248/understanding-c-syntax-for-array-pointers-double-brackets", "title": "Understanding C++ syntax for array pointers double brackets", "body": "<p>I writing a script which receives a structure (Evt) which holds an array of pointers <code>uint16_t *DataChannel[Evt-&gt;ChSize[ch]]</code>. I can then loop over the data and print out of the value as so: </p>\n\n<pre><code>for(uint16_t ch=0; ch&lt;sizeof(Evt-&gt;DataChannel)/sizeof(Evt-&gt;DataChannel[0]); ++ch){                                                                                       \n for(int adc_it=0; adc_it&lt;(Evt-&gt;ChSize[ch]); ++adc_it){                                                                                                                                                                                    for(int adc_it=0; adc_it&lt;(Evt-&gt;ChSize[ch]); ++adc_it){                                                                                                                 \n       std::cout &lt;&lt; (Evt-&gt;DataChannel)[ch][adc_it] &lt;&lt; \" \";                                                                                                                  \n    }    \n }\n</code></pre>\n\n<p>I don't understand  where the second bracket comes from ([adc_it]), what it is doing and how it works. I think (<code>Evt-&gt;DataChannel</code>) should be a <code>uint16_t</code> which is not an array so why the second bracket?  </p>\n\n<p>I tried to replicate this in a quick piece of code:</p>\n\n<pre><code> #include &lt;iostream&gt;\n\nint main()\n{\n   int* test[10];\n   *(test[0]) = 5;\n\n   std::cout &lt;&lt; test[0][0] &lt;&lt; std::endl;  //Gives 5 \n   std::cout &lt;&lt; test[0][1] &lt;&lt; std::endl;  //Seg faults\n\n   return 0;\n}\n</code></pre>\n\n<p>Again can some explain what <code>test[0][0]</code> is doing because I have no idea and why it runs but <code>test[0][1]</code> fails? </p>\n\n<p>Cheers\nDom </p>\n"}, {"tags": ["c++", "c++11", "boost-python", "pybind11", "pybinding"], "answers": [{"tags": [], "owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1573169488, "creation_date": 1573169488, "answer_id": 58758362, "question_id": 53752165, "link": "https://stackoverflow.com/questions/53752165/wrapping-variadic-templates-in-pybind11/58758362#58758362", "title": "Wrapping variadic templates in pybind11", "body": "<p>Mixing templates and Python is best done at run-time to make sure you have all template instantiations that will actually be used. You can do that with cppyy (<a href=\"http://cppyy.org\" rel=\"nofollow noreferrer\">http://cppyy.org</a>), which uses Cling (LLVM) underneath to instantiate the templates.</p>\n\n<p>Using your example (with <code>cerr</code> replacing your <code>LOG</code>, the specific code for which you did not post):</p>\n\n<pre><code>import cppyy\n\n# variadic template example; the code can also live in a header which is loaded \n# with \"cppyy.include()\"\ncppyy.cppdef(r\"\"\"\n    template &lt;typename Arg, typename... Args&gt;\n    void log(int level, Arg&amp;&amp; arg, Args&amp;&amp;... args)\n    {   \n        std::stringstream out;\n        out &lt;&lt; std::forward&lt;Arg&gt;(arg);\n        using expander = int[];\n        (void)expander{0, (void(out &lt;&lt; ' ' &lt;&lt; std::forward&lt;Args&gt;(args)), 0)...};\n        std::cerr &lt;&lt; out.str() &lt;&lt; '\\n';\n    }\n\"\"\")\n\nlevel = 1\ncppyy.gbl.log(level, 1, \"string\", 3.14)\n</code></pre>\n\n<p>which has the expected out of:</p>\n\n<pre><code>1 string 3.14\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10763518, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-26GPwPuUuN8/AAAAAAAAAAI/AAAAAAAAAx4/hZfvlvc6KIw/photo.jpg?sz=128", "display_name": "Amey Narkhede", "link": "https://stackoverflow.com/users/10763518/amey-narkhede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 58758362, "answer_count": 1, "score": 1, "last_activity_date": 1573169488, "creation_date": 1544652674, "last_edit_date": 1544654747, "question_id": 53752165, "link": "https://stackoverflow.com/questions/53752165/wrapping-variadic-templates-in-pybind11", "title": "Wrapping variadic templates in pybind11", "body": "<p>I'm writing python bindings for glog like library which uses macro and has cout like syntax for logging.\n<code>LOG(LEVEL)&lt;&lt;\" \"&lt;&lt;\" \"...</code>.\nSo I'm using this function to call the macro</p>\n\n<pre><code>    template &lt;typename Arg, typename... Args&gt;\n    void log(auto level, Arg&amp;&amp; arg, Args&amp;&amp;... args)\n    {\n        std::stringstream out;\n        out &lt;&lt; std::forward&lt;Arg&gt;(arg);\n        using expander = int[];\n        (void)expander{0, (void(out &lt;&lt; ' ' &lt;&lt; std::forward&lt;Args&gt;(args)), 0)...};\n        LOG(level) &lt;&lt; out.str();\n    }\n</code></pre>\n\n<p>So in order to wrap this function for pybind11 module I need to explicitly specify template type.\nIs there any possible workaround or way to bind this function using pybind11? I'm also open to use other libraries like boost.python or even cython if its possible.</p>\n"}, {"tags": ["c++", "pointers", "constructor", "arduino"], "comments": [{"owner": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "edited": false, "score": 1, "creation_date": 1544652612, "post_id": 53752096, "comment_id": 94357050, "body": "you should post a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> (especially focus on the M part)"}, {"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 0, "creation_date": 1544652869, "post_id": 53752096, "comment_id": 94357155, "body": "I&#39;ll try to recreate the problem in a C++ console application and update the post. If you have suggestions for the title I&#39;ll happily change it to something more constructive."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1544652871, "post_id": 53752096, "comment_id": 94357158, "body": "<code>JFSF_PRIV::SwitchContinuousAction newBtnAction(_joystick, inputPin, btnIndex);</code> then <code>_actions[_nextActionIndex++] = &amp;newBtnAction;</code> is a common mistake. You can&#39;t store the address of a temporary and use it later. <code>newBtnAction</code> no longer exists after the function ends making the pointer invalid / point to random garbage memory. This is a case of Undefined Behavior. Unluckily it worked for some of your cases."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1544653099, "post_id": 53752096, "comment_id": 94357244, "body": "The problem is essentially the same as this: <a href=\"https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope/6445794#6445794\" title=\"can a local variables memory be accessed outside its scope\">stackoverflow.com/questions/6441218/&hellip;</a>"}, {"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 0, "creation_date": 1544653421, "post_id": 53752096, "comment_id": 94357384, "body": "Thanks, that makes sense and would correspond with the problem I&#39;m having. I&#39;ll post a fix once I figured it out. I&#39;ll update the title to be more descriptive as well."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1544653984, "post_id": 53752096, "comment_id": 94357598, "body": "&quot;I&#39;ll post a fix once I figured it out&quot; ... you can answer your own question if you like, but please dont edit your question to fix errors in the code!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544654178, "post_id": 53752096, "comment_id": 94357680, "body": "also your &quot;Update 0&quot; does not belong in the question. Comments are there to be deleted at some point and your question is rather pointless when it starts with the answer before saying what is the problem ;)"}, {"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 0, "creation_date": 1544654432, "post_id": 53752096, "comment_id": 94357778, "body": "Right, I don&#39;t know exactly what the policy is here. The problem is that the problem description is kind of the answer as well since my original question was simply wrong."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544655432, "post_id": 53752096, "comment_id": 94358129, "body": "<b><i>Right, I don&#39;t know exactly what the policy is here</i></b> StackOverflow is a Q&amp;A site with the primary goal to help future readers with the same problem.  The question should not contain the answer.  I think with my edit I fixed it in a reasonable manner."}, {"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1544657195, "post_id": 53752096, "comment_id": 94358681, "body": "I&#39;ve included my code change in a separate answer as well just in case someone might find it useful. I&#39;ll leave @user463035818 &#39;s answer as the accepted one since it&#39;s more clear on what the core of the issue is."}], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 0, "creation_date": 1544654276, "post_id": 53752316, "comment_id": 94357715, "body": "I recall I started with that approach but couldn&#39;t figure out how to store an array of objects using a common abstract interface (with the shared <code>void loop()</code> signature). I&#39;ll have to go over some tutorials. Thanks for the help."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 1, "creation_date": 1544654351, "post_id": 53752316, "comment_id": 94357746, "body": "@RiceKab ok, sorry missed that. Still no reason to get your hands dirty. In that case you store smart pointers in the container and they&#39;ll do the clean up for you"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 1, "creation_date": 1544654469, "post_id": 53752316, "comment_id": 94357790, "body": "@RiceKab <code>std::unique_ptr</code> and <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique\" rel=\"nofollow noreferrer\"><code>std::make_unique</code></a> are your best friends when faced with a problem like this."}, {"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 0, "creation_date": 1544654910, "post_id": 53752316, "comment_id": 94357956, "body": "My prior experience with C++ did involve using the standard library. Unfortunately the Arduino has some severe storage and memory constraints. I do know there are some (partial) ports available so that might be worth looking into."}, {"owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "edited": false, "score": 0, "creation_date": 1544657336, "post_id": 53752316, "comment_id": 94358734, "body": "I &quot;fixed&quot; it by just moving the instance creation up to the global scope. Given the context of the application this seems like an acceptable solution. I included the code change in a separate answer below. Thanks again for the help :)"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": true, "score": 5, "last_activity_date": 1544653554, "creation_date": 1544653554, "answer_id": 53752316, "question_id": 53752096, "link": "https://stackoverflow.com/questions/53752096/c-referencing-instances-created-within-a-functions-scope/53752316#53752316", "title": "C++ referencing instances created within a function&#39;s scope", "body": "<p>I dont really understand your code. Please read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete and Verifiable example</a>. Anyhow, the following is certainly wrong and likely the cause of your problem:</p>\n\n<pre><code>void JFSF::addSwitchContinuous(int inputPin, int btnIndex)\n{\n    JFSF_PRIV::SwitchContinuousAction newBtnAction(_joystick, inputPin, btnIndex);\n    _actions[_nextActionIndex++] = &amp;newBtnAction;\n}\n</code></pre>\n\n<p>Lets rewrite it a bit for clarity:</p>\n\n<pre><code>void foo(){\n    T bar;\n    container[index] = &amp;bar;\n}\n</code></pre>\n\n<p>What happens here is that <code>bar</code> gets destroyed when it goes out of scope, hence the pointer you put into the container, points to garbage. Presumably somewhere else in your code you are dereferencing those pointers, which is undefined behaviour (aka anything can happen). </p>\n\n<p>Long story short: It is a common pattern among c++ beginners to overuse pointers. Most likely you should make <code>container</code> a container of objects rather than pointers and make use of automatic memory managment instead of trying to fight it. </p>\n"}, {"tags": [], "owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "is_accepted": false, "score": 1, "last_activity_date": 1544657038, "creation_date": 1544657038, "answer_id": 53752915, "question_id": 53752096, "link": "https://stackoverflow.com/questions/53752096/c-referencing-instances-created-within-a-functions-scope/53752915#53752915", "title": "C++ referencing instances created within a function&#39;s scope", "body": "<p>Thanks to @user463035818 and @drescherjm for identifiying the actual problem.</p>\n\n<p>So in the end I fixed it by simply moving the Action object creation up to the Arduino code (where it's essentially global) and passing references to those objects to the controller.</p>\n\n<p>In code this translates to:</p>\n\n<p><strong>JFSF.cpp</strong></p>\n\n<pre><code>void JFSF::addAction(JFSF_PRIV::AbstractAction *action){\n    _actions[_nextActionIndex++] = action;\n}\n</code></pre>\n\n<p><strong>Arduino code (ino)</strong></p>\n\n<pre><code>// See code in original post\n\nJFSF controller(&amp;joystick, !DO_AUTO_SEND_STATE);\n\nJFSF_PRIV::SwitchContinuousAction btnOne(&amp;joystick, 10, 0);\nJFSF_PRIV::SwitchContinuousAction btnTwo(&amp;joystick, 9, 1);\n\nvoid setup() {\n  joystick.begin(DO_AUTO_SEND_STATE);\n  //  controller.addSwitchContinuous(10, 0);  // Pin 10; btn index 0\n  //  controller.addSwitchContinuous(9, 1);   // Pin 9 ; btn index 1 \n  controller.addAction(&amp;btnOne);\n  controller.addAction(&amp;btnTwo);\n}\n// loop() is unchanged\n</code></pre>\n"}], "owner": {"reputation": 561, "user_id": 3073859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdWqS.png?s=128&g=1", "display_name": "ricekab", "link": "https://stackoverflow.com/users/3073859/ricekab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 53752316, "answer_count": 2, "score": 3, "last_activity_date": 1544657038, "creation_date": 1544652364, "last_edit_date": 1544655315, "question_id": 53752096, "link": "https://stackoverflow.com/questions/53752096/c-referencing-instances-created-within-a-functions-scope", "title": "C++ referencing instances created within a function&#39;s scope", "body": "<p><strong>Context</strong> </p>\n\n<p>The context of the problem is that I am currently writing a small library for use with the Arduino in order to act as a game controller. The problem I am encountering has more to do with C++ than anything Arduino specific however.</p>\n\n<p>I've included the libraries' header and source code below, followed by the Arduino code. I've truncated it where possible.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>In short, only the last switch / action I define actually gets properly handles.</p>\n\n<p>These actions get defined in the Arduino setup function. For example:</p>\n\n<pre><code>controller.addSwitchContinuous(10, 0);  // Pin 10; btn index 0\n</code></pre>\n\n<p>means that pin 10 gets mapped to button 0. When pin 10 is switched closed this is treated as the button being pressed. This works fine for a single action but when I start adding more only the last action actually works. So in the following example only pin 9 is recognized:</p>\n\n<pre><code>controller.addSwitchContinuous(10, 0);  // &lt;-- Doesn't work\ncontroller.addSwitchContinuous(9, 1);   // &lt;-- Works\n</code></pre>\n\n<p>This goes for any arbitrary number of actions:</p>\n\n<pre><code>controller.addSwitchContinuous(10, 0);  // &lt;-- Doesn't work\ncontroller.addSwitchContinuous(9, 1);   // &lt;-- Doesn't work\ncontroller.addSwitchContinuous(8, 2);   // &lt;-- Doesn't work\ncontroller.addSwitchContinuous(7, 3);   // &lt;-- Works\n</code></pre>\n\n<p><strong>Potential causes</strong></p>\n\n<p>I am fairly novice with C++ so this I suspect I'm doing something wrong with pointers. More specifically, something seems wrong with how the <code>Joystick_</code> instance gets passed around.</p>\n\n<p>I have been fiddling with the constructor and trying to use references instead of pointers but I couldn't get it to work properly.</p>\n\n<p>I can confirm the iteration in JFSF::loop does iterate over all actions, if I modify it with:</p>\n\n<pre><code>void JFSF::loop()\n    {\n        for (int n = 0; n &lt; _nextActionIndex; n++)\n        {\n            if (_actions[n])\n            {\n                _actions[n]-&gt;loop();\n                _joystick-&gt;setButton(n, PRESSED);  // Debug: Set button pressed, regardless of switch.\n            }\n        }\n        if (_doSendState)\n        {\n            _joystick-&gt;sendState();\n        }\n    }\n</code></pre>\n\n<p>then buttons 0 through n get pressed as expected. It is possible that loop() isn't properly being called, but I would expect it to fail for the N = 1 case as well in that case. Furthermore the fact the last action always succeeds would suggest the iteration is ok.</p>\n\n<p><strong>Full code</strong></p>\n\n<pre><code>// JFSF.h\n#ifndef JFSF_h\n#define JFSF_h\n\n// ... include for Arduino.h and Joystick.h; bunch of defines\n\nnamespace JFSF_PRIV\n{\nclass AbstractAction\n{\npublic:\n  virtual void loop();\n};\n\n/* A Switch that essentially acts as a push button. */\nclass SwitchContinuousAction : public AbstractAction\n{\npublic:\n  SwitchContinuousAction(Joystick_ *joystick, int pin, int btnIndex);\n  void loop();\n\nprivate:\n  Joystick_ *_joystick;\n  int _pin;\n  int _btnIndex;\n};\n\n} // namespace JFSF_PRIV\n\nclass JFSF\n{\npublic:\n  JFSF(Joystick_ *joystick, bool doSendState); // doSendState should be true if Joystick_ does not auto send state.\n  void loop();\n  void addSwitchContinuous(int inputPin, int btnIndex);\n\nprivate:\n  Joystick_ *_joystick;\n  JFSF_PRIV::AbstractAction *_actions[MAX_ACTIONS];\n  int _nextActionIndex;\n  bool _doSendState;\n};\n\n#endif\n</code></pre>\n\n<p>Source file (trimmed):</p>\n\n<pre><code>// JFSF.cpp\n#include \"Arduino.h\"\n#include \"Joystick.h\"\n#include \"JFSF.h\"\n\n#define PRESSED 1\n#define RELEASED 0\n\n// Private classes\nnamespace JFSF_PRIV\n{\n\nSwitchContinuousAction::SwitchContinuousAction(Joystick_ *joystick, int pin, int btnIndex)\n{\n    _joystick = joystick;\n    _pin = pin;\n    _btnIndex = btnIndex;\n    pinMode(_pin, INPUT_PULLUP);\n}\n\nvoid SwitchContinuousAction::loop()\n{\n    int _state = digitalRead(_pin) == LOW ? PRESSED : RELEASED;\n    _joystick-&gt;setButton(_btnIndex, _state);\n}\n\n} // namespace JFSF_PRIV\n\nJFSF::JFSF(Joystick_ *joystick, bool doSendState)\n{\n    _joystick = joystick;\n    _nextActionIndex = 0;\n    _doSendState = doSendState;\n}\n\nvoid JFSF::addSwitchContinuous(int inputPin, int btnIndex)\n{\n    JFSF_PRIV::SwitchContinuousAction newBtnAction(_joystick, inputPin, btnIndex);\n    _actions[_nextActionIndex++] = &amp;newBtnAction;\n}\n\nvoid JFSF::loop()\n{\n    for (int n = 0; n &lt; _nextActionIndex; n++)\n    {\n        if (_actions[n])\n        {\n            _actions[n]-&gt;loop();\n        }\n    }\n    if (_doSendState)\n    {\n        _joystick-&gt;sendState();\n    }\n}\n</code></pre>\n\n<p>For completeness sake, this is the code for the Arduino, but it is pretty much just declarations:</p>\n\n<pre><code>#include &lt;JFSF.h&gt;\n\n// ... A bunch of const declarations used below. These are pretty self explanatory.\n\n// See: https://github.com/MHeironimus/ArduinoJoystickLibrary#joystick-library-api\nJoystick_ joystick(HID_REPORT_ID,\n  JOYSTICK_TYPE_JOYSTICK, // _JOYSTICK, _GAMEPAD or _MULTI_AXIS\n  BTN_COUNT, HAT_SWITCH_COUNT,\n  INCLUDE_X_AXIS, INCLUDE_Y_AXIS, INCLUDE_Z_AXIS, \n  INCLUDE_RX_AXIS, INCLUDE_RY_AXIS, INCLUDE_RZ_AXIS,\n  INCLUDE_RUDDER, INCLUDE_THROTTLE, \n  INCLUDE_ACCELERATOR, INCLUDE_BRAKE, INCLUDE_STEERING);\n\nJFSF controller(&amp;joystick, !DO_AUTO_SEND_STATE);\n\nvoid setup() {\n  joystick.begin(DO_AUTO_SEND_STATE);\n  controller.addSwitchContinuous(10, 0);  // &lt;-- Doesn't work\n  controller.addSwitchContinuous(9, 1);   // &lt;-- Works\n}\n\nvoid loop() {\n  controller.loop();\n}\n</code></pre>\n\n<p><strong>References</strong></p>\n\n<p>ArduinoJoystickLibrary (Source for Joystick_) can be found here: <a href=\"https://github.com/MHeironimus/ArduinoJoystickLibrary#joystick-library-api\" rel=\"nofollow noreferrer\">https://github.com/MHeironimus/ArduinoJoystickLibrary#joystick-library-api</a></p>\n"}, {"tags": ["c++", "data-structures", "dijkstra", "adjacency-matrix", "adjacency-list"], "comments": [{"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1544652444, "post_id": 53752073, "comment_id": 94356974, "body": "You can deduce what data structures you need from those examples using the standard library, even if you aren&#39;t allowed to use it directly. Seeing your assignment, I suspect you are expected to at least use a graph."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1544655217, "post_id": 53752073, "comment_id": 94358066, "body": "<a href=\"https://stackoverflow.com/a/3448361/14065\">stackoverflow.com/a/3448361/14065</a>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 2, "creation_date": 1544656150, "post_id": 53752073, "comment_id": 94358361, "body": "To implement Dijkstra&#39;s: You need a priority queue (aka sorted list) and a set (which could be implemented as a list). The priority queue that keeps the current boundary and you pick the next item to be processed as the item in the queue with the shortest path (so the priority is distance to city). You need a set to keep track of the cities you have already reached. The algorithm needs a way of finding a set of connected cities and distances given a current city. So to implement Dijkstra&#39;s the minimal data structure you need is a list and an interface to your cities)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1544656658, "post_id": 53752073, "comment_id": 94358519, "body": "<i>I am not allowed to use any STL container at all.</i> -- Yes, because if you used STL, the program will just magically write itself.  (I hope you know that was sarcasm...).  If you <i>were</i> to use STL, what would you use?"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1544656814, "post_id": 53752073, "comment_id": 94358557, "body": "It amazes me how many instructors hand out assignments and ban the STL, and then we wonder why we keep interviewing people that don&#39;t know the STL."}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1544657216, "post_id": 53752073, "comment_id": 94358689, "body": "@ChristopherPisz: essentially all senior interviews I do have CVs claiming knowledge of STL. Reality is that hardly any of these people has even a cursory idea of what STL is about! I&#39;d not be surprised if most instructors believed that the central theme of STL are containers. ... and do instructors really want to prohibit operating in terms of concepts for iteration which is what STL is actually about?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544657881, "post_id": 53752073, "comment_id": 94358878, "body": "@OP Even if the STL was used, you still need to know what tools out of STL to use to create a program that implements Dijkstra&#39;s algorithm.  The issue with your requirements is that you may know full and well how to implement the algorithm, but the stumbling block is getting the stupid dynamic array to work properly, or the priority queue to not have bugs.  So the question is really -- is this an assignment to implement Dijkstra&#39;s algorithm, or an assignment in implementing home-made data structures?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544657999, "post_id": 53752073, "comment_id": 94358908, "body": "@OP What I advise is to first implement the solution using STL -- make sure it works.  Once it works, &quot;reverse engineer&quot; the STL parts of the code to your own data structures."}, {"owner": {"reputation": 657, "user_id": 8974764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86ac9ae2eef2b628028f15b4d70a521?s=128&d=identicon&r=PG&f=1", "display_name": "weno", "link": "https://stackoverflow.com/users/8974764/weno"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544662487, "post_id": 53752073, "comment_id": 94359925, "body": "@PaulMcKenzie I have working implementation using STL. Problem is it&#39;s using std::list, vector, pair, set and, well... std::map."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544665185, "post_id": 53752073, "comment_id": 94360423, "body": "Then you need a home-made linked list class, vector, and map.  Honestly, the work you&#39;ve already done should be sufficient -- having you make home-made containers <i>should</i> have been separate exercises before doing this current homework example.  Creating working vector, list and map classes are not trivial -- I have yet to see a student actual write, say, a bug-free, working linked list class."}], "answers": [{"tags": [], "owner": {"reputation": 928, "user_id": 13743105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DKEV8.jpg?s=128&g=1", "display_name": "Eloy P&#233;rez Torres", "link": "https://stackoverflow.com/users/13743105/eloy-p%c3%a9rez-torres"}, "is_accepted": true, "score": 1, "last_activity_date": 1600791117, "creation_date": 1600791117, "answer_id": 64013663, "question_id": 53752073, "link": "https://stackoverflow.com/questions/53752073/c-what-data-structures-for-dijkstras-should-i-use/64013663#64013663", "title": "C++ - what data structures for Dijkstra&#39;s should I use?", "body": "<p>To code Dijkstra's shortest path algorithm you only need to implement a priority queue (min heap).</p>\n<p>I recommend heap above all. The implementation of a set involves a (almost) balanced binary search tree like AVL or Red-Black Tree or Treap (Cartesian Tree), such codes are way harder by several orders of magnitude than implementing a heap. Also, all these solutions have the same running time <code>O(log n)</code> so easier to code solution come first.</p>\n"}], "owner": {"reputation": 657, "user_id": 8974764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86ac9ae2eef2b628028f15b4d70a521?s=128&d=identicon&r=PG&f=1", "display_name": "weno", "link": "https://stackoverflow.com/users/8974764/weno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 64013663, "answer_count": 1, "score": 1, "last_activity_date": 1600791117, "creation_date": 1544652249, "question_id": 53752073, "link": "https://stackoverflow.com/questions/53752073/c-what-data-structures-for-dijkstras-should-i-use", "title": "C++ - what data structures for Dijkstra&#39;s should I use?", "body": "<p><strong>The task is:</strong></p>\n\n<p><strong>Find the shortest path between two cities. Cities are connected with one-way roads.</strong>\nCities are present inside a .txt file in such manner:</p>\n\n<blockquote>\n  <p>// From // // To // // Distance //</p>\n</blockquote>\n\n<p>e.g.:</p>\n\n<blockquote>\n  <p>London Glasgow 180 </p>\n  \n  <p>Manchester Liverpool 80 </p>\n  \n  <p>York Cambridge 415 </p>\n  \n  <p>York Manchester 260</p>\n  \n  <p>Glasgow York 315</p>\n  \n  <p>Glasgow Manchester 315</p>\n</blockquote>\n\n<p>Given a source city S and target city T, find the shortest path. Calculate the distance and retrieve the taken path.</p>\n\n<p><strong>Problem is:</strong> I am not allowed to use any STL container at all. Cannot use containers such as std::list, std::vector, std::pair, std::set, etc. I am, however, able to use my own implemented dynamic data structures.</p>\n\n<p>I'm clueless which data structures should I implement and how to implement them.\nAlso, should I use priority queue, or a heap, or something else?\nAlso wondering about adjacency list or adjacency matrix. </p>\n\n<p>I don't really care if the solution is well-optimized or not. </p>\n\n<p>I have been googling much, but all Dijkstras algorithms implementations I found use plenty of STL containers, that I'm not allowed to use.</p>\n\n<p>Any tips, hints or links are appreciated. Thank you.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1544652249, "post_id": 53752011, "comment_id": 94356900, "body": "why didn&#39;t you just write <code>using buffer_t = void const *;</code> ?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1544652359, "post_id": 53752011, "comment_id": 94356933, "body": "Maybe it is just a bug in gcc 4"}, {"owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1544652392, "post_id": 53752011, "comment_id": 94356951, "body": "I actually copied it from another file, void const * makes more sense, u r right"}, {"owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1544652436, "post_id": 53752011, "comment_id": 94356970, "body": "@M.M: I think it is a compiler bug as well, can u think of a workaround?"}], "answers": [{"tags": [], "owner": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1544652544, "creation_date": 1544652544, "answer_id": 53752137, "question_id": 53752011, "link": "https://stackoverflow.com/questions/53752011/c11-invoke-a-type-conversion-while-moving-an-object/53752137#53752137", "title": "c++11 invoke a type conversion while moving an object", "body": "<p>Looks like this GCC version does not like the brace-initialization <code>item{std::move(object)}</code>. It compiles with <code>item(std::move(object))</code> though.</p>\n\n<p><a href=\"https://wandbox.org/permlink/5VK2h5eRSWGyqJsv\" rel=\"nofollow noreferrer\">live example</a></p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1544654429, "creation_date": 1544654429, "answer_id": 53752473, "question_id": 53752011, "link": "https://stackoverflow.com/questions/53752011/c11-invoke-a-type-conversion-while-moving-an-object/53752473#53752473", "title": "c++11 invoke a type conversion while moving an object", "body": "<p>The essence of the problem can be reduced to:</p>\n\n<pre><code>#include &lt;utility&gt;\n\nstruct probe_message\n{\n    int id;\n};\n\nint main()\n{\n    probe_message a;\n    probe_message b{std::move(a)};\n}\n</code></pre>\n\n<p>which is rejected by gcc 4.9.4, accepted by gcc 5+ and fixed by replacing <code>{ }</code> with <code>( )</code>.</p>\n\n<p>I believe this is the same problem as in <a href=\"https://stackoverflow.com/questions/33970892/\">List-initialization priority from object of same type</a>, addressed by DR 1467.</p>\n\n<p>gcc 4 does aggregate initialization with the list, and fails to convert <code>std::move(a)</code> to <code>int</code>.  Later versions do copy-construction or move-construction from a list of 1 element of the same type.</p>\n\n<p>The Defect Report was not resolved until after C++14 publication, too late for gcc 4 it seems.</p>\n"}], "owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53752137, "answer_count": 2, "score": 4, "last_activity_date": 1544708056, "creation_date": 1544651934, "last_edit_date": 1544708056, "question_id": 53752011, "link": "https://stackoverflow.com/questions/53752011/c11-invoke-a-type-conversion-while-moving-an-object", "title": "c++11 invoke a type conversion while moving an object", "body": "<p>I have a simple code, I compiled the code on GCC 5, 6, and 8 and deployed it to a physical testbed that uses gcc 4.8.3 for some reason, the code fails to compile on the testbed (ubuntu 14.04), I have been scratching my head to figure out what the problem is, but so far nothing. I copied the code below, </p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;utility&gt;\n\nstruct probe_payload\n{\n    int id{0};\n    int sub_id{0};\n    int snd_ts{0};\n    int rcv_ts{0};\n    int rtt_ms{1000};\n    double snd_bw_bps{0};\n    bool end_flag{false};\n};\n\nstruct probe_message\n{\n  public:\n    using buffer_t = void const *;\n\n    probe_payload info;\n    char shim[1280];\n\n};\n\ntemplate&lt;typename Packet&gt;\nstruct parcel\n{\n    explicit parcel(Packet&amp;&amp; object, int ts) : item{std::move(object)}\n    {\n        arrival_time = std::move(ts);\n    }\n\n    parcel() = delete;\n    parcel(const parcel&lt;Packet&gt;&amp; /* other */) = default;\n    parcel&lt;Packet&gt;&amp; operator=(const parcel&lt;Packet&gt;&amp; /* other */) = default;\n    parcel(parcel&lt;Packet&gt;&amp;&amp; /* other */) = default;\n    parcel&lt;Packet&gt;&amp; operator=(parcel&lt;Packet&gt;&amp;&amp; /* other */) = default;\n\n    Packet item;\n    int arrival_time{0};\n};\n\n\ntemplate &lt;typename T&gt;\nparcel&lt;T&gt; get_parcel()\n{\n    T a;\n    return parcel&lt;T&gt;{std::move(a), 10};\n}\n\n\nint main()\n{\n    auto p = get_parcel&lt;probe_message&gt;();\n    return p.arrival_time;\n}\n</code></pre>\n\n<blockquote>\n  <p>: In instantiation of 'parcel::parcel(Packet&amp;&amp;, int)\n  [with Packet = probe_message]':</p>\n  \n  <p>:48:38:   required from 'parcel get_parcel() [with T =\n  probe_message]'</p>\n  \n  <p>:54:40:   required from here</p>\n  \n  <p>:28:67: error: could not convert 'std::move((*\n  &amp; object))' from 'std::remove_reference::type {aka\n  probe_message}' to 'probe_payload'</p>\n  \n  <p>explicit parcel(Packet&amp;&amp; object, int ts) : item{std::move(object)}</p>\n</blockquote>\n\n<p>I've attached the link from <a href=\"https://godbolt.org/z/52jeuf\" rel=\"nofollow noreferrer\">compiler explorer</a>.</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1544653098, "post_id": 53751976, "comment_id": 94357241, "body": "Can you <a href=\"https://stackoverflow.com/posts/53751976/edit\">edit</a> your question to clarify what &quot;best match&quot;, &quot;exact match&quot;, and &quot;nearest match&quot; means, in regard to two arrays?  Perhaps with an example?"}, {"owner": {"reputation": 1829, "user_id": 2187015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be67c478bd88613dfecad541b287ddd?s=128&d=identicon&r=PG", "display_name": "Abdurrahim", "link": "https://stackoverflow.com/users/2187015/abdurrahim"}, "edited": false, "score": 0, "creation_date": 1544653121, "post_id": 53751976, "comment_id": 94357254, "body": "I am just guessing you are looking for is faiss <a href=\"https://github.com/facebookresearch/faiss\" rel=\"nofollow noreferrer\">github.com/facebookresearch/faiss</a> just check it out if you see this is what you want"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10782967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZCOv.png?s=128&g=1", "display_name": "gSExpln", "link": "https://stackoverflow.com/users/10782967/gsexpln"}, "is_accepted": false, "score": 0, "last_activity_date": 1544652821, "creation_date": 1544652821, "answer_id": 53752185, "question_id": 53751976, "link": "https://stackoverflow.com/questions/53751976/best-match-from-smaller-array-to-larger-array-c/53752185#53752185", "title": "best match from smaller array to larger array. (C++)", "body": "<p>If i understand correctly you want to find the first index from which the smaller array matches exactly a subset of the larger array? for example:\n[2,3], [1, 5, 2, 3, 6] ==> at index 2.</p>\n\n<pre><code>double big[N], small[M]; // M &lt;= N\nbool found = False;\n... // initialize arrays..\n\nfor (int i = 0; i &lt;= N; ++i){\n    int j = 0;\n    while (small[j] == big[i+j]){\n        j++;\n        if (j &gt;= M){\n            found = True;\n            break;\n        }\n        else if (i+j &gt;= N) return -1; //didn't find a solution.\n    }\n    if (found) return i;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10783127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f615db2e87beb5f6a6286804c70b89c?s=128&d=identicon&r=PG&f=1", "display_name": "N. Once", "link": "https://stackoverflow.com/users/10783127/n-once"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544652821, "creation_date": 1544651764, "question_id": 53751976, "link": "https://stackoverflow.com/questions/53751976/best-match-from-smaller-array-to-larger-array-c", "title": "best match from smaller array to larger array. (C++)", "body": "<p>I have two arrays filled with doubles, the first array is smaller than the second array, there is no exact match between the arrays but I am trying to see if there is a way to show where the nearest match is in both arrays. </p>\n"}, {"tags": ["c++", "image"], "comments": [{"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1544654904, "post_id": 53751945, "comment_id": 94357951, "body": "What&#39;s the purpose of this please? Is it academic - i.e. for learning or do you just want to get the job done?"}, {"owner": {"reputation": 11, "user_id": 10091403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4f96aadd7f0c784a38fb33a44500f1?s=128&d=identicon&r=PG&f=1", "display_name": "multibboi", "link": "https://stackoverflow.com/users/10091403/multibboi"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1544655671, "post_id": 53751945, "comment_id": 94358210, "body": "academic, I want to be able to play around with the image as bits and then output a new image"}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1544656542, "post_id": 53751945, "comment_id": 94358483, "body": "Look here <a href=\"https://en.m.wikipedia.org/wiki/Netpbm_format\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Netpbm_format</a> at <code>P1</code> format images. ImageMagick can turn any image into one with <code>magick image.jpg -threshold 50% -colorspace gray -compress none result.pbm</code> and the other way too."}], "owner": {"reputation": 11, "user_id": 10091403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4f96aadd7f0c784a38fb33a44500f1?s=128&d=identicon&r=PG&f=1", "display_name": "multibboi", "link": "https://stackoverflow.com/users/10091403/multibboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544657394, "creation_date": 1544651600, "last_edit_date": 1544657394, "question_id": 53751945, "link": "https://stackoverflow.com/questions/53751945/black-and-white-image-conversion-to-array-and-back", "title": "Black and white image conversion to array and back?", "body": "<p>I am looking to take a black and white image and convert it into a bit string representing each pixel with a 1 or 0. A list or array would work as well.</p>\n\n<p>I am then looking to convert in the opposite direction, from a string or array to an image.</p>\n\n<p>This is in C++.</p>\n"}, {"tags": ["c++", "algorithm"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 9, "creation_date": 1544649888, "post_id": 53751580, "comment_id": 94355785, "body": "Yes that is possible."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1544650340, "post_id": 53751580, "comment_id": 94355999, "body": "we cannot answer this because its not clear, what are the rules about where the repeats occur, for example"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 3, "creation_date": 1544653161, "post_id": 53751580, "comment_id": 94357274, "body": "Take a look at <a href=\"https://en.cppreference.com/w/cpp/algorithm/random_shuffle\" rel=\"nofollow noreferrer\"><code>std::shuffle</code></a>.  Seems a clear enough question to me."}], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 2, "last_activity_date": 1544700575, "creation_date": 1544700575, "answer_id": 53760855, "question_id": 53751580, "link": "https://stackoverflow.com/questions/53751580/generate-a-fixed-number-of-1s-on-random-positions/53760855#53760855", "title": "Generate a fixed number of 1s on random positions", "body": "<p>Try this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;random&gt;\n\nvoid print_v (const std::vector &lt;int&gt;&amp; v)\n{\n    for (int i : v)\n        std::cout &lt;&lt; i;\n    std::cout &lt;&lt; \"\\n\";\n}\n\nint main()\n{\n    std::vector &lt;int&gt; v;\n\n    v.push_back (1);\n    v.push_back (1);\n    v.push_back (0);\n    v.push_back (0);\n    v.push_back (0);\n    print_v (v);\n\n    std::random_device rd;\n    std::mt19937 g (rd ());    \n    std::shuffle (v.begin (), v.end (), g);\n    print_v (v);\n}\n</code></pre>\n\n<p>Representative output:</p>\n\n<pre><code>11000\n00011\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/DE7MYeIOmxCHYpgU\" rel=\"nofollow noreferrer\">Live demo</a></p>\n\n<p>(I'll leave constructing the original, unshuffled vector to you).</p>\n"}], "owner": {"reputation": 35, "user_id": 7210893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1170792602998315/picture?type=large", "display_name": "Adeniran Adeniyi", "link": "https://stackoverflow.com/users/7210893/adeniran-adeniyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53760855, "answer_count": 1, "score": -1, "last_activity_date": 1544707243, "creation_date": 1544649848, "last_edit_date": 1544707243, "question_id": 53751580, "link": "https://stackoverflow.com/questions/53751580/generate-a-fixed-number-of-1s-on-random-positions", "title": "Generate a fixed number of 1s on random positions", "body": "<p>Is there a way possible to get the number 1 occurring n Number of times randomly, in a <code>vector</code> that should contain only numbers <code>0</code> and <code>1</code>?</p>\n\n<p>example </p>\n\n<ol>\n<li><p><code>vector</code> size 5, <code>1</code> must occur twice randomly in the <code>vector</code></p>\n\n<blockquote>\n  <p>[0,1,0,1,0]</p>\n</blockquote></li>\n<li><p><code>vector</code> size 8, <code>1</code> must occur 5 times randomly in the <code>vector</code></p>\n\n<blockquote>\n  <p>[1,1,0,0,0,1,0,1] </p>\n</blockquote></li>\n</ol>\n\n<p>etc..</p>\n\n<p>How can it be done in C++?</p>\n"}, {"tags": ["c++", "opencl"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7711169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/126cfd867168c418e7feae34abc12234?s=128&d=identicon&r=PG&f=1", "display_name": "Sharky", "link": "https://stackoverflow.com/users/7711169/sharky"}, "edited": false, "score": 0, "creation_date": 1545134683, "post_id": 53752104, "comment_id": 94513394, "body": "I have managed to solve this in a, I think, nice and pretty enough way. I will edit my post to reflect how the code looks right at this moment."}, {"owner": {"reputation": 3, "user_id": 7711169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/126cfd867168c418e7feae34abc12234?s=128&d=identicon&r=PG&f=1", "display_name": "Sharky", "link": "https://stackoverflow.com/users/7711169/sharky"}, "edited": false, "score": 0, "creation_date": 1545135384, "post_id": 53752104, "comment_id": 94513797, "body": "I had some more questions in the text but you answered the one in the subject so I&#39;ll accept this as answer."}], "tags": [], "owner": {"reputation": 641, "user_id": 8387427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883d5988e104bc94054083b9d6a10bb3?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Savonichev", "link": "https://stackoverflow.com/users/8387427/andrew-savonichev"}, "is_accepted": true, "score": 1, "last_activity_date": 1544652394, "creation_date": 1544652394, "answer_id": 53752104, "question_id": 53751484, "link": "https://stackoverflow.com/questions/53751484/opencl-c-wrapper-is-it-possible-to-extract-the-platform-and-device-from-a-con/53752104#53752104", "title": "OpenCL C++ wrapper. Is it possible to extract the platform and device from a Context class?", "body": "<p>You can find a list of devices associated with a context by using <code>clGetContextInfo(CL_CONTEXT_DEVICES)</code> function (or <code>Context::getInfo()</code> for C++) . Then you can iterate over these devices and ask for a program build status or a build log for each device.</p>\n\n<p>Same function can be used to get a platform from a context: for <code>CL_CONTEXT_PROPERTIES</code> query will return an array of properties, which should contain a value for <code>CL_CONTEXT_PLATFORM</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7711169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/126cfd867168c418e7feae34abc12234?s=128&d=identicon&r=PG&f=1", "display_name": "Sharky", "link": "https://stackoverflow.com/users/7711169/sharky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 53752104, "answer_count": 1, "score": 0, "last_activity_date": 1545136190, "creation_date": 1544649430, "last_edit_date": 1545136190, "question_id": 53751484, "link": "https://stackoverflow.com/questions/53751484/opencl-c-wrapper-is-it-possible-to-extract-the-platform-and-device-from-a-con", "title": "OpenCL C++ wrapper. Is it possible to extract the platform and device from a Context class?", "body": "<p>I am learning OpenCL and I already know this problem can be solved by first setting up platform &amp; device the proper way.</p>\n\n<p>What I would like to find out is.\nIn the free and online course <a href=\"https://handsonopencl.github.io/\" rel=\"nofollow noreferrer\">https://handsonopencl.github.io/</a> they start setting up the environment in a more shorthand way that I like.</p>\n\n<p>I am now at Exercise9 and am supposed to write a kernel and host program from scratch. I want to solve it in this short handed way that skips setting up platform and device and instead goes straight to calling the Context class.\nLike this.</p>\n\n<pre><code>    #define DEVICE CL_DEVICE_TYPE_GPU\n    try {\n    // Create a context\n    cl::Context context(DEVICE);\n\n    // Load source and build\n    cl::Program program(context, kernelSource, true);\n\n    // Get command queue\n    cl::CommandQueue queue(context);\n\n    // Create kernel functor\n    auto pi = cl::make_kernel&lt;int&gt;(program, \"pi\");\n\n\n}\ncatch (cl::Error err) {\n    std::cout &lt;&lt; \"Exception\" &lt;&lt; std::endl;\n    std::cerr &lt;&lt; \"ERROR: \" &lt;&lt; err.what() &lt;&lt; \"(\" &lt;&lt; err_code(err.err()) &lt;&lt; \")\" &lt;&lt; std::endl;\n\n}\n</code></pre>\n\n<p>Now. I have everything setup properly. The C++ code compiles and if I provide a correct kernelSource then the program will also compile.</p>\n\n<p>So far so good.</p>\n\n<p>The problem arrives when I made a mistake in my kernel source and would like to get the CL_PROGRAM_BUILD_LOG. The only calls that I find requires that I pass a cl::device (which obviously should've existed at some point inside the Context constructor). But since I took the shorthand route I do not have this at hand outside the constructor.</p>\n\n<p>I know I can perform the calls that I skipped out on and get the values I need. But I feel that takes away from the benefit of writing this in the short hand way.</p>\n\n<p><strong>Is there any way to get a hold of the device and platform identifiers from inside the Context class ?</strong>\nMy C++ is not the strongest but from looking at the class I could not find a way. </p>\n\n<p><strong>Is there any other way in this wrapper or call that I have missed out on that can retrieve the build log for me without first setting up device and platform ?</strong></p>\n\n<p><strong>Is there any really strong reasons why I shouldn't set my code up this way ?</strong></p>\n\n<p>The only benefits I can see of scanning through platform and device is if I was interested in getting capabilities and making an informed choice. In this case I am not since I know which device I want to use already.</p>\n\n<p>EDIT:\nAdding this code snippet to show how I solved my problem using the context.getInfo() provided in the answer.</p>\n\n<pre><code>    cl::Context context;\ncl::Program program;\ncl::CommandQueue queue;\n\ntry {\n    // Create a context\n    context = cl::Context(DEVICE);\n\n    // Load source and build\n    //program = cl::Program(context, kernelSource, true); // Don't do this. It will error with \"abort() has been called\n    program = cl::Program(context, kernelSource);\n    program.build();\n\n    // Bind variables\n    d_sum = cl::Buffer(context, CL_MEM_WRITE_ONLY, sizeof(float) * 1);\n\n    // Get command queue\n    queue = cl::CommandQueue(context);\n\n    // Create kernel functor\n    auto clpi = cl::make_kernel&lt;int, cl::Buffer, cl::LocalSpaceArg&gt;(program, \"pi\");\n\n    // Run kernel\n    clpi(cl::EnqueueArgs(queue, cl::NDRange(num_steps), cl::NDRange(workgroup_size)), num_steps, d_sum, d_local_sums);\n\n    // Extract sum\n    cl::copy(queue, d_sum, h_sum.begin(), h_sum.end());\n\n}\ncatch (cl::Error err) {\n    std::cout &lt;&lt; \"Exception\" &lt;&lt; std::endl;\n    std::cerr &lt;&lt; \"ERROR: \" &lt;&lt; err.what() &lt;&lt; \"(\" &lt;&lt; err_code(err.err()) &lt;&lt; \")\" &lt;&lt; std::endl;\n\n    if (err.err() == CL_BUILD_PROGRAM_FAILURE)\n    {\n        for (cl::Device dev : context.getInfo&lt;CL_CONTEXT_DEVICES&gt;())\n        {\n            // Check the build status\n            cl_build_status status = program.getBuildInfo&lt;CL_PROGRAM_BUILD_STATUS&gt;(dev);\n            if (status != CL_BUILD_ERROR)\n                continue;\n            // Get the build log\n            std::string name = dev.getInfo&lt;CL_DEVICE_NAME&gt;();\n            std::string buildlog = program.getBuildInfo&lt;CL_PROGRAM_BUILD_LOG&gt;(dev);\n            std::cerr &lt;&lt; \"Build log for \" &lt;&lt; name &lt;&lt; \":\" &lt;&lt; std::endl\n                &lt;&lt; buildlog &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "time", "chrono"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1544649685, "post_id": 53751482, "comment_id": 94355704, "body": "The example you gave does not match the error message.  The error tells you that you just forgot to add the <code>chrono</code> namespace."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 1, "creation_date": 1544650355, "post_id": 53751482, "comment_id": 94356006, "body": "Your edit doesn&#39;t make any sense. Are you sure this is the exact error message? BTW, <a href=\"http://coliru.stacked-crooked.com/a/2f4f5956d4548711\" rel=\"nofollow noreferrer\">this seems to work fine</a>"}, {"owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "edited": false, "score": 0, "creation_date": 1544650811, "post_id": 53751482, "comment_id": 94356199, "body": "Yes, the error is correct."}, {"owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "edited": false, "score": 0, "creation_date": 1544650861, "post_id": 53751482, "comment_id": 94356222, "body": "system_clock works fine. but not the high_resolution_clock"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1544650915, "post_id": 53751482, "comment_id": 94356248, "body": "<a href=\"https://coliru.stacked-crooked.com/a/a51ace6f480c7b19\" rel=\"nofollow noreferrer\">Cannot reproduce</a>.  Even after your edit, the error still indicates that you compiled with <code>std::high_resolution_clock</code> instead of <code>std::chrono::high_resolution_clock</code>.  Maybe try a clean build to make sure you are compiling all of the right files."}, {"owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "edited": false, "score": 0, "creation_date": 1544651170, "post_id": 53751482, "comment_id": 94356380, "body": "just built again ... the above is a complied time error, std::chrono::high_resolution_clock still doesn&#39;t work"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1544651701, "post_id": 53751482, "comment_id": 94356628, "body": "Ahh, after that last edit the error makes more sense.  On your system, <code>high_resolution_clock</code> is aliased to <code>steady_clock</code>, which is not required by the standard to implement <code>to_time_t</code>.  It&#39;s possible that the two are incompatible, e.g. if <code>time_t</code> is seconds since epoch, and <code>high_resolution_clock::period</code> is smaller than 1 second, then you couldn&#39;t represent a <code>high_resolution_clock::time_point</code> as a <code>time_t</code> without a loss of precision."}], "answers": [{"tags": [], "owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "is_accepted": true, "score": 2, "last_activity_date": 1544651905, "creation_date": 1544651905, "answer_id": 53752004, "question_id": 53751482, "link": "https://stackoverflow.com/questions/53751482/c-convert-chronohigh-resolution-clock-to-time-t/53752004#53752004", "title": "C++: convert chrono::high_resolution_clock to time_t", "body": "<p>On your system, <code>high_resolution_clock</code> is aliased to <code>steady_clock</code>, which is not required by the standard to implement <code>to_time_t</code>.  It's possible that the two are incompatible, e.g. if <code>time_t</code> is seconds since epoch, and <code>high_resolution_clock::period</code> is smaller than 1 second, then you couldn't represent a <code>high_resolution_clock::time_point</code> as a <code>time_t</code> without a loss of precision.</p>\n\n<p>If you are using this for benchmarking, you can probably skip the conversion to <code>time_t</code> altogether.  Just do something like:</p>\n\n<pre><code>auto start = std::chrono::high_resolution_clock::now();\nmy_function();\nauto end = std::chrono::high_resolution_clock::now();\nstd::cout &lt;&lt; \"my_function took \" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - start).count() &lt;&lt; \" ms\" &lt;&lt; std::endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 9, "last_activity_date": 1544652009, "creation_date": 1544652009, "answer_id": 53752028, "question_id": 53751482, "link": "https://stackoverflow.com/questions/53751482/c-convert-chronohigh-resolution-clock-to-time-t/53752028#53752028", "title": "C++: convert chrono::high_resolution_clock to time_t", "body": "<p>In general, it is not possible to convert <code>chrono::high_resolution_clock::time_point</code> to <code>time_t</code>.  It is not just because it lacks a <code>to_time_t</code> member function.  It is because:</p>\n\n<blockquote>\n  <p>There is absolutely no relationship between the time <code>time_t</code> measures and the time <code>high_resolution_clock::time_point</code> measures.</p>\n</blockquote>\n\n<p>Think of <code>high_resolution_clock</code> as a stopwatch.  You can use it to measure the time it took for some event to happen.  But you can't tell the time of day with it.</p>\n\n<p>On my platform, <code>high_resolution_clock</code> measures the number of <code>nanoseconds</code> since the system booted up.  If you don't know what time the system booted, there's no way to translate <code>high_resolution_clock</code> into a time of day.</p>\n\n<p><code>time_t</code> on the other hand typically measures time since 1970-01-01 00:00:00 UTC, and so <em>does</em> have a relationship to the time-of-day.</p>\n"}], "owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 53752004, "answer_count": 2, "score": 3, "last_activity_date": 1544652009, "creation_date": 1544649420, "last_edit_date": 1544651134, "question_id": 53751482, "link": "https://stackoverflow.com/questions/53751482/c-convert-chronohigh-resolution-clock-to-time-t", "title": "C++: convert chrono::high_resolution_clock to time_t", "body": "<p>I have the following code which works fine:</p>\n\n<pre><code> auto my_time = std::chrono::system_clock::now();\n std::cout &lt;&lt; \"My Time is \" &lt;&lt; std::chrono::system_clock::to_time_t(my_time) &lt;&lt; std::endl;\n</code></pre>\n\n<p>However, if I replace system_clock with high_resolution_clock like below:</p>\n\n<pre><code>auto my_time = std::chrono::high_resolution_clock::now();\nstd::cout &lt;&lt; \"My Time is \" &lt;&lt; std::chrono::high_resolution_clock::to_time_t(my_time) &lt;&lt; std::endl;\n</code></pre>\n\n<p>I got the following error:</p>\n\n<pre><code>    no member named 'to_time_t' in 'std::__1::chrono::steady_clock'\n    std::cout &lt;&lt; \"My Time is \" &lt;&lt; std::chrono::high_resolution_clock::to_time_t(my_time) &lt;&lt; std::endl;\n                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n1 error generated.\n</code></pre>\n\n<p>Any idea how to make high_resolution_clock works here? (I am benchmarking some functions, so would like to use high_resolution_clock rather than system_clock) Thanks!</p>\n"}, {"tags": ["c++", "linux", "performance", "x86-64", "intel"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1544649248, "post_id": 53751321, "comment_id": 94355546, "body": "What is your operating system?"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1544649439, "post_id": 53751321, "comment_id": 94355621, "body": "@jxh Linux, not sure it depends on OS, rather on the intel-processor"}, {"owner": {"reputation": 152, "user_id": 8310504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462a6dbf3a5233f0b0712d5ea33a7448?s=128&d=identicon&r=PG&f=1", "display_name": "K. Nielson", "link": "https://stackoverflow.com/users/8310504/k-nielson"}, "edited": false, "score": 0, "creation_date": 1544650220, "post_id": 53751321, "comment_id": 94355945, "body": "See <a href=\"https://danluu.com/3c-conflict/\" rel=\"nofollow noreferrer\">this article</a> on the effect of page alignment.  It looks like the effect you are observing is related."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544670627, "post_id": 53751321, "comment_id": 94361649, "body": "The <code>void doit(...)</code> function at the top of your question doesn&#39;t do anything with <code>result</code>.  gcc and clang both optimize it away completely.  <a href=\"https://godbolt.org/z/6P4sqh\" rel=\"nofollow noreferrer\">godbolt.org/z/6P4sqh</a>.  gcc optimizes the whole function to just <code>ret</code>, while clang still loops the right number of times but doesn&#39;t read memory.  If you returned the result, it couldn&#39;t be optimized away.  (Assuming that the caller also did something with it to defeat optimization after inlining.) <a href=\"https://godbolt.org/z/4vjC9v\" rel=\"nofollow noreferrer\">godbolt.org/z/4vjC9v</a>"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544671008, "post_id": 53751321, "comment_id": 94361730, "body": "When you&#39;re getting L1 hits, it&#39;s not really accurate to claim 64 bytes &quot;transferred&quot; when you&#39;re only reading 4 bytes.  You need a CPU with AVX512 to actually read 64 bytes from L1d with a single uop, and using 512-bit vectors reduces the max turbo clock on current Intel CPUs.  (Also, without loop unrolling with multiple accumulators, you&#39;ll bottleneck on the 1 cycle latency of <code>add</code> instead of the 2 load per clock L1d throughput.)"}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1544671215, "post_id": 53754136, "comment_id": 94361790, "body": "For a low enough iteration count, branch prediction correctly predicts the loop-exit branch of the inner-most loop.  e.g. a 21 taken, 1 not-taken, 21 taken, 1 not-taken pattern.  Beyond about 22 or 23 iterations on Skylake, the loop-exit branch will mispredict, so you have one mispredict (on the inner loop exit) per iteration of the outer loop.  The more inner loop iterations you have, the less of the total cost this represents.  And yes, unrolling will help a lot, letting out-of-order exec run ahead and see the mispredict, and not requiring 4 uops per clock throughput to keep up."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544671807, "post_id": 53754136, "comment_id": 94361924, "body": "@PeterCordes Thanks for the info. I am mainly surprised by the seemingly random peaks around 2.5 in the non-unrolled loop case. For example for <code>size = 35*BLOCK_SIZE</code> there seems to be one misprediction for the inner loop, while there is none for <code>34*BLOCK_SIZE</code> or <code>36*BLOCK_SIZE</code>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1544672358, "post_id": 53754136, "comment_id": 94362028, "body": "TAGE predictors use recent branch history (taken/not-taken) as part of the <i>index</i> into the branch-prediction cache.  This is the kind of weirdness you should expect when you&#39;re on the cusp of running out of BTB space or aliasing: one pattern predicts very well, a similar pattern runs into aliasing between important branches and predicts poorly.  (The actual index function is usually a hash of branch history and branch address.)  e.g. <a href=\"https://www.irisa.fr/caps/people/seznec/L-TAGE.pdf\" rel=\"nofollow noreferrer\">irisa.fr/caps/people/seznec/L-TAGE.pdf</a> and <a href=\"https://comparch.net/2013/06/30/why-tage-is-the-best/\" rel=\"nofollow noreferrer\">comparch.net/2013/06/30/why-tage-is-the-best</a>"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1544681473, "post_id": 53754136, "comment_id": 94364262, "body": "@user10605163 it really looks like branch misses are the reason. It seems I don&#39;t really understand what going on here, because it comes as a complete surprise to me, it plays a role at all..."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1544682542, "post_id": 53754136, "comment_id": 94364589, "body": "@ead: nested loops where the inner-most loop has a small iteration count are a problem. It creates a pattern like every 25th execution of the same branch is not-taken, and the rest are taken.  A mispredict stalls the pipeline and results in discarding a lot of work that was in flight. (And with a not-unrolled loop, out-of-order execution isn&#39;t helping as much as it could without a front-end bottleneck.) The last edit to this answer added a nice summary of that effect. See Agner Fog&#39;s cpu microarchitecture guide (<a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a>) and <a href=\"https://stackoverflow.com/tags/x86/info\">stackoverflow.com/tags/x86/info</a> for more."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "is_accepted": true, "score": 18, "last_activity_date": 1544673458, "last_edit_date": 1544673458, "creation_date": 1544667409, "answer_id": 53754136, "question_id": 53751321, "link": "https://stackoverflow.com/questions/53751321/reason-for-collapse-of-memory-bandwidth-when-2kb-of-data-is-cached-in-l1-cache/53754136#53754136", "title": "Reason for collapse of memory bandwidth when 2KB of data is cached in L1-cache", "body": "<p>I changed the values slightly: <code>NITER = 100000</code> and <code>NTRIES=1</code> to get a less noisy result.</p>\n\n<p>I don't have a Broadwell available right now, however I tried your code on my Coffee-Lake and got a performance drop, not at 2KB, but around 4.5KB. In addition I find erratic behavior of the throughput slightly above 2KB.</p>\n\n<p>The blue line in the graph corresponds to your measurement (left axis):\n<a href=\"https://i.stack.imgur.com/qpz4a.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/qpz4a.png\" alt=\"\"></a></p>\n\n<p>The red line here is the result from <code>perf stat -e branch-instructions,branch-misses</code>, giving the fraction of branches that were not correctly predicted (in percent, right axis). As you can see there is a clear anti-correlation between the two.</p>\n\n<p>Looking into the more detailed <code>perf</code> report, I found that basically all of these branch mispredictions happen in the most inner loop in <code>Worker::operator()</code>. If the taken/non-taken pattern for the loop branch becomes too long the branch predictor will not be able to keep track of it and so the exit branch of the inner loop will be mispredicted, leading to the sharp drop in throughput. With further increasing number of iterations the impact of this single mispredict will become less significant leading to the slow recover of the throughput.</p>\n\n<p>For further information on the erratic behavior before the drop see the comments made by @PeterCordes below.</p>\n\n<p>In any case the best way to avoid branch mispredictions is to avoid branches and so I manually unrolled the loop in <code>Worker::operator()</code>, like e.g.:</p>\n\n<pre><code>void operator()(){\n    for(size_t i=0;i+3*BLOCK_SIZE&lt;n;i+=BLOCK_SIZE*4){\n         result+=mem[i];\n         result+=mem[i+BLOCK_SIZE];\n         result+=mem[i+2*BLOCK_SIZE];\n         result+=mem[i+3*BLOCK_SIZE];\n    }\n}\n</code></pre>\n\n<p>Unrolling 2, 3, 4, 6 or 8 iterations gives the results below. Note that I did not correct for the blocks at the end of the vector which were ignored due to the unrolling. Therefore the periodic peaks in the blue line should be ignored, the lower bound base line of the periodic pattern is the actual bandwidth.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BOwmA.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/BOwmA.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/aVXTx.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/aVXTx.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/VnQlQ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/VnQlQ.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/bYOSB.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/bYOSB.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/19nIZ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/19nIZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see the fraction of branch mispredictions didn't really change, but because the total number of branches is reduced by the factor of unrolled iterations, they will not contribute strongly to the performance anymore.</p>\n\n<p>There is also an additional benefit of the processor being more free to do the calculations out-of-order if the loop is unrolled.</p>\n\n<p>If this is supposed to have practical application I would suggest to try to give the hot loop a compile-time fixed number of iteration or some guarantee on divisibility, so that (maybe with some extra hints) the compiler can decide on the optimal number of iterations to unroll.</p>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 2242890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6117450dad2bc883741eac32bf0debbe?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/2242890/mario"}, "is_accepted": false, "score": 2, "last_activity_date": 1544681527, "creation_date": 1544681527, "answer_id": 53755914, "question_id": 53751321, "link": "https://stackoverflow.com/questions/53751321/reason-for-collapse-of-memory-bandwidth-when-2kb-of-data-is-cached-in-l1-cache/53755914#53755914", "title": "Reason for collapse of memory bandwidth when 2KB of data is cached in L1-cache", "body": "<p>Might be unrelated but your Linux machine might playing with CPU frequency. I know Ubuntu 18 has a gouverner that is balanced between power and performance. You also want to play with the process affinity to make sure it does not get migrated to different core while running. </p>\n"}], "owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 7, "accepted_answer_id": 53754136, "answer_count": 2, "score": 26, "last_activity_date": 1544857885, "creation_date": 1544648696, "last_edit_date": 1544735333, "question_id": 53751321, "link": "https://stackoverflow.com/questions/53751321/reason-for-collapse-of-memory-bandwidth-when-2kb-of-data-is-cached-in-l1-cache", "title": "Reason for collapse of memory bandwidth when 2KB of data is cached in L1-cache", "body": "<p>In a self-educational project I measure the bandwidth of the memory with help of the following code (here paraphrased, the whole code follows at the end of the question):</p>\n\n<pre><code>unsigned int doit(const std::vector&lt;unsigned int&gt; &amp;mem){\n   const size_t BLOCK_SIZE=16;\n   size_t n = mem.size();\n   unsigned int result=0;\n   for(size_t i=0;i&lt;n;i+=BLOCK_SIZE){           \n             result+=mem[i];\n   }\n   return result;\n}\n\n//... initialize mem, result and so on\nint NITER = 200; \n//... measure time of\n   for(int i=0;i&lt;NITER;i++)\n       resul+=doit(mem)\n</code></pre>\n\n<p><code>BLOCK_SIZE</code> is choosen in such a way, that a whole 64byte cache line is fetched per single integer-addition. My machine (an Intel-Broadwell) needs about 0.35 nanosecond per integer-addion, so the code above could saturate a bandwith as high as 182GB/s (this value is just an upper bound and is probably quite off, what is important is the ratio of bandwidths for different sizes). The code is compiled with <code>g++</code> and <code>-O3</code>.</p>\n\n<p>Varying the size of the vector, I can observe expected bandwidths for L1(*)-, L2-, L3-caches and the RAM-memory:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Uyr5.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/5Uyr5.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, there is an effect I'm really struggling to explain: the collapse of the measured bandwidth of L1-cache for sizes around 2 kB, here in somewhat higher resolution:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Y6YX.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/5Y6YX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I could reproduce the results on all machines I have access to (which have Intel-Broadwell and Intel-Haswell processors). </p>\n\n<p><strong>My question:</strong> What is the reason for the performance-collapse for memory-sizes around 2 KB?</p>\n\n<p>(*) I hope I understand correctly, that for L1-cache not 64 bytes but only 4 bytes per addition are read/transfered (there is no further faster cache where a cache line must be filled), so the plotted bandwidth for L1 is only the upper limit and not the badwidth itself.</p>\n\n<p><strong>Edit</strong>: When the step size in the inner for-loop is chosen to be </p>\n\n<ul>\n<li>8 (instead of 16) the collapse happens for 1KB </li>\n<li>4 (instead of 16) the collapse happens for 0.5KB</li>\n</ul>\n\n<p>i.e. when the inner loop consists of about 31-35 steps/reads. That means the collapse isn't due to the memory-size but due to the number of steps in the inner loop.</p>\n\n<p>It can be explained with branch misses as shown in <a href=\"https://stackoverflow.com/a/53754136/5769463\">@user10605163's great answer</a>.</p>\n\n<hr>\n\n<p>Listing for reproducing the results</p>\n\n<p><code>bandwidth.cpp</code>:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;chrono&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\n\n//returns minimal time needed for one execution in seconds:\ntemplate&lt;typename Fun&gt;\ndouble timeit(Fun&amp;&amp; stmt, int repeat, int number)\n{  \n   std::vector&lt;double&gt; times;\n   for(int i=0;i&lt;repeat;i++){\n       auto begin = std::chrono::high_resolution_clock::now();\n       for(int i=0;i&lt;number;i++){\n          stmt();\n       }\n       auto end = std::chrono::high_resolution_clock::now();\n       double time = std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end-begin).count()/1e9/number;\n       times.push_back(time);\n   }\n   return *std::min_element(times.begin(), times.end());\n}\n\n\nconst int NITER=200;\nconst int NTRIES=5;\nconst size_t BLOCK_SIZE=16;\n\n\nstruct Worker{\n   std::vector&lt;unsigned int&gt; &amp;mem;\n   size_t n;\n   unsigned int result;\n   void operator()(){\n        for(size_t i=0;i&lt;n;i+=BLOCK_SIZE){           \n             result+=mem[i];\n        }\n   }\n\n   Worker(std::vector&lt;unsigned int&gt; &amp;mem_):\n       mem(mem_), n(mem.size()), result(1)\n   {}\n};\n\ndouble PREVENT_OPTIMIZATION=0.0;\n\n\ndouble get_size_in_kB(int SIZE){\n   return SIZE*sizeof(int)/(1024.0);\n}\n\ndouble get_speed_in_GB_per_sec(int SIZE){\n   std::vector&lt;unsigned int&gt; vals(SIZE, 42);\n   Worker worker(vals);\n   double time=timeit(worker, NTRIES, NITER);\n   PREVENT_OPTIMIZATION+=worker.result;\n   return get_size_in_kB(SIZE)/(1024*1024)/time;\n}\n\n\nint main(){\n\n   int size=BLOCK_SIZE*16;\n   std::cout&lt;&lt;\"size(kB),bandwidth(GB/s)\\n\";\n   while(size&lt;10e3){\n       std::cout&lt;&lt;get_size_in_kB(size)&lt;&lt;\",\"&lt;&lt;get_speed_in_GB_per_sec(size)&lt;&lt;\"\\n\";\n       size=(static_cast&lt;int&gt;(size+BLOCK_SIZE)/BLOCK_SIZE)*BLOCK_SIZE;\n   }\n\n   //ensure that nothing is optimized away:\n   std::cerr&lt;&lt;\"Sum: \"&lt;&lt;PREVENT_OPTIMIZATION&lt;&lt;\"\\n\";\n}\n</code></pre>\n\n<p><code>create_report.py</code>:</p>\n\n<pre><code>import sys\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ninput_file=sys.argv[1]\noutput_file=input_file[0:-3]+'png'\ndata=pd.read_csv(input_file)\n\nlabels=list(data)    \nplt.plot(data[labels[0]], data[labels[1]], label=\"my laptop\")\nplt.xlabel(labels[0])\nplt.ylabel(labels[1])   \nplt.savefig(output_file)\nplt.close()\n</code></pre>\n\n<p>Building/running/creating report:</p>\n\n<pre><code>&gt;&gt;&gt; g++ -O3 -std=c++11 bandwidth.cpp -o bandwidth\n&gt;&gt;&gt; ./bandwidth &gt; report.txt\n&gt;&gt;&gt; python create_report.py report.txt\n# image is in report.png\n</code></pre>\n"}, {"tags": ["c++", "arrays", "loops", "for-loop"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 5, "creation_date": 1544648666, "post_id": 53751295, "comment_id": 94355299, "body": "Your code is, most likely, suffering from integer division."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544649213, "post_id": 53751295, "comment_id": 94355527, "body": "Note this is a very different thing from Joy Division."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10782941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1a293348a73750690fdc3e5a782d16?s=128&d=identicon&r=PG&f=1", "display_name": "mab", "link": "https://stackoverflow.com/users/10782941/mab"}, "edited": false, "score": 0, "creation_date": 1544650228, "post_id": 53751395, "comment_id": 94355947, "body": "You mean entering the scores by myself? Will this stop letting user enter it?"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 1, "user_id": 10782941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1a293348a73750690fdc3e5a782d16?s=128&d=identicon&r=PG&f=1", "display_name": "mab", "link": "https://stackoverflow.com/users/10782941/mab"}, "edited": false, "score": 0, "creation_date": 1544693682, "post_id": 53751395, "comment_id": 94369604, "body": "No and no, but I don&#39;t really understand what you are asking. I&#39;m showing you how to calculate the class average, this has nothing to do with how the scores are entered, it&#39;s just a calculation."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1544649040, "creation_date": 1544649040, "answer_id": 53751395, "question_id": 53751295, "link": "https://stackoverflow.com/questions/53751295/c-students-score-average-calculator-array-problem/53751395#53751395", "title": "C++ Students score average calculator array problem", "body": "<p>You don't need an array for class average. Just add up all the students scores and divide by the number of students. That just needs one variable (I've called it <code>std_sum</code>) not an array. Like this</p>\n\n<pre><code>double std_sum = 0.0;\nfor(stdn=0; stdn&lt;num; stdn++){\n    ...\n   std = mt * 30/100 + q1 * 10/100 + q2 * 10/100 + fnl * 50/100;\n   std_sum = std_sum + std; // add up all student scores\n}\navg = std_total/num;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10782941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1a293348a73750690fdc3e5a782d16?s=128&d=identicon&r=PG&f=1", "display_name": "mab", "link": "https://stackoverflow.com/users/10782941/mab"}, "edited": false, "score": 0, "creation_date": 1544650637, "post_id": 53751552, "comment_id": 94356117, "body": "Numbers are not the issue here i guess. Program should show all of the students average, then total average of their class. I can&#39;t connect these two, that my problem."}, {"owner": {"reputation": 31, "user_id": 10782967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZCOv.png?s=128&g=1", "display_name": "gSExpln", "link": "https://stackoverflow.com/users/10782967/gsexpln"}, "reply_to_user": {"reputation": 1, "user_id": 10782941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1a293348a73750690fdc3e5a782d16?s=128&d=identicon&r=PG&f=1", "display_name": "mab", "link": "https://stackoverflow.com/users/10782941/mab"}, "edited": false, "score": 0, "creation_date": 1544651791, "post_id": 53751552, "comment_id": 94356665, "body": "Not sure to which average you are referring, if a student has marks for q1, q2, mt, fnl, should&#39;nt the program calculate the score he gets? then the average of the entire class? what other average is there?"}, {"owner": {"reputation": 1, "user_id": 10782941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1a293348a73750690fdc3e5a782d16?s=128&d=identicon&r=PG&f=1", "display_name": "mab", "link": "https://stackoverflow.com/users/10782941/mab"}, "edited": false, "score": 0, "creation_date": 1544652598, "post_id": 53751552, "comment_id": 94357046, "body": "It will calculate the average of students total score. I mean after we calculate the q1, q2, mt, fnl. Not just that. I can do that, thats not the issue."}], "tags": [], "owner": {"reputation": 31, "user_id": 10782967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZCOv.png?s=128&g=1", "display_name": "gSExpln", "link": "https://stackoverflow.com/users/10782967/gsexpln"}, "is_accepted": false, "score": 1, "last_activity_date": 1544649726, "creation_date": 1544649726, "answer_id": 53751552, "question_id": 53751295, "link": "https://stackoverflow.com/questions/53751295/c-students-score-average-calculator-array-problem/53751552#53751552", "title": "C++ Students score average calculator array problem", "body": "<p>Type int is always rounding down the value after a decimal point.\nSo, (int)3.84 == 3, and therefore your std variable will probably have a wrong value.\nDefine all variables as double for start. To calculate avg simply add marks then devide by the number of students in the end.</p>\n\n<pre><code>double mt, q1, q2, fnl, stdn, num, grades_sum = 0, avg;\n...\nfor(stdn=0; stdn&lt;num; stdn++){\n    ...\n    grades_sum += mt * 30/100 + q1 * 10/100 + q2 * 10/100 + fnl * 50/100;\n    ...\n}\navg = grades_sum/num;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1832, "user_id": 8947748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d73b489c80b662f62baccd4f8c4da4?s=128&d=identicon&r=PG&f=1", "display_name": "rhavelka", "link": "https://stackoverflow.com/users/8947748/rhavelka"}, "is_accepted": false, "score": 0, "last_activity_date": 1544655447, "last_edit_date": 1544655447, "creation_date": 1544655055, "answer_id": 53752608, "question_id": 53751295, "link": "https://stackoverflow.com/questions/53751295/c-students-score-average-calculator-array-problem/53752608#53752608", "title": "C++ Students score average calculator array problem", "body": "<p>You can add up all of the students scores, then at the end divide by the total number of students. This will give you a total average of the class. Also, I avoided integer division by replacing your fractions with decimals that add up to 1. I also edited your for loop to start at 1 and go to the number, to avoid adding 1 to everything.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    int mt, q1, q2, fnl, stdn, num;\n    double cls[5], std;\n    double classAvg = 0; // add a new variable\n\n    cout &lt;&lt; \"Enter a number of students: \";\n    cin &gt;&gt; num;\n\n    for (stdn=1; stdn &lt;= num; stdn++) {\n       cout &lt;&lt; \"Enter mt, q1, q2, fnl of a \" &lt;&lt; stdn &lt;&lt; \". student in order:\" &lt;&lt; endl;\n       cin &gt;&gt; mt &gt;&gt; q1 &gt;&gt; q2 &gt;&gt; fnl;\n       std = (mt * 0.3) + (q1 * 0.1) + (q2 * 0.1) + (fnl * 0.5);\n       cout &lt;&lt; stdn &lt;&lt; \". students total score is \" &lt;&lt; std &lt;&lt; endl;\n\n       classAvg = classAvg + std; // start adding the totals of all the students\n    }\n    avg = classAvg/num; // find the total average by dividing by total students\n    cout &lt;&lt; \"Class Average is \" &lt;&lt; classAvg &lt;&lt; endl; // display average.\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10782941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1a293348a73750690fdc3e5a782d16?s=128&d=identicon&r=PG&f=1", "display_name": "mab", "link": "https://stackoverflow.com/users/10782941/mab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1544670638, "creation_date": 1544648571, "last_edit_date": 1544670638, "question_id": 53751295, "link": "https://stackoverflow.com/questions/53751295/c-students-score-average-calculator-array-problem", "title": "C++ Students score average calculator array problem", "body": "<p>I am trying to write a program that calculates students last scores as a midterm, quiz1, quiz2 and final then finds their class average depends on a number of students. Program will show the class average. User should enter the scores. I am new to c++, and my problem is right now i can't find a way to connect this for loop to an array for class average. Is my code wrong for this? I don't know what to do.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    int mt, q1, q2, fnl, stdn, num;\n    double cls[5], std, avg;\n\n    cout &lt;&lt; \"Enter a number of students: \";\n    cin &gt;&gt; num;\n\n    for (stdn=0; stdn&lt;num; stdn++) {\n        cout&lt;&lt;\"Enter mt, q1, q2, fnl of a \"&lt;&lt;stdn+1&lt;&lt;\". student in order:\"&lt;&lt;endl;\n        cin&gt;&gt;mt&gt;&gt;q1&gt;&gt;q2&gt;&gt;fnl;\n\n        std = mt * 30/100 + q1 * 10/100 + q2 * 10/100 + fnl * 50/100;\n\n        cout&lt;&lt;stdn+1&lt;&lt;\". students total score is \"&lt;&lt;std&lt;&lt;endl;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "exception", "arm", "bootloader"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1544649658, "post_id": 53751272, "comment_id": 94355697, "body": "<code>there is a frame in the stack and the unwinding &quot;just&quot; need to call the destructor on each object of it, and finally jump to the given catch.</code> - no, there&#39;s (potentially) a hierarchy of active exception frames (try blocks) on stack, arranged as a linked list. The actual exception may well occur further down the hierarchy, outside an explicit frame. The unwinder must inspect each active frame, which may contain a finally block, a catch block, or both. Finally block must be executed, catch blocks must too, if they match the exception. This is just scratching the surface. Use a library."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 1, "creation_date": 1544679949, "post_id": 53751272, "comment_id": 94363755, "body": "Most high-quality exception-handling implementations rely on tables that indicate which destructors and <code>catch</code> blocks apply to any given program counter value, so as to avoid burdening the non-exceptional path with recording them on every execution."}, {"owner": {"reputation": 11267, "user_id": 903651, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3dda4f66a2b7cc9fdced12a0fbede58?s=128&d=identicon&r=PG", "display_name": "Adrian Maire", "link": "https://stackoverflow.com/users/903651/adrian-maire"}, "edited": false, "score": 0, "creation_date": 1544683908, "post_id": 53751272, "comment_id": 94365086, "body": "Thank you for you comments. Is there any further explanation on this? (Before to jump to those 100+ pages spec.)."}], "owner": {"reputation": 11267, "user_id": 903651, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3dda4f66a2b7cc9fdced12a0fbede58?s=128&d=identicon&r=PG", "display_name": "Adrian Maire", "link": "https://stackoverflow.com/users/903651/adrian-maire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544648454, "creation_date": 1544648454, "question_id": 53751272, "link": "https://stackoverflow.com/questions/53751272/enabling-c-exceptions-on-arm-bare-metal-bootloader", "title": "Enabling C++ exceptions on ARM bare-metal bootloader", "body": "<p>For learning purpose, I am trying to get full C++ support on an ARM MCU (STM32F407ZE). I am struggling at getting exceptions working, consequently carrying this question:</p>\n\n<p><strong>How to get C++ exceptions on a bare-metal ARM bootloader?</strong></p>\n\n<p>To extend a bit the question:<br>\nI understand that an exception, like exiting a function require unwinding the stack. The fact that exiting a function works out of the box, but the exception handling does not, make me to think that the compiler is adding the unwinding of functions-exit but can not do it for exceptions.</p>\n\n<p>So the sub-question 1 is: Is this premise correct? Do I really need to implement/integrate an unwinding library for exception handling?</p>\n\n<p>In my superficial understanding of unwinding, there is a frame in the stack and the unwinding \"just\" need to call the destructor on each object of it, and finally jump to the given <code>catch</code>.</p>\n\n<p>Sub-question 2 is: How does the unwinding library perform this task? What is the strategy used? (to the extends appropriate for a SO answer)</p>\n\n<p>In my searches, I found many explanations of WHAT is the unwinding, but very few of how to get it working. The closest is:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12151397/gcc-arm-none-eabi-codesourcery-and-c-exceptions\">GCC arm-none-eabi (Codesourcery) and C++ Exceptions</a></p>\n\n<hr>\n\n<h2>The project</h2>\n\n<p>1) The first step and yet with some difficulties, was to get the MCU powered and communicating through JTAG. </p>\n\n<blockquote>\n  <p>This is just contextual information, please do not tag the question off-topic just because of this picture. Jump to step 2 instead.</p>\n</blockquote>\n\n<p>I know there are testing boards available, but this is a learning project to get a better understanding on all the \"magic\" behind the scene. So I got a chip socket, a bread-board and setup the minimal power-up circuitry:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uap5I.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uap5I.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Note: JTAG is performed through the GPIO of a raspberry-pi.<br>\nNote2: I am using OpenOCD to communicate with the chip.</p>\n\n<p>2) Second step, was to make a minimal software to blink the yellow led.<br>\nUsing arm-none-eabi-g++ as a compiler and linker, the c++ code was straightforward, but my understanding of the linker script is still somewhat blurry.</p>\n\n<p>3) Enable exceptions handling (not yet working).</p>\n\n<p>For this goal, following informations where useful:</p>\n\n<ul>\n<li><a href=\"https://wiki.osdev.org/C++_Exception_Support\" rel=\"nofollow noreferrer\">https://wiki.osdev.org/C++_Exception_Support</a></li>\n<li><a href=\"https://itanium-cxx-abi.github.io/cxx-abi/exceptions.pdf\" rel=\"nofollow noreferrer\">https://itanium-cxx-abi.github.io/cxx-abi/exceptions.pdf</a></li>\n<li><a href=\"https://itanium-cxx-abi.github.io/cxx-abi/abi-eh.html\" rel=\"nofollow noreferrer\">https://itanium-cxx-abi.github.io/cxx-abi/abi-eh.html</a></li>\n</ul>\n\n<p>However, it seems quite too much complexity for a simple exception handling, and before to start implementing/integrating an unwinding library, I would like to be sure I am going in the correct direction.<br>\nI would like to avoid earing in 2 weeks: \"Ohh, by the way, you just need to add this \"-xx\" option to the compiler and it works\"</p>\n\n<p>main.cpp  </p>\n\n<pre><code>auto reset_handler() noexcept -&gt;void;\nauto main() -&gt; int;\n\nint global_variable_test=50;\n\nextern \"C\"\n{\n\n        #include \"stm32f4xx.h\"\n        #include \"stm32f4xx_rcc.h\"\n        #include \"stm32f4xx_gpio.h\"\n\n\n\n        void assert_failed(uint8_t* file, uint32_t line){}\n        void hardFaultHandler( unsigned int * hardFaultArgs);\n\n        // vector table\n        #define SRAM_SIZE 128*1024\n        #define SRAM_END        (SRAM_BASE + SRAM_SIZE)\n        unsigned long *vector_table[] __attribute__((section(\".vector_table\"))) =\n        {\n                (unsigned long *)SRAM_END,   // initial stack pointer \n                (unsigned long *)reset_handler,        // main as Reset_Handler\n        };\n}\n\n\nauto reset_handler() noexcept -&gt; void\n{\n        // Setup execution\n\n        // Call the main function\n        int ret = main();\n\n        // never finish\n        while(true);\n}\n\n\nclass A\n{\npublic:\n        int b;\n\n        auto cppFunc()-&gt; void\n        {\n                throw (int)4;\n        }\n};\n\nauto main() -&gt; int\n{\n        // Initializing led GPIO\n        RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOG, ENABLE);\n        GPIO_InitTypeDef GPIO_InitDef;\n\n        GPIO_InitDef.GPIO_Pin = GPIO_Pin_13 | GPIO_Pin_14;\n        GPIO_InitDef.GPIO_OType = GPIO_OType_PP;\n        GPIO_InitDef.GPIO_Mode = GPIO_Mode_OUT;\n        GPIO_InitDef.GPIO_PuPd = GPIO_PuPd_NOPULL;\n        GPIO_InitDef.GPIO_Speed = GPIO_Speed_100MHz;\n        GPIO_Init(GPIOG, &amp;GPIO_InitDef);\n\n        // Testing normal blinking\n        int loopNum = 500000;\n        for (int i=0; i&lt;5; ++i)\n        {\n                loopNum = 100000;\n                GPIO_SetBits(GPIOG, GPIO_Pin_13 | GPIO_Pin_14);\n                for (int i = 0; i &lt; loopNum; i++) continue; //active waiting!\n\n                loopNum = 800000;\n                GPIO_ResetBits(GPIOG, GPIO_Pin_13 | GPIO_Pin_14);\n                for (int i=0; i&lt;loopNum; i++) continue; //active waiting!\n        }\n\n        // Try exceptions handling\n        try\n        {\n                A a;\n                a.cppFunc();\n        }\n        catch(...){}\n\n\n        return 0;\n}\n</code></pre>\n\n<p>Makefile</p>\n\n<pre><code>CPP_C = arm-none-eabi-g++\nC_C = arm-none-eabi-g++\nLD = arm-none-eabi-g++\nCOPY = arm-none-eabi-objcopy\n\nLKR_SCRIPT = -Tstm32_minimal.ld\n\nINCLUDE = -I. -I./stm32f4xx/CMSIS/Device/ST/STM32F4xx/Include -I./stm32f4xx/CMSIS/Include -I./stm32f4xx/STM32F4xx_StdPeriph_Driver/inc -I./stm32f4xx/Utilities/STM32_EVAL/STM3240_41_G_EVAL -I./stm32f4xx/Utilities/STM32_EVAL/Common\nC_FLAGS  = -c -fexceptions -fno-common -O0 -g -mcpu=cortex-m4 -mthumb -DSTM32F40XX -DUSE_FULL_ASSERT -DUSE_STDPERIPH_DRIVER $(INCLUDE)\nCPP_FLAGS  = -std=c++11 -c $(C_FLAGS)\nLFLAGS  = -specs=nosys.specs -nostartfiles -nostdlib $(LKR_SCRIPT)\nCPFLAGS = -Obinary\n\nall: main.bin\n\nmain.o: main.cpp\n        $(CPP_C) $(CPP_FLAGS) -o main.o main.cpp\n\nstm32f4xx_gpio.o: stm32f4xx_gpio.c\n        $(C_C) $(C_FLAGS) -o stm32f4xx_gpio.o stm32f4xx_gpio.c\n\nstm32f4xx_rcc.o: stm32f4xx_rcc.c\n        $(C_C) $(C_FLAGS) -o stm32f4xx_rcc.o stm32f4xx_rcc.c\n\nmain.elf: main.o stm32f4xx_gpio.o stm32f4xx_rcc.o\n        $(LD) $(LFLAGS) -o main.elf main.o stm32f4xx_gpio.o stm32f4xx_rcc.o\n\nmain.bin: main.elf\n        $(COPY) $(CPFLAGS) main.elf main.bin\n\nclean:\n        rm -rf *.o *.elf *.bin\n\nwrite:\n        ./write_bin.sh main.elf\n</code></pre>\n\n<p>Linker script: stm32_minimal.ld</p>\n\n<pre><code>/* memory layout for an STM32F407 */\nMEMORY\n{\n    FLASH (rx)  : ORIGIN = 0x08000000, LENGTH = 512K\n    SRAM (rwx)  : ORIGIN = 0x20000000, LENGTH = 128K\n}\n\n/* output sections */\nSECTIONS\n{\n    /* program code into FLASH */\n    .text :\n    {\n        *(.vector_table)    /* Vector table */\n        *(.text)            /* Program code */\n        *(.data)\n        /**(.eh_frame)*/\n    } &gt;FLASH\n\n    .ARM.exidx :            /* Required for unwinding the stack? */\n    {\n        __exidx_start = .;\n        * (.ARM.exidx* .gnu.linkonce.armexidx.*)\n        __exidx_end   = .;\n    } &gt; FLASH\n\n    PROVIDE ( end = . );\n\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "design-patterns", "visitor-pattern"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544649629, "post_id": 53751202, "comment_id": 94355685, "body": "if it seems like not the right approach then maybe it is not the right approach. Why do you use the visitor pattern in the first place? What do you actually want to achieve? No offense, but I cannot make any sense of <code>Red</code> and <code>Blue</code> being subclasses of <code>Color</code> or them having methods <code>sky</code> and <code>eye</code>..."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544650030, "post_id": 53751202, "comment_id": 94355860, "body": "I would like to define new operations for these classes without changing the classes. Thus using the visitor pattern made sense to me."}, {"owner": {"reputation": 332, "user_id": 8137872, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10213146126271038/picture?type=large", "display_name": "Joseph Franciscus", "link": "https://stackoverflow.com/users/8137872/joseph-franciscus"}, "edited": false, "score": 0, "creation_date": 1544650478, "post_id": 53751202, "comment_id": 94356063, "body": "Just a note <code>template</code> methods cannot be virtual."}], "answers": [{"comments": [{"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1544651621, "post_id": 53751782, "comment_id": 94356601, "body": "I am wondering now, if it were also possible to refractor all the visit override methods as their only purpose is to call the template visit method. But I guess, then would have to use another pattern. The virtual void visit really seems like a curse and blessing here."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1544650805, "creation_date": 1544650805, "answer_id": 53751782, "question_id": 53751202, "link": "https://stackoverflow.com/questions/53751202/mix-template-and-non-template-visitor-methods/53751782#53751782", "title": "Mix template and non-template visitor methods", "body": "<p>Unfortunately, virtual methods and template methods can't match.</p>\n\n<p>I mean... if your base class <code>Visitor</code> require</p>\n\n<pre><code>virtual void visit(Red*) = 0;\nvirtual void visit(Blu*) = 0;\n</code></pre>\n\n<p>the implementation of two virtual methods in derived classes, you can't solve this obligation with a single template method</p>\n\n<pre><code>template&lt;class C&gt;\nvoid visit(C* c)\n{\n    ++num_of_colours;\n}\n</code></pre>\n\n<p>You have to write two methods, absolutely not template, with the exact signature. Maybe adding also <code>override</code>, to reduce the risk of mistakes.</p>\n\n<pre><code>  void visit (Red * r) override\n   { ++num_of_colours; }\n\n  void visit (Blu * b) override\n   { ++num_of_colours; }\n</code></pre>\n\n<p>Obviously you can define a template method (maybe with another name, but also <code>visit()</code> if you want) that is called by both virtual overrided methods</p>\n\n<pre><code>  template &lt;typename C&gt;\n  void visit (C * c)\n   { ++num_of_colours; }\n\n  void visit (Red * r) override\n   { visit&lt;Red&gt;(r); }\n\n  void visit (Blu * b) override\n   { visit&lt;Blu&gt;(b); }\n</code></pre>\n\n<p>This way, you can implement the logic of the visitor in a single template method and call it by all virtual methods</p>\n"}, {"tags": [], "owner": {"reputation": 332, "user_id": 8137872, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10213146126271038/picture?type=large", "display_name": "Joseph Franciscus", "link": "https://stackoverflow.com/users/8137872/joseph-franciscus"}, "is_accepted": false, "score": 0, "last_activity_date": 1544651020, "creation_date": 1544651020, "answer_id": 53751830, "question_id": 53751202, "link": "https://stackoverflow.com/questions/53751202/mix-template-and-non-template-visitor-methods/53751830#53751830", "title": "Mix template and non-template visitor methods", "body": "<p>Why not just use a map and add some function to color to use as an identifier? </p>\n\n<pre><code>class Color\n{    \npublic:\n    virtual void accept(class Visitor*) = 0;\n    virtual std::string color_name() = 0; \n\n};\n\nclass Visitor\n{\npublic:\n    virtual void visit(Color* c);\n};\n\nclass CountVisitor: public Visitor\n{\n    std::unordered_map&lt;std::string, int&gt; map; \n\npublic:\n    /*virtual*/\n    void visit(Color* c)\n    {\n        map[c.color_name()]++;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544651020, "creation_date": 1544648122, "last_edit_date": 1544649115, "question_id": 53751202, "link": "https://stackoverflow.com/questions/53751202/mix-template-and-non-template-visitor-methods", "title": "Mix template and non-template visitor methods", "body": "<p>Currently I am learning about the Visitor Pattern and try out various ideas. \nBelow I have the code of my current setup, which I would like to get functioning somehow.</p>\n\n<p>I would like to have two visitors, one that counts instances of <code>Red</code> and <code>Blu</code> separately and one that counts anything (one can assume, it's a <code>Color</code>)</p>\n\n<p>This is of course solvable by simply implementing the second visitor analogously to the first one, however not using separate variables for counting, but just one. \nI think however this is unnecessary - if I had for example many, many different colours, the code would be very repetitive: All functions in that visitor would be same, they would simply increment one variable. Surely, there is an easier way, but how?\nAccording to the standard Visitor Pattern I have to implement for every color class a visit functions, thus this does not seem to be the right approach. </p>\n\n<p>How would someone solve this problem?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Color\n{\npublic:\n    virtual void accept(class Visitor*) = 0;\n};\n\nclass Red: public Color\n{\npublic:\n    /*virtual*/\n    void accept(Visitor*);\n    void eye()\n    {\n        std::cout &lt;&lt; \"Red::eye\\n\";\n    }\n};\nclass Blu: public Color\n{\npublic:\n    /*virtual*/\n    void accept(Visitor*);\n    void sky()\n    {\n        std::cout &lt;&lt; \"Blu::sky\\n\";\n    }\n};\n\nclass Visitor\n{\npublic:\n    virtual void visit(Red*) = 0;\n    virtual void visit(Blu*) = 0;\n};\n\nclass CountVisitor: public Visitor\n{\npublic:\n    CountVisitor()\n    {\n        m_num_red = m_num_blu = 0;\n    }\n    /*virtual*/\n    void visit(Red*)\n    {\n        ++m_num_red;\n    }\n    /*virtual*/void visit(Blu*)\n    {\n        ++m_num_blu;\n    }\n    void report_num()\n    {\n        std::cout &lt;&lt; \"Reds \" &lt;&lt; m_num_red &lt;&lt; \", Blus \" &lt;&lt; m_num_blu &lt;&lt; '\\n';\n    }\nprivate:\n    int m_num_red, m_num_blu;\n};\n\nclass TemplateVisitor: public Visitor\n{\npublic:\n    TemplateVisitor() : num_of_colours(0) {}\n\n    /*virtual*/\n    template&lt;class C&gt;\n    void visit(C* c)\n    {\n        ++num_of_colours;\n    }\n    void report_num()\n    {\n        std::cout &lt;&lt; \"Colours \" &lt;&lt; num_of_colours &lt;&lt; '\\n';\n    }\n\nprivate:\n    int num_of_colours;\n\n};\n\n\nvoid Red::accept(Visitor *v)\n{\n    v-&gt;visit(this);\n}\n\nvoid Blu::accept(Visitor *v)\n{\n    v-&gt;visit(this);\n}\n\nint main()\n{\n    Color *set[] =\n    {\n        new Red, new Blu, new Blu, new Red, new Red, nullptr\n    };\n    CountVisitor count_operation;\n    TemplateVisitor template_visitor;\n    for (int i = 0; set[i]; i++)\n    {\n        set[i]-&gt;accept(&amp;count_operation);\n        set[i]-&gt;accept(&amp;template_visitor);\n    }\n    count_operation.report_num();\n    template_visitor.report_num();\n}\n</code></pre>\n"}, {"tags": ["c++", "string", "compilation"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1544647610, "post_id": 53751046, "comment_id": 94354869, "body": "This is English speaking site, your error messages are unreadable, can you switch your IDE temporarily to produce errors in English?"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 1, "creation_date": 1544647627, "post_id": 53751046, "comment_id": 94354877, "body": "You should get int he habit of avoiding <code>using namespace std;</code>. It can lead to problems later on."}, {"owner": {"reputation": 973, "user_id": 10721563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGUHp.png?s=128&g=1", "display_name": "Ozan Yurtsever", "link": "https://stackoverflow.com/users/10721563/ozan-yurtsever"}, "edited": false, "score": 0, "creation_date": 1544647717, "post_id": 53751046, "comment_id": 94354927, "body": "Your error messages are not readable. Please make it English."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1544647724, "post_id": 53751046, "comment_id": 94354931, "body": "And please explain what &quot;does not work&quot; mean"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 1, "creation_date": 1544647804, "post_id": 53751046, "comment_id": 94354966, "body": "Did you use Ctrl+C to end the program? <a href=\"https://stackoverflow.com/questions/45691954/native-exiting-with-with-code-1073741510-0xc000013a-while-using-prime-checke\">This</a> indicates that is what the exit code means."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544647845, "post_id": 53751046, "comment_id": 94354981, "body": "I don&#39;t see any issues that a few <code>std::endl;</code>s won&#39;t fix: <a href=\"https://ideone.com/advng3\" rel=\"nofollow noreferrer\">ideone.com/advng3</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544647906, "post_id": 53751046, "comment_id": 94355009, "body": "When I googled for <code>0xc000013a</code> it said you pressed ctrl-c or forcibly closed the command window."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1544649471, "post_id": 53751046, "comment_id": 94355632, "body": "The errors aren&#39;t in the code (although it&#39;s a bit of a mess). The error must be in the way you are using your compiler. Hard to help with that, but you&#39;re doing something fundamentally wrong."}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1544649592, "post_id": 53751046, "comment_id": 94355673, "body": "The first messages are not relevant - it&#39;s just VS complaining about missing symbols. The rest means that the program exited with <code>0xc000013a</code>. As @drescherjm pointed out, the command window was probably closed and OP mistook that output for errors. He probably did not input the 3 lines his program expects."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544651510, "post_id": 53751046, "comment_id": 94356551, "body": "I say all of the current answers are wrong. <b><i>Das Programm &quot;[2132] ConsoleApplication3.exe&quot; wurde mit Code -1073741510 (0xc000013a) beendet.</i></b> says that the program compiled and ran. It also says the user either closed the window or pressed ctrl+c."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1544648724, "post_id": 53751305, "comment_id": 94355318, "body": "this should be a comment"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544648911, "post_id": 53751305, "comment_id": 94355397, "body": "<code>#include &quot;pch.h&quot;</code> means the user is likely using Visual Studio with precompiled headers enabled. If you have this default setting enabled and don&#39;t include <code>pch.h</code> at the top of every source file you get an error message."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544649072, "post_id": 53751305, "comment_id": 94355467, "body": "<b><i>I can&#39;t decipher your errors</i></b> There really was only 1 message that was important. <b>Das Programm &quot;[2132] ConsoleApplication3.exe&quot; wurde mit Code -1073741510 (0xc000013a) beendet</b> The rest was normal for any program."}], "tags": [], "owner": {"reputation": 11, "user_id": 10498977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5618b8aa1cf4a95e75263f6d840e27?s=128&d=identicon&r=PG&f=1", "display_name": "Radu Z.", "link": "https://stackoverflow.com/users/10498977/radu-z"}, "is_accepted": false, "score": -1, "last_activity_date": 1544648618, "creation_date": 1544648618, "answer_id": 53751305, "question_id": 53751046, "link": "https://stackoverflow.com/questions/53751046/reading-strings-in-c-compiling-in-c/53751305#53751305", "title": "reading strings in c++, compiling in c++", "body": "<p>First, I deleted the first line of your code, which is </p>\n\n<pre><code>#include \"pch.h\"\n</code></pre>\n\n<p>, as I didn't have that file and it compiled. Maybe you don't have that file either. Then, I put a space before \"are blue\", so the plural noun and the \"are blue\" aren't connected.</p>\n\n<pre><code>cout &lt;&lt; pluralNoun &lt;&lt; \" are blue\" &lt;&lt; endl;\n</code></pre>\n\n<p>And it all worked perfectly.\nMaybe your problem is the compiler you use? I can't decipher your errors but my opinion is that you should check the pch.h file and the compiler.</p>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544649876, "post_id": 53751561, "comment_id": 94355782, "body": "This is because you have precompiled headers enabled in your project. For small projects that don&#39;t have many external includes its best to turn that off. With that said this could not have been related to any issue you had because your program wouldn&#39;t have built if you did not have the <code>pch.h</code> file. You could not execute it at all. Unless you pressed debug anyways (and somehow had an old exe in the same folder of the same name) on the failure to compile I don&#39;t see how this could have been the problem."}], "tags": [], "owner": {"reputation": 49, "user_id": 10782914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gk9ek.jpg?s=128&g=1", "display_name": "one friendly programmer", "link": "https://stackoverflow.com/users/10782914/one-friendly-programmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1544649754, "creation_date": 1544649754, "answer_id": 53751561, "question_id": 53751046, "link": "https://stackoverflow.com/questions/53751046/reading-strings-in-c-compiling-in-c/53751561#53751561", "title": "reading strings in c++, compiling in c++", "body": "<p>Thank you @\"Radu Z\". You were almost rigth: the problem was, that the header had to be used, i do not know why, but it had to be empty, and I also do not know where this makes sense, but it worked for me to delete the lines concerning the namespace, leaving me with:</p>\n\n<pre><code>#ifndef PCH_H\n#define PCH_H\n\n\n// TODO: add headers\n\n#endif //PCH_H\n</code></pre>\n\n<p>I am very grateful that you all answered that quickly, and I promise to change my Language to english for the next questions. Concerning the namespace, I removed it since I had to use the stds anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544651175, "post_id": 53751792, "comment_id": 94356385, "body": "I believe newer versions of Visual Studio by default look for  <code>pch.h</code> instead of <code>stdafx.h</code>"}, {"owner": {"reputation": 2743, "user_id": 1592639, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/61c0I.png?s=128&g=1", "display_name": "Michael Haephrati", "link": "https://stackoverflow.com/users/1592639/michael-haephrati"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544651354, "post_id": 53751792, "comment_id": 94356475, "body": "Good to know. I am using VS2017 and haven&#39;t noticed, but I may be mistaken. In any case, the solution to the problem is in the Precompiled Header section of the Project&#39;s properties."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1555674490, "post_id": 53751792, "comment_id": 98197316, "body": "There is no requirement to use precompiled headers, as this answer implies. The issue cannot possibly be caused by an issue with precompiled headers either. Those issues result in compile errors. Clearly, the OP was able to compile the application, since they managed to run it."}, {"owner": {"reputation": 2743, "user_id": 1592639, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/61c0I.png?s=128&g=1", "display_name": "Michael Haephrati", "link": "https://stackoverflow.com/users/1592639/michael-haephrati"}, "edited": false, "score": 0, "creation_date": 1555722038, "post_id": 53751792, "comment_id": 98212488, "body": "This is best practice to always use precompiled headers, however step 2 can be changed so the compiler doesn&#39;t use precompiled headers."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1555766975, "post_id": 53751792, "comment_id": 98220454, "body": "Unconditionally using precompiled headers is certainly not <i>&quot;best practice&quot;</i>. There are reasons to use precompiled headers, and there are reasons to <i>not</i> use precompiled headers. You have to make a judicious decision. Irrespective, the OP&#39;s code compiles, so trying to fix a compiler error that does not exist doesn&#39;t help the OP solve <i>their</i> problem."}, {"owner": {"reputation": 2743, "user_id": 1592639, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/61c0I.png?s=128&g=1", "display_name": "Michael Haephrati", "link": "https://stackoverflow.com/users/1592639/michael-haephrati"}, "edited": false, "score": 0, "creation_date": 1555792720, "post_id": 53751792, "comment_id": 98227157, "body": "I completely disagree but thank you for your comment!"}], "tags": [], "owner": {"reputation": 2743, "user_id": 1592639, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/61c0I.png?s=128&g=1", "display_name": "Michael Haephrati", "link": "https://stackoverflow.com/users/1592639/michael-haephrati"}, "is_accepted": false, "score": -1, "last_activity_date": 1544651463, "last_edit_date": 1544651463, "creation_date": 1544650838, "answer_id": 53751792, "question_id": 53751046, "link": "https://stackoverflow.com/questions/53751046/reading-strings-in-c-compiling-in-c/53751792#53751792", "title": "reading strings in c++, compiling in c++", "body": "<p>From your question I assume you are using <strong>Visual Studio</strong>. \nYou should always have the first include line</p>\n\n<pre><code>#include \"stdafx.h\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>#include \"pch.h\" \n</code></pre>\n\n<p>as introduced recently. <a href=\"https://stackoverflow.com/questions/51928685/can-i-use-include-pch-h-instead-of-include-stdafx-h-as-my-precompile-heade\">See also</a>.</p>\n\n<p>Then go to \n<strong>Project -> Properties</strong> \nand then to \n<strong>C/C++ -> Precompiled Headers</strong></p>\n\n<p>In the first setting: <strong>Precompiled Header</strong> select <strong>Create (/Yc)</strong></p>\n\n<p>In the second setting: <strong>Precompiled Header File</strong> select <strong>stdafx.h</strong></p>\n\n<p>In the third setting: <strong>Precompiled Header Output File</strong> select <strong>$(IntDir)$(TargetName).pch</strong></p>\n\n<p>This is in fact where you define your .pch file.</p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 9695972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad066b9f9de1c63dd14a80d319c112b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9695972/ben"}, "is_accepted": false, "score": 1, "last_activity_date": 1544690017, "last_edit_date": 1592644375, "creation_date": 1544690017, "answer_id": 53757833, "question_id": 53751046, "link": "https://stackoverflow.com/questions/53751046/reading-strings-in-c-compiling-in-c/53757833#53757833", "title": "reading strings in c++, compiling in c++", "body": "<p>If you just started learning c++ and using Visual Studio i would recommend that you create your project in this manner :\n<a href=\"https://i.stack.imgur.com/h6HHI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h6HHI.png\" alt=\"Chosse Empty Project\" /></a></p>\n<p>As the option says it'll create an empty project where you'll have to manually add header and cpp files in those:</p>\n<p><a href=\"https://i.stack.imgur.com/dXWE2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dXWE2.png\" alt=\"Just right click on the folder and select Add -&gt; Add New Item\" /></a></p>\n<p>Header file should go to the Header Folder and cpp file to the Source folder.</p>\n<p>The problem you encountered was because when you created your new project you selected &quot;Windows Console Application&quot;, by default Visual Studio will create the project including the pre-compiled header named &quot;pch.h&quot;.</p>\n<p>This header is useful in a bit larger projects, basically you should include in &quot;pch.h&quot; headers you will use very often in multiple files like:</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n</code></pre>\n<p>etc...\nAnd then you should include &quot;pch.h&quot; in cpp file at the very top.</p>\n<p>Warning tho, this is not even the basics of the topic, but if you're only starting and trying things out i think it's going to be easier to deal with an empty project, but for later do some research on pre-compiled headers, they're very useful.</p>\n<p>Also as other mentioned, try to avoid</p>\n<pre><code>using namespace std;\n</code></pre>\n<p>as much as possible</p>\n<p>Hope this will help you for later.</p>\n"}], "owner": {"reputation": 49, "user_id": 10782914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gk9ek.jpg?s=128&g=1", "display_name": "one friendly programmer", "link": "https://stackoverflow.com/users/10782914/one-friendly-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1544690017, "creation_date": 1544647398, "question_id": 53751046, "link": "https://stackoverflow.com/questions/53751046/reading-strings-in-c-compiling-in-c", "title": "reading strings in c++, compiling in c++", "body": "<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;sstream&gt;\n#include &lt;istream&gt;\nusing namespace std;\nint main()\n{\n    std::string color, pluralNoun, celebrity;\n\n    std::cout &lt;&lt; \"enter a color: \";\n    std::getline(cin, color);  \n    std::cout &lt;&lt; \"enter a plural noun: \";\n    std::getline(cin, pluralNoun);\n    std::cout &lt;&lt; \"enter a celebrity: \";\n    std::getline(cin, celebrity);\n\n    cout &lt;&lt; \"Roses are \" &lt;&lt; color &lt;&lt; endl;\n    cout &lt;&lt; pluralNoun &lt;&lt; \"are blue\" &lt;&lt; endl;\n    cout &lt;&lt; \"I love \" &lt;&lt;celebrity &lt;&lt;endl;\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Hallo developers..</p>\n\n<p>To keep it short: I come from Java ..</p>\n\n<p>is that enough? I already had enormous problems with reading the strings, and had to search about 50 pages for needed libraries. In addition, I have included in a statement the namespace std, and yet I get an error message when I remove std before the cout s.</p>\n\n<pre><code>\"ConsoleApplication3.exe\" (Win32): \"D:\\Users\\nils\\source\\repos\\ConsoleApplication3\\Debug\\ConsoleApplication3.exe\" geladen. Symbole wurden geladen.\n\"ConsoleApplication3.exe\" (Win32): \"C:\\Windows\\SysWOW64\\ntdll.dll\" geladen. Symbole wurden geladen.\n\"ConsoleApplication3.exe\" (Win32): \"C:\\Windows\\SysWOW64\\kernel32.dll\" geladen. Symbole wurden geladen.\n\"ConsoleApplication3.exe\" (Win32): \"C:\\Windows\\SysWOW64\\KernelBase.dll\" geladen. Symbole wurden geladen.\n\"ConsoleApplication3.exe\" (Win32): \"C:\\Windows\\SysWOW64\\msvcp140d.dll\" geladen. Symbole wurden geladen.\n\"ConsoleApplication3.exe\" (Win32): \"C:\\Windows\\SysWOW64\\vcruntime140d.dll\" geladen. Symbole wurden geladen.\n\"ConsoleApplication3.exe\" (Win32): \"C:\\Windows\\SysWOW64\\ucrtbased.dll\" geladen. Symbole wurden geladen.\nDer Thread 0x4d6c hat mit Code -1073741510 (0xc000013a) geendet.\nDer Thread 0x4dc8 hat mit Code -1073741510 (0xc000013a) geendet.\nDer Thread 0x486c hat mit Code -1073741510 (0xc000013a) geendet.\nDas Programm \"[2132] ConsoleApplication3.exe\" wurde mit Code -1073741510 (0xc000013a) beendet.\n</code></pre>\n\n<p>Can anyone explain why this does not work, and if there are other ways to read the strings? As far as I can read consoles all required files were loaded (for the pdb file I used the visual studio server, dll I saved locally. (sry for the debugger, i am german, \"geendet\" means that it finished, not that there are any problems)</p>\n\n<ul>\n<li>Nils Drees -</li>\n</ul>\n"}, {"tags": ["c++", "qt", "macos-mojave", "qvector"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1544651159, "post_id": 53750896, "comment_id": 94356371, "body": "please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1544654485, "post_id": 53750896, "comment_id": 94357798, "body": "Your start(x,y,z) will loop forever because of z is not changed in each call. The program stack will be overflowed and crashed. You should rework your recursive function. What is the problem you are trying to solve ?"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 10198944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d9fd0ebcd20fc67e714822fe77f734?s=128&d=identicon&r=PG&f=1", "display_name": "I. Plumb", "link": "https://stackoverflow.com/users/10198944/i-plumb"}, "is_accepted": false, "score": 0, "last_activity_date": 1544712071, "last_edit_date": 1544712071, "creation_date": 1544659671, "answer_id": 53753250, "question_id": 53750896, "link": "https://stackoverflow.com/questions/53750896/qvector-crash-random-in-recursive-function/53753250#53753250", "title": "Qvector crash random in recursive function", "body": "<p>I recommend you use append for add elements in a QVector, it's equal to pus_back,  because QVector typically allocate more memory than necessary. </p>\n\n<pre><code>void add(bool in){\n    global_var.append(in) //Qvector&lt;bool&gt;, global varible\n    return;\n}\n</code></pre>\n\n<p>And your start method, will loop ever. How to call start method? the value of z it's not changed in each call and if z=0, then for condition not working.</p>\n\n<p>So, What is the problem you are really trying to solve ?</p>\n"}], "owner": {"reputation": 1, "user_id": 10782852, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KLtJvgylTso/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jrCYatfBIKthTK8BZ9m9oJw2JR4w/mo/photo.jpg?sz=128", "display_name": "UD12121", "link": "https://stackoverflow.com/users/10782852/ud12121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544712071, "creation_date": 1544646755, "last_edit_date": 1544651167, "question_id": 53750896, "link": "https://stackoverflow.com/questions/53750896/qvector-crash-random-in-recursive-function", "title": "Qvector crash random in recursive function", "body": "<p>I am having weird problem using QT creator. I am using latest version of qt creator and Qvector function(i tried also std::vector and same problem)  In for loop i am calling recursive functions, example:</p>\n\n<pre><code>void add(bool in){\n    global_var.push_back(in) //Qvector&lt;bool&gt;, global varible\n    return;\n}\nvoid start(int x,int y,int z){\n    for(int i=0;i&lt;z;i++){\n        if(i&lt;z){\n           add(true);\n           start(x,y,z);\n           start(x,y,z);\n           return;\n        }\n\n    }\n        add(false) \n\n    }\n</code></pre>\n\n<p>And then app randomly crash at some point and only error i am getting is:</p>\n\n<pre><code>    Process:               FIRST_program [24565]\nPath:                  /Users/USER/Downloads/*/FIRST_program.app/Contents/MacOS/FIRST_program\nIdentifier:            feri.FIRST_program\nVersion:               0\nCode Type:             X86-64 (Native)\nParent Process:        Qt Creator [23775]\nResponsible:           FIRST_program [24565]\nUser ID:               501\n\nDate/Time:             2018-12-12 21:24:41.838 +0100\nOS Version:            Mac OS X 10.14.1 (18B75)\nReport Version:        12\nBridge OS Version:     3.0 (14Y667)\nAnonymous UUID:        F7D655B5-7798-C8EF-925D-0F2BF1B2ABD3\n\nSleep/Wake UUID:       6384DE06-A77B-4893-9D81-3BC040DA989F\n\nTime Awake Since Boot: 52000 seconds\nTime Since Wake:       11000 seconds\n\nSystem Integrity Protection: enabled\n\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\n\nException Type:        EXC_BAD_ACCESS (SIGSEGV)\nException Codes:       KERN_PROTECTION_FAILURE at 0x00007ffee4a8bff8\nException Note:        EXC_CORPSE_NOTIFY\n\nTermination Signal:    Segmentation fault: 11\nTermination Reason:    Namespace SIGNAL, Code 0xb\nTerminating Process:   exc handler [24565]\n\nVM Regions Near 0x7ffee4a8bff8:\n    MALLOC_SMALL           00007f9884800000-00007f9885800000 [ 16.0M] rw-/rwx SM=PRV  \n--&gt; STACK GUARD            00007ffee128c000-00007ffee4a8c000 [ 56.0M] ---/rwx SM=NUL  stack guard for thread 0\n    Stack                  00007ffee4a8c000-00007ffee528c000 [ 8192K] rw-/rwx SM=SHM  thread 0\n\nThread 0 Crashed:: Dispatch queue: com.apple.main-thread\n0   macbook.FIRST_program               0x000000010a97d690 QBasicAtomicInteger&lt;int&gt;::load() const + 16 (qbasicatomic.h:103)\n1   macbook.FIRST_program               0x000000010a97f155 QtPrivate::RefCount::isShared() const + 21 (qrefcount.h:101)\n2   macbook.FIRST_program               0x000000010a980d38 QVector&lt;bool&gt;::isDetached() const + 24 (qvector.h:106)\n3   macbook.FIRST_program               0x000000010a981920 QVector&lt;bool&gt;::append(bool const&amp;) + 64 (qvector.h:679)\n4   macbook.FIRST_program               0x000000010a97b64d QVector&lt;bool&gt;::push_back(bool const&amp;) + 29 (qvector.h:260)\n5   macbook.FIRST_program               0x000000010a97afc8 MainWindow::add(bool) + 40 (mainwindow.cpp:204)\n6   macbook.FIRST_program               0x000000010a97ae22 MainWindow::start(int, int, int, int) + 242 (mainwindow.cpp:132)\n7   macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n8   macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n9   macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n10  macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n11  macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n12  macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n13  macbook.FIRST_program               0x000000010a97ae9b MainWindow::start(int, int, int, int) + 363 (mainwindow.cpp:139)\n</code></pre>\n"}, {"tags": ["c++", "macos", "qt", "localization", "macos-mojave"], "owner": {"reputation": 564, "user_id": 1165946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fYEZj.png?s=128&g=1", "display_name": "rdowell", "link": "https://stackoverflow.com/users/1165946/rdowell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576065864, "creation_date": 1544646702, "question_id": 53750885, "link": "https://stackoverflow.com/questions/53750885/qt-application-on-macos-mojave-not-respecting-system-language", "title": "Qt application on MacOS Mojave not respecting system language", "body": "<p>I have a Qt-based desktop application for Windows/Mac that's localized for English and German.  The app is written to use the system language to determine its startup language, using the Qt QLocale API:</p>\n\n<pre><code>QLocale sysLocale = QLocale::system();\nQString translatorFileName = sysLocale.name(); // en_US, de_DE, etc\n</code></pre>\n\n<p>This was working as expected as of MacOS High Sierra(10.13.2).  On Mojave(10.14.1), this call is now always returning English for the language component regardless of the system language, i.e. if I change the system language and region to German/Germany, I expect <code>de_DE</code> to be returned as the locale name, but Qt returns <code>en_DE</code>.  I found that modifying the value of the <code>CFBundleDevelopmentRegion</code> key in the application's <code>Info.plist</code> file will override the system locale in some situations but it also behaves differently between High Sierra and Mojave</p>\n\n<p>I've <a href=\"https://bugreports.qt.io/browse/QTBUG-72491\" rel=\"nofollow noreferrer\">opened an issue</a> on the Qt bug report forums as well that has more detail, trying to determine whether this issue stems from Qt or from an API change in Mojave.</p>\n"}, {"tags": ["c++", "multithreading", "unity3d"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1544645841, "post_id": 53750704, "comment_id": 94354134, "body": "What is &quot;it&quot;? And what issue do you have with your DLL?"}, {"owner": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 5, "creation_date": 1544645850, "post_id": 53750704, "comment_id": 94354138, "body": "Unity components can utilize multithreaded code, but only the main thread can call the Unity API."}, {"owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1544645993, "post_id": 53750704, "comment_id": 94354191, "body": "I write multi-threaded stuff in Unity all the time... so care to give us a reference of what you are talking about?"}], "answers": [{"comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1544713422, "post_id": 53750759, "comment_id": 94381135, "body": "Re, &quot;single-thread limitation is typical...&quot; I&#39;ve lost the link, but one of the designers of AWT and Swing wrote about how GUI systems typically have a deep heirarchy of components in which business-logic typically goes from the root toward the leaves, while event handling goes in the opposite direction. He said that the opposite-direction-ness makes it <i>very</i> hard to design a multi-threaded system that is free from deadlocks. They tried with AWT, and Swing happened after they realized that it was never going to work well."}], "tags": [], "owner": {"reputation": 5525, "user_id": 576857, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8ec04b9d97b033d197d40642de73a4bc?s=128&d=identicon&r=PG", "display_name": "Al Kepp", "link": "https://stackoverflow.com/users/576857/al-kepp"}, "is_accepted": true, "score": 4, "last_activity_date": 1544646034, "creation_date": 1544646034, "answer_id": 53750759, "question_id": 53750704, "link": "https://stackoverflow.com/questions/53750704/combining-multithreaded-c-and-unity/53750759#53750759", "title": "Combining multithreaded C++ and Unity", "body": "<p>This is no problem, actually the single-thread limitation is typical for almost all user interface implementations. There are multiple ways how you can solve your problem. I don't know which solution is the best for Unity, I am just providing this as an example how you can proceed: You can for example have a single UI thread and call all Unity-related stuff only from this single thread. Use all other threads for whatever you want and let them communicate with your UI thread. The UI thread is then also de-facto mediator between Unity and the rest of your application.</p>\n"}], "owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 53750759, "answer_count": 1, "score": 0, "last_activity_date": 1544646034, "creation_date": 1544645758, "question_id": 53750704, "link": "https://stackoverflow.com/questions/53750704/combining-multithreaded-c-and-unity", "title": "Combining multithreaded C++ and Unity", "body": "<p>It says that Unity is not thread-safe. What does this exactly imply? If I have a multithreaded C++ DLL that I want to import and use in Unity, is there a procedure to make it compatible?</p>\n"}, {"tags": ["c++", "oop", "operator-overloading", "overloading", "covariant-return-types"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1544645974, "post_id": 53750703, "comment_id": 94354186, "body": "How does it not compile?  After fixing the order and not using <code>Proxy</code> right in <code>B</code> it compiles: <a href=\"http://coliru.stacked-crooked.com/a/9bef90d5e7438ca0\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/9bef90d5e7438ca0</a>"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1544646059, "post_id": 53750703, "comment_id": 94354220, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Providing code that actually doesn&#39;t demonstrate the problem has very little utility.  I suspect your real problem is over use of <code>virtual</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10671686"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1544647722, "post_id": 53750703, "comment_id": 94354930, "body": "@NathanOliver I made changes, it is more complete now, excuse my ignorance"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10671686"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544647853, "post_id": 53750703, "comment_id": 94354984, "body": "@Yakk-AdamNevraumont I don&#39;t think the problem is related to virtual,considering I have the same issue with or without it."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1544648100, "post_id": 53750703, "comment_id": 94355074, "body": "@protoneight Your code remains incomplete.  Please click on <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, read it, and then provide one.  I cannot prove you are wrong about <code>virtual</code> without actually having code that actually reproduces your actual problem."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1544648246, "post_id": 53750703, "comment_id": 94355129, "body": "<a href=\"http://coliru.stacked-crooked.com/a/37a311887eb07455\" rel=\"nofollow noreferrer\">Example of your code compiling with <code>virtual</code> removed</a>, and <a href=\"http://coliru.stacked-crooked.com/a/9d5e45ca6a1fed9d\" rel=\"nofollow noreferrer\">not compiling with <code>virtual</code> added</a>, after fixing around a dozen errors.  There are still more errors I didn&#39;t fix, but enough that clang actually complained about the lack of covariance.  Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that <i>actually exhibits the error</i>, and is both minimal and complete."}], "answers": [{"comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544649243, "post_id": 53751297, "comment_id": 94355544, "body": "The entire <i>reason</i> to have the <code>Proxy</code> class is to support the <code>Proxy&amp; operator=(const T&amp; elm)</code> that does more than simply assign the value. And your code is fundamentally incompatible with this."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544650132, "post_id": 53751297, "comment_id": 94355912, "body": "@MooingDuck Edited the answer, added requested functionality. Please point out what else is incompatible."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544650466, "post_id": 53751297, "comment_id": 94356059, "body": "<a href=\"http://coliru.stacked-crooked.com/a/88f60013062a4b0b\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/88f60013062a4b0b</a> container[0] = 3; // error: lvalue required as left operand of assignment.  Note that <code>std::vector&lt;bool&gt;</code> returns a proxy that allows you to assign directly to it, but that had to sacrifice the interface slightly because it couldn&#39;t be covariant."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544650718, "post_id": 53751297, "comment_id": 94356157, "body": "@MooingDuck Of course you cannot assign to a B through an A; A&#39;s interface doesn&#39;t allow assigning."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544650900, "post_id": 53751297, "comment_id": 94356243, "body": "@Yakk-AdamNevraumont: This isn&#39;t about A&#39;s interface, this is about T&#39;s interface. And since <code>A::operator[]</code> returns a <code>T</code>, that means B can&#39;t instead return a Proxy that allows conversion to/from T, like std::vector&lt;bool&gt; does, which is exactly what the OP is trying to do in <code>Proxy&amp; operator=(const T&amp; elm)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10671686"}, "edited": false, "score": 0, "creation_date": 1544651480, "post_id": 53751297, "comment_id": 94356530, "body": "@n.m. Very cool thank you ! This answers my question. I made some adjustments to Proxy so it converts automatically to T. However, I don&#39;t understand the use of operator_impl_A, since the behavior seems to be the same if I delete it in both classes."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544651752, "post_id": 53751297, "comment_id": 94356648, "body": "@MooingDuck It doesn&#39;t look like we&#39;re on the same page. Why do you think <code>container[0] = 3</code> is supposed to ever work? I was not tasked to implement this. <code>operator[]</code> in the parent class is specified to return <code>T</code>, not <code>T&amp;</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544651959, "post_id": 53751297, "comment_id": 94356740, "body": "@protoneight I changed the code to reflect your example more closely. It compiles and runs. I replaced <code>Box</code> with <code>std::map</code> just to use something specific."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544652051, "post_id": 53751297, "comment_id": 94356793, "body": "@MooingDuck &quot;This isn&#39;t about A&#39;s interface, this is about T&#39;s interface.&quot; I don&#39;t think you are thinking about the same set of requirements OP is thinking about."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544652151, "post_id": 53751297, "comment_id": 94356843, "body": "@protoneight Can you show me what exactly was removed and how the modified code looks like? You cannot just remove <code>operator_impl_A</code> because <code>A::operator[]</code> calls it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10671686"}, "edited": false, "score": 0, "creation_date": 1544653654, "post_id": 53751297, "comment_id": 94357458, "body": "@n.m. sorry I meant op_impl_B. (op_Spec) This is a test code : <a href=\"https://coliru.stacked-crooked.com/a/c0b2b93b96f2d821\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/c0b2b93b96f2d821</a>"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544653789, "post_id": 53751297, "comment_id": 94357521, "body": "@n.m.: I disagree. The OP clearly is merely lacking the vocabulary to describe their problem, which can be seen in the code: <code>specialContainer&lt;T&gt;</code> should return a <code>Proxy</code>, that allows <code>SpecialContainer&lt;int&gt; x; x[2] = 3;</code>, but they can&#39;t make this work with a generic <code>AbsContainer</code> interface, which doesn&#39;t support the use of the proxy."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544655003, "post_id": 53751297, "comment_id": 94357987, "body": "@MooingDuck When you return a covariant type in a subclass, you do <i>not</i> mean that the base class has access to the extension.  Rather, when you know you are the subclass, you get the subclass enhanced behavior; when you are the base, you get the base class behavior."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544658001, "post_id": 53751297, "comment_id": 94358911, "body": "@Yakk-AdamNevraumont: Yes. And that&#39;s exactly what this answer <i>ought</i> to say. What the OP wants cannot be done. The two concepts are fundamentally incompatible."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544658901, "post_id": 53751297, "comment_id": 94359141, "body": "@moo that is exactly what this answer does.  I explained this answer.  I have no idea what you think this answer says.  The OP&#39;s example also doesn&#39;t show assigning through index of base, so I have no idea why you think the OP wants that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544673263, "post_id": 53751297, "comment_id": 94362186, "body": "@protoneight I see! It is needed e.g. for the case one wants to derive a further subclass from SpecialContainer, override <code>operator[]</code> further, and make the return type covariant again. In general it is often a goof idea to make all public methods non-virtual, and make them forward calls to private virtual method. See e.g. <a href=\"https://isocpp.org/wiki/faq/strange-inheritance\" rel=\"nofollow noreferrer\">this FAQ</a>. But you can skip this and it will also work."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544674011, "post_id": 53751297, "comment_id": 94362325, "body": "@MooingDuck What OP wants is very clearly written in the text of the question. I don&#39;t detect any lack of vocabulary here. I think understand the problem completely because I have encountered very similar problems in the past and I have invented this here method to solve them. OP agrees that this method solves their problem. If you think otherwise, please feel free to post your own answer and explain that it cannot be done."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1544651818, "last_edit_date": 1544651818, "creation_date": 1544648577, "answer_id": 53751297, "question_id": 53750703, "link": "https://stackoverflow.com/questions/53750703/covariant-return-type-with-primitive-types/53751297#53751297", "title": "Covariant return type with primitive types", "body": "<p>You can implement something very similar to covariant types even without any compiler support for actual covariant types. Here's how to do it.</p>\n\n<pre><code>#include &lt;cstddef&gt;\n#include &lt;map&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nclass AbsContainer {\n  public:\n    T operator[](ptrdiff_t i) { return operator_Abs(i); }\n    virtual T operator_Abs(ptrdiff_t) = 0;\n};\n\ntemplate&lt;typename T&gt;\nclass SpecialContainer : public AbsContainer&lt;T&gt;, std::map&lt;ptrdiff_t, T&gt;  {\n  public:\n    class Proxy;\n    Proxy operator[](ptrdiff_t i) { return operator_Spec(i); }\n    T operator_Abs(ptrdiff_t i) override {\n        return operator_Spec(i).get();\n    }\n    virtual Proxy operator_Spec(ptrdiff_t i) {\n        return Proxy(i, this);\n    }\n};\n\ntemplate &lt;typename T&gt;\nclass SpecialContainer&lt;T&gt;::Proxy  {\n    ptrdiff_t _i;\n    std::map&lt;ptrdiff_t, T&gt;* _p;\npublic:\n    Proxy(ptrdiff_t i, std::map&lt;ptrdiff_t, T&gt;* p) : _i(i), _p(p) {};\n    Proxy&amp; operator=(const T&amp; elm) {\n        _p-&gt;insert(std::pair&lt;ptrdiff_t,T&gt;(_i,elm));\n        return *this;\n    }\n    T get() { return (*_p)[_i]; }\n};\n\nint main()\n{\n       SpecialContainer&lt;std::string&gt; spec;\n       AbsContainer&lt;std::string&gt;&amp; abs = spec;\n       auto k = spec[42];\n       k = \"Hello World\";\n       std::cout &lt;&lt; abs[42] &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10671686"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545471333, "creation_date": 1544645751, "last_edit_date": 1545471333, "question_id": 53750703, "link": "https://stackoverflow.com/questions/53750703/covariant-return-type-with-primitive-types", "title": "Covariant return type with primitive types", "body": "<p>I have the following:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass AbsContainer {\npublic:\n    virtual T operator[](ptrdiff_t) = 0;\n};\n\ntemplate&lt;typename T&gt;\nclass SpecialContainer : public AbsContainer&lt;T&gt;, Box&lt;pair&lt;ptrdiff,T&gt;&gt; {\n    class Proxy;\npublic:\n    Proxy operator[](ptrdiff_t i) {\n        return Proxy(i, this);\n    };\n};\n\ntemplate &lt;typename T&gt;\nclass SpecialContainer&lt;T&gt;::Proxy  {\n    ptrdiff_t _i;\n    Box* _p;\npublic:\n    Proxy(ptrdiff_t i, Box* p) : _i(i), _p(p);\n    Proxy&amp; operator=(const T&amp; elm) {\n        _p-&gt;::insert(pair&lt;ptrdiff,T&gt;(_i,elm));  //defined in Box\n    }\n};\n</code></pre>\n\n<p>main:</p>\n\n<pre><code>SpecialContainer&lt;int&gt; x;\nx[2] = 3;\n</code></pre>\n\n<p>This doesn't compile, because in class <code>SpecialContainer</code>, the <code>operator[]</code> with the one in <code>AbsContainer</code>.</p>\n\n<p>Ideally in concept, <code>Proxy operator[]</code> should be an override. So I tried resolving this by achieving covariant return type by making Proxy inherit from T. However it doesn't work since T can be a primitive type, and inheriting from a primitive type has no sense.</p>\n\n<p>Error because of operator conflict :</p>\n\n<p><code>error: conflicting return type specified for \u2018specialContainer&lt;T&gt;::Proxy B&lt;T&gt;::operator[](std::ptrdiff_t) [with T = int; std::ptrdiff_t = long unsigned int]</code></p>\n\n<p>Error because trying to inherit from parametric type T (<code>int</code> in this case):</p>\n\n<p><code>error: base type \u2018int\u2019 fails to be a struct or class type</code></p>\n\n<p>Is there any way in which can this be resolved ?</p>\n"}, {"tags": ["c++", "standard-deviation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1544648602, "post_id": 53750700, "comment_id": 94355275, "body": "What is your question? If you are encountering compiler errors tell us what they are and where and what you intend the error-producing code to do. I am getting lots of errors."}, {"owner": {"reputation": 33, "user_id": 10535116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e760a00e068cf260b14f23c27f50513e?s=128&d=identicon&r=PG&f=1", "display_name": "Fummy", "link": "https://stackoverflow.com/users/10535116/fummy"}, "edited": false, "score": 0, "creation_date": 1544648726, "post_id": 53750700, "comment_id": 94355319, "body": "Specific error is at this line: while (InFile &gt;&gt; dataPoint) . I&#39;m trying to say while my file is inputting data points. No &quot;&gt;&gt;&quot; operator matches these operands."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1544648848, "post_id": 53750700, "comment_id": 94355371, "body": "<code>dataPoint</code> is an array of doubles. You can only read one double at a time, so you need to index into the element of the array that you want to write to."}, {"owner": {"reputation": 33, "user_id": 10535116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e760a00e068cf260b14f23c27f50513e?s=128&d=identicon&r=PG&f=1", "display_name": "Fummy", "link": "https://stackoverflow.com/users/10535116/fummy"}, "edited": false, "score": 0, "creation_date": 1544649622, "post_id": 53750700, "comment_id": 94355681, "body": "So: for (int i = 0; i &lt; MAX_COUNT; i++)? And then have dataPoint[i]? But where would i place the for loop?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1544649836, "post_id": 53750700, "comment_id": 94355764, "body": "Either use the <code>while</code> loop you have now or replace it with the loop, in either case make sure you leave it when the <code>&gt;&gt;</code> operation fails. You already have a counter by the way: <code>SamplePoint</code>. Also it makes no sense to me that you calculate the standard deviation each time inside the loop."}, {"owner": {"reputation": 33, "user_id": 10535116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e760a00e068cf260b14f23c27f50513e?s=128&d=identicon&r=PG&f=1", "display_name": "Fummy", "link": "https://stackoverflow.com/users/10535116/fummy"}, "edited": false, "score": 0, "creation_date": 1544652791, "post_id": 53750700, "comment_id": 94357121, "body": "I&#39;m trying to put each data point in and calculate the new standard deviation. The program doesn&#39;t do it correctly anyways. I changed the while loop to this:  while (InFile &gt;&gt; dataPoint[SamplePoint]) \t{ \t\tStandard_Deviation(dataPoint, MAX_COUNT); \t\tSamplePoint++; \t\tif (InFile.eof())break; \t} \tcout &lt;&lt; &quot;The Standard Deviation is: &quot; &lt;&lt; sd &lt;&lt; endl; \tcout &lt;&lt; SamplePoint &lt;&lt; &quot; records process \\n&quot;;"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10535116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e760a00e068cf260b14f23c27f50513e?s=128&d=identicon&r=PG&f=1", "display_name": "Fummy", "link": "https://stackoverflow.com/users/10535116/fummy"}, "is_accepted": false, "score": 0, "last_activity_date": 1544656763, "creation_date": 1544656763, "answer_id": 53752873, "question_id": 53750700, "link": "https://stackoverflow.com/questions/53750700/reading-a-numbers-from-dat-file-and-then-computing-the-standard-deviation/53752873#53752873", "title": "Reading a numbers from .dat file and then computing the standard deviation", "body": "<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\ndouble Calc_Stand_Dev(ifstream &amp;);\n\nvoid Magic_Number();\n\nifstream InFile;\n\nconst int MAX_NUM = 1000;\n\nint main()\n{\n    string NameOfInputFile = \"StdDev.dat\";\n\n    InFile.open(\"StdDev.dat\");\n    if (InFile.fail()) {\n        cout &lt;&lt; \"Cannot open file: \" &lt;&lt; NameOfInputFile &lt;&lt; \"\\d\";\n        exit(-3);\n    }\n\n    double sd = Calc_Stand_Dev(InFile);\n\n    cout &lt;&lt; \"The standard deviation is: \" &lt;&lt; sd &lt;&lt; endl;\n\n    //cout &lt;&lt; RecordCount &lt;&lt; \" numbers total are used to calculate the standard deviation. \\n\";\n\n    InFile.close();\n    if (InFile.fail()) {\n        cout &lt;&lt; \"Cannot close file: \" &lt;&lt; NameOfInputFile &lt;&lt; \"\\d\";\n        exit(-5);\n    }\n    cin.get();\n\n    return 0;\n}\n\ndouble Calc_Stand_Dev(ifstream &amp; InFile)\n{\n    double dataPoint[MAX_NUM], Avg, Variance, stdDev, sum = 0, sumSq = 0;\n    int RecordCount = 0;\n\n    for (int i = 0; i &lt; MAX_NUM; i++)\n    {\n        InFile &gt;&gt; dataPoint[i];\n        Magic_Number();\n\n        sum += dataPoint[i]; //sums each new data point added from the file\n        sumSq += (dataPoint[i] * dataPoint[i]); //squares the data points and makes a sum out of it.\n\n        ++RecordCount; // coutner for number of data points\n        if (InFile.eof())break;\n    }\n\n    Avg = sum / RecordCount;\n    Variance = (RecordCount * sumSq - sum * sum) / (RecordCount * (RecordCount - 1));\n    stdDev = sqrt(Variance);\n\n    cout &lt;&lt; RecordCount &lt;&lt; \" numbers processed \\n\";\n\n    return stdDev;\n}\n\nvoid Magic_Number()\n{\n    cout.setf(ios::fixed);\n    cout.setf(ios::showpoint);\n    cout.precision(2); \n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10535116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e760a00e068cf260b14f23c27f50513e?s=128&d=identicon&r=PG&f=1", "display_name": "Fummy", "link": "https://stackoverflow.com/users/10535116/fummy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544656763, "creation_date": 1544645747, "question_id": 53750700, "link": "https://stackoverflow.com/questions/53750700/reading-a-numbers-from-dat-file-and-then-computing-the-standard-deviation", "title": "Reading a numbers from .dat file and then computing the standard deviation", "body": "<p>I'm suppose to read numbers from a .dat file and then compute the standard deviation and also output the amount of the numbers in the file. I believe my mean and standard deviation functions are correct. It's the actually inputting of the numbers from the file to the functions that's throwing me off. Here's what I have so far.</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;cstdlib&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\nconst int MAX_COUNT = 1000; //for max size of array\n\ndouble Mean(double*, int); //calculates average of numbers\ndouble Standard_Deviation(double*, int); //calculates standard deviation\n\nvoid Magic_Number();\n\nifstream InFile;\n\nint main()\n{\n    Homework_Header();\n\n    string NameOfInputFile = \"StdDev.dat\";\n\n    InFile.open(\"StdDev.dat\");\n    if (InFile.fail()) {\n        cout &lt;&lt; \"Cannot open file: \" &lt;&lt; NameOfInputFile &lt;&lt; \"\\d\";\n        exit(1);\n    }\n\n    int SamplePoint = 0;\n    double dataPoint[MAX_COUNT];\n    double sd = Standard_Deviation(dataPoint, MAX_COUNT);\n\n    while (InFile &gt;&gt; dataPoint)\n    {\n        void Magic_Number();\n\n        sd = Standard_Deviation(dataPoint, MAX_COUNT);\n\n        SamplePoint++;\n        if (InFile.eof())break;\n    }\n    cout &lt;&lt; \"The Standard Deviation is: \" &lt;&lt; sd &lt;&lt; endl;\n    cout &lt;&lt;SamplePoint &lt;&lt; \" records process \\n\";\n\n\n\n    InFile.close();\n\n    if (InFile.fail()) {\n        cout &lt;&lt; \"Cannot close file: \" &lt;&lt; NameOfInputFile &lt;&lt; \"\\d\";\n        exit(-5);\n    }\n\n    cin.get();\n    return 0;\n}\n\n\nvoid Magic_Number()\n{\n    cout.setf(ios::fixed);\n    cout.setf(ios::showpoint);\n    cout.precision(2);\n}\n\ndouble Mean(double* numbers, int count)\n{\n    double calculated_mean = 0.0;\n\n    for (int i = 0; i &lt; count; ++i)\n    {\n        calculated_mean += numbers[i];\n    }\n    calculated_mean /= double(count);\n\n    return calculated_mean;\n}\n\ndouble Standard_Deviation(double* numbers, int count) // * is pointer: special variable that has a memory address as value\n{\n    double std_dev = 0.0;\n    double average = Mean(numbers, count); //Mean of numbers\n    double temp_dev;\n\n    for (int i = 0; i &lt; count; ++i)\n    {\n        temp_dev = numbers[i] - average; //sets temp_dev to be the deviation from the average\n\n        std_dev += temp_dev * temp_dev; //adds squares of the deviations\n    }\n\n    std_dev /= double(count);\n\n    std_dev = sqrt(std_dev); // square roots\n\n    return std_dev;\n}\n</code></pre>\n"}, {"tags": ["c#", "c++"], "comments": [{"owner": {"reputation": 9718, "user_id": 1424244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8d370542399af1afe3202ed1fc1ab88?s=128&d=identicon&r=PG", "display_name": "IS4", "link": "https://stackoverflow.com/users/1424244/is4"}, "edited": false, "score": 0, "creation_date": 1544662192, "post_id": 53750602, "comment_id": 94359878, "body": "I suggest you not attempt interop on C++ <code>std</code> classes at all, unless there is no other way (such as changing your C++ code). The memory layout of <code>std::bitset</code> is not guaranteed at all. Different versions of the compiler might produce incompatible layouts of the class."}, {"owner": {"reputation": 1024, "user_id": 2556818, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c9fa20d61c8736ada3483cbeb812aacb?s=128&d=identicon&r=PG", "display_name": "Noobie3001", "link": "https://stackoverflow.com/users/2556818/noobie3001"}, "reply_to_user": {"reputation": 9718, "user_id": 1424244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8d370542399af1afe3202ed1fc1ab88?s=128&d=identicon&r=PG", "display_name": "IS4", "link": "https://stackoverflow.com/users/1424244/is4"}, "edited": false, "score": 0, "creation_date": 1544690034, "post_id": 53750602, "comment_id": 94367713, "body": "Thanks for the info.  I don&#39;t own the C++ code and have no control over it."}], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 2556818, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c9fa20d61c8736ada3483cbeb812aacb?s=128&d=identicon&r=PG", "display_name": "Noobie3001", "link": "https://stackoverflow.com/users/2556818/noobie3001"}, "edited": false, "score": 0, "creation_date": 1544661207, "post_id": 53751410, "comment_id": 94359682, "body": "Thanks.  I&#39;ve updated the question and found a solution based on your suggestion to use byte arrays to represent the bitset."}, {"owner": {"reputation": 11, "user_id": 10773476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AhL8t.png?s=128&g=1", "display_name": "Ed By Day", "link": "https://stackoverflow.com/users/10773476/ed-by-day"}, "reply_to_user": {"reputation": 1024, "user_id": 2556818, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c9fa20d61c8736ada3483cbeb812aacb?s=128&d=identicon&r=PG", "display_name": "Noobie3001", "link": "https://stackoverflow.com/users/2556818/noobie3001"}, "edited": false, "score": 0, "creation_date": 1545176639, "post_id": 53751410, "comment_id": 94533509, "body": "I&#39;m glad this helped.  Interop is always kind of a drag."}], "tags": [], "owner": {"reputation": 11, "user_id": 10773476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AhL8t.png?s=128&g=1", "display_name": "Ed By Day", "link": "https://stackoverflow.com/users/10773476/ed-by-day"}, "is_accepted": false, "score": 1, "last_activity_date": 1544649086, "creation_date": 1544649086, "answer_id": 53751410, "question_id": 53750602, "link": "https://stackoverflow.com/questions/53750602/using-cs-marshal-ptrtostructure-on-a-c-struct-containing-two-bitsets/53751410#53751410", "title": "Using C#&#39;s Marshal.PtrToStructure on a C++ struct containing two bitsets", "body": "<p>We use interop a lot where I work, and though I haven't had to handle this situation, I suggest you treat your bitsets as byte arrays (<code>byte[]</code> in C#, I believe <code>char[]</code> in C++ unless you're aliasing <code>char</code>).  After all 512 bits is just 64 contiguous bytes.</p>\n\n<p>I admit I haven't given you a full explanation of the syntax, my apologies, but I hope this gets you pointed in the right direction.</p>\n\n<p>If your C# end needs to use them as <code>BitArray</code> instances, you could create properties on your struct there and just make them calculated, based on your <code>byte[]</code>s.  That does no harm for interop; the marshaller doesn't try to convert them across code boundaries in either direction.</p>\n"}], "owner": {"reputation": 1024, "user_id": 2556818, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c9fa20d61c8736ada3483cbeb812aacb?s=128&d=identicon&r=PG", "display_name": "Noobie3001", "link": "https://stackoverflow.com/users/2556818/noobie3001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544660915, "creation_date": 1544645248, "last_edit_date": 1544660915, "question_id": 53750602, "link": "https://stackoverflow.com/questions/53750602/using-cs-marshal-ptrtostructure-on-a-c-struct-containing-two-bitsets", "title": "Using C#&#39;s Marshal.PtrToStructure on a C++ struct containing two bitsets", "body": "<p>I'm trying to use my existing code to map a C++ structure containing std::bitsets to a C# version of it.  </p>\n\n<p>My code works great on these simple objects:</p>\n\n<pre><code>// C++ struct\nstruct log_t \n{\n    uint16 current;\n    bool   complete[64];\n};\n\nC# struct\n[StructLayout(LayoutKind.Sequential)]\npublic struct Log\n{\n    public UInt16 current;\n    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 64, ArraySubType = UnmanagedType.Struct)]\n    public byte[] complete;\n}\n\n// Convert the C# struct back to bytes for the C++ app to use\nprivate byte[] GetObjectBytes(object obj)\n{\n    int size = Marshal.SizeOf(obj);\n    byte[] arr = new byte[size];\n    IntPtr ptr = Marshal.AllocHGlobal(size);\n    Marshal.StructureToPtr(obj, ptr, true);\n    Marshal.Copy(ptr, arr, 0, size);\n    Marshal.FreeHGlobal(ptr);\n    return arr;\n}\n</code></pre>\n\n<p>How do I map the following C++ structs to C# structs that contains two std::bitsets? I wish to use them in the same manner as above.</p>\n\n<pre><code>struct items_table\n{\n    std::bitset&lt;512&gt; keyList;\n    std::bitset&lt;512&gt; seenList;\n};\n\nstruct items\n{\n    std::array&lt;items_table, 7&gt; tables;\n};\n</code></pre>\n\n<p>SOLUTION</p>\n\n<p>I used byte[] arrays in C# to represent the bitsets in C++.  I then had to access each bit like this:</p>\n\n<pre><code>    private void AddItem(int ItemId, KeyItems keyitems)\n    {\n        decimal byteIndex = (ItemId % 512) / 8;\n        decimal bitInByteIndex = (ItemId % 512) % 8;\n        keyitems.tables[ItemId / 512].keyList[(int)byteIndex] |= (byte)(1 &lt;&lt; (byte)bitInByteIndex);\n    }\n</code></pre>\n"}, {"tags": ["c++", "templates", "math", "functor", "relational-operators"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1544644848, "post_id": 53750460, "comment_id": 94353702, "body": "<code>foo&lt;plus&gt;</code> and <code>foo&lt;minus&gt;</code> can be trampoline functions that call into more complicated template machinery where you can encode the <code>less</code> <code>greater</code> and the appropriate constants."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544644958, "post_id": 53750460, "comment_id": 94353760, "body": "@AndyG Yeah, I suppose I could do a <code>constexpr if</code> based on the type."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544645127, "post_id": 53750460, "comment_id": 94353826, "body": "Basically that&#39;s the way to go. Will probably be cleaner than without <code>constexpr if</code>. I think you&#39;ve got the gist of it, would you like a code example, too? Is there another way you&#39;re hoping for this to work?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544645443, "post_id": 53750460, "comment_id": 94353951, "body": "@AndyG Yeah I guess if that&#39;s as good as we got and you write it up I&#39;ll accept. But what I was thinking of was a way to magic less than out of <code>minus</code> and greater than out of <code>plus</code>."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544645769, "post_id": 53750460, "comment_id": 94354094, "body": "There&#39;s no inherent binding of <code>less</code> to <code>minus</code> or <code>greater</code> to <code>plus</code>, so the traditional way would be through traits, but that is a lot of extra machinery that you just don&#39;t need when <code>if constexpr</code> is around"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544647806, "post_id": 53750460, "comment_id": 94354969, "body": "How are you passing <code>std::plus&lt;int&gt;{}</code> to <code>auto T</code>? <code>std::plus</code> is not an integral type"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544648161, "post_id": 53750460, "comment_id": 94355095, "body": "@AndyG Yeah <code>T</code> can be anything. I learned about <code>auto</code> template parameters here: <a href=\"https://stackoverflow.com/q/38457112/2642059\">stackoverflow.com/q/38457112/2642059</a> And I&#39;ve found them extremely useful for handing around functors/function pointers/member pointers. I&#39;m effectively passing the type <i>and</i> the object in one parameter there."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1544648344, "post_id": 53750460, "comment_id": 94355169, "body": "Can you show a compiling example where you pass <code>std::plus&lt;int&gt;{}</code> as an explicit template argument for a function?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544703534, "post_id": 53750460, "comment_id": 94375129, "body": "@AndyG And of course you&#39;re totally right T.T I can&#39;t pass a functor as a template argument :( I thought this was possible. I&#39;ll be asking a follow up question and post it here."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1544704329, "post_id": 53750460, "comment_id": 94375518, "body": "@AndyG I&#39;ve asked a question for clarification on what is and isn&#39;t allowed as an argument to an <code>auto</code> template parameter here: <a href=\"https://stackoverflow.com/q/53761899/2642059\">stackoverflow.com/q/53761899/2642059</a> Just thought I&#39;d link in case you would like to weigh in."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544720132, "post_id": 53750460, "comment_id": 94385164, "body": "@JonathanMee <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b20\">c++20</a> with <code>operator&lt;=&gt;</code> permits non-type template parameters of (some) class types.  I&#39;m uncertain if lambdas or <code>std::plus</code> will be one of them, but as both are monostate types there is no reason why they won&#39;t."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544763086, "post_id": 53750460, "comment_id": 94398790, "body": "@Yakk-AdamNevraumont Sadly, the standard functors do not define relational operators, so I think even in C++20, I won&#39;t be able to do this. Thank you for the tip though. I also found this rather exciting tidbit in my linked question, and I&#39;ve been excited about it ever since."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544773483, "post_id": 53750460, "comment_id": 94401913, "body": "@jona adding <code>&lt;=&gt; = default</code> to std types is probably worth proposing."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1544793336, "post_id": 53750460, "comment_id": 94412122, "body": "@Yakk-AdamNevraumont It is at that. I&#39;d love to... though I&#39;ve never written a proposal. I don&#39;t suppose there&#39;s a beginner&#39;s guide somewhere?"}], "answers": [{"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1544645496, "post_id": 53750639, "comment_id": 94353973, "body": "Oh snap, that&#39;s sexy."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1544720012, "last_edit_date": 1544720012, "creation_date": 1544645439, "answer_id": 53750639, "question_id": 53750460, "link": "https://stackoverflow.com/questions/53750460/can-i-write-relational-operators-in-terms-of-arithmetic-operations/53750639#53750639", "title": "Can I Write Relational Operators in Terms of Arithmetic Operations?", "body": "<pre><code>T{}(0, arg1) &gt; T{}(0,arg2);\nT{}(0, bar) &gt; 0;\nT{}(0, bar) &gt; -10;\n</code></pre>\n\n<p>The basic idea is <code>a &gt; b</code> if and only if <code>-a &lt; -b</code>.  And <code>plus(0,a)==a</code> while <code>minus(0,a)==-a</code>.</p>\n\n<p>The last one is tricky, as we want to change the order of <code>&lt;</code> and the sign.  Luckily they cancel:</p>\n\n<p>Suppose we want a constant that is <code>-10</code> in the plus case, and <code>10</code> in the minus case.  Then</p>\n\n<pre><code>plus(0,-10)\n</code></pre>\n\n<p>is <code>-10</code> and</p>\n\n<pre><code>minus(0,-10)\n</code></pre>\n\n<p>is <code>10</code>.</p>\n\n<p>So we get:</p>\n\n<pre><code>T{}(0, bar) &gt; T{}(0, T{}(0,-10))\n</code></pre>\n\n<p>in the plus case, the rhs is <code>0+0+-10</code>, aka <code>-10</code>.</p>\n\n<p>In the minus case, this is <code>0-(0-(-10))</code>, aka <code>-10</code>.</p>\n\n<p>So the short form is:</p>\n\n<pre><code>T{}(0,bar) &gt; -10\n</code></pre>\n\n<p>and it should work.</p>\n"}, {"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1544763499, "post_id": 53766488, "comment_id": 94398867, "body": "Just wanted to say that I appreciated all the effort that went into this. I&#39;m restricted to Visual Studio 2012 for this project so, I think you&#39;re only suggestion that I could benefit from was the specialization. Ultimately I found that passing 2 template arguments was just the best approach for this problem. But I find these very educational in a more general sense as well. So thank you."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1544794569, "post_id": 53766488, "comment_id": 94412771, "body": "@JonathanMee: I&#39;m sorry about your luck. That&#39;s coming from a former VS2012 user. I hope you get to upgrade soon, the product has really improved through VS 2017. That said, I think with some fiddling we could make the function traits and the tagged dispatch approaches work there, but full specialization is probably good enough."}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 1, "last_activity_date": 1544719543, "creation_date": 1544719543, "answer_id": 53766488, "question_id": 53750460, "link": "https://stackoverflow.com/questions/53750460/can-i-write-relational-operators-in-terms-of-arithmetic-operations/53766488#53766488", "title": "Can I Write Relational Operators in Terms of Arithmetic Operations?", "body": "<p>Besides <a href=\"https://stackoverflow.com/a/53750639/27678\">@Yakk's answer</a> there are a number of ways you can do this. Here are 5.</p>\n\n<h3>Method 1: Function traits</h3>\n\n<p>This is more of a classic technique used before more advanced template-metaprogramming techniques became available. It's still quite handy. We specialize some structure depending on <code>T</code> to give us the types and constants we want to use.</p>\n\n<pre><code>template&lt;class T&gt;\nstruct FooTraits;\n\ntemplate&lt;class T&gt;\nstruct FooTraits&lt;std::plus&lt;T&gt;&gt;\n{\n    using Compare = std::greater&lt;T&gt;;\n    static constexpr std::tuple&lt;int, int&gt; barVals{0, 10};\n};\n\ntemplate&lt;class T&gt;\nstruct FooTraits&lt;std::minus&lt;T&gt;&gt;\n{\n    using Compare = std::less&lt;T&gt;;\n    static constexpr std::tuple&lt;int, int&gt; barVals{0, -10};\n};\n\ntemplate &lt;class T&gt;\nvoid foo(const int arg1, const int arg2, int&amp; bar)\n{\n    using traits = FooTraits&lt;T&gt;;\n    typename traits::Compare cmp{};\n    cmp(arg1, arg2);\n    cmp(bar, std::get&lt;0&gt;(traits::barVals));\n    cmp(bar, std::get&lt;1&gt;(traits::barVals));\n}\n</code></pre>\n\n<h2><a href=\"https://wandbox.org/permlink/auzkKK9LgzQg5CGF\" rel=\"nofollow noreferrer\">Live Demo 1</a></h2>\n\n<hr>\n\n<h3>Method 2: Full specialization</h3>\n\n<p>Another \"classic\" technique that remains useful. You are probably familiar with this technique, but I'm showing it for completeness. So long as you never need to <em>partially</em> specialize a function, you can write different version of it for the types you need:</p>\n\n<pre><code>template &lt;class T&gt;\nvoid foo(const int arg1, const int arg2, int&amp; bar);\n\ntemplate &lt;&gt;\nvoid foo&lt;std::plus&lt;int&gt;&gt;(const int arg1, const int arg2, int&amp; bar)\n{\n    arg1 &gt; arg2;\n    bar &gt; 0;\n    bar &gt; 10;\n}\n\ntemplate &lt;&gt;\nvoid foo&lt;std::minus&lt;int&gt;&gt;(const int arg1, const int arg2, int&amp; bar)\n{\n    arg1 &lt; arg2;\n    bar &lt; 0;\n    bar &lt; -10;\n}\n</code></pre>\n\n<h2><a href=\"https://wandbox.org/permlink/nmX51TygQqszmzGe\" rel=\"nofollow noreferrer\">Live Demo 2</a></h2>\n\n<hr>\n\n<h3>Method 3: Tagged dispatch</h3>\n\n<p>A third classic technique that turns a type check into an overloading problem. The gist is that we define some lightweight <code>tag</code> struct that we can instantiate, and then use that as a differentiator between overloads. Often this is nice to use when you have a templated class function, and you don't want to specialize the entire class just to specialize said function.</p>\n\n<pre><code>namespace detail\n{\n    template&lt;class...&gt; struct tag{};\n\n    void foo(const int arg1, const int arg2, int&amp; bar, tag&lt;std::plus&lt;int&gt;&gt;)\n    {\n        arg1 &gt; arg2;\n        bar &gt; 0;\n        bar &gt; 10;\n    }\n\n    void foo(const int arg1, const int arg2, int&amp; bar, tag&lt;std::minus&lt;int&gt;&gt;)\n    {\n        arg1 &lt; arg2;\n        bar &lt; 0;\n        bar &lt; -10;\n    }\n}\ntemplate &lt;class T&gt;\nvoid foo(const int arg1, const int arg2, int&amp; bar)\n{\n    return detail::foo(arg1, arg2, bar, detail::tag&lt;T&gt;{});\n}\n</code></pre>\n\n<h2><a href=\"https://wandbox.org/permlink/bQPkqY5b7NX9cvrQ\" rel=\"nofollow noreferrer\">Live Demo 3</a></h2>\n\n<hr>\n\n<h3>Method 4: Straightforward <code>constexpr if</code></h3>\n\n<p>Since C++17 we can use <code>if constexpr</code> blocks to make a compile-time check on a type. These are useful because if the check fails <em>the compiler doesn't compile that block at all</em>. This oftentimes leads to much easier code than before, where we had to use complicated indirection to classes or functions with advanced metaprogramming:</p>\n\n<pre><code>template &lt;class T&gt;\nvoid foo(const int arg1, const int arg2, int&amp; bar)\n{\n    if constexpr (std::is_same_v&lt;T, std::plus&lt;int&gt;&gt;)\n    {\n        arg1 &gt; arg2;\n        bar &gt; 0;\n        bar &gt; 10;\n    }\n    if constexpr(std::is_same_v&lt;T, std::minus&lt;int&gt;&gt;)\n    {\n        arg1 &lt; arg2;\n        bar &lt; 0;\n        bar &lt; -10;\n    }\n}\n</code></pre>\n\n<h2><a href=\"https://wandbox.org/permlink/bQPkqY5b7NX9cvrQ\" rel=\"nofollow noreferrer\">Live Demo 4</a></h2>\n\n<hr>\n\n<h3>Method 5: <code>constexpr</code> + trampolining</h3>\n\n<p><em>trampolining</em> is a metaprogramming technique where you use a \"trampoline\" function as an intermediary between the caller and the actual function you wish to dispatch to. Here we will use it to map to the appropriate comparison type (<code>std::greater</code> or <code>std::less</code>) as well as the integral constants we wish to compare <code>bar</code> to. It's a little more flexible than Method 4. It also separates concerns a bit, too. At the cost of readability:</p>\n\n<pre><code>namespace detail\n{\n    template&lt;class Cmp, int first, int second&gt;\n    void foo(const int arg1, const int arg2, int&amp; bar)\n    {\n        Cmp cmp{};\n        cmp(arg1, arg2);\n        cmp(bar, first);\n        cmp(bar, second);\n    }\n}\n\ntemplate &lt;class T&gt;\nvoid foo(const int arg1, const int arg2, int&amp; bar)\n{\n    if constexpr (std::is_same_v&lt;T, std::plus&lt;int&gt;&gt;)\n        return detail::foo&lt;std::greater&lt;int&gt;, 0, 10&gt;(arg1, arg2, bar);\n    if constexpr(std::is_same_v&lt;T, std::minus&lt;int&gt;&gt;)\n        return detail::foo&lt;std::less&lt;int&gt;, 0, -10&gt;(arg1, arg2, bar);\n}\n</code></pre>\n\n<h2><a href=\"https://wandbox.org/permlink/bjc3poGN7RtJk4vr\" rel=\"nofollow noreferrer\">Live Demo 5</a></h2>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 53750639, "answer_count": 2, "score": 2, "last_activity_date": 1544720012, "creation_date": 1544644589, "last_edit_date": 1544702975, "question_id": 53750460, "link": "https://stackoverflow.com/questions/53750460/can-i-write-relational-operators-in-terms-of-arithmetic-operations", "title": "Can I Write Relational Operators in Terms of Arithmetic Operations?", "body": "<p>So I have a fairly complex function:</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid foo(const int param1, const int param2, int&amp; out_param)\n</code></pre>\n\n<p>Given <code>int bar</code>, <code>const int arg1</code>, and <code>const int arg2</code> the function will be called with either: <code>foo&lt;plus&lt;int&gt;&gt;(arg1, arg2, bar)</code> or <code>foo&lt;minus&lt;int&gt;&gt;(arg1, arg2, bar)</code></p>\n\n<p>Internally the function is rather complex but I am doing different relational operators based on the type of functor that was passed as a template parameter.</p>\n\n<p>In the case of <code>plus</code> I need to do:</p>\n\n<ol>\n<li><code>arg1 &gt; arg2</code></li>\n<li><code>bar &gt; 0</code></li>\n<li><code>bar &gt; -10</code></li>\n</ol>\n\n<p>In the case of <code>minus</code> I need to do:</p>\n\n<ol>\n<li><code>arg1 &lt; arg2</code></li>\n<li><code>bar &lt; 0</code></li>\n<li><code>bar &lt; 10</code></li>\n</ol>\n\n<p>Note that <code>10</code> does not have the same sign in both <strong>3</strong>s. I am currently solving all this by passing a second template parameter (<code>less</code> or <code>greater</code>.) But I was thinking it might make more sense to write these relations as arithmetic operations. Is that even possible, or do I need to take the second template parameter?</p>\n"}, {"tags": ["c++", "apache-arrow"], "comments": [{"owner": {"reputation": 82394, "user_id": 776560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c08a3eed709a9d1a2654cea45aa466f?s=128&d=identicon&r=PG", "display_name": "Wes McKinney", "link": "https://stackoverflow.com/users/776560/wes-mckinney"}, "edited": false, "score": 0, "creation_date": 1544730794, "post_id": 53750405, "comment_id": 94390075, "body": "I strongly suggest asking this question (and future questions) on the dev@ mailing list instead of StackOverflow. Not many Arrow developers follow the tags here."}, {"owner": {"reputation": 2801, "user_id": 289784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ba7b17b968819e14a859ebccc86e59?s=128&d=identicon&r=PG", "display_name": "suvayu", "link": "https://stackoverflow.com/users/289784/suvayu"}, "reply_to_user": {"reputation": 82394, "user_id": 776560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c08a3eed709a9d1a2654cea45aa466f?s=128&d=identicon&r=PG", "display_name": "Wes McKinney", "link": "https://stackoverflow.com/users/776560/wes-mckinney"}, "edited": false, "score": 0, "creation_date": 1544734046, "post_id": 53750405, "comment_id": 94391464, "body": "Okay, thanks.  I&#39;ll repost on the dev list."}], "answers": [{"tags": [], "owner": {"reputation": 2801, "user_id": 289784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ba7b17b968819e14a859ebccc86e59?s=128&d=identicon&r=PG", "display_name": "suvayu", "link": "https://stackoverflow.com/users/289784/suvayu"}, "is_accepted": true, "score": 0, "last_activity_date": 1544811883, "creation_date": 1544811883, "answer_id": 53785049, "question_id": 53750405, "link": "https://stackoverflow.com/questions/53750405/access-gadiva-filter-result-by-index-in-apache-arrow/53785049#53785049", "title": "Access Gadiva filter result by index in Apache Arrow", "body": "<p>The <code>SelectionVector</code> stores indices, so the type is <code>unsigned</code>, the following works:</p>\n\n<pre><code>auto arr = std::dynamic_pointer_cast&lt;NumericArray&lt;UInt16Type&gt;&gt;(selected-&gt;ToArray());\n</code></pre>\n\n<p>Thanks to Ravindra on the Arrow dev list for <a href=\"http://mail-archives.apache.org/mod_mbox/arrow-dev/201812.mbox/%3C20181214145921.fjo73odrm2tgabar%40karna%3E\" rel=\"nofollow noreferrer\">the answer</a>.</p>\n"}], "owner": {"reputation": 2801, "user_id": 289784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ba7b17b968819e14a859ebccc86e59?s=128&d=identicon&r=PG", "display_name": "suvayu", "link": "https://stackoverflow.com/users/289784/suvayu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 1, "accepted_answer_id": 53785049, "answer_count": 1, "score": 0, "last_activity_date": 1544811883, "creation_date": 1544644351, "last_edit_date": 1544689283, "question_id": 53750405, "link": "https://stackoverflow.com/questions/53750405/access-gadiva-filter-result-by-index-in-apache-arrow", "title": "Access Gadiva filter result by index in Apache Arrow", "body": "<p>Maybe I'm missing something obvious, but for the life of me, I can't figure out how I can access the elements of an array after a Gandiva filter operation.</p>\n\n<p>I have linked a minimal example which I compile like this:</p>\n\n<pre><code>$ /usr/lib64/ccache/g++ -g -Wall -m64 -std=c++17 -pthread -fPIC \\\n      -I/opt/data-an/include  mwe.cc -o mwe \\\n      -L/opt/data-an/lib64 -lgandiva -larrow\n</code></pre>\n\n<p>and I then run the binary like this:</p>\n\n<pre><code>$ LD_LIBRARY_PATH=/opt/data-an/lib64 ./mwe\n</code></pre>\n\n<p>Broadly this is what I was attempting (followed by excerpts from the MWE):</p>\n\n<ol>\n<li><p>create a 5-element vector: 1, 3, 2, 4, 5</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int num_records = 5;\narrow::Int64Builder i64builder;\nArrayPtr array0;\n\nEXPECT_OK(i64builder.AppendValues({1, 3, 2, 4, 5}));\nEXPECT_OK(i64builder.Finish(&amp;array0));\n</code></pre></li>\n<li><p>use Gandiva to get even elements, indices: 2, 3</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// schema for input fields\nauto field0 = field(\"f0\", arrow::int64());\nauto schema = arrow::schema({field0});\n\n// even: f0 % 2 == 0\nauto field0_node = TreeExprBuilder::MakeField(field0);\nauto lit_2 = TreeExprBuilder::MakeLiteral(int64_t(2));\nauto remainder = TreeExprBuilder::MakeFunction(\"mod\", {field0_node, lit_2}, int64());\nauto lit_0 = TreeExprBuilder::MakeLiteral(int64_t(0));\nauto even = TreeExprBuilder::MakeFunction(\"equal\", {remainder, lit_0}, boolean());\nauto condition = TreeExprBuilder::MakeCondition(even);\n\n// input record batch\nauto in_batch = arrow::RecordBatch::Make(schema, num_records, {array0});\n\n// filter\nstd::shared_ptr&lt;Filter&gt; filter;\nEXPECT_OK(Filter::Make(schema, condition, &amp;filter));\n\nstd::shared_ptr&lt;SelectionVector&gt; selected;\nEXPECT_OK(SelectionVector::MakeInt16(num_records, pool_, &amp;selected));\nEXPECT_OK(filter-&gt;Evaluate(*in_batch, selected));\n</code></pre></li>\n<li><p>access the even elements in the original array by using the selection vector from the Gandiva filter as an index array</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// std::cout &lt;&lt; \"array0[0]: \" &lt;&lt; array0-&gt;Value(0); // doesn't compile\n// error: \u2018using element_type = class arrow::Array\u2019 {aka \u2018class\n// arrow::Array\u2019} has no member named \u2018Value\u2019\n\n// downcast it to the correct derived class\nauto array0_cast = std::dynamic_pointer_cast&lt;NumericArray&lt;Int64Type&gt;&gt;(array0);\nstd::cout &lt;&lt; \"array0[0]: \" &lt;&lt; array0_cast-&gt;Value(0) &lt;&lt; std::endl;\n</code></pre></li>\n</ol>\n\n<p>But I can't seem to access the elements of the <a href=\"https://arrow.apache.org/docs/cpp/classgandiva_1_1_selection_vector.html\" rel=\"nofollow noreferrer\">selection vector</a>.  Since it was declared as <code>std::shared_ptr&lt;arrow::Array&gt;</code>, the <code>Value(..)</code> method isn't found.  Since I filled it with <code>SelectionVector::MakeInt16(..)</code>, I tried downcasting to <code>arrow::NumericArray&lt;Int16Type&gt;</code>, but that fails!  I'm not sure where I'm going wrong.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto idx_arr_cast = std::dynamic_pointer_cast&lt;NumericArray&lt;Int16Type&gt;&gt;(idx_arr);\nif (idx_arr_cast) {\n  std::cout &lt;&lt; \"idx_arr[0]: \" &lt;&lt; idx_arr_cast-&gt;Value(0) &lt;&lt; std::endl;\n} else {\n  std::cerr &lt;&lt; \"idx_arr_cast is a nullptr!\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I also have a related, but more general question.  Given an array, I can't find a way to access the elements (or iterate over them) if I don't know the exact type.  If I know the type, I can downcast, and use the likes of <code>Value(..)</code>, <code>GetValue(..)</code>, <code>GetString(..)</code>, etc.  That seems quite round about just to access the elements.  What am I missing?</p>\n\n<p><strong>Note:</strong> The complete MWE, along with a Makefile, can be cloned from <a href=\"https://gist.github.com/suvayu/aa2d38cee82b97be76186ec00073fe10\" rel=\"nofollow noreferrer\">this gist</a>.</p>\n"}, {"tags": ["c++", "uml", "doxygen", "dot"], "comments": [{"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1544707088, "post_id": 53750399, "comment_id": 94377129, "body": "I have no idea why the methods are listed twice (from the conceptual point of view it is clear from the code), but it is done from the beginning (1.8.1) the UML diagram is supported. probably best to create an issue in the doxygen issue tracker: <a href=\"https://github.com/doxygen/doxygen/issues/new\" rel=\"nofollow noreferrer\">github.com/doxygen/doxygen/issues/new</a>"}, {"owner": {"reputation": 11, "user_id": 10782520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf36d70ba3f2a93c20ea38ad31056a2?s=128&d=identicon&r=PG&f=1", "display_name": "Weston", "link": "https://stackoverflow.com/users/10782520/weston"}, "reply_to_user": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1565801852, "post_id": 53750399, "comment_id": 101467649, "body": "I&#39;m still having similar problems. I have added this issue at <a href=\"https://github.com/doxygen/doxygen/issues/7197\" rel=\"nofollow noreferrer\">github.com/doxygen/doxygen/issues/7197</a>"}], "owner": {"reputation": 11, "user_id": 10782520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf36d70ba3f2a93c20ea38ad31056a2?s=128&d=identicon&r=PG&f=1", "display_name": "Weston", "link": "https://stackoverflow.com/users/10782520/weston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544687259, "creation_date": 1544644319, "last_edit_date": 1544687259, "question_id": 53750399, "link": "https://stackoverflow.com/questions/53750399/grouped-methods-in-class-uml-produced-by-doxygen-have-duplicates-with-asterisks", "title": "Grouped methods in class UML produced by Doxygen have duplicates with asterisks", "body": "<p>I try to generate UML in html documentation for the following class using doxygen/dot.</p>\n\n<pre><code>class MyClass\n{\npublic:\n\n    /**\n     * @name My Grouping\n     *\n     * description\n     */\n    // @{\n    void methodA();\n    void methodB();\n    // @}\n};\n</code></pre>\n\n<p>I specifically want to use grouping as described <a href=\"http://www.doxygen.nl/manual/grouping.html\" rel=\"nofollow noreferrer\">here</a>. But when I do so I get a UML diagram with 2 entries for each method, one of which has an asterisk in front:</p>\n\n<p><img src=\"https://i.stack.imgur.com/O8u60.png\" alt=\"see image\"></p>\n\n<p>Essentially I would like to remove the entries with the asterisks, but still do the grouping. Does anyone know how to do this?</p>\n\n<p>I am using doxygen 1.8.11 on Ubuntu 16.04.5 LTS.\nMy Doxyfile is <a href=\"https://drive.google.com/open?id=14-KgvY5Ig6wr7A0o_zAwtFKlUA0dXXum\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1544646710, "post_id": 53750286, "comment_id": 94354488, "body": "How do you want this output?"}], "answers": [{"comments": [{"owner": {"reputation": 4068, "user_id": 792589, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/863696978053d25d7e55920ebaa775d7?s=128&d=identicon&r=PG", "display_name": "aarelovich", "link": "https://stackoverflow.com/users/792589/aarelovich"}, "edited": false, "score": 0, "creation_date": 1544650474, "post_id": 53750969, "comment_id": 94356062, "body": "HAHAHAAH I tried setting it on each of the entries and on the list view but not on the actual combo box!! Thank you so much!!"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1544647066, "creation_date": 1544647066, "answer_id": 53750969, "question_id": 53750286, "link": "https://stackoverflow.com/questions/53750286/list-view-in-qml-appearing-below-other-objects-in-my-window/53750969#53750969", "title": "List View in QML appearing below other objects in my window", "body": "<p>You have to set <a href=\"http://doc.qt.io/qt-5/qml-qtquick-item.html#z-prop\" rel=\"nofollow noreferrer\">property z</a> to a high value with respect to the other items, for example <code>1</code> since the default z is <code>0</code>.</p>\n\n<pre><code>VMAutoCompleteComboBox{\n    id: diagDBDefaultCountry\n    z: 1 // &lt;--\n    // ...\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zl0iT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zl0iT.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 4068, "user_id": 792589, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/863696978053d25d7e55920ebaa775d7?s=128&d=identicon&r=PG", "display_name": "aarelovich", "link": "https://stackoverflow.com/users/792589/aarelovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 53750969, "answer_count": 1, "score": 1, "last_activity_date": 1544647066, "creation_date": 1544643805, "question_id": 53750286, "link": "https://stackoverflow.com/questions/53750286/list-view-in-qml-appearing-below-other-objects-in-my-window", "title": "List View in QML appearing below other objects in my window", "body": "<p>I've created a minimum working example to show my problem. What I'm trying to do is create a working list of countries that can be filtered as the user types input. This works perfectly except for one major drawback. The list view is drawn BELOW other elements in the screen. Here is the code for a MWE to illustrate my problem.</p>\n\n<p>My main.qml</p>\n\n<pre><code>import QtQuick 2.9\nimport QtQuick.Window 2.2\n\nWindow {\n    visible: true\n    width: 1280\n    height: 720\n    title: qsTr(\"MWE\")\n\n    Rectangle {\n        id: rect1\n        color: \"#ff0000\"\n        width: 440\n        height: 30\n        anchors.horizontalCenter: parent.horizontalCenter\n        anchors.top: parent.top\n        anchors.topMargin: 20\n    }\n\n    VMAutoCompleteComboBox{\n        id: diagDBDefaultCountry\n        width: 440\n        height: 30\n        vmList: {\n            var list = loader.getCountryList()\n            return list;\n        }\n        vmValues: loader.getCountryCodeList()\n        anchors.top: parent.top\n        anchors.topMargin: 70\n        anchors.horizontalCenter: parent.horizontalCenter\n    }\n\n    Rectangle {\n        id: rect2\n        color: \"#ff0000\"\n        width: 440\n        height: 30\n        anchors.horizontalCenter: parent.horizontalCenter\n        anchors.top: parent.top\n        anchors.topMargin: 120\n    }\n\n    Rectangle {\n        id: rect3\n        color: \"#ff0000\"\n        width: 440\n        height: 30\n        anchors.horizontalCenter: parent.horizontalCenter\n        anchors.top: parent.top\n        anchors.topMargin: 170\n    }\n\n}\n</code></pre>\n\n<p>My VMAutoCompleteComboBox.qml</p>\n\n<pre><code>import QtQuick 2.6\nimport QtQuick.Window 2.2\nimport QtQuick.Controls 2.1\n\nItem {\n\n    property string vmLabel : \"\"\n    property var vmList: []\n    property var vmValues: []\n    property int vmMaxOptions: 10\n\n    function filter(){\n\n        // Creating the model list\n        modelList.clear()\n\n        var count = 0;\n        for (var i = 0; i &lt; vmList.length; i++){\n           if ((vmList[i].toLowerCase().search(lineEdit.text.toLowerCase()) !== -1) || (lineEdit.text === \"\")){\n               var data = \"\";\n               if (i &lt; vmValues.length) data = vmValues[i];               \n               modelList.append({\"vmText\": vmList[i], \"vmData\": data, \"vmIndex\": count});\n               count++;\n               if (count == vmMaxOptions) break;\n           }\n        }\n\n        // Updating the height of the patient list.\n        listView.height = lineEditRect.height*(count+1);\n    }\n\n    Rectangle {\n        id: lineEditRect\n        anchors.fill: parent\n        color: \"#ebf3fa\"\n        border.width: 0\n        height: parent.height\n    }\n\n    ListModel {\n        id: modelList\n    }\n\n    Rectangle {\n        id: subLine\n        width: lineEditRect.width\n        height: 1;\n        border.color: \"#297fca\"\n        color: \"#297fca\"\n        anchors.bottom: lineEditRect.bottom\n    }\n\n    TextInput {\n        property bool vmFilterEnable: true\n        id: lineEdit\n        font.pixelSize: 13\n        anchors.bottom: subLine.top\n        anchors.bottomMargin: 5\n        verticalAlignment: TextInput.AlignVCenter\n        leftPadding: 5\n        width: lineEditRect.width\n        onTextChanged: {\n            if (!vmFilterEnable ) return;\n            filter();\n        }\n        onCursorVisibleChanged: {\n            if (cursorVisible) filter();\n        }\n    }\n\n    Text{\n        id: labelText\n        text: vmLabel\n        color:  \"#297fca\"\n        font.pixelSize: 11\n        anchors.left: lineEditRect.left\n        anchors.bottom: lineEdit.top\n        anchors.bottomMargin: 5\n        visible: (vmLabel != \"\")\n    }\n\n    ListView {\n        id: listView\n        width: parent.width\n        model: modelList\n        anchors.top: lineEditRect.bottom\n        anchors.left: lineEditRect.left\n        layer.enabled: true\n        clip: true\n        delegate: VMAutoCompleteCBEntry {\n            width: lineEditRect.width\n            height: lineEditRect.height\n            layer.enabled: true\n            clip: true\n            onClicked: {\n                console.log(\"Clicked on text: \" + text + \" that has data \" + data + \" with index \" + index);\n            }\n        }\n    }\n\n}\n</code></pre>\n\n<p>And finally my VMAutoCompleteCBEntry</p>\n\n<pre><code>import QtQuick 2.6\n\nRectangle {\n\n    signal clicked(string text, string data, int index);\n\n    id: contentRect\n    color: mouseDetect.containsMouse? \"#cfcfcf\" : \"#ffffff\"\n    border.width: 1\n    border.color: \"#cfcfcf\"\n    z: 10\n\n    MouseArea {\n        id: mouseDetect\n        hoverEnabled: true\n        anchors.fill: parent\n        onClicked: contentRect.clicked(vmText,vmData,vmIndex);\n    }\n\n    Text {\n        id: contentText\n        text: vmText\n        //color: (labelText.visible)? \"#58595b\" : \"#cfcfcf\"\n        color: \"#202020\"\n        //font.family: viewHome.robotoR.name\n        font.pixelSize: 13\n        verticalAlignment: TextInput.AlignVCenter\n        anchors.verticalCenter: contentRect.verticalCenter\n        leftPadding: 5\n    }\n\n}\n</code></pre>\n\n<p>I will provide all other files in my project in order to provide a complete MWE. However the only purpose of most of the code below is just to provide a stringlist of country names and ISO country codes.</p>\n\n<p>My countries.h</p>\n\n<pre><code>#ifndef COUNTRIES_H\n#define COUNTRIES_H\n\n#include &lt;QStringList&gt;\n\nstruct CountryStruct {\n\npublic:\n    void fillCountryList(bool inEnglish = true) {\n        if (COUNTRY_CODE.size() != 0) return;\n        /// TODO: Get the country list in spanish.\n        if ((inEnglish) || (!inEnglish)){\n            COUNTRY_LIST &lt;&lt;  \"Afghanistan\" &lt;&lt; \"\u00c5land Islands\" &lt;&lt; \"Albania\" &lt;&lt; \"Algeria\" &lt;&lt; \"American Samoa\" &lt;&lt; \"Andorra\" &lt;&lt; \"Angola\" &lt;&lt; \"Anguilla\" &lt;&lt; \"Antarctica\"\n                          &lt;&lt; \"Antigua and Barbuda\" &lt;&lt; \"Argentina\" &lt;&lt; \"Armenia\" &lt;&lt; \"Aruba\" &lt;&lt; \"Australia\" &lt;&lt; \"Austria\" &lt;&lt; \"Azerbaijan\" &lt;&lt; \"Bahamas\" &lt;&lt; \"Bahrain\"\n                          &lt;&lt; \"Bangladesh\" &lt;&lt; \"Barbados\" &lt;&lt; \"Belarus\" &lt;&lt; \"Belgium\" &lt;&lt; \"Belize\" &lt;&lt; \"Benin\" &lt;&lt; \"Bermuda\" &lt;&lt; \"Bhutan\" &lt;&lt; \"Bolivia, Plurinational State of\"\n                          &lt;&lt; \"Bonaire, Sint Eustatius and Saba\" &lt;&lt; \"Bosnia and Herzegovina\" &lt;&lt; \"Botswana\" &lt;&lt; \"Bouvet Island\" &lt;&lt; \"Brazil\" &lt;&lt; \"British Indian Ocean Territory\"\n                          &lt;&lt; \"Brunei Darussalam\" &lt;&lt; \"Bulgaria\" &lt;&lt; \"Burkina Faso\" &lt;&lt; \"Burundi\" &lt;&lt; \"Cambodia\" &lt;&lt; \"Cameroon\" &lt;&lt; \"Canada\" &lt;&lt; \"Cape Verde\" &lt;&lt; \"Cayman Islands\"\n                          &lt;&lt; \"Central African Republic\" &lt;&lt; \"Chad\" &lt;&lt; \"Chile\" &lt;&lt; \"China\" &lt;&lt; \"Christmas Island\" &lt;&lt; \"Cocos (Keeling) Islands\" &lt;&lt; \"Colombia\" &lt;&lt; \"Comoros\" &lt;&lt; \"Congo\"\n                          &lt;&lt; \"Congo, the Democratic Republic of the\" &lt;&lt; \"Cook Islands\" &lt;&lt; \"Costa Rica\" &lt;&lt; \"C\u00f4te d'Ivoire\" &lt;&lt; \"Croatia\" &lt;&lt; \"Cuba\" &lt;&lt; \"Cura\u00e7ao\" &lt;&lt; \"Cyprus\"\n                          &lt;&lt; \"Czech Republic\" &lt;&lt; \"Denmark\" &lt;&lt; \"Djibouti\" &lt;&lt; \"Dominica\" &lt;&lt; \"Dominican Republic\" &lt;&lt; \"Ecuador\" &lt;&lt; \"Egypt\" &lt;&lt; \"El Salvador\" &lt;&lt; \"Equatorial Guinea\"\n                          &lt;&lt; \"Eritrea\" &lt;&lt; \"Estonia\" &lt;&lt; \"Ethiopia\" &lt;&lt; \"Falkland Islands (Malvinas)\" &lt;&lt; \"Faroe Islands\" &lt;&lt; \"Fiji\" &lt;&lt; \"Finland\" &lt;&lt; \"France\" &lt;&lt; \"French Guiana\"\n                          &lt;&lt; \"French Polynesia\" &lt;&lt; \"French Southern Territories\" &lt;&lt; \"Gabon\" &lt;&lt; \"Gambia\" &lt;&lt; \"Georgia\" &lt;&lt; \"Germany\" &lt;&lt; \"Ghana\" &lt;&lt; \"Gibraltar\" &lt;&lt; \"Greece\"\n                          &lt;&lt; \"Greenland\" &lt;&lt; \"Grenada\" &lt;&lt; \"Guadeloupe\" &lt;&lt; \"Guam\" &lt;&lt; \"Guatemala\" &lt;&lt; \"Guernsey\" &lt;&lt; \"Guinea\" &lt;&lt; \"Guinea-Bissau\" &lt;&lt; \"Guyana\" &lt;&lt; \"Haiti\"\n                          &lt;&lt; \"Heard Island and McDonald Islands\" &lt;&lt; \"Holy See (Vatican City State)\" &lt;&lt; \"Honduras\" &lt;&lt; \"Hong Kong\" &lt;&lt; \"Hungary\" &lt;&lt; \"Iceland\" &lt;&lt; \"India\"\n                          &lt;&lt; \"Indonesia\" &lt;&lt; \"Iran, Islamic Republic of\" &lt;&lt; \"Iraq\" &lt;&lt; \"Ireland\" &lt;&lt; \"Isle of Man\" &lt;&lt; \"Israel\" &lt;&lt; \"Italy\" &lt;&lt; \"Jamaica\" &lt;&lt; \"Japan\" &lt;&lt; \"Jersey\"\n                          &lt;&lt; \"Jordan\" &lt;&lt; \"Kazakhstan\" &lt;&lt; \"Kenya\" &lt;&lt; \"Kiribati\" &lt;&lt; \"Korea, Democratic People's Republic of\" &lt;&lt; \"Korea, Republic of\" &lt;&lt; \"Kuwait\" &lt;&lt; \"Kyrgyzstan\"\n                          &lt;&lt; \"Lao People's Democratic Republic\" &lt;&lt; \"Latvia\" &lt;&lt; \"Lebanon\" &lt;&lt; \"Lesotho\" &lt;&lt; \"Liberia\" &lt;&lt; \"Libya\" &lt;&lt; \"Liechtenstein\" &lt;&lt; \"Lithuania\" &lt;&lt; \"Luxembourg\"\n                          &lt;&lt; \"Macao\" &lt;&lt; \"Macedonia, the former Yugoslav Republic of\" &lt;&lt; \"Madagascar\" &lt;&lt; \"Malawi\" &lt;&lt; \"Malaysia\" &lt;&lt; \"Maldives\" &lt;&lt; \"Mali\" &lt;&lt; \"Malta\"\n                          &lt;&lt; \"Marshall Islands\" &lt;&lt; \"Martinique\" &lt;&lt; \"Mauritania\" &lt;&lt; \"Mauritius\" &lt;&lt; \"Mayotte\" &lt;&lt; \"Mexico\" &lt;&lt; \"Micronesia, Federated States of\"\n                          &lt;&lt; \"Moldova, Republic of\" &lt;&lt; \"Monaco\" &lt;&lt; \"Mongolia\" &lt;&lt; \"Montenegro\" &lt;&lt; \"Montserrat\" &lt;&lt; \"Morocco\" &lt;&lt; \"Mozambique\" &lt;&lt; \"Myanmar\" &lt;&lt; \"Namibia\" &lt;&lt; \"Nauru\"\n                          &lt;&lt; \"Nepal\" &lt;&lt; \"Netherlands\" &lt;&lt; \"New Caledonia\" &lt;&lt; \"New Zealand\" &lt;&lt; \"Nicaragua\" &lt;&lt; \"Niger\" &lt;&lt; \"Nigeria\" &lt;&lt; \"Niue\" &lt;&lt; \"Norfolk Island\"\n                          &lt;&lt; \"Northern Mariana Islands\" &lt;&lt; \"Norway\" &lt;&lt; \"Oman\" &lt;&lt; \"Pakistan\" &lt;&lt; \"Palau\" &lt;&lt; \"Palestinian Territory, Occupied\" &lt;&lt; \"Panama\" &lt;&lt; \"Papua New Guinea\"\n                          &lt;&lt; \"Paraguay\" &lt;&lt; \"Peru\" &lt;&lt; \"Philippines\" &lt;&lt; \"Pitcairn\" &lt;&lt; \"Poland\" &lt;&lt; \"Portugal\" &lt;&lt; \"Puerto Rico\" &lt;&lt; \"Qatar\" &lt;&lt; \"R\u00e9union\" &lt;&lt; \"Romania\"\n                          &lt;&lt; \"Russian Federation\" &lt;&lt; \"Rwanda\" &lt;&lt; \"Saint Barth\u00e9lemy\" &lt;&lt; \"Saint Helena, Ascension and Tristan da Cunha\" &lt;&lt; \"Saint Kitts and Nevis\" &lt;&lt; \"Saint Lucia\"\n                          &lt;&lt; \"Saint Martin (French part)\" &lt;&lt; \"Saint Pierre and Miquelon\" &lt;&lt; \"Saint Vincent and the Grenadines\" &lt;&lt; \"Samoa\" &lt;&lt; \"San Marino\" &lt;&lt; \"Sao Tome and Principe\"\n                          &lt;&lt; \"Saudi Arabia\" &lt;&lt; \"Scotland\" &lt;&lt; \"Senegal\" &lt;&lt; \"Serbia\" &lt;&lt; \"Seychelles\" &lt;&lt; \"Sierra Leone\" &lt;&lt; \"Singapore\" &lt;&lt; \"Sint Maarten (Dutch part)\" &lt;&lt; \"Slovakia\" &lt;&lt; \"Slovenia\"\n                          &lt;&lt; \"Solomon Islands\" &lt;&lt; \"Somalia\" &lt;&lt; \"South Africa\" &lt;&lt; \"South Georgia and the South Sandwich Islands\" &lt;&lt; \"South Sudan\" &lt;&lt; \"Spain\" &lt;&lt; \"Sri Lanka\" &lt;&lt; \"Sudan\"\n                          &lt;&lt; \"Suriname\" &lt;&lt; \"Svalbard and Jan Mayen\" &lt;&lt; \"Swaziland\" &lt;&lt; \"Sweden\" &lt;&lt; \"Switzerland\" &lt;&lt; \"Syrian Arab Republic\" &lt;&lt; \"Taiwan, Province of China\"\n                          &lt;&lt; \"Tajikistan\" &lt;&lt; \"Tanzania, United Republic of\" &lt;&lt; \"Thailand\" &lt;&lt; \"Timor-Leste\" &lt;&lt; \"Togo\" &lt;&lt; \"Tokelau\" &lt;&lt; \"Tonga\" &lt;&lt; \"Trinidad and Tobago\" &lt;&lt; \"Tunisia\"\n                          &lt;&lt; \"Turkey\" &lt;&lt; \"Turkmenistan\" &lt;&lt; \"Turks and Caicos Islands\" &lt;&lt; \"Tuvalu\" &lt;&lt; \"Uganda\" &lt;&lt; \"Ukraine\" &lt;&lt; \"United Arab Emirates\" &lt;&lt; \"United Kingdom\"\n                          &lt;&lt; \"United States\" &lt;&lt; \"United States Minor Outlying Islands\" &lt;&lt; \"Uruguay\" &lt;&lt; \"Uzbekistan\" &lt;&lt; \"Vanuatu\" &lt;&lt; \"Venezuela, Bolivarian Republic of\" &lt;&lt; \"Viet Nam\"\n                          &lt;&lt; \"Virgin Islands, British\" &lt;&lt; \"Virgin Islands, U.S.\" &lt;&lt; \"Wallis and Futuna\" &lt;&lt; \"Western Sahara\" &lt;&lt; \"Yemen\" &lt;&lt; \"Zambia\" &lt;&lt; \"Zimbabwe\";\n        }\n        /// TODO: Get the country list in english\n        else return;\n\n        COUNTRY_CODE &lt;&lt; \"AF\" &lt;&lt; \"AX\" &lt;&lt; \"AL\" &lt;&lt; \"DZ\" &lt;&lt; \"AS\" &lt;&lt; \"AD\" &lt;&lt; \"AO\" &lt;&lt; \"AI\" &lt;&lt; \"AQ\" &lt;&lt; \"AG\" &lt;&lt; \"AR\" &lt;&lt; \"AM\" &lt;&lt; \"AW\" &lt;&lt; \"AU\" &lt;&lt; \"AT\" &lt;&lt; \"AZ\"\n                     &lt;&lt; \"BS\" &lt;&lt; \"BH\" &lt;&lt; \"BD\" &lt;&lt; \"BB\" &lt;&lt; \"BY\" &lt;&lt; \"BE\" &lt;&lt; \"BZ\" &lt;&lt; \"BJ\" &lt;&lt; \"BM\" &lt;&lt; \"BT\" &lt;&lt; \"BO\" &lt;&lt; \"BQ\" &lt;&lt; \"BA\" &lt;&lt; \"BW\" &lt;&lt; \"BV\" &lt;&lt; \"BR\"\n                     &lt;&lt; \"IO\" &lt;&lt; \"BN\" &lt;&lt; \"BG\" &lt;&lt; \"BF\" &lt;&lt; \"BI\" &lt;&lt; \"KH\" &lt;&lt; \"CM\" &lt;&lt; \"CA\" &lt;&lt; \"CV\" &lt;&lt; \"KY\" &lt;&lt; \"CF\" &lt;&lt; \"TD\" &lt;&lt; \"CL\" &lt;&lt; \"CN\" &lt;&lt; \"CX\" &lt;&lt; \"CC\"\n                     &lt;&lt; \"CO\" &lt;&lt; \"KM\" &lt;&lt; \"CG\" &lt;&lt; \"CD\" &lt;&lt; \"CK\" &lt;&lt; \"CR\" &lt;&lt; \"CI\" &lt;&lt; \"HR\" &lt;&lt; \"CU\" &lt;&lt; \"CW\" &lt;&lt; \"CY\" &lt;&lt; \"CZ\" &lt;&lt; \"DK\" &lt;&lt; \"DJ\" &lt;&lt; \"DM\" &lt;&lt; \"DO\"\n                     &lt;&lt; \"EC\" &lt;&lt; \"EG\" &lt;&lt; \"SV\" &lt;&lt; \"GQ\" &lt;&lt; \"ER\" &lt;&lt; \"EE\" &lt;&lt; \"ET\" &lt;&lt; \"FK\" &lt;&lt; \"FO\" &lt;&lt; \"FJ\" &lt;&lt; \"FI\" &lt;&lt; \"FR\" &lt;&lt; \"GF\" &lt;&lt; \"PF\" &lt;&lt; \"TF\" &lt;&lt; \"GA\"\n                     &lt;&lt; \"GM\" &lt;&lt; \"GE\" &lt;&lt; \"DE\" &lt;&lt; \"GH\" &lt;&lt; \"GI\" &lt;&lt; \"GR\" &lt;&lt; \"GL\" &lt;&lt; \"GD\" &lt;&lt; \"GP\" &lt;&lt; \"GU\" &lt;&lt; \"GT\" &lt;&lt; \"GG\" &lt;&lt; \"GN\" &lt;&lt; \"GW\" &lt;&lt; \"GY\" &lt;&lt; \"HT\"\n                     &lt;&lt; \"HM\" &lt;&lt; \"VA\" &lt;&lt; \"HN\" &lt;&lt; \"HK\" &lt;&lt; \"HU\" &lt;&lt; \"IS\" &lt;&lt; \"IN\" &lt;&lt; \"ID\" &lt;&lt; \"IR\" &lt;&lt; \"IQ\" &lt;&lt; \"IE\" &lt;&lt; \"IM\" &lt;&lt; \"IL\" &lt;&lt; \"IT\" &lt;&lt; \"JM\" &lt;&lt; \"JP\"\n                     &lt;&lt; \"JE\" &lt;&lt; \"JO\" &lt;&lt; \"KZ\" &lt;&lt; \"KE\" &lt;&lt; \"KI\" &lt;&lt; \"KP\" &lt;&lt; \"KR\" &lt;&lt; \"KW\" &lt;&lt; \"KG\" &lt;&lt; \"LA\" &lt;&lt; \"LV\" &lt;&lt; \"LB\" &lt;&lt; \"LS\" &lt;&lt; \"LR\" &lt;&lt; \"LY\" &lt;&lt; \"LI\"\n                     &lt;&lt; \"LT\" &lt;&lt; \"LU\" &lt;&lt; \"MO\" &lt;&lt; \"MK\" &lt;&lt; \"MG\" &lt;&lt; \"MW\" &lt;&lt; \"MY\" &lt;&lt; \"MV\" &lt;&lt; \"ML\" &lt;&lt; \"MT\" &lt;&lt; \"MH\" &lt;&lt; \"MQ\" &lt;&lt; \"MR\" &lt;&lt; \"MU\" &lt;&lt; \"YT\" &lt;&lt; \"MX\"\n                     &lt;&lt; \"FM\" &lt;&lt; \"MD\" &lt;&lt; \"MC\" &lt;&lt; \"MN\" &lt;&lt; \"ME\" &lt;&lt; \"MS\" &lt;&lt; \"MA\" &lt;&lt; \"MZ\" &lt;&lt; \"MM\" &lt;&lt; \"NA\" &lt;&lt; \"NR\" &lt;&lt; \"NP\" &lt;&lt; \"NL\" &lt;&lt; \"NC\" &lt;&lt; \"NZ\" &lt;&lt; \"NI\"\n                     &lt;&lt; \"NE\" &lt;&lt; \"NG\" &lt;&lt; \"NU\" &lt;&lt; \"NF\" &lt;&lt; \"MP\" &lt;&lt; \"NO\" &lt;&lt; \"OM\" &lt;&lt; \"PK\" &lt;&lt; \"PW\" &lt;&lt; \"PS\" &lt;&lt; \"PA\" &lt;&lt; \"PG\" &lt;&lt; \"PY\" &lt;&lt; \"PE\" &lt;&lt; \"PH\" &lt;&lt; \"PN\"\n                     &lt;&lt; \"PL\" &lt;&lt; \"PT\" &lt;&lt; \"PR\" &lt;&lt; \"QA\" &lt;&lt; \"RE\" &lt;&lt; \"RO\" &lt;&lt; \"RU\" &lt;&lt; \"RW\" &lt;&lt; \"BL\" &lt;&lt; \"SH\" &lt;&lt; \"KN\" &lt;&lt; \"LC\" &lt;&lt; \"MF\" &lt;&lt; \"PM\" &lt;&lt; \"VC\" &lt;&lt; \"WS\"\n                     &lt;&lt; \"SM\" &lt;&lt; \"ST\" &lt;&lt; \"SA\" &lt;&lt; \"SQ\" &lt;&lt; \"SN\" &lt;&lt; \"RS\" &lt;&lt; \"SC\" &lt;&lt; \"SL\" &lt;&lt; \"SG\" &lt;&lt; \"SX\" &lt;&lt; \"SK\" &lt;&lt; \"SI\" &lt;&lt; \"SB\" &lt;&lt; \"SO\" &lt;&lt; \"ZA\" &lt;&lt; \"GS\"\n                     &lt;&lt; \"SS\" &lt;&lt; \"ES\" &lt;&lt; \"LK\" &lt;&lt; \"SD\" &lt;&lt; \"SR\" &lt;&lt; \"SJ\" &lt;&lt; \"SZ\" &lt;&lt; \"SE\" &lt;&lt; \"CH\" &lt;&lt; \"SY\" &lt;&lt; \"TW\" &lt;&lt; \"TJ\" &lt;&lt; \"TZ\" &lt;&lt; \"TH\" &lt;&lt; \"TL\" &lt;&lt; \"TG\"\n                     &lt;&lt; \"TK\" &lt;&lt; \"TO\" &lt;&lt; \"TT\" &lt;&lt; \"TN\" &lt;&lt; \"TR\" &lt;&lt; \"TM\" &lt;&lt; \"TC\" &lt;&lt; \"TV\" &lt;&lt; \"UG\" &lt;&lt; \"UA\" &lt;&lt; \"AE\" &lt;&lt; \"GB\" &lt;&lt; \"US\" &lt;&lt; \"UM\" &lt;&lt; \"UY\" &lt;&lt; \"UZ\"\n                     &lt;&lt; \"VU\" &lt;&lt; \"VE\" &lt;&lt; \"VN\" &lt;&lt; \"VG\" &lt;&lt; \"VI\" &lt;&lt; \"WF\" &lt;&lt; \"EH\" &lt;&lt; \"YE\" &lt;&lt; \"ZM\" &lt;&lt; \"ZW\";\n\n    }\n\n    QString getCodeForCountry(const QString &amp;country){\n        int index = COUNTRY_LIST.indexOf(country);\n        if (index == -1) return \"\";\n        else return COUNTRY_CODE.at(index);\n    }\n\n    QString getCountrFromCode (const QString &amp;code){\n        int index = COUNTRY_CODE.indexOf(code);\n        if (index == -1)  return \"\";\n        else return COUNTRY_LIST.at(index);\n    }\n\n    qint32 getIndexFromCode(const QString &amp;countryCode){\n        return COUNTRY_CODE.indexOf(countryCode);\n    }\n\n    QString getCodeFromIndex (int index){\n        if (index == -1)  return \"\";\n        else return COUNTRY_CODE.at(index);\n    }\n\n    QStringList getCountryList() const {return COUNTRY_LIST;}\n    QStringList getCodeList() const {return COUNTRY_CODE;}\n\nprivate:\n    QStringList COUNTRY_LIST;\n    QStringList COUNTRY_CODE;\n\n\n};\n\n#endif // COUNTRIES_H\n</code></pre>\n\n<p>My loader.h</p>\n\n<pre><code>#ifndef LOADER_H\n#define LOADER_H\n\n#include &lt;QObject&gt;\n#include &lt;QUrl&gt;\n#include &lt;QQuickWindow&gt;\n\n#include \"countries.h\"\n\n\nclass Loader : public QObject\n{\n    Q_OBJECT\npublic:\n    explicit Loader(QObject *parent = nullptr, CountryStruct *cs = nullptr);\n    ~Loader();\n    Q_INVOKABLE QStringList getCountryList() {return countries-&gt;getCountryList();}\n    Q_INVOKABLE QStringList getCountryCodeList() {return countries-&gt;getCodeList();}\nsignals:\n\npublic slots:\n\nprivate:\n    // The list of countries and their codes.\n    CountryStruct *countries;\n};\n\n#endif // LOADER_H\n</code></pre>\n\n<p>My loader.cpp</p>\n\n<pre><code>#include \"loader.h\"\n\nLoader::Loader(QObject *parent, CountryStruct *cs) : QObject(parent)\n{\n    countries = cs;\n    countries-&gt;fillCountryList();\n}\n\nLoader::~Loader(){\n\n}\n</code></pre>\n\n<p>And finally my main.cpp</p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include &lt;QQmlContext&gt;\n#include \"loader.h\"\n\nCountryStruct countries;\n\nint main(int argc, char *argv[])\n{\n#if defined(Q_OS_WIN)\n    QCoreApplication::setAttribute(Qt::AA_EnableHighDpiScaling);\n#endif\n\n    QGuiApplication app(argc, argv);\n\n    QQmlApplicationEngine engine;\n\n    Loader loader(nullptr,&amp;countries);\n    engine.rootContext()-&gt;setContextProperty(\"loader\", &amp;loader);\n\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n    if (engine.rootObjects().isEmpty())\n        return -1;\n\n    return app.exec();\n}\n</code></pre>\n\n<p>This was compiled with MSVC2015 32bits (as is required by the actual project where this is from) using Qt 5.9</p>\n\n<p>The problem is illustrated in the picture below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9zkpt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9zkpt.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "static", "function-pointers", "functor", "member-functions"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1544647011, "post_id": 53750251, "comment_id": 94354625, "body": "Calling it could look strange: <code>my_functor::()</code>."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1544647261, "post_id": 53750251, "comment_id": 94354719, "body": "@PeteBecker Yeah I closed this when I read the linked questions answers. It looks like this has been explicitly disallowed by C++. So yeah, none of that strange look in C++!"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1544643770, "answer_count": 0, "score": 2, "last_activity_date": 1544643606, "creation_date": 1544643606, "question_id": 53750251, "link": "https://stackoverflow.com/questions/53750251/c-standard-functors-have-non-static-operators", "closed_reason": "Duplicate", "title": "C++ Standard Functors Have Non-Static Operators", "body": "<p>So I notice that C++ functors, such as <code>plus</code> have non-<code>static</code> operators: <a href=\"https://en.cppreference.com/w/cpp/utility/functional/plus#Member_functions\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/utility/functional/plus#Member_functions</a></p>\n\n<p>Because the <code>template &lt;typename T&gt; T plus::operator()(const T&amp;, const T&amp;)</code> is non-<code>static</code> I can not pass it or assign it to a function pointer.</p>\n\n<p>For example I just want to be able to assign <code>plus&lt;int&gt;::operator()</code> to:</p>\n\n<pre><code>int (*foo)(const int&amp;, const int&amp;)\n</code></pre>\n\n<p>But I cannot because it is a member function. Obviously I can write a lambda here to do this, I just wanted to know if there had been any discussion on making the <code>operator()</code> <code>static</code>.</p>\n"}, {"tags": ["c++", "smart-pointers"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544642880, "post_id": 53750040, "comment_id": 94352752, "body": "What stops the user from saying <code>char x[100]; func(x);</code>?  There is no heap involvement there.  Maybe your <code>func</code> function shouldn&#39;t do too much hand-holding -- let the caller handle the memory."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1544642894, "post_id": 53750040, "comment_id": 94352761, "body": "Is <code>func</code> going to participate in the ownership of the pointer or is it just viewing it&#39;s contents?"}, {"owner": {"reputation": 81, "user_id": 9733085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47c35fd964e021148df97c72899c4c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Seeker", "link": "https://stackoverflow.com/users/9733085/seeker"}, "edited": false, "score": 0, "creation_date": 1544643038, "post_id": 53750040, "comment_id": 94352825, "body": "That is up to the caller, it may be on stack or heap but can I use a smart pointer instead of raw pointer"}, {"owner": {"reputation": 81, "user_id": 9733085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47c35fd964e021148df97c72899c4c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Seeker", "link": "https://stackoverflow.com/users/9733085/seeker"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1544643190, "post_id": 53750040, "comment_id": 94352912, "body": "@NathanOliver it is going to view and doesn&#39;t own"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1544643451, "post_id": 53750040, "comment_id": 94353067, "body": "@Deepak If it isn&#39;t going to participate in ownership then accepting a raw pointer is fine.  Just don&#39;t hold on to it for later or pass it up out of the scope of the thing that does own it."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1544643601, "post_id": 53750040, "comment_id": 94353135, "body": "I think it&#39;s not possible to use a smart pointer at this place. A shared pointer counts owners and whe the number of owners gets to zero (at end of your function) the memory is freed. So your function would delete memory that should be managed from outside"}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1544643698, "post_id": 53750040, "comment_id": 94353191, "body": "1. It looks to me like it is not clear to you who must own the data. 2. Don&#39;t use <code>std</code> in API. If you use it, you must be sure the client is using the same &#39;std&#39; library &amp; compiler."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1544644270, "post_id": 53750040, "comment_id": 94353472, "body": "It depends on circumstances but I would be tempted to use <code>std::vector&lt;char&gt; const&amp; data</code> because something has to own that data and containers are usually preferable. I would also be tempted to use <code>std::byte</code> rather than <code>char</code> for binary data."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1544643265, "post_id": 53750151, "comment_id": 94352960, "body": "The problem with giving up ownership and taking it back is that makes it hard to have exception-safe code. If your function throws, that object is hard to recover."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1544643462, "post_id": 53750151, "comment_id": 94353074, "body": "@Fran&#231;oisAndrieux I&#39;ve never needed to recover an object in that situation, but I suppose you have a point. In my cases it would just get thrown away anyway."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 1, "last_activity_date": 1544643215, "creation_date": 1544643215, "answer_id": 53750151, "question_id": 53750040, "link": "https://stackoverflow.com/questions/53750040/how-to-replace-char-using-smart-pointers/53750151#53750151", "title": "How to replace char* using smart pointers?", "body": "<p>If <code>func</code> simply observes the data without changing it, have it accept a <code>const char *</code>. The caller can store the pointer in any smart pointer, and use the <code>get()</code> function to get a bare pointer to pass to <code>func</code>.</p>\n\n<p>If <code>func</code> changes the data, I like to steal ideas from Rust and pass in a <code>std::unique_ptr</code> and return a <code>std::unique_ptr</code>. The caller passes away ownership and then receives back ownership of a pointer, but possibly a completely different pointer. And it doesn't matter.</p>\n\n<p>If <code>func</code> has to modify the data and it has to accept a <code>char *</code> then just use <code>get()</code> as before from any smart pointer that you want. As long as <code>func</code> does not store the pointer somewhere nothing will break.</p>\n"}], "owner": {"reputation": 81, "user_id": 9733085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47c35fd964e021148df97c72899c4c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Seeker", "link": "https://stackoverflow.com/users/9733085/seeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544643215, "creation_date": 1544642816, "question_id": 53750040, "link": "https://stackoverflow.com/questions/53750040/how-to-replace-char-using-smart-pointers", "title": "How to replace char* using smart pointers?", "body": "<p>I have to expose an API which takes a char* as input argument. The char* points to a chunk of binary data on heap. In this case the caller have to manage the memory allocation and deletion.</p>\n\n<p>Is there a way that I could use a shared_ptr as input argument instead of a raw pointer. </p>\n\n<pre><code>void func(char* data)\n{\n   //some operation\n}\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors", "clang", "compiler-warnings"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 0, "last_activity_date": 1544642719, "creation_date": 1544642719, "answer_id": 53750023, "question_id": 53749946, "link": "https://stackoverflow.com/questions/53749946/turn-warnings-into-error-only-within-supplied-diff/53750023#53750023", "title": "Turn warnings into error only within supplied diff", "body": "<p>If I had to implement that, my first idea would be:</p>\n\n<ol>\n<li>Get merged file.</li>\n<li>Analyze diff to figure out which regions were changed.</li>\n<li>Generate a new file and inject <code>#pragma</code> directives<sup>1</sup> that locally enable/disable warnings around the changed regions.</li>\n<li>Also inject <code>#line</code> directives to make it look like warnings/errors are coming from the original file.</li>\n<li>Compile modified file and save compiler warnings/errors.</li>\n<li>Delete modified file.</li>\n<li>Present compiler diagnostics to the user.</li>\n</ol>\n\n<hr>\n\n<p><sup>1</sup> E.g. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html#Diagnostic-Pragmas\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html#Diagnostic-Pragmas</a> for GCC.</p>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": -1, "last_activity_date": 1544642736, "creation_date": 1544642736, "answer_id": 53750026, "question_id": 53749946, "link": "https://stackoverflow.com/questions/53749946/turn-warnings-into-error-only-within-supplied-diff/53750026#53750026", "title": "Turn warnings into error only within supplied diff", "body": "<p>Clang supports GCC's <a href=\"https://clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-via-pragmas\" rel=\"nofollow noreferrer\"><code>#pragma diagnostic</code></a>.</p>\n\n<p>For example:</p>\n\n<pre><code>#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wuninitialized\"\n\n// ... changed code here ...\n\n#pragma GCC diagnostic pop\n</code></pre>\n\n<p>MSVC also has something similar:</p>\n\n<pre><code>#pragma warning(push, 3)\n// ... changed code here ...\n#pragma warning(pop)\n</code></pre>\n"}], "owner": {"reputation": 9769, "user_id": 595605, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3b71ec2390b9ed0035f73222eb1bfa72?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/595605/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1544642736, "creation_date": 1544642336, "question_id": 53749946, "link": "https://stackoverflow.com/questions/53749946/turn-warnings-into-error-only-within-supplied-diff", "title": "Turn warnings into error only within supplied diff", "body": "<p>At a company I used to work at, the build system was set up to turn warnings into errors only within changed code. It worked by supplying generating a diff (typically between the branch you were trying to merge and <code>master</code> and then supplying that diff to some compilation tool, and the tool would produce warnings only within the supplied diff.</p>\n\n<p>This was great as it allowed you to e.g. deprecate some function, and have the build system prevent people from introducing new uses of that function, and then remove old usages of that function later.</p>\n\n<p>Unfortunately, I didn't look at the setup closely enough before I left the company, and don't know how to replicate it. My question: How can I replicate this setup?</p>\n\n<p>Question is tagged Clang but I would also be interested in answers that use tooling from other compilers.</p>\n"}, {"tags": ["c++", "aes", "libgcrypt"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544643173, "post_id": 53749797, "comment_id": 94352901, "body": "<code>gcry_cipher_decrypt</code> doesn&#39;t return in some way the length of the decrypted string?"}, {"owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544643344, "post_id": 53749797, "comment_id": 94353000, "body": "@PaulMcKenzie <code>gcry_cipher_decrypt</code> returns a <code>0</code> on success or an error code"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544643402, "post_id": 53749797, "comment_id": 94353042, "body": "<a href=\"https://stackoverflow.com/questions/28845263/determine-size-of-decrypted-data-from-gcry-cipher-decrypt\">Possible duplicate</a>.  Once you know the size, the string you construct should be <code>string ret(decBuffer, size);</code> and not just <code>string ret(decBuffer);</code>"}, {"owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "edited": false, "score": 0, "creation_date": 1544644206, "post_id": 53749797, "comment_id": 94353448, "body": "I checked if there was an error code to return. I get <code>gcry_cipher_decrypt failed: gcrypt&#47;Invalid length</code>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1544644350, "post_id": 53749797, "comment_id": 94353502, "body": "What are <code>GCRY_CIPHER</code> and <code>GCRY_MODE</code>?"}, {"owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1544644480, "post_id": 53749797, "comment_id": 94353557, "body": "@DavidSchwartz forgot to paste those in. Edited post"}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "edited": false, "score": 0, "creation_date": 1544645913, "post_id": 53750616, "comment_id": 94354167, "body": "I missed that detail when it comes to encrypting and decrypting. Changing the size of my buffer to a multiple of 16 bytes solved the problem. Thanks for pointing that out for me. I will take a look at the other modes to see if something else better suits my project."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "edited": false, "score": 0, "creation_date": 1544646576, "post_id": 53750616, "comment_id": 94354433, "body": "@KS7X ECB is almost never the right choice. It&#39;s like a linked list -- you learn it first, but it&#39;s almost never the right thing to actually use. (I&#39;m going to get lots of angry comments from linked list fans for that, aren&#39;t I?)"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 2, "last_activity_date": 1544645339, "creation_date": 1544645339, "answer_id": 53750616, "question_id": 53749797, "link": "https://stackoverflow.com/questions/53749797/aes128-encryption-libgcrypt-outputs-junk/53750616#53750616", "title": "AES128 encryption libgcrypt outputs junk", "body": "<p>For AES128 in ECB mode, the size of the data to be encrypted must be a multiple of 128 bits. The plaintext and ciphertext sizes must be precisely the same.</p>\n\n<p>Here's working code to give you an idea of what you need to do to make it work. But I'd strongly suggest you rethink using ECB.</p>\n\n<pre><code>#include &lt;gcrypt.h&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;stdio.h&gt;\n\nclass aes\n{\npublic:\n    aes(std::string);\n    ~aes() { ; }\n\n    gcry_cipher_hd_t handle;\n    void encrypt(std::string, std::vector&lt;char&gt;&amp;);\n    std::string decrypt(std::vector&lt;char&gt; const&amp;); \n\nprivate:\n    std::string key_;\n    size_t keyLength_; \n};\n\n#define GCRY_CIPHER GCRY_CIPHER_AES128\n#define GCRY_MODE GCRY_CIPHER_MODE_ECB\n\naes::aes(std::string k)\n{\n    key_ = k;\n    keyLength_ = gcry_cipher_get_algo_keylen(GCRY_CIPHER);\n\n    gcry_control (GCRYCTL_DISABLE_SECMEM, 0);\n    gcry_control (GCRYCTL_INITIALIZATION_FINISHED, 0);\n    gcry_cipher_open(&amp;handle, GCRY_CIPHER, GCRY_MODE, 0);\n    gcry_cipher_setkey(handle, key_.c_str(), keyLength_);\n}\n\nvoid aes::encrypt(std::string text, std::vector&lt;char&gt;&amp; ret)\n{\n\n    // round up to the nearest multiple of the AES block size\n    while ((text.size() &amp; 0xf) != 0xf)\n        text += \" \";\n\n    size_t textLength = text.size() + 1;\n    ret.resize(textLength);\n    int err = gcry_cipher_encrypt(handle, ret.data(), textLength, text.c_str(), textLength);\n    if (err != 0)\n    {\n       std::cout &lt;&lt; \"encrypt fail\" &lt;&lt;\n           gcry_strsource(err) &lt;&lt; \" \" &lt;&lt;\n           gcry_strerror(err) &lt;&lt; std::endl;\n    }\n}\n\nstd::string aes::decrypt(std::vector&lt;char&gt; const&amp; text) {\n    size_t textLength = text.size();\n\n    char * decBuffer = new char[textLength];\n\n    int err=gcry_cipher_decrypt(handle, decBuffer, textLength, text.data(), textLength);\n    if (err != 0)\n    {\n       std::cout &lt;&lt; \"decrypt fail: \" &lt;&lt;\n           gcry_strsource(err) &lt;&lt;  \" \" &lt;&lt;\n           gcry_strerror(err) &lt;&lt; std::endl;\n     }\n\n    std::string ret (decBuffer);\n    delete [] decBuffer;\n    return ret;\n}\n\nint main()\n{\n    std::vector&lt;char&gt; data;\n\n    aes bb = aes(\"one test AES key\");\n    bb.encrypt(\"Some message\", data);\n\n\n    std::string dec = bb.decrypt(data);\n    std::cout &lt;&lt; \"decrypted string \" &lt;&lt; dec &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>decrypted string Some message   </p>\n</blockquote>\n"}], "owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 53750616, "answer_count": 1, "score": 0, "last_activity_date": 1544645339, "creation_date": 1544641747, "last_edit_date": 1544644454, "question_id": 53749797, "link": "https://stackoverflow.com/questions/53749797/aes128-encryption-libgcrypt-outputs-junk", "title": "AES128 encryption libgcrypt outputs junk", "body": "<p>I am using this solved post as a reference but cannot seem to get the same result: <a href=\"https://stackoverflow.com/questions/26189967/aes128-in-libgcrypt-not-encrypting/26190186?noredirect=1#comment94351144_26190186\">AES128 in libgcrypt not encrypting</a></p>\n\n<p>When I print the string to console, I get junk characters. I think it may be due to <code>'\\0'</code> being in the string but I am not certain how to go about that. </p>\n\n<p>//aes.cpp</p>\n\n<pre><code>#include \"aes.h\"\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\n#define GCRY_CIPHER GCRY_CIPHER_AES128   // Pick the cipher here\n#define GCRY_MODE GCRY_CIPHER_MODE_ECB // Pick the cipher mode here\n\naes::aes(std::string k)\n{\n    key_ = k;\n    keyLength_ = gcry_cipher_get_algo_keylen(GCRY_CIPHER);\n\n    gcry_control (GCRYCTL_DISABLE_SECMEM, 0);\n    gcry_control (GCRYCTL_INITIALIZATION_FINISHED, 0);\n    gcry_cipher_open(&amp;handle, GCRY_CIPHER, GCRY_MODE, 0);\n    gcry_cipher_setkey(handle, key_.c_str(), keyLength_);\n}\n\nvoid aes::encrypt(string text, std::vector&lt;char&gt;&amp; ret) {\n    size_t textLength = text.size() + 1;\n    ret.resize(textLength);\n    gcry_cipher_encrypt(handle, ret.data(), textLength, text.c_str(), textLength);\n}\n\nstring aes::decrypt(std::vector&lt;char&gt; const&amp; text) {\n    size_t textLength = text.size() + 1;\n\n\n    char * decBuffer = new char[textLength];\n    gcry_cipher_decrypt(handle, decBuffer, textLength, text.data(), textLength);\n    string ret (decBuffer);\n    delete [] decBuffer;\n    return ret;\n}\n</code></pre>\n\n<p>//aes.h</p>\n\n<pre><code>#include &lt;gcrypt.h&gt;\n#include &lt;iostream&gt;\n\n#ifndef AES_H\n#define AES_H\n\nclass aes\n{\npublic:\n    aes(std::string);\n    ~aes();\n\n    gcry_cipher_hd_t handle;\n    void encrypt(std::string, std::vector&lt;char&gt;&amp;);\n    std::string decrypt(std::vector&lt;char&gt; const&amp;); \n\nprivate:\n    std::string key_;\n    size_t keyLength_; \n};\n\n#endif // AES_H\n</code></pre>\n\n<p>//main.cpp</p>\n\n<pre><code>#include \"aes.h\"\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::vector&lt;char&gt; data;\n\n    aes bb = aes(\"one test AES key\");\n    bb.encrypt(\"Some message\", data);\n\n    std::string dec = bb.decrypt(data);\n    std::cout &lt;&lt; \"decrypted string \" &lt;&lt; dec &lt;&lt; std::endl;\n    return 0;\n    //output gives me: decrypted string \ufffd\n\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "glut"], "comments": [{"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1544642054, "post_id": 53749750, "comment_id": 94352364, "body": "Why mixing <code>gluOrtho2D</code> with <code>gluPerspective</code>? Use only <code>gluOrtho2D</code> and try doing <code>float squareZ = 0.0f;</code>"}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1544642412, "post_id": 53749750, "comment_id": 94352537, "body": "??? I think, you should remove <code>gluPerspective</code>"}, {"owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1544642620, "post_id": 53749750, "comment_id": 94352662, "body": "How about modern OpenGL <a href=\"https://learnopengl.com/\" rel=\"nofollow noreferrer\">learnopengl.com</a> I&#39;d do this on the Vertex Shader, by the way glut hasn&#39;t been updated in years why not GLFW with glad?"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1544642767, "post_id": 53749750, "comment_id": 94352705, "body": "<code>glTranslatef</code> is not allowed within <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glBegin.xml\" rel=\"nofollow noreferrer\"><code>glBegin</code>/<code>glEnd</code></a> sequences"}, {"owner": {"reputation": 592, "user_id": 8779004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gLi3z.jpg?s=128&g=1", "display_name": "Muddy", "link": "https://stackoverflow.com/users/8779004/muddy"}, "edited": false, "score": 0, "creation_date": 1544642940, "post_id": 53749750, "comment_id": 94352780, "body": "Where should I put <code>glTranslatef</code>?"}, {"owner": {"reputation": 592, "user_id": 8779004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gLi3z.jpg?s=128&g=1", "display_name": "Muddy", "link": "https://stackoverflow.com/users/8779004/muddy"}, "edited": false, "score": 0, "creation_date": 1544643004, "post_id": 53749750, "comment_id": 94352801, "body": "I removed <code>gluPerspective</code>, but I still can&#39;t see the square"}], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 8779004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gLi3z.jpg?s=128&g=1", "display_name": "Muddy", "link": "https://stackoverflow.com/users/8779004/muddy"}, "edited": false, "score": 0, "creation_date": 1544643626, "post_id": 53750169, "comment_id": 94353155, "body": "My square still doesn&#39;t appear when I run the code. Is there anything wrong with the values I&#39;m using on <code>glBegin(GL_POLYGON);</code>?"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 592, "user_id": 8779004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gLi3z.jpg?s=128&g=1", "display_name": "Muddy", "link": "https://stackoverflow.com/users/8779004/muddy"}, "edited": false, "score": 0, "creation_date": 1544643855, "post_id": 53750169, "comment_id": 94353271, "body": "@Muddy It worls fine for me. I used the code of your question and exchanged the functions <code>drawShape</code>, <code>handleResize</code> and <code>update</code> with that one of my answer"}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 2, "last_activity_date": 1544644010, "last_edit_date": 1544644010, "creation_date": 1544643266, "answer_id": 53750169, "question_id": 53749750, "link": "https://stackoverflow.com/questions/53749750/displaying-and-moving-a-square/53750169#53750169", "title": "Displaying and moving a square", "body": "<p>Note, that drawing by <code>glBegin</code>/<code>glEnd</code> sequences and the fixed function pipeline matrix stack is deprecated since decades.\nRead about <a href=\"https://www.khronos.org/opengl/wiki/Fixed_Function_Pipeline\" rel=\"nofollow noreferrer\">Fixed Function Pipeline</a> and see <a href=\"https://www.khronos.org/opengl/wiki/Vertex_Specification\" rel=\"nofollow noreferrer\">Vertex Specification</a> and <a href=\"https://www.khronos.org/opengl/wiki/Shader\" rel=\"nofollow noreferrer\">Shader</a> for a state of the art way of rendering.</p>\n\n<hr>\n\n<p>Anyway, <code>glTranslatef</code> is not allowed within <code>glBegin</code>/<code>glEnd</code> sequences. Do it before <code>glBegin</code>:</p>\n\n<pre><code>void drawShape(void) {\n    glTranslatef(squareX, squareY, squareZ); \n    glBegin(GL_POLYGON);\n    glColor3f(1.0, 0.0, 0.0);\n    glVertex2f(162, 50);\n    glVertex2f(162, 10);\n    glVertex2f(220, 10);\n    glVertex2f(220, 50);\n    glVertex2f(162, 50);\n    glEnd();\n}\n</code></pre>\n\n<p>If you want to draw the quad in window coordinates, then you have to use orthographic projection (<a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glOrtho.xml\" rel=\"nofollow noreferrer\"><code>glOrtho</code></a>):</p>\n\n<pre><code>void handleResize(int w, int h) {\n\n    glViewport(0, 0, w, h);\n    glMatrixMode(GL_PROJECTION); \n    glLoadIdentity(); \n    /*\n    gluPerspective(45.0,   // the camera angle\n    (double)w / (double)h, // the width-to-height ratio\n    1.0,                   // the near z clipping coordinate\n    200.0);                // the far z clipping coordinate\n    */\n\n    glOrtho( 0.0f, (float)w, 0.0f,(float)h, -1.0f, 1.0f );\n}  \n</code></pre>\n\n<p>and you have to change the amount of the translation:</p>\n\n<pre><code>void update(int value) {\n    if (flag) {\n        squareY += 1.0f;\n        if (squareY &gt; 350.0) {\n            flag = 0;\n        }\n    }\n    if (!flag) {\n        squareY -= 1.0f;\n        if (squareY &lt; 0.0) {\n            flag = 1;\n        }\n    }\n    glutPostRedisplay(); \n    glutTimerFunc(25, update, 0);\n}\n</code></pre>\n\n<p>Preview:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FTpb1.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FTpb1.gif\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 592, "user_id": 8779004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gLi3z.jpg?s=128&g=1", "display_name": "Muddy", "link": "https://stackoverflow.com/users/8779004/muddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 53750169, "answer_count": 1, "score": 2, "last_activity_date": 1545647496, "creation_date": 1544641523, "last_edit_date": 1545647496, "question_id": 53749750, "link": "https://stackoverflow.com/questions/53749750/displaying-and-moving-a-square", "title": "Displaying and moving a square", "body": "<pre><code>#include &lt;stdio.h&gt; // this library is for standard input and output\n#include \"glut.h\"// this library is for glut the OpenGL Utility Toolkit\n#include &lt;math.h&gt;\n\nfloat squareX = 0.0f;\nfloat squareY = -0.3f;\nfloat squareZ = 0.0f;\n\nstatic int flag = 1;\n\nvoid drawShape(void) {\n    glBegin(GL_POLYGON);\n    glColor3f(1.0, 0.0, 0.0); // set colour to red\n    glVertex2f(162, 50);\n    glVertex2f(162, 10);\n    glVertex2f(220, 10);\n    glVertex2f(220, 50);\n    glVertex2f(162, 50);\n    glTranslatef(squareX, squareY, squareZ); // moving it toward the screen a bit on creation\n    glEnd();\n}\n\nvoid initRendering() {\n    glEnable(GL_DEPTH_TEST);\n}\n\n// called when the window is resized\nvoid handleResize(int w, int h) {\n    // tell OpenGL how to convert from coordinates to pixel values\n    glViewport(0, 0, w, h);\n    glMatrixMode(GL_PROJECTION); // switch to setting the camera perspective\n    // set the camera perspective\n    glLoadIdentity(); // reset the camera\n    gluPerspective(45.0,                  // the camera angle\n    (double)w / (double)h, // the width-to-height ratio\n    1.0,                   // the near z clipping coordinate\n    200.0);                // the far z clipping coordinate\n}\n\nvoid drawScene() {\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n    drawShape();\n    glutSwapBuffers();\n}\n\n// float _angle = 30.0f;\nvoid update(int value) {\n    if (flag) {\n        squareY += 0.001f;\n        if (squareY &gt; 0.3) {\n            flag = 0;\n        }\n    }\n    if (!flag) {\n        squareY -= 0.001f;\n        if (squareY &lt; -0.3) {\n            flag = 1;\n        }\n    }\n    glutPostRedisplay(); // tell GLUT that the display has changed\n    // tell GLUT to call update again in 25 milliseconds\n    glutTimerFunc(25, update, 0);\n}\n\nint main(int argc, char** argv) {\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);\n    glutInitWindowSize(400, 400);\n    glutCreateWindow(\"Moving Square\");\n    initRendering();\n    glutDisplayFunc(drawScene);\n    glutReshapeFunc(handleResize);\n    glutTimerFunc(25, update, 0);\n    glutMainLoop();\n    return(0);\n}\n</code></pre>\n\n<p>I've added comments to the code so you can understand it. I'm trying to create a square that travels to the top of the screen, but I'm having trouble displaying the square. For some reason, it doesn't show up when I run the code. I can only display the square when I remove the code for the movement. How can I display the square and also make it go up?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3481, "user_id": 395029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/iWHeY.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/395029/brent"}, "edited": false, "score": 0, "creation_date": 1544641374, "post_id": 53749705, "comment_id": 94352041, "body": "I tested this in Visual Studio 2017 and <a href=\"https://cpp.sh\" rel=\"nofollow noreferrer\">cpp.sh</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1544642086, "post_id": 53749705, "comment_id": 94352376, "body": "Maybe because the template function is not a copy constructor, but something masquerading as one?  AFAIK, the standard doesn&#39;t define the canonical copy constructor as a function that is templated.  OK, the duplicate verified my suspicions."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1544642391, "post_id": 53749705, "comment_id": 94352530, "body": "<a href=\"https://stackoverflow.com/a/9487897/1848654\">stackoverflow.com/a/9487897/1848654</a>"}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1544642811, "post_id": 53749705, "comment_id": 94352717, "body": "When compiler has to choose between free-function (default copy ctor generated by compiler) and templated ctor (both have the same match), always free-function is called. You can see <code>hit</code> only if you remove <code>const</code> from signature of templated ctor because <code>template&lt;&gt; test(test&amp;)</code> is better match when it is called for non-const object <code>test a;</code> than calling default copy ctor  which takes <code>test</code> by const reference."}, {"owner": {"reputation": 3481, "user_id": 395029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/iWHeY.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/395029/brent"}, "edited": false, "score": 0, "creation_date": 1544642875, "post_id": 53749705, "comment_id": 94352748, "body": "Is constructor inheritance a possible workaround? Two base classes, one has the constructor, one does not, and which is inherited is determined through template resolution."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1544642969, "post_id": 53749705, "comment_id": 94352792, "body": "@Brent What are you trying to accomplish with this?  There is probably an already existing workaround"}, {"owner": {"reputation": 3481, "user_id": 395029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/iWHeY.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/395029/brent"}, "edited": false, "score": 0, "creation_date": 1544642999, "post_id": 53749705, "comment_id": 94352800, "body": "I have a wrapper class that&#39;s templated on a type T. The wrapper class should only be copy constructible if T is."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1544643194, "post_id": 53749705, "comment_id": 94352915, "body": "Does the class hold a <code>T</code>.  If so you already get this.  If <code>T</code> is not copyable it will automatically mark the wrappers copy constructor as deleted.  This is how <code>std::vector</code> works.  A <code>std::vector&lt;int&gt;</code> is copyable but a <code>std::vector&lt;std::unique_ptr&lt;int&gt;&gt;</code> isn&#39;t."}, {"owner": {"reputation": 3481, "user_id": 395029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/iWHeY.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/395029/brent"}, "edited": false, "score": 0, "creation_date": 1544643388, "post_id": 53749705, "comment_id": 94353033, "body": "It only holds a T through a pointer. More importantly, if a copy is permitted, the default copy constructor doesn&#39;t have the needed behavior."}, {"owner": {"reputation": 3481, "user_id": 395029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/iWHeY.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/395029/brent"}, "edited": false, "score": 0, "creation_date": 1544643705, "post_id": 53749705, "comment_id": 94353197, "body": "I think another work around might be to have a new class that when copied carries out the needed operations. Add an instance of this class to the wrapper, and let the default copy constructor do its thing. Put a T in the wrapper class to control whether that default copy constructor is created."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1544644698, "post_id": 53749705, "comment_id": 94353643, "body": "@Brent You could also specialize the entire class.  Take a look at this: <a href=\"http://coliru.stacked-crooked.com/a/40807e3483fc075e\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/40807e3483fc075e</a>"}], "owner": {"reputation": 3481, "user_id": 395029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/iWHeY.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/395029/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "closed_date": 1544641785, "answer_count": 0, "score": 2, "last_activity_date": 1544642281, "creation_date": 1544641355, "last_edit_date": 1544642281, "question_id": 53749705, "link": "https://stackoverflow.com/questions/53749705/why-are-templated-copy-constructors-ignored", "closed_reason": "Duplicate", "title": "Why are templated copy constructors ignored?", "body": "<p>I think this code should print \"hit\" but it doesn't. If you comment out line 6 (the template line), it prints \"hit.\"</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct test {\n    test() {}\n\n    template&lt;typename = typename std::enable_if&lt;true&gt;::type&gt;\n    test(test const &amp; other) {\n        std::cout &lt;&lt; \"hit\";\n    }\n};\n\nint main()\n{\n  test a;\n  test b(a);\n}\n</code></pre>\n\n<p>The standard explicitly indicates this. What's the rationale?</p>\n"}, {"tags": ["c++", "algorithm", "chess"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1544641025, "post_id": 53749562, "comment_id": 94351878, "body": "A valid knight&#39;s move is one where the absolute value of the change in x and the absolute value of the change in y are 1 and 2 or 2 and 1. And where the move is confined to the board."}, {"owner": {"reputation": 81, "user_id": 10729360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBXNOtAKifU/AAAAAAAAAAI/AAAAAAAAAA8/siiijrXpht4/photo.jpg?sz=128", "display_name": "Z.Zadon", "link": "https://stackoverflow.com/users/10729360/z-zadon"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1544642035, "post_id": 53749562, "comment_id": 94352351, "body": "Could you right me the condition please? I am not sure I understand"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1544642295, "post_id": 53749562, "comment_id": 94352487, "body": "@Z.Zadon No, we cannot write the condition for you: SO is not a coding service.  Also, the problem of a legal knight&#39;s move is covered quite well on line, including on this site.  We expect you to take due diligence to find or create a solution before you post here for help."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1544642307, "post_id": 53749562, "comment_id": 94352495, "body": "Welcome to StackOverflow.  Please read and follow the posting guidelines in the help documentation, as suggested when you created this account.  <a href=\"http://stackoverflow.com/help/on-topic\">On topic</a>, <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>, and <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">... the perfect question</a> apply here. StackOverflow is not a design, coding, research, or tutorial resource. However, if you follow whatever resources you find on line, make an honest coding attempt, and run into a problem, you&#39;d have a good example to post."}, {"owner": {"reputation": 81, "user_id": 10729360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBXNOtAKifU/AAAAAAAAAAI/AAAAAAAAAA8/siiijrXpht4/photo.jpg?sz=128", "display_name": "Z.Zadon", "link": "https://stackoverflow.com/users/10729360/z-zadon"}, "edited": false, "score": 0, "creation_date": 1544642586, "post_id": 53749562, "comment_id": 94352643, "body": "I don&#39;t understand what I did wrong. I posted my solution here and it works good but I just want to check if theres a better way.. its not like I just asked you to write me a code ;("}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1544642977, "post_id": 53749562, "comment_id": 94352795, "body": "The absolute change in x means the difference between <code>x</code> and <code>this-&gt;getLocX()</code> as a positive value. Same thing for the absolute change in y. It&#39;s a valid knight move if one of those is 1 and the other is 2."}, {"owner": {"reputation": 81, "user_id": 10729360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBXNOtAKifU/AAAAAAAAAAI/AAAAAAAAAA8/siiijrXpht4/photo.jpg?sz=128", "display_name": "Z.Zadon", "link": "https://stackoverflow.com/users/10729360/z-zadon"}, "edited": false, "score": 0, "creation_date": 1544643027, "post_id": 53749562, "comment_id": 94352820, "body": "Alright thanks I managed to do it :), solved"}, {"owner": {"reputation": 35518, "user_id": 104950, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1nwnJ.jpg?s=128&g=1", "display_name": "Amir Afghani", "link": "https://stackoverflow.com/users/104950/amir-afghani"}, "edited": false, "score": 0, "creation_date": 1544729587, "post_id": 53749562, "comment_id": 94389541, "body": "If you&#39;re looking to improve efficiency, ditch the 2d array in favor of a 1-d array."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1544643101, "creation_date": 1544643101, "answer_id": 53750116, "question_id": 53749562, "link": "https://stackoverflow.com/questions/53749562/check-if-knight-move-between-two-points-is-valid/53750116#53750116", "title": "Check if knight move between two points is valid", "body": "<p>Here a variants to check the validity, checking the horizontal and vertical distance:  </p>\n\n<pre><code>bool isValidKnight2(int getLocX,int getLocY, int x,int y)\n{\n    int dx = abs(getLocX - x); \n    int dy = abs(getLocY - y); \n    return (dx == 1 &amp;&amp; dy==2 || dx  == 2 &amp;&amp; dy==1); \n}\n</code></pre>\n\n<p>And here one checking the horizontal and vertical move against a <a href=\"https://en.cppreference.com/w/cpp/container/set\" rel=\"nofollow noreferrer\">set</a> of allowed possibitlities: </p>\n\n<pre><code>bool isValidKnight3(int getLocX,int getLocY, int x,int y)\n{\n    static set&lt;pair&lt;int,int&gt;&gt; valid={{1,2},{2,1}}; \n    return (valid.find(make_pair(abs(getLocX - x), abs(getLocY - y)))!=valid.end()); \n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/RSbOKt\" rel=\"nofollow noreferrer\">Online demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 5525, "user_id": 576857, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8ec04b9d97b033d197d40642de73a4bc?s=128&d=identicon&r=PG", "display_name": "Al Kepp", "link": "https://stackoverflow.com/users/576857/al-kepp"}, "edited": false, "score": 0, "creation_date": 1544647050, "post_id": 53750868, "comment_id": 94354643, "body": "I like this solution +1, but you miss the check if the destination is inside the board (as well as all other solutions so far)."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 5525, "user_id": 576857, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8ec04b9d97b033d197d40642de73a4bc?s=128&d=identicon&r=PG", "display_name": "Al Kepp", "link": "https://stackoverflow.com/users/576857/al-kepp"}, "edited": false, "score": 0, "creation_date": 1544647239, "post_id": 53750868, "comment_id": 94354712, "body": "@AlKepp: this didn&#39;t seem to be requested in the question, possibly handled elsewhere or just implicitly achieved."}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": true, "score": 6, "last_activity_date": 1544646978, "last_edit_date": 1544646978, "creation_date": 1544646611, "answer_id": 53750868, "question_id": 53749562, "link": "https://stackoverflow.com/questions/53749562/check-if-knight-move-between-two-points-is-valid/53750868#53750868", "title": "Check if knight move between two points is valid", "body": "<p>My try:</p>\n\n<pre><code>abs((X0 - X1) * (Y0 - Y1)) == 2\n</code></pre>\n\n<p>For efficiency, the absolute value can be computed branchless.</p>\n"}], "owner": {"reputation": 81, "user_id": 10729360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBXNOtAKifU/AAAAAAAAAAI/AAAAAAAAAA8/siiijrXpht4/photo.jpg?sz=128", "display_name": "Z.Zadon", "link": "https://stackoverflow.com/users/10729360/z-zadon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 1, "accepted_answer_id": 53750868, "answer_count": 2, "score": 0, "last_activity_date": 1544646978, "creation_date": 1544640735, "last_edit_date": 1544641715, "question_id": 53749562, "link": "https://stackoverflow.com/questions/53749562/check-if-knight-move-between-two-points-is-valid", "title": "Check if knight move between two points is valid", "body": "<p>I am doing a chess project in C++.  I am trying to check for a valid knight move in a 2D array.</p>\n\n<p>I've got the old position of the player <code>this-&gt;getLocX(),this-&gt;getLocY()</code> variables (where the player was) and I have <code>x,y</code> (this is where the player wants to move his knight into).</p>\n\n<p>How can you check validity in the best way? Here's my solution but I want to know if theres a better way.</p>\n\n<pre><code>if (x == this-&gt;getLocX() + 1 &amp;&amp; y == this-&gt;getLocY() + 2 || x == this-&gt;getLocX() - 1 &amp;&amp; y == this-&gt;getLocY() + 2 || y == this-&gt;getLocY() + 1 &amp;&amp; x == this-&gt;getLocX() + 2 || y == this-&gt;getLocY() + 1 &amp;&amp; x == this-&gt;getLocX() - 2  || x == this-&gt;getLocX() - 1 &amp;&amp; y == this-&gt;getLocY() + 2 || x == this-&gt;getLocX() + 1 &amp;&amp; y == this-&gt;getLocY() - 2 || y == this-&gt;getLocY() - 1 &amp;&amp; x == this-&gt;getLocX() - 2 || y == this-&gt;getLocY() - 1 &amp;&amp; x == this-&gt;getLocX() + 2 || x == this-&gt;getLocX() - 1 &amp;&amp; y == this-&gt;getLocY() - 2)\n{\n    //Move is vaid\n}\n</code></pre>\n"}, {"tags": ["c++", "cmake", "header", "sdl"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1544640866, "post_id": 53749507, "comment_id": 94351797, "body": "Does this not work?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1544640988, "post_id": 53749507, "comment_id": 94351855, "body": "Maybe you need to change <code>&quot;D:&#47;Programs&#47;SDL2-2.0.9&#47;include&quot;</code> to <code>&quot;D:&#47;Programs&#47;SDL2-2.0.9&#47;include&#47;SDL2&quot;</code> although if the SDL headers use the <code>#include &lt;SDL2&#47;SDL.h&gt;</code> convention you will want to keep both folders in your includes."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 8647757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd8bd7e051c26adc67e55756dd10ae4?s=128&d=identicon&r=PG&f=1", "display_name": "Macelaru Tiberiu", "link": "https://stackoverflow.com/users/8647757/macelaru-tiberiu"}, "is_accepted": false, "score": 0, "last_activity_date": 1544649660, "creation_date": 1544649660, "answer_id": 53751539, "question_id": 53749507, "link": "https://stackoverflow.com/questions/53749507/include-headers-with-one-level-indirection/53751539#53751539", "title": "Include headers with one level indirection?", "body": "<p>Ok so drescherjm comment was close.</p>\n\n<p>Simply put all header files in a folder named SDL2 inside the /include directory and now you can use the second method of header includes :</p>\n\n<pre><code>#include &lt;SDL2/SDL.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 8647757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd8bd7e051c26adc67e55756dd10ae4?s=128&d=identicon&r=PG&f=1", "display_name": "Macelaru Tiberiu", "link": "https://stackoverflow.com/users/8647757/macelaru-tiberiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544649660, "creation_date": 1544640515, "last_edit_date": 1544647503, "question_id": 53749507, "link": "https://stackoverflow.com/questions/53749507/include-headers-with-one-level-indirection", "title": "Include headers with one level indirection?", "body": "<p>To include the SDL2 library in my project using CMake on Windows a did this :</p>\n\n<pre><code>target_include_directories(main_receiver PRIVATE \"D:/Programs/SDL2-2.0.9/include\")\ntarget_link_libraries(main_receiver \"D:/Programs/SDL2-2.0.9/lib/x64/SDL2.lib\")\n</code></pre>\n\n<p>I can now include every header file in D:/Programs/SDL2-2.0.9/include directly :</p>\n\n<pre><code>#include &lt;SDL.h&gt;\n#include &lt;SDL_audio.h&gt;\n#include &lt;SDL_bits.h&gt;\n#include &lt;SDL_assert.h&gt;\n. . .\n</code></pre>\n\n<p>However in the Vulkan templates (the Vulkan SDK includes the third party SDL2 library) all includes for SDL2 are done like this :</p>\n\n<pre><code>#include &lt;SDL2/SDL.h&gt;\n#include &lt;SDL2/SDL_audio.h&gt;\n#include &lt;SDL2/SDL_bits.h&gt;\n#include &lt;SDL2/SDL_assert.h&gt;\n. . .\n</code></pre>\n\n<p>How can I use the latter mode/style ?</p>\n\n<p>I like it more because it reduces naming conflicts and it also helps in distinguishing that I am using SDL2 version of the library.</p>\n"}, {"tags": ["c++", "sse", "simd", "intrinsics", "sse2"], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1544641156, "post_id": 53749611, "comment_id": 94351941, "body": "but <code>__m128d</code> isn&#39;t a sort of <code>typedef double</code> pointer? How can that code works if I don&#39;t allocate the <code>result</code> array?"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 3, "creation_date": 1544641445, "post_id": 53749611, "comment_id": 94352078, "body": "@markzzz It&#39;s not a pointer or a <code>typedef</code>, it&#39;s an opaque type which the compiler knows how to deal with. This is the abstraction I referred to. The compiler knows that the <code>ADDPD</code> output goes into <code>xmm1</code> and from there it will manage the value however it needs to based on what you&#39;ve done with the variables in C."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1544641644, "post_id": 53749611, "comment_id": 94352174, "body": "So I don&#39;t understand what <code>__m128d</code> is. Compiler keyword so? GCC and MSVC do the same? C++ Standard? Any docs to it?"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1544641885, "post_id": 53749611, "comment_id": 94352293, "body": "Not a compiler keyword and not part of the C or C++ standards. It is an intrinsic type, defined by Intel, which is supported by <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/m128d?view=vs-2017\" rel=\"nofollow noreferrer\">MSVC</a>, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/x86-Options.html\" rel=\"nofollow noreferrer\">gcc</a>, <a href=\"https://software.intel.com/en-us/intel-compilers\" rel=\"nofollow noreferrer\">Intel&#39;s compiler</a>, <a href=\"https://clang.llvm.org/docs/genindex.html\" rel=\"nofollow noreferrer\">clang</a> and likely others."}, {"owner": {"reputation": 427, "user_id": 4439756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c29ecf1a1641720880d5d04b3f85bd94?s=128&d=identicon&r=PG&f=1", "display_name": "rpress", "link": "https://stackoverflow.com/users/4439756/rpress"}, "edited": false, "score": 1, "creation_date": 1544643226, "post_id": 53749611, "comment_id": 94352930, "body": "Not exactly related to the question, just for precision: the ADDPD instruction can store its result into any xmm register not just xmm1. The use of xmm1 in the linked docs is a little misleading."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1544643619, "post_id": 53749611, "comment_id": 94353149, "body": "&quot;The __m128d data type, for use with the Streaming SIMD Extensions 2 instructions intrinsics, is defined in &lt;emmintrin.h&gt;.&quot; So its a data type :O Can access to its definition though :O"}, {"owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "edited": false, "score": 0, "creation_date": 1544644455, "post_id": 53749611, "comment_id": 94353544, "body": "Every compiler has its own version of the intrinsics headers, so their definitions may differ. If you only use the <code>__m*</code> types with the corresponding intrinsics, you can be rather sure that the compiler compiles everything as you specified it. Any access to the &#39;internals&#39; of the data type will probably have to use rather inefficient instructions compared to what you can do with the <code>_mm*</code> intrinsics. So in short: Unless you know exactly what you are doing, best stick to the intrinsics."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 1, "creation_date": 1544646732, "post_id": 53749611, "comment_id": 94354497, "body": "Physically <code>__m128d</code> as a stack variable is just a proxy for a <code>XMM</code> hardware register. The compiler is responsible for scheduling the instructions and keeping tracking of the register file, so you don&#39;t actually know or care what register it gets mapped to. For x64 you have more <code>XMM</code> than x86 available. Intel and MSVC also consider <code>__m128d</code> to be a structure so you can use it to cast 16-byte aligned memory to the same &#39;type&#39;, but GCC/clang do not support this and treat <code>__m128d</code> as an opaque type. See also <a href=\"https://github.com/Microsoft/DirectXMath\" rel=\"nofollow noreferrer\">DirectXMath</a>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 427, "user_id": 4439756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c29ecf1a1641720880d5d04b3f85bd94?s=128&d=identicon&r=PG&f=1", "display_name": "rpress", "link": "https://stackoverflow.com/users/4439756/rpress"}, "edited": false, "score": 0, "creation_date": 1544674111, "post_id": 53749611, "comment_id": 94362347, "body": "@rpress: fun fact: there are a few SIMD instructions that do use a fixed architectural register, like non-VEX <code>blendvps</code> / <code>pblendvb</code> implicitly uses XMM0 as the blend-control.  Intel documents this with <code>BLENDVPS xmm1, xmm2&#47;m128, &lt;XMM0&gt;</code>: <a href=\"http://felixcloutier.com/x86/BLENDVPS.html\" rel=\"nofollow noreferrer\">felixcloutier.com/x86/BLENDVPS.html</a>.  (I edited the answer to remove the mistake you pointed out.)"}], "tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": true, "score": 5, "last_activity_date": 1544673919, "last_edit_date": 1544673919, "creation_date": 1544640925, "answer_id": 53749611, "question_id": 53749482, "link": "https://stackoverflow.com/questions/53749482/where-do-sse2-intrinsics-store-results/53749611#53749611", "title": "Where do SSE2 intrinsics store results?", "body": "<p>The description <em>\"store the results in <code>dst</code>\"</em> is a little misleading. The intrinsic function returns the result of the vector addition as a value of type <code>__m128d</code>.</p>\n\n<pre><code>__m128d arg1 = ...;\n__m128d arg2 = ...;\n__m128d result = _mm_add_pd(arg1, arg2);\n</code></pre>\n\n<p>If you call the variable <code>dst</code> instead of <code>result</code>, then you have code that fits the description. (But you can call it whatever you want.)</p>\n\n<p>The underlying SSE instruction, <a href=\"https://www.felixcloutier.com/x86/ADDPD.html\" rel=\"nofollow noreferrer\"><code>ADDPD</code></a>, stores the result of the operation in the XMM register of its choice.  The compiler will do register allocation (and even store/reload C vector variables if it runs out of registers, or around a function call that clobbers the vector registers).</p>\n\n<p>Intrinsics operate on C variables, just like <code>+</code> and <code>*</code> with <code>int</code> or <code>float</code> types.  Normally these compile to asm instructions that operate on registers (or maybe a memory source operand if it combines a load and add intrinsic), but leaving all this to the compiler is the point of using intrinsics.</p>\n\n<p>You do want to write your code so that it <em>can</em> compile efficiently, though: if more than 16 <code>__m128</code> variables are \"alive\" at once, the compiler will have to spill/reload them.</p>\n"}, {"tags": [], "owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "is_accepted": false, "score": 6, "last_activity_date": 1544641452, "last_edit_date": 1544641452, "creation_date": 1544640944, "answer_id": 53749616, "question_id": 53749482, "link": "https://stackoverflow.com/questions/53749482/where-do-sse2-intrinsics-store-results/53749616#53749616", "title": "Where do SSE2 intrinsics store results?", "body": "<p>The intrinsic returns the result of the computation, so you can store it in a variable or use it as another parameter.</p>\n\n<p>An important thing to note here is that most SIMD instructions don't operate directly on memory, but you need to explicitly load (<code>_mm_load(u)_pd</code>) and store (<code>_mm_store(u)_pd</code>) the double values as you would for example do in assembly. The intermediate values will most likely be stored in SSE registers, or if too many registers are in use, on the stack.</p>\n\n<p>So if you wanted to sum up two double arrays, you would do something like</p>\n\n<pre><code>double a[N];\ndouble b[N];\ndouble c[N];\nfor (int i = 0; i &lt; N; i += 2) {  // We load two doubles every time\n    auto x = _mm_loadu_pd(a + i); // We don't know anything about alignment\n    auto y = _mm_loadu_pd(b + i); // So I assume the load is unaligned\n    auto sum = _mm_add_pd(x, y);  // Compute the vector sum\n    _mm_storeu_pd(c + i, sum);    // The store is unaligned as well\n}\n</code></pre>\n"}], "owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 53749611, "answer_count": 2, "score": 3, "last_activity_date": 1544677021, "creation_date": 1544640423, "last_edit_date": 1544677021, "question_id": 53749482, "link": "https://stackoverflow.com/questions/53749482/where-do-sse2-intrinsics-store-results", "title": "Where do SSE2 intrinsics store results?", "body": "<p>I'm moving the first steps into SSE2 in C++. <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#techs=SSE2&amp;expand=115\" rel=\"nofollow noreferrer\">Here's</a> the intrinsic I'm learning right now:</p>\n\n<pre><code>__m128d _mm_add_pd (__m128d a, __m128d b)\n</code></pre>\n\n<p>The document says: <em>Add packed double-precision (64-bit) floating-point elements in a and b, and store the results in dst.</em></p>\n\n<p>But I never pass <code>dst</code> to that function. So how can it add two double I pass (via pointer) to a resulting array if I don't pass it?</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1544640193, "post_id": 53749409, "comment_id": 94351422, "body": "Depends on your definition of safe. Program probably won&#39;t crash, but the results are undefined."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1544640327, "post_id": 53749409, "comment_id": 94351498, "body": "It also depends on the type of access. For example, calling an in-place constructor may be safe but calling <code>operator=</code> may not be."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1544640776, "post_id": 53749409, "comment_id": 94351751, "body": "Many debugging runtime libraries will stop your program dead in its tracks with an <code>assert</code> if you go beyond <code>size()</code>.  For example, the Visual C++ debug runtime will halt your program."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 1, "creation_date": 1544641142, "post_id": 53749409, "comment_id": 94351930, "body": "Between index 0 and <code>size()</code> you have valid data, between index <code>size()</code> and <code>capacity()</code> you only have valid memory. At best you can initialize the valid memory but still vector will not manage it in any meaningful way. There are some details about reasons to circunvent the vector interface here: <a href=\"https://lemire.me/blog/2012/06/20/do-not-waste-time-with-stl-vectors/\" rel=\"nofollow noreferrer\">lemire.me/blog/2012/06/20/do-not-waste-time-with-stl-vectors</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1544641428, "post_id": 53749409, "comment_id": 94352070, "body": "Note: cplusplus.com tends to favour easy reading for beginners over accuracy. This is great until you hit  a problem that requires literal correctness. At that point <a href=\"https://en.cppreference.com/w/\" rel=\"nofollow noreferrer\">prefer cppreference</a>, and if that&#39;s not good enough, <a href=\"http://eel.is/c++draft/\" rel=\"nofollow noreferrer\">go to the C++ Standard</a>. Note that as you get into deeper and more correct documentation, it gets much harder to understand without a strong backing knowledge (and sometimes a law degree)."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1544640577, "post_id": 53749495, "comment_id": 94351626, "body": "And after <code>size()</code> things get fun. The library implementation could include code that checks for out of bounds access and halts your program with an error message. It could do nothing and let the program consume unknown  data values. It could play La Macarena."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1544640638, "post_id": 53749495, "comment_id": 94351662, "body": "The inference is not true. The statement does not say what else is valid. The comment by @DavidSchwartz is more to the point."}, {"owner": {"reputation": 823, "user_id": 779912, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bbe42bc7078d4c4481ebdf908d7dd9cc?s=128&d=identicon&r=PG", "display_name": "TruLa", "link": "https://stackoverflow.com/users/779912/trula"}, "edited": false, "score": 0, "creation_date": 1544640877, "post_id": 53749495, "comment_id": 94351802, "body": "Thank you very much for the link. The <a href=\"https://timsong-cpp.github.io/cppwp/vector.capacity\" rel=\"nofollow noreferrer\">vector.capacity</a> is less ambiguous there: <code>The total number of elements that the vector can hold without requiring reallocation</code>. Which does not imply the fact that <code>data()</code> returns a pointer to the region of size <code>capacity</code>"}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544686553, "post_id": 53749495, "comment_id": 94366197, "body": "@user4581301 That reminds me to someday make a C++ implementation which would play La Macarena + rendering Rick Ashleys picture in every frame buffer it can find, whenever UB is invoked or implementation defined behaviour allows it."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 7, "last_activity_date": 1544641170, "last_edit_date": 1544641170, "creation_date": 1544640481, "answer_id": 53749495, "question_id": 53749409, "link": "https://stackoverflow.com/questions/53749409/c-access-vector-beyond-size-and-under-capacity/53749495#53749495", "title": "C++ access vector beyond size() and under capacity()", "body": "<p>It isn't valid to access <code>data()[n]</code> if <code>n &gt;= size()</code>.  Per <a href=\"https://timsong-cpp.github.io/cppwp/vector.data\" rel=\"nofollow noreferrer\">[vector.data]</a> <code>std::vector::data</code></p>\n\n<blockquote>\n  <p>Returns: A pointer such that <code>[data(), data() + size())</code> is a valid range. For a non-empty vector, <code>data() == addressof(front())</code>.</p>\n</blockquote>\n\n<p>So it is only valid to access <code>data</code> with a value in the range of <code>[0, size())</code>.</p>\n\n<hr>\n\n<p>Generally then memory between <code>data() + size() - 1</code> and <code>data + capacity()</code> is uninitialized.  If you read from that uninitialized memory that is undefined behavior.  If you have an object that has non trivial initialization then you can't even assign a value to it since there isn't an object actually in that spot, just the space for one.  You could probably get away with doing things in the uninitialized range, but your violating the contract with <code>std::vector</code> and it might get angry if you do ;)</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1544640721, "post_id": 53749525, "comment_id": 94351719, "body": "Regarding <i>everybody will confirm</i>, I remember ads as a child stating that 9 out of 10 dentists agree that brushing your teeth was good. I always wondered what was up with that tenth dentist."}], "tags": [], "owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "is_accepted": false, "score": 3, "last_activity_date": 1544640603, "creation_date": 1544640603, "answer_id": 53749525, "question_id": 53749409, "link": "https://stackoverflow.com/questions/53749409/c-access-vector-beyond-size-and-under-capacity/53749525#53749525", "title": "C++ access vector beyond size() and under capacity()", "body": "<p>No it is <strong>not safe</strong> because \u00a723.3.6.4 of ISO/IEC 14882:2014 states</p>\n\n<blockquote>\n  <p>vector data ... Returns: A pointer such that [data(),data() + size()) is a valid range.</p>\n</blockquote>\n\n<p>So by the standard everything beyond <code>size()</code> is not defined, meaning the so called <em>undefined behaviour</em>, which as everybody will confirm, is something very unsafe.</p>\n\n<p>To be fair, usually nothing bad would happen, but this is a very weak usually, which means, another compiler, operating system, and boom things happen, and you can not tell that. And to be also complete, there are several implementations where this will crash, I think for example when you compile with address sanitisation. Just don't do it.</p>\n"}], "owner": {"reputation": 823, "user_id": 779912, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bbe42bc7078d4c4481ebdf908d7dd9cc?s=128&d=identicon&r=PG", "display_name": "TruLa", "link": "https://stackoverflow.com/users/779912/trula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 1, "accepted_answer_id": 53749495, "answer_count": 2, "score": 2, "last_activity_date": 1544641170, "creation_date": 1544640125, "question_id": 53749409, "link": "https://stackoverflow.com/questions/53749409/c-access-vector-beyond-size-and-under-capacity", "title": "C++ access vector beyond size() and under capacity()", "body": "<p>Is it safe to access vector's <code>data()[i]</code> for indices <code>i</code> beyond vector's <code>size()</code> and under vector's <code>capacity()</code>?</p>\n\n<p>Here is my reasoning:</p>\n\n<p>a) According the <a href=\"http://www.cplusplus.com/reference/vector/vector/capacity/\" rel=\"nofollow noreferrer\">cplusplus</a>, <code>capacity()</code> is \"the size of the storage space currently allocated for the vector\" which makes me think that the answer to my question is <code>YES</code>, but then</p>\n\n<p>b) Using <code>reserve()</code> and access <code>data</code> beyond vector's <code>size()</code> should be safe because according to <a href=\"http://www.cplusplus.com/reference/vector/vector/reserve/\" rel=\"nofollow noreferrer\">cplusplus</a>, <code>reserve()</code> \"causes the container to reallocate its storage increasing its capacity to n\", but then</p>\n\n<p>c) <a href=\"https://stackoverflow.com/questions/38972443/use-stdvectordata-after-reserve\">Stackoverflow topic</a> contradicts the statement <code>b)</code> above</p>\n\n<p>So I'm puzzled and looking for the answer.</p>\n"}, {"tags": ["c++", "calculator", "postfix-notation", "infix-notation"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544640043, "post_id": 53749246, "comment_id": 94351358, "body": "You might find <code>std::istringstream</code> useful here. You can use it to pull apart the <code>string</code> with the <code>&gt;&gt;</code> operator. Read for a number. If the read fails, <code>clear</code> the error and try the read again, this time into character."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1544644160, "post_id": 53749246, "comment_id": 94353421, "body": "Search the internet for &quot;c++ shunting algorithm&quot;.  You&#39;ll need to handle precedence."}, {"owner": {"reputation": 19, "user_id": 10782329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf2a73fecf3ed844be49ad7393c976d?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/10782329/graham"}, "edited": false, "score": 0, "creation_date": 1544645207, "post_id": 53749246, "comment_id": 94353854, "body": "Thanks for the reply! I have posted the solution I came up with as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 10782329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf2a73fecf3ed844be49ad7393c976d?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/10782329/graham"}, "is_accepted": false, "score": 2, "last_activity_date": 1544646381, "last_edit_date": 1544646381, "creation_date": 1544645536, "answer_id": 53750655, "question_id": 53749246, "link": "https://stackoverflow.com/questions/53749246/c-infix-to-postfix-conversion-and-calculator/53750655#53750655", "title": "C++ Infix to Postfix Conversion and Calculator", "body": "<p>Thanks everyone for the replies. After looking into the solutions you all posted and gathering ideas from them, I found a very simple solution to my specific case.</p>\n\n<p>In my getPostFix function, I added spaces after every character inserted into the postFixStr, and then using these spaces as delimiters, I was able to add this to the first \"if\" statement in my evaluate function:</p>\n\n<pre><code>if ( isdigit( str[i] ) )\n{\n    double value = 0;\n    while ( i &lt; str.length() &amp;&amp; isdigit( str[i] ) ) // if a digit, push to stack as double value\n    {\n        value = ( value * 10 ) + ( str[i] - '0' );\n        i++;    \n    }\n    stack.push(value);\n}\n</code></pre>\n\n<p>Note, the * 10 is to move the previous value in as the 10's place (or 100's+ place), and the <code>-'0'</code> is a slightly clearer version of the <code>-49</code> that I had before to change the ascii value to the arithmetic value.</p>\n\n<p>I hope this helps someone in the future!</p>\n"}], "owner": {"reputation": 19, "user_id": 10782329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf2a73fecf3ed844be49ad7393c976d?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/10782329/graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3582, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1615993057, "creation_date": 1544639424, "question_id": 53749246, "link": "https://stackoverflow.com/questions/53749246/c-infix-to-postfix-conversion-and-calculator", "title": "C++ Infix to Postfix Conversion and Calculator", "body": "<p>I'm new to stackoverflow, and have final project for my Data Structures class in college. For my project, I am creating a calculator that takes a mathematical expression from input, such as (11-2)/3*(15+2/1)-6, and does two things:</p>\n\n<p>1) Converts the expression from infix notation to postfix notation\n2) Uses the postfix notation to evaluate the value of the expression</p>\n\n<p>I have gotten fairly close to a final product, but my issue is that the program can only take numbers 0-9, as the way I currently have the code is that the conversion function evaluates the input as a string, and thus numbers greater than 9 (i.e., double/triple digit numbers) will trip up the evaluation function. How can I detect these numbers as ints (or floats/doubles) and put them in a format (with the operators) that the evaluation function can deal with?</p>\n\n<p>Additionally, I need to create exception class (incorrect parenthesis, division by zero, letters/non-operands/non-operators, etc). I have not learned much about what exception classes even are, so I'm not sure how I write these. I know it has to do with throw/catch functions, but any input is appreciated (or direction towards where I can find a simple explanation). I have pasted my code below:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stack&gt;\n#include &lt;ItemType.h&gt;\nusing namespace std;\n\nstring getPostfix( string str );\n\ndouble evaluate( string str );\n\nbool hasPrecedence( char a, char b );\n\nint main()\n{\n    cout &lt;&lt; \"Welcome to the calculator!\" &lt;&lt; endl;\n    string infixString; \n    string postFixString;\n    bool valid = false;\n    cout &lt;&lt; \"Enter the expression you would like to evaluate: \";\n    getline( cin, infixString );    // get expression as string\n    postFixString = getPostfix( infixString ); // convert to postfix\n    cout &lt;&lt; postFixString &lt;&lt; endl;\n    cout &lt;&lt; \"The value of the given expression is: \" &lt;&lt; evaluate( postFixString ) &lt;&lt; endl; // output evaluated expression\n\n    return 0;\n}\n\nstring getPostfix( string str ) // function to convert infix to postfix\n{\n    string postFixStr;  // converted string\n    stack&lt;char&gt; stack;  // stack for operators\n    for ( int i = 0; i &lt; str.length(); i++ )\n    {\n        if ( isdigit( str[i] ) )    // if str[i] is a digit (0-9), add to postfix string\n            postFixStr += str[i];\n\n        else if ( str[i] == '(' )   // if str[i] is an opening parenthesis, push to stack\n            stack.push( str[i] );\n\n        else if ( str[i] == '+' || str[i] == '-' || str[i] == '*' || str[i] == '/' )    // if an operator...\n        {\n            if ( stack.empty() || stack.top() == '(' ) // ... push to stack if stack is empty or top of stack is opening parenthesis\n            {\n                stack.push( str[i] );\n            }\n\n            else if ( hasPrecedence( str[i], stack.top() ) ) // ... if the operator has higher precedence, push to stack\n            {\n                stack.push( str[i] );\n            }\n\n            else // ... if neither of the above cases, add operator already in stack to string, pop it, and push the new operator to stack\n            {\n                postFixStr += stack.top();\n                stack.pop();\n                stack.push( str[i] );\n            }\n        }\n\n        else if ( str[i] == ')' ) // ... if str[i] is closing parenthesis, add to string and pop until opening parenthesis is reached\n        {\n            while ( stack.top() != '(' )\n            {\n                postFixStr += stack.top();\n                stack.pop();\n            }\n            if ( stack.top() == '(' )\n                stack.pop();\n        }\n    }\n    while ( ! stack.empty() ) // after string has been iterated, add the remainder of the stack to the string\n    {\n        postFixStr += stack.top();\n        stack.pop();\n    }\n    return postFixStr;\n} \n\ndouble evaluate( string str ) // function to evaluate postfix expression\n{\n    int op1, op2;\n    stack&lt;int&gt; stack;\n    for ( int i = 0; i &lt; str.length(); i++ ) // iterate through postfix string\n    {\n        if ( isdigit( str[i] ) ) // if a digit, push to stack as int value\n            stack.push( str[i] - 48 );\n        else if ( str[i] == '+' ) // cases for different operators\n        {\n            op1 = stack.top(); // assign top int to op1\n            stack.pop();       // pop top\n            op2 = stack.top(); // assign next into to op2\n            stack.pop();       // pop top\n            stack.push( op1 + op2 ); // add op1 and op2, push result to stack\n        }\n        else if ( str[i] == '-' )\n        {\n            op1 = stack.top();\n            stack.pop();\n            op2 = stack.top();\n            stack.pop();\n            stack.push( op1 - op2 );\n        }\n        else if ( str[i] == '*' )\n        {\n            op1 = stack.top();\n            stack.pop();\n            op2 = stack.top();\n            stack.pop();\n            stack.push( op1 * op2 );\n        }\n        else if ( str[i] == '-' )\n        {\n            op1 = stack.top();\n            stack.pop();\n            op2 = stack.top();\n            stack.pop();\n            stack.push( op1 / op2 );\n        }\n    }\n    return stack.top(); // return final value\n}\n\nbool hasPrecedence( char a, char b ) // function to determine operator precedence\n{\n    int aWeight, bWeight = 2;\n    if ( a == '*' || a == '/' )\n        aWeight = 2;\n    else\n        aWeight = 1;\n    return aWeight &gt;= bWeight;\n}\n</code></pre>\n"}, {"tags": ["c++", "unions"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544639488, "post_id": 53749198, "comment_id": 94351081, "body": "Have you considered adding a constructor to your union?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544639694, "post_id": 53749198, "comment_id": 94351189, "body": "Unrelated: There&#39;s usually no need for the <code>typedef</code> trick in C++. <code>union UNION_TYPE { ... };</code> is enough to get <code>UNION_TYPE m_union;</code> working."}, {"owner": {"reputation": 1, "user_id": 10782369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a005466f503f0f86fc4d4902a19e2?s=128&d=identicon&r=PG&f=1", "display_name": "Wrthyn", "link": "https://stackoverflow.com/users/10782369/wrthyn"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544643231, "post_id": 53749198, "comment_id": 94352933, "body": "Yes I tried, but without result. I didn&#39;t create this union and I prefer to not modify this typedef, I see in this situation it&#39;s not needed."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544644739, "post_id": 53749198, "comment_id": 94353660, "body": "Was going to write up an answer, but as always someone&#39;s beaten me to it: <a href=\"https://stackoverflow.com/questions/321351/initializing-a-union-with-a-non-trivial-constructor\" title=\"initializing a union with a non trivial constructor\">stackoverflow.com/questions/321351/&hellip;</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544644898, "post_id": 53749198, "comment_id": 94353724, "body": "Sidenote: The layout suggests C-style thinking, and C++ does not give the same guarantees about unions that C does. Be particularly careful with unions containing non-POD data."}, {"owner": {"reputation": 1, "user_id": 10782369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a005466f503f0f86fc4d4902a19e2?s=128&d=identicon&r=PG&f=1", "display_name": "Wrthyn", "link": "https://stackoverflow.com/users/10782369/wrthyn"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1544993525, "post_id": 53749198, "comment_id": 94461375, "body": "Thanks very much :) I saw this post before I asked a question, but didn&#39;t saw a solution there. So for POD data, memset is solution for my problem and it guarantees that all POD data types will be initialized with 0 by this <code>U1() { memset( this, 0, sizeof( U1 ) ); }</code>? Did I understood well?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1545071344, "post_id": 53749198, "comment_id": 94490626, "body": "That looks good to me."}], "owner": {"reputation": 1, "user_id": 10782369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a005466f503f0f86fc4d4902a19e2?s=128&d=identicon&r=PG&f=1", "display_name": "Wrthyn", "link": "https://stackoverflow.com/users/10782369/wrthyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545658047, "creation_date": 1544639212, "last_edit_date": 1545658047, "question_id": 53749198, "link": "https://stackoverflow.com/questions/53749198/initializating-members-of-structures-inside-union-in-class-constructor", "title": "Initializating members of structures inside union in class constructor", "body": "<p>I have problem with initializating members of structures inside union. Union is a class member. I would like to initialize int members a 0 value. I found some similar solutions, but they didn't help me to solve my problem. I mean solution like initialization list or other, not <code>m_union.structure1.value_s1 = 0</code></p>\n\n<p>I suppose I need to create constructors inside structures? How should it look? Could I initialize all members inside union's body? To not do that in class constructor after creating a class member?</p>\n\n<pre><code>typedef union U1\n{\n    struct S1\n    {\n        int value_s1;\n\n    }structure1;\n\n    struct S2\n    {\n       int value_s2;\n       int number_s2;\n\n    }structure2;\n\n    struct S3\n    {\n       int value_s3;\n       int number_s3;\n\n    }structure3;\n\n}UNION_TYPE;\n\n\nclass Test_Class\n{\npublic:\n    Test_Class();\n    UNION_TYPE m_union;\n};\n\n\nTest_Class::Test_Class()\n{\n\n}\n</code></pre>\n"}, {"tags": ["c++", "constants", "pass-by-reference"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1544638958, "post_id": 53749119, "comment_id": 94350807, "body": "You are thinking of <code>Sprite &amp; sprite = entity-&gt;GetSprite();</code> which won&#39;t compile."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 6, "creation_date": 1544638959, "post_id": 53749119, "comment_id": 94350809, "body": "<code>Sprite sprite = entity-&gt;GetSprite();</code> creates a <i>copy</i>, which is modifiable."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 2, "creation_date": 1544639136, "post_id": 53749119, "comment_id": 94350902, "body": "This is what you probably want: <code>const Sprite&amp; sprite = ...</code>"}, {"owner": {"reputation": 675, "user_id": 9115056, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03b215b328c73e80b4ddf39ebc75a79d?s=128&d=identicon&r=PG&f=1", "display_name": "jjmcc", "link": "https://stackoverflow.com/users/9115056/jjmcc"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1544639151, "post_id": 53749119, "comment_id": 94350905, "body": "Oh of course. @UnholySheep is there a way to prevent being able to make this copy so I don&#39;t unintentionally do this?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1544639298, "post_id": 53749119, "comment_id": 94350981, "body": "Pretty hard to prevent accidental copying short of explicitly removing the copy constructor and assignment operator. <code>Sprite (const Sprite  &amp;) = delete;</code> and <code>Sprite &amp;  operator=(const Sprite  &amp;) = delete;</code> This, of course, makes it harder to intentionally copy."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1544640574, "post_id": 53749119, "comment_id": 94351625, "body": "@jjmcc Since you didn&#39;t modify the object that you said shouldn&#39;t be modified, it&#39;s not clear why you&#39;d want to prevent it. Can you be more precise about exactly what you want to avoid? Is it the cost of the copy?"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 6, "last_activity_date": 1544640381, "creation_date": 1544640381, "answer_id": 53749471, "question_id": 53749119, "link": "https://stackoverflow.com/questions/53749119/how-do-i-correctly-return-an-unmodifiable-object-reference-from-function-in-c/53749471#53749471", "title": "How do I correctly return an unmodifiable object reference from function in C++?", "body": "<pre><code>Sprite sprite = entity-&gt;GetSprite();\n</code></pre>\n\n<p>this creates a copy of the <code>Sprite</code> object <code>GetSprite</code> returns, using the copy-consturctor of `Sprite.</p>\n\n<p>Editing the copy should not cause the original to be modified, unless you have written <code>Sprite</code> wrong, or you get confused between reference, value and pointer semantics.</p>\n\n<pre><code>Sprite const&amp; sprite = entity-&gt;GetSprite();\n</code></pre>\n\n<p>this gets a reference to the contained <code>Sprite</code> through which you cannot modify it.</p>\n\n<p>If you want to block copying of <code>Sprite</code>s, you can do:</p>\n\n<pre><code>Sprite(Sprite const&amp;) = delete;\n</code></pre>\n\n<p>but I'd advise allowing moving of <code>Sprite</code>s:</p>\n\n<pre><code>Sprite(Sprite&amp;&amp;) = default;\n</code></pre>\n\n<p>especially pre-<a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> (when guaranteed elision makes it less important).</p>\n"}], "owner": {"reputation": 675, "user_id": 9115056, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03b215b328c73e80b4ddf39ebc75a79d?s=128&d=identicon&r=PG&f=1", "display_name": "jjmcc", "link": "https://stackoverflow.com/users/9115056/jjmcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 53749471, "answer_count": 1, "score": 1, "last_activity_date": 1544640381, "creation_date": 1544638898, "question_id": 53749119, "link": "https://stackoverflow.com/questions/53749119/how-do-i-correctly-return-an-unmodifiable-object-reference-from-function-in-c", "title": "How do I correctly return an unmodifiable object reference from function in C++?", "body": "<p>I am trying to return a const object from a function so that I can get information from it, but nothing can be changed once it has been created. I have the following code</p>\n\n<pre><code>    Sprite const&amp; GetSprite() const {\n        return *m_sprite;\n    }\n\n\n    std::unique_ptr&lt;Sprite&gt; m_sprite;\n    int test = 5;\n</code></pre>\n\n<p>Somewhere else in the code I am calling this <code>GetSprite</code> function</p>\n\n<pre><code>Sprite sprite = entity-&gt;GetSprite();\nsprite.test = 6;\n</code></pre>\n\n<p>This seems to compile fine and after stepping through the value in <code>test</code> is actually changed. I would have assumed that the object returned from <code>GetSprite</code> would not allow me to modify the object, but the const qualifier seems to be dropped?</p>\n\n<p>Am I doing this wrong or is there a different approach to achieve this?</p>\n"}, {"tags": ["c++", "dictionary", "boost", "unordered-map"], "comments": [{"owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "edited": false, "score": 1, "creation_date": 1544641344, "post_id": 53748923, "comment_id": 94352022, "body": "First of all, you are asking a general community for a solution to a very specific problem. Not many people have the time or desire to dig into something this detailed, especially considering that it won&#39;t be useful to many other people. As an answer to your question, you seem to be doing the right thing with unordered_map. I guess you could get a higher speed if you read the whole file into memory (as a char array) and then manipulated it there. You could also try to avoid the boost tokenizer and do tokenizing yourself - but there is no telling how much faster it will be before you try it."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 1, "creation_date": 1544648392, "post_id": 53748923, "comment_id": 94355187, "body": "This might help you: <a href=\"https://stackoverflow.com/questions/34745078/improve-performance-of-accessing-elements-in-a-map-and-writing-to-a-file/34748845#34748845\" title=\"improve performance of accessing elements in a map and writing to a file\">stackoverflow.com/questions/34745078/&hellip;</a>"}, {"owner": {"reputation": 498, "user_id": 2302830, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yoc1c.jpg?s=128&g=1", "display_name": "Rahul Bhargava", "link": "https://stackoverflow.com/users/2302830/rahul-bhargava"}, "reply_to_user": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "edited": false, "score": 0, "creation_date": 1544677742, "post_id": 53748923, "comment_id": 94363119, "body": "@PlinyTheElder, I see. What would you suggest for tokenizing then?"}, {"owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "edited": false, "score": 0, "creation_date": 1544710997, "post_id": 53748923, "comment_id": 94379532, "body": "You could perform tokenizing with &quot;manual&quot; string handling - that is, cycling though characters and looking for separators. In your case, the separators are &#39;\\n&#39;, space, and &#39;:&#39;. It&#39;s not as convenient, but could be faster."}], "owner": {"reputation": 498, "user_id": 2302830, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yoc1c.jpg?s=128&g=1", "display_name": "Rahul Bhargava", "link": "https://stackoverflow.com/users/2302830/rahul-bhargava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544638061, "creation_date": 1544638061, "question_id": 53748923, "link": "https://stackoverflow.com/questions/53748923/parse-raw-data-fast-with-specific-format", "title": "Parse raw data fast with specific format", "body": "<p>I am searching ways to read a text file fast, really fast. I have thought of many solution but could not reach to an optimal one. Let me describe my problem and then I shall write the things I already tried.</p>\n\n<p>Problem statement:</p>\n\n<p>Say I have an 10G text file and the format of that file is:</p>\n\n<pre><code>___PART_1___\n*1 abc\n*2 def\n...\n&lt;5 million lines of this format&gt;\n*5000001 blah\n\n___PART_2___\n1 *1:1 *2:2 &lt;value1&gt;\n2 *3:1 *4:3 &lt;value2&gt;\n3 *4:2 *4:4 &lt;value3&gt;\n&lt;another 10 million lines of this format&gt;\n</code></pre>\n\n<p>In <strong>_PART_1_</strong>, There are two columns, ID and NAME.\nIn <strong>_PART_2_</strong>, There are 4 columns, Serial number, data1, data2, some_value</p>\n\n<p>What we want from this huge file is to get the data before colons from data1 and data2 column. In this case, we would want</p>\n\n<p>from 1st row of <strong>_PART_2_</strong>, extract *1 and *2, get the corresponding name from <strong>_PART_1_</strong> which is abc &amp; def in this case.\nfrom 2nd row of <strong>_PART_2_</strong>, extract *3 and *4, get the corresponding name from <strong>_PART_1_</strong> whatever they are.</p>\n\n<p>That is all information we want.</p>\n\n<p>Things to keep in consideration before we jump to conclusion:</p>\n\n<p>In <strong>_PART_1_</strong>, ID's might not be unique or consecutive and there could be any number of lines, 5 million is just an number.</p>\n\n<p>In <strong>_PART_2_</strong>, It is certain that there would be an entry in <strong>_PART_1_</strong> for the data before colons from data1 and data2 column of <strong>PART_2_</strong>.</p>\n\n<p>Tried so far:\nNumber 1 : I have tried keeping the <strong>_PART_1_</strong> into map but since the number of entries are quite big, balancing would itself take much time. So, I confirmed myself on unordered_map. Will write a good hashing function as well for it. And then whenever I reaches <strong>_PART_2_</strong>, tokenize that line, get second/third token, tokenize them again and get the data. Finally, look for them into the unordered_map. Used boost::tokenizer to tokenizer.</p>\n\n<p>Number 2 : Instead of boost::tokenizer, worked with regex_searches as well but they also seem to be slow.</p>\n\n<p>Number 2 : Mapped files to memory using mmap but since the file is huge, my program ran out of memory sometimes.</p>\n\n<p>Code snapshot, not full code:</p>\n\n<pre><code>typedef boost::tokenizer&lt;boost::char_separator&lt;char&gt; &gt; tokenizer;\ntypedef std::unordered_map&lt;std::string, std::string&gt; m_unordered;\ntypedef std::unordered_map&lt;std::string, std::string&gt;::iterator m_unordered_itr;\n\nint main() {\n  m_unordered un_name_map;\n  m_unordered_itr un_name_map_itr;\n  boost::char_separator&lt;char&gt; space_sep{\" \"};\n  std::ifstream myfile(\"file.txt\");\n  if (myfile.is_open()) {\n    std::string line;\n    bool part1_starts = 0;\n    bool part2_starts = 0;\n    while ( std::getline (myfile,line) ) {\n      if (line.find(\"___PART_1___\") != std::string::npos) {\n        part1_starts = 1;\n        continue;\n      }\n      if (mapping_starts) {\n        tokenizer tok{line, space_sep};\n        tokenizer::iterator it = tok.begin();\n        std::string index = *it++;\n        std::string value = *it;\n        un_name_map.insert(un_name_map.end(), {index, value});\n      }\n      if (line.find(\"___PART_2___\") != std::string::npos) {\n        part2_starts = 1;\n        part1_starts = 0;\n        continue;\n      }\n      if (part2_starts) {\n        tokenizer tok{line, space_sep};\n        tokenizer::iterator it_start = tok.begin();\n        // Ignore first token and advance\n        std::advance(it_start, 1);\n\n        // Split the second token which is my second column of ___PART_2___             vector&lt;std::string&gt; strs;\n        strs.reserve(2);\n        boost::split(strs, *it_start, boost::is_any_of(\":\"));\n        un_name_map_itr = un_name_map.find(strs[0]);\n        if (un_name_map_itr != un_name_map.end()) {\n         std::cout &lt;&lt; \"1. Name from the map is \" &lt;&lt; un_name_map_itr-&gt;second &lt;&lt; std::endl;\n        }\n\n        // Split the third token which is my third column of ___PART_2___\n        // Similar code as above.\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>I am sure that there are better ways to reach to the mentioned solution. I look forward to all of them.\nOnly and only thing I care about is 'SPEED'. I will be happy to write more details about it, if needed.</p>\n"}, {"tags": ["c++", "function"], "comments": [{"owner": {"reputation": 1521, "user_id": 16703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c7c9b54938b0332d53d81712b7260d1?s=128&d=identicon&r=PG", "display_name": "Bob_Gneu", "link": "https://stackoverflow.com/users/16703/bob-gneu"}, "edited": false, "score": 1, "creation_date": 1544638928, "post_id": 53748666, "comment_id": 94350789, "body": "As it currently stands, this code does not compile. <code>player1</code> is a function call and userCommand is not declared. <a href=\"https://gcc.godbolt.org/z/mowu2m\" rel=\"nofollow noreferrer\">gcc.godbolt.org/z/mowu2m</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10782135"}, "edited": false, "score": 0, "creation_date": 1544637276, "post_id": 53748710, "comment_id": 94349973, "body": "how would I do that?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1544637772, "post_id": 53748710, "comment_id": 94350226, "body": "@Dragon I encourage you to compile asking for all the warnings (e.g. g++ -Wall),doing that you are warn about &quot;while(!player1)&quot; and more"}], "tags": [], "owner": {"reputation": 11764, "user_id": 279130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5855748ea447bb6797fb04ccb6aa70bb?s=128&d=identicon&r=PG", "display_name": "jwismar", "link": "https://stackoverflow.com/users/279130/jwismar"}, "is_accepted": true, "score": 2, "last_activity_date": 1544637296, "last_edit_date": 1544637296, "creation_date": 1544637130, "answer_id": 53748710, "question_id": 53748666, "link": "https://stackoverflow.com/questions/53748666/program-doesnt-call-one-function-but-calls-other-functions/53748710#53748710", "title": "Program doesn&#39;t call one function but calls other functions", "body": "<p>You aren't calling player1, you're checking whether it (the function) exists. You need to pass parameters...</p>\n\n<p>so it would be:</p>\n\n<pre><code>while(!player1(m))\n</code></pre>\n\n<p>(What you have still compiles fine, because referring to a function by name is a valid construction -- it treats it as a pointer to the function itself -- and it gets converted to bool automatically, where null converts to false, and non-null converts to true.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10782135"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53748710, "answer_count": 1, "score": -5, "last_activity_date": 1544649528, "creation_date": 1544636980, "last_edit_date": 1544649528, "question_id": 53748666, "link": "https://stackoverflow.com/questions/53748666/program-doesnt-call-one-function-but-calls-other-functions", "title": "Program doesn&#39;t call one function but calls other functions", "body": "<p>everything compiles, but when I run the program, it seems to completely skip over the player1 function and goes directly to the printBoard function, when I ask for the variables needed in player1 before the loop, it takes them in and still skips the loop.   I previously had another bool function that worked just fine </p>\n\n<pre><code>#include&lt;iostream&gt; \n\nusing namespace std;\n\nchar board[9] = { 1, 2, 3, 4, 5, 6, 7, 8, 9 };\nvoid printBoard();\nbool player1(char);\nint main()\n{\n    char m;\n    char x;\n    char o;\n\n    cout &lt;&lt; \"Welcome to Tic- Tac- Toe!\" &lt;&lt; endl;\n    cout &lt;&lt; \"Choose your mode: \" &lt;&lt; endl;\n    cout &lt;&lt; \"1: Player vs Player\" &lt;&lt; endl;\n\n    cin &gt;&gt; userCommand;\n\n    if (userCommand == 1) {\n        cout &lt;&lt; \"Player vs Player\" &lt;&lt; endl;\n        cout &lt;&lt; \"Player 1 will use 'X'\" &lt;&lt; endl;\n        cout &lt;&lt; \"Player 2 will use 'O'\" &lt;&lt; endl;\n\n        printBoard();\n\n        while (!player1) {\n            cout &lt;&lt; \"Player 1 please enter space: \";\n            cin &gt;&gt; m;\n        }\n\n        printBoard();\n    }\n    else {\n        cout &lt;&lt; \"Player vs AI\";\n    }\n\n    return 0;\n}\n\nvoid printBoard()\n{\n    cout &lt;&lt; board[0] &lt;&lt; \"|\" &lt;&lt; board[1] &lt;&lt; \"|\" &lt;&lt; board[2] &lt;&lt; endl;\n    cout &lt;&lt; \"-\"\n         &lt;&lt; \" \"\n         &lt;&lt; \"-\"\n         &lt;&lt; \" \"\n         &lt;&lt; \"-\" &lt;&lt; endl;\n    cout &lt;&lt; board[3] &lt;&lt; \"|\" &lt;&lt; board[4] &lt;&lt; \"|\" &lt;&lt; board[5] &lt;&lt; endl;\n    cout &lt;&lt; \"-\"\n         &lt;&lt; \" \"\n         &lt;&lt; \"-\"\n         &lt;&lt; \" \"\n         &lt;&lt; \"-\" &lt;&lt; endl;\n    cout &lt;&lt; board[6] &lt;&lt; \"|\" &lt;&lt; board[7] &lt;&lt; \"|\" &lt;&lt; board[9] &lt;&lt; endl;\n}\n\nbool player1(char m)\n{\n    if (board[m] == m) {\n        board[m] = 'x';\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "eclipse"], "comments": [{"owner": {"reputation": 16538, "user_id": 6770384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kXCNG.png?s=128&g=1", "display_name": "Socowi", "link": "https://stackoverflow.com/users/6770384/socowi"}, "edited": false, "score": 3, "creation_date": 1544637015, "post_id": 53748636, "comment_id": 94349854, "body": "This has nothing to do with bash."}, {"owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "reply_to_user": {"reputation": 16538, "user_id": 6770384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kXCNG.png?s=128&g=1", "display_name": "Socowi", "link": "https://stackoverflow.com/users/6770384/socowi"}, "edited": false, "score": 0, "creation_date": 1544637068, "post_id": 53748636, "comment_id": 94349880, "body": "yes .. because i am testing this on bash and the problem is that assert is not working corectly on bash. because for every input bash doesn&#39;t give me any warning . i want it to give me any warning"}, {"owner": {"reputation": 16538, "user_id": 6770384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kXCNG.png?s=128&g=1", "display_name": "Socowi", "link": "https://stackoverflow.com/users/6770384/socowi"}, "edited": false, "score": 0, "creation_date": 1544637119, "post_id": 53748636, "comment_id": 94349897, "body": "So, are you saying it is working in another shell? Which one? (Just a rhetorical question. I&#39;m still pretty sure it is not related to bash. Imagine you asked something about cooking and that you burned your food. Would you tag the question as [knife] because you used a knife to cut the food?)"}, {"owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "reply_to_user": {"reputation": 16538, "user_id": 6770384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kXCNG.png?s=128&g=1", "display_name": "Socowi", "link": "https://stackoverflow.com/users/6770384/socowi"}, "edited": false, "score": 0, "creation_date": 1544637163, "post_id": 53748636, "comment_id": 94349919, "body": "i am using only bash for now and it is not working"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "edited": false, "score": 0, "creation_date": 1544637208, "post_id": 53748707, "comment_id": 94349945, "body": "so i should compile without -DNDEBUG ?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "edited": false, "score": 0, "creation_date": 1544637225, "post_id": 53748707, "comment_id": 94349953, "body": "@anna, That is correct."}, {"owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "edited": false, "score": 0, "creation_date": 1544637635, "post_id": 53748707, "comment_id": 94350153, "body": "do you know what i should add to my compile line so it would not tell me that nullPtr was not declared in this scope ?"}, {"owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "edited": false, "score": 0, "creation_date": 1544637660, "post_id": 53748707, "comment_id": 94350170, "body": "and thank you so much sir :)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "edited": false, "score": 0, "creation_date": 1544637776, "post_id": 53748707, "comment_id": 94350229, "body": "@anna, please create another post regarding <code>nullPtr</code>, with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "edited": false, "score": 0, "creation_date": 1544637825, "post_id": 53748707, "comment_id": 94350256, "body": "no it&#39;s ok ...."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1544637125, "creation_date": 1544637125, "answer_id": 53748707, "question_id": 53748636, "link": "https://stackoverflow.com/questions/53748636/assert-works-in-bash-for-every-input-i-give-it-even-if-its-wrong-how-to-fix-th/53748707#53748707", "title": "assert works in bash for every input I give it even if it&#39;s wrong? how to fix this?", "body": "<p>From <a href=\"https://en.cppreference.com/w/cpp/error/assert\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/error/assert</a>:</p>\n\n<blockquote>\n  <p>If <code>NDEBUG</code> is defined as a macro name at the point in the source code where  is included, then assert does nothing.</p>\n</blockquote>\n\n<p>Since you are compiling with <code>-DNDEBUG</code>, those statements are not doing anything at all.</p>\n"}], "owner": {"reputation": 107, "user_id": 5622745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771bfefd377d844d537f8b5ba0443068?s=128&d=identicon&r=PG&f=1", "display_name": "anna", "link": "https://stackoverflow.com/users/5622745/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "closed_date": 1544643490, "accepted_answer_id": 53748707, "answer_count": 1, "score": -1, "last_activity_date": 1544638265, "creation_date": 1544636860, "last_edit_date": 1544638265, "question_id": 53748636, "link": "https://stackoverflow.com/questions/53748636/assert-works-in-bash-for-every-input-i-give-it-even-if-its-wrong-how-to-fix-th", "closed_reason": "Needs details or clarity", "title": "assert works in bash for every input I give it even if it&#39;s wrong? how to fix this?", "body": "<p>I wrote a code using C++ and then wrote a main file to check it, and in this main file I used an assert to check if the values I get are true or not ...\nbut after a while I discovered I don't get any mistake on bash even though I entered wrong values. Anyone knows why? Or why such a thing happens?</p>\n\n<p>for example :</p>\n\n<pre><code>assert(numOfSegments == 1); // i don't get warning \n//but also\n\nassert(numOfSegments == 100); // also here no warning even though this is wrong\n</code></pre>\n\n<blockquote>\n  <p>//this is how i compile in bash : </p>\n  \n  <p>g++ -std=c++0x -DNDEBUG -g *.cpp</p>\n</blockquote>\n"}, {"tags": ["c++", "language-lawyer", "undefined-behavior", "object-lifetime", "placement-new"], "comments": [{"owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1544636666, "post_id": 53748543, "comment_id": 94349685, "body": "why are you trying to do  a-&gt;print() if a is not a pointer???"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1544636713, "post_id": 53748543, "comment_id": 94349718, "body": "This really isn&#39;t any different than <code>int foo; std::cout &lt;&lt; foo;</code>.  Sure, there is something in the memory but since you didn&#39;t initialize <code>foo</code> it is UB."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1544637202, "post_id": 53748543, "comment_id": 94349942, "body": "@\u03a6Xoc\u0119\uc6c3\u041fepe&#250;pa\u30c4 He&#39;s using placement new. Calling delete on this pointer would be undefined behavior because you would be invoking the wrong deallocation function\u2026"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1544637262, "post_id": 53748543, "comment_id": 94349969, "body": "@\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4 because I felt that among people who knew the answer, the exact code is irrelevant. It could have been pseudo code.  I&#39;ve now confirmed that everything compiles and runs: <a href=\"http://coliru.stacked-crooked.com/a/811f14a7692cb461\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/811f14a7692cb461</a>  I&#39;m calling the destructor directly because this question is about placement new, which requires direct destructor calls."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1544639011, "post_id": 53748543, "comment_id": 94350839, "body": "The behaviour is undefined because as soon you placement-new something into a region of memory, the lifetime of object(s) that used to live there ends."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1544639206, "post_id": 53748543, "comment_id": 94350942, "body": "@Mooing Duck that code is very fragile and depends on the compiler choices. For instance if you add a virtual method in A this will introduce an offset isn&#39;t it ?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544743556, "post_id": 53748543, "comment_id": 94394843, "body": "@n.m. Even a char? Everything is covered with char objects. Do their lifetime ends and begins again all the time?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1544743603, "post_id": 53748543, "comment_id": 94394864, "body": "@bruno &quot;<i>For instance if you add a virtual method in A</i>&quot; If you do it makes the class polymorphic and many things changes. In practice the class with need a vptr indeed."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1544743765, "post_id": 53748543, "comment_id": 94394894, "body": "Mirror question <a href=\"https://stackoverflow.com/q/11637611/963864\">After an object is destroyed, what happens to subobjects of scalar type?</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1544765560, "post_id": 53748543, "comment_id": 94399308, "body": "@curiousguy not sure, with char it could be unspecified."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1544773460, "post_id": 53748543, "comment_id": 94401905, "body": "@curiousguy <i>the class with need a vptr indeed</i> : yes, this is the reason of my remark"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1544823066, "post_id": 53748543, "comment_id": 94425887, "body": "@bruno: Clarified the code to make it clear this is a POD class."}], "answers": [{"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1544638515, "post_id": 53748984, "comment_id": 94350588, "body": "This is my reasoning too. Although I&#39;m annoyed that I can&#39;t get any of the sanitizers to complain about this code (then again I also can&#39;t get any of the sanitizers to complain about <code>int i; cout &lt;&lt; i;</code> so ... shrug)"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1544639643, "post_id": 53748984, "comment_id": 94351165, "body": "Unfortunately, this case is a bit hard for a sanitizer to detect. I guess the only way to do it in general would be to create some internal data structure that keeps track of every uninitialized object and generate code that queries that data structure upon every access to an lvalue anywhere in the program. Even for a sanitizer, that overhead might be a bit too massive\u2026"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1544639647, "post_id": 53748984, "comment_id": 94351167, "body": "Now I&#39;m idly wondering about assigning the buffer from the already initialized buffer it&#39;s built into: <a href=\"http://coliru.stacked-crooked.com/a/4c926413da81a529\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/4c926413da81a529</a> Curiously, G++ is not producing output for this variation."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 3, "creation_date": 1544640106, "post_id": 53748984, "comment_id": 94351389, "body": "I think this also constitutes UB because (as also noted by n.m. in his comment to your original question), the lifetime of the elements of your buffer has ended and their storage is being reused at the point your constructor is called\u2026"}], "tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": true, "score": 8, "last_activity_date": 1544639000, "last_edit_date": 1544639000, "creation_date": 1544638335, "answer_id": 53748984, "question_id": 53748543, "link": "https://stackoverflow.com/questions/53748543/is-it-undefined-behavior-to-initialize-data-before-placement-new/53748984#53748984", "title": "Is it undefined behavior to initialize data before placement new?", "body": "<p>Even though the class member and the array are guaranteed to have the same address in this particular case (based on <a href=\"http://eel.is/c++draft/basic.compound#4.3\" rel=\"noreferrer\">[basic.compound]/4.3</a> plus the fact that the <a href=\"http://eel.is/c++draft/expr.new#12\" rel=\"noreferrer\">requirements on <em>new-expression</em>s</a> don't really allow the compiler to do anything else than put that object right at the beginning of your buffer), I'm pretty sure this is undefined behavior.</p>\n\n<p>I believe the relevant bit of the standard would be <a href=\"http://eel.is/c++draft/basic.memobj#basic.indet-1\" rel=\"noreferrer\">basic.memobj \u00a71</a>:</p>\n\n<blockquote>\n  <p>When storage for an object with automatic or dynamic storage duration is obtained, the object has an indeterminate value, and if no initialization is performed for the object, that object retains an indeterminate value until that value is replaced ([expr.ass]).</p>\n</blockquote>\n\n<p>I'm not aware of any additional wording anywhere in the standard that would in any case give guarantees concerning the initial value of an object based on what was inside the storage it was created in before its lifetime began. Your object is default-initialized and of class type, therefore, the default constructor will be called. There is no <em>mem-initializer</em> for the member in your constructor nor is there a default initializer in the class, therefore, the member will be default-initialized <a href=\"http://eel.is/c++draft/class.base.init#9.3\" rel=\"noreferrer\">[class.base.init/9.3]</a>. Since the elements of the array are of fundamental type, <a href=\"http://eel.is/c++draft/dcl.init#7.3\" rel=\"noreferrer\">no initialization will be performed for them</a>. That means that <a href=\"http://eel.is/c++draft/basic.memobj#basic.indet-2\" rel=\"noreferrer\">basic.indet \u00a72</a> applies to any use of the contents of the array (which would happen inside the <code>operator &lt;&lt;</code>)</p>\n\n<blockquote>\n  <p>If an indeterminate value is produced by an evaluation, the behavior is undefined except in the following cases [\u2026]</p>\n</blockquote>\n\n<p>Since your case does not match any of the cases listed as exceptions, your program should have undefined behavior\u2026</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1544824088, "last_edit_date": 1544824088, "creation_date": 1544638359, "answer_id": 53748990, "question_id": 53748543, "link": "https://stackoverflow.com/questions/53748543/is-it-undefined-behavior-to-initialize-data-before-placement-new/53748990#53748990", "title": "Is it undefined behavior to initialize data before placement new?", "body": "<p>The state of the buffer after the object is constructed is undefined.  Compilers are free to write <code>\"format c;:\"</code> into it during construction of <code>A</code>.  They are also free to optimize your preloading of the buffer out, simply discarding what you did on that line.</p>\n\n<p>Your <code>print</code> code is then UB as <code>&lt;&lt;</code> expects a nul-terminated buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1544724495, "creation_date": 1544724495, "answer_id": 53767777, "question_id": 53748543, "link": "https://stackoverflow.com/questions/53748543/is-it-undefined-behavior-to-initialize-data-before-placement-new/53767777#53767777", "title": "Is it undefined behavior to initialize data before placement new?", "body": "<p>Although it would generally cost nothing for a compiler to interpret a placement new as \"importing\" whatever bit patterns happen to be in the storage before an object is constructed, there are some difficult-to-characterize corner cases where doing so may significantly complicate or impede optimization without offering any real benefit.  Thus, the Standard allows compilers to import the bit patterns in cases where it would cost nothing or would benefit their customers, without requiring them to do so in cases that would be expensive without benefiting their customers.</p>\n\n<p>While it would be helpful if there were a form of placement new syntax that would explicitly specify that bit patterns should be imported, such a thing wasn't seen as necessary when the Standard was written.  In most cases where importing bit patterns would be useful, it would cost nothing and compilers would do it whether mandated or not.  In cases where it would be useless, it wouldn't matter whether compilers supported the behavior.  Situations where such a syntax would result in compilers doing something useful that they wouldn't otherwise do were sufficiently rare that there was no need to accommodate them.</p>\n\n<p>Obviously, compiler philosophy has changed in the decades since placement new was first standardized, and situations where bitwise import would be useful but compilers wouldn't reliably support it are far more commonplace.  A sensible resolution would be to add two new syntactic forms--one which would require that a compiler import the bit pattern and another which would explicitly state that the bit pattern didn't matter--on the basis that the programmer will likely know more about whether the bit patterns matter than a compiler writer possibly could.  So far, however, that hasn't happened yet, leaving constructs like yours in the awkward state of being usefully supported by some implementations but not others, without any nice way of identifying implementations that support them.</p>\n"}], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 1, "accepted_answer_id": 53748984, "answer_count": 3, "score": 1, "last_activity_date": 1544824088, "creation_date": 1544636473, "last_edit_date": 1544823043, "question_id": 53748543, "link": "https://stackoverflow.com/questions/53748543/is-it-undefined-behavior-to-initialize-data-before-placement-new", "title": "Is it undefined behavior to initialize data before placement new?", "body": "<pre><code>struct A { //POD class\n    char data[10];\n    void print() {std::cout &lt;&lt; data;}\n};\nint main() {\n    char buffer[11] = \"HELLO\"; //sets values in buffer\n    A* a = new(buffer)A;\n    a-&gt;print(); // read from memory buffer\n    a-&gt;~A();\n}\n</code></pre>\n\n<p>From the class' perspective, this is a read from uninitialized memory, but from the memory perspective, the memory was actually initialized. Is this undefined behavior, or merely dangerous?</p>\n\n<p>[Note: For those curious about <a href=\"http://coliru.stacked-crooked.com/a/811f14a7692cb461\" rel=\"nofollow noreferrer\"><code>new(buffer)A</code> and <code>a-&gt;~A()</code></a>, This is called \"placement new\" and is used to construct objects in a specific buffer in memory. This is was <code>vector</code> does under the covers to construct classes in its internal buffer]</p>\n"}, {"tags": ["c++", "function-pointers", "unordered-map"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5935158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60af169110028c02d37015a214ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "xen20", "link": "https://stackoverflow.com/users/5935158/xen20"}, "edited": false, "score": 0, "creation_date": 1544638063, "post_id": 53748611, "comment_id": 94350365, "body": "I would prefer to use the second option (I want to keep the project a bit on the simpler side), but it doesn&#39;t compile, citing: &lt;error: must use \u2018.*\u2019 or \u2018-&gt;*\u2019 to call pointer-to-member function in \u2018iter.std::__detail::_Node_iterator&lt;std::pair&lt;const int, void &gt; ... and so on. I am of course aware that I must invoke on an object, but the syntax is killing me."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 43, "user_id": 5935158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60af169110028c02d37015a214ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "xen20", "link": "https://stackoverflow.com/users/5935158/xen20"}, "edited": false, "score": 0, "creation_date": 1544640938, "post_id": 53748611, "comment_id": 94351832, "body": "Oh yes indeed, missing parentheses."}, {"owner": {"reputation": 43, "user_id": 5935158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60af169110028c02d37015a214ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "xen20", "link": "https://stackoverflow.com/users/5935158/xen20"}, "edited": false, "score": 0, "creation_date": 1544641756, "post_id": 53748611, "comment_id": 94352230, "body": "That works beautifully. Thank you. If it is not a problem I would love if you could explain the syntax a bit - nevertheless, accepting!"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 43, "user_id": 5935158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60af169110028c02d37015a214ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "xen20", "link": "https://stackoverflow.com/users/5935158/xen20"}, "edited": false, "score": 1, "creation_date": 1544641939, "post_id": 53748611, "comment_id": 94352319, "body": "Of course. <code>(iter-&gt;second)</code> is to get the method. <code>.*</code> is the operator to make the method call, and we need to put parentheses <code>(t.*(iter-&gt;second))</code> to indicate this is what we want to &quot;call&quot;."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 0, "last_activity_date": 1544640947, "last_edit_date": 1544640947, "creation_date": 1544636780, "answer_id": 53748611, "question_id": 53748542, "link": "https://stackoverflow.com/questions/53748542/unordered-map-issue-using-class-member-function-pointer/53748611#53748611", "title": "Unordered map: issue using class member function pointer", "body": "<p>Use <code>std::invoke</code> from the header <code>functional</code> to execute it (C++17):</p>\n\n<pre><code>test t;\nstd::invoke(iter-&gt;second, t);\n</code></pre>\n\n<p>After all, you need to invoke it on an object. The method on its own cannot be executed.</p>\n\n<p>If you don't have C++17 (IIRC):</p>\n\n<pre><code>test t;\n(t.*(iter-&gt;second))();\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5935158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60af169110028c02d37015a214ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "xen20", "link": "https://stackoverflow.com/users/5935158/xen20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 53748611, "answer_count": 1, "score": 0, "last_activity_date": 1544640947, "creation_date": 1544636473, "question_id": 53748542, "link": "https://stackoverflow.com/questions/53748542/unordered-map-issue-using-class-member-function-pointer", "title": "Unordered map: issue using class member function pointer", "body": "<p>I have the following problem: I am writing a simple chip8 emulator, and have a massive class of interpreter functions that I would like to access via opcodes as keys, such as with a dictionary. That is to replace a massive switch case, and I understand that for that purpose, an unordered map is a nice tool to use. </p>\n\n<p>This approach works easily with just functions (because of their static scope, I assume), but does not with classes, because of the same concept of scope. I am somewhat new to pointers and C++ itself, and am not sure how to resolve the issue (having tried a lot of stuff, e.g making member functions static, pointing to a class instance of the function and such - these will not compile). Accessing iter->second returns nothing at all, even though map.count says that the member exists.</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;unordered_map&gt;\n\nclass test{\npublic:\n    test();\n    void fptr(void);\n};\n\nvoid test::fptr(void){\n    printf(\"fptr\\n\");\n}\n\ntypedef void (test::*Interpreter)(void);\ntypedef std::unordered_map&lt;int, Interpreter&gt; fmap;\n\nint main(void){\n    fmap map;\n    int input = 0;\n\n    map.emplace(1, &amp;test::fptr);\n\n    printf(\"input int to access:\\n\");\n    scanf(\"%i\", &amp;input);\n\n    auto iter = map.find(input);\n    if(iter == map.end() ){\n        printf(\"No such function\\n\");\n    }\n    else{\n        iter-&gt;second; //iter-&gt;second() will not compile, accessing like this returns nothing\n    }\n\n//checks that the emplaced function actually exists\n    for (auto&amp; x: {1}) {\n    if (map.count(x)&gt;0){ \n        printf(\"map has %i\\n\", x);\n    }\n    else {\n        printf(\"map has no %i\\n\", x);\n    }\n\n    return 0\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544636417, "post_id": 53748373, "comment_id": 94349542, "body": "Is there a point of resolve beyond how it is used here? As it is, it just prevents overloading that the compiler could already do, based on your example."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544636478, "post_id": 53748373, "comment_id": 94349569, "body": "If the user-defined <code>foo</code> is declared before the include of your library, does it work?"}, {"owner": {"reputation": 19146, "user_id": 635654, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b8fb58eef98caeec6ab3366e0ac986d7?s=128&d=identicon&r=PG", "display_name": "CygnusX1", "link": "https://stackoverflow.com/users/635654/cygnusx1"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544636630, "post_id": 53748373, "comment_id": 94349662, "body": "@PhilM I don&#39;t understand your first question? There is a point for the existence of <code>resolve</code>, it does some complex work. But I cut it out to make the example simple. <code>foo</code> could be defined before the inclusion of a library, and this might work, but you don&#39;t normally put any code before the <code>#include</code> directives, do you?"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544636824, "post_id": 53748373, "comment_id": 94349772, "body": "Sure, people normally put code (in other include files) before includes all the time :) You&#39;d just require your users to include a header file declaring other overloads before including your header file. Bit messy, perhaps."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544639026, "post_id": 53748373, "comment_id": 94350849, "body": "@PhilM &quot;Bit messy&quot;? Rather &quot;untenable&quot; I would say. Depending on include ordering is always horrifying."}], "answers": [{"comments": [{"owner": {"reputation": 19146, "user_id": 635654, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b8fb58eef98caeec6ab3366e0ac986d7?s=128&d=identicon&r=PG", "display_name": "CygnusX1", "link": "https://stackoverflow.com/users/635654/cygnusx1"}, "edited": false, "score": 0, "creation_date": 1544637328, "post_id": 53748585, "comment_id": 94350001, "body": "So, there is no way to force using a second-phase lookup on <code>foo</code>? After all, overloading does depend on the argument being <code>T</code>..."}, {"owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 1, "creation_date": 1544637423, "post_id": 53748585, "comment_id": 94350045, "body": "@MaxLanghof <code>foo(arg)</code> is dependent, declaration visible at template definition are considered and those that are visible at instantiation context if ADL were to be used."}, {"owner": {"reputation": 19146, "user_id": 635654, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b8fb58eef98caeec6ab3366e0ac986d7?s=128&d=identicon&r=PG", "display_name": "CygnusX1", "link": "https://stackoverflow.com/users/635654/cygnusx1"}, "edited": false, "score": 0, "creation_date": 1544638222, "post_id": 53748585, "comment_id": 94350448, "body": "@MaxLanghof With the links regarding std function template specializaiton in C++20 - they want to prohibit that and force users to use a more verbose solution with more boilerplate code. I wonder why they can&#39;t just change how function overloading works in C++20 instead..."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 19146, "user_id": 635654, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b8fb58eef98caeec6ab3366e0ac986d7?s=128&d=identicon&r=PG", "display_name": "CygnusX1", "link": "https://stackoverflow.com/users/635654/cygnusx1"}, "edited": false, "score": 0, "creation_date": 1544638872, "post_id": 53748585, "comment_id": 94350756, "body": "@CygnusX1 You&#39;re free to make a proposal how function overloading should work in your eyes. Do consider the impacts on existing code and the usability in templated libraries though. I agree that the C++20 way will involve annoying amounts of boilerplate, but the existing overloading rules aren&#39;t just randomly thrown together. It&#39;s a pretty fine-tuned machinery, you can&#39;t just &quot;change how it works&quot; that easily."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 4, "last_activity_date": 1544639093, "last_edit_date": 1592644375, "creation_date": 1544636667, "answer_id": 53748585, "question_id": 53748373, "link": "https://stackoverflow.com/questions/53748373/function-overloading-order-of-definitions/53748585#53748585", "title": "Function overloading - order of definitions", "body": "<p>The rules regarding name lookups in templates are detailed <a href=\"https://en.cppreference.com/w/cpp/language/unqualified_lookup\" rel=\"nofollow noreferrer\">here</a>:</p>\n<blockquote>\n<p>For a dependent name used in a template definition, the lookup is postponed until the template arguments are known, at which time ADL examines function declarations [...] that are visible from the template definition context as well as in the template instantiation context, while non-ADL lookup only examines function declarations [...] that are visible from the template definition context (<strong>in other words, adding a new function declaration after template definition does not make it visible except via ADL</strong>).</p>\n</blockquote>\n<p>There are thus two options for you:</p>\n<ul>\n<li><p>Users can only invoke your <code>resolve</code> with arguments that either have the specialization provided by you (by default) or that can be found via <a href=\"https://en.cppreference.com/w/cpp/language/adl\" rel=\"nofollow noreferrer\">Argument Dependent Lookup</a>. Basically, they must define their overloads in the same namespace as the types they pass.</p>\n<p>Example: <a href=\"https://godbolt.org/z/KCaO-s\" rel=\"nofollow noreferrer\">https://godbolt.org/z/KCaO-s</a></p>\n</li>\n<li><p>You make <code>foo</code> a template which users can specialize. You provide your own (default) specializations, the user can later provide theirs and <code>resolve</code> will choose the best template specialization available <em>at the point of instantiation</em> for <code>resolve</code> (i.e. where <code>resolve</code> is called).</p>\n<p>Example: <a href=\"https://godbolt.org/z/AYn7FM\" rel=\"nofollow noreferrer\">https://godbolt.org/z/AYn7FM</a></p>\n</li>\n</ul>\n<hr />\n<p><em>Addendum:</em><br />\nThe standard library has a very similar problem; see e.g. <a href=\"https://en.cppreference.com/w/cpp/language/extending_std\" rel=\"nofollow noreferrer\">here</a> for how customizing e.g. <code>std::swap</code> behavior by users is achieved (as in, allowed). Note in particular that with C++20, function template specializations are no longer allowed (only class template specializations). The reasons for that are detailed in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0551r1.pdf\" rel=\"nofollow noreferrer\">the corresponding paper</a>. While the above advice is more comfortable for users than requiring class specializations everywhere, you should probably look into the reasons why the standard library decided to take a more extreme stance.</p>\n"}], "owner": {"reputation": 19146, "user_id": 635654, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b8fb58eef98caeec6ab3366e0ac986d7?s=128&d=identicon&r=PG", "display_name": "CygnusX1", "link": "https://stackoverflow.com/users/635654/cygnusx1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 53748585, "answer_count": 1, "score": 6, "last_activity_date": 1544639093, "creation_date": 1544635792, "last_edit_date": 1544637033, "question_id": 53748373, "link": "https://stackoverflow.com/questions/53748373/function-overloading-order-of-definitions", "title": "Function overloading - order of definitions", "body": "<p>I am trying to create a library which has some complex <code>resolve</code> function, that calls a simple <code>foo</code> function. The <code>resolve</code> function should work for any type for which <code>foo</code> is overloaded.</p>\n\n<p>The <code>foo</code> provided in the library works with some basic types, but I want the user to be able to provide its own, overloaded versions of <code>foo</code> that could be used in <code>resolve</code>.</p>\n\n<p>Here is a very short example:</p>\n\n<pre><code>//IN THE LIBRARY\n#include &lt;iostream&gt;\n\nvoid foo(int i) { std::cout &lt;&lt; \"int \" &lt;&lt; i; }\nvoid foo(float f) { std::cout &lt;&lt; \"float \" &lt;&lt; f; }\n\ntemplate &lt;typename T&gt;\nvoid resolve(T arg) {\n    //some complex computation\n    foo(arg);\n    //some more complutation\n}\n\n//IN THE USER CODE\n\nvoid foo(const char* c) { std::cout &lt;&lt; \"cstring \" &lt;&lt; c; }\n\nint main() {\n    resolve(3);\n    resolve(4.2f);\n    resolve(\"abc\");\n    return 0;\n}\n</code></pre>\n\n<p>The problem is, that the user-defined overload for <code>foo</code> appears after the definition of <code>resolve</code> and it is not seen. I was expecting that at the time of instantiation <code>resolve&lt;const char*&gt;</code> the 3-rd overload of <code>foo</code> would be seen &ndash; but that is seems not to be the case:</p>\n\n<pre><code>prog.cpp: In instantiation of \u2018void resolve(T) [with T = const char*]\u2019:\nprog.cpp:16:15:   required from here\nprog.cpp:8:5: error: invalid conversion from \u2018const char*\u2019 to \u2018int\u2019 [-fpermissive]\n  foo(arg);\n  ~~~^~~~~\nprog.cpp:3:6: note:   initializing argument 1 of \u2018void foo(int)\u2019\n void foo(int i) { std::cout &lt;&lt; \"int \" &lt;&lt; i; }\n      ^~~\n</code></pre>\n\n<p>So, my question is, how can I make it work? Is there some easy way of having parts of <code>resolve</code> to be user-provided (e.g. in terms of <code>foo</code> overloading)?</p>\n\n<p>Some constraints:</p>\n\n<ul>\n<li>I want it to be resolved at compile-time.</li>\n<li>It should be as simple as possible in user code. For example, having <code>resolve</code> take an additional lambda parameter &ndash; which should always be the same for a given type of <code>arg</code> &ndash; is too complex in use.</li>\n</ul>\n\n<p>The use scenario is similar to overloading the <code>std::less</code> for given custom <code>T</code>, and then using <code>std::sort</code> without taking any additional arguments, besides the array of <code>T</code> that should be sorted.</p>\n"}, {"tags": ["c++", "promise", "future"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1544635894, "post_id": 53748331, "comment_id": 94349242, "body": "Where does the exception get thrown?"}, {"owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1544636189, "post_id": 53748331, "comment_id": 94349399, "body": "for me is working... <a href=\"https://ideone.com/Yh4Hzr\" rel=\"nofollow noreferrer\">ideone.com/Yh4Hzr</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 3, "creation_date": 1544636619, "post_id": 53748463, "comment_id": 94349659, "body": "This is very interesting. How come there is no link-time error? Also, what does <code>-pthreads</code> flag mean and how is it different from <code>-lpthread</code>?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1544636734, "post_id": 53748463, "comment_id": 94349728, "body": "@r3musn0x I think <code>-pthreads</code> (compiler flag) may set internal compiler MACROS or other magic that may impact the standard library headers whereas <code>-lpthread</code> (linker flag) will only link the library object."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1544638230, "post_id": 53748463, "comment_id": 94350453, "body": "AFAIK, <code>-pthreads</code> is like <code>-D_REENTRANT</code> for the compiler plus <code>-lpthread</code> for the linker, but the details may vary per architecture. About why it does not fail the linker, I don&#39;t know, but I think it may be related to pthreads being a shared object."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": true, "score": 5, "last_activity_date": 1544638235, "last_edit_date": 1544638235, "creation_date": 1544636171, "answer_id": 53748463, "question_id": 53748331, "link": "https://stackoverflow.com/questions/53748331/how-am-i-misusing-c-promises-and-futures-here/53748463#53748463", "title": "How am I misusing C++ promises and futures here?", "body": "<p><code>std::promise</code> is part of the C++ threading support, even though you are using it in a non thread way.</p>\n\n<p>So you have to use the compiler option <code>-pthread</code>:</p>\n\n<pre><code>clang++ -pthread main.cpp\n</code></pre>\n"}], "owner": {"reputation": 23688, "user_id": 1256041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/NJUNN.jpg?s=128&g=1", "display_name": "sdgfsdh", "link": "https://stackoverflow.com/users/1256041/sdgfsdh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 53748463, "answer_count": 1, "score": 3, "last_activity_date": 1544638235, "creation_date": 1544635604, "question_id": 53748331, "link": "https://stackoverflow.com/questions/53748331/how-am-i-misusing-c-promises-and-futures-here", "title": "How am I misusing C++ promises and futures here?", "body": "<p>Here is my code, <code>main.cpp</code>: </p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;future&gt;\n\nint main() {\n  using namespace std;\n\n  auto p = promise&lt;string&gt;();\n\n  p.set_value(\"Hello, world. \");\n\n  auto f = p.get_future();\n\n  cout &lt;&lt; f.get() &lt;&lt; endl;\n\n  return 0;\n}\n</code></pre>\n\n<p>Here is the error: </p>\n\n<pre><code>./a.out    \nterminate called after throwing an instance of 'std::system_error'              \n  what():     \n    Unknown error -1  [1]  \n\n15195 abort (core dumped)  ./a.out\n</code></pre>\n\n<p>My compiler version: </p>\n\n<pre><code>$ clang++ --version \nclang version 7.0.0-3 (tags/RELEASE_700/final)  \nTarget: x86_64-pc-linux-gnu \nThread model: posix InstalledDir: /usr/bin\n</code></pre>\n\n<p>My compilation command: </p>\n\n<pre><code>$ clang++ ./main.cpp &amp;&amp; ./a.out\n</code></pre>\n"}, {"tags": ["c++", "sockets", "pthreads", "gtkmm"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544635579, "post_id": 53748273, "comment_id": 94349071, "body": "I don&#39;t know much about GTK but you should generally don&#39;t do time consuming work in GUI event handlers, like waiting for incomming connections on sockets. Create a thread for things like that."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1544639004, "post_id": 53748273, "comment_id": 94350834, "body": "But launching a thread and just after that waiting for it to finish will not add any paralellism to your program: you are still waiting fo the network!"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1544647890, "post_id": 53748273, "comment_id": 94354999, "body": "@rodrigo Of course. The result from the thread needs to be synchronized into the main flow somehow. GTK may even have some built-in mechanism for doing just that, start a task and let the result be signaled back, whenever the task is finished."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 2, "creation_date": 1544648020, "post_id": 53748273, "comment_id": 94355047, "body": "@TedLyngmo: Indeed, GTK uses Glib, and Glib has that GIO to do fully asynchronous network. I&#39;m not too familiar with GTKmm, but I bet there is a GIOmm somewhere..."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544648935, "post_id": 53748273, "comment_id": 94355409, "body": "@Flo The new codes <code>listening_thread.join();</code> willl still block the event handler from returning until there&#39;s a connection. Look for support for asynchronous operations in GTKmm as rodrigo says."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544649270, "post_id": 53748273, "comment_id": 94355554, "body": "Perhaps <a href=\"https://developer.gnome.org/gtkmm-tutorial/unstable/gtkmm-tutorial.html\" rel=\"nofollow noreferrer\">29.3.\u2003Example</a> is a good place to start."}], "owner": {"reputation": 65, "user_id": 10363533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b6d94de6ba7985d9f9e7f318110572a?s=128&d=identicon&r=PG&f=1", "display_name": "Flo", "link": "https://stackoverflow.com/users/10363533/flo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544638004, "creation_date": 1544635351, "last_edit_date": 1544638004, "question_id": 53748273, "link": "https://stackoverflow.com/questions/53748273/c-gtkmm-buttons-onclick-method-blocks-text-change", "title": "C++ Gtkmm buttons onclick method blocks text change", "body": "<p>So I have a Gtkmm Application, which should listen for the next connection requests and change the text of another Gtk Widget <code>status</code> to \"Listening...\", as soon as the user clicks a button. </p>\n\n<p>The buttons onclick method looks as the following: </p>\n\n<pre><code>status.set_text(\"Listening...\");\n\nif(nh.listen()&lt;0){\n      status.set_text(\"Not connected.\");\n      return;\n}\nstatus.set_text(\"Connected\");\n</code></pre>\n\n<p>Where <code>nh.listen()</code> is a blocking method which first binds the socket, then listens and accepts an incoming connection:</p>\n\n<pre><code>soc = socket(AF_INET, SOCK_STREAM, 0);\n\n\nstruct sockaddr_in local_addr;\n\nmemset(&amp;local_addr, 0, sizeof(local_addr));\nlocal_addr.sin_family = AF_INET;\nlocal_addr.sin_addr.s_addr = INADDR_ANY;\nlocal_addr.sin_port = htons(6666);\n\nif(bind(soc, (struct sockaddr*) &amp;local_addr, sizeof(local_addr))&lt;0){\n    return -1;\n}\n\nif(::listen( soc , 1) == -1){\n    return -1;\n}\n\nstruct sockaddr_in client;\nsocklen_t size = sizeof(client);\nint socket_accept = ::accept(soc, (struct sockaddr*) &amp;client, &amp;size);\n\nsoc = socket_accept;\nreturn 0;\n</code></pre>\n\n<p>The behavior I'd expect is that the text of <code>status</code> widget gets changed before <code>nh.listen()</code> is called and blocking the thread, but instead the thread gets just blocked. </p>\n\n<p>Now my assumption is that the onclick method somehow blocks all other calls/changes of Gtk widgets and I'm wondering how I'd be able to achieve the desired behavior.</p>\n\n<p>---- Edit ------</p>\n\n<p>Considering @Ted Lyngmo 's comment I restructured the code as follows:</p>\n\n<pre><code> void frame::onclick_listen(){\n     std::thread listening_thread(&amp;frame::listening_thread_fun, this);\n     status.set_text(\"Listening...\");\n     listening_thread.join();\n  }\n\n\n\n\n void frame::listening_thread_fun(){\n      if(nh.listen()&lt;0){\n            //Error   \n            status.set_text(\"Not connected.\");\n            return;\n      }\n      status.set_text(\"Connected\");\n }\n</code></pre>\n\n<p>But nothing really changes. Since the connection is needed in order to continue I called the thread join() just after the text-change. Which means that the onclick method is still in scope when I try to change the text and thus probably blocking it. So what would be the best practice for the call of join()?</p>\n"}, {"tags": ["c++", "templates", "reference", "bind", "dispatcher"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1544634890, "post_id": 53747991, "comment_id": 94348622, "body": "I don&#39;t know whether what you are doing is sound, but the only compilation error I get is because <code>instances</code> should be of type <code>std::list&lt;std::pair&lt;void(*)(void*, std::ostream &amp; os), void *&gt;&gt;</code> the way you are using it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544635211, "post_id": 53747991, "comment_id": 94348822, "body": "@MatthieuBrucher I think the duplicate does not apply. OP is not trying to store a non-static member function address in a function pointer anywhere."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544635507, "post_id": 53747991, "comment_id": 94349019, "body": "@user10605163 fair enough, retracted."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544635786, "post_id": 53747991, "comment_id": 94349184, "body": "Still, sounds to be that what he wants is to call non static members."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 6722680, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WMnO2.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6722680/michael"}, "edited": false, "score": 0, "creation_date": 1544636373, "post_id": 53748438, "comment_id": 94349516, "body": "Works like a charm now! Should be using 17 more often :)"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 177, "user_id": 6722680, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WMnO2.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6722680/michael"}, "edited": false, "score": 0, "creation_date": 1544636467, "post_id": 53748438, "comment_id": 94349562, "body": "It&#39;s only invoke, which can be done by hand. The main thing is lambdas and <code>std::function</code>s ;)"}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 2, "last_activity_date": 1544636078, "creation_date": 1544636078, "answer_id": 53748438, "question_id": 53747991, "link": "https://stackoverflow.com/questions/53747991/c-dispatcher-argument-passing/53748438#53748438", "title": "C++ dispatcher argument passing", "body": "<p>You are using methods and not functions, so casting the instance as void is bad practice, using C-style casts.</p>\n\n<p>Instead, C++ has <code>std::function</code> and lambdas:</p>\n\n<pre><code>namespace trd {\n\n  struct dispatcher {\n    public:\n      template&lt;typename C, void(C::*M)(std::ostream &amp; os) = &amp;C::update&gt;\n        void bind(C * instance) {\n          instances.push_back([=](std::ostream &amp; os){std::invoke(M, instance, os);});\n        }\n\n      void operator () (std::ostream &amp; os) {\n        for (auto &amp; instance : instances)\n          std::invoke(instance, os);\n      }\n\n    private:\n      std::list&lt;std::function&lt;void(std::ostream &amp; os)&gt;&gt; instances;\n  };\n}\n</code></pre>\n\n<p>Using C++17 for <code>std::invoke</code>.</p>\n"}], "owner": {"reputation": 177, "user_id": 6722680, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WMnO2.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6722680/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 53748438, "answer_count": 1, "score": 2, "last_activity_date": 1544636192, "creation_date": 1544634339, "last_edit_date": 1544636192, "question_id": 53747991, "link": "https://stackoverflow.com/questions/53747991/c-dispatcher-argument-passing", "title": "C++ dispatcher argument passing", "body": "<p>I've a simple dispatcher struct which won't compile and honestly, I don't have any clue why.</p>\n\n<p>So I created a dispatcher which you can bind a function to called update, it will invoke a static member function called invoke which dereferences the objects instance and calls the method with a simple <code>std::ostream</code> ref.</p>\n\n<p>For some reason this doesn't compile, but it looks right to me.\nThe compiler won't give any good output :/</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;utility&gt;\n\nnamespace trd {\n\n  struct dispatcher {\n    public:\n      template&lt;typename C, void(C::*M)(std::ostream &amp; os) = C::update&gt;\n        static void invoke(void * instance, std::ostream &amp; os) {\n          (static_cast&lt;C*&gt;(instance)-&gt;*M)(os);\n        }\n\n      template&lt;typename C, void(C::*M)(std::ostream &amp; os) = &amp;C::update&gt;\n        void bind(C * instance) {\n          instances.push_back(std::make_pair(&amp;invoke&lt;C, M&gt;, instance));\n        }\n\n      void operator () (std::ostream &amp; os) {\n        for (auto &amp; instance : instances)\n          (instance.first)(instance.second, os);\n      }\n\n    private:\n      std::list&lt;std::pair&lt;void(*)(std::ostream &amp; os), void *&gt;&gt; instances;\n  };\n\n}\n\nstruct test {\n  public:\n    void update(std::ostream &amp; os) { os &lt;&lt; \"foo\"; }\n};\n\nint main() {\n  trd::dispatcher dp;\n\n  test t;\n\n  dp.bind(&amp;t);\n\n  dp(std::cout);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "uwp"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544634117, "post_id": 53747916, "comment_id": 94348256, "body": "This happened after a clean rebuild?"}, {"owner": {"reputation": 2055, "user_id": 10733631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z9f47Aj3ez4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j0jfocyr5e1Wd0v4q8aluK_b7B5Q/mo/photo.jpg?sz=128", "display_name": "Dmytro Dadyka", "link": "https://stackoverflow.com/users/10733631/dmytro-dadyka"}, "edited": false, "score": 0, "creation_date": 1544634639, "post_id": 53747916, "comment_id": 94348507, "body": "Try manually delete all output binary files (*.obj, *.exe), hidden .vs directory and solution .db files. This can help."}, {"owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "edited": false, "score": 0, "creation_date": 1544636032, "post_id": 53747916, "comment_id": 94349321, "body": "This happens after a &quot;Clean&quot; and &quot;Rebuild&quot;.  I have tried for over a day to get this to work."}, {"owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "edited": false, "score": 0, "creation_date": 1545668015, "post_id": 53747916, "comment_id": 94674243, "body": "I put the target back a few revisions and it worked.  Not a great solution."}], "owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544634160, "creation_date": 1544634063, "last_edit_date": 1544634160, "question_id": 53747916, "link": "https://stackoverflow.com/questions/53747916/visual-studio-c-code-gets-a-redefinition-error", "title": "Visual Studio C++ code gets a redefinition error", "body": "<p>After a system crash, I reinstalled VS and brought up my solution.  Now it gets a redefinition error in Microsoft code.  Example output below:</p>\n\n<pre><code>2&gt;Compressor.xaml.cpp\n....\n2&gt;c:\\program files (x86)\\windows kits\\10\\include\\10.0.17763.0\\winrt\\windows.foundation.numerics.h(349): warning C4099: 'Windows::Foundation::Numerics::Rational': type name first seen using 'class' now seen using 'struct' (compiling source file Compressor.xaml.cpp)\n2&gt;c:\\program files (x86)\\windows kits\\10\\include\\10.0.17763.0\\winrt\\windows.foundation.numerics.h(567): error C2371: 'ABI::Windows::Foundation::Numerics::Rational': redefinition; different basic types (compiling source file Compressor.xaml.cpp)\n2&gt;c:\\program files (x86)\\windows kits\\10\\include\\10.0.17763.0\\winrt\\windows.foundation.numerics.h(349): note: see declaration of 'ABI::Windows::Foundation::Numerics::Rational' (compiling source file Compressor.xaml.cpp)\n2&gt;c:\\program files (x86)\\windows kits\\10\\include\\10.0.17763.0\\winrt\\windows.foundation.numerics.h(349): warning C4099: 'Windows::Foundation::Numerics::Rational': type name first seen using 'class' now seen using 'struct' (compiling source file CommonToolBar.xaml.cpp)\n</code></pre>\n\n<p>FYI: I don't use rational in my code.  </p>\n\n<p>The project is dead until this is fixed.  Ideas?  </p>\n"}, {"tags": ["c++", "file", "resources"], "comments": [{"owner": {"reputation": 2055, "user_id": 10733631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z9f47Aj3ez4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j0jfocyr5e1Wd0v4q8aluK_b7B5Q/mo/photo.jpg?sz=128", "display_name": "Dmytro Dadyka", "link": "https://stackoverflow.com/users/10733631/dmytro-dadyka"}, "edited": false, "score": 1, "creation_date": 1544633900, "post_id": 53747837, "comment_id": 94348156, "body": "The most obvious problem is that you are aimlessly taking up RAM."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1544635203, "post_id": 53747837, "comment_id": 94348815, "body": "To do that can decrease the readability of your program, a piece of code and where it is must have a &#39;good&#39; reason, else it is difficult for some else (or you later when you will forget the details) to understand the code if there is no underlying logic."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1544635301, "post_id": 53747837, "comment_id": 94348888, "body": "It sounds a bit to me like you would have a lot of globals hanging around which is usually not a good design."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 9258430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MtcgW.png?s=128&g=1", "display_name": "Vladimir A.", "link": "https://stackoverflow.com/users/9258430/vladimir-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1544635063, "creation_date": 1544635063, "answer_id": 53748193, "question_id": 53747837, "link": "https://stackoverflow.com/questions/53747837/any-disadvantage-of-storing-file-handles-over-whole-program-execution/53748193#53748193", "title": "Any disadvantage of storing file handles over whole program execution?", "body": "<p>In general I don't see any significant problems with such approach. But in special cases you can get problems. Conflict can happen when somebody else will decide to use the same files. </p>\n\n<ul>\n<li><p>you run your program twice and second processes will try to open the same files</p></li>\n<li><p>system services can affect files. Maybe you have cron set up to archive your files</p></li>\n<li><p>you open file for writing. File is created, but nothing is written there. As a result you generated empty file without reason</p></li>\n</ul>\n\n<p>And anyway it is a good manner not to reserve resource if you don't need it. </p>\n"}], "owner": {"reputation": 689, "user_id": 9185797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HJqOX.jpg?s=128&g=1", "display_name": "Phins", "link": "https://stackoverflow.com/users/9185797/phins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53748193, "answer_count": 1, "score": 0, "last_activity_date": 1544635063, "creation_date": 1544633788, "question_id": 53747837, "link": "https://stackoverflow.com/questions/53747837/any-disadvantage-of-storing-file-handles-over-whole-program-execution", "title": "Any disadvantage of storing file handles over whole program execution?", "body": "<p>Im currently working on a projects which maps all avaible resources (files) at beginning of its execution. Many of the resources might be used later but are not needed at the beginning. The resources can be read, modified and newly created.</p>\n\n<p>Would there be any disadvantage of reserving all eventually needed files and storing their file handles for later? (ps. the resources are only used by this program and should not be modified externally)</p>\n"}, {"tags": ["c++", "c++11", "variadic-templates"], "answers": [{"tags": [], "owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "is_accepted": false, "score": 0, "last_activity_date": 1544635048, "creation_date": 1544635048, "answer_id": 53748190, "question_id": 53747784, "link": "https://stackoverflow.com/questions/53747784/how-does-this-variadic-template-with-using-work/53748190#53748190", "title": "How does this variadic template with using work?", "body": "<ol>\n<li><p><code>General&lt;typename BaseHelper&lt;Types... &gt;::BaseType</code> access the <code>using BaseType = General&lt;GenBase&gt;</code> type, which has access to the <code>void BaseClass()</code> function.</p></li>\n<li><p>Using that constructor would call the <code>BaseHelper &lt;Type, Types...&gt;</code>, so you would get <code>BaseHelper</code> with <code>Type = int</code> and <code>Types = float, Test</code>, which would make a <code>General</code> type with <code>Types = float, Test</code>.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 7355932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c310506b06aa3cfaeedccae2aca20f?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7355932/eugene"}, "edited": false, "score": 0, "creation_date": 1544649780, "post_id": 53751117, "comment_id": 94355736, "body": "Thanks a lot for your answer!"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 0, "last_activity_date": 1544647741, "last_edit_date": 1592644375, "creation_date": 1544647741, "answer_id": 53751117, "question_id": 53747784, "link": "https://stackoverflow.com/questions/53747784/how-does-this-variadic-template-with-using-work/53751117#53751117", "title": "How does this variadic template with using work?", "body": "<blockquote>\n<p><code>using BaseType = General&lt;typename BaseHelper&lt;Types... &gt;::BaseType&gt;</code></p>\n<p>Why do we need <code>::BaseType</code> at the end?</p>\n</blockquote>\n<p><code>General&lt;typename BaseHelper&lt;Types... &gt;</code> and <code>General&lt;typename BaseHelper&lt;Types... &gt;::BaseType</code> are different types; with <code>::BaseType</code> you select the <code>BaseType</code> defined, through <code>using</code>, inside <code>General&lt;typename BaseHelper&lt;Types... &gt;</code></p>\n<blockquote>\n<p>What type would <code>BaseType</code> contain in <code>OurClass</code> if we instantiate it with <code>OurClass&lt;int,float,Test&gt;</code>?</p>\n</blockquote>\n<p>You get that <code>BaseType</code> is defined as <code>General&lt;General&lt;General&lt;GenBase&gt;&gt;&gt;</code>.</p>\n<p>I'll try to show you, step by step, how to you get that type.</p>\n<p>You have <code>OurClass&lt;int,float,Test&gt;</code>, so <code>Types...</code> is <code>int, float, Test</code>, so</p>\n<pre><code>// 1: Types... is int, float, Test\nusing BaseType = typename BaseHelper&lt;int, float, Test&gt;::BaseType;\n</code></pre>\n<p>Next step: <code>BaseType</code> in <code>BaseHelper&lt;int, float, Test&gt;</code> (general template selected; <code>Type</code> is <code>int</code> and <code>Types...</code> is <code>float, Test</code>) is defined as</p>\n<pre><code>// 2: Types... is float, Test\nusing BaseType = General&lt;typename BaseHelper&lt;float, Test&gt;::BaseType&gt;;\n</code></pre>\n<p>Next step: <code>BaseType</code> in <code>BaseHelper&lt;float, Test&gt;</code> (general template selected; <code>Type</code> is <code>float</code> and <code>Types...</code> is <code>Test</code>) is defined as</p>\n<pre><code>// 3: Types... is Test\nusing BaseType = General&lt;typename BaseHelper&lt;Test&gt;::BaseType&gt;;\n</code></pre>\n<p>Next step: <code>BaseType</code> in <code>BaseHelper&lt;Test&gt;</code> (partial specialization <code>BaseHelper&lt;Type&gt;</code>, with <code>Test</code> as <code>Type</code>, is selected) is defined as</p>\n<pre><code>// 4\nusing BaseType = General&lt;GenBase&gt;;\n</code></pre>\n<p>Next step: we substitute <code>General&lt;GenBase&gt;</code> in 3, so</p>\n<pre><code>// 3: BaseHelper&lt;Test&gt;::BaseType&gt; is General&lt;GenBase&gt;\nusing BaseType = General&lt;General&lt;GenBase&gt;&gt;;\n</code></pre>\n<p>Next step: we substitute <code>General&lt;General&lt;GenBase&gt;&gt;</code> in 2, so</p>\n<pre><code>// 2: BaseHelper&lt;float, Test&gt;::BaseType is General&lt;General&lt;GenBase&gt;&gt;\nusing BaseType = General&lt;General&lt;General&lt;GenBase&gt;&gt;&gt;;\n</code></pre>\n<p>Final step: we substitute <code>General&lt;General&lt;General&lt;GenBase&gt;&gt;&gt;</code> in 1,</p>\n<pre><code>// 1: BaseHelper&lt;int, float, Test&gt;::BaseType is General&lt;General&lt;General&lt;GenBase&gt;&gt;&gt;\nusing BaseType = General&lt;General&lt;General&lt;GenBase&gt;&gt;&gt;;\n</code></pre>\n<p>Conclusion: <code>OurClass&lt;int,float,Test&gt;::BaseType</code> is <code>General&lt;General&lt;General&lt;GenBase&gt;&gt;&gt;</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 7355932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c310506b06aa3cfaeedccae2aca20f?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7355932/eugene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53751117, "answer_count": 2, "score": 1, "last_activity_date": 1544647741, "creation_date": 1544633605, "last_edit_date": 1544646266, "question_id": 53747784, "link": "https://stackoverflow.com/questions/53747784/how-does-this-variadic-template-with-using-work", "title": "How does this variadic template with using work?", "body": "<p>I have this code snippet and am trying to understand how it works:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass GenBase\n{\npublic:\n    void BaseClass()\n    {\n        std::cout &lt;&lt; \" BaseClass \" &lt;&lt; std::endl;\n    }\n};\n\ntemplate &lt;class Base&gt;\nclass General: public Base\n{\n    public:\n        void PrintGeneral()\n        {\n            std::cout &lt;&lt; \" General \" &lt;&lt; std::endl;\n        }\n};\n\ntemplate &lt;typename... Types&gt;\nstruct BaseHelper;\n\ntemplate &lt;typename Type, typename... Types&gt;\nstruct BaseHelper&lt; Type, Types...&gt;\n{\n    using BaseType = General&lt;typename BaseHelper&lt;Types... &gt;::BaseType&gt;;\n};\n\ntemplate &lt;typename Type&gt;\nstruct BaseHelper&lt;Type&gt;\n{\n    using BaseType = General&lt;GenBase&gt;;\n};\n\ntemplate &lt;typename... Types&gt;\nclass OurClass: public BaseHelper&lt;Types...&gt;::BaseType\n{\npublic:\n     void print_smth()\n     {\n        BaseType::PrintGeneral();\n     }\n\nprivate:\n     using BaseType = typename BaseHelper&lt;Types...&gt;::BaseType;\n};\n\nclass Test\n{\n  public:\n      void foo();\n};\n</code></pre>\n\n<ol>\n<li><p><code>using BaseType = General&lt;typename BaseHelper&lt;Types... &gt;::BaseType&gt;</code></p>\n\n<p>Why do we need <code>::BaseType</code> at the end?</p></li>\n<li><p>What type would <code>BaseType</code> contain in <code>OurClass</code> if we instantiate it with <code>OurClass&lt;int,float,Test&gt;</code>?</p></li>\n</ol>\n"}, {"tags": ["c++", "mesh", "cgal"], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 9051576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982508d548e8d994adb5eea5a9908a29?s=128&d=identicon&r=PG&f=1", "display_name": "mato", "link": "https://stackoverflow.com/users/9051576/mato"}, "edited": false, "score": 0, "creation_date": 1545068417, "post_id": 53756124, "comment_id": 94489306, "body": "I was wondering how I could extract face information after I use make_hexahedron."}, {"owner": {"reputation": 443, "user_id": 9051576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982508d548e8d994adb5eea5a9908a29?s=128&d=identicon&r=PG&f=1", "display_name": "mato", "link": "https://stackoverflow.com/users/9051576/mato"}, "edited": false, "score": 0, "creation_date": 1545080570, "post_id": 53756124, "comment_id": 94494597, "body": "I asked this quesion here (<a href=\"https://stackoverflow.com/questions/53819689/how-to-extract-face-information-from-linear-cell-complex-for-combinatorial-map-i\" title=\"how to extract face information from linear cell complex for combinatorial map i\">stackoverflow.com/questions/53819689/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "is_accepted": true, "score": 1, "last_activity_date": 1544682473, "creation_date": 1544682473, "answer_id": 53756124, "question_id": 53747731, "link": "https://stackoverflow.com/questions/53747731/how-to-create-a-rectangular-mesh-using-cgal/53756124#53756124", "title": "How to create a rectangular mesh using cgal?", "body": "<p>Some maybe interesting pointers:</p>\n\n<ul>\n<li><a href=\"https://doc.cgal.org/latest/BGL/group__PkgBGLHelperFct.html#gad9df350e98780f0c213046d8a257358e\" rel=\"nofollow noreferrer\"><code>make_hexahedron()</code></a></li>\n<li><a href=\"https://doc.cgal.org/latest/Polygon_mesh_processing/group__PMP__meshing__grp.html#ga102e1ba5d709c5e53e013160792e4d08\" rel=\"nofollow noreferrer\"><code>extrude_mesh()</code></a></li>\n<li><a href=\"https://doc.cgal.org/latest/Polygon_mesh_processing/group__PMP__meshing__grp.html#gad3d03890515ae8103bd32a30a3486412\" rel=\"nofollow noreferrer\"><code>isotropic_remeshing()</code></a></li>\n</ul>\n"}], "owner": {"reputation": 443, "user_id": 9051576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982508d548e8d994adb5eea5a9908a29?s=128&d=identicon&r=PG&f=1", "display_name": "mato", "link": "https://stackoverflow.com/users/9051576/mato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 53756124, "answer_count": 1, "score": 0, "last_activity_date": 1544682473, "creation_date": 1544633445, "question_id": 53747731, "link": "https://stackoverflow.com/questions/53747731/how-to-create-a-rectangular-mesh-using-cgal", "title": "How to create a rectangular mesh using cgal?", "body": "<p>I am currently trying to create a 2D rod. So its basically a rectangle with length and breadth.\nNow I want to mesh this rectangle using triangle and squares (or small rectangle).</p>\n\n<p>I was trying to achieve this task using cgal. I know we can do this using <code>CGAL::Constrained_Delaunay_triangulation_2</code> for generating triangular mesh. But I was trying to find mesh in cgal that\ncould generate square (or rectangle) mesh. </p>\n"}, {"tags": ["c++", "arm", "embedded", "rtos", "jtag"], "comments": [{"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1544642264, "post_id": 53747641, "comment_id": 94352463, "body": "Output over the SWO line is possible with some tools, or you can do mailboxing discovered by triggering a breakpoint when the embedded system adds a message.   But most of the time you build an embedded system like this with debug output from a serial UART, and capture that, typically with a logic-level USB UART cable on your dev machine."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544686649, "post_id": 53747641, "comment_id": 94366242, "body": "Yes it is possible, but cumbersome. Regarding how to do it, that&#39;s far too broad a question for this site."}], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "closed_date": 1544705593, "answer_count": 0, "score": 3, "last_activity_date": 1544633129, "creation_date": 1544633129, "question_id": 53747641, "link": "https://stackoverflow.com/questions/53747641/how-to-send-data-to-pc-over-jtag-debugger", "closed_reason": "Needs more focus", "title": "how to send data to PC over JTAG/debugger", "body": "<p>I am using a PEmicro USB Multilink Universal JTAG.</p>\n\n<p>I have a Cortex M4 processor running a custom C++ RTOS with no filesystem.</p>\n\n<p>I need to trace execution of some functions to debug a problem but since I don't have a filesystem, I'd have to use a RAM circular buffer.</p>\n\n<p><strong>QUESTION</strong></p>\n\n<p>Is it possible to write the trace data over the JTAG/debugger connection to the PC? Even if this can't be done full-speed, it would still be useful to me.</p>\n"}, {"tags": ["c++", "sorting", "complexity-theory"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 8, "creation_date": 1544632796, "post_id": 53747506, "comment_id": 94347546, "body": "*&quot;I am having issues implementing it&quot; - you forgot to mention what those issues are."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1544633463, "post_id": 53747506, "comment_id": 94347942, "body": "Do you really want to slow down the sort ? You can sort your int[] with the complexity O(n*log(n))"}, {"owner": {"reputation": 1, "user_id": 4619193, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IsH0QZpFfnY/AAAAAAAAAAI/AAAAAAAAABY/fIVZizbZ2-c/photo.jpg?sz=128", "display_name": "Arnolt Infern Kitler", "link": "https://stackoverflow.com/users/4619193/arnolt-infern-kitler"}, "edited": false, "score": 0, "creation_date": 1544634317, "post_id": 53747506, "comment_id": 94348351, "body": "I need to slow down the sort because my task is to compare them and make graphs. So I need seperate versions for n^(3/2) and n^(4/3) based on this code."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544635266, "post_id": 53747506, "comment_id": 94348857, "body": "@ArnoltInfernKitler The edit you made together with the comment confuses me. <i>I need to slow down the sort</i> but the requirements are changed to speed it up?"}, {"owner": {"reputation": 1, "user_id": 4619193, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IsH0QZpFfnY/AAAAAAAAAAI/AAAAAAAAABY/fIVZizbZ2-c/photo.jpg?sz=128", "display_name": "Arnolt Infern Kitler", "link": "https://stackoverflow.com/users/4619193/arnolt-infern-kitler"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544635474, "post_id": 53747506, "comment_id": 94348995, "body": "@TedLyngmo I just tried to clarify becasue bruno asked if I really want to slow down the sort and proposed O(n*log(n)) which I don&#39;t want becasue my task is to compare  O(N^2), O^(3/2) and O^(4/3)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544635824, "post_id": 53747506, "comment_id": 94349200, "body": "@ArnoltInfernKitler It&#39;s the <i>I need to slow down the sort</i> comment I find confusing since both O(n^(3/2)) and O(n^(4/3)) are faster than O(n^2) but perhaps I just misunderstood it."}, {"owner": {"reputation": 1, "user_id": 4619193, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IsH0QZpFfnY/AAAAAAAAAAI/AAAAAAAAABY/fIVZizbZ2-c/photo.jpg?sz=128", "display_name": "Arnolt Infern Kitler", "link": "https://stackoverflow.com/users/4619193/arnolt-infern-kitler"}, "edited": false, "score": 0, "creation_date": 1544643459, "post_id": 53747506, "comment_id": 94353072, "body": "So this part &quot; for (int gap = n/2; gap &gt; 0; gap /= 2)&quot; is used by term (N/2^k). Any idea how to do it for (2^k)-1 ??"}, {"owner": {"reputation": 1, "user_id": 4619193, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IsH0QZpFfnY/AAAAAAAAAAI/AAAAAAAAABY/fIVZizbZ2-c/photo.jpg?sz=128", "display_name": "Arnolt Infern Kitler", "link": "https://stackoverflow.com/users/4619193/arnolt-infern-kitler"}, "edited": false, "score": 0, "creation_date": 1544643551, "post_id": 53747506, "comment_id": 94353115, "body": "Tried something like this <a href=\"https://imgur.com/6GJREIh\" rel=\"nofollow noreferrer\">imgur.com/6GJREIh</a>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1544654301, "post_id": 53747506, "comment_id": 94357726, "body": "@ArnoltInfernKitler No, not without reading up on the algorithm. I did however make a small edit suggestion to clean up the code at <a href=\"https://www.geeksforgeeks.org/cpp-program-for-shellsort/\" rel=\"nofollow noreferrer\">geeksforgeeks.org</a> where you got it from."}], "owner": {"reputation": 1, "user_id": 4619193, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IsH0QZpFfnY/AAAAAAAAAAI/AAAAAAAAABY/fIVZizbZ2-c/photo.jpg?sz=128", "display_name": "Arnolt Infern Kitler", "link": "https://stackoverflow.com/users/4619193/arnolt-infern-kitler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544660380, "creation_date": 1544632632, "last_edit_date": 1544660380, "question_id": 53747506, "link": "https://stackoverflow.com/questions/53747506/shell-sort-complexity-for-other-variations", "title": "Shell sort complexity for other variations", "body": "<p>So the code below has complexity of O(N^2), is there an easy way to edit this code to give complexity of O(n^(3/2)) and another of O(n^(4/3)). Theres some hints there: <a href=\"https://en.wikipedia.org/wiki/Shellsort#Gap_sequences\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Shellsort#Gap_sequences</a> but I am having issues implementing it.\n(My task it to compare algorithm speed of those three in graph)</p>\n\n<pre><code>#include  &lt;iostream&gt;\n\nusing namespace std;\n\nint shellSort(int arr[], int n)\n{\n    for (int gap = n/2; gap &gt; 0; gap /= 2)\n    {\n        for (int i = gap; i &lt; n; i += 1)\n        {\n            int temp = arr[i];\n            int j;\n\n            for (j = i; j &gt;= gap &amp;&amp; arr[j - gap] &gt; temp; j -= gap)\n                arr[j] = arr[j - gap];\n\n            arr[j] = temp;\n        }\n    }\n    return 0;\n}\n\nvoid printArray(int arr[], int n)\n{\n    for (int i=0; i&lt;n; i++)\n        cout &lt;&lt; arr[i] &lt;&lt; \" \";\n}\n\nint main()\n{\n    int arr[] = {12, 34, 54, 2, 3}, i;\n    int n = sizeof(arr)/sizeof(arr[0]);\n\n    cout &lt;&lt; \"Array before sorting: \\n\";\n    printArray(arr, n);\n\n    shellSort(arr, n);\n\n    cout &lt;&lt; \"\\nArray after sorting: \\n\";\n    printArray(arr, n);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "uwp", "native", "managed"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1545669408, "post_id": 53747503, "comment_id": 94674570, "body": "This question should have been closed in the first five minutes of its existence."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1545669856, "post_id": 53747503, "comment_id": 94674666, "body": "Make sure that &quot;Use Library Dependency Inputs&quot; on the project reference is false."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545669929, "post_id": 53747503, "comment_id": 94674679, "body": "@n.m.: When you say &quot;question should be closed&quot; you need to give a reason.  It clearly is not off-topic, because it is a question about tools used by programmers and is unique to software development (someone using Visual C++ as a glorified text editor would never encounter this)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1545671309, "post_id": 53747503, "comment_id": 94675003, "body": "@BenVoigt To my eye It contains no useful information to diagnose the problem. Well obviously you think it does. For what I know, &quot;Use Library Dependency Inputs&quot; is a linker option, not a compiler option. It tells the linker to use object (not source) files rather than the library file. I&#39;m known to be wrong fairly often though."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545671515, "post_id": 53747503, "comment_id": 94675048, "body": "@n.m.: I&#39;m skeptical on it being the solution here, because the compiler should respect the per-file compile options (including &quot;no <code>&#47;clr</code>&quot;)... but it&#39;s something that OP would have missed by just looking through project properties, so I wanted to mention it.  I expanded my comment into an answer only because an image is very helpful in finding said setting."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545671944, "post_id": 53747503, "comment_id": 94675159, "body": "@n.m.: Another possibility is &quot;link time code generation&quot;, which delays compilation until the link stage (but it still should respect per-file compile options)"}, {"owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545681951, "post_id": 53747503, "comment_id": 94677450, "body": "@n.m.  Sorry, you are disappointed with the question.  I work alone, with no support.  This is a show stopper for me.  It&#39;s been a week of trying anything and everything."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545682783, "post_id": 53747503, "comment_id": 94677605, "body": "I understand it is hard to share your entire project, but you could at least try to show <i>something</i> related to your project. A screenshot or two, even, if all else fails. You could also try to reproduce the situation from scratch with a freshly made project, carefully recording all your steps. If the ew project fails the same way, show the steps. If it doesn&#39;t, compare the property sheets and try changing options on the fresh project until they match the bad project."}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "edited": false, "score": 0, "creation_date": 1545675198, "post_id": 53915935, "comment_id": 94675918, "body": "This is a UWP project and not a .net project.  I do not see mscorlib or anything ending in debug."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "edited": false, "score": 0, "creation_date": 1545675257, "post_id": 53915935, "comment_id": 94675934, "body": "@doby: Of course your project will have a different name than mine does."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 0, "last_activity_date": 1545670493, "creation_date": 1545670493, "answer_id": 53915935, "question_id": 53747503, "link": "https://stackoverflow.com/questions/53747503/c-visual-studio-compiler-compiles-native-code-as-managed/53915935#53915935", "title": "C++ Visual Studio Compiler compiles native code as managed", "body": "<p>Not all the relevant settings are in the project properties dialog.  Also check the properties non-modal window, particularly with the project-to-project reference selected inside Solution Explorer.</p>\n\n<p>There you will find a setting named \"Use Library Dependency Inputs\" which causes the main project to include the individual source files from the library project, instead of the static library.  Make sure this is set to False.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2dzmx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2dzmx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "is_accepted": true, "score": 2, "last_activity_date": 1545782614, "creation_date": 1545782614, "answer_id": 53926407, "question_id": 53747503, "link": "https://stackoverflow.com/questions/53747503/c-visual-studio-compiler-compiles-native-code-as-managed/53926407#53926407", "title": "C++ Visual Studio Compiler compiles native code as managed", "body": "<p>Ensure the stdafx.h files are properly inserted in the code.  The build order is different so you may get trapped.  </p>\n\n<p>Include (#include) the native stdafx.h in the managed pch.h file.  </p>\n"}], "owner": {"reputation": 445, "user_id": 6175092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdf773adcd27bd609b94f9e7e1e355b?s=128&d=identicon&r=PG&f=1", "display_name": "doby", "link": "https://stackoverflow.com/users/6175092/doby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 53926407, "answer_count": 2, "score": -1, "last_activity_date": 1545782614, "creation_date": 1544632631, "last_edit_date": 1545778601, "question_id": 53747503, "link": "https://stackoverflow.com/questions/53747503/c-visual-studio-compiler-compiles-native-code-as-managed", "title": "C++ Visual Studio Compiler compiles native code as managed", "body": "<p>I have started a new solution under VS that has both a managed, UWP code project and a native project.  The compiler compiles the native code and delivers a .lib file just fine.  When compiling the managed code, the compiler compiles the native code again -- as managed code and spits out errors.  </p>\n\n<p>I have another solution that use to work and I have tried to replicate the settings.  After a day of comparing the property settings, I cannot figure out why it's doing what it's doing.  </p>\n\n<p>Ideas for where to look?  </p>\n\n<p>_____ New below_____</p>\n\n<p>I have started a new solution an project and replicated everything. Here's what I've learned.  </p>\n\n<p>First, the compile order is different -- there was a missing stdafx.h file and the errors went from infinite to just 25.  They are now related to one file, MotionBase.  The native project compiles just fine, then the managed project compiles and it barfs on MotionBase.  This code sample gives errors \"'MotionBase': is not a member of 'BallLib'\"   and\"'input': unknown override specifier\".  </p>\n\n<pre><code>#pragma once\n#include \"stdafx.h\"\n#include \"FiniteDiffHelpers.h\"\n#include \"MotionBase.h\"\n#include \"MultiVarSolver.h\"\n\nnamespace BallLib {\n    class PathFinderHelper : public FiniteDiffHelper\n    {\n    public:\n        PathFinderHelper();\n        Line locs;\n        BallLib::MotionBase output;\n        MotionBase input;\n</code></pre>\n\n<p>.....</p>\n\n<p>PathFinderHelper compiled fine in the native project.  There are no errors in MotionBase.  MotionBase is part of BallLib.  Intelisense gives no errors in PathFinderHelper.  </p>\n"}, {"tags": ["c++", "g++", "translation-unit"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1544632816, "post_id": 53747499, "comment_id": 94347560, "body": "Line started with # is a preprocessor directive, like <code>#include</code> and <code>#ifdef</code> etc"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1544632980, "post_id": 53747499, "comment_id": 94347648, "body": "&quot;Is there any document that I should read&quot; I would start with <a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/C_preprocessor</a>"}, {"owner": {"reputation": 1885, "user_id": 2711672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/XZH0c.jpg?s=128&g=1", "display_name": "pasha", "link": "https://stackoverflow.com/users/2711672/pasha"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1544635314, "post_id": 53747499, "comment_id": 94348896, "body": "@Slava, the translation unit is generated after preprocessing, so those aren&#39;t preprocessor directives."}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1544633778, "last_edit_date": 1544633778, "creation_date": 1544632860, "answer_id": 53747579, "question_id": 53747499, "link": "https://stackoverflow.com/questions/53747499/what-do-the-lines-starting-with-symbol-in-g-e-generated-translation-unit/53747579#53747579", "title": "What do the lines starting with # symbol in g++ -E generated translation unit", "body": "<p><a href=\"http://tigcc.ticalc.org/doc/comopts.html\" rel=\"nofollow noreferrer\">http://tigcc.ticalc.org/doc/comopts.html</a></p>\n\n<blockquote>\n  <p><strong>-E</strong></p>\n  \n  <p>Stop after the preprocessing stage; do not run the compiler proper. The output is in the form of preprocessed source code, which\n  is sent to the standard output.</p>\n  \n  <p>Input files which don't require preprocessing are ignored.</p>\n</blockquote>\n\n<p>Then you can find <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Preprocessor-Output.html#Preprocessor-Output\" rel=\"nofollow noreferrer\">\"Preprocessor Output\" in gcc documentation</a>:</p>\n\n<blockquote>\n<pre><code># linenum filename flags\n</code></pre>\n  \n  <p>These are called linemarkers. They are inserted as needed into the\n  output (but never within a string or character constant). They mean\n  that the following line originated in file filename at line linenum.\n  filename will never contain any non-printing characters; they are\n  replaced with octal escape sequences.</p>\n  \n  <p>After the file name comes zero or more flags, which are \u20181\u2019, \u20182\u2019, \u20183\u2019,\n  or \u20184\u2019. If there are multiple flags, spaces separate them. Here is\n  what the flags mean:</p>\n  \n  <ul>\n  <li><p>\u20181\u2019 This indicates the start of a new file. </p></li>\n  <li><p>\u20182\u2019 This indicates returning to a file (after having included another file). </p></li>\n  <li>\u20183\u2019 This indicates that the following text comes from a system header file, so certain warnings should be suppressed. </li>\n  <li>\u20184\u2019 This indicates that the following text should be treated as being wrapped in an implicit extern \"C\" block.</li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1544633104, "creation_date": 1544633104, "answer_id": 53747636, "question_id": 53747499, "link": "https://stackoverflow.com/questions/53747499/what-do-the-lines-starting-with-symbol-in-g-e-generated-translation-unit/53747636#53747636", "title": "What do the lines starting with # symbol in g++ -E generated translation unit", "body": "<p>Line number information.</p>\n\n<p>If you compile the preprocessed output, those can.be used to find the line numbers and files of the original source.</p>\n"}], "owner": {"reputation": 1885, "user_id": 2711672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/XZH0c.jpg?s=128&g=1", "display_name": "pasha", "link": "https://stackoverflow.com/users/2711672/pasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "closed_date": 1544633024, "accepted_answer_id": 53747579, "answer_count": 2, "score": 1, "last_activity_date": 1544633778, "creation_date": 1544632625, "question_id": 53747499, "link": "https://stackoverflow.com/questions/53747499/what-do-the-lines-starting-with-symbol-in-g-e-generated-translation-unit", "closed_reason": "Duplicate", "title": "What do the lines starting with # symbol in g++ -E generated translation unit", "body": "<p>I tried to check the translation unit generated for a simple hello world program looks like.\nSo, I wrote below code in test.cpp.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    cout&lt;&lt;\"Hello World\"&lt;&lt;endl;\n}\n</code></pre>\n\n<p>I then compiled the above file with g++ with -E option and output the data to a temp file.\nThe file has c++ code with lines in between starting with # symbols.</p>\n\n<p>Something like below,</p>\n\n<pre><code># 1 \"test.cpp\"\n# 1 \"&lt;built-in&gt;\"\n# 1 \"&lt;command-line&gt;\"\n# 1 \"/usr/include/stdc-predef.h\" 1 3 4\n# 1 \"&lt;command-line&gt;\" 2\n# 1 \"test.cpp\"\n# 1 \"/usr/include/c++/8/iostream\" 1 3\n# 36 \"/usr/include/c++/8/iostream\" 3\n</code></pre>\n\n<ol>\n<li>What do these lines mean ?</li>\n<li>Is there any document that I should read or do I have to get knowledge in any specific subject to understand this file?</li>\n</ol>\n"}, {"tags": ["c++", "gcc", "arm", "instrumentation", "cortex-m"], "comments": [{"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 0, "creation_date": 1544714358, "post_id": 53747484, "comment_id": 94381712, "body": "A web search for &quot;gcc gprof arm-cortex-m&quot; produces: <a href=\"https://mcuoneclipse.com/2015/08/23/tutorial-using-gnu-profiling-gprof-with-arm-cortex-m/\" rel=\"nofollow noreferrer\">mcuoneclipse.com/2015/08/23/&hellip;</a> It appears to use semihosting to write profiling data to host machine. Does this help?"}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 0, "creation_date": 1545160833, "post_id": 53747484, "comment_id": 94527680, "body": "@domen yes that&#39;s the answer. Add it as the answer to this question so I can close it."}], "answers": [{"tags": [], "owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "is_accepted": true, "score": 1, "last_activity_date": 1545232064, "creation_date": 1545232064, "answer_id": 53853998, "question_id": 53747484, "link": "https://stackoverflow.com/questions/53747484/how-to-use-gcc-instrumentation-options-without-a-native-filesystem/53853998#53853998", "title": "how to use gcc instrumentation options without a native filesystem", "body": "<p>A web search for \"gcc gprof arm-cortex-m\" produces: <a href=\"https://mcuoneclipse.com/2015/08/23/tutorial-using-gnu-profiling-gprof-with-arm-cortex-m/\" rel=\"nofollow noreferrer\">https://mcuoneclipse.com/2015/08/23/tutorial-using-gnu-profiling-gprof-with-arm-cortex-m/</a></p>\n\n<p>It appears to use <code>semihosting</code> to write profiling data to host machine.</p>\n\n<p>Semihosting is a common way for ARM to communicate with debugger on host (through JTAG/SWD). It is also supported on emulators like qemu.</p>\n"}], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 53853998, "answer_count": 1, "score": 1, "last_activity_date": 1545232064, "creation_date": 1544632574, "question_id": 53747484, "link": "https://stackoverflow.com/questions/53747484/how-to-use-gcc-instrumentation-options-without-a-native-filesystem", "title": "how to use gcc instrumentation options without a native filesystem", "body": "<p>Many of the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html#Instrumentation-Options\" rel=\"nofollow noreferrer\">instrumentation options for gcc</a> save data to a file during/after runtime:</p>\n\n<blockquote>\n  <p>When the compiled program exits it <strong>saves this data to a file</strong> called auxname.gcda for each source file.</p>\n</blockquote>\n\n<p>However, I'm running on a custom C++-based RTOS which doesn't have a filesystem \"natively\" like Linux.</p>\n\n<p><strong>QUESTION</strong></p>\n\n<p>How do I use these gcc-instrumentation options that output results to a file?<br>\nDo I have to provide a file-writer interface - which in my case would write to a RAM buffer - which would be called whenever the instrumentation code needs to \"write to file\"?</p>\n"}, {"tags": ["python", "c++", "boost"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1544632896, "post_id": 53747379, "comment_id": 94347601, "body": "I&#39;ll probably get flamed for this but you use Modern C and you want to step down to python? It&#39;s like having an Audi or Mercedes and replacing it with a T-Ford ..."}, {"owner": {"reputation": 1, "user_id": 10683020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ppadvhJF5VU/AAAAAAAAAAI/AAAAAAAAGUA/KIH5To13i80/photo.jpg?sz=128", "display_name": "toolelucidator", "link": "https://stackoverflow.com/users/10683020/toolelucidator"}, "edited": false, "score": 0, "creation_date": 1544696792, "post_id": 53747379, "comment_id": 94371362, "body": "The fact is all the required libraries i need are already in python i only speed up part of my algorithm using C++ and CUDA and i need the ouput from this  ti be &quot;received&quot; by python"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1544722792, "post_id": 53747379, "comment_id": 94386472, "body": "Please elaborate: Why python in the first place if you want speed? python is an interpreted language and thus not a smart choice if you want speed"}], "owner": {"reputation": 1, "user_id": 10683020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ppadvhJF5VU/AAAAAAAAAAI/AAAAAAAAGUA/KIH5To13i80/photo.jpg?sz=128", "display_name": "toolelucidator", "link": "https://stackoverflow.com/users/10683020/toolelucidator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544632222, "creation_date": 1544632222, "question_id": 53747379, "link": "https://stackoverflow.com/questions/53747379/expose-opencv-c-mat-to-python", "title": "Expose OpenCV C++ Mat to Python", "body": "<p>Hello everyone basically i have the following </p>\n\n<p>A test.cpp as it follows </p>\n\n<pre><code>cv::Mat load(string filename){\n\nMat img = imread(filename,CV_LOAD_IMAGE_COLOR);\nGpuMat cudaMat;\ncudaMat.upload(img);\ncuda::DeviceInfo deviceinfo;\ncout &lt;&lt; \"GPU: \"&lt;&lt; deviceinfo.cuda::DeviceInfo::name() &lt;&lt; endl;   \nimshow(\"opencvtest_load\",img);\nwaitKey(0);\nreturn img;\n}\n</code></pre>\n\n<p>and i'm wrapping with boost as it follows: </p>\n\n<pre><code>#include&lt;boost/python.hpp&gt;\nusing namespace boost::python;\nBOOST_PYTHON_MODULE(opencvtest)\n{\ndef(\"load\",load);\n}\n</code></pre>\n\n<p>I generate everythong with the make command To be called from python code test.py </p>\n\n<pre><code>image = \"some directory and image\"\nfrom opencvtest import load\nimg3 = load(image)\n</code></pre>\n\n<p>So, in fact what i need now is to get that Mat from the load method to be processed converted to python. </p>\n\n<p>At the time i have the following error: \n    TypeError: No to_python (by-value) converter found for C++ type:<br>\n    cv::Mat</p>\n\n<p>So i'm done with all the libraries solutions because they trow errors all the time. Is there a better solution for this. Thanks a lot in advance</p>\n"}, {"tags": ["c++", "winapi", "callback", "com", "windows-10"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1544644565, "post_id": 53747374, "comment_id": 94353590, "body": "Sensor stuff works in the same thread, so COM needs messages to route the calls."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1544652386, "post_id": 53747374, "comment_id": 94356948, "body": "<a href=\"https://docs.microsoft.com/en-us/windows/desktop/com/processes--threads--and-apartments\" rel=\"nofollow noreferrer\">Processes, Threads, and Apartments</a>."}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "edited": false, "score": 0, "creation_date": 1544653460, "post_id": 53747374, "comment_id": 94357398, "body": "Yes, it says that for single threaded apartment, &quot;all COM objects are synchronized with the windows message queue.&quot; But it says that if we <code>CoInitializeEx(NULL, COINIT_MULTITHREADED)</code>, which makes it a multithreaded apartment, now it is not bound to the windows message queue - free-threaded - so we can simply make everything work with a console application without the Win32Application limitations. So what are some reasons or fixes to why COM Event firing won&#39;t work as expected? Please let me know if I am misundertsanding any of the COM related concepts."}, {"owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "edited": false, "score": 0, "creation_date": 1544654466, "post_id": 53747374, "comment_id": 94357789, "body": "Also it says that &quot;Threads in multi-threaded apartments should not perform UI actions.&quot; because &quot;this is because UI threads require a message pump, and COM does not pump messages for threads in a multi-threaded apartment.&quot; Does a console application count as a GUI, which leads to must I make ithe eventhandler multithreaded to receive any results?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1544661127, "post_id": 53747374, "comment_id": 94359676, "body": "You need to get a grip on some fundamentals: <code>1</code> The author of a COM object decides, which apartment the object can be instantiated in. You cannot arbitrarily choose. <code>2</code> <i>Any</i> thread can have a message queue. A thread that owns windows always does, but a GUI is not a requirement. A console application&#39;s threads can (or must, in the case of an STA) pump messages. <code>3</code> Learn what a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is, and provide one."}], "owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544643589, "creation_date": 1544632209, "last_edit_date": 1544643589, "question_id": 53747374, "link": "https://stackoverflow.com/questions/53747374/sensor-apis-seteventsink-for-windows-console-application", "title": "Sensor API&#39;s SetEventSink() for Windows Console Application", "body": "<p>I currently am using asynchronous callback to get the motion data through Window's Sensor API. For now I want to test the functionalities through a Windows 10 Console application (NOT a Windows Application). To simplify things, I am currently having the exact same problem as <a href=\"https://stackoverflow.com/questions/35693507/how-to-cause-my-c-program-to-wait-for-sensor-events-for-ever-and-not-terminate\">How to cause my C++ program to wait for sensor events for ever and not terminate</a>, where </p>\n\n<p><code>while(true) { hr = sensor-&gt;SetEventSink(pMyEvents); }</code> fires the event and I get consistent data, but the proper usage should be just</p>\n\n<p><code>hr = sensor-&gt;SetEventSink(pMyEvents);</code>, which will trigger the event asynchronously. </p>\n\n<p>I also used <code>CoInitializeEx(NULL, COINIT_MULTITHREADED);</code> to allow multithreading in COM. </p>\n\n<p>In the comments in the above SO link, two users mention that \"You're forgetting the Windows message event loop.\" I do not want to have a graphical interface for this program, and more importantly I do not get why \"COM will not work without a message loop.\" This seems to apply only for Windows Application Projects. Could someone elaborate on this, and how to properly use <code>SetEventSink(ISensorEvent)</code> to keep receiving the data for a regular console application?</p>\n\n<p>I have confirmed that other code such as for initialization/decoding dataworks by using the synchronous method - <code>GetData()</code>.</p>\n"}, {"tags": ["c++", "visual-studio", "intellisense"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10781913, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CWjDcrezL30/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYuo0HXf3GpZ6PyMxY5URarIpgSQ/mo/photo.jpg?sz=128", "display_name": "Ran Hilai", "link": "https://stackoverflow.com/users/10781913/ran-hilai"}, "edited": false, "score": 0, "creation_date": 1544633028, "post_id": 53747441, "comment_id": 94347688, "body": "Thanks Matthieu IntelliSense -&gt; &quot;Disable Error Reporting&quot; did it."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 1, "last_activity_date": 1544632441, "creation_date": 1544632441, "answer_id": 53747441, "question_id": 53747329, "link": "https://stackoverflow.com/questions/53747329/msvs-c-2012-how-to-disable-compiling-while-editting/53747441#53747441", "title": "MSVS C++ 2012: how to disable compiling-while-editting", "body": "<p>Go to Tools->Options->TextEditor</p>\n\n<p>Then choose C/C++->Advanced and turn off what you don't like. There are also some parameters in General that you may want to turn off (autocompletion).</p>\n"}], "owner": {"reputation": 3, "user_id": 10781913, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CWjDcrezL30/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYuo0HXf3GpZ6PyMxY5URarIpgSQ/mo/photo.jpg?sz=128", "display_name": "Ran Hilai", "link": "https://stackoverflow.com/users/10781913/ran-hilai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 53747441, "answer_count": 1, "score": 0, "last_activity_date": 1544632502, "creation_date": 1544632035, "last_edit_date": 1544632502, "question_id": 53747329, "link": "https://stackoverflow.com/questions/53747329/msvs-c-2012-how-to-disable-compiling-while-editting", "title": "MSVS C++ 2012: how to disable compiling-while-editting", "body": "<p>MSVS C++ constantly checks my code as I edit and mark compile errors/warning with \"red wavy underline\".</p>\n\n<p>I don't want to see these red wavy underlines. I want to see my errors only when I build.</p>\n\n<p>Is it possible to disable this feature?</p>\n"}, {"tags": ["c++", "vector", "replace"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1544632293, "post_id": 53747323, "comment_id": 94347251, "body": "You&#39;re not going to get any faster.  It&#39;s an O(N) operation and that is what you are doing.  You can put it into a function so it only looks like one line of code."}, {"owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "edited": false, "score": 0, "creation_date": 1544632495, "post_id": 53747323, "comment_id": 94347365, "body": "<code>v1.insert(v1.begin() + 3, v2.begin(), v2.end())</code> should work. Just removing the first step of copying the first element of v2. Otherwise not much optimization."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 2, "creation_date": 1544632565, "post_id": 53747323, "comment_id": 94347418, "body": "<code>std::list</code> is faster (complexity wise). But you need to profile for the required workloads"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1544632665, "post_id": 53747323, "comment_id": 94347471, "body": "If you have to often add/remove element(s) to use a list rather than a vector is faster, but of course all depend on what else you do with your sequence, vector and list have their own advantages and disadvantages"}, {"owner": {"reputation": 833, "user_id": 8047760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4420b0b735bf473e56fb2996ae53d39?s=128&d=identicon&r=PG&f=1", "display_name": "Christian G", "link": "https://stackoverflow.com/users/8047760/christian-g"}, "edited": false, "score": 0, "creation_date": 1544633003, "post_id": 53747323, "comment_id": 94347668, "body": "one line: <code>v1.insert(v1.emplace(v1.begin() + 2, v2.front()) + 1, v2.begin() + 1, v2.end());</code> ... unreadable and error-prone, not faster, if you want to use it you should at least encapsulate it in a method like replace_and_insert or something similar"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1544633022, "post_id": 53747323, "comment_id": 94347682, "body": "<a href=\"https://en.cppreference.com/w/cpp/container/list/splice\" rel=\"nofollow noreferrer\"><code>std::list::splice</code></a> has constant time complexity, but <code>std::vector</code> doesn&#39;t have anything like that."}, {"owner": {"reputation": 703, "user_id": 9753452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Michael Surette", "link": "https://stackoverflow.com/users/9753452/michael-surette"}, "edited": false, "score": 0, "creation_date": 1544633253, "post_id": 53747323, "comment_id": 94347810, "body": "If you need a vector then I would append the inserted vector and do a rotate. This would avoid the repeated moving of the elements following the insertion point."}, {"owner": {"reputation": 3551, "user_id": 287693, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a2b2f6453da084d8538fd521c0a0f264?s=128&d=identicon&r=PG", "display_name": "justik", "link": "https://stackoverflow.com/users/287693/justik"}, "edited": false, "score": 0, "creation_date": 1544654654, "post_id": 53747323, "comment_id": 94357859, "body": "Thanks for your comments..."}], "owner": {"reputation": 3551, "user_id": 287693, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a2b2f6453da084d8538fd521c0a0f264?s=128&d=identicon&r=PG", "display_name": "justik", "link": "https://stackoverflow.com/users/287693/justik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1544632016, "creation_date": 1544632016, "question_id": 53747323, "link": "https://stackoverflow.com/questions/53747323/c-replace-the-i-th-element-with-n-elements-low-complexity", "title": "C++, replace the i-th element with n elements (low complexity)", "body": "<p>Suppose two vectors:</p>\n\n<pre><code>std::vector&lt;int&gt; v1{1, 10, 18, 41, 6};\nstd::vector&lt;int&gt; v2{-12, 107, 14, -3, 5};\n</code></pre>\n\n<p>How to replace the i-th element of v1 with v2? For example</p>\n\n<pre><code>v1[2]&lt;-v2\n</code></pre>\n\n<p>leads to</p>\n\n<pre><code>v1={1, 10, -12, 107, 14, -3, 5 , 41, 6}\n</code></pre>\n\n<p>The simple solution is:</p>\n\n<pre><code>v1[2] = v2[0]\nv1.insert(v1.begin() + 3, v2.begin() + 1, v2.end())\n</code></pre>\n\n<p>Is there any faster (lower time complexity) method? Is it possible to perform these operations as a single statement?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c++", "c++11", "inheritance", "deleted-functions"], "comments": [{"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1544633760, "post_id": 53747179, "comment_id": 94348102, "body": "Any good developer will know that the probable cause of this error is the lack of a move constructor (He <b>is</b> using <code>std::move</code>, after all). I wouldn&#39;t worry about it."}, {"owner": {"reputation": 428, "user_id": 5847906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Mq0Bm.png?s=128&g=1", "display_name": "Ayak973", "link": "https://stackoverflow.com/users/5847906/ayak973"}, "reply_to_user": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1544647889, "post_id": 53747179, "comment_id": 94354998, "body": "I agree with you, but I don&#39;t want to rely on other people nor my probable skills, and thought that an exact compiler error was easier to be understood by beginners like me..."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1544659735, "post_id": 53747179, "comment_id": 94359376, "body": "The compiler error is <i>exact</i>: the implicitly defined move constructor is deleted, because the copy ctor is."}], "answers": [{"comments": [{"owner": {"reputation": 428, "user_id": 5847906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Mq0Bm.png?s=128&g=1", "display_name": "Ayak973", "link": "https://stackoverflow.com/users/5847906/ayak973"}, "edited": false, "score": 0, "creation_date": 1544648545, "post_id": 53750445, "comment_id": 94355254, "body": "The goal here is to know if the compiler can complains about the child class move ctor not present, not about the base class move ctor deleted?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 428, "user_id": 5847906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Mq0Bm.png?s=128&g=1", "display_name": "Ayak973", "link": "https://stackoverflow.com/users/5847906/ayak973"}, "edited": false, "score": 2, "creation_date": 1544648788, "post_id": 53750445, "comment_id": 94355345, "body": "@Ayak973 The child class gets a move ctor written for it that fails <i>because</i> the base class has a deleted move ctor.  The compiler is saying why the derived class&#39;s move ctor cannot be written for you."}, {"owner": {"reputation": 428, "user_id": 5847906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Mq0Bm.png?s=128&g=1", "display_name": "Ayak973", "link": "https://stackoverflow.com/users/5847906/ayak973"}, "edited": false, "score": 0, "creation_date": 1544709704, "post_id": 53750445, "comment_id": 94378725, "body": "My reasoning was biased, I understand better now with your comment"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1544644519, "creation_date": 1544644519, "answer_id": 53750445, "question_id": 53747179, "link": "https://stackoverflow.com/questions/53747179/force-compiler-to-emit-error-on-move-constructor-not-defined-with-a-base-class-d/53750445#53750445", "title": "Force compiler to emit error on move constructor not defined with a base class deleted copy ctor", "body": "<p>add</p>\n\n<pre><code>    NonCopyable(NonCopyable &amp;&amp;)                 = delete;\n    NonCopyable&amp; operator=(NonCopyable &amp;&amp;)      = delete;\n</code></pre>\n\n<p>that now complains about the base class move ctor being deleted.</p>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1544659863, "post_id": 53753238, "comment_id": 94359405, "body": "The &quot;Rule of Five&quot; is not a rule of the language though."}, {"owner": {"reputation": 573, "user_id": 7636018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IQbgw.jpg?s=128&g=1", "display_name": "Julien Villemure-Fr&#233;chette", "link": "https://stackoverflow.com/users/7636018/julien-villemure-fr%c3%a9chette"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1544660720, "post_id": 53753238, "comment_id": 94359578, "body": "@Deduplicator I know, it&#39;s more of a guideline, but I used it as a shortcut."}], "tags": [], "owner": {"reputation": 573, "user_id": 7636018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IQbgw.jpg?s=128&g=1", "display_name": "Julien Villemure-Fr&#233;chette", "link": "https://stackoverflow.com/users/7636018/julien-villemure-fr%c3%a9chette"}, "is_accepted": false, "score": 0, "last_activity_date": 1544659535, "creation_date": 1544659535, "answer_id": 53753238, "question_id": 53747179, "link": "https://stackoverflow.com/questions/53747179/force-compiler-to-emit-error-on-move-constructor-not-defined-with-a-base-class-d/53753238#53753238", "title": "Force compiler to emit error on move constructor not defined with a base class deleted copy ctor", "body": "<p>Formally speaking, the implicitly generated move ctor/assignment is defined as \"deleted\" in the base class <code>NonCopyable</code> itself. A \"deleted\" move ctor/assignment is just ignored by overload resolution (instead of being deleted in the strict sense). Since <code>NonCopyable</code> is not copyable and not movable, any subclass will have it's implicit (and =default) copy and move operations be defined as deleted.</p>\n\n<p>Under strict iso c++, your design has the wanted semantics but unfortunately, most compilers do not strictly enforce the so called <em>rule of five</em>, but only enforce a subset of the <em>implicitly deleted</em> rule. For example, having user declared destructor for a class implies that the implicit (and =default) definitions of all copy and move operation will be deleted, but I don't know of a compiler that fails to compile or emit a warning when the implicitly declared copy constructor would be ODR used for such a class.</p>\n\n<p>I came across this bug report <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58407#c16\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58407#c16</a> . It suggest that compilers will probably begin to enforce or warn against the <em>rule of five</em> violations.</p>\n"}], "owner": {"reputation": 428, "user_id": 5847906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Mq0Bm.png?s=128&g=1", "display_name": "Ayak973", "link": "https://stackoverflow.com/users/5847906/ayak973"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 53750445, "answer_count": 2, "score": 0, "last_activity_date": 1544659535, "creation_date": 1544631507, "question_id": 53747179, "link": "https://stackoverflow.com/questions/53747179/force-compiler-to-emit-error-on-move-constructor-not-defined-with-a-base-class-d", "title": "Force compiler to emit error on move constructor not defined with a base class deleted copy ctor", "body": "<p>Consider a base class wich prevent copy construction and copy assignement like this:</p>\n\n<pre><code>class NonCopyable {\n    public:\n        NonCopyable() = default;\n        ~NonCopyable() = default;\n\n        NonCopyable(NonCopyable const&amp;)                 = delete;\n        NonCopyable&amp; operator=(NonCopyable const&amp;)      = delete;\n};\n</code></pre>\n\n<p>Our developers can now include this class, and use it to disable copy for inherited classes, like this:</p>\n\n<pre><code>class CopyTest : public NonCopyable {\n    public:\n        CopyTest() {\n            std::cout &lt;&lt; \"copy test created\" &lt;&lt; std::endl;\n        }\n\n        ~CopyTest() {\n            std::cout &lt;&lt; \"copy test deleted\" &lt;&lt; std::endl;\n        }\n};\n</code></pre>\n\n<p>When I try to use the <code>CopyTest</code> class:</p>\n\n<pre><code>CopyTest ct, ct1(ct);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>CopyTest ct;\nCopyTest ct1 = ct2;\n</code></pre>\n\n<p>The compiler emit an error : <code>use of deleted function xxx</code> (where xxx is my deleted copy ctor, or copy operator)</p>\n\n<p>Then, if I want to <code>std::move</code> a <code>CopyTest</code> object :</p>\n\n<pre><code>CopyTest ct;\nCopyTest ct1 = std::move(ct);\n</code></pre>\n\n<p>The compiler emit the same error (use of deleted function xxx - where xxx remains my copy ctor or assignement operator).</p>\n\n<p>If I remind correctly, it's because the developer has not defined the proper move ctor/assignement operator.</p>\n\n<p><strong>Is it possible to force the compiler to tell the developper of the <code>CopyTest</code> class that the move error is here because he has not defined the proper move ctor/assignement operator, and not because the copy ctor/assignement operator is deleted on the base class?</strong></p>\n\n<p>Platform : </p>\n\n<p>Debian 9 </p>\n\n<p>GCC 6.3.0</p>\n\n<p>Compilation flags : </p>\n\n<p>-fpermissive -ggdb -std=c++11 </p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1544630748, "post_id": 53746710, "comment_id": 94346378, "body": "Why not use move-ops and allow covariance to do all of this. In other words, lose the <i>first</i> implementation, not the second, and do this properly."}], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 2, "last_activity_date": 1544630649, "creation_date": 1544630649, "answer_id": 53746926, "question_id": 53746710, "link": "https://stackoverflow.com/questions/53746710/template-parameter-inference-with-inheritance/53746926#53746926", "title": "Template parameter inference with inheritance", "body": "<p>You should move instead of passing the object by reference:</p>\n\n<pre><code>void push(std::unique_ptr&lt;A&gt; v) {\n    push(v.release());\n};\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>h.push(std::move(a));\nh.push(std::move(b));\n</code></pre>\n\n<p>But any <code>release</code> on a unique pointer is a bad smell, so implement the push the other way:</p>\n\n<pre><code>void push(A *v) {\n    //Perform some checks and other stuff before pushing\n    push(std::unique_ptr&lt;A&gt;(v));\n};\nvoid push(std::unique_ptr&lt;A&gt; v) {\n    _items.push_back(std::move(v));\n};\n</code></pre>\n\n<p>And add the virtual destructor.</p>\n"}, {"comments": [{"owner": {"reputation": 618, "user_id": 2836899, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a279c153f484f6d9656d41c41e82f45f?s=128&d=identicon&r=PG", "display_name": "Masadow", "link": "https://stackoverflow.com/users/2836899/masadow"}, "edited": false, "score": 0, "creation_date": 1544707740, "post_id": 53746931, "comment_id": 94377523, "body": "Thanks for the insight !  I&#39;ll go for that :)  How copy constructor of unique_ptr isn&#39;t called with std::move ?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 618, "user_id": 2836899, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a279c153f484f6d9656d41c41e82f45f?s=128&d=identicon&r=PG", "display_name": "Masadow", "link": "https://stackoverflow.com/users/2836899/masadow"}, "edited": false, "score": 0, "creation_date": 1544710100, "post_id": 53746931, "comment_id": 94378978, "body": "@Masadow Its <i>move</i> constructor is instead called.  You probably want to brush up on move semantics of <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b11\">c++11</a>."}, {"owner": {"reputation": 618, "user_id": 2836899, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a279c153f484f6d9656d41c41e82f45f?s=128&d=identicon&r=PG", "display_name": "Masadow", "link": "https://stackoverflow.com/users/2836899/masadow"}, "edited": false, "score": 0, "creation_date": 1544715349, "post_id": 53746931, "comment_id": 94382412, "body": "I must admit that I still stick to pre-c++11 features most of the time, I&#39;ll read upon this one :)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1544630658, "creation_date": 1544630658, "answer_id": 53746931, "question_id": 53746710, "link": "https://stackoverflow.com/questions/53746710/template-parameter-inference-with-inheritance/53746931#53746931", "title": "Template parameter inference with inheritance", "body": "<p>This is the right signature:</p>\n\n<pre><code>void push(std::unique_ptr&lt;A&gt; v) {\n    //Perform some checks and other stuff before pushing\n    push(std::move(v));\n}\n</code></pre>\n\n<p>taking a <code>unique_ptr</code> communicates that you are taking ownership.</p>\n\n<p>At call site:</p>\n\n<pre><code>// It works but it's too verbose\nh.push(std::move(a));\nh.push(std::move(b));\n</code></pre>\n\n<p>both because it is required, and because you want ownership-changing code to be clear.</p>\n\n<p>Note that the <code>std::move(b)</code> code will result in undefined behavior because <code>A</code> lacks a virtual destructor.</p>\n\n<pre><code>// It works for a because it has the right type but not for b\nh.push(a);\n</code></pre>\n\n<p>this code is toxic, and will cause bugs.  You just silently changed the ownership of a <code>unique_ptr</code>.  <code>auto_ptr</code> had this property, and was found to be nearly impossible to use properly, and was deprecated then removed from the standard.</p>\n\n<p>Don't write code that makes <code>unique_ptr</code> behave like <code>auto_ptr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "is_accepted": false, "score": 2, "last_activity_date": 1544630723, "creation_date": 1544630723, "answer_id": 53746958, "question_id": 53746710, "link": "https://stackoverflow.com/questions/53746710/template-parameter-inference-with-inheritance/53746958#53746958", "title": "Template parameter inference with inheritance", "body": "<p>For <code>std::unique_ptr</code>, you should always have ownership, and in this case, you don't need to worry about releasing and making a new pointer. Instead, use the <code>std::move</code> function, it was made for this. You can change your push function to this:</p>\n\n<pre><code>void push (std::unique_ptr&lt;A&gt; v) { _items.push_back(std::move(v)); }\n</code></pre>\n\n<p>And then you would push in the pointers with:</p>\n\n<pre><code>h.push(std::move(a));\nh.push(std::move(b));\n</code></pre>\n"}], "owner": {"reputation": 618, "user_id": 2836899, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a279c153f484f6d9656d41c41e82f45f?s=128&d=identicon&r=PG", "display_name": "Masadow", "link": "https://stackoverflow.com/users/2836899/masadow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1544707919, "accepted_answer_id": 53746931, "answer_count": 3, "score": 0, "last_activity_date": 1544630723, "creation_date": 1544629960, "question_id": 53746710, "link": "https://stackoverflow.com/questions/53746710/template-parameter-inference-with-inheritance", "closed_reason": "Duplicate", "title": "Template parameter inference with inheritance", "body": "<p>Considering this small program:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;vector&gt;\n\nclass Holder {\n    std::vector&lt;std::unique_ptr&lt;A&gt; &gt; _items;\n\npublic:\n    void push(A *v) {\n        //Perform some checks and other stuff before pushing\n        _items.emplace_back(v);\n    };\n    void push(std::unique_ptr&lt;A&gt; &amp;v) {\n        push(v.release());\n    };\n};\n\nclass A {\n\n};\n\nclass B : public A {\n\n};\n\nint main()\n{\n    Holder h;\n    std::unique_ptr&lt;A&gt; a;\n    std::unique_ptr&lt;B&gt; b;\n\n    // It works but it's too verbose\n    h.push(a.release());\n    h.push(b.release());\n\n    // It works for a because it has the right type but not for b\n    h.push(a);\n    h.push(b);\n}\n</code></pre>\n\n<p>I'm wondering if there's a simple way to write the <code>h.push(b)</code> line without the overhead to give ownership myself.</p>\n\n<p>I don't want to use <code>*b</code> because the pointer must lose its ownership in the <code>push</code> method and I want the <code>push</code> method to be as easy as possible to use.</p>\n\n<p>I'm feeling like I should remove the <code>push</code> overload taking a <code>unique_ptr</code> from <code>Holder</code> class and use the first example that works.</p>\n\n<p>Any idea ? </p>\n"}, {"tags": ["c++", "wmi"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5854252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36aa28691d917bedd1f47a989e7e4b1?s=128&d=identicon&r=PG&f=1", "display_name": "JosephB", "link": "https://stackoverflow.com/users/5854252/josephb"}, "edited": false, "score": 0, "creation_date": 1544693576, "post_id": 53747896, "comment_id": 94369554, "body": "It&#39;s updated every second. So every second the bytes (sent &amp; received) of the right picture get automatically updated. For the left picture I have to do it manually."}], "tags": [], "owner": {"reputation": 150, "user_id": 4440740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mvPzO.jpg?s=128&g=1", "display_name": "Shumatsu", "link": "https://stackoverflow.com/users/4440740/shumatsu"}, "is_accepted": false, "score": 0, "last_activity_date": 1544633989, "creation_date": 1544633989, "answer_id": 53747896, "question_id": 53746682, "link": "https://stackoverflow.com/questions/53746682/how-to-convert-bytes-received-per-second-and-bytes-sent-per-second-to-mb/53747896#53747896", "title": "How to convert Bytes received per second and Bytes sent per second to MB?", "body": "<p>Your formula for converting bytes to megabytes is correct. Data in Data Usage menu is not realtime. What you see is a cached state. I cannot find information about how often it's updated. </p>\n"}], "owner": {"reputation": 1, "user_id": 5854252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36aa28691d917bedd1f47a989e7e4b1?s=128&d=identicon&r=PG&f=1", "display_name": "JosephB", "link": "https://stackoverflow.com/users/5854252/josephb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544633989, "creation_date": 1544629870, "last_edit_date": 1544629972, "question_id": 53746682, "link": "https://stackoverflow.com/questions/53746682/how-to-convert-bytes-received-per-second-and-bytes-sent-per-second-to-mb", "title": "How to convert Bytes received per second and Bytes sent per second to MB?", "body": "<p>I\u2019m using <strong>WMI with C++</strong> to get the data usage of my PC (BytesReceivedPerSec en  BytesSentPerSec).</p>\n\n<p>Reference: <a href=\"https://docs.microsoft.com/en-us/windows/desktop/wmisdk/example--getting-wmi-data-from-the-local-computer\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/wmisdk/example--getting-wmi-data-from-the-local-computer</a></p>\n\n<p>Those data are similar to the data from the right picture (Tab title = \u201cEthernet 2 Status\u201d )  But I'm having trouble figuring out how to convert those data of the right picture (Tab title = Ethernet 2 Status ) to the left picture</p>\n\n<p><img src=\"https://i.stack.imgur.com/dJune.png\" alt=\"enter image description here\"></p>\n\n<p>(Tab title = Data usage). This formula doesn\u2019t work <strong>(Bytes sent + Bytes received)/1024^2</strong> .  Even when I reset both data at the same time I don\u2019t get the same result. For example (959.644 + 22.298.664)/1024^2 =22.180.850 I guess that\u2019s 22MB thus not 11MB like the left picture tell me. I just don\u2019t know how to convert those data to MB. Any help or tips would be really appreciated  </p>\n\n<p><a href=\"https://i.stack.imgur.com/dJune.png\" rel=\"nofollow noreferrer\">1</a> <a href=\"https://i.stack.imgur.com/s1B1p.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/s1B1p.png</a></p>\n"}, {"tags": ["c++", "opengl", "matrix-multiplication", "glm-math"], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 6, "last_activity_date": 1544631416, "creation_date": 1544631416, "answer_id": 53747153, "question_id": 53746629, "link": "https://stackoverflow.com/questions/53746629/opengl-mat4x4-multiplied-with-vec4-yields-tvecfloat/53747153#53747153", "title": "OpenGL: mat4x4 multiplied with vec4 yields tvec&lt;float&gt;", "body": "<blockquote>\n  <p>According to my knowledge of linear algebra this should yield a mat4x4.</p>\n</blockquote>\n\n<p>Then that's the problem.</p>\n\n<p>According to linear algebra, a matrix can be <a href=\"https://en.wikipedia.org/wiki/Matrix_(mathematics)#Addition,_scalar_multiplication_and_transposition\" rel=\"noreferrer\">multipled by a scalar</a> (which does element-wise multiplication) or by another matrix. But even then, a <a href=\"https://en.wikipedia.org/wiki/Matrix_multiplication\" rel=\"noreferrer\">matrix * matrix multiplication</a> only works if the number of rows in the first matrix equals the number of columns in the second. And the resulting matrix is one which has the number of columns in the first and the number of rows in the second.</p>\n\n<p>So if you have an AxB matrix and you multiply it with a CxD matrix, this only works if B and C are equal. And the result is an AxD matrix.</p>\n\n<p>Multiplying a matrix by a vector means to pretend the vector <em>is a matrix</em>. So if you have a 4x4 matrix and you right-multiply it with a 4-element vector, this will only make sense if you treat that vector as a 4x1 matrix (since you cannot multiply a 4x4 matrix by a 1x4 matrix). And the result of a 4x4 matrix * a 4x1 matrix is... a 4x1 matrix.</p>\n\n<p>AKA: a <em>vector</em>.</p>\n\n<p>GLM is doing exactly what you asked.</p>\n"}], "owner": {"reputation": 1212, "user_id": 5620642, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d3cdbfd9a17481d049878ccd6554085?s=128&d=identicon&r=PG&f=1", "display_name": "Nulle", "link": "https://stackoverflow.com/users/5620642/nulle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 53747153, "answer_count": 1, "score": 1, "last_activity_date": 1544711439, "creation_date": 1544629658, "last_edit_date": 1544711439, "question_id": 53746629, "link": "https://stackoverflow.com/questions/53746629/opengl-mat4x4-multiplied-with-vec4-yields-tvecfloat", "title": "OpenGL: mat4x4 multiplied with vec4 yields tvec&lt;float&gt;", "body": "<p>Consider the code:</p>\n\n<pre><code>glm::mat4x4 T = glm::mat4x4(1);\nglm::vec4 vrpExpanded;\nvrpExpanded.x = this-&gt;vrp.x;\nvrpExpanded.y = this-&gt;vrp.y;\nvrpExpanded.z = this-&gt;vrp.z;\nvrpExpanded.w = 1;\n\nthis-&gt;vieworientationmatrix =  T * (-vrpExpanded);\n</code></pre>\n\n<p>Why does <code>T*(-vrpExpanded)</code> yield a vector? According to my knowledge of linear algebra this should yield a mat4x4. </p>\n"}, {"tags": ["c++", "regex", "qt", "gps"], "comments": [{"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1544630037, "post_id": 53746527, "comment_id": 94345905, "body": "<code>line</code> seems to be a bit ambiguous here. There seems to be a <code>line</code> right before the start of your code snippet and there&#39;s another one within the <code>while</code>-loop. And is the file-reading at all relevant or...?"}, {"owner": {"reputation": 21, "user_id": 10657978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZwVbE.jpg?s=128&g=1", "display_name": "Golta", "link": "https://stackoverflow.com/users/10657978/golta"}, "reply_to_user": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1544630218, "post_id": 53746527, "comment_id": 94346047, "body": "The code posted above is in a Slot and there&#39;s nothing above the <code>GPSLong</code>, and as for the while there&#39;s 3 more regex which are working fine. The file reading isn&#39;t that relevant just put it here to show why it&#39;s used..."}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1544630396, "post_id": 53746527, "comment_id": 94346181, "body": "Err... so how is <code>line</code> defined in <code>QRegularExpressionMatch matchGPSLong = GPSLong.match(line);</code>?"}, {"owner": {"reputation": 21, "user_id": 10657978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZwVbE.jpg?s=128&g=1", "display_name": "Golta", "link": "https://stackoverflow.com/users/10657978/golta"}, "reply_to_user": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1544687122, "post_id": 53746527, "comment_id": 94366449, "body": "My bad i misplaced it and didn&#39;t even see, thanks"}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1544688280, "post_id": 53746527, "comment_id": 94366961, "body": "May help if you tell us what OS/Qt Version you&#39;re using. Me hard-coding <code>QString line = &quot;43&#176; 31&#39; 8.3\\&quot; N, 5&#176; 3&#39; 13.2\\&quot; E, 0m&quot;;</code> and looping through match captures gives me 3 <code>&quot;5&#176; 3&#39; 13.2\\&quot; E&quot;</code>, 1 <code>&quot;&quot;</code>, 1 <code>&quot;E&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1544630877, "post_id": 53746894, "comment_id": 94346443, "body": "capture 0 is the whole match rather than the whole line (unless the regex matches the whole line)"}, {"owner": {"reputation": 21, "user_id": 10657978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZwVbE.jpg?s=128&g=1", "display_name": "Golta", "link": "https://stackoverflow.com/users/10657978/golta"}, "edited": false, "score": 0, "creation_date": 1544687783, "post_id": 53746894, "comment_id": 94366733, "body": "@KyleRoss index 0 through 2 still give me : <code>Longitude :  &quot;43? 31&#39; 8.3\\&quot; N, 5? 3&#39; 13.2\\&quot; E&quot;</code> index 3 is &quot; &quot; and 4 &quot;E&quot; as expected"}], "tags": [], "owner": {"reputation": 67, "user_id": 10038228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18p5I.jpg?s=128&g=1", "display_name": "Kyle Ross", "link": "https://stackoverflow.com/users/10038228/kyle-ross"}, "is_accepted": false, "score": 0, "last_activity_date": 1544632391, "last_edit_date": 1544632391, "creation_date": 1544630547, "answer_id": 53746894, "question_id": 53746527, "link": "https://stackoverflow.com/questions/53746527/qt-regex-display-the-full-text-instead-of-what-is-asked/53746894#53746894", "title": "QT regex display the full text instead of what is asked", "body": "<p>You want:</p>\n\n<pre><code>QString GPSLongCoordinates = matchGPSLong.captured(1);\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>QString GPSLongCoordinates = matchGPSLong.captured(0);\n</code></pre>\n\n<p>The 0-index of a capture is the entire match.  If any groups match, those groups starting at index 1 are the respective matches.</p>\n"}], "owner": {"reputation": 21, "user_id": 10657978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZwVbE.jpg?s=128&g=1", "display_name": "Golta", "link": "https://stackoverflow.com/users/10657978/golta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545124213, "creation_date": 1544629291, "last_edit_date": 1545124213, "question_id": 53746527, "link": "https://stackoverflow.com/questions/53746527/qt-regex-display-the-full-text-instead-of-what-is-asked", "title": "QT regex display the full text instead of what is asked", "body": "<p>i'm having an issue with my regex here where i'm trying to get the longitude of a gps data and instead it's giving me the entire coordinate</p>\n\n<p>my code</p>\n\n<pre><code>QRegularExpression GPSLong(\"((?&lt;=,\\\\s)([0-9](.*?)+(W|E)))\");\n\n\n while (!file.atEnd()) \n{\n    QString line = file.readLine();\n    i++;\n\n    QRegularExpressionMatch matchGPSLong = GPSLong.match(line);\n\n    if ( matchGPSLong.hasMatch()) \n    {\n        QString GPSLongCoordinates = matchGPSLong.captured(0);\n        qDebug()&lt;&lt; \"Longitude : \" &lt;&lt;GPSLongCoordinates;\n    }\n  //....\n}\n</code></pre>\n\n<p>An example <code>line</code> is</p>\n\n<blockquote>\n  <p>43\u00b0 31' 8.3\" N, 5\u00b0 3' 13.2\" E, 0m</p>\n</blockquote>\n\n<p>And the result I'm getting is</p>\n\n<blockquote>\n  <p>Longitude : 43\u00b0 31' 8.3\" N, 5\u00b0 3' 13.2\" E</p>\n</blockquote>\n\n<p>But I was expecting</p>\n\n<blockquote>\n  <p>Longitude : 5\u00b0 3' 13.2\" E</p>\n</blockquote>\n\n<p>i'm using Qt 5.9.2 on Windows10 and can't update to a newer version because of the software i'm working on</p>\n\n<p><strong>EDIT</strong> : i managed to find a solution, instead of getting DMS(Degrees, Minute, Second) coordinates i switched to DD (Decimal Degrees) and then used global match to obtain a <code>QRegularExpressionMatchIterator</code></p>\n\n<p>here's the fixed and working code :</p>\n\n<pre><code>QRegularExpression GPSRegex(\"-|[0-9]+\\\\.+[0-9]+\");\n\n\nwhile (!file.atEnd()) {\n    QString line = file.readLine();\n    i++;\n\n    QRegularExpressionMatch matchGPSLat = GPSRegex.match(line);\n    auto matchIterator = CoordinateRegex.globalMatch(line);\n\n    if (matchGPSLat.hasMatch()) {\n\n        QString GPSLatCoordinates = matchGPSLat.captured(0);\n        while(matchIterator.hasNext())\n        {\n            auto result = matchIterator.next();\n            if (!matchIterator.hasNext())\n            {\n\n                GPSLongCoordinates = result.captured(0);\n            }\n        }\n\n        double GPSlat = GPSLatCoordinates.toDouble();\n        double GPSLong = GPSLongCoordinates.toDouble();\n    }\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1544628690, "post_id": 53746346, "comment_id": 94345016, "body": "Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in addition to copy-pasted (not paraphrased) error messages."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544628772, "post_id": 53746346, "comment_id": 94345068, "body": "Why <code>extern</code>? that&#39;s seems like a typo, that says it&#39;s declared somewhere else."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544629060, "post_id": 53746346, "comment_id": 94345266, "body": "@MatthieuBrucher - <a href=\"https://en.cppreference.com/w/cpp/language/function_template#Function_template_instantiation\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/&hellip;</a>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1544629221, "post_id": 53746346, "comment_id": 94345369, "body": "You instantiate a declaration. Where is the <b>definition</b> instantiated?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1544629306, "post_id": 53746346, "comment_id": 94345422, "body": "@StoryTeller Indeed, wrong term, I wanted to say defined."}, {"owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544629334, "post_id": 53746346, "comment_id": 94345438, "body": "in a cpp file, the declaration/instantiations are in a h file and are not members of a class"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544629360, "post_id": 53746346, "comment_id": 94345454, "body": "Remove the extern, that&#39;s enough to make it a definition, as you need."}, {"owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544629449, "post_id": 53746346, "comment_id": 94345513, "body": "if i remove extern, i get an error that i explicitly instantiate but no definition is available"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544629511, "post_id": 53746346, "comment_id": 94345552, "body": "So that means that you don&#39;t have the proper elements in your cpp file. But we don&#39;t know what is missing because the code is not complete (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544629649, "post_id": 53746346, "comment_id": 94345643, "body": "All I have in a cpp file is:"}, {"owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544629661, "post_id": 53746346, "comment_id": 94345654, "body": "template&lt;typename... Args&gt; string print(const char *format, Args... args) {     return string; }"}, {"owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544629700, "post_id": 53746346, "comment_id": 94345679, "body": "Everything else is in .h file (function declaration and instantiations i provided above)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1544629893, "post_id": 53746346, "comment_id": 94345804, "body": "Don&#39;t add information into the comment section. <a href=\"https://stackoverflow.com/posts/53746346/edit\">edit</a> it into your qeustion"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544631055, "post_id": 53746760, "comment_id": 94346552, "body": "Thank you! It actually seems that declarations do not need to be instantiated at all?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "edited": false, "score": 0, "creation_date": 1544631276, "post_id": 53746760, "comment_id": 94346680, "body": "@IamEncrypted - Strictly speaking no they don&#39;t need to be. But it serves a documentation purpose."}, {"owner": {"reputation": 576, "user_id": 5337612, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-52U8ppyS8iA/AAAAAAAAAAI/AAAAAAAAAhQ/L87ieoMPSTQ/photo.jpg?sz=128", "display_name": "Vahagn Avagyan", "link": "https://stackoverflow.com/users/5337612/vahagn-avagyan"}, "edited": false, "score": 0, "creation_date": 1545040365, "post_id": 53746760, "comment_id": 94473631, "body": "I think this is a bad answer"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1544630136, "creation_date": 1544630136, "answer_id": 53746760, "question_id": 53746346, "link": "https://stackoverflow.com/questions/53746346/how-do-you-explicitly-instantiate-variadic-template-functions-c/53746760#53746760", "title": "How do you explicitly instantiate variadic template functions? C++", "body": "<p>Instantiating declarations is all well and good, but the definitions need to be instantiated as well. Add these to your cpp file:</p>\n\n<pre><code>template&lt;typename... Args&gt;\nstring print(const char *format, Args... args) {\n    return string;\n}\n\ntemplate std::string print(const char *, const char *);\ntemplate std::string print(const char *, const char *, int);\n</code></pre>\n\n<p>Now those functions will be defined as well. Linkage should find them if your do the linking properly.</p>\n"}], "owner": {"reputation": 17, "user_id": 10781629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f639b12f70c337a77f05d5184cebb75b?s=128&d=identicon&r=PG&f=1", "display_name": "Iam Encrypted", "link": "https://stackoverflow.com/users/10781629/iam-encrypted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1544630136, "creation_date": 1544628651, "last_edit_date": 1544629969, "question_id": 53746346, "link": "https://stackoverflow.com/questions/53746346/how-do-you-explicitly-instantiate-variadic-template-functions-c", "title": "How do you explicitly instantiate variadic template functions? C++", "body": "<p>h file:</p>\n\n<p>Example Function:</p>\n\n<pre><code>template&lt;typename... Args&gt;\nstd::string print(const char *format, Args... args);\n</code></pre>\n\n<p>Attempts:</p>\n\n<pre><code>extern template std::string print(const char *, const char *);\nextern template std::string print(const char *, const char *, int);\n</code></pre>\n\n<p>cpp file:</p>\n\n<pre><code>template&lt;typename... Args&gt;\nstring print(const char *format, Args... args) {\n    return string;\n}\n</code></pre>\n\n<p>I get </p>\n\n<blockquote>\n  <p>Undefined symbols for architecture x86_64</p>\n</blockquote>\n"}, {"tags": ["c++", "visual-c++", "atl", "c-strings", "msdn"], "comments": [{"owner": {"reputation": 3128, "user_id": 2899520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d046c85ed155fb3e964d9dd4c43842a?s=128&d=identicon&r=PG&f=1", "display_name": "LearningC", "link": "https://stackoverflow.com/users/2899520/learningc"}, "edited": false, "score": 0, "creation_date": 1544628870, "post_id": 53746268, "comment_id": 94345126, "body": "this code is compiling with approach 1?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1544629263, "post_id": 53746268, "comment_id": 94345398, "body": "<code>Crash is not reproducible in-house and no dumps either.</code> so how do you know this is the source of problems? You need crash dump/log, or at least application logs to have any clue what is the problem, if you can&#39;t reproduce it. Your code sample looks valid."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1544629435, "post_id": 53746268, "comment_id": 94345504, "body": "Your macro case is exactly the same as <code>obj.SetMyString(CString(L&quot;Hello world&quot;))</code>. It&#39;s entirely unproblematic and not the source of your problems."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1544629467, "post_id": 53746268, "comment_id": 94345528, "body": "There is no difference between both approaches. In case 1 conversion is done silently in case 2 explicitly."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1544659715, "post_id": 53746268, "comment_id": 94359371, "body": "On a side note, there is no need for a macro here. I suggest to write <code>constexpr wchar_t SAMPLE_STRING[] = L&quot;Hello World&quot;;</code>. If your compiler doesn&#39;t have <code>constexpr</code>, write <code>const wchar_t* const SAMPLE_STRING = L&quot;Hello World&quot;;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10781224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vD1Juxq4az8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jK3WRPvzTJYa055mgg0Mq8uGXocw/mo/photo.jpg?sz=128", "display_name": "Ananth", "link": "https://stackoverflow.com/users/10781224/ananth"}, "is_accepted": false, "score": 0, "last_activity_date": 1545375924, "creation_date": 1545375924, "answer_id": 53880536, "question_id": 53746268, "link": "https://stackoverflow.com/questions/53746268/passing-macro-as-a-cstring-reference/53880536#53880536", "title": "Passing macro as a CString reference", "body": "<p>As everyone said, source of problem was at a differnt place. Thanks everyone for the quick response.The problem was reproduced and it helped fixed the crash. Source of problem is ,was reading a file which has english and japanese characters into an CStringA variable, while trying to do a makelower it crashed. Literally japanese characters was converted to junk in CStringA.\nCString makelower was the source of problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 10781224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vD1Juxq4az8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jK3WRPvzTJYa055mgg0Mq8uGXocw/mo/photo.jpg?sz=128", "display_name": "Ananth", "link": "https://stackoverflow.com/users/10781224/ananth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545375924, "creation_date": 1544628421, "question_id": 53746268, "link": "https://stackoverflow.com/questions/53746268/passing-macro-as-a-cstring-reference", "title": "Passing macro as a CString reference", "body": "<p>I'm analyzing a crash on my application and I suspect my current approach(Approach 1 in the code pasted below) could result in a crash,but not sure.\nI have pasted below my code for reference. Crash is not reproducible in-house and no dumps either.</p>\n\n<pre><code>#define SAMPLE_STRING L\"Hello world\"\n\nclass CFoo\n{\n    std::map &lt;CString, CString&gt; m_map;\npublic:\n    void SetMyString(__in const CString&amp;  csParam)\n    {\n        CString csKey(L\"Mykey\");\n        m_map[csKey] = csParam;\n    }\n};\nint main()\n{\n    //approach 1\n    CFoo obj;\n    obj.SetMyString(SAMPLE_STRING);\n\n\n    //approach 2\n    CFoo obj;\n    CString csMystr(SAMPLE_STRING);\n    obj.SetMyString(csMystr);\n\n}\n</code></pre>\n\n<p>Below are my questions:</p>\n\n<ol>\n<li>Can we pass the macro as a CString reference or should we create a CString intialize with the macro and then pass the reference of the CString?</li>\n<li>What is the difference between the above two approaches? </li>\n<li>Could the application crash with approach 1? If it could, Can someone please explain how?</li>\n</ol>\n"}, {"tags": ["android", "c++", "oboe"], "comments": [{"owner": {"reputation": 12122, "user_id": 824903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0903f3a872eef8fded8e48257fde823?s=128&d=identicon&r=PG", "display_name": "donturner", "link": "https://stackoverflow.com/users/824903/donturner"}, "edited": false, "score": 0, "creation_date": 1544636209, "post_id": 53746049, "comment_id": 94349408, "body": "&quot;on other devices&quot; - which devices?"}, {"owner": {"reputation": 848, "user_id": 2207137, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/xaTP3.jpg?s=128&g=1", "display_name": "TomV", "link": "https://stackoverflow.com/users/2207137/tomv"}, "reply_to_user": {"reputation": 12122, "user_id": 824903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0903f3a872eef8fded8e48257fde823?s=128&d=identicon&r=PG", "display_name": "donturner", "link": "https://stackoverflow.com/users/824903/donturner"}, "edited": false, "score": 0, "creation_date": 1544638838, "post_id": 53746049, "comment_id": 94350734, "body": "Works fine on: Moto G6 (8.0), Nexus 7 (5.1), Galaxy S3 (4.3), Pixel 2 (9),K3 2017 (6.0). Native crash on: Mate 9 (7.0) LG S6 (7.0), Galaxy S9 (8.0), Xperia XZ1 Compact (8,0), Moto G4 Play (6.0)  In fact, working closely with the Nexus 7, it seems the native crash happens sometimes."}, {"owner": {"reputation": 12122, "user_id": 824903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0903f3a872eef8fded8e48257fde823?s=128&d=identicon&r=PG", "display_name": "donturner", "link": "https://stackoverflow.com/users/824903/donturner"}, "edited": false, "score": 0, "creation_date": 1545068286, "post_id": 53746049, "comment_id": 94489249, "body": "Does the crash happen with any of the Oboe samples e.g. RhythmGame?"}, {"owner": {"reputation": 848, "user_id": 2207137, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/xaTP3.jpg?s=128&g=1", "display_name": "TomV", "link": "https://stackoverflow.com/users/2207137/tomv"}, "reply_to_user": {"reputation": 12122, "user_id": 824903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0903f3a872eef8fded8e48257fde823?s=128&d=identicon&r=PG", "display_name": "donturner", "link": "https://stackoverflow.com/users/824903/donturner"}, "edited": false, "score": 0, "creation_date": 1545491943, "post_id": 53746049, "comment_id": 94639254, "body": "On the 4 test devices in the office, no crashes are experienced with RhythmGame. The other devices used for testing was those available from Google Play when you upload an .apk to beta. One big difference between the RhythmGame and our app is that we used a mixer for about 40 sound samples, where rhythm game has 2 or 3. Could this have anything to do with it?"}], "answers": [{"comments": [{"owner": {"reputation": 848, "user_id": 2207137, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/xaTP3.jpg?s=128&g=1", "display_name": "TomV", "link": "https://stackoverflow.com/users/2207137/tomv"}, "edited": false, "score": 0, "creation_date": 1546273156, "post_id": 53948616, "comment_id": 94816383, "body": "Thanks. Checking for the nullptr on loadingFromAssets has now increased the stability, as I can handle the native error elegantly. If I detect that, I revert from native oboe/c++ to the traditional Android Soundpool."}, {"owner": {"reputation": 848, "user_id": 2207137, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/xaTP3.jpg?s=128&g=1", "display_name": "TomV", "link": "https://stackoverflow.com/users/2207137/tomv"}, "edited": false, "score": 0, "creation_date": 1546350552, "post_id": 53948616, "comment_id": 94829258, "body": "Just tried it on various devices, e.g. Samsung S9 (Android 8,0), Mate 9 Huawei (7.0), Sony Xperia XZ1 Compact (8.0), Samsung Galaxy S3 (Android 4.3) and still getting the SEGV_MAPERR crash, which unable to handle. Here&#39;s the error log from S9: Build fingerprint: &#39;samsung/starqlteue/starqlteue:8.0.0/R16NW/G960U1UEU1ARB7:us&zwnj;&#8203;er/release-keys&#39; Revision: &#39;14&#39; ABI: &#39;arm64&#39; pid: 24507, tid: 24507, name: rntomaster.dlmp  &gt;&gt;&gt; com.learntomaster.dlmp &lt;&lt;&lt; signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x90 Cause: null pointer dereference"}], "tags": [], "owner": {"reputation": 12122, "user_id": 824903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0903f3a872eef8fded8e48257fde823?s=128&d=identicon&r=PG", "display_name": "donturner", "link": "https://stackoverflow.com/users/824903/donturner"}, "is_accepted": false, "score": 1, "last_activity_date": 1545931023, "creation_date": 1545931023, "answer_id": 53948616, "question_id": 53746049, "link": "https://stackoverflow.com/questions/53746049/android-oboe-c-e-audioalsaplaybackhandlerbase-openpcmdriver-pcm-start0xef/53948616#53948616", "title": "Android oboe c++ E/AudioALSAPlaybackHandlerBase: openPcmDriver(), pcm_start(0xeff82fc0) fail due to cannot start channel: Broken pipe", "body": "<p>My guess is that your application is attempting to use more memory than is available to it. Each time you call <code>SoundRecording::loadFromAssets</code> you're loading the entire contents of a sound file into memory and you have 40 sound files. </p>\n\n<p>If even one of these sound files fails to load then the resulting <code>SoundRecording *</code> object will be null pointer. This is added to the <code>Mixer</code>. After calling <code>mAudioStream-&gt;requestStart()</code> the first callback occurs during which <code>Mixer::renderAudio</code> is called, which in turn calls <code>SoundRecording::renderAudio</code> which dereferences that null pointer <a href=\"https://stackoverflow.com/a/28116503/824903\">causing the SEGV_MAPERR</a>.</p>\n\n<p>I'm not 100% sure but I think at least one callback needs to occur to start the stream (it certainly does when using OpenSL ES), which would explain why the <code>pcm_start</code> method fails. </p>\n\n<p>An easy way to verify this is to check for <code>nullptr</code> after calling <code>loadFromAssets</code>:</p>\n\n<pre><code>if (stdB == nullptr){ LOGE(\"Failed to load sound file\"); }\n</code></pre>\n\n<p>You should also check out the <a href=\"https://github.com/google/oboe/commits/master/samples\" rel=\"nofollow noreferrer\">updated sample code</a> which fixes a memory leak in the RhythmGame sample, and uses smart pointers. </p>\n"}], "owner": {"reputation": 848, "user_id": 2207137, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/xaTP3.jpg?s=128&g=1", "display_name": "TomV", "link": "https://stackoverflow.com/users/2207137/tomv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611049200, "creation_date": 1544627655, "question_id": 53746049, "link": "https://stackoverflow.com/questions/53746049/android-oboe-c-e-audioalsaplaybackhandlerbase-openpcmdriver-pcm-start0xef", "title": "Android oboe c++ E/AudioALSAPlaybackHandlerBase: openPcmDriver(), pcm_start(0xeff82fc0) fail due to cannot start channel: Broken pipe", "body": "<p>On some devices, android oboe library for high performance audio is working fine. However on other devices it crashes after loading the sound files. </p>\n\n<p>This jni method is executed fine:</p>\n\n<pre><code>void SoundFunctions::loadSounds() {\n\n    LOGD(\"SoundFunctions loadSounds called\");\n\n    // Load the RAW PCM data files for both the clap sound and backing track into memory.\n    stdB = SoundRecording::loadFromAssets(mAssetManager, \"std_kit_b.wav\");\n    stdSN= SoundRecording::loadFromAssets(mAssetManager, \"std_kit_sn.wav\");\n\n    // Add all to mixer\n    mMixer.addTrack(stdB);\n    mMixer.addTrack(stdSN);\n\n\n    // Create a builder\n    AudioStreamBuilder builder;\n    builder.setFormat(AudioFormat::I16);\n    builder.setChannelCount(1);\n    builder.setSampleRate(kSampleRateHz);\n    builder.setCallback(this);\n    builder.setPerformanceMode(PerformanceMode::LowLatency);\n    builder.setSharingMode(SharingMode::Exclusive);\n    LOGD(\"After creating a builder\");\n\n    // Open stream\n    Result result = builder.openStream(&amp;mAudioStream);\n    if (result != Result::OK){\n        LOGE(\"Failed to open stream. Error: %s\", convertToText(result));\n    }\n    LOGD(\"After openstream\");\n\n    // Reduce stream latency by setting the buffer size to a multiple of the burst size\n    mAudioStream-&gt;setBufferSizeInFrames(mAudioStream-&gt;getFramesPerBurst() * 2);\n\n    // Start the stream\n    result = mAudioStream-&gt;requestStart();\n    if (result != Result::OK){\n        LOGE(\"Failed to start stream. Error: %s\", convertToText(result));\n    }\n    LOGD(\"After starting stream\");\n\n\n}\n</code></pre>\n\n<p>However, shortly afterwards, there is a native crash E/AudioALSAPlaybackHandlerBase: openPcmDriver(), pcm_start(0xeff82fc0) fail due to cannot start channel: Broken pipe</p>\n\n<p><strong>What does it mean and how can I resolve?</strong></p>\n\n<p>This is the error log:</p>\n\n<blockquote>\n  <p>12-12 14:55:14.995 11622-11622/com.learntomaster.dlmp D/RhythmGame:\n  After starting stream 12-12 14:55:15.006 1462-1987/?\n  E/AudioALSAPlaybackHandlerBase: openPcmDriver(), pcm_start(0xeff82fc0)\n  fail due to cannot start channel: Broken pipe</p>\n\n<pre><code>--------- beginning of crash 12-12 14:55:15.047 11622-11622/com.learntomaster.dlmp A/libc: Fatal signal 11 (SIGSEGV),\n</code></pre>\n  \n  <p>code 1, fault addr 0x90 in tid 11622 (rntomaster.dlmp) 12-12\n  14:55:15.137 10957-11660/? E/Icing: Aborting indexing of corpus\n  playlists 12-12 14:55:15.151 11895-11895/? I/AEE/AED: <strong>* <em></strong> <strong></em> <em></strong>\n  <strong></em> <em></strong> <strong></em> <em></strong> <strong></em> <em></strong> <strong></em> <em></strong> <strong></em> <em></strong> <strong></em> *</strong> 12-12 14:55:15.152 11895-11895/? I/AEE/AED: Build fingerprint:\n  'Lenovo/LenovoTB3-850F/TB3-850F:6.0/MRA58K/TB3-850F_S100031_171010_ROW:user/release-keys'\n  12-12 14:55:15.152 11895-11895/? I/AEE/AED: Revision: '0' 12-12\n  14:55:15.152 11895-11895/? I/AEE/AED: ABI: 'arm64' 12-12 14:55:15.152\n  11895-11895/? I/AEE/AED: pid: 11622, tid: 11622, name: rntomaster.dlmp</p>\n  \n  <blockquote>\n    <blockquote>\n      <blockquote>\n        <p>com.learntomaster.dlmp &lt;&lt;&lt; 12-12 14:55:15.152 11895-11895/? I/AEE/AED: signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x90\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x0   0000000000000090 \n        x1   0000007fdedc7540  x2   0000000000000000  x3   0000000000000000\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x4   0000000000000000 \n        x5   0000000000000000  x6   0000000000000000  x7   0000000000000000\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x8   0000000000000001 \n        x9   0000007f956290a0  x10  0000000000000001  x11  0000007f937c20e0\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x12  0000007f96ecea40 \n        x13  0000000000000004  x14  0000000000000005  x15  00000000000000c0\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x16  0000007f9562e760 \n        x17  0000007f96e9048c  x18  0000007f937c20e0  x19  0000000000000000\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x20  0000000000000090 \n        x21  0000007f7ea3b488  x22  0000007f7ea3b380  x23  0000007f7ea3b4b0\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x24  0000007fdedc7540 \n        x25  0000000000000000  x26  0000007fdedc7a78  x27  0000279200002d66\n        12-12 14:55:15.174 11895-11895/? I/AEE/AED:     x28  0000279200002d66 \n        x29  0000007fdedc7490  x30  0000007f955948a4 12-12 14:55:15.174\n        11895-11895/? I/AEE/AED:     sp   0000007fdedc7490  pc<br>\n        0000007f96e90494  pstate 0000000060000000 12-12 14:55:15.195\n        1462-1988/? E/AudioFlinger: getNextBuffer, get null buffer 12-12\n        14:55:15.203 11895-11895/? I/AEE/AED: backtrace: 12-12 14:55:15.203\n        11895-11895/? I/AEE/AED:     #00 pc 0000000000068494 \n        /system/lib64/libc.so (pthread_mutex_lock+8) 12-12 14:55:15.203\n        11895-11895/? I/AEE/AED:     #01 pc 000000000002f8a0 \n        /system/lib64/libhwui.so\n        (_ZN7android10uirenderer12renderthread12RenderThread5queueEPNS1_10RenderTaskE+28)\n        12-12 14:55:15.203 11895-11895/? I/AEE/AED:     #02 pc\n        000000000002e324  /system/lib64/libhwui.so\n        (_ZN7android10uirenderer12renderthread11RenderProxy11postAndWaitEPNS1_22MethodInvokeRenderTaskE+132)\n        12-12 14:55:15.203 11895-11895/? I/AEE/AED:     #03 pc\n        000000000002e600  /system/lib64/libhwui.so\n        (_ZN7android10uirenderer12renderthread11RenderProxy20loadSystemPropertiesEv+92)\n        12-12 14:55:15.203 11895-11895/? I/AEE/AED:     #04 pc\n        0000000002a1b990  /system/framework/arm64/boot.oat (offset 0x2439000)\n        12-12 14:55:15.795 1858-1858/? E/WifiTrafficPoller: TRAFFIC_STATS_POLL\n        true Token 14 num clients 9 12-12 14:55:15.796 1858-1858/?\n        E/WifiTrafficPoller:  packet count Tx=11477 Rx=15018 12-12\n        14:55:15.823 11895-11895/? I/AEE/AED: Tombstone written to:\n        /data/tombstones/tombstone_04 12-12 14:55:15.824 11895-11895/?\n        E/AEE/AED: AM write failed: Broken pipe 12-12 14:55:15.824\n        11895-11895/? E/AEE/AED: request.action: 0</p>\n      </blockquote>\n    </blockquote>\n  </blockquote>\n</blockquote>\n"}, {"tags": ["c++", "opencv", "visual-studio-2015"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1544628483, "post_id": 53745946, "comment_id": 94344899, "body": "<code>I have tried to delete the Detector</code>: What does this mean? Is the error shown from this exact code you posted? <code>Ptr</code> is a shared smart pointer, it should not be <code>delete</code>d. Why are you using <code>new</code> and the non-standard reference binding anyway? Just declare automatic storage duration non-reference variables: <code>SimpleBlobDetector::Params parameters;</code> and <code>SimpleBlobDetector Detector(parameters);</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1544628695, "post_id": 53745946, "comment_id": 94345021, "body": "<code>parameters</code> is a non-const reference to a temporary object that doesn&#39;t exist after that line; using it is undefined and anything can happen. That it compiles is a known bug in Visual C++ (although Microsoft prefer to call it &quot;language extension&quot;)."}, {"owner": {"reputation": 1, "user_id": 6919902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c989957e477d511d6fa0e6fa03c10ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Zeng", "link": "https://stackoverflow.com/users/6919902/jack-zeng"}, "edited": false, "score": 0, "creation_date": 1544673379, "post_id": 53745946, "comment_id": 94362209, "body": "@user10605163 yes the code is show from that code, and after change to non-reference variables, it shows another error as shown in the update."}, {"owner": {"reputation": 1, "user_id": 6919902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c989957e477d511d6fa0e6fa03c10ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Zeng", "link": "https://stackoverflow.com/users/6919902/jack-zeng"}, "edited": false, "score": 0, "creation_date": 1544686043, "post_id": 53745946, "comment_id": 94365957, "body": "@user10605163 @molbdnilo thanks again. By initializing the vector with a (large enough) size (like 100), <code>vector&lt;KeyPoint&gt; keypoints(100);</code>it works well .(though I don&#39;t know why...)"}], "owner": {"reputation": 1, "user_id": 6919902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c989957e477d511d6fa0e6fa03c10ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Zeng", "link": "https://stackoverflow.com/users/6919902/jack-zeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544692037, "creation_date": 1544627316, "last_edit_date": 1544692037, "question_id": 53745946, "link": "https://stackoverflow.com/questions/53745946/opencv-2-4-9-simpleblobdetector-debug-assertion-failed-dbgdel-cpp-line52-blo", "title": "OpenCV 2.4.9 SimpleBlobDetector Debug Assertion Failed ..dbgdel.cpp line:52 _BLOCK_TYPE_IS_VALID(pHead-&gt;nBlockUse)", "body": "<p>The error is like\nDebug Assertion Failed!</p>\n\n<p>File:f:\\dd\\vctools\\crt_bld\\self_x86\\crt\\dbgdel.cpp</p>\n\n<p>Line 52</p>\n\n<p>Expression\" _BLOCK_TYPE_IS_VALID(pHead-> nBlockUse)</p>\n\n<p>my code is like:</p>\n\n<pre><code>bool test()\n{\nMat testImg = imread(\"test.bmp\",0);\nvector&lt;KeyPoint&gt; keypoints;\nSimpleBlobDetector::Params &amp;parameters = SimpleBlobDetector::Params();\nparameters.maxArea = 100000;\nparameters.maxThreshold = 1000;\nPtr&lt;FeatureDetector&gt; Detector  =  new SimpleBlobDetector(parameters);\nDetector-&gt;detect(testImg,keypoints);\nreturn true;\n}\n</code></pre>\n\n<p>I have tried to delete the Detector but didn't work, the error occurs in the last return sentense and my environment is Visual Studio 2015 32bit Debug mode,and opencv version is 2.4.9.</p>\n\n<p>Beside, when I debug into it, the error appears when releasing the object in core/operation.hpp </p>\n\n<pre><code>~Ptr(){ release();}\n</code></pre>\n\n<p>When deleting the obj in line around 2616, it shows the error window.</p>\n\n<p>--------------update------------</p>\n\n<p>Thank user10605163 and molbdnilo. Sorry that I'm not so familiar with smart pointer so I delete it just to make sure there's no mistakes like memory leaks.</p>\n\n<p>I change my code as follow:</p>\n\n<pre><code>Mat testImg = imread(\"testIMG.bmp\",0);\nvector&lt;KeyPoint&gt; keypoints;\nSimpleBlobDetector::Params parameters;\nparameters.maxArea = 100000;\nparameters.maxThreshold = 1000;\nSimpleBlobDetector Detector(parameters);\nDetector.detect(testImg,keypoints);\nreturn true;\n</code></pre>\n\n<p>Still ,it doesn't work, but the error is a little different :</p>\n\n<pre><code>Debug Assertion Failed!\nFile:minkernel\\crts\\ucrt\\src\\appcrt\\heap\\debug_heap.cpp\nLine:892\nExpression:is_block_type_valid(header-&gt;_block_use)\n</code></pre>\n\n<p>This time the error seems to occur when deconstructing the vector.\nIn include/vector around line 973:</p>\n\n<pre><code>~vector()\n{\n   _Tidy();\n}\n_Tidy()\n{\n /* ... */\n this-&gt;_Getal().deallocate(this-&gt;_Myfitst(),this-&gt;Myend() - this-&gt;_Myfirst());\n/*...*/\n\n}\n/*debugging into, at delete_scalar.cpp line 17 _free_dbg() */\nvoid __CRTDECL operator delete(void* const block) noexcept\n{\n    #ifdef _DEBUG\n    _free_dbg(block,_UNKNOWN_BLOCK);\n    #else\n    free(block);\n    #endif\n}\n</code></pre>\n\n<p>It's wierd that the error occurs when the vector is deconstructing, but if I comment <code>Detector.detect(testImg,keypoint)</code>,without changing other things about the vector,it works fine (but does not do anything though).And the wierdest thing is, when I test the origin code in OpenCV project that build from the source code(same version, VS 2015 32bit Debug too), it worked well!</p>\n\n<p>-----------------update--------------------</p>\n\n<p>Finally I built the opencv source code and use the lib file in my project, and it worked fine.Before I was using the lib extracted from the exe file.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 51244, "user_id": 952747, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/86ebf3cf751f63acb38e763f7104a318?s=128&d=identicon&r=PG&f=1", "display_name": "masoud", "link": "https://stackoverflow.com/users/952747/masoud"}, "edited": false, "score": 1, "creation_date": 1544627296, "post_id": 53745912, "comment_id": 94344195, "body": "Maybe &quot;Explicit is better than implicit&quot; !"}, {"owner": {"reputation": 141, "user_id": 10686130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e141d8e91574ceb58f8f59612711c0?s=128&d=identicon&r=PG&f=1", "display_name": "ronald_s56", "link": "https://stackoverflow.com/users/10686130/ronald-s56"}, "reply_to_user": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1544627373, "post_id": 53745912, "comment_id": 94344238, "body": "@CinCout when using auto it makes sense, when the type is specified, what is the point."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1544629099, "last_edit_date": 1544629099, "creation_date": 1544627633, "answer_id": 53746044, "question_id": 53745912, "link": "https://stackoverflow.com/questions/53745912/is-there-any-need-to-make-an-integer-literal-unsigned/53746044#53746044", "title": "Is there any need to make an integer literal unsigned?", "body": "<p>There is no point at all in writing <code>u</code> in your case as the compiler will make the conceptual conversion. It's a bad habit to get into insfar that it can introduce portability issues.</p>\n\n<p>It is occasionally necessary though: <code>std::accumulate</code> is an important example - the type of the initial value is the type of the result.</p>\n\n<p>If you were to use <code>auto</code> then you'll see that the rules become quite involved. For example, if you use a hexadecimal literal then the <code>unsigned</code> types become candidates.</p>\n\n<p>Reference: <a href=\"https://en.cppreference.com/w/cpp/language/integer_literal\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/integer_literal</a></p>\n"}], "owner": {"reputation": 141, "user_id": 10686130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e141d8e91574ceb58f8f59612711c0?s=128&d=identicon&r=PG&f=1", "display_name": "ronald_s56", "link": "https://stackoverflow.com/users/10686130/ronald-s56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 1, "accepted_answer_id": 53746044, "answer_count": 1, "score": 7, "last_activity_date": 1544629099, "creation_date": 1544627204, "last_edit_date": 1544627493, "question_id": 53745912, "link": "https://stackoverflow.com/questions/53745912/is-there-any-need-to-make-an-integer-literal-unsigned", "title": "Is there any need to make an integer literal unsigned?", "body": "<p>I see lots of code doing things like,</p>\n\n<pre><code>static constexpr std::size_t value = 1024u;\n</code></pre>\n\n<p>I understand that <code>u</code> is specifying <code>1024</code> as an unsigned integer, but why bother with marking as <code>unsigned</code>?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 4, "creation_date": 1544626136, "post_id": 53745558, "comment_id": 94343469, "body": "You need to cast it. But doesn&#39;t work if you are building in 64bits and warned strongly against in modern C++ compilers with the proper flags."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1544626206, "post_id": 53745558, "comment_id": 94343516, "body": "<code>uintptr_t</code> is exactly for this purpose."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1544626232, "post_id": 53745558, "comment_id": 94343535, "body": "<code>int y = *(int*)x;</code>. Are you sure that your <code>uint32_t</code> is holding an address, though?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1544626235, "post_id": 53745558, "comment_id": 94343536, "body": "Read about casting (a.k.a. explicit conversion) in your favourite book. (You should be using <code>uintptr_t</code> and not assume 32-bit addresses.)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1544626423, "post_id": 53745558, "comment_id": 94343656, "body": "C or C++? The rules on this topic differ."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1544626467, "post_id": 53745558, "comment_id": 94343691, "body": "While it is true, that for portability <code>uintptr_t</code> should be used, it is often the case that the code is written for a specific (embedded) architecture, where the address is known to be 32-bit long <i>and</i> apparently might be stored in some memory / register known to be 32-bit long and thus naturally defined as <code>uint32_t</code>."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1544627026, "post_id": 53745558, "comment_id": 94344049, "body": "How do you get the address? What platform? Also, C or C++, answers differ..."}, {"owner": {"reputation": 3733, "user_id": 2013672, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4010c640f24dec3e17b12eb57226255e?s=128&d=identicon&r=PG&f=1", "display_name": "Sadik", "link": "https://stackoverflow.com/users/2013672/sadik"}, "edited": false, "score": 0, "creation_date": 1544627304, "post_id": 53745558, "comment_id": 94344202, "body": "I get the address through magic. C is actually preferable here."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1544626641, "creation_date": 1544626641, "answer_id": 53745746, "question_id": 53745558, "link": "https://stackoverflow.com/questions/53745558/assign-memory-address-stored-in-int-to-int/53745746#53745746", "title": "Assign memory address stored in int to int", "body": "<p>An integer type which is large enough to represent all data pointers can be converted into a pointer using <code>reinterpret_cast</code> or an explicit conversion. The pointer can be indirected to get the pointed value using the indirection operator.</p>\n\n<p>Note that <code>uint32_t</code> is not guaranteed to be large enough to be able to represent all pointer values (and in fact will not be enough on modern 64 bit cpus). <code>uintptr_t</code> is meant precisely for this purpose.</p>\n\n<p>Note that if the pointed address does not contain an object (of compatible type), then behaviour will be undefined.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 2, "last_activity_date": 1544627356, "creation_date": 1544627356, "answer_id": 53745960, "question_id": 53745558, "link": "https://stackoverflow.com/questions/53745558/assign-memory-address-stored-in-int-to-int/53745960#53745960", "title": "Assign memory address stored in int to int", "body": "<p><strong>In C++ this can be done using <code>reinterpret_cast</code></strong></p>\n\n<blockquote>\n  <p><strong>8.5.1.10 Reinterpret cast [expr.reinterpret.cast]</strong><br>\n  ...<br>\n  5.  A value of integral type or enumeration type can be explicitly converted to a pointer. A pointer converted to an integer of sufficient size (if any such exists on the implementation) and back to the same pointer type will have its original value; mappings between pointers and integers are otherwise implementation-de\ufb01ned. [Note: Except as described in 6.6.4.4.3, the result of such a conversion will not be a safely-derived pointer value. \u2014end note] </p>\n</blockquote>\n\n<p><strong>And the rules in 6.6.4.4.3 state:</strong>  </p>\n\n<blockquote>\n  <p>An integer value is an integer representation of a safely-derived pointer only if its type is at least as large as <code>std::intptr_t</code> and it is one of the following:<br>\n  \u2014(3.1) the result of a reinterpret_cast of a safely-derived pointer value;<br>\n  \u2014(3.2) the result of a valid conversion of an integer representation of a safely-derived pointer value;<br>\n  \u2014(3.3) the value of an object whose value was copied from a traceable pointer object, where at the time of the copy the source object contained an integer representation of a safely-derived pointer value;<br>\n  \u2014(3.4) the result of an additive or bitwise operation, one of whose operands is an integer representation of a safely-derived pointer value P, if that result converted by <code>reinterpret_cast&lt;void*&gt;</code> would compare equal to a safely-derived pointer computable from <code>reinterpret_cast&lt;void*&gt;(P)</code>.   </p>\n</blockquote>\n\n<p>So if <code>x</code> (in the question) has a type at least as large as <code>std::intptr_t</code> and is already an integral representation of a safely derived pointer as per the rules above, you will be able to get the value behind the address stored in <code>x</code>.</p>\n"}], "owner": {"reputation": 3733, "user_id": 2013672, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4010c640f24dec3e17b12eb57226255e?s=128&d=identicon&r=PG&f=1", "display_name": "Sadik", "link": "https://stackoverflow.com/users/2013672/sadik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544627356, "creation_date": 1544626052, "question_id": 53745558, "link": "https://stackoverflow.com/questions/53745558/assign-memory-address-stored-in-int-to-int", "title": "Assign memory address stored in int to int", "body": "<p>Assuming the value of <code>uint32_t x</code> is an address. How can I get the value behind this address?\nMy try was to simply assign the address to a pointer.</p>\n\n<pre><code>int*y = x;\n</code></pre>\n\n<p>But x is not an int pointer, it's just int with an address as value.</p>\n"}, {"tags": ["c++", "c++14", "language-lawyer", "new-expression"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1544627605, "post_id": 53745158, "comment_id": 94344370, "body": "Out of curiosity, a double allows for fractional quantities, so how would you allocate 0.75 of an integer, such as <code>int * p_array = new int [0.75];</code>?  Or take something like 0.33333333, which is kind of difficult to allocate."}, {"owner": {"reputation": 749, "user_id": 10663732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNDF3.jpg?s=128&g=1", "display_name": "tomer zeitune", "link": "https://stackoverflow.com/users/10663732/tomer-zeitune"}, "edited": false, "score": 0, "creation_date": 1544629843, "post_id": 53745158, "comment_id": 94345776, "body": "I expect it to use the binary value of it as an integer even when it&#39;s a double so 0.75 would be 0011111111101 as an integer it&#39;s 16360"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 5, "creation_date": 1544630395, "post_id": 53745158, "comment_id": 94346180, "body": "@ThomasMatthews no this would end up being a float to integral conversion and <a href=\"http://eel.is/c++draft/conv.fpint#1\" rel=\"nofollow noreferrer\">would truncate the float</a>"}, {"owner": {"reputation": 749, "user_id": 10663732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNDF3.jpg?s=128&g=1", "display_name": "tomer zeitune", "link": "https://stackoverflow.com/users/10663732/tomer-zeitune"}, "edited": false, "score": 0, "creation_date": 1544635377, "post_id": 53745158, "comment_id": 94348938, "body": "@ShafikYaghmour yea that&#39;s what I was thinking"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 749, "user_id": 10663732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNDF3.jpg?s=128&g=1", "display_name": "tomer zeitune", "link": "https://stackoverflow.com/users/10663732/tomer-zeitune"}, "edited": false, "score": 1, "creation_date": 1544694658, "post_id": 53745158, "comment_id": 94370145, "body": "@tomerzeitune Well, that (0.75 -&gt; 0) is not what you wrote (0.75 -&gt; 16360) ;)"}, {"owner": {"reputation": 749, "user_id": 10663732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNDF3.jpg?s=128&g=1", "display_name": "tomer zeitune", "link": "https://stackoverflow.com/users/10663732/tomer-zeitune"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1544702161, "post_id": 53745158, "comment_id": 94374379, "body": "@Bob__ it won&#39;t round towards zero it will refer to it as an int like type punning"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 749, "user_id": 10663732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNDF3.jpg?s=128&g=1", "display_name": "tomer zeitune", "link": "https://stackoverflow.com/users/10663732/tomer-zeitune"}, "edited": false, "score": 1, "creation_date": 1544740545, "post_id": 53745158, "comment_id": 94393915, "body": "@tomerzeitune Why <code>int</code>? Why not <code>unsigned</code> or <code>long</code>?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 749, "user_id": 10663732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNDF3.jpg?s=128&g=1", "display_name": "tomer zeitune", "link": "https://stackoverflow.com/users/10663732/tomer-zeitune"}, "edited": false, "score": 0, "creation_date": 1544741542, "post_id": 53745158, "comment_id": 94394237, "body": "@tomerzeitune: I&#39;m curious what basis you see for asserting that this would use type punning. Of what possible use would that be? Converting a floating-point value to an integer type (<code>5.0</code> to <code>5</code>) would make a lot more sense."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1544811112, "post_id": 53745158, "comment_id": 94421264, "body": "@KeithThompson I think the commenters are joking around"}], "answers": [{"comments": [{"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 19, "creation_date": 1544629705, "post_id": 53745159, "comment_id": 94345682, "body": "I am dubious about the usefulness of allowing <code>double</code> to be used as the size of an array... it seems more likely to let bugs pass silently than anything else :("}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 13, "creation_date": 1544630234, "post_id": 53745159, "comment_id": 94346057, "body": "@MatthieuM. I agree, I believe it is a defect and that the intent was really to say <code>contextually implicitly converted</code>. I am filing a defect report on this hopefully today but who knows maybe I am wrong :-("}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 3, "creation_date": 1544810171, "post_id": 53745159, "comment_id": 94420852, "body": "@MatthieuM. FYI I filed a defect report, processing takes a while so I don&#39;t expect to have an update anytime soon though."}], "tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": false, "score": 44, "last_activity_date": 1544886011, "last_edit_date": 1544886011, "creation_date": 1544624733, "answer_id": 53745159, "question_id": 53745158, "link": "https://stackoverflow.com/questions/53745158/in-c14-is-it-valid-to-use-a-double-in-the-dimension-of-a-new-expression/53745159#53745159", "title": "In C++14 is it valid to use a double in the dimension of a new expression?", "body": "<p>Clang is correct, the key wording in <a href=\"https://timsong-cpp.github.io/cppwp/n3337/expr.new#6\" rel=\"nofollow noreferrer\">[expr.new]p6</a> changes from the following in the C++11 draft:</p>\n\n<blockquote>\n  <p>Every <em>constant-expression</em> in a <em>noptr-new-declarator</em> shall be an integral constant expression ([expr.const]) and evaluate to a strictly positive value. <strong>The expression in a <em>noptr-new-declarator</em> shall be of integral type, unscoped enumeration type, or a class type for which a single non-explicit conversion function to integral or unscoped enumeration type exists</strong> ([class.conv]). If the expression is of class type, the expression is converted by calling that conversion function, and the result of the conversion is used in place of the original expression. \u2026</p>\n</blockquote>\n\n<p>to <a href=\"https://timsong-cpp.github.io/cppwp/n4140/expr.new#6\" rel=\"nofollow noreferrer\">this in the C++14 draft</a>:</p>\n\n<blockquote>\n  <p>Every <em>constant-expression</em> in a <em>noptr-new-declarator</em> shall be a converted constant expression ([expr.const]) of type <code>std::size_t</code> and shall evaluate to a strictly positive value. <strong>The expression in a <em>noptr-new-declarator</em> is implicitly converted to <code>std::size_t</code></strong>. \u2026</p>\n</blockquote>\n\n<p>In C++14 the requirement for the expression in a <em>noptr-new-declarator</em> was weakened to not require an integral, unscoped enumeration or a class with a \nsingle non-explicit conversion function to one of those types but just allow implicit conversions to <em>size_t</em>.</p>\n\n<p>The change in wording came from the proposal <a href=\"https://wg21.link/n3323\" rel=\"nofollow noreferrer\">A Proposal to Tweak Certain C++ Contextual Conversions, v3</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1547109778, "last_edit_date": 1547109778, "creation_date": 1544798087, "answer_id": 53781700, "question_id": 53745158, "link": "https://stackoverflow.com/questions/53745158/in-c14-is-it-valid-to-use-a-double-in-the-dimension-of-a-new-expression/53781700#53781700", "title": "In C++14 is it valid to use a double in the dimension of a new expression?", "body": "<p>From <a href=\"/questions/tagged/c%2b%2b14\" class=\"post-tag\" title=\"show questions tagged &#39;c++14&#39;\" rel=\"tag\">c++14</a> to <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> (for the ones that wonder like me), the phrasing remains practically the same (unlike from C++11 to C++14 as @ShafikYaghmour answered), as stated in this <a href=\"https://timsong-cpp.github.io/cppwp/n4140/expr.new#6\" rel=\"nofollow noreferrer\">C++17 draft</a>:</p>\n\n<blockquote>\n  <p>Every <em>constant-expression</em> in a <em>noptr-new-declarator</em> shall be a converted constant expression of type <code>std::size_t</code> and shall evaluate to a strictly positive value. <strong>The expression in a <em>noptr-new-declarator</em> is implicitly converted to <code>std::size_t</code></strong>. [..]</p>\n</blockquote>\n\n<p>with only this part <code>([expr.const])</code> missing from the C++17 draft.</p>\n"}], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2218, "favorite_count": 1, "answer_count": 2, "score": 42, "last_activity_date": 1547109778, "creation_date": 1544624733, "last_edit_date": 1544735403, "question_id": 53745158, "link": "https://stackoverflow.com/questions/53745158/in-c14-is-it-valid-to-use-a-double-in-the-dimension-of-a-new-expression", "title": "In C++14 is it valid to use a double in the dimension of a new expression?", "body": "<p>In C++14 given the following code:</p>\n\n<pre><code>void foo() {\n  double d = 5.0;\n  auto p1 = new int[d];\n}\n</code></pre>\n\n<p>clang compiles this without diagnostic while gcc on the other hand produces the following diagnostic (<a href=\"https://godbolt.org/z/8HDfZV\" rel=\"noreferrer\">see it live in godbolt</a>):</p>\n\n<pre><code>error: expression in new-declarator must have integral or enumeration type\n    7 |     auto p1 = new int[d];\n      |                       ^\n</code></pre>\n\n<p>I specifically labeled this C++14 because in C++11 mode clang treats this as ill-formed and produces the following diagnostic (<a href=\"https://godbolt.org/z/ooUuqM\" rel=\"noreferrer\">see it live in godbolt</a>):</p>\n\n<pre><code>error: array size expression must have integral or unscoped enumeration type, not 'double'\n    auto p1 = new int[d];\n              ^       ~\n</code></pre>\n\n<p>Is clang correct? If so what changed in C++14 to allow this?</p>\n"}, {"tags": ["c++", "c++11", "compiler-errors", "runtime-error", "global-variables"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1544625020, "post_id": 53745137, "comment_id": 94342779, "body": "&quot;<i>My question is more why this specific example doesn&#39;t throw some sort of error, cause in my opinion it should.</i>&quot; Why should it throw any error? Undefined behavior is undefined."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544625141, "post_id": 53745137, "comment_id": 94342862, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/469597/destruction-order-of-static-objects-in-c\">Destruction order of static objects in C++</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1544625808, "post_id": 53745137, "comment_id": 94343263, "body": "The vector doesn&#39;t exist at that point. There is nothing it <i>can</i> do."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1544626467, "post_id": 53745137, "comment_id": 94343689, "body": "Your program exhibits undefined behavior in <code>B::B</code> already, by way of accessing <code>B::v_</code> before its lifetime has started."}, {"owner": {"reputation": 326, "user_id": 7576082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55dd92fa2efa971a901d11598532c76e?s=128&d=identicon&r=PG&f=1", "display_name": "rinn2883", "link": "https://stackoverflow.com/users/7576082/rinn2883"}, "edited": false, "score": 0, "creation_date": 1544639889, "post_id": 53745137, "comment_id": 94351276, "body": "mhh so this falls under undefined behavior instead of reading or writing an illegal memory location since the vector doesn&#39;t exist at that point? I was kinda thinking this would/should generate a seg fault and I don&#39;t understand why it doesn&#39;t"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 0, "last_activity_date": 1544647568, "creation_date": 1544647568, "answer_id": 53751081, "question_id": 53745137, "link": "https://stackoverflow.com/questions/53745137/c-understanding-accessing-global-variables-after-cleanup-does-not-give-some-so/53751081#53751081", "title": "c++ understanding accessing global variables after cleanup does not give some sort of error", "body": "<p>Undefined behavior means that the behavior of your program is not defined by the C++ standard.  A conforming C++ compiler can do <strong>anything</strong> with a program that has, or <strong>will</strong>, exhibit undefined behavior (yes, UB can time travel).</p>\n\n<p>Your program exhibits undefined behavior by accessing <code>v_</code> as an object prior to it being constructed in <code>B::B</code>.  Given that it does this, nothing about your programs execution is specified or constrained by the C++ standard.</p>\n\n<p>In this case, the compiler treats the UB access as if it was accessing an empty <code>std::vector</code>.  This is valid, because <strong>anything is valid</strong>.  The program then proceeds as-if you hadn't done the UB (other than the above symptom), which is also a valid option.</p>\n\n<p>If we imagine removing the UB in the ctor, during destruction your program again exhibits UB.  This time by accessing <code>v_</code> as a <code>vector</code> object after it was destroyed.  Again, by doing this the behavior of your program is not defined or constrained by the C++ standard, before, at, and after the UB.</p>\n\n<p>In this case, it behaves as if you have a vector of 2 values whose values are 0.  That is conforming, because <strong>anything is conforming</strong>.</p>\n\n<p>One of many possibilities is that the data was recycled on the heap, but the pointers where left dangling.  Treating the vector's \"rotted\" data as pointers they still point 2 <code>sizeof(int)</code> apart, and <code>.size()</code> reads that as 2.  The data pointed to, however, has been recycled on the heap, and there is different data there.</p>\n"}], "owner": {"reputation": 326, "user_id": 7576082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55dd92fa2efa971a901d11598532c76e?s=128&d=identicon&r=PG&f=1", "display_name": "rinn2883", "link": "https://stackoverflow.com/users/7576082/rinn2883"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53751081, "answer_count": 1, "score": 2, "last_activity_date": 1544647568, "creation_date": 1544624657, "last_edit_date": 1544640088, "question_id": 53745137, "link": "https://stackoverflow.com/questions/53745137/c-understanding-accessing-global-variables-after-cleanup-does-not-give-some-so", "title": "c++ understanding accessing global variables after cleanup does not give some sort of error", "body": "<p>I have a question about how global variables work in c++.\n<strong>I know global variables are evil so that is not the point of this question. I just want a deeper understanding of what is happening in the following example.</strong></p>\n\n<pre><code>#include &lt;cstdint&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nclass B\n{\npublic:\n  B();\n  ~B();\nprivate:\n  static std::vector&lt;int32_t&gt; v_;\n};\n\nB::B()\n{\n  std::cout &lt;&lt; \"v_.size() = \" &lt;&lt; v_.size() &lt;&lt; std::endl;\n  for (auto i : v_)\n    std::cout &lt;&lt; i &lt;&lt; std::endl;\n}\n\nB::~B()\n{\n  std::cout &lt;&lt; \"v_.size() = \" &lt;&lt; v_.size() &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"v_[0] = \" &lt;&lt; v_[0] &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"v_.at(0) = \" &lt;&lt; v_.at(0) &lt;&lt; std::endl;\n  for (auto i : v_)\n    std::cout &lt;&lt; i &lt;&lt; std::endl;\n}\n\nB b;\n\nstd::vector&lt;int32_t&gt; B::v_ { 5, -7 };\n\nint main()\n{\n  return 0;\n}\n</code></pre>\n\n<p>Gives this output:</p>\n\n<pre><code>$ ./test \nv_.size() = 0\nv_.size() = 2\nv_[0] = 0\nv_.at(0) = 0\n0\n0\n</code></pre>\n\n<p>Why is the size of the vector in the destructor of B still 2?</p>\n\n<p>When I access the elements of the vector I get random memory, which I sort of understand because the vector gets cleaned up before B. But to me the size of the vector should be 0 or even way better throw some sort of error when asking for the size. Even when using at() function It doesn't throw an error because the size is still 2.</p>\n\n<p>I also know I can fix this by switching the initialization of b and the vector. My question is more why this specific example doesn't throw some sort of error, cause in my opinion it should.</p>\n\n<p>Note: like my comment:  why does this behavior fall under undefined behavior instead of reading or writing an illegal memory location since the vector doesn't exist at that point? I was kinda thinking this would/should generate a seg fault and I don't understand why it doesn't</p>\n"}, {"tags": ["c++", "set", "eigen"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544624588, "post_id": 53745093, "comment_id": 94342540, "body": "What&#39;s wrong with using a lambda expression and capture variables instead?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1544625364, "post_id": 53745093, "comment_id": 94342989, "body": "When do you want to <i>reset the precision of <code>key_comp</code></i>? After <code>_transList</code> has been constructed? That is not allowed I&#39;m afraid. Imagine you would increase <code>_prec</code>. Then, two set elements that were originally different might become equal."}, {"owner": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1544626198, "post_id": 53745093, "comment_id": 94343507, "body": "@DanielLangr How about after I clear <code>_transList</code> up; i.e. <code>_transList.clear()</code>, is it possible to reset <code>_prec</code>?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1544627330, "post_id": 53745093, "comment_id": 94344213, "body": "@rnels12 It&#39;s even not possible to use floating-point comparator based on considering close number to be equal. See, e.g, <a href=\"https://stackoverflow.com/q/6684573/580083\">stackoverflow.com/q/6684573/580083</a> for discussion."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1544627432, "post_id": 53745093, "comment_id": 94344271, "body": "IMO you need to write your own container which will be some kind of <a href=\"https://en.wikipedia.org/wiki/B-tree\" rel=\"nofollow noreferrer\">B-tree</a>."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1544783062, "post_id": 53745093, "comment_id": 94406779, "body": "Your modified comparator is wrong again. Consider <code>a=[-0.5,0,0]</code> and <code>b=[1,0,0]</code>. Then <code>a.norm()</code> is 0.5 and <code>b.norm()</code> is 1. Therefore <code>comp(a,b)</code> is <code>true</code>, but <code>comp(b,a)</code> is <code>true</code> as well, since <code>a(0)&lt;b(0)</code> is true. This break the rule that if <code>comp(a,b)==true</code> then <code>comp(b,a)==false</code>."}, {"owner": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1544791822, "post_id": 53745093, "comment_id": 94411277, "body": "@DanielLangr with your example: if <code>comp(a,b)</code> is true, why is <code>comp(b,a)</code> true as well? With my code <code>comp(b,a)</code> is indeed <code>false</code>. After checking the norm, which is passed since <code>b.norm()</code> NOT &lt; <code>a.norm()</code>, in the element-wise checking, nothing will yield <code>true</code> for <code>b(i) &lt; a(i)</code> (btw it should be <code>b(i) &lt; a(i)</code>) so it comes to the last line line which returns <code>false</code>. Did you do the analysis correctly?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1544795029, "post_id": 53745093, "comment_id": 94413012, "body": "You&#39;re right, my bad. I switched the signs. It should have been <code>a=[0.5,0,0]</code> and <code>b=[-1,0,0]</code>. <code>comp(a,b)==true</code> (the norms are the same independently of signs), but <code>comp(b,a)==true</code> as well, since <code>b(0)==-1&lt;0.5==a(0)</code>."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1544796966, "post_id": 53745093, "comment_id": 94414152, "body": "Also note that with your new comparator, any two vectors will be considered <code>equal</code> only if they have the very same norm. Therefore vectors <code>[1,0,0]</code> and <code>[1+_prec&#47;2.0,0,0]</code> will not be considered equal (at least one comparison will be true, and equal will be consequently false), even if they are &quot;closer&quot; to each other than <code>_prec</code>."}], "answers": [{"comments": [{"owner": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "edited": false, "score": 0, "creation_date": 1544629165, "post_id": 53745520, "comment_id": 94345332, "body": "I have added some codes to fulfill the condition defined in: <a href=\"http://www.cplusplus.com/reference/set/set/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/set/set</a>, namely: keys are equivalent if !comp(a,b) &amp;&amp; !comp(b,a)."}, {"owner": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "edited": false, "score": 0, "creation_date": 1544646923, "post_id": 53745520, "comment_id": 94354588, "body": "Your solution seems to work; the code compiles. Now I&#39;m gonna see if it works with my full code. I upvote your answer but will also wait a bit longer to accept this as the answer, in case some can come up with with a bit more elegant solution. Thanks anyway! :)"}], "tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": true, "score": 2, "last_activity_date": 1544628706, "last_edit_date": 1544628706, "creation_date": 1544625958, "answer_id": 53745520, "question_id": 53745093, "link": "https://stackoverflow.com/questions/53745093/custom-key-comp-with-a-class-that-takes-an-argument-for-a-c-set/53745520#53745520", "title": "Custom key_comp with a class that takes an argument for a c++ set", "body": "<p>You can't just reset the comparator, since this would (likely) also change the internal order. You can however reset the set using a new comparator (and optionally insert the current values):</p>\n\n<pre><code>void Tan::setTransList(double foo) {\n    Vector3dNormCompareClass comp(foo);\n    set&lt;Vector3d,Vector3dNormCompareClass&gt; tmp(\n        _transList.begin(), _transList.end(), // remove this line if you don't want to copy old entries\n        comp); \n    _transList.swap(tmp);    \n}\n</code></pre>\n\n<p><strong>Edit:</strong> As Daniel pointed out, your comparator does not fulfill the necessary criteria for a set (namely being transitive), i.e., you will likely get unexpected results (depending on the order you insert values).</p>\n"}, {"comments": [{"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1544628580, "post_id": 53745583, "comment_id": 94344955, "body": "That is true, although this is not the reason for the code not compiling."}, {"owner": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "reply_to_user": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1544629018, "post_id": 53745583, "comment_id": 94345234, "body": "I agree with @chtz, my main concern is about the code to compile. Also, according to this page: <a href=\"http://www.cplusplus.com/reference/set/set/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/set/set</a>, <code>a and b are equivalent if !comp(a,b) &amp;&amp; !comp(b,a)).</code> How about I first check (a&lt;b) and (b&lt;a), certainly if they are the same numbers they will fulfill this condition. (I added this in my code) So in this case the <code>prec</code> is just used to order the key. Then my question remains, how to make the code compile to allow with this flexible precision?"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "edited": false, "score": 0, "creation_date": 1544959266, "post_id": 53745583, "comment_id": 94452012, "body": "@rnels12 If you read further, you&#39;ll see that the comparison also needs to fulfill &quot;strict weak ordering&quot; -- look up what that means, if you don&#39;t want to get surprised later."}], "tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": false, "score": 1, "last_activity_date": 1544626464, "last_edit_date": 1544626464, "creation_date": 1544626130, "answer_id": 53745583, "question_id": 53745093, "link": "https://stackoverflow.com/questions/53745093/custom-key-comp-with-a-class-that-takes-an-argument-for-a-c-set/53745583#53745583", "title": "Custom key_comp with a class that takes an argument for a c++ set", "body": "<p>I believe you cannot define a comparator for associative containers this way in case of floating-point keys. The C++ Standard requires that equality derived from comparator is transitive, such as: <a href=\"http://eel.is/c++draft/alg.sorting#4.2\" rel=\"nofollow noreferrer\"><code>equiv(a, b) &amp;&amp; equiv(b, c)</code> implies <code>equiv(a, c)</code></a>, where <code>equiv(a, b)</code> is defined as <a href=\"http://eel.is/c++draft/alg.sorting#4\" rel=\"nofollow noreferrer\"><code>!comp(a, b) &amp;&amp; !comp(b, a)</code></a>.</p>\n\n<p>With floating-point keys and comparing with respect to some precision, you can get <code>equiv(a, b)</code> and <code>equiv(b, c)</code> being <code>true</code> (both differ of less than the precision) but <code>equiv(a, c)</code> being <code>false</code> (sum of the differences is higher than the precision).</p>\n\n<hr>\n\n<p><strong>Example for scalar keys</strong></p>\n\n<p>Consider <code>_prec</code> being 0.1 (it's high for exemplary purposes, you can make the same analysis for any value). Then <code>comp(a, b)</code> being defined as <code>abs(a, b) &lt; 0.1</code> will imply that <code>equiv(1.10, 1.19)</code> is <code>true</code> as well as <code>equiv(1.19, 1.28)</code>, but <code>equiv(1.10, 1.28)</code> will be <code>false</code>.</p>\n"}], "owner": {"reputation": 570, "user_id": 4647710, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/af725ad4de55f6eb0ecf2284464d3545?s=128&d=identicon&r=PG&f=1", "display_name": "rnels12", "link": "https://stackoverflow.com/users/4647710/rnels12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 53745520, "answer_count": 2, "score": 0, "last_activity_date": 1544646046, "creation_date": 1544624501, "last_edit_date": 1544646046, "question_id": 53745093, "link": "https://stackoverflow.com/questions/53745093/custom-key-comp-with-a-class-that-takes-an-argument-for-a-c-set", "title": "Custom key_comp with a class that takes an argument for a c++ set", "body": "<p>I've been trying to create a set of Vector3d<em>s</em> (from the Eigen Library). The set, furthermore, will take a key_comp from a custom class which happens to take an argument too. So the following is my code</p>\n\n<pre><code>#include &lt;set&gt;\n#include &lt;Eigen/Core&gt;\n\nusing namespace std;\nusing namespace Eigen;\n\nclass Vector3dNormCompareClass {\npublic:\n        Vector3dNormCompareClass(const double prec) {\n                _prec = prec;\n        }\n        bool operator ()(const Vector3d lhs, const Vector3d rhs) const;\nprivate:\n        double _prec;\n};\n\nbool Vector3dNormCompareClass::operator ()(const Vector3d lhs,\n                const Vector3d rhs) const {    \n        if (lhs.norm() &lt; rhs.norm())\n                return true;\n\n        for (int i = 0; i &lt; 3; ++i) {\n                if (abs(lhs(i) - rhs(i)) &gt; _prec)\n                        return lhs(i) &lt; rhs(i);\n        }\n        return false;\n}\n\nclass Tan {    \n    set&lt;Vector3d,Vector3dNormCompareClass&gt; _transList;\n    public:\n    void setTransList(double foo);    \n};\n\n\nvoid Tan::setTransList(double foo) {\n    Vector3dNormCompareClass comp(foo);\n    _transList(comp);    \n}\n</code></pre>\n\n<p>Here, <code>_transList</code> is the set I want to construct when the class <code>Tan</code> is declared and <code>Vector3dNormCompareClass</code> is the class for the <code>key_comp</code> that takes an argument for the precision of the comparison (since we're comparing the vectors of doubles). Furthermore, in my case I want to be able to reset the precision of the <code>key_comp</code>, i.e. <code>Vector3dNormCompareClass</code>, but with the current form my code, unfortunately, doesn't compile. Could anyone help me how to define the list such that it can take the custom <code>key_comp</code> with its argument (i.e. <code>double prec</code>)?</p>\n\n<p><strong>UPDATE</strong>\nBecause some of you apparently are more concerned about the mathematical validity of my <code>key_comp</code>, I have added some code in it: <code>if (lhs.norm() &lt; rhs.norm()) return true;</code> to fulfill the condition defined <a href=\"http://www.cplusplus.com/reference/set/set/\" rel=\"nofollow noreferrer\">here</a>, I quote:</p>\n\n<blockquote>\n  <p>The set object uses this expression to determine both the order the elements follow in the container and whether two element keys are equivalent (by comparing them reflexively: they are equivalent if !comp(a,b) &amp;&amp; !comp(b,a)). No two elements in a set container can be equivalent.</p>\n</blockquote>\n\n<p>So, by checking <code>(a&lt;b) &amp; (b&gt;a)</code>, I believe my <code>key_comp</code> will fulfill the condition to determine equivalent keys. That said, the <code>double prec</code> here is now used to order the keys and I want to make it \"flexible\", meaning able to reset, perhaps, every time after I clear <code>_transList</code>, i.e. <code>_transList.clear()</code>. So my problem still exists, namely the code doesn't compile with the current form and I would appreciate it if someone could help me with this concern!</p>\n"}, {"tags": ["c++", "oop", "c++11", "inheritance", "unique-ptr"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1544627027, "post_id": 53745050, "comment_id": 94344050, "body": "The compiler doesn&#39;t know that <code>product[0]</code> points to a <code>Banana</code> and not some other <code>Fruit</code>. If you are sure about that, you can tell the compiler, by way of a cast. E.g.<code>std::unique_ptr&lt;Banana&gt; b{static_cast&lt;Banana*&gt;(product[0].release())};</code>"}, {"owner": {"reputation": 517, "user_id": 7340306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd32b68e03c772583ca2fe0f524c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Gaetan", "link": "https://stackoverflow.com/users/7340306/gaetan"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1544630271, "post_id": 53745050, "comment_id": 94346094, "body": "with release() my product[0] is lost. I don&#39;t want this to happend since I plan to use it again. Is there another way?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1544642112, "post_id": 53745050, "comment_id": 94352391, "body": "It would be similarly lost with <code>std::unique_ptr&lt;Banana&gt; b = std::move(product[0]);</code>, if it were to compile, so I assumed that&#39;s what you wanted. If you didn&#39;t mean to take ownership out of the vector, make it <code>auto b = static_cast&lt;Banana*&gt;(product[0].get());</code>"}], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 7340306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd32b68e03c772583ca2fe0f524c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Gaetan", "link": "https://stackoverflow.com/users/7340306/gaetan"}, "edited": false, "score": 0, "creation_date": 1544630291, "post_id": 53745866, "comment_id": 94346104, "body": "with release() my product[0] is lost forever. I don&#39;t want this to happend since I plan to use it again. Is there another way?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 517, "user_id": 7340306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd32b68e03c772583ca2fe0f524c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Gaetan", "link": "https://stackoverflow.com/users/7340306/gaetan"}, "edited": false, "score": 1, "creation_date": 1544630842, "post_id": 53745866, "comment_id": 94346424, "body": "@Gaetan there should only ever be <b>one</b> <code>unique_ptr</code> pointing to a given object. If it&#39;s a local <code>std::unique_ptr&lt;Banana&gt; b</code> then it can&#39;t be a <code>std::unique_ptr&lt;Fruit&gt;</code> element of <code>product</code>. Maybe you only want a <code>Banana * b</code>?"}, {"owner": {"reputation": 517, "user_id": 7340306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd32b68e03c772583ca2fe0f524c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Gaetan", "link": "https://stackoverflow.com/users/7340306/gaetan"}, "edited": false, "score": 0, "creation_date": 1544632951, "post_id": 53745866, "comment_id": 94347631, "body": "oh yes, with `Banana* b&#180;  everything works fine. thanks. So unique_ptr can never be instantiate with an existing unique_ptr without setting the this existing one to nullptr, right?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 517, "user_id": 7340306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd32b68e03c772583ca2fe0f524c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Gaetan", "link": "https://stackoverflow.com/users/7340306/gaetan"}, "edited": false, "score": 0, "creation_date": 1544637738, "post_id": 53745866, "comment_id": 94350209, "body": "@Gaetan <code>unique_ptr</code> is <b>unique</b>, i.e. it cannot share ownership. That&#39;s why it&#39;s not possible to copy it for example, so yes."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1544627893, "last_edit_date": 1544627893, "creation_date": 1544627078, "answer_id": 53745866, "question_id": 53745050, "link": "https://stackoverflow.com/questions/53745050/instantiate-unique-ptr-to-derived-class-from-vector-of-base-class-where-derived/53745866#53745866", "title": "Instantiate unique_ptr to derived class from vector of base class where derived class has been stored", "body": "<p>You need to explicitly cast, since that first product can be any fruit... The compiler doesn't know whether this fruit is a Banana or a Pineapple.</p>\n\n<p>As @IgorTandetnik said, you could do:</p>\n\n<pre><code>std::unique_ptr&lt;Banana&gt; b{static_cast&lt;Banana*&gt;(product[0].release())};\n</code></pre>\n\n<p>where <a href=\"http://www.cplusplus.com/reference/memory/unique_ptr/release/\" rel=\"nofollow noreferrer\"><code>release()</code></a> is used, along with <a href=\"https://en.cppreference.com/w/cpp/language/static_cast\" rel=\"nofollow noreferrer\"><code>static_cast</code></a>.</p>\n\n<p><kbd><a href=\"https://godbolt.org/z/wa4Dqv\" rel=\"nofollow noreferrer\">Live demo</a></kbd></p>\n\n<p>Note: You can't fall back to using <code>auto</code> for b, since the compiler will choose <code>struct Fruit</code> as the type, in order to be prepared for any subclass.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1544695524, "creation_date": 1544695524, "answer_id": 53759339, "question_id": 53745050, "link": "https://stackoverflow.com/questions/53745050/instantiate-unique-ptr-to-derived-class-from-vector-of-base-class-where-derived/53759339#53759339", "title": "Instantiate unique_ptr to derived class from vector of base class where derived class has been stored", "body": "<p>You don't want ownership transfer, so cast only the pointer:</p>\n\n<pre><code>auto&amp; banana = dynamic_cast&lt;Banana&amp;&gt;(*product[0]);\nauto c = b-&gt;color;\n</code></pre>\n\n<p><code>dynamic_cast</code> might be replaced by <code>static_cast</code> if you are really sure that <code>Fruit</code>is really a <code>Banana</code>.\nIn case your are wrong, <code>static_cast</code> would lead to UB whereas you can check validity with <code>dynamic_cast</code> (exception with cast to reference or null pointer with cast to pointer).</p>\n"}], "owner": {"reputation": 517, "user_id": 7340306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd32b68e03c772583ca2fe0f524c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Gaetan", "link": "https://stackoverflow.com/users/7340306/gaetan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 53759339, "answer_count": 2, "score": 2, "last_activity_date": 1544695524, "creation_date": 1544624339, "last_edit_date": 1544627618, "question_id": 53745050, "link": "https://stackoverflow.com/questions/53745050/instantiate-unique-ptr-to-derived-class-from-vector-of-base-class-where-derived", "title": "Instantiate unique_ptr to derived class from vector of base class where derived class has been stored", "body": "<p>Consider following piece of code:</p>\n\n<pre><code>struct  Fruit\n{\n   Fruit() {}\n   virtual ~Fruit() {}       \n   std::string name;\n};\n\nstruct Banana : public Fruit\n{\n   std::string color;\n};\n\nstruct Pineapple : public Fruit\n{\n   int weight;\n};\n</code></pre>\n\n<p>here is my main() : </p>\n\n<pre><code>int main()\n{\n    std::vector&lt;std::unique_ptr&lt;Fruit&gt;&gt; product;\n    product.push_back(std::unique_ptr&lt;Banana&gt;(new Banana)); //product[0] is a Banana\n    product.emplace_back(new Pineapple);\n\n    // I need to acess the \"color\" member of product[0]\n    std::unique_ptr&lt;Banana&gt; b = std::move(product[0]); // this doesn't work, why?\n    auto c = b-&gt;color;\n}\n</code></pre>\n\n<p>in <code>product[0]</code> I store a unique_ptr to Banana, why can't I assign it to a banana unique_ptr ? </p>\n"}, {"tags": ["c++", "memory", "pool"], "comments": [{"owner": {"reputation": 364, "user_id": 2652357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/662eada2c38986bd19c258fbf358e666?s=128&d=identicon&r=PG", "display_name": "CodingFeles", "link": "https://stackoverflow.com/users/2652357/codingfeles"}, "edited": false, "score": 0, "creation_date": 1544624293, "post_id": 53745021, "comment_id": 94342355, "body": "Actually, I&#39;m not sure yet whether unique_ptr will be useful in this case."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544625472, "post_id": 53745021, "comment_id": 94343061, "body": "The issue is that the object size now varies... So I would say custom allocator, but that&#39;s a hammer... Why do you want contiguous Block and data?"}, {"owner": {"reputation": 364, "user_id": 2652357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/662eada2c38986bd19c258fbf358e666?s=128&d=identicon&r=PG", "display_name": "CodingFeles", "link": "https://stackoverflow.com/users/2652357/codingfeles"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544625904, "post_id": 53745021, "comment_id": 94343324, "body": "@MatthieuBrucher well, it&#39;s variable in general sense. But with the solution logic it&#39;s determined at the start and doesn&#39;t change. Contiguous block and data are needed for better cache locality. There are batches of such blocks which will be processed one after another."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544626063, "post_id": 53745021, "comment_id": 94343434, "body": "In that case, you don&#39;t want block to be in that memory, but only data. That&#39;s a custom allocator."}, {"owner": {"reputation": 364, "user_id": 2652357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/662eada2c38986bd19c258fbf358e666?s=128&d=identicon&r=PG", "display_name": "CodingFeles", "link": "https://stackoverflow.com/users/2652357/codingfeles"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544626509, "post_id": 53745021, "comment_id": 94343709, "body": "Why? Even though data is a main thing, block have fields which also will be used in processing."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544626569, "post_id": 53745021, "comment_id": 94343759, "body": "OK, let&#39;s assume you do want that. You need a custom allocator for both block and data."}, {"owner": {"reputation": 364, "user_id": 2652357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/662eada2c38986bd19c258fbf358e666?s=128&d=identicon&r=PG", "display_name": "CodingFeles", "link": "https://stackoverflow.com/users/2652357/codingfeles"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544627026, "post_id": 53745021, "comment_id": 94344048, "body": "Custom allocator seems the right thing. Can you make make it an answer? Maybe with a bit more details for easier research? :) Also, I&#39;d like to hear reasons why I wouldn&#39;t want block to be with data together. I think you may know something that I don&#39;t. I&#39;d be happy, if you could explain to me (in the chat, of course)."}], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 2, "last_activity_date": 1544628053, "creation_date": 1544628053, "answer_id": 53746159, "question_id": 53745021, "link": "https://stackoverflow.com/questions/53745021/preallocated-memory-pool-for-objects-with-fixed-sized-array/53746159#53746159", "title": "Preallocated memory pool for objects with fixed-sized array", "body": "<p>I think your only option is to write a custom allocator on top of your boost::pool and use it to get pointers to the memory. You can have a first start by looking at <a href=\"https://stackoverflow.com/questions/48782450/how-to-use-boostpool-library-to-create-a-custom-memory-allocator\">How to use boost::pool library to create a custom memory allocator</a> for writing such an allocator.</p>\n\n<p>Basically this custom allocator will allocate a large array of memory (at least one) and give back pointers to blocks and data with boost::pool. Modify the first answer of the previous post so that it doesn't rely on the size of T, but on a custom size passed as a paremeter. This size should be <code>sizeof(Block) + data_length</code>.</p>\n\n<p>Now, what you <strong>could</strong> do is cheat and change your class:</p>\n\n<pre><code>class Block\n{\n    uint8_t* data;\n};\n</code></pre>\n\n<p>Now when you ask for a new <code>Block</code>, you don't get just your <code>Block</code>, you also get the data block afterwards. When you construct your object (placement new), pass also the pointer to the new data (that would be the return of the <code>allocator + sizeof(Block)</code>.</p>\n\n<p>When the data is freed, don't forget to first call the destructor as this is required for placement new.</p>\n\n<p>Of course, there are still lots of small details that you will have to solve, but this should give you a start.</p>\n"}], "owner": {"reputation": 364, "user_id": 2652357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/662eada2c38986bd19c258fbf358e666?s=128&d=identicon&r=PG", "display_name": "CodingFeles", "link": "https://stackoverflow.com/users/2652357/codingfeles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 53746159, "answer_count": 1, "score": 1, "last_activity_date": 1544628053, "creation_date": 1544624235, "question_id": 53745021, "link": "https://stackoverflow.com/questions/53745021/preallocated-memory-pool-for-objects-with-fixed-sized-array", "title": "Preallocated memory pool for objects with fixed-sized array", "body": "<p>I have a type with the following structure:</p>\n\n<pre><code>class Block\n{\n   /* few fixed size fields*/\n   ...\n\n   /* fixed size byte array*/\n   std::unique_ptr&lt;std::uint8_t[]&gt; data;\n}\n</code></pre>\n\n<p>These objects are used in a work pipeline and there are gonna be a lot of such objects. Size of <code>data</code> is a runtime parameter, but it's known before work starts and it doesn't change later.</p>\n\n<p>I want to use a memory pool (boost::pool/boost::object_pool in particular) to preallocate a lot of such objects with the such layout that each <code>Block</code> object is followed by it's <code>data</code> array.</p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["c++", "installation", "wix", "certificate", "wincrypt"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10673519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90434fbdb7d8580bc9af731baa46daf?s=128&d=identicon&r=PG&f=1", "display_name": "KkVova", "link": "https://stackoverflow.com/users/10673519/kkvova"}, "is_accepted": false, "score": 0, "last_activity_date": 1544690672, "creation_date": 1544690672, "answer_id": 53757980, "question_id": 53744575, "link": "https://stackoverflow.com/questions/53744575/cryptqueryobject-systematically-falls/53757980#53757980", "title": "CryptQueryObject systematically falls", "body": "<p>I resolve it just adding the count, in bytes, of data, before call <code>CryptQueryObject</code>.</p>\n\n<pre><code>blob.cbData = cert.length();\n</code></pre>\n\n<p>Be careful with struct data.</p>\n"}], "owner": {"reputation": 23, "user_id": 10673519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90434fbdb7d8580bc9af731baa46daf?s=128&d=identicon&r=PG&f=1", "display_name": "KkVova", "link": "https://stackoverflow.com/users/10673519/kkvova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544690704, "creation_date": 1544622789, "last_edit_date": 1544690704, "question_id": 53744575, "link": "https://stackoverflow.com/questions/53744575/cryptqueryobject-systematically-falls", "title": "CryptQueryObject systematically falls", "body": "<p>I try to integrate root certificate installation within my programm installer. I have to create an object from certificate and then add it to the store.</p>\n\n<pre><code>const std::string cert = R\"cert(\n-----BEGIN CERTIFICATE-----\n/***/\n-----END CERTIFICATE-----\n)cert\";\n\nPCCERT_CONTEXT pCertCtx = NULL;\nCRYPT_INTEGER_BLOB blob;\nblob.pbData = (BYTE*)cert.c_str();\n\nbool result = CryptQueryObject(CERT_QUERY_OBJECT_BLOB, &amp;blob,\n                               CERT_QUERY_CONTENT_FLAG_CERT,         \n                               CERT_QUERY_FORMAT_FLAG_BASE64_ENCODED,\n                               0, NULL, NULL, NULL, NULL, NULL, (const void**)&amp;pCertCtx);\n            if (!result) {\n                    DWORD errorMessageID = ::GetLastError();\n\n                    LPSTR messageBuffer = nullptr;\n                    size_t size = FormatMessageA(FORMAT_MESSAGE_ALLOCATE_BUFFER |\n                                                FORMAT_MESSAGE_FROM_SYSTEM |\n                                                FORMAT_MESSAGE_IGNORE_INSERTS,\n                                                NULL, errorMessageID,\n                                                MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), \n                                                (LPSTR)&amp;messageBuffer, 0, NULL);\n\n                    std::string message(messageBuffer, size);\n                    //Free the buffer.\n                    LocalFree(messageBuffer);\n                    return ERROR_INSTALL_FAILURE;\n            }\n</code></pre>\n\n<p>I make my own dll with this custom action and add this to WiX.</p>\n\n<pre><code>    &lt;Binary Id=\"pathFixer\" SourceFile=\"$(var.product.inputFilesDir)\\path-fixer.dll\" /&gt;\n    &lt;Binary Id=\"additionalActions\" SourceFile=\"$(var.product.inputFilesDir)\\additional-actions.dll\" /&gt;\n\n    &lt;CustomAction Id=\"SetNativeMessageHostPath\" BinaryKey=\"pathFixer\" DllEntry=\"SetNativeMessageHostPath\" Execute=\"deferred\" Impersonate=\"no\"/&gt;\n    &lt;CustomAction Id=\"SetInstallDir\" Property=\"SetNativeMessageHostPath\" Value=\"[INSTALLDIR]\" Execute=\"immediate\" /&gt;\n\n    &lt;CustomAction Id=\"installRootCert\" BinaryKey=\"additionalActions\" DllEntry=\"installRootCert\" Execute=\"deferred\" Impersonate=\"no\"/&gt;\n\n    &lt;CustomAction Id=\"ResetOldVersionFound\" Property=\"OTHER_VERSION_FOUND\" Value=\"\" Execute=\"immediate\" /&gt;\n    &lt;CustomAction Id=\"GetPerUserOldVersionFound\" Property=\"USER_OTHER_VERSION_FOUND\" Value=\"[OTHER_VERSION_FOUND]\" Execute=\"immediate\" /&gt;\n    &lt;CustomAction Id=\"GetPerMachineOldVersionFound\" Property=\"MACHINE_OTHER_VERSION_FOUND\" Value=\"[OTHER_VERSION_FOUND]\" Execute=\"immediate\" /&gt;\n    &lt;CustomAction Id=\"SetPerUserOldVersionToRemove\" Property=\"OTHER_VERSION_FOUND\" Value=\"[USER_OTHER_VERSION_FOUND]\" Execute=\"immediate\" /&gt;\n    &lt;CustomAction Id=\"SetPerMachineOldVersionToRemove\" Property=\"OTHER_VERSION_FOUND\" Value=\"[MACHINE_OTHER_VERSION_FOUND]\" Execute=\"immediate\" /&gt;\n\n    &lt;InstallExecuteSequence&gt;\n        &lt;Custom Action=\"SetPerUserOldVersionToRemove\" Before=\"RemoveExistingProducts\"&gt;MSIINSTALLPERUSER=1&lt;/Custom&gt;\n        &lt;Custom Action=\"SetPerMachineOldVersionToRemove\" Before=\"RemoveExistingProducts\"&gt;MSIINSTALLPERUSER=\"\"&lt;/Custom&gt;\n        &lt;Custom Action=\"SetInstallDir\" After=\"InstallInitialize\"/&gt;\n        &lt;RemoveExistingProducts After=\"InstallInitialize\" /&gt;\n        &lt;InstallExecute After=\"RemoveExistingProducts\" /&gt;\n    &lt;/InstallExecuteSequence&gt;\n\n    &lt;Media Id=\"1\" Cabinet=\"$(var.project.name).cab\" EmbedCab=\"yes\" CompressionLevel=\"high\" /&gt;\n\n    &lt;CustomAction Id=\"SetPerUserFolder\" Directory=\"APPLICATIONFOLDER\" Value=\"[AppDataFolder]\" Execute=\"immediate\" /&gt;\n    &lt;CustomAction Id=\"SetPerMachineFolder\" Directory=\"APPLICATIONFOLDER\" Value=\"[ProgramFilesFolder]\" Execute=\"immediate\" /&gt;\n\n    &lt;InstallExecuteSequence&gt;\n        &lt;Custom Action=\"SetPerUserFolder\" After=\"CostFinalize\"&gt;NOT Installed AND MSIINSTALLPERUSER=1&lt;/Custom&gt;\n        &lt;Custom Action=\"SetPerMachineFolder\" After=\"SetPerUserFolder\"&gt;NOT Installed AND MSIINSTALLPERUSER=\"\"&lt;/Custom&gt;\n        &lt;Custom Action=\"SetNativeMessageHostPath\" After=\"PublishProduct\"&gt;NOT REMOVE&lt;/Custom&gt;\n        &lt;Custom Action=\"installRootCert\" After=\"PublishProduct\"&gt;NOT REMOVE&lt;/Custom&gt;\n    &lt;/InstallExecuteSequence&gt;\n</code></pre>\n\n<p>Debuging says directly that due installing functions is executed. But with some magic operations like join MessageBox, Debuging, i take from <code>CryptQueryObject</code> <code>true</code> and <code>false</code> periodcly, but not systematicly. <code>GetLastError</code> says <code>Parameter is incorrect</code>. Why could this happen?</p>\n"}, {"tags": ["c++", "templates", "stdtuple"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544623515, "post_id": 53744497, "comment_id": 94341918, "body": "Unrelated, but prefer using an <code>enum class</code> instead of <code>int</code> for <code>int value_type</code>."}], "answers": [{"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544625457, "post_id": 53745013, "comment_id": 94343048, "body": "Wouldn&#39;t a templated lambda with variadic template arguments be a possibility too (ignoring all ridiculousness of such a construct)?  Or would there be a conflict in having to specify the types for the specialization outside of <code>unpack_tuple::operator()</code> already?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544626954, "post_id": 53745013, "comment_id": 94344001, "body": "@MaxLanghof I&#39;m not so aggressive as to use C++17 or 20 by default quite yet.  :)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1544624217, "creation_date": 1544624217, "answer_id": 53745013, "question_id": 53744497, "link": "https://stackoverflow.com/questions/53744497/how-to-forward-the-types-of-tuple-to-specialize-other-template/53745013#53745013", "title": "how to forward the types of tuple to specialize other template?", "body": "<p>The <code>if</code> before the line in question should be a <code>constexpr if</code>.</p>\n\n<p>Unpacking of types is annoying to do without using a class helper.  I can do it with some fancy <a href=\"/questions/tagged/c%2b%2b14\" class=\"post-tag\" title=\"show questions tagged &#39;c++14&#39;\" rel=\"tag\">c++14</a> lambda action tho.</p>\n\n<pre><code>template&lt;class T&gt;\nstruct tag_t{using type=T;};\ntemplate&lt;class Tag&gt;\nusing type=typename Tag::type;\n\ntemplate&lt;class Tuple&gt;\nstruct unpack_tuple;\ntemplate&lt;class...Ts&gt;\nstruct unpack_tuple&lt;std::tuple&lt;Ts...&gt;&gt; {\n  template&lt;class F&gt;\n  decltype(auto) operator()(F&amp;&amp; f)const {\n    return std::forward&lt;F&gt;(f)( tag_t&lt;Ts&gt;{}... );\n  }\n};\n#define TYPE_FROM(...) \\\n  type&lt; std::decay_t&lt;decltype(__VA_ARGS__)&gt; &gt;\n</code></pre>\n\n<p>then we get</p>\n\n<pre><code>if constexpr(is_tuple&lt;T&gt;::value)\n{\n    return unpack_tuple&lt;T&gt;{}([&amp;](auto...tags){\n      return expect_tuple_value&lt;TYPE_FROM(tags)...&gt;();\n    });\n}\nelse\n{\n    return expect_simple_value&lt;T&gt;();\n}\n</code></pre>\n\n<p>and done.</p>\n"}, {"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544626601, "post_id": 53745702, "comment_id": 94343783, "body": "Ah, this is even better than what I was tinkering on. I agree, we don&#39;t need to tag-dispatch each individual parameter, just a monostate type that we can pass as actual argument for type deduction. This elegantly does the <code>constexpr if</code> and pack deduction at once, but it&#39;s not immediately obvious to onlookers why (or when) the variadic version wins."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544627005, "post_id": 53745702, "comment_id": 94344030, "body": "You do need such an intermediary function for every instance where you want to go back from <code>T</code> to <code>Args...</code> (somewhat obviously), so Yakk&#39;s lambda version wins a bit on reusability. If templated variadic lambdas had <a href=\"https://godbolt.org/z/b4bpdi\" rel=\"nofollow noreferrer\">better support</a> we could combine both."}, {"owner": {"reputation": 595, "user_id": 3996029, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/g0Tn7.jpg?s=128&g=1", "display_name": "spiritsaway", "link": "https://stackoverflow.com/users/3996029/spiritsaway"}, "edited": false, "score": 1, "creation_date": 1544629504, "post_id": 53745702, "comment_id": 94345550, "body": "This answer is simpler to reason than the lambda version."}], "tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": true, "score": 2, "last_activity_date": 1544626471, "creation_date": 1544626471, "answer_id": 53745702, "question_id": 53744497, "link": "https://stackoverflow.com/questions/53744497/how-to-forward-the-types-of-tuple-to-specialize-other-template/53745702#53745702", "title": "how to forward the types of tuple to specialize other template?", "body": "<p>What about using template argument deduction and overload resolution through partial ordering of function template:</p>\n\n<pre><code>class my_container\n{\n\npublic:\n    template&lt;class T&gt; optional&lt;T&gt; expect_value_simple();\n\n    template&lt;class...Args&gt; optional&lt;tuple&lt;Args...&gt;&gt; expect_value_tuple();\n\n\nprivate:\n    template&lt;class T&gt; struct deduce_type{};\n\n    template&lt;typename T&gt; \n    auto expect_value_dispatching(deduce_type&lt;T&gt;){\n       return expect_value_simple&lt;T&gt;();\n       }\n    template&lt;typename...Args&gt;\n    auto expect_value_dispatching(deduce_type&lt;tuple&lt;Args...&gt;&gt;){\n       return expect_value_tuple&lt;Args...&gt;();\n       }\npublic:     \n    template&lt;typename T&gt; \n    auto expect_value(){\n        return expect_value_dispatching(deduce_type&lt;T&gt;{});\n        }\n};\n</code></pre>\n\n<p>(<a href=\"https://godbolt.org/z/cCLLzI\" rel=\"nofollow noreferrer\">Demo</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1544627526, "post_id": 53745972, "comment_id": 94344326, "body": "First interesting template lambda use case I see!"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1544627561, "post_id": 53745972, "comment_id": 94344346, "body": "@Oliv It appears that the clang people agree with a lack of interesting use cases ;)"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1544629385, "post_id": 53745972, "comment_id": 94345476, "body": "I feel GCC has taken a big lead in the last 2 years over Clang, not only on experimental new feature implementation but also on the quality of implementation of standardized one. This attitude may play a role in that."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1544709655, "post_id": 53745972, "comment_id": 94378698, "body": "In few hours, while coding with template lambda in mind, I found interesting use cases of template lambda that improve readability: <a href=\"https://godbolt.org/z/xAJ9Up\" rel=\"nofollow noreferrer\">godbolt.org/z/xAJ9Up</a>. It avoids the distracting delctype(arg) and sometime some type manipulations."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1544627529, "last_edit_date": 1544627529, "creation_date": 1544627397, "answer_id": 53745972, "question_id": 53744497, "link": "https://stackoverflow.com/questions/53744497/how-to-forward-the-types-of-tuple-to-specialize-other-template/53745972#53745972", "title": "how to forward the types of tuple to specialize other template?", "body": "<p>The core issue here is that you need to do argument deduction at least once to go back from a type to its variadic parameters. To do that, you must pass some instance of such a variadically-templated type to a function - but it does not have to be the original one.</p>\n\n<p><strong>Yakk</strong>'s solution does this via a variadic lambda that is passed instances of tag-types (one per tuple type). The advantage here is that you can use a lambda instead of an explicit intermediary function every time.</p>\n\n<p><strong>Oliv</strong>'s solution uses a monostate type which we can instantiate and pass to a function for type deduction. It's much cleaner but requires such an intermediary function for every use case.</p>\n\n<p>Here is a (more or less theoretical) version combining both, using templated variadic lambdas (<strong>C++20</strong>, and they apparently don't even have <a href=\"https://godbolt.org/z/b4bpdi\" rel=\"nofollow noreferrer\">clang support</a> as of now):</p>\n\n<pre><code>template&lt;class... Args&gt;\nstruct MonostateTuple\n{};\n\ntemplate&lt;class... Args&gt;\nauto tupleToMonostate(std::tuple&lt;Args...&gt;)\n{\n    return MonostateTuple&lt;Args...&gt;{};\n}\n\ntemplate&lt;class T, class F&gt;\nauto unpack_tuple(F&amp;&amp; f)\n{\n    using MT = decltype(tupleToMonostate(std::declval&lt;T&gt;()));\n    return std::forward&lt;F&gt;(f)(MT{});\n}\n\n/// User code\n\ntemplate&lt;class Tuple&gt;\nauto foo()\n{\n    return unpack_tuple&lt;Tuple&gt;([&amp;] &lt;typename... Args&gt; (MonostateTuple&lt;Args...&gt;) {\n        return expect_tuple_value&lt;Args...&gt;();\n    });\n}\n</code></pre>\n\n<p>It's a bit more ugly in the lambda signature (not to mention the lack of compiler support again) but theoretically combines both advantages.</p>\n"}], "owner": {"reputation": 595, "user_id": 3996029, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/g0Tn7.jpg?s=128&g=1", "display_name": "spiritsaway", "link": "https://stackoverflow.com/users/3996029/spiritsaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 53745702, "answer_count": 3, "score": 3, "last_activity_date": 1544627529, "creation_date": 1544622509, "question_id": 53744497, "link": "https://stackoverflow.com/questions/53744497/how-to-forward-the-types-of-tuple-to-specialize-other-template", "title": "how to forward the types of tuple to specialize other template?", "body": "<p>currently I'm working on a dynamic container structure, which represents one pod value or  has vector of pointers with same container type. The container has an interface <code>optional&lt;T&gt; expect_value&lt;T&gt;()</code> \u3002 For pod types the implemention is simple. For the non pod value, I would call <code>expect_value&lt;tuple&lt;args...&gt;&gt;()</code>, the <code>args</code> would be tuple as well. But when implement this function, I come across a trouble: how to redirect <code>a.expect_value&lt;tuple&lt;args...&gt;&gt;()</code> to <code>a.expect_value_tuple&lt;args...&gt;&gt;()</code>. For example, the call to <code>a.expect_value&lt;tuple&lt;int,int&gt;()</code> would return the result of <code>a.expect_value_tuple&lt;int, int&gt;()</code>. Because the argument is empty, I cant use the type deduce of unpacked arguments. Then the whole project just cant progress any more. Any ideas? Below is the minimal example for my intention.</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;vector&gt;\n#include &lt;optional&gt;\n#include &lt;functional&gt;\n\nusing namespace std;\n\ntemplate&lt;typename T&gt;\nstruct is_tuple_impl : std::false_type {};\n\ntemplate&lt;typename... Ts&gt;\nstruct is_tuple_impl&lt;std::tuple&lt;Ts...&gt;&gt; : std::true_type {};\n\ntemplate&lt;typename T&gt;\nstruct is_tuple : is_tuple_impl&lt;std::decay_t&lt;T&gt;&gt; {};\n\nclass my_container;\n\ntemplate&lt;typename... args, size_t... arg_idx&gt;\noptional&lt;tuple&lt;args&gt;...&gt; get_tuple_value_from_vector(const vector&lt;my_container*&gt;&amp; v_list, std::index_sequence&lt;arg_idx...&gt;)\n{\n    auto temp_result = make_tuple((*v_list[arg_idx]).expect_value&lt;arg&gt;()...);\n\n    if(!(get&lt;arg_idx&gt;(temp_result) &amp;&amp;...))\n    {\n        return nullopt;\n    }\n    return make_tuple(get&lt;arg_idx&gt;(temp_result).value()...);\n\n}\n\nclass my_container\n{\npublic:\n    int value_type; // 1 for v_int 2 for v_list 0 empty\n    union\n    {\n        int v_int;\n    };\n    vector&lt;my_container*&gt; v_list;\n    template&lt;typename T&gt; \n    optional&lt;T&gt; expect_simple_value();\n    template&lt;typename... args&gt;\n    optional&lt;tuple&lt;args...&gt;&gt; expect_tuple_value();\n    template&lt;typename T&gt; \n    optional&lt;T&gt; expect_value();\n};\ntemplate &lt;typename T&gt;\noptional&lt;T&gt; my_container::expect_simple_value()\n{\n    return nullopt;\n}\n\ntemplate &lt;&gt;\noptional&lt;int&gt; my_container::expect_simple_value()\n{\n    if(value_type == 1)\n    {\n        return v_int;\n    }\n    return nullopt;\n}\n\ntemplate&lt;typename... args&gt;\noptional&lt;tuple&lt;args...&gt;&gt; my_container::expect_tuple_value()\n{\n    if(v_list.size() == 0)\n    {\n        return nullopt;\n    }\n    for(const auto i: v_list)\n    {\n        if(!i)\n        {\n            return nullopt;\n        }\n    }\n    auto the_tuple_size = sizeof...(args);\n    if(v_list.size() != the_tuple_size)\n    {\n        return nullopt;\n    }\n    return get_tuple_value_from_vector&lt;args...&gt;(v_list, index_sequence_for&lt;args...&gt;{});\n}\ntemplate &lt;typename T&gt;\noptional&lt;T&gt; my_container::expect_value()\n{\n    if(is_tuple&lt;T&gt;::value)\n    {\n        return expect_tuple_value&lt;T&gt;();\n    }\n    else\n    {\n        return expect_simple_value&lt;T&gt;();\n    }\n}\n\nint main()\n{\n    my_container test_value;\n    test_value.value_type = 1;\n    test_value.v_int = 1;\n    auto result = test_value.expect_value&lt;tuple&lt;int, int&gt;&gt;();\n    if(result)\n    {\n        return 0;\n    }\n    else\n    {\n        return 1;\n    }\n}\n</code></pre>\n\n<p>the heart of the problem is the line  <code>return expect_tuple_value&lt;T&gt;();</code> When logic goes there, the T should be  <code>tuple&lt;args...&gt;</code>, but what I want is return <code>return expect_tuple_value&lt;args...&gt;()</code>.</p>\n"}, {"tags": ["c++", "templates", "pointers", "struct"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1544622942, "post_id": 53744407, "comment_id": 94341582, "body": "You would encounter the same problem if it weren&#39;t a template."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1544622938, "post_id": 53744485, "comment_id": 94341580, "body": "Or, it could be a trailing return type: <code>LinkedList&lt;T&gt;::getNode() -&gt; Node*</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23, "user_id": 10781137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7d183e9ced97fdb420e86a735cabc67?s=128&d=identicon&r=PG&f=1", "display_name": "JDoe", "link": "https://stackoverflow.com/users/10781137/jdoe"}, "edited": false, "score": 0, "creation_date": 1544623211, "post_id": 53744485, "comment_id": 94341739, "body": "@JDoe Do you still get it if you change <code>struct Node* getNode();</code> to <code>Node* getNode();</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544623329, "post_id": 53744485, "comment_id": 94341802, "body": "@MaxLanghof Right you are.  I forgot it was dependent on <code>T</code>."}, {"owner": {"reputation": 23, "user_id": 10781137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7d183e9ced97fdb420e86a735cabc67?s=128&d=identicon&r=PG&f=1", "display_name": "JDoe", "link": "https://stackoverflow.com/users/10781137/jdoe"}, "edited": false, "score": 0, "creation_date": 1544623434, "post_id": 53744485, "comment_id": 94341858, "body": "Thanks a lot everybody ^^"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1544623493, "post_id": 53744485, "comment_id": 94341899, "body": "@eerorika Good idea.  I&#39;ve added that to the answer."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1544623464, "last_edit_date": 1544623464, "creation_date": 1544622467, "answer_id": 53744485, "question_id": 53744407, "link": "https://stackoverflow.com/questions/53744407/how-to-return-a-pointer-to-template-struct/53744485#53744485", "title": "How to return a pointer to template struct?", "body": "<p>In</p>\n\n<pre><code>template&lt;class T&gt;\nstruct Node* LinkedList&lt;T&gt;::getNode() // Error\n{\n    return head;\n}\n</code></pre>\n\n<p><code>Node</code> is scoped to <code>LinkedList&lt;T&gt;</code>.  Because you are not inside the function parameter list or the function body, the unqualified <code>Node</code>, is not available for you to use.  You have to scope the name using <code>LinkedList&lt;T&gt;::Node</code> to tell the compiler that you are using <code>LinkedList&lt;T&gt;</code>'s <code>Node</code>.  You also need to use the keyword <code>typename</code> when you do so since <code>Node</code> is a dependent name.  That means you need:</p>\n\n<pre><code>template&lt;class T&gt;\ntypename LinkedList&lt;T&gt;::Node* LinkedList&lt;T&gt;::getNode()\n{\n    return head;\n}\n</code></pre>\n\n<p>Or you could use a trailing return type and use</p>\n\n<pre><code>template&lt;class T&gt;\nauto LinkedList&lt;T&gt;::getNode() -&gt; Node*\n{\n    return head;\n}\n</code></pre>\n\n<p>to save on typing all that out.</p>\n\n<hr>\n\n<p>Also note that you do not need to use <code>struct</code> when you use the name of a <code>struct</code>.  That is/was required in C but it is not required in C++.</p>\n"}], "owner": {"reputation": 23, "user_id": 10781137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7d183e9ced97fdb420e86a735cabc67?s=128&d=identicon&r=PG&f=1", "display_name": "JDoe", "link": "https://stackoverflow.com/users/10781137/jdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 53744485, "answer_count": 1, "score": -1, "last_activity_date": 1544623464, "creation_date": 1544622232, "question_id": 53744407, "link": "https://stackoverflow.com/questions/53744407/how-to-return-a-pointer-to-template-struct", "title": "How to return a pointer to template struct?", "body": "<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\ntemplate&lt;class T&gt;\nclass LinkedList\n{\npublic:\n    struct Node {\n        T data;\n        Node* link;\n    };\n    struct Node* getNode();\n    LinkedList();\n    ~LinkedList();\nprivate:\n    Node* head;\n};\n\ntemplate&lt;class T&gt;\nstruct Node* LinkedList&lt;T&gt;::getNode() // Error\n{\n    return head;\n}\n\ntemplate&lt;class T&gt;\nLinkedList&lt;T&gt;::LinkedList()\n{\n    head = NULL;\n}\n\ntemplate&lt;class T&gt;\nLinkedList&lt;T&gt;::~LinkedList()\n{\n}\n</code></pre>\n\n<p>As you can see I want to create a LinkedList class which can take any data type. I have problems with returning pointer to template struct.</p>\n\n<p>Error message is <code>declaration is incompatible with...</code> (function declared up)</p>\n"}, {"tags": ["c++", "header", "include"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1544622957, "post_id": 53744352, "comment_id": 94341592, "body": "See also <a href=\"https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/\">here</a> for some examples of &quot;legitimate&quot; reasons to <code>#include</code> in the middle of a file."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10546991"}, "edited": false, "score": 0, "creation_date": 1544624177, "post_id": 53744462, "comment_id": 94342288, "body": "Thanks, this seems like a good solution, But you made me ask another question.  Since my functions are in class A and rely on class A&#39;s variables, i&#39;ll need to create class PurposeA, B and C as a child of class A but I won&#39;t be able to put them back into class A after that, how do I do ?  I&#39;m sorry if this sounds dumb but i&#39;m a begginer"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1544624361, "post_id": 53744462, "comment_id": 94342382, "body": "@Matt - You can also pass an <code>A&amp;</code> to the members of <code>B</code> and <code>C</code> that need to operate on A. Anyway, I&#39;d strive to make each class as independent as possible. But there is no one size fits all solution. Only you know your exact problem and possible needs."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1544622411, "creation_date": 1544622411, "answer_id": 53744462, "question_id": 53744352, "link": "https://stackoverflow.com/questions/53744352/is-it-good-practice-to-include-in-the-middle-of-a-file/53744462#53744462", "title": "Is it good practice to #include in the middle of a file?", "body": "<p>Relying on inclusion is a crutch you try to use when you failed to encapsulate those purposes. Write types for them</p>\n\n<pre><code>class PurposeA {\n  // Functions\n};\n\nclass PurposeB {\n  // Functions\n};\n\nclass PurposeC {\n  // Functions\n};\n</code></pre>\n\n<p>And then inherit privately, or compose, depending on your needs:</p>\n\n<pre><code>class Foo : private PurposeA,\n            private PurposeB,\n            private PurposeC {\n};\n\nclass Bar {\nprivate:\n  PurposeA a;\n  PurposeB b;\n  PurposeC c;\n};\n</code></pre>\n\n<p>Your function bloat is a strong hint your classes carry too much responsibility. Refactoring and encapsulation into smaller and more focused classes will serve to make the overall design better.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10546991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1544667011, "accepted_answer_id": 53744462, "answer_count": 1, "score": 0, "last_activity_date": 1544622411, "creation_date": 1544622018, "last_edit_date": 1544622389, "question_id": 53744352, "link": "https://stackoverflow.com/questions/53744352/is-it-good-practice-to-include-in-the-middle-of-a-file", "closed_reason": "Opinion-based", "title": "Is it good practice to #include in the middle of a file?", "body": "<p>In the private section of my class there are a lot of functions, let's say there are:</p>\n\n<ul>\n<li>3 functions for purpose A</li>\n<li>5 for purpose B </li>\n<li>1 for purpose C </li>\n</ul>\n\n<p>I was wondering if it was okay to make a .h file which contains all of the Purpose A functions, one for purpose B and one for C and then include each in the middle of the class definition.</p>\n\n<p>If it's considered bad practice, what is the best way to compact these functions prototypes ?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1544622253, "post_id": 53744328, "comment_id": 94341154, "body": "Could you have a default argument value for <code>T2</code>?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1544622288, "post_id": 53744328, "comment_id": 94341174, "body": "Alternatively, you could rename <code>B</code> to something else, and make <code>template &lt;typename T&gt; using B = B_improved&lt;T, whatever&gt;;</code>."}, {"owner": {"reputation": 1181, "user_id": 2492801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzzOZ.jpg?s=128&g=1", "display_name": "Benjamin Bihler", "link": "https://stackoverflow.com/users/2492801/benjamin-bihler"}, "edited": false, "score": 0, "creation_date": 1544622536, "post_id": 53744328, "comment_id": 94341346, "body": "Shouldn&#39;t you make A also a template class? Because if A stores an instance of B that means that using A is only possible if you know the second type of B."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1544622630, "post_id": 53744328, "comment_id": 94341407, "body": "@HolyBlackCat hi, can you show me some examples?  I can\u2019t imagine how a default argument helps here"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1544622791, "post_id": 53744328, "comment_id": 94341511, "body": "If you used e.g. <code>template &lt;typename T1, typename T2 = int&gt; class B;</code>, then <code>B&lt;A1&gt;</code> would no longer be a error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1544622919, "post_id": 53744328, "comment_id": 94341573, "body": "@HolyBlackCat I don\u2019t think this actually solved the problem... we will use some type more than the default eventually..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "reply_to_user": {"reputation": 1181, "user_id": 2492801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzzOZ.jpg?s=128&g=1", "display_name": "Benjamin Bihler", "link": "https://stackoverflow.com/users/2492801/benjamin-bihler"}, "edited": false, "score": 0, "creation_date": 1544690148, "post_id": 53744328, "comment_id": 94367766, "body": "@BenjaminBihler I have update my question, make class <code>A</code> a template is easy, but I don&#39;t know how to initialize a class <code>B</code>, it will cause a recursive."}, {"owner": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 1, "creation_date": 1544691049, "post_id": 53744328, "comment_id": 94368210, "body": "To me it sounds more like a design problem. I think class A should not &quot;know&quot; class B, rather it should reference some interface (abstract class) that is implemented by B and that is not generic."}, {"owner": {"reputation": 1181, "user_id": 2492801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzzOZ.jpg?s=128&g=1", "display_name": "Benjamin Bihler", "link": "https://stackoverflow.com/users/2492801/benjamin-bihler"}, "edited": false, "score": 0, "creation_date": 1544691090, "post_id": 53744328, "comment_id": 94368229, "body": "@reavenisadesk Why? Make <code>A</code> a template class, make the constructor of <code>A</code> receive a template argument of type <code>T2</code> and pass it as second argument to the constructor of <code>B</code>. Either you do not know <code>T2</code> when initializing A. Then it is anyway a wrong decision to make <code>A</code> store an instance of <code>B</code>. Or you know <code>T2</code> when initializing <code>A</code>, then my proposal seems exactly right to me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "reply_to_user": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 0, "creation_date": 1544691533, "post_id": 53744328, "comment_id": 94368491, "body": "@o_weisman Yes, what you suggest is a typical run-time polymorphism, while in this case, all the class type is fixed on compiled time, so I&#39;d like to find if there&#39;s a &quot;template&quot; way to do this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "reply_to_user": {"reputation": 1181, "user_id": 2492801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzzOZ.jpg?s=128&g=1", "display_name": "Benjamin Bihler", "link": "https://stackoverflow.com/users/2492801/benjamin-bihler"}, "edited": false, "score": 0, "creation_date": 1544691674, "post_id": 53744328, "comment_id": 94368574, "body": "@BenjaminBihler that is still a &quot;independent&quot; way, I think. If one day someone change the <code>B</code> class to 3 template parameters, all the code should be re-write."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "edited": false, "score": 0, "creation_date": 1544694296, "post_id": 53758658, "comment_id": 94369919, "body": "Thanks for sharing. So at last, which way did you choose? Give up the general design to write certain code? Or stick the general design by using pointers and run-time polymorphism?"}, {"owner": {"reputation": 1181, "user_id": 2492801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzzOZ.jpg?s=128&g=1", "display_name": "Benjamin Bihler", "link": "https://stackoverflow.com/users/2492801/benjamin-bihler"}, "edited": false, "score": 0, "creation_date": 1544694656, "post_id": 53758658, "comment_id": 94370143, "body": "I would give up the general design. If you have a compelling reason for being so general, please share it. But remember that if you try to write absolutely general software you will always end up writing an operating system."}], "tags": [], "owner": {"reputation": 1181, "user_id": 2492801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzzOZ.jpg?s=128&g=1", "display_name": "Benjamin Bihler", "link": "https://stackoverflow.com/users/2492801/benjamin-bihler"}, "is_accepted": false, "score": 0, "last_activity_date": 1544693289, "creation_date": 1544693289, "answer_id": 53758658, "question_id": 53744328, "link": "https://stackoverflow.com/questions/53744328/multiple-template-parameters-reference-loop/53758658#53758658", "title": "Multiple template parameters reference loop", "body": "<p>I would say that your answer 4 is this right one: this seems as being a flawed design. I cannot prove that but I would like to give you an example.</p>\n\n<p>I have implemented something similar to your code when I have been implementing bounding volume hierarchies. You could think of <code>B</code> as a branch class and <code>A</code> as a leave class of the tree (that is not completely correct, but should give an idea). Every branch has to contain its leaves, therefore <code>B</code> stores instances of <code>A</code>. But it is also nice to go back from a leave to its branch, therefore <code>A</code> should store a reference to <code>B</code>. You could decide to make your bounding volume hierarchy store arbitrary content (triangle, quads, polygons), therefore the item type should be a template parameter. Also you might decide to make the maximum leave number of each branch a template parameter of <code>B</code>.</p>\n\n<p>But why should the branch class be able to store leaves that are made for arbitrary branches (because the <code>B</code> type is a template parameter of <code>A</code>)? If <code>B</code> stores instances of <code>A</code>, then I cannot think of any reason for making the <code>B</code> type a template parameter of <code>A</code>.</p>\n\n<p>So probably you are too general here and should look for another design.</p>\n\n<p>I am looking forward to your comments.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "edited": false, "score": 0, "creation_date": 1544703375, "post_id": 53759168, "comment_id": 94375039, "body": "Hi, thanks for answering. What if I change the <code>int</code> to <code>A2</code>(a class which also has a reference to B, just like <code>A1</code>)? I think this solution does not completely solve the <code>T1</code> <code>T2</code> dependence problem..."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544706008, "post_id": 53759168, "comment_id": 94376476, "body": "@reavenisadesk Having a reference to B is nothing special, don&#39;t see a problem here. Do you mean B is parameterised by both A1 and A2, and both A1 and A2 are parameterised by B?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "edited": false, "score": 0, "creation_date": 1544706654, "post_id": 53759168, "comment_id": 94376869, "body": "yes exactly, I add a <code>A2</code> class in the question, the <code>A2</code> class is basically the same as <code>A1</code>,  now <code>B</code> has <code>A1</code> and <code>A2</code> as members and both <code>A1</code> and <code>A2</code> has a reference to <code>B</code>, this is the &quot;independent&quot; problem I&#39;m getting stuck with."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544709916, "post_id": 53759168, "comment_id": 94378854, "body": "This is a complex structure, I think it should be doable but is it worth the effort?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "edited": false, "score": 0, "creation_date": 1544754871, "post_id": 53759168, "comment_id": 94397291, "body": "Like @Benjamin Bihler said, my work is more like a tree and leaves syntax, except that this tree is fixed on compile time. I can give up the template and write the certain code each time, but I think it&#39;s a little annoying."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "edited": false, "score": 0, "creation_date": 1545033248, "post_id": 53759168, "comment_id": 94470025, "body": "This design is really elegant, while I changed the <code>template &lt;template&lt;class&gt; class T&gt; struct Bottom1 {};</code> to <code>template &lt;template&lt;class&gt; class T, typename E&gt; struct Bottom1 {};</code> to avoid <code>Bundle</code> class showing in the <code>Bottom</code> class, do you think this is a good idea?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1545036334, "post_id": 53759168, "comment_id": 94471388, "body": "@reavenisadesk If it works, why not. The design can be improved, it&#39;s just a starting point."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1544810153, "last_edit_date": 1544810153, "creation_date": 1544695047, "answer_id": 53759168, "question_id": 53744328, "link": "https://stackoverflow.com/questions/53744328/multiple-template-parameters-reference-loop/53759168#53759168", "title": "Multiple template parameters reference loop", "body": "<p>Here's how one might do that.</p>\n\n<pre><code>// B doesn't know about A\ntemplate &lt;class T1, class T2&gt;\nclass B {};\n\n// A doesn't know about B\ntemplate &lt;template&lt;class&gt; class TB&gt;\nclass A {\n    using MyB = TB&lt;A&lt;TB&gt;&gt;;\n};\n\ntemplate &lt;class K&gt;\n    using Bint = B&lt;K, int&gt;;\n\nint main() {\n    A&lt;Bint&gt; abint;\n}\n</code></pre>\n\n<p>Edit: If B has more than one template parameters, this can also be done, though a bit more complicated. One needs to tie all the template parameters in one class using some helpers. Here's an example. (I have renamed the classes for clarity).</p>\n\n<pre><code>// The top class parameterised by 3 bottom classes\ntemplate &lt;class A1, class A2, class A3&gt;\nstruct Top {};\n\n// Three bottom classes parameterised by the top\ntemplate &lt;template&lt;class&gt; class T&gt; struct Bottom1 {};\ntemplate &lt;template&lt;class&gt; class T&gt; struct Bottom2 {};\ntemplate &lt;template&lt;class&gt; class T&gt; struct Bottom3 {};\n\n// Until this point, none of the classes know about any other.\n// Now tie them together with these helper definitions.\n\ntemplate &lt;typename K&gt;\nusing BundledTop = Top&lt;typename K::A1, typename K::A2, typename K::A3&gt;;\n\nstruct Bundle\n{\n    using A1 = Bottom1&lt;BundledTop&gt;;\n    using A2 = Bottom2&lt;BundledTop&gt;;\n    using A3 = Bottom3&lt;BundledTop&gt;;\n};\n\nusing MyTop = BundledTop&lt;Bundle&gt;;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2269707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 53759168, "answer_count": 2, "score": 1, "last_activity_date": 1544810153, "creation_date": 1544621929, "last_edit_date": 1544757655, "question_id": 53744328, "link": "https://stackoverflow.com/questions/53744328/multiple-template-parameters-reference-loop", "title": "Multiple template parameters reference loop", "body": "<p>I got two classes, a <code>B</code> class has a member <code>A1</code>, and the <code>A1</code> class has a reference member <code>B</code>, this is easy to write like this:</p>\n\n<pre><code>class B;\n\nclass A1 {\n public:\n  A1(const B&amp; b) : b_(b) {}\n private:\n  const B&amp; b_;  // a reference to B\n};\n\nclass B {\n public:\n  B(A1 a1) : a1_(a1) {}\n private:\n  A1 a1_;  // a Type A1 member \n};\n</code></pre>\n\n<p>And then I need change class <code>B</code> to a template class, so the code should be like this:</p>\n\n<pre><code>template&lt;typename T1&gt;\nclass B;\n\n\nclass A1 {\n public:\n  A1(const B&lt;A1&gt; &amp;b) : b_(b) {};\n private:\n  const B&lt;A1&gt; &amp;b_; // a reference to B&lt;A1&gt;\n};\n\ntemplate&lt;typename T1&gt;\nclass B {\n public:\n  B(T1 t1) : t1_(t1){}\n private:\n  T1 t1_; //a T1 type member\n};\n</code></pre>\n\n<p>And suddenly we need a second member in <code>B</code>, so I changed the <code>B</code> to this:</p>\n\n<pre><code>template&lt;typename T1, typename T2&gt;\nclass B {\n public:\n  B(T1 t1, T2 t2) : t1_(t1), t2_(t2){}\n private:\n  T1 t1_;\n  T2 t2_;\n};\n</code></pre>\n\n<p>This got a problem:</p>\n\n<p>now if I'm a coder of <code>A</code>, the code below is illegal:</p>\n\n<pre><code>template&lt;typename T1, typename T2&gt;\nclass B;\n\n\nclass A1 {\n public:\n  A1(const B&lt;A1&gt; &amp;b) : b_(b) {}; //wrong, need a second template argument\n private:\n  const B&lt;A1&gt; &amp;b_; // wrong, either\n};\n</code></pre>\n\n<p>That means the coder must fill the second template argument which he may not know (or at least, may not care about). So I change the code to this:</p>\n\n<pre><code>template &lt;typename T1, typename T2&gt;\nclass B;\n\ntemplate &lt;typename TB&gt;\nclass A1 {\n public:\n  explicit A1(const TB&amp; b) : b_(b) {}\n private:\n  const TB&amp; b_;\n};\n\ntemplate &lt;typename TB&gt;\nclass A2 {\n public:\n  explicit A2(const TB&amp; b) : b_(b) {}\n private:\n  const TB&amp; b_;\n};\n\ntemplate &lt;typename T1, typename T2&gt;\nclass B {\n public:\n  B(T1 a1, T2 a2) : a1_(a1), a2_(a2) {}\n private:\n  T1 a1_;\n  T2 a2_;\n};\n</code></pre>\n\n<p>This looks nice except I don't know how to make a <code>B</code> instance(like this:<code>B&lt;A1&lt;B&lt;A1&lt;...&gt;,A2&gt;, A2&gt;</code>, it's recursively.)</p>\n\n<p>The ideal design I'm looking forward to is that programmers for <code>A1</code> and <code>A2</code> simply do not need to know each other, and the programmer for <code>B</code> is simply add <code>A1</code> and <code>A2</code> more or less like this <code>B&lt;A1, A2&gt;</code>(or add some other stuff), and even if he add a <code>T3</code> parameter like <code>B&lt;A1, A2, A3&gt;, the code of</code>A1<code>and</code>A2` will not need to be changed.</p>\n\n<p>So</p>\n\n<p>1: If I insist in this syntax, does this mean I have to give up using template for <code>B</code>, instead use pointers?  </p>\n\n<p>2: If I insist in using template, does this mean the class <code>T1</code> and class <code>T2</code> must know each other?</p>\n\n<p>3: Is there a third way by using template while <code>T1</code> and <code>T2</code> is independent? That is, no matter how many parameters I add to class <code>B</code>, the <code>A1</code> class does not need to change? Template template/CRTP/SFINAE, all of this seems not useful. As the <code>B</code> class is only a reference in class <code>A</code>, the <code>B</code> class is more like a interface rather than a certain class, this remind me of the C++ proposal \"concept\", can \"concept\" help in this case?</p>\n\n<p>4: Is this a xy problem? That means I should not design my code pattern in this way?</p>\n"}, {"tags": ["c++", "c++11", "thread-sleep", "usleep"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544621868, "post_id": 53744238, "comment_id": 94340919, "body": "See second answer at the duplicate."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1544622105, "post_id": 53744238, "comment_id": 94341066, "body": "The link is right there at the top of your question. Maybe refresh the page using F5."}, {"owner": {"reputation": 617, "user_id": 7280140, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fHhkQ.jpg?s=128&g=1", "display_name": "Ahmed Hussein", "link": "https://stackoverflow.com/users/7280140/ahmed-hussein"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544622997, "post_id": 53744238, "comment_id": 94341625, "body": "OK, I edited the question, could you please check again to see whether it is still duplicate? Thanks for the notice :)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544623247, "post_id": 53744238, "comment_id": 94341759, "body": "I don&#39;t see why I should reopen the question. The behavior of <code>usleep()</code> is well documented, that there&#39;s no exact time measurement guaranteed. Also it&#39;s a well known fact that any <i>realtime</i> computing depends on the operating system&#39;s time resolution. You might want to have a look at <code>std::crono</code> and the usagee of realtime clock devices."}, {"owner": {"reputation": 617, "user_id": 7280140, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fHhkQ.jpg?s=128&g=1", "display_name": "Ahmed Hussein", "link": "https://stackoverflow.com/users/7280140/ahmed-hussein"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544623374, "post_id": 53744238, "comment_id": 94341829, "body": "I found a way to solve my problem, and I would like to share it with people in an answer. I found a more accurate way. Could you please reopen it?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544623487, "post_id": 53744238, "comment_id": 94341891, "body": "<i>&quot;Could you please reopen it?&quot;</i> I&#39;ll leave that for other&#39;s to do. ATM the duplicate and the existing answer, perfectly answer your question."}, {"owner": {"reputation": 617, "user_id": 7280140, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fHhkQ.jpg?s=128&g=1", "display_name": "Ahmed Hussein", "link": "https://stackoverflow.com/users/7280140/ahmed-hussein"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544623673, "post_id": 53744238, "comment_id": 94342004, "body": "The answer you provided explains the reason behind the inaccuracy, but doesn&#39;t say how to overcome it"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1544623909, "post_id": 53744238, "comment_id": 94342129, "body": "That might be worth another and clearer asked question."}], "answers": [{"comments": [{"owner": {"reputation": 617, "user_id": 7280140, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fHhkQ.jpg?s=128&g=1", "display_name": "Ahmed Hussein", "link": "https://stackoverflow.com/users/7280140/ahmed-hussein"}, "edited": false, "score": 0, "creation_date": 1544621935, "post_id": 53744280, "comment_id": 94340954, "body": "So, how can I implement method #2 with a more accurate function?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 617, "user_id": 7280140, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fHhkQ.jpg?s=128&g=1", "display_name": "Ahmed Hussein", "link": "https://stackoverflow.com/users/7280140/ahmed-hussein"}, "edited": false, "score": 2, "creation_date": 1544622382, "post_id": 53744280, "comment_id": 94341249, "body": "The function is always inaccurate, so if you call it multiple times in a row, those inaccuracies add up. Why do you need the method #2 over the first one? It sounds like there might be a better solution to your problem."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 3, "last_activity_date": 1544621764, "creation_date": 1544621764, "answer_id": 53744280, "question_id": 53744238, "link": "https://stackoverflow.com/questions/53744238/usleep-inside-loop-takes-too-long/53744280#53744280", "title": "usleep inside loop takes too long", "body": "<p>From <a href=\"http://man7.org/linux/man-pages/man3/usleep.3.html\" rel=\"nofollow noreferrer\">the documentation</a> (emphasis mine)</p>\n\n<blockquote>\n  <p>The usleep() function suspends execution of the calling thread for\n         <strong>(at least)</strong> usec microseconds.  The sleep may be lengthened slightly\n         by any system activity or by the time spent processing the call or by\n         the granularity of system timers.</p>\n</blockquote>\n\n<p>So in other words, the reason why it takes longer is because it's now \"going to sleep\" and \"waking up\" 1500000 times instead of just once, and with such a short sleep duration, that overhead may be much bigger than the actual microsecond sleep.</p>\n"}], "owner": {"reputation": 617, "user_id": 7280140, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fHhkQ.jpg?s=128&g=1", "display_name": "Ahmed Hussein", "link": "https://stackoverflow.com/users/7280140/ahmed-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "closed_date": 1544621841, "answer_count": 1, "score": 3, "last_activity_date": 1544622927, "creation_date": 1544621624, "last_edit_date": 1544622927, "question_id": 53744238, "link": "https://stackoverflow.com/questions/53744238/usleep-inside-loop-takes-too-long", "closed_reason": "Duplicate", "title": "usleep inside loop takes too long", "body": "<p>In the below C++ program, I am using the function <code>usleep()</code> to sleep for a 1.5 seconds. I implemented that in 2 equivalent methods as illustrated below:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n\nusing namespace std;\n\nint main() {\n    //METHOD #1\n    cout&lt;&lt;\"sleep\"&lt;&lt;endl;\n    usleep(1500000);\n    cout&lt;&lt;\"wake up\"&lt;&lt;endl;\n\n    //METHOD #2\n    cout&lt;&lt;\"sleep\"&lt;&lt;endl;\n    for(int i=0; i&lt;1500000; i++)\n        usleep(1);\n    cout&lt;&lt;\"wake up\"&lt;&lt;endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>however the results came as follows:  </p>\n\n<ul>\n<li><strong>First method:</strong> takes exactly 1.5 seconds</li>\n<li><strong>Second method:</strong> takes around 1.5 minutes !</li>\n</ul>\n\n<p>Actually, I will need the second method. According to this <a href=\"https://stackoverflow.com/a/14853240/7280140\">Answer</a>, I think I need a more accurate function that <code>usleep()</code>. Could any one help ?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1544621554, "post_id": 53744128, "comment_id": 94340741, "body": "I would say it&#39;s to make sure stuff in the <code>std</code> namespace can reference them without worrying too much about it getting resolved to some practical joke that someone declared in the global namespace."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1544621592, "post_id": 53744128, "comment_id": 94340762, "body": "Fairly similar: <a href=\"https://stackoverflow.com/questions/32606023/when-using-c-headers-in-c-should-we-use-functions-from-std-or-the-global-na\" title=\"when using c headers in c should we use functions from std or the global na\">stackoverflow.com/questions/32606023/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544622612, "post_id": 53744400, "comment_id": 94341401, "body": "The link you&#39;ve provided says about the <b>order</b> of declaration - first in global namespace then in <code>std::</code> or vice-versa, not of existing only one of these. If I read it correctly. Futhermore I think the cite from my question should override type existance if your answer is right."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544623032, "post_id": 53744400, "comment_id": 94341651, "body": "@&#228;l\u0451x&#246;l&#252;t I&#39;ve updated the answer to elaborate more."}, {"owner": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544624306, "post_id": 53744400, "comment_id": 94342360, "body": "Thank you for clarification. In my expectation phrase <i>&quot;The header defines all types and macros the same as the C standard library header &lt;stdint.h&gt;.&quot;</i> doesn&#39;t say that all names will be in <code>std::</code> only. I think <i>&quot;defines all types&quot;</i> means that all types will ne visible in global namespace too, same as I <code>#include &lt;stdint.h&gt;</code>. Am I wrong?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544624642, "post_id": 53744400, "comment_id": 94342572, "body": "@&#228;l\u0451x&#246;l&#252;t You are incorrect.  Your quote says they are defined, and they are, but mine says they are scoped to the std namespace."}, {"owner": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544624761, "post_id": 53744400, "comment_id": 94342631, "body": "Do you know any compiler which use the latter <code>&lt;cstdint&gt;</code> implementation from your answer?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544624841, "post_id": 53744400, "comment_id": 94342678, "body": "@&#228;l\u0451x&#246;l&#252;t <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/c_global/cstdint\" rel=\"nofollow noreferrer\">GCC does</a>.  Do note though that it could change at any time."}, {"owner": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544624926, "post_id": 53744400, "comment_id": 94342721, "body": "Oops ... sorry, I meant the first one, when only <code>std::</code> type are declared."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544625040, "post_id": 53744400, "comment_id": 94342796, "body": "@&#228;l\u0451x&#246;l&#252;t I do not.  IIRC the big 3 all use the latter version."}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "reply_to_user": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "edited": false, "score": 0, "creation_date": 1544625723, "post_id": 53744400, "comment_id": 94343209, "body": "@&#228;l\u0451x&#246;l&#252;t As far as I recall the C++03 standard required std::-only for the imported C-library but since the major players ignored this they changed the standard for C++11. The only compiler I know that implemented this requirement was the IAR C++ compiler but they switched  when moving to C++14."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 6, "last_activity_date": 1544624771, "last_edit_date": 1544624771, "creation_date": 1544622209, "answer_id": 53744400, "question_id": 53744128, "link": "https://stackoverflow.com/questions/53744128/c-std-types-instead-of-corresponding-c-types/53744400#53744400", "title": "c++ std:: types instead of corresponding c types", "body": "<blockquote>\n  <p>So is there a need to use say std::int8_t instead of the short C form int8_t somewhere?</p>\n</blockquote>\n\n<p>Yes.  Per <a href=\"https://timsong-cpp.github.io/cppwp/headers#4\" rel=\"nofollow noreferrer\">[headers]/4</a> it is unspecified if the C names are defined in the global namespace or not.  Because of this you need <code>std::int8_t</code> to use <code>int8_t</code>.  It doesn't guarantee that <code>std::int8_t</code> exists, just that if it does exist, using <code>std::int8_t</code> is guaranteed to work.</p>\n\n<p>You can just add <code>using std::int8_t;</code> so you don't have to type <code>std::int8_t</code> all over the place.</p>\n\n<hr>\n\n<p>The relevant part of [headers]/4 is </p>\n\n<blockquote>\n  <p>In the C++ standard library, however, <strong>the declarations</strong> (except for names which are defined as macros in C) <strong>are within namespace scope of the namespace std</strong></p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<p>This means we know they are declared in <code>std::</code>.  The part </p>\n\n<blockquote>\n  <p>It is unspecified whether these names (including any overloads added in [language.support] through [thread] and [depr]) are first declared within the global namespace scope and are then injected into namespace std by explicit using-declarations ([namespace.udecl]). </p>\n</blockquote>\n\n<p>then allows the names to be in the global namespace, but does required it. This lets implementations do things like</p>\n\n<p><code>&lt;cstdint&gt;</code>:</p>\n\n<pre><code>namespace std\n{\n    #include &lt;stdint.h&gt;\n}\n</code></pre>\n\n<p>or </p>\n\n<p><code>&lt;cstdint&gt;</code>:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\nnamespace std\n{\n    using ::int8_t;\n    using ::int16_t;\n    //...\n}\n</code></pre>\n\n<p>Bot accomplish the same thing (putting the names in <code>std::</code>) and are legal implementations but only the second one puts the names in the global scope.</p>\n"}], "owner": {"reputation": 4338, "user_id": 3240681, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1", "display_name": "\u03b1\u03bb\u03b5\u03c7\u03bf\u03bb\u03c5\u03c4", "link": "https://stackoverflow.com/users/3240681/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "accepted_answer_id": 53744400, "answer_count": 1, "score": 5, "last_activity_date": 1544624771, "creation_date": 1544621280, "question_id": 53744128, "link": "https://stackoverflow.com/questions/53744128/c-std-types-instead-of-corresponding-c-types", "title": "c++ std:: types instead of corresponding c types", "body": "<p>For instance, consider the <code>&lt;cstdint&gt;</code> header. C++ standard <a href=\"http://eel.is/c++draft/cstdint#syn-2\" rel=\"noreferrer\">says</a>:</p>\n\n<blockquote>\n  <p>The header defines all types and macros the same as the C standard library header <code>&lt;stdint.h&gt;</code>.</p>\n</blockquote>\n\n<p>So is there a need to use say <code>std::int8_t</code> instead of the short C form <code>int8_t</code> somewhere?</p>\n"}, {"tags": ["c++", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 5, "creation_date": 1544621337, "post_id": 53744088, "comment_id": 94340612, "body": "It&#39;s going to take a long time for your computer to count down from that number, one by one. Even on modern CPUs. Because that&#39;s what you told your computer to do, decrement it, one by one. You must realize that this is going to take a while, so maybe you should&#39;ve tried running this on a quantum computer?"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1544621344, "post_id": 53744088, "comment_id": 94340620, "body": "You are counting down from 832564823476. Yikes. Debugging Pro Tip: try a smaller number to see if the algo works."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1544621434, "post_id": 53744088, "comment_id": 94340672, "body": "Even if that whole loop would only take a single cycle, it would take a 2.4 GHz machine almost 6 minutes to execute this."}, {"owner": {"reputation": 35, "user_id": 9851475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a4ffcb448a7a4d0ba33f825d58df69?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Ray", "link": "https://stackoverflow.com/users/9851475/aniket-ray"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1544621665, "post_id": 53744088, "comment_id": 94340811, "body": "@nicomp Yup, this works for a smaller number."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1544622582, "post_id": 53744088, "comment_id": 94341386, "body": "If you look at the last digit of enough Fibonacci numbers, you will discover that there&#39;s a cycle. (If you think about it, you might realise that there must be one.) It&#39;s also not a very long cycle."}], "answers": [{"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1544622452, "creation_date": 1544622452, "answer_id": 53744479, "question_id": 53744088, "link": "https://stackoverflow.com/questions/53744088/why-is-the-output-of-the-cpp-code-failing-for-832564823476-as-input/53744479#53744479", "title": "Why is the output of the CPP code failing for &quot;832564823476&quot; as input?", "body": "<p>The sum of the first <code>n</code> Fibonacci numbers <code>F(n)</code> is <code>F(n+2)-1</code> (<a href=\"https://en.wikipedia.org/wiki/Fibonacci_number#Combinatorial_identities\" rel=\"nofollow noreferrer\">source</a>). You are interested in the last digit of this number.</p>\n\n<p>Now consider that the last digit of <code>F(n)</code> only depends on the last digits of <code>F(n-1)</code> and <code>F(n-2)</code>. There are at most 100 possible such pairs, so the series of last digits has to repeat eventually. Indeed, <code>lastDigitOf(F(n)) = lastDigitOf(F(n+60))</code> (see e.g. <a href=\"https://math.stackexchange.com/questions/113536/fibonaccis-final-digits-cycle-every-60-numbers\">here</a>), so you should be able to find an algorithm that is <em>much</em> faster than what you have right now. Then you won't have your console \"freezing\" (i.e. waiting for your algorithm to complete) any longer.</p>\n"}], "owner": {"reputation": 35, "user_id": 9851475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a4ffcb448a7a4d0ba33f825d58df69?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Ray", "link": "https://stackoverflow.com/users/9851475/aniket-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1544622452, "creation_date": 1544621164, "question_id": 53744088, "link": "https://stackoverflow.com/questions/53744088/why-is-the-output-of-the-cpp-code-failing-for-832564823476-as-input", "title": "Why is the output of the CPP code failing for &quot;832564823476&quot; as input?", "body": "<p>I am currently enrolled for the Data Structures and Algorithm Specialization on Coursera. I came across a problem as my assignment. The problem tells to find the last (unit) digit of the sum of n-terms of a fibonacci sequence. </p>\n\n<p>For ex: \nInput : 3  <br>\nOutput : 4 <br>\nF0 + F1 + F2 + F3 = 0 + 1 + 1 + 2 = 4</p>\n\n<p>The soltuion for this I provided was :</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint lastDigit=0;\nint fibLastDigit(unsigned long long);\n\nint main() {\n    unsigned long long terms;\n    cin&gt;&gt;terms;         //0&lt;=n&lt;=10^18\n    cout&lt;&lt;fibLastDigit(terms);\n    return 0;\n}\n\nint fibLastDigit(unsigned long long nTh) { \n    int first=0, second=1, third;\n    if(nTh == 0) {\n        lastDigit = first;\n        return lastDigit;\n    }\n    else if(nTh == 1) {\n        lastDigit = second;\n        return lastDigit;\n    }\n    else if(nTh &gt; 1) { \n        lastDigit = 1;\n        while(nTh&gt;=2) {\n            first = first % 10;\n            second = second % 10;\n            third = ((first + second)%10);\n            first = second;\n            second = third;\n            lastDigit = (lastDigit + third) % 10;\n            nTh--;\n\n        }\n\n    }\n    return lastDigit;\n}\n</code></pre>\n\n<p>But the code fails for 832564823476. The console freezes and doesn't provide any output.</p>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "decltype"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1544620610, "post_id": 53743882, "comment_id": 94340210, "body": "the compiler cannot deduce the type of something before it even knows it exists"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1544620625, "post_id": 53743882, "comment_id": 94340218, "body": "Two different things. Declaration and definition. Class methods are not defined until the class declaration is complete. While declaring class methods and members (their types and their return types), the usual rules apply. Can&#39;t reference something that has not been declared yet."}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1544620659, "post_id": 53743882, "comment_id": 94340235, "body": "But in first snippet, it does know about a, doesn&#39;t it ?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620700, "post_id": 53743882, "comment_id": 94340256, "body": "It &quot;knows about a&quot; because the body of the function is logically not defined until the entire class is declared. It&#39;s as if the compiler does not process the body of the class method until the closing brace is seen, first."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1544620857, "post_id": 53743882, "comment_id": 94340342, "body": "Note a similar thing does compile: <code>struct A { size_t get() { return sizeof(a); } int a; };</code>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1544621079, "post_id": 53743882, "comment_id": 94340465, "body": "This seems unrelated as <code>a</code> is not used in the declaration of  <code>get</code> here. @Bathsheba"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1544621111, "post_id": 53743882, "comment_id": 94340485, "body": "@BaummitAugen: Yes, that seems to be the explanation."}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1544629008, "post_id": 53743882, "comment_id": 94345226, "body": "It was indeed a dupe, <a href=\"https://stackoverflow.com/a/16666387/193789\">stackoverflow.com/a/16666387/193789</a> has the correct answer (Paragraph 3.4.1/7)"}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1544629197, "post_id": 53743882, "comment_id": 94345355, "body": "Thanks to all for your (correct) answers, I could accept all, but @Nelfeal has the lowest rep, so I&#39;ll accept his ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1544621022, "post_id": 53743951, "comment_id": 94340435, "body": "@Bathsheba Why wouldn&#39;t it? The declaration <code>size_t get()</code> does not include anything about <code>a</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1544621431, "post_id": 53743951, "comment_id": 94340670, "body": "You&#39;re correct. Have an upvote since I trolled your answer. I&#39;ve also answered informally too."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544691547, "post_id": 53743951, "comment_id": 94368505, "body": "i am not really the one to ask when it is about correct formal terms, but I wonder if &quot;(because A is fully defined)&quot; is really correct. Isnt the definition of its members part of <code>A</code>s definition? Did you mean to write &quot;because A is fully declared&quot; ?"}, {"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544702884, "post_id": 53743951, "comment_id": 94374791, "body": "@user463035818 True, although I don&#39;t think I&#39;ve ever encountered a formal definition of &quot;class definition&quot;. I have no idea if the standard defines that, or differentiates between class declaration and class definition. But I guess you could say the class definition includes the definition of its members."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544703518, "post_id": 53743951, "comment_id": 94375114, "body": "well, sorry, on a second thought, my &quot;correction&quot; made it worse. <code>struct A;</code> is already a declaration (but no definition), not sure what is the correct wording for &quot;fully declared&quot;"}, {"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1544708592, "post_id": 53743951, "comment_id": 94378038, "body": "@user463035818 Not sure. <code>struct A;</code> is a <a href=\"https://en.cppreference.com/w/cpp/language/class\" rel=\"nofollow noreferrer\">forward declaration</a> (without curly braces). So I guess we could call the next thing a full declaration, and then, when every member is defined, a definition."}], "tags": [], "owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "is_accepted": true, "score": 5, "last_activity_date": 1544702706, "last_edit_date": 1544702706, "creation_date": 1544620768, "answer_id": 53743951, "question_id": 53743882, "link": "https://stackoverflow.com/questions/53743882/why-doesnt-the-compiler-infer-the-type-of-member-when-using-decltype/53743951#53743951", "title": "Why doesn&#39;t the compiler infer the type of member when using decltype?", "body": "<p>In your first example, <code>A::get</code> is declared, then <code>A::a</code> is declared, and only then (because <code>A</code> is fully declared), <code>A::get</code> is defined. At this point, in <code>A::get</code>, the compiler knows about <code>A::a</code>.</p>\n\n<p>Consider this equivalent form:</p>\n\n<pre><code>struct A\n{\n    int get();\n    int a=1;\n};\n\ninline int A::get()\n{\n    return a;\n}\n</code></pre>\n\n<p>This would not be compilable for you second example:</p>\n\n<pre><code>struct A\n{\n    auto get() -&gt; decltype(a); // What is \"a\"?\n    int a=1;\n};\n\ninline auto A::get() -&gt; decltype(A::a)\n{\n    return a;\n}\n</code></pre>\n\n<p>The same \"order of declaration\" has to be respected when you declare types, for example:</p>\n\n<pre><code>struct A\n{\n    using IntType = int;\n    auto get() -&gt; IntType;\n    int a=1;\n};\n</code></pre>\n\n<p>You couldn't write like so:</p>\n\n<pre><code>struct A\n{\n    using IntType = decltype(a);\n    auto get() -&gt; IntType;\n    int a=1;\n};\n</code></pre>\n\n<p>Also note that this is not limited to return types: parameter types are also part of a function declaration. So this doesn't compile either:</p>\n\n<pre><code>struct A\n{\n    void f(decltype(a));\n    int a=1;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1544621511, "post_id": 53744014, "comment_id": 94340711, "body": "Mmmh, I get the idea, but not sure it applies here: when defining a(), looking for b&#39;s type would indeed fail. On the opposite, in my example, the type of the data member is clearly known."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 1, "creation_date": 1544622959, "post_id": 53744014, "comment_id": 94341593, "body": "@kebs and thats were &quot;super complicated rules&quot; would be required. The current easy rule is &quot;members are declared in the order they appear in the code&quot;. Compare this to &quot;members are declared in any order, but if the declaration of one member depends on a second one they need to be declared in order [... ~500 special cases, notes and quirks due to interference with other rules ... ]&quot; ;)"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 4, "last_activity_date": 1544620948, "creation_date": 1544620948, "answer_id": 53744014, "question_id": 53743882, "link": "https://stackoverflow.com/questions/53743882/why-doesnt-the-compiler-infer-the-type-of-member-when-using-decltype/53744014#53744014", "title": "Why doesn&#39;t the compiler infer the type of member when using decltype?", "body": "<p>Let me give some handwavy explanation why what you would like to write cannot work in general:</p>\n\n<pre><code>struct A {\n    auto get() -&gt; decltype(a)\n    {\n        return a;\n    } \n    int a=1;\n};\n</code></pre>\n\n<p>If this was allowed then either super complicated rules would be required or also the following would be allowed, while it actually does not make sense:</p>\n\n<pre><code>struct cyclic {\n    auto a() -&gt; decltype(b) {\n        return ...;\n    }\n    auto b() -&gt; decltype(a) { \n        return ...;\n    }\n};\n</code></pre>\n\n<p>I hope another answer will tell you the exact rules of the language that prevent to write something like that. I tried to give a motivation why it is actually better that we cannot write it. </p>\n"}, {"comments": [{"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 3, "creation_date": 1544621644, "post_id": 53744164, "comment_id": 94340794, "body": "For those who (like me) never heard that: <a href=\"https://en.wikipedia.org/wiki/Red_herring\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Red_herring</a> ;-)"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1544621845, "last_edit_date": 1544621845, "creation_date": 1544621401, "answer_id": 53744164, "question_id": 53743882, "link": "https://stackoverflow.com/questions/53743882/why-doesnt-the-compiler-infer-the-type-of-member-when-using-decltype/53744164#53744164", "title": "Why doesn&#39;t the compiler infer the type of member when using decltype?", "body": "<p>An informal answer if I may: <code>decltype</code> is a red herring.</p>\n\n<p>All parts of a <code>return</code> type need to have already been seen by the compiler on the first pass.</p>\n\n<p>For example,</p>\n\n<pre><code>template &lt;size_t N&gt; struct T{};\n\nstruct A\n{\n    T&lt;sizeof(a)&gt; get()\n    {\n        return T&lt;sizeof(a)&gt;();\n    }\n    int a;\n};\n</code></pre>\n\n<p>will also fail, for the same reason: compilation passes if <code>int a;</code> is seen before <code>get()</code>.</p>\n"}], "owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "closed_date": 1544623994, "accepted_answer_id": 53743951, "answer_count": 3, "score": 12, "last_activity_date": 1544702706, "creation_date": 1544620514, "last_edit_date": 1544620702, "question_id": 53743882, "link": "https://stackoverflow.com/questions/53743882/why-doesnt-the-compiler-infer-the-type-of-member-when-using-decltype", "closed_reason": "Duplicate", "title": "Why doesn&#39;t the compiler infer the type of member when using decltype?", "body": "<p>I just noticed this behavior in own code, so here is the naive question:</p>\n\n<p>This:</p>\n\n<pre><code>struct A\n{\n    int get()\n    {\n        return a;\n    }\n    int a=1;\n};   \nint main() {}\n</code></pre>\n\n<p>Compiles of course fine, although when the declaration of member data lies <strong>after</strong> the function definition.</p>\n\n<p>But then I don't understand why this:</p>\n\n<pre><code>struct A\n{\n    auto get() -&gt; decltype(a)\n    {\n        return a;\n    }\n    int a=1;\n};  \n</code></pre>\n\n<p>does not compile(*). I have to write this:</p>\n\n<pre><code>struct A\n{\n    int a=1;\n    auto get() -&gt; decltype(a)\n    {\n        return a;\n    }\n};  \n</code></pre>\n\n<p>Is there any language-related reasons why it's not ok, or is it just that the compilers have not implemented that ? I would expect to have the same behavior regardless of the order of the class members.</p>\n\n<p>(*) tested with gcc 6.3 through Ideone.com</p>\n"}, {"tags": ["c++", "c++11", "copy-constructor"], "answers": [{"comments": [{"owner": {"reputation": 5795, "user_id": 3253896, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa6d2f73d0c32ee94e11661d94857fc8?s=128&d=identicon&r=PG", "display_name": "\u0428\u0430\u0445", "link": "https://stackoverflow.com/users/3253896/%d0%a8%d0%b0%d1%85"}, "edited": false, "score": 0, "creation_date": 1544619424, "post_id": 53743528, "comment_id": 94339597, "body": "Thank you for explanation!"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1544620235, "post_id": 53743528, "comment_id": 94340041, "body": "Well, if you want to test whether or not there&#39;s a copy constructor, create the object, and the create a 2nd object as a copy of the first one. Seems logical to me."}, {"owner": {"reputation": 6891, "user_id": 2204581, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1e49d077f4d914cfc9d81299a453fcd2?s=128&d=identicon&r=PG", "display_name": "mrks", "link": "https://stackoverflow.com/users/2204581/mrks"}, "edited": false, "score": 1, "creation_date": 1544621185, "post_id": 53743528, "comment_id": 94340527, "body": "See an example above on how to test it"}], "tags": [], "owner": {"reputation": 6891, "user_id": 2204581, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1e49d077f4d914cfc9d81299a453fcd2?s=128&d=identicon&r=PG", "display_name": "mrks", "link": "https://stackoverflow.com/users/2204581/mrks"}, "is_accepted": true, "score": 4, "last_activity_date": 1544621163, "last_edit_date": 1544621163, "creation_date": 1544619349, "answer_id": 53743528, "question_id": 53743508, "link": "https://stackoverflow.com/questions/53743508/does-a-deleted-constructor-in-base-class-influences-on-child-class/53743528#53743528", "title": "Does a deleted constructor in base class influences on child class?", "body": "<p>No, as the default copy constructor would call the parent's copy constructor (which is deleted), this won't work.</p>\n\n<p>Why didn't you simply test it:</p>\n\n<pre><code>int main() {\n    auto x = fact_t&lt;int&gt;(5);\n    auto y = x;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>copytest.cpp: In function 'int main()':\ncopytest.cpp:32:14: error: use of deleted function 'fact_t&lt;int&gt;::fact_t(const fact_t&lt;int&gt;&amp;)'\n     auto y = x;\n              ^\ncopytest.cpp:21:7: note: 'fact_t&lt;int&gt;::fact_t(const fact_t&lt;int&gt;&amp;)' is implicitly declared as deleted because 'fact_t&lt;int&gt;' declares a move constructor or move assignment operator\n class fact_t: public exp_t&lt;val_t&gt; {\n       ^~~~~~\n</code></pre>\n"}], "owner": {"reputation": 5795, "user_id": 3253896, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa6d2f73d0c32ee94e11661d94857fc8?s=128&d=identicon&r=PG", "display_name": "\u0428\u0430\u0445", "link": "https://stackoverflow.com/users/3253896/%d0%a8%d0%b0%d1%85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 1, "accepted_answer_id": 53743528, "answer_count": 1, "score": 3, "last_activity_date": 1544621163, "creation_date": 1544619278, "last_edit_date": 1544619354, "question_id": 53743508, "link": "https://stackoverflow.com/questions/53743508/does-a-deleted-constructor-in-base-class-influences-on-child-class", "title": "Does a deleted constructor in base class influences on child class?", "body": "<p>I deleted a copy constructor in base class but I can't get if the compiler will create an implicit copy constructor in child classes? Or does a deleted constructor in the base class prevent it?</p>\n\n<pre><code>template &lt;typename val_t&gt;\nclass exp_t {\npublic:\n    using vals_t = std::vector&lt;val_t&gt;;\n\n    exp_t() {}\n    exp_t(const exp_t&lt;val_t&gt; &amp;) = delete;\n    exp_t(exp_t &amp;&amp;) = default;\n    virtual ~exp_t() {}\n\n    exp_t&lt;val_t&gt; &amp;operator=(const exp_t&lt;val_t&gt; &amp;) = delete;\n    exp_t&lt;val_t&gt; &amp;operator=(exp_t&lt;val_t&gt; &amp;) = delete;\n    exp_t&lt;val_t&gt; &amp;operator=(exp_t &amp;&amp;) = default;\n};\n\n\ntemplate &lt;typename val_t&gt;\nclass fact_t: public exp_t&lt;val_t&gt; {\n    using vals_t = std::vector&lt;val_t&gt;;\n\n    val_t m_value;\npublic:\n    fact_t(val_t &amp;&amp;value) : m_value{std::forward&lt;val_t&gt;(value)} {}\n    fact_t(fact_t &amp;&amp;) = default;\n};\n</code></pre>\n\n<p><strong>Will <code>fact_t</code> have an implicit copy constructor?</strong> (GCC 7)</p>\n"}, {"tags": ["c++", "c", "unix", "operating-system"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1544619503, "post_id": 53743485, "comment_id": 94339633, "body": "How is this to work if <code>std::string</code> allocates the string data from the heap at runtime?  The <code>sizeof(shared)</code> remains constant, since <code>sizeof</code> is a compile-time value."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1544619516, "post_id": 53743485, "comment_id": 94339641, "body": "You cannot put an <code>std::string</code> into a shared memory, only POD-types."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1544619568, "post_id": 53743485, "comment_id": 94339667, "body": "Why do you think a C++ <code>std::string</code> object will restrict itself to a specific location?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1544619872, "post_id": 53743485, "comment_id": 94339856, "body": "<a href=\"http://coliru.stacked-crooked.com/a/ed18bb267ab09e7b\" rel=\"nofollow noreferrer\">This illustrates why this code will not work</a>.  The <code>sizeof(shared)</code> remains at 200, regardless of the number of characters placed in one element of the string array."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "edited": false, "score": 0, "creation_date": 1544620312, "post_id": 53743485, "comment_id": 94340073, "body": "Thanks for the code, I see the mistake now. The buffer space I allocate is fixed, whereas the memory for strings are being taken from heap, hence the segmentation fault."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620351, "post_id": 53743485, "comment_id": 94340086, "body": "And to add to the growing list of fundamental problems: like every other C++ class, <code>std::string</code> has a constructor. Which must be used for constructing <b><i>every</i></b> instance of the class. Creating a shared memory segment, and converting it to a pointer, just like that, is not going to result in its constructor being invoked, automatically. C++ does not work this way."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "edited": false, "score": 0, "creation_date": 1544620364, "post_id": 53743485, "comment_id": 94340093, "body": "How should I go about correcting this ?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620410, "post_id": 53743485, "comment_id": 94340122, "body": "The best way to figure out how to do this correctly is to keep learning C++ and trying to understand how it works. How classes work. What a constructor and a destructor means. And so on. Once you have good, solid understanding of the core principles of C++ language itself, then you can branch out in operating system-specific topics like shared memory, that have nothing to do with C++, and figure out how to make everything fit together."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620978, "post_id": 53743485, "comment_id": 94340408, "body": "@SamVarshavchik thanks for the advice. I am aware of the basics of classes and related stuff, although I agree I need to work more on my C++ skills. However, a little direction into how to solve this problem would be appreciable so that I can figure out what is the best way to tackle this issue."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544621157, "post_id": 53743485, "comment_id": 94340510, "body": "Until you have a firm grasp on things like custom allocators, the rule of thumb for you to follow, right now, is that the only thing you can put into shared memory are plain values and arrays. No classes like <code>std::string</code>. Basically, if it has a constructor, or a destructor, you can&#39;t have it in shared memory, and even for plain non-class data, you have to keep in mind that shared memory is not initialized, and you are responsible for clearing its contents to their initial values."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "edited": false, "score": 0, "creation_date": 1544622737, "post_id": 53743485, "comment_id": 94341480, "body": "Thanks for the advice, I was able to workaround this problem by using a character array with a fixed size. It would be nice if any one of you can answer this question along with this fix so that I can mark it accepted and close the question."}], "owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544619215, "creation_date": 1544619215, "question_id": 53743485, "link": "https://stackoverflow.com/questions/53743485/unable-to-access-string-array-in-shared-memory", "title": "Unable to access string array in Shared Memory", "body": "<p>I am trying to send lines of text from a writer program to a reader program through shared memory. The writer works perfectly. However, during the execution of the reader program, I get a segmentation fault at the following line</p>\n\n<p><code>cout&lt;&lt;buffer-&gt;str[initial]&lt;&lt;endl;</code></p>\n\n<p><strong>The changes in count value of the shared structure are visible and correctly incremented when I run the reader simultaneously alongside the writer while commenting the above line. Hence, according to my diagnosis, the issue is with accessing the array of strings of the shared structure. Why is this the case ?</strong></p>\n\n<p>The code consists of the writer.cpp and reader.cpp which have been provided below for reference. </p>\n\n<p>The aim of the writer.cpp is to read lines from an input file and then write them in the shared memory.</p>\n\n<p><strong>Writer.cpp</strong></p>\n\n<pre><code>// for c++ related functions\n#include&lt;iostream&gt;\n#include&lt;fstream&gt;\n#include&lt;string&gt;\n\n// for c related functions\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;unistd.h&gt;\n\n// for system calls\n#include&lt;sys/types.h&gt;\n#include&lt;sys/ipc.h&gt;\n// for shared memory\n#include&lt;sys/shm.h&gt;\n\nusing namespace std;\n\n// store the key for accessing the shared memory\nkey_t shm_key = ftok(\"practical\",65);\n\n// the structure for shared memory\nstruct shared{\n  bool the_end = false;\n  int count = 0;\n  string str[6];\n};\n\nint main(){\n\n  // create the shared memory\n  int shmid = shmget(shm_key,sizeof(shared),0666|IPC_CREAT);\n  if(shmid == -1){\n    perror(\"Error in creating shared memory\");\n    return 1;\n  }\n\n  // attach server to the shared memory\n  struct shared *buffer = (shared*)shmat(shmid,NULL,0);\n  if(buffer == (void *) -1){\n     perror(\"Unable to attach to shared memory\");\n     return 1;\n  }\n\n  // open the file for reading the input\n  ifstream fin(\"input.txt\");\n  // check for errors in opening the file\n  if(!fin){\n    cerr&lt;&lt;\"Error in opening the file\"&lt;&lt;endl;\n    exit(1);\n  }\n\n  // to store the read line\n  string inptxt;\n  cout&lt;&lt;\"Reading contents from file\\n\"&lt;&lt;endl;\n\n  while(fin){\n    // read a line\n    getline(fin,inptxt);\n\n    // exit the loop if string is empty\n    if(inptxt == \"\\0\") break;\n\n    // store the line in the buffer\n    buffer-&gt;str[buffer-&gt;count++] = inptxt;\n    cout&lt;&lt;\"This was written : \"&lt;&lt;buffer-&gt;str[buffer-&gt;count-1]&lt;&lt;endl;\n\n    sleep(3);\n  }\n  cout&lt;&lt;\"Closing the file\"&lt;&lt;endl;\n  fin.close();\n\n  // marks the end of writing into shared memory\n  buffer-&gt;the_end = true;\n\n  if(shmdt(buffer) == -1){\n     perror(\"error in deatching from shared memory\");\n     return 1;\n  }\n\n  if(shmctl(shmid,IPC_RMID,0) == -1){\n     perror(\"error in destroying the shared memory\");\n     return 1;\n  }\n\n  cout&lt;&lt;\"Writing Completed\"&lt;&lt;endl;\n  return 0;\n}\n</code></pre>\n\n<p>The aim of the reader program is to read lines from the shared memory and then display them on the console.</p>\n\n<p><strong>Reader.cpp</strong></p>\n\n<pre><code>// for c++ related functions\n#include&lt;iostream&gt;\n#include&lt;fstream&gt;\n#include&lt;string&gt;\n\n// for c related functions\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;unistd.h&gt;\n\n// for system calls\n#include&lt;sys/types.h&gt;\n#include&lt;sys/ipc.h&gt;\n// for shared memory\n#include&lt;sys/shm.h&gt;\n\nusing namespace std;\n\n// store the key for accessing the shared memory\nkey_t shm_key = ftok(\"practical\",65);\n\n// the structure for shared memory\nstruct shared{\n  bool the_end = false;\n  int count = 0;\n  string str[6];\n};\n\nint main(){\n\n  // create the shared memory\n  int shmid = shmget(shm_key,sizeof(shared),0666|IPC_CREAT);\n  if(shmid == -1){\n    perror(\"Error in creating shared memory\");\n    return 1;\n  }\n\n  // attach server to the shared memory\n  struct shared *buffer = (shared*)shmat(shmid,NULL,0);\n  if(buffer == (void *) -1){\n     perror(\"Unable to attach to shared memory\");\n     return 1;\n  }\n\n  cout&lt;&lt;\"Reading contents from shared memory\\n\"&lt;&lt;endl;\n\n  int initial = 0;\n  while(!buffer-&gt;the_end){\n    if(buffer-&gt;count &gt; initial){\n      cout&lt;&lt;\"initial : \"&lt;&lt;initial&lt;&lt;\" buffer count : \"&lt;&lt;buffer-&gt;count&lt;&lt;\"\\n\";\n      // the following line gives segmentation fault\n      // cout&lt;&lt;buffer-&gt;str[initial]&lt;&lt;endl;\n      initial++;\n    }\n  }\n\n  if(shmdt(buffer) == -1){\n     perror(\"error in deatching from shared memory\");\n     return 1;\n  }\n\n  cout&lt;&lt;\"Reading Completed\"&lt;&lt;endl;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "sfml"], "comments": [{"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 1, "creation_date": 1544621933, "post_id": 53743363, "comment_id": 94340950, "body": "Have you tried <code>getLocalBounds</code> instead of <code>getGlobalBounds</code>?"}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "reply_to_user": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 0, "creation_date": 1544700000, "post_id": 53743363, "comment_id": 94373194, "body": "@Nelfeal It shouldn&#39;t matter if the bound rectangle is locally or globally placed, width and height should be the same if the sprite wasn&#39;t <b>transformed</b>. If the sprite was transformed (moved, rotated or scaled), then <code>getGlobalBounds()</code> should be used."}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 0, "creation_date": 1544700929, "post_id": 53743363, "comment_id": 94373718, "body": "That bound check works fine for me (VS2013), may be something related with your sprite movement? Are you checking values for <code>width</code> and <code>height</code>? If they are zero, your sprite will go out of the window."}], "owner": {"reputation": 1, "user_id": 10405750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa863b3dc5f0c9d37be62473779d04ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jung Lip", "link": "https://stackoverflow.com/users/10405750/jung-lip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544618812, "creation_date": 1544618812, "question_id": 53743363, "link": "https://stackoverflow.com/questions/53743363/c-sfml-screen-boundary-collision", "title": "C++ SFML screen boundary collision", "body": "<p>I have this snippet of my whole code here:</p>\n\n<pre><code>        if (player.playerSprite.getPosition().x &lt;= 0) //Left\n                player.playerSprite.setPosition(0.f, player.playerSprite.getPosition().y);\n\n        if (player.playerSprite.getPosition().x &gt;= window.getSize().x - player.playerSprite.getGlobalBounds().width) //Right\n            player.playerSprite.setPosition(window.getSize().x - player.playerSprite.getGlobalBounds().width, player.playerSprite.getPosition().y);\n\n        if (player.playerSprite.getPosition().y &lt;= 0) //Top\n    player.playerSprite.setPosition(player.playerSprite.getPosition().x, 0.f);\n\n        if (player.playerSprite.getPosition().y &gt;= window.getSize().y - player.playerSprite.getGlobalBounds().height) //Bottom\n    player.playerSprite.setPosition(player.playerSprite.getPosition().x, window.getSize().y - player.playerSprite.getGlobalBounds().height);\n</code></pre>\n\n<p>The left and top are working fine (the sprite collides into them but not pass through) but the sprite won't even come near the right and the bottom sides. Any idea how to fix this? </p>\n"}]