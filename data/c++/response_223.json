[{"tags": ["c++", "operating-system", "pthreads", "semaphore"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541272, "post_id": 55736941, "comment_id": 98151804, "body": "Any reason to use PThreads over <a href=\"https://en.cppreference.com/w/cpp/thread/thread\" rel=\"nofollow noreferrer\"><code>std::thread</code></a>? You probably also want to use <a href=\"https://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\"><code>std::string</code></a> instead of raw C-style character buffers."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541305, "post_id": 55736941, "comment_id": 98151817, "body": "You should also get out of the habit of jamming a bunch of lines together in one line for no reason. It impairs readability. That one convoluted line could be a simple <code>for</code> loop."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541333, "post_id": 55736941, "comment_id": 98151825, "body": "@tadman I am supposed to use pthread"}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541406, "post_id": 55736941, "comment_id": 98151843, "body": "@tadman which line? can you please specify?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1555541525, "post_id": 55736941, "comment_id": 98151877, "body": "You have a pile of <code>pthread_join</code> statements in <code>main</code>. Consider using <code>std::vector&lt;pthread&gt; threads</code> and later you can <code>for (auto&amp; thread : threads)</code> to iterate over them and do whatever you need. C-style arrays can be largely avoided in C++. I hope you&#39;re using a modern version of C++ and not some museum grace implementation."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541627, "post_id": 55736941, "comment_id": 98151910, "body": "@tadman actually I am not allowed to use any C++ libraries."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541788, "post_id": 55736941, "comment_id": 98151953, "body": "Is this for a C++ course of some kind? Having the Standard Library off limits is preposterous."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555541898, "post_id": 55736941, "comment_id": 98151977, "body": "@tadman its actually operating system college course assignment. but I have to learn the coding part of pthreads all my myself."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555542554, "post_id": 55736941, "comment_id": 98152117, "body": "@tadman well what can you tell me about the condition problem?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555552008, "post_id": 55736941, "comment_id": 98153755, "body": "That adds some important context. It&#39;s worth mentioning any unusual constraints you have."}], "answers": [{"comments": [{"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555546900, "post_id": 55737296, "comment_id": 98152892, "body": "I changed that but now the code is getting stuck in the producer <code>sem_wait(&amp;mutex)</code> part. the output is as follows: consumer 1 loop reached here a reached here b consumer 2 loop reached here a reached here b consumer 1 loop end consumer 1 loop reached here a reached here b reached here a and then its stuck there"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555547270, "post_id": 55737296, "comment_id": 98152964, "body": "Your <code>if(!charQueue.empty())</code> block always locks a mutex and only sometimes unlocks it."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555547476, "post_id": 55737296, "comment_id": 98153001, "body": "Here&#39;s a thought: The only thing that you need to protect against concurrent access is the queue and the only other thing you need is some way for the consumer to wait for the queue to become non-empty. So ditch the semaphores. Use one mutex to protect the queue and one condition variable to wait for the queue to be non-empty."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555547744, "post_id": 55737296, "comment_id": 98153053, "body": "I fixed that as well, still same output. also I am not checking whether queue empty with condition. i want to check that consumer 2 is reading every 3rd character and consumer 1 reads every other 2.eg: string.txt has &#39;abcdefgh&#39;, consumer 1 must read &#39;abdegh&#39; and consumer 2 must read &#39;cf&#39;"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555548432, "post_id": 55737296, "comment_id": 98153190, "body": "@ShantanuShinde You can still use just a condition variable and a mutex. The mutex protects all shared state and the condition variable is broadcast any time the shared state changes in a way that might allow a thread to make forward progress."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555548565, "post_id": 55737296, "comment_id": 98153210, "body": "but my assignment says to use semaphore for queue protection. also what do you suggest on the solution to the question I have put. how do I  make consumer 2 read every third char?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555552653, "post_id": 55737296, "comment_id": 98153855, "body": "You can&#39;t use a semaphore for queue protection and also use a condition variable because a cv&#39;s atomic &quot;unlock and wait&quot; semantic can only unlock a mutex. You&#39;ll have to go back to the earlier design with two semaphores, one to protect the queue and one to wait on."}, {"owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "edited": false, "score": 0, "creation_date": 1555564229, "post_id": 55737296, "comment_id": 98156193, "body": "I edited the code and now it is working. will you edit it into your answer so I  can accept it as answer? I will post it as my own answer, you put it in one answer. is that ok?"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 2, "last_activity_date": 1555543832, "creation_date": 1555543832, "answer_id": 55737296, "question_id": 55736941, "link": "https://stackoverflow.com/questions/55736941/how-to-properly-synchronous-threads-in-pthreads/55737296#55737296", "title": "How to properly synchronous threads in pthreads?", "body": "<p>Okay, let's start with this code:</p>\n\n<pre><code>        std::cout&lt;&lt;\"Wait over\"&lt;&lt;std::endl;\n        pthread_mutex_unlock(&amp;cond_mutex);\n        thirdCharToRead = false;\n</code></pre>\n\n<p>This code says that <code>cond_mutex</code> does not protect <code>thirdCharToRead</code> from concurrent access. Why? Because it modifies <code>thirdCharToRead</code> without holding that mutex.</p>\n\n<p>Now look at this code:</p>\n\n<pre><code>        pthread_mutex_lock(&amp;cond_mutex);\n\n        while(!thirdCharToRead)\n        {\n            std::cout&lt;&lt;\"Waiting for condition\"&lt;&lt;std::endl;\n            pthread_cond_wait(&amp;cond,&amp;cond_mutex);\n        }\n</code></pre>\n\n<p>Now, the <code>while</code> loop checks <code>thirdCharToRead</code>, so we must hold whatever lock protects <code>thirdCharToRead</code> from concurrent access when we test it. But the <code>while</code> loop will loop forever if <code>thirdCharToRead</code> stays locked for the whole loop since no other thread could ever change it. Thus, this code only makes sense if somewhere in the loop we release the lock that protects <code>thirdCharToRead</code>, and the only lock we release in the loop is <code>cond_mutex</code> in the call to <code>pthread_cond_wait</code>.</p>\n\n<p>So this code only makes sense if <code>cond_mutex</code> protects <code>thirdCharToRead</code>.</p>\n\n<p>Houston, we have a problem. One chunk of code says <code>cond_mutex</code> does not protect <code>thirdCharToRead</code> and one chunk of code says <code>cond_mutex</code> does protect <code>thirdCharToRead</code>.</p>\n"}], "owner": {"reputation": 619, "user_id": 10551333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X_vKPPlK_u4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCkXkHKjJt8QrdSkaaHgeaFAZ2UMQ/mo/photo.jpg?sz=128", "display_name": "Shantanu Shinde", "link": "https://stackoverflow.com/users/10551333/shantanu-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 55737296, "answer_count": 1, "score": 0, "last_activity_date": 1555547656, "creation_date": 1555541164, "last_edit_date": 1555547656, "question_id": 55736941, "link": "https://stackoverflow.com/questions/55736941/how-to-properly-synchronous-threads-in-pthreads", "title": "How to properly synchronous threads in pthreads?", "body": "<p>I am implementing a producer-consumer problem using pthreads and semaphore. I have 1 Producer and 2 Consumers. My Producer reads characters one by one from a file and enqueues them into a circular queue. I want the consumers to read from the queue and store into separate arrays. I want the reading in such a way that the first consumer reads 2 characters and the second consumer reads every 3rd character. I am trying to do this using <code>pthread_cond_wait()</code> but it is not working out. This is my code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;pthread.h&gt;\n#include&lt;fstream&gt;\n#include&lt;unistd.h&gt;\n#include&lt;semaphore.h&gt;\n#include&lt;queue&gt;\n#include \"circular_queue\"\n\n// define queue size\n#define QUEUE_SIZE 5\n\n// declare and initialize semaphore and read/write counter\nstatic sem_t mutex,queueEmptyMutex;\n//static int counter = 0;\n\n// Queue for saving characters\nstatic Queue charQueue(QUEUE_SIZE);\n//static std::queue&lt;char&gt; charQueue;\n\n// indicator for end of file\nstatic bool endOfFile = false;\n\n// save arrays\nstatic char consumerArray1[100];\nstatic char consumerArray2[100];\n\nstatic pthread_cond_t cond;\nstatic pthread_mutex_t cond_mutex; \nstatic bool thirdCharToRead = false;\n\nvoid *Producer(void *ptr)\n{\n    int i=0;\n    std::ifstream input(\"string.txt\");\n    char temp;\n    while(input&gt;&gt;temp)\n    {\n        std::cout&lt;&lt;\"reached here a\"&lt;&lt;std::endl;\n        sem_wait(&amp;mutex);\n        std::cout&lt;&lt;\"reached here b\"&lt;&lt;std::endl;\n        if(!charQueue.full())\n        {\n            charQueue.enQueue(temp);\n        }\n        sem_post(&amp;queueEmptyMutex);\n        sem_post(&amp;mutex);\n\n        i++;\n\n        sleep(4);\n    }\n\n    endOfFile = true;\n    sem_post(&amp;queueEmptyMutex);\n    pthread_exit(NULL);\n}\n\nvoid *Consumer1(void *ptr)\n{\n\n    int i = 0;\n    sem_wait(&amp;queueEmptyMutex);\n    bool loopCond = endOfFile;\n    while(!loopCond)\n    {\n        std::cout&lt;&lt;\"consumer 1 loop\"&lt;&lt;std::endl;\n        if(endOfFile)\n        {\n\n            loopCond = charQueue.empty();\n            std::cout&lt;&lt;loopCond&lt;&lt;std::endl;\n            sem_post(&amp;queueEmptyMutex);\n        }\n       sem_wait(&amp;queueEmptyMutex);\n\n\n        sem_wait(&amp;mutex);\n\n\n        if(!charQueue.empty())\n        {\n\n            consumerArray1[i] = charQueue.deQueue();\n            i++;\n            if(i%2==0)\n            {\n                pthread_mutex_lock(&amp;cond_mutex);\n                std::cout&lt;&lt;\"Signal cond. i = \"&lt;&lt;i&lt;&lt;std::endl;\n                thirdCharToRead = true;\n                pthread_mutex_unlock(&amp;cond_mutex);\n                pthread_cond_signal(&amp;cond);\n\n            }\n        }        \n        if(charQueue.empty()&amp;&amp;endOfFile)\n        {\n\n            sem_post(&amp;mutex);\n            sem_post(&amp;queueEmptyMutex);\n\n            break;\n        }  \n        sem_post(&amp;mutex);\n\n        sleep(2);\n        std::cout&lt;&lt;\"consumer 1 loop end\"&lt;&lt;std::endl;\n    }\n\n    consumerArray1[i] = '\\0';\n    pthread_exit(NULL);\n\n}\n\nvoid *Consumer2(void *ptr)\n{\n\n    int i = 0;\n    sem_wait(&amp;queueEmptyMutex);\n    bool loopCond = endOfFile;\n    while(!loopCond)\n    {\n        std::cout&lt;&lt;\"consumer 2 loop\"&lt;&lt;std::endl;\n        if(endOfFile)\n        {\n\n            loopCond = charQueue.empty();\n            std::cout&lt;&lt;loopCond&lt;&lt;std::endl;\n            sem_post(&amp;queueEmptyMutex);\n        }\n        sem_wait(&amp;queueEmptyMutex);\n\n\n        sem_wait(&amp;mutex);\n\n\n        if(!charQueue.empty())\n        {\n            pthread_mutex_lock(&amp;cond_mutex);\n\n            while(!thirdCharToRead)\n            {\n                std::cout&lt;&lt;\"Waiting for condition\"&lt;&lt;std::endl;\n                pthread_cond_wait(&amp;cond,&amp;cond_mutex);\n            }\n            std::cout&lt;&lt;\"Wait over\"&lt;&lt;std::endl;\n            thirdCharToRead = false;\n            pthread_mutex_unlock(&amp;cond_mutex);\n\n            consumerArray2[i] = charQueue.deQueue();\n\n            i++;\n        }  \n        if(charQueue.empty()&amp;&amp; endOfFile)\n        {\n            sem_post(&amp;mutex);\n            sem_post(&amp;queueEmptyMutex);\n            break;\n        }  \n\n        sem_post(&amp;mutex);\n        std::cout&lt;&lt;\"consumer 2 loop end\"&lt;&lt;std::endl;\n        sleep(2);\n\n    }\n\n    consumerArray2[i] = '\\0';\n    pthread_exit(NULL);\n\n}\n\nint main()\n{\n    pthread_t thread[3];\n    sem_init(&amp;mutex,0,1);\n    sem_init(&amp;queueEmptyMutex,0,1);\n    pthread_mutex_init(&amp;cond_mutex,NULL);\n    pthread_cond_init(&amp;cond,NULL);\n    pthread_create(&amp;thread[0],NULL,Producer,NULL);\n    int rc = pthread_create(&amp;thread[1],NULL,Consumer1,NULL);\n    if(rc)\n    {\n        std::cout&lt;&lt;\"Thread not created\"&lt;&lt;std::endl;\n    }\n    pthread_create(&amp;thread[2],NULL,Consumer2,NULL);\n    pthread_join(thread[0],NULL);pthread_join(thread[1],NULL);pthread_join(thread[2],NULL);\n    std::cout&lt;&lt;\"First array: \"&lt;&lt;consumerArray1&lt;&lt;std::endl;\n    std::cout&lt;&lt;\"Second array: \"&lt;&lt;consumerArray2&lt;&lt;std::endl;\n    sem_destroy(&amp;mutex);\n    sem_destroy(&amp;queueEmptyMutex);\n    pthread_exit(NULL);\n}\n</code></pre>\n\n<p>The problem I am having is after one read, consumer 2 goes into infinite loop in the <code>while(!thirdCharToRead)</code>. Is there any better way to implement this?</p>\n"}, {"tags": ["c++", "templates", "template-specialization", "partial-specialization"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1555543105, "post_id": 55736916, "comment_id": 98152236, "body": "It is unclear exactly what you want, but I am guessing you want to pass <code>types_match_impl</code> to itself. Can you show the code you would like to write, and describe what you think it should do?"}], "answers": [{"comments": [{"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1555566362, "post_id": 55737069, "comment_id": 98156814, "body": "Thank you, I understand. The solution looks promising, I&#39;ll get back with my results (PS: love the Haskell thrown in :) )"}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1555568522, "post_id": 55737069, "comment_id": 98157523, "body": "Unfortunately it is not possible to have both &quot;kinds&quot; of types in the same variadic parameter pack, so recursion as I have imagined it, is not possible"}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 1, "creation_date": 1555584215, "post_id": 55737069, "comment_id": 98165419, "body": "It turns out that for my design I don&#39;t even need uninstanciated templates, but this information will be helpful for the future"}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": true, "score": 3, "last_activity_date": 1555543201, "last_edit_date": 1555543201, "creation_date": 1555542140, "answer_id": 55737069, "question_id": 55736916, "link": "https://stackoverflow.com/questions/55736916/partial-template-specialization-over-instantiated-and-uninstantiated-template/55737069#55737069", "title": "Partial template specialization over instantiated and uninstantiated template", "body": "<p><strong>The way you're hoping for is not possible.</strong> Here's why:</p>\n\n<p></p>\n\n<pre><code>one&lt;instantiated&gt;{};\ntwo&lt;sample_templated&gt;{};\n</code></pre>\n\n<p><code>one</code> \"uses\" more than <code>two</code>: It is referring to <code>instantiated</code> which is <code>sample_templated</code> <em>instantiated with</em> <code>double</code>. <code>two</code> on the other hand is only \"using\" the <code>sample_templated</code>.</p>\n\n<p>When you think of templates as functions on types, then this becomes even clearer: <code>two</code> is a function which accepts a (type-level) function to create some type. <code>one</code> is a function which accepts a type to create some type:</p>\n\n<pre><code>one :: T -&gt; one&lt;T&gt;\ntwo :: (T -&gt; U) -&gt; two&lt;(T -&gt; U)&gt;\n</code></pre>\n\n<p>Put differently the parameter of <code>one</code> has a different \"kind\" (\"type of type\") as the one of <code>two</code>.</p>\n\n<p><strong>What you can do:</strong> </p>\n\n<ul>\n<li><p>You can provide a specialization of <code>one</code> which accepts a template template parameter (\"type level function\") <em>and</em> the template parameter for that:</p>\n\n<pre><code>template&lt;template&lt;typename...&gt; typename TT, typename T&gt;\nstruct one&lt;TT&lt;T&gt;&gt;  { /* ... */ }; // this basically \"calls\" TT\n</code></pre></li>\n<li><p>You can turn <code>two</code> into something which can accept both, albeit with a \"dummy\" template template parameter:</p>\n\n<pre><code>template&lt;template&lt;typename...&gt; typename TT, typename... Ts&gt;\nstruct two { /* */ };\n\ntemplate&lt;typename...&gt;\nstruct Void;\n\ntemplate&lt;typename T&gt;\nstruct two&lt;Void&lt;&gt;, T&gt; { /* Use T like in one */ };\n// or derive from one&lt;T&gt;\n</code></pre></li>\n</ul>\n\n<p>There are probably more approaches, but these will depend on your specific use case.</p>\n"}], "owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55737069, "answer_count": 1, "score": 3, "last_activity_date": 1555543201, "creation_date": 1555540949, "last_edit_date": 1555541130, "question_id": 55736916, "link": "https://stackoverflow.com/questions/55736916/partial-template-specialization-over-instantiated-and-uninstantiated-template", "title": "Partial template specialization over instantiated and uninstantiated template", "body": "<p>I have the following two structs:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nstruct one { /* ... */ };\n\ntemplate&lt;template&lt;typename...&gt; typename T&gt;\nstruct two { /* ... */ };\n</code></pre>\n\n<p>When I have example instantiated/uninstantiated templates like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nstruct sample_templated { /* ... */ };\n\nusing instantiated = sample_templated&lt;double&gt;;\n\n</code></pre>\n\n<p>then I can do</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>one&lt;instantiated&gt;{};\ntwo&lt;sample_templated&gt;{};\n</code></pre>\n\n<p>just fine. I would like to merge the definition of <code>one</code> and <code>two</code> such that they have the same name, though, as this would allow recursion.</p>\n\n<p>I tried having a default definition like</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename...&gt;\nstruct types_match_impl;\n</code></pre>\n\n<p>and having the two original structs be partial specializations of this, but this is incompatible with <code>two</code>.</p>\n\n<p>What is the solution here?</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555541108, "post_id": 55736891, "comment_id": 98151755, "body": "Unrelated: <code>return 0;</code> looks odd in a function that returns <code>void</code>."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1555541689, "post_id": 55736891, "comment_id": 98151929, "body": "Also unrelated: instead of expressing multiple return values as reference arguments, I usually prefer to have the function return a structure with the return values.  That makes things easier on the caller: <code>auto pq = Factorise_the_number(n);</code> as opposed to <code>int p; int q; Factorise_the_number(n, p, q);</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555541731, "post_id": 55736891, "comment_id": 98151938, "body": "Instead of <code>int n, p=0, q=0; cin &gt;&gt; n;</code>, use <code>int n=99, p=0, q=0;</code> Now people don&#39;t have to type in <code>n</code>. They can keep testing the same case over and over until it&#39;s cracked. Faster and less chance of wasting time accidentally debugging a typo."}, {"owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555541945, "post_id": 55736891, "comment_id": 98151989, "body": "@user4581301 actually try type in <code>10</code>, <code>9223</code>, <code>57683</code>. It doesn&#39;t work for them, too. I just found that out. It does work for the following: <code>77777, 48, 22360800</code>  Thanks for your help by the way"}, {"owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "reply_to_user": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1555541991, "post_id": 55736891, "comment_id": 98152003, "body": "@DanielSchepler now that you mention such a possibility it is niftier, but I don&#39;t know how to return a structure yet! Thanks"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1555542187, "post_id": 55736891, "comment_id": 98152044, "body": "If it never enters the loop because sqfree_factors is empty then it will use uninitialized values."}, {"owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555542210, "post_id": 55736891, "comment_id": 98152048, "body": "@user4581301 Can you suggest an alternative? I understand what using uninitialized variables means but I don&#39;t see how (or where) to fix it!"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555542674, "post_id": 55736891, "comment_id": 98152141, "body": "Do you need <code>sqfree_number</code>? At the end of the day it just looks like it&#39;s <code>p</code>. Why not use <code>p</code>? Better still, make <code>sqfree_number</code> the parameter and do away with <code>p</code>. The more descriptive name should always win out. Makes for easier-to-read code."}, {"owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1555543126, "post_id": 55736891, "comment_id": 98152244, "body": "@ZanLynx Yes, but take for instance the number <code>123</code>. The sqfree_factors for it shouldn&#39;t be empty (should contain <code>3 and 41</code>) right?"}, {"owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555543434, "post_id": 55736891, "comment_id": 98152301, "body": "@user4581301 thanks for the suggestion. I changed it!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "edited": false, "score": 0, "creation_date": 1555578190, "post_id": 55737334, "comment_id": 98162167, "body": "Many thanks for your help! I was able to solve it after you pointed me to the right direction. May I ask one more thing though, do you think that this algorithm is too inefficient? Because the exercise says that there are many ways to perform such a factoring(one of which would be via finding all prime factors of the number <code>n</code>, but that there should be many more algorithms)?"}, {"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "reply_to_user": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "edited": false, "score": 0, "creation_date": 1555583253, "post_id": 55737334, "comment_id": 98164861, "body": "A faster approach would be to change the order of your checks from breadth-first to depth-first. Right now you find <i>all</i> the factors, then you check <i>all</i> of them for squarefree-ness, and then you try the equality for <i>all</i> of them. Imagine the factors are 1000, and 500 are squarefree. Of these, the third one satisfies the equality. It means that hundreds of checks were useless! Instead, when you find a factor, check if it is squarefree immediately, and if it is, check the equality. It&#39;s faster, and you also save memory, because there&#39;s no need to store your results."}, {"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "reply_to_user": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "edited": false, "score": 0, "creation_date": 1555590429, "post_id": 55737334, "comment_id": 98168784, "body": "Alternative algorithm: you just need to factor the number, and then it satisfies your equality if there&#39;s at least a factor with an even exponent and at least one with an odd exponent. It might, or might not, be faster than your approach."}], "tags": [], "owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1555544262, "creation_date": 1555544262, "answer_id": 55737334, "question_id": 55736891, "link": "https://stackoverflow.com/questions/55736891/accessing-an-uninitialized-value-most-probably-in-a-vector/55737334#55737334", "title": "Accessing an uninitialized value, most probably in a vector", "body": "<p>As you said, for 39 it doesn't work. Have you checked what it's doing with 39? You should do it, as it is the best way to debug your program.</p>\n\n<p>Let's have a look at it together. First it tries to find all the factors, and it finds 1, 3 and 13: this looks fine.</p>\n\n<p>Then, it checks whether each of those numbers is squarefree, and they all are: this also looks correct.</p>\n\n<p>Then, it checks whether any of the squarefree factors satisfy the equality you are looking for. None of them does (39 is 3 x 13, there's no way it can contain a squared factor). This means that <code>if (int(sqrt(n / x)) == sqrt(n / x))</code> is never true, and that block is never run. What's the value of <code>sqfree_number</code> and <code>squared</code> at that point? It is never initialised. Using uninitialised values leads to \"undefined behaviour\", that is, your program can do anything. In this case, <code>p</code> and <code>q</code> end up containing random values.</p>\n\n<p>How can you fix it? Consider this: if <code>n</code> doesn't satisfy your equation, that is, it can't be expressed as pq*q, what, exactly, should the program output? Would your output, as it is now, ever make sense? No. This means you have to modify your program so that it covers a case you hadn't considered.</p>\n\n<p>A way is to add a <code>bool found = false;</code> just before your final <code>for</code> loop. When you find the factors, before breaking, set that variable to <code>true</code>. Then, outside the loop, check it: is it <code>true</code>? Then you can return the correct values. But if it's still <code>false</code>, it means the equality doesn't hold, and you can't return correct values. You have to find a way to signal this to the caller (which is your <code>main</code> function), so that it can print an appropriate message.</p>\n\n<p>And how can you signal it? In general, you could change your <code>Factorise_the_number</code> (by the way, the name of functions should start with a lowercase letter; uppercase letters are usually used for classes) to return a <code>bool</code>. Or you could use a trick: return a special value for <code>p</code> and <code>q</code> that cannot be the result of the calculation. Like -1. Then, before printing, check: if the values are -1, it means the number can't be expressed as pq*q.</p>\n"}], "owner": {"reputation": 13, "user_id": 11376225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c3638edcc3bd311cc6d38185aae120?s=128&d=identicon&r=PG&f=1", "display_name": "ff998", "link": "https://stackoverflow.com/users/11376225/ff998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55737334, "answer_count": 1, "score": 0, "last_activity_date": 1555544262, "creation_date": 1555540767, "last_edit_date": 1555541930, "question_id": 55736891, "link": "https://stackoverflow.com/questions/55736891/accessing-an-uninitialized-value-most-probably-in-a-vector", "title": "Accessing an uninitialized value, most probably in a vector", "body": "<p>I am doing an exercise where I need to find a positive integers <code>p</code> and <code>q</code> which are factors of another natural number <code>n</code>.\nFollowing the formula <code>n=pq*q</code> where p is a <em>squarefree</em> number. </p>\n\n<p>However, for some instances of the program my compiler detects a memory error saying that I am accessing an uninitialized value.</p>\n\n<p>The logic I tried is as follows. Firstly, I took the number that needs to be factored (name it n). Next I found all factors of the number n and placed them in a vector. After that, check if every element of that vector is <em>squarefree</em>. If true, put the element in another vector(a vector of squarefree factors of the number n). After that, go through every element of the vector of squarefree factors and solve the equation <code>q=sqrt(n/p)</code> where p is the squarefree factor from the vector. Additionally, I check the condition <code>if(int(sqrt(n/p))==sqrt(n/p))</code> because the square root needs to be a positive integer.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n// Function that checks if the number is squarefree\n\nbool isSquareFree(int n)\n{\n    if (n % 2 == 0)\n        n = n / 2;\n    if (n % 2 == 0)\n        return false;\n    for (int i = 3; i &lt;= sqrt(n); i += 2)\n    {\n        if (n % i == 0)\n        {\n            n = n / i;\n            if (n % i == 0)\n                return false;\n        }\n    }\n    return true;\n}\n\nvoid Factorise_the_number(int n, int &amp;p, int &amp;q)\n{\n    if (n &lt;= 0)\n        return 0;\n    vector&lt;int&gt; factors(0); // vector of factors\n    vector&lt;int&gt; sqfree_factors(0); // vector of squarefree factors\n    int sqfree_number; // the number \"p\"\n    int squared; // is essentially the number \"q\"\n\n    for (int i = 1; i &lt;= n / 2; i++)\n    {\n        if (n % i == 0)\n            factors.push_back(i); // takes all factors of the number \"n\"\n    }\n\n    for (int i = 0; i &lt; factors.size(); i++)\n    {\n        if (isSquareFree(factors.at(i)))\n            sqfree_factors.push_back(factors.at(i));\n    } // checks if each factor is squarefree. if yes, put it in a separate vector\n\n    for (auto x : sqfree_factors)\n    {\n\n        if (int(sqrt(n / x)) == sqrt(n / x))\n        { // if true, we found the numbers\n            squared = sqrt(n / x);\n            sqfree_number = x;\n            break;\n        }\n    }\n\n    p = sqfree_number;\n    q = squared;\n}\n\nint main()\n{\n\n    int n, p = 0, q = 0;\n    cin &gt;&gt; n;\n\n    Factorise_the_number(n, p, q);\n    cout &lt;&lt; p &lt;&lt; \" \" &lt;&lt; q;\n\n    return 0;\n}\n</code></pre>\n\n<p>For example, my program works if I enter the number <code>99</code>, but doesn't work if I enter <code>39</code>. Can anyone give any insight?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "sorting", "structure"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1555540905, "post_id": 55736846, "comment_id": 98151711, "body": "<i>I thought storing the marks in a structure would help keeping track of the various subjects.</i> Exactly the right idea. Writing bubblesort is not so good for two reasons: 1. don&#39;t write stuff unless you have to. There are library functions to do the sorting for you. 2. Usually the code competition sites are looking for fast code and bubblesort is about as slow as they come."}, {"owner": {"reputation": 309, "user_id": 11319137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Detd5tmq43w/AAAAAAAAAAI/AAAAAAAAAz4/7q7skKpomaI/photo.jpg?sz=128", "display_name": "dkapur17", "link": "https://stackoverflow.com/users/11319137/dkapur17"}, "edited": false, "score": 0, "creation_date": 1555542144, "post_id": 55736846, "comment_id": 98152034, "body": "Sorry, I just noticed that I had written std::swap instead of std::sort int the first paragraph. Rectified the mistake."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1555542650, "creation_date": 1555542650, "answer_id": 55737144, "question_id": 55736846, "link": "https://stackoverflow.com/questions/55736846/sorting-a-vector-of-structures-based-on-one-of-the-elements/55737144#55737144", "title": "Sorting a vector of structures based on one of the elements", "body": "<p><code>std::sort()</code> allows you to give it a predicate so you can perform comparisons however you want, eg:</p>\n\n<pre><code>std::sort(\n  stud.begin(),\n  stud.begin()+n, // &lt;-- use stud.end() instead if n == stud.size() ...\n  [](const scores &amp;a, const scores &amp;b){ return a.tot &lt; b.tot; }\n);\n</code></pre>\n\n<p>Simply use <code>return b.tot &lt; a.tot</code> to reverse the sorting order.</p>\n"}], "owner": {"reputation": 309, "user_id": 11319137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Detd5tmq43w/AAAAAAAAAAI/AAAAAAAAAz4/7q7skKpomaI/photo.jpg?sz=128", "display_name": "dkapur17", "link": "https://stackoverflow.com/users/11319137/dkapur17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55737144, "answer_count": 1, "score": -2, "last_activity_date": 1555542650, "creation_date": 1555540466, "last_edit_date": 1555542471, "question_id": 55736846, "link": "https://stackoverflow.com/questions/55736846/sorting-a-vector-of-structures-based-on-one-of-the-elements", "title": "Sorting a vector of structures based on one of the elements", "body": "<p>I was writing a program to input the marks of <code>n</code> students in four subjects and then find the rank of one of them based on the total scores (from codeforces.com: <a href=\"https://codeforces.com/problemset/problem/1017/A\" rel=\"nofollow noreferrer\">https://codeforces.com/problemset/problem/1017/A</a>). I thought storing the marks in a structure would help keeping track of the various subjects.</p>\n\n<p>Now, what I did is simply implement a bubble sort on the vector while checking the total value. I want to know, is there a way that I can sort the vector based on just one of the members of the struct using <code>std::sort()</code>? Also, how do we make it descending?</p>\n\n<p>Here is what the code looks like right now:</p>\n\n<pre><code>//The Structure\nstruct scores\n{\n    int eng, ger, mat, his, tot, rank;\n    bool tommyVal;\n};\n\n//The Sort (present inside the main function)\n    bool sorted = false;\n    while (!sorted)\n    {\n        sorted = true;\n        for (int i = 0; i &lt; n-1; i++)\n        {\n            if (stud[i].tot &lt; stud[i + 1].tot)\n            {\n                std::swap(stud[i], stud[i + 1]);\n                sorted = false;\n            }\n        }\n    }\n</code></pre>\n\n<p>Just in case you're interested, I need to find the rank of a student named Thomas. So, for that, I set the value of tommyVal true for his element, while I set it as false for the others. This way, I can easily locate Thomas' marks even though his location in the vector has changed after sorting it based on their total marks.</p>\n\n<p>Also nice to know that <code>std::swap()</code> works for swapping entire structs as well. I wonder what other data structures it can swap.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1555543659, "post_id": 55736698, "comment_id": 98152349, "body": "Are You linking against an implementation of the C++ standard library? <a href=\"https://stackoverflow.com/q/7015285/1116364\">stackoverflow.com/q/7015285/1116364</a>"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1555544904, "post_id": 55736698, "comment_id": 98152542, "body": "Note that if I just copy and paste your code into the Arduino Web Editor (after fixing the typos), it compiles just fine there\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": true, "score": 1, "last_activity_date": 1555543753, "creation_date": 1555543753, "answer_id": 55737289, "question_id": 55736698, "link": "https://stackoverflow.com/questions/55736698/virtual-destructor-arduino-due-undefined-reference-to-operator-delete/55737289#55737289", "title": "Virtual destructor Arduino Due undefined reference to operator delete", "body": "<p>It is rather strange that the sole presence of a destructor would introduce a reference to the global <code>operator delete</code>. However, it seems that you're not the first one with this problem: <a href=\"https://stackoverflow.com/questions/7015285/undefined-reference-to-operator-deletevoid\">Undefined reference to &#39;operator delete(void*)&#39;</a>. As pointed out in the comments there, the C++ standard library is <a href=\"http://www.nongnu.org/avr-libc/user-manual/FAQ.html#faq_cplusplus\" rel=\"nofollow noreferrer\">not really available</a> on <code>avr-g++</code> which is most likely what you're using as well.</p>\n\n<p>All that being said, however, I believe I can offer some relief.</p>\n\n<blockquote>\n  <p>When an interface contains a pure virtual method, it is recommended to use a virtual destructor.</p>\n</blockquote>\n\n<p>A virtual destructor is only necessary when you need to <code>delete</code> an object via a base pointer <a href=\"http://eel.is/c++draft/expr.delete#3\" rel=\"nofollow noreferrer\">[expr.delete]/3</a>. Think of a virtual destructor as part of the interface itself. If an interface declares a virtual destructor, that means \"objects that implement this interface can be deleted\". The operation <code>delete</code> becomes part of the interface.</p>\n\n<p>If you do not need the capability to <code>delete</code> as part of your interface, which, I would argue, should actually be the default, then you don't need a virtual destructor. Simply declare the destructor non-virtual and make it protected. Thus, you remove the operation <code>delete</code> from the interface and pass on the decision whether a type can be deleted further down to more concrete implementations of the interface&hellip;</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11376207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 55737289, "answer_count": 1, "score": 0, "last_activity_date": 1555543753, "creation_date": 1555539459, "question_id": 55736698, "link": "https://stackoverflow.com/questions/55736698/virtual-destructor-arduino-due-undefined-reference-to-operator-delete", "title": "Virtual destructor Arduino Due undefined reference to operator delete", "body": "<p>When an interface contains a pure virtual method, it is recommended to use a virtual destructor. So for example, I have this code:</p>\n\n<pre>\n\n    template\n    class A {\n    protected:\n        char buffer[Size];\n    public:\n        virtual void method() = 0;\n        A() = default;\n        virtual ~A() = default;\n    };\n\n    template\n    class B : public A {\n    public:\n        void method() override;\n        B() = default\n        ~B() = default;\n    };\n\n    int main() {\n        B b;\n        b.method();\n    }\n\n</pre>\n\n<p>But when I try to compile this with g++ for an Arduino Due, I get the following error:</p>\n\n<pre>\n\n    main.cpp:(.text._ZN4r2d29robot_arm22uarm_gcode_generator_cILj100EED0Ev[_ZN4r2d29robot_arm22uarm_gcode_generator_cILj100EED5Ev]+0x6): undefined reference to `operator delete(void*, unsigned int)'\n\n</pre>\n\n<p>However, when I remove the destructor from A entirely, it removes the error, but wouldn't this cause Undifed Behaviour? Also, when I just remove the virtual keyword from the destructor of A it gives me the same error message.</p>\n"}, {"tags": ["c++", "macros"], "comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1555539365, "post_id": 55736643, "comment_id": 98151361, "body": "You could use the <a href=\"https://stackoverflow.com/questions/4674480/do-whilefalse-pattern\"><code>do ... while (false);</code></a> pattern to put the macro&#39;s content inside a new scope."}, {"owner": {"reputation": 1913, "user_id": 2899885, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZJfu0.png?s=128&g=1", "display_name": "Cybran", "link": "https://stackoverflow.com/users/2899885/cybran"}, "edited": false, "score": 1, "creation_date": 1555539656, "post_id": 55736643, "comment_id": 98151423, "body": "Is it important to re-use the same variable? Otherwise I would just introduce a new scope in the macro"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1555539486, "creation_date": 1555539486, "answer_id": 55736701, "question_id": 55736643, "link": "https://stackoverflow.com/questions/55736643/how-to-avoid-re-declare-variables-with-c-macros/55736701#55736701", "title": "How to avoid re-declare variables with C++ Macros", "body": "<p>It seems regular function works:</p>\n\n<pre><code>void EXPECT_MY_CLASS_EQ(const char* expectedStr, const char* candidateStr)\n{\n    auto ptrCandidate = parseAndGetPtr(candidateStr);\n    doWork(ptrCandidate);\n    EXPECT_EQ(expectedStr, convertToString(ptrCandidate));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1555589795, "last_edit_date": 1555589795, "creation_date": 1555539607, "answer_id": 55736721, "question_id": 55736643, "link": "https://stackoverflow.com/questions/55736643/how-to-avoid-re-declare-variables-with-c-macros/55736721#55736721", "title": "How to avoid re-declare variables with C++ Macros", "body": "<p>A possible way might be to use <code>__LINE__</code> or <code>__COUNTER__</code>  with preprocessor symbol <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Concatenation.html#Concatenation\" rel=\"nofollow noreferrer\">concatenation</a>.</p>\n\n<p>In your case, you probably don't need any macro: prefer some <code>static inline</code> function.</p>\n\n<p>Here is a real-life example (using concatenation and <code>__LINE__</code>) from my <a href=\"https://github.com/bstarynk/bismon\" rel=\"nofollow noreferrer\">Bismon</a>'s project file <a href=\"https://github.com/bstarynk/bismon/blob/master/cmacros_BM.h#L285\" rel=\"nofollow noreferrer\">cmacros.h line 285</a> (it is in C, but the same trick could be done in C++)</p>\n\n<pre><code>#define LOCAL_FAILURE_HANDLE_ATBIS_BM(Fil,Lin,Lockset,Flabel,FcodVar,ReasonVar,PlaceVar) \\\n  struct failurehandler_stBM fh_##Lin                   \\\n   = {                                  \\\n     .pA = {.htyp = typayl_FailureHandler_BM},              \\\n     .failh_magic = FAILUREHANDLEMAGIC_BM,              \\\n     .failh_lockset = Lockset,                      \\\n     .failh_reason = NULL,                      \\\n     .failh_jmpbuf = {}};                       \\\n  curfailurehandle_BM = &amp;fh_##Lin;                  \\\n  volatile int failcod_##Lin =  setjmp(fh_##Lin.failh_jmpbuf);      \\\n  FcodVar = failcod_##Lin;                      \\\n  if (failcod_##Lin) {                          \\\n    ReasonVar = fh_##Lin.failh_reason;                  \\\n    PlaceVar = fh_##Lin.failh_place;                    \\\n    goto Flabel;                            \\\n  };                                    \\\n  (void)0\n\n#define LOCAL_FAILURE_HANDLE_AT_BM(Fil,Lin,Lockset,Flabel,FcodVar,ReasonVar,PlaceVar) \\\n  LOCAL_FAILURE_HANDLE_ATBIS_BM(Fil,Lin,Lockset,Flabel,FcodVar,ReasonVar,PlaceVar)\n\n/// code using LOCAL_FAILURE_HANDLE_BM should probably backup and\n/// restore the curfailurehandle_BM\n#define LOCAL_FAILURE_HANDLE_BM(Lockset,Flabel,FcodVar,ReasonVar,PlaceVar)  \\\nLOCAL_FAILURE_HANDLE_AT_BM(__FILE__,__LINE__,Lockset,Flabel,FcodVar,ReasonVar,PlaceVar)\n</code></pre>\n\n<p>Back to your question, if you still want a macro: just create a block, e.g.</p>\n\n<pre><code>#define EXPECT_MY_CLASS_EQ(expectedStr, candidateStr)   do{    \\\n    auto ptrCandidate = parseAndGetPtr(candidateStr);       \\\n    doWork(ptrCandidate);                                   \\\n    EXPECT_EQ(expectedStr, convertToString(ptrCandidate));} while(0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555555874, "post_id": 55736763, "comment_id": 98154393, "body": "What if, in some complicated huge program with 40 different directories nested at different levels, I use that pasty-indirection-unique-variable macro on line 10 of file blah.cpp, in directory feature1/stuff/foo/, and <i>just happen</i> to also use the same macro in baz.cpp in driver/core/bar/, and <i>by coincidence</i> it happens to be on line 10 of that file.  What exactly in this hand wavy incomplete recommendation prevents baz.cpp&#39;s &quot;unique symbol&quot; from colliding with blah.cpp&#39;s &quot;unique symbol&quot;?  (It isn&#39;t <code>__LINE__</code>, that&#39;s for sure!)"}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555556264, "post_id": 55736763, "comment_id": 98154464, "body": "...o/c, this comment is specifically about (and limited to) the recommendation of the use of <code>__LINE__</code> and <code>__COUNTER__</code> to generate &quot;unique&quot; variables (and this is easily mitigated e.g., by putting them an unnamed ns, but I would think that should have to be mentioned)."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555588461, "post_id": 55736763, "comment_id": 98167674, "body": "@HWalters If the probability of that happening is more than minimal to impossible then you have way too many global variables.  And all you&#39;ll get is an compiler error (redefinition)."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555588523, "post_id": 55736763, "comment_id": 98167715, "body": "Unnamed namespaces are IMO on a different level .. this post is about unique variable names within a translation unit. This is not about linking."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555597875, "post_id": 55736763, "comment_id": 98173352, "body": "&quot;this post is about&quot; <i>This</i> question is about <i>scoped</i> variables, but I see nothing mentioning a single t.u.  But your <i>bullet</i> is listed under &quot;generally speaking&quot;, which I read as importing scope (it&#39;s superfluous for <i>this</i> question <i>anyway</i>).  &quot;probability&quot; ...it&#39;s akin to <a href=\"https://en.wikipedia.org/wiki/Birthday_problem\" rel=\"nofollow noreferrer\">the birthday problem</a> (two t.u.&#39;s, same line); we&#39;re not talking won-the-lottery.  &quot;too many globals&quot;/&quot;all you&#39;ll get&quot; ...I&#39;m reading, &quot;if my advice bites you, you did something wrong, and my advice is still perfectly fine because if it bites you it won&#39;t hurt much&quot;."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555621558, "post_id": 55736763, "comment_id": 98183846, "body": "@HWalters The questions contains code which is only valid <i>within</i> a function. Thus global variables aren&#39;t really what this question is about.  Thus I didn&#39;t include approaches for resolving the possible <i>linking</i> issues which could occur using it.  Note that the <i>linking</i> issue which you mentioned <b>requires</b> two separate translation units ... unless you merge feature1/stuff/foo/blah.cpp and driver/core/bar/baz.cpp into a single file or do some other trickery (including source files instead of headers for example)."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1555621713, "post_id": 55736763, "comment_id": 98183894, "body": "@HWalters Long story short: What you mention <i>can</i> be a problem with this approach <i>when</i> applied to global variables <i>and</i> when not following proper practices (putting &quot;local&quot; definitions in an unnamed namespace). It&#39;s completely orthogonal to the questions though. Last but not least I don&#39;t &quot;recommend&quot; any approach here, I just list the possibilities. Which approach is suitable or not depends on the circumstances (which are - again - not the scope of the question)."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1555638375, "post_id": 55736763, "comment_id": 98187319, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/192080/discussion-between-h-walters-and-daniel-jour\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 4, "last_activity_date": 1555540935, "last_edit_date": 1555540935, "creation_date": 1555539924, "answer_id": 55736763, "question_id": 55736643, "link": "https://stackoverflow.com/questions/55736643/how-to-avoid-re-declare-variables-with-c-macros/55736763#55736763", "title": "How to avoid re-declare variables with C++ Macros", "body": "<p>As shown in another answer, you don't need a macro in this case.</p>\n\n<p>Generally speaking though, you can avoid re-definitions of variable names by the following means:</p>\n\n<ul>\n<li><p>Use of <code>__LINE__</code> preprocessor symbol (or <code>__COUNTER__</code>, though IIRC that's not standard).  Note that <a href=\"https://stackoverflow.com/q/1489932/1116364\">creating a variable name with the preprocessor requires two levels of indirection</a> (replace <code>VARIABLE</code> in the link with <code>__LINE__</code>).</p></li>\n<li><p>A <a href=\"https://stackoverflow.com/questions/4674480/\"><code>do { /* code */ } while(0)</code></a> ... which is AFAIK the most common way to write macros that are more than just a simple expression.</p></li>\n<li><p>A lambda which is immediately executed: </p>\n\n<p><code>([](auto var) { /* code using var */ })(initExpressionForVar())</code></p></li>\n</ul>\n\n<p>Note that each of these approaches actually creates a <strong>new</strong> variable each time, so is semantically different from your approach with two separate macros!  This is especially important if the type of the (assigned) variable has a non-default assignment operator!</p>\n\n<p>If, for some reason, you rely on the reuse of a single variable and the assignment to it, then IMO the easiest approach is to define two macros. One macro which declares the variable (and initializes it, if necessary), and another macro with the code which uses the variable.</p>\n"}], "owner": {"reputation": 11, "user_id": 10349656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122e2a89b574b4597dcd1ce14caf75c9?s=128&d=identicon&r=PG&f=1", "display_name": "BlowMyMind", "link": "https://stackoverflow.com/users/10349656/blowmymind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558953423, "creation_date": 1555539061, "last_edit_date": 1558953423, "question_id": 55736643, "link": "https://stackoverflow.com/questions/55736643/how-to-avoid-re-declare-variables-with-c-macros", "title": "How to avoid re-declare variables with C++ Macros", "body": "<p>I want to write a simple Macro function. Because this macro is used in many places by different normal c++ functions, I encountered a variable scope issue. I would like to know if there is a quick way to solve it? Thank you very much.</p>\n\n<p>As you can see in the attached code, depending on whether the macro is called in the function for the first time or not, I want to either declare or reuse the variable <code>ptrCandidate</code>. Note the variable scope is in the function, not in the file or translation unit. In other words, every time the macro is invoked in a new function for the 1st time, I want the top macro. And within the same function, if the macro is invoked again, I want the bottom macro.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define EXPECT_MY_CLASS_EQ(expectedStr, candidateStr)       \\\n    auto ptrCandidate = parseAndGetPtr(candidateStr);       \\\n    doWork(ptrCandidate);                                   \\\n    EXPECT_EQ(expectedStr, convertToString(ptrCandidate));\n\n#define EXPECT_MY_CLASS_EQ(expectedStr, candidateStr)       \\\n    ptrCandidate = parseAndGetPtr(candidateStr);            \\\n    doWork(ptrCandidate);                                   \\\n    EXPECT_EQ(expectedStr, convertToString(ptrCandidate));\n</code></pre>\n\n<pre><code>void foo(){\n    EXPECT_MY_CLASS_EQ(\"123\",\"abcd\")\n}\nvoid bar(){\n    EXPECT_MY_CLASS_EQ(\"111\",\"aabb\")\n    EXPECT_MY_CLASS_EQ(\"222\",\"ccdd\")\n}\n</code></pre>\n\n<pre><code>void foo(){\n    auto ptrCandidate = parseAndGetPtr(\"abcd\");\n    doWork(ptrCandidate);\n    EXPECT_EQ(\"123\", convertToString(ptrCandidate));\n}\nvoid bar(){\n    auto ptrCandidate = parseAndGetPtr(\"aabb\");\n    doWork(ptrCandidate);\n    EXPECT_EQ(\"111\", convertToString(ptrCandidate));\n\n    /* auto */ ptrCandidate = parseAndGetPtr(\"ccdd\");\n    doWork(ptrCandidate);\n    EXPECT_EQ(\"222\", convertToString(ptrCandidate));\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "decltype", "template-argument-deduction"], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1555554653, "creation_date": 1555554653, "answer_id": 55738337, "question_id": 55736611, "link": "https://stackoverflow.com/questions/55736611/how-to-use-decltype-to-get-vector-elements-type-as-template-argument/55738337#55738337", "title": "How to use decltype to get vector element&#39;s type as template argument", "body": "<blockquote>\n  <p>What would be the right grammar to use decltype here?</p>\n</blockquote>\n\n<p><code>decltype(arr.front())</code> and <code>decltype(arr[0])</code> are all OK but, unfortunately, all of they returning a <strong>reference</strong> to a <strong>const</strong> <code>int</code> (considering that <code>arr</code> is a constant vector)</p>\n\n<p>You have to remove the reference and the const so, by example</p>\n\n<pre><code>std::unordered_map&lt;\n      std::remove_const_t&lt;std::remove_reference_t&lt;decltype(arr.front())&gt;&gt;,\n      decltype(dis)&gt; S;\n</code></pre>\n\n<p>Using the <code>::value_type</code> is better (IMHO) because you avoid the constness, so you have to remove only the reference, so you can write</p>\n\n<pre><code>   std::unordered_map&lt;\n      std::remove_reference_t&lt;decltype(arr)&gt;::value_type,\n      decltype(dis)&gt; S;\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7086220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f73f90f96b1749b8c5498a5bff56fe?s=128&d=identicon&r=PG&f=1", "display_name": "jerron", "link": "https://stackoverflow.com/users/7086220/jerron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55738337, "answer_count": 1, "score": 1, "last_activity_date": 1555554731, "creation_date": 1555538826, "last_edit_date": 1555554731, "question_id": 55736611, "link": "https://stackoverflow.com/questions/55736611/how-to-use-decltype-to-get-vector-elements-type-as-template-argument", "title": "How to use decltype to get vector element&#39;s type as template argument", "body": "<p>Here is part of my code:</p>\n\n<pre><code>int getLength(const vector&lt;int&gt; &amp;arr) {\n    auto  n=arr.size(),dis=n;\n    unordered_map&lt;int,decltype(dis)&gt; S;\n    //...\n}\n</code></pre>\n\n<p>So far so good. Now instead of hardcoded \"<code>int</code>\" for my <code>std::unordered_map</code>, I tried to change it to something like:\n    <code>unordered_map&lt;decltype(arr.front()),decltype(dis)&gt; S;</code>\nor\n    <code>unordered_map&lt;decltype(arr)::value_type,decltype(dis)&gt; S;</code>\nor\n    <code>unordered_map&lt;decltype(arr[0]),decltype(dis)&gt; S;</code></p>\n\n<p>None seems to work. What would be the right grammar to use <code>decltype()</code> here?</p>\n"}, {"tags": ["c++", "llvm"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555537604, "post_id": 55736390, "comment_id": 98150901, "body": "c++ doesn&#39;t support nested function definitions besides lambda function definitions. It&#39;s unclear what you&#39;re after."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1555538095, "post_id": 55736390, "comment_id": 98151051, "body": "That isn&#39;t a supported C++ programming practice.  If you want to access a variable in a parent function, pass a reference to it."}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "edited": false, "score": 0, "creation_date": 1555538202, "post_id": 55736390, "comment_id": 98151082, "body": "I am trying to compile the code in the example(with functions a and b) to llvm code (not sure if that&#39;s what is called), to be compiled with <code>llc</code>. But because llvm is a c like language and doesn&#39;t support nested functions I need another way to make variable <code>x</code> visible and accessible in function <code>b</code>. Global variables would be a way, but I don&#39;t think it is really viable to use them."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1555538373, "post_id": 55736390, "comment_id": 98151117, "body": "@JohnFikioris so this is what actual compilers do: they convert such nested functions into a class with a constructor and a method (being the actual function body). The constructor takes a reference (or value, depends) to the outer variable and stores it in the object. Then the code is transformed into &quot;create object&quot; and &quot;call method&quot; instructions. That&#39;s what you need to implement."}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1555538580, "post_id": 55736390, "comment_id": 98151171, "body": "@freakish Do you have any suggestions on how to do that ?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555538622, "post_id": 55736390, "comment_id": 98151184, "body": "@JohnFikioris You may refer to a lambda capturing variables in such case as mentioned. You cannot change the language parsing fundamentally fpr the llvm frontend."}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1555539008, "post_id": 55736390, "comment_id": 98151290, "body": "@freakish So you are basically saying to pass every outer variable as a parameter to the inner function when called."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1555539425, "post_id": 55736390, "comment_id": 98151377, "body": "@JohnFikioris yes, sort of. Depending on what you need having a separate struct will allow you to store &quot;inline functions&quot; and opens more possibilities. I&#39;ve made my comment into an answer."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1555541104, "post_id": 55736390, "comment_id": 98151754, "body": "I think some Pascal compilers, to support this, did something along the lines of: first make sure that all local variables are &quot;spilled&quot; to the stack in a fixed layout before the inner function is called, then pass a pointer to the outer function&#39;s stack frame as an implicit parameter of the inner function.  (And then for multiple-level nesting of functions, you would need to have some mechanism to chain from one stack frame to an outer layer, or else pass implicit pointers to each outer stack frame as determined by the lexical code structure.)"}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "edited": false, "score": 0, "creation_date": 1555541475, "post_id": 55736390, "comment_id": 98151863, "body": "Yes, my language is kinda like pascal, but I think freakish&#39;s answer is easier to implement."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1555591175, "post_id": 55736390, "comment_id": 98169233, "body": "@JohnFikioris There is another way of dealing with nested functions depending on how your language is designed. For example Python compiles nested functions on the fly. Meaning it stores its body code somewhere and once <code>a()</code> is executed it builds the nested function inside it (and binds all references on the fly). This is arguably simplier. But requires embedding the compiler (possibly only the final IL compiler) inside runtime. You lose some performance plus some optimizations may be impossible with this approach. One of the reasons why most scripting languages are slow."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1555591237, "post_id": 55736390, "comment_id": 98169287, "body": "Also you would have to slightly redesign your language because such functions are no longer easily convertible to llvm functions. They are now (runtime) objects with source code."}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "edited": false, "score": 0, "creation_date": 1555620920, "post_id": 55736390, "comment_id": 98183601, "body": "It&#39;s for my compiler course so I don&#39;t really get a say :P"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "edited": false, "score": 0, "creation_date": 1555538486, "post_id": 55736513, "comment_id": 98151145, "body": "The code I am trying to compile isn&#39;t C++. I am using the LLVM API to create the compiled executable. The language that I want to compile supports nested functions."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "reply_to_user": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "edited": false, "score": 0, "creation_date": 1555538529, "post_id": 55736513, "comment_id": 98151156, "body": "Ah... You have this tagged as a C++ question.  I misread what you were asking."}], "tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": false, "score": 0, "last_activity_date": 1555538141, "creation_date": 1555538141, "answer_id": 55736513, "question_id": 55736390, "link": "https://stackoverflow.com/questions/55736390/llvm-how-to-make-a-nested-function-see-an-outside-functions-variables/55736513#55736513", "title": "LLVM - How to make a nested function see an outside function&#39;s variables", "body": "<p>That isn't a supported capability in C++.</p>\n\n<p>If you are looking to access a variable in this way from a nested or any other function, pass a reference to it. :)</p>\n"}, {"tags": [], "owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "is_accepted": true, "score": 1, "last_activity_date": 1555579643, "last_edit_date": 1555579643, "creation_date": 1555539126, "answer_id": 55736652, "question_id": 55736390, "link": "https://stackoverflow.com/questions/55736390/llvm-how-to-make-a-nested-function-see-an-outside-functions-variables/55736652#55736652", "title": "LLVM - How to make a nested function see an outside function&#39;s variables", "body": "<p>LLVM does support structs, right? So here's what typical compilers do.</p>\n\n<p>You need to create an anonymous struct with fields generated from <strong>every</strong> outer variable you reference. Then you create an anonymous function corresponding to <code>b()</code> that takes that struct as argument and operates on it. Basically you turn <code>b()</code> into a regular top-level function. Finally you transform <code>a()</code> code so that it creates the struct instance and calls the anonymous function. At this point further optimizations are possible. Be prepared: this is not easy at all, possibly a very advanced topic for code transformations.</p>\n\n<p>For example</p>\n\n<pre><code>func a()\n   int x = 1;\n   func b() {\n      return x+1;\n   }\n   return b() + 2;\n}\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>struct tmp {\n    int tmpx;  // reference or value?\n}\nfunc tmp_b(tmp&amp; instance) {\n    instance.tmpx += 1;\n    return instance.tmpx;\n}\nfunc a() {\n    int x = 1;\n    tmp instance(tmpx = x);  // should it go by reference or value?\n    return tmp_b(instance) + 2;\n}\n</code></pre>\n\n<p>As an alternative you can convert <code>b()</code> into <code>b(int x)</code> top-level function. But that approach is less flexible IMO. Or depending on context utilize both approaches, why not.</p>\n\n<p>Note that all of that can probably be simplified if your language supports proper classes with methods and/or operator (in this case call operator) overloading.</p>\n"}], "owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 1, "accepted_answer_id": 55736652, "answer_count": 2, "score": 1, "last_activity_date": 1555579643, "creation_date": 1555537414, "question_id": 55736390, "link": "https://stackoverflow.com/questions/55736390/llvm-how-to-make-a-nested-function-see-an-outside-functions-variables", "title": "LLVM - How to make a nested function see an outside function&#39;s variables", "body": "<p>I am trying to write a compiler for a language that supports nested functions, for example:</p>\n\n<pre><code>func a()\n   int x;\n   func b()\n      int y;\n      {\n       // code of func b - both x and y are visible here\n      }\n   {\n    // code of func a - only x is visible here\n   }\n</code></pre>\n\n<p>I am using LLVM API in c++ to compile the code. My problem is that I don't know how to make variable x visible in function b, since to my knowledge llvm does not support nested function. The way I am declaring variable as of now is this function:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>static AllocaInst *CreateEntryBlockAlloca(Function *TheFunction, const std::string &amp;VarName, Type *T) {\n    IRBuilder&lt;&gt; TmpB(&amp;TheFunction-&gt;getEntryBlock(), TheFunction-&gt;getEntryBlock().begin());\n    return TmpB.CreateAlloca(T, 0, VarName.c_str());\n}\n</code></pre>\n\n<p>As shown in the llvm tutorial <a href=\"https://llvm.org/docs/tutorial/LangImpl07.html#adjusting-existing-variables-for-mutation\" rel=\"nofollow noreferrer\">https://llvm.org/docs/tutorial/LangImpl07.html#adjusting-existing-variables-for-mutation</a>.\nWhen using this declaration and trying to use an outside variable in a nested function this error pops up: <em>Instruction does not dominate all uses!</em>.<br>\nIs there a way to fix this?</p>\n"}, {"tags": ["c++", "constructor", "variadic-functions"], "comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1555536288, "post_id": 55736138, "comment_id": 98150463, "body": "You&#39;re using c-style variadic arguments, which are a runtime construct that is very unsafe to use and very limited. You really should prefer to use <a href=\"https://en.wikipedia.org/wiki/Variadic_template\" rel=\"nofollow noreferrer\">variadic templates</a> for this instead of C-style variadic functions. Could you also explain what you need this for? Your code only shows one call to the <code>create</code> function; it would help to see more examples of calls that you want to make.."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 4, "last_activity_date": 1555536579, "creation_date": 1555536579, "answer_id": 55736241, "question_id": 55736138, "link": "https://stackoverflow.com/questions/55736138/variadic-function-and-copy-pasting-these-parameters-like-we-can-in-a-macro/55736241#55736241", "title": "Variadic function and copy pasting these parameters (like we can in a macro)", "body": "<p>The correct way of doing this in C++ is by using <a href=\"https://en.wikipedia.org/wiki/Variadic_template\" rel=\"nofollow noreferrer\"><em>variadic templates</em></a>, which are a language construct that allow you to manipulate parameter packs. E.g.</p>\n\n<pre><code>template &lt;typename... Ts&gt;\nObject createObject(Ts&amp;&amp;... xs)\n{\n    return Object{std::forward&lt;Ts&gt;(xs)...};\n}\n\ncreateObject(1, 'a'); // as if `Object{1, 'a'}`\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 7281468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JCfThOSj9Uo/AAAAAAAAAAI/AAAAAAAAAHo/YDkpSbprKXA/photo.jpg?sz=128", "display_name": "Nyck", "link": "https://stackoverflow.com/users/7281468/nyck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555537966, "creation_date": 1555536046, "last_edit_date": 1555537966, "question_id": 55736138, "link": "https://stackoverflow.com/questions/55736138/variadic-function-and-copy-pasting-these-parameters-like-we-can-in-a-macro", "title": "Variadic function and copy pasting these parameters (like we can in a macro)", "body": "<p>I want a variadic function and copy-paste these parameters inside the code, like in a macro. In a macro we would simply put <code>__VA_ARGS__</code> where we want them to be copy-pasted.</p>\n\n<p>Actually, I want these parameters to be values for variables, which then will be put in an object declaration (calling constructor using these values).</p>\n\n<p>Look:</p>\n\n<pre><code>struct Object {\n    std::string name;\n    int id;\n\n    Object(std::string name, int id) {\n        this-&gt;name = name;\n        this-&gt;id = id;\n    }\n\n};\n\nvoid create(...) {\n    Object object(VA_ARGS);\n}\n\nint main() {\n    create(\"Object1\", 1);\n}\n</code></pre>\n\n<p>Of course that in this code nothing really happens, as the object goes out of scope, but it's just to show what I mean.</p>\n\n<p>Any way to do this?</p>\n"}, {"tags": ["c++", "crypto++"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1555536477, "post_id": 55736126, "comment_id": 98150534, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/26145776/608639\">std::string to SecByteBlock conversion</a>. Also see <a href=\"https://stackoverflow.com/q/31929531/608639\">How to convert SecByteBlock to string?</a>"}, {"owner": {"reputation": 51, "user_id": 10951969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1563dc0e2cfd32cd503eb8546b7594b6?s=128&d=identicon&r=PG&f=1", "display_name": "GoQuestion", "link": "https://stackoverflow.com/users/10951969/goquestion"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1555545354, "post_id": 55736126, "comment_id": 98152626, "body": "Thanks! That should work!"}], "owner": {"reputation": 51, "user_id": 10951969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1563dc0e2cfd32cd503eb8546b7594b6?s=128&d=identicon&r=PG&f=1", "display_name": "GoQuestion", "link": "https://stackoverflow.com/users/10951969/goquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1555545363, "answer_count": 0, "score": 1, "last_activity_date": 1555551992, "creation_date": 1555535949, "last_edit_date": 1555551992, "question_id": 55736126, "link": "https://stackoverflow.com/questions/55736126/how-to-assign-a-stdstring-key-value-to-the-secbyteblock", "closed_reason": "Duplicate", "title": "How to assign a std::string key value to the SecByteBlock", "body": "<p>I am using crypto++ AES to encrypt and decrypt.</p>\n\n<p>I have the key stored as string type in database for some reason.</p>\n\n<p>How do I assign this key to the AES SecByteBlock key or initialize the AES key with this value instead of some random generated blocks.</p>\n\n<pre><code>std::string key_fromDB = \"12dfre314?//1afsfa\";\nAutoSeededRandomPool prng;\nbyte iv[ AES::BLOCKSIZE ];\nprng.GenerateBlock( iv, sizeof(iv) );\nSecByteBlock temp_key(AES::DEFAULT_KEYLENGTH);\nprng.GenerateBlock( temp_key, temp_key.size() );\n\ntry \n{\n    CBC_Mode&lt; AES &gt;::Decryption d;\n    d.SetKeyWithIV(temp_key , temp_key.size(), iv );\n\n    // The StreamTransformationFilter removes\n    //  padding as required.\n    StringSource ss( cipher, true,\n        new StreamTransformationFilter( d,\n            new StringSink( recovered )\n        ) // StreamTransformationFilter\n    ); // StringSource\n\n    std::cout &lt;&lt; \"recovered text: \" &lt;&lt; recovered &lt;&lt; std::endl;\n}\ncatch ( const CryptoPP::Exception&amp; e)\n{\n    std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17", "dynamic-import"], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 4443495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3fQpF.png?s=128&g=1", "display_name": "original.roland", "link": "https://stackoverflow.com/users/4443495/original-roland"}, "edited": false, "score": 0, "creation_date": 1555565434, "post_id": 55736167, "comment_id": 98156522, "body": "Ah, I see. Note that you should change the order of NTAPI &amp; NTSTATUS, because this way it&#39;s failing. Else, it&#39;s cool :)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 533, "user_id": 4443495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3fQpF.png?s=128&g=1", "display_name": "original.roland", "link": "https://stackoverflow.com/users/4443495/original-roland"}, "edited": false, "score": 1, "creation_date": 1555573920, "post_id": 55736167, "comment_id": 98159945, "body": "@original.roland: order changed."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 6, "last_activity_date": 1555573876, "last_edit_date": 1555573876, "creation_date": 1555536166, "answer_id": 55736167, "question_id": 55736098, "link": "https://stackoverflow.com/questions/55736098/why-traditional-getprocaddress-to-stdfunction-is-not-working-straightforward/55736167#55736167", "title": "Why traditional GetProcAddress to std::function is not working straightforward", "body": "<p><code>std::function</code> takes signature as template parameter, not pointer.</p>\n\n<p>So it should be:</p>\n\n<pre><code>using fn_NtAllocateVirtualMemory = NTSTATUS NTAPI (\n        HANDLE      ProcessHandle,\n        PVOID*      BaseAddress,\n        ULONG_PTR   ZeroBits,\n        PSIZE_T     RegionSize,\n        ULONG       AllocationType,\n        ULONG       Protect\n    );\n\nint main()\n{\n    std::function&lt;fn_NtAllocateVirtualMemory&gt; myFn(\n        reinterpret_cast&lt;fn_NtAllocateVirtualMemory*&gt;(0xDEADBABE));\n}\n</code></pre>\n"}], "owner": {"reputation": 533, "user_id": 4443495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3fQpF.png?s=128&g=1", "display_name": "original.roland", "link": "https://stackoverflow.com/users/4443495/original-roland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 55736167, "answer_count": 1, "score": 0, "last_activity_date": 1555573876, "creation_date": 1555535848, "question_id": 55736098, "link": "https://stackoverflow.com/questions/55736098/why-traditional-getprocaddress-to-stdfunction-is-not-working-straightforward", "title": "Why traditional GetProcAddress to std::function is not working straightforward", "body": "<p>As in the title I'd like to convert GetProcAddress into std::function. Yes, there are multiple solutions in stack overflow, but none actually explains why those workarounds are needed. I can't really understand the exact error message and why it happens. The sample source is simple:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;Windows.h&gt;\n\nusing fn_NtAllocateVirtualMemory = NTSTATUS (NTAPI*)(\n        HANDLE      ProcessHandle,\n        PVOID*      BaseAddress,\n        ULONG_PTR   ZeroBits,\n        PSIZE_T     RegionSize,\n        ULONG       AllocationType,\n        ULONG       Protect\n    );\n\nint main()\n{\n    std::function&lt;fn_NtAllocateVirtualMemory&gt; myFn(reinterpret_cast&lt;fn_NtAllocateVirtualMemory&gt;(0xDEADBABE));\n}\n</code></pre>\n\n<p>( <a href=\"https://godbolt.org/z/FhaeLA\" rel=\"nofollow noreferrer\">https://godbolt.org/z/FhaeLA</a> )</p>\n\n<p>So, my question is why is it wrong?</p>\n\n<hr>\n\n<p>Related:\nI also tried this:\n<a href=\"https://stackoverflow.com/questions/13558875/function-pointer-to-multiple-argument-c11-stdfunction-templating-getprocadd\">Function pointer to multiple argument C++11 std::function: Templating GetProcAddress</a>\nBut it also failed to compile ( <a href=\"https://godbolt.org/z/1wSDZj\" rel=\"nofollow noreferrer\">https://godbolt.org/z/1wSDZj</a> )</p>\n\n<p>I've also found this topic:\n<a href=\"https://stackoverflow.com/questions/15249465/c-dynamically-load-arbitrary-function-from-dll-into-stdfunction\">C++ Dynamically load arbitrary function from DLL into std::function</a>\nWhich might work <em>(I haven't yet tried, I'll do it soon)</em> but I'm trying to understand why this kind of cryptic looking huge boilerplate is necessary.</p>\n\n<hr>\n\n<p>Notes:</p>\n\n<ul>\n<li>Obviously 0xDEADBEEF is going to be replaced with the necessary address.</li>\n<li>I'm using Visual Studio 2019 to compile, but obviously any generic answer is welcomed</li>\n</ul>\n"}, {"tags": ["c++", "arduino", "raspberry-pi", "i2c", "sensors"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555534955, "post_id": 55735757, "comment_id": 98149975, "body": "Totally unrelated to your problem, but the size you pass to the <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>snprintf</code></a> function is <i>including</i> the terminator. Therefore you can pass e.g. <code>sizeof filename</code> instead of using a <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\">magic number</a>. Also, if you program in C++, why don&#39;t you use <code>std::string</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9849141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c7191fe1b1de51a33bcfe684ab759f7?s=128&d=identicon&r=PG", "display_name": "NicolasColsoul", "link": "https://stackoverflow.com/users/9849141/nicolascolsoul"}, "edited": false, "score": 0, "creation_date": 1555594642, "post_id": 55738392, "comment_id": 98171298, "body": "Thanks for your answer. I thing we are in the right direction. I am able to connect to the sensors because ioctl is showing no error. But I can&#39;t read/write to sensor regs. Here is the initialize code of each sensor (first step of doTheSameAsOneOnlyVL680). I have edited my question."}, {"owner": {"reputation": 31, "user_id": 9849141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c7191fe1b1de51a33bcfe684ab759f7?s=128&d=identicon&r=PG", "display_name": "NicolasColsoul", "link": "https://stackoverflow.com/users/9849141/nicolascolsoul"}, "edited": false, "score": 0, "creation_date": 1555595949, "post_id": 55738392, "comment_id": 98172176, "body": "I change in my I2C_init() function file to file2 for the test and there it says unable to reach laser... I am bad with my channel select."}, {"owner": {"reputation": 9874, "user_id": 2577244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461b49b3ad25d7f49ec7b4b253dce1b4?s=128&d=identicon&r=PG", "display_name": "Alex Baban", "link": "https://stackoverflow.com/users/2577244/alex-baban"}, "reply_to_user": {"reputation": 31, "user_id": 9849141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c7191fe1b1de51a33bcfe684ab759f7?s=128&d=identicon&r=PG", "display_name": "NicolasColsoul", "link": "https://stackoverflow.com/users/9849141/nicolascolsoul"}, "edited": false, "score": 0, "creation_date": 1555610655, "post_id": 55738392, "comment_id": 98179656, "body": "I&#39;m not clear..., without the multiplexer, are you able to write/read to/from one sensor? If not, I think you&#39;ll need to get that working before connecting more sensors."}, {"owner": {"reputation": 31, "user_id": 9849141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c7191fe1b1de51a33bcfe684ab759f7?s=128&d=identicon&r=PG", "display_name": "NicolasColsoul", "link": "https://stackoverflow.com/users/9849141/nicolascolsoul"}, "edited": false, "score": 0, "creation_date": 1555682713, "post_id": 55738392, "comment_id": 98200658, "body": "Yes. I can easily."}, {"owner": {"reputation": 9874, "user_id": 2577244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461b49b3ad25d7f49ec7b4b253dce1b4?s=128&d=identicon&r=PG", "display_name": "Alex Baban", "link": "https://stackoverflow.com/users/2577244/alex-baban"}, "reply_to_user": {"reputation": 31, "user_id": 9849141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c7191fe1b1de51a33bcfe684ab759f7?s=128&d=identicon&r=PG", "display_name": "NicolasColsoul", "link": "https://stackoverflow.com/users/9849141/nicolascolsoul"}, "edited": false, "score": 0, "creation_date": 1555692533, "post_id": 55738392, "comment_id": 98204703, "body": "Maybe try I2C_SLAVE_FORCE instead of I2C_SLAVE"}], "tags": [], "owner": {"reputation": 9874, "user_id": 2577244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461b49b3ad25d7f49ec7b4b253dce1b4?s=128&d=identicon&r=PG", "display_name": "Alex Baban", "link": "https://stackoverflow.com/users/2577244/alex-baban"}, "is_accepted": false, "score": 1, "last_activity_date": 1555555251, "creation_date": 1555555251, "answer_id": 55738392, "question_id": 55735757, "link": "https://stackoverflow.com/questions/55735757/tca9548a-i2c-multiplexer-c-integration/55738392#55738392", "title": "TCA9548a (I2C multiplexer) C++ integration", "body": "<p>When  <code>ioctl(file, I2C_SLAVE, addr)</code> runs you're saying <strong>\"On I2C talk to the multiplexer.\"</strong></p>\n\n<p>Then, with </p>\n\n<p><code>buf[0] = 0x01; // to select channel 0\nwrite(file, buf, 10);</code></p>\n\n<p>you make the multiplexer connect the VL680 that's connected to multiplexer first port to the I2C bus.</p>\n\n<p>After you talked to the multiplexer with </p>\n\n<p><code>write(file, buf, 10);</code> </p>\n\n<p>and before you talk to the distance sensor with</p>\n\n<p><code>doTheSameAsOneOnlyVL680();</code> </p>\n\n<p>you need to run some code in order to say <strong>\"On I2C talk to the distance sensor.\"</strong></p>\n\n<p>Something like:</p>\n\n<pre><code>if(ioctl(file, I2C_SLAVE, vl680Addr) &lt; 0) \n{\n    printf(\"Fail to reach distance sensor \\n\");\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>, where <code>vl680Addr</code> is the address (you'll need to define that) for the VL680 laser distance sensor, </p>\n"}], "owner": {"reputation": 31, "user_id": 9849141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c7191fe1b1de51a33bcfe684ab759f7?s=128&d=identicon&r=PG", "display_name": "NicolasColsoul", "link": "https://stackoverflow.com/users/9849141/nicolascolsoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1555594832, "creation_date": 1555534137, "last_edit_date": 1555594832, "question_id": 55735757, "link": "https://stackoverflow.com/questions/55735757/tca9548a-i2c-multiplexer-c-integration", "title": "TCA9548a (I2C multiplexer) C++ integration", "body": "<p>I have 4 VL680 laser distance sensors to use with \u00e0 Raspberry. It is a I2C bus compatible sensor but we can't change the address. So, I use the TCA9548a Adafruit board I2C multiplexer. I can run only one VL680 directly on my I2C bus but it won't work trough the multiplexer. Datasheet is not clear and I find only code for Arduino or bad Python example.</p>\n\n<p>Here I am :</p>\n\n<pre><code>char filename[20];\nconst int adapter_nr = 1;\nsnprintf(filename, 19, \"/dev/i2c-%d\", adapter_nr);\nfile = open(filename, O_RDWR);\nif (file &lt; 0) \n{\n    printf(\"Unable to connect reach I2C bus \\n\");\n    exit(EXIT_FAILURE);\n}\n\n// multiplex address\nconst int addr = 0x70;\n\nif(ioctl(file, I2C_SLAVE, addr) &lt; 0) \n{\n    printf(\"Fail to reach multiplex laser \\n\");\n    exit(EXIT_FAILURE);\n}\n\nchar buf[10];\nbuf[0] = 0x01; // to select channel 0\nwrite(file, buf, 1);\nI2C_init();\n\ndoTheSameAsOneOnlyVL680();\n...\n</code></pre>\n\n<p>I don't know how I must do and nothing help. Is that the way to select the channel ? How write and read then ?</p>\n\n<pre><code>void I2C_init()\n{   \n    const int addr = 0x29;\n\n    if(ioctl(file, I2C_SLAVE, addr) &lt; 0) \n    {\n        printf(\"Fail to reach laser \\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    if(read_byte(file, 0x000) != 0xB4)\n    {\n        printf(\"Problem with VL6180X\\n\");\n        //exit(EXIT_FAILURE);\n    }\n\n    int setup = read_byte(file, 0x016);\n\n    if(setup == 1)\n    {\n        printf(\"Init all registers \\n\");\n        write_byte(file, 0x0207, 0x01);\n                ...\n\n    }\n    else\n    {\n        printf(\"Fail \\n\");\n    }\n\n    set_scaling(file, 1);\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1555533627, "post_id": 55735634, "comment_id": 98149512, "body": "<code>p[x+a]</code> is a row in your 2D array and you are trying to assign a single number. What are you trying to do here?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1555533639, "post_id": 55735634, "comment_id": 98149518, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Concerning your problem, also extract a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Further, one note: Check the description of tags that you apply to your question, in particular the &quot;c&quot; tag is misplaced here!"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1555533783, "post_id": 55735634, "comment_id": 98149579, "body": "Also read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> for tips on debugging your code."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1555533863, "post_id": 55735634, "comment_id": 98149609, "body": "Maybe you want <code>p[x+a][y] = 1</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1555533807, "post_id": 55735676, "comment_id": 98149589, "body": "A 2d <code>int</code> array is not a <code>int**</code>.  They are completely different things.  A 2d <code>int</code> array decays into a <code>int(*)[N]</code>"}], "tags": [], "owner": {"reputation": 39, "user_id": 6752411, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154505376933809/picture?type=large", "display_name": "Netanel Gonen", "link": "https://stackoverflow.com/users/6752411/netanel-gonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1555533710, "creation_date": 1555533710, "answer_id": 55735676, "question_id": 55735634, "link": "https://stackoverflow.com/questions/55735634/incompatible-types-of-assignment-of-int-to-int-x/55735676#55735676", "title": "incompatible types of assignment of int to int [x]", "body": "<p>When you are defining a 2D array the start point (the array name) is actually int** \nSo, when you dereference once with p[x-a] the type is actually int* and not int.\ntherefore if you are trying to set this with an int variable you will get 'incompatible types'</p>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "is_accepted": false, "score": 2, "last_activity_date": 1555533772, "creation_date": 1555533772, "answer_id": 55735685, "question_id": 55735634, "link": "https://stackoverflow.com/questions/55735634/incompatible-types-of-assignment-of-int-to-int-x/55735685#55735685", "title": "incompatible types of assignment of int to int [x]", "body": "<p><code>p[5][5]</code> declares a two dimensional array, or matrix, as you state. When you want to insert a value, you have to specify the location in both dimensions, e.g. <code>p[1][2]</code>. Currently you only specify one dimension with <code>p[x+a]</code>, which refers to a row in the matrix, which can also be comprehended as a pointer to a 1-dimensional matrix. Thus, the error about assigning an <code>int</code> to an <code>int[5]</code>, because you are attempting to assign an <code>int</code> to a row in the matrix.</p>\n"}], "owner": {"reputation": 9, "user_id": 11098500, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0kkPV-TFVtI/AAAAAAAAAAI/AAAAAAAAAXI/gIN73neYmD0/photo.jpg?sz=128", "display_name": "robertkq", "link": "https://stackoverflow.com/users/11098500/robertkq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555533772, "creation_date": 1555533475, "last_edit_date": 1555533653, "question_id": 55735634, "link": "https://stackoverflow.com/questions/55735634/incompatible-types-of-assignment-of-int-to-int-x", "title": "incompatible types of assignment of int to int [x]", "body": "<p>So there is a matrix of n lines and m columns, x y are coordonates for a the tree that was first on fire. Figure out how many days until the hole forest is burnt down.</p>\n\n<p>I think I got the code down but there is a problem with it.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    int n,m,p[5][5],x,y,z=1,c,a=1,b=1;\n    cout&lt;&lt;\"Cate linii de copaci sunt:\";\n    cin&gt;&gt;n;\n    cout&lt;&lt;\"Cate coloane de copaci sunt:\";\n    cin&gt;&gt;m;\n    cout&lt;&lt;\"Coordonata X a copacului de la care a izbucnit focul:\";\n    cin&gt;&gt;x;\n    cout&lt;&lt;\"Coordonata Y a copacului de la care a izbucnit focul:\";\n    cin&gt;&gt;y;\n    p[x][y]=1;\n        while (c!=0) {\n            c=0;\n            if (b!=0) {\n                    b=0;\n            if (x+a&lt;=n) {\n                 p[x+a]=1;\n                 b++;\n            }\n             if (x-a&lt;=n) {\n                 p[x-a]=1;\n                 b++;\n            }\n             if (y+a&lt;=m) {\n                 p[x+a]=1;\n                 b++;\n            }\n             if (y-a&lt;=m) {\n                 p[x-a]=1;\n                 b++;\n            }\n            c=1;\n            z++;\n            }\n            a++;\n        }\n        cout&lt;&lt;\"In total a durat \"&lt;&lt;z&lt;&lt;\" zile ca sa arda toata padurea.\";\n    return 0;\n\n}\n\n</code></pre>\n\n<p>At every if p[x/y -/+ a]=1 there is this error:\nincompatible types in assignment of int to int[5]</p>\n\n<p>If anyone could help me understand what have I done wrong for this error to show up. And also if there is a better solution than the one I have wrote I would appriciate to see it.\nI know it is probably an easy error but I'm still at the beginning of my coding career.</p>\n\n<p>Thanks for helping/reading! Have a nice day !</p>\n\n<p>When I declared the Matrix.. if If I change the columns and lines to another value, the error will show up incompatible types in assignment of int to int[that value that I've put in declaration]</p>\n\n<p>Uhm, haven't really expected anything because I am learning but the results I was hoping for were to not have this error, maybe a different error I would have known to solve but never saw this one.</p>\n"}, {"tags": ["c++", "linux", "embedded", "embedded-linux", "spi"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 3071872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7d735f68601345608c3f3c8583eba6?s=128&d=identicon&r=PG&f=1", "display_name": "Eskimoalva", "link": "https://stackoverflow.com/users/3071872/eskimoalva"}, "edited": false, "score": 0, "creation_date": 1555942080, "post_id": 55794550, "comment_id": 98260290, "body": "The reason my FPGA didn&#39;t like it is because the FPGA was expecting mode 0, not mode 3"}], "tags": [], "owner": {"reputation": 197, "user_id": 3071872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7d735f68601345608c3f3c8583eba6?s=128&d=identicon&r=PG&f=1", "display_name": "Eskimoalva", "link": "https://stackoverflow.com/users/3071872/eskimoalva"}, "is_accepted": true, "score": 0, "last_activity_date": 1555936675, "creation_date": 1555936675, "answer_id": 55794550, "question_id": 55735574, "link": "https://stackoverflow.com/questions/55735574/how-to-fix-an-spi-driver-that-always-fails-validation-in-the-linux-kernel-spi-dr/55794550#55794550", "title": "How to fix an SPI driver that always fails validation in the Linux kernel SPI driver", "body": "<p>So I am not sure why this is required, but this version of the driver appears to work. I added all the extra ioctls that were in <a href=\"https://armbedded.taskit.de/node/318\" rel=\"nofollow noreferrer\">this example.</a>\n While my FPGA still doesn't like the output (even though it worked fine with 3.14), it looks correct on the logic analyzer and via a protocol analyzer.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"os/drivers/buses/linuxos/spi_driver.h\"\n\n#include &lt;fcntl.h&gt;\n#include &lt;sstream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;linux/spi/spidev.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\nnamespace os\n{\nnamespace drivers\n{\nnamespace buses\n{\nnamespace linuxos\n{\nspi_driver::spi_driver(int bus_id, int cs_index, std::uint32_t speed_bps) :\n    m_speed_bps(speed_bps)\n{\n    std::stringstream descriptor;\n    descriptor &lt;&lt; \"/dev/spidev\" &lt;&lt; bus_id &lt;&lt; '.' &lt;&lt; cs_index;\n    m_device_file_descriptor = descriptor.str();\n}\n\nbool spi_driver::transfer(const unsigned char *out_data, unsigned char *in_data, size_t size_in_bytes)\n{\n    int spi_file_handle = open(m_device_file_descriptor.c_str(), O_RDWR);\n    bool success = (spi_file_handle &gt;= 0);\n\n    const std::uint8_t mode = 3;\n    const std::uint8_t bits = 8;\n    int ioctl_return = 0;\n\n    if (success)\n    {\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_WR_MODE, &amp;mode);\n        if (ioctl_return != 0)\n            success = false;\n\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_RD_MODE, &amp;mode);\n        if (ioctl_return != 0)\n            success = false;\n\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_WR_BITS_PER_WORD, &amp;bits);\n        if (ioctl_return != 0)\n            success = false;\n\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_RD_BITS_PER_WORD, &amp;bits);\n        if (ioctl_return != 0)\n            success = false;\n\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_WR_MAX_SPEED_HZ, &amp;m_speed_bps);\n        if (ioctl_return != 0)\n            success = false;\n\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_RD_MAX_SPEED_HZ, &amp;m_speed_bps);\n        if (ioctl_return != 0)\n            success = false;\n    }\n\n    if (success)\n    {\n        struct spi_ioc_transfer tr;\n        tr.tx_buf = reinterpret_cast&lt;unsigned long&gt;(out_data);\n        tr.rx_buf = reinterpret_cast&lt;unsigned long&gt;(in_data);\n        tr.len = size_in_bytes;\n        tr.delay_usecs = 0;\n        tr.speed_hz = 0;\n        tr.bits_per_word = 0;\n\n        ioctl_return = ioctl(spi_file_handle, SPI_IOC_MESSAGE(1), &amp;tr);\n        success = (ioctl_return != 1);\n    }\n\n    close(spi_file_handle);\n\n    return success;\n}\n}\n}\n}\n}\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 3071872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7d735f68601345608c3f3c8583eba6?s=128&d=identicon&r=PG&f=1", "display_name": "Eskimoalva", "link": "https://stackoverflow.com/users/3071872/eskimoalva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 55794550, "answer_count": 1, "score": 2, "last_activity_date": 1555936675, "creation_date": 1555533163, "last_edit_date": 1555590270, "question_id": 55735574, "link": "https://stackoverflow.com/questions/55735574/how-to-fix-an-spi-driver-that-always-fails-validation-in-the-linux-kernel-spi-dr", "title": "How to fix an SPI driver that always fails validation in the Linux kernel SPI driver", "body": "<p>I am running embedded Linux (4.14.16) built with Yocto (Pyro).  I am running on a custom board that has an i.MX6DL and the SPI is connected to an FPGA (a Xilinx Artix 7).  I am currently writing a class that is part of an abstraction layer, so this code sits on top of the Linux drivers.  It isn't a Linux device driver.  The SPI works; I can program the FPGA with a shell script, and see the SPI traffic if echo data into /dev/spi1.0 (the FPGA brings out the SPI to a header, which I have an analyzer hooked up to).</p>\n\n<p>The issue is when I use my driver to try to read registers in the FPGA, it isn't sending anything; the SPI transfer doesn't happen.  </p>\n\n<p>I dug into the spidev and spi drivers in Linux a little bit, and I am seeing it fail the <code>__spi_validate</code> call in drivers/spi/spi.c right under the <code>/* check transfer rx_nbits */</code> comment.  What controls those bits?  Everything on our board is single data bit per clock, we have no quad-spi.</p>\n\n<p>Here is the code in question:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"os/drivers/buses/linuxos/spi_driver.h\"\n\n#include &lt;fcntl.h&gt;\n#include &lt;sstream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;linux/spi/spidev.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\nnamespace os\n{\nnamespace drivers\n{\nnamespace buses\n{\nnamespace linuxos\n{\nspi_driver::spi_driver(int bus_id, int cs_index, std::uint32_t speed_bps) :\n    m_speed_bps(speed_bps)\n{\n    std::stringstream descriptor;\n    descriptor &lt;&lt; \"/dev/spidev\" &lt;&lt; bus_id &lt;&lt; '.' &lt;&lt; cs_index;\n    m_device_file_descriptor = descriptor.str();\n}\n\nbool spi_driver::transfer(const unsigned char *out_data, unsigned char *in_data, size_t size_in_bytes)\n{\n    int spi_file_handle = open(m_device_file_descriptor.c_str(), O_RDWR);\n    bool success = (spi_file_handle &gt;= 0);\n\n    if (success)\n    {\n        printf(\"spidev opened\\n\");\n        struct spi_ioc_transfer transfer_parameters;\n        transfer_parameters.tx_buf = reinterpret_cast&lt;unsigned long&gt;(out_data);\n        transfer_parameters.rx_buf = reinterpret_cast&lt;unsigned long&gt;(in_data);\n        transfer_parameters.len = size_in_bytes;\n        transfer_parameters.speed_hz = m_speed_bps;\n        transfer_parameters.bits_per_word = 0;\n        // transfer_parameters.cs_change = 0;\n        // transfer_parameters.delay_usecs = 0;\n\n        int ioctl_return = ioctl(spi_file_handle, SPI_IOC_MESSAGE(1), &amp;transfer_parameters);\n\n        printf(\"spidev ioctl returned %d\\n\", ioctl_return);\n\n        success = (ioctl_return &gt; 0);\n\n        printf(\"Received data: \");\n        for (unsigned int i = 0; i &lt; size_in_bytes; i++)\n        {\n            printf(\"%02x \", in_data[i]);\n        }\n        printf(\"\\n\");\n    }\n\n    close(spi_file_handle);\n\n    return success;\n}\n}\n}\n}\n}\n</code></pre>\n\n<p>I am not sure if it is relevant (the SPI appears to work...) but here is the SPI part of the device tree.</p>\n\n<pre><code>&amp;ecspi2 {\n    cs-gpios = &lt;&amp;gpio5 12 GPIO_ACTIVE_HIGH&gt;;\n    pinctrl-names = \"default\";\n    pinctrl-0 = &lt;&amp;pinctrl_ecspi2 &amp;pinctrl_ecspi2_cs&gt;;\n    status = \"okay\";\n\n    simulator-fpga {\n        compatible = \"mi,simulator-fpga\";\n        spi-max-frequency = &lt;8000000&gt;;\n        reg = &lt;0&gt;;\n    };\n};\n</code></pre>\n\n<p>The <em>mi,simulator-fpga</em> has been added to the generic spidev driver's compatible string, since it prints an error if you use spidev directly, but it is the generic spidev device.</p>\n\n<p>I did try just using the Linux read and write functions, which worked (I saw the traffic on the SPI analyzer), but I need full duplex transfers which can't be done via that method.</p>\n\n<p>Edit: In case anyone is wondering what those printf statements print out, here is what I get from those:  </p>\n\n<pre><code>spidev opened\nspidev ioctl returned -1\nReceived data: 00 00 00 00 00 00 00 00\n</code></pre>\n\n<p>The Received data is the correct length for the desired message being sent.  I am not sure why this is getting -1 for a return value, the error thrown in spi.c in the kernel is -22 (EINVAL/Invalid argument) as noted above.</p>\n"}, {"tags": ["c++", "vector", "iostream"], "comments": [{"owner": {"reputation": 16707, "user_id": 341065, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8e57fe4b0f7381288a8e1e4c6cd77a8e?s=128&d=identicon&r=PG", "display_name": "wilx", "link": "https://stackoverflow.com/users/341065/wilx"}, "edited": false, "score": 0, "creation_date": 1555532595, "post_id": 55735410, "comment_id": 98149128, "body": "The comma is either after every element but the last one, or before every element but the first one. Pick one of these conditions and use it to print or not print the comma."}, {"owner": {"reputation": 866, "user_id": 7607594, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OyzH_J0Nigs/AAAAAAAAAAI/AAAAAAAAAFg/tWm2BVaSBwY/photo.jpg?sz=128", "display_name": "Jorge Omar Medra", "link": "https://stackoverflow.com/users/7607594/jorge-omar-medra"}, "edited": false, "score": 0, "creation_date": 1555532788, "post_id": 55735410, "comment_id": 98149203, "body": "Try this, using a vairable as flag to indentify when add a comma: <code>int bCount = 0;</code>  ...  <code>cout &lt;&lt;  (bCount++ &gt; 0 ? &quot;, &quot; : &quot;&quot;)  &lt;&lt; *i</code>."}, {"owner": {"reputation": 866, "user_id": 7607594, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OyzH_J0Nigs/AAAAAAAAAAI/AAAAAAAAAFg/tWm2BVaSBwY/photo.jpg?sz=128", "display_name": "Jorge Omar Medra", "link": "https://stackoverflow.com/users/7607594/jorge-omar-medra"}, "edited": false, "score": 0, "creation_date": 1555533104, "post_id": 55735410, "comment_id": 98149317, "body": "Or, like someone answered:  <code>cout &lt;&lt; (i == vi3.begin()? &quot;&quot; : &quot;, &quot;) &lt;&lt; *i</code>"}, {"owner": {"reputation": 17031, "user_id": 185915, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/207045374ab195353388d9fcc77af9c5?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/185915/chad"}, "edited": false, "score": 0, "creation_date": 1555534605, "post_id": 55735410, "comment_id": 98149863, "body": "<code>boost::algorithm::join</code> will do this for you, if you don&#39;t mind bringing it in"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555535036, "post_id": 55735410, "comment_id": 98150006, "body": "<i>@rajkod</i> I formatted your code for better readability, but there&#39;s a lot of completely irrelevant code you should consider to remove. Make it a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>  focussing on the problem you want to resolve."}], "answers": [{"comments": [{"owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "edited": false, "score": 1, "creation_date": 1555536105, "post_id": 55735513, "comment_id": 98150378, "body": "If performance is a concern, the if can be omitted, and all elements except the last one can be printed using that loop. Then the last one can be printed outside the loop without the comma."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "edited": false, "score": 0, "creation_date": 1555536365, "post_id": 55735513, "comment_id": 98150486, "body": "@SenselessCoder I seriously doubt this would improve performance in a significant manner."}, {"owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "edited": false, "score": 0, "creation_date": 1555536681, "post_id": 55735513, "comment_id": 98150600, "body": "It could have <i>some</i> impact with very large element sizes."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "edited": false, "score": 0, "creation_date": 1555536908, "post_id": 55735513, "comment_id": 98150667, "body": "@SenselessCoder You probably meant an impact regarding <i>large sizes</i> of the collection, not the elements themselves. Even then we can use <i>branch prediction hints</i> for the compiler to optimize."}, {"owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "edited": false, "score": 0, "creation_date": 1555537043, "post_id": 55735513, "comment_id": 98150716, "body": "You&#39;re right, I made a typo there. Compiler would very likely optimize this, I forgot about it. I&#39;ll test this to see if it does."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "edited": false, "score": 0, "creation_date": 1555537286, "post_id": 55735513, "comment_id": 98150803, "body": "@SenselessCoder As mentioned it&#39;s a really common idiom I am using in various programming languages all the time. I&#39;ve never been stuck in a performance problem doing so so far."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555538886, "post_id": 55735513, "comment_id": 98151248, "body": "If the cost of printing doesn&#39;t make the cost of the if not first check insignificant, whoever wrote the print routines deserves a raise and free drinks at the pub."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555539029, "post_id": 55735513, "comment_id": 98151296, "body": "@user4581301 <i>&quot;free drinks at the pub&quot;</i> What&#39;s your favorite place? :-D"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555542882, "post_id": 55735513, "comment_id": 98152184, "body": "<a href=\"http://oceanparkpizza.com/\" rel=\"nofollow noreferrer\">oceanparkpizza.com</a> Not much of a drinker, mind you. I&#39;m there for the lasagna."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 6, "last_activity_date": 1555535624, "last_edit_date": 1555535624, "creation_date": 1555532930, "answer_id": 55735513, "question_id": 55735410, "link": "https://stackoverflow.com/questions/55735410/removing-a-comma-from-a-c-output/55735513#55735513", "title": "Removing a comma from a c++ output", "body": "<p>Rather than <em>removing</em> the simplest way is just to print commas only for other values than the first:</p>\n\n<pre><code>for (auto i = vi3.begin(); i != vi3.end(); ++i) {\n    if(i != vi3.begin()) {\n        cout &lt;&lt; \", \";\n    }\n    cout &lt;&lt; *i;\n}\n</code></pre>\n\n<p>I am using this idiom regularly to format e.g. SQL parameter lists, or similar where a delimiter isn't wanted after the last element but for any others.<br>\nThere are other ways to detect the <em>first element</em> (e.g. using a <code>bool</code> variable initialized to <code>true</code> before the loop starts, and set to <code>false</code> upon the first iteration).<br>\nFor your example it seems just checking for <code>vi3.begin()</code> is the easiest and most natural way.</p>\n\n<p>Here's the generic variant in pseudo code:</p>\n\n<pre><code>bool isFirstOutput = true;\nfor_each(element in list) {\n    if(not isFirstOutput) {\n        print delimiter;\n    }\n    print element;\n    isFirstOutput = false;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": false, "score": 0, "last_activity_date": 1556981881, "last_edit_date": 1556981881, "creation_date": 1556899777, "answer_id": 55973580, "question_id": 55735410, "link": "https://stackoverflow.com/questions/55735410/removing-a-comma-from-a-c-output/55973580#55973580", "title": "Removing a comma from a c++ output", "body": "<p>If <code>begin</code>, <code>end</code> are at least bidirectional iterators (as yours are),\nyou can just check initially that <code>begin</code> != <code>end</code>;  if not print nothing; if so print\n<code>\", \"</code>-puncuated elements incrementing <code>begin != std::prev(end)</code>, and\nfinally print <code>*begin()</code>. like so:</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;utility&gt;\n\ntemplate&lt;typename OStream, typename BiIter, typename Punct&gt;\nvoid punctuated(OStream &amp;&amp; out, Punct &amp;&amp; punct, BiIter begin, BiIter end)\n{\n    if (begin != end) {\n        for (--end  ;begin != end; ++begin) {\n            std::forward&lt;OStream&gt;(out) &lt;&lt; *begin &lt;&lt; std::forward&lt;Punct&gt;(punct);\n        }\n        std::forward&lt;OStream&gt;(out) &lt;&lt; *begin;\n    }\n}\n\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;list&gt;\n#include &lt;set&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; v0;\n    std::vector&lt;int&gt; v1{{1}};\n    std::list&lt;int&gt; l{{1,2}};\n    std::set&lt;int&gt;s{{3,4,5,6,7}};\n    std::cout &lt;&lt; \"v0 [\";\n    punctuated(std::cout,\",\",v0.begin(),v0.end());\n    std::cout &lt;&lt; \"]\\n\";\n    std::cout &lt;&lt; \"v1 [\";\n    punctuated(std::cout,\",\",v1.begin(),v1.end());\n    std::cout &lt;&lt; \"]\\n\";\n    std::cout &lt;&lt; \"l [\";\n    punctuated(std::cout,\",\",l.begin(),l.end());\n    std::cout &lt;&lt; \"]\\n\";\n    std::cout &lt;&lt; \"s [\";\n    punctuated(std::cout,\"|\",s.begin(),s.end());\n    std::cout &lt;&lt; \"]\\n\";\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>g++ -Wall -Wextra main.cpp &amp;&amp; ./a.out\nv0 []\nv1 [1]\nl [1,2]\ns [3|4|5|6|7]\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/d8396777c2f17b0b\" rel=\"nofollow noreferrer\">Live</a></p>\n"}], "owner": {"reputation": 41, "user_id": 11199757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1b02ccde2acc07339274633d7e5e46?s=128&d=identicon&r=PG&f=1", "display_name": "raj kod", "link": "https://stackoverflow.com/users/11199757/raj-kod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1556981881, "creation_date": 1555532434, "last_edit_date": 1555534894, "question_id": 55735410, "link": "https://stackoverflow.com/questions/55735410/removing-a-comma-from-a-c-output", "title": "Removing a comma from a c++ output", "body": "<p>I wrote this program that sorts numbers in vectors from greatest to least, it works great but the only thing that is bugging me is trying to remove the comma from the last number. Heres my code </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cstdlib&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nint main() {\n\n    vector&lt;int&gt; vi1, vi2, vi3;\n    srand(987);\n\n    for (int i = 0; i &lt; 10; ++i) vi1.push_back(rand() % 10);\n    sort(vi1.begin(), vi1.end());\n\n    for (int i = 0; i &lt; 10; ++i) vi2.push_back(rand() % 10);\n    sort(vi2.begin(), vi2.end())\n\n    while(!vi1.empty() &amp;&amp; !vi2.empty()) {\n        if(vi1.back()&gt;=vi2.back()) {\n            vi3.push_back(vi1.back());\n            vi1.pop_back();\n        }\n        else {\n            vi3.push_back(vi2.back());\n            vi2.pop_back();\n        }\n    }\n\n    while(!vi1.empty()) {\n        vi3.push_back(vi1.back());\n        vi1.pop_back();\n    }\n    while(!vi2.empty()) {\n        vi3.push_back(vi2.back());\n        vi2.pop_back();\n    }\n\n    for (auto i = vi3.begin(); i != vi3.end(); ++i)\n        cout &lt;&lt; *i &lt;&lt; \", \";\n    cout &lt;&lt; \"\\nBye...\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>and here is the output </p>\n\n<pre><code>9, 9, 9, 8, 8, 8, 6, 6, 3, 3, 3, 3, 2, 2, 2, 1, 1, 1, 0, 0, \nBye...\n</code></pre>\n\n<p>as you can see after the last 0 there is a comma which doesn't make sense grammatically speaking. How can I remove that comma?</p>\n"}, {"tags": ["c++", "qt", "qchart"], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 10039118, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tpxi00vso58/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qBaNEndECUOMxeGqgX2WpVfpHBqQ/mo/photo.jpg?sz=128", "display_name": "lll", "link": "https://stackoverflow.com/users/10039118/lll"}, "edited": false, "score": 0, "creation_date": 1555600168, "post_id": 55743905, "comment_id": 98174634, "body": "i added m_chart-&gt;legend()-&gt;update(), but width and height of the legend are not changed"}], "tags": [], "owner": {"reputation": 28669, "user_id": 3049264, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MNMWc.jpg?s=128&g=1", "display_name": "Nejat", "link": "https://stackoverflow.com/users/3049264/nejat"}, "is_accepted": false, "score": 0, "last_activity_date": 1555582557, "creation_date": 1555582557, "answer_id": 55743905, "question_id": 55735409, "link": "https://stackoverflow.com/questions/55735409/qchart-legend-setgeometry-does-not-work/55743905#55743905", "title": "Qchart, legend()-&gt;setGeometry does not work", "body": "<p>You should call <code>update()</code> function of <code>QLegend</code> after setting geometry:</p>\n\n<pre><code>m_chart-&gt;legend()-&gt;update();\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 10039118, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tpxi00vso58/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qBaNEndECUOMxeGqgX2WpVfpHBqQ/mo/photo.jpg?sz=128", "display_name": "lll", "link": "https://stackoverflow.com/users/10039118/lll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555582557, "creation_date": 1555532423, "question_id": 55735409, "link": "https://stackoverflow.com/questions/55735409/qchart-legend-setgeometry-does-not-work", "title": "Qchart, legend()-&gt;setGeometry does not work", "body": "<p>I followed qt documentation <a href=\"https://doc-snapshots.qt.io/qt5-5.11/qtcharts-legend-example.html\" rel=\"nofollow noreferrer\">https://doc-snapshots.qt.io/qt5-5.11/qtcharts-legend-example.html</a> to detach the legend from the chart and set the detached legend dimensions</p>\n\n<pre><code>legend-&gt;detachFromChart();\nm_chart-&gt;legend()-&gt;setBackgroundVisible(true);\nm_chart-&gt;legend()-&gt;setBrush(QBrush(QColor(128, 128, 128, 128)));\nm_chart-&gt;legend()-&gt;setPen(QPen(QColor(192, 192, 192, 192)));\nm_chart-&gt;legend()-&gt;setGeometry(QRectF(80, 50, 100, 180));\n</code></pre>\n\n<p>m_chart->legend()->setGeometry(QRectF(80, 50, 100, 180)) does not work.\nthe first two arguments works. The position of the legend is (80, 50). However, the last two arguments does not work. The width of the legend is not 100, and the height of the legend is not 180.</p>\n"}, {"tags": ["c++", "directed-graph", "weighted-graph"], "comments": [{"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 3, "creation_date": 1555530987, "post_id": 55735040, "comment_id": 98148490, "body": "It would be helpful if you could include a <code>main()</code> function and the <code>#include</code> statements, and then shrink your code to the smallest program possible that produces your problem. We call this a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This allows members to copy, paste, compile, and then Help you."}, {"owner": {"reputation": 1, "user_id": 11313920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b96dba65bb97cae315ed11632fa410?s=128&d=identicon&r=PG&f=1", "display_name": "cappsm", "link": "https://stackoverflow.com/users/11313920/cappsm"}, "edited": false, "score": 2, "creation_date": 1555531195, "post_id": 55735040, "comment_id": 98148722, "body": "This is a good place to use the classic Dijkstra&#39;s algorithm (see related question <a href=\"https://stackoverflow.com/questions/3447566/dijkstras-algorithm-in-c\" title=\"dijkstras algorithm in c\">stackoverflow.com/questions/3447566/dijkstras-algorithm-in-c</a> )"}, {"owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "reply_to_user": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1555531860, "post_id": 55735040, "comment_id": 98148849, "body": "@Gardener is it better now? Thank you."}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1555532389, "post_id": 55735040, "comment_id": 98149052, "body": "Would you just not sum up all the weights of all the paths and then pick the smallest one?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555533676, "post_id": 55735040, "comment_id": 98149531, "body": "There might be enough to determine the problem but it&#39;s not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. <code>InsertArc</code> and <code>GetPathWeight</code> are missing from the class definition. There is a <code>#endif</code> missing. It&#39;s incomplete. An MCVE would have everything in one file unless the problem is a linking issue and with all inputs hard-coded unless the problem is an input issue. Not minimal, and without the inputs it&#39;s not verifiable. That said, the real point of the MCVE is to eliminate the need to ask questions. It&#39;s hard to craft a MCVE without also discovering and fixing the bug."}, {"owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555544341, "post_id": 55735040, "comment_id": 98152459, "body": "@user4581301 would a link to the complete project online work?"}, {"owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "reply_to_user": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1555544393, "post_id": 55735040, "comment_id": 98152468, "body": "@Sailanarmo this is exactly my problem. I don&#39;t know how to get all the paths in one point to then be able to check all the weights and compare them."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1555544873, "post_id": 55735040, "comment_id": 98152534, "body": "@user3812411 Much better.  Optimal would be to make the files smaller and to try to put everything into one file.  The longer it is and the more copies and pastes that are needed to get it to an IDE slows down the member until they decide to move on.  See the explanation by user4581301 above."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1555545367, "post_id": 55735040, "comment_id": 98152631, "body": "Missing GetOrder(), DoesPathExist(), and FindMinimumWeightedPath().  Sorry, I&#39;ve got to head home now.  Some people are smart enough to read the code and find bugs.  I use the compiler and a debugger to do that.  Hopefully one of the smarter members will have time to act like a compiler and read the code."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555545414, "post_id": 55735040, "comment_id": 98152641, "body": "Almost certainly a link to the code would not be minimal. Plus links rot. A question that depends on links will become useless once the links are gone. Avoid links to code except as supplemental information for more context. All I think you need here is to touch up the code you have in the question and make sure that it A) compiles and B demonstrates the bug when run."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555545484, "post_id": 55735040, "comment_id": 98152652, "body": "A quick blurb on the MCVE:  The goal of the MCVE is to isolate the bug in as little code as possible. This leaves the bug with no place to hide and picking it off at that point is usually easy. Demanding a MCVE forces the asker to apply a powerful debugging technique and, usually long before they get to the ultimate end, often find and fix the bug themselves. If they do this before asking the question, odds are really good they don&#39;t need to ask the question anymore."}, {"owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555550208, "post_id": 55735040, "comment_id": 98153462, "body": "@user4581301 the think is my problem is not a bug but a way of thinking. I just need an explanation on how this should be done."}], "owner": {"reputation": 45, "user_id": 3812411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df60fe240930cf3ac145235eb08df49?s=128&d=identicon&r=PG&f=1", "display_name": "user3812411", "link": "https://stackoverflow.com/users/3812411/user3812411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555531819, "creation_date": 1555530732, "last_edit_date": 1555531819, "question_id": 55735040, "link": "https://stackoverflow.com/questions/55735040/find-minimum-weighted-path-in-a-vector-of-tuples-representing-a-graph", "title": "Find minimum weighted path in a vector of tuples representing a graph", "body": "<p>I am still new to graphs and am building a weighted directed graph for a school project. I was able to complete all the functions except the one that find the minimum weighted path from a node to another. I am able to find a path, but don't know how I would store all the paths then get the minimum weighted one. \nMy graph is represented by a vector .</p>\n\n<p>I have created a helper function that gives me a path from the source to the destination and a function that finds the weight of the path. They both work but I can't get the one that find the path to find all the paths instead of the first one it finds.</p>\n\n<pre><code>int WeightedDigraph::Myhelp(int to) const{\n    for (mytup::const_iterator k = adjList.begin(); k != adjList.end(); ++k) {\n        if(get&lt;1&gt;(*k) == to){ //destination\n                return get&lt;0&gt;(*k); //source\n        }\n    }\n    return 10000;\n}\n\nlist&lt;int&gt; WeightedDigraph::FindMinimumWeightedPath(int from, int to) const {\n    list&lt;int&gt; minpath;\n    minpath.push_front(to);\n    int src = Myhelp(to);\n    while(src != from){\n        minpath.push_front(src);\n            src = Myhelp(src);\n    }\n    return minpath;\n}\n</code></pre>\n\n<p>This code returns a list for \"a\" path from \"from\" to \"to\". Instead, I want it to return the one with the least weight. I have to function getPathWeight(const list&amp; path ) already setup to find the weight of each path and compare them but how can I get all paths in one place?</p>\n\n<p>Update for minimum, working example with includes:</p>\n\n<p>Main.cpp</p>\n\n<pre><code>    #include \"WeightedDigraph.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;list&gt;\nusing namespace std;\n\nint main(int argc, char* argv[])\n{\n\n    if(argc != 4) {\n        cerr &lt;&lt; \"Incorrect number of command line arguments.\" &lt;&lt; endl;\n        cerr &lt;&lt; \"Usage: \" &lt;&lt; argv[0] &lt;&lt; \" &lt;filename&gt; &lt;start vertex&gt; &lt;dest vertex&gt;\" &lt;&lt; endl;\n        exit(EXIT_FAILURE);\n    }\n\n    WeightedDigraph graph(argv[1]);\n\n    cout &lt;&lt; \"The graph has \" &lt;&lt; graph.GetOrder() &lt;&lt; \" vertices and \" &lt;&lt; graph.GetSize() &lt;&lt; \" arcs\" &lt;&lt; endl;\n\n    int source = atoi(argv[2]);\n    int dest = atoi(argv[3]);\n\n    if (graph.DoesPathExist(source, dest)) {\n        list&lt;int&gt; path = graph.FindMinimumWeightedPath(source, dest);\n        //then the path will be used for other functions\n    return 0;\n}\n</code></pre>\n\n<p>WeightedDiagraph.cpp:</p>\n\n<pre><code>#include \"WeightedDigraph.h\"\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;limits&gt;\n#include&lt;list&gt;\n\nusing namespace std;\n\n\nvoid WeightedDigraph::InsertArc(int from, int to, double weight) {\n    tuple&lt;int, int, double&gt; newtup (from, to, weight); \n    adjList.push_back(newtup);\n}\n\ndouble WeightedDigraph::GetPathWeight(const list&lt;int&gt; &amp; path) const {\n    //working\n}\n\n//other functions that are not needed for my question\n</code></pre>\n\n<p>WeightedDiagraph.h:</p>\n\n<pre><code>#ifndef WeightedDigraph_H\n#define WeightedDigraph_H\n\n#include&lt;list&gt;\n#include&lt;string&gt;\n#include&lt;vector&gt;\n#include&lt;tuple&gt;\n\nusing namespace std;\n\ntypedef vector&lt;tuple&lt;int,int,double&gt;&gt; mytup;\n\nclass WeightedDigraph {\npublic:\n    mytup adjList;\n    //all methods\n\nprivate:\n    int numVertices;\n    int numArcs;\n\n    int from;\n    int to;\n    double weight;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "for-loop"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 3, "creation_date": 1555529924, "post_id": 55734835, "comment_id": 98148052, "body": "See if you can use OpenMP. It has a set of <code>#pragma</code> commands which can automatically run subsets of your loops on threads."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1555529983, "post_id": 55734835, "comment_id": 98148080, "body": "Your inner loop appears to allow many iterations of the loop to read or alter the positions of the same balls. The algorithm doesn&#39;t appear to be parallelizable as-is. At least, you&#39;ll have to synchronize positions. This will be tricky, because all you do is operate over positions."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1555530153, "post_id": 55734835, "comment_id": 98148145, "body": "For what it&#39;s worth, you can use <a href=\"https://en.cppreference.com/w/cpp/thread/thread/hardware_concurrency\" rel=\"nofollow noreferrer\"><code>std::thread::hardware_concurrency</code></a> to get a hint at the number of threads you should run. It&#39;s widely supported, but platforms are allowed to return 0 instead."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1555530204, "post_id": 55734835, "comment_id": 98148164, "body": "If I remember rightly, it seems some game code did vector intersections and made a list of colliding objects. Then at the end it went back and did fine tuned precise collision."}, {"owner": {"reputation": 11, "user_id": 6221516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1513334215648842/picture?type=large", "display_name": "Job Guidos", "link": "https://stackoverflow.com/users/6221516/job-guidos"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555530991, "post_id": 55734835, "comment_id": 98148492, "body": "@Fran&#231;oisAndrieux I am using the hardware_concurrency function. Definitely vital to my goal, but now I need to know how to divide up the work to an arbitrary number of threads based on what that function returns. Also to your first comment, the outer loop can be paralellized without issue. I don&#39;t plan to parallelize the inner loop. I&#39;m writing a simpler code example to replace so it is clearer what I need."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1555531221, "post_id": 55734835, "comment_id": 98148589, "body": "The problem I described is that if you divide the outer loop, each thread&#39;s inner loop can interfer with other threads&#39; inner loop. The data is shared and operations overlap on it"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1555531382, "post_id": 55734835, "comment_id": 98148649, "body": "I would advice to look at the cookie-cutter solution - Intel TBB with their task groups, scheduling etc. <a href=\"https://www.threadingbuildingblocks.org/\" rel=\"nofollow noreferrer\">threadingbuildingblocks.org</a>"}, {"owner": {"reputation": 1232, "user_id": 3426820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100003174453005/picture?type=large", "display_name": "SemperAmbroscus", "link": "https://stackoverflow.com/users/3426820/semperambroscus"}, "edited": false, "score": 0, "creation_date": 1555532489, "post_id": 55734835, "comment_id": 98149092, "body": "Seems like the exact type of thing you&#39;d offload to the GPU"}, {"owner": {"reputation": 11, "user_id": 6221516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1513334215648842/picture?type=large", "display_name": "Job Guidos", "link": "https://stackoverflow.com/users/6221516/job-guidos"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555533188, "post_id": 55734835, "comment_id": 98149351, "body": "@Fran&#231;oisAndrieux you are right. Thanks. I just noticed that it can potentially randomize the location of a ball in multiple threads. I&#39;ll move them in a separate loop afterward. I&#39;m going to simplify the code now to get at the problem I really want to answer."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6221516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1513334215648842/picture?type=large", "display_name": "Job Guidos", "link": "https://stackoverflow.com/users/6221516/job-guidos"}, "edited": false, "score": 0, "creation_date": 1555534329, "post_id": 55735297, "comment_id": 98149776, "body": "Thank you for the large effort here, and as someone else pointed out as well, I do now see that I need a second loop to move everything at the end. My intended question should be clearer now that I edited it. I don&#39;t feel like it warrants a non-std library. I&#39;m working on a function to do it right now, and will post it unless someone beats me to it."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1555531895, "creation_date": 1555531895, "answer_id": 55735297, "question_id": 55734835, "link": "https://stackoverflow.com/questions/55734835/distributing-a-for-loop-over-an-arbitrary-number-of-threads-based-on-varying-har/55735297#55735297", "title": "Distributing a for loop over an arbitrary number of threads based on varying hardware", "body": "<p>The basic shape of your work is a triangle -- each inner loop does n-1, n-2, n-3, ..., 1 steps.</p>\n\n<p>So the first step will be to linearize the triangle, or otherwise divide it into K equal sized groups.</p>\n\n<p>Suppose we have a function from i to a triangle position:</p>\n\n<pre><code>struct ball_pair { int ball, other_ball; };\n\nball_pair get_ball_pair( int i ); // TODO\nint get_pair_count( int n ) { return n*(n-1)/2; }\n</code></pre>\n\n<p>now we rewrite your code to read:</p>\n\n<pre><code>for (int i = 0; i &lt; get_pair_count(n); ++i) {\n  auto&amp;&amp; [Ball, otherBall] = get_ball_pair(i);\n  // your code\n}\n</code></pre>\n\n<p>this code is <em>almost</em> in good shape to be made parallel.  The next problem is you are mutating the sequence as you work on it.</p>\n\n<p>Defer the mutation until later; instead of mutating directly, track the balls you want to mutate, and mutate them in a batch.</p>\n\n<p>An easy way would be a vector of char (not bools, that isn't thread safe) which is non-zero if and only if you want to reroll a ball's location.</p>\n\n<pre><code>std::vector&lt;char&gt; rerolling( pos.size() ); // can be reused if you zero it\nfor (int i = 0; i &lt; get_pair_count(n); ++i) {\n  auto&amp;&amp; [Ball, otherBall] = get_ball_pair(i);\n   if (distance(pos[Ball], pos[otherBall]) &lt;= R[Ball] + R[otherBall]) {\n     rerolling[Ball] = 1; // I did this to Ball, not otherBall, on purpose\n   }\n}\n</code></pre>\n\n<p>and then a second loop:</p>\n\n<pre><code>for (int i = 0; i &lt; rerolling.size(); ++i) {\n  if (rerolling[i])\n    pos[i] =  { randDouble(xRange), randDouble(yRange), randDouble(zRange) }\n}\n</code></pre>\n\n<p>This is getting closer.</p>\n\n<p>The next problem is the write to rerolling -- we have to ensure that only one thread writes to each index.  The easy way is to ensure that each thread gets a set of <code>Ball</code>s that are unique to it.</p>\n\n<p>The partition of the triangle gets interesting, but the first row contains a fraction of at most 2/(n-1) of the entire work set.</p>\n\n<p>Ah, we can use some fancy math.  As it happens, the length of the <em>first</em> row plus the length of the <em>last</em> row is (n-1).  The length of the <em>second</em> row plus the length of the <em>second last</em> row is also (n-1).  Etc.</p>\n\n<p>So our \"task units\" can be to do the kth row and the (n-k)th row (roughly).  That provides n/2 equal size task units, and none have overlapping \"Ball\" values.</p>\n\n<p>We now rewrite the first loop:</p>\n\n<pre><code>std::vector&lt;char&gt; rerolling( pos.size() ); // can be reused if you zero it\nauto do_row = [&amp;rerolling, &amp;pos, &amp;R, n]( int Ball ) {\n  for (int otherBall = Ball+1; otherBall &lt; n; ++otherBall)\n    if (distance(pos[Ball], pos[otherBall]) &lt;= R[Ball] + R[otherBall])\n      rerolling[Ball] = 1; // I did this to Ball, not otherBall, on purpose\n};\nfor (int i = 0; i &lt; (n+1)/2; ++i) {\n  do_row(i);\n  do_row(n-1-i);\n}\n</code></pre>\n\n<p>there we go -- (almost) equal sized non-overlapping work units consisting of two <code>do_row</code> calls.</p>\n\n<p>Then a simple to thread reroller:</p>\n\n<pre><code>for (int i = 0; i &lt; rerolling.size(); ++i) {\n  if (rerolling[i])\n    pos[i] =  { randDouble(xRange), randDouble(yRange), randDouble(zRange) }\n}\n</code></pre>\n\n<p>as we saw above.</p>\n\n<p>This is the hard work.</p>\n\n<p>The easy work is finding a threading solution to work on these tasks.  Open MP, C++17 parallel algorithms, PPL, TBB, or write your own thread pool.</p>\n\n<p>If you roll your own thread pool, use  <a href=\"https://en.cppreference.com/w/cpp/thread/thread/hardware_concurrency\" rel=\"nofollow noreferrer\">std::thread::hardware_concurrency()</a> work out how many threads to launch.</p>\n\n<p><a href=\"https://stackoverflow.com/a/42282654/1774667\">Here is one of many toy thread pools</a> I have posted to SO over the years.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6221516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1513334215648842/picture?type=large", "display_name": "Job Guidos", "link": "https://stackoverflow.com/users/6221516/job-guidos"}, "is_accepted": false, "score": 0, "last_activity_date": 1555551346, "last_edit_date": 1555551346, "creation_date": 1555542666, "answer_id": 55737147, "question_id": 55734835, "link": "https://stackoverflow.com/questions/55734835/distributing-a-for-loop-over-an-arbitrary-number-of-threads-based-on-varying-har/55737147#55737147", "title": "Distributing a for loop over an arbitrary number of threads based on varying hardware", "body": "<p>Convert your for loop into a function that takes iterator start and end and its arguments.</p>\n\n<pre><code>int customForLoop(int start, int end)\n{\n    for (int Ball = start; Ball &lt; end; Ball++)\n    {\n        // the work you want parallelized.\n    }\n}\n</code></pre>\n\n<p>Gets the number of threads on the hardware being used.</p>\n\n<pre><code>        unsigned hardwareThreadCount = std::thread::hardware_concurrency();\n</code></pre>\n\n<p>Initialize a vector to store threads in.</p>\n\n<pre><code>        std::vector&lt;std::thread&gt; threads;\n</code></pre>\n\n<p>Calculate even chunks of loop.</p>\n\n<pre><code>        int loopChunk = balls / hardwareThreadCount; // Obviously won't always divide evenly, but it just needs to be close.\n        for (int i = 0; i &lt; hardwareThreadCount; i++)\n        {\n</code></pre>\n\n<p>Launch a thread where the iterator controls the range, and the final thread launching loop goes to the max range of the array you are iterating through, so you don't miss any due to the chunking, such as:</p>\n\n<pre><code>if (i &lt; hardwareThreadCount - 1)\n            {\n                threads.emplace_back(customForLoop,loopChunk * i, loopChunk * (i + 1));\n            }\n            else \n            {\n                threads.emplace_back(customForLoop,loopChunk * i, balls);\n            }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6221516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1513334215648842/picture?type=large", "display_name": "Job Guidos", "link": "https://stackoverflow.com/users/6221516/job-guidos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555551346, "creation_date": 1555529786, "last_edit_date": 1555533795, "question_id": 55734835, "link": "https://stackoverflow.com/questions/55734835/distributing-a-for-loop-over-an-arbitrary-number-of-threads-based-on-varying-har", "title": "Distributing a for loop over an arbitrary number of threads based on varying hardware", "body": "<p>I want to distribute the workload of a for loop over an arbitrary number of threads.</p>\n\n<pre><code>unsigned hardwareThreads = std::thread::hardware_concurrency();\nstd::vector&lt;std::thread&gt; threads(hardwareThreads);\n\ndouble bigList[n]\n\nvoid worker() {\n    for (int i = 0; i &lt; n; i++)\n    {\n        // do work on big list\n    }\n}\n</code></pre>\n\n<p>I want to AVOID manually defining a separate worker function to do even chunks of what worker does:</p>\n\n<pre><code>threads[0](worker1)\nthreads[1](worker3)\nthreads[2](worker2)\netc...\n</code></pre>\n\n<p>I want to provide a loop with the number of threads available, and have it divide up the loop into that many even sized loops.</p>\n\n<p>I'm working on an answer and will post it soon. I realized this isn't very hard. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "edited": false, "score": 3, "creation_date": 1555529577, "post_id": 55734698, "comment_id": 98147939, "body": "Please include all your code (and any other relevant information) in the question itself. The third-party website may not keep it around for long and then this question is not going to make a whole lot of sense."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 1, "creation_date": 1555530301, "post_id": 55734698, "comment_id": 98148204, "body": "You did pass the first three test cases and the first 19 lines of the fourth test case, so your approach is probably mostly correct. It shows you the test data, so you can step through your code with a debugger to find the bug."}, {"owner": {"reputation": 1, "user_id": 8940744, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840096372870592/picture?type=large", "display_name": "Joshua Mokut", "link": "https://stackoverflow.com/users/8940744/joshua-mokut"}, "edited": false, "score": 0, "creation_date": 1555586088, "post_id": 55734698, "comment_id": 98166387, "body": "@jakub_d done. I have included my code."}, {"owner": {"reputation": 1, "user_id": 8940744, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840096372870592/picture?type=large", "display_name": "Joshua Mokut", "link": "https://stackoverflow.com/users/8940744/joshua-mokut"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1555587189, "post_id": 55734698, "comment_id": 98166985, "body": "@Brian I can&#39;t debug because the test data isn&#39;t complete. There are not up to 20 queries of the second type in the test data."}], "owner": {"reputation": 1, "user_id": 8940744, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840096372870592/picture?type=large", "display_name": "Joshua Mokut", "link": "https://stackoverflow.com/users/8940744/joshua-mokut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555586021, "creation_date": 1555529208, "last_edit_date": 1555586021, "question_id": 55734698, "link": "https://stackoverflow.com/questions/55734698/can-codeforces-problem-455d-be-solved-using-dequesqrt-decomposition", "title": "Can codeforces problem 455D be solved using Deque+Sqrt Decomposition?", "body": "<p>So the task is this: you are given an array Arr of size n. the elements of the array range from 1 to n. you have two types of queries:</p>\n\n<ol>\n<li>(l, r) -  do a cyclic shift in the subarray Arr[l, r] both ends inclusive.</li>\n<li>(l, r, k) - print out the number of elements in the range [l, r], that are equal to k;</li>\n</ol>\n\n<p>Link to the original problem: <a href=\"https://codeforces.com/contest/455/problem/D\" rel=\"nofollow noreferrer\">https://codeforces.com/contest/455/problem/D</a></p>\n\n<p>I decided to do this:\nlet's divide the array Arr into sqrt(n) blocks.\nlet's store sqrt(n) deques(C++ STL deque).\nalso let's store sqrt(n) counter arrays where cnt[i][j] is the number of times the number j occurs in the i-th block</p>\n\n<p>the first query can be done in O(sqrt(n)) time, if we just update the deque of the corresponding blocks using pop_back and push_front as well as update the counter arrays.</p>\n\n<p>The second query can be done by just calculating the sum cnt[i][k] over the corresponding blocks i.</p>\n\n<p>I'm getting WA4 implementing this idea, I can't find the bug in my code so it got me thinking maybe the idea is wrong. What do you think?</p>\n\n<p>this is my submission</p>\n\n<pre><code>int n;\n\nvoid decode(int &amp;l, int &amp;r, int lastans) {\n    l = ((l + lastans - 1) % n);\n    r = ((r + lastans - 1) % n);\n    if (l &gt; r)\n        swap(l, r);\n}\n\nvoid decode(int &amp;l, int &amp;r, int &amp;k, int lastans) {\n    decode(l, r, lastans);\n    k = ((k + lastans - 1) % n)+1;\n\n}\n\nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n\n    cin &gt;&gt; n; \n\n    vector&lt;int&gt; a(n);\n    for (int i = 0; i &lt; n; i++)\n        cin &gt;&gt; a[i];\n\n    int sqt = sqrt(n + .2) + 1;\n    vector&lt;deque&lt;int&gt; &gt; b(sqt);\n    vector&lt;vector&lt;int&gt; &gt; cnt(sqt, vector&lt;int&gt; (n+1));\n    for (int i = 0; i &lt; n; i++) {\n        int blok = i / sqt;\n\n        b[blok].push_back(a[i]);\n        cnt[blok][a[i]]++;\n    }\n\n    int q;\n    cin &gt;&gt; q; \n    int lastans = 0;\n\n    while (q--) {\n        int l, r, k, t;\n        cin &gt;&gt; t;\n\n        if (t == 1) {\n            cin &gt;&gt; l &gt;&gt; r; \n            decode(l, r, lastans);\n\n            int b1, b2;\n            b1 = l / sqt;\n            b2 = r / sqt;\n\n            if (b1 == b2) {\n                int temp = b[b2][r%sqt];\n\n                for (int g = r % sqt; g &gt; l%sqt; g--) {\n                    b[b2][g] = b[b2][g - 1];\n                }\n                b[b1][l%sqt] = temp;\n            }\n            else {\n                int temp = b[b2][r%sqt];\n                cnt[b2][temp]--;\n\n                for (int g = r % sqt; g &gt; 0; g--) {\n                    b[b2][g] = b[b2][g - 1];\n                }\n                cnt[b2][b[b2].front()]--;\n                b[b2][0] = b[b2 - 1].back();\n                cnt[b2][b[b2].front()]++;\n\n                for (int g = b2 - 1; g &gt; b1; g--) {\n                    cnt[g][b[g].back()]--;\n                    b[g].pop_back();\n                    b[g].push_front(b[g - 1].back());\n                    cnt[g][b[g].front()]++;\n                }\n                cnt[b1][b[b1].back()]--;\n\n                for (int g = (int)b[b1].size()-1; g &gt; l%sqt; g--) {\n                    b[b1][g] = b[b1][g - 1];\n                }\n                b[b1][l%sqt] = temp;\n                cnt[b1][temp]++;\n            }\n        }\n        else {\n            cin &gt;&gt; l &gt;&gt; r &gt;&gt; k; \n            decode(l, r, k, lastans);\n\n            int b1 = l / sqt;\n            int b2 = r / sqt;\n\n            if (b1 == b2) {\n                int ans = 0;\n\n                for (int g = l % sqt; g &lt;= r % sqt; g++) {\n                    ans += b[b1][g] == k ? 1 : 0;\n                }\n\n                lastans = ans;\n                cout &lt;&lt; lastans &lt;&lt; '\\n';\n            }\n            else {\n                int ans = 0;\n                for (int g = l % sqt; g &lt; b[b1].size(); g++) {\n                    ans += b[b1][g] == k ? 1 : 0;\n                }\n                for (int g = b1 + 1; g &lt; b2; g++) {\n                    ans += cnt[g][k];\n                }\n                for (int g = 0; g &lt;= r % sqt; g++)\n                    ans += b[b2][g] == k ? 1 : 0;\n                lastans = ans;\n\n                cout &lt;&lt; lastans &lt;&lt; '\\n';\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "readdirectorychangesw"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1555531014, "post_id": 55734661, "comment_id": 98148499, "body": "Remove <code>FILE_FLAG_OVERLAPPED</code> as you don&#39;t use that anyway and the docs are ambiguous on whether thats allowed. Also you must call <code>GetLastErrorAsString()</code> the first thing you do after the call failing. Allocating a string (<code>string Message = &quot;Stopped monitor. Error: &quot;;</code>) is a really bad idea as that could clobber the last error. Hope this helps."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1555531092, "post_id": 55734661, "comment_id": 98148543, "body": "And finally, disable any anti virus or similar systems, they&#39;re notorious for causing issues like this."}, {"owner": {"reputation": 123, "user_id": 9926676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872f94f7fe2fbf1f4333a804eef4a498?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas van Hesteren", "link": "https://stackoverflow.com/users/9926676/thomas-van-hesteren"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1555531981, "post_id": 55734661, "comment_id": 98148884, "body": "@MikeVine, I have no anti virus or similar installed on the machine causing the issues. So, the <code>FILE_FLAG_OVERLAPPED</code> is the cause of the issue? Could you explain why, because I don&#39;t understand? Since the directory handle is not returning <code>INVALID_HANDLE_VALUE</code> and is therefore considered successful?"}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1555539262, "post_id": 55734661, "comment_id": 98151342, "body": "Do you mean removing the overlapped fixed it? It was a suggestion."}, {"owner": {"reputation": 123, "user_id": 9926676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872f94f7fe2fbf1f4333a804eef4a498?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas van Hesteren", "link": "https://stackoverflow.com/users/9926676/thomas-van-hesteren"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1555602063, "post_id": 55734661, "comment_id": 98175748, "body": "@MikeVine, ah alright. Yea, I thought it was the cause for the problem. The error I get is correct, I checked that (code 998) by directly catching the errorno"}], "owner": {"reputation": 123, "user_id": 9926676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872f94f7fe2fbf1f4333a804eef4a498?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas van Hesteren", "link": "https://stackoverflow.com/users/9926676/thomas-van-hesteren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555529078, "creation_date": 1555529078, "question_id": 55734661, "link": "https://stackoverflow.com/questions/55734661/readdirectorychanges-buffer-alignment-issue-error-998-windows", "title": "ReadDirectoryChanges buffer alignment issue error 998 Windows", "body": "<p>I have the following code to monitor file changes on the system, but I get an error code 998 (INVALID MEMORY LOCATION). What is wrong about my code? It should be something with the buffer alignment, but I can't find my coding mistake?</p>\n\n<p>The code I use to monitor the system changes is shown below:</p>\n\n<pre><code>#if _WIN32\n    HANDLE hDir = NULL;\n    int TryCount = 0;\n    char filename[MAX_PATH];\n\n    HANDLE DirHandle;\n    while (hDir == NULL || hDir == INVALID_HANDLE_VALUE) {\n        DirHandle = CreateFileA(\n            Settings.Directory.c_str(),\n            GENERIC_READ | FILE_LIST_DIRECTORY,\n            FILE_SHARE_WRITE | FILE_SHARE_READ | FILE_SHARE_DELETE,\n            NULL,\n            OPEN_EXISTING,\n            FILE_FLAG_BACKUP_SEMANTICS | FILE_FLAG_OVERLAPPED,\n            NULL);\n        if (DirHandle == INVALID_HANDLE_VALUE) {\n            TryCount++;\n            if (TryCount == 5) {\n                string Message = \"Failed to open directory: \";\n                Message += Settings.Directory.Real;\n                Message += \". Shutting down monitor\";\n                Log(Message, true, \"Warning\");\n                SleepForSeconds(30);\n                }\n            }\n        else {\n            hDir = DirHandle;\n            }\n        }\n\n    if (TryCount &lt; 5) {\n        int offset;\n        string RenameOld;\n        bool result = true;\n        char buffer[65536]; //64kB\n        DWORD dwBytesReturned = 0;\n        FILE_NOTIFY_INFORMATION* pNotify;\n        while (result) {\n            result = ReadDirectoryChangesW(DirHandle, &amp;buffer, sizeof(buffer), TRUE, FILE_NOTIFY_CHANGE_FILE_NAME | FILE_NOTIFY_CHANGE_LAST_WRITE, &amp;dwBytesReturned, NULL, NULL);\n            if (result) {\n                offset = 0;\n                do {\n                    pNotify = (FILE_NOTIFY_INFORMATION*)((char*)buffer + offset);\n                    strcpy(filename, \"\");\n                    WideCharToMultiByte(CP_ACP, 0, pNotify-&gt;FileName, pNotify-&gt;FileNameLength/2, filename, sizeof(filename), NULL, NULL);\n                    filename[pNotify-&gt;FileNameLength/2] = '\\0';\n                    string FilePath = Settings.Directory + PathSeparator + filename;\n\n                    if (pNotify-&gt;Action == FILE_ACTION_ADDED || pNotify-&gt;Action == FILE_ACTION_MODIFIED) {\n                        HandleMonitorAction(\"PROCESS\", FilePath);\n                        }\n                    else if (pNotify-&gt;Action == FILE_ACTION_REMOVED) {\n                        HandleMonitorAction(\"DELETE\", FilePath);\n                        }\n                    else if (pNotify-&gt;Action == FILE_ACTION_RENAMED_OLD_NAME) {\n                        RenameOld = FilePath;\n                        }\n                    else if (pNotify-&gt;Action == FILE_ACTION_RENAMED_NEW_NAME) {\n                        HandleMonitorAction(\"RENAME\", FilePath, RenameOld);\n                        RenameOld = \"\";\n                        }\n                    else {\n                        Log(\"Unknown monitor-action received for the file: \" + FilePath, false, \"Warning\");\n                        }\n                    offset += pNotify-&gt;NextEntryOffset;\n                    } while(pNotify-&gt;NextEntryOffset); //(offset != 0);\n                }\n            else {\n\n                //THIS GIVES THE 998 INVALID MEMORY ERROR\n\n                string Message = \"Stopped monitor. Error: \";\n                Message += GetLastErrorAsString();\n                Log(Message, true, \"Error\");\n                return;\n                }\n            }\n        }\n</code></pre>\n\n<p>Please advise on my mistake</p>\n"}, {"tags": ["c++", "loops", "recursion", "language-lawyer", "undefined-behavior"], "comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 1, "creation_date": 1555572802, "post_id": 55734648, "comment_id": 98159458, "body": "&quot;The loop in principle could run forever, while the recursion will eventually result in a stackoverflow.&quot; \u2013 Actually, since it is UB it could do anything. And it doesn&#39;t have to recurse in the first place on actual hardware because of the as-if rule. In particular, if optimizations are enabled, the compiler is likely to replace your recursive example with effectively a loop (tail call optimization) even if it has side effects."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1555576071, "post_id": 55734648, "comment_id": 98160987, "body": "@ArneVogel Yes the code is contrived but in practice most C++ code has no objects with non trivial dtors and cannot be tail optimized most of the time"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1555586204, "post_id": 55734648, "comment_id": 98166457, "body": "@ArneVogel read &quot;in principle&quot; as &quot;what would happen if it wasnt ub&quot;"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1556053758, "post_id": 55734648, "comment_id": 98305309, "body": "@user463035818: I&#39;d say if it wasn&#39;t UB  I&#39;d say an implementation should be expected to refrain from performing any action which wouldn&#39;t occur if the loop were omitted, or any action which would have a non-hoistable data dependency on anything in the loop, but may perform any actions which would occur if the loop were omitted, unless or until it encounters a non-hoistable data dependency."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555529553, "post_id": 55734750, "comment_id": 98147931, "body": "ah now I remember that this is the actual phrasing, I didnt find it anymore (i mean somewhere else than in the standard itself). cppreference is a bit short on ub"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1555530118, "post_id": 55734750, "comment_id": 98148128, "body": "Where is it defined UB? Doesn&#39;t the standard states about loop removal?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1555530226, "post_id": 55734750, "comment_id": 98148173, "body": "@Jean-BaptisteYun&#232;s It&#39;s in the &quot;may assume&quot; part. If your program doesn&#39;t do that you&#39;re violating the compiler&#39;s assumption which is the same thing as UB. It does but that&#39;s just an example of what could happen."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555530384, "post_id": 55734750, "comment_id": 98148242, "body": "i am a bit confused. Naively put: Compiler knows that my stacksize is limited, infinite recursion will result in stack overflow, thread will terminate, all fine. Where am I wrong?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1555530603, "post_id": 55734750, "comment_id": 98148326, "body": "@user463035818 In the C++ abstract machine there is no stack size. That&#39;s one of those implementation defined limits, but it doesn&#39;t count as a program terminating if that makes sense."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555532528, "post_id": 55734750, "comment_id": 98149107, "body": "@Rakete1111 you want to tell me stackoverflow isnt real ? :P Seriously, what is a stackoverflow in terms of the c++ language? It simply does not exist and therefore is undefined by definition?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555532614, "post_id": 55734750, "comment_id": 98149135, "body": "@user463035818 Well yeah, it is not something the language is concerned about. It&#39;s not necessarily undefined though, it&#39;s just that that concept doesn&#39;t exist in the abstract machine."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1555537563, "post_id": 55734750, "comment_id": 98150884, "body": "Is there already an answer to why a compiler may assume that infinite loop is not a busy waiting for a signal to arrive?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 1, "creation_date": 1555537761, "post_id": 55734750, "comment_id": 98150939, "body": "@LanguageLawyer Well if you want this waiting you would mark the variable denoting that with <code>volatile</code>, which would fall into the conditions above. You&#39;d do that anyway so that the compiler doesn&#39;t optimize it away in some other context."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1555598038, "post_id": 55734750, "comment_id": 98173442, "body": "@Rakete1111 it is not an answer."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1557429374, "post_id": 55734750, "comment_id": 98772199, "body": "@LanguageLawyer: Given <code>func1(); func2();</code> any portions of <code>func2();</code> which may be affected by actions performed in <code>func1()</code> must behave as though executed after those actions, but any actions in <code>func1()</code> and <code>func2()</code> that do not interact with each other and have no observable side-effects may be performed in any order.  I think the Standard&#39;s language about assuming that loops terminate is intended to say that a failure of <code>func1()</code> to terminate would not in and of itself be a &quot;side-effect&quot; that must be sequenced prior to <code>func2()</code>."}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 10, "last_activity_date": 1555529567, "last_edit_date": 1555529567, "creation_date": 1555529391, "answer_id": 55734750, "question_id": 55734648, "link": "https://stackoverflow.com/questions/55734648/infinite-loop-vs-infinite-recursion-are-both-undefined/55734750#55734750", "title": "Infinite loop vs infinite recursion. Are both undefined?", "body": "<p>No there is no difference. <a href=\"http://eel.is/c++draft/basic.exec#intro.progress-1\" rel=\"noreferrer\">[basic.progress]p1</a>:</p>\n\n<blockquote>\n  <p>The implementation may assume that any thread will eventually do one of the following:</p>\n  \n  <ul>\n  <li><p>terminate,</p></li>\n  <li><p>make a call to a library I/O function,</p></li>\n  <li><p>perform an access through a volatile glvalue, or</p></li>\n  <li><p>perform a synchronization operation or an atomic operation.</p></li>\n  </ul>\n</blockquote>\n\n<p>It doesn't matter how you have your infinite loop; if it doesn't do any of the points above, you get UB. Including the following:</p>\n\n<pre><code>int bar(int cond) {\n    if (cond == 42) bar(cond);\n    return 42;\n}\nbar(some_user_input);\n</code></pre>\n\n<p>The compiler is allowed to assume that <code>some_user_input</code> will never be 42.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1556052419, "last_edit_date": 1556052419, "creation_date": 1556051604, "answer_id": 55819007, "question_id": 55734648, "link": "https://stackoverflow.com/questions/55734648/infinite-loop-vs-infinite-recursion-are-both-undefined/55819007#55819007", "title": "Infinite loop vs infinite recursion. Are both undefined?", "body": "<p>In most real-world situations, an invitation to assume something will happen implies that one is not obligated to take any special measures to allow for the possibility that it doesn't, but is not a license to behave in arbitrary fashion if one discovers that the event in question won't occur.</p>\n\n<p>Under fashionable interpretations of the C Standard, however, there is no reason to expect that implementations will refrain from totally nonsensical fashion if any assumption the Standard would invite them to make proves incorrect.</p>\n\n<p>I don't think the authors of the Standard intended that C compilers would use complicated inference engines which cascade assumptions to the point that a compiler given e.g.</p>\n\n<pre><code>if (x &gt; 1000) foo(x);\nwhile ( x &lt;= 1000)\n  somethingWithNoSideEffectsThatCantAffectX();\n</code></pre>\n\n<p>would conclude that <code>foo</code> should be executed unconditionally regardless of the value of <code>x</code>.  More likely, they intended that a compiler given something like:</p>\n\n<pre><code>volatile int yy;\nvoid test(int x, int *restrict arr)\n{\n  int y;\n  do\n    x=arr[x];\n  while(x &amp; 1);\n  y=yy;\n  if (y)\n    printf(\"%d\\n\",x);\n}\n</code></pre>\n\n<p>would be allowed to use the fact that the final value of <code>x</code> may or may not be needed to rearrange the code to be more efficient in the cases where it isn't (by skipping its calculation altogether).  Essentially, the fact that a piece of code takes time to execute--<em>even if infinite</em>--should not be considered a side-effect in and of itself, and if a compiler can prove that a piece of code cannot execute any side-effects that would be visible before it reaches a certain place, it need not wait for that piece of code to finish before executing code at that place.</p>\n\n<p>Unfortunately, the authors of the Standard rely upon compiler writers to recognize what kinds of actions may be usefully taken on the basis of certain assumptions, while compiler writers assume that any possible inference they can draw should be presumed useful.</p>\n"}], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 55734750, "answer_count": 2, "score": 7, "last_activity_date": 1556052419, "creation_date": 1555528984, "last_edit_date": 1555530207, "question_id": 55734648, "link": "https://stackoverflow.com/questions/55734648/infinite-loop-vs-infinite-recursion-are-both-undefined", "title": "Infinite loop vs infinite recursion. Are both undefined?", "body": "<p>Infinite loops without side effect are undefined behaviour. See <a href=\"https://coliru.stacked-crooked.com/view?id=24e0a58778f67cd4\" rel=\"noreferrer\">here</a> for the example from <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"noreferrer\">cppreference</a>. Much simpler example:</p>\n\n<pre><code>int foo() {\n    while(true) {}\n    return 42;\n}\n</code></pre>\n\n<p>Now consider the almost equivalent</p>\n\n<pre><code>int bar() {\n    if (true) return bar();\n    return 42;\n}\n</code></pre>\n\n<p><strong>Does this invoke undefined behaviour as well?</strong></p>\n\n<p>Or phrased differently: <strong>What class of error is infinite recursion according to the language?</strong></p>\n\n<p>PS: note that I am aware of the implications at runtime: The loop in principle could run forever, while the recursion will eventually result in a stackoverflow. Though I am mainly interested in what the compiler does to them. Maybe a quite academic question...</p>\n"}, {"tags": ["c++", "recursion"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555528436, "post_id": 55734443, "comment_id": 98147419, "body": "what did you try?"}, {"owner": {"reputation": 14988, "user_id": 881441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ktk8b.jpg?s=128&g=1", "display_name": "Stephen Quan", "link": "https://stackoverflow.com/users/881441/stephen-quan"}, "edited": false, "score": 2, "creation_date": 1555528457, "post_id": 55734443, "comment_id": 98147433, "body": "You can do this in Java? Well, in C++, the above code, technically, is &#39;infinite&#39;, but, in practice will quickly exhaust your stack and crash. Not sure what the point of it is."}, {"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555528572, "post_id": 55734443, "comment_id": 98147494, "body": "i have a function for a project, this can call itself 56000 times but should call itself over million times. how can i do this?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1555528623, "post_id": 55734443, "comment_id": 98147529, "body": "Get rid of the recursion."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1555528631, "post_id": 55734443, "comment_id": 98147534, "body": "increase the stack size <code>ulimit -s unlimited</code>; you&#39;ll crash <i>later</i>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1555528825, "post_id": 55734443, "comment_id": 98147606, "body": "C++ has no notion of stack space, it&#39;s an implementation detail. I would be shocked if any platform offered such a function. No implementation of c++ uses garbage collection and &quot;cleaning the stack&quot; is fundamentally not something the language can support."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 8, "creation_date": 1555528835, "post_id": 55734443, "comment_id": 98147611, "body": "<a href=\"https://repl.it/@RyanHaining1/rererererefunction\" rel=\"nofollow noreferrer\">I don&#39;t think you can do that in java</a>"}, {"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555528984, "post_id": 55734443, "comment_id": 98147676, "body": "Is it a bad practice in c++ to use recursive functions?"}, {"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555529040, "post_id": 55734443, "comment_id": 98147702, "body": "And can i create something like the garbage collector myself? So somehow clean the stack?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1555529086, "post_id": 55734443, "comment_id": 98147720, "body": "I&#39;m not aware of any language using a garbage collector that would clean the <i>stack</i> - garbage collectors usually only manage <i>heap</i> allocated memory"}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1555529567, "post_id": 55734443, "comment_id": 98147934, "body": "@JohnSmith you can use recursion, but this is unrelated to garbage collection which is about heap allocated objects, not the call stack."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 3, "creation_date": 1555530469, "post_id": 55734443, "comment_id": 98148274, "body": "Several misconceptions here: 1: The above breaks Java (unless the compiler optimizes out the tail recursion). Same thing happens in C++. 2: Garbage collection does not affect the stack (it cleans the heap). 3: C++ does have garbage collectors (they are just not very popular as we have a better method of cleaning up memory that is deterministic)."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 2, "last_activity_date": 1555528917, "creation_date": 1555528917, "answer_id": 55734632, "question_id": 55734443, "link": "https://stackoverflow.com/questions/55734443/how-to-enable-a-recursive-function-to-avoid-stack-overflow/55734632#55734632", "title": "How to enable a recursive function to avoid stack overflow?", "body": "<p>There is no standard way to force a c++ compiler to perform tail-call optimisation on a recursive function.</p>\n\n<p>Having said that, gcc8 with -O2 will actually perform tail-call optimisation when possible.</p>\n\n<p><a href=\"https://godbolt.org/z/tSDODA\" rel=\"nofollow noreferrer\">https://godbolt.org/z/tSDODA</a></p>\n"}], "owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55734632, "answer_count": 1, "score": 0, "last_activity_date": 1555529459, "creation_date": 1555528122, "last_edit_date": 1555529459, "question_id": 55734443, "link": "https://stackoverflow.com/questions/55734443/how-to-enable-a-recursive-function-to-avoid-stack-overflow", "title": "How to enable a recursive function to avoid stack overflow?", "body": "<p>If I have a recursive function in Java, I can call it infinitely with the following code:</p>\n\n<pre><code>void recfunction()\n{\n    recfunction();\n    System.gc();\n}\n</code></pre>\n\n<p>How can I do this in C++? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1555529051, "post_id": 55734441, "comment_id": 98147708, "body": "According to the error message it\u2019s trying to initialize an object of type <code>int</code> with a value of type <code>unsigned long long</code>, and an <code>int</code> Is too small."}], "answers": [{"comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555529220, "post_id": 55734684, "comment_id": 98147774, "body": "Where is this <code>int</code> it&#39;s being assigned to?"}, {"owner": {"reputation": 4485, "user_id": 2205033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d36e28c13c9214b2281af2d12916b?s=128&d=identicon&r=PG", "display_name": "Johannes Overmann", "link": "https://stackoverflow.com/users/2205033/johannes-overmann"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555529471, "post_id": 55734684, "comment_id": 98147890, "body": "@chris: Yes! This is the actual question! :-) I assume that __m64 is not a real type to the compiler. It stands for a MM register."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1555529683, "post_id": 55734684, "comment_id": 98147974, "body": "@chris: it&#39;s the __m64. GCC uses the semantic of <code>int[2]</code> for __m64. But this is not necessarily a portable thing. For example, clang uses <code>long long[1]</code> instead."}], "tags": [], "owner": {"reputation": 4485, "user_id": 2205033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d36e28c13c9214b2281af2d12916b?s=128&d=identicon&r=PG", "display_name": "Johannes Overmann", "link": "https://stackoverflow.com/users/2205033/johannes-overmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1555529382, "last_edit_date": 1555529382, "creation_date": 1555529142, "answer_id": 55734684, "question_id": 55734441, "link": "https://stackoverflow.com/questions/55734441/error-narrowing-conversion-of-18446744069414584320ull-from-long-long-unsigne/55734684#55734684", "title": "error: narrowing conversion of \u201818446744069414584320ull\u2019 from \u2018long long unsigned int\u2019 to \u2018int\u2019 inside { } [-Wnarrowing]", "body": "<p>The part <code>const_epi32(0, 0,-1, -1)</code> is causing the warning since you are assigning '0xffffFFFFffffFFFF' to a 32 bit 'int' which is narrowing. </p>\n\n<p>I assume the other cases do not cause a warning since the assigned value is a constant 0 which does not suffer from narrowing.</p>\n\n<p>The other question is, why is <code>__m64</code> an <code>int</code>. I assume that <code>__m64</code> cannot be directly assigned to (being an MM register) and that the narrowing check (at least for constant assignment) is bogus in the compiler.</p>\n"}, {"comments": [{"owner": {"reputation": 840, "user_id": 401736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fcdd532dfaeb387028b088e88a19fdeb?s=128&d=identicon&r=PG", "display_name": "StNickolay", "link": "https://stackoverflow.com/users/401736/stnickolay"}, "edited": false, "score": 0, "creation_date": 1555576394, "post_id": 55735091, "comment_id": 98161156, "body": "yep, you are absolutely right. Your suggestion bring back to my mind that we have special load intrinsics. I rewrite const_epi32 macro as in my post below."}], "tags": [], "owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "is_accepted": true, "score": 1, "last_activity_date": 1555530957, "creation_date": 1555530957, "answer_id": 55735091, "question_id": 55734441, "link": "https://stackoverflow.com/questions/55734441/error-narrowing-conversion-of-18446744069414584320ull-from-long-long-unsigne/55735091#55735091", "title": "error: narrowing conversion of \u201818446744069414584320ull\u2019 from \u2018long long unsigned int\u2019 to \u2018int\u2019 inside { } [-Wnarrowing]", "body": "<p>The types <code>__m64</code> and <code>__m128</code> are very special, representing vector registers, which means that you cannot assign values to them in the usual way (like you seem to be trying to do in your code). You need to use special load functions to put data into registers, and special store functions to get data back from there.</p>\n\n<p>Here is an example of how you could load data (four floats) into a <code>__m128</code> variable:</p>\n\n<pre><code>#include &lt;cstring&gt;\n#include &lt;smmintrin.h&gt;\nint main() {\n  float f[4];\n  memset(f, 0, 16);\n  __m128 a = _mm_load_ps(f);\n  return 0;\n}\n</code></pre>\n\n<p>This page has lots of info about all the different types and intrinsic functions available: <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/\" rel=\"nofollow noreferrer\">https://software.intel.com/sites/landingpage/IntrinsicsGuide/</a></p>\n"}, {"comments": [{"owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 0, "creation_date": 1555578516, "post_id": 55742134, "comment_id": 98162372, "body": "It looks strange that your macro has four input arguments i3 i2 i1 i0 but it only uses two of them; i2 and i0 are unused?"}, {"owner": {"reputation": 840, "user_id": 401736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fcdd532dfaeb387028b088e88a19fdeb?s=128&d=identicon&r=PG", "display_name": "StNickolay", "link": "https://stackoverflow.com/users/401736/stnickolay"}, "reply_to_user": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 0, "creation_date": 1555588236, "post_id": 55742134, "comment_id": 98167553, "body": "Oh. it&#39;s just snippet from real code, just to localize root cause of problem:)"}], "tags": [], "owner": {"reputation": 840, "user_id": 401736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fcdd532dfaeb387028b088e88a19fdeb?s=128&d=identicon&r=PG", "display_name": "StNickolay", "link": "https://stackoverflow.com/users/401736/stnickolay"}, "is_accepted": false, "score": 1, "last_activity_date": 1555576491, "creation_date": 1555576491, "answer_id": 55742134, "question_id": 55734441, "link": "https://stackoverflow.com/questions/55734441/error-narrowing-conversion-of-18446744069414584320ull-from-long-long-unsigne/55742134#55742134", "title": "error: narrowing conversion of \u201818446744069414584320ull\u2019 from \u2018long long unsigned int\u2019 to \u2018int\u2019 inside { } [-Wnarrowing]", "body": "<pre><code>#define const_epi32( i3,i2,i1,i0 )      \\\n        { _m_from_int64( (static_cast&lt;unsigned long long&gt;(i1) &lt;&lt; 32), \\\n          _m_from_int64( (static_cast&lt;unsigned long long&gt;(i3) &lt;&lt; 32) }\n</code></pre>\n"}], "owner": {"reputation": 840, "user_id": 401736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fcdd532dfaeb387028b088e88a19fdeb?s=128&d=identicon&r=PG", "display_name": "StNickolay", "link": "https://stackoverflow.com/users/401736/stnickolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 55735091, "answer_count": 3, "score": 2, "last_activity_date": 1555576491, "creation_date": 1555528112, "last_edit_date": 1555528217, "question_id": 55734441, "link": "https://stackoverflow.com/questions/55734441/error-narrowing-conversion-of-18446744069414584320ull-from-long-long-unsigne", "title": "error: narrowing conversion of \u201818446744069414584320ull\u2019 from \u2018long long unsigned int\u2019 to \u2018int\u2019 inside { } [-Wnarrowing]", "body": "<p>What is wrong with this piece of code? I'm using GCC 6.3.</p>\n\n<p><a href=\"https://ideone.com/ektGEp\" rel=\"nofollow noreferrer\">https://ideone.com/ektGEp</a></p>\n\n<blockquote>\n  <p>a.cpp: In function \u2018int main()\u2019:`a.cpp:26:24: error: narrowing conversion of \u201818446744069414584320ull\u2019 from \u2018long long unsigned int\u2019 to \u2018int\u2019 inside { } [-Wnarrowing]</p>\n</blockquote>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n#include &lt;smmintrin.h&gt;\n#include &lt;emmintrin.h&gt;\n#include &lt;tmmintrin.h&gt;\n\ntypedef union {\n        __m64  mm64[2];\n        __m128 mm128i;\n} sse2_t;\n\n#define const_epi32( i3,i2,i1,i0 )      \\\n            { static_cast&lt;unsigned long long&gt; (static_cast&lt;unsigned long long&gt;(i1) &lt;&lt; 32), \\\n              static_cast&lt;unsigned long long&gt; (static_cast&lt;unsigned long long&gt;(i3) &lt;&lt; 32) }\n\nint main() {\n\n        sse2_t arr_val[3] = { const_epi32(0,-1,0,-1),\n                          const_epi32(0, 0,-1, -1),\n                          const_epi32(0, 0,0, 1024) \n                        }; //error!\n\n        sse2_t val = const_epi32(0,-1,0,-1); // ok!\n        // your code goes here\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 7, "creation_date": 1555527805, "post_id": 55734338, "comment_id": 98147153, "body": "It is a reference to a pointer of type <code>Data</code>. So it behaves like a pointer but if you change its value you will also change the original pointer."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1555527882, "post_id": 55734338, "comment_id": 98147184, "body": "The return type of the <code>GetNext</code> is a reference to pointer. Not really different from returning <code>int&amp;</code> - you wouldn&#39;t say the function returns both <code>int</code> and a reference?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1555528251, "creation_date": 1555528251, "answer_id": 55734472, "question_id": 55734338, "link": "https://stackoverflow.com/questions/55734338/using-pointer-and-reference-as-return-type-in-same-function/55734472#55734472", "title": "Using pointer and reference as return type in same function", "body": "<p><code>X *</code> is a pointer to a <code>X</code>.</p>\n\n<p><code>T &amp;</code> is a reference to a <code>T</code>. If <code>T</code> happens to be a pointer type, then it is a reference to a pointer: <code>X* &amp;</code> is a reference to a <code>X*</code>.</p>\n\n<p>As such, <code>Data*&amp;</code> is a reference to a pointer to a <code>Data</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 2, "last_activity_date": 1555528650, "creation_date": 1555528650, "answer_id": 55734556, "question_id": 55734338, "link": "https://stackoverflow.com/questions/55734338/using-pointer-and-reference-as-return-type-in-same-function/55734556#55734556", "title": "Using pointer and reference as return type in same function", "body": "<p>The value returned from <code>GetNext()</code> is a reference to a pointer to <code>Data</code>. This means it acts just like a pointer but if you change the value it will change the original object.</p>\n\n<pre><code>int main()\n{\n     Data*   d1 = new Data(1);\n     std::cout &lt;&lt; d1-&gt;GetData() &lt;&lt; \" : \" &lt;&lt; d1-&gt;GetNext()   // prints null;\n               &lt;&lt; \"\\n\";\n\n     d1-&gt;getNext() = new Data(2);   // Modify the value.\n\n     std::cout &lt;&lt; d1-&gt;GetData() &lt;&lt; \" : \" &lt;&lt; d1-&gt;GetNext()   // Does not print null\n               &lt;&lt; \" -&gt; \" \n               &lt;&lt;  d1-&gt;GetNext()-&gt;GetData() &lt;&lt; \" : \" &lt;&lt; d1-&gt;GetNext()-&gt;GetNext()\n               &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10496125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094ec7aa8f77a1e46e86de541ddd68c3?s=128&d=identicon&r=PG&f=1", "display_name": "LaughingKid", "link": "https://stackoverflow.com/users/10496125/laughingkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 55734472, "answer_count": 2, "score": 5, "last_activity_date": 1555528650, "creation_date": 1555527632, "last_edit_date": 1555527837, "question_id": 55734338, "link": "https://stackoverflow.com/questions/55734338/using-pointer-and-reference-as-return-type-in-same-function", "title": "Using pointer and reference as return type in same function", "body": "<p>So I was looking at some code and I came across this.</p>\n\n<pre><code>class Data{\n private:\n  int data;\n  Data* next;\n public:\n   Data(int d=0): data(d), next(NULL) {}\n   void SetData(int d) { data = d;}\n   int  GetData() { return data; }\n   Data*&amp; GetNext() { return next; }\n }\n</code></pre>\n\n<p>The <code>GetNext()</code> return type is both the reference and pointer as return type. What does this mean? </p>\n"}, {"tags": ["c++", "enterprise-architect"], "comments": [{"owner": {"reputation": 30989, "user_id": 3379653, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/f97JZ.png?s=128&g=1", "display_name": "qwerty_so", "link": "https://stackoverflow.com/users/3379653/qwerty-so"}, "edited": false, "score": 0, "creation_date": 1555576161, "post_id": 55734136, "comment_id": 98161030, "body": "Unless Geert will be looking during Easter I guess you should cross-post on Sparx&#39; forum. The Sparxians (almost) don&#39;t answer here but only on their forum."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1555737434, "post_id": 55734136, "comment_id": 98214320, "body": "I am looking, but I don&#39;t know anything about reverse engineering C++, sorry. I would probably contact Sparx support."}], "owner": {"reputation": 3, "user_id": 4379191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2856634a57b3664be5edb457e1ac6112?s=128&d=identicon&r=PG&f=1", "display_name": "mts", "link": "https://stackoverflow.com/users/4379191/mts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555526732, "creation_date": 1555526732, "question_id": 55734136, "link": "https://stackoverflow.com/questions/55734136/enterprise-architecture-not-importing-c-code-reverse-engineering-with-type-a", "title": "Enterprise Architecture not importing c++ code (reverse engineering) with type alias with &#39;using&#39; in the class", "body": "<p>I am trying to import a c++ template class into Enterprise Architect project, but doesn't show anything after import successfully. The template class has type aliases defined, with 'using' statement. E.g. </p>\n\n<pre><code>using my_type_t = decltype(T::struct_mem_1);\nusing type_2_t = typename T_2::value_type;\n</code></pre>\n\n<p>When I remove the above aliases, then it is able to import and synchronize. So, is there any reason why it is behaving like this? And any workaround, so that I can synchronize without having to remove first the aliases and then add them back after synchronization?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "cmake", "linker", "dependencies", "static-libraries"], "comments": [{"owner": {"reputation": 76, "user_id": 11171590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5291fce985c4975a9c74018ed9401342?s=128&d=identicon&r=PG&f=1", "display_name": "tswanson-cs", "link": "https://stackoverflow.com/users/11171590/tswanson-cs"}, "edited": false, "score": 0, "creation_date": 1555526572, "post_id": 55734040, "comment_id": 98146655, "body": "This is a helpful page for understanding cmake:<a href=\"https://github.com/pr0g/cmake-examples#modern-cmake-examples\" rel=\"nofollow noreferrer\">github.com/pr0g/cmake-examples#modern-cmake-examples</a>"}, {"owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "reply_to_user": {"reputation": 76, "user_id": 11171590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5291fce985c4975a9c74018ed9401342?s=128&d=identicon&r=PG&f=1", "display_name": "tswanson-cs", "link": "https://stackoverflow.com/users/11171590/tswanson-cs"}, "edited": false, "score": 0, "creation_date": 1555526646, "post_id": 55734040, "comment_id": 98146680, "body": "Thanks @ThomasSwanson I would check that first"}, {"owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1555527622, "post_id": 55734040, "comment_id": 98147093, "body": "Yea @Amadeus many answers I found there are resolving static libraries dependencies with gcc. Not with CMake. At least I didn&#39;t find out solution here, I have searched over the forum and tried the methods for hours. But none works for me."}, {"owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1555528681, "post_id": 55734040, "comment_id": 98147553, "body": "@Amadeus However my static library is from an external build. I don&#39;t want to include it as a submodule in my project."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1555529150, "post_id": 55734040, "comment_id": 98147741, "body": "On Ubuntu 16.04 your toolchain is GCC, or possibly clang. The system linker&#39;s static library linkage rules apply: a library must be appear in the linkage sequence before those that it depends on. <code>A.a B.a C.a</code> is the wrong order. <code>C.a B.a A.a</code> is the right order."}, {"owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "reply_to_user": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1555530282, "post_id": 55734040, "comment_id": 98148194, "body": "@MikeKinghan Thanks! You are correct."}], "owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1555527072, "answer_count": 0, "score": 0, "last_activity_date": 1555530431, "creation_date": 1555526318, "last_edit_date": 1555530431, "question_id": 55734040, "link": "https://stackoverflow.com/questions/55734040/how-to-correctly-link-3-static-libraries-with-dependencies-with-cmake", "closed_reason": "Duplicate", "title": "How to correctly link 3 static libraries with dependencies with cmake?", "body": "<p>I am importing three static libraries (A.a, B.a, C.a) with C depends on A and B, B depends on A. In my program I use functions in C. </p>\n\n<p>(Ubuntu 16.04 and CMake 3.5.1) In my cmake file I use target_link_libraries() to link A.a, B.a, C.a with ordered to my executable file. However when compiling it shows \"undefined reference to funcA()\", where funA is Undefined Symbol in C.a (showed with nm command), this function is actually defined in A.a as a Text Symbol.</p>\n\n<pre><code>target_link_libraries(myExec A.a B.a C.a)\n</code></pre>\n\n<p>I expect to see linking static libraries correctly without those undefined symbol.</p>\n\n<p><strong>Update</strong>\nAs Mike mentioned in the comment: </p>\n\n<blockquote>\n  <p>a library must be appear in the linkage sequence before those that it depends on</p>\n</blockquote>\n\n<p>Therefore, </p>\n\n<pre><code>target_link_libraries(myExec C.a B.a A.a)\n</code></pre>\n\n<p>is the correct order</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1555526074, "post_id": 55733956, "comment_id": 98146431, "body": "While there is a way to make it compile, I urge you not go this road. Best you can do in given scenario is to make your members public and drop getters/setters altogether."}, {"owner": {"reputation": 803, "user_id": 11024660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6673cc05490facc3f5c10dac0ef91f51?s=128&d=identicon&r=PG&f=1", "display_name": "Chriss555888", "link": "https://stackoverflow.com/users/11024660/chriss555888"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1555526469, "post_id": 55733956, "comment_id": 98146608, "body": "@SergeyA Well, the example is just an example - a stupid one, just to give the idea of what I want to achieve. I would like to implement something similar in a class where making some of the members private actually makes sense, and using getters for these members is necessary. Why do you think using a single <code>get</code> method for all private members that need a getter is a bad idea?"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1555526568, "post_id": 55733956, "comment_id": 98146650, "body": "It would seem like you&#39;d probably want to have a look at <a href=\"https://en.cppreference.com/w/cpp/utility/tuple\" rel=\"nofollow noreferrer\">std::tuple</a>\u2026"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1555526586, "post_id": 55733956, "comment_id": 98146660, "body": "@Chriss555888 unless you implement something like <code>std::tuple</code>, you better have meaningful names."}, {"owner": {"reputation": 803, "user_id": 11024660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6673cc05490facc3f5c10dac0ef91f51?s=128&d=identicon&r=PG&f=1", "display_name": "Chriss555888", "link": "https://stackoverflow.com/users/11024660/chriss555888"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1555526607, "post_id": 55733956, "comment_id": 98146665, "body": "@SergeyA  And I am very curious why it won&#39;t compile as it is now. I don&#39;t work with templates very often, so I possibly got something wrong."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1555526780, "post_id": 55733956, "comment_id": 98146725, "body": "It most likely doesn&#39;t compile because <code>string</code> (whatever that may be exactly) most likely cannot be converted to <code>int</code> or <code>double</code>. Thus, instantiating <code>get&lt;T&gt;</code> with either of those types as <code>T</code> will not lead to a valid function because <code>return s;</code> won&#39;t fly when the return type is not <code>string</code> (or something that string can be converted to)\u2026"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1555527806, "post_id": 55733956, "comment_id": 98147154, "body": "imho already having getters for private members is the mess. Doesnt really matter how many of them or what type. Getters arent really about encapsulation but about trying to pretend there was encapsulation."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555528010, "post_id": 55733956, "comment_id": 98147230, "body": "interfaces should be about interactions of objects. Instead of provide getters such that users of the class can ask for things like &quot;gimme your data so I can do soemthing with it&quot;, rather make them ask for &quot;do something&quot;"}, {"owner": {"reputation": 803, "user_id": 11024660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6673cc05490facc3f5c10dac0ef91f51?s=128&d=identicon&r=PG&f=1", "display_name": "Chriss555888", "link": "https://stackoverflow.com/users/11024660/chriss555888"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555528984, "post_id": 55733956, "comment_id": 98147677, "body": "@user463035818 While I agree with you that getters are not flawless, and I would even dare to say that the core idea of encapsulation is simply lame, the imperfections of the design and core ideas of OOP are not what the question was about. However, getters for private members, if in a reasonable amount, are, after all, a common practice. And, as means for read-only access to private members from outside the class, getters work just fine, while they also allow us to adhere to some principles of OOP at the same time."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555529136, "post_id": 55733956, "comment_id": 98147740, "body": "yeah sorry for going offtopic, the question was kind of settled so I didnt feel it was adding too much distraction. You seem to have made peace with something I am still struggling with ;). I still get excited by ppl mechanically writing getters and setters for everything and believing that would be what OOP is about"}], "answers": [{"comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 803, "user_id": 11024660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6673cc05490facc3f5c10dac0ef91f51?s=128&d=identicon&r=PG&f=1", "display_name": "Chriss555888", "link": "https://stackoverflow.com/users/11024660/chriss555888"}, "edited": false, "score": 0, "creation_date": 1555530114, "post_id": 55734220, "comment_id": 98148127, "body": "@Chriss555888 implementing a tuple like structure is quite tricky but enlightening. It shows the complexity of implementing something actually simple"}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 3, "last_activity_date": 1555527106, "creation_date": 1555527106, "answer_id": 55734220, "question_id": 55733956, "link": "https://stackoverflow.com/questions/55733956/get-method-that-can-return-more-than-one-type-using-template/55734220#55734220", "title": "Get method that can return more than one type using template", "body": "<p>What do you think will happen in this case?</p>\n\n<pre><code>TYPE t = DOUBLE;\nif (rand() % 2 == 0) {\n    t = INT;\n}\n\nint i = foo.get&lt;int&gt;(t); // t might be INT or DOUBLE\n</code></pre>\n\n<p>It cannot make sense, since the <code>TYPE</code> parameter is a runtime value, and you rely on it to choose the return type, which must be known at compile time.</p>\n\n<p>Also, when you do the <code>switch</code> statement, the compiler <em>has</em> to compile the whole switch statement, even the cases that might not be invoked.</p>\n\n<p>Imagine the <code>get&lt;int&gt;</code> member function being instantiated:</p>\n\n<pre><code>template&lt;&gt;\nauto get&lt;int&gt;(TYPE type) -&gt; int {\n    switch (type) { // type might be anything\n    case INT:\n        return i;   // return int\n    case DOUBLE:\n        return d;   // return double\n    case DOUBLE2:\n        return d2;  // return double\n    case STRING:\n        return s;   // return string\n    }\n}\n</code></pre>\n\n<p>This cannot compile. The function clearly return an <code>int</code>, yet in some branch it returns other types.</p>\n\n<p>A proper solution would be to drop the enum completely and use something like <code>constexpr if</code> to denote a compile time branch, and instead of sending both a typename and a value, rely only on the typename.</p>\n\n<p>If you want to learn more about how to implement that kind of data structure, I suggest you go read about <a href=\"https://en.cppreference.com/w/cpp/utility/tuple\" rel=\"nofollow noreferrer\"><code>std::tuple</code></a></p>\n"}], "owner": {"reputation": 803, "user_id": 11024660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6673cc05490facc3f5c10dac0ef91f51?s=128&d=identicon&r=PG&f=1", "display_name": "Chriss555888", "link": "https://stackoverflow.com/users/11024660/chriss555888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55734220, "answer_count": 1, "score": -1, "last_activity_date": 1555527106, "creation_date": 1555525953, "question_id": 55733956, "link": "https://stackoverflow.com/questions/55733956/get-method-that-can-return-more-than-one-type-using-template", "title": "Get method that can return more than one type using template", "body": "<p>Having multiple <code>get</code> methods for multiple private members makes a class quite messy. I would like to implement a single <code>get</code> method that is able to return whichever member I need.</p>\n\n<pre><code>enum TYPE {INT, DOUBLE, DOUBLE2, STRING};\n\nclass Foo {\nint i     = 1;\ndouble d  = 2.5;\ndouble d2 = 6.0;\nstring s  = \"string\";\n\npublic:\n\ntemplate&lt;typename T&gt;\nT get(TYPE type) {\n    switch (type) {\n    case INT:\n        return i;\n    case DOUBLE:\n        return d;\n    case DOUBLE2:\n        return d2;\n    case STRING:\n        return s;\n    }\n}\n</code></pre>\n\n<p>The method would then be used like this:</p>\n\n<pre><code>Foo foo;\nint integer = foo.get&lt;int&gt;(INT);\ndouble d2   = foo.get&lt;double&gt;(DOUBLE2);\n</code></pre>\n\n<p>Why won't it compile?</p>\n"}, {"tags": ["c++", "numerical-methods", "arbitrary-precision"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 4, "creation_date": 1555525962, "post_id": 55733940, "comment_id": 98146387, "body": "<code>It looks like the program knows already it won&#39;t reach that level of tolerance</code> That&#39;s clearly not the case here. That would be cool though!!"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1555526018, "post_id": 55733940, "comment_id": 98146409, "body": "My advice is to debug on an IDE with an integrated debugger. That way you will be able to see what it does instead of guessing."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1555526293, "post_id": 55733940, "comment_id": 98146527, "body": "For a quick debug, add <code>cout &lt;&lt; pnew &lt;&lt; &#39;\\n&#39;;</code> after <code>pnew = p - f&#47;dfdx;</code> and I suspect you will see it run 100 times... Adding <code>if (!(cin &gt;&gt; tol)) { cerr &lt;&lt; &quot;error: invalid input - tol\\n&quot;; return 1; }</code> and similar <b><i>validation</i></b> of EVERY input can also be illuminating...."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1555526302, "post_id": 55733940, "comment_id": 98146532, "body": "Unrelated: <code>#define N 100</code> is high risk. Everything named <code>N</code> will be silently replaced by 100 before the program compiles resulting in some truly bizarre error messages if you accidentally reuse <code>N</code>. Prefer <code>constexpr int N = 100;</code>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555526308, "post_id": 55733940, "comment_id": 98146537, "body": "This should help with what @Fran&#231;oisAndrieux said:  <a href=\"https://en.cppreference.com/w/cpp/types/numeric_limits\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/numeric_limits</a>"}, {"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1555526909, "post_id": 55733940, "comment_id": 98146782, "body": "I did like @DavidC.Rankin in his comment and in this case it says &quot;Enter starting value x: 0.25&quot; then run the code and fail to reach converge. It looks like it is exactly like you said, but what&#39;s strange is that pnew, between all possible values, takes a value very close to the root which 2.42"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1555527416, "post_id": 55733940, "comment_id": 98147004, "body": "1e-600 is a uselessly small number. The Planck length is 1.6e-35 metres, which is 1.6e565 times larger."}, {"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1555527508, "post_id": 55733940, "comment_id": 98147044, "body": "@molbdnilo I know it&#39;s a stupid number, that&#39;s why I tried to put it, to see what happened. Plus I don&#39;t get the reference to Planck lengtt, i can invent a unit system in which it is exactly 1e-600, or exactly 1, like it is in Planckian units"}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555526826, "post_id": 55734049, "comment_id": 98146741, "body": "I did like @David C. Rankin said in his comment and in this case it says &quot;Enter starting value x: 0.25&quot; then run the code and fail to reach converge. It looks like it is exactly like you said, but what&#39;s strange is that pnew, between all possible values, takes a value very close to the root"}], "tags": [], "owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "is_accepted": false, "score": 1, "last_activity_date": 1555526359, "creation_date": 1555526359, "answer_id": 55734049, "question_id": 55733940, "link": "https://stackoverflow.com/questions/55733940/why-does-the-program-ends-even-before-running/55734049#55734049", "title": "Why does the program ends even before running?", "body": "<p>As mentioned, <code>1e-600</code> is not a valid <code>double</code> value. However, there's more to it than being outside of the range. What's likely happening is that 1 is scanned into <code>tol</code>, and then some portion of <code>e-600</code> is being scanned into <code>pnew</code>, and that's why it ends immediately, instead of asking for input for <code>pnew</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555527577, "post_id": 55734063, "comment_id": 98147073, "body": "So if I understand it correctly it should either set tol=0 or set it the the minimum value representable right? Sorry I don&#39;t really know much, I wouldn&#39;t even know what &quot;failbit is set&quot; means"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 2, "creation_date": 1555527898, "post_id": 55734063, "comment_id": 98147189, "body": "@Runlikehell The streams have error bits, flags that indicate possible error states a stream can be in. If the fail bit is set, it means the stream failed to perform an operation and doesn&#39;t trust it&#39;s current state. While the stream is in a failed state, it will fail any other input operation. Another commonly used bit is the End Of File (EOF) bit, which is set when trying to read from a stream that has reached the end of it&#39;s corresponding input. Again, the stream will fail any further attempt at getting input (for obvious reasons)."}, {"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555528355, "post_id": 55734063, "comment_id": 98147391, "body": "Thanks, clearer now. Could you look at the edit at the question and maybe guess why it takes the value of pnew=0.25, without even asking me?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555528573, "post_id": 55734063, "comment_id": 98147497, "body": "@Runlikehell It&#39;s not clear to me how you determined the value of <code>pnew</code>. And the behavior depends on which version of c++ you are using. I don&#39;t see how <code>pnew</code> could be <code>0.25</code> with c++17, but with earlier version a failed input operation leaves the value as it was, meaning uninitialized in this case. If this is the case, then you have undefined behavior from reading the value of an uninitialized variable."}, {"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555528839, "post_id": 55734063, "comment_id": 98147612, "body": "after I enter the meaningles tolerance, the console writes <code>Enter starting value x: 0.25</code> so i assumed It took that value"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555528919, "post_id": 55734063, "comment_id": 98147649, "body": "@Runlikehell No, that has to be something else. <code>std::cin</code> doesn&#39;t print anything. Most terminals will echo your input to the shell though, so it looks like it does. Edit : I can&#39;t see what would cause that output. Edit 2 : But if you have undefined behavior, anything is possible."}, {"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555529492, "post_id": 55734063, "comment_id": 98147902, "body": "another weird thing: if I tell it to print pnew at the very beginning of the loop, after the meaningless tolerance the console writes <code>Enter starting value x: 0</code> , but then when he has to print pnew for the first time he prints 0.25. I have always been kinda fascinated by weird machines behaviour, especially when exposed to meaningless things,  but if you don&#39;t have time or will to understand this one, which is probably not even very interesting, there&#39;s no need invest more time answering me."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555529591, "post_id": 55734063, "comment_id": 98147943, "body": "@Runlikehell It sounds an awful lot like undefined behavior. Try initializing all your variables and see what happens (the UB should go away). But diving into why UB exhibits itself in one way or another is beyond the scope of this question."}, {"owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "edited": false, "score": 0, "creation_date": 1555530129, "post_id": 55734063, "comment_id": 98148135, "body": "Yes, it disappears after initializing pnew. Still curious about why it assigns the value on its own when it&#39;s not initialized, but as you said this is not the place to discuss it, thanks."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 3, "last_activity_date": 1555526403, "creation_date": 1555526403, "answer_id": 55734063, "question_id": 55733940, "link": "https://stackoverflow.com/questions/55733940/why-does-the-program-ends-even-before-running/55734063#55734063", "title": "Why does the program ends even before running?", "body": "<p><code>1e-600</code> is not representable by most implementations of <code>double</code>. <code>std::cin</code> will fail to convert your input to <code>double</code> and fall into a failed state. This means that, unless you clear the error state, any future <code>std::cin</code> also automatically fails without waiting for user input.</p>\n\n<p>From <a href=\"https://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt\" rel=\"nofollow noreferrer\">cppreference</a> (since c++17) : </p>\n\n<blockquote>\n  <p>If extraction fails, zero is written to value and <code>failbit</code> is set. If extraction results in the value too large or too small to fit in value, <code>std::numeric_limits&lt;T&gt;::max()</code> or <code>std::numeric_limits&lt;T&gt;::min()</code> is written and <code>failbit</code> flag is set.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 4515010, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh6.googleusercontent.com/-lyN8vuEXTOc/AAAAAAAAAAI/AAAAAAAAAEA/7mhsys1qfis/photo.jpg?sz=128", "display_name": "Yvain", "link": "https://stackoverflow.com/users/4515010/yvain"}, "is_accepted": false, "score": 0, "last_activity_date": 1555526526, "creation_date": 1555526526, "answer_id": 55734091, "question_id": 55733940, "link": "https://stackoverflow.com/questions/55733940/why-does-the-program-ends-even-before-running/55734091#55734091", "title": "Why does the program ends even before running?", "body": "<p>Like Fran\u00e7ois said, you cannot exeed 2^64 when you work on an 64bit machine (with corresponding OS) and 2^32 on a 32bit machine, you can use SSE which are 4 32 bytes data used for floating point representation. In your program the function fails at every iteration and skips your test with \"if\" and so never returns before ending the loop.</p>\n"}], "owner": {"reputation": 277, "user_id": 3691695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e560d61bb97a8c3af97a6ce92a17e71?s=128&d=identicon&r=PG&f=1", "display_name": "RenatoRenatoRenato", "link": "https://stackoverflow.com/users/3691695/renatorenatorenato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 55734063, "answer_count": 3, "score": -2, "last_activity_date": 1555528095, "creation_date": 1555525887, "last_edit_date": 1555528095, "question_id": 55733940, "link": "https://stackoverflow.com/questions/55733940/why-does-the-program-ends-even-before-running", "title": "Why does the program ends even before running?", "body": "<p>I want to use this question to improve a bit in my general understanding of how computer works, since I'll probably never have the chance to study in a profound and deep manner. Sorry in advance if the question is silly and not useful in general, but I prefer to learn in this way.</p>\n\n<p>I am learning c++, I found online a code that implements the Newton-Raphson method for finding the root of a function. The code is pretty simple, as you can see from it, at the beginning it asks for the tolerance required, and if I give a \"decent\" number it works fine. If instead, when it asks for the tolerance I write something like <code>1e-600</code>, the program break down immediately and the output is <code>Enter starting value x: Failed to converge after 100 iterations</code> . </p>\n\n<p>The output of failed convergence should be a consequence of running the loop for more than 100 iterations, but this isn't the case since the loop doesn't even start. It looks like the program knows already it won't reach that level of tolerance. </p>\n\n<p>Why does this happen? How can the program write that output even if it didn't try the loop for 100 times? </p>\n\n<p><strong>Edit:</strong> It seems that everything meaningless (too small numbers, words) I write when it asks for tolerance produces a pnew=0.25 and then the code runs 100 times and fails. </p>\n\n<p>The code is the following:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n#define N 100    // Maximum number of iterations\n\n\nint main() {\n\n    double p, pnew;\n    double f, dfdx;\n    double tol;\n    int i;\n\n    cout &lt;&lt; \"Enter tolerance: \";\n    cin &gt;&gt; tol;\n    cout &lt;&lt; \"Enter starting value x: \";\n    cin &gt;&gt; pnew;\n    // Main Loop\n    for(i=0; i &lt; N; i++){\n        p = pnew;\n        //Evaluate the function and its derivative\n        f = 4*p - cos(p);\n        dfdx= 4 + sin(p);\n        // The Newton-Raphson step\n        pnew = p - f/dfdx;\n        // Check for convergence and quit if done\n        if(abs(p-pnew) &lt; tol){\n            cout &lt;&lt; \"Root is \" &lt;&lt; pnew &lt;&lt; \" to within \" &lt;&lt; tol &lt;&lt; \"\\n\";\n            return 0;\n        }\n    }\n    // We reach this point only if the iteration failed to converge\n    cerr &lt;&lt; \"Failed to converge after \" &lt;&lt; N &lt;&lt; \" iterations.\\n\";\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["android", "c++", "windows", "winapi", "usb"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1555532885, "post_id": 55733797, "comment_id": 98149237, "body": "It&#39; not possible. Create an android app which will receive the data you want through TCP."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1555536937, "post_id": 55733797, "comment_id": 98150679, "body": "One way to communicate with an Android device over USB is via the <a href=\"https://developer.android.com/studio/command-line/adb\" rel=\"nofollow noreferrer\">Android Debug Bridge</a>. It doesn&#39;t directly allow you to pass arbitrary data to the device, but it does allow you to share files, and create TCP connections to the device (amongst other things)."}], "owner": {"reputation": 808, "user_id": 9577324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Whgns.jpg?s=128&g=1", "display_name": "James Casia", "link": "https://stackoverflow.com/users/9577324/james-casia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555536762, "creation_date": 1555525293, "last_edit_date": 1555536762, "question_id": 55733797, "link": "https://stackoverflow.com/questions/55733797/how-to-write-data-to-an-android-phone-connected-through-usb-from-a-c-windows-d", "title": "How to write data to an Android phone connected through USB from a C++ Windows Desktop Application", "body": "<p>I am trying to develop a system wherein I need to save data directly to an Android smartphone connected through USB from a Windows desktop app written in C++. Since I'm targeting old Windows versions such as XP, I want to make the application as stand-alone as possible, that's why I'm not using .NET. </p>\n\n<p>I have searched Microsoft's docs and it doesn't seem to contain what I want. The closest that I've seen is <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/using-winusb-api-to-communicate-with-a-usb-device\" rel=\"nofollow noreferrer\">How to Access a USB Device by Using WinUSB Functions</a>, but that still doesn't contain what I'm looking for.</p>\n\n<p>So, given the absence of official docs, is it even possible? </p>\n"}, {"tags": ["c++", "pointers", "arduino", "pass-by-reference"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555525323, "post_id": 55733787, "comment_id": 98146094, "body": "It&#39;s important to understand that many symbols can mean different things in c++, depending on where they are used. Here, <code>&amp;</code> is the address-of operator and produces a pointer to the operand. It is unrelated to references, except that references happen to use the same symbol."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1555525356, "post_id": 55733787, "comment_id": 98146112, "body": "Sounds like you could use a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>  This will really help you to understand pointer and reference syntax."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1555525489, "post_id": 55733787, "comment_id": 98146168, "body": "<code>&amp;variable</code> obtains it&#39;s pointer. <code>type*</code> declare a pointer to <code>type</code>. <code>type&amp;</code> declares a reference to <code>type</code>. <code>*pointer</code> obtain the value of the variable it points to."}, {"owner": {"reputation": 115, "user_id": 6234366, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3e057ee9f1bb96e567e4df2e244606c?s=128&d=identicon&r=PG", "display_name": "Nischal", "link": "https://stackoverflow.com/users/6234366/nischal"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1555525793, "post_id": 55733787, "comment_id": 98146309, "body": "So &amp;Input is a pointer in this case and * is giving the value stored at Input location? Do I understand it correctly? @NathanOliver Thanks you for the book."}], "answers": [{"tags": [], "owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "is_accepted": false, "score": 1, "last_activity_date": 1555531244, "creation_date": 1555531244, "answer_id": 55735153, "question_id": 55733787, "link": "https://stackoverflow.com/questions/55733787/vs-arduino-class/55735153#55735153", "title": "* vs &amp; Arduino Class", "body": "<p>In this case &amp; is the address-of operator.</p>\n\n<p>The PID constructor's parameter list contains several pointers. <code>&amp;Input</code> returns the address of <code>Input</code>. What do pointers store? Addresses!</p>\n\n<p>For more info on the address-of operator &amp; read:</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/operator_member_access\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/operator_member_access</a></p>\n\n<blockquote>\n  <p>1) &amp;expr</p>\n  \n  <p>...</p>\n  \n  <p>1) If the operand is an lvalue expression of some object or function\n  type T, operator&amp; creates and returns a prvalue of type T*, with the\n  same cv qualification, that is pointing to the object or function\n  designated by the operand....</p>\n</blockquote>\n"}], "owner": {"reputation": 115, "user_id": 6234366, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3e057ee9f1bb96e567e4df2e244606c?s=128&d=identicon&r=PG", "display_name": "Nischal", "link": "https://stackoverflow.com/users/6234366/nischal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1555531244, "creation_date": 1555525258, "question_id": 55733787, "link": "https://stackoverflow.com/questions/55733787/vs-arduino-class", "title": "* vs &amp; Arduino Class", "body": "<p>Probably these kind of questions have been asked quite a few times and I also read a few blogs about pointers and references in C++. I have limited experience to C++. However, I was going through the following code from Arduino's PID library and I couldn't understand that during object instantiation the <strong>\"&amp;\"</strong> is used which looks to me like pass by reference. But why is the Class using <strong>\"*\"</strong>? </p>\n\n<pre><code>**************** Class instantiation ******************\n\nPID myPID(&amp;Input, &amp;Output, &amp;Setpoint, Kp, Ki, Kd, DIRECT);    \n\n**************** Code for class definition ******************\n\nPID(double*, double*, double*, Input, Output,double, double, double, int, int);\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1555525168, "post_id": 55733744, "comment_id": 98146018, "body": "All you need to do is make sure the index is valid for the container."}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 1, "creation_date": 1555526368, "post_id": 55733744, "comment_id": 98146566, "body": "Yep, it&#39;s automatically converted to the vector&#39;s <code>size_type</code>"}, {"owner": {"reputation": 1232, "user_id": 3426820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100003174453005/picture?type=large", "display_name": "SemperAmbroscus", "link": "https://stackoverflow.com/users/3426820/semperambroscus"}, "edited": false, "score": 0, "creation_date": 1555532686, "post_id": 55733744, "comment_id": 98149158, "body": "Did you even try?"}], "answers": [{"tags": [], "owner": {"reputation": 1699, "user_id": 11255447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df72cdbb62b1cf94eff00f4ae6c99e3?s=128&d=identicon&r=PG", "display_name": "aparpara", "link": "https://stackoverflow.com/users/11255447/aparpara"}, "is_accepted": false, "score": 5, "last_activity_date": 1555609763, "last_edit_date": 1555609763, "creation_date": 1555530582, "answer_id": 55734998, "question_id": 55733744, "link": "https://stackoverflow.com/questions/55733744/is-it-okay-to-access-vector-elements-with-an-integer-index/55734998#55734998", "title": "Is it okay to access vector elements with an integer index?", "body": "<p>Yes, is will be converted to <code>size_t</code> without any warnings or errors. But beware of negative values. If your <code>int i</code> is negative, the conversion will yield <code>std::numeric_limits&lt;size_t&gt;::max() + 1 - abs(i)</code>, usually a very large number which is likely to lead to undesirable consequences. So if the index can be negative, check it before the indexing.</p>\n\n<p><strong>UPD</strong>:\nStrictly speaking, there may be a warning depending on your compiler flags. In case of g++ there are two of them relevant here:</p>\n\n<ol>\n<li><code>-Wconversion</code> warns about conversions that may alter the value. In integer conversions this may occur when the destination type is smaller than the source (e.g. <code>int32_t y = 1000; int16_t x = y;</code>).</li>\n<li>Signed-unsigned conversions where the destination is unsigned (e.g. <code>int16_t y = -1; uint32_t x = y;</code>) or the destination is of the same size as the source (e.g. <code>unsigned int y = UINT_MAX; int x = y;</code>) may change the value too, and in C <code>-Wconversion</code> does issue the warning, but in C++ you need to add <code>-Wsign-conversion</code> to make it appear.</li>\n</ol>\n\n<p>I suspect they made the distinction in C++ precisely because people usually index <code>std::vector</code> using <code>int</code> and would have to make too much <code>static_cast</code>s to get rid of the warning if it appeared in this case.</p>\n\n<p>Microsoft CL covers the first case by warning C4244, turned on by /W3 or /W4, and for the second case I could'n find a warning switch. If someone knows, please tell in a comment.</p>\n\n<p>AFAIK, the C++ standard doesn't explicitly require <code>size_t</code> to be of equal size or larger than <code>int</code>. But I don't know any platform where it is not the case. So conversion from <code>int</code> to <code>size_t</code> falls into the second category.</p>\n\n<p>To summarize: most likely, you will not receive a warning for <code>int</code> to <code>size_t</code> conversion in C++, as I stated before, unless you are using g++ with <code>-Wsign-conversion</code> switch.</p>\n"}], "owner": {"reputation": 141, "user_id": 11370748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/401f06678435076b5d29b28ab1c394d4?s=128&d=identicon&r=PG&f=1", "display_name": "menaci342", "link": "https://stackoverflow.com/users/11370748/menaci342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1555609763, "creation_date": 1555525109, "last_edit_date": 1555525299, "question_id": 55733744, "link": "https://stackoverflow.com/questions/55733744/is-it-okay-to-access-vector-elements-with-an-integer-index", "title": "Is it okay to access vector elements with an integer index?", "body": "<p>I have some integer variables and a vector. I need to use the integer variable as a index in the vector. </p>\n\n<p>Is it okay to simply say <code>some_vector[some_integer]</code>?</p>\n\n<p>Or do I need to somehow convert the integer to a size type?</p>\n"}, {"tags": ["c++", "multithreading", "threadpool"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1555524000, "post_id": 55733459, "comment_id": 98145528, "body": "What does <code>GetFolderPath</code> do?"}, {"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1555524040, "post_id": 55733459, "comment_id": 98145548, "body": "@tkausl it just builds the path and returns it. That is a custom function that I have, and it works just fine. Basically it appends the &lt;+&gt; on the end of the path for specific indexes"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1555524122, "post_id": 55733459, "comment_id": 98145588, "body": "When non-<code>static</code>, <code>DtIndexer::ThreadedIndex</code> must be invoked on an <code>DtIndexer</code> instance to get a valid <code>this</code>. That instance is your missing parameter. If you don&#39;t need <code>this</code>, it&#39;s best to stay <code>static</code> or use a <a href=\"https://stackoverflow.com/questions/4861914/what-is-the-meaning-of-the-term-free-function-in-c\">free function</a>."}, {"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555524464, "post_id": 55733459, "comment_id": 98145741, "body": "@user4581301 Ahh... I see what you mean. Let me see what I can do with that"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555524692, "post_id": 55733459, "comment_id": 98145838, "body": "Warning: the <code>DtIndexer</code> instances must survive at least until the thread exits, so you&#39;ll have to keep them somewhere. If you are thinking of storing <code>DtIndexer</code> instances in a <code>vector</code>, you&#39;ll have to worry about <a href=\"https://stackoverflow.com/questions/6438086/iterator-invalidation-rules\">Iterator Invalidation</a>. With a bit more context on how you plan on using this code (and probably a bit more code) we can offer up better suggestions on how to get what you want."}, {"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555524763, "post_id": 55733459, "comment_id": 98145867, "body": "@user4581301 good to know. makes sense. looks like I need to re-think how I&#39;m structuring my code"}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 3, "creation_date": 1555524912, "post_id": 55733459, "comment_id": 98145919, "body": "Are you aware that in this line <code>thread(ThreadedIndex, folder)</code> is called <code>thread(&amp;ThreadedIndex, const char*)</code> which second param refers to local variable, and when iteration of for loop ends, string is destroyed. So when body of threads are executed string <code>folderPath</code> is created from dangling pointer. You should pass string by value instead of <code>const char*</code> to thread."}, {"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 1, "creation_date": 1555525609, "post_id": 55733459, "comment_id": 98146223, "body": "@rafix07 Yes, thank you. That was the problem. I&#39;m also going to look into the information user4581301 added as well. Thanks again all. If you want to post this as the answer (for my specific problem), I&#39;ll mark it as accepted"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1555526466, "post_id": 55733459, "comment_id": 98146607, "body": "Your question lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1555526583, "post_id": 55733459, "comment_id": 98146659, "body": "@UlrichEckhardt I&#39;d disagree, but that&#39;s fine :)"}], "answers": [{"comments": [{"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "edited": false, "score": 0, "creation_date": 1555526008, "post_id": 55733913, "comment_id": 98146405, "body": "Thank you, this makes perfect sense and coincides with what the other comments were suggesting. I appreciate the detailed explanation."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 3, "last_activity_date": 1555532502, "last_edit_date": 1555532502, "creation_date": 1555525765, "answer_id": 55733913, "question_id": 55733459, "link": "https://stackoverflow.com/questions/55733459/why-am-i-getting-duplicate-values-in-a-c-thread-function-call/55733913#55733913", "title": "Why am I getting duplicate values in a C++ thread function call?", "body": "<p>Replace </p>\n\n<pre><code>const char *folder = GetFolderPath(s, data.IncludeSubFolders);\n</code></pre>\n\n<p>with</p>\n\n<pre><code>std::string folder( GetFolderPath(s, data.IncludeSubFolders) );\n</code></pre>\n\n<p>The thread starts by copying the arguments by value and you copy a <code>const char*</code> which probably points to a static buffer in the <code>GetFolderPath</code> function. That buffer will be overwritten for each call you do so the threads that is reading from it may or may not get what you expect.</p>\n\n<p>Note that you don't need to do <code>emplace_back(std::thread(...</code> since what you write as arguments to <code>emplace_back</code> is forwarded to the constructor of the type your <code>vector</code> is holding, which in this case is <code>std::thread</code>. You also do not need to make the thread function <code>static</code> unless you really want to. You could start with a lambda, capturing <code>this</code> and <code>folder</code> by copy. Another thing you may notice is that the output gets garbled when many threads write to <code>std::cout</code> at the same time. You can guard common resources (like <code>std::cout</code>) against simultaneous accesses by multiple threads using <code>std::mutex</code> and <code>std::lock_guard</code>.</p>\n\n<p>Here's a version of your class with a non-static thread method and a guard for <code>std::cout</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cstring&gt;\n#include &lt;mutex&gt;\n#include &lt;thread&gt;\n\nconst char* GetFolderPath() {\n    static std::vector&lt;std::string&gt; paths = {\"this is a path\", \"here is another one\",\n                                             \"what do we have here\", \"mother of dirs\",\n                                             \"what did the tomatoe ...\"};\n    static size_t idx = 0;\n    static char buf[256];\n    std::strcpy(buf, paths[idx].c_str());\n    idx = (idx + 1) % paths.size();\n    return buf;\n}\n\nclass DtIndexer {\n    std::mutex mtx_cout; // std::cout mutex\n\npublic:\n    void ThreadedIndex(std::string folderPath) {\n        std::lock_guard lock(mtx_cout); // wait until this thread acquires the mutex\n        std::cout &lt;&lt; \"\\t-&gt; Indexing Folder: \" &lt;&lt; folderPath &lt;&lt; \"\\n\";\n    }\n\n    void UpdateIndex() {\n        std::vector&lt;std::thread&gt; threadList;\n\n        { // lock_guard scope\n            std::lock_guard lock(mtx_cout); // acquire mutex\n\n            for(int i = 0; i &lt; 50; ++i) {\n                // const char* folder = GetFolderPath();\n                std::string folder(GetFolderPath());\n\n                std::cout &lt;&lt; \"\\t-&gt; Adding Folder to Thread: \" &lt;&lt; folder &lt;&lt; \"\\n\";\n\n                //             safe copy here --+       +--- thread runs here ---+\n                //                              |       |                        |\n                //                              V       V                        V\n                threadList.emplace_back( [this, folder] { ThreadedIndex(folder); });\n                //                      \u0394\n                //                      |\n                //                      +-- no std::thread(... needed here\n            }\n        } // lock_guard releases mutex here\n\n        for(auto&amp; t : threadList) t.join();\n    }\n};\n\nint main() {\n    DtIndexer a;\n    a.UpdateIndex();\n}\n</code></pre>\n\n<p>You can replace the <code>folder</code> string above with a <code>const char*</code> and see the same problem you got.</p>\n"}], "owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 55733913, "answer_count": 1, "score": 3, "last_activity_date": 1555532502, "creation_date": 1555523791, "question_id": 55733459, "link": "https://stackoverflow.com/questions/55733459/why-am-i-getting-duplicate-values-in-a-c-thread-function-call", "title": "Why am I getting duplicate values in a C++ thread function call?", "body": "<p>I'm curious to what I'm doing wrong here. I have the following function:</p>\n\n<p>indexer.h:</p>\n\n<pre><code>class DtIndexer {\npublic:\n    static void ThreadedIndex(string folderPath);\n</code></pre>\n\n<p>indexer.cpp</p>\n\n<pre><code>void DtIndexer::ThreadedIndex(string folderPath) {\n    cout &lt;&lt; \"\\t-&gt; Indexing Folder: \" &lt;&lt; folderPath &lt;&lt; endl;\n    cout &lt;&lt; \"\\t-&gt;&gt; Done...\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>and my call to create the threads:</p>\n\n<pre><code>void DtIndexer::UpdateIndex(DatabaseData &amp;data, bool isCreate) {\n    vector&lt;thread&gt; threadList;\n\n    for (string &amp;s: data.FilePaths) {\n        const char *folder = GetFolderPath(s, data.IncludeSubFolders);\n        cout &lt;&lt; \"\\t-&gt; Adding Folder to Thread: \" &lt;&lt; folder &lt;&lt; endl;\n        threadList.emplace_back(thread(ThreadedIndex, folder));\n    }\n\n    for_each(threadList.begin(), threadList.end(), mem_fn(&amp;thread::join));\n}\n</code></pre>\n\n<p>My output is this:</p>\n\n<blockquote>\n  <p>-> Adding Folder to Thread: /index_2185&lt;+></p>\n  \n  <p>-> Adding Folder to Thread: /index_1065&lt;+>    </p>\n  \n  <p>-> Indexing Folder: /index_1065&lt;+></p>\n  \n  <p>->> Done...   </p>\n  \n  <p>-> Indexing Folder: /index_1065&lt;+>    </p>\n  \n  <p>->> Done...</p>\n</blockquote>\n\n<p>Now, I'm pretty sure it has to deal with the static for the method, but if I remove static I get this:</p>\n\n<blockquote>\n  <p>error: invalid use of non-static member function \u2018void\n  DtIndexer::ThreadedIndex(std::__cxx11::string)\u2019\n               threadList.emplace_back(thread(ThreadedIndex, folder));</p>\n</blockquote>\n\n<p>Also, If I remove <code>static</code> and add the function to the thread like this:</p>\n\n<pre><code>threadList.emplace_back(thread(&amp;DtIndexer::ThreadedIndex, folder));\n</code></pre>\n\n<p>I get:</p>\n\n<blockquote>\n  <p>required from here /usr/include/c++/6/functional:1286:7: error: static\n  assertion failed: Wrong number of arguments for pointer-to-member\n         static_assert(_Varargs::value</p>\n</blockquote>\n\n<p>I'm still fairly new to C++, so, any advice will be appreciated.</p>\n"}, {"tags": ["c++", "breadth-first-search"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "is_accepted": false, "score": 0, "last_activity_date": 1555524562, "creation_date": 1555524562, "answer_id": 55733632, "question_id": 55733436, "link": "https://stackoverflow.com/questions/55733436/how-to-resolve-an-infinite-loop-in-my-modified-bfs-program/55733632#55733632", "title": "How to resolve an Infinite loop in my modified BFS program?", "body": "<p>Mark the nodes you have already seen to make sure you do not visit them again (and again), for example using your .state:</p>\n\n<pre><code>if (entry.city == (itr).city &amp;&amp; !entry.state) {\n    //Initial condition for setting color/type to follow\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11375317, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IRSJAIkvdCU/AAAAAAAAAAI/AAAAAAAAAX8/GDhEUN5B6xQ/photo.jpg?sz=128", "display_name": "Allan M", "link": "https://stackoverflow.com/users/11375317/allan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555524562, "creation_date": 1555523677, "question_id": 55733436, "link": "https://stackoverflow.com/questions/55733436/how-to-resolve-an-infinite-loop-in-my-modified-bfs-program", "title": "How to resolve an Infinite loop in my modified BFS program?", "body": "<p>I have set up a code that will navigate a graph based on values associated with each edge between nodes. Each edge has a color and type associated with it, and I should only follow an edge in my BFS if the color or type matches the last color or Type. The first Color/Type is set by whatever first edge is followed. However, when I run my specific code, I get an infite loop someplace in the setup that will not resolve. </p>\n\n<p>I Have tried setting up different loop styles and looping through my list using iterators instead of the current for loop, neither works and both result in the same error. </p>\n\n<p>queue  Q;</p>\n\n<pre><code>Q.push(neededNode);\nstring lastType = \"\";\nstring lastColor = \"\";\nwhile (!Q.empty()){\n    node u = Q.front();\n    Q.pop();\n    for(auto&amp; itr : adjacencyList[u.city]){ //cycle through the adjacency list\n        for (auto&amp; entry: nodeList){ //find the node for the entry\n            if (entry.city == (itr).city){\n                //Initial condition for setting color/type to follow\n                if(lastType == \"\" || lastColor == \"\"){\n                    lastColor = (itr).color;\n                    lastType = (itr).type;\n                    entry.state = true;\n                    entry.distance = u.distance +1;\n                    entry.parent = u.city;\n                    cout &lt;&lt; u.city &lt;&lt; \" \" &lt;&lt; lastColor &lt;&lt; \" \" &lt;&lt; lastType &lt;&lt; endl;\n                //If Types match\n                }else if(lastType == (itr).type){\n                    lastColor = (itr).color;\n                    lastType = (itr).type;\n                    entry.state = true;\n                    entry.distance = u.distance +1;\n                    entry.parent = u.city;\n                    cout &lt;&lt; u.city &lt;&lt; \" \" &lt;&lt; lastColor &lt;&lt; \" \" &lt;&lt; lastType &lt;&lt; endl;\n                //If colors match\n                }else if(lastColor == (itr).color){\n                    lastColor = (itr).color;\n                    lastType = (itr).type;\n                    entry.state = true;\n                    entry.distance = u.distance +1;\n                    entry.parent = u.city;\n                    cout &lt;&lt; u.city &lt;&lt; \" \" &lt;&lt; lastColor &lt;&lt; \" \" &lt;&lt; lastType &lt;&lt; endl;\n                }\n                Q.push(entry);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Ideally, the code should run and stop running when complete, and I should be able to follow the parent values to the correct path. Currently, I get an infinite loop.</p>\n"}, {"tags": ["c++", "arrays", "pointers", "reference"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 6, "creation_date": 1555522433, "post_id": 55733073, "comment_id": 98144782, "body": "You&#39;re lucky you got just those items, as <code>std::cout</code> requires a null-terminated array of char, and you did not explicitly place a null entry at the end of that array."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1555522636, "post_id": 55733073, "comment_id": 98144885, "body": "&quot; using the reference syntax&quot; You are not using any reference syntax here. If you mean <code>&amp;test[0]</code>, this is the address-of operator which creates a pointer from its operand and is equivalent to just <code>test</code> in this context."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 4, "creation_date": 1555522671, "post_id": 55733073, "comment_id": 98144914, "body": "@PaulMcKenzie Some might say OP was <i>un</i>lucky in that the test mislead him/her to an incorrect conclusion."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1555522680, "post_id": 55733073, "comment_id": 98144919, "body": "You are making use of the char* functionality of std::cout used to print c-strings. @PaulMcKenzie explained that since you don&#39;t null terminate it you could get more data than you expect. This is undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1555523027, "post_id": 55733230, "comment_id": 98145094, "body": "Formally, passing a <code>char*</code> that doesn&#39;t point to null terminated array is undefined behavior. It <i>may</i> print the data and stop at the first <code>&#39;\\0&#39;</code>, but it might do anything else due to the transformations compilers are allowed to do or due to how the OS handles memory accesses."}], "tags": [], "owner": {"reputation": 7674, "user_id": 74819, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d7a3f99d0318b55b5be641d2d160ffa5?s=128&d=identicon&r=PG", "display_name": "Aric TenEyck", "link": "https://stackoverflow.com/users/74819/aric-teneyck"}, "is_accepted": true, "score": 5, "last_activity_date": 1555522780, "creation_date": 1555522780, "answer_id": 55733230, "question_id": 55733073, "link": "https://stackoverflow.com/questions/55733073/how-does-this-print-the-whole-array/55733230#55733230", "title": "How does this print the whole array?", "body": "<p><code>&amp;test[0]</code> is a pointer to a char, to the first character in an array.  </p>\n\n<p>Sending a <code>char *</code> to <code>cout</code> is the equivalent of printing a string.  The underlying logic will start dumping characters to the screen until it finds a NULL character, i.e. a <code>char</code> with a value of zero.</p>\n\n<p>As others have mentioned, you are just lucky that you apparently had a zero (uninitialized memory?) immediately after the end of your array.  Otherwise, the string printer would have kept going until it found one.</p>\n"}], "owner": {"reputation": 89, "user_id": 4363773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b9c4cb655ececaa96afed72e6091?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Lindstr&#246;m", "link": "https://stackoverflow.com/users/4363773/jens-lindstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55733230, "answer_count": 1, "score": 0, "last_activity_date": 1555522780, "creation_date": 1555522129, "last_edit_date": 1555522484, "question_id": 55733073, "link": "https://stackoverflow.com/questions/55733073/how-does-this-print-the-whole-array", "title": "How does this print the whole array?", "body": "<p>So I was messing around with vectors and the windows-api and someone suggested that I use a pointer to the first element in the vector as a buffer for a function.</p>\n\n<p>I went out and tried printing the array with the syntax and it printed the whole array and now I wonder why is that?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char test[10] = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j' };\nstd::cout &lt;&lt; &amp;test[0] &lt;&lt; std::endl;\n//output: abcdefghij\n</code></pre>\n\n<p>Edit 1:\nI found out that printing with the array name worked too, but this code suprised me becasue using the reference syntax it printed the char array in decreasing order. But without using the refrenece syntax it does not I wonder why is that?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (int i = 0; i &lt; 10; i++) {\n    std::cout &lt;&lt; &amp;test[0] + i &lt;&lt; \" \";\n}\n//outputs: abcdefghij bcdefghij cdefghij defghij efghij fghij ghij hij ij j\n</code></pre>\n"}, {"tags": ["c++", "delphi", "c++builder"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1555600608, "post_id": 55732963, "comment_id": 98174889, "body": "Well worth checking if the Chromium library initializes COM. If it does it is a bug and should be reported."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 10548418, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002062306660/picture?type=large", "display_name": "Aziz", "link": "https://stackoverflow.com/users/10548418/aziz"}, "edited": false, "score": 0, "creation_date": 1555537019, "post_id": 55736224, "comment_id": 98150707, "body": "Thank You ! Your are brilliant."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1555536500, "creation_date": 1555536500, "answer_id": 55736224, "question_id": 55732963, "link": "https://stackoverflow.com/questions/55732963/coinitializesecurity-cannot-succeeded-when-using-tchromium-cef3/55736224#55736224", "title": "CoInitializeSecurity cannot succeeded when using TChromium (CEF3)", "body": "<p>COM can be initialized only 1 time per thread. <code>CoInitialize/Ex()</code> can be called multiple times per thread (with corresponding <code>CoUninitialize()</code> calls for every <em>successful</em> <code>CoInitialize/Ex()</code> call), but COM will only be initialized on the first call, and subsequent calls will return either <code>S_FALSE</code> or <code>RPC_E_CHANGED_MODE</code> if COM has already been initialized on the calling thread.</p>\n\n<p>To solve your issue, try moving your WMI code to a separate worker thread, then you have total control over how you want to initialize COM for that thread, completely separate from how COM is initialized on the main UI thread.  Have your main thread create the WMI thread when needed and wait for it to terminate, then the WMI thread can query the device info and pass it back to the main thread.</p>\n"}], "owner": {"reputation": 149, "user_id": 10548418, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002062306660/picture?type=large", "display_name": "Aziz", "link": "https://stackoverflow.com/users/10548418/aziz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 55736224, "answer_count": 1, "score": 2, "last_activity_date": 1555536500, "creation_date": 1555521599, "question_id": 55732963, "link": "https://stackoverflow.com/questions/55732963/coinitializesecurity-cannot-succeeded-when-using-tchromium-cef3", "title": "CoInitializeSecurity cannot succeeded when using TChromium (CEF3)", "body": "<p>I have an application that is running a chromium client browser, and at some point I need to execute WMI code to access some device information, but it fails everytime. It is working only when the application is not using TChromium object. Possible TChromium(CEF3) Initializes the COM library, and only one instance is allowed on the current thread. I read that application should use CoInitializeEx with COINIT_APARTMENTTHREADED instead of CoInitialize.</p>\n\n<p>It is possible to access COM library and CoInitializeSecurity when using TChromium (CEF3) in one application? If yes, how to do it?</p>\n\n<p>Below is what I want to achive: </p>\n\n<pre><code>CoUninitialize();\n   CoInitialize(NULL);\n   if(CoInitializeSecurity(NULL, -1, NULL, NULL, RPC_C_AUTHN_LEVEL_PKT, RPC_C_IMP_LEVEL_IMPERSONATE, NULL, EOAC_NONE, 0) == S_OK)\n   { \n    // cannot get here, CoInitializeSecurity fails\n     ... need to execute WMI code using IWbemLocator, IWbemServices ...\n   }\n</code></pre>\n"}, {"tags": ["c++", "bit", "bit-packing", "nibble"], "comments": [{"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1555522361, "post_id": 55732775, "comment_id": 98144745, "body": "(unrelated to title) Sorry.  This does not appear c++-ish to me.  Example: C uses &lt;stdio.h&gt;, but C++ would use &lt;cstdio&gt; ... these are different.  C++ std::printf is from &lt;cstdio&gt;.  But why did you include &lt;iostream&gt;?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 3, "creation_date": 1555522451, "post_id": 55732775, "comment_id": 98144788, "body": "Don&#39;t use <code>structs</code> as network protocols."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1555522591, "post_id": 55732775, "comment_id": 98144863, "body": "I think you forgot to include &lt;cstdint&gt;, for uint8_t."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1555522759, "post_id": 55732775, "comment_id": 98144965, "body": "Consider enabling more warnings:  Example:  warning: large integer implicitly truncated to unsigned type [-Woverflow]  (for the assignment of value 27 to 4 bit field obj_data.id_adc_precision.)"}], "owner": {"reputation": 31, "user_id": 9085393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4ae6cf0d101d76420264f5f72fc33?s=128&d=identicon&r=PG&f=1", "display_name": "Kirito-kun", "link": "https://stackoverflow.com/users/9085393/kirito-kun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555522369, "creation_date": 1555520843, "last_edit_date": 1555522369, "question_id": 55732775, "link": "https://stackoverflow.com/questions/55732775/properly-bit-packing-for-enum-and-typedef-struct", "title": "Properly bit packing for enum and typedef struct", "body": "<p>I am trying to do some bit packing to transmit data in the small format possible, but I am unsure how to archive it, I started with a typedef struct where I gave the size to each element, but when I am trying to transmit it using UART, in the other end I receive it as one byte for each element</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n    enum type \n    {\n        id_hardware=1,\n        id_software,\n        id_led,\n        id_adc,\n        id_motor,\n        id_battery\n                /* ... some enums more */\n                id_some = 31\n    };\n    #pragma pack(push, 1)\n    typedef struct\n    {\n        uint8_t id_software     : 8;\n        uint8_t id_led_light    : 8;    /* values from 0 to 100 -&gt; 0 - 100% */ \n        uint8_t id_adc          : 8;    /* e.g 45,xx */\n        uint8_t id_adc_precision: 4;    /* e.g xx,06 */\n        uint8_t battery_voltage : 6;    \n        uint8_t hardware_id     : 5;\n        uint8_t id_motor        : 1;    /* on-off */\n    } data;\n    #pragma pack(pop)\n    data obj_data;\n\nint main()\n{\n    obj_data.hardware_id        = 1;\n    obj_data.id_software        = 1;\n    obj_data.id_led_light       = 50;\n    obj_data.id_adc             = 40;\n    obj_data.id_adc_precision   = 27;\n    obj_data.battery_voltage    = 50;\n    obj_data.id_motor           = 0;\n\n    printf(\"[%x][%x][%x][%x]\",id_hardware , obj_data.hardware_id, id_battery, obj_data.battery_voltage);\n</code></pre>\n\n<p>for the code above I am sending the data as:</p>\n\n<p>hex: [1][1][6][32] </p>\n\n<p>binary: 00000001 00000001 00000110 00100000</p>\n\n<p>where my real intention is receiving something like this:</p>\n\n<p>[8][4C][40]</p>\n\n<p>binary: <strong><em>00001</em></strong> 00001 <strong><em>00110</em></strong> 0 0100000 <strong><em>0</em></strong></p>\n"}, {"tags": ["c++", "linker"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1555518235, "post_id": 55732101, "comment_id": 98142848, "body": "Does it work if you use a simple int iso an array?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1555518356, "post_id": 55732101, "comment_id": 98142918, "body": "Did you forget to include &quot;tables.h&quot; in &quot;tables.cpp&quot;? The compiler does not give symbols external linkage unless it&#39;s aware that you want it at the point of definition."}, {"owner": {"reputation": 149, "user_id": 3991844, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c34d128bb9f371747777d59709d3cea1?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/3991844/john"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1555518492, "post_id": 55732101, "comment_id": 98142990, "body": "@JVApen it does not"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1555518756, "post_id": 55732101, "comment_id": 98143100, "body": "Could the link-time optimizations (enabled with <code>-flto</code> flag) have anything to do with it? What happens if you remove that flag?"}, {"owner": {"reputation": 149, "user_id": 3991844, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c34d128bb9f371747777d59709d3cea1?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/3991844/john"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1555518927, "post_id": 55732101, "comment_id": 98143177, "body": "@molbdnilo that was it. not sure how I didn&#39;t see that. How was tables.o able to compile? I would have thought it would complain that TABLES::A is declared twice then?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1555520684, "post_id": 55732101, "comment_id": 98144022, "body": "If you had done <code>#include &quot;tables.hpp&quot;</code> in your <code>tables.cpp</code> file as suggested by @molbdrillo, I think you could have kept the <code>-flto</code> flag. You should include it nevertheless."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1555525528, "post_id": 55732101, "comment_id": 98146185, "body": "@john It\u2019s declared once and defined once, which is not a problem."}], "owner": {"reputation": 149, "user_id": 3991844, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c34d128bb9f371747777d59709d3cea1?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/3991844/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555518038, "creation_date": 1555518038, "question_id": 55732101, "link": "https://stackoverflow.com/questions/55732101/having-issue-linking-with-an-external-array-declared-in-a-header-file-and-define", "title": "Having issue linking with an external array declared in a header file and defined in a source file", "body": "<p>I need to declare a very large n-d array. It is defined in a header file and never changes. Unfortunately compiling the main file takes a very long time, so I decided to bring it out into it's own object file.</p>\n\n<p>Here is the header file tables.hpp:</p>\n\n<pre><code>#pragma once\n\nnamespace TABLES\n{\n    extern const int A[10][10][10];\n    extern const int B[10][10][10];\n}\n</code></pre>\n\n<p>Here is the source file tables.cpp:</p>\n\n<pre><code>namespace TABLES\n{\n    const int A[10][10][10] = {};  // use default for brevity\n    const int B[10][10][10] = {};  // use default for brevity\n}\n</code></pre>\n\n<p>and my main file:</p>\n\n<pre><code>#include \"tables.hpp\"\n\nint main()\n{\n    printf(\"%d\", TABLES::A[0][0][0]);\n}\n</code></pre>\n\n<p>and here is my Makefile:</p>\n\n<pre><code>CXX = clang++\nCFLAGS = -std=c++17 -g -flto -Wall -Iinclude/ \nSRC = src/\nINC = include/\n\ntables.o: $(SRC)tables.cpp $(INC)tables.hpp\n    $(CXX) $(CFLAGS) -c $(SRC)tables.cpp\n\nmain: main.cpp tables.o\n    $(CXX) $(CFLAGS) -o main main.cpp tables.o\n</code></pre>\n\n<p>the tables.o compiles successfully, however I am having issues linking the tables.o to the main program:</p>\n\n<pre><code>undefined reference to `TABLES::A'\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nMakefile:30: recipe for target 'main' failed\nmake: *** [refactor] Error 1\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1555518050, "post_id": 55732071, "comment_id": 98142760, "body": "why you are not allowed to use it? <code>auto</code> can be replaced by using <code>decltype</code>, though it makes the code less readable and I am not sure if that would be in the spirit of your actual constraints"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1555518067, "post_id": 55732071, "comment_id": 98142766, "body": "Add the flag: -std=c++17 to your compile command"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1555518133, "post_id": 55732071, "comment_id": 98142794, "body": "You can always replace <code>auto</code> with the exact type."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1555518274, "post_id": 55732071, "comment_id": 98142865, "body": "@JesperJuhl Almost. You can&#39;t do that with lambda expressions : <code>auto x = [](){};</code>. In that case <code>auto</code> can&#39;t be replaced with the explicit type of the lamdba. The best you can do is wrap it in something else, like an <code>std::function</code>."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555518344, "post_id": 55732071, "comment_id": 98142911, "body": "@Fran&#231;oisAndrieux: If he&#39;s not allowed to use <code>auto</code>, what are the chances he&#39;s allowed to use lambda expressions?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555518364, "post_id": 55732071, "comment_id": 98142924, "body": "@Fran&#231;oisAndrieux True. Lambdas are special."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1555518370, "post_id": 55732071, "comment_id": 98142930, "body": "@FredLarson OP probably won&#39;t be using a lambda here, but it&#39;s still an exception to the rule that you can always replace <code>auto</code> with the explicit type."}, {"owner": {"reputation": 13, "user_id": 11244953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f2b16df1bd03d2ae9ee946e3b16b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/11244953/jared"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555522383, "post_id": 55732071, "comment_id": 98144760, "body": "@user463035818, my lecturer just said for now she doesn&#39;t want us to use auto for some reason"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555522505, "post_id": 55732071, "comment_id": 98144825, "body": "Ok. My suggestion to use decltype wasnt that serious. If you have constraints like that you better include them in the question. It helps to give appropriate answers"}], "answers": [{"tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": false, "score": 4, "last_activity_date": 1555518056, "creation_date": 1555518056, "answer_id": 55732106, "question_id": 55732071, "link": "https://stackoverflow.com/questions/55732071/i-need-to-convert-some-code-so-that-it-does-not-contain-the-auto-keyword/55732106#55732106", "title": "I need to convert some code so that it does not contain the &#39;auto&#39; keyword", "body": "<p>You should use the right returned type by the str.rbeghin() to replace the auto so i guess this should be enough </p>\n\n<pre><code>for (std::string::reverse_iterator it=str.rbegin(); it!=str.rend(); ++it)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": false, "score": 0, "last_activity_date": 1555519417, "creation_date": 1555519417, "answer_id": 55732430, "question_id": 55732071, "link": "https://stackoverflow.com/questions/55732071/i-need-to-convert-some-code-so-that-it-does-not-contain-the-auto-keyword/55732430#55732430", "title": "I need to convert some code so that it does not contain the &#39;auto&#39; keyword", "body": "<p>Your question is a bit confusing, as you haven't explained why you ain't able to use it, I'm gonna assume it rejects your program.</p>\n\n<p>For a long time, Gcc was defaulting to c++98. If you are still using it, try changing the default standard. This can be done with the flag -std=.\nSome possible values include: c++11 (official standard that introduced it), c++0x (pre-release implementation of c++11), c++14, c++17, c++2a</p>\n\n<p>In case you use a different compiler, like Clang, you can use the same flag. MSVC uses /std=, and the only supported values are c++14, c++17 and c++-latest.</p>\n\n<p>If your compiler is too old to support any of these, I recommend upgrading your compiler.</p>\n"}], "owner": {"reputation": 13, "user_id": 11244953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f2b16df1bd03d2ae9ee946e3b16b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/11244953/jared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555519417, "creation_date": 1555517949, "last_edit_date": 1555518143, "question_id": 55732071, "link": "https://stackoverflow.com/questions/55732071/i-need-to-convert-some-code-so-that-it-does-not-contain-the-auto-keyword", "title": "I need to convert some code so that it does not contain the &#39;auto&#39; keyword", "body": "<p>I have created a program but in the code I used 'auto' and have found out that im not allowed to. I can not figure out how to not use it as ive always just used it. Any help or tips would be much appreciated.</p>\n\n<p>Here is the code i have:</p>\n\n<pre><code>string reverse_word(string str)\n{\n    string output_str;\n\n    output_str.reserve(str.length());\n\n    char save_non_alpha = 0;\n\n    for (auto it = str.rbegin(); it != str.rend(); it++) {\n\n        if (it == str.rbegin() &amp;&amp; !is_letter(*it)) {\n            save_non_alpha = *it;\n        }\n        else {\n            output_str += *it;\n        }\n    }\n    if (save_non_alpha != 0) {\n        output_str += save_non_alpha;\n    }\n    return output_str;\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "winapi", "mingw", "uac"], "comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1555520415, "post_id": 55732050, "comment_id": 98143900, "body": "Not sure on the shell abstractions. Maybe try the <code>Winreg.h</code> API&#39;s, see which returns an error (<code>RegOpenKey</code>, <code>RegQueryValueEx</code>, etc.)  and if it is more detailed."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 3, "creation_date": 1555520776, "post_id": 55732050, "comment_id": 98144059, "body": "<i>&quot;... the status always returns me 2 without any information ...&quot;</i> - <code>SHGetValue</code> returns a <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shlwapi/nf-shlwapi-shgetvaluea\" rel=\"nofollow noreferrer\"><code>LSTATUS</code></a>. I believe that is. <code>ERROR_FILE_NOT_FOUND</code>. I believe you are asking for a key, subkey or value that does not exist. One of the folks more current with the Win32 API can probably say more."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 2, "creation_date": 1555535489, "post_id": 55732050, "comment_id": 98150150, "body": "<code>HKLM</code> is not the name of a registry key, it&#39;s an abbreviation for <code>HKEY_LOCAL_MACHINE</code> which you&#39;re already passing to <code>SHGetValue</code> as the first parameter."}, {"owner": {"reputation": 241, "user_id": 8632386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104279ac6b6fcffcad290e7c5ec43dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tom13000", "link": "https://stackoverflow.com/users/8632386/tom13000"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1555568582, "post_id": 55732050, "comment_id": 98157548, "body": "@jww the status with compiler MinGW is a DWORD, and I corrected my error with the answer of Jonathan thanks"}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 8632386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104279ac6b6fcffcad290e7c5ec43dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tom13000", "link": "https://stackoverflow.com/users/8632386/tom13000"}, "edited": false, "score": 0, "creation_date": 1555574201, "post_id": 55732880, "comment_id": 98160078, "body": "I want use FilterAdministratorToken but is disable by default how give it back  enable .?"}], "tags": [], "owner": {"reputation": 2682, "user_id": 7602551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81b7fabc768e5360e25c5875f757883?s=128&d=identicon&r=PG&f=1", "display_name": "unlut", "link": "https://stackoverflow.com/users/7602551/unlut"}, "is_accepted": true, "score": 4, "last_activity_date": 1555580275, "last_edit_date": 1555580275, "creation_date": 1555521232, "answer_id": 55732880, "question_id": 55732050, "link": "https://stackoverflow.com/questions/55732050/shgetvalue-returns-2-when-querying-uac-value/55732880#55732880", "title": "SHGetValue returns 2 when querying UAC value", "body": "<p>What specific key you are trying to read? I am not an expert on win32 API so I don't know whether there is a way to read a set of keys at once (<strong>Edit:</strong> I think there are<code>RegEnumValue/RegEnumValueA</code> functions for this purpose). Here is an example that shows how you can read \"EnableLUA\" or any other key from that path:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;shlwapi.h&gt;\n\n\nbool ReadUACRegistryKey(char* key, DWORD &amp;keyValue)\n{\n    LPCTSTR pszSubKey = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\";\n    LPCTSTR pszValue = key;\n\n    //  don't care\n    DWORD dwType = 0;\n    DWORD dwValue = 0;\n\n    //  \n    DWORD dwValueSize = sizeof(dwValue);\n\n    int retval = SHGetValue( HKEY_LOCAL_MACHINE, pszSubKey, key, &amp;dwType, &amp;dwValue, &amp;dwValueSize);\n    if ( retval != ERROR_SUCCESS)\n    {\n        return false;\n    }\n\n    keyValue = dwValue;\n    return true;\n}\n\nint main()\n{\n    DWORD keyValue;\n    char* key = \"EnableLUA\";  //  \"EnableSecureUIAPaths\" etc..;\n    if (ReadUACRegistryKey(key, keyValue))\n    {\n        std::cout &lt;&lt; \"Successfully readed key \" &lt;&lt; key &lt;&lt; \", value:\" &lt;&lt; keyValue &lt;&lt; std::endl;\n    }\n    else\n    {\n        std::cout &lt;&lt; \"Unable to read value of key \" &lt;&lt; key &lt;&lt; std::endl;\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Also keep in mind that value of read key value is stored in value parameter, not in the return value of the function.</p>\n\n<p><strong>Edit</strong>: Answer of the the op's comment <em>\"I want use FilterAdministratorToken but is disable by default how give it back enable .?\"</em>. Keep in mind that your process need to have admin rights to perform these operation.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;shlwapi.h&gt;\n\n\nbool ReadUACRegistryKey(char* key, DWORD &amp;keyValue)\n{\n    LPCTSTR pszSubKey = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\";\n    LPCTSTR pszValue = key;\n\n    //  don't care\n    DWORD dwType = 0;\n    DWORD dwValue = 0;\n\n    //  \n    DWORD dwValueSize = sizeof(dwValue);\n\n    int retval = SHGetValue( HKEY_LOCAL_MACHINE, pszSubKey, key, &amp;dwType, &amp;dwValue, &amp;dwValueSize);\n    if ( retval != ERROR_SUCCESS)\n    {\n        return false;\n    }\n\n    keyValue = dwValue;\n    return true;\n}\n\nbool EnableFilterAdministratorToken()\n{\n    //  first check if its already enabled or not\n    DWORD val;\n    if (ReadUACRegistryKey(\"FilterAdministratorToken\", val))\n    {\n        if (val == 1)\n        {\n            std::cout &lt;&lt; \"FilterAdministratorToken is already enabled\" &lt;&lt; std::endl;\n            return true;\n        }\n    }\n    else\n    {\n        std::cout &lt;&lt; \"Unable to read key\" &lt;&lt; std::endl;\n        return false;\n    }\n\n\n    //  its not enabled, we need to enable it manually\n    //  obtain a handle to reg key\n    HKEY hKey;\n    int retval = RegOpenKeyExA(HKEY_LOCAL_MACHINE, \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\", 0, KEY_SET_VALUE, &amp;hKey);\n    if (retval != ERROR_SUCCESS)\n    {\n        //  we are unable to obtain a handle to reg key\n        std::cout &lt;&lt; \"Unable to obtain handle to reg key\" &lt;&lt; std::endl;\n        return false;\n    }\n\n\n    DWORD enabledValue = 1;\n    retval = RegSetValueExA(hKey, \"FilterAdministratorToken\", 0, REG_DWORD, (BYTE*) &amp;enabledValue, sizeof(DWORD));\n    if (retval != ERROR_SUCCESS)\n    {\n        //  some error occured\n        std::cout &lt;&lt; \"Some error occured during setting the key value\" &lt;&lt; std::endl;\n        RegCloseKey(hKey);\n        return false;\n    }\n\n    std::cout &lt;&lt; \"Successfully changed key value\" &lt;&lt; std::endl;\n    RegCloseKey(hKey);\n    return true;\n}\n\nint main()\n{\n    if (EnableFilterAdministratorToken())\n    {\n        std::cout &lt;&lt; \"OK\" &lt;&lt; std::endl;\n    }\n    else\n    {\n        std::cout &lt;&lt; \"FAIL\" &lt;&lt; std::endl;\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 8632386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104279ac6b6fcffcad290e7c5ec43dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tom13000", "link": "https://stackoverflow.com/users/8632386/tom13000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 55732880, "answer_count": 1, "score": 0, "last_activity_date": 1555616927, "creation_date": 1555517879, "last_edit_date": 1555616927, "question_id": 55732050, "link": "https://stackoverflow.com/questions/55732050/shgetvalue-returns-2-when-querying-uac-value", "title": "SHGetValue returns 2 when querying UAC value", "body": "<p>I would like to check the UAC configuration settings of windows. And thus recover the parameters of the UAC in the registry keys. </p>\n\n<p>I used the windows <code>SHGetValue</code> function but the status always returns me 2 without any information.</p>\n\n<p>I use C++11, MinGW and windows. </p>\n\n<p>My code is :</p>\n\n<pre><code>DWORD dwStatus;\n  LPCSTR pszSubKey= \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\";\n  LPCSTR pszValue=\"\";\n  DWORD  pdwType=REG_SZ;\n  PVOID  pvData[63];\n  DWORD  pcbData;\n  pcbData=sizeof(pvData);\n\n  dwStatus=SHGetValueA(HKEY_LOCAL_MACHINE, pszSubKey, pszValue, &amp;pdwType, pvData, &amp;pcbData);\n\n  //Here dwStatus = 2\n  // pvData = 0x11fd0b2\n  // pcbData = 504\n</code></pre>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 5, "creation_date": 1555517981, "post_id": 55732031, "comment_id": 98142725, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/adl\" rel=\"nofollow noreferrer\">ADL</a>"}], "owner": {"reputation": 74, "user_id": 7036515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250704e3879b489e811ca67df7a2d930?s=128&d=identicon&r=PG&f=1", "display_name": "Maple", "link": "https://stackoverflow.com/users/7036515/maple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1555518015, "answer_count": 0, "score": 4, "last_activity_date": 1555522277, "creation_date": 1555517819, "last_edit_date": 1555522277, "question_id": 55732031, "link": "https://stackoverflow.com/questions/55732031/why-some-stl-functions-like-find-dont-need-std-sometimes", "closed_reason": "Duplicate", "title": "Why some STL functions like &#39;find&#39; don&#39;t need &#39;std::&#39; (sometimes)?", "body": "<p>There is no \"using namespace std;\" in the code. \"find\" works well. So my question is why I don't need to add \"std::\" to \"find\"?</p>\n\n<p>My gcc version is 4.9.4</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main() {\n    std::vector&lt;int&gt; v;\n    v.push_back(0);\n    v.push_back(1);\n    v.push_back(2);\n    std::cout &lt;&lt; find(v.begin(), v.end(), 1) - v.begin() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1555517449, "post_id": 55731871, "comment_id": 98142421, "body": "You can&#39;t. You can write a custom structure which holds both and update the result image"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1555517514, "post_id": 55731871, "comment_id": 98142456, "body": "also, you can simplify your &quot;merge&quot; function using two &quot;copyTo&quot;, see <a href=\"https://stackoverflow.com/a/33262398/5008845\">here</a>"}, {"owner": {"reputation": 13, "user_id": 11374579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c81fbef8ca9878468f84408c6a22e1?s=128&d=identicon&r=PG&f=1", "display_name": "Entoren", "link": "https://stackoverflow.com/users/11374579/entoren"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1555518341, "post_id": 55731871, "comment_id": 98142909, "body": "@Miki it worked thanks, I was thinking of solving it the wrong way"}], "answers": [{"tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": true, "score": 1, "last_activity_date": 1555519074, "creation_date": 1555519074, "answer_id": 55732353, "question_id": 55731871, "link": "https://stackoverflow.com/questions/55731871/is-there-a-way-to-create-a-mat-from-two-image-while-keeping-the-reference-of-the/55732353#55732353", "title": "Is there a way to create a Mat from two image while keeping the reference of the image", "body": "<p>When you <code>merge</code> you're making a copy of the data, so changing the two input images won't change <code>concat</code>.</p>\n\n<p>You need to make the two input images to point to the <code>concat</code> data:</p>\n\n<pre><code>...\nmerge(myImage, myImage.clone(), concat);\n\nmyImage = concat(cv::Rect(0, 0, myImage.cols, myImage.rows)); \nmyImageCopy = concat(cv::Rect(myImage.cols, 0, myImage.cols, myImage.rows));\n</code></pre>\n\n<p>so that changing <code>myImage</code> or <code>myImageCopy</code> will change also <code>concat</code></p>\n"}], "owner": {"reputation": 13, "user_id": 11374579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c81fbef8ca9878468f84408c6a22e1?s=128&d=identicon&r=PG&f=1", "display_name": "Entoren", "link": "https://stackoverflow.com/users/11374579/entoren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55732353, "answer_count": 1, "score": 1, "last_activity_date": 1555519074, "creation_date": 1555517251, "question_id": 55731871, "link": "https://stackoverflow.com/questions/55731871/is-there-a-way-to-create-a-mat-from-two-image-while-keeping-the-reference-of-the", "title": "Is there a way to create a Mat from two image while keeping the reference of the image", "body": "<p>I am trying to create a Mat A composed of two other Mat B and C so that changing B or C also change a part of A.</p>\n\n<p>Here's an example with some code:</p>\n\n<pre><code>// not important, i am only using it to change the Mat\nvoid someFunction(Mat &amp; image)\n{\n    for (int y = 0; y &lt; image.rows; y++)\n    {\n        for (int x = 0; x &lt; image.cols; x++)\n        {\n            image.at&lt;Vec3b&gt;(Point(x, y)) = image.at&lt;Vec3b&gt;(Point(x, y)) * 2;\n        }\n    }\n}\n\n// I am taking image and image2, and putting them poth in outputImage\n// It does the same thing then hconcat.\nvoid merge(Mat &amp; image, Mat&amp; image2, Mat &amp; outputImage)\n{\n    for (int y = 0; y &lt; image.rows; y++)\n    {\n        for (int x = 0; x &lt; image.cols; x++)\n        {\n            outputImage.at&lt;Vec3b&gt;(Point(x, y)) = image.at&lt;Vec3b&gt;(Point(x, y));\n            outputImage.at&lt;Vec3b&gt;(Point(x + image.cols, y)) = image2.at&lt;Vec3b&gt;(Point(x, y));\n        }\n    }\n}\n\nvoid mainFunction()\n{\n    // Reading image from file path\n    Mat myImage = imread(\"img/left.jpeg\");\n    Mat myImageCopy = myImage;\n\n    // Creating the Mat to hold the two other\n    Mat concat(myImage.rows, myImage.cols*2, CV_8UC3,Scalar(0,0,0));\n\n    // This is where i am doing something wrong\n    // I want concat to keep a reference or a pointer with myImage\n    // So that if myImage is changed, concat is also changed\n    merge(myImage, myImage.clone(), concat);\n\n    // showing the 3 Mat\n    imshow(\"myImage\", myImage);\n    imshow(\"myImageCopy\", myImageCopy);\n    imshow(\"concat\", concat);\n\n    // I change the value of some pixel at myImage\n    someFunction(myImage);\n\n    // showing the 3 mat again, myImage and myImageCopy are both changed but concat is the same \n    imshow(\"myImageAfter\", myImage);\n    imshow(\"myImageCopyAfter\", myImageCopy);\n    imshow(\"concatAfter\", concat);\n    waitKey(0);\n}\n</code></pre>\n\n<p>I want to create a Mat concat that will store the value of Mat myImage and it's copy by reference, but hconcat doesn't work for that, i tried to make my own function and called it merge but it didn't seem to work either.</p>\n\n<p>I want to be able to change my variable concat after it's declaration by only changing myImage.</p>\n\n<p>I couldn't find any other similar post and sorry if my question is not clear.</p>\n"}, {"tags": ["c++", "c++11", "lambda", "c++14"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1555517167, "post_id": 55731722, "comment_id": 98142282, "body": "TL;DR: <code>i</code> is a local variable so returning a reference to it is undefined behavior.  If you a return a lambda out of scope and it captures by reference to have to make sure what it captures is still alive it the scope it returns to.  If not, or you don&#39;t want to do that, capture by value."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1555518317, "post_id": 55731722, "comment_id": 98142894, "body": "To answer your question: Yes, it is still UB - you are reading from a reference to an object whose lifetime has ended. You probably just got &quot;lucky&quot; that nothing else overwrote that <code>i</code>."}, {"owner": {"reputation": 9, "user_id": 8453786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beymf.jpg?s=128&g=1", "display_name": "BowenDean", "link": "https://stackoverflow.com/users/8453786/bowendean"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1555581849, "post_id": 55731722, "comment_id": 98164166, "body": "@MaxLanghof Langhof But what ever  i put in <code>f</code>, <code>p</code> returns the same value. I think it&#39;s because the stack of <code>f</code> still is what it was after <code>f</code> returns."}], "owner": {"reputation": 9, "user_id": 8453786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beymf.jpg?s=128&g=1", "display_name": "BowenDean", "link": "https://stackoverflow.com/users/8453786/bowendean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1555517093, "answer_count": 0, "score": 0, "last_activity_date": 1555587777, "creation_date": 1555516825, "last_edit_date": 1555587777, "question_id": 55731722, "link": "https://stackoverflow.com/questions/55731722/reference-capture-type-of-a-lambda-expression-in-c11-and-c14", "closed_reason": "Duplicate", "title": "Reference capture type of a lambda expression in C++11 and C++14", "body": "<p>I am using g++@7.3.0 in ubuntu18.04 in WSL, and I am learning c++ lambda from cpprefernce. And I find some differences between c++11&amp;c++14 of lambda.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::function&lt;int(void)&gt; f(int i) {\n  auto y = [=]() { return i; };\n  return y;\n}\n\nint main() {\n  auto p = f(3);\n  std::cout &lt;&lt; p() &lt;&lt; std::endl;\n  return 0;\n}\n\n</code></pre>\n\n<p>With c++11, i in f will be captured and pass to p, and when p is called it will return i, so the result is 3. If I use refernce capture:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::function&lt;int(void)&gt; f(int i) {\n  auto y = [&amp;]() { return i; };\n  return y;\n}\n</code></pre>\n\n<p>On my pc I can compile it but the result will not be 3. It's something random.That's fine because it's a UB according to cppreference.\nBut when I turn to c++14, like:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto f(int i) {\n  auto y = [&amp;]() { return i; };\n  return y;\n}\n</code></pre>\n\n<p>The result is 3. Why? Is this 3 the same one of i in f? The lifetime of i exsits with p? Or it's still a UB, but g++ make it like this?\nAnd now I found another interesting thing: </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto f(int i) {\n  auto y = [&amp;]() {\n    std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n    return i;\n  };\n  // std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n  return y;\n}\n</code></pre>\n\n<p>The result is something random.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto f(int i) {\n  auto y = [&amp;]() {\n    // std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n    return i;\n  };\n  std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n  return y;\n}\n</code></pre>\n\n<p>the result is exactly <code>i</code>.</p>\n\n<pre><code>  auto y = [&amp;]() {\n    std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n    return i;\n  };\n  std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n  return y;\n}\n</code></pre>\n\n<p>Random.</p>\n\n<pre><code>auto f(int i) {\n  auto y = [&amp;]() {\n    // std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n    return i;\n  };\n  // std::cout &lt;&lt; &amp;i &lt;&lt; std::endl;\n  return y;\n}\n</code></pre>\n\n<p><code>i</code>\nWhy does the <code>cout</code> statement changes the result?</p>\n"}, {"tags": ["c++", "qt", "qt5"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11271440, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWHL3F8IWwY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcc-7mAxgukUXmrMIQHGQ81jE6Hxw/mo/photo.jpg?sz=128", "display_name": "smawell", "link": "https://stackoverflow.com/users/11271440/smawell"}, "edited": false, "score": 0, "creation_date": 1555522953, "post_id": 55731683, "comment_id": 98145053, "body": "Thank you for all!!!  It does wait 5 seconds with your methode i can see it in qDebug consol but it dosn&#39;t display it instantly on the GUI so it doesn&#39;t solve my probleme. I still don&#39;t understand why GUI doesn&#39;t refresh instantly at each increment."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 43, "user_id": 11271440, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWHL3F8IWwY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcc-7mAxgukUXmrMIQHGQ81jE6Hxw/mo/photo.jpg?sz=128", "display_name": "smawell", "link": "https://stackoverflow.com/users/11271440/smawell"}, "edited": false, "score": 0, "creation_date": 1555523300, "post_id": 55731683, "comment_id": 98145232, "body": "@smawell I think you have another mistake since I have tested my answer. On the other GUI lives in an event loop, that is, there is a loop that allows the GUI to perform several actions: read user events such as mouse, keyboard, etc. read OS events such as maximize, minimize, etc. and the repaint but when using sleep does not allow the eventloop to run."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 43, "user_id": 11271440, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWHL3F8IWwY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcc-7mAxgukUXmrMIQHGQ81jE6Hxw/mo/photo.jpg?sz=128", "display_name": "smawell", "link": "https://stackoverflow.com/users/11271440/smawell"}, "edited": false, "score": 0, "creation_date": 1555523307, "post_id": 55731683, "comment_id": 98145234, "body": "@smawell [cont.] For example to understand you try to change the size of the window when the loop is executed with your code, you will see that it will freeze. On the other hand, with my solution, no, at least that is what I have tested. So if you want more help then you should provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": false, "score": 3, "last_activity_date": 1555517046, "last_edit_date": 1555517046, "creation_date": 1555516730, "answer_id": 55731683, "question_id": 55731565, "link": "https://stackoverflow.com/questions/55731565/widget-is-only-updated-at-the-end-of-the-for-loop-i-need-it-to-be-updated-insid/55731683#55731683", "title": "widget is only updated at the end of the for loop. I need it to be updated inside the for loop incrementally", "body": "<p>You should not use the sleep method in the GUI because it blocks for a long time the eventloop where the GUI lives, a workaround is to use <code>QTimer::singleShot()</code> + <code>QEventLoop</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (int i=0; i &lt; 10 ; i++ )\n{\n    sentFrame = \"toto\"+i;\n    ui-&gt;alarmSent-&gt;addItem(sentFrame.toHex()); \n    ui-&gt;sentTest-&gt;insertPlainText(sentFrame.toHex()); \n    QEventLoop loop;\n    QTimer::singleShot(5*1000, &amp;loop, &amp;QEventLoop::quit);\n    loop.exec();\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11271440, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWHL3F8IWwY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcc-7mAxgukUXmrMIQHGQ81jE6Hxw/mo/photo.jpg?sz=128", "display_name": "smawell", "link": "https://stackoverflow.com/users/11271440/smawell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555662873, "creation_date": 1555516259, "last_edit_date": 1555662873, "question_id": 55731565, "link": "https://stackoverflow.com/questions/55731565/widget-is-only-updated-at-the-end-of-the-for-loop-i-need-it-to-be-updated-insid", "title": "widget is only updated at the end of the for loop. I need it to be updated inside the for loop incrementally", "body": "<p>How can I use this \"for loop\" bellow to have the window updated immediatly. Sleep(5) is only to see if the items are filled instantly </p>\n\n<p>I am using Qt in a simple \" class MainWindow : public QMainWindow\" with one button and one plainTextEdit and one textEdit</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (int i=0; i &lt; 10 ; i++ )\n{\n    sentFrame = \"toto\"+i;\n    ui-&gt;alarmSent-&gt;addItem(sentFrame.toHex()); // filled at the end of for loop\n    ui-&gt;sentTest-&gt;insertPlainText(sentFrame.toHex()); // filled at the end of for loop\n    sleep(5);\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 3, "creation_date": 1555516079, "post_id": 55731418, "comment_id": 98141734, "body": "How do you know that none of the other fields contains a space?"}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 1, "creation_date": 1555516198, "post_id": 55731418, "comment_id": 98141793, "body": "<code>the code doesn&#39;t work properly</code> That&#39;s not true."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555516762, "post_id": 55731418, "comment_id": 98142077, "body": "Do you have any control over the formatting of the input file?"}, {"owner": {"reputation": 3, "user_id": 8168613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LdEyB.png?s=128&g=1", "display_name": "Danger Saleh", "link": "https://stackoverflow.com/users/8168613/danger-saleh"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555518164, "post_id": 55731418, "comment_id": 98142817, "body": "@stark I have another function that controls the input of the other fields, my only problem is when the user enters his name and it includes a spcae, like Sami Ahmed, I need to know how to store it in 1 variable which is RenterName"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1555520804, "post_id": 55731418, "comment_id": 98144072, "body": "You can put the first word in RenterID, the last 3 in Flat, Fine and Status, and everything in between in RenterName.  But that fails if any of the other fields could also contain spaces."}], "answers": [{"tags": [], "owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "is_accepted": true, "score": 0, "last_activity_date": 1555517125, "creation_date": 1555517125, "answer_id": 55731828, "question_id": 55731418, "link": "https://stackoverflow.com/questions/55731418/how-to-read-different-variables-with-one-has-a-string-with-spaces-from-a-file/55731828#55731828", "title": "How to read different variables with one has a string with spaces from a file", "body": "<blockquote>\n  <p>the problem is the string RenterName if it includes a space, the code doesn't work properly.</p>\n</blockquote>\n\n<p>No, the code still works the way it suppose to work. Consider 2 variables <code>a</code> and <code>b</code> and the following line in a file:</p>\n\n<pre><code>Hello from file\n</code></pre>\n\n<p>Now doing this:</p>\n\n<pre><code>in &gt;&gt; a &gt;&gt; b\n</code></pre>\n\n<p>will read \"Hello\" and \"from\" and NOT \"Hello from\" and \"file\" or \"Hello\" and \"from file\". </p>\n\n<p>If you want a variable to contain whitespaces you need to change the file format. You could for example separate using a delimiter:</p>\n\n<pre><code>Hello, from file\n</code></pre>\n\n<p>and then use <code>std::getline()</code> to read the entire line an then split using the delimiter.</p>\n"}], "owner": {"reputation": 3, "user_id": 8168613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LdEyB.png?s=128&g=1", "display_name": "Danger Saleh", "link": "https://stackoverflow.com/users/8168613/danger-saleh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55731828, "answer_count": 1, "score": -2, "last_activity_date": 1555517125, "creation_date": 1555515757, "question_id": 55731418, "link": "https://stackoverflow.com/questions/55731418/how-to-read-different-variables-with-one-has-a-string-with-spaces-from-a-file", "title": "How to read different variables with one has a string with spaces from a file", "body": "<p>So I have a function which is supposed to read 6 variables in each line from a file, and then show them to console, the problem is the string RenterName if it includes a space, the code doesn't work properly. This is my code:<br>\n...</p>\n\n<pre><code>  void displayRentersInformations() {\nint RenterID, Fine;\nstring RenterName, FlatNumber, Status;\nifstream in;\nin.open(\"RentersInformation.txt\");\nif (!in) {\n    cout &lt;&lt; \"There is no information to be shown! \\n\";\n}\nelse {\n    while (in &gt;&gt; RenterID &gt;&gt; RenterName &gt;&gt; FlatNumber &gt;&gt; Fine &gt;&gt; Status) {\n\n        cout &lt;&lt; RenterID &lt;&lt; RenterName &lt;&lt; FlatNumber &lt;&lt; Fine &lt;&lt; Status &lt;&lt; endl;\n\n    }\n}\nin.close();\n}\n</code></pre>\n\n<p>this is an example of the text from the file: </p>\n\n<p>223456000 Sami Ahmed A7 6000 Paid</p>\n\n<p>so Sami Ahmed should be stored as string inside RenterName but the space between them is making the problem, I tried using getline but It didn't work or I just didn't use it the right way, how to solve this problem?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 6, "creation_date": 1555515143, "post_id": 55731175, "comment_id": 98141188, "body": "<code>if (c1 == c2 == &#39;:&#39;)</code> has a precedence problem that the compiler may be warning you about."}, {"owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555515235, "post_id": 55731175, "comment_id": 98141238, "body": "Aha. This has fixed it! 0 warnings unfortunately. If you can make this the answer I&#39;ll accept gladly. Thankyou."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1555515260, "post_id": 55731175, "comment_id": 98141253, "body": "<code>c1 == c2 == &#39;:&#39;</code> will always be false <code>(c1 == c2) == &#39;:&#39;</code> -&gt; <code>true == &#39;:&#39;</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1555515814, "post_id": 55731175, "comment_id": 98141572, "body": "Cranking up the warning level can be quite helpful. With gcc and similar compilers I use <code>-pedantic -Wall -Wextra</code> It&#39;s often worth adding on ` -Werror` so that the warnings can&#39;t be ignored. In Visual Studio go to Project-&gt;Properties-&gt;C/C++-&gt;general and set Warning level to Level4."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1555515822, "post_id": 55731175, "comment_id": 98141576, "body": "Related: <i>debugger</i>. Two breakpoints in a debugger and the problem is identified: one on the duration assignment <code>d = ...</code>, the other on the istream clear."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1555517064, "post_id": 55731175, "comment_id": 98142229, "body": "@RichardCritten: <i>&quot; will always be false&quot;</i> We might have/create a layout with <code>&#39;:&#39;</code> as 1 ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555516557, "post_id": 55731417, "comment_id": 98141985, "body": "Sure. Thanks again"}], "tags": [], "owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "is_accepted": false, "score": 1, "last_activity_date": 1555516635, "last_edit_date": 1555516635, "creation_date": 1555515755, "answer_id": 55731417, "question_id": 55731175, "link": "https://stackoverflow.com/questions/55731175/overloading-operator-is-not-setting-attributes-on-input/55731417#55731417", "title": "Overloading &gt;&gt; operator is not setting attributes on input", "body": "<p><code>if (c1 == c2 == ':')</code> was the issue as pointed out, evaluating to <code>true == ':'</code> which of course equals <code>false</code>. I fixed it with <code>if (c1 == c2 &amp;&amp; c2 == ':')</code> (not sure if most efficient, but certainly now works as intended).</p>\n"}], "owner": {"reputation": 638, "user_id": 5550969, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5bca48e6f7cd5e529c9d1f686085d6dc?s=128&d=identicon&r=PG&f=1", "display_name": "eddiewastaken", "link": "https://stackoverflow.com/users/5550969/eddiewastaken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555516635, "creation_date": 1555514920, "last_edit_date": 1555515168, "question_id": 55731175, "link": "https://stackoverflow.com/questions/55731175/overloading-operator-is-not-setting-attributes-on-input", "title": "Overloading &gt;&gt; operator is not setting attributes on input", "body": "<p>I'm new to C++, and trying to read in from cin to my object by overloading the >> operator. However, after the input, the object I create remains unchanged.</p>\n\n<p>Header:</p>\n\n<pre><code>class Duration {\nprivate:\n    int hours, mins, secs;\n\npublic:\n    Duration();\n    Duration(int hours, int mins, int secs);\n};\n\ninline Duration::Duration() {\n    this-&gt;hours = 0;\n    this-&gt;mins = 0;\n    this-&gt;secs = 0;\n}\n\ninline Duration::Duration(int hours, int mins, int secs) {\n    this-&gt;hours = hours;\n    this-&gt;mins = mins;\n    this-&gt;secs = secs;\n}\n\ninline istream&amp; operator&gt;&gt;(istream&amp; is, Duration &amp;d) {\n    char c1, c2;\n\n    int hours, mins, secs;\n\n    if (is &gt;&gt; hours &gt;&gt; c1 &gt;&gt; mins &gt;&gt; c2 &gt;&gt; secs) {\n        if (c1 == c2 == ':') {\n            d = Duration(hours, mins, secs);\n        }\n        else {\n            is.clear(ios_base::failbit);\n        }\n    }\n    return is;\n}\n\ninline ostream&amp; operator&lt;&lt;(ostream&amp; os, const Duration &amp;d) {\n    return os &lt;&lt; d.getHours() &lt;&lt; \":\"\n              &lt;&lt; d.getMins() &lt;&lt; \":\"\n              &lt;&lt; d.getSecs();\n}\n</code></pre>\n\n<p>and my main:</p>\n\n<pre><code>int main(int argc, char** argv) {\n    Duration test;\n\n    cin &gt;&gt; test;\n\n    cout &lt;&lt; test &lt;&lt; endl;\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I'm pretty sure I've included all 'passing by reference' indications where needed, I'm not sure what I'm doing wrong. Whatever I input when running the program, the resulting <code>Duration test</code> has the value <code>0:0:0</code>.</p>\n"}, {"tags": ["c++", "c", "graphics", "operating-system"], "comments": [{"owner": {"reputation": 313, "user_id": 11200005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de761c377f59b2e8b9f230ee0313b110?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Welch", "link": "https://stackoverflow.com/users/11200005/aidan-welch"}, "edited": false, "score": 0, "creation_date": 1555515085, "post_id": 55731138, "comment_id": 98141164, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2659932/how-to-read-the-screen-pixels\">How to read the screen pixels?</a>"}, {"owner": {"reputation": 1955, "user_id": 1264768, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/94mm8.png?s=128&g=1", "display_name": "salbeira", "link": "https://stackoverflow.com/users/1264768/salbeira"}, "reply_to_user": {"reputation": 313, "user_id": 11200005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de761c377f59b2e8b9f230ee0313b110?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Welch", "link": "https://stackoverflow.com/users/11200005/aidan-welch"}, "edited": false, "score": 0, "creation_date": 1555520407, "post_id": 55731138, "comment_id": 98143894, "body": "Though it asks the same question I am explicitly asking for the OS APIs of both Linux and Windows while the linked question only gets answerd by code working on Windows with an unspecified Library."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1555563761, "post_id": 55731138, "comment_id": 98156042, "body": "see <a href=\"https://stackoverflow.com/a/38549548/2521214\">How can I access a graphics card&#39;s output directly?</a> I cover OpenGL and WinAPI (VCL based encapsulation)"}, {"owner": {"reputation": 1955, "user_id": 1264768, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/94mm8.png?s=128&g=1", "display_name": "salbeira", "link": "https://stackoverflow.com/users/1264768/salbeira"}, "edited": false, "score": 1, "creation_date": 1555779057, "post_id": 55731138, "comment_id": 98223660, "body": "This gets close but is there also a way to directly write to the screen, like displaying an &quot;overlay&quot; above whatever the user is currently looking at by writing directly to video memory?"}], "owner": {"reputation": 1955, "user_id": 1264768, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/94mm8.png?s=128&g=1", "display_name": "salbeira", "link": "https://stackoverflow.com/users/1264768/salbeira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1555520607, "creation_date": 1555514791, "last_edit_date": 1555520607, "question_id": 55731138, "link": "https://stackoverflow.com/questions/55731138/reading-and-writing-bytes-directly-to-the-visible-framebuffer-of-the-os", "title": "Reading and writing bytes directly to the visible framebuffer of the OS?", "body": "<p>There are tools like Screenshot tools, Game Macro Tools and others that can read and write pixel data directly from the visible framebuffer that is presented to the user. So there must be an API that allows one to read and possibly write directly to these arrays of pixels.</p>\n\n<p>What are the APIs used to accomplish this in either Linux or Windows? Both OSes must to have some kind of systemcall to do this.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2659932/how-to-read-the-screen-pixels\">How to read the screen pixels?</a> only gets answered by giving a huge code example with an unspecified library without explaining includes or portability (seems to be Windows Exclusive stuff).</p>\n"}, {"tags": ["c++", "gcc", "c++17"], "answers": [{"tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": true, "score": 11, "last_activity_date": 1555523237, "creation_date": 1555523237, "answer_id": 55733335, "question_id": 55730971, "link": "https://stackoverflow.com/questions/55730971/is-it-safe-to-link-gcc-6-gcc-7-and-gcc-8-objects/55733335#55733335", "title": "Is it safe to link gcc 6, gcc 7, and gcc 8 objects?", "body": "<blockquote>\n  <p>Most of the language ABI changes seem like they wouldn't cause issues, but the calling convention change for empty class types in 12 might?</p>\n</blockquote>\n\n<p>The change of the calling convention for empty classes can cause an issue on x86-64. Here's an example:</p>\n\n<p><strong>def.hpp</strong>:</p>\n\n<pre><code>struct Empty { };\n\nstruct Foo {\n    char dummy[16];\n    int a;\n\n    Foo() : a(42) { }\n};\n\nvoid fn(Empty, Foo);\n</code></pre>\n\n<p><strong>one.cpp</strong>:</p>\n\n<pre><code>#include \"def.hpp\"\n\nint main() {\n    fn(Empty(), Foo());\n}\n</code></pre>\n\n<p><strong>two.cpp</strong>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"def.hpp\"\n\nvoid fn(Empty e, Foo foo) {\n    printf(\"%d\\n\", foo.a);\n}\n</code></pre>\n\n<p>Now, if you compile these with G++ 8 with differing ABIs of 11 and 12, for example:</p>\n\n<pre><code>g++ -c -fabi-version=11 one.cpp\ng++ -c -fabi-version=12 two.cpp\ng++ one.o two.o\n</code></pre>\n\n<p>the resulting <code>a.out</code> won't print the expected <code>42</code>.</p>\n\n<p>The reason is that the old ABI (11) reserves space for <code>Empty()</code> on the stack, but the new ABI (12) doesn't. So the address of <code>foo</code> will differ between the caller and the callee side. </p>\n\n<p>(Note: I've included <code>Foo::dummy</code> so <code>Foo</code> gets passed using the stack instead of registers. If <code>Foo</code> was passed using registers, there would be no problem.)</p>\n"}, {"tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": false, "score": 5, "last_activity_date": 1555539158, "creation_date": 1555539158, "answer_id": 55736661, "question_id": 55730971, "link": "https://stackoverflow.com/questions/55730971/is-it-safe-to-link-gcc-6-gcc-7-and-gcc-8-objects/55736661#55736661", "title": "Is it safe to link gcc 6, gcc 7, and gcc 8 objects?", "body": "<p>Most of them alter mangling in minor ways, which could cause some undefined references while linking, or just some code bloat due to identical source code producing two equivalent symbols with different names, so won't be merged by the linker.</p>\n\n<blockquote>\n  <p>the calling convention change for empty class types in 12 might?</p>\n</blockquote>\n\n<p>Yes, definitely. If you have non-final parameters that are empty types then that affects the ABI for the function, and differences can lead to undefined behaviour (in practice, accessing junk on the stack, or parameters getting the wrong values).</p>\n"}], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 9, "accepted_answer_id": 55733335, "answer_count": 2, "score": 19, "last_activity_date": 1555539158, "creation_date": 1555514211, "question_id": 55730971, "link": "https://stackoverflow.com/questions/55730971/is-it-safe-to-link-gcc-6-gcc-7-and-gcc-8-objects", "title": "Is it safe to link gcc 6, gcc 7, and gcc 8 objects?", "body": "<p><a href=\"https://stackoverflow.com/q/46746878/2069064\">Is it safe to link C++17, C++14, and C++11 objects</a> asks about linking objects compiled with different language standards, and Jonathan Wakely's excellent answer on that question explains the ABI stability promises that gcc/libstdc++ make to enusure that this works.</p>\n\n<p>There's one more thing that can change between gcc versions though - the language ABI via <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html\" rel=\"noreferrer\"><code>-fabi-version</code></a>. Let's say, for simplicity, I have three object files:</p>\n\n<ul>\n<li><code>foo.o</code>, compiled with gcc 6.5 c++14</li>\n<li><code>bar.o</code>, compiled with gcc 7.4 c++14</li>\n<li><code>quux.o</code>, compiled with gcc 8.3 c++17</li>\n</ul>\n\n<p>All with the respective default language ABIs (i.e. 10, 11, and 13). Linking these objects together is safe from the library perspective per the linked answer. But are there things that could go wrong from a language ABI perspective? Is there anything I should be watching out for? Most of the language ABI changes seem like they wouldn't cause issues, but the calling convention change for empty class types in 12 might?</p>\n"}, {"tags": ["c++", "cmake", "code-coverage", "gcov", "ninja"], "comments": [{"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 1, "creation_date": 1555515468, "post_id": 55730962, "comment_id": 98141370, "body": "I was about to point out undocumented CMake&#39;s <code>CMAKE_CXX_OUTPUT_EXTENSION_REPLACE</code>, but I googled for it and it sounds like someone already struggled with your issue: <a href=\"https://stackoverflow.com/a/40110752/5945883\">stackoverflow.com/a/40110752/5945883</a>"}, {"owner": {"reputation": 175, "user_id": 7188613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba946ff889b567cac14a5a21667d8324?s=128&d=identicon&r=PG&f=1", "display_name": "Arturo Gonzalez", "link": "https://stackoverflow.com/users/7188613/arturo-gonzalez"}, "reply_to_user": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1555577948, "post_id": 55730962, "comment_id": 98162003, "body": "Thanks for the fast and helpful answer! As the other question referenced by you, has a title which does not really point out the problem, I can imagine that it is difficult to find when you do not have a clue of the existence of CMAKE_CXX_OUTPUT_EXTENSION_REPLACE. For that reason, I will answer my own question with the solution that I used."}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1555581743, "post_id": 55730962, "comment_id": 98164113, "body": "Well, to be honest, it is more about understanding that Ninja has nothing to do here. All it does it obey to CMake&#39;s generated commands. Once you know that you can google &quot;CMake change object file extension&quot;. Then dig through old mailing lists, learn about magic <code>CMAKE_CXX_OUTPUT_EXTENSION_REPLACE</code> and google for it and find linked answer. Easy... ;) But the point was, the question could be improved by changing Ninja to CMake, as the solution can work with other generators as well."}, {"owner": {"reputation": 175, "user_id": 7188613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba946ff889b567cac14a5a21667d8324?s=128&d=identicon&r=PG&f=1", "display_name": "Arturo Gonzalez", "link": "https://stackoverflow.com/users/7188613/arturo-gonzalez"}, "reply_to_user": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1556005624, "post_id": 55730962, "comment_id": 98280686, "body": "you are right, I will reformulate the question."}], "owner": {"reputation": 175, "user_id": 7188613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba946ff889b567cac14a5a21667d8324?s=128&d=identicon&r=PG&f=1", "display_name": "Arturo Gonzalez", "link": "https://stackoverflow.com/users/7188613/arturo-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "closed_date": 1556006531, "answer_count": 0, "score": 0, "last_activity_date": 1556006170, "creation_date": 1555514164, "last_edit_date": 1556006170, "question_id": 55730962, "link": "https://stackoverflow.com/questions/55730962/cmake-produces-object-files-with-obj-extension-instead-of-o", "closed_reason": "Duplicate", "title": "CMake produces object files with .obj extension instead of .o", "body": "<p>I am working in a new C++ project which is using CMake and Ninja to be built. \nI am new to both tools and was expecting to easily implement code coverage using gcov.</p>\n\n<p>I was very fast and could compile my code with the flags <strong><em>-fprofile-arcs</em></strong> and <strong><em>-ftest-coverage</em></strong>, and then link with the <strong><em>gcov</em></strong> library. </p>\n\n<p>When executing the .exe file the <em>.gcda</em> files where generated as expected but when trying to generate the human readable coverage reports I realized that the gcov tool could not find the <em>.gcda</em> and <em>.gcno</em> files, even when they were there.</p>\n\n<p>After some minutes I realized that the problem was that the objects files which are generated have the extension <strong>.cpp.obj</strong> instead of just <strong>.o</strong>, and the coverage files <strong>.cpp.gcno</strong> and <strong>.cpp.gcda</strong> instead of just <strong>.gcno</strong> and <strong>.gcda</strong> as gcov expects.</p>\n\n<p>I have not found a way to tell cmake to \"tell\" ninja to give the extension <strong>.o</strong> to object files instead of <strong>.cpp.obj</strong></p>\n\n<p>Is there a way to achieve what I want?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555514167, "post_id": 55730909, "comment_id": 98140574, "body": "<code>i</code> is shadowed by the declaration in the for loop, and not accessible outside it&#39;s scope."}, {"owner": {"reputation": 1643, "user_id": 9177810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziLgX.jpg?s=128&g=1", "display_name": "JamesS", "link": "https://stackoverflow.com/users/9177810/jamess"}, "edited": false, "score": 0, "creation_date": 1555514203, "post_id": 55730909, "comment_id": 98140599, "body": "What happens if the array contains more than one occurrence of v??"}, {"owner": {"reputation": 12572, "user_id": 8534008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2af9937cac66f08b6ee6e4219cc0d?s=128&d=identicon&r=PG&f=1", "display_name": "GBlodgett", "link": "https://stackoverflow.com/users/8534008/gblodgett"}, "edited": false, "score": 1, "creation_date": 1555514205, "post_id": 55730909, "comment_id": 98140600, "body": "Why do you set <code>v</code> to <code>0</code> if <code>array[i] == v</code>? You want to set an index of the array to <code>0</code> yes?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1555514571, "post_id": 55730909, "comment_id": 98140842, "body": "<code>for (i = 0; i &lt; 1; i++)</code> is a very convoluted way of doing something exactly once. The significance of the ninth element is also very unclear."}, {"owner": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555515035, "post_id": 55730909, "comment_id": 98141137, "body": "guys i have 0 understanding about all this sht... i dont know even what i am doing, so i cant explain you why i doing that or that...its black image for me, i just need finish this homework and i dont want to think about this trash more.. Our teacher start learn c++ for total beginners, he said because then we will have easier to start coding with another languages.. I think its biggest mistake to start learn programming with c++..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555515580, "post_id": 55731136, "comment_id": 98141433, "body": "More closer with this, but still not what it should be. &lt;br&gt; I have now 0 in the end of final array, but that value of V integer still show in final array, it should be gone and see 0 in the end of array. Like they moving from bottom to top. Can you please see that picture from first post?"}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1555514784, "creation_date": 1555514784, "answer_id": 55731136, "question_id": 55730909, "link": "https://stackoverflow.com/questions/55730909/how-to-move-user-input-array-value-to-end-of-array-and-set-it-to-0/55731136#55731136", "title": "how to move user input array value to end of array and set it to 0?", "body": "<p>To replace the i:th value in the array with zero, you write <code>array[i] = 0</code>, not <code>v = 0</code>.<br>\nTo copy the i:th element to the last position, you write <code>array[9] = array[i]</code>.  </p>\n\n<p>Also, you should modify the array first and then print it, not print it as you go.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555516387, "post_id": 55731480, "comment_id": 98141880, "body": "Yep, that is what i was looking for! Thanks you so match! :) But can you explain what is k? Because i cant see that you declare it somewhere? Also i will make your code for solution, thanks man!"}, {"owner": {"reputation": 167, "user_id": 4560400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dcaad663002432e23c9ff2662cf62d?s=128&d=identicon&r=PG&f=1", "display_name": "the boy", "link": "https://stackoverflow.com/users/4560400/the-boy"}, "reply_to_user": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555516722, "post_id": 55731480, "comment_id": 98142058, "body": "hi, i declared k in for loop (int k = i; k &lt; 9; ++k). it is for moving value of array after we meet &#39;V&#39; backward, and at the end, set the last element of array to 0. does this make sense?"}, {"owner": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555516832, "post_id": 55731480, "comment_id": 98142109, "body": "ou ok, it means you dont need to declare k on top of code? where is  int i, array[10], v; ? Thanks for explain :) Ok i got it, you can declare even in for loop :) Or if you defined on top then you can write like this ? -&gt;&gt; (k = i; k &lt; 9; ++k) without int i am right?"}, {"owner": {"reputation": 167, "user_id": 4560400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dcaad663002432e23c9ff2662cf62d?s=128&d=identicon&r=PG&f=1", "display_name": "the boy", "link": "https://stackoverflow.com/users/4560400/the-boy"}, "reply_to_user": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555517105, "post_id": 55731480, "comment_id": 98142254, "body": "actually, you don&#39;t need to declare i at top of code. of course we have to declare array[10], v as they are not declared any where else. in this case, we will have 2 variables naming &#39;i&#39; and it will priority &#39;i&#39; in inner first ( i at top of code consider as outer variable) ... i think you are newbie of c++, please take time to learn about it :)"}, {"owner": {"reputation": 167, "user_id": 4560400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dcaad663002432e23c9ff2662cf62d?s=128&d=identicon&r=PG&f=1", "display_name": "the boy", "link": "https://stackoverflow.com/users/4560400/the-boy"}, "reply_to_user": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555517172, "post_id": 55731480, "comment_id": 98142284, "body": "yes, you are right, just &quot;without int k&quot;, not &quot;without int i&quot;"}, {"owner": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "edited": false, "score": 0, "creation_date": 1555517480, "post_id": 55731480, "comment_id": 98142434, "body": "Ye, i am very new to c++, and don&#39;t want to even go deeper, just need this for school...I think its the worst thing to start learn c++ for beginners in programming, i learning html, css, by myself that&#39;s all for now :) This is nightmare.. :D Thanks for help, appreciate!"}, {"owner": {"reputation": 160, "user_id": 10447655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a1ff7f91379be737a5f222732a230?s=128&d=identicon&r=PG&f=1", "display_name": "user10447655", "link": "https://stackoverflow.com/users/10447655/user10447655"}, "edited": false, "score": 0, "creation_date": 1555519604, "post_id": 55731480, "comment_id": 98143501, "body": "Does not work when array is {1,1,1,2,1,1,1,1,1,1}; When v = 1. Output is   <code>array[0]: 1 array[1]: 2 array[2]: 1 array[3]: 1 array[4]: 1 array[5]: 0 array[6]: 0 array[7]: 0 array[8]: 0 array[9]: 0</code>"}, {"owner": {"reputation": 167, "user_id": 4560400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dcaad663002432e23c9ff2662cf62d?s=128&d=identicon&r=PG&f=1", "display_name": "the boy", "link": "https://stackoverflow.com/users/4560400/the-boy"}, "edited": false, "score": 0, "creation_date": 1555520213, "post_id": 55731480, "comment_id": 98143800, "body": "Thank you so much for your info. Yes, i have found the problem, issue in case of 2 elements are equal which they are next to each other, i will update code on tomorrow. It is midnight in my country now."}], "tags": [], "owner": {"reputation": 167, "user_id": 4560400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dcaad663002432e23c9ff2662cf62d?s=128&d=identicon&r=PG&f=1", "display_name": "the boy", "link": "https://stackoverflow.com/users/4560400/the-boy"}, "is_accepted": true, "score": 0, "last_activity_date": 1555566868, "last_edit_date": 1555566868, "creation_date": 1555516012, "answer_id": 55731480, "question_id": 55730909, "link": "https://stackoverflow.com/questions/55730909/how-to-move-user-input-array-value-to-end-of-array-and-set-it-to-0/55731480#55731480", "title": "how to move user input array value to end of array and set it to 0?", "body": "<p>this is code for moving all equal elements in array, you can refer it</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main ()\n{\n    const int N = 10;\n    int array[N];\n    int v;\n\n    cout &lt;&lt; \"Please enter 10 integer elements of an array!\\n\" &lt;&lt; endl;\n    for (int i = 0; i &lt; N; i++)\n    {\n        cout &lt;&lt; \"array[\" &lt;&lt; i &lt;&lt; \"]: \";\n        cin &gt;&gt; array[i];\n    }\n\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"Now, enter the integer, 'V': \";\n    cin &gt;&gt; v;\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"The final array is:\\n\" &lt;&lt; endl;\n\n    int pos = 0;\n    // move element which are not equal backward\n    for (int i = 0; i &lt; N; i++)\n    {\n        if (array[i] != v)\n        {\n            array[pos] = array[i];\n            ++pos;\n        }\n    }\n    // set value in remaining position to 0\n    for ( ; pos &lt; N; ++pos){\n        array[pos] = 0;    \n    }\n\n    // print output\n    for (int i = 0; i &lt; N; i++){\n        cout &lt;&lt; \"array[\" &lt;&lt; i &lt;&lt; \"]: \" &lt;&lt; array[i] &lt;&lt; endl;    \n    }\n\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 160, "user_id": 10447655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a1ff7f91379be737a5f222732a230?s=128&d=identicon&r=PG&f=1", "display_name": "user10447655", "link": "https://stackoverflow.com/users/10447655/user10447655"}, "is_accepted": false, "score": 0, "last_activity_date": 1555570269, "creation_date": 1555570269, "answer_id": 55740546, "question_id": 55730909, "link": "https://stackoverflow.com/questions/55730909/how-to-move-user-input-array-value-to-end-of-array-and-set-it-to-0/55740546#55740546", "title": "how to move user input array value to end of array and set it to 0?", "body": "<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main () {\n\n    const size_t MAX_SIZE = 10;\n    size_t i = 0, array[MAX_SIZE], v;\n\n    cout &lt;&lt; \"Please enter 10 integer elements of an array!\\n\" &lt;&lt; endl;\n\n    for (int i = 0; i &lt; MAX_SIZE; i++) {\n        cout &lt;&lt; \"array[\" &lt;&lt; i &lt;&lt; \"]: \";\n        cin &gt;&gt; array[i];\n    }\n\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"Now, enter the integer, 'V': \";\n    cin &gt;&gt; v;\n    cout &lt;&lt; endl;\n    cout &lt;&lt; \"The final array is:\\n\" &lt;&lt; endl;\n\n    while (true)\n    {\n        if (i == MAX_SIZE) {\n            break;\n        }\n\n        if (array[i] == v) {\n\n            for (size_t j = i; j &lt; MAX_SIZE - 1; j++) {\n                array[j] = array[j + 1];\n            }\n\n            array[MAX_SIZE - 1] = 0;\n            continue;\n        }\n\n        cout &lt;&lt; \"array[\" &lt;&lt; i &lt;&lt; \"]: \" &lt;&lt; array[i] &lt;&lt; endl;\n\n        i++;\n    }\n\n}\n</code></pre>\n\n<p>_ </p>\n\n<p>You can also do it with a for loop.</p>\n\n<pre><code>for (size_t i = 0; i &lt; MAX_SIZE; /*EMPTY*/) {\n\n    if (array[i] == v)\n    {\n        for (size_t j = i; j &lt; MAX_SIZE - 1; j++) {\n            array[j] = array[j + 1];\n        }\n\n        array[MAX_SIZE - 1] = 0;\n        continue;\n    }\n\n    cout &lt;&lt; \"array[\" &lt;&lt; i &lt;&lt; \"]: \" &lt;&lt; array[i] &lt;&lt; endl;\n\n    i++;\n}\n</code></pre>\n\n<p>_</p>\n\n<pre><code>Please enter 10 integer elements of an array!\n\narray[0]: 1\narray[1]: 1\narray[2]: 1\narray[3]: 2\narray[4]: 1\narray[5]: 1\narray[6]: 1\narray[7]: 1\narray[8]: 1\narray[9]: 1\n\nNow, enter the integer, 'V': 1\n\nThe final array is:\n\narray[0]: 2\narray[1]: 0\narray[2]: 0\narray[3]: 0\narray[4]: 0\narray[5]: 0\narray[6]: 0\narray[7]: 0\narray[8]: 0\narray[9]: 0\n</code></pre>\n\n<p>_</p>\n\n<pre><code>Please enter 10 integer elements of an array!\n\narray[0]: 1\narray[1]: 1\narray[2]: 1\narray[3]: 2\narray[4]: 1\narray[5]: 1\narray[6]: 1\narray[7]: 1\narray[8]: 1\narray[9]: 1\n\nNow, enter the integer, 'V': 2\n\nThe final array is:\n\narray[0]: 1\narray[1]: 1\narray[2]: 1\narray[3]: 1\narray[4]: 1\narray[5]: 1\narray[6]: 1\narray[7]: 1\narray[8]: 1\narray[9]: 0\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11358963, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pqqv2G0LHRA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZVXRPCAf-aeg3G1Eu7rKYvxujAQ/mo/photo.jpg?sz=128", "display_name": "Gocha", "link": "https://stackoverflow.com/users/11358963/gocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 55731480, "answer_count": 3, "score": 0, "last_activity_date": 1555570269, "creation_date": 1555514045, "last_edit_date": 1592644375, "question_id": 55730909, "link": "https://stackoverflow.com/questions/55730909/how-to-move-user-input-array-value-to-end-of-array-and-set-it-to-0", "title": "how to move user input array value to end of array and set it to 0?", "body": "<p>What I need, is make program where user type 10 integers in array and then type one more integer which need to replace with 0 and move to the end of final array.</p>\n<p>Tried out everything what I can find in google, but didn't work still.</p>\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main ()\n{\n    int i, array[10], v;\n\ncout &lt;&lt; &quot;Please enter 10 integer elements of an array!\\n&quot; &lt;&lt; endl;\n    for (int i = 0; i &lt; 10; i++)\n    {\n        cout &lt;&lt; &quot;array[&quot; &lt;&lt; i &lt;&lt; &quot;]: &quot;;\n        cin &gt;&gt; array[i];\n    }\n\n    cout &lt;&lt; endl;\ncout &lt;&lt; &quot;Now, enter the integer, 'V': &quot;;\n    cin &gt;&gt; v;\n    cout &lt;&lt; endl;\ncout &lt;&lt; &quot;The final array is:\\n&quot; &lt;&lt; endl;\n\n    for (int i = 0; i &lt; 10; i++)\n    {\n        cout &lt;&lt; &quot;array[&quot; &lt;&lt; i &lt;&lt; &quot;]: &quot; &lt;&lt; array[i] &lt;&lt; endl;\n        if (array[i] == v)\n        {\n            v = 0;\n        }\n    }\n    for (i = 0; i &lt; 1; i++)\n    cout &lt;&lt; &quot;array[&quot; &lt;&lt; array[8] &lt;&lt; &quot;]: &quot; &lt;&lt; v &lt;&lt; endl;\n</code></pre>\n<p>This is how far I am done, almost finished, but don't know how to make it proper, to see in final only 10 array values, not 11, when user enter the same value of main array.</p>\n<p><a href=\"https://i.stack.imgur.com/4PV3f.png\" rel=\"nofollow noreferrer\">there is final result, how it should look like</a>\nBecause I guess you will not understand anything what I need from this description, because my English is trash ;/ <br> <br></p>\n"}, {"tags": ["c++", "xml", "pugixml"], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "is_accepted": true, "score": 1, "last_activity_date": 1555520183, "creation_date": 1555520183, "answer_id": 55732618, "question_id": 55730878, "link": "https://stackoverflow.com/questions/55730878/cant-get-attributes-name-and-value-while-parsing-xml/55732618#55732618", "title": "can&#39;t get attribute&#39;s name and value while parsing xml", "body": "<p><code>name()</code> and <code>value()</code> methods return <code>const char_t*</code>.</p>\n\n<p><code>char_t</code> is Pugi-specific typedef, controlled by <code>PUGIXML_WCHAR_MODE</code> macro.</p>\n\n<p>What I think happened, you have defined <code>PUGIXML_WCHAR_MODE</code>, <code>char_t</code> becomes <code>wchar_t</code>, however <code>std::cout</code> is not Unicode. If that\u2019s the case, try using Unicode output instead, like this:</p>\n\n<pre><code>std::wcout &lt;&lt; attr.name() &lt;&lt; L\" : \" &lt;&lt; attr.value() &lt;&lt; std::endl;\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 3051029, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/07a213a65e6392b3d3a1a5b6a165fbb9?s=128&d=identicon&r=PG&f=1", "display_name": "user3051029", "link": "https://stackoverflow.com/users/3051029/user3051029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 55732618, "answer_count": 1, "score": 0, "last_activity_date": 1555520183, "creation_date": 1555513938, "question_id": 55730878, "link": "https://stackoverflow.com/questions/55730878/cant-get-attributes-name-and-value-while-parsing-xml", "title": "can&#39;t get attribute&#39;s name and value while parsing xml", "body": "<p>I have got a non empty <code>pugi::xml_node my_node;</code>. </p>\n\n<p>If I print it with <code>my_node.print(std::cout);</code> I can clearly see that the contents of this node are okay.\nLet's say it's:</p>\n\n<pre><code>&lt;my_class id=\"0\" name=\"my class\" type=\"my type\"&gt;\n   &lt;child_1&gt; 45.0 &lt;/child_1&gt;\n   &lt;child_2&gt; 0.01 &lt;/child_2&gt;\n   &lt;child_3&gt; 100.0 &lt;/child_3&gt;\n   &lt;child_4&gt; some_string &lt;/child_4&gt;\n&lt;/my_class&gt;\n</code></pre>\n\n<p>But when I try to iterate it's attributes, I get weird output (which looks like some kind of addresses?). </p>\n\n<pre><code>for (auto attr : my_node.attributes()){\n    std::cout &lt;&lt; attr.name() &lt;&lt; \" : \" &lt;&lt; attr.value() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>And here's the output:</p>\n\n<pre><code>0x55727e049cd4 : 0x55727e049ce4\n0x55727e049d1c : 0x55727e049d34\n0x55727e049d8c : 0x55727e049da4\n</code></pre>\n\n<p>I took this example from the documentation by the way and I've got no idea why this is happening.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "yaml", "yaml-cpp"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9635643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4aa05ad8f966ce299934acd454c864?s=128&d=identicon&r=PG&f=1", "display_name": "user9635643", "link": "https://stackoverflow.com/users/9635643/user9635643"}, "edited": false, "score": 0, "creation_date": 1555780161, "post_id": 55732195, "comment_id": 98224012, "body": "Thank you for your input. I managed to answer part of my own question before I saw your answer. I am able to extract the characters and the lines, but I&#39;m not sure how to go prevent c++ from printing out <code>:main</code>, and how to tell it to go find <code>main:</code>..."}], "tags": [], "owner": {"reputation": 3750, "user_id": 1105015, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/996b29e26a9da215e1637df637cabb48?s=128&d=identicon&r=PG", "display_name": "Rob Starling", "link": "https://stackoverflow.com/users/1105015/rob-starling"}, "is_accepted": false, "score": 0, "last_activity_date": 1555518388, "creation_date": 1555518388, "answer_id": 55732195, "question_id": 55730527, "link": "https://stackoverflow.com/questions/55730527/how-to-return-sequences-in-yaml-node-as-string/55732195#55732195", "title": "How to return sequences in YAML node as string?", "body": "<p>You're asking how to find the \"key name\" for the list. You could certainly look at all the keys under <code>dialogue[\"dialogue_block\"]</code>, but it would be much more idiomatic yaml to make <code>character</code> a separate field from their <code>lines</code>, like so</p>\n\n<pre><code>dialogue_block:\n  character: Bob\n  lines:\n    - Hello\n    - How are you?\n    - :main\n</code></pre>\n\n<p>or if a block is intended to be a list,</p>\n\n<pre><code>dialogue_block:\n  - character: Bob\n    lines:\n      - Hello\n      - How are you?\n      - :main\n  - character: Alice\n    lines:\n      - Blah\n      - :main\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9635643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4aa05ad8f966ce299934acd454c864?s=128&d=identicon&r=PG&f=1", "display_name": "user9635643", "link": "https://stackoverflow.com/users/9635643/user9635643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 806, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555781279, "creation_date": 1555512900, "last_edit_date": 1555781279, "question_id": 55730527, "link": "https://stackoverflow.com/questions/55730527/how-to-return-sequences-in-yaml-node-as-string", "title": "How to return sequences in YAML node as string?", "body": "<p>I'm trying to parse a dialogue tree (YAML) in C++ using yaml-cpp. Here's a sample YAML:</p>\n\n<pre><code>dialogue_block:\n  character_name:\n    - Hello\n    - How are you?\n    - :main\nmain:\n  - 1: [\"I'm fine, thank you\", :response1]\n  - 2: [\"Not very well\", :response2]\n  - 3: [\"I don't want to talk\", :exit]\n</code></pre>\n\n<p>I'm relatively new to C++ and Yaml, so if there's an easier/more intuitive way, please point me in the right direction. My idea is to store each block as a dialogue node. In the example above, I want to be able to call on <code>dialogue_block</code>, and extract <code>character_name</code> to identify the character speaking, print all of the sequences up to <code>:main</code>, where it'll switch to the <code>main</code> node, with 3 choices for the player. I'm currently stuck on step 1 - parsing the yaml file... </p>\n\n<p>The following works...</p>\n\n<pre><code>YAML::Node dialogue = YAML::LoadFile(\"dialogue.yaml\");\nif(dialogue[\"dialogue_block\"]){\n  std::cout &lt;&lt; dialogue[\"dialogue_block\"][\"character_name\"][0].as&lt;std::string&gt;() &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>and it prints \"Hello\". However, I'm stumped on the next steps: how can I retrieve \"character_name\" without hardcoding the string into my code? Is there a way to print all of the strings leading up to, but not including \":main\"? And then make \"main\" the next node? </p>\n\n<p>First time posting on stackoverflow, so please do let me know if there's more info needed! Thanks.</p>\n\n<p><strong>Edit:</strong>\nHere's the updated code I'm using:</p>\n\n<pre><code>// read in file\nYAML::Node dialogue = YAML::LoadFile(\"dialogue.yaml\");\n\n// Extract names of each block\nstd::vector&lt;std::string&gt; dialogueBlocks;\nfor (const auto&amp; kv : dialogue) {\n    dialogueBlocks.push_back(kv.first.as&lt;std::string&gt;());\n} // will return \"dialogue_block\" and \"main\" \n\nstd::string character;\n\n// if first_encounter exists, always start at that block\nif(dialogue[\"first_encounter\"]){\n    for(YAML::iterator it = dialogue[\"first_encounter\"].begin(); it != dialogue[\"first_encounter\"].end(); ++it){\n        character = it-&gt;first.as&lt;std::string&gt;();\n        std::cout &lt;&lt; \"\\nCharacter: \" &lt;&lt; character &lt;&lt; \"\\n\";\n        for (YAML::iterator it=dialogue[\"first_encounter\"][character].begin();it!=dialogue[\"first_encounter\"][character].end(); ++it) {\n        std::cout &lt;&lt; it-&gt;as&lt;std::string&gt;() &lt;&lt; \"\\n\";\n    }\n    }\n\n}\n</code></pre>\n\n<p>I can successfully extract the character name and the dialogue, but there are a few things I'm struggling with: \n1) It also prints \":main\", which I want it to leave out. I'm not sure how to get it to terminate when it reaches a string starting with \":\", or if there's an appropriate built-in function to use. \n2) Store \":main\" as the next block to pass through the for loop when called upon.</p>\n"}, {"tags": ["c++", "arrays", "vector"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1555512963, "post_id": 55730515, "comment_id": 98139783, "body": "Why not just keep and use the vector?  It makes life easy."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10043112"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1555513029, "post_id": 55730515, "comment_id": 98139828, "body": "because i do not need it, and memory is critical"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555513058, "post_id": 55730515, "comment_id": 98139846, "body": "<code>int*</code> is not an array"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1555513095, "post_id": 55730515, "comment_id": 98139877, "body": "what memory? Why do you think you save memory by using a C-style array?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1555513118, "post_id": 55730515, "comment_id": 98139893, "body": "Do you know in advance how many elements your vector will have? If yes, use <code>std::vector::reserve</code> and there will be no memory wasted."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 6, "creation_date": 1555513140, "post_id": 55730515, "comment_id": 98139905, "body": "The data is the only heap memory that <code>std::vector</code> allocates. The rest is stored in the object itself and can&#39;t be deallocated.  You may want to use <a href=\"https://en.cppreference.com/w/cpp/container/vector/shrink_to_fit\" rel=\"nofollow noreferrer\"><code>shrink_to_fit</code></a> to reduce unused capacity."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1555513155, "post_id": 55730515, "comment_id": 98139915, "body": "You&#39;re not going to save any memory.  A vector is only a couple pointers so that isn&#39;t going to make a difference.  If you worried about the extra space the vector uses because of the quadratic growth of <code>push_back</code> then you can use <code>shrink_to_fit</code> or the swap trick so it only has the memory needed to store the elements.  You could also just <code>reserve</code> the memory you need a head of time if you know what that will be."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1555513211, "post_id": 55730515, "comment_id": 98139950, "body": "<code>std::vector</code> is just something like <code>T* data; std::size_t capacity; std::size_t size;</code>, so you just have 2 extra small fields."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1555513269, "post_id": 55730515, "comment_id": 98139973, "body": "@thejack There is no mechanism for extracting the data used by the <code>std::vector</code> such that it outlives the <code>vector</code>, other than putting it in another vector via a move. And if memory is critical, <code>std::vector</code> may not work for you. I will likely have much more spare <code>capacity</code> than you need and there is no guaranteed way to avoid that."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555513270, "post_id": 55730515, "comment_id": 98139974, "body": "and if you dont use <code>std::vector</code> you&#39;d still need <code>T* data;</code> and at the very least <code>std::size_t size;</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1555513632, "post_id": 55730515, "comment_id": 98140220, "body": "It&#39;s not unreasonable to want this (or something like it) when heap memory is limited. However, you can&#39;t have it ;) because the language doesn&#39;t have variable length arrays. And keeping the data on the heap but discarding vector&#39;s auto-storage metadata is (as discussed) not possible (and probably not useful)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1555519140, "post_id": 55730515, "comment_id": 98143281, "body": "@thejack <i>At some point, the vector is finished, and i do not need the extra functionality ::std::vector provides any more</i> -- Honestly, no C++ programmer writes programs this way.  This is the one of the weirdest cases of &quot;premature optimization&quot; I&#39;ve ever come across."}], "answers": [{"comments": [{"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 1, "creation_date": 1555513506, "post_id": 55730626, "comment_id": 98140132, "body": "You should mention that not only <code>std::vector</code> have to outlive but it must be shure that no modifications to the vector is allowed. Adding a single object can result in realocation which also makes the pointer invalid"}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1555513855, "post_id": 55730626, "comment_id": 98140361, "body": "Yes I actually implied that since it&#39;s one of the OP assertions, that he&#39;s done with the vector at some point. But I&#39;ll specify it."}], "tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": false, "score": 4, "last_activity_date": 1555513889, "last_edit_date": 1555513889, "creation_date": 1555513180, "answer_id": 55730626, "question_id": 55730515, "link": "https://stackoverflow.com/questions/55730515/use-a-stdvector-for-array-creation/55730626#55730626", "title": "Use a ::std::vector for array creation", "body": "<p>You can use the contents of a <code>std::vector</code> as a C array without the need to copy or release anything. Just make sure that <code>std::vector</code> outlives the need for your pointer to be valid (and that further modifications which could trigger a reallocation are done on the vector itself).</p>\n\n<p>When you obtain a pointer to internal storage through <code>data()</code> you're not actually allocating anything, just referring to the already allocated memory.</p>\n\n<p>The only additional precaution you could use to save memory is to use <code>shrink_to_fit()</code> to release any excess memory used as spare capacity (though it's not guaranteed).</p>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1555513311, "post_id": 55730651, "comment_id": 98139999, "body": "<code>shrink_to_fit</code> is non-binding and what it does is up to the implementation."}], "tags": [], "owner": {"reputation": 2151, "user_id": 5902079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df4530b8e41c66ac12d17f96cd70c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Gordon", "link": "https://stackoverflow.com/users/5902079/dmitry-gordon"}, "is_accepted": false, "score": 0, "last_activity_date": 1555513652, "last_edit_date": 1555513652, "creation_date": 1555513243, "answer_id": 55730651, "question_id": 55730515, "link": "https://stackoverflow.com/questions/55730515/use-a-stdvector-for-array-creation/55730651#55730651", "title": "Use a ::std::vector for array creation", "body": "<p>You have two options: </p>\n\n<ol>\n<li>Keep data in vector, but call <a href=\"https://en.cppreference.com/w/cpp/container/vector/shrink_to_fit\" rel=\"nofollow noreferrer\">shrink_to_fit</a>. All overhead you'll have - is an extra pointer (to the vector end). It is available since C++ 11</li>\n<li>Copy data to an external array and destroy the vector object:</li>\n</ol>\n\n<p>Here is the example:</p>\n\n<pre><code>std::vector&lt;int&gt; vec;\n// fill vector\nstd::unique_ptr&lt;int[]&gt; arr(new int[vec.size()]);\nstd::copy(vec.begin(), vec.end(), arr.get());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 5, "last_activity_date": 1555513472, "creation_date": 1555513472, "answer_id": 55730724, "question_id": 55730515, "link": "https://stackoverflow.com/questions/55730515/use-a-stdvector-for-array-creation/55730724#55730724", "title": "Use a ::std::vector for array creation", "body": "<p>In all the implementations I have seen, the allocated part of a vector is... the array itself. If you know that it will no longer grow, you can try to shrink it, to release possibly unused memory:</p>\n\n<pre><code>i.shrink_to_fit();\nint* v = i.data();\n</code></pre>\n\n<p>Of course, nothing guarantees that the implementation will do anything, but the only foolproof alternative would be to allocated a new array, move data from the vector to the array and clear the vector.</p>\n\n<pre><code>int *v = new int[i.size];\nmemcpy(v, i.data, i.size * sizeof(int));\ni.clear();\n</code></pre>\n\n<p>But I really doubt that you will have a major gain that way...</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10043112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555514157, "creation_date": 1555512874, "question_id": 55730515, "link": "https://stackoverflow.com/questions/55730515/use-a-stdvector-for-array-creation", "title": "Use a ::std::vector for array creation", "body": "<p>I want to grow a ::std::vector at runtime, like that:</p>\n\n<pre><code>::std::vector&lt;int&gt; i;\ni.push_back(100);\ni.push_back(10);\n</code></pre>\n\n<p>At some point, the vector is finished, and i do not need the extra functionality ::std::vector provides any more, so I want to convert it to a C-Array:</p>\n\n<pre><code>int* v = i.data();\n</code></pre>\n\n<p>Because I will do that more than once, I want to deallocate all the heap memory ::std::vector reserved, but I want to keep the data, like that (pseudo-code):</p>\n\n<pre><code>free(/*everything from ::std::vector but the list*/);\n</code></pre>\n\n<p>Can anybody give me a few pointers on that?</p>\n\n<p>Thanks in advance,\nJack</p>\n"}, {"tags": ["c++", "qt", "c++11"], "answers": [{"comments": [{"owner": {"reputation": 1017, "user_id": 4663570, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c76e3a8f039ee0afff38479e52578249?s=128&d=identicon&r=PG&f=1", "display_name": "Nmaster88", "link": "https://stackoverflow.com/users/4663570/nmaster88"}, "edited": false, "score": 0, "creation_date": 1555514184, "post_id": 55730439, "comment_id": 98140588, "body": "Awesome, but how can the space be added to the right instead?"}, {"owner": {"reputation": 980, "user_id": 10185183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oUA_ZF9CW5c/AAAAAAAAAAI/AAAAAAAACX0/TLhc82gWtsI/photo.jpg?sz=128", "display_name": "arsdever", "link": "https://stackoverflow.com/users/10185183/arsdever"}, "reply_to_user": {"reputation": 1017, "user_id": 4663570, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c76e3a8f039ee0afff38479e52578249?s=128&d=identicon&r=PG&f=1", "display_name": "Nmaster88", "link": "https://stackoverflow.com/users/4663570/nmaster88"}, "edited": false, "score": 0, "creation_date": 1555526653, "post_id": 55730439, "comment_id": 98146684, "body": "use negative <code>fieldWidth</code> instead"}], "tags": [], "owner": {"reputation": 980, "user_id": 10185183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oUA_ZF9CW5c/AAAAAAAAAAI/AAAAAAAACX0/TLhc82gWtsI/photo.jpg?sz=128", "display_name": "arsdever", "link": "https://stackoverflow.com/users/10185183/arsdever"}, "is_accepted": true, "score": 1, "last_activity_date": 1555526706, "last_edit_date": 1555526706, "creation_date": 1555512624, "answer_id": 55730439, "question_id": 55730398, "link": "https://stackoverflow.com/questions/55730398/how-to-have-make-a-qstring-have-a-specific-size-in-qt/55730439#55730439", "title": "how to have make a QString have a specific size in QT?", "body": "<p>You can use following approach</p>\n\n<pre><code>qDebug() &lt;&lt; QString(\"%1\").arg(yourStringVar, fieldWidth, QChar('fillEmptySpaceChar'));\n</code></pre>\n\n<p>in your example it could be</p>\n\n<pre><code>qDebug() &lt;&lt; QString(\"%1\").arg(val, 32, QChar(' '));\n</code></pre>\n\n<p>for making fill characters to fill from right simply use following</p>\n\n<pre><code>qDebug() &lt;&lt; QString(\"%1\").arg(val, -32, QChar(' '));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 4, "last_activity_date": 1555512970, "creation_date": 1555512970, "answer_id": 55730555, "question_id": 55730398, "link": "https://stackoverflow.com/questions/55730398/how-to-have-make-a-qstring-have-a-specific-size-in-qt/55730555#55730555", "title": "how to have make a QString have a specific size in QT?", "body": "<p>Use can use <code>QString::resize</code>. It takes the size and a fill character:</p>\n\n<pre><code>val.resize(20,' ');\nqDebug() &lt;&lt; val;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14632, "user_id": 399908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/56ea829e87b7772e36a35782dde9fb94?s=128&d=identicon&r=PG", "display_name": "Martin Hennings", "link": "https://stackoverflow.com/users/399908/martin-hennings"}, "is_accepted": false, "score": 1, "last_activity_date": 1556095571, "creation_date": 1556095571, "answer_id": 55825922, "question_id": 55730398, "link": "https://stackoverflow.com/questions/55730398/how-to-have-make-a-qstring-have-a-specific-size-in-qt/55825922#55825922", "title": "how to have make a QString have a specific size in QT?", "body": "<p>Or you use the functions <a href=\"https://doc.qt.io/qt-5/qstring.html#leftJustified\" rel=\"nofollow noreferrer\"><code>QString::leftJustified()</code></a> / <code>QString::rightJustified()</code> created specifically for this purpose :</p>\n\n<pre><code>qDebug() &lt;&lt; val.leftJustified(20, /*QChar fill=*/QLatin1Char(' '), /*bool truncate=*/false);\n</code></pre>\n\n<p>This also lets you choose how to proceed if your input string is longer than your fixed width.</p>\n"}], "owner": {"reputation": 1017, "user_id": 4663570, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c76e3a8f039ee0afff38479e52578249?s=128&d=identicon&r=PG&f=1", "display_name": "Nmaster88", "link": "https://stackoverflow.com/users/4663570/nmaster88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 55730439, "answer_count": 3, "score": 0, "last_activity_date": 1556095571, "creation_date": 1555512509, "question_id": 55730398, "link": "https://stackoverflow.com/questions/55730398/how-to-have-make-a-qstring-have-a-specific-size-in-qt", "title": "how to have make a QString have a specific size in QT?", "body": "<p>My problem is that in i will have a <code>QString val</code>that will get different values there. But i want all of results to have a fixed number of charaters, for example 20.</p>\n\n<p>So if the word i put there is less than that number of charaters it will put white spaces to the right.</p>\n\n<p>An example, lets suppose i have 2 words: <code>\"abc\"</code> and <code>\"abcdefghijklmno\"</code> </p>\n\n<p>for the <code>first case</code>:</p>\n\n<p><code>qDebug()&lt;&lt;val; //\"abc                 \"</code></p>\n\n<p>for the <code>second case</code>:</p>\n\n<p><code>qDebug()&lt;&lt;val; //\"abcdefghijklmno     \"</code></p>\n\n<p>how can it be done?</p>\n"}, {"tags": ["c++", "templates", "c++17", "variadic-templates"], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 10911886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51aa344456eed18b5a1f88711d7ce76?s=128&d=identicon&r=PG&f=1", "display_name": "user3520616", "link": "https://stackoverflow.com/users/10911886/user3520616"}, "edited": false, "score": 0, "creation_date": 1555513651, "post_id": 55730460, "comment_id": 98140238, "body": "thank you, this works. However, I don&#39;t really understand what you&#39;re doing on the gcc-bug-fix. Could you elaborate a little?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1555513797, "post_id": 55730460, "comment_id": 98140325, "body": "It&#39;s called sfinae. It&#39;s quite a rabbit hole. Search for <code>std::enable_if</code>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 425, "user_id": 10911886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51aa344456eed18b5a1f88711d7ce76?s=128&d=identicon&r=PG&f=1", "display_name": "user3520616", "link": "https://stackoverflow.com/users/10911886/user3520616"}, "edited": false, "score": 0, "creation_date": 1555513848, "post_id": 55730460, "comment_id": 98140355, "body": "@user3520616 Read the linked answer, and consider what effects the constraint has on the relevant candidates."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 7, "last_activity_date": 1555513163, "last_edit_date": 1555513163, "creation_date": 1555512691, "answer_id": 55730460, "question_id": 55730358, "link": "https://stackoverflow.com/questions/55730358/template-member-variables-depending-on-rules/55730460#55730460", "title": "Template member variables depending on rules", "body": "<p>You could unwrap the <code>Container&lt;T&gt;</code>s with a helper function:</p>\n\n<pre><code>template &lt;typename T&gt; T unwrap(T value)        { return value; }\ntemplate &lt;typename T&gt; T unwrap(Container&lt;T&gt; c) { return c.value; }\n\ntemplate &lt;typename T&gt; using unwrap_t = decltype(unwrap(std::declval&lt;T&gt;()));\n</code></pre>\n\n<p>And then adjust your template and deduction guide accordingly:</p>\n\n<pre><code>template &lt;typename... T&gt;\nstruct ElementCodec\n{\n  std::tuple&lt;T...&gt; values;\n\n  template &lt;typename... Us&gt;\n  ElementCodec(Us... args) : values(unwrap(args)...) {}\n};\n\ntemplate&lt;typename... T&gt;\nElementCodec(T...) -&gt; ElementCodec&lt;unwrap_t&lt;T&gt;...&gt;;\n</code></pre>\n\n<hr />\n\n<p>The above doesn't work on gcc (see <a href=\"https://stackoverflow.com/a/46849956/2069064\">this answer</a>) , you can fix it with a constraint:</p>\n\n<pre><code>template &lt;typename... Us,\n  std::enable_if_t&lt;std::is_constructible_v&lt;\n    std::tuple&lt;T...&gt;, unwrap_t&lt;Us&gt;...\n    &gt;, int&gt; = 0&gt;\nElementCodec(Us... args) : values(unwrap(args)...) {}\n</code></pre>\n"}], "owner": {"reputation": 425, "user_id": 10911886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51aa344456eed18b5a1f88711d7ce76?s=128&d=identicon&r=PG&f=1", "display_name": "user3520616", "link": "https://stackoverflow.com/users/10911886/user3520616"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55730460, "answer_count": 1, "score": 2, "last_activity_date": 1555513163, "creation_date": 1555512375, "last_edit_date": 1555512548, "question_id": 55730358, "link": "https://stackoverflow.com/questions/55730358/template-member-variables-depending-on-rules", "title": "Template member variables depending on rules", "body": "<p>in following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;tuple&gt;\n\ntemplate&lt;typename T&gt;\nstruct Container\n{\n  std::string id;\n  T value;\n\n  Container(std::string id, T value) : id(id), value(value) {}\n};\n\ntemplate&lt;typename... T&gt;\nstruct ElementCodec\n{\n  std::tuple&lt;T...&gt; values;\n\n  ElementCodec(T... args) : values(args...) {}\n};\n\ntemplate&lt;typename... T&gt; ElementCodec(T...) -&gt; ElementCodec&lt;T...&gt;;\n\nint main()\n{\n  ElementCodec a { int { 5 }, double { 3. }, Container { \"52\", 7 } };\n  auto [x, y, container] = a.values;\n\n  std::cout &lt;&lt; x &lt;&lt; \", \" &lt;&lt; y &lt;&lt; \", \" &lt;&lt; container.value &lt;&lt; '\\n';\n\n}\n</code></pre>\n\n<p>After the specialization of the given code the tuple <code>values</code> is of type <code>std::tuple&lt;int, double, Container&lt;int&gt;&gt;</code>. What I'd like to do is decaying it to the type stored in the container, so <code>std::tuple&lt;int, double, int&gt;</code> to make th access via <code>container.value</code> not necessary.</p>\n\n<p>Is this possible to do in c++17? I've been stuck on this problem for a while now and can't really find any ressources about this.</p>\n"}, {"tags": ["c++", "user-interface", "wxwidgets"], "comments": [{"owner": {"reputation": 980, "user_id": 10185183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oUA_ZF9CW5c/AAAAAAAAAAI/AAAAAAAACX0/TLhc82gWtsI/photo.jpg?sz=128", "display_name": "arsdever", "link": "https://stackoverflow.com/users/10185183/arsdever"}, "edited": false, "score": 0, "creation_date": 1555512824, "post_id": 55730185, "comment_id": 98139702, "body": "Are you calling <code>OnInit</code> function before <code>OnCardSelect</code> function? It seems, that <code>OnCardSelect</code> function was invoked before <code>OnInit</code> function, so <code>player</code> is not initialized yet"}, {"owner": {"reputation": 980, "user_id": 10185183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oUA_ZF9CW5c/AAAAAAAAAAI/AAAAAAAACX0/TLhc82gWtsI/photo.jpg?sz=128", "display_name": "arsdever", "link": "https://stackoverflow.com/users/10185183/arsdever"}, "edited": false, "score": 0, "creation_date": 1555512860, "post_id": 55730185, "comment_id": 98139723, "body": "To be sure, simply log some strings from both functions"}, {"owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "edited": false, "score": 0, "creation_date": 1555518836, "post_id": 55730185, "comment_id": 98143131, "body": "The code as shown can&#39;t compile, you can&#39;t use <code>player</code> field of <code>MyApp</code> without the object."}, {"owner": {"reputation": 43, "user_id": 11367269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f18ecca9f38e7db98ae1cec3e62de8?s=128&d=identicon&r=PG&f=1", "display_name": "username16", "link": "https://stackoverflow.com/users/11367269/username16"}, "edited": false, "score": 0, "creation_date": 1555536613, "post_id": 55730185, "comment_id": 98150577, "body": "I think <code>OnInit</code> is called using <code>IMPLEMENT_APP</code>. <code>OnCardSelect</code> is connected to button event (and called only when it is clicked), and button is created in <code>OnInit</code> function, so <code>Player</code> object should be already created."}], "owner": {"reputation": 43, "user_id": 11367269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f18ecca9f38e7db98ae1cec3e62de8?s=128&d=identicon&r=PG&f=1", "display_name": "username16", "link": "https://stackoverflow.com/users/11367269/username16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555511906, "creation_date": 1555511906, "question_id": 55730185, "link": "https://stackoverflow.com/questions/55730185/where-to-declare-variables-used-in-application-wxwidgets", "title": "Where to declare variables used in application (wxWidgets)?", "body": "<p>I've created <code>MyApp</code> class which inherit from <code>wxApp</code> and added some component variables to it:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class MyApp : public wxApp {\n    GameBoard* gb;\n    Player* player;\n    bool lightTheme;\n\n    std::vector&lt;wxBitmapToggleButton *&gt; cardImages;\npublic:\n    MyApp();\n    virtual bool OnInit();\n    void displayImages(wxFrame *, wxGridSizer *);\n\n    void OnCardSelect(wxCommandEvent&amp;);\n};\n</code></pre>\n\n<p>then I set their values in <code>MyApp::OnInit</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void MyApp::OnInit() {\n    //...\n    player = new Player(1);\n    //...\n}\n</code></pre>\n\n<p>and when I use <code>Player</code> class methods in <code>MyApp::OnInit</code> function, everything works fine, but when I use it in event function, I'm getting strange results (for example size of <b>empty</b> <code>std::vector&lt;int&gt;</code> declared in <code>Player</code> class returns 18446744073709551540). Event function:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void MyApp::OnCardSelect(wxCommandEvent&amp; event) {\n    std::cout &lt;&lt; (player-&gt;getChosen()).size() &lt;&lt; std::endl;\n    // above line only for debugging, getChosen() returns const std::vector&lt;int&gt;&amp;, which should be empty, but it print strange result\n    wxBitmapToggleButton *selectedCard = dynamic_cast&lt;wxBitmapToggleButton *&gt;(event.GetEventObject());\n    player -&gt; toggleChosen(int(selectedCard -&gt; GetId()));\n}\n</code></pre>\n\n<p>What is happening with component variables of <code>MyApp</code> after calling <code>OnInit</code> (using <code>IMPLEMENT_APP(MyApp)</code>), and where should I declare and change values of these varables?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1555514498, "post_id": 55730153, "comment_id": 98140796, "body": "When passing a pointer to a function, the value pointed at is passed by reference. The pointer itself is not. <code>scan</code>&#39;s <code>p</code> is a copy of <code>main</code>&#39;s <code>p</code>. They both point to the same place, but they are different variables. When <code>scan</code>&#39;s <code>p</code> is changed, <code>main</code>&#39;s <code>p</code> is unaffected."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1555512052, "creation_date": 1555512052, "answer_id": 55730241, "question_id": 55730153, "link": "https://stackoverflow.com/questions/55730153/simple-pointer-question-i-dont-know-why-the-exact-explanation-is-eluding-me/55730241#55730241", "title": "simple pointer question ( I don&#39;t know why the exact explanation is eluding me)", "body": "<p>A copy of <code>p</code> is passed, so when you increase it here:</p>\n\n<pre><code>printf(\"%c\", *p++);\n</code></pre>\n\n<p>You're not actually increasing the <code>p</code> passed in <code>main</code>, hence why you get an infinite loop. It works if you don't pass a copy of the pointer, but a reference instead:</p>\n\n<pre><code>void scan(char* &amp;p) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 3, "last_activity_date": 1555512074, "creation_date": 1555512074, "answer_id": 55730252, "question_id": 55730153, "link": "https://stackoverflow.com/questions/55730153/simple-pointer-question-i-dont-know-why-the-exact-explanation-is-eluding-me/55730252#55730252", "title": "simple pointer question ( I don&#39;t know why the exact explanation is eluding me)", "body": "<blockquote>\n  <p>ie why does p not get incremented in the outer level if that is even the problem?</p>\n</blockquote>\n\n<p>Your function operates at a copy of that pointer, so the incrementing won't affect the original pointer.</p>\n\n<p>To achieve that pass that pointer variable by reference:</p>\n\n<pre><code>void scan(char*&amp; p){\n  printf(\"%c\", *p++);\n}\n</code></pre>\n\n<p>Here's a <a href=\"http://coliru.stacked-crooked.com/a/107bc38c6ea91f2c\" rel=\"nofollow noreferrer\">working example online</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11374454"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555512074, "creation_date": 1555511827, "last_edit_date": 1555511897, "question_id": 55730153, "link": "https://stackoverflow.com/questions/55730153/simple-pointer-question-i-dont-know-why-the-exact-explanation-is-eluding-me", "title": "simple pointer question ( I don&#39;t know why the exact explanation is eluding me)", "body": "<p>This example seems so simple, I don't know why the exact explanation is eluding me..</p>\n\n<p>In the following example:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nvoid scan(char* p){\n  printf(\"%c\", *p++);\n}\n\nint main() {\n  char str[] = \"hi this is a test\";\n  char* p = str;\n\n  while(*p != '\\0'){\n    printf(\"%c\", *p++); //ok..\n  // scan(p); //crash\n  }\n\n}\n</code></pre>\n\n<p>what is the problem when using the scan function. ie why does p not get incremented in the outer level if that is even the problem?</p>\n"}, {"tags": ["c++", "c++17", "enable-if", "std-variant"], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 2905366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78978789ad07885056b754168b635657?s=128&d=identicon&r=PG&f=1", "display_name": "thayne", "link": "https://stackoverflow.com/users/2905366/thayne"}, "edited": false, "score": 0, "creation_date": 1555511849, "post_id": 55729886, "comment_id": 98139056, "body": "using !std::is_same_v still results in a compile error for my specific case. However, your second example using constexpr works!"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 166, "user_id": 2905366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78978789ad07885056b754168b635657?s=128&d=identicon&r=PG&f=1", "display_name": "thayne", "link": "https://stackoverflow.com/users/2905366/thayne"}, "edited": false, "score": 1, "creation_date": 1555512398, "post_id": 55729886, "comment_id": 98139417, "body": "@thayne Yeah that&#39;s cause I wrote it wrong, fixed. But yeah, <code>if constexpr</code> is way superior if it&#39;s viable."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1555512374, "last_edit_date": 1555512374, "creation_date": 1555511204, "answer_id": 55729886, "question_id": 55729713, "link": "https://stackoverflow.com/questions/55729713/overloading-a-function-with-stdenable-if-to-avoid-template-substitution-error/55729886#55729886", "title": "Overloading a function with std::enable_if to avoid template substitution error", "body": "<p>Here's a way reduced example:</p>\n\n<pre><code>template &lt;typename T, typename R, typename=std::enable_if_t&lt;std::is_same_v&lt;R, int&gt;&gt;\nvoid foo(T, R); // #1\n\ntemplate &lt;typename T, typename R&gt;\nvoid foo(T, R); // #2\n\nfoo(some_t{}, some_r{});\n</code></pre>\n\n<p>It doesn't really matter what the particular sfinae constraint is, so I picked a simple one. Now, if the constraint (in this case <code>is_same_v&lt;R, int&gt;</code>) is <em>not</em> met, substitution into <code>#1</code> fails and we're left with one single candidate: <code>#2</code>.</p>\n\n<p>But if substitution succeeds, then we have two candidates. They're equivalently viable, there's nothing to distinguish them. Hence, the call is ambiguous!</p>\n\n<hr />\n\n<p>We need an additional way to distinguish them. One way is to add the negated constrained to the other overload (note that you need to change the SFINAE form here to make this work):</p>\n\n<pre><code>template &lt;typename T, typename R, std::enable_if_t&lt;std::is_same_v&lt;R, int&gt;, int&gt; = 0&gt;\nvoid foo(T, R); // #1\n\ntemplate &lt;typename T, typename R, std::enable_if_t&lt;!std::is_same_v&lt;R, int&gt;, int&gt; = 0&gt;\nvoid foo(T, R); // #2\n</code></pre>\n\n<p>This ensures exactly one of the two is viable.</p>\n\n<p>Another way would be to forward the trait to a separate overload set:</p>\n\n<pre><code>template &lt;typename T, typename R&gt;\nvoid foo_impl(T, R, std::true_type); // #1\n\ntemplate &lt;typename T, typename R&gt;\nvoid foo_impl(T, R, std::false_type); // #2\n\ntemplate &lt;typename T, typename R&gt;\nvoid foo(T t, R r) {\n    return foo_impl(t, r, std::is_same&lt;R, int&gt;{}); // NB: not _v\n}\n</code></pre>\n\n<p>Another way would be to just write one overload and use <code>if constexpr</code> internally:</p>\n\n<pre><code>template &lt;typename T, typename R&gt;\nvoid foo(T, R) {\n    if constexpr (std::is_same_v&lt;R, int&gt;) {\n        // #1\n    } else {\n        // #2\n    }\n}\n</code></pre>\n\n<p>A future way (in C++20) would be to use concepts:</p>\n\n<pre><code>template &lt;typename T, typename R&gt;\n    requires std::is_same_v&lt;R, int&gt;\nvoid foo(T, R); // #1\n\ntemplate &lt;typename T, typename R&gt;\nvoid foo(T, R); // #2\n</code></pre>\n\n<p>This would make <code>#1</code> \"more constrained than\" <code>#2</code> if it's viable, so it would be preferred.</p>\n"}, {"tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1555517525, "creation_date": 1555517525, "answer_id": 55731947, "question_id": 55729713, "link": "https://stackoverflow.com/questions/55729713/overloading-a-function-with-stdenable-if-to-avoid-template-substitution-error/55731947#55731947", "title": "Overloading a function with std::enable_if to avoid template substitution error", "body": "<p>I wonder if a simple overload could work as well:</p>\n\n<pre><code>// General case (U::resource_t != R)\ntemplate &lt;typename U, typename R&gt;\n     typename U::value_t callCalcValue(U const&amp; u, R const&amp; r){\n       // Fail immediately!\n       assert(!\"Unit resource does not match\");\n       return U::value_t();\n     }\n\n//Specific case (U::resource_t == R) overloads the general case\ntemplate &lt;typename U&gt;\n      typename U::value_t callCalcValue(U const&amp; u,  typename U::resource_t const&amp; r){\n        return u.calcValue(r);\n      }\n</code></pre>\n"}], "owner": {"reputation": 166, "user_id": 2905366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78978789ad07885056b754168b635657?s=128&d=identicon&r=PG&f=1", "display_name": "thayne", "link": "https://stackoverflow.com/users/2905366/thayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 1, "accepted_answer_id": 55729886, "answer_count": 2, "score": 0, "last_activity_date": 1555517525, "creation_date": 1555510684, "last_edit_date": 1555510831, "question_id": 55729713, "link": "https://stackoverflow.com/questions/55729713/overloading-a-function-with-stdenable-if-to-avoid-template-substitution-error", "title": "Overloading a function with std::enable_if to avoid template substitution error", "body": "<p>I want to write two template functions such that one catches a specific case and the other catches all other cases that don't match first case.\nI'm trying to use std::enable_if to catch the specific case, but the compiler still fails with an ambiguous match. How can I write these overloaded functions so that the ambiguity is resolved by the compiler? (I'm using g++)</p>\n\n<p>I've tried writing the following code (this is a simplified example that reproduces the problem):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct resource1_t{\n};\n\nstruct resource2_t{\n};\n\ntemplate &lt;typename R, typename V&gt;\nstruct unit_t{\n  typedef R resource_t;\n  typedef V value_t;\n  unit_t(value_t const&amp; value):v(){}\n  value_t v;\n  value_t calcValue(resource_t const&amp; r)const{return v;}\n};\n\n// Specific case (U::resource_t == R)\ntemplate &lt;typename U, typename R, typename=std::enable_if_t&lt;std::is_same_v&lt;typename U::resource_t,R&gt;&gt;&gt;\n      typename U::value_t callCalcValue(U const&amp; u, R const&amp; r){\n        return u.calcValue(r);\n      }\n\n // General case (U::resource_t != R)\n template &lt;typename U, typename R&gt;\n      typename U::value_t callCalcValue(U const&amp; u, R const&amp; r){\n        // Fail immediately!\n        assert(!\"Unit resource does not match\");\n        return U::value_t();\n      }\n\nint main()\n{\n    // Create an array of unit variants\n   typedef unit_t&lt;resource1_t,int&gt; U1;\n   typedef unit_t&lt;resource2_t,float&gt; U2;\n   std::vector&lt;std::variant&lt;U1,U2&gt;&gt; units;\n   units.emplace_back(U1(1));\n   units.emplace_back(U2(1.0f));\n\n   // Create a parallel array of resources\n   std::vector&lt;std::variant&lt;resource1_t,resource2_t&gt;&gt; resources;\n   resources.emplace_back(resource1_t());\n   resources.emplace_back(resource2_t());\n\n   // Call calcValue for each unit on the parallel resource\n   for(int i(0); i&lt;units.size(); ++i){\n       std::visit([&amp;](auto&amp;&amp; unit){\n           std::visit([&amp;](auto&amp;&amp; resource){\n             // Fails to compile with substitution failure...\n             //std::cout &lt;&lt; unit.calcValue(resource) &lt;&lt; \"\\n\";\n\n             // Results in ambiguous call compile error...\n             std::cout &lt;&lt; callCalcValue(unit,resource) &lt;&lt; \"\\n\";\n           },resources[i]);\n       },units[i]);\n   }\n}\n</code></pre>\n\n<p>I expected the compiler to match all cases where <code>std::is_same_v&lt;U::resource_t,R&gt;</code> to the specific case and all other combinations to the general case, instead, the compiler fails saying the function is ambiguous.\nI also tried <code>! std::is_same</code> for the second definition and the compiler fails with <code>error: redefinition of ... callCalcValue()...</code></p>\n"}, {"tags": ["c++", "opencv", "video", "video-streaming", "libvlc"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1555510804, "post_id": 55729556, "comment_id": 98138388, "body": "<i>&quot;I passed the server ip and login info into VideoCapture() as an argument but it didn&#39;t work.&quot;</i> It didn&#39;t work is a quite vague problem description. Elaborate about what exactly <i>didn&#39;t work</i> please."}, {"owner": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "edited": false, "score": 0, "creation_date": 1555516387, "post_id": 55729556, "comment_id": 98141881, "body": "What do yo me at by \u201ccapture\u201d if it\u2019s in memory, it\u2019s already captured. Also the URL implies raw YUV. Where does h.264 come into the picture? Where is the encoding taking place?"}, {"owner": {"reputation": 289, "user_id": 1553872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0f74dc62b1c07d1fcf04f5519b4e34?s=128&d=identicon&r=PG", "display_name": "seokrae.kim", "link": "https://stackoverflow.com/users/1553872/seokrae-kim"}, "edited": false, "score": 0, "creation_date": 1556090420, "post_id": 55729556, "comment_id": 98314031, "body": "change http to rtsp"}], "owner": {"reputation": 1, "user_id": 11374115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2d074d7530c3ea5bb26ba764a505cd?s=128&d=identicon&r=PG&f=1", "display_name": "dizar", "link": "https://stackoverflow.com/users/11374115/dizar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 705, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555583204, "creation_date": 1555510229, "last_edit_date": 1555583204, "question_id": 55729556, "link": "https://stackoverflow.com/questions/55729556/video-capture-and-stream-in-c", "title": "Video capture and stream in C++", "body": "<p>I'm working on a problem, where as the input it takes video data(raw data) from a server(Network Video Recorder) and just streams the video using VLC. The data is provided in the pointer form (provided in code part) and I want to be able to capture and stream the video.</p>\n\n<p>I have already tried to use OpenCV and VLC to capture data, but I don't have experience with video in C++ and I wasn't able to get those data. In OpenCV, I passed the server ip and login info like (\"<a href=\"http://username:password@xx.xx.xx.xx:xxxx/yuv/video.yuv\" rel=\"nofollow noreferrer\">http://username:password@xx.xx.xx.xx:xxxx/yuv/video.yuv</a>\") into VideoCapture() as an argument but it didn't work.</p>\n\n<p>The code where the video data is from the NVR Sdk, where the video is passed frame by frame as the pointer.</p>\n\n<p>...</p>\n\n<pre><code>typedef struct FrameHeadr \n{ \n  unsigned char mediaType;  \n  unsigned char * pData;    //video Data as a pointer    \n  unsigned int preBufSize;           \n  unsigned int dataSize;             \n  unsigned char frameRate;          \n  unsigned int frameID;             \n  unsigned int timeStamp;            \n  union \n  { \n    struct { \n      int keyFrame;                 \n      unsigned short videoWidth;    \n      unsigned short videoHeight;   \n    } videoParam; \n        unsigned char audioMode;         \n  }; \n} FrameHeadr; \ntypedef FrameHeadr * pFrameHeadr; \n</code></pre>\n\n<p>...</p>\n\n<p>When the video data is captured or save, it doesn't need to be trans coded, just to be able to get the data and stream as RTSP in VLC. Since I'm a new learner, any suggestion, link or methodology how to do it, is appreciated. If the way how I am trying to capture video is wrong, pleas can you suggest any other method?</p>\n"}, {"tags": ["c++", "arrays", "data-structures", "hashtable"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1555510200, "post_id": 55729465, "comment_id": 98137946, "body": "If they <code>key</code> is the number they are on the ballot why not just use an array with <code>amount_of_candidates</code> size and index directly to them using <code>key</code>?"}, {"owner": {"reputation": 363, "user_id": 11249957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6002dbfc2a513f20bbd1191118595a3c?s=128&d=identicon&r=PG&f=1", "display_name": "dodekja", "link": "https://stackoverflow.com/users/11249957/dodekja"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1555510710, "post_id": 55729465, "comment_id": 98138316, "body": "That&#39;s the problem, I&#39;m not sure, if there is anything, that hash table does better in this situation, since the candidate order seems to be the best key."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1555510819, "post_id": 55729465, "comment_id": 98138401, "body": "As far as I can tell you gain nothing.  It cost you cycles to compute the hash for the hash table.  As long as the keys are dense then just using a table with the key as the index is as fast as you can get."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1555510850, "post_id": 55729465, "comment_id": 98138420, "body": "If keys are just consecutive numbers then array like the proposed by @NathanOliver will be much more effective and easier to implement. Actually, it would still be good if keys aren&#39;t consecutive but they have some reasonable limit so the array is not too big. Only when there is no such limit you need some more sophisticated data structure."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555510968, "post_id": 55729465, "comment_id": 98138480, "body": "since apparently keys are constitutive numbers just use array. You will not gain anything using hash here. Hash are good if you have larger amount of irregular keys or complex key compare method. Here it will be an overkill."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1555511076, "post_id": 55729465, "comment_id": 98138551, "body": "Hash table is rather tricky to implement. You need good enough hash function and also you need to deal with the situation when a few keys have the same hash. It&#39;s doable but I would suggest an array/list of key-value pairs or some sort of tree for better speed. (Although, you have to think about speed only if you deal with significant amount of data.)"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1555511125, "post_id": 55729465, "comment_id": 98138586, "body": "<code>Since this is a homework, datastructures built in the language are forbidden</code> This is so dumb, why do they always do this."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1555511207, "post_id": 55729465, "comment_id": 98138641, "body": "@FantasticMrFox So you can concentrate on reinventing the wheel instead of designing some nice solution ;)"}, {"owner": {"reputation": 363, "user_id": 11249957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6002dbfc2a513f20bbd1191118595a3c?s=128&d=identicon&r=PG&f=1", "display_name": "dodekja", "link": "https://stackoverflow.com/users/11249957/dodekja"}, "edited": false, "score": 0, "creation_date": 1555511448, "post_id": 55729465, "comment_id": 98138782, "body": "Well, there is about 10Mb of data files (for both election rounds), but the search complexity should be less than O(n) and sort complexity should be less then O(n^2)."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1555511618, "post_id": 55729465, "comment_id": 98138899, "body": "So basically you are forbidden from using bubble sort and from linearly searching over list of key-value pairs. Everything else will pass. I would suggest a binary tree which directly maps to binary representation of the key. (0 - left branch, 1 right branch) EDIT: of course use the tree only in the situation when you cannot just do this in array."}, {"owner": {"reputation": 363, "user_id": 11249957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6002dbfc2a513f20bbd1191118595a3c?s=128&d=identicon&r=PG&f=1", "display_name": "dodekja", "link": "https://stackoverflow.com/users/11249957/dodekja"}, "reply_to_user": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1555512132, "post_id": 55729465, "comment_id": 98139231, "body": "@NO_NAME thanks for the clarification, I guess going with the array solution would be best in this situation."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 3, "creation_date": 1555512870, "post_id": 55729465, "comment_id": 98139727, "body": "@NO_NAME: the external key is already a number. So in that case the hash function is trivial and is the identity function (which as said in question is already a perfect hash). Simply it means directly using an array..."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1555513094, "post_id": 55729465, "comment_id": 98139875, "body": "@SergeBallesta You&#39;re right, the array solution is a special case of hash table. I didn&#39;t think about that."}, {"owner": {"reputation": 363, "user_id": 11249957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6002dbfc2a513f20bbd1191118595a3c?s=128&d=identicon&r=PG&f=1", "display_name": "dodekja", "link": "https://stackoverflow.com/users/11249957/dodekja"}, "reply_to_user": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1555513976, "post_id": 55729465, "comment_id": 98140450, "body": "@NO_NAME could you please post your comments as an answer so I can approve it?"}], "answers": [{"tags": [], "owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "is_accepted": true, "score": 2, "last_activity_date": 1555571633, "last_edit_date": 1555571633, "creation_date": 1555541813, "answer_id": 55737032, "question_id": 55729465, "link": "https://stackoverflow.com/questions/55729465/is-hash-table-with-a-perfect-hash-function-better-than-an-array/55737032#55737032", "title": "Is hash table with a perfect hash function better than an array?", "body": "<p>I've aggregated my comments into one answer.</p>\n\n<p>This is a summary of different methods to implement a data structure called map (dictionary in some other languages).</p>\n\n<hr>\n\n<h2>List of key-value pairs</h2>\n\n<p>The simplest way of solving your problem would be to an array/list of key-value pairs which you just check one by one until you find the right key.\nIt has very poor efficiency, though. O(n) is good only for small data sets. Speed doesn't matter that much and in case of very low amounts of data, this approach may be even faster due to the overhead that more sophisticated data structures have (e.g. calculating hash function).</p>\n\n<p>This approach can be optimized quite significantly if you sort your keys and use binary search which is only O(log(n)).</p>\n\n<hr>\n\n<h2>Hash table</h2>\n\n<p>Hash table is rather tricky to implement. You need good enough hash function.\nGood hash function means that it has low amount of collisions - situations when two different keys have the same hash. You need program for this situation anyway but too high number of collisions decrease benefits from using hash table.</p>\n\n<p>Your implementation is quite simple.</p>\n\n<p><code>key % (amount_of_candidates + 1)</code></p>\n\n<p>It is hard to tell if it is good enough without knowing how keys are assigned.</p>\n\n<p>If keys are just consecutive numbers is perfectly good. (You don't even need <code>+ 1</code>.) Actually, in that situation you have a special case for hash table where you don't need to check for collisions because you can tell there won't be any.\nAt this point you can stop pretending that you use hash table and just make an array ;) Position of each candidate is just <code>key - smallest_key</code>. In fact, this would be a very effective solution: O(1).</p>\n\n<p>You cannot simplify it that much if keys are assigned randomly. In this case your solution is mostly good. However, <code>(amount_of_candidates + 1)</code> is too small size for the hash table. It should be about 30% bigger than the amount of data (<a href=\"https://en.wikipedia.org/wiki/Hash_table#Load_factor\" rel=\"nofollow noreferrer\">load factor</a>). This will decrease number of collisions to a reasonable level.</p>\n\n<hr>\n\n<h2>Binary tree</h2>\n\n<p>Yet another solution would be to use a binary tree which directly maps to binary representation of the key. (0 - left branch, 1 right branch)\nThis is a method very similar to binary search in array but it allows to easily add new elements without resizing the array and sorting the new element into it.\nThe disadvantage of that solution would be higher memory requirements.</p>\n\n<p>You could also experiment with other types of binary trees. You just need to remember to keep them balanced so they stay efficient. I don't really know much about balancing so I won't write more in this topic.</p>\n\n<hr>\n\n<h2>Conclusion</h2>\n\n<p>I infer that, in you case, keys are just consecutive integers so I would recommend the solution which uses a plain array with indices tier directly to values of keys.\nThis is a very simple and at the same time very effective solution.</p>\n\n<hr>\n\n<h1>Edit</h1>\n\n<p>OK, let's actually answer the question from the title.</p>\n\n<p>The implementation of perfect hash function you showed is no different than an array. It is just another way of coding the same thing and depending on some factors the result assembly may be the same.</p>\n\n<p>In the case of other hash function where keys are distributed over the whole range of <code>K</code>, straight array would be impractical / impossible to use due to huge amount of memory it would need. If you would succeed in allocating this amount of memory, array would be slightly faster because it wouldn't require to calculate hashes but it certainly wouldn't be worth it.</p>\n"}], "owner": {"reputation": 363, "user_id": 11249957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6002dbfc2a513f20bbd1191118595a3c?s=128&d=identicon&r=PG&f=1", "display_name": "dodekja", "link": "https://stackoverflow.com/users/11249957/dodekja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 55737032, "answer_count": 1, "score": 1, "last_activity_date": 1555571633, "creation_date": 1555509982, "question_id": 55729465, "link": "https://stackoverflow.com/questions/55729465/is-hash-table-with-a-perfect-hash-function-better-than-an-array", "title": "Is hash table with a perfect hash function better than an array?", "body": "<p>I am working on a project that interprets election data, using custom data structures. Currently I am deciding on what datastructure is best for storing information about the final amount of votes the candidates achieved in different territorial units.</p>\n\n<p>Since this is a homework, datastructures built in the language and datastructures from external libraries  are forbidden. Also, complexity for search must be lesser than O(n).</p>\n\n<p>The hash function I intend to use looks like this</p>\n\n<p>The key type would be of type unsigned int, the key itself would be the candidate's number on the ballot.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename K, typename T&gt;\ninline int CandidateResultsHashTable&lt;K, T&gt;::hashFunction(const K &amp; key) const\n    {\n        return key % (amount_of_candidates + 1);\n    }\n</code></pre>\n\n<p>The amount of candidates is known, although it can change between election rounds. All the data stored inside the hash table would be read from a file, which contains data for all candidates. So there shouldn't be any number that doesn't belong to a candidate.</p>\n\n<p>I want to know, which implementation would be better based on access times and memory usage.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1555508801, "post_id": 55728998, "comment_id": 98136993, "body": "And <code>Char</code> is exactly defined where? You probably wanted to use <code>char</code> instead."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555508829, "post_id": 55728998, "comment_id": 98137007, "body": "<code>Char</code> is neither a standard type nor a type provided by the Windows API (it provides <code>CHAR</code>). It&#39;s not clear to why you expect <code>Char</code> to be defined or by what."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1555508873, "post_id": 55728998, "comment_id": 98137043, "body": "C++ has no such types. Both UChar and Char are custom types defined in one header or another. Probably a header with a similar name to the one that defined UChar"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1555509091, "post_id": 55728998, "comment_id": 98137190, "body": "Check <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/string-and-character-literals-cpp?view=vs-2019\" rel=\"nofollow noreferrer\">String and Character Literals</a> in the Visual C++ docs. It explains that the C++ standard character types are <code>char</code> for 8-bit characters, <code>char16_t</code> for UTF16, <code>char32_t</code> for UTF32 and that the STL string types are string, u16string and u32string"}, {"owner": {"reputation": 123, "user_id": 10883908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678374a498afcf882f4fc09c22930cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ma", "link": "https://stackoverflow.com/users/10883908/dee-ma"}, "edited": false, "score": 0, "creation_date": 1555598571, "post_id": 55728998, "comment_id": 98173740, "body": "Hi all, the problem has been solved. Both of you are right, I forgot to modify the definitions of &#39;Char&#39; in a header. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 10883908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678374a498afcf882f4fc09c22930cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ma", "link": "https://stackoverflow.com/users/10883908/dee-ma"}, "edited": false, "score": 0, "creation_date": 1555598661, "post_id": 55729051, "comment_id": 98173774, "body": "Thanks, Bathsheba! I just forgot to modify the definitions of &#39;Char&#39;"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 1, "last_activity_date": 1555508885, "creation_date": 1555508885, "answer_id": 55729051, "question_id": 55728998, "link": "https://stackoverflow.com/questions/55728998/why-the-char-identifier-could-not-be-recognised-in-vs2013/55729051#55729051", "title": "Why the \u2018Char\u2019 identifier could not be recognised in VS2013?", "body": "<p>Neither <code>Char</code>, <code>UChar</code>, nor <code>Bool</code> are defined as types by the C++ standard.</p>\n\n<p>They are most likely part of a library like MFC or ATL, and are probably (you can but hope) <code>typedef</code>s for primitive types like <code>char</code>, <code>unsigned char</code>, and <code>bool</code>.</p>\n\n<p>Since neither <code>TComDataCU</code> nor <code>SliceType</code> are not C++ standard classes either, it's probably a simple case of studying the documentation associated with that class, to see what other headers you need to include.</p>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 10883908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678374a498afcf882f4fc09c22930cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ma", "link": "https://stackoverflow.com/users/10883908/dee-ma"}, "edited": false, "score": 0, "creation_date": 1555598632, "post_id": 55729095, "comment_id": 98173759, "body": "Thanks, Theodor Badea! The problem has been solved, you are right, I forgot to correct the definitions of &#39;Char&#39; in a header."}], "tags": [], "owner": {"reputation": 465, "user_id": 11241587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea334bb29226f73a25b431b3e48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Theodor Badea", "link": "https://stackoverflow.com/users/11241587/theodor-badea"}, "is_accepted": false, "score": 3, "last_activity_date": 1555509001, "creation_date": 1555509001, "answer_id": 55729095, "question_id": 55728998, "link": "https://stackoverflow.com/questions/55728998/why-the-char-identifier-could-not-be-recognised-in-vs2013/55729095#55729095", "title": "Why the \u2018Char\u2019 identifier could not be recognised in VS2013?", "body": "<p>Char is not a primitive type. I think you might refer to char. If you want to use Char, you must define the meaning of Char. Maybe you forgot a library in which Char is defined.</p>\n"}], "owner": {"reputation": 123, "user_id": 10883908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678374a498afcf882f4fc09c22930cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ma", "link": "https://stackoverflow.com/users/10883908/dee-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55729051, "answer_count": 2, "score": 0, "last_activity_date": 1555509001, "creation_date": 1555508733, "question_id": 55728998, "link": "https://stackoverflow.com/questions/55728998/why-the-char-identifier-could-not-be-recognised-in-vs2013", "title": "Why the \u2018Char\u2019 identifier could not be recognised in VS2013?", "body": "<p>I am just using VS2013 to build the HEVC reference software. Here, I write a C++ file and want to build it. However, it always shown that 'Identifier \"Char\" is not defined'. </p>\n\n<p>I also use 'UChar*' and it is ok in VS2013, but the 'Char*' is shown not defined...</p>\n\n<p>I am confused about this. Could you please me with this?</p>\n\n<p>Thanks in advance!</p>\n\n<p>I tried to use 'Char*' to define the string variable in VS2013, however, it returned error message....</p>\n\n<pre><code>void recordMBInfo(TComDataCU*&amp; pcCU, SliceType sliceType)\n{\nChar* modeInfo;\nChar* parSize = pcCU-&gt;getPartitionSize();\nBool* skipFlag = pcCU-&gt;getSkipFlag();\nChar* preMode = pcCU-&gt;getPredictionMode();\nUChar* puhDepth = pcCU-&gt;getDepth();\n\nChar* phQP = pcCU-&gt;getQP();\n\n\nmodeInfo = new Char[pcCU-&gt;getTotalNumPart() + 1];\n</code></pre>\n\n<p>My problem is that the 'UChar*' is correct in VS2013, but 'Char*' returned error message. I am not sure the reason about this.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1555508677, "post_id": 55728954, "comment_id": 98136907, "body": "what does the error say?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555508719, "post_id": 55728954, "comment_id": 98136938, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> reproducing your problem as required here please."}, {"owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "edited": false, "score": 0, "creation_date": 1555522241, "post_id": 55728954, "comment_id": 98144689, "body": "Please copy and paste the exact error you say that you&#39;re getting."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1555510481, "post_id": 55729198, "comment_id": 98138130, "body": "i mildly advise against answering questions that are as unclear as this one before they have been clarified. OPs is talking about some different parts of the code and we dont know what is the error they are trying to fix (btw without compiling the code I also dont know what is the error you are refering to)"}, {"owner": {"reputation": 1, "user_id": 11374061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977008244368deba581525e791d7809?s=128&d=identicon&r=PG&f=1", "display_name": "Mergim315", "link": "https://stackoverflow.com/users/11374061/mergim315"}, "edited": false, "score": 0, "creation_date": 1555521891, "post_id": 55729198, "comment_id": 98144540, "body": "Yes i should of removed this line before posting(i was testing things), i will edit it right now sorry for the confusing. The code runs fine theres no errors im just looking to find out how can i get the data in the object specifically ( int cost) through my vector."}, {"owner": {"reputation": 1, "user_id": 11374061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977008244368deba581525e791d7809?s=128&d=identicon&r=PG&f=1", "display_name": "Mergim315", "link": "https://stackoverflow.com/users/11374061/mergim315"}, "edited": false, "score": 0, "creation_date": 1555522136, "post_id": 55729198, "comment_id": 98144650, "body": "If i print out ( Search) it retruns the address of (listPos-1) to my understanding (*Search) is suppose to dereference the pointer to return the data values in my class UnSold @ listPos-1, but it returns an error."}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "reply_to_user": {"reputation": 1, "user_id": 11374061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977008244368deba581525e791d7809?s=128&d=identicon&r=PG&f=1", "display_name": "Mergim315", "link": "https://stackoverflow.com/users/11374061/mergim315"}, "edited": false, "score": 0, "creation_date": 1555541593, "post_id": 55729198, "comment_id": 98151902, "body": "@Mergim315 What do you mean by &quot;returns an error&quot;? Is it a compile error or a runtime error? What&#39;s the error message?"}], "tags": [], "owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "is_accepted": false, "score": 0, "last_activity_date": 1555509299, "creation_date": 1555509299, "answer_id": 55729198, "question_id": 55728954, "link": "https://stackoverflow.com/questions/55728954/vector-pointers-and-retrieving-data/55729198#55729198", "title": "vector pointers and retrieving data", "body": "<p>This is a compile error.\nRemove line 85: <code>newItem.at(listPos - 1);</code> and it runs just fine in visual studio.</p>\n\n<p>The issue is that <code>newItem</code> is a pointer to an element. I assume you meant to use <code>Inventory</code> here instead. However, that logic was already done on the previous line.</p>\n\n<p>On a side note, I stongly advise against storing owning pointers like this. There's no good reason in this case not to just use <code>vector&lt;UnSold&gt;</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11374061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977008244368deba581525e791d7809?s=128&d=identicon&r=PG&f=1", "display_name": "Mergim315", "link": "https://stackoverflow.com/users/11374061/mergim315"}, "edited": false, "score": 0, "creation_date": 1555524741, "post_id": 55733293, "comment_id": 98145857, "body": "For the PrintEverything function i added 1 to ( i ) to start it at 1 intstead of 0."}, {"owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "reply_to_user": {"reputation": 1, "user_id": 11374061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977008244368deba581525e791d7809?s=128&d=identicon&r=PG&f=1", "display_name": "Mergim315", "link": "https://stackoverflow.com/users/11374061/mergim315"}, "edited": false, "score": 0, "creation_date": 1555525092, "post_id": 55733293, "comment_id": 98145987, "body": "You have to do it everywhere then. If you&#39;re allowing your list to be started at 1(from the user&#39;s perspective), anytime the user provides a list index, you have to subtract 1 from it. So make the changes mentioned for the second case.  As an example, you add an item to the list. That item is at Inventory[0]. To sell the item, the user would say they want to sell the first item on the list, so they input 1. Your conditional fails because listPos &lt; Inventory.size() is false because they&#39;re both 1.  Also don&#39;t forget the second conditional check to make sure they don&#39;t input 0."}], "tags": [], "owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "is_accepted": false, "score": 0, "last_activity_date": 1555525377, "last_edit_date": 1555525377, "creation_date": 1555523051, "answer_id": 55733293, "question_id": 55728954, "link": "https://stackoverflow.com/questions/55728954/vector-pointers-and-retrieving-data/55733293#55733293", "title": "vector pointers and retrieving data", "body": "<pre><code>else if ( UserInput == \"sell\") {\n    cout &lt;&lt; \"List Positon: \";\n    cin &gt;&gt; listPos;\n    if ( listPos &lt; Inventory.size()){\n        cout &lt;&lt; \" Item Sold and Removed from list position \" &lt;&lt; listPos &lt;&lt;endl;\n        search = Inventory.at(listPos-1);\n\n\n            //cout&lt;&lt; \"contents of Search: \"&lt;&lt; search &lt;&lt; endl;\n\n            delete search;\n            Inventory.erase(Inventory.begin() + (listPos -1));\n</code></pre>\n\n<p>Here you mix the use of <code>listPos</code> and <code>listPos - 1</code>. </p>\n\n<p>If you're allowing the user to input position 0 indexed, then</p>\n\n<blockquote>\n  <p><code>Inventory.at(listPos-1)</code> should be <code>Inventory.at(listPos)</code> <br> and <br>\n  <code>Inventory.erase(Inventory.begin() + (listPos -1))</code> should be  <code>Inventory.erase(Inventory.begin() + (listPos))</code>. </p>\n</blockquote>\n\n<p><strong>If you're letting them input the position with the indexing starting at 1</strong>, then </p>\n\n<blockquote>\n  <p><code>if (listPos &lt; Inventory.size())</code> should be <br>\n  <code>if(listPos &lt;= Inventory.size() &amp;&amp; listPos &gt; 0)</code> </p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 11374061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977008244368deba581525e791d7809?s=128&d=identicon&r=PG&f=1", "display_name": "Mergim315", "link": "https://stackoverflow.com/users/11374061/mergim315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "answer_count": 2, "score": -4, "last_activity_date": 1555525377, "creation_date": 1555508575, "last_edit_date": 1555521991, "question_id": 55728954, "link": "https://stackoverflow.com/questions/55728954/vector-pointers-and-retrieving-data", "title": "vector pointers and retrieving data", "body": "<p>I'm a beginner at coding in C++ and every other language. The problem I'm having here is in main() with the first (else if) where (UserInput == sell). I would like the function to print the data stored in the object @listPos to retrieve the cost and input it into my incomplete Profit() function, but every time I dereference the pointer (Search) I get an error code. There's something I'm missing big time please help!!</p>\n\n<p>Ive already tried (*search) but there's a huge error code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nclass UnSold{\n\npublic:\nUnSold(string NameOfShoe, int PurchasePrice ){\n    name = NameOfShoe;\n    cost = PurchasePrice;\n    return;\n}\n\nvoid SetName(string NameOfShoe){\n    name = NameOfShoe;\n    return;\n}\nvoid SetCost(int PurchasePrice){\n    cost = PurchasePrice;\n    return;\n}\n\nstring GetName() const {\n    return name;\n}\nint GetCost() const{\n    return cost;\n}\n\nvoid Profit();\nvoid PrintItem();   \nprivate:\n    string name;\n    int cost;\n};\nvoid UnSold::Profit(){\n    static int profit = 0;\n    //profit += (sold-cost);\n}\nvoid UnSold::PrintItem(){\n    cout &lt;&lt; \"Name: \" &lt;&lt; this-&gt;name &lt;&lt; \" Cost: \" &lt;&lt; this-&gt;cost &lt;&lt; endl;\n}\n\nvoid PrintEverything(vector&lt;UnSold*&gt; AllItems) {\n    unsigned int i;\n\n    for (i=0; i&lt;AllItems.size(); ++i) {\n        cout&lt;&lt; i+1 &lt;&lt; \" \";\n        (*AllItems.at(i)).PrintItem();\n    }\n\n}\nint main(){\n\n    vector&lt;UnSold*&gt; Inventory;\n    string Name;\n    int Cost;\n    string UserInput;\n    unsigned int listPos;\n\n    UnSold* newItem = nullptr;\n    UnSold* search = nullptr; \n\n    while ( UserInput != \"quit\") {\n\n        cout &lt;&lt; \"Do you want to add, sell, print or quit?\" &lt;&lt;endl;\n        cin &gt;&gt; UserInput;\n\n        if ( UserInput == \"add\") {\n            cout &lt;&lt; \"Enter item name: \"&lt;&lt;endl;\n            cin &gt;&gt; Name;\n            cout &lt;&lt; \"Enter item cost: \" &lt;&lt; endl;\n            cin &gt;&gt; Cost;\n            newItem = new UnSold(Name, Cost);\n            Inventory.push_back(newItem);\n        }\n\n        else if ( UserInput == \"sell\") {\n            cout &lt;&lt; \"List Positon: \";\n            cin &gt;&gt; listPos;\n            if ( listPos &lt; Inventory.size()){\n                cout &lt;&lt; \" Item Sold and Removed from list position \" &lt;&lt; listPos &lt;&lt;endl;\n                search = Inventory.at(listPos-1);\n\n\n                //cout&lt;&lt; \"contents of Search: \"&lt;&lt; search &lt;&lt; endl;\n\n                delete search;\n                Inventory.erase(Inventory.begin() + (listPos -1));\n            }\n            else{\n                cout &lt;&lt; \"Error\"&lt;&lt;endl;\n            }\n        }\n        else if ( UserInput == \"print\") {\n            PrintEverything(Inventory);\n        }\n\n        else if ( UserInput != \"quit\"){\n        }\n\n\n    }       \n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "language-lawyer", "c++03", "variadic"], "comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 3, "creation_date": 1555511638, "post_id": 55728743, "comment_id": 98138910, "body": "The standard requires the argument to <code>va_start</code> to be the rightmost parameter in the parameter list (<a href=\"https://eel.is/c++draft/cstdarg.syn#1.sentence-2\" rel=\"nofollow noreferrer\">&#91;cstdarg.syn&#93;</a>). Since <code>this</code> is not in the parameter list, I&#39;d say it&#39;s undefined behavior."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555517744, "post_id": 55728743, "comment_id": 98142587, "body": "From a conceptual standpoint this is strange, since how is the callee supposed to know the number of arguments? The only sane place it can get it from is via <code>this</code>, but that means the number of arguments passed isn&#39;t a property of the invocation anymore, but of the object itself. That&#39;s pretty weird and it&#39;s not clear to me that it&#39;s a good design... and I&#39;m not sure I&#39;ve seen that in any language before."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555518766, "post_id": 55728743, "comment_id": 98143102, "body": "@Mehrdad: Consider a function that accepts an arbitrary number of strings and output their total length followed by their content.  If one could get a <code>va_list</code> that started with the first string, one could use <code>va_copy</code> on that, use one loop that reads all the arguments from the original va_list and adds up the lengths, and then a loop that uses the copied va_list to output all the strings, without having to &quot;special-case&quot; the first string."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1555518969, "post_id": 55728743, "comment_id": 98143194, "body": "@supercat: But in that case you should be making the first string explicit. Varargs would imply that it could be absent, which is clearly not the case, unlike with the arguments that follow, so it really is a special case. And practically speaking it helps the compiler raise an error if you forget to specify it."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555519563, "post_id": 55728743, "comment_id": 98143481, "body": "@Mehrdad: Using a separate explicit argument for the first string pointer require that code make an extra copy of that pointer as well as the <code>va_list</code>.  Further, any functions that are passed a va_list would need to be passed a first-string pointer in addition to the va_list.  Not a terribly huge problem, but the code could be cleaner and more efficient if that weren&#39;t required."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1555519796, "post_id": 55728743, "comment_id": 98143593, "body": "@supercat: Yes, that&#39;s what <code>sprintf</code> et al. already do..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555519902, "post_id": 55728743, "comment_id": 98143651, "body": "@Mehrdad: As another couple considerations: (1) one could legitimately pass zero non-sentinel values, and forgetting the sentinel in the zero-other-items case seems so much less likely than forgetting it in other cases that the validation would be of little value; (2) in some cases where a function receives pointers to two methods, but will use one <i>only</i> for purposes of passing it to the second, the code through which the function pointer is passed shouldn&#39;t need to know or care about any of its argument types."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555519969, "post_id": 55728743, "comment_id": 98143683, "body": "@Mehrdad: The first two arguments of <code>sprintf</code> are processed totally differently from any that follow, so I&#39;m not sure what your point is."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1555520249, "post_id": 55728743, "comment_id": 98143819, "body": "@supercat: My point is that they still need to be passed around separately with <code>va_list</code> like you said, and that doesn&#39;t exactly pose a problem."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555520895, "post_id": 55728743, "comment_id": 98144118, "body": "@Mehrdad: If the first arguments to <code>sprintf</code> weren&#39;t processed separately, it would need to fetch them from the <code>va_list</code> using different code from everything else.  The natural way to write an &quot;output items until sentinel&quot; function, however, would be to process the first item in the same loop as every other."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1555521221, "post_id": 55728743, "comment_id": 98144266, "body": "@supercat: Yes that&#39;s just <code>char const *fmt = va_arg(ap, char const *);</code>. Hardly something anyone loses sleep over. And for the loop it&#39;s also not exactly difficult to make it do one extra iteration for the first element and fetch that when <code>i == 0</code> or something. I have to say it would be nice if you didn&#39;t keep picking pointless arguments with me on StackOverflow though..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1555523070, "post_id": 55728743, "comment_id": 98145117, "body": "@Mehrdad: You asked a question--how one could plausibly use the ability to have all arguments be variadic.  I sought to describe a way that could be useful.  Not indispensable, perhaps, but somewhat useful.  BTW, can you name any languages other than C or C++ which support variadic arguments but require at least one fixed argument?  C#, VB.Net, Javascript, and I think Java all allow one to define a function which can usefully accept an arbitrary number of parameters including zero.  So far as I can tell, C and C++ are unique in <i>not</i> doing so."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1555523417, "post_id": 55728743, "comment_id": 98145273, "body": "@supercat: Those languages all pass the length in the background. C and C++ don&#39;t impose such overhead for you. And in any case, in none of the cases is the argument length a property of the object whose method is being called. Can you stop arguing please?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1555529989, "post_id": 55728743, "comment_id": 98148085, "body": "I assume you thought of overloading the member function (which could get tricky since it\u2019s <code>virtual</code>) or passing a data structure of variable size as the parameter. Is there a reason those aren\u2019t good options?"}], "answers": [{"comments": [{"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 4, "creation_date": 1555508895, "post_id": 55728890, "comment_id": 98137052, "body": "Is it possible for an ABI to assign a specific register for <code>this</code> which is never used in regular functions (hence breaking va_start)? Is it possible for <code>this</code> to be subject to special optimizations which break va_start?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555509412, "post_id": 55728890, "comment_id": 98137426, "body": "@MichaelVeksler: I don&#39;t think the &quot;special optimizations&quot; part should be relevant, but I did consider the ABI aspect.  I decided it is not very reasonable to expect ABI-related breakage, because ABIs already treat different parameters differently e.g. based on their type (int goes here, float goes there).  It&#39;s upon the implementation to understand which types of parameters go where, and if <code>this</code> is passed in a specific register that&#39;s not really different to values of type <code>double</code> being passed in a specific register, is it?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555509797, "post_id": 55728890, "comment_id": 98137691, "body": "I still feel uncomfortable about this. Generally when something is not allowed explicitly in C++, it is undefined behavior. The way I understand it, <code>this</code> is not defined as a parameter in the standard, which is not compatible with the language of va_start"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555509964, "post_id": 55728890, "comment_id": 98137804, "body": "@MichaelVeksler: If <code>this</code> is not a parameter, how does <code>std::bind(&amp;C::f, c)</code> work?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 2, "creation_date": 1555510367, "post_id": 55728890, "comment_id": 98138062, "body": "you are talking about implementation details, not the language of the standard. The language does not say that<code>this</code> is a parameter. At least not in a way compatible with va_start language. Of course it&#39;s implemented as a parameter, but without explicit language guarantee the compiler might do something bad with it"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555510964, "post_id": 55728890, "comment_id": 98138476, "body": "I just figured out when it might break - singletons. The compiler might figure out that an object is a singleton, and avoid passing <code>this</code> as a parameter. In such a case, <code>this</code> becomes a global entity whose address is set  at link or load time."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1555511261, "post_id": 55728890, "comment_id": 98138669, "body": "@JohnZwinck The behavior of <code>bind</code> is specified to use the <code>INVOKE</code> operation described <a href=\"https://en.cppreference.com/w/cpp/utility/functional/invoke\" rel=\"nofollow noreferrer\">here</a>, which has special handling for member functions. This is just an abstraction layer, so it doesn&#39;t mean the ABI is compatible."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555511473, "post_id": 55728890, "comment_id": 98138805, "body": "@MichaelVeksler: Can you describe or link to example code showing the specific type of singleton you&#39;re talking about?  Singleton is a pattern which may be implemented in several ways, and I&#39;m not sure what you&#39;re thinking of."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1555512194, "post_id": 55728890, "comment_id": 98139282, "body": "<i>&quot;It will be easy to add a unit test&quot;</i>, how, in any reasonably reliable way?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555512388, "post_id": 55728890, "comment_id": 98139413, "body": "@JohnZwinck look at my answer below"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1555512539, "post_id": 55728890, "comment_id": 98139515, "body": "@PasserBy: Here are some ideas: (1) Call the function, check the results (via passing the args to snprintf(), vsnprintf(), etc).  (2) Do the same thing but running inside UBSan, valgrind, etc.  (3) Compile but do not assemble, check in the generated assembly code for a simple example of both callee and caller, and diff (in case your platforms ever change)."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1555558881, "post_id": 55728890, "comment_id": 98154965, "body": "@MichaelVeksler: At which point you get a compiler error as the compiler tries to take the address of the register. It might be an intelligent one, or it might just say internal compiler error. Now if it said &quot;can&#39;t take the address of a variable declared register&quot; it would be really nice."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1555560284, "post_id": 55728890, "comment_id": 98155229, "body": "@Joshua from language point of view registers don&#39;t exist - they are only a hidden implementation detail. If you try to take the address of a parameter passed by register, the compiler will store the value on stack, and refer to the address of that."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1555508343, "creation_date": 1555508343, "answer_id": 55728890, "question_id": 55728743, "link": "https://stackoverflow.com/questions/55728743/is-safe-to-use-va-start-macro-with-this-as-parameter/55728890#55728890", "title": "Is safe to use va_start macro with this as parameter?", "body": "<p>I think it should be OK, though I doubt you will find a specific citation from the C++ standard which says so.</p>\n\n<p>The rationale is this: <code>va_start()</code> must be passed the last argument to the function.  A member function taking no explicit parameters has only a single parameter (<code>this</code>), which therefore must be its last parameter.</p>\n\n<p>It will be easy to add a unit test to alert you if you ever compile on a platform where this doesn't work (which seems unlikely, but then again you are already compiling on a somewhat atypical platform).</p>\n"}, {"comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 2, "creation_date": 1555510763, "post_id": 55729544, "comment_id": 98138356, "body": "If it&#39;s undefined, then I&#39;d go even further and say that not only can it cause different results on different implementations, but also with different runs on the same implementation."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 2, "creation_date": 1555511169, "post_id": 55729544, "comment_id": 98138612, "body": "@cadaniluk Real world implementations are much more consistent than what is required by standard, whether their <i>extensions</i> are documented or not. Simply relying on that gives non portable code."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 2, "creation_date": 1555518872, "post_id": 55729544, "comment_id": 98143151, "body": "@SergeBallesta: Some real-world compiler-writers try to be more consistent than what is required by the Standard. Others are more prone to view consistent behaviors as &quot;missed optimization opportunities&quot; regardless of whether the consistent behaviors might have been useful, or the &quot;optimizations&quot; are likely to offer any real benefit."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1555549934, "post_id": 55729544, "comment_id": 98153422, "body": "@SergeBallesta More consistent than is required, yes, but that does not mean that they are consistent enough to be relied upon. Even if an implementation always compiles the UB-containing code the same way (which is not guaranteed, but isn&#39;t unusual for some types of UB), and even if it compiles it the same way across all different levels of optimization (which is less likely), there&#39;s still no guarantee that the next release of the same compiler won&#39;t change a few things that result in different behavior in certain undefined cases. And trying to get such code to work again is a colossal pain."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1555573973, "post_id": 55729544, "comment_id": 98159966, "body": "@supercat: That&#39;s why I had said that it was UB and would give non portable code. My remark was just about <i>different runs on the same implementation</i>. It is certainly allowed per standard for UB. But in this specific use case, I still think that the risk is low. Just my opinion of course, only enforced by programming for forty years."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1555594353, "post_id": 55729544, "comment_id": 98171106, "body": "@SergeBallesta: If one is using a compiler written by someone who values compatibility with earlier compilers, that is true.  If one is using a compiler whose authors think decades of useful behavior is just &quot;happenstance&quot; resulting from &quot;missed optimizations&quot;, however, then code which relies upon anything not mandated by the Standard--even constructs whose behavior the authors of the Standard thought were sufficiently obvious to not need mention--will be prone to fail."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 20, "last_activity_date": 1555510505, "last_edit_date": 1555510505, "creation_date": 1555510203, "answer_id": 55729544, "question_id": 55728743, "link": "https://stackoverflow.com/questions/55728743/is-safe-to-use-va-start-macro-with-this-as-parameter/55729544#55729544", "title": "Is safe to use va_start macro with this as parameter?", "body": "<p>Nothing specifies that behaviour in the standard, so this construct just invokes formal Undefined Behaviour. That means that it can work fine in your implementation and cause compilation error or unexpected results in a different implementation.</p>\n\n<p>The fact that non static methods have to pass the hidden <code>this</code> pointer cannot guarantee that <code>va_start</code> can use it. It probably works that way because in the early times, C++ compilers were just pre-processors that converted C++ source to C source and the hidden <code>this</code> parameter was added by the pre-processor to be available to the C compiler. And it has probably be maintained for <em>compatibility</em> reasons. But I would try hard to avoid that in mission critical code...</p>\n"}, {"comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555513342, "post_id": 55730159, "comment_id": 98140020, "body": "Isn&#39;t the hypothetical optimization you&#39;ve presented also possible if the parameter is named? E.g. a <code>single*</code> which is ever dereferenced can be shown to come from <code>static single x</code> in <code>get()</code>, therefore it does not need to be passed to a regular free function <code>void f(single* s, ...) { *s; va_list vl; va_start(vl, s); va_end(vl); }</code>. Do you think this function <code>f</code> has undefined behavior too?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555513363, "post_id": 55730159, "comment_id": 98140037, "body": "@JohnZwinck no, it doesn&#39;t, since that would break va_start for an explicit parameter. The compiler is not allowed to perform optimizations which break legal code"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 2, "creation_date": 1555513447, "post_id": 55730159, "comment_id": 98140101, "body": "You&#39;ve basically made a circular argument now."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555525647, "post_id": 55730159, "comment_id": 98146242, "body": "You can&#39;t optimize away regular <code>single*</code> parameter, since it could either point to the singleton or be null. On the other hand <code>this</code> must point to the singleton, always."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555563287, "post_id": 55730159, "comment_id": 98155926, "body": "You can optimize away a regular <code>single*</code> if it is dereferenced (because that means if it is null you have UB, so it didn&#39;t matter what you did).  That&#39;s why I wrote the unused <code>*s</code>."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555564940, "post_id": 55730159, "comment_id": 98156402, "body": "@JohnZwinck I agree. There are cases when the compiler can optimize away a parameter. It does that regularly when inlining a function. Yet, va_start works, since inlining is disabled (or made to appear so) when va_start is present. Optimizing away <code>this</code> can also be disabled with variadic functions, but the compiler is not required to do so for undefined behavior (and va_start for <code>this</code> qualifies)"}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 0, "last_activity_date": 1555546354, "last_edit_date": 1555546354, "creation_date": 1555511840, "answer_id": 55730159, "question_id": 55728743, "link": "https://stackoverflow.com/questions/55728743/is-safe-to-use-va-start-macro-with-this-as-parameter/55730159#55730159", "title": "Is safe to use va_start macro with this as parameter?", "body": "<p>This is undefined behavior. Since the language does not require <code>this</code> to be passed as a parameter, it might not be passed at all. </p>\n\n<p>For example, if a compiler can figure out that an object is a singleton, it may avoid passing <code>this</code> as a parameter and use a global symbol when the address of <code>this</code> is explicitly required (like in the case of va_start). In theory, the compiler might generate code to compensate that in <code>va_start</code> (after all, the compiler knows this is a singleton), but it is not required to do so by the standard.</p>\n\n<p>Think of something like:</p>\n\n<pre><code>class single {\npublic:\n   single(const single&amp; )= delete;\n   single &amp;operator=(const single&amp; )= delete;\n   static single &amp; get() {\n       // this is the only place that can construct the object.\n       // this address is know not later than load time:\n       static single x;\n       return x;\n   }\n  void print(...) {\n      va_list args;\n      va_start (args, this);\n      vprintf (\"%d\\n\", args);\n      va_end (args);\n}\n\nprivate:\n  single() = default;\n};\n</code></pre>\n\n<p>Some compilers,  like clang 8.0.0, emit a warning for the above code:</p>\n\n<pre><code>prog.cc:15:23: warning: second argument to 'va_start' is not the last named parameter [-Wvarargs] va_start (args, this);\n</code></pre>\n\n<p>Despite the warning,  <a href=\"https://wandbox.org/permlink/r1KD3epgc3NWIUMj\" rel=\"nofollow noreferrer\">it runs ok</a>. In general, this proves nothing, but it is a bad idea to have a warning . </p>\n\n<p><strong>Note</strong>: I don't know of any compiler that detects singletons and treats them specially, but the language does not forbid this kind of optimization. If it is not done today by your compiler, it might be done tomorrow by another compiler.</p>\n\n<p><strong>Note 2:</strong> despite all that, it might work in practice to pass this to <code>va_start</code>. Even if it works, it is not a good idea to do something that isn't guaranteed by the standard.</p>\n\n<p><strong>Note 3</strong>:  The same singleton optimization can't be applied to parameters such as:</p>\n\n<pre><code>void foo(singleton * x, ...)\n</code></pre>\n\n<p>It can't be optimized away since it may have one of two values, point to the singleton or be <code>nullptr</code>. This means that this optimization concern does not apply here.</p>\n"}, {"comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555513111, "post_id": 55730516, "comment_id": 98139885, "body": "You say that <code>va_start(ap, pN)</code> takes the address of <code>pN</code>.  Are you sure that&#39;s what it does?  What if <code>pN</code> is a parameter passed in a register, and therefore has no address?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555513176, "post_id": 55730516, "comment_id": 98139925, "body": "@JohnZwinck putting an ellipsis in the arguments should force the function/method into cdecl calling convention"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1555514664, "post_id": 55730516, "comment_id": 98140922, "body": "@JohnZwinck ok, I see that gcc has va_* as a bunch of builtins that are free to do even crazy stuff like traverse multiple registers; not sure how &quot;IAR compiler&quot; does <code>va_start</code>"}, {"owner": {"reputation": 183, "user_id": 11373693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fe0c4087a319ee9d61ff5a360887a2?s=128&d=identicon&r=PG&f=1", "display_name": "user11373693", "link": "https://stackoverflow.com/users/11373693/user11373693"}, "edited": false, "score": 2, "creation_date": 1555519570, "post_id": 55730516, "comment_id": 98143485, "body": "IAR defines: <code>va_start(ap, A) (ap._Ap = _CSTD __va_start1())</code>. So it ignores 2nd parameter. <code>va_start(args, 0);</code> works too. But it is ugly and not portable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "reply_to_user": {"reputation": 183, "user_id": 11373693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fe0c4087a319ee9d61ff5a360887a2?s=128&d=identicon&r=PG&f=1", "display_name": "user11373693", "link": "https://stackoverflow.com/users/11373693/user11373693"}, "edited": false, "score": 1, "creation_date": 1555519949, "post_id": 55730516, "comment_id": 98143670, "body": "@user11373693 I think I remember borland c++ 3.1 ignoring the second arg as well. So you have the option of putting <code>va_start(ap, if this breaks for you - fix it)</code>, if someone uses a different compiler, at least they will find out :)"}, {"owner": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "edited": false, "score": 0, "creation_date": 1555526235, "post_id": 55730516, "comment_id": 98146501, "body": "As I understand it historically varags were a hack that relied on pointer arithmetic with the last parameter. However I suspect few if any modern compilers do it that way, it&#39;s simply not compatible with modern ABIs."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 1, "creation_date": 1555528129, "post_id": 55730516, "comment_id": 98147286, "body": "@jakub_d On intel + linux the ellipsis still passes first arguments by registers. As evidence, play with <code>printf(&quot;%d %lf&quot;, 1.2, 10)</code> and see <a href=\"https://wandbox.org/permlink/oFlwfimqZX4BiP7W\" rel=\"nofollow noreferrer\">how it prints 10, 1.2</a>, since it looks at the registers not the stack."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "is_accepted": false, "score": 3, "last_activity_date": 1555514566, "last_edit_date": 1555514566, "creation_date": 1555512883, "answer_id": 55730516, "question_id": 55728743, "link": "https://stackoverflow.com/questions/55728743/is-safe-to-use-va-start-macro-with-this-as-parameter/55730516#55730516", "title": "Is safe to use va_start macro with this as parameter?", "body": "<p>Seems to be undefined behavior. If you look at what <code>va_start(ap, pN)</code> does in many implementations (check your header file), it takes the address of pN, increments the pointer by the size of pN and stores the result in ap. Can we legally look at <code>&amp;this</code>?</p>\n\n<p>I found a nice reference here: <a href=\"https://stackoverflow.com/a/9115110/10316011\">https://stackoverflow.com/a/9115110/10316011</a></p>\n\n<blockquote>\n  <p>Quoting the 2003 C++ standard:</p>\n  \n  <p>5.1 [expr.prim] The keyword this names a pointer to the object for which a nonstatic member function (9.3.2) is invoked. ... The type of the expression is a pointer to the function\u2019s class (9.3.2), ... The expression is an rvalue.</p>\n  \n  <p>5.3.1 [expr.unary.op] The result of the unary &amp; operator is a pointer to its operand. The operand shall be an lvalue or a qualified_id.</p>\n</blockquote>\n\n<p>So even if this works for you, it is not guaranteed to and you should not rely on it.</p>\n"}], "owner": {"reputation": 183, "user_id": 11373693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fe0c4087a319ee9d61ff5a360887a2?s=128&d=identicon&r=PG&f=1", "display_name": "user11373693", "link": "https://stackoverflow.com/users/11373693/user11373693"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 2, "accepted_answer_id": 55729544, "answer_count": 4, "score": 18, "last_activity_date": 1555546354, "creation_date": 1555507870, "last_edit_date": 1555510192, "question_id": 55728743, "link": "https://stackoverflow.com/questions/55728743/is-safe-to-use-va-start-macro-with-this-as-parameter", "title": "Is safe to use va_start macro with this as parameter?", "body": "<p>I have to use IAR compiller in embedded application (it does not have namespaces, exceptions, multiple/virtual inheritance, templates are bit limited and only C++03 is supported). \nI can't use parameter pack so I tried to create member function with variadic parameter. \nI know variadic parameters are generally unsafe. But is safe to use <code>this</code> pointer in <code>va_start</code> macro?</p>\n\n<p>If I use ordinary variadic function it would need a dummy parameter before <code>...</code> to be able to access remaining parameters. I know variadic macro would not need parameter before <code>...</code> but I would prefer not to use it.\nIf I use member function it has hidden <code>this</code> parameter before <code>...</code> so I tried it.:</p>\n\n<pre><code>struct VariadicTestBase{\n  virtual void DO(...)=0;\n};\n\nstruct VariadicTest: public VariadicTestBase{\n  virtual void DO(...){\n    va_list args;\n    va_start(args, this);\n    vprintf(\"%d%d%d\\n\",args);\n    va_end(args);\n  }\n};\n\n//Now I can do\nVariadicTestBase *tst = new VariadicTest;\ntst-&gt;DO(1,2,3);\n</code></pre>\n\n<p><code>tst-&gt;DO(1,2,3);</code> prints 123 as expected. But I am not sure if it is not just some random/undefined behavior. I know <code>tst-&gt;DO(1,2);</code> would crash just like normal prinf would. I do not mind it.</p>\n"}, {"tags": ["c++", "pointers", "void-pointers", "reinterpret-cast", "double-pointer"], "comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 2, "creation_date": 1555508247, "post_id": 55728740, "comment_id": 98136621, "body": "&quot;it specifies the legal types we can always cast to&quot; This seems like your invention. That page does not say anything similar to that."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1555508407, "post_id": 55728740, "comment_id": 98136728, "body": "You don&#39;t need a <code>reinterpret_cast</code> to convert a pointer to <code>void*</code>. <a href=\"https://godbolt.org/z/-eIfjl\" rel=\"nofollow noreferrer\">godbolt.org/z/-eIfjl</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1555508528, "post_id": 55728740, "comment_id": 98136799, "body": "I&#39;ve reopened the question because I didn&#39;t see only the top answer applies to this.  Leaving a link here: <a href=\"https://stackoverflow.com/questions/573294/when-to-use-reinterpret-cast\" title=\"when to use reinterpret cast\">stackoverflow.com/questions/573294/when-to-use-reinterpret-c&zwnj;&#8203;ast</a>"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1555509174, "post_id": 55728740, "comment_id": 98137250, "body": "@cpplearner The types are in the Type Aliasing section."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1555509304, "post_id": 55728740, "comment_id": 98137345, "body": "@Fran&#231;oisAndrieux Ugh, I knew that. I&#39;m just forgetting like an idiot. Could you just post that as an answer and I&#39;ll accept?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1555590741, "post_id": 55728740, "comment_id": 98168961, "body": "@Fran&#231;oisAndrieux And I&#39;ve lied to you. Thank you for posting. I gave you a +1, but <a href=\"https://stackoverflow.com/a/55729272/2642059\">Serge Ballesta answer</a> felt a little more clear cut to me so I&#39;ve accepted that one."}], "answers": [{"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1555535352, "post_id": 55729101, "comment_id": 98150105, "body": "Thanks for a really detailed answer... unfortunately this is going a little different direction from my misunderstanding. As you can see from the last line of the question I&#39;m trying to cast from an <code>int**</code> to a <code>void*</code> which I believe does require a <code>reinterpret_cast</code>?"}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1555564323, "post_id": 55729101, "comment_id": 98156220, "body": "No? &quot;Pointer to <code>int*</code>&quot; <i>is</i> a pointer to cv-unqualified object type."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1555590341, "post_id": 55729101, "comment_id": 98168747, "body": "Cancel that, it&#39;s the cast from the <code>void*</code> to the <code>int**</code> that requires a <code>reinterpret_cast</code>. You agree with that right? I pirated <a href=\"https://stackoverflow.com/a/55573563/2642059\">this answer</a>&#39;s example to demonstrate: <a href=\"https://ideone.com/G4zuwd\" rel=\"nofollow noreferrer\">ideone.com/G4zuwd</a> Unless you know something I don&#39;t I&#39;ll need a <code>reinterpret_cast</code> to assign <code>ptr</code>, right?"}], "tags": [], "owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "is_accepted": false, "score": 4, "last_activity_date": 1555509671, "last_edit_date": 1555509671, "creation_date": 1555509020, "answer_id": 55729101, "question_id": 55728740, "link": "https://stackoverflow.com/questions/55728740/is-it-legal-to-reinterpret-cast-to-a-void/55729101#55729101", "title": "Is it Legal to reinterpret_cast to a void*", "body": "<p><a href=\"https://eel.is/c++draft/expr.reinterpret.cast#7.sentence-1\" rel=\"nofollow noreferrer\">[expr.reinterpret.cast]/7</a>:</p>\n\n<blockquote>\n  <p>An object pointer can be explicitly converted to an object pointer of a different type.</p>\n</blockquote>\n\n<p><a href=\"https://eel.is/c++draft/basic.compound#3.sentence-1\" rel=\"nofollow noreferrer\">[basic.compound]/3</a>:</p>\n\n<blockquote>\n  <p>The type of a pointer to <em>cv</em> <code>void</code> or a pointer to an object type is called an <em>object pointer type</em>.</p>\n</blockquote>\n\n<p>You don't need to use <code>reinterpret_cast</code>, though. Every object pointer type whose pointed type is cv-unqualified is implicitly convertible to <code>void*</code>, and the inverse can be done by <code>static_cast</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 5, "last_activity_date": 1555509894, "last_edit_date": 1592644375, "creation_date": 1555509441, "answer_id": 55729249, "question_id": 55728740, "link": "https://stackoverflow.com/questions/55728740/is-it-legal-to-reinterpret-cast-to-a-void/55729249#55729249", "title": "Is it Legal to reinterpret_cast to a void*", "body": "<p>Those types are exempt from strict aliasing rules. It does not mean they are the only type you can use with <code>reinterpret_cast</code>. In the case of casting an object pointer to another object pointer type, failing to meet the requirements of strict aliasing rules means you cannot safely dereference the result. But you can still cast the resulting pointer back to the original type safely, and use the result as-if it was the original pointer.</p>\n<p>The relevant section from cppreference on <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"nofollow noreferrer\"><code>reinterpret_cast</code></a> :</p>\n<blockquote>\n<p>(Any object pointer type <code>T1*</code> can be converted to another object pointer type <em>cv</em> <code>T2*</code>. This is exactly equivalent to <code>static_cast&lt;cv T2*&gt;(static_cast&lt;cv void*&gt;(expression))</code> (which implies that if <code>T2</code>'s alignment requirement is not stricter than <code>T1</code>'s, the value of the pointer does not change and conversion of the resulting pointer back to its original type yields the original value). In any case, the resulting pointer may only be dereferenced safely if allowed by the type aliasing rules)</p>\n</blockquote>\n<p>When casting back to the original type, <code>AliasedType</code> and <code>DynamicType</code> are the same, so they are similar, which is the first case listed by the aliasing rules where it is legal to dereference the result of <code>reinterpret_cast</code> :</p>\n<blockquote>\n<p>Whenever an attempt is made to read or modify the stored value of an object of type <code>DynamicType</code> through a glvalue of type <code>AliasedType</code>, the behavior is undefined unless one of the following is true:</p>\n<ul>\n<li><code>AliasedType</code> and <code>DynamicType</code> are similar.</li>\n<li><code>AliasedType</code> is the (possibly cv-qualified) <code>signed</code> or <code>unsigned</code> variant of <code>DynamicType</code>.</li>\n<li><code>AliasedType</code> is <code>std::byte</code>, (since C++17)<code>char</code>, or <code>unsigned char</code>: this permits examination of the object representation of any object as an array of bytes.</li>\n</ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1555510099, "post_id": 55729272, "comment_id": 98137879, "body": "You don&#39;t even need <code>static_cast</code> in your example. Any object pointer type is implicitly convertible to <code>void*</code> (with equivalent cv qualifiers). You only need <code>static_cast</code> to cast a <code>void*</code> back to an object pointer of a particular type\u2026"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1555535326, "post_id": 55729272, "comment_id": 98150099, "body": "Thanks for a really detailed answer... unfortunately this is going a little different direction from my misunderstanding. As you can see from the last line of the question I&#39;m trying to cast from an <code>int**</code> to a <code>void*</code>, and back, which I believe does require a <code>reinterpret_cast</code>?"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 2, "last_activity_date": 1555573622, "last_edit_date": 1555573622, "creation_date": 1555509489, "answer_id": 55729272, "question_id": 55728740, "link": "https://stackoverflow.com/questions/55728740/is-it-legal-to-reinterpret-cast-to-a-void/55729272#55729272", "title": "Is it Legal to reinterpret_cast to a void*", "body": "<p>It is always legal to convert from a pointer to a type to a pointer to a different type <em>including void</em>, so if T is a type this is legal C++:</p>\n\n<pre><code>T* x;\nvoid *y = reinterpret_cast&lt;void *&gt;(x);\n</code></pre>\n\n<p>In real world it is never used because <code>void *</code> is a special case, and you obtain the same value with <code>static_cast</code>:</p>\n\n<pre><code>void *y = static_cast&lt;void *&gt;(x); // equivalent to previous reinterpret_cast\n</code></pre>\n\n<p>(in fact above conversion is implicit and can be simply written <code>void *y = x;</code> - thank to Michael Kenzel for noticing it)</p>\n\n<p>To be more explicit the standard even says in draft n4659 for C++17 8.2.10 Reinterpret cast [expr.reinterpret.cast], \u00a77</p>\n\n<blockquote>\n  <p>When a prvalue v of\n  object pointer type is converted to the object pointer type \u201cpointer to cv T\u201d, the result is <code>static_cast&lt;cv T*&gt;(static_cast&lt;cv void*&gt;(v))</code>.</p>\n</blockquote>\n\n<p>When you refer to byte and char being the only legal types, it is just that it is legal to <em>dereference</em> the converted pointer only for those types. <code>void</code> is not included here because you can never dereference a <code>void *</code>.</p>\n\n<hr>\n\n<p>To specifically answer your question</p>\n\n<blockquote>\n  <p>.. I'm casting from an int** to a void*. And I will eventually cast from the void* back to an int**.</p>\n</blockquote>\n\n<p>The standard guarantees that first one is a <em>standard</em> (read implicit) conversion:</p>\n\n<blockquote>\n  <p>A prvalue of type \u201cpointer to cv T\u201d, where T is an object type, can be converted to a prvalue of type \u201cpointer\n  to cv void\u201d. The pointer value (6.9.2) is unchanged by this conversion.</p>\n</blockquote>\n\n<p>So this is always legal:</p>\n\n<pre><code>int **i = ...;\nvoid *v = i;\n</code></pre>\n\n<p>For back casting, standard says (in <code>static_cast</code> paragraph):</p>\n\n<blockquote>\n  <p>A prvalue of type \u201cpointer to cv1 void\u201d can be converted to a prvalue of type \u201cpointer to cv2 T\u201d,</p>\n</blockquote>\n\n<p>So this is also legal</p>\n\n<pre><code>int **j = static_cast&lt;int **&gt;(v);\n</code></pre>\n\n<p>and the standard ensures that <code>j == i</code>.</p>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 1, "accepted_answer_id": 55729272, "answer_count": 3, "score": 8, "last_activity_date": 1555573622, "creation_date": 1555507861, "question_id": 55728740, "link": "https://stackoverflow.com/questions/55728740/is-it-legal-to-reinterpret-cast-to-a-void", "title": "Is it Legal to reinterpret_cast to a void*", "body": "<p>I was looking at <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/language/reinterpret_cast</a> and I noticed that it specifies the legal types we can always cast to:</p>\n\n<ul>\n<li><code>byte*</code></li>\n<li><code>char*</code></li>\n<li><code>unsigned char*</code></li>\n</ul>\n\n<p>But I did <em>not</em> see <code>void*</code> in the list. Is this an oversight? My use case requires a <code>reinterpret_cast</code> because I'm casting from an <code>int**</code> to a <code>void*</code>. And I will eventually cast from the <code>void*</code> back to an <code>int**</code>.</p>\n"}, {"tags": ["c++", "inheritance", "new-operator", "delete-operator"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1555507913, "post_id": 55728694, "comment_id": 98136434, "body": "It is undefined behavior to not have a virtual destructor when deleting from a base pointer.  Any behavior you observe is a consequence of that and not really worth digging into."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1555507977, "post_id": 55728694, "comment_id": 98136484, "body": "Because the standard specifies that the first case has well-defined behaviour, and the second case has undefined behaviour."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 4780530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37e01f7fc6af59bce87cb2a0c7ad0236?s=128&d=identicon&r=PG", "display_name": "Abergard", "link": "https://stackoverflow.com/users/4780530/abergard"}, "is_accepted": true, "score": 1, "last_activity_date": 1555533368, "creation_date": 1555533368, "answer_id": 55735606, "question_id": 55728694, "link": "https://stackoverflow.com/questions/55728694/different-behavior-of-delete-operator-with-virtual-and-non-virtual-destructor/55735606#55735606", "title": "Different behavior of delete operator with virtual and non-virtual destructor", "body": "<p>I will start from the second question.</p>\n\n<p>\"Why the size of the object is different?\" - the <code>virtual</code> is a key here.</p>\n\n<p>Every <code>class</code>/<code>struct</code> that have a virtual function contain a pointer to virtual table.\nIn this case the size of M will be equal size of pointer on your machine.\nI guess that you have 64-bit machine, and the size of pointer is equal 8 bytes.\nIn the example where 'virtual' keyword was removed the size of empty class is 1 byte.</p>\n\n<p>More about virtual function and tables you can read here:\n<a href=\"https://pabloariasal.github.io/2017/06/10/understanding-virtual-tables/\" rel=\"nofollow noreferrer\">https://pabloariasal.github.io/2017/06/10/understanding-virtual-tables/</a></p>\n\n<p>About your first question about reusing address memory on heap \nI highly recommend you to read first part of \n<a href=\"https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/\" rel=\"nofollow noreferrer\">https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/</a></p>\n\n<p>In a brief, the allocation of memory is done by chunk. \nIn the first example (with virtual destructor) both classes are extended by pointer to virtual table.\nNew allocated memory doesn't fit into dealocated chunk of memory, so the new address is found.\nIn the second one the new allocated memory fit into freed space and is reused.</p>\n\n<p>You can try to recompile you example with virtual function but with removed <code>long d</code> from <code>struct C</code>. It may turn out that the address will be the same now.</p>\n"}], "owner": {"reputation": 171, "user_id": 6707172, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_-oJ4-GxV-Q/AAAAAAAAAAI/AAAAAAAAIeI/nKtIUIyXOs0/photo.jpg?sz=128", "display_name": "Dark Hell", "link": "https://stackoverflow.com/users/6707172/dark-hell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55735606, "answer_count": 1, "score": 0, "last_activity_date": 1555533368, "creation_date": 1555507742, "last_edit_date": 1555508010, "question_id": 55728694, "link": "https://stackoverflow.com/questions/55728694/different-behavior-of-delete-operator-with-virtual-and-non-virtual-destructor", "title": "Different behavior of delete operator with virtual and non-virtual destructor", "body": "<p>When I use virtual destructor of struct M, operator new after delete operator return point to other address.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct M {\n    virtual ~M() = default;\n};\n\nstruct D : public M {\n    int* b = nullptr;\n};\n\nstruct C : public M {\n    int* c = nullptr, *b = nullptr;  \n    long d = 10;\n};\n\nint main() {\n\n    M* f;\n    M* d;\n\n    f = new D;\n    static_cast&lt;D*&gt;(f)-&gt;b = new int(10);\n    std::cout &lt;&lt; f &lt;&lt; \":\" &lt;&lt; sizeof(*f) &lt;&lt; std::endl; // 0x23c1c20 : 8\n    delete f;\n\n    d = new C;\n    std::cout &lt;&lt; d &lt;&lt; \":\" &lt;&lt; sizeof(*d) &lt;&lt; std::endl; // 0x23c2c70 : 8\n    delete d;\n\n    return 0;\n}\n\n</code></pre>\n\n<p>But if destructor of struct M is non-virtual operator new return same address. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct M {\n    ~M() = default;\n};\n\n...\n\nint main() {\n\n    M* f;\n    M* d;\n\n    f = new D;\n    static_cast&lt;D*&gt;(f)-&gt;b = new int(10);\n    std::cout &lt;&lt; f &lt;&lt; \":\" &lt;&lt; sizeof(*f) &lt;&lt; std::endl; // 0x23c1c20 : 1\n    delete f;\n\n    d = new C;\n    std::cout &lt;&lt; d &lt;&lt; \":\" &lt;&lt; sizeof(*d) &lt;&lt; std::endl; // 0x23c1c20 : 1\n    delete d;\n\n    return 0;\n}\n\n</code></pre>\n\n<p>And the size of the objects is different.</p>\n\n<p>Why is this happening? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555507592, "post_id": 55728549, "comment_id": 98136189, "body": "slicing aside <code>Kingdom[0] = *(new Dog);</code> is also a memory leak. You create a dog, copy it and the pointer to the dynamically allocated one is lost, you will never be able to delete it later"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555507660, "post_id": 55728549, "comment_id": 98136226, "body": "<i>&quot;I think this is because I&#39;m copying the object to the array instead of &quot;pointing&quot; to it. However, I can&#39;t figure out how to do this correctly.&quot;</i> That assumption is correct. <i>&quot;However, I can&#39;t figure out how to do this correctly.&quot;</i> Use <code>std::vector&lt;std::unique_ptr&lt;Animal&gt;&gt; Kingdom(Size);</code> instead of <code>Animal* Kingdom = new Animal[Size];</code>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1555507710, "post_id": 55728549, "comment_id": 98136266, "body": "You would need an array of <code>Animal*</code> (or in modern C++, <code>std::vector&lt;std::unique_ptr&lt;Animal&gt;&gt;</code>). You currently have an array of <code>Animal</code>."}, {"owner": {"reputation": 401, "user_id": 7729563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec8207f243df3f4f6f50935f80a69c?s=128&d=identicon&r=PG&f=1", "display_name": "James S.", "link": "https://stackoverflow.com/users/7729563/james-s"}, "edited": false, "score": 0, "creation_date": 1555508233, "post_id": 55728549, "comment_id": 98136616, "body": "Thanks - that makes sense."}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 7729563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec8207f243df3f4f6f50935f80a69c?s=128&d=identicon&r=PG&f=1", "display_name": "James S.", "link": "https://stackoverflow.com/users/7729563/james-s"}, "edited": false, "score": 0, "creation_date": 1555508877, "post_id": 55728639, "comment_id": 98137045, "body": "Thanks - makes sense, changing Kingdom to an array of pointers fixes the issue!"}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 1, "last_activity_date": 1555507572, "creation_date": 1555507572, "answer_id": 55728639, "question_id": 55728549, "link": "https://stackoverflow.com/questions/55728549/clarification-requested-on-putting-class-instances-in-array-and-using-virtual-me/55728639#55728639", "title": "Clarification requested on putting class instances in array and using virtual methods", "body": "<p>Your array holds <code>Animal</code> objects, not <code>Animal*</code>. So you don't get any polymorphism and <code>Kingdom[0] = *(new Dog);</code> slices your <code>Dog</code> to just its <code>Animal</code> parts.</p>\n"}], "owner": {"reputation": 401, "user_id": 7729563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec8207f243df3f4f6f50935f80a69c?s=128&d=identicon&r=PG&f=1", "display_name": "James S.", "link": "https://stackoverflow.com/users/7729563/james-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "closed_date": 1555507450, "accepted_answer_id": 55728639, "answer_count": 1, "score": 0, "last_activity_date": 1555509043, "creation_date": 1555507335, "last_edit_date": 1555509043, "question_id": 55728549, "link": "https://stackoverflow.com/questions/55728549/clarification-requested-on-putting-class-instances-in-array-and-using-virtual-me", "closed_reason": "Duplicate", "title": "Clarification requested on putting class instances in array and using virtual methods", "body": "<p>Note:  I do not agree this is a duplicate of the linked issue.  While that is an issue, that is not the question.  Please see below.</p>\n\n<p>When I assign a new class instance to an array, the base class' virtual function \nis used instead of the overridden derived class virtual function.</p>\n\n<p>I was told the problem with the code below is <a href=\"https://stackoverflow.com/questions/274626/what-is-object-slicing\">object slicing</a>.  However, according to <a href=\"https://www.youtube.com/watch?v=qqYOYIVrso0\" rel=\"nofollow noreferrer\">this YouTube video</a>, this should work.  I am a beginner at C++, so I'm not sure who is right.  Can someone point me in the right direction or tell me what's wrong?</p>\n\n<p>Is this because I'm copying the object to the array instead of \"pointing\" to it?  However, I can't figure out how to do this correctly.</p>\n\n<p>See code below for what I've tried.</p>\n\n<p>Addendum:  There is in fact an object slicing problem here.  However, the purpose of my question and what I did not understand is that overriding only works if you use pointers or an array of pointers and not if you declare an array of instances.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\n// I know these should be structs since they're all public!\nclass Animal {\n  public:\n    Animal() { std::cout &lt;&lt; \"Animal constructor\\n\"; }\n    virtual void speak() { std::cout &lt;&lt; \"Animal/Hello!\\n\"; }\n};\n\nclass Dog: public Animal {\n  public:\n    Dog() { std::cout &lt;&lt; \"Dog constructor\\n\"; }\n    void speak() override { std::cout &lt;&lt; \"Dog/Bark!\\n\"; }\n};\n\nint main() {\n  const int Size = 4;\n\n  Animal* Kingdom = new Animal[Size];\n  Dog* rover = new Dog;\n\n  // Legal because of polymorphism:\n  Animal* spot = new Dog;\n\n  // Legal because of polymorphism;\n  // Believe this is wrong - I think I'm copying the value rather than\n  // pointing to it, but not sure what the right way is...\n  Kingdom[0] = *(new Dog);\n  // &amp;Kingdom[0] = new Dog;  // Error - left operand must be l-value\n  // Kingdom = new Dog;  // Wrong - changing array base, leaking memory\n\n  Kingdom[1] = *rover;\n  Kingdom[2] = *spot;\n\n  // Virtual method followed here:\n  std::cout &lt;&lt; \"\\nIndividual invocations:\\n\";\n  rover-&gt;speak();\n  spot-&gt;speak();\n\n  std::cout &lt;&lt; \"\\nInvocation from array:\\n\";\n  for (int i = 0; i &lt; Size; ++i)\n    // Doesn't work - virtual method not followed, not sure why...\n    // Kingdom[i].speak();\n    // No difference between these two forms:\n    (Kingdom + i)-&gt;speak();\n\n  // PS - I know I should put deletes in here not to leak memory!\n}\n\n</code></pre>\n"}, {"tags": ["c++", "winapi", "sendinput"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555507459, "post_id": 55728525, "comment_id": 98136109, "body": "Uhh <code>(LPCWSTR)0x409</code> does not look at all like <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-loadkeyboardlayoutw\" rel=\"nofollow noreferrer\">MSDN&#39;s examples</a>."}, {"owner": {"reputation": 197, "user_id": 7150888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efdd8478f135ceddd8514d6c020cad46?s=128&d=identicon&r=PG&f=1", "display_name": "LPVOID", "link": "https://stackoverflow.com/users/7150888/lpvoid"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555507553, "post_id": 55728525, "comment_id": 98136169, "body": "@chris quote from <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-loadkeyboardlayoutw\" rel=\"nofollow noreferrer\">MSDN</a> page &gt; &quot;For example, U.S. English has a language identifier of 0x0409, so the primary U.S.&quot;. Did I get it wrong?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555507740, "post_id": 55728525, "comment_id": 98136294, "body": "&quot;so the primary U.S. English layout is named <code>&quot;00000409&quot;</code>&quot;. It also says at the very beginning that it expects a name, not a pointer whose value bytes form an ID."}, {"owner": {"reputation": 197, "user_id": 7150888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efdd8478f135ceddd8514d6c020cad46?s=128&d=identicon&r=PG&f=1", "display_name": "LPVOID", "link": "https://stackoverflow.com/users/7150888/lpvoid"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555507950, "post_id": 55728525, "comment_id": 98136470, "body": "@chris OMG yes you were right :) :) silly me. I got the latter working, but it still doesn&#39;t work as expected. Still sends Russian chars instead of English while I have Russian layout on my machine. Any thoughts?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1555509218, "post_id": 55728525, "comment_id": 98137283, "body": "Unfortunately, I can&#39;t say I&#39;m familiar with the workings of input locales or how <code>SendInput</code> is implemented."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1555538810, "creation_date": 1555538810, "answer_id": 55736608, "question_id": 55728525, "link": "https://stackoverflow.com/questions/55728525/how-to-make-sendinput-use-fixed-en-us-layout-regardless-of-what-layouts-the-us/55736608#55736608", "title": "How to make SendInput use fixed (en-US) layout regardless of what layouts the user have installed or uses?", "body": "<p>Calling <code>SendInput()</code> with <code>cInputs==1</code> is (almost) always a bug in user code. Don't do it!  One of the main benefits of using <code>SendInput()</code> over <code>keybd_event()</code> is the ability to <em>atomically</em> submit an array of inputs at one time (so no need for using <code>BlockInput()</code> at all).</p>\n\n<p>In this case, create an array of <code>INPUT</code>s for the keystrokes, and then call <code>SendInput()</code> only 1 time.  And, per the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/ns-winuser-tagkeybdinput\" rel=\"nofollow noreferrer\"><code>KEYBDINPUT</code> documentation</a>, <code>KEYEVENTF_UNICODE</code> doesn't take virtual key codes as input, it takes actual Unicode text characters instead (which means you don't have to deal with keyboard layouts manually).</p>\n\n<p>You are also not sending <code>KEYEVENTF_KEYUP</code> events at all.  You need those, even when using <code>KEYEVENTF_UNICODE</code>.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/31307429/65863\">my previous answer</a> to <a href=\"https://stackoverflow.com/questions/31305404/\">Sending Two or more chars using SendInput</a> for more details.</p>\n\n<p>With that said, try something more like this instead:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;string&gt;\n\nvoid SendInputString(const std::wstring &amp;str)\n{\n    int len = str.length();\n    if (len == 0) return;\n\n    std::vector&lt;INPUT&gt; in(len*2);\n    ZeroMemory(&amp;in[0], in.size()*sizeof(INPUT));\n\n    int i = 0, idx = 0;\n    while (i &lt; len)\n    {\n        WORD ch = (WORD) str[i++];\n\n        if ((ch &lt; 0xD800) || (ch &gt; 0xDFFF))\n        {\n            in[idx].type = INPUT_KEYBOARD;\n            in[idx].ki.wScan = ch;\n            in[idx].ki.dwFlags = KEYEVENTF_UNICODE;\n            ++idx;\n\n            in[idx] = in[idx-1];\n            in[idx].ki.dwFlags |= KEYEVENTF_KEYUP;\n            ++idx;\n        }\n        else\n        {\n            in[idx].type = INPUT_KEYBOARD;\n            in[idx].ki.wScan = ch;\n            in[idx].ki.dwFlags = KEYEVENTF_UNICODE;\n            ++idx;\n\n            in[idx].type = INPUT_KEYBOARD;\n            in[idx].ki.wScan = (WORD) str[i++];\n            in[idx].ki.dwFlags = KEYEVENTF_UNICODE;\n            ++idx;\n\n            in[idx] = in[idx-2];\n            in[idx].ki.dwFlags |= KEYEVENTF_KEYUP;\n            ++idx;\n\n            in[idx] = in[idx-2];\n            in[idx].ki.dwFlags |= KEYEVENTF_KEYUP;\n            ++idx;\n        }\n    }\n\n    SendInput(in.size(), &amp;in[0], sizeof(INPUT));\n}\n\nvoid SendKeys(LPCWSTR format, ...)\n{\n    std::wstring buffer;\n\n    va_list args;\n    va_start(args, format);\n\n    buffer.resize(_vscwprintf(format, args) + 1);\n    buffer.resize(vswprintf_s(&amp;buffer[0], buffer.size(), format, args));\n\n    va_end(args);\n\n    SendInputString(buffer);\n}\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 7150888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efdd8478f135ceddd8514d6c020cad46?s=128&d=identicon&r=PG&f=1", "display_name": "LPVOID", "link": "https://stackoverflow.com/users/7150888/lpvoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55736608, "answer_count": 1, "score": 0, "last_activity_date": 1555538810, "creation_date": 1555507244, "last_edit_date": 1555508040, "question_id": 55728525, "link": "https://stackoverflow.com/questions/55728525/how-to-make-sendinput-use-fixed-en-us-layout-regardless-of-what-layouts-the-us", "title": "How to make SendInput use fixed (en-US) layout regardless of what layouts the user have installed or uses?", "body": "<p>I find it quite handy that I can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-sendinput\" rel=\"nofollow noreferrer\">SendInput</a> to mix text and controls into single string and send it to any application like\n<code>\"\\nHello\\nWorld\"</code> would end up with sequence of</p>\n\n<pre><code>hit {Enter}\ntype \"Hello\"\nhit {enter}\ntype \"World\"\n</code></pre>\n\n<p>In any chat application (for example).</p>\n\n<p>I have the following code</p>\n\n<pre><code>void GenerateKey(WORD vk)\n{\n\n    INPUT Input;\n    ZeroMemory(&amp;Input, sizeof(Input));\n    Input.type = INPUT_KEYBOARD;\n    Input.ki.time = 0;\n    Input.ki.dwFlags = KEYEVENTF_EXTENDEDKEY | KEYEVENTF_UNICODE;\n    Input.ki.wVk = vk;\n    SendInput(1, &amp;Input, sizeof(INPUT));\n    return;\n}\n\nvoid SendKeys(const LPCWSTR format, ...)\n{\n    va_list args;\n    va_start(args, format);\n    WCHAR buffer[256];\n    vswprintf_s(buffer, format, args);\n    va_end(args);\n\n    BlockInput(true);\n    for (unsigned int i = 0; i&lt;wcslen(buffer); ++i)\n        GenerateKey((WORD)VkKeyScan(buffer[i]));\n    BlockInput(false);\n}\n</code></pre>\n\n<p>It works pretty fine. But the problem is, it depends on the currently used layout of the keyboard.</p>\n\n<p>I have also tried to use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-loadkeyboardlayouta\" rel=\"nofollow noreferrer\">LoadKeyboardLayout</a>, but the following has no effect at all</p>\n\n<pre><code>    BlockInput(true);\n    HKL keyboard_layout = LoadKeyboardLayout(\"00000409\", KLF_ACTIVATE);\n    for (unsigned int i = 0; i&lt;wcslen(buffer); ++i)\n        GenerateKey((WORD)VkKeyScanExW(buffer[i], keyboard_layout));\n    BlockInput(false);\n</code></pre>\n\n<p>I also welcome any ideas to achieve the goal.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-sendmessage\" rel=\"nofollow noreferrer\">SendMessage</a> isn't an option, cause it would require me to get a handle to the window and also to the text box.</p>\n"}, {"tags": ["c++", "qt", "part-of-speech"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11281734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86236d735e57301e36e5c9f04c47ef56?s=128&d=identicon&r=PG&f=1", "display_name": "T1v1", "link": "https://stackoverflow.com/users/11281734/t1v1"}, "edited": false, "score": 0, "creation_date": 1555524382, "post_id": 55729124, "comment_id": 98145691, "body": "Unfortunately, there appers another problem... No way I can output an array with loop using html (array length may change)"}, {"owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "reply_to_user": {"reputation": 27, "user_id": 11281734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86236d735e57301e36e5c9f04c47ef56?s=128&d=identicon&r=PG&f=1", "display_name": "T1v1", "link": "https://stackoverflow.com/users/11281734/t1v1"}, "edited": false, "score": 0, "creation_date": 1555524492, "post_id": 55729124, "comment_id": 98145750, "body": "then worte your custom textEdit"}], "tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": true, "score": 2, "last_activity_date": 1555509079, "creation_date": 1555509079, "answer_id": 55729124, "question_id": 55728329, "link": "https://stackoverflow.com/questions/55728329/how-to-output-words-above-text-in-qtextedit/55729124#55729124", "title": "How to output words above text in QTextEdit", "body": "<p>you can set the text as html:</p>\n\n<pre><code>QString pos = \"Hello. p .v.\";\nQString word = \"word\";\n\nui-&gt;textEdit-&gt;setHtml(\"&lt;!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.0//EN\\\" \\\"http://www.w3.org/TR/REC-html40/strict.dtd\\\"&gt;\"\n                     \"&lt;html&gt;&lt;head&gt;&lt;meta name=\\\"qrichtext\\\" content=\\\"1\\\" /&gt;&lt;style type=\\\"text/css\\\"&gt;\"\n                     \"p, li { white-space: pre-wrap; }\"\n                     \"&lt;/style&gt;&lt;/head&gt;&lt;body style=\\\" font-family:'Ubuntu'; font-size:11pt; font-weight:400; font-style:normal;\\\"&gt;\"\n                     \"&lt;p style=\\\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\\\"&gt;&lt;span style=\\\" font-style:italic; color:#888a85;\\\"&gt;\" + pos + \". &lt;/span&gt;&lt;/p&gt;\"\n                     \"&lt;p style=\\\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\\\"&gt;&lt;span style=\\\" font-size:14pt; font-weight:600; color:#2e3436;\\\"&gt;\" + word + \"&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\");\n</code></pre>\n\n<p>output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hrPA0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hrPA0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 11281734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86236d735e57301e36e5c9f04c47ef56?s=128&d=identicon&r=PG&f=1", "display_name": "T1v1", "link": "https://stackoverflow.com/users/11281734/t1v1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55729124, "answer_count": 1, "score": 2, "last_activity_date": 1556108813, "creation_date": 1555506621, "last_edit_date": 1556108813, "question_id": 55728329, "link": "https://stackoverflow.com/questions/55728329/how-to-output-words-above-text-in-qtextedit", "title": "How to output words above text in QTextEdit", "body": "<p>I have a <strong>structure</strong> with two members: <code>word</code>:string and <code>pos</code>:int (part of speech). </p>\n\n<p>And I want to output <code>words</code> with their <code>pos</code> above in <code>QTextEdit</code> like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/oJcDz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oJcDz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is this even possible or it's easier to make colorful font and background with <code>SyntaxHighlighter</code>?</p>\n"}, {"tags": ["c++", "lua", "swig"], "comments": [{"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1555506965, "post_id": 55728283, "comment_id": 98135757, "body": "Does <a href=\"https://stackoverflow.com/a/12426701/1810087\">this</a> help?"}, {"owner": {"reputation": 101, "user_id": 7714745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cac797b9ba4e425c44034ba97c3e856?s=128&d=identicon&r=PG&f=1", "display_name": "Mahashi", "link": "https://stackoverflow.com/users/7714745/mahashi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1555508277, "post_id": 55728283, "comment_id": 98136641, "body": "@user1810087 nope I&#39;ve already had it included"}, {"owner": {"reputation": 101, "user_id": 7714745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cac797b9ba4e425c44034ba97c3e856?s=128&d=identicon&r=PG&f=1", "display_name": "Mahashi", "link": "https://stackoverflow.com/users/7714745/mahashi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1555508804, "post_id": 55728283, "comment_id": 98136995, "body": "What&#39;s more funny when I deleted double constructor it matches numbers as a string."}, {"owner": {"reputation": 342, "user_id": 2047576, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001881388753/picture?type=large", "display_name": "Bas Groothedde", "link": "https://stackoverflow.com/users/2047576/bas-groothedde"}, "edited": false, "score": 0, "creation_date": 1556974123, "post_id": 55728283, "comment_id": 98614625, "body": "I believe the system is using <code>lua_isnumber</code> before <code>lua_isstring</code>, which eventually invokes <code>luaV_tonumber_</code> if the value is not a float. <code>luaV_tonumber_</code> tries converting a string to a number if it is convertible, hence it assuming your string should be interpreted as a number. <a href=\"https://www.lua.org/source/5.3/lvm.c.html#luaV_tonumber_\" rel=\"nofollow noreferrer\">luaV_tonumber_</a>. This could be remedied if the types were checked explicitly, instead of relying on <code>lua_isstring</code> and <code>lua_isnumber</code>."}, {"owner": {"reputation": 342, "user_id": 2047576, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001881388753/picture?type=large", "display_name": "Bas Groothedde", "link": "https://stackoverflow.com/users/2047576/bas-groothedde"}, "edited": false, "score": 0, "creation_date": 1556974731, "post_id": 55728283, "comment_id": 98614781, "body": "I can confirm that <code>lua_isnumber</code> is defined first in the <a href=\"https://github.com/swig/swig/blob/master/Lib/lua/luatypemaps.swg#L20\" rel=\"nofollow noreferrer\"><code>swig&#47;luatypemaps.swg</code></a> in the SWIG source code. I&#39;m assuming it checks the typemap in order, meaning all number-like strings are converted to number."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1557036143, "post_id": 55728283, "comment_id": 98626920, "body": "This is the expected behaviour.  Read <a href=\"https://www.lua.org/manual/5.3/manual.html#3.4.3\" rel=\"nofollow noreferrer\">3.4.3 Coercions and Conversions</a> in the Lua reference manual.  There it says: \u201cLua also converts strings to numbers, whenever a number is expected.\u201d"}, {"owner": {"reputation": 342, "user_id": 2047576, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001881388753/picture?type=large", "display_name": "Bas Groothedde", "link": "https://stackoverflow.com/users/2047576/bas-groothedde"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1557097155, "post_id": 55728283, "comment_id": 98641167, "body": "@HenriMenke I don&#39;t agree that this is expected behaviour; the implementation of Lua in Swig causes this. If Swig would have used <code>lua_type</code> tests rather than using <code>lua_isstring</code> and <code>lua_isnumber</code> it would be able to match types in signatures better."}], "owner": {"reputation": 101, "user_id": 7714745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cac797b9ba4e425c44034ba97c3e856?s=128&d=identicon&r=PG&f=1", "display_name": "Mahashi", "link": "https://stackoverflow.com/users/7714745/mahashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1555506635, "creation_date": 1555506443, "question_id": 55728283, "link": "https://stackoverflow.com/questions/55728283/swig-c-to-lua-custom-type-constructor-recognises-string-as-double", "title": "Swig c++ to lua custom type constructor recognises string as double", "body": "<p>I'm trying to return my C++ struct to lua using Swig and I want to have two constructors taking string or double as arguments.</p>\n\n<pre><code>struct MyType\n{\n    MyType(const std::string &amp; arg)\n    {\n        std::cout &lt;&lt; \"string constructor\\n\";\n    }\n\n    MyType(double arg)\n    {\n        std::cout &lt;&lt; \"double constructor\\n\";\n    }\n}\n</code></pre>\n\n<p>In Lua running</p>\n\n<pre><code>MyType(\"3.14\")\n&gt; double constructor\n\nstrInput = \"3.14\"\nprint(type(strInput))\n&gt; string\nMyType(strInput)\n&gt; double constructor\n</code></pre>\n\n<p>What's more it looks like the string is parsed to double. So if I wanted to print argument from double constructor it would be 3.14.</p>\n\n<p>Could there be any implicit conversion to double happening?</p>\n"}, {"tags": ["c++", "boost", "boost-asio"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1555506382, "post_id": 55728162, "comment_id": 98135402, "body": "I hate to ask, but you are compiling with optimizations enabled, right?"}, {"owner": {"reputation": 33, "user_id": 10168446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b849edcf9140f1e56f91d98373b26?s=128&d=identicon&r=PG&f=1", "display_name": "byrnexu", "link": "https://stackoverflow.com/users/10168446/byrnexu"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1555506547, "post_id": 55728162, "comment_id": 98135504, "body": "i use O2, like this .                                                                                                 g++ -Wall -fexceptions -O2 -std=c++11 -fPIC -g -DBOOST_LOG_DYN_LINK -I../hynet/include -I../3rdparty/inc/boost1.67 -I../3rdparty/inc/tbb4.4 -c /home/jt/hy-trade-test/hynet/src/cli.cpp -o ../build/hynet/release/hynet/src/cli.o"}, {"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1555506852, "post_id": 55728162, "comment_id": 98135689, "body": "Try using ftrace to find out."}], "owner": {"reputation": 33, "user_id": 10168446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b849edcf9140f1e56f91d98373b26?s=128&d=identicon&r=PG&f=1", "display_name": "byrnexu", "link": "https://stackoverflow.com/users/10168446/byrnexu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555506087, "creation_date": 1555506087, "question_id": 55728162, "link": "https://stackoverflow.com/questions/55728162/why-does-boostasioasync-write-take-so-much-time", "title": "Why does boost::asio::async_write take so much time?", "body": "<p>I use boost::asio to handle my asynchronous tcp request, but I found that calling boost::asio::async_write takes hundreds of microseconds each time. I think this is just putting the data into the TCP send buffer. Why is it so long? thank you all!</p>\n\n<p>==== 227 do_write_impl <br>\n ==== 274 do_write_impl <br> \n ==== 238 do_write_impl  <br>\n ==== 60 do_write_impl  <br>\n ==== 220 do_write_impl  <br>\n ==== 229 do_write_impl  <br>\n ==== 368 do_write_impl  <br>\n ==== 189 do_write_impl  <br>\n ==== 221 do_write_impl  <br>\n ==== 234 do_write_impl  <br>\n <br></p>\n\n<pre><code>       auto b = boost::asio::buffer(msg_send-&gt;get_header(), length);\n       auto f = [self, this] (const bsys::error_code&amp; e, std::size_t bytes_trans) { handle_write_impl(e, bytes_trans); };\n\n       struct timeval tv1 {0, 0}; \n       struct timeval tv2 {0, 0}; \n       gettimeofday(&amp;tv1, nullptr); const auto beg = tv1.tv_sec * 1000000 + tv1.tv_usec;\n\n       boost::asio::async_write(socket_,\n               b,                      \n               f   \n               );  \n\n       gettimeofday(&amp;tv2, nullptr); const auto end = tv2.tv_sec * 1000000 + tv2.tv_usec;\n       std::cout &lt;&lt; \" ==== \" &lt;&lt; (end - beg) &lt;&lt; \" do_write_impl \" &lt;&lt; std::endl;\n</code></pre>\n"}, {"tags": ["c++", "regex", "c++11", "clang++"], "comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1555506145, "post_id": 55728066, "comment_id": 98135215, "body": "Don&#39;t pass temporary string to <code>std::regex_search</code>. In C++14 and above such usage invokes a deleted overload, but apparently libc++ doesn&#39;t enable this safeguard for C++11."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1555506187, "post_id": 55728066, "comment_id": 98135240, "body": "This is a dupe.  I&#39;ll have the target in a minute"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1555506480, "post_id": 55728066, "comment_id": 98135465, "body": "Probably, <a href=\"https://stackoverflow.com/questions/33154890/simple-stdregex-search-code-wont-compile-with-apple-clang-std-c14\">also related</a>."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 1, "creation_date": 1555506614, "post_id": 55728066, "comment_id": 98135549, "body": "it is a duplicate, but this question here is way better proposed."}], "answers": [{"tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 8, "last_activity_date": 1556001544, "last_edit_date": 1556001544, "creation_date": 1555506216, "answer_id": 55728203, "question_id": 55728066, "link": "https://stackoverflow.com/questions/55728066/c-regex-search-breaks-when-compiled-with-o1/55728203#55728203", "title": "C++ regex_search breaks when compiled with -O1", "body": "<p>My understanding of the <code>regex_search</code> overload you are using here:</p>\n\n<pre><code>std::regex_search(std::string(\"10\"), m, npat);\n</code></pre>\n\n<p>Is that it has the signature:</p>\n\n<pre><code>template&lt; class STraits, class SAlloc,\n      class CharT, class Traits &gt;\nbool regex_search( const std::basic_string&lt;CharT,STraits,SAlloc&gt;&amp; s,\n               const std::basic_regex&lt;CharT,Traits&gt;&amp; e,\n               std::regex_constants::match_flag_type flags);\n</code></pre>\n\n<p>Note that it takes the string by reference. By passing it a temporary, you are invoking undefined behaviour. You can see this in the explanation of <a href=\"https://en.cppreference.com/w/cpp/regex/match_results\" rel=\"nofollow noreferrer\"><code>std::match_results</code></a>:</p>\n\n<blockquote>\n  <p>Because std::match_results holds std::sub_matches, each of which is a pair of iterators into the original character sequence that was matched, it's undefined behavior to examine std::match_results if the original character sequence was destroyed or iterators to it were invalidated for other reasons.</p>\n</blockquote>\n\n<p>This behaviour is disallowed as of c++14 by deleting the operator taking an rvalue reference:</p>\n\n<pre><code>bool regex_search( const std::basic_string&lt;CharT,STraits,SAlloc&gt;&amp;&amp;,\n               std::match_results&lt;\n                   typename std::basic_string&lt;CharT,STraits,SAlloc&gt;::const_iterator, \n                   Alloc\n               &gt;&amp;,\n               const std::basic_regex&lt;CharT, Traits&gt;&amp;,\n               std::regex_constants::match_flag_type flags) = delete;\n</code></pre>\n\n<p>From <a href=\"https://en.cppreference.com/w/cpp/regex/regex_search\" rel=\"nofollow noreferrer\"><code>std::regex_search</code></a>.</p>\n"}], "owner": {"reputation": 1335, "user_id": 789977, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a036b2e4be4ccd713cf52a46833f88c1?s=128&d=identicon&r=PG&f=1", "display_name": "FJDU", "link": "https://stackoverflow.com/users/789977/fjdu"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "closed_date": 1555506268, "accepted_answer_id": 55728203, "answer_count": 1, "score": 8, "last_activity_date": 1556001544, "creation_date": 1555505800, "question_id": 55728066, "link": "https://stackoverflow.com/questions/55728066/c-regex-search-breaks-when-compiled-with-o1", "closed_reason": "Duplicate", "title": "C++ regex_search breaks when compiled with -O1", "body": "<p>Sample code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;regex&gt;\n\nint main()\n{\n  std::regex npat(R\"(^(\\d+))\");\n  std::smatch m;\n  std::regex_search(std::string(\"10\"), m, npat);\n  std::cout &lt;&lt; m.size() &lt;&lt; \" m.str(1): |\"\n            &lt;&lt; m.str(1) &lt;&lt; \"| \";\n  std::cout &lt;&lt; std::stoi(m.str(1)) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>When compiled with</p>\n\n<pre><code>g++ -std=c++11 main.cpp\n</code></pre>\n\n<p>the output is</p>\n\n<pre><code>2 m.str(1): |10| 10\n</code></pre>\n\n<p>which is expected.</p>\n\n<p>However, when compiled with</p>\n\n<pre><code>g++ -std=c++11 -O1 main.cpp\n</code></pre>\n\n<p>The output becomes</p>\n\n<pre><code>libc++abi.dylib: terminating with uncaught exception\nof type std::invalid_argument: stoi: no conversion\n2 m.str(1): || Abort trap: 6\n</code></pre>\n\n<hr>\n\n<p>Compiler version:</p>\n\n<pre><code>g++ -v\n</code></pre>\n\n<blockquote>\n  <p>Configured with: --prefix=/Library/Developer/CommandLineTools/usr\n  --with-gxx-include-dir=/Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk/usr/include/c++/4.2.1\n  Apple LLVM version 10.0.1 (clang-1001.0.46.3) Target:\n  x86_64-apple-darwin18.5.0 Thread model: posix InstalledDir:\n  /Library/Developer/CommandLineTools/usr/bin</p>\n</blockquote>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 2, "creation_date": 1555504838, "post_id": 55727726, "comment_id": 98134378, "body": "Its actually because there is no specific overload for a function pointer type. It gets converted to a <code>bool</code> which is then displayed as 1 (since it is non-zero)."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1555505062, "post_id": 55727726, "comment_id": 98134520, "body": "on Visual Studio output is in fact the adress of the function."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 0, "creation_date": 1555505325, "post_id": 55727726, "comment_id": 98134674, "body": "Put <code>(void*)</code> before <code>ptr</code>."}], "owner": {"reputation": 323, "user_id": 8671940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8abcb8960a5bf7f32db224a4588c49?s=128&d=identicon&r=PG&f=1", "display_name": "user123456789", "link": "https://stackoverflow.com/users/8671940/user123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1555504791, "answer_count": 0, "score": 1, "last_activity_date": 1555504583, "creation_date": 1555504583, "question_id": 55727726, "link": "https://stackoverflow.com/questions/55727726/after-assigning-a-function-to-a-pointer-to-function-why-does-it-print-1-instea", "closed_reason": "Duplicate", "title": "after assigning a function to a &#39;pointer to function&#39; why does it print 1 instead of the address of the assigned function", "body": "<p>when we create a pointer 'int (*ptr)()' and assign it to a function 'foo', it should store the address of that function. But when i try to print the pointer ptr it displays 1 instead of the address of the foo. Why is that ? </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint foo(){\n    return 2019;\n}\n\nint main(){\n\n    int (*ptr)() = foo;\n\n    std::cout &lt;&lt; ptr &lt;&lt; std::endl;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "ubuntu", "cmake", "llvm"], "comments": [{"owner": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 0, "creation_date": 1555506079, "post_id": 55727636, "comment_id": 98135161, "body": "What does the output look like if you do <code>make VERBOSE=1</code>?"}, {"owner": {"reputation": 11, "user_id": 8532960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc892d9b9e9ca97ff84b938f95833e74?s=128&d=identicon&r=PG", "display_name": "Haoxin", "link": "https://stackoverflow.com/users/8532960/haoxin"}, "reply_to_user": {"reputation": 870, "user_id": 6708867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc169117dec38d9392c8c8ff61b7049?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/6708867/elias"}, "edited": false, "score": 0, "creation_date": 1555507156, "post_id": 55727636, "comment_id": 98135906, "body": "hi, @Elias, the output message after <code>make VERBOSE=1</code> are follows: sorry, the characters are out of range, I just updated my question details."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8532960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc892d9b9e9ca97ff84b938f95833e74?s=128&d=identicon&r=PG", "display_name": "Haoxin", "link": "https://stackoverflow.com/users/8532960/haoxin"}, "edited": false, "score": 0, "creation_date": 1555571780, "post_id": 55732089, "comment_id": 98158991, "body": "thanks, @Petesh. It works out ok. By the way, the <code>x86</code> could be replace in uppercase <code>X86</code>."}, {"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "reply_to_user": {"reputation": 11, "user_id": 8532960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc892d9b9e9ca97ff84b938f95833e74?s=128&d=identicon&r=PG", "display_name": "Haoxin", "link": "https://stackoverflow.com/users/8532960/haoxin"}, "edited": false, "score": 0, "creation_date": 1555574845, "post_id": 55732089, "comment_id": 98160365, "body": "The module names are case insensitive, but the library names aren\u2019t (if you\u2019re using Linux)"}], "tags": [], "owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1555518010, "creation_date": 1555518010, "answer_id": 55732089, "question_id": 55727636, "link": "https://stackoverflow.com/questions/55727636/usr-bin-ld-cannot-find-lllvmjitand-lllvmipa-in-ubuntu-16-04/55732089#55732089", "title": "/usr/bin/ld: cannot find -lLLVMJIT(and -lLLVMipa) in ubuntu 16.04", "body": "<p>There is much better llvm support in cmake if you target cmake 3.5, which will address a lot of these problems by adding the ability to reference libraries in virtual groups, rather than the manual list of libraries you're using.</p>\n\n<p>You're using a list of libraries that would have been suitable in the llvm 3.5 timeframe, but you're linking against llvm 6, so several things have changed in the interim - a lot of library reorganization. For example, the <a href=\"https://releases.llvm.org/3.6.0/docs/ReleaseNotes.html#the-old-jit-has-been-removed\" rel=\"nofollow noreferrer\">LLVMJIT library was removed</a> in <code>3.6</code>, and LLVMipa was removed in 3.8 (no reference found in anything other than source code), but the long and short of this is that it's a delicate list of libraries that will change as you build against different versions of llvm.</p>\n\n<p>you do a:</p>\n\n<pre><code>set(LLVM_LINK_COMPONENTS\n    Core\n    ExecutionEngine\n    Interpreter\n    MC\n    Support\n    nativecodegen\n    )\n</code></pre>\n\n<p>is supposed to deal with all the libraries that you're linking - you should not be adding a full list of libraries to link manually at the end like that.</p>\n\n<p>Based on the list of libraries you need to add the following components:</p>\n\n<pre><code>mcjit\nx86 (covers asmparser, disassembler and code generator)\nasmparser\nobjcarcopts (LLVMObjCARCOpts - is it needed???)\nscalaropts\ntransformutils\nirreader\n</code></pre>\n\n<p>so changing to:</p>\n\n<pre><code>set(LLVM_LINK_COMPONENTS\n    Core\n    ExecutionEngine\n    Interpreter\n    MC\n    Support\n    nativecodegen\n    mcjit\n    x86\n    asmparser\n    objcarcopts\n    scalaropts\n    transformutils\n    irreader\n    )\n</code></pre>\n\n<p>gives us the list of components to use. <code>LLVMipa</code> was rolled back into the main <code>LLVMAnalysis</code>, so you no longer need to specify it.</p>\n\n<p>setting a variable for the libraries:</p>\n\n<pre><code>llvm_map_components_to_libnames(llvm_libs ${LLVM_LINK_COMPONENTS})\n</code></pre>\n\n<p>This uses the llvm mapping code to map to the needed libraries.</p>\n\n<p>Changing the link line to:</p>\n\n<pre><code>target_link_libraries(driver\n        pthread\n        tinfo\n        dl\n        ${llvm_libs}\n        )\n</code></pre>\n\n<p>will link the relevant libraries, and you can remove the <code>target_link_libraries</code> specifying the individual libraries.</p>\n"}], "owner": {"reputation": 11, "user_id": 8532960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc892d9b9e9ca97ff84b938f95833e74?s=128&d=identicon&r=PG", "display_name": "Haoxin", "link": "https://stackoverflow.com/users/8532960/haoxin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555518010, "creation_date": 1555504315, "last_edit_date": 1555507445, "question_id": 55727636, "link": "https://stackoverflow.com/questions/55727636/usr-bin-ld-cannot-find-lllvmjitand-lllvmipa-in-ubuntu-16-04", "title": "/usr/bin/ld: cannot find -lLLVMJIT(and -lLLVMipa) in ubuntu 16.04", "body": "<p>I want to use the llvm framework to build a simple compiler like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/uPcF7.png\" rel=\"nofollow noreferrer\">A simple compiler</a></p>\n\n<p>and implement the code in Ubuntu 16.04. But I got the error </p>\n\n<pre><code>[ 20%] Linking CXX executable driver\n/usr/bin/ld: cannot find -lLLVMJIT\n/usr/bin/ld: cannot find -lLLVMipa\ncollect2: error: ld returned 1 exit status\nCMakeFiles/driver.dir/build.make:219: recipe for target 'driver' failed\nmake[2]: *** [driver] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/driver.dir/all' failed\nmake[1]: *** [CMakeFiles/driver.dir/all] Error 2\nMakefile:83: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I search the LLVMJIT library in the command <code>apt-file search libLLVMJIT</code> and <code>apt-file search libLLVMipa</code> and got the following output </p>\n\n<pre><code>haoxin@ubuntu:~/github/dcc888$ apt-file search libLLVMJIT\nlibllvm-3.5-ocaml-dev: /usr/lib/ocaml/llvm-3.5/libLLVMJIT.a\nllvm-3.5-dev: /usr/lib/llvm-3.5/lib/libLLVMJIT.a\nhaoxin@ubuntu:~/github/dcc888$ apt-file search libLLVMipa\nlibllvm-3.5-ocaml-dev: /usr/lib/ocaml/llvm-3.5/libLLVMipa.a\nllvm-3.5-dev: /usr/lib/llvm-3.5/lib/libLLVMipa.a\nllvm-3.6-dev: /usr/lib/llvm-3.6/lib/libLLVMipa.a\nllvm-3.7-dev: /usr/lib/llvm-3.7/lib/libLLVMipa.a\n</code></pre>\n\n<p>these are static library that Maybe I cannot use in LLVM JIT.</p>\n\n<p>When I use the command <code>make VERBOSE=1</code>, the output are follows:</p>\n\n<pre><code>/usr/bin/cmake -H/home/haoxin/github/dcc888/dcc888-1 -B/home/haoxin/github/dcc888/dcc888-1 --check-build-system CMakeFiles/Makefile.cmake 0\n/usr/bin/cmake -E cmake_progress_start /home/haoxin/github/dcc888/dcc888-1/CMakeFiles /home/haoxin/github/dcc888/dcc888-1/CMakeFiles/progress.marks\nmake -f CMakeFiles/Makefile2 all\nmake[1]: Entering directory '/home/haoxin/github/dcc888/dcc888-1'\nmake -f CMakeFiles/driver.dir/build.make CMakeFiles/driver.dir/depend\nmake[2]: Entering directory '/home/haoxin/github/dcc888/dcc888-1'\ncd /home/haoxin/github/dcc888/dcc888-1 &amp;&amp; /usr/bin/cmake -E cmake_depends \"Unix Makefiles\" /home/haoxin/github/dcc888/dcc888-1 /home/haoxin/github/dcc888/dcc888-1 /home/haoxin/github/dcc888/dcc888-1 /home/haoxin/github/dcc888/dcc888-1 /home/haoxin/github/dcc888/dcc888-1/CMakeFiles/driver.dir/DependInfo.cmake --color=\nmake[2]: Leaving directory '/home/haoxin/github/dcc888/dcc888-1'\nmake -f CMakeFiles/driver.dir/build.make CMakeFiles/driver.dir/build\nmake[2]: Entering directory '/home/haoxin/github/dcc888/dcc888-1'\n[ 20%] Linking CXX executable driver\n/usr/bin/cmake -E cmake_link_script CMakeFiles/driver.dir/link.txt --verbose=1\n/usr/bin/c++   -std=c++11 -fno-rtti -fno-exceptions    CMakeFiles/driver.dir/Driver.cpp.o CMakeFiles/driver.dir/Expr.cpp.o CMakeFiles/driver.dir/Lexer.cpp.o CMakeFiles/driver.dir/Parser.cpp.o  -o driver -rdynamic -lLLVMJIT /usr/lib/llvm-6.0/lib/libLLVMRuntimeDyld.a /usr/lib/llvm-6.0/lib/libLLVMX86Disassembler.a /usr/lib/llvm-6.0/lib/libLLVMX86AsmParser.a /usr/lib/llvm-6.0/lib/libLLVMX86CodeGen.a /usr/lib/llvm-6.0/lib/libLLVMSelectionDAG.a /usr/lib/llvm-6.0/lib/libLLVMAsmPrinter.a /usr/lib/llvm-6.0/lib/libLLVMMCParser.a /usr/lib/llvm-6.0/lib/libLLVMCodeGen.a /usr/lib/llvm-6.0/lib/libLLVMObjCARCOpts.a /usr/lib/llvm-6.0/lib/libLLVMScalarOpts.a /usr/lib/llvm-6.0/lib/libLLVMInstCombine.a /usr/lib/llvm-6.0/lib/libLLVMX86Desc.a /usr/lib/llvm-6.0/lib/libLLVMX86Info.a /usr/lib/llvm-6.0/lib/libLLVMX86AsmPrinter.a /usr/lib/llvm-6.0/lib/libLLVMX86Utils.a /usr/lib/llvm-6.0/lib/libLLVMTransformUtils.a -lLLVMipa /usr/lib/llvm-6.0/lib/libLLVMIRReader.a /usr/lib/llvm-6.0/lib/libLLVMBitReader.a /usr/lib/llvm-6.0/lib/libLLVMAsmParser.a /usr/lib/llvm-6.0/lib/libLLVMExecutionEngine.a /usr/lib/llvm-6.0/lib/libLLVMAnalysis.a /usr/lib/llvm-6.0/lib/libLLVMTarget.a /usr/lib/llvm-6.0/lib/libLLVMMC.a /usr/lib/llvm-6.0/lib/libLLVMObject.a /usr/lib/llvm-6.0/lib/libLLVMCore.a /usr/lib/llvm-6.0/lib/libLLVMSupport.a -lpthread -ltinfo -ldl /usr/lib/llvm-6.0/lib/libLLVMDebugInfoCodeView.a /usr/lib/llvm-6.0/lib/libLLVMDebugInfoMSF.a /usr/lib/llvm-6.0/lib/libLLVMMCDisassembler.a /usr/lib/llvm-6.0/lib/libLLVMGlobalISel.a /usr/lib/llvm-6.0/lib/libLLVMCodeGen.a /usr/lib/llvm-6.0/lib/libLLVMScalarOpts.a /usr/lib/llvm-6.0/lib/libLLVMInstCombine.a /usr/lib/llvm-6.0/lib/libLLVMBitWriter.a /usr/lib/llvm-6.0/lib/libLLVMTransformUtils.a /usr/lib/llvm-6.0/lib/libLLVMRuntimeDyld.a /usr/lib/llvm-6.0/lib/libLLVMTarget.a /usr/lib/llvm-6.0/lib/libLLVMAnalysis.a /usr/lib/llvm-6.0/lib/libLLVMProfileData.a /usr/lib/llvm-6.0/lib/libLLVMObject.a /usr/lib/llvm-6.0/lib/libLLVMMCParser.a /usr/lib/llvm-6.0/lib/libLLVMBitReader.a /usr/lib/llvm-6.0/lib/libLLVMMC.a /usr/lib/llvm-6.0/lib/libLLVMCore.a /usr/lib/llvm-6.0/lib/libLLVMBinaryFormat.a /usr/lib/llvm-6.0/lib/libLLVMSupport.a -lz -lrt -ltinfo -ldl -lpthread -lm /usr/lib/llvm-6.0/lib/libLLVMDemangle.a \n/usr/bin/ld: cannot find -lLLVMJIT\n/usr/bin/ld: cannot find -lLLVMipa\ncollect2: error: ld returned 1 exit status\nCMakeFiles/driver.dir/build.make:219: recipe for target 'driver' failed\nmake[2]: *** [driver] Error 1\nmake[2]: Leaving directory '/home/haoxin/github/dcc888/dcc888-1'\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/driver.dir/all' failed\nmake[1]: *** [CMakeFiles/driver.dir/all] Error 2\nmake[1]: Leaving directory '/home/haoxin/github/dcc888/dcc888-1'\nMakefile:83: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>CMakeList.txt messages:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nfind_package(LLVM REQUIRED CONFIG)\n\nadd_definitions(${LLVM_DEFINITIONS})\nadd_definitions( -D__STDC_LIMIT_MACROS )\nadd_definitions( -D__STDC_CONSTANT_MACROS )\ninclude_directories(${LLVM_INCLUDE_DIRS})\n\nset(CMAKE_CXX_FLAGS \"-std=c++11 -fno-rtti -fno-exceptions ${CMAKE_CXX_FLAGS}\")\n\nset(LLVM_LINK_COMPONENTS\n        Core\n        ExecutionEngine\n        Interpreter\n        MC\n        Support\n        nativecodegen\n        )\n\n\nadd_executable(driver Driver.cpp Expr.cpp Lexer.cpp Parser.cpp Expr.h Lexer.h Parser.h)\n\ntarget_link_libraries(driver\n        LLVMJIT\n        LLVMRuntimeDyld\n        LLVMX86Disassembler\n        LLVMX86AsmParser\n        LLVMX86CodeGen\n        LLVMSelectionDAG\n        LLVMAsmPrinter\n        LLVMMCParser\n        LLVMCodeGen\n        LLVMObjCARCOpts\n        LLVMScalarOpts\n        LLVMInstCombine\n        LLVMX86Desc\n        LLVMX86Info\n        LLVMX86AsmPrinter\n        LLVMX86Utils\n        LLVMTransformUtils\n        LLVMipa\n        LLVMIRReader\n        LLVMBitReader\n        LLVMAsmParser\n        LLVMExecutionEngine\n        LLVMAnalysis\n        LLVMTarget\n        LLVMMC\n        LLVMObject\n        LLVMCore\n        LLVMSupport\n        )\n\ntarget_link_libraries(driver\n        pthread\n        tinfo\n        dl\n        )\n\n</code></pre>\n\n<p>I expect the <code>make</code> work out ok and <code>drive</code> can execute successfully.</p>\n"}, {"tags": ["c++", "pointers", "if-statement"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1555504068, "post_id": 55727538, "comment_id": 98133853, "body": "Do you want to check whether the pointer is non-null or do you want to check if the <i>contents</i> of the pointer are non-zero? The answer to that determines whether you need <code>if (ptr)</code> or <code>if (*ptr)</code>."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1555504106, "post_id": 55727538, "comment_id": 98133874, "body": "<code>if(ptr)</code> is often used instead of <code>if(ptr != nullptr)</code>"}, {"owner": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555505106, "post_id": 55727538, "comment_id": 98134550, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 this is good to know. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "edited": false, "score": 1, "creation_date": 1555504859, "post_id": 55727594, "comment_id": 98134392, "body": "Okay, thank you. This is exactly what I needed. I am just trying to get the hang of pointers and references. Thank you!"}], "tags": [], "owner": {"reputation": 1267, "user_id": 4162391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/--AwzGvC9kTY/AAAAAAAAAAI/AAAAAAAAARw/E_pTA6XKr9k/photo.jpg?sz=128", "display_name": "Malus Jan", "link": "https://stackoverflow.com/users/4162391/malus-jan"}, "is_accepted": true, "score": 5, "last_activity_date": 1555507193, "last_edit_date": 1555507193, "creation_date": 1555504174, "answer_id": 55727594, "question_id": 55727538, "link": "https://stackoverflow.com/questions/55727538/pointer-syntax-within-condition/55727594#55727594", "title": "Pointer Syntax Within Condition", "body": "<pre><code>if (ptr)\n</code></pre>\n\n<p>check if the pointer is not <code>Null</code> but</p>\n\n<pre><code>if (*ptr)\n</code></pre>\n\n<p>check if the value it points to is not zero (in this example is 10)</p>\n\n<p>So for checking the value you shoud add *.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "edited": false, "score": 0, "creation_date": 1555504774, "post_id": 55727639, "comment_id": 98134323, "body": "So, if I\u2019m understanding this correctly, dereferencing the pointer (*ptr) will check the condition as if I used if(var), whereas NOT dereferencing (ptr) will check to see if the pointer is null or actually holds a legal memory address?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "edited": false, "score": 0, "creation_date": 1555504969, "post_id": 55727639, "comment_id": 98134474, "body": "@Hill3D That&#39;s correct. Except that <code>if(ptr)</code> will only tell you if the pointer is <code>nullptr</code> or not, it does <i>not</i> verify if the address it holds is <i>valid</i> or not, just that it is not <code>nullptr</code>."}, {"owner": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "edited": false, "score": 0, "creation_date": 1555505069, "post_id": 55727639, "comment_id": 98134528, "body": "thank you! Much appreciated. This is my first time using Stack Overflow and I gotta say, the response time of everyone has been wonderful! Thanks again!"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "edited": false, "score": 0, "creation_date": 1555505280, "post_id": 55727639, "comment_id": 98134640, "body": "@Hill3D You are welcome. Btw; the usual way to say &quot;thank you&quot; for an answer that helped you is to upvote it. No need for thank you comments. :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 0, "last_activity_date": 1555505101, "last_edit_date": 1555505101, "creation_date": 1555504327, "answer_id": 55727639, "question_id": 55727538, "link": "https://stackoverflow.com/questions/55727538/pointer-syntax-within-condition/55727639#55727639", "title": "Pointer Syntax Within Condition", "body": "<p>It depends on what you want to do.</p>\n\n<p><code>if(ptr)</code> checks if the pointer value is <code>nullptr</code> or not. Note that this is shorthand for <code>if(ptr != nullptr)</code>.</p>\n\n<p><code>if(*ptr)</code> checks if what the pointer <em>points to</em> is <code>nullptr</code> (or 0) - and in that case, since you dereference (follow) the pointer to answer the question, the pointer itself had better <em>not</em> be <code>nullptr</code> in that case.</p>\n"}, {"tags": [], "owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "is_accepted": false, "score": 0, "last_activity_date": 1555505528, "creation_date": 1555505528, "answer_id": 55727984, "question_id": 55727538, "link": "https://stackoverflow.com/questions/55727538/pointer-syntax-within-condition/55727984#55727984", "title": "Pointer Syntax Within Condition", "body": "<p>First of all, a pointer is only a variable. However, there are different contexts in which you can use it.</p>\n\n<p>As any other variable you can access the pointers content (which is the adress of the underlying memory) as follows:</p>\n\n<pre><code>int i = 1;\nint * p = &amp;i;\nstd::cout &lt;&lt; p &lt;&lt; std::endl\n</code></pre>\n\n<p>this would output the adress of <code>i</code> since this is what is stored in <code>p</code></p>\n\n<p>If you however want to access the content of the underlying memory (the value of <code>i</code>), you need to dereference the pointer first by using the <code>*</code> operator:</p>\n\n<pre><code>std::cout &lt;&lt; *p &lt;&lt; std::endl;\n</code></pre>\n\n<p>This would print the value of <code>i</code>so <code>1</code>.</p>\n\n<p>of course you can also access the pointer's adress (since the adress of <code>i</code> is a numeric value as well and needs to be stored somewhere too):</p>\n\n<pre><code>std::cout &lt;&lt; &amp;p &lt;&lt; std::endl;\n</code></pre>\n\n<p>That would output the adress of <code>p</code> so the adress where the adress of <code>i</code> is stored :)\nAs a little example try to run this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\nint main() {\n    int i = 1;\n    int * p = &amp;i;\n    std::cout &lt;&lt; \"Value of i(i): \" &lt;&lt; i &lt;&lt; std::endl\n              &lt;&lt; \"Adress of i(&amp;i): \" &lt;&lt; &amp;i &lt;&lt; std::endl\n              &lt;&lt; \"Value of p(p): \" &lt;&lt; p &lt;&lt; std::endl\n              &lt;&lt; \"Dereferenced p(*p): \" &lt;&lt; *p &lt;&lt; std::endl\n              &lt;&lt; \"Adress of p(&amp;p): \" &lt;&lt; &amp;p &lt;&lt; std::endl\n              &lt;&lt; \"Dereferenced adress of p(*(&amp;p)): \" &lt;&lt; *(&amp;p) &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11161516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4998f5ed97ae8aeca8d4c4b94b00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Hill3D", "link": "https://stackoverflow.com/users/11161516/hill3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55727594, "answer_count": 3, "score": 3, "last_activity_date": 1555507316, "creation_date": 1555503979, "last_edit_date": 1555507316, "question_id": 55727538, "link": "https://stackoverflow.com/questions/55727538/pointer-syntax-within-condition", "title": "Pointer Syntax Within Condition", "body": "<p>After a pointer is initialized, do you have to use the * dereference operator to call the pointer in a condition? </p>\n\n<p>Example:</p>\n\n<pre><code>int main()\n{\n    int var = 10;\n    int *ptr = &amp;var;\n\n    if(ptr)    // does this need to be if(*ptr)  ???\n    {.......}\n}\n</code></pre>\n\n<p>And can I have a short explanation as to why?</p>\n\n<p>Thank you. </p>\n"}, {"tags": ["c++", "smart-pointers"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1555504140, "post_id": 55727508, "comment_id": 98133898, "body": "The code as is won&#39;t compile... Please have a look at <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and especially <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, which is what we need to be able to help you..."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1555504140, "post_id": 55727508, "comment_id": 98133899, "body": "Take a step back from smart pointers and understand <a href=\"https://en.wikipedia.org/wiki/Variable_shadowing\" rel=\"nofollow noreferrer\">variable shadowing</a> first."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1555504208, "post_id": 55727508, "comment_id": 98133944, "body": "Appropriate code formatting improves code readability tremdously..."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1555505639, "post_id": 55727508, "comment_id": 98134887, "body": "It is unclear why you want to manage this array yourself. <code>std::array</code> or <code>std::vector</code> <i>will</i> be able to do what you need/want."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "edited": false, "score": 0, "creation_date": 1555507078, "post_id": 55727701, "comment_id": 98135843, "body": "is it possible to initalise it in the body of the constructor and not in the initialization list?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "edited": false, "score": 0, "creation_date": 1555507403, "post_id": 55727701, "comment_id": 98136071, "body": "@blacksheep If you want, but you should initialize in the initializer list where you can."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 1, "last_activity_date": 1555505698, "last_edit_date": 1555505698, "creation_date": 1555504507, "answer_id": 55727701, "question_id": 55727508, "link": "https://stackoverflow.com/questions/55727508/how-to-add-elements-to-an-array-maanged-by-a-smart-pointer/55727701#55727701", "title": "How to add elements to an array maanged by a smart pointer", "body": "<p>It looks like you have a misnomer about how variables work in c++. In your example, you have 2 different objects of different types named <code>xadj</code> where one shadows the other:</p>\n\n<pre><code>struct GraphStructure {\nidx_t* xadj; // A class member object named xadj of type idx_t*                    \nGraphStructure() {\n\n\n    std::unique_ptr&lt;idx_t[]&gt;  xadj(new idx_t[5]);  // A function scope object called xadj \n                                                   // that shadows the one above\n} // At the end of this scope the xadj unique pointer is destroyed\n\n...\nvoid function(GraphStructure&amp; Graph) {\n    Graph.xadj[xadjIndex] = adjncyIndex; // Here you use the idx_t* xadj which cannot be \n                                         // accessed with operator[], only by derefencing \n                                         // (with -&gt;). Even if you did use this accessor,\n                                         // it would be undefined behaviour because xadj is\n                                         // not initialized.\n</code></pre>\n\n<p>What you are probably looking for is something like this:</p>\n\n<pre><code>struct GraphStructure {\n    std::unique_ptr&lt;idx_t[]&gt; xadj;     \n    GraphStructure() : xadj(new idx_t[5]) {}\n};\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1555507303, "creation_date": 1555503886, "last_edit_date": 1555507303, "question_id": 55727508, "link": "https://stackoverflow.com/questions/55727508/how-to-add-elements-to-an-array-maanged-by-a-smart-pointer", "title": "How to add elements to an array maanged by a smart pointer", "body": "<p>How do I access elements of a an array that is managed by a smart pointer?</p>\n\n<p>I am getting an error </p>\n\n<blockquote>\n  <p>struct has no member xadj</p>\n</blockquote>\n\n<p>I provided some code below.</p>\n\n<p>I've documentation on smart pointers here \n<a href=\"https://www.internalpointers.com/post/beginner-s-look-smart-pointers-modern-c\" rel=\"nofollow noreferrer\">https://www.internalpointers.com/post/beginner-s-look-smart-pointers-modern-c</a></p>\n\n<pre><code>struct GraphStructure\n{\nstd::unique_ptr&lt;idx_t[]&gt;  xadj;\n\nGraphStructure() {\n\n    //xadj = new idx_t[5];\n    std::unique_ptr&lt;idx_t[]&gt;  xadj(new idx_t[5]);\n\n}   \n\nvoid function(GraphStructure&amp; Graph) {\nint adjncyIndex = 0;\nint xadjIndex = 0;\nGraph.xadj[xadjIndex] = adjncyIndex;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "stdoptional"], "comments": [{"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1555503592, "post_id": 55727399, "comment_id": 98133540, "body": "The more your debug build diverges from the release, the less useful it becomes."}], "answers": [{"tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": false, "score": 4, "last_activity_date": 1555503842, "creation_date": 1555503842, "answer_id": 55727496, "question_id": 55727399, "link": "https://stackoverflow.com/questions/55727399/why-does-stdoptional-operator-not-have-debug-mode-assertion-for-has-value/55727496#55727496", "title": "Why does std::optional operator* not have debug mode assertion for has_value()?", "body": "<blockquote>\n  <p>Is there any fundamental reason why the compiler would NOT make such an assertion on debug mode or is it just a missing feature?</p>\n</blockquote>\n\n<p>ODR violations. <code>std::optional</code> is a class template and hence implemented in a header. Different behavior of code inside a header for different preprocessor symbols is as dangerous as it gets. Consider this example (not tested, you'll get the point):</p>\n\n<pre><code>clang++ -DNDEBUG usesOptionalOfInt.cpp -shared -c -o myLib.so\nclang++ alsoUsesOptionalOfInt.cpp main.cpp -lmyLib -o ./ub-please\n</code></pre>\n\n<p>There you go with undefined behavior. Note that it's very unlikely that the difference in <code>std::optional::operator*</code> would actually cause any harm in this example, but still - you want to avoid these situations.</p>\n"}], "owner": {"reputation": 41, "user_id": 9253113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2661cd5419d8a7ae6bdd1bff62d4dd64?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Martinez", "link": "https://stackoverflow.com/users/9253113/francisco-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1555503842, "creation_date": 1555503522, "last_edit_date": 1555503619, "question_id": 55727399, "link": "https://stackoverflow.com/questions/55727399/why-does-stdoptional-operator-not-have-debug-mode-assertion-for-has-value", "title": "Why does std::optional operator* not have debug mode assertion for has_value()?", "body": "<p>I perfectly understand that because of performance reasons the <code>operator*</code> in <code>std::optional</code> does not make any checks for the actual existence of a contained value. However, in debug mode performance considerations should not matter and it would make a lot of sense to me that some kind of assertion should be made while in debug mode. </p>\n\n<p>Visual studio doesn't seem to have such an assertion (though I am not sure of other compilers). </p>\n\n<p>My question is: Is there any fundamental reason why the compiler would NOT make such an assertion on debug mode or is it just a missing feature?</p>\n"}, {"tags": ["c++", "string", "format", "precision"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1555503822, "post_id": 55727329, "comment_id": 98133688, "body": "What is <code>wsprintf()</code>? There&#39;s a <code>swprintf()</code> in the standard, but it takes different arguments..."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1555504036, "post_id": 55727329, "comment_id": 98133836, "body": "Ah, think I found it. <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-wsprintfa\" rel=\"nofollow noreferrer\">Some Windows thing</a>? Pay close attention to the documentation if so."}, {"owner": {"reputation": 63, "user_id": 11290144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqsVA.jpg?s=128&g=1", "display_name": "Alice Turner", "link": "https://stackoverflow.com/users/11290144/alice-turner"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1555578969, "post_id": 55727329, "comment_id": 98162598, "body": "Thank you i will also research this as i went with the <code>swprintf()</code> option in the end. But i will look in to the MSDN info you provided, i only code as a hobby so i&#39;m not really trained or a professional lol. All the information i can get it much appreciated. Thank you Shawn"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 11290144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqsVA.jpg?s=128&g=1", "display_name": "Alice Turner", "link": "https://stackoverflow.com/users/11290144/alice-turner"}, "edited": false, "score": 0, "creation_date": 1555504433, "post_id": 55727428, "comment_id": 98134081, "body": "Writing a logger, it&#39;s interface is generic pure virtual class but it&#39;s implementation it&#39;s platform specific. I&#39;m writing the windows part now so i&#39;m sticking to using all of the windows stuff and taking advantage of what Microsoft made specifically for their operating system but you might be right, using a stream might be the easier option"}, {"owner": {"reputation": 134, "user_id": 10634115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Can &#214;zlemi\u015f", "link": "https://stackoverflow.com/users/10634115/can-%c3%96zlemi%c5%9f"}, "reply_to_user": {"reputation": 63, "user_id": 11290144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqsVA.jpg?s=128&g=1", "display_name": "Alice Turner", "link": "https://stackoverflow.com/users/11290144/alice-turner"}, "edited": false, "score": 0, "creation_date": 1555504572, "post_id": 55727428, "comment_id": 98134182, "body": "Oh my bad, I did not figure out that you were trying to make a logger.... Should have paid more attention, my excuses ."}], "tags": [], "owner": {"reputation": 134, "user_id": 10634115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Can &#214;zlemi\u015f", "link": "https://stackoverflow.com/users/10634115/can-%c3%96zlemi%c5%9f"}, "is_accepted": false, "score": 0, "last_activity_date": 1555503622, "creation_date": 1555503622, "answer_id": 55727428, "question_id": 55727329, "link": "https://stackoverflow.com/questions/55727329/float-precision-not-formatting-in-string/55727428#55727428", "title": "Float precision not formatting in string", "body": "<p>What you can do is :</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>cout &lt;&lt; fixed &lt;&lt; setprecision(2) &lt;&lt; message &lt;&lt; \"&gt;&gt; Speed : \"&lt;&lt; duration &lt;&lt; endl;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 11290144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqsVA.jpg?s=128&g=1", "display_name": "Alice Turner", "link": "https://stackoverflow.com/users/11290144/alice-turner"}, "edited": false, "score": 0, "creation_date": 1555508653, "post_id": 55727737, "comment_id": 98136887, "body": "Thanks for this update, ill look at everything you said and decide on which i feel best thank you"}, {"owner": {"reputation": 63, "user_id": 11290144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqsVA.jpg?s=128&g=1", "display_name": "Alice Turner", "link": "https://stackoverflow.com/users/11290144/alice-turner"}, "edited": false, "score": 0, "creation_date": 1555577007, "post_id": 55727737, "comment_id": 98161458, "body": "I have changed over to use <code>swprintf()</code> it makes a lot sense thanks very much P.W my code works as expected :)"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 3, "last_activity_date": 1555505310, "last_edit_date": 1555505310, "creation_date": 1555504625, "answer_id": 55727737, "question_id": 55727329, "link": "https://stackoverflow.com/questions/55727329/float-precision-not-formatting-in-string/55727737#55727737", "title": "Float precision not formatting in string", "body": "<p>The function <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-wsprintfa\" rel=\"nofollow noreferrer\"><code>wsprintf()</code></a> (which seems to be windows specific) does not support floating point parameters, You can go for <a href=\"https://en.cppreference.com/w/cpp/io/c/fwprintf\" rel=\"nofollow noreferrer\"><code>swprintf()</code></a> (which is a standard library function) instead.</p>\n\n<p>Moreover, there is a note in the <code>wsprintf</code> documentation which states:</p>\n\n<blockquote>\n  <p>Do not use. Consider using one of the following functions instead: <code>StringCbPrintf, StringCbPrintfEx, StringCchPrintf, or StringCchPrintfEx</code>. See Security Considerations.</p>\n</blockquote>\n"}], "owner": {"reputation": 63, "user_id": 11290144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqsVA.jpg?s=128&g=1", "display_name": "Alice Turner", "link": "https://stackoverflow.com/users/11290144/alice-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 55727737, "answer_count": 2, "score": 2, "last_activity_date": 1555505310, "creation_date": 1555503220, "last_edit_date": 1555503428, "question_id": 55727329, "link": "https://stackoverflow.com/questions/55727329/float-precision-not-formatting-in-string", "title": "Float precision not formatting in string", "body": "<p>When I write a simple <code>wprintf</code> function and pass a double to it a <code>float</code> number using the verb notation <code>L\"%.2f\"</code> it simply prints an \"<code>f</code>\" on the screen instead of a number like in the format <code>0.00</code>.</p>\n\n<p>I would like some help as everywhere I look it simply says <code>L\"%.2f\"</code> is the way to print a number with 2 decimal digit precision.</p>\n\n<pre><code>float duration = (float)((std::clock() - mTimer) / (float)(CLOCKS_PER_SEC / 1000));\nwsprintf(message, L\"&gt;&gt; Speed: %.2f\\r\\n\", duration);\n</code></pre>\n\n<p>These are the 2 lines causing my headache... they result in </p>\n\n<blockquote>\n<pre><code>&gt;&gt; Speed: f\n</code></pre>\n</blockquote>\n\n<p>being printed on the console.</p>\n\n<p>The output i'm looking for is this:</p>\n\n<blockquote>\n<pre><code>&gt;&gt; Speed: 4000.00\n</code></pre>\n</blockquote>\n"}, {"tags": ["c++", "arrays", "oop", "object"], "comments": [{"owner": {"reputation": 74, "user_id": 2763059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775e08cad1d49500f3e7da51e44d4f45?s=128&d=identicon&r=PG", "display_name": "Pranav", "link": "https://stackoverflow.com/users/2763059/pranav"}, "edited": false, "score": 0, "creation_date": 1555503160, "post_id": 55727147, "comment_id": 98133288, "body": "Please disregard the snippet with <code>am2301[i]-&gt;begin();</code>. I was trying out some different things just before posting this here, and messed up. At this point I just want an array of DHTs that I can init with (PIN_SENSORx, DHT_TYPE), and begin() and read from."}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 2763059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775e08cad1d49500f3e7da51e44d4f45?s=128&d=identicon&r=PG", "display_name": "Pranav", "link": "https://stackoverflow.com/users/2763059/pranav"}, "edited": false, "score": 0, "creation_date": 1555503895, "post_id": 55727304, "comment_id": 98133741, "body": "Thanks. I tried this, got an error about vector not being found, so included &lt;vector&gt;. Now I have a bunch of errors... Pastebin: <a href=\"https://pastebin.com/t8HBtjyL\" rel=\"nofollow noreferrer\">pastebin.com/t8HBtjyL</a>"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 74, "user_id": 2763059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775e08cad1d49500f3e7da51e44d4f45?s=128&d=identicon&r=PG", "display_name": "Pranav", "link": "https://stackoverflow.com/users/2763059/pranav"}, "edited": false, "score": 0, "creation_date": 1555504044, "post_id": 55727304, "comment_id": 98133842, "body": "@Pranav, You should open another question to solve those. From the error you post here and the code from your question, there is no way to know why that is happening."}, {"owner": {"reputation": 74, "user_id": 2763059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775e08cad1d49500f3e7da51e44d4f45?s=128&d=identicon&r=PG", "display_name": "Pranav", "link": "https://stackoverflow.com/users/2763059/pranav"}, "edited": false, "score": 0, "creation_date": 1555504145, "post_id": 55727304, "comment_id": 98133901, "body": "Okay. Thanks a lot with this. I learnt something new, and I am running in the correct direction now."}, {"owner": {"reputation": 74, "user_id": 2763059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775e08cad1d49500f3e7da51e44d4f45?s=128&d=identicon&r=PG", "display_name": "Pranav", "link": "https://stackoverflow.com/users/2763059/pranav"}, "edited": false, "score": 0, "creation_date": 1555505967, "post_id": 55727304, "comment_id": 98135089, "body": "I was able to get rid of the errors by undefining the min and max definitions used by Arduino core.   <code>#undef max</code>  <code>#undef min</code>"}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 1, "last_activity_date": 1555503741, "last_edit_date": 1555503741, "creation_date": 1555503112, "answer_id": 55727304, "question_id": 55727147, "link": "https://stackoverflow.com/questions/55727147/cpp-object-array-with-different-constructor-parameters/55727304#55727304", "title": "CPP object array with DIFFERENT constructor parameters", "body": "<p>c++ supplies you with plenty of object storage types to help you with these sorts of things. Seeing <code>DHT **am2301;</code> can usually be replaced with something like a <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a> which is designed to be a vector of objects. Assuming as you have stated that this:</p>\n\n<pre><code>DHT dht(DHTPIN, DHTTYPE);\ndht.begin();\nfloat t = dht.readTemperature();\n</code></pre>\n\n<p>works correctly, then you can easily produce a vector of these reading types like this:</p>\n\n<pre><code>std::vector&lt;DHT&gt; am2301; // My vector\nfor (auto i = 0; i &lt; 8; ++i) {\n    am2301.emplace_back(SENSORS[i], DHT_TYPE); // Create the objects in place with the \n                                               // correct constructor arguments. std::vector\n                                               // takes care of memory allocation.\n    am2301[i].begin(); // Start the object\n}\n\nfloat t = am2301[5].readTemperature(); // Use the vector\n</code></pre>\n\n<p>This saves you having to remember to delete the objects later, and gives you much more flexibility in how to use that vector. Usage of types like this is one of the most powerful things in c++, <a href=\"https://en.cppreference.com/w/cpp/language/raii\" rel=\"nofollow noreferrer\">RAII</a>.</p>\n"}], "owner": {"reputation": 74, "user_id": 2763059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775e08cad1d49500f3e7da51e44d4f45?s=128&d=identicon&r=PG", "display_name": "Pranav", "link": "https://stackoverflow.com/users/2763059/pranav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55727304, "answer_count": 1, "score": 0, "last_activity_date": 1555506381, "creation_date": 1555502551, "last_edit_date": 1555506381, "question_id": 55727147, "link": "https://stackoverflow.com/questions/55727147/cpp-object-array-with-different-constructor-parameters", "title": "CPP object array with DIFFERENT constructor parameters", "body": "<p>I have 8x AM2301 sensors which I can read individually using <a href=\"https://github.com/adafruit/DHT-sensor-library\" rel=\"nofollow noreferrer\">this DHT library</a> and the example code modified to my requirement. This implies having to do something like this for each sensor (which results in a lot of repeating code).</p>\n\n<pre><code>DHT dht(DHTPIN, DHTTYPE);\ndht.begin();\nfloat t,h;\nt = dht.readTemperature();\nh = dht.readHumidity();\n</code></pre>\n\n<p>Now I am trying to refactor my code so that I have an array of DHT objects that I can iterate over to declare, initialize, and read the values from (into arrays of floats).</p>\n\n<p>After checking out some threads on <a href=\"https://stackoverflow.com/questions/8462895/how-to-dynamically-declare-an-array-of-objects-with-a-constructor-in-c\">stackoverflow</a>, etc. I came up with two versions of my code that compile.</p>\n\n<p>Here is the relevant portion of my code. The entire source (PlatformIO based) is <a href=\"https://bitbucket.org/snippets/pro2xy/Mex4G4\" rel=\"nofollow noreferrer\">uploaded here</a>.</p>\n\n<pre><code>    SERIAL.print(\"Reading sensors: \");\n    uint32_t startTime = millis();\n\n    uint8_t SENSORS[] =  { PIN_SENSOR0, PIN_SENSOR1, PIN_SENSOR2, PIN_SENSOR3,\n                           PIN_SENSOR4, PIN_SENSOR5, PIN_SENSOR6, PIN_SENSOR7 };\n\n    SERIAL.println(\"INIT SENSORS\");\n\n    /* Please disregard this snippet. \n    // I was trying various things before posting here and messed up.\n    DHT am2301[8];\n    uint8_t i;\n    for (i=0; i&lt;8; i++){\n      *am2301[i] = DHT(SENSORS[i], DHT_TYPE);\n      am2301[i]-&gt;begin();\n    }\n    */\n\n    // This locks up\n    DHT **am2301;\n    am2301 = new DHT* [8];\n    uint8_t i;\n    for (i=0; i&lt;8; i++){\n      am2301[i] = new DHT(SENSORS[i], DHT_TYPE);\n      am2301[i]-&gt;begin();\n    }\n</code></pre>\n\n<p>However, both of these styles lock up the code execution just after printing \"INIT SENSORS\". The target platform is ATSAMD21.</p>\n\n<p>I am not an expert C/C++ programmer, so there may be something I am missing or overlooking here. I need some help in trying to figure out what I am doing wrong, and if there is a better way to do this.</p>\n\n<p><strong>EDIT:</strong> Using <code>vector</code> as recommended in the accepted answer, I was able to have an iterable list of objects. However, the program still locks up. It seems this particular issue is related to the DHT library not liking multiple dynamic objects. Now off to github...</p>\n"}, {"tags": ["c++", "profiling", "arm64", "nvidia-jetson", "gperftools"], "owner": {"reputation": 11, "user_id": 11373004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc272640f6f2bcab14bd80b637bc6fe?s=128&d=identicon&r=PG&f=1", "display_name": "Martvvliet", "link": "https://stackoverflow.com/users/11373004/martvvliet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555501883, "creation_date": 1555501883, "question_id": 55726959, "link": "https://stackoverflow.com/questions/55726959/profiling-issues-c-on-a-jetson-tx2-function-names-are-not-displayed", "title": "Profiling issues C++ on a Jetson TX2. Function names are not displayed", "body": "<p>I'm having issues with profiling my C++ code on a Jetson TX2. The profiling itself works, but I don't get the function names, but instead, it says that a part is unknown.\nI installed pprof with go and it works on my Raspberry Pi, zo i guess id did the correct steps. For example the difference between my Jetson and my Pi:</p>\n\n<p>The result I get on the Jetson is:</p>\n\n<pre><code>LD_PRELOAD=\"/usr/lib/libprofiler.so.0\" CPUPROFILE=./tmp/profile.log            ./testProg\nWorker threads activated: 1\nDone\nPROFILE: interrupts/evictions/bytes = 3792/1650/150928\npprof --functions --text ./testProg ./tmp/profile.log\nSome binary filenames not available. Symbolization may be incomplete.\nTry setting PPROF_BINARY_PATH to the search path for local binaries.\nFile: testProg\nType: cpu\nShowing nodes accounting for 37.15s, 97.97% of 37.92s total\nDropped 38 nodes (cum &lt;= 0.19s)\nflat flat% sum% cum cum%\n16s 42.19% 42.19% 16s 42.19% inflateBackEnd\n5.88s 15.51% 57.70% 5.88s 15.51% cv::(anonymous namespace)::medianBlur_SortNet\n3.92s 10.34% 68.04% 3.92s 10.34% png_get_uint_16\n2.86s 7.54% 75.58% 2.86s 7.54% inflate\n1.89s 4.98% 80.56% 1.89s 4.98% adler32\n1.15s 3.03% 83.60% 1.15s 3.03% memcpy\n1.13s 2.98% 86.58% 1.13s 2.98% png_set_invert_mono\n0.93s 2.45% 89.03% 0.93s 2.45% crc32\n0.68s 1.79% 90.82% 0.68s 1.79% carotene_o4t::bgr2gray\n0.62s 1.64% 92.46% 0.62s 1.64% sched_yield\n0.48s 1.27% 93.72% 0.48s 1.27% [[vdso]]\n0.48s 1.27% 94.99% 0.48s 1.27% cv::ThresholdRunner::operator()\n0.47s 1.24% 96.23% 0.47s 1.24% inflateMark\n0.37s 0.98% 97.20% 0.37s 0.98% read\n0.29s 0.76% 97.97% 0.29s 0.76% cvFindNextContour\n0 0% 97.97% 37.92s 100%\n</code></pre>\n\n<p>On the Pi I get:</p>\n\n<pre><code>LD_PRELOAD=\"/usr/lib/libprofiler.so.0\" CPUPROFILE=./tmp/profile.log ./testProg\nWorker threads activated: 1\nDone\nPROFILE: interrupts/evictions/bytes = 16223/283/24060\npprof --functions --text ./testProg ./tmp/profile.log\nFile: testProg\nType: cpu\nShowing nodes accounting for 159.98s, 98.61% of 162.23s total\nDropped 97 nodes (cum &lt;= 0.81s)\nflat flat% sum% cum cum%\n75.63s 46.62% 46.62% 75.63s 46.62% cv::medianBlur_8u_Om\n37.26s 22.97% 69.59% 37.26s 22.97% inflateBackEnd\n11.58s 7.14% 76.72% 11.58s 7.14% png_set_read_user_transform_fn\n6.45s 3.98% 80.70% 6.45s 3.98% memcmp\n5.45s 3.36% 84.06% 5.45s 3.36% inflate\n4.46s 2.75% 86.81% 4.46s 2.75% adler32\n3.91s 2.41% 89.22% 3.91s 2.41% png_set_invert_mono\n3.86s 2.38% 91.60% 3.87s 2.39% cvFindNextContour\n2.97s 1.83% 93.43% 2.97s 1.83% cv::CvtColorLoop_Invoker::operator()\n2s 1.23% 94.66% 2s 1.23% read\n1.90s 1.17% 95.83% 1.90s 1.17% cv::ThresholdRunner::operator()\n1.80s 1.11% 96.94% 1.80s 1.11% crc32\n1.25s 0.77% 97.71% 1.25s 0.77% munmap\n1.22s 0.75% 98.47% 1.22s 0.75% inflateMark\n0.10s 0.062% 98.53% 5.40s 3.33% tbb::empty_task::~empty_task\n0.03s 0.018% 98.55% 2.04s 1.26% __GI__IO_file_xsgetn\n0.02s 0.012% 98.56% 3.14s 1.94% rml::internal::thread_monitor::detach_thread\n0.02s 0.012% 98.57% 4.91s 3.03% tbb::interface7::internal::start_for::execute\n0.01s 0.0062% 98.58% 2.05s 1.26% _GI__IO_fread\n0.01s 0.0062% 98.58% 4.18s 2.58% cv::findContours\n0.01s 0.0062% 98.59% 2.33s 1.44% cv::parallel_for\n0.01s 0.0062% 98.59% 4.24s 2.61% imgprocessing::blobfind\n0.01s 0.0062% 98.60% 2.31s 1.42% tbb::interface7::internal::delegated_function::operator()\n0.01s 0.0062% 98.61% 2.32s 1.43% tbb::interface7::internal::task_arena_base::internal_execute\n0.01s 0.0062% 98.61% 3.12s 1.92% tbb::task_scheduler_init::initialize\n0 0% 98.61% 1.30s 0.8% _IO_new_file_underflow\n0 0% 98.61% 82.20s 50.67% __libc_start_main\n0 0% 98.61% 1.72s 1.06% cv::cvtColor\n0 0% 98.61% 1.72s 1.06% cv::cvtColorBGR2Gray\n0 0% 98.61% 1.71s 1.05% cv::hal::cvtBGRtoGray\n0 0% 98.61% 75.65s 46.63% cv::medianBlur\n0 0% 98.61% 76.06s 46.88% imgprocessing::filter_img (inline)\n0 0% 98.61% 82.20s 50.67% imgprocessing::process\n0 0% 98.61% 82.20s 50.67% main\n0 0% 98.61% 2.30s 1.42% tbb::interface7::internal::start_for::run\n</code></pre>\n\n<p>As you can see, profiling the OpenCV functions I used is working fine, but my own code is called unknown.</p>\n\n<p>I have the -g flag enabled while compiling.\nI use the following line to profile my code (makefile)</p>\n\n<pre><code>LD_PRELOAD=\"/usr/lib/libprofiler.so.0\" CPUPROFILE=./tmp/profile.log ./$(PROG)\npprof --functions --text ./$(PROG) ./tmp/profile.log\n</code></pre>\n\n<p>...When I use google-pprof instead of pprof I don't get the unknown but only addresses (like 0x0000007f7a090498). I tried to solve the error but without success.\nI tried a lot and guess it is something with coupling the addresses to function names. When I try addr2line I get:</p>\n\n<pre><code>addr2line -e testProg 0x7f7a090498\n??:0\n</code></pre>\n\n<p>I hope someone can help me.</p>\n"}, {"tags": ["c++", "pointers", "delay", "cout"], "comments": [{"owner": {"reputation": 95, "user_id": 4010635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcb993eb6fe33da895ab98f2c3cb3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "xsmyqf", "link": "https://stackoverflow.com/users/4010635/xsmyqf"}, "edited": false, "score": 0, "creation_date": 1555501179, "post_id": 55726726, "comment_id": 98132136, "body": "this code is running in visual studio 15.9.9   .net framework 4.7.03190"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 4, "creation_date": 1555501260, "post_id": 55726726, "comment_id": 98132173, "body": "What do you mean by &quot;delayed&quot; in this context?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1555501574, "post_id": 55726726, "comment_id": 98132352, "body": "I obtain the expected result on Fedora 29, x86_64. No sanitizer or Valgrind findings."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1555501685, "post_id": 55726726, "comment_id": 98132414, "body": "I did, too - Visual Studio 2017 15.9.5 on all configuration modes."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1555501985, "post_id": 55726726, "comment_id": 98132569, "body": "why is your example so complicated? The ony difference in output seems to be from incrementing/multiplying an <code>int</code> , why pointers or even function pointers?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 4, "creation_date": 1555502643, "post_id": 55726726, "comment_id": 98132951, "body": "I struggled to find the right google terms but finally I found what I was looking for. I strongly believe your mis-understanding comes from not considering what&#39;s explained here: <a href=\"https://en.cppreference.com/w/cpp/language/eval_order\" rel=\"nofollow noreferrer\">Order of evaluation</a>. You may scroll down to <a href=\"https://en.cppreference.com/w/cpp/language/eval_order#Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined behavior</a> and will find that some of your expressions are quite similar. ;-) It&#39;s not quite easy to puzzle out what&#39;s undefined, what unspecified, and for which standard. I wouldn&#39;t use such things in productive code."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1555503185, "post_id": 55726726, "comment_id": 98133304, "body": "One of your examples was especially eye-catching to me: <code>cout &lt;&lt; intInit++ &lt;&lt; &quot;:&quot; &lt;&lt; intInit &lt;&lt; endl;</code> I tried on coliru and got (for my suprise) the same result like you. <a href=\"http://coliru.stacked-crooked.com/a/81fa9c4b7588f176\" rel=\"nofollow noreferrer\"><b>Live Demo on coliru</b></a> On the other hand, the warning <code>operation on &#39;intInit&#39; may be undefined</code> didn&#39;t surprise me. ;-)"}, {"owner": {"reputation": 95, "user_id": 4010635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcb993eb6fe33da895ab98f2c3cb3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "xsmyqf", "link": "https://stackoverflow.com/users/4010635/xsmyqf"}, "edited": false, "score": 0, "creation_date": 1555516943, "post_id": 55726726, "comment_id": 98142170, "body": "delayed mean the same as delayed variable in windows batch programming,this is only learning code,not in productive env."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1555518145, "post_id": 55726726, "comment_id": 98142805, "body": "Why using undefined behavior results in undefined behavior..."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4010635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcb993eb6fe33da895ab98f2c3cb3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "xsmyqf", "link": "https://stackoverflow.com/users/4010635/xsmyqf"}, "edited": false, "score": 0, "creation_date": 1555517980, "post_id": 55728119, "comment_id": 98142723, "body": "I add a new example in my question."}, {"owner": {"reputation": 95, "user_id": 4010635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcb993eb6fe33da895ab98f2c3cb3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "xsmyqf", "link": "https://stackoverflow.com/users/4010635/xsmyqf"}, "edited": false, "score": 0, "creation_date": 1555664433, "post_id": 55728119, "comment_id": 98193580, "body": "do you mean <code>std::cout &lt;&lt; intInit; intInit++ std::cout &lt;&lt; &quot;:&quot; &lt;&lt; intInit &lt;&lt; endl;</code>"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 3, "last_activity_date": 1555665108, "last_edit_date": 1555665108, "creation_date": 1555505973, "answer_id": 55728119, "question_id": 55726726, "link": "https://stackoverflow.com/questions/55726726/cout-variable-value-delay/55728119#55728119", "title": "cout variable value delay", "body": "<p>Before C++17,</p>\n\n<pre><code>std::cout &lt;&lt; intInit++ &lt;&lt; \":\" &lt;&lt; intInit &lt;&lt; endl;\n</code></pre>\n\n<p>the increment of <code>intInit</code> doesn't have to happen before next <code>&lt;&lt;</code></p>\n\n<p>so both</p>\n\n<pre><code>std::cout &lt;&lt; intInit &lt;&lt; \":\" &lt;&lt; intInit &lt;&lt; endl; intInit++;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>std::cout &lt;&lt; intInit;\nintInit++;\nstd::cout &lt;&lt; \":\" &lt;&lt; intInit &lt;&lt; endl; intInit++;\n</code></pre>\n\n<p>are valid.</p>\n\n<p>In C++17, full side effect of <code>intInit++</code> should happen before <code>std::cout &lt;&lt; \":\" &lt;&lt; intInit &lt;&lt; endl</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1555671875, "post_id": 55759458, "comment_id": 98196374, "body": "Prior c++17, <code>add(i++, i, ++i);</code> was UB, after it is order sequence is undertermined."}], "tags": [], "owner": {"reputation": 95, "user_id": 4010635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcb993eb6fe33da895ab98f2c3cb3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "xsmyqf", "link": "https://stackoverflow.com/users/4010635/xsmyqf"}, "is_accepted": false, "score": 0, "last_activity_date": 1555665413, "creation_date": 1555665413, "answer_id": 55759458, "question_id": 55726726, "link": "https://stackoverflow.com/questions/55726726/cout-variable-value-delay/55759458#55759458", "title": "cout variable value delay", "body": "<p>It is like function parse input parameters,calculate from right to left,then push the value into stack and show the value.for example:</p>\n\n<pre><code>int add(int a, int b, int c)\n{\n    return a + b + c;\n}\nauto i = 0;\nadd(i++, i, ++i);\n</code></pre>\n\n<p>we get 5 at last.but if it is calculated first and then push the value into stack,I still think the first input should be 1:1 not 1:2.but when I change the compiler standard to c++ 17. the result of code above is 3.I change the original code to be:</p>\n\n<pre><code>    int intInit = 1;\n    int * (*intPtr)(int *) = getInt2;\n    cout &lt;&lt; intInit++ &lt;&lt; \":\" &lt;&lt; intInit &lt;&lt; endl;\n    cout &lt;&lt; *intPtr(&amp;intInit) &lt;&lt; \":\" &lt;&lt; intInit&lt;&lt;endl;\n    cout &lt;&lt; intInit &lt;&lt; endl;\n    cout &lt;&lt; *intPtr(&amp;intInit) &lt;&lt; endl;\n    //(* ptr)\u51fd\u6570\u4e66\u5199\n    cout &lt;&lt; *(*intPtr)(&amp;intInit) &lt;&lt; \":\" &lt;&lt; *(*intPtr)(&amp;intInit) &lt;&lt; endl;\n    cout &lt;&lt; intInit &lt;&lt; endl;\n</code></pre>\n\n<p>and the output is normal:</p>\n\n<pre><code>1:2\n4:4\n4\n8\n16:32\n32\n</code></pre>\n\n<p>It is really related to c++ standard and the c++ 14 compiler may be not good at parameter parsing.</p>\n"}], "owner": {"reputation": 95, "user_id": 4010635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcb993eb6fe33da895ab98f2c3cb3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "xsmyqf", "link": "https://stackoverflow.com/users/4010635/xsmyqf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 55728119, "answer_count": 2, "score": 2, "last_activity_date": 1555665413, "creation_date": 1555501124, "last_edit_date": 1555517773, "question_id": 55726726, "link": "https://stackoverflow.com/questions/55726726/cout-variable-value-delay", "title": "cout variable value delay", "body": "<pre><code>int * getInt2(int a[]) {\n    (*a) *= 2;\n    return a;\n}\n\nint main(int argc,char *argv[])\n{\n    int intInit = 1;\n    int * (*intPtr)(int *) = getInt2;\n    cout &lt;&lt; intInit++ &lt;&lt; \":\" &lt;&lt; intInit &lt;&lt; endl;\n    cout &lt;&lt; intPtr(&amp;intInit) &lt;&lt; \":\" &lt;&lt; intInit&lt;&lt;endl;\n    cout &lt;&lt; intInit &lt;&lt; endl;\n    cout &lt;&lt; *intPtr(&amp;intInit) &lt;&lt; endl;\n    cout &lt;&lt; (*intPtr)(&amp;intInit) &lt;&lt; \":\" &lt;&lt; *(*intPtr)(&amp;intInit) &lt;&lt; endl;\n    cout &lt;&lt; intInit &lt;&lt; endl;\n}\n</code></pre>\n\n<p>real result when running:</p>\n\n<pre><code>1:2\n012FFABC:2\n4\n8\n012FFABC:16\n32\n</code></pre>\n\n<p>but I expect it to be:</p>\n\n<pre><code>1:2\n012FFABC:4\n4\n8\n012FFABC:32\n32\n</code></pre>\n\n<p>what did i misunderstand?Is there any reason why it is delayed? thanks for any clue.</p>\n\n<p>I see someone think the expression behaviour is undefined in c++ and the focus is always in auto-increment operation,so I add an example:</p>\n\n<pre><code>int addTarget(int &amp;n) {\n    n += 1;\n    return n;\n}\nint multiplyTarget(int &amp;n) {\n    n *= 2;\n    return n;\n}\n\nint main(int argc,char *argv[])\n{\n    int intTest = 1;\n    cout &lt;&lt; multiplyTarget(intTest) &lt;&lt; \":\" &lt;&lt; addTarget(intTest) &lt;&lt; endl;\n    cout &lt;&lt; addTarget(intTest) &lt;&lt; \":\" &lt;&lt; multiplyTarget(intTest) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>above code's result is:</p>\n\n<pre><code>4:2\n9:8\n</code></pre>\n\n<p>I see someone say that the output sequence is from left to right and the operation sequence is from right to me.this can explain most situation.but I think the first example's first output should be 1:1 not 1:2 according to this theory.I really want to know the theory.</p>\n"}, {"tags": ["c++", "multithreading", "operating-system", "mutex"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1555501648, "post_id": 55726712, "comment_id": 98132390, "body": "The use of <code>new int</code> and <code>cout</code> indicates this is C++, not C."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1555501774, "post_id": 55726712, "comment_id": 98132457, "body": "Note that in <code>pthread_create(..., &amp;rowCheck, row);</code> row is a pointer and you pass every thread the same pointer, independent if the value of the int pointed to."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 3, "creation_date": 1555503095, "post_id": 55726712, "comment_id": 98133253, "body": "Rather than using pthreads, I suggest that you have a look at <a href=\"https://en.cppreference.com/w/cpp/thread/thread\" rel=\"nofollow noreferrer\"><code>std::thread</code></a> which is the portable, built-in threading library\u2026"}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1555504066, "post_id": 55726712, "comment_id": 98133852, "body": "You have <code>retrun</code> in <code>main</code> (instead of <code>return</code>)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1555506195, "post_id": 55726712, "comment_id": 98135249, "body": "I given you two proposals to solve the problems, see my answer"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1555511638, "post_id": 55726712, "comment_id": 98138909, "body": "What sense is there in calling <code>pthread_join(id1,NULL)</code> immediately after calling <code>pthread_create(&amp;id1,NULL,&amp;checkingRows,NULL)</code>? Why don&#39;t you simply call <code>checkintRows(NULL)</code> at that point instead?"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1555505927, "last_edit_date": 1555505927, "creation_date": 1555502632, "answer_id": 55727170, "question_id": 55726712, "link": "https://stackoverflow.com/questions/55726712/synchronization-in-multithreading/55727170#55727170", "title": "Synchronization in multithreading", "body": "<p>The first created thread is useless because you create it and immediately waits for its end</p>\n\n<p>On the contrary you do not wait for the end of the 9 other threads, so you exit before their end</p>\n\n<p>When you start the sub threads you do not have a synchronization to be sure they have time to read the row number before to modify it for the next thread, several can check the same row. For that you can use a condition (still using C thread lib), or you can give each time a newly created <em>int</em> given the index.</p>\n\n<p>You have a memory leak because you do not delete the <em>int</em>, and in fact it is useless to allocate it in the heap in your case</p>\n\n<hr>\n\n<p>A proposal from your code, as you can see I directly give the address of the concerned row to each thread, I removed the intermediate thread and I wait for the end of the 9 threads, more some other changes</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\n\npthread_mutex_t mut1;\n\nint arr[9][9] = {  \n                    {6,2,4,5,3,9,1,8,7},\n                    {6,6,9,7,2,8,6,3,4},\n                    {8,3,7,6,1,4,2,9,5},\n                    {1,4,3,8,6,5,7,2,9},\n                    {9,5,8,2,4,7,3,6,1},\n                    {7,6,2,3,9,1,4,5,8},\n                    {3,7,1,9,5,6,8,4,2},\n                    {4,9,6,1,8,2,5,7,3},\n                    {2,8,5,4,7,3,9,1,6}\n                };\n\nvoid * rowCheck(void* arg)\n{\n    int * row = (int *) arg;\n    const char * result = \"ok\";\n\n    for(int i = 0; i &lt; 9; i++){\n      int temp = row[i];\n      int count = 0;\n\n      for(int j = i; j &lt; 9; j++){\n        if(row[j] == temp || row[j] &lt;= 0 || row[j] &gt;= 10){\n          count++; \n        }\n        if(count &gt; 1){\n          result = \"ko\";\n          pthread_mutex_lock(&amp;mut1);\n          std::cout&lt;&lt;\"ERROR at \"&lt;&lt; row[j]\n            &lt;&lt; \" (row \" &lt;&lt; (row - arr[0])/9\n              &lt;&lt; \" column \" &lt;&lt; j &lt;&lt; \")\" &lt;&lt; std::endl;\n          pthread_mutex_unlock(&amp;mut1);\n          break;\n        }\n      }\n    }\n    pthread_exit((void *) result);\n}\n\nint main()\n{\n  pthread_t id[9];\n\n  pthread_mutex_init(&amp;mut1, NULL);\n\n  for (int i = 0; i != 9; ++i) {\n    if (pthread_create(&amp;id[i], NULL, &amp;rowCheck, arr[i]) != 0) {\n      std::cerr &lt;&lt; \"error when creating thread \" &lt;&lt; i &lt;&lt; std::endl;\n      return -1;\n    }\n  }\n\n  for (int i = 0; i != 9; ++i) {\n    void * retval;\n\n    pthread_join(id[i], &amp;retval);\n\n    pthread_mutex_lock(&amp;mut1);\n    std::cout &lt;&lt; i &lt;&lt; \":\" &lt;&lt; (char *) retval &lt;&lt; std::endl;\n    pthread_mutex_unlock(&amp;mut1);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>/tmp % g++ -pedantic -Wextra -Wall c.cc -lpthread\n/tmp % ./a.out\nERROR at 6 (row 1 column 1)\nERROR at 6 (row 1 column 6)\n0:ok\n1:ko\n2:ok\n3:ok\n4:ok\n5:ok\n6:ok\n7:ok\n8:ok\n</code></pre>\n\n<hr>\n\n<p>An other way is to give the index through an allocated <em>int</em> dedicated to each thread (and deleting it in the thread) :</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\n\npthread_mutex_t mut1;\n\nint arr[9][9] = {  \n                    {6,2,4,5,3,9,1,8,7},\n                    {6,6,9,7,2,8,6,3,4},\n                    {8,3,7,6,1,4,2,9,5},\n                    {1,4,3,8,6,5,7,2,9},\n                    {9,5,8,2,4,7,3,6,1},\n                    {7,6,2,3,9,1,4,5,8},\n                    {3,7,1,9,5,6,8,4,2},\n                    {4,9,6,1,8,2,5,7,3},\n                    {2,8,5,4,7,3,9,1,6}\n                };\n\nvoid * rowCheck(void* arg)\n{\n    int rowNum = *((int*) arg);\n\n    delete (int*) arg;\n\n    int * row = arr[rowNum];\n    const char * result = \"ok\";\n\n    for(int i = 0; i &lt; 9; i++){\n      int temp = row[i];\n      int count = 0;\n\n      for(int j = i; j &lt; 9; j++){\n        if(row[j] == temp || row[j] &lt;= 0 || row[j] &gt;= 10){\n          count++; \n        }\n        if(count &gt; 1){\n          result = \"ko\";\n          pthread_mutex_lock(&amp;mut1);\n          std::cout&lt;&lt;\"ERROR at \"&lt;&lt; row[j]\n            &lt;&lt; \" (row \" &lt;&lt; rowNum\n              &lt;&lt; \" column \" &lt;&lt; j &lt;&lt; \")\" &lt;&lt; std::endl;\n          pthread_mutex_unlock(&amp;mut1);\n          break;\n        }\n      }\n    }\n    pthread_exit((void *) result);\n}\n\nint main()\n{\n  pthread_t id[9];\n\n  pthread_mutex_init(&amp;mut1, NULL);\n\n  for (int i = 0; i != 9; ++i) {\n    if (pthread_create(&amp;id[i], NULL, &amp;rowCheck, new int(i)) != 0) {\n      std::cerr &lt;&lt; \"error when creating thread \" &lt;&lt; i &lt;&lt; std::endl;\n      return -1;\n    }\n  }\n\n  for (int i = 0; i != 9; ++i) {\n    void * retval;\n\n    pthread_join(id[i], &amp;retval);\n\n    pthread_mutex_lock(&amp;mut1);\n    std::cout &lt;&lt; i &lt;&lt; \":\" &lt;&lt; (char *) retval &lt;&lt; std::endl;\n    pthread_mutex_unlock(&amp;mut1);\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1555502696, "creation_date": 1555502696, "answer_id": 55727190, "question_id": 55726712, "link": "https://stackoverflow.com/questions/55726712/synchronization-in-multithreading/55727190#55727190", "title": "Synchronization in multithreading", "body": "<p>You ask,</p>\n\n<blockquote>\n  <p>How can i synchronize these 9 threads so that they execute before main\n  thread?</p>\n</blockquote>\n\n<p>, and I think you're talking about these:</p>\n\n<blockquote>\n  <p>checkingRows is creating further 9 threads which are\n  checking validity of each row.</p>\n</blockquote>\n\n<p>Of course, these can't run before <code>main()</code>, at least not before <code>main</code> <em>starts</em>, unless you start them in that time frame.  You don't.  But I think what you're really after is just that that they <em>finish</em> before <code>main</code> runs past a certain point.</p>\n\n<p>Well that's what <code>pthread_join</code> is for.  I see you're already using that function in <code>main()</code> for the thread it launches, but perhaps you are confused by the fact that that does not affect the additional threads started by the second one.</p>\n\n<p>It just doesn't automatically work that way.  Once started, threads run independently of each other.  If you want to wait for a thread to finish, then you must join that specific thread.  In your case, that probably means that  <code>checkingRows()</code> should join each thread it starts before it itself terminates.</p>\n"}], "owner": {"reputation": 3, "user_id": 11343067, "user_type": "registered", "profile_image": "https://graph.facebook.com/1507153569421979/picture?type=large", "display_name": "Adil Alam", "link": "https://stackoverflow.com/users/11343067/adil-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55727170, "answer_count": 2, "score": 0, "last_activity_date": 1555505927, "creation_date": 1555501055, "last_edit_date": 1555501659, "question_id": 55726712, "link": "https://stackoverflow.com/questions/55726712/synchronization-in-multithreading", "title": "Synchronization in multithreading", "body": "<p>How can i synchronize these 9 threads so that they execute before main thread?   </p>\n\n<p>I want to check validity of rows in a 2D array of size 9. Each row should contain values(1 to 9).\nFor that i created a thread named as \"void* checkingRows(void* arg)\" in the main thread and joined it with main.\nThen thread checkingRows is creating further 9 threads which are checking validity of each row.</p>\n\n<pre><code>````````````````````````````````````\nPthread_t id1;\npthread_mutex_t mut1;\nint arr[9][9] = {  \n                    {6,2,4,5,3,9,1,8,7},\n                    {6,6,9,7,2,8,6,3,4},\n                    {8,3,7,6,1,4,2,9,5},\n                    {1,4,3,8,6,5,7,2,9},\n                    {9,5,8,2,4,7,3,6,1},\n                    {7,6,2,3,9,1,4,5,8},\n                    {3,7,1,9,5,6,8,4,2},\n                    {4,9,6,1,8,2,5,7,3},\n                    {2,8,5,4,7,3,9,1,6}\n                };\n````````````````````````````````````\nvoid* rowCheck(void* arg){\n    int* argument = (int*) arg;\n    int idx = *argument;\n    int count = 0;\n    for(int i = 0; i &lt; 9; i++){\n        int temp = arr[idx][i];\n        count = 0;\n        for(int j = i; j &lt; 9; j++){\n            if(arr[idx][j] == temp || arr[idx][j] &lt;= 0 || arr[idx][j] &gt;= 10){\n                count++; \n            }\n            if(count &gt; 1){\n                pthread_mutex_lock(&amp;mut1);\n                count = 0;\n                cout&lt;&lt;\"ERROR at\"&lt;&lt;arr[idx][j]&lt;&lt;endl;\n                pthread_mutex_unlock(&amp;mut1);\n                break;\n            }\n        }\n    }\n    pthread_exit(NULL);\n}\n\n````````````````````````````````````\nvoid* checkingRows(void* arg){\n    int *row = new int;\n    *row = 0;\n    for(int i = 0; i&lt;gridSize; i++){\n        pthread_create(&amp;workerIdRow[i], NULL, &amp;rowCheck, row);\n        *row = *row + 1;\n    }\n    pthread_exit(NULL);\n}\n`````````````````````````````````\nint main(){\n\n    pthread_mutex_init(&amp;mut1, NULL);\n    pthread_create(&amp;id1, NULL, &amp;checkingRows, NULL);\n    pthread_join(id1,NULL);\n\n    retrun 0;\n\n}\n````````````````````````````````````\n\nERROR at 6\nERROR at 6\n</code></pre>\n"}, {"tags": ["c++", "templates", "switch-statement"], "comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1555500010, "post_id": 55726326, "comment_id": 98131421, "body": "I haven&#39;t looked into the assembly code, but without looking, I can tell you for sure that the compiler will optimize constants out."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1555500275, "post_id": 55726326, "comment_id": 98131593, "body": "You may also be interested in the <a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\">constexpr specifier</a>."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 0, "creation_date": 1555505220, "post_id": 55726326, "comment_id": 98134606, "body": "It might not get optimized out if you compile with <code>-O0</code>, otherwise I would expect it to be optimized."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1555507755, "post_id": 55726326, "comment_id": 98136303, "body": "I would replace your <code>throw</code> by <code>static_assert(1 &lt;= funcStep1 &amp;&amp; funcStep1 &lt;= 4);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 976, "user_id": 2548655, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/929PX.jpg?s=128&g=1", "display_name": "Michiel uit het Broek", "link": "https://stackoverflow.com/users/2548655/michiel-uit-het-broek"}, "edited": false, "score": 0, "creation_date": 1555501480, "post_id": 55726534, "comment_id": 98132302, "body": "That website is excellent, I already almost gave up hope of ever understanding assembly!"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 976, "user_id": 2548655, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/929PX.jpg?s=128&g=1", "display_name": "Michiel uit het Broek", "link": "https://stackoverflow.com/users/2548655/michiel-uit-het-broek"}, "edited": false, "score": 2, "creation_date": 1555501703, "post_id": 55726534, "comment_id": 98132422, "body": "@Michiel it is indeed a very good website. And don&#39;t be intimidated by assembly. While writing good assembly is a whole different story, reading assembly a compiler wrote for you is by far not as hard as it may sound. In fact, it&#39;s actually quite simple, especially with the tooltips that tell you what each instruction does, just takes some time to get used to. It&#39;s a very important skill if you care about performance at all, which you probably do since you&#39;re using C++ ;)\u2026"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 4, "last_activity_date": 1555500527, "creation_date": 1555500527, "answer_id": 55726534, "question_id": 55726326, "link": "https://stackoverflow.com/questions/55726326/switch-on-template-argument-does-gcc-remove-the-switch/55726534#55726534", "title": "Switch on template argument: does gcc remove the switch?", "body": "<p>Yes, this is optimized. There are a few things that make reading assembly easier, such as demangling names (example: <code>_ZNK3Mdp12expectedCostILi1EEEdiiiii</code> is the mangled form of <code>double Mdp::expectedCost&lt;1&gt;(int, int, int, int, int) const</code>), stripping comments and text (and using Intel syntax):</p>\n\n<pre><code>double expectedCost&lt;1&gt;(int, int, int, int, int):           # @double expectedCost&lt;1&gt;(int, int, int, int, int)\n        jmp     expectedCost_exact(int, int, int, int, int) # TAILCALL\ndouble expectedCost&lt;2&gt;(int, int, int, int, int):           # @double expectedCost&lt;2&gt;(int, int, int, int, int)\n        jmp     expectedCost_approx(int, int, int, int, int) # TAILCALL\ndouble expectedCost&lt;3&gt;(int, int, int, int, int):           # @double expectedCost&lt;3&gt;(int, int, int, int, int)\n        jmp     expectedCost_exact(int, int, int, int, int) # TAILCALL\ndouble expectedCost&lt;4&gt;(int, int, int, int, int):           # @double expectedCost&lt;4&gt;(int, int, int, int, int)\n        jmp     expectedCost_approx(int, int, int, int, int) # TAILCALL\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/ZtoKFH\" rel=\"nofollow noreferrer\">https://godbolt.org/z/ZtoKFH</a></p>\n\n<p>The above site simplifies this whole process for you.</p>\n\n<p>In this case I didn't provide definitions for <code>expectedCost_approx</code> so the compiler just leaves a jump. But in any case, compilers are <em>definitely</em> smart enough to realize that each template function has a constant value in the switch.</p>\n"}, {"tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": false, "score": 3, "last_activity_date": 1555501159, "creation_date": 1555501159, "answer_id": 55726741, "question_id": 55726326, "link": "https://stackoverflow.com/questions/55726326/switch-on-template-argument-does-gcc-remove-the-switch/55726741#55726741", "title": "Switch on template argument: does gcc remove the switch?", "body": "<p>The answer to your question is: Yes, any moderately useful compiler will <a href=\"https://en.wikipedia.org/wiki/Dead_code_elimination\" rel=\"nofollow noreferrer\">perform dead code elimination</a>.</p>\n\n<p><code>if constexpr</code> is not so much about forcing compile time evaluation for reasons of performance. In terms of performance, there's not really going to be any difference between <code>if constexpr</code> and a normal <code>if</code> when the given expression is a compile-time constant because compilers will end up optimizing the unused branch away either way. What <code>if constexpr</code> enables is to have code in the inactive branch that must not be instantiated with the given template arguments (e.g., because it would be invalid in that particular case). For your switch above, the whole code will be instantiated for all cases. Only afterwards will the unused code be removed by the optimizer. <code>if constexpr</code> on the other hand, guarantees that the code in the unused branch will never be instantiated to begin with. See, e.g., <a href=\"https://stackoverflow.com/questions/53809853/if-vs-if-constexpr-inside-constexpr-function\">here</a> for more on that&hellip;</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1555516844, "last_edit_date": 1555516844, "creation_date": 1555507602, "answer_id": 55728653, "question_id": 55726326, "link": "https://stackoverflow.com/questions/55726326/switch-on-template-argument-does-gcc-remove-the-switch/55728653#55728653", "title": "Switch on template argument: does gcc remove the switch?", "body": "<p>We don't have <code>switch constexpr</code>, and there are no guaranties of branch elimination for simple <code>switch</code>, even with <code>constexpr</code> value (as for regular <code>if</code> in fact), but I expect than compiler would remove them with proper optimization flag.</p>\n\n<p>Notice also that your not-used branches would instantiate, if any, template methods/objects whereas <code>if constexpr</code> would not.</p>\n\n<p>So if you want to have guaranty that only relevant code is there, or avoid unneeded instantiations, use <code>if constexpr</code>. Else use the one you find the clearer.</p>\n"}], "owner": {"reputation": 976, "user_id": 2548655, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/929PX.jpg?s=128&g=1", "display_name": "Michiel uit het Broek", "link": "https://stackoverflow.com/users/2548655/michiel-uit-het-broek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 55726534, "answer_count": 3, "score": 2, "last_activity_date": 1555516844, "creation_date": 1555499819, "last_edit_date": 1555500640, "question_id": 55726326, "link": "https://stackoverflow.com/questions/55726326/switch-on-template-argument-does-gcc-remove-the-switch", "title": "Switch on template argument: does gcc remove the switch?", "body": "<p>Will (or can?) a switch statement based on a template argument be removed by the compiler?</p>\n\n<p>See for example the following function in which the template argument <code>funcStep1</code> is used to select the appropriate function. Will this switch statement be removed as its argument is known at compile time? I tried to learn it from the assembly code (given below) but I have no experience in reading assembly yet so this is not really a feasible task for me.</p>\n\n<p>This question became now relevant for me since the newly introduced <code>if constexpr</code> provides an alternative that is guaranteed to be evaluated at compile time.</p>\n\n<pre><code>template&lt;int funcStep1&gt;\ndouble Mdp::expectedCost(int sdx0, int x0, int x1, int adx0, int adx1) const\n{\n  switch (funcStep1)\n  {\n    case 1:\n    case 3:\n      return expectedCost_exact(sdx0, x0, x1, adx0, adx1);\n\n    case 2:\n    case 4:\n      return expectedCost_approx(sdx0, x0, x1, adx0, adx1);\n\n    default:\n      throw string(\"Unknown value (Mdp::expectedCost.cc)\");\n  }\n}\n\n// Define all the template types we need\ntemplate double Mdp::expectedCost&lt;1&gt;(int, int, int, int, int) const;\ntemplate double Mdp::expectedCost&lt;2&gt;(int, int, int, int, int) const;\ntemplate double Mdp::expectedCost&lt;3&gt;(int, int, int, int, int) const;\ntemplate double Mdp::expectedCost&lt;4&gt;(int, int, int, int, int) const;\n</code></pre>\n\n<p>Here you find the output of 'objdump -D' when the above function is compiled with gcc -O2 -ffunction-sections:</p>\n\n<pre><code>1expectedCost.o:     file format elf64-x86-64\n\n\nDisassembly of section .group:\n\n0000000000000000 &lt;.group&gt;:\n   0:   01 00                   add    %eax,(%rax)\n   2:   00 00                   add    %al,(%rax)\n   4:   08 00                   or     %al,(%rax)\n   6:   00 00                   add    %al,(%rax)\n   8:   09 00                   or     %eax,(%rax)\n    ...\n\nDisassembly of section .group:\n\n0000000000000000 &lt;.group&gt;:\n   0:   01 00                   add    %eax,(%rax)\n   2:   00 00                   add    %al,(%rax)\n   4:   0a 00                   or     (%rax),%al\n   6:   00 00                   add    %al,(%rax)\n   8:   0b 00                   or     (%rax),%eax\n    ...\n\nDisassembly of section .group:\n\n0000000000000000 &lt;.group&gt;:\n   0:   01 00                   add    %eax,(%rax)\n   2:   00 00                   add    %al,(%rax)\n   4:   0c 00                   or     $0x0,%al\n   6:   00 00                   add    %al,(%rax)\n   8:   0d                      .byte 0xd\n   9:   00 00                   add    %al,(%rax)\n    ...\n\nDisassembly of section .group:\n\n0000000000000000 &lt;.group&gt;:\n   0:   01 00                   add    %eax,(%rax)\n   2:   00 00                   add    %al,(%rax)\n   4:   0e                      (bad)  \n   5:   00 00                   add    %al,(%rax)\n   7:   00 0f                   add    %cl,(%rdi)\n   9:   00 00                   add    %al,(%rax)\n    ...\n\nDisassembly of section .bss:\n\n0000000000000000 &lt;_ZStL8__ioinit&gt;:\n    ...\n\nDisassembly of section .text._ZNK3Mdp12expectedCostILi1EEEdiiiii:\n\n0000000000000000 &lt;_ZNK3Mdp12expectedCostILi1EEEdiiiii&gt;:\n   0:   e9 00 00 00 00          jmpq   5 &lt;_ZNK3Mdp12expectedCostILi1EEEdiiiii+0x5&gt;\n\nDisassembly of section .text._ZNK3Mdp12expectedCostILi2EEEdiiiii:\n\n0000000000000000 &lt;_ZNK3Mdp12expectedCostILi2EEEdiiiii&gt;:\n   0:   e9 00 00 00 00          jmpq   5 &lt;_ZNK3Mdp12expectedCostILi2EEEdiiiii+0x5&gt;\n\nDisassembly of section .text._ZNK3Mdp12expectedCostILi3EEEdiiiii:\n\n0000000000000000 &lt;_ZNK3Mdp12expectedCostILi3EEEdiiiii&gt;:\n   0:   e9 00 00 00 00          jmpq   5 &lt;_ZNK3Mdp12expectedCostILi3EEEdiiiii+0x5&gt;\n\nDisassembly of section .text._ZNK3Mdp12expectedCostILi4EEEdiiiii:\n\n0000000000000000 &lt;_ZNK3Mdp12expectedCostILi4EEEdiiiii&gt;:\n   0:   e9 00 00 00 00          jmpq   5 &lt;_ZNK3Mdp12expectedCostILi4EEEdiiiii+0x5&gt;\n\nDisassembly of section .text.startup._GLOBAL__sub_I_expectedCost.cc:\n\n0000000000000000 &lt;_GLOBAL__sub_I_expectedCost.cc&gt;:\n   0:   48 8d 3d 00 00 00 00    lea    0x0(%rip),%rdi        # 7 &lt;_GLOBAL__sub_I_expectedCost.cc+0x7&gt;\n   7:   48 83 ec 08             sub    $0x8,%rsp\n   b:   e8 00 00 00 00          callq  10 &lt;_GLOBAL__sub_I_expectedCost.cc+0x10&gt;\n  10:   48 8b 3d 00 00 00 00    mov    0x0(%rip),%rdi        # 17 &lt;_GLOBAL__sub_I_expectedCost.cc+0x17&gt;\n  17:   48 8d 15 00 00 00 00    lea    0x0(%rip),%rdx        # 1e &lt;_GLOBAL__sub_I_expectedCost.cc+0x1e&gt;\n  1e:   48 8d 35 00 00 00 00    lea    0x0(%rip),%rsi        # 25 &lt;_GLOBAL__sub_I_expectedCost.cc+0x25&gt;\n  25:   48 83 c4 08             add    $0x8,%rsp\n  29:   e9 00 00 00 00          jmpq   2e &lt;_GLOBAL__sub_I_expectedCost.cc+0x2e&gt;\n\nDisassembly of section .init_array:\n\n0000000000000000 &lt;.init_array&gt;:\n    ...\n\nDisassembly of section .comment:\n\n0000000000000000 &lt;.comment&gt;:\n   0:   00 47 43                add    %al,0x43(%rdi)\n   3:   43 3a 20                rex.XB cmp (%r8),%spl\n   6:   28 55 62                sub    %dl,0x62(%rbp)\n   9:   75 6e                   jne    79 &lt;_ZStL8__ioinit+0x79&gt;\n   b:   74 75                   je     82 &lt;_ZStL8__ioinit+0x82&gt;\n   d:   20 37                   and    %dh,(%rdi)\n   f:   2e 33 2e                xor    %cs:(%rsi),%ebp\n  12:   30 2d 32 37 75 62       xor    %ch,0x62753732(%rip)        # 6275374a &lt;_ZStL8__ioinit+0x6275374a&gt;\n  18:   75 6e                   jne    88 &lt;_ZStL8__ioinit+0x88&gt;\n  1a:   74 75                   je     91 &lt;_ZStL8__ioinit+0x91&gt;\n  1c:   31 7e 31                xor    %edi,0x31(%rsi)\n  1f:   38 2e                   cmp    %ch,(%rsi)\n  21:   30 34 29                xor    %dh,(%rcx,%rbp,1)\n  24:   20 37                   and    %dh,(%rdi)\n  26:   2e 33 2e                xor    %cs:(%rsi),%ebp\n  29:   30 00                   xor    %al,(%rax)\n\nDisassembly of section .eh_frame:\n\n0000000000000000 &lt;.eh_frame&gt;:\n   0:   14 00                   adc    $0x0,%al\n   2:   00 00                   add    %al,(%rax)\n   4:   00 00                   add    %al,(%rax)\n   6:   00 00                   add    %al,(%rax)\n   8:   01 7a 52                add    %edi,0x52(%rdx)\n   b:   00 01                   add    %al,(%rcx)\n   d:   78 10                   js     1f &lt;.eh_frame+0x1f&gt;\n   f:   01 1b                   add    %ebx,(%rbx)\n  11:   0c 07                   or     $0x7,%al\n  13:   08 90 01 00 00 10       or     %dl,0x10000001(%rax)\n  19:   00 00                   add    %al,(%rax)\n  1b:   00 1c 00                add    %bl,(%rax,%rax,1)\n  1e:   00 00                   add    %al,(%rax)\n  20:   00 00                   add    %al,(%rax)\n  22:   00 00                   add    %al,(%rax)\n  24:   05 00 00 00 00          add    $0x0,%eax\n  29:   00 00                   add    %al,(%rax)\n  2b:   00 10                   add    %dl,(%rax)\n  2d:   00 00                   add    %al,(%rax)\n  2f:   00 30                   add    %dh,(%rax)\n  31:   00 00                   add    %al,(%rax)\n  33:   00 00                   add    %al,(%rax)\n  35:   00 00                   add    %al,(%rax)\n  37:   00 05 00 00 00 00       add    %al,0x0(%rip)        # 3d &lt;.eh_frame+0x3d&gt;\n  3d:   00 00                   add    %al,(%rax)\n  3f:   00 10                   add    %dl,(%rax)\n  41:   00 00                   add    %al,(%rax)\n  43:   00 44 00 00             add    %al,0x0(%rax,%rax,1)\n  47:   00 00                   add    %al,(%rax)\n  49:   00 00                   add    %al,(%rax)\n  4b:   00 05 00 00 00 00       add    %al,0x0(%rip)        # 51 &lt;.eh_frame+0x51&gt;\n  51:   00 00                   add    %al,(%rax)\n  53:   00 10                   add    %dl,(%rax)\n  55:   00 00                   add    %al,(%rax)\n  57:   00 58 00                add    %bl,0x0(%rax)\n  5a:   00 00                   add    %al,(%rax)\n  5c:   00 00                   add    %al,(%rax)\n  5e:   00 00                   add    %al,(%rax)\n  60:   05 00 00 00 00          add    $0x0,%eax\n  65:   00 00                   add    %al,(%rax)\n  67:   00 14 00                add    %dl,(%rax,%rax,1)\n  6a:   00 00                   add    %al,(%rax)\n  6c:   6c                      insb   (%dx),%es:(%rdi)\n  6d:   00 00                   add    %al,(%rax)\n  6f:   00 00                   add    %al,(%rax)\n  71:   00 00                   add    %al,(%rax)\n  73:   00 2e                   add    %ch,(%rsi)\n  75:   00 00                   add    %al,(%rax)\n  77:   00 00                   add    %al,(%rax)\n  79:   4b 0e                   rex.WXB (bad) \n  7b:   10 5e 0e                adc    %bl,0xe(%rsi)\n  7e:   08 00                   or     %al,(%rax)\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1555501910, "post_id": 55725894, "comment_id": 98132528, "body": "You should show your compile and link command. You are likely missing the YAML library or it was placed in the wrong position in the compile/link command."}], "owner": {"reputation": 21, "user_id": 5783970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f0c6bd8f5e5810a162076cd90dfaa5?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad", "link": "https://stackoverflow.com/users/5783970/muhammad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1555500880, "answer_count": 0, "score": 1, "last_activity_date": 1555501618, "creation_date": 1555498442, "last_edit_date": 1555501618, "question_id": 55725894, "link": "https://stackoverflow.com/questions/55725894/undefined-reference-to-yamlloadfilestd-cxx11basic-stringchar-stdcha", "closed_reason": "Duplicate", "title": "undefined reference to `YAML::LoadFile(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)&#39;", "body": "<p>Can anyone help me with this error ? </p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;iostream&gt;\n\n#include &lt;yaml-cpp/yaml.h&gt;\n\nclass ConfigLoader\n{\npublic:\n    ConfigLoader():loadedConfigFile(YAML::LoadFile(\"./home/muasad/Desktop/magna_mdf_reader/Config_file.yaml\"))\n    {\n\n    }\n\nprivate:\n\n    YAML::Node loadedConfigFile;\n};\n</code></pre>\n\n<blockquote>\n  <p>error: undefined reference to `YAML::LoadFile(std::__cxx11::basic_string, std::allocator > const&amp;)'</p>\n</blockquote>\n"}, {"tags": ["c++", "memory-management"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 4, "creation_date": 1555498399, "post_id": 55725862, "comment_id": 98130526, "body": "Don&#39;t use naked <code>new</code>, use smart pointers instead. Or <code>std::vector</code> for arrays."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 4, "creation_date": 1555498432, "post_id": 55725862, "comment_id": 98130546, "body": "Use smart pointers and containers instead of managing memory allocation yourself."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1555498518, "post_id": 55725862, "comment_id": 98130577, "body": "Also, the premise of the question is wrong. If you do <code>delete Graph_</code> in <code>~Aclass</code> there is no double free in itself. The problem likely comes from incorrect copy constructors. Read up on the rule of five and the rule of zero. Further reading: <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\" title=\"what is the rule of three\">stackoverflow.com/questions/4172722/what-is-the-rule-of-thre&zwnj;&#8203;e</a>"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555498951, "post_id": 55725862, "comment_id": 98130801, "body": "explicit use of <code>new</code> <code>delete</code> is not recommended nowadays. See this: <a href=\"https://youtu.be/JfmTagWcqoE\" rel=\"nofollow noreferrer\">youtu.be/JfmTagWcqoE</a>"}], "owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1555498603, "answer_count": 0, "score": 0, "last_activity_date": 1555498323, "creation_date": 1555498323, "question_id": 55725862, "link": "https://stackoverflow.com/questions/55725862/c-how-to-manage-clean-up-of-a-dynamically-allocate-object-that-also-dynamicall", "closed_reason": "Duplicate", "title": "C++ how to manage clean up of a dynamically allocate object that also dynamically allocates memory", "body": "<p>I have a class <code>Aclass</code> which contains a pointer to struct <code>GraphStructure *Graph_</code>. </p>\n\n<p>The <code>Aclass</code> constructor initializes this pointer by dynamically allocating a <code>GraphStructure</code> instance. </p>\n\n<p>The <code>GraphStructure</code> instance also dynamically allocates arrays and calls delete on these in its destructor.</p>\n\n<p>The order in which the destructors are called are (1) the class destructor and (2) the struct destructor.  </p>\n\n<p>If I call <code>delete</code> on <code>Graph_</code> in the <code>Aclass</code> destructor and then the destructor for the struct is called, is there a double free happening here as my  program stops responding. </p>\n\n<p>If I don't call <code>delete Graph_;</code> then it runs ok but am I not introducing a memory leak here?\nWhat is the correct way to handle this? </p>\n\n<p>I've tried to debug the program.</p>\n\n<pre><code>struct GraphStructure\n{\n    idx_t* xadj;                     \n    idx_t* adjncy;                    \n\n    GraphStructure() {\n\n        xadj = new idx_t[5]; \n        adjncy = new idx_t[5];\n\n    }   \n\n    ~GraphStructure() {\n        delete[] xadj;\n        delete[] adjncy;\n    }\n};\n\n\nclass Aclass \n{\n    GraphStructure *Graph_;\n }\n\n\n\nAclass::Aclass():Graph_(new GraphStructure()) {}\n\nAclass::~Aclass()\n{\n//delete Graph_;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "qml"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555506986, "post_id": 55726811, "comment_id": 98135773, "body": "How can i access it from qml? I tried <code>console.log(list[0])</code>, but this doesn&#39;t work."}, {"owner": {"reputation": 28669, "user_id": 3049264, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MNMWc.jpg?s=128&g=1", "display_name": "Nejat", "link": "https://stackoverflow.com/users/3049264/nejat"}, "reply_to_user": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555526015, "post_id": 55726811, "comment_id": 98146407, "body": "@JohnSmith The QML engine provides automatic type conversion between QVariantList and JavaScript arrays. How do you expose it to qml?"}, {"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555526315, "post_id": 55726811, "comment_id": 98146541, "body": "I had another error. Now all works fine and thank you for your great help."}], "tags": [], "owner": {"reputation": 28669, "user_id": 3049264, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MNMWc.jpg?s=128&g=1", "display_name": "Nejat", "link": "https://stackoverflow.com/users/3049264/nejat"}, "is_accepted": true, "score": 1, "last_activity_date": 1555501419, "creation_date": 1555501419, "answer_id": 55726811, "question_id": 55725828, "link": "https://stackoverflow.com/questions/55725828/pass-2d-array-from-c-to-qml/55726811#55726811", "title": "Pass 2d Array from c++ to qml", "body": "<p>You can use <code>QVariantList</code> which could be passed to qml:</p>\n\n<pre><code>QVariantList list;\nlist.append(QVariantList{5, 5, 6, 7});\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555502709, "post_id": 55726880, "comment_id": 98132998, "body": "If i try the first example, the error message is <code>error: use of deleted function \u2018QVariant::QVariant(void*)\u2019</code>"}, {"owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "reply_to_user": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555502844, "post_id": 55726880, "comment_id": 98133095, "body": "Right. These are the negative examples (not compiling). The <code>QVariantList</code> example is ok."}, {"owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "edited": false, "score": 0, "creation_date": 1555503152, "post_id": 55726880, "comment_id": 98133285, "body": "And how can I convert an existing array into QVarianList?"}], "tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1555501631, "creation_date": 1555501631, "answer_id": 55726880, "question_id": 55725828, "link": "https://stackoverflow.com/questions/55725828/pass-2d-array-from-c-to-qml/55726880#55726880", "title": "Pass 2d Array from c++ to qml", "body": "<p>The problem is: <code>QVariant</code> cannot store arrays, so this lines won't compile at all:</p>\n\n<pre><code>int array[] = {0, 1, 2};\nQVariant v = array;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>QVariant x = {0, 1, 2};\n</code></pre>\n\n<p>or</p>\n\n<pre><code>QVariant x{0, 1, 2};\n</code></pre>\n\n<p>A <a href=\"https://doc.qt.io/qt-5/qvariant.html#QVariantList-typedef\" rel=\"nofollow noreferrer\">specific type</a> exists, though, so you'd be better doing:</p>\n\n<pre><code>QVariantList myArray =\n{\n    QVariantList{4, 5, 6, 7},\n    QVariantList{0, \"one\", true}\n    //etc\n};\n</code></pre>\n\n<p>and access items like:</p>\n\n<pre><code>int x = myArray[0].toList()[0].toInt();\nbool y = myArray[1].toList()[2].toBool();\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 11208910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IubW0nJb16M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7rvn_RUmGAgbvHuxpAhdzQWJUnA/mo/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11208910/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 55726811, "answer_count": 2, "score": 0, "last_activity_date": 1555501631, "creation_date": 1555498222, "last_edit_date": 1555499781, "question_id": 55725828, "link": "https://stackoverflow.com/questions/55725828/pass-2d-array-from-c-to-qml", "title": "Pass 2d Array from c++ to qml", "body": "<p>The question is above. I can create a 2d array in qml like this:</p>\n\n<pre><code>function create()\n{\n    var array= new Array(9);\n    array[0]= new Array(\n}\n</code></pre>\n\n<p>So how I can create such array in c++? I tried:</p>\n\n<pre><code>QVariant myArray= QVariant([4,5,6,7]);\n</code></pre>\n\n<p>but this doesn't work.</p>\n"}, {"tags": ["c++", "c++11", "c++14", "language-lawyer"], "comments": [{"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 9, "creation_date": 1555498172, "post_id": 55725646, "comment_id": 98130416, "body": "no class in the standard library is marked final."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 3, "creation_date": 1555498367, "post_id": 55725646, "comment_id": 98130501, "body": "<a href=\"https://stackoverflow.com/questions/9298450/are-c11-standard-containers-final\" title=\"are c11 standard containers final\">stackoverflow.com/questions/9298450/&hellip;</a>"}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1555499570, "post_id": 55725646, "comment_id": 98131156, "body": "there are a very few classes the standard provides that you can inherit from. since you shouldn&#39;t derive from a standard class to begin with, no reason to add unnecessary keywords."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 7, "creation_date": 1555500839, "post_id": 55725646, "comment_id": 98131927, "body": "Inheriting from a class with a non-virtual destructor is not inherently bad. You just have to be careful how you use it. If you never delete a derived object through a base class pointer, then you don&#39;t <i>need</i> a virtual destructor."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1555503327, "post_id": 55725646, "comment_id": 98133397, "body": "&quot;I can&#39;t think of a reason to do it&quot; is not the same as &quot;nobody could possibly want to do it&quot;. I&#39;ve been surprised many times by things I thought were obvious nonsense that turned out to be useful when viewed from a different perspective."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 0, "creation_date": 1555503875, "post_id": 55725646, "comment_id": 98133727, "body": "With a non virtual destructor you could still: a) do private inheritance. b) do public inheritance without adding member variables (in that case I strongly recommend a <code>static_assert(sizeof(base) == sizeof(derived), &quot;Error&quot;);</code> c) do <code>class MyVect : public std::vector&lt;int&gt; {}</code> to avoid using typedefs."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 2, "creation_date": 1555508586, "post_id": 55725646, "comment_id": 98136838, "body": "@Mirko: b). Adding member is fine, as state above, it is calling destructor of derived object from base class which is UB (even if same size). c). Whereas I see cases for strong typedef for <code>int</code>/<code>float</code>, I don&#39;t see for <code>std::vector&lt;int&gt;</code> :)"}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1555510330, "post_id": 55725646, "comment_id": 98138035, "body": "@Jarod42 on the b case I think you might be right and might be UB (probably works all the time, but the standard does not give you any guarantee). On the c one such an advantage is to do simpler PIMPL. You can&#39;t easily forward declare a typedef to a template inside a namespace. The fact that there&#39;s a header just for forwarding <code>std::string</code> is a strong indicator that there&#39;s room for improvement there."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1555513892, "post_id": 55725646, "comment_id": 98140395, "body": "This isn&#39;t Java. &quot;Make everything <code>virtual</code>&quot; may be popular in some teams, but it&#39;s certainly nothing the library is ever going to mandate, which is effectively what you&#39;re suggesting it does by making things <code>final</code> when they don&#39;t have a virtual dtor."}], "answers": [{"comments": [{"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 1, "creation_date": 1555503702, "post_id": 55726104, "comment_id": 98133607, "body": "It is cleaner to do inheritance if you&#39;re exposing base functions via <code>using</code>. That could help you to avoid reimplementing an <code>operator[]</code> that only refers to <code>member[]</code> for every possible case."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 0, "creation_date": 1555504021, "post_id": 55726104, "comment_id": 98133824, "body": "Also, you could extend functionality as in your example using public inheritance, given that you don&#39;t add any members that change the size of the class."}, {"owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "reply_to_user": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 3, "creation_date": 1555504123, "post_id": 55726104, "comment_id": 98133886, "body": "@Mirko The example is intended to only show some non-ill-formed, non-UB use case related to the OP&#39;s question. And <code>public</code> inheritance opens the door for UB, as it allows invoking the non-<code>virtual</code> destructor.."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 0, "creation_date": 1555504328, "post_id": 55726104, "comment_id": 98134021, "body": "Yes, but there&#39;s no problem invoking base class non virtual destructor as long as your destructor is empty and you&#39;re not extending the size of the class."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 0, "creation_date": 1555504711, "post_id": 55726104, "comment_id": 98134288, "body": "No. I mean by size that you can&#39;t add member variables, you can always do <code>static_assert(sizeof(Example&lt;T&gt;) == sizeof(std::vector&lt;T&gt;), &quot;&quot;);</code> If you extend your <code>Example</code> class with a member, it&#39;s destructor won&#39;t get called, big no-no. But if you don&#39;t, and you don&#39;t expect any special behaviuor in your destructor (it&#39;s empty), there should be no problem."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 7, "creation_date": 1555512116, "post_id": 55726104, "comment_id": 98139214, "body": "@Mirko &quot;there&#39;s no problem invoking base class non virtual destructor&quot; really? Or is it that it <i>appears fine</i> all the times you tried?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 2, "creation_date": 1555520586, "post_id": 55726104, "comment_id": 98143985, "body": "@Mirko You can add semantics to a derived class that require calling the proper destructor, without increasing the size of the class, so your <code>static_assert</code> is not necessarily sufficient. And in any case, the point of the answer was not to show the <i>best</i> way to inherit from <i>something</i>, just a <i>legal</i> way to derive from <code>std::vector</code>."}], "tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": false, "score": 19, "last_activity_date": 1555499110, "creation_date": 1555499110, "answer_id": 55726104, "question_id": 55725646, "link": "https://stackoverflow.com/questions/55725646/why-are-stdfuture-and-stdpromise-not-final/55726104#55726104", "title": "Why are std::future and std::promise not final?", "body": "<p>Have a look at this contrived (admittedly nonsensical) example with <code>std::vector</code>:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct Example : private std::vector&lt;T&gt; {\n   void doStuff(const T&amp; t) { this-&gt;push_back(t); }\n   T retrieveStuff() { return this-&gt;operator[](0); }\n};\n\nExample&lt;int&gt; e;\n\ne.doStuff(42);\nstd::cout &lt;&lt; e.retrieveStuff() &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>This works, you can't get into UB due to <code>std::vector::~vector</code> not being <code>virtual</code> because you can't delete an object through a base class pointer (<code>public</code> inheritance is needed there).</p>\n\n<p>The inheritance here is just an implementation detail. Not recommended practice, but people probably did and do this. Once the decision is made to not break existing code by making <code>std::vector</code> or other container types <code>final</code>, it makes sense to stick to that with different vocabulary types like <code>std::promise</code> or <code>std::future</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 16, "last_activity_date": 1555499362, "creation_date": 1555499362, "answer_id": 55726179, "question_id": 55725646, "link": "https://stackoverflow.com/questions/55725646/why-are-stdfuture-and-stdpromise-not-final/55726179#55726179", "title": "Why are std::future and std::promise not final?", "body": "<p>As per <a href=\"http://eel.is/c++draft/derivation#4\" rel=\"noreferrer\">[derivation]/4</a>:</p>\n\n<blockquote>\n  <p>All types specified in the C++ standard library shall be <strong>non-final types</strong> unless otherwise specified.  </p>\n</blockquote>\n\n<p>And <code>std::future</code> or <code>std::promise</code> are not excepted.</p>\n\n<p>And as mentioned in a comment, this issue has been discussed before. <a href=\"http://cplusplus.github.io/LWG/lwg-closed.html#2113\" rel=\"noreferrer\">Do library implementers have the freedom to add final to non-polymorphic components?</a>. </p>\n\n<p>The resolution of this issue was that it was not considered a defect with the conclusion:</p>\n\n<blockquote>\n  <p>Unless the library uses the keyword <code>final</code> in a specification, the user clearly has freedom to derive from such a class, and so equally clearly, <strong>the library vendor does not have freedom to add a <code>final</code> overrider or class attribute.</strong></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "is_accepted": false, "score": 0, "last_activity_date": 1555570486, "creation_date": 1555570486, "answer_id": 55740591, "question_id": 55725646, "link": "https://stackoverflow.com/questions/55725646/why-are-stdfuture-and-stdpromise-not-final/55740591#55740591", "title": "Why are std::future and std::promise not final?", "body": "<p>Absence of any virtual function in a class doesn't make it non-qualifiable as the Base class. In my opinion, adding <code>virtual</code> function(s) to the base class is kind of <strong>special</strong> case of making the base class as polymorphic. Many programmers careless put <code>virtual</code> to functions, and especially to the destructor of the class (and comment that <em>\"Virtual destructor is necessary\"</em>). </p>\n\n<p>ATL, for example, relies heavily on inheritance but doesn't have any virtual functions. The (base) classes are non-polymorphic. Most (if not all) of the C++/STL classes are non-polymorphic.</p>\n\n<p>One may break the rule of \"Prefer containment/composition over inheritance\" and derive from a class in an illogical form (One example given by lubgr); but this is doable and is valid. Sometimes it is more appropriate to inherit from a non-polymorphic class, rather than containing a class.</p>\n\n<p>Template/Template-meta classes rely on inheritance where no virtual functions are involved. Attribute-inheritance is one example, where a class would inherit from various different classes (multi-inheritance), and inherit the attributes. </p>\n\n<p>One very simple example would be to make a class <code>non_copyable</code>, put copy-constructor/assignment-operator, etc as private/protected; and let other classes inherit from it. This way the \"derived\" class would inherit the <em>non-copyable</em> \"capability/attribute\" of the base class.</p>\n"}], "owner": {"reputation": 592, "user_id": 3054219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298f60961c829e570dbf0566134dd7cb?s=128&d=identicon&r=PG&f=1", "display_name": "Sonic78", "link": "https://stackoverflow.com/users/3054219/sonic78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "accepted_answer_id": 55726179, "answer_count": 3, "score": 14, "last_activity_date": 1555570486, "creation_date": 1555497543, "last_edit_date": 1555499804, "question_id": 55725646, "link": "https://stackoverflow.com/questions/55725646/why-are-stdfuture-and-stdpromise-not-final", "title": "Why are std::future and std::promise not final?", "body": "<p>I wounder why the classes <a href=\"https://en.cppreference.com/w/cpp/thread/future\" rel=\"noreferrer\"><code>std::future</code></a> and <a href=\"https://en.cppreference.com/w/cpp/thread/promise\" rel=\"noreferrer\"><code>std::promise</code></a> are not marked with the <code>final</code> specifier. The <a href=\"https://en.cppreference.com/w/cpp/thread/future/~future\" rel=\"noreferrer\">destructor</a> is <strong>not</strong> virtual so why was <code>final</code> not added? What was (is) the rationale? </p>\n"}, {"tags": ["c++", "optimization", "reference", "this"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 4, "creation_date": 1555497579, "post_id": 55725625, "comment_id": 98130058, "body": "You don&#39;t need to do that at all. You can also omit the <code>this-&gt;</code>, it&#39;s implicit."}, {"owner": {"reputation": 313, "user_id": 4233943, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UaI8T.jpg?s=128&g=1", "display_name": "Pedro Vernetti", "link": "https://stackoverflow.com/users/4233943/pedro-vernetti"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555497740, "post_id": 55725625, "comment_id": 98130156, "body": "I know the compilers will understand I&#39;m accessing members even without <code>this-&gt;</code> when no ambiguity exists, but it is just like if there was a hidden <code>this-&gt;</code>, nothing related to the <code>-&gt;</code> in <code>this-&gt;</code> having costs."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555497844, "post_id": 55725625, "comment_id": 98130224, "body": "<i>&quot;but it is just like if there was a hidden <code>this-&gt;</code>&quot;</i> It&#39;s indeed an implicit parameter given to non static class member functions."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1555497847, "post_id": 55725625, "comment_id": 98130226, "body": "@PedroVernetti there is an already implicit cost of <code>this</code> (since it&#39;s passed as a hidden parameter). How would making a copy of it (<code>self</code>) improve the situation?"}, {"owner": {"reputation": 313, "user_id": 4233943, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UaI8T.jpg?s=128&g=1", "display_name": "Pedro Vernetti", "link": "https://stackoverflow.com/users/4233943/pedro-vernetti"}, "edited": false, "score": 0, "creation_date": 1555497895, "post_id": 55725625, "comment_id": 98130249, "body": "As far as I know, the cost of <code>-&gt;</code> is not the same as that of <code>.</code> (I tested it in some different cases)"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 1, "creation_date": 1555498078, "post_id": 55725625, "comment_id": 98130351, "body": "<code>value.member</code> isn&#39;t the same as <code>reference.member</code>, which exactly did you test?"}, {"owner": {"reputation": 313, "user_id": 4233943, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UaI8T.jpg?s=128&g=1", "display_name": "Pedro Vernetti", "link": "https://stackoverflow.com/users/4233943/pedro-vernetti"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1555499401, "post_id": 55725625, "comment_id": 98131047, "body": "@FireLancer didn&#39;t knew. I actually tested with values"}], "answers": [{"comments": [{"owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 1, "creation_date": 1555506029, "post_id": 55725780, "comment_id": 98135131, "body": "The most obvious gain of any sort of aliasing is cutting long names short in order to increase readability. &#39;this&#39; is the shortest expression in practice, hence no practical gain in a &#39;self&#39; reference. But some readability can be gained through aliasing long-named members."}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": true, "score": 5, "last_activity_date": 1555498043, "creation_date": 1555498043, "answer_id": 55725780, "question_id": 55725625, "link": "https://stackoverflow.com/questions/55725625/keeping-a-reference-to-the-object-itself-inside-member-functions/55725780#55725780", "title": "Keeping a reference to the object itself inside member functions", "body": "<p>No. worst case it would consume extra stack space and need some extra instructions, best case it gets optimized back to <code>this-&gt;</code>.</p>\n\n<p><code>this</code> will almost certainly live in a register where possible, and a reference like <code>A&amp;</code> is basically a pointer at the implementation level.</p>\n\n<p>There probably isn't even a gain in trying to store a direct pointer/reference to <code>this-&gt;Count</code> etc., as on most platforms <code>this-&gt;Count[n]</code> can be a single instruction (e.g. on x86 I believe <code>LEA</code> will be used, you might check the disassembly).</p>\n"}], "owner": {"reputation": 313, "user_id": 4233943, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UaI8T.jpg?s=128&g=1", "display_name": "Pedro Vernetti", "link": "https://stackoverflow.com/users/4233943/pedro-vernetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55725780, "answer_count": 1, "score": 0, "last_activity_date": 1555499821, "creation_date": 1555497461, "last_edit_date": 1555499821, "question_id": 55725625, "link": "https://stackoverflow.com/questions/55725625/keeping-a-reference-to-the-object-itself-inside-member-functions", "title": "Keeping a reference to the object itself inside member functions", "body": "<p>Is it useful, in terms of saving time and reducing number of operations, to create a reference to <code>(*this)</code> in the beginning of a member function where using of <code>this-&gt;</code> is recurrent? Is it something that compilers (gcc interests me the most) already optimize for me? Are there reasons not to do this?</p>\n\n<p>Example:</p>\n\n<pre><code>void A::checkBytes( const byte * dataChunk, uint32_t chunkSize )\n{\n    A &amp; self = (*this);\n    bool UTF8Valid = self.InvalidSequences &amp; 1;\n    byte current, expectedUTF8Bytes = 0;\n    for (uint32_t i = 0; i &lt; chunkSize; i++)\n    {\n        current = dataChunk[i];\n\n        // many tests with 'current' and 'this-&gt;InvalidSequences'\n\n        self.Count[current]++;\n        self.ChunkSize++;\n    }\n    if (!UTF8Valid) self.InvalidSequences |= 1;\n}\n</code></pre>\n\n<p>I know every non-static member function takes its own hidden <code>this</code>. I know I'll have both the hidden <code>A * this</code> and the <code>A &amp; self</code>. What I do not know is whether many <code>this-&gt;someMember</code> will cost more than many <code>referenceToThis.someMember</code> or not at all.</p>\n"}, {"tags": ["c++", "vector", "operator-overloading"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1555498185, "post_id": 55725572, "comment_id": 98130420, "body": "<code>inline</code> is redundant for member functions that are defined inside the class definition. Such functions are implicitly <code>inline</code> (= &quot;may have definitions in more than one translation unit&quot;)."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 2, "creation_date": 1555499336, "post_id": 55725572, "comment_id": 98131018, "body": "I don&#39;t know why MSVC gives such a cryptic error, but the solution is to declare <code>operator&lt;</code> as const: <code>bool operator&lt;(const A&amp; r) const</code>."}, {"owner": {"reputation": 71, "user_id": 5291066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a22e2108a235551018c22544250a36?s=128&d=identicon&r=PG&f=1", "display_name": "yunus celik", "link": "https://stackoverflow.com/users/5291066/yunus-celik"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1555499547, "post_id": 55725572, "comment_id": 98131144, "body": "@cpplearner Can you elaborate it? Because it works."}], "owner": {"reputation": 71, "user_id": 5291066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a22e2108a235551018c22544250a36?s=128&d=identicon&r=PG&f=1", "display_name": "yunus celik", "link": "https://stackoverflow.com/users/5291066/yunus-celik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 646, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1555574628, "creation_date": 1555497264, "last_edit_date": 1555574628, "question_id": 55725572, "link": "https://stackoverflow.com/questions/55725572/operator-gives-operator-surrogate-func-error", "title": "operator&lt; gives operator __surrogate_func error", "body": "<p>I've implemented <code>operator&lt;</code> for my c++ classes and when I tried it for a class that contains object vector; it fails and gives <b>operator __surrogate_func</b></p>\n\n<p>When I remove object vector from class, everything is OK.\nI found this similar question about question but I dont know why Im getting this error? Because I'm just comparing vector. <a href=\"https://stackoverflow.com/questions/39940394/error-c2672-operator-surrogate-func-no-matching-overloaded-function-found/42166464\">error C2672: &#39;operator __surrogate_func&#39;: no matching overloaded function found when using std::upper_bound</a></p>\n\n<pre><code>class A\n{\npublic:\nA() {}\n\ninline int getAVal() { return m_a; }\ninline int getBVal() { return m_b; }\n\ninline void setAVal(int a) { m_a = a; }\ninline void setBVal(int b) { m_b = b; }\n\ninline bool operator&lt;(const A&amp; r)\n{\n    return std::tie(m_a, m_b) &lt; std::tie(r.m_a, r.m_b);\n}\n\nprivate:\nint m_a;\nint m_b;\n};\n\nclass B\n{\nB() {}\n\ninline bool operator&lt;(const B&amp; r)\n{\n    return std::tie(m_aVec) &lt; std::tie(r.m_aVec);\n}\n\nprivate:\nstd::vector&lt;A&gt; m_aVec;\n};\n</code></pre>\n"}, {"tags": ["c++", "image-processing", "filtering", "convolution"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1555498257, "post_id": 55725548, "comment_id": 98130442, "body": "[-2, 0, 2] is not a blur kernel, it&#39;s a 1D edge detector as the comment also says. So it shouldn&#39;t work as a 1D blur either. Did you use a different kernel there?"}, {"owner": {"reputation": 1, "user_id": 10782051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5bbd65adc840ef1fbac62208a1f278f?s=128&d=identicon&r=PG&f=1", "display_name": "Dec", "link": "https://stackoverflow.com/users/10782051/dec"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1555506999, "post_id": 55725548, "comment_id": 98135788, "body": "@harold I don&#39;t think I used a different kernel, I just didn&#39;t use a 2d blocked range for the 1d image and it worked (Single line blur within the 1d). Is there anyway I could show you my whole code? I am very new to this, so I&#39;m unsure"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1555520232, "post_id": 55725548, "comment_id": 98143810, "body": "Please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. There is no way we can point at what you&#39;re doing wrong, because we don&#39;t see what you&#39;re doing. Don&#39;t post all of your code, post the <b>minimal</b> bit of code that is <b>complete</b> (i.e. I can compile and run) and shows the behavior you&#39;re seeing."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1555520307, "post_id": 55725548, "comment_id": 98143849, "body": "The only thing I can see you are doing wrong is in this comment: &quot;to blur the data (1D edge detector)&quot; -- an edge detector and a blur filter are 2 different things. But that&#39;s just a nomenclature thing, and doesn&#39;t invalidate what you&#39;re seeing."}], "owner": {"reputation": 1, "user_id": 10782051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5bbd65adc840ef1fbac62208a1f278f?s=128&d=identicon&r=PG&f=1", "display_name": "Dec", "link": "https://stackoverflow.com/users/10782051/dec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555520345, "creation_date": 1555497182, "last_edit_date": 1555520345, "question_id": 55725548, "link": "https://stackoverflow.com/questions/55725548/gaussian-blur-not-working-for-a-2d-image", "title": "Gaussian Blur not working for a 2D Image?", "body": "<p>I'm trying to implement a Gaussian blur within c++ and I've ran into a problem that involves the 2d image not being blurred when ran. The whole process is it loads a fully colored image and changes it to gray-scale, but it should also blur it. I also tried it within a 1d image and the blur worked. I'm using a stencil access pattern to blur the data. Any guidance would be helpful.  </p>\n\n<p>Blur pattern code</p>\n\n<pre><code>//use the Stencil access pattern to blur the data (1D edge detector)\n    tbb::parallel_for(blocked_range&lt;int&gt;(1, n - 1), [&amp;](const blocked_range&lt;int&gt;&amp; range)\n    {\n        for (int i = range.begin(); i != range.end(); i++)\n            floatOutput[i] = floatInput[i - 1] * -2 + floatInput[i] * 0 + floatInput[i + 1] * 2; \n    });\n</code></pre>\n\n<p>Save code</p>\n\n<pre><code>std::cout &lt;&lt; \"Saving image...\\n\";\n\n    outputImage.convertToType(FREE_IMAGE_TYPE::FIT_BITMAP);\n    outputImage.convertTo24Bits();\n    outputImage.save(\"blurred.png\");\n\n    std::cout &lt;&lt; \"...done\\n\\n\";\n</code></pre>\n"}, {"tags": ["c++", "gcc", "eigen3"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 6, "creation_date": 1555496654, "post_id": 55725226, "comment_id": 98129485, "body": "The phrases &quot;internal compiler error&quot; and &quot;Please submit a full bug report&quot; make it pretty clear that you&#39;ve encountered a compiler bug. If you&#39;re not using the latest compiler, it may have been fixed in a newer release."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555499524, "post_id": 55725226, "comment_id": 98131121, "body": "<a href=\"http://eigen.tuxfamily.org/index.php?title=News:Eigen_3.3.7_released!\" rel=\"nofollow noreferrer\">Based on this</a> it is known problem. What is your compiler version?"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1555504823, "post_id": 55725226, "comment_id": 98134373, "body": "Compiles cleanly for me with GCC 7.3 and Eigen 3.3.4: <a href=\"https://godbolt.org/z/-cF1CO\" rel=\"nofollow noreferrer\">godbolt.org/z/-cF1CO</a>"}, {"owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555504838, "post_id": 55725226, "comment_id": 98134379, "body": "@MarekR I&#39;m using GCC 7.3.0 (see edit). Also note that I&#39;m using the master of <a href=\"https://github.com/eigenteam/eigen-git-mirror\" rel=\"nofollow noreferrer\">github.com/eigenteam/eigen-git-mirror</a> (it says version 3.3.90 in <code>Core&#47;util&#47;Macros.h</code>, although that does not correspond a version listed on the site of Eigen)"}, {"owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1555504976, "post_id": 55725226, "comment_id": 98134479, "body": "@P.W As listed, I&#39;m having difficulty constructing an example in which the compiler error shows up. It occurs in my library, but not in the minimal example. So this makes it very difficult to find."}, {"owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555505031, "post_id": 55725226, "comment_id": 98134502, "body": "@MarekR Also not that I did switch on optimisation. The site you listed seems to imply that the problem on occurs without optimisation."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555505338, "post_id": 55725226, "comment_id": 98134686, "body": "If I were you I would try to find issue description in Eigen. Note in release notes is very similar, so finding this issue analysis can give you an extra hints or possible workarounds."}, {"owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555506336, "post_id": 55725226, "comment_id": 98135359, "body": "@MarekR Thanks I will. In the mean time it seems that the problem disappears for gcc 6.4.0"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1557600733, "post_id": 55725226, "comment_id": 98822725, "body": "ICEs are usually hard to track down. Sometimes removing or adding seemingly unrelated lines can make the problem disappear. Do as @molbdnilo and submit a bug report (following the instructions). Often it is helpful to split your code into smaller compilation units (this also can speed up re-compilation times)."}], "owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1555506375, "creation_date": 1555496099, "last_edit_date": 1555506375, "question_id": 55725226, "link": "https://stackoverflow.com/questions/55725226/strange-compilation-error-compiler-bug-or-my-own", "title": "Strange compilation error: compiler bug or my own?", "body": "<p>I have header-only library, and I'm getting the strangest compilation error. The problem in proceeding is that I'm not getting this error in a representative minimal example, and not on all compilers (on macOS everything compiles and runs like a charm). I am not sure if I should be worried about something in my code, or if it is an upstream bug. Regardless, I'm not sure how to work around this. </p>\n\n<p>I'm getting the following compiler error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>In file included from /home/tdegeus/opt/include/eigen3/Eigen/SparseCore:59:0,\n                 from /home/tdegeus/opt/include/eigen3/Eigen/Sparse:26,\n                 from /home/tdegeus/opt/include/eigen3/Eigen/Eigen:2,\n                 from /home/tdegeus/prog/src/GooseFEM/docs/examples/Statics/Periodic/LinearElasticity/main.cpp:1:\n/home/tdegeus/opt/include/eigen3/Eigen/src/SparseCore/SparseSelfAdjointView.h: In function \u2018void Eigen::internal::permute_symm_to_symm(const MatrixType&amp;, Eigen::SparseMatrix&lt;typename MatrixType::Scalar, DestOrder, typename MatrixType::StorageIndex&gt;&amp;, const typename MatrixType::StorageIndex*) [with int SrcMode = 1; int DstMode = 2; MatrixType = Eigen::SparseMatrix&lt;double&gt;; int DestOrder = 0]\u2019:\n/home/tdegeus/opt/include/eigen3/Eigen/src/SparseCore/SparseSelfAdjointView.h:517:6: internal compiler error: in predicate_mem_writes, at tree-if-conv.c:2252\n void permute_symm_to_symm(const MatrixType&amp; mat, SparseMatrix&lt;typename MatrixType::Scalar,DstOrder,typename MatrixType::StorageIndex&gt;&amp; _dest, const typename MatrixType::StorageIndex* perm)\n      ^~~~~~~~~~~~~~~~~~~~\n0xb3530b predicate_mem_writes\n    /ssoft/spack/paien/spack.v2/var/spack/stage/gcc-7.3.0-drb5cfgzldhzbrs6lyzk7xdqqcixbxhb/gcc-7.3.0/gcc/tree-if-conv.c:2252\n0xb3530b combine_blocks\n    /ssoft/spack/paien/spack.v2/var/spack/stage/gcc-7.3.0-drb5cfgzldhzbrs6lyzk7xdqqcixbxhb/gcc-7.3.0/gcc/tree-if-conv.c:2377\n0xb359bb tree_if_conversion(loop*)\n    /ssoft/spack/paien/spack.v2/var/spack/stage/gcc-7.3.0-drb5cfgzldhzbrs6lyzk7xdqqcixbxhb/gcc-7.3.0/gcc/tree-if-conv.c:2883\n0xb3663b execute\n    /ssoft/spack/paien/spack.v2/var/spack/stage/gcc-7.3.0-drb5cfgzldhzbrs6lyzk7xdqqcixbxhb/gcc-7.3.0/gcc/tree-if-conv.c:2961\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nPlease include the complete backtrace with any bug report.\nSee &lt;https://gcc.gnu.org/bugs/&gt; for instructions.\n</code></pre>\n\n<p>Which disappears if I comment this line (obviously breaking functionality):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>m_solver.compute(m_ACuu);\n</code></pre>\n\n<p>Note that:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Eigen::SparseMatrix&lt;double&gt; m_ACuu;\nEigen::SimplicialLDLT&lt;Eigen::SparseMatrix&lt;double&gt;&gt; m_solver;\n</code></pre>\n\n<p>I tried a minimal example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;math.h&gt;\n#include &lt;vector&gt;\n#include &lt;Eigen/Dense&gt;\n#include &lt;Eigen/Sparse&gt;\n#include &lt;Eigen/SparseCholesky&gt;\n\nint main()\n{\n  size_t N = 11;\n\n  // allocate system\n  Eigen::SparseMatrix&lt;double&gt; A(N,N);\n  Eigen::VectorXd f(N);\n\n  // set force\n  f         *= 0.0;\n  f((N-1)/2) = 1.0;\n\n  // construct list of Triplets (row,col,data) that from the matrix \"A\"\n  std::vector&lt;Eigen::Triplet&lt;double&gt;&gt; Atr;\n  // - first equation\n  Atr.push_back(Eigen::Triplet&lt;double&gt;(0,0,+2.0));\n  Atr.push_back(Eigen::Triplet&lt;double&gt;(0,1,-1.0));\n  // - body\n  for ( size_t i=1; i&lt;N-1; ++i ) {\n    Atr.push_back(Eigen::Triplet&lt;double&gt;(i,i-1,-1.0));\n    Atr.push_back(Eigen::Triplet&lt;double&gt;(i,i  ,+2.0));\n    Atr.push_back(Eigen::Triplet&lt;double&gt;(i,i+1,-1.0));\n  }\n  // - last equation\n  Atr.push_back(Eigen::Triplet&lt;double&gt;(N-1,N-2,-1.0));\n  Atr.push_back(Eigen::Triplet&lt;double&gt;(N-1,N-1,+2.0));\n\n  // build matrix from Triplets\n  A.setFromTriplets(Atr.begin(),Atr.end());\n\n  // solve the linear system\n  // - define solver (according to type above)\n  Eigen::SimplicialLDLT&lt;Eigen::SparseMatrix&lt;double&gt;&gt; solver;\n  // - analyze the system, and factorize (one could solve different right-hand-sides)\n  // solver.analyzePattern(A);\n  solver.factorize(A);\n  // - solve \"A * x = f\"\n  Eigen::VectorXd u = solver.solve(f);\n\n  // print to screen\n  std::cout &lt;&lt; A &lt;&lt; std::endl;\n  std::cout &lt;&lt; u &lt;&lt; std::endl;\n\n  return 0;\n}\n\n</code></pre>\n\n<p>Compiled on the same system with the same libraries and with similar options:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>g++ -march=native -O3 test.cpp\n</code></pre>\n\n<p><strong>But this compiles and runs like a charm!?</strong></p>\n\n<p>Note that I've tried several Eigen versions, including 3.3.90. </p>\n\n<p><strong>Edit</strong></p>\n\n<p>Also note that this problem occurs with</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>g++ --version\ng++ (GCC) 7.3.0\n</code></pre>\n\n<p>But is gone for </p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>g++ (GCC) 6.4.0\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 5, "creation_date": 1555495901, "post_id": 55725113, "comment_id": 98129071, "body": "<code>std::shared_ptr</code>/<code>std::weak_ptr</code> might extend lifetime or allow to test pointer validity."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1555496125, "post_id": 55725113, "comment_id": 98129203, "body": "@Jarod42 It&#39;s also a good way to get a circular reference you may not notice, if you forget the weak_ptr part :D"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1555496560, "post_id": 55725113, "comment_id": 98129429, "body": "<code>[cls_ptr]</code> means capturing (local variable) <code>cls_ptr</code> <i>by value</i>. It&#39;s not a problem that the local variable goes out of scope before lambda is called. (Capturing it <i>by reference</i> i.e. <code>[&amp;cls_ptr]</code> would be a problem.) However, the actual problem is (IMHO) the life-time of the pointe<b>e</b> of <code>cls_ptr</code>..."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1555503228, "post_id": 55725113, "comment_id": 98133325, "body": "<code>GetPointerToClass</code> should return a pointer to object with infinitive lifetime, this is what I would expect from function with such name. If this is not the case (this is only reason you can have UB), then consider renaming function. To fix it you have make sure that the life time of the pointed object is longer then lifetime of the lambda which captures the pointer."}], "answers": [{"comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1555496275, "post_id": 55725238, "comment_id": 98129286, "body": "Especially, in combination with lambdas, raw pointers are good for becoming dangling. Hence, the comment of Jarod42 (about <code>std::shared_ptr</code>/<code>std::weak_ptr</code>) is worth to be elaborated."}, {"owner": {"reputation": 2151, "user_id": 5902079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df4530b8e41c66ac12d17f96cd70c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Gordon", "link": "https://stackoverflow.com/users/5902079/dmitry-gordon"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1555496551, "post_id": 55725238, "comment_id": 98129426, "body": "Yes, I agree that it should be used with care. However we don&#39;t know the context - maybe is function exists only within the more narrow scope that the object, etc."}], "tags": [], "owner": {"reputation": 2151, "user_id": 5902079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df4530b8e41c66ac12d17f96cd70c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Gordon", "link": "https://stackoverflow.com/users/5902079/dmitry-gordon"}, "is_accepted": true, "score": 2, "last_activity_date": 1555497334, "last_edit_date": 1555497334, "creation_date": 1555496125, "answer_id": 55725238, "question_id": 55725113, "link": "https://stackoverflow.com/questions/55725113/passing-pointer-to-stdfunctionvoid/55725238#55725238", "title": "passing pointer to std::function&lt;void()&gt;", "body": "<blockquote>\n  <p>will the cls_ptr always be valid in the second_on_finish if the object isnt deleted</p>\n</blockquote>\n\n<p>If you mean that <code>cls_ptr</code>wasn't destroyed by that time - the answer is <strong>yes</strong>. Pointer is captured by value (not the object it points to) so untill object is destroyed at that address - you can deference it.</p>\n"}], "owner": {"reputation": 507, "user_id": 4593846, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1095d4be6173b85931b08009701a5167?s=128&d=identicon&r=PG&f=1", "display_name": "dvrer", "link": "https://stackoverflow.com/users/4593846/dvrer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 55725238, "answer_count": 1, "score": 1, "last_activity_date": 1555497334, "creation_date": 1555495758, "question_id": 55725113, "link": "https://stackoverflow.com/questions/55725113/passing-pointer-to-stdfunctionvoid", "title": "passing pointer to std::function&lt;void()&gt;", "body": "<p>what is the best practice to avoid UB when passing a pointer to <code>std::function&lt;void()&gt;</code> in <code>[]</code> ?</p>\n\n<p>will the <code>cls_ptr</code> always be valid in the <code>second_on_finish</code> if the object isnt deleted?</p>\n\n<p>this is the current code:</p>\n\n<pre><code>void Foo()\n{\n    SomeClass* cls_ptr = GetPointerToClass();\n\n    std::function&lt;void()&gt; first_on_finish = [cls_ptr]() {\n\n        if (some_argument == true)\n        {\n            std::function&lt;void()&gt; second_on_finish = [cls_ptr]() {\n                //cls_ptr is always valid here?\n            };\n            run_in_a_few_seconds(second_on_finish);\n        }\n\n    };\n\n    run_in_a_few_seconds(first_on_finish);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "cmake", "gnu-make", "ninja"], "comments": [{"owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "edited": false, "score": 2, "creation_date": 1555495320, "post_id": 55724934, "comment_id": 98128742, "body": "On unix systems, you could do something like <code>make 2&gt;&amp;1 | tee myLogFile</code>, which does print everything to stdout as well as to <code>myLogFile</code>. Should be identical with <code>ninja</code>."}, {"owner": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "reply_to_user": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "edited": false, "score": 1, "creation_date": 1555496139, "post_id": 55724934, "comment_id": 98129212, "body": "As @lubgr said, plus: When doing this in the cosole window, since you should start to resolve the compiler errors from top to bottom, simply pipe the output to <code>less</code> or <code>more</code>: <code>make 2&gt;&amp;1 | less</code>."}, {"owner": {"reputation": 171, "user_id": 8091812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89a2a9bb4ef0a14d2603bcef8a9425f?s=128&d=identicon&r=PG&f=1", "display_name": "user654789384", "link": "https://stackoverflow.com/users/8091812/user654789384"}, "edited": false, "score": 0, "creation_date": 1555585409, "post_id": 55724934, "comment_id": 98166061, "body": "ok thank you i will have a look at it. but the translation for this is: reroute stdout, store and alalyse by hand? i was hoping there might be a happy-coder already facing this issue in the past :)"}], "owner": {"reputation": 171, "user_id": 8091812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89a2a9bb4ef0a14d2603bcef8a9425f?s=128&d=identicon&r=PG&f=1", "display_name": "user654789384", "link": "https://stackoverflow.com/users/8091812/user654789384"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555495189, "creation_date": 1555495189, "question_id": 55724934, "link": "https://stackoverflow.com/questions/55724934/logging-make-ninja-warnings-to-a-file", "title": "Logging Make/Ninja Warnings to a file", "body": "<p>The make/ninja-build output is missing the possibility to have a clear overview of warnings and other messages. I search a solution to log warnings, messages and other compiler information somehow to a file, and sort the information as well as remove dublicates.</p>\n\n<p>Problems with the stdout which the compiler produces:</p>\n\n<ul>\n<li>Warnings and messages from header files are printed X-times instead of once</li>\n<li>the terminal coloring is not really helpful</li>\n<li>the terminal has a max line (back feed) where i can scroll back, the rest is lost</li>\n</ul>\n\n<p>As for those who work with Eclipse CDT:\nAt the end of the build you get a list in the \"Problems\" window as follows:\nFILENAME, LINE, WARNING /INFO</p>\n\n<p>If there would be a solution to mirror this output into a file, this would be very helpful</p>\n"}, {"tags": ["c#", "c++", "unity3d", "udp"], "comments": [{"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1555495264, "post_id": 55724698, "comment_id": 98128711, "body": "one thing to remember udp does not guarantee delivery, and is therefore in effect not designed to be a bidirectional communication tool. TCP is."}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1555496155, "post_id": 55724698, "comment_id": 98129221, "body": "Thanks for the comment BugFinder.  The choice of UDP over TCP was made to maximizing communication speed and minimizing processing overhead costs.  I need to simulate movement and haptic feedback while running graphical 3D environments and was informed that UDP would provide better results for my specific application."}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1555496859, "post_id": 55724698, "comment_id": 98129616, "body": "Maybe, but if you&#39;re trying to simulate movement and haptic feedback, you surely require all parts to get there, and more over in order. UDP guarantees none of that.  UDP is broadcast and forget, tcp is more like a phone call, it connects, it talks to you, you grunt to say you got it.."}, {"owner": {"reputation": 3859, "user_id": 6383171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1hf3.png?s=128&g=1", "display_name": "zambari", "link": "https://stackoverflow.com/users/6383171/zambari"}, "edited": false, "score": 0, "creation_date": 1555496890, "post_id": 55724698, "comment_id": 98129633, "body": "all the working exmaples I&#39;ve seen have used different sockets for send and recieve"}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1555497436, "post_id": 55724698, "comment_id": 98129962, "body": "@BugFinder, again thanks for your attention.  Since UDP is correctly working very well (one-way) I&#39;d like to continue with it if it is possible to get it working both ways."}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "reply_to_user": {"reputation": 3859, "user_id": 6383171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1hf3.png?s=128&g=1", "display_name": "zambari", "link": "https://stackoverflow.com/users/6383171/zambari"}, "edited": false, "score": 0, "creation_date": 1555497594, "post_id": 55724698, "comment_id": 98130067, "body": "@zambari.  Thanks for the input.  I&#39;ve been reviewing the microsoft docs for recvfrom function and saw: &quot;If no incoming data is available at the socket, the recvfrom function blocks and waits for data to arrive according to the blocking rules defined for WSARecv with the MSG_PARTIAL flag not set unless the socket is nonblocking. In this case, a value of SOCKET_ERROR is returned with the error code set to WSAEWOULDBLOCK. The select, WSAAsyncSelect, or WSAEventSelect can be used to determine when more data arrives.&quot;  So, I&#39;m thinking maybe I can run two threads to send/receive using same socket?"}, {"owner": {"reputation": 3859, "user_id": 6383171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1hf3.png?s=128&g=1", "display_name": "zambari", "link": "https://stackoverflow.com/users/6383171/zambari"}, "edited": false, "score": 1, "creation_date": 1555497639, "post_id": 55724698, "comment_id": 98130089, "body": "why can&#39;t you just use two sockets?"}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "edited": false, "score": 0, "creation_date": 1555497746, "post_id": 55724698, "comment_id": 98130163, "body": "Actually, I don&#39;t have a reason why I can&#39;t.  I&#39;ve only been suggesting the one socket based on what I&#39;ve been reading.  I&#39;m just assuming that one socket open (that can send/receive) would be more efficient than having two open."}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "edited": false, "score": 0, "creation_date": 1555499603, "post_id": 55724698, "comment_id": 98131173, "body": "This is one of the answers which I have read which says that read/send should be available on one socket, and this one also actually says that using one socket is the preferred method over using two sockets for send/receive (see part 2 of Peter Duniho&#39;s Answer): <a href=\"https://stackoverflow.com/questions/27625793/udp-send-and-receive-socket-behavior\" title=\"udp send and receive socket behavior\">stackoverflow.com/questions/27625793/&hellip;</a>"}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "edited": false, "score": 0, "creation_date": 1555511417, "post_id": 55724698, "comment_id": 98138765, "body": "I still don&#39;t have a working solution, but I am in the process of running two threads (one for sending, one for receiving) under the same socket.  I&#39;ll update if I get this working.  Also, I plan on building a a very simple c++ application that will send and receive (and open two instances of it for testing) and then a Unity application that will do the same.  If I get those working, then hopefully I will have learned winsock, etc., enough to do what I want for my specific work in and out of Unity.  I&#39;ll update but please continue with suggestions if you have any.  Thanks!"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 3859, "user_id": 6383171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1hf3.png?s=128&g=1", "display_name": "zambari", "link": "https://stackoverflow.com/users/6383171/zambari"}, "edited": false, "score": 0, "creation_date": 1555553872, "post_id": 55724698, "comment_id": 98154032, "body": "@zambari: Using two sockets doesn\u2019t reduce the central difficulty of interleaving the sends and receives."}, {"owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "edited": false, "score": 0, "creation_date": 1556023303, "post_id": 55724698, "comment_id": 98289748, "body": "Been on holiday for a few days.  Since back, I&#39;ve been working on different aspects of the project to fix performance issues, but I&#39;ll go back to working on this issue in the next day or so and I&#39;ll update then.  Thanks again for the comments so far, everyone."}], "owner": {"reputation": 91, "user_id": 11345647, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-goGyVx0QbdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8Gw_on-0l7V8Jutw8u9rVGxc_sA/mo/photo.jpg?sz=128", "display_name": "user70711", "link": "https://stackoverflow.com/users/11345647/user70711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555494448, "creation_date": 1555494448, "question_id": 55724698, "link": "https://stackoverflow.com/questions/55724698/how-to-both-send-receive-continously-via-udp-and-post-process-datagrams-on-bot", "title": "How to BOTH send &amp; receive continously via UDP and post-process datagrams on both ends (using the same socket?)", "body": "<p>This is an issue mainly due to my inexperience with winsock, sockets, UDP, and programming in general.  There are a lot of questions/answers posted related to this issue, but I'm been unable to sift through them due to my poor understanding of winsock, etc., to grasp how to resolve my issue.</p>\n\n<p>Problem.\nI currently have a UDP connection running (continously), correctly, through a C++ application and C# script running in a Unity application.  Currently, the C++ application convert position data information from an external haptic device into a simple string and sends that datagram via UDP to the unity application.  The Unity script then converts the simple string back into relevant information and is used to control objects within the Unity gamespace.  This works fine, but mainly because I have been able to find scripts online which only needed a little editing and adjusting to work for my specific application.  What I now need to do is to send datagrams from the Unity application to the C++ application (the reverse of what I am currently doing) to provide haptic feedback to the haptic devices when the gameobject interacts with colliders in the Unity gamespace.  I have the data that I want to send available when contact with the colliders is made (currently prints via Debug.Log), but I don't know how to properly use the winsock Sentto and Recvfrom functions to have the C++ application actively listening (not just sending) and the Unity application actively sending (not just listening).  </p>\n\n<p>I will continue to look through the questions/solutions already posted to see if I can figure it out, but in the meantime if anyone can provide some assistance I would greatly appreciate it.  The relevant portions of the code that I am using are posted below:</p>\n\n<p>This script is attached to my gameobject in Unity</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\nusing System;\nusing System.Text;\nusing System.Net;\nusing System.Net.Sockets;\nusing System.Threading;\nusing System.Globalization;\nusing UnityEngine.Serialization;\n\npublic class TestUDPConnection : MonoBehaviour\n{\n\n    private const int listenPort = 11000;\n    private UdpClient listener;\n    private IPEndPoint remoteIpEndPoint;\n\n    public static string currentUDPData;\n    private Thread listenerThread;\n    public bool inputSignal = false;\n\n    //bool to fix unity crash\n    public int fixMe = 1;\n\n    // Use this for initialization\n    void Start ()\n    {\n        // Creat a new thread for receiving UDP messages\n        listenerThread = new Thread(new ThreadStart(UDPReceive));\n        listenerThread.Name = \"UDP Receiving Thread\";\n        listenerThread.IsBackground = true; // run thread in background\n        listenerThread.Start();\n    }\n\n    // Thread for receiving UDP input\n    public void UDPReceive()\n    {\n        Debug.Log(\"Start receiving UDP.\");\n\n        listener = new UdpClient(listenPort); // Initializes and BINDS directly (this is an overload of the UdpClient function, or to be precise the Constructor)\n        while (fixMe &gt; 0) {\n            try {\n                // Opening udpclient listener on port\n                Debug.Log(\"Listening to port: \" + listenPort);\n\n                // Receive bytes\n                remoteIpEndPoint = new IPEndPoint(IPAddress.Any, 0); // Initializes the Endpoint with the correct Port and any IP address (UDP is connectionless the receiver doesn't need any IP address)\n                byte[] receiveBytes = listener.Receive(ref remoteIpEndPoint);\n\n                // Encode bytes to string (with UTF8 or ASCII Encoding)\n                currentUDPData = Encoding.ASCII.GetString(receiveBytes);\n\n                try {\n//code is parsed here\n\n                } catch (Exception parseError) {\n                    Debug.Log(\"Parsing didn't work: \" + parseError.ToString());\n                }\n            } catch (Exception e) {\n                Debug.Log(\"Something went wrong: \" + e.ToString());\n            }\n        }\n\n        Debug.Log(\"Stop receiving UDP.\");\n\n    }\n    // Update is called once per frame\n    void Update ()\n    {\n        // Executed when BACKSPACE key hit\n            if (Input.GetKeyDown(\"backspace\")) {\n                DestroyObject(gameObject);\n                fixMe = 0;\n    }\n}\n    // Executed when object gets destroyed\n    void OnDisable()\n    {\n        if (listenerThread != null) {\n            listenerThread.Abort();\n        }\n        listener.Close();\n        Debug.Log(\"UDP receiver closed\");\n        fixMe = 0;\n    }\n} \n</code></pre>\n\n<p>This is script that I have in my C++ application (there is more code in the script that deals with the haptic device, but this portion pertains to the UDP communication):</p>\n\n<pre><code>#ifndef UNICODE\n#define UNICODE\n#endif\n\n#define WIN32_LEAN_AND_MEAN\n\n#include &lt;winsock2.h&gt;\n#include &lt;Ws2tcpip.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;vector&gt;\n\n// Link with ws2_32.lib\n#pragma comment(lib, \"Ws2_32.lib\")\n\nint iResult;\nWSADATA wsaData;\n\nSOCKET SendSocket = INVALID_SOCKET;\nsockaddr_in RecvAddr;\n\nunsigned short Port = 11000; //port communicated through\n\nchar SendBuf[1024]; //message variable\nint BufLen = 1024; //max length of buffer\n\nint main()\n{\n// Initialize Winsock\n    iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\n    if (iResult != NO_ERROR) {\n        wprintf(L\"WSAStartup failed with error: %d\\n\", iResult);\n        //return 1;\n    }\n\n    //---------------------------------------------\n    // Create a socket for sending data\n    SendSocket = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n    if (SendSocket == INVALID_SOCKET) {\n        wprintf(L\"socket failed with error: %ld\\n\", WSAGetLastError());\n        WSACleanup();\n        //return 1;\n    }\n    //---------------------------------------------\n    // Set up the RecvAddr structure with the IP address of\n    // the receiver (in this example case \"192.168.1.1\")\n    // and the specified port number.\n    RecvAddr.sin_family = AF_INET;\n    RecvAddr.sin_port = htons(Port);\n    RecvAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    //InetPton(AF_INET, _T(\"127.0.0.1\"), &amp;RecvAddr.sin_addr.s_addr);\n\n    //---------------------------------------------\n    // Clean up and quit.\n    //wprintf(L\"Exiting.\\n\");\n    //WSACleanup();\n    //return 0;\n\n//the udp communication, data parsing, etc., is contained within this loop:\n// main haptic simulation loop\n    while (simulationRunning)\n{\n//script here for various stuff...\n//taking in position values of haptic device in different variables\n//converting them to strings\n//adding them to the pBuffer that is sent through the UDP pipeline via:\n\niResult = sendto(SendSocket,\n                    pBuffer, nStrSize + 1, 0, (SOCKADDR *)&amp; RecvAddr, sizeof(RecvAddr));\n                if (iResult == SOCKET_ERROR) {\n                    wprintf(L\"sendto failed with error: %d\\n\", WSAGetLastError());\n                    closesocket(SendSocket);\n                    WSACleanup();\n                    //return 1;\n                }\n    }\n</code></pre>\n\n<p>So, basically, I'd like to implement the reverse of what is happening in each code (i.e., sending data in the C# Unity script and receiving data in the C++ application script).  From what I've read, you can send/receive on the same socket so it seems that it might be simple to add a few lines to my C++ simulation loop which includes the recvfrom function, and some simple copy and paste of my c++ loop into the C# script (with few adjustments) to get the data sent as well.  I'll be reading more and trying different code see about to getting it working in the meantime.  Thanks ahead of time for any assistance that you can provide!</p>\n"}, {"tags": ["c++", "string", "pointers", "pass-by-reference"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 4, "creation_date": 1555494202, "post_id": 55724572, "comment_id": 98128001, "body": "Why are you using a pointer to pass the <code>word</code> parameter to the function?"}, {"owner": {"reputation": 115, "user_id": 10976676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a331b94bb31fbbfb159828ac43e171?s=128&d=identicon&r=PG&f=1", "display_name": "o2640110", "link": "https://stackoverflow.com/users/10976676/o2640110"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1555494376, "post_id": 55724572, "comment_id": 98128130, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 This function will modify the string later."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1555494444, "post_id": 55724572, "comment_id": 98128182, "body": "Then just use a reference. There&#39;s no need to use apointer for that purpose."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1555510670, "post_id": 55724572, "comment_id": 98138283, "body": "To answer your question directly:  <code>(*word)[i]</code>.  The <code>(*word)</code> dereferences the pointer, returning a string variable. The <code>[i]</code> returns the character from the string."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 10976676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a331b94bb31fbbfb159828ac43e171?s=128&d=identicon&r=PG&f=1", "display_name": "o2640110", "link": "https://stackoverflow.com/users/10976676/o2640110"}, "edited": false, "score": 0, "creation_date": 1555494353, "post_id": 55724606, "comment_id": 98128107, "body": "What is the difference aside from character used in the declaration?"}, {"owner": {"reputation": 412, "user_id": 2394602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Id1e2.png?s=128&g=1", "display_name": "One Man Monkey Squad", "link": "https://stackoverflow.com/users/2394602/one-man-monkey-squad"}, "edited": false, "score": 1, "creation_date": 1555494491, "post_id": 55724606, "comment_id": 98128215, "body": "The reference allows you to use the instance like a normal instance on the stack. No pointer syntax required. It essentially &quot;hides&quot; the pointer from you."}, {"owner": {"reputation": 115, "user_id": 10976676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a331b94bb31fbbfb159828ac43e171?s=128&d=identicon&r=PG&f=1", "display_name": "o2640110", "link": "https://stackoverflow.com/users/10976676/o2640110"}, "reply_to_user": {"reputation": 412, "user_id": 2394602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Id1e2.png?s=128&g=1", "display_name": "One Man Monkey Squad", "link": "https://stackoverflow.com/users/2394602/one-man-monkey-squad"}, "edited": false, "score": 0, "creation_date": 1555494739, "post_id": 55724606, "comment_id": 98128376, "body": "@OneManMonkeySquad Aside that, is there other reasons to use a reference instead of a pointer? Why is this the recommended way to do this?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1555495219, "post_id": 55724606, "comment_id": 98128686, "body": "Because you know that you have a &quot;unique&quot; string (you cannot reassign the reference), whereas a pointer may be <code>nullptr</code> or change."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 115, "user_id": 10976676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a331b94bb31fbbfb159828ac43e171?s=128&d=identicon&r=PG&f=1", "display_name": "o2640110", "link": "https://stackoverflow.com/users/10976676/o2640110"}, "edited": false, "score": 1, "creation_date": 1555495963, "post_id": 55724606, "comment_id": 98129107, "body": "@o2640110 you got the question backwards. You should ask instead &quot;Why would you use a pointer?&quot; and the only reason I know is to allow a <code>nullptr</code> being passed. Note that most of the time it makes simply no sense for a function to accept a <code>nullptr</code> (yours is not even checking and would cause undefined behaviour)"}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 5, "last_activity_date": 1555494191, "creation_date": 1555494191, "answer_id": 55724606, "question_id": 55724572, "link": "https://stackoverflow.com/questions/55724572/how-can-i-get-a-character-from-a-string-pointer-in-c/55724606#55724606", "title": "How can I get a character from a string pointer in C++?", "body": "<p>As you know that you have an object, pass it by reference. Then access the object as usual.</p>\n\n<pre><code>    shuffle(word);\n}\n\nvoid shuffle(std::string&amp; word) // Not adding const as I suppose you want to change the string\n{\n    for (unsigned int i = 0; i &lt; word.size(); ++i) {\n        std::cout &lt;&lt; word[i] &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 10976676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a331b94bb31fbbfb159828ac43e171?s=128&d=identicon&r=PG&f=1", "display_name": "o2640110", "link": "https://stackoverflow.com/users/10976676/o2640110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 55724606, "answer_count": 1, "score": -1, "last_activity_date": 1555494218, "creation_date": 1555494085, "last_edit_date": 1555494218, "question_id": 55724572, "link": "https://stackoverflow.com/questions/55724572/how-can-i-get-a-character-from-a-string-pointer-in-c", "title": "How can I get a character from a string pointer in C++?", "body": "<p>I'm passing a <code>std::string</code> pointer to a function and I want to use this pointer to access and modify characters in this string.</p>\n\n<p>For now, the only thing I am able to do is print my string by using the <code>*</code> operator but I cant't access only one character. I tried with <code>*word[i]</code>, <code>*(word + i)</code> where <code>word</code> is my pointer and <code>i</code> is an <code>unsigned int</code>.</p>\n\n<p>For now I have this.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid shuffle(std::string* word);\n\nint main(int argc, char *argv[])\n{\n    std::string word, guess;\n\n    std::cout &lt;&lt; \"Word: \";\n    std::cin &gt;&gt; word;\n\n    shuffle(&amp;word);\n}\n\nvoid shuffle(std::string* word)\n{\n    for (unsigned int i(0); i &lt; word-&gt;length(); ++i) {\n        std::cout &lt;&lt; *word &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>Lets say I type the word <em>Overflow</em>, I want to have the following output:</p>\n\n<pre><code>Word: Overflow\nO\nv\ne\nr\nf\nl\no\nw\n</code></pre>\n\n<p>I'm quite new to C++ and I'm not a native English speaker so please excuse the mistakes. Thanks.</p>\n"}, {"tags": ["c++", "opengl", "shader"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1555493580, "post_id": 55724301, "comment_id": 98127647, "body": "GLSL version 150 corresponds to OpenGL 3.2. Are you <i>sure</i> you&#39;re creating a context of 3.2 or above? <a href=\"https://stackoverflow.com/questions/44430594/mac-opengl-shader-error-version-150-is-not-supported\">Possible duplicate</a>."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1555493807, "post_id": 55724301, "comment_id": 98127765, "body": "I&#39;m not sure at all, as i&#39;m very new to this and just now started to understand how it actually works. The school is running 330 as a standard for the assignment and it works with Qt 2017 on a windows computer, if that answers anything?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1555494010, "post_id": 55724301, "comment_id": 98127891, "body": "I don&#39;t know much about Qt, but there has to be a way to select a desired GL version before creating a window."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555494235, "post_id": 55724301, "comment_id": 98128024, "body": "Ok, so what version should I set for my mac then?"}, {"owner": {"reputation": 1482, "user_id": 11082033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16202735251109a2e024fbdd88d5fc23?s=128&d=identicon&r=PG&f=1", "display_name": "J.R.", "link": "https://stackoverflow.com/users/11082033/j-r"}, "edited": false, "score": 0, "creation_date": 1555496196, "post_id": 55724301, "comment_id": 98129243, "body": "You could try to set the version to 120; there may not be anything in your shader that requires 150."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555496857, "post_id": 55724301, "comment_id": 98129614, "body": "You&#39;re right! It did work, but it seems that I need version 3.3 to work to get the shaders working. And the more I research the more I give up hope about that working.."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1555499009, "post_id": 55724301, "comment_id": 98130830, "body": "Note that <a href=\"https://stackoverflow.com/questions/55287467/is-opengl-on-macos-deprecated/55287682\">OpenGL is deprecated</a> on Apple platforms."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1555499590, "post_id": 55724301, "comment_id": 98131167, "body": "Which version of macOS are you running? You can check which OpenGL version should be supported on your system, e.g., here: <a href=\"https://developer.apple.com/opengl/OpenGL-Capabilities-Tables.pdf\" rel=\"nofollow noreferrer\">developer.apple.com/opengl/OpenGL-Capabilities-Tables.pdf</a>"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1555503802, "post_id": 55724301, "comment_id": 98133679, "body": "For what it&#39;s worth my own MacBook Pro is circa mid. 2012, is running macOS 10.13.6 and <code>Open GLExtensions Viewer</code> shows that it fully supports all OpenGL versions from 3.0 to 4.1 inclusive.  Even if you create a suitable OpenGL context there&#39;s nothing in the code shown to indicate that that context is the <i>current</i> context when you attempt to compile the shaders.  A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would be nice."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1555503833, "post_id": 55724301, "comment_id": 98133695, "body": "Note also that you appear to be mixing OpenGL related classes from both Qt5 and Qt4 which is probably a bad idea -- the Qt4 classes are largely deprecated/obsoleted.  Have a look at the <a href=\"https://doc.qt.io/qt-5/examples-widgets-opengl.html\" rel=\"nofollow noreferrer\">Qt5 examples</a>."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555520167, "post_id": 55724301, "comment_id": 98143781, "body": "I\u2019m running mojave latest version, updated it to be able to use something I didn\u2019t need. Well in my viewer It only supports one out of 13 \u201dmethods\u201d of OpenGL 3.3 and the further I go it\u2019s less and less. I have the same Mac as you. Maybe it was the update that changed everything? Also, its not my choice to do it like that. This is the code from the assignement skeleton. I just want it to compile and display the given image, so I can start with the assignement at hand.."}, {"owner": {"reputation": 1930, "user_id": 1890396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812a06bb3f81c24479cc1b65112723?s=128&d=identicon&r=PG", "display_name": "Hugh Fisher", "link": "https://stackoverflow.com/users/1890396/hugh-fisher"}, "edited": false, "score": 0, "creation_date": 1555541751, "post_id": 55724301, "comment_id": 98151945, "body": "MacOS 10.8 supports OpenGL 3, MacOS 10.10 and up are OpenGL 4. I&#39;ve written shaders with #version 330 core on MacOS 10.8 that compiled without any errors. Your program asks for a Core Profile, so you&#39;ll get a version 3 or 4 context. Either should compile your shaders. So ... are you perhaps trying to compile these shaders <i>before</i> initializeGL? Until that method your code isn&#39;t guaranteed to have the GL context you asked for, it may instead be an old compatibility context"}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 1930, "user_id": 1890396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812a06bb3f81c24479cc1b65112723?s=128&d=identicon&r=PG", "display_name": "Hugh Fisher", "link": "https://stackoverflow.com/users/1890396/hugh-fisher"}, "edited": false, "score": 0, "creation_date": 1555580121, "post_id": 55724301, "comment_id": 98163223, "body": "@HughFisher Oh, that gives me hope of success after all. But i&#39;m not familiar enough with openGL to check for that. From what you&#39;re describing it doesn&#39;t look like that is the problem. Because when I changed the version to 2.1 I didn&#39;t get a version error anymore I only got syntax error since 2.1 don&#39;t have the methods that 3.3 have. How would I go about debugging this problem?"}, {"owner": {"reputation": 1930, "user_id": 1890396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812a06bb3f81c24479cc1b65112723?s=128&d=identicon&r=PG", "display_name": "Hugh Fisher", "link": "https://stackoverflow.com/users/1890396/hugh-fisher"}, "edited": false, "score": 0, "creation_date": 1555626304, "post_id": 55724301, "comment_id": 98185159, "body": "I didn&#39;t make myself clear. Until your glWidget::initializeGL() method runs, you are not guaranteed to have version 3/4 OpenGL. If you compile the shaders before initializeGL(), you would be using the application default GL context, which AFAIK is version 2.x compatibility on MacOS. Which seems to be what is happening here, since you say version 2.1 doesn&#39;t give the version error. So do all your OpenGL setup - shaders, textures, etc - from initializeGL(), not before"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555499262, "post_id": 55725864, "comment_id": 98130983, "body": "Why do I have to do that?"}, {"owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "reply_to_user": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555499329, "post_id": 55725864, "comment_id": 98131010, "body": "@ruubel Because it is not what the question title says"}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555584561, "post_id": 55725864, "comment_id": 98165593, "body": "Well, this is perfect for people looking for the same problem. Just have to follow my steps and come to the same conclusion. Am I wrong?"}, {"owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "reply_to_user": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1555587503, "post_id": 55725864, "comment_id": 98167170, "body": "@ruubel Do as you wish ... I wonder if you will get any other answer"}], "tags": [], "owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "is_accepted": false, "score": 2, "last_activity_date": 1555590413, "last_edit_date": 1555590413, "creation_date": 1555498328, "answer_id": 55725864, "question_id": 55724301, "link": "https://stackoverflow.com/questions/55724301/using-opengl-on-mac-version-150-is-not-supported-error/55725864#55725864", "title": "Using openGL on mac, version &#39;150&#39; is not supported error", "body": "<p>Copied from the question above:</p>\n\n<blockquote>\n  <p>After a lot of research, I have concluded that first and foremost I\n  have to use openGL v: 3.3 for the shaders to work. Which my \"OpenGl\n  Extensions Viewer\" says my mac does not support, i'm still wondering\n  if there is a loophole I can exploit. So any information about how or\n  if it's possible to do, would help.</p>\n</blockquote>\n\n<p>So the initial question is answered, and the second part regarding the \"loophole\" should be asked as a separate question (relating to this question).</p>\n\n<p><strong>Update</strong>:</p>\n\n<blockquote>\n  <p>LAST EDIT:</p>\n  \n  <p>I found the solution, you have to pass the QGLFormat to QGLWidget as a\n  constructor parameter. Found some of the solution here:</p>\n  \n  <p>Qt5 OpenGL GLSL version error</p>\n  \n  <p>Thank you for all the help!</p>\n</blockquote>\n"}], "owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555590413, "creation_date": 1555493323, "last_edit_date": 1592644375, "question_id": 55724301, "link": "https://stackoverflow.com/questions/55724301/using-opengl-on-mac-version-150-is-not-supported-error", "title": "Using openGL on mac, version &#39;150&#39; is not supported error", "body": "<p>I'm trying to setup my assignment from school, but the only guidance is for windows. We're using Qt to for the shaders, and I'm working through visual studio code and compiling with terminal. Problem is it seems that what ever version of openGL I try end up with the same error:</p>\n<pre><code>*QOpenGLShader::compile(Vertex): ERROR: 0:1: '' :  version '150' is not supported* \n</code></pre>\n<p>I'm using a macbook mid 12, and as it seems I'm using version 4.1 of openGL, I've tried multiple versions like 3.3, 2.1 4.1 and so on. Nothing seems to do the trick. I have also tried to override the version but that doesn't work. Am I looking at the problem the wrong way?</p>\n<h1>This is the source code that is causing the error:</h1>\n<pre><code>#version 150 core &lt;----\n\n// input from application\nuniform vec3 vecLight;\nuniform sampler2D samTexture;\n\n// input from geometry shader\nsmooth in vec3 normal;\nsmooth in vec3 vertex;\nsmooth in vec3 cartescoord;\n\n// material constants\nfloat ka = 0.1;\nfloat kd = 0.6;\nfloat ks = 0.3;\nfloat spec_exp = 50.0;\n\n// useful constants\nfloat PI = 3.14159265;\n\n// output color\n        out vec4 outFragColor;\n\n        vec2 cartesian2normspherical(vec3 cart)\n{\n    float fPhi = 0.0;\n    float fTheta = 0.0;\n\n    float fRadius = length(cart);\n    fTheta = acos (cart.z / fRadius) / (PI);\n    fPhi = atan(cart.y, cart.x)/ (PI);\n\n    //transform phi from [-1,1] to [0,1]\n    fPhi = (fPhi+1.0)/2.0;\n\n    return vec2(fPhi, fTheta);\n}\n\nfloat calcPhongBlinn(vec3 vecV, vec3 vecN, vec3 vecL)\n{\n    float fLightingIntesity = 1.0;\n\n    float fDiffuseIntensity = clamp(dot(normal, vecLight), 0, 1);\n\n    vec3 vecHalfway = normalize(vecL + vecV);\n    float fSpecularIntensity = pow(clamp(dot(vecHalfway, vecN), 0, 1), spec_exp);\n\n    fLightingIntesity = ka + kd*fDiffuseIntensity + ks*fSpecularIntensity;\n\n    return fLightingIntesity;\n}\n\nvoid main(void)\n{\n    \n    vec2 sphCoord = cartesian2normspherical(cartescoord);\n    vec2 texcoord = sphCoord.xy;\n\n    // this vector is constant since we assume that we look orthogonally at the computer screen\n    vec3 vecView = vec3(0.0, 0.0, 1.0);\n    float fI = calcPhongBlinn(vecView, normal, vecLight);\n    \n    vec4 vecColor =  texture2D(samTexture, texcoord.xy);\n\n    outFragColor = vec4(vecColor.rgb*fI, 1.0);\n}\n</code></pre>\n<h1>This is the extensive error:</h1>\n<pre><code>QOpenGLShader::compile(Vertex): ERROR: 0:1: '' :  version '150' is not supported\n\n*** Problematic Vertex shader source code ***\n\nQOpenGLShader: could not create shader\nQOpenGLShader::link: ERROR: One or more attached shaders not successfully compiled\n\n</code></pre>\n<p>With my script file running:\n<em>make &amp;&amp; ./myMain.app/Contents/MacOS/myMain</em></p>\n<h1>EDIT1: Adding my window file to the question</h1>\n<pre><code>Window::Window()\n{\n    QGridLayout *mainLayout = new QGridLayout;\n\n\n    QGLFormat glFormat;\n    glFormat.setVersion(3, 3);\n    glFormat.setProfile(QGLFormat::CoreProfile); \n    glFormat.setSampleBuffers(true);\n\n    GLWidget *glWidget = new GLWidget(/*glFormat,0*/);\n    mainLayout-&gt;addWidget(glWidget, 0, 0);\n    \n    setLayout(mainLayout);\n\n    setWindowTitle(tr(&quot;Rendering with OpenGL&quot;));\n}\n</code></pre>\n<h1>EDIT2:</h1>\n<p>After a lot of research, I have concluded that first and foremost I have to use openGL v: 3.3 for the shaders to work. Which my &quot;OpenGl Extensions Viewer&quot; says my mac does not support, i'm still wondering if there is a loophole I can exploit. So any information about how or if it's possible to do, would help.</p>\n<h1>LAST EDIT:</h1>\n<p>I found the solution, you have to pass the QGLFormat to QGLWidget as a constructor parameter. Found some of the solution here:</p>\n<p><a href=\"https://stackoverflow.com/questions/17390970/qt5-opengl-glsl-version-error?fbclid=IwAR3FuY9ZGkce1rFBBIJ2SRcXe1JGzciHprHYcGGzg4wPNBbkcxCNcO2l26A\">Qt5 OpenGL GLSL version error</a></p>\n<p>Thank you for all the help!</p>\n"}, {"tags": ["c++", "windows"], "comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1555493536, "post_id": 55724118, "comment_id": 98127623, "body": "How is the pointer not clear to you? The pointer is returned by <code>opendir</code>. Failure is apparently returning <code>nullptr</code>. You could always make a new ref variable as follows: <code>DIR &amp;refDir = *pDir;</code> after checking for <code>nullptr</code> of course. But using the pointer is perfectly valid."}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555493662, "post_id": 55724118, "comment_id": 98127699, "body": "Wait what exactly is the issue with the recursive iterator? Is it that it will list files you can&#39;t access, is that what you wish to avoid?"}, {"owner": {"reputation": 567, "user_id": 11161500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ntb4T.png?s=128&g=1", "display_name": "karl-police", "link": "https://stackoverflow.com/users/11161500/karl-police"}, "edited": false, "score": 0, "creation_date": 1555493749, "post_id": 55724118, "comment_id": 98127734, "body": "All I know from the pointer is that there are stuff like &amp; and *. * turns something into a memory address that is pointed to DIR, apperantly. And yeah..."}, {"owner": {"reputation": 567, "user_id": 11161500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ntb4T.png?s=128&g=1", "display_name": "karl-police", "link": "https://stackoverflow.com/users/11161500/karl-police"}, "reply_to_user": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555493896, "post_id": 55724118, "comment_id": 98127818, "body": "@Qubit I want to avoid that it accesses folders and files I can&#39;t access. Also, what opendir does that filesystem doesn&#39;t do is, that it doesn put a \\ behind each directory, I guess that&#39;s the open thing. Also, my method with listing everything and pushing it into an vector array, takes too long, while the other program steps a head to the next step. What I&#39;ve noticed is, if the program doesn&#39;t notices a &quot;.&quot;, in the folder or whatever name, it will push it inside the file array, and well, for everything else it tries to put a \\ behind it.... to see if that works?"}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555494030, "post_id": 55724118, "comment_id": 98127905, "body": "Well you could always write something similar yourself using the filesystem library. I suppose you avoid using the recursive iterator directly and instead use the regular one. Then you check each file, if it is a directory, you call your function recursively, much like in your example above. While doing so, you can also check for permissions, so if you don&#39;t have permission, simply skip. Although I would imagine that worked by default unless you run your code as the administrator of the system."}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555494167, "post_id": 55724118, "comment_id": 98127974, "body": "After looking at the reference a bit, you might be interested in trying <code>directory_options</code>: <a href=\"https://en.cppreference.com/w/cpp/experimental/fs/directory_options\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/experimental/fs/directory_options</a>"}, {"owner": {"reputation": 567, "user_id": 11161500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ntb4T.png?s=128&g=1", "display_name": "karl-police", "link": "https://stackoverflow.com/users/11161500/karl-police"}, "reply_to_user": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555494307, "post_id": 55724118, "comment_id": 98128076, "body": "@Qubit The original program when run as administrator, searching through C:\\ well, basically only SYSTEM can access it. I don&#39;t want my program to search the content of files like pagefile.sys... I mean... does it really have to open the file silently to search through it? The other thing the program does is using an external library called mman, which is for file mapping"}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555494443, "post_id": 55724118, "comment_id": 98128181, "body": "Well if you run something as administrator it will always have access to everything, that&#39;s sort of the point. Although Windows does seem to forget that every now and then."}, {"owner": {"reputation": 567, "user_id": 11161500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ntb4T.png?s=128&g=1", "display_name": "karl-police", "link": "https://stackoverflow.com/users/11161500/karl-police"}, "edited": false, "score": 0, "creation_date": 1555494698, "post_id": 55724118, "comment_id": 98128343, "body": "I&#39;m new into cpp, and from other programming languages, there is a lot of stuff I&#39;ve never seen before, currently trying to figure out what directory_options is, I&#39;ve seen I can use options() next to the construction of the function but I haven&#39;t really figured out, only that it is an observer."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1555499407, "post_id": 55724118, "comment_id": 98131052, "body": "I recommend reading <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">a few good books</a>"}, {"owner": {"reputation": 567, "user_id": 11161500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ntb4T.png?s=128&g=1", "display_name": "karl-police", "link": "https://stackoverflow.com/users/11161500/karl-police"}, "reply_to_user": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1555503514, "post_id": 55724118, "comment_id": 98133496, "body": "@Qubit you know how to use it?"}], "owner": {"reputation": 567, "user_id": 11161500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ntb4T.png?s=128&g=1", "display_name": "karl-police", "link": "https://stackoverflow.com/users/11161500/karl-police"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559203393, "creation_date": 1555492776, "last_edit_date": 1559203393, "question_id": 55724118, "link": "https://stackoverflow.com/questions/55724118/how-can-i-open-directories-using-a-similar-function-like-opendir-but-using-the", "title": "How can I open directories using a similar function like opendir, but using the filesystem library?", "body": "<p>How can I list directories using a similar function like opendir, but using the filesystem library from C++?</p>\n\n<p>The opendir function from dirent, opens the directory but we can't see it, which is okay.</p>\n\n<pre><code>for (const auto &amp; entry : fs::recursive_directory_iterator(dir))\n</code></pre>\n\n<p>Basically, this is the code I use to loop through the directories. fs is the filesystem.</p>\n\n<p>&nbsp;</p>\n\n<p>Now, the opendir actually opens the directory silently. Now if it doesn't have enough permissions, it can't open the directory and it will return,\nNo such directory. (I didn't write this function myself)</p>\n\n<pre><code>void SearchFiles(std::string Directory)\n{\n    DIR* pDir;\n\n    if((pDir = opendir(Directory.c_str())) != NULL)\n    {\n        struct dirent* pEntry;\n\n        /* print all the files and directories within directory */\n        while((pEntry = readdir(pDir)) != NULL)\n        {\n            if(pEntry-&gt;d_type == DT_DIR)\n            {\n                std::string Name = pEntry-&gt;d_name;\n\n                if(Name != \".\" &amp;&amp; Name != \"..\")\n                    SearchFiles(Directory + Name + '\\\\');\n            }\n            else if(pEntry-&gt;d_type == DT_REG)\n            {\n                g_vFiles.push_back(Directory + pEntry-&gt;d_name);\n            }\n        }\n\n        closedir(pDir);\n    }\n    else\n    {\n        printf(\"No such directory: '%s'\\n\", Directory.c_str());\n    }\n}\n</code></pre>\n\n<p>Now, I don't understand the code above a lot, but yeah...</p>\n\n<p>&nbsp;</p>\n\n<p>Not sure how new the filesystem library is, but does it have a function or something so I can make that what it does above?</p>\n\n<p>Because when using my method with the filesystem code above, it lists everything even those that I do not have permissions to, I guess.</p>\n\n<p>&nbsp;</p>\n\n<p>Incase that doesn't exist without using the dirent.h one. Do I really have to use the * to do the pDir thing? Can't I just write DIR pDir, because the pointer thing is kinda not really clear to me.</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 9396140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8369da70180e6c9a15fdacafe569e0e3?s=128&d=identicon&r=PG&f=1", "display_name": "G. Chouchani", "link": "https://stackoverflow.com/users/9396140/g-chouchani"}, "edited": false, "score": 0, "creation_date": 1555492943, "post_id": 55724148, "comment_id": 98127266, "body": "Silly mistake that I could not see for an hour! Thank you so much"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 48, "user_id": 9396140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8369da70180e6c9a15fdacafe569e0e3?s=128&d=identicon&r=PG&f=1", "display_name": "G. Chouchani", "link": "https://stackoverflow.com/users/9396140/g-chouchani"}, "edited": false, "score": 2, "creation_date": 1555493046, "post_id": 55724148, "comment_id": 98127314, "body": "@G.Chouchani IMHO, there should be a warning for such cases in modern C++ compilers. You might have a look how to activate it. (For <code>g++</code> <code>-Wall</code> is probably worth.)"}, {"owner": {"reputation": 48, "user_id": 9396140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8369da70180e6c9a15fdacafe569e0e3?s=128&d=identicon&r=PG&f=1", "display_name": "G. Chouchani", "link": "https://stackoverflow.com/users/9396140/g-chouchani"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1555494467, "post_id": 55724148, "comment_id": 98128199, "body": "@Scheff One more question please , in the function print_map to print the battleship, I am not able to print the x coordinates 0 1 2 3 4 above the map."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 48, "user_id": 9396140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8369da70180e6c9a15fdacafe569e0e3?s=128&d=identicon&r=PG&f=1", "display_name": "G. Chouchani", "link": "https://stackoverflow.com/users/9396140/g-chouchani"}, "edited": false, "score": 0, "creation_date": 1555495232, "post_id": 55724148, "comment_id": 98128692, "body": "@G.Chouchani The outer loop (<code>i</code>) is for rows (y-direction). The inner loop (<code>j</code>) is for columns (x-direction). You already have &quot;prefixed&quot; the printing of columns by output of current <code>i</code>. So, the solution is IMHO obvious: You need another loop to print column indices (the x-coordinates) above your outer loop."}], "tags": [], "owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "is_accepted": true, "score": 1, "last_activity_date": 1555493194, "last_edit_date": 1555493194, "creation_date": 1555492853, "answer_id": 55724148, "question_id": 55724000, "link": "https://stackoverflow.com/questions/55724000/multidimensional-array-not-changing-elements-from-function-for-some-reason/55724148#55724148", "title": "Multidimensional array not changing elements from function for some reason", "body": "<p>In your function <code>player_attack</code> you use wrong operator:</p>\n\n<pre><code>if (pc_board[y][x] == \"O\") {\n    cout &lt;&lt; \"HIT!\" &lt;&lt; endl;\n    pc_board[y][x] == \"H\";  // here\n}\nelse {\n    cout &lt;&lt; \"Miss.\" &lt;&lt; endl;\n    pc_board[y][x] == \"M\";  // and here\n}\n</code></pre>\n\n<p>instead of <code>==</code> that is a comparison operator you should use <code>=</code> that is the assignment operator.</p>\n\n<p>Using <code>operator ==</code> in this context is still valid C++ syntax, which produces a boolean value, however it does not modify the arguments (which are left and right side of comparison), which is probably what you want to do in most cases. Enabling compiler flags like <code>-Wall</code> or <code>Wextra</code> along with <code>Werror</code> helps to avoid this kind of bugs.</p>\n"}], "owner": {"reputation": 48, "user_id": 9396140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8369da70180e6c9a15fdacafe569e0e3?s=128&d=identicon&r=PG&f=1", "display_name": "G. Chouchani", "link": "https://stackoverflow.com/users/9396140/g-chouchani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55724148, "answer_count": 1, "score": -1, "last_activity_date": 1555493194, "creation_date": 1555492450, "question_id": 55724000, "link": "https://stackoverflow.com/questions/55724000/multidimensional-array-not-changing-elements-from-function-for-some-reason", "title": "Multidimensional array not changing elements from function for some reason", "body": "<p>The function player_attack() changes the elements of the multi-dimensional  array pc_board but when i reprint it in main, the array prints unchanged.\nI removed all unnecessary code.</p>\n\n<p>I tried to pass is at as a parameter to the function but i got an error for using a multidimensional array in the parameter.</p>\n\n<p>$</p>\n\n<pre><code>bool game_won = false;\nstring board[5][5];\nstring pc_board[5][5];\n\nvoid initialize_player_board() {\n    for (int i = 0; i &lt; 5; i++) {\n        for (int j = 0; j &lt; 5; j++) {\n            board[i][j] = \"-\";\n        }\n    }\n}\n\nvoid print_map() {\n\n    for (int i = 0; i &lt; 5; i++) {\n        cout &lt;&lt; setw(5);\n        cout &lt;&lt; i &lt;&lt; setw(5);\n        for (int j = 0; j &lt; 5; j++) {\n            cout &lt;&lt; board[i][j] &lt;&lt; setw(5);\n        }\n        cout &lt;&lt; setw(10);\n        for (int j = 0; j &lt; 5; j++) {\n            cout &lt;&lt; pc_board[i][j] &lt;&lt; setw(5);\n        }\n        cout &lt;&lt; endl;\n    }\n}\n\n\nvoid pc_add_battleship() {\n    int x = 0;\n    int y = 0;\n    int choice_generator = 0;\n    char choice;\n    x = rand() % 4 + 1;\n    y = rand() % 4 + 1;\n    choice_generator = rand() % 2;\n    if (choice_generator == 0) {\n        choice = 'h';\n    }\n    else {\n        choice = 'v';\n    }\n    if (choice == 'h') {\n        pc_board[y - 1][x] = 'O';\n        pc_board[y][x] = 'O';\n        pc_board[y + 1][x] = 'O';\n    }\n    if (choice == 'v') {\n        pc_board[y][x - 1] = 'O';\n        pc_board[y][x] = 'O';\n        pc_board[y][x + 1] = 'O';\n    }\n\n}\n\nvoid player_attack() {\n    int x = 0; \n    int y = 0;\n    cout &lt;&lt; \"Choose an x coordinate to attack: \" &lt;&lt; endl;\n    cin &gt;&gt; x;\n    cout &lt;&lt; \"Choose a y coordinate to attack: \" &lt;&lt; endl;\n    cin &gt;&gt; y;\n    if (pc_board[y][x] == \"O\") {\n        cout &lt;&lt; \"HIT!\" &lt;&lt; endl;\n        pc_board[y][x] == \"H\";\n    }\n    else {\n        cout &lt;&lt; \"Miss.\" &lt;&lt; endl;\n        pc_board[y][x] == \"M\";\n    }\n}\n\n\nint main()\n{\n    srand(time(0));\n    initialize_player_board();\n    initialize_pc_board();\n    cout &lt;&lt; \"Welcome to the battleship game.\" &lt;&lt; endl;\n    print_map();\n    Add_battleship();\n    pc_add_battleship();\n    while (!game_won) {\n        print_map();\n        player_attack();\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>$</p>\n\n<p>I expected for the multidimensional array to change its elements due to the function</p>\n"}, {"tags": ["c++", "double", "mingw32", "divide"], "comments": [{"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 6, "creation_date": 1555492592, "post_id": 55723929, "comment_id": 98127076, "body": "Unless you give us a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, and mention the compiler and version, we have no way of verifying this."}, {"owner": {"reputation": 35, "user_id": 10972181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wOuaVCeeMP0/AAAAAAAAAAI/AAAAAAAAABw/GiIoXt_KaoI/photo.jpg?sz=128", "display_name": "MasterBLB", "link": "https://stackoverflow.com/users/10972181/masterblb"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1555493178, "post_id": 55723929, "comment_id": 98127397, "body": "Added exact compiler version."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1555493816, "post_id": 55723929, "comment_id": 98127775, "body": "Are you sure it&#39;s actually 40.0? Not something slightly less? You know floating point is &quot;weird&quot;, yeah?"}, {"owner": {"reputation": 35, "user_id": 10972181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wOuaVCeeMP0/AAAAAAAAAAI/AAAAAAAAABw/GiIoXt_KaoI/photo.jpg?sz=128", "display_name": "MasterBLB", "link": "https://stackoverflow.com/users/10972181/masterblb"}, "edited": false, "score": 0, "creation_date": 1555494442, "post_id": 55723929, "comment_id": 98128179, "body": "I&#39;m sure as much as I can believe this output - <a href=\"http://i64.tinypic.com/1zmzdrb.png\" rel=\"nofollow noreferrer\">i64.tinypic.com/1zmzdrb.png</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1555494521, "post_id": 55723929, "comment_id": 98128230, "body": "Print your values with greater precision, and include <code>tonnageToRecover</code>."}, {"owner": {"reputation": 35, "user_id": 10972181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wOuaVCeeMP0/AAAAAAAAAAI/AAAAAAAAABw/GiIoXt_KaoI/photo.jpg?sz=128", "display_name": "MasterBLB", "link": "https://stackoverflow.com/users/10972181/masterblb"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1555496118, "post_id": 55723929, "comment_id": 98129199, "body": "@molbdnilo - done."}, {"owner": {"reputation": 35932, "user_id": 76722, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4baed26d9b00bbc7c0c706515aeb596e?s=128&d=identicon&r=PG", "display_name": "Sebastian Mach", "link": "https://stackoverflow.com/users/76722/sebastian-mach"}, "edited": false, "score": 0, "creation_date": 1555496655, "post_id": 55723929, "comment_id": 98129486, "body": "After an hour has passed: How about a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>? Why do you expect us to create one?"}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1555506363, "post_id": 55723929, "comment_id": 98135386, "body": "Your basic problem is truncating the answer. If real number arithmetic would result in 8, floating point arithmetic will give an answer very close to 8 in either direction. Truncating, rather than rounding, reduces an answer even a tiny bit less than 8 to 7. You need to work out changes to your logic to avoid truncation."}, {"owner": {"reputation": 35, "user_id": 10972181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wOuaVCeeMP0/AAAAAAAAAAI/AAAAAAAAABw/GiIoXt_KaoI/photo.jpg?sz=128", "display_name": "MasterBLB", "link": "https://stackoverflow.com/users/10972181/masterblb"}, "edited": false, "score": 0, "creation_date": 1555509916, "post_id": 55723929, "comment_id": 98137777, "body": "Well, I could understand rounding flaws, but damn, these are round numbers - 40 and 5. Not 39.(9), not 5.(0)1, but 40 and 5, so why division is not equal to 8??. Well, unless qDebug() is lying to me, that&#39;s it."}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1555522963, "post_id": 55723929, "comment_id": 98145059, "body": "@MasterBLB I don&#39;t know qDebug, but many debug utilities do lie, in the sense of rounding floating point numbers. A number very slightly less than 40 might be reported as 40."}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 6512586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e379acd016133b44c01fc8960199652?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6512586/julian"}, "is_accepted": false, "score": 0, "last_activity_date": 1555586329, "last_edit_date": 1555586329, "creation_date": 1555496828, "answer_id": 55725458, "question_id": 55723929, "link": "https://stackoverflow.com/questions/55723929/wrong-result-for-division-of-two-doubles-in-release-build/55725458#55725458", "title": "Wrong result for division of two doubles in release build", "body": "<p>I guess, the reason is that <code>armorPointsPerHalfTon / minimumArmorDelta</code> could be not 8 but actually 7.99999999 in the Release-version. This value then changes to 7 through the int-cast.</p>\n\n<p>So, if the Debug version calculates  <code>armorPointsPerHalfTon / minimumArmorDelta = 8.0000001</code>, the result is <code>static_cast&lt;int&gt;(armorPointsPerHalfTon / minimumArmorDelta) = 8</code>.</p>\n\n<p>It's not surprising that Debug / Release yield different results (on the order of machine precision), as several optimizations occur in the Release version.</p>\n\n<p>EDIT: If it suits your requirements, you could just use <code>std::round</code> to round your double to the nearest integer, rather than truncation decimals.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10972181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wOuaVCeeMP0/AAAAAAAAAAI/AAAAAAAAABw/GiIoXt_KaoI/photo.jpg?sz=128", "display_name": "MasterBLB", "link": "https://stackoverflow.com/users/10972181/masterblb"}, "is_accepted": false, "score": 0, "last_activity_date": 1555499102, "last_edit_date": 1555499102, "creation_date": 1555498140, "answer_id": 55725802, "question_id": 55723929, "link": "https://stackoverflow.com/questions/55723929/wrong-result-for-division-of-two-doubles-in-release-build/55725802#55725802", "title": "Wrong result for division of two doubles in release build", "body": "<p>@Julian\nI suspect that too, but how can I overcome this obstacle? Will try to change steps to double, then cast to int again.\nRESUT: still does not work :/</p>\n\n<p>I found a solution, but I have no idea exactly why it works now. Current code it:</p>\n\n<pre><code>    double armorPointsPerHalfTon = tonnageToRecover / tonnagePerArmorPoint;\n//    int aPHT = (int)armorPointsPerHalfTon;\n//    double minDelta = 5.0;//static_cast&lt;double&gt;(minimumArmorDelta);\n    QString s(QString::number(abs(armorPointsPerHalfTon / minimumArmorDelta)));\n    int steps = abs(armorPointsPerHalfTon / minimumArmorDelta);\n\n#define myqDebug() qDebug() &lt;&lt; fixed &lt;&lt; qSetRealNumberPrecision(10)\n    myqDebug() &lt;&lt; \"tonnageToRecover = \" &lt;&lt; tonnageToRecover;\n    myqDebug() &lt;&lt; \"tonnagePerArmorPoint = \" &lt;&lt; tonnagePerArmorPoint;\n    myqDebug() &lt;&lt; \"armorPointsPerHalfTon = \" &lt;&lt; armorPointsPerHalfTon;\n    //myqDebug() &lt;&lt; \"aPHT = \" &lt;&lt; aPHT;//this was 39 in Release, 40 in Debug\n    myqDebug() &lt;&lt; \"steps initial = \" &lt;&lt; steps;\n    myqDebug() &lt;&lt; \"string version = \" &lt;&lt; s;\n    myqDebug() &lt;&lt; \"minimumArmorDelta = \" &lt;&lt; minimumArmorDelta;// &lt;&lt; \", minDelta = \" &lt;&lt; minDelta;\n#undef myqDebug\n</code></pre>\n\n<p>I suppose that creation of that QString s flushes something, and that's why calculation of steps is correct now. String has incorrect value \"7\", though.</p>\n"}, {"tags": [], "owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1555579136, "creation_date": 1555579136, "answer_id": 55742889, "question_id": 55723929, "link": "https://stackoverflow.com/questions/55723929/wrong-result-for-division-of-two-doubles-in-release-build/55742889#55742889", "title": "Wrong result for division of two doubles in release build", "body": "<p>Your basic problem is that you are truncating. </p>\n\n<p>Suppose real number arithmetic would give an answer of exactly 8. Floating point arithmetic will give an answer that is very close to 8, but can differ from it in either direction due to rounding error. If the floating point answer is slightly greater than 8, truncating will change it to 8. If it is even slightly less than 8, truncating will change it to 7.</p>\n\n<p>I suggest writing a new question on how to avoid the truncation, with discussion of why you are doing it.</p>\n"}], "owner": {"reputation": 35, "user_id": 10972181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wOuaVCeeMP0/AAAAAAAAAAI/AAAAAAAAABw/GiIoXt_KaoI/photo.jpg?sz=128", "display_name": "MasterBLB", "link": "https://stackoverflow.com/users/10972181/masterblb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1555586329, "creation_date": 1555492229, "last_edit_date": 1555495996, "question_id": 55723929, "link": "https://stackoverflow.com/questions/55723929/wrong-result-for-division-of-two-doubles-in-release-build", "title": "Wrong result for division of two doubles in release build", "body": "<p>When I compile my application in Release mode I get incorrect division result of 40.0 / 5 = 7.\nIn debug compilation it is correct, and result is 8</p>\n\n<p>I tried to cast to double, from double, to int, without abs() etc, but no luck. I know this must be related to weirdness of floating point math on computers, but I have no idea what exactly. I also logged the values on console, via the qDebugs() below the code - everything looks okay, except initial steps.</p>\n\n<pre><code>//somewhere in code\n   double tonnageToRecover = 0.5;//actually, its QDoubleSpinBox-&gt;value(), with 0.5 step set. Anyway, the value finally reduces to 0.5 every time\n   double tonnagePerArmorPoint = 0.0125;//taken from .json\n   int minimumArmorDelta = 5;//taken from .json\n...\n//palace where the calculations are preformed\n    double armorPointsPerHalfTon = tonnageToRecover / tonnagePerArmorPoint;    \n    int steps = abs(static_cast&lt;int&gt;(armorPointsPerHalfTon / minimumArmorDelta));\n    qDebug() &lt;&lt; \"armorPointsPerHalfTon = \" &lt;&lt; armorPointsPerHalfTon;\n    qDebug() &lt;&lt; \"tonnagePerArmorPoint = \" &lt;&lt; tonnagePerArmorPoint;\n    qDebug() &lt;&lt; \"steps initial = \" &lt;&lt; steps;\n    qDebug() &lt;&lt; \"minimumArmorDelta = \" &lt;&lt; minimumArmorDelta;\n</code></pre>\n\n<p>both 1st division parts are type double, tonnageToRecover = 0.5, tonnagePerArmorPoint = 0.0125, result is 40 which is OK\nminimumArmorDelta is int = 5</p>\n\n<p>So why 40/5 isn't 8??</p>\n\n<p>Compiler - MinGW 32 5.3.0, from Qt 5.11 pack</p>\n\n<p>Screenshots:\n<a href=\"https://i.stack.imgur.com/P8JWR.png\" rel=\"nofollow noreferrer\">Release</a>\n<a href=\"https://i.stack.imgur.com/DKZl2.png\" rel=\"nofollow noreferrer\">Debug</a></p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 14632, "user_id": 399908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/56ea829e87b7772e36a35782dde9fb94?s=128&d=identicon&r=PG", "display_name": "Martin Hennings", "link": "https://stackoverflow.com/users/399908/martin-hennings"}, "edited": false, "score": 1, "creation_date": 1555496617, "post_id": 55723887, "comment_id": 98129465, "body": "When does the text change and who initiates that? You could connect to the <code>QTableWidgetItem</code>&#39;s model signal <code>dataChanged(QModelIndex, QModelIndex)</code>"}, {"owner": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "edited": false, "score": 1, "creation_date": 1555496769, "post_id": 55723887, "comment_id": 98129561, "body": "I cannot find this signal in <a href=\"https://doc.qt.io/qt-5/qtablewidgetitem-members.html\" rel=\"nofollow noreferrer\"><code>QTableWidgetItem</code></a> list of members."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 10896120, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WnxPli9VoF8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYdVAEIpfc_jesh_vBJ4xeRU-U_fg/mo/photo.jpg?sz=128", "display_name": "Chief", "link": "https://stackoverflow.com/users/10896120/chief"}, "edited": false, "score": 0, "creation_date": 1555500425, "post_id": 55725078, "comment_id": 98131683, "body": "it worked well ! thanks, i have found also another way with the signal currentItemChanged(QTableWidgetItem*,QTableWidgetItem*). Both worked well for me"}], "tags": [], "owner": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "is_accepted": true, "score": 3, "last_activity_date": 1555496009, "last_edit_date": 1555496009, "creation_date": 1555495658, "answer_id": 55725078, "question_id": 55723887, "link": "https://stackoverflow.com/questions/55723887/qtablewidgetitem-text-changed/55725078#55725078", "title": "QTableWidgetItem text changed", "body": "<p>You can make your widget no to send signals using <a href=\"https://doc.qt.io/qt-5/qobject.html#blockSignals\" rel=\"nofollow noreferrer\"><code>QObject::blockSignals</code></a>. This way you can use the signal <code>QTableWidget::itemChanged(QTableWidgetItem* item)</code> connected to an slot that will first block the signals of the table, then change the item, and then unblock the signals. Here you have a minimum example:</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QTableWidget&gt;\n#include &lt;QTableWidgetItem&gt;\n\n// Declare table globaly so the slot can block its signals\nQTableWidget* table;\n\n// Slot\nvoid itemChanged(QTableWidgetItem* item)\n{\n  // Block table signals\n  table-&gt;blockSignals(true);\n\n  // Change item background color\n  item-&gt;setBackgroundColor(Qt::red);\n\n  // Append text\n  item-&gt;setText(item-&gt;text() + \" edited\");\n\n  // Unblock signals\n  table-&gt;blockSignals(false);\n}\n\nint main(int argc, char** argv)\n{\n  // Create application\n  QApplication app(argc, argv);\n\n  // Create table\n  table = new QTableWidget(3, 4);\n\n  // Add items\n  for (int i = 0; i &lt; table-&gt;rowCount() * table-&gt;columnCount(); i++)\n  {\n    int row = i / table-&gt;columnCount();\n    int col = i % table-&gt;columnCount();\n    table-&gt;setItem(row, col, new QTableWidgetItem(QString::number(i)));\n  }\n\n  // Connect\n  QObject::connect(table, &amp;QTableWidget::itemChanged, itemChanged);\n\n  // Show table\n  table-&gt;show();\n\n  // Run\n  return app.exec();\n}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 10896120, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WnxPli9VoF8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYdVAEIpfc_jesh_vBJ4xeRU-U_fg/mo/photo.jpg?sz=128", "display_name": "Chief", "link": "https://stackoverflow.com/users/10896120/chief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1939, "favorite_count": 0, "accepted_answer_id": 55725078, "answer_count": 1, "score": 3, "last_activity_date": 1555496009, "creation_date": 1555492111, "question_id": 55723887, "link": "https://stackoverflow.com/questions/55723887/qtablewidgetitem-text-changed", "title": "QTableWidgetItem text changed", "body": "<p>Im looking for a clean way to react on the event if a <code>QTableWidgetItem</code> has changed its text. I\u00b4ve tried to use the Signal <code>QTableWidget::itemChanged(QTableWidgetItem *item)</code> but this causes an error due to the fact that i change the backgroundcolor of the <code>QTableWidgetItem</code> in my slot and this slot is then executed recursivly, because the itemChanged.</p>\n\n<p>I've also tried to use the signal <code>QTableWidget::itemEntered(QTableWidgetItem *item)</code>but this is related to some mouse events which doesnt really work  for me. </p>\n\n<p>The last method I've tried is to override the eventfilter in my custom QTableWidget class like this:</p>\n\n<pre><code>    bool custom_DropTable::eventFilter(QObject *obj, QEvent *evt)\n{\n    if (evt-&gt;type() == QEvent::KeyPress)\n    {\n        QKeyEvent *keyEvent = static_cast&lt;QKeyEvent *&gt;(evt);\n        if (keyEvent-&gt;key() == Qt::Key_Return)\n        {\n            emit si_itemTextEntered(this-&gt;currentItem());\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n    else\n    {\n        return QObject::eventFilter(obj, evt);\n    }\n}\n</code></pre>\n\n<p>But the signal is never really arrived even if pressed enter so set the text.</p>\n\n<p>Has someone any suggestions or improvements for me? </p>\n"}, {"tags": ["c++", "llvm"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1555492883, "post_id": 55723882, "comment_id": 98127228, "body": "You need <code>getlelementptr</code> instruction with proper pointer type (<code>[123 x i8]*</code>)."}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1555493316, "post_id": 55723882, "comment_id": 98127487, "body": "Something like this ?: <code>Builder.CreateGEP(ArrayType::get(i8, 123), p.first, Vector&lt;Value *&gt;{ c32(0), c32(1) })</code> or this: <code>Builder.CreateGEP(PointerType::get(ArrayType::get(i8, 123),0), p.first, Vector&lt;Value *&gt;{ c32(0), c32(1) })</code> neither works"}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1555498612, "post_id": 55723882, "comment_id": 98130627, "body": "You can&#39;t add an int to a pointer because LLVM doesn&#39;t do implicit casts, generating the right casts is your job, and you decide most of what &quot;right&quot; means. Generally, life with LLVM is happier if types are first-class citizens in your code, ie. the type for <code>v</code> and the type you use to make your GEP are related in your code, not generated by mostly-independent calls to LLVM. I can&#39;t guess what &quot;neither works&quot; means, so I have no comment on that."}, {"owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "edited": false, "score": 0, "creation_date": 1555516032, "post_id": 55723882, "comment_id": 98141702, "body": "What I meant with &quot;neither works&quot; is that both commands that I wrote above generate a runtime error (which I can post if it&#39;ll help). So what you are saying is that I need to cast the type <code>i8**</code> to a matrix before calling <code>CreateGEP</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "is_accepted": true, "score": 0, "last_activity_date": 1555521020, "creation_date": 1555521020, "answer_id": 55732820, "question_id": 55723882, "link": "https://stackoverflow.com/questions/55723882/llvm-load-variable-from-pointer-with-offset/55732820#55732820", "title": "LLVM - Load variable from pointer with offset", "body": "<p>So I found the solution. If <code>v</code> is a array, <code>Builder.CreateGEP(v, Vector&lt;Value *&gt;{ c64(0), c64(5) })</code> loads correctly the 6th element of v. If v is a pointer to a matrix (i8**) then what worked for me was:\n<code>Builder.CreateGEP(Builder.CreateLoad(p.first), c64(5))</code>, which correctly loads the 6th element of the array which <code>v</code> points to.\n(function <code>c64()</code> creates a 64bit int constant)</p>\n"}], "owner": {"reputation": 13, "user_id": 11372773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcb5890fb37224613cd690a642624ca?s=128&d=identicon&r=PG&f=1", "display_name": "John Fikioris", "link": "https://stackoverflow.com/users/11372773/john-fikioris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 55732820, "answer_count": 1, "score": 0, "last_activity_date": 1555521020, "creation_date": 1555492091, "question_id": 55723882, "link": "https://stackoverflow.com/questions/55723882/llvm-load-variable-from-pointer-with-offset", "title": "LLVM - Load variable from pointer with offset", "body": "<p>I have a value, let's call it <code>v</code>, of <code>Type i8**</code> which points to the first element of an array. If I want to get the value that is the variable of first element of the array I can use <code>Builder.CreateLoad(v);</code>. If I want to get the second element of the array is there a command like the <code>CreateLoad()</code> one, but with an offset?</p>\n\n<p>I have tried adding an integer to <code>v</code>, but it hasn't worked (for some obvious reason i don't know). Also I have tried using <code>Builder.CreateGEP(v, Vector&lt;Value *&gt;{ c64(0), c64(1) });</code>, but it also doesn't work (<code>c64</code> creates a constant).</p>\n\n<p>Can you help?</p>\n"}, {"tags": ["c++", "qt", "c++11", "lambda", "signals-slots"], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "edited": false, "score": 0, "creation_date": 1555502740, "post_id": 55723976, "comment_id": 98133024, "body": "Thanks this solved my problem. But I needed to to [&amp;] in the capture as somehow those classpointers were unidentified for some reason! I have them in the private section of &quot;Class B&quot; so I guess they should be public to be available at that point!"}], "tags": [], "owner": {"reputation": 14632, "user_id": 399908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/56ea829e87b7772e36a35782dde9fb94?s=128&d=identicon&r=PG", "display_name": "Martin Hennings", "link": "https://stackoverflow.com/users/399908/martin-hennings"}, "is_accepted": true, "score": 6, "last_activity_date": 1555492742, "last_edit_date": 1555492742, "creation_date": 1555492395, "answer_id": 55723976, "question_id": 55723875, "link": "https://stackoverflow.com/questions/55723875/using-lambda-syntax-in-qt-signal-and-slot-and-accessing-passed-arguments/55723976#55723976", "title": "Using lambda syntax in Qt signal and slot and accessing passed arguments", "body": "<p>Your lambda should know both objects: <code>[pClassX, pClassC]</code> and accept the original parameters of the signal: <code>(voltage_range_e vr, current_range_e cr, uint16_t bits)</code>.</p>\n\n<p>So your connect should start like this:</p>\n\n<pre><code>connect(pClassA, &amp;ClassA::requestToChangeRange, this,\n    [pClassX, pClassC](voltage_range_e vr, current_range_e cr, uint16_t bits) {\n    //...\n});\n</code></pre>\n\n<p><em>About the 'receiver' in the connect() statement:</em></p>\n\n<p>This pointer to QObject is actually not needed when connecting to a lambda, but it serves the purpose that the signal-slot-connection will be removed if either sender or receiver gets destroyed.</p>\n\n<p>Using <code>this</code> means you have to make sure that after deleting either one of <code>pClassX</code>, <code>pClassC</code> you don't emit the signal anymore. Alternatively you could use <code>pClassC</code> as receiver, then you have to be sure that <code>pClassX</code> stays valid as long as <code>pClassC</code> and <code>pClassA</code> are alive... Ideally you'd specify <code>pClassX</code> AND <code>pClassC</code> as receivers, but that's not possible. You could utilize the guarding functionality of a <code>QPointer</code> for that.</p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 11405014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22caec28175e0f7e001a4eacad0593e9?s=128&d=identicon&r=PG", "display_name": "Allan Jensen", "link": "https://stackoverflow.com/users/11405014/allan-jensen"}, "is_accepted": false, "score": 1, "last_activity_date": 1556109585, "creation_date": 1556109585, "answer_id": 55830257, "question_id": 55723875, "link": "https://stackoverflow.com/questions/55723875/using-lambda-syntax-in-qt-signal-and-slot-and-accessing-passed-arguments/55830257#55830257", "title": "Using lambda syntax in Qt signal and slot and accessing passed arguments", "body": "<p>One trick worth mentioning in this context is that if you grap pointers to QObjects, I would recommend first creating QPointer variables, and grap THOSE in the lambda. That way you can check if they have been deleted. If you use normal signal and slots, this is taken care of, but with lambdas you might need to handle life-time yourself of references.</p>\n\n<p>Hopefully we will soon get more convinient C++ ways of capturing with constructed objects.</p>\n"}], "owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1859, "favorite_count": 0, "accepted_answer_id": 55723976, "answer_count": 2, "score": 4, "last_activity_date": 1556366585, "creation_date": 1555492083, "last_edit_date": 1556366585, "question_id": 55723875, "link": "https://stackoverflow.com/questions/55723875/using-lambda-syntax-in-qt-signal-and-slot-and-accessing-passed-arguments", "title": "Using lambda syntax in Qt signal and slot and accessing passed arguments", "body": "<p>I have a class that has a signal with this signature:</p>\n\n<pre><code>// CLASS A\nsignals:\n    void requestToChangeRange(voltage_range_e vr, current_range_e cr, uint16_t bits);\n</code></pre>\n\n<p>There is another class which has a slot like this (notice the extra parameter)</p>\n\n<pre><code>// CLASS C\npublic slots:\n    void handleRequestRangeChange(voltage_range_e vr, current_range_e cr, uint16_t bits, uint16_t limiter);\n</code></pre>\n\n<p>Then I have a class \"B\" which acts as a meeting point of all other classes. When the class \"A\" emits the signal, class \"C\" should redirect it into class \"B\". But that extra argument on the slot of class \"B\" is the problem, because that extra argument comes from another class \"X\".</p>\n\n<p>So if the signal and slots of classes \"A\" and \"C\" were matching I would do the following in class \"B\":</p>\n\n<pre><code>// somewhere in CLASS B (the manager of all other classes)\nconnect(pClassA, &amp;ClassA::requestToChangeRange,\n    pClassC, &amp;ClassC::handleRequestRangeChange);\n</code></pre>\n\n<p>But obviously this does not work because of function signatures. What I want to do is something like:</p>\n\n<pre><code>// somewhere in CLASS B (the manager of all other classes)\nconnect(pClassA, &amp;ClassA::requestToChangeRange,\nthis /* class B */, []() {\n    // Get that last required parameter from class X\n    uint16_t limiter = pClassX-&gt;getValue();\n    // Call slot of class C\n    pClassC-&gt;handleRequestRangeChange(vr, cr, bits, limiter);\n});\n</code></pre>\n\n<p>So how can I access those passed parameters inside the lambda? Is this even possible?</p>\n"}]