[{"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1516837412, "post_id": 48433473, "comment_id": 83858309, "body": "<code>typename WorkerType::ResultType StartWork() </code> will tell the compiler that <code>ResultType</code> should be assumed to be a <i>type</i>"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516837581, "post_id": 48433473, "comment_id": 83858350, "body": "I&#39;m not sure quite what you are looking for, but patterns similar to <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique\" rel=\"nofollow noreferrer\"><code>std::make_unique</code></a> may do what you want. Basically, if you want the <code>int</code> to be inferred by the <code>1</code> in <code>CustomTask(1);</code>, you could have the syntax be <code>auto CustomTask = make_task_runner&lt;CustomWorker&gt;(1)</code>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1516837759, "post_id": 48433473, "comment_id": 83858394, "body": "Unless I completely misunderstood your question, this seems like a non-issue."}, {"owner": {"reputation": 395, "user_id": 1136229, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/56df212c6ef8890d817a169ff26e0a39?s=128&d=identicon&r=PG", "display_name": "Jordan", "link": "https://stackoverflow.com/users/1136229/jordan"}, "edited": false, "score": 0, "creation_date": 1516838279, "post_id": 48433473, "comment_id": 83858558, "body": "Thanks Drew, that was the secret missing ingredient I was looking for!"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 1136229, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/56df212c6ef8890d817a169ff26e0a39?s=128&d=identicon&r=PG", "display_name": "Jordan", "link": "https://stackoverflow.com/users/1136229/jordan"}, "edited": false, "score": 0, "creation_date": 1516903922, "post_id": 48433539, "comment_id": 83891361, "body": "Thanks StoryTeller.  I didn&#39;t know auto could deduce return types in c++14. That&#39;s really cool. Drew Dormann&#39;s suggestion of using typename worked as well, as long as I exposed the referenced type in Worker with <code>using</code>. If anyone else looks at the decltype solution, I had some trouble getting that to compile until I realized that <code>Worker</code> needed to be declared before decltype is used."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1516837736, "creation_date": 1516837736, "answer_id": 48433539, "question_id": 48433473, "link": "https://stackoverflow.com/questions/48433473/how-to-access-a-template-type-of-a-templated-class-at-compile-time/48433539#48433539", "title": "How to access a template type of a templated class at compile time?", "body": "<p>If you want to declare <code>StartWork</code> as returning whatever <code>DoWork()</code> returns, then you have the options of just letting the implementation figure it out in C++14</p>\n\n<pre><code>auto StartWork() \n{\n    return Worker-&gt;DoWork();\n}\n</code></pre>\n\n<p>Or, specify it with <code>decltype</code> in C++11</p>\n\n<pre><code>auto StartWork() -&gt; decltype(Worker-&gt;DoWork())\n{\n    return Worker-&gt;DoWork();\n}\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 1136229, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/56df212c6ef8890d817a169ff26e0a39?s=128&d=identicon&r=PG", "display_name": "Jordan", "link": "https://stackoverflow.com/users/1136229/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48433539, "answer_count": 1, "score": 0, "last_activity_date": 1516837736, "creation_date": 1516837231, "question_id": 48433473, "link": "https://stackoverflow.com/questions/48433473/how-to-access-a-template-type-of-a-templated-class-at-compile-time", "title": "How to access a template type of a templated class at compile time?", "body": "<p>I'm trying to write a basic TaskRunner system.  A worker object does some work and returns a result. A task runner runs a worker object and returns the result of that worker.  Here's what I have right now (usual warnings apply: simplified example; this may not compile):</p>\n\n<p>Worker class:</p>\n\n<pre><code>template&lt;typename ResultType&gt;\nclass Worker\n{\npublic:\n    virtual ~Worker() = 0;\n    virtual ResultType DoWork() = 0;\n};\n</code></pre>\n\n<p>Runner class:</p>\n\n<pre><code>template&lt;typename ResultType, typename WorkerType&gt;\nclass TaskRunner\n{\npublic:\n    template&lt;typename... Args&gt;\n    TaskRunner( Args&amp;&amp;... args )\n    {\n        Worker = std::unique_ptr&lt;WorkerType&gt;(new WorkerType(std::forward&lt;Args&gt;(args)...));\n    }\n    ~TaskRunner() {}\n\n    ResultType StartWork() \n    {\n        return Worker-&gt;DoWork();\n    }\n\nprivate:\n    std::unique_ptr&lt;WorkerType&gt; Worker;\n};\n</code></pre>\n\n<p>I want to specialize each worker to return a concrete type:</p>\n\n<pre><code>class CustomWorker : public Worker&lt;int&gt;\n{\npublic:\n    CustomWorker(int InNumber) : Number(InNumber) {}\n    ~CustomWorker() {}\n    int DoWork() override { return Number; };\nprivate:\n    int Number;\n};\n</code></pre>\n\n<p>I have all this working, and can kick off the system with this call:</p>\n\n<pre><code>TaskRunner&lt;int, CustomWorker&gt; CustomTask(1);\n</code></pre>\n\n<p>The problem with this is that CustomWorker is tightly coupled with the return type of int.  This is the only combination of template types that will work for this task.  Each worker will have one, and only one return type.  Therefore, I would like to be able to call:</p>\n\n<pre><code>TaskRunner&lt;CustomWorker&gt; CustomTask(1);\n</code></pre>\n\n<p>But this seems to require knowing the templated type of CustomWorker in the definition of TaskRunner::StartWork.  </p>\n\n<p>Something like this...</p>\n\n<pre><code>template&lt;typename WorkerType&gt;\nclass TaskRunner\n{\npublic:\n    ...\n\n    WorkerType::ResultType StartWork() \n    {\n        ...\n    }\n    ...\n</code></pre>\n\n<p>Is there some templating syntax / constexpr magic that could help me achieve this?</p>\n"}, {"tags": ["c++", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1516837328, "post_id": 48433470, "comment_id": 83858287, "body": "Why do you declare an <code>Insert()</code> you never define?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1516837383, "post_id": 48433470, "comment_id": 83858300, "body": "Forward declaration of <code>void Insert(int x, Node* head);</code> does not match implementation of <code>void Insert(int x, Node** phead)</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516837572, "post_id": 48433470, "comment_id": 83858349, "body": "Unrelated: might as well remove <code>temp-&gt;next = NULL;</code> and always <code>temp-&gt;next = *phead;</code>. If <code>*phead</code> is NULL, it effectively does <code>temp-&gt;next = NULL;</code> for you. If not, you get what you want anyway."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516837846, "post_id": 48433470, "comment_id": 83858411, "body": "Also unrelated: Carrying the last comment through, if you add a <code>Node (int pdata, Node* pnext = NULL): data(pdata), next(pnext){}</code> constructor to <code>Node</code>, you can simplify <code>Insert</code> to <code>*phead = new Node(x, *phead);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1516837873, "post_id": 48433470, "comment_id": 83858421, "body": "OT: <code>typedef struct Node</code> is C."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1516839553, "post_id": 48433470, "comment_id": 83858961, "body": "@user4581301: No need to define a constructor, aggregate-initialization will work great."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516840302, "post_id": 48433470, "comment_id": 83859192, "body": "Good point. <code>Insert</code> now looks like <code>*phead = new Node{x, *phead};</code> and that&#39;s all you need to change."}], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "edited": false, "score": 0, "creation_date": 1516866538, "post_id": 48433485, "comment_id": 83866906, "body": "I never saw the header. G++ was pointing me to the function instead. Good catch, Thank you!"}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 3, "last_activity_date": 1516837316, "creation_date": 1516837316, "answer_id": 48433485, "question_id": 48433470, "link": "https://stackoverflow.com/questions/48433470/pointer-dereferencing-cannot-convert-node-to-node/48433485#48433485", "title": "Pointer Dereferencing: cannot convert \u2018Node**\u2019 to \u2018Node*\u2019", "body": "<p>Your function prototype doesn't match the definition.</p>\n\n<pre><code>void Insert(int x, Node* head);\nvoid Insert(int x, Node** phead)\n{\n</code></pre>\n"}], "owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "closed_date": 1516869441, "accepted_answer_id": 48433485, "answer_count": 1, "score": -1, "last_activity_date": 1516837316, "creation_date": 1516837213, "question_id": 48433470, "link": "https://stackoverflow.com/questions/48433470/pointer-dereferencing-cannot-convert-node-to-node", "closed_reason": "Not suitable for this site", "title": "Pointer Dereferencing: cannot convert \u2018Node**\u2019 to \u2018Node*\u2019", "body": "<p>I'm writing a code to insert an element, using call by reference. \nI cant figure out what this mess with pointers is. Please guide me as to whats wrong in my implementation. </p>\n\n<p>My problem here is clearly conceptual so I'd appreciate if the explanation behind the answer is given, than the answer itself. </p>\n\n<pre><code>#include &lt;iostream&gt;\n// Insert an element in a Single Linked List\nusing namespace std;\n\ntypedef struct Node {\n    int data;\n    Node* next;\n} Node;\n\nvoid Insert(int x, Node* head);\nint main()\n{\n    int n, x;\n    cout&lt;&lt;\"How many elements?\\n\";\n    cin&gt;&gt;n;\n    Node* head = NULL;\n    for(int i=0; i&lt;n; i++)\n    {\n        cout&lt;&lt;\"Insert Number\\n\";\n        cin&gt;&gt;x;\n        Insert(x, &amp;head);\n    }\n    Print(head);\n    return 0;\n}\nvoid Insert(int x, Node** phead) // Insert at the beginning\n{\n    Node* temp = new Node();\n    temp-&gt;data = x; // (*temp).data = x\n    temp-&gt;next = NULL;\n    if (*phead != NULL) temp-&gt;next = *phead;\n    *phead = temp;\n}\n</code></pre>\n\n<p>The full error is:</p>\n\n<pre><code>error: cannot convert \u2018Node**\u2019 to \u2018Node*\u2019 for argument \u20182\u2019 to \u2018void Insert(int, Node*)\u2019\n   Insert(x, &amp;head);\n</code></pre>\n"}, {"tags": ["c++", "valgrind"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516837095, "post_id": 48433349, "comment_id": 83858229, "body": "Based on the results, it looks like your <code>memcpy()</code> implementation acts like <code>memmove()</code>."}, {"owner": {"reputation": 691, "user_id": 1291457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c2de53b1653add71f472e35a12b856c?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/1291457/charles"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516873314, "post_id": 48433349, "comment_id": 83870617, "body": "It does, I suppose another way to phrase my question is why, given that there is a call to memcpy() in the assembly, and that Valgrind intercepts such functions to check for errors, are none thrown here, when the dst and src arguments overlap?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516910651, "post_id": 48433349, "comment_id": 83894893, "body": "Very strange, it definitely seems like this should be detected. I was going to ask if you have <code>Overlap</code> suppression enabled. But I see that it says &quot;suppressed: 0&quot;. But just to be sure, try running with <code>-v</code> to see details of suppressions."}, {"owner": {"reputation": 691, "user_id": 1291457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c2de53b1653add71f472e35a12b856c?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/1291457/charles"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516917073, "post_id": 48433349, "comment_id": 83898112, "body": "@Barmar, thank you for that suggestion, I have no suppressions, but after reading the verbose log, I do see an optimized call to memcpy being <code>REDIR</code>&#39;d (I assume &quot;redirected&quot;) to a call to <code>memmove</code>. I have updated my question with this new information."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1516917310, "post_id": 48433349, "comment_id": 83898212, "body": "valgrind detects problems that actually happened on that run,  it doesn&#39;t detect code that is UB but happened to work correctly"}, {"owner": {"reputation": 691, "user_id": 1291457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c2de53b1653add71f472e35a12b856c?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/1291457/charles"}, "edited": false, "score": 0, "creation_date": 1516917447, "post_id": 48433349, "comment_id": 83898266, "body": "The advertised abilities of the memcheck tool: <a href=\"http://valgrind.org/docs/manual/mc-manual.html\" rel=\"nofollow noreferrer\">valgrind.org/docs/manual/mc-manual.html</a> -- explicitly it says &quot;Overlapping src and dst pointers in memcpy and related functions.&quot; -- how could this test case be anymore obvious of an instance where overlapping memory regions are being used in memcpy?"}, {"owner": {"reputation": 691, "user_id": 1291457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c2de53b1653add71f472e35a12b856c?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/1291457/charles"}, "edited": false, "score": 0, "creation_date": 1516918754, "post_id": 48433349, "comment_id": 83898728, "body": "OK; so in a callgrind there appears to be a thing called <code>dl-trampoline.h</code> that has functions like <code>_dl_runtime_resolve_avx_slow</code> just before the call to memcpy. I&#39;ve no idea yet, but I&#39;m guessing logic exists in the dynamic loader to patch out syscalls like this based on some kind of heuristics??"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516919433, "post_id": 48433349, "comment_id": 83899004, "body": "FYI, there&#39;s a <code>valgrind-users</code> mailing list. See <a href=\"http://valgrind.org/support/mailing_lists.html\" rel=\"nofollow noreferrer\">valgrind.org/support/mailing_lists.html</a>"}, {"owner": {"reputation": 691, "user_id": 1291457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c2de53b1653add71f472e35a12b856c?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/1291457/charles"}, "edited": false, "score": 0, "creation_date": 1516920790, "post_id": 48433349, "comment_id": 83899493, "body": "OK; I will take it there, I hate mailing lists so try to resolve without needing to register them :)"}], "owner": {"reputation": 691, "user_id": 1291457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c2de53b1653add71f472e35a12b856c?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/1291457/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516917024, "creation_date": 1516836384, "last_edit_date": 1516917024, "question_id": 48433349, "link": "https://stackoverflow.com/questions/48433349/valgrind-not-detecting-overlapping-memcpy", "title": "Valgrind not detecting overlapping memcpy?", "body": "<p>I have this function which I believe has overlapping memory. Since I'm writing ahead of where I'll be reading from, it seems the <code>memcpy</code> is going to go into undefined behavior </p>\n\n<pre><code>void overlappingMemcpy() {\n    int* data = new int[20];\n    iota(data, data + 20, 1);\n    printIntData(data, 20);\n    memcpy(data+1, data, 19*sizeof(int));\n    printIntData(data, 20);\n    delete[] data;\n}\n</code></pre>\n\n<p>But when it is run with Valgrind, I see no errors,</p>\n\n<pre><code>&gt; valgrind --tool=memcheck  ./ValgrindExamples \n==81068== Memcheck, a memory error detector\n==81068== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==81068== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==81068== Command: ./ValgrindExamples\n==81068== \nHello World!\nint data for memory at 0x5b210c0of size 20\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \nint data for memory at 0x5b210c0of size 20\n1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \n==81068== \n==81068== HEAP SUMMARY:\n==81068==     in use at exit: 0 bytes in 0 blocks\n==81068==   total heap usage: 3 allocs, 3 frees, 73,808 bytes allocated\n==81068== \n==81068== All heap blocks were freed -- no leaks are possible\n==81068== \n==81068== For counts of detected and suppressed errors, rerun with: -v\n==81068== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>I'm compiling with <code>-O0 -g -fno-inlines -std=c++14</code>. The assembly shows a call to memcpy, indicating the compiler hasn't inlined it, so I'm completely lost why this isn't getting triggered. Full assembly generated of the above method,</p>\n\n<pre><code>        128 [1] void overlappingMemcpy() {\n0x401320                   55                                            push   %rbp\n0x401321  &lt;+0x0001&gt;        48 89 e5                                      mov    %rsp,%rbp\n0x401324  &lt;+0x0004&gt;        48 83 ec 20                                   sub    $0x20,%rsp\n0x401328  &lt;+0x0008&gt;        b8 50 00 00 00                                mov    $0x50,%eax\n0x40132d  &lt;+0x000d&gt;        89 c7                                         mov    %eax,%edi\n        129 [1]     int* data = new int[20];\n0x40132f  &lt;+0x000f&gt;        e8 dc f9 ff ff                                callq  0x400d10 &lt;_Znam@plt&gt;\n0x401334  &lt;+0x0014&gt;        ba 01 00 00 00                                mov    $0x1,%edx\n0x401339  &lt;+0x0019&gt;        48 89 45 f8                                   mov    %rax,-0x8(%rbp)\n        130 [1]     iota(data, data + 20, 1);\n0x40133d  &lt;+0x001d&gt;        48 8b 7d f8                                   mov    -0x8(%rbp),%rdi\n0x401341  &lt;+0x0021&gt;        48 8b 45 f8                                   mov    -0x8(%rbp),%rax\n0x401345  &lt;+0x0025&gt;        48 83 c0 50                                   add    $0x50,%rax\n0x401349  &lt;+0x0029&gt;        48 89 c6                                      mov    %rax,%rsi\n0x40134c  &lt;+0x002c&gt;        e8 cf 00 00 00                                callq  0x401420 &lt;std::iota&lt;int*, int&gt;(int*, int*, int)&gt;\n0x401351  &lt;+0x0031&gt;        ba 14 00 00 00                                mov    $0x14,%edx\n0x401356  &lt;+0x0036&gt;        89 d6                                         mov    %edx,%esi\n        131 [1]     printIntData(data, 20);\n0x401358  &lt;+0x0038&gt;        48 8b 7d f8                                   mov    -0x8(%rbp),%rdi\n0x40135c  &lt;+0x003c&gt;        e8 df fb ff ff                                callq  0x400f40 &lt;printIntData(int*, unsigned long)&gt;\n0x401361  &lt;+0x0041&gt;        ba 14 00 00 00                                mov    $0x14,%edx\n0x401366  &lt;+0x0046&gt;        89 d6                                         mov    %edx,%esi\n0x401368  &lt;+0x0048&gt;        ba 4c 00 00 00                                mov    $0x4c,%edx\n        132 [1]     memcpy(data+1, data, 19*sizeof(int));\n0x40136d  &lt;+0x004d&gt;        48 8b 45 f8                                   mov    -0x8(%rbp),%rax\n0x401371  &lt;+0x0051&gt;        48 83 c0 04                                   add    $0x4,%rax\n0x401375  &lt;+0x0055&gt;        48 8b 7d f8                                   mov    -0x8(%rbp),%rdi\n0x401379  &lt;+0x0059&gt;        48 89 7d f0                                   mov    %rdi,-0x10(%rbp)\n0x40137d  &lt;+0x005d&gt;        48 89 c7                                      mov    %rax,%rdi\n0x401380  &lt;+0x0060&gt;        48 8b 45 f0                                   mov    -0x10(%rbp),%rax\n0x401384  &lt;+0x0064&gt;        48 89 75 e8                                   mov    %rsi,-0x18(%rbp)\n0x401388  &lt;+0x0068&gt;        48 89 c6                                      mov    %rax,%rsi\n0x40138b  &lt;+0x006b&gt;        e8 d0 f9 ff ff                                callq  0x400d60 &lt;memcpy@plt&gt;\n        133 [1]     printIntData(data, 20);\n0x401390  &lt;+0x0070&gt;        48 8b 7d f8                                   mov    -0x8(%rbp),%rdi\n0x401394  &lt;+0x0074&gt;        48 8b 75 e8                                   mov    -0x18(%rbp),%rsi\n0x401398  &lt;+0x0078&gt;        e8 a3 fb ff ff                                callq  0x400f40 &lt;printIntData(int*, unsigned long)&gt;\n        134 [1]     delete[] data;\n0x40139d  &lt;+0x007d&gt;        48 8b 45 f8                                   mov    -0x8(%rbp),%rax\n0x4013a1  &lt;+0x0081&gt;        48 83 f8 00                                   cmp    $0x0,%rax\n0x4013a5  &lt;+0x0085&gt;        48 89 45 e0                                   mov    %rax,-0x20(%rbp)\n0x4013a9  &lt;+0x0089&gt;        0f 84 0c 00 00 00                             je     0x4013bb &lt;overlappingMemcpy()+155&gt;\n0x4013af  &lt;+0x008f&gt;        48 8b 45 e0                                   mov    -0x20(%rbp),%rax\n0x4013b3  &lt;+0x0093&gt;        48 89 c7                                      mov    %rax,%rdi\n0x4013b6  &lt;+0x0096&gt;        e8 05 fa ff ff                                callq  0x400dc0 &lt;_ZdaPv@plt&gt;\n        135 [1] }\n0x4013bb  &lt;+0x009b&gt;        48 83 c4 20                                   add    $0x20,%rsp\n0x4013bf  &lt;+0x009f&gt;        5d                                            pop    %rbp\n0x4013c0  &lt;+0x00a0&gt;        c3                                            retq\n</code></pre>\n\n<p>Should this not be reported by the tool? It says on the documentation page that it detects \"Passes overlapping source and destination memory blocks to memcpy() and related functions.\"</p>\n\n<p><strong>Edit</strong>\nThanks to a commenter, I found that the optimized version of memcpy that appears to be called in the above assembly is redirected by Valgrind to <code>memmove</code> (at least, that's what I surmise). The verbose Valgrind run is below,</p>\n\n<pre><code>&gt; valgrind -v  ./ValgrindExamples \n==56912== Memcheck, a memory error detector\n==56912== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==56912== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==56912== Command: ./ValgrindExamples\n==56912== \n--56912-- Valgrind options:\n--56912--    -v\n--56912-- Contents of /proc/version:\n--56912--   Linux version 4.14.7-041407-generic (kernel@gloin) (gcc version 7.2.0 (Ubuntu 7.2.0-8ubuntu3)) #201712171031 SMP Sun Dec 17 15:33:35 UTC 2017\n--56912-- \n--56912-- Arch and hwcaps: AMD64, LittleEndian, amd64-cx16-lzcnt-rdtscp-sse3-avx-avx2-bmi\n--56912-- Page sizes: currently 4096, max supported 4096\n--56912-- Valgrind library directory: /usr/lib/valgrind\n--56912-- Reading syms from /home/charlie/Projects/build-ValgrindExamples-Desktop-Default/ValgrindExamples\n--56912-- Reading syms from /lib/x86_64-linux-gnu/ld-2.26.so\n--56912--   Considering /lib/x86_64-linux-gnu/ld-2.26.so ..\n--56912--   .. CRC mismatch (computed 89c8df08 wanted 47b839f9)\n--56912--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/ld-2.26.so ..\n--56912--   .. CRC is valid\n--56912-- Reading syms from /usr/lib/valgrind/memcheck-amd64-linux\n--56912--   Considering /usr/lib/valgrind/memcheck-amd64-linux ..\n--56912--   .. CRC mismatch (computed 9fa343a0 wanted dc854ea8)\n--56912--    object doesn't have a symbol table\n--56912--    object doesn't have a dynamic symbol table\n--56912-- Scheduler: using generic scheduler lock implementation.\n--56912-- Reading suppressions file: /usr/lib/valgrind/default.supp\n==56912== embedded gdbserver: reading from /tmp/vgdb-pipe-from-vgdb-to-56912-by-charlie-on-???\n==56912== embedded gdbserver: writing to   /tmp/vgdb-pipe-to-vgdb-from-56912-by-charlie-on-???\n==56912== embedded gdbserver: shared mem   /tmp/vgdb-pipe-shared-mem-vgdb-56912-by-charlie-on-???\n==56912== \n==56912== TO CONTROL THIS PROCESS USING vgdb (which you probably\n==56912== don't want to do, unless you know exactly what you're doing,\n==56912== or are doing some strange experiment):\n==56912==   /usr/lib/valgrind/../../bin/vgdb --pid=56912 ...command...\n==56912== \n==56912== TO DEBUG THIS PROCESS USING GDB: start GDB like this\n==56912==   /path/to/gdb ./ValgrindExamples\n==56912== and then give GDB the following command\n==56912==   target remote | /usr/lib/valgrind/../../bin/vgdb --pid=56912\n==56912== --pid is optional if only one valgrind process is running\n==56912== \n--56912-- REDIR: 0x401f860 (ld-linux-x86-64.so.2:strlen) redirected to 0x58060901 (???)\n--56912-- REDIR: 0x401f640 (ld-linux-x86-64.so.2:index) redirected to 0x5806091b (???)\n--56912-- Reading syms from /usr/lib/valgrind/vgpreload_core-amd64-linux.so\n--56912--   Considering /usr/lib/valgrind/vgpreload_core-amd64-linux.so ..\n--56912--   .. CRC mismatch (computed f3fb86a7 wanted 0b99f9ab)\n--56912--    object doesn't have a symbol table\n--56912-- Reading syms from /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so\n--56912--   Considering /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so ..\n--56912--   .. CRC mismatch (computed 5ffa922b wanted 4228a583)\n--56912--    object doesn't have a symbol table\n==56912== WARNING: new redirection conflicts with existing -- ignoring it\n--56912--     old: 0x0401f860 (strlen              ) R-&gt; (0000.0) 0x58060901 ???\n--56912--     new: 0x0401f860 (strlen              ) R-&gt; (2007.0) 0x04c32db0 strlen\n--56912-- REDIR: 0x401d8d0 (ld-linux-x86-64.so.2:strcmp) redirected to 0x4c33ee0 (strcmp)\n--56912-- REDIR: 0x401fda0 (ld-linux-x86-64.so.2:mempcpy) redirected to 0x4c374f0 (mempcpy)\n--56912-- Reading syms from /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.24\n--56912--    object doesn't have a symbol table\n--56912-- Reading syms from /lib/x86_64-linux-gnu/libm-2.26.so\n--56912--   Considering /lib/x86_64-linux-gnu/libm-2.26.so ..\n--56912--   .. CRC mismatch (computed b616e9a5 wanted 56d31e5b)\n--56912--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libm-2.26.so ..\n--56912--   .. CRC is valid\n--56912-- Reading syms from /lib/x86_64-linux-gnu/libgcc_s.so.1\n--56912--    object doesn't have a symbol table\n--56912-- Reading syms from /lib/x86_64-linux-gnu/libc-2.26.so\n--56912--   Considering /lib/x86_64-linux-gnu/libc-2.26.so ..\n--56912--   .. CRC mismatch (computed b6c34c34 wanted f79829d1)\n--56912--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.26.so ..\n--56912--   .. CRC is valid\n--56912-- REDIR: 0x57c3f50 (libc.so.6:memmove) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c3010 (libc.so.6:strncpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c4230 (libc.so.6:strcasecmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2a60 (libc.so.6:strcat) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c3040 (libc.so.6:rindex) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c5bb0 (libc.so.6:rawmemchr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c40c0 (libc.so.6:mempcpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c3ee0 (libc.so.6:bcmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2fd0 (libc.so.6:strncmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2ad0 (libc.so.6:strcmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c4020 (libc.so.6:memset) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57e1f10 (libc.so.6:wcschr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2f70 (libc.so.6:strnlen) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2b40 (libc.so.6:strcspn) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c4280 (libc.so.6:strncasecmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2b10 (libc.so.6:strcpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c43c0 (libc.so.6:memcpy@@GLIBC_2.14) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c3070 (libc.so.6:strpbrk) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2a90 (libc.so.6:index) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c2f40 (libc.so.6:strlen) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57ce510 (libc.so.6:memrchr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c42d0 (libc.so.6:strcasecmp_l) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c3eb0 (libc.so.6:memchr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57e2cc0 (libc.so.6:wcslen) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c3350 (libc.so.6:strspn) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c4200 (libc.so.6:stpncpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c41d0 (libc.so.6:stpcpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c5be0 (libc.so.6:strchrnul) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x57c4320 (libc.so.6:strncasecmp_l) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--56912-- REDIR: 0x58ad6f0 (libc.so.6:__strrchr_avx2) redirected to 0x4c32730 (rindex)\n--56912-- REDIR: 0x57bdeb0 (libc.so.6:malloc) redirected to 0x4c2faa0 (malloc)\n--56912-- REDIR: 0x58ad8c0 (libc.so.6:__strlen_avx2) redirected to 0x4c32cf0 (strlen)\n--56912-- REDIR: 0x58a9ed0 (libc.so.6:__memcmp_avx2_movbe) redirected to 0x4c35e00 (bcmp)\n--56912-- REDIR: 0x58890b0 (libc.so.6:__strcmp_ssse3) redirected to 0x4c33da0 (strcmp)\nHello World!\n--56912-- REDIR: 0x4ecc500 (libstdc++.so.6:operator new[](unsigned long)) redirected to 0x4c30830 (operator new[](unsigned long))\n--56912-- REDIR: 0x58adde0 (libc.so.6:__mempcpy_avx_unaligned_erms) redirected to 0x4c37130 (mempcpy)\nint data for memory at 0x5b210c0of size 20\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \n--56912-- REDIR: 0x58ade00 (libc.so.6:__memcpy_avx_unaligned_erms) redirected to 0x4c366e0 (memmove)\nint data for memory at 0x5b210c0of size 20\n1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \n--56912-- REDIR: 0x4eca3b0 (libstdc++.so.6:operator delete[](void*)) redirected to 0x4c316d0 (operator delete[](void*))\n--56912-- REDIR: 0x57be3e0 (libc.so.6:free) redirected to 0x4c30cd0 (free)\n==56912== \n==56912== HEAP SUMMARY:\n==56912==     in use at exit: 0 bytes in 0 blocks\n==56912==   total heap usage: 3 allocs, 3 frees, 73,808 bytes allocated\n==56912== \n==56912== All heap blocks were freed -- no leaks are possible\n==56912== \n==56912== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n==56912== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>So the follow-up question: what is choosing to call <code>__memcpy_avx_unaligned_erms</code>, I don't see it in the assembly. Due to the occurrence of the REDIR being aligned to when the memcpy is called, it seems to me as though Valgrind has figured out something I can't see in the assembly :$</p>\n"}, {"tags": ["c++", "function", "templates"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516836255, "post_id": 48433295, "comment_id": 83857988, "body": "Related, but there are techniques that read better: <a href=\"https://stackoverflow.com/q/19985160/1896169\">stackoverflow.com/q/19985160/1896169</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516836290, "post_id": 48433295, "comment_id": 83858001, "body": "just use overloads - thats what they are for"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1516836327, "post_id": 48433295, "comment_id": 83858015, "body": "@pm100 I wouldn&#39;t recommend that someone write all the overloads for all the integer and 2 float types. That&#39;s a lot of unnecessary code duplication"}, {"owner": {"reputation": 8756, "user_id": 416274, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa38a4e372afb202e6ab7eb1619372a8?s=128&d=identicon&r=PG", "display_name": "Robinson", "link": "https://stackoverflow.com/users/416274/robinson"}, "edited": false, "score": 0, "creation_date": 1516836378, "post_id": 48433295, "comment_id": 83858031, "body": "Experience (and time pressure) have taught me to choose a single type and stick with it.  Of course if you&#39;re a library writer things may be different."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1516836441, "post_id": 48433295, "comment_id": 83858051, "body": "Use SFINAE.  One using <code>std::is_intergal</code> and <code>!is_floating_point</code> and the other using the reverse"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1516836562, "post_id": 48433295, "comment_id": 83858086, "body": "You could use explicit template instantiation to only insatiate for a few specific types. <a href=\"https://stackoverflow.com/a/2351622/14065\">stackoverflow.com/a/2351622/14065</a>"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516836759, "post_id": 48433295, "comment_id": 83858134, "body": "@pm100 Kind of proves my point that I forgot about <code>long double</code>..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1516838866, "post_id": 48433295, "comment_id": 83858747, "body": "@NathanOliver: why check for <code>!is_floating_point</code>? <code>std::is_integral</code> does not include floating point types.  I think you meant to say &quot;one using <code>std::is_integral</code> and the other using <code>std::is_floating_point</code>&quot;..."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516839275, "post_id": 48433295, "comment_id": 83858867, "body": "@Justin - his original title said he wanted different code for each one. Classic overload case. Now title is changed"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516839377, "post_id": 48433295, "comment_id": 83858903, "body": "@pm100 That&#39;s a valid point. Thanks for pointing that out to me. But I do believe that the title change is appropriate, as it better matches what&#39;s in the body of the question"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1516840439, "post_id": 48433295, "comment_id": 83859234, "body": "@RemyLebeau Yep.  misspoke there.  They just need to use one,"}], "answers": [{"tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": false, "score": 5, "last_activity_date": 1516838539, "last_edit_date": 1516838539, "creation_date": 1516836989, "answer_id": 48433441, "question_id": 48433295, "link": "https://stackoverflow.com/questions/48433295/is-it-possible-to-overload-a-template-function-based-on-whether-the-type-is-an-i/48433441#48433441", "title": "Is it possible to overload a template function based on whether the type is an integer type or a floating point type?", "body": "<p>Yes, this is possible. One way of doing this is to use <a href=\"http://en.cppreference.com/w/cpp/language/sfinae\" rel=\"nofollow noreferrer\">SFINAE</a>:</p>\n\n<pre><code>template &lt;class T, std::enable_if_t&lt;std::is_integral_v&lt;T&gt;, int&gt; = 0&gt;\nvoid fun(T b)\n{\n   /// Code for integer type\n}\n\n\ntemplate &lt;class S, std::enable_if_t&lt;std::is_floating_point_v&lt;T&gt;, int&gt; = 0&gt;\nvoid fun(S a)\n{\n   /// Code for floating type\n}\n</code></pre>\n\n<p>Note that the 2 conditions for the <a href=\"http://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\"><code>enable_if</code></a>s have to be disjoint, which we can see from the documentation of <a href=\"http://en.cppreference.com/w/cpp/types/is_integral\" rel=\"nofollow noreferrer\"><code>std::is_integral</code></a> and <a href=\"http://en.cppreference.com/w/cpp/types/is_floating_point\" rel=\"nofollow noreferrer\"><code>std::is_floating_point</code></a> that they are. If they weren't, the conditions would have to look like <code>std::is_integral_v&lt;T&gt; &amp;&amp; !std::is_floating_point_v&lt;T&gt;</code>.</p>\n\n<p>What is happening here is that the <code>std::enable_if_t</code> makes one of the overloads \"fail to compile\" if the condition is not satisfied, which means that the overload is simply not considered due to SFINAE.</p>\n\n<hr>\n\n<p>If you are using C++17, you might want to consider using <code>if constexpr</code> instead:</p>\n\n<pre><code>template &lt;class T&gt;\nvoid fun(T b)\n{\n    if constexpr (std::is_integral_v&lt;T&gt;) {\n        /// Code for integer type\n    } else if constexpr (std::is_floating_point_v&lt;T&gt;) {\n        /// Code for floating type\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516838469, "post_id": 48433586, "comment_id": 83858624, "body": "For cases where you want to overload all of <code>int8_t</code> through <code>int64_t</code> and <code>uint8_t</code> through <code>uint64_t</code>, this solution has a lot of code duplication. However, when I&#39;ve been in such a case, I usually find that it&#39;s unnecessary, and I could instead just overload for <code>int64_t</code> and <code>uint64_t</code> and call it done."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516838612, "post_id": 48433586, "comment_id": 83858665, "body": "I completely agree, @Justin !! OP&#39;s question hints that they want individual functions for each type though, which is why suggested keeping simple function overloads if that was indeed their intent."}], "tags": [], "owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "is_accepted": false, "score": 3, "last_activity_date": 1516838422, "last_edit_date": 1516838422, "creation_date": 1516838078, "answer_id": 48433586, "question_id": 48433295, "link": "https://stackoverflow.com/questions/48433295/is-it-possible-to-overload-a-template-function-based-on-whether-the-type-is-an-i/48433586#48433586", "title": "Is it possible to overload a template function based on whether the type is an integer type or a floating point type?", "body": "<p>Depending on what your full intent is, outside of <a href=\"https://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error\" rel=\"nofollow noreferrer\">SFINAE</a> and <a href=\"http://www.cplusplus.com/reference/type_traits/enable_if/\" rel=\"nofollow noreferrer\">std::enable_if</a>, you can use regular function overloads and/or template specialization too:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdint&gt;\n\ntemplate &lt; typename T &gt;\nvoid fun(T b)\n{\n    std::cout &lt;&lt; \"Generic called: \" &lt;&lt; b &lt;&lt; std::endl;\n}\n\nvoid fun(int16_t b)\n{\n    std::cout &lt;&lt; \"int16_t: \" &lt;&lt; b &lt;&lt; std::endl;\n}\n\nvoid fun(int32_t b)\n{\n    std::cout &lt;&lt; \"int32_t: \" &lt;&lt; b &lt;&lt; std::endl;\n}\n\nvoid fun(float b)\n{\n    std::cout &lt;&lt; \"float: \" &lt;&lt; b &lt;&lt; std::endl;\n}\n\ntemplate &lt;&gt;\nvoid fun&lt;int64_t&gt;(int64_t b)\n{\n    std::cout &lt;&lt; \"int64_t specialization: \" &lt;&lt; b &lt;&lt; std::endl;\n}\n\nint main(int argc, char** argv)\n{\n    double dbl = 3.14159;\n    float flt = 1.12345;\n    int16_t i16 = 16;\n    int32_t i32 = 32;\n    fun(dbl);\n    fun(flt);\n    fun(i16);\n    fun(i32);\n    fun(5.555f);\n    fun(32);\n    fun(std::numeric_limits&lt;int64_t&gt;::max());\n    return 0;\n}\n</code></pre>\n\n<p>Hope that can help.</p>\n"}, {"tags": [], "owner": {"reputation": 3554, "user_id": 688080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9ee8890c431e4689f29f73fb36d58610?s=128&d=identicon&r=PG", "display_name": "ziyuang", "link": "https://stackoverflow.com/users/688080/ziyuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1573957733, "last_edit_date": 1573957733, "creation_date": 1573937799, "answer_id": 58895142, "question_id": 48433295, "link": "https://stackoverflow.com/questions/48433295/is-it-possible-to-overload-a-template-function-based-on-whether-the-type-is-an-i/58895142#58895142", "title": "Is it possible to overload a template function based on whether the type is an integer type or a floating point type?", "body": "<p>According to <a href=\"https://en.cppreference.com/w/cpp/language/sfinae\" rel=\"nofollow noreferrer\">SFINAE</a>, we can design compilation errors for one type while letting the other go in the template substitution phase. In the case of integral type vs. floating-point type, we can make use of the bit-related operators for integers like <code>~</code>. For example,</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename T, T=~0&gt;\nvoid f_(T a, int)  // additional tags for unambiguous overloading, same below\n{\n    std::cout &lt;&lt; a &lt;&lt; \" is of integral type.\" &lt;&lt; std::endl;\n}\n\ntemplate &lt;typename T&gt;\nvoid f_(T a, char)\n{\n    std::cout &lt;&lt; a &lt;&lt; \" is of floating-point type.\" &lt;&lt; std::endl;\n}\n\ntemplate &lt;typename T&gt;\nvoid f(T a)\n{\n    f_&lt;T&gt;(a, 0);\n}\n\n\nint main()\n{\n    f&lt;char&gt;('a');\n    f&lt;int&gt;(0);\n    f&lt;float&gt;(1.5f);\n    f&lt;double&gt;(2.5);\n    return 0;\n}\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>a is of integral type.\n0 is of integral type.\n1.5 is of floating-point type.\n2.5 is of floating-point type.\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4071670, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6d4dc2d8f1c4a0b4251eb604a46448eb?s=128&d=identicon&r=PG&f=1", "display_name": "Aniss Be", "link": "https://stackoverflow.com/users/4071670/aniss-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1573957733, "creation_date": 1516836047, "last_edit_date": 1516836508, "question_id": 48433295, "link": "https://stackoverflow.com/questions/48433295/is-it-possible-to-overload-a-template-function-based-on-whether-the-type-is-an-i", "title": "Is it possible to overload a template function based on whether the type is an integer type or a floating point type?", "body": "<p>I want to write template function that should just be called when the type is integer, for example int8, int16, int32, int64, uint8, uint16, uint32, uint64; and an other template function (same name) with different code just for FLOAT type float32, float64... There is anyway to do it using templates functions in C++ ?\nFor example :</p>\n\n<pre><code>template &lt;class T&gt;\nvoid fun(T b)\n{\n   /// Code for integer type\n}\n\n\n template &lt;class S&gt;\nvoid fun(S a)\n{\n   /// Code for floating type\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "openssl", "libcurl", "ca"], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 6004779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i6sV8.jpg?s=128&g=1", "display_name": "GarCB613", "link": "https://stackoverflow.com/users/6004779/garcb613"}, "edited": false, "score": 1, "creation_date": 1516894391, "post_id": 48434362, "comment_id": 83884948, "body": "According to this <a href=\"https://stackoverflow.com/a/15251304/6004779\">stackoverflow.com/a/15251304/6004779</a> the configure tool isn&#39;t an option for Windows :( am I out of luck or is there preprocessor equivalents to these flags? Thanks!"}], "tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": true, "score": 2, "last_activity_date": 1516844835, "last_edit_date": 1516844835, "creation_date": 1516844534, "answer_id": 48434362, "question_id": 48433182, "link": "https://stackoverflow.com/questions/48433182/define-ca-info-at-compile-time-for-libcurl/48434362#48434362", "title": "Define CA Info at Compile Time for libcurl", "body": "<blockquote>\n  <p>Do these settings only apply to command line or can libcurl be configured at compile time to always use the same CA info?</p>\n</blockquote>\n\n<p>cURL has the same settings for compile time. More accurately, they are Autotools options.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>curl-7.57.0$ ./configure --help\n`configure' configures curl - to adapt to many kinds of systems.\n\nUsage: ./configure [OPTION]... [VAR=VALUE]...\n...\n\n  --with-ca-bundle=FILE   Path to a file containing CA certificates (example:\n                          /etc/ca-bundle.crt)\n  --without-ca-bundle     Don't use a default CA bundle\n  --with-ca-path=DIRECTORY\n                          Path to a directory containing CA certificates\n                          stored individually, with their filenames in a hash\n                          format. This option can be used with OpenSSL, GnuTLS\n                          and PolarSSL backends. Refer to OpenSSL c_rehash for\n                          details. (example: /etc/certificates)\n  --without-ca-path       Don't use a default CA path\n  --with-ca-fallback      Use the built in CA store of the SSL library\n  --without-ca-fallback   Don't use the built in CA store of the SSL library\n</code></pre>\n\n<p>I build cURL on occasion for testing on older systems like CentOS 5. I find it is easiest to download an updated <a href=\"https://curl.haxx.se/docs/caextract.html\" rel=\"nofollow noreferrer\"><code>cacert.pem</code></a>, and then use <code>--with-ca-bundle</code>.</p>\n\n<p>If you want to use <code>--with-ca-path</code>, then that is the one where each certificate is hashed. So you will have a directory with 120 or 150 files in it. The files will have names like <code>NNNNNNNN.0</code>, <code>NNNNNNNN.1</code> and so on. <code>NNNNNNNN</code> will be a hash, and collisions are resolved by incrementing the suffix.</p>\n\n<p>I keep my script for building cURL online at <a href=\"https://github.com/noloader/Build-Scripts/blob/master/build-curl.sh\" rel=\"nofollow noreferrer\">Build-Scripts | build-curl.sh</a>.</p>\n"}], "owner": {"reputation": 164, "user_id": 6004779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i6sV8.jpg?s=128&g=1", "display_name": "GarCB613", "link": "https://stackoverflow.com/users/6004779/garcb613"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "accepted_answer_id": 48434362, "answer_count": 1, "score": 3, "last_activity_date": 1516844835, "creation_date": 1516835206, "last_edit_date": 1516844735, "question_id": 48433182, "link": "https://stackoverflow.com/questions/48433182/define-ca-info-at-compile-time-for-libcurl", "title": "Define CA Info at Compile Time for libcurl", "body": "<p>I have built libcurl for Windows x64 with OpenSSL. If I specify the CA Info with the libcurl command as shown below I am able to post my data via https.</p>\n\n<p><code>curl_easy_setopt(curl_handle, CURLOPT_CAINFO, \"C:\\\\cacert.pem\");</code></p>\n\n<p>My question is regards to option 3 under the heading \u201cCertificate Verification\u201d found here: <a href=\"https://curl.haxx.se/docs/sslcerts.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/docs/sslcerts.html</a></p>\n\n<blockquote>\n  <p>3) Add the CA cert for your server to the existing default CA certificate store. The default CA certificate store can changed at compile time with the following configure options:</p>\n  \n  <p>--with-ca-bundle=FILE: use the specified file as CA certificate store. CA certificates need to be concatenated in PEM format into this file.</p>\n  \n  <p>--with-ca-path=PATH: use the specified path as CA certificate store. CA certificates need to be stored as individual PEM files in this directory. You may need to run c_rehash after adding files there.</p>\n</blockquote>\n\n<p>Do these settings only apply to command line or can libcurl be configured at compile time to always use the same CA info?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "winapi", "registry"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1516834667, "post_id": 48432994, "comment_id": 83857456, "body": "You are lying to the OS about your buffer size. However I am not sure that hurts you here."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1516834687, "post_id": 48432994, "comment_id": 83857462, "body": "Check the return value, and remember that registry functions return 0 on success."}, {"owner": {"reputation": 11, "user_id": 9220868, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1a7K9GwGSA0/AAAAAAAAAAI/AAAAAAAAAmc/dtiuu5BY9cU/photo.jpg?sz=128", "display_name": "Jezis Marja", "link": "https://stackoverflow.com/users/9220868/jezis-marja"}, "edited": false, "score": 0, "creation_date": 1516834812, "post_id": 48432994, "comment_id": 83857513, "body": "Thanks for the suggestions, however as I said, it works perfectly fine when i try to read other registry values. It actually outputs the values successfully. Doesn&#39;t work with MachineGuid for some reason...."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1516834841, "post_id": 48432994, "comment_id": 83857523, "body": "Could be a permission problem."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 2, "creation_date": 1516834971, "post_id": 48432994, "comment_id": 83857573, "body": "And that&#39;s why you check the return value, that way you find out what (if anything) the function thinks is wrong in this particular case. If it turns out the call succeeds but there is still no output (particularly by returned buffer size) then something is very weird."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1516873890, "post_id": 48432994, "comment_id": 83871015, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384232.aspx\" rel=\"nofollow noreferrer\">Registry Redirector</a>."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1516835639, "last_edit_date": 1516835639, "creation_date": 1516835317, "answer_id": 48433200, "question_id": 48432994, "link": "https://stackoverflow.com/questions/48432994/c-read-machine-guid-via-reggetvalue/48433200#48433200", "title": "C++ Read machine GUID via RegGetValue", "body": "<p>You are not passing your <code>value</code> buffer to <code>RegGetValueA()</code> correctly.  Get rid of the <code>&amp;</code> operator (and the type-cast).  Let the array decay into a pointer naturally.</p>\n\n<p>More importantly, you need to pass the <em>correct</em> buffer size, in bytes.  You are allocating only 255 bytes, but are telling <code>RegGetValueA()</code> that <code>value</code> has 8192 bytes available, which is a lie.  Even though <code>MachineGuid</code> will return only 37 bytes on success, you should not lie to the API.</p>\n\n<p>Also, you need to check the return value of <code>RegGetValueA()</code> to see whether it succeeds or fails, and if it fails then you can find out WHY it fails.</p>\n\n<p>Try this:</p>\n\n<pre><code>int main()\n{\n    char value[255];\n    DWORD BufferSize = sizeof(value);\n    LONG res = RegGetValueA(HKEY_LOCAL_MACHINE, \"SOFTWARE\\\\Microsoft\\\\Cryptography\", \"MachineGuid\", RRF_RT_REG_SZ, NULL, value, &amp;BufferSize);\n    if (res == 0)\n    {\n        std::cout &lt;&lt; value &lt;&lt; std::endl;\n\n        /* alternatively:\n        std::cout.write(value, BufferSize-1); // -1 to ignore the null terminator\n        std::cout &lt;&lt; std::endl;\n        */\n    }\n    else\n        std::cerr &lt;&lt; \"Error: \" &lt;&lt; res &lt;&lt; std::endl;\n\n    std::system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9220868, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1a7K9GwGSA0/AAAAAAAAAAI/AAAAAAAAAmc/dtiuu5BY9cU/photo.jpg?sz=128", "display_name": "Jezis Marja", "link": "https://stackoverflow.com/users/9220868/jezis-marja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516835639, "creation_date": 1516834181, "last_edit_date": 1516834496, "question_id": 48432994, "link": "https://stackoverflow.com/questions/48432994/c-read-machine-guid-via-reggetvalue", "title": "C++ Read machine GUID via RegGetValue", "body": "<p>So today, i've been trying to get a MachineGuid value from registry in C++ via RegGetValue.</p>\n\n<p>RegGetValue works fine for me on almost every other value i try to read in the registry, but does not work with MachineGuid for some reason (output = nothing).</p>\n\n<p>Does anyone have any idea on how to approach this? How do i retreive it correctly?(Preferably string)\nSorry if this is a noob-ish question, I just don't know what else to do at this point.\nThanks! </p>\n\n<pre><code>#define BUFFER 8192\nint main{\nchar value[255];\nDWORD BufferSize = BUFFER;\nRegGetValueA(HKEY_LOCAL_MACHINE, \"SOFTWARE\\\\Microsoft\\\\Cryptography\", \"MachineGuid\", RRF_RT_ANY, NULL, (PVOID)&amp;value, &amp;BufferSize);\nstd::cout &lt;&lt; value &lt;&lt; std::endl; // Returns absolutely nothing.\nsystem(\"pause\");\n\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "parallel-processing", "intel", "tbb"], "comments": [{"owner": {"reputation": 3388, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1516891388, "post_id": 48432935, "comment_id": 83882706, "body": "The code that you&#39;ve shown looks right.  I&#39;m wondering if the &quot;a series of calculations&quot; has some kind of cross-iteration dependence, e.g. a read-write  dependence for some memory location."}, {"owner": {"reputation": 21, "user_id": 9146016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5045cc4b510f800e69f1fcd84a7ac8df?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Pascual Sanchez", "link": "https://stackoverflow.com/users/9146016/carlos-pascual-sanchez"}, "reply_to_user": {"reputation": 3388, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1516899433, "post_id": 48432935, "comment_id": 83888736, "body": "I basically read the values of the array and calculate some areas or others based on these values. Then I generate, for each row, a file with these calculations. In this code I create auxiliar variables to help in calculations. I don&#180;t know if I need to create a mutex object so that two threads do not access the variables at the same time."}, {"owner": {"reputation": 3388, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1516925864, "post_id": 48432935, "comment_id": 83901018, "body": "Two threads can safely read a variable at the same time.  But if one reads and the other writes, or both write, then there can be problems.  A simple test (won&#39;t catch all possible errors, but will catch a bunch of common ones) is to reverse the iteration order of the serial loop and see if you get the same results."}], "owner": {"reputation": 21, "user_id": 9146016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5045cc4b510f800e69f1fcd84a7ac8df?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Pascual Sanchez", "link": "https://stackoverflow.com/users/9146016/carlos-pascual-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516834372, "creation_date": 1516833851, "last_edit_date": 1516834372, "question_id": 48432935, "link": "https://stackoverflow.com/questions/48432935/parallelize-array-whith-tbbparalel-for", "title": "parallelize array whith tbb::paralel for", "body": "<p>I\u00b4m new in IntelTBB and I am trying to parallelize an array of vector. This is the function, in which I pass the array as a pointer.</p>\n\n<pre><code>void calculate(map&lt;int,string&gt; &amp;m, vector&lt;order&gt;* ord, auto&amp;k, string &amp;dir){\n\nfor(int i=0;i&lt;k;i++){\n//here I declare a series of variables\n\n    for(int j=0; j&lt;ord[i][j].size()-1; j++){\n        // here I do a series of calculations with the values of\n        // the array and I generate one file for each row of the array\n        // with this calculations, to do this I declare more variables\n     }\n\n\n}\n\n\n}\n</code></pre>\n\n<p>I want to parallelize this function so that it can process several rows of the array at the same time. I have tried to do this with parallel_for as follows:</p>\n\n<pre><code>void calculate(map&lt;int,string&gt; &amp;m, vector&lt;order&gt;* ord, auto&amp;k, string &amp;dir){\n\ntbb::parallel_for(tbb::blocked_range&lt;int&gt;(0,k),[&amp;](tbb::blocked_range&lt;int&gt;r)\n{\nfor(int i=r.begin();i&lt;r.end();i++){\n//here I declare a series of variables\n\n    for(int j=0; j&lt;ord[i][j].size()-1; j++){\n        // here I do a series of calculations with the values of\n        // the array and I generate one file for each row of the array\n        // with these calculations, to do this I declare more variables\n     }\n\n\n});\n\n\n}\n</code></pre>\n\n<p>This program compile well, but when it is executed, sometimes I obtain a result (generate text file that I need) with wrong calculations, but normally  I obtain an error like this:</p>\n\n<p>TBB Warning : Exact exception propagation is requested by application but the linked library is built without support for it\nterminate called after throwing an instance of 'tbb::capture_exception'</p>\n\n<p>How can this be done correctly? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "sockets", "tcp", "server", "client"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516832860, "post_id": 48432686, "comment_id": 83856685, "body": "Please format your code properly, i.e. with indentation, and tell us exactly what you mean by &#39;exit&#39;. Does it crash? Print an error and exit? Exit silently?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516833008, "post_id": 48432686, "comment_id": 83856751, "body": "There are fewer closing braces than there are opening ones. Was does <code>display</code> do after the loop?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516833882, "post_id": 48432686, "comment_id": 83857146, "body": "A step through the disconnect logic with a debugger will probably prove more fruitful to you in the long term than a asking question. Unrelated: <code>exit(1);</code> in <code>main</code> is kind of pointless <code>return 1;</code> will do the job."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1516834014, "post_id": 48432686, "comment_id": 83857201, "body": "If the thread exits with an exception then it will probably cause the application to terminate. You should run everything in the thread in a try catch block to prevent exceptions escaping. (You should check the documentation of pthread. But any abnormal termination of a thread is likely to cause the application to terminate)."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1516834058, "post_id": 48432686, "comment_id": 83857217, "body": "There is a race condition on your usage of <code>remoteSocket</code>"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516834247, "post_id": 48432686, "comment_id": 83857290, "body": "Your program exhibits undefined behavior, by way of reaching the end of a non-<code>void</code> function without encountering a <code>return</code> statement. <code>display</code> is declared to return a <code>void*</code>, but doesn&#39;t."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1516834256, "post_id": 48432686, "comment_id": 83857297, "body": "When you have it working. Bring it over to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> to get it reviewed."}, {"owner": {"reputation": 7, "user_id": 8767803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81180dd7d989ce5d8771cf7dc4993baf?s=128&d=identicon&r=PG&f=1", "display_name": "F. DE VIVO", "link": "https://stackoverflow.com/users/8767803/f-de-vivo"}, "edited": false, "score": 0, "creation_date": 1516834408, "post_id": 48432686, "comment_id": 83857364, "body": "could you please be more precise? Which way shoud I handle the solution? I have also commented the call to pthred_create to see which is the behaviour when a connection has been established and then I will close the client, and in that case the system work properly, but when I enter in display and I will close,also the server close. Could you add some line of code to handle the exception?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516835109, "post_id": 48432686, "comment_id": 83857620, "body": "No, could <i>you</i> be more precise, and answer all the questions you&#39;ve been asked?"}, {"owner": {"reputation": 7, "user_id": 8767803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81180dd7d989ce5d8771cf7dc4993baf?s=128&d=identicon&r=PG&f=1", "display_name": "F. DE VIVO", "link": "https://stackoverflow.com/users/8767803/f-de-vivo"}, "edited": false, "score": 0, "creation_date": 1516835561, "post_id": 48432686, "comment_id": 83857767, "body": "the code doesn&#39;t give errors. Practically when you type ctrl+c to close the client application, automatically also the server application on the other computer will close at the same time, without errors, simply terminates, as it has reached the end of the program (return 0). I hope I have answered your questions."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8767803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81180dd7d989ce5d8771cf7dc4993baf?s=128&d=identicon&r=PG&f=1", "display_name": "F. DE VIVO", "link": "https://stackoverflow.com/users/8767803/f-de-vivo"}, "edited": false, "score": 0, "creation_date": 1516922056, "post_id": 48433579, "comment_id": 83899898, "body": "this solution is not working... I have found that if I use the flag MSG_NOSIGNAL instead of 0 in the call &#168;send&#168; of function display the program doesn&#180;t close... the problem is that when I try to reconnect the client, the program will remain stucked just before the while(1) in funcntion display"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 7, "user_id": 8767803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81180dd7d989ce5d8771cf7dc4993baf?s=128&d=identicon&r=PG&f=1", "display_name": "F. DE VIVO", "link": "https://stackoverflow.com/users/8767803/f-de-vivo"}, "edited": false, "score": 0, "creation_date": 1516922973, "post_id": 48433579, "comment_id": 83900175, "body": "@F.DEVIVO: See <a href=\"http://www.microhowto.info/howto/prevent_a_process_from_terminating_when_writing_to_a_broken_pipe.html\" rel=\"nofollow noreferrer\">Prevent a process from terminating when writing to a broken pipe</a>. But either way you disable <code>SIGPIPE</code>, <code>send()</code> will simply fail with an error code on disconnect, which this code already handles to terminate the thread loop. It can&#39;t get stuck in the loop unless <code>send()</code> is reporting success. When the client disconnects, the loop should break. When the client reconnects, a new thread should be starting."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1516838034, "creation_date": 1516838034, "answer_id": 48433579, "question_id": 48432686, "link": "https://stackoverflow.com/questions/48432686/how-to-prevent-the-server-to-close-when-i-close-the-client-socket-c/48433579#48433579", "title": "how to prevent the server to close when I close the client socket? C++", "body": "<p>You are not passing <code>remoteSocket</code> to <code>display()</code> safely, so you have a race condition that could alter the value of <code>remoteSocket</code> if another client connects before <code>display()</code> has a chance to use the previous value.  Don't pass a pointer to the original <code>remoteSocket</code>, pass a copy of it instead.</p>\n\n<p>Also, <code>display()</code> is not closing the accepted socket when done using it before exiting, so you are leaking socket descriptors.  Eventually, <code>accept()</code> will fail due to lack of available descriptors, and your main loop will exit the program.</p>\n\n<p>Try something more like this instead:</p>\n\n<pre><code>/**\n * OpenCV video streaming over TCP/IP\n * Server: Captures video from a webcam and send it to a client\n * by Isaac Maia\n */\n\n#include \"opencv2/opencv.hpp\"\n#include &lt;iostream&gt;\n#include &lt;sys/socket.h&gt; \n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;unistd.h&gt; \n#include &lt;string.h&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace cv;\n\nvoid* display(void *);\n\nint capDev = 0;\nVideoCapture cap(capDev); // open the default camera\n\nint main(int argc, char** argv)\n{\n    //--------------------------------------------------------\n    //networking stuff: socket, bind, listen\n    //--------------------------------------------------------\n    int localSocket, remoteSocket;\n    unsigned short port = 4097;\n    struct sockaddr_in localAddr, remoteAddr;\n    socklen_t addrLen;\n\n    pthread_t thread_id;    \n    int err;\n\n    if (argc &gt; 1)\n    {\n        long lport = strtol(argv[1], NULL, 10);\n        if ((lport &lt;= 0) || (lport &gt; 65535))\n        {\n            std::cerr &lt;&lt; \"usage: ./cv_video_srv [port] [capture device]\\n\"\n                      &lt;&lt; \"port           : socket port (4097 default)\\n\"\n                      &lt;&lt; \"capture device : (0 default)\\n\" &lt;&lt; std::endl;\n\n            return 1;\n        }\n\n        port = (unsigned short) lport;\n    }\n\n    localSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n    if (localSocket == -1)\n    {\n        perror(\"socket() call failed\");\n        return 1;\n    }\n\n    localAddr.sin_family = AF_INET;\n    localAddr.sin_addr.s_addr = INADDR_ANY;\n    localAddr.sin_port = htons(port);\n\n    if (bind(localSocket, (struct sockaddr *) &amp;localAddr, sizeof(localAddr)) &lt; 0)\n    {\n        perror(\"Can't bind() socket\");\n        close(localSocket);\n        return 1;\n    }\n\n    //Listening\n    if (listen(localSocket, 3) &lt; 0)\n    {\n        perror(\"Can't listen() socket\");\n        close(localSocket);\n        return 1;\n    }\n\n    std::cout &lt;&lt; \"Waiting for connections...\\n\"\n              &lt;&lt; \"Server Port:\" &lt;&lt; port &lt;&lt; std::endl;\n\n    //accept connection from an incoming client\n    while (1)\n    {\n        addrLen = sizeof(struct sockaddr_in);\n        remoteSocket = accept(localSocket,\n                              (struct sockaddr *) &amp;remoteAddr,\n                              &amp;addrLen);\n        //std::cout &lt;&lt; remoteSocket &lt;&lt; std::endl;\n        if (remoteSocket &lt; 0)\n        {\n            perror(\"accept failed\");\n            close(localSocket);\n            return 1;\n        }\n\n        std::cout &lt;&lt; \"Connection accepted\" &lt;&lt; std::endl;\n\n        int *socket = new int(remoteSocket);\n        err = pthread_create(&amp;thread_id, NULL, display, socket);\n        if (err != 0)\n        {\n            //perror(\"pthread_create failed\");\n            std::cerr &lt;&lt; \"pthread_create failed: \" &lt;&lt; strerror(err) &lt;&lt; std::endl;\n            close(remoteSocket);\n            delete socket;\n            continue;\n        }\n\n        //pthread_join(thread_id,NULL);\n    }\n\n    //pthread_join(thread_id,NULL);\n\n    return 0;\n}\n\nvoid* display(void *ptr)\n{\n    int socket = * (int*) ptr;\n    delete (int*) ptr;\n\n    //OpenCV Code\n    //----------------------------------------------------------\n\n    Mat img, imgGray;\n    img = Mat::zeros(480, 640, CV_8UC1);\n    //make it continuous\n    if (!img.isContinuous())\n    {\n        img = img.clone();\n    }\n\n    int imgSize = img.total() * img.elemSize();\n    int bytes = 0;\n    int key;\n\n    //make img continuos\n    if (!img.isContinuous())\n    {\n        img = img.clone();\n        imgGray = img.clone();\n    }\n\n    std::cout &lt;&lt; \"Image Size:\" &lt;&lt; imgSize &lt;&lt; std::endl;\n\n    while (1)\n    {\n        /* get a frame from camera */\n        cap &gt;&gt; img;\n\n        //do video processing here \n        cvtColor(img, imgGray, CV_BGR2GRAY);\n\n        //send processed image\n        bytes = send(socket, imgGray.data, imgSize, 0);\n        if (bytes &lt;= 0)\n        {\n            if (bytes &lt; 0)\n                perror(\"send failed\");\n            break;\n        }\n    }\n\n    close(socket);\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8767803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81180dd7d989ce5d8771cf7dc4993baf?s=128&d=identicon&r=PG&f=1", "display_name": "F. DE VIVO", "link": "https://stackoverflow.com/users/8767803/f-de-vivo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516838034, "creation_date": 1516832568, "last_edit_date": 1516833723, "question_id": 48432686, "link": "https://stackoverflow.com/questions/48432686/how-to-prevent-the-server-to-close-when-i-close-the-client-socket-c", "title": "how to prevent the server to close when I close the client socket? C++", "body": "<p>I have the following code that is the \"server.cpp\". It correctly establishes a connection with the client and streams the video. The problem is that when I close the client, regardless of the while cycle in the main program, automatically also the server will shout down, even if I am using pthread_create.</p>\n\n<p>Could you help me to find a solution to avoid it to close, and to remain alive until a new client will connect to it? </p>\n\n<pre><code>/**\n * OpenCV video streaming over TCP/IP\n * Server: Captures video from a webcam and send it to a client\n * by Isaac Maia\n */\n\n#include \"opencv2/opencv.hpp\"\n#include &lt;iostream&gt;\n#include &lt;sys/socket.h&gt; \n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;unistd.h&gt; \n#include &lt;string.h&gt;\n\nusing namespace cv;\n\nvoid *display(void *);\n\nint capDev = 0;\n\nVideoCapture cap(capDev); // open the default camera\n\nint main(int argc, char** argv)\n{\n\n//--------------------------------------------------------\n//networking stuff: socket, bind, listen\n//--------------------------------------------------------\n    int localSocket, remoteSocket, port = 4097;\n\n    struct sockaddr_in localAddr, remoteAddr;\n    pthread_t thread_id;\n\n    int addrLen = sizeof(struct sockaddr_in);\n\n    if ((argc &gt; 1) &amp;&amp; (strcmp(argv[1], \"-h\") == 0))\n    {\n        std::cerr &lt;&lt; \"usage: ./cv_video_srv [port] [capture device]\\n\"\n                &lt;&lt; \"port           : socket port (4097 default)\\n\"\n                &lt;&lt; \"capture device : (0 default)\\n\" &lt;&lt; std::endl;\n\n        exit(1);\n    }\n\n    if (argc == 2)\n        port = atoi(argv[1]);\n\n    localSocket = socket(AF_INET, SOCK_STREAM, 0);\n    if (localSocket == -1)\n    {\n        perror(\"socket() call failed!!\");\n    }\n\n    localAddr.sin_family = AF_INET;\n    localAddr.sin_addr.s_addr = INADDR_ANY;\n    localAddr.sin_port = htons(port);\n\n    if (bind(localSocket, (struct sockaddr *) &amp;localAddr, sizeof(localAddr))\n            &lt; 0)\n    {\n        perror(\"Can't bind() socket\");\n        exit(1);\n    }\n\n    //Listening\n    listen(localSocket, 3);\n\n    std::cout &lt;&lt; \"Waiting for connections...\\n\" &lt;&lt; \"Server Port:\" &lt;&lt; port\n            &lt;&lt; std::endl;\n\n    //accept connection from an incoming client\n    while (1)\n    {\n\n        //if (remoteSocket &lt; 0) {\n        //    perror(\"accept failed!\");\n        //    exit(1);\n        //}\n\n        remoteSocket = accept(localSocket,\n                              (struct sockaddr *) &amp;remoteAddr,\n                              (socklen_t*) &amp;addrLen);\n        //std::cout &lt;&lt; remoteSocket&lt;&lt; \"32\"&lt;&lt; std::endl;\n        if (remoteSocket &lt; 0)\n        {\n            perror(\"accept failed!\");\n            exit(1);\n        }\n        std::cout &lt;&lt; \"Connection accepted\" &lt;&lt; std::endl;\n        pthread_create(&amp;thread_id, NULL, display, &amp;remoteSocket);\n\n        //pthread_join(thread_id,NULL);\n\n    }\n    //pthread_join(thread_id,NULL);\n    //close(remoteSocket);\n\n    return 0;\n}\n\nvoid *display(void *ptr)\n{\n    int socket = *(int *) ptr;\n    //OpenCV Code\n    //----------------------------------------------------------\n\n    Mat img, imgGray;\n    img = Mat::zeros(480, 640, CV_8UC1);\n    //make it continuous\n    if (!img.isContinuous())\n    {\n        img = img.clone();\n    }\n\n    int imgSize = img.total() * img.elemSize();\n    int bytes = 0;\n    int key;\n\n    //make img continuos\n    if (!img.isContinuous())\n    {\n        img = img.clone();\n        imgGray = img.clone();\n    }\n\n    std::cout &lt;&lt; \"Image Size:\" &lt;&lt; imgSize &lt;&lt; std::endl;\n\n    while (1)\n    {\n\n        /* get a frame from camera */\n        cap &gt;&gt; img;\n\n        //do video processing here \n        cvtColor(img, imgGray, CV_BGR2GRAY);\n\n        //send processed image\n        if ((bytes = send(socket, imgGray.data, imgSize, 0)) &lt; 0)\n        {\n            std::cerr &lt;&lt; \"bytes = \" &lt;&lt; bytes &lt;&lt; std::endl;\n            break;\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "macos", "qt", "macports"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1516832766, "post_id": 48432636, "comment_id": 83856640, "body": "Use QtCreator,  In addition to this you must use &lt;QDebug&gt; instead of &lt;Qdebug&gt;"}, {"owner": {"reputation": 26, "user_id": 9254811, "user_type": "registered", "profile_image": "https://graph.facebook.com/36820315/picture?type=large", "display_name": "Teera", "link": "https://stackoverflow.com/users/9254811/teera"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1516836530, "post_id": 48432636, "comment_id": 83858078, "body": "Not directly answer my question but thanks anyway."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1516836634, "post_id": 48432636, "comment_id": 83858099, "body": "Qt is a very extensive library, you need many flags to compile it, so if you want a good editor you should use QtCreator. If you do not want at least you should use qmake to generate an appropriate Makefile."}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 9254811, "user_type": "registered", "profile_image": "https://graph.facebook.com/36820315/picture?type=large", "display_name": "Teera", "link": "https://stackoverflow.com/users/9254811/teera"}, "edited": false, "score": 0, "creation_date": 1516854056, "post_id": 48434187, "comment_id": 83862533, "body": "Thanks.  Sorry for my ignorance, what is project.pro?  Is it from some kind of IDE?"}, {"owner": {"reputation": 64, "user_id": 908285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2e92d64682d50ea4a8c8dbd41ada0?s=128&d=identicon&r=PG", "display_name": "Longwei", "link": "https://stackoverflow.com/users/908285/longwei"}, "reply_to_user": {"reputation": 26, "user_id": 9254811, "user_type": "registered", "profile_image": "https://graph.facebook.com/36820315/picture?type=large", "display_name": "Teera", "link": "https://stackoverflow.com/users/9254811/teera"}, "edited": false, "score": 0, "creation_date": 1516893718, "post_id": 48434187, "comment_id": 83884409, "body": "project.pro the is the file normally generated by QtCreator. qmake binary parse this .pro file, and output makefile depends on your platform. If you are more familiar with CMake, project.pro is the equivalent of CMakeLists.txt in CMake."}], "tags": [], "owner": {"reputation": 64, "user_id": 908285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2e92d64682d50ea4a8c8dbd41ada0?s=128&d=identicon&r=PG", "display_name": "Longwei", "link": "https://stackoverflow.com/users/908285/longwei"}, "is_accepted": false, "score": -1, "last_activity_date": 1516842993, "creation_date": 1516842993, "answer_id": 48434187, "question_id": 48432636, "link": "https://stackoverflow.com/questions/48432636/how-to-link-qt-codes-to-c-codes-or-c-in-mac-using-macports/48434187#48434187", "title": "How to link Qt codes to C++ codes (or C) in Mac using Macports?", "body": "<p>Like linux system, in order to add a library to your project.\nYou need to tell makefile 3 things: </p>\n\n<ol>\n<li>what's your library name? (let's say it is mylib.dylib) </li>\n<li>where to find the library? (/usr/opt/lib) </li>\n<li>where to find headers? (/usr/opt/include/)</li>\n</ol>\n\n<p>for Qt, the makefile is generated by qmake from project.pro.\nYou need to add following to your project.pro</p>\n\n<pre><code>LIBS += -L/usr/opt/lib -lmylib\nINCLUDEPATH += /usr/opt/include/\nDEPENDPATH += /usr/opt/include/\n</code></pre>\n\n<p>OK, what's deal with DEPENDPATH?</p>\n\n<p>So if mylib is updated, should build system trigger a new build?</p>\n\n<p>the answer is normally yes. so it is a good idea add DEPENDPATH.</p>\n\n<p>see <a href=\"http://doc.qt.io/qt-5/qmake-variable-reference.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qmake-variable-reference.html</a> for more details.</p>\n"}], "owner": {"reputation": 26, "user_id": 9254811, "user_type": "registered", "profile_image": "https://graph.facebook.com/36820315/picture?type=large", "display_name": "Teera", "link": "https://stackoverflow.com/users/9254811/teera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516842993, "creation_date": 1516832353, "question_id": 48432636, "link": "https://stackoverflow.com/questions/48432636/how-to-link-qt-codes-to-c-codes-or-c-in-mac-using-macports", "title": "How to link Qt codes to C++ codes (or C) in Mac using Macports?", "body": "<p>I have installed Qt using Macports.  However, I do not know how to link Qt into the code ... what is the exact command to compile the code, the include path, library path and the name of the library.  Could any one help me with this?  I use clang and g++ as the main C++ compiler.</p>\n\n<pre><code>#include &lt;Qdebug&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    cout &lt;&lt; \"Test compilation.\";\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 2, "creation_date": 1516832405, "post_id": 48432618, "comment_id": 83856455, "body": "You say that your input is 3 numbers (8, 10 and 12) but your code takes 4 numbers."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1516832502, "post_id": 48432618, "comment_id": 83856503, "body": "How do you get 8, 10 and 12 to give you a mean of 11?"}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1516832517, "post_id": 48432618, "comment_id": 83856507, "body": "standard deviation requires dividing by one less. But variance is divided by n."}, {"owner": {"reputation": 51, "user_id": 2803082, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09350861f8044d27dbbb3aa7f8547d38?s=128&d=identicon&r=PG&f=1", "display_name": "user2803082", "link": "https://stackoverflow.com/users/2803082/user2803082"}, "edited": false, "score": 0, "creation_date": 1516832619, "post_id": 48432618, "comment_id": 83856553, "body": "my mistake, I just edited my post, there is indeed 4 inputs, I just accidentally left 1 out."}], "answers": [{"comments": [{"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 3, "creation_date": 1516832442, "post_id": 48432650, "comment_id": 83856482, "body": "This might be intended depending on if this is sample or population variance. See <a href=\"https://stats.stackexchange.com/questions/17890/what-is-the-difference-between-n-and-n-1-in-calculating-population-variance\" title=\"what is the difference between n and n 1 in calculating population variance\">stats.stackexchange.com/questions/17890/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 2803082, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09350861f8044d27dbbb3aa7f8547d38?s=128&d=identicon&r=PG&f=1", "display_name": "user2803082", "link": "https://stackoverflow.com/users/2803082/user2803082"}, "edited": false, "score": 1, "creation_date": 1516832547, "post_id": 48432650, "comment_id": 83856519, "body": "I looked up the formula for variance and it said to divide by n-1, I didn&#39;t realize there are two different types of variance. @frslm"}, {"owner": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "edited": false, "score": 0, "creation_date": 1516832612, "post_id": 48432650, "comment_id": 83856548, "body": "Scohe001 is right."}, {"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "reply_to_user": {"reputation": 51, "user_id": 2803082, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09350861f8044d27dbbb3aa7f8547d38?s=128&d=identicon&r=PG&f=1", "display_name": "user2803082", "link": "https://stackoverflow.com/users/2803082/user2803082"}, "edited": false, "score": 0, "creation_date": 1516832666, "post_id": 48432650, "comment_id": 83856578, "body": "@user2803082 If you must use the &quot;n-1&quot; formula, then why do you expect your variance to be 5, as mentioned in your question?"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1516832714, "post_id": 48432650, "comment_id": 83856609, "body": "@frslm I think the point is he was supposed to use one variance equation but mistakenly used the wrong one."}, {"owner": {"reputation": 51, "user_id": 2803082, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09350861f8044d27dbbb3aa7f8547d38?s=128&d=identicon&r=PG&f=1", "display_name": "user2803082", "link": "https://stackoverflow.com/users/2803082/user2803082"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1516832742, "post_id": 48432650, "comment_id": 83856625, "body": "Thank you @scohe001 I didn&#39;t think about how there is two different types of variance."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "reply_to_user": {"reputation": 51, "user_id": 2803082, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09350861f8044d27dbbb3aa7f8547d38?s=128&d=identicon&r=PG&f=1", "display_name": "user2803082", "link": "https://stackoverflow.com/users/2803082/user2803082"}, "edited": false, "score": 1, "creation_date": 1516833079, "post_id": 48432650, "comment_id": 83856789, "body": "@user2803082 taking another look at the link I gave, it&#39;s actually not a very good explanation (or what I was thinking). <a href=\"http://www.macroption.com/population-sample-variance-standard-deviation/\" rel=\"nofollow noreferrer\">This</a> is a far more explanatory link with both formulas."}], "tags": [], "owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "is_accepted": true, "score": 1, "last_activity_date": 1516832393, "creation_date": 1516832393, "answer_id": 48432650, "question_id": 48432618, "link": "https://stackoverflow.com/questions/48432618/where-is-my-mistake-in-calculating-the-variance-of-4-values/48432650#48432650", "title": "Where is my mistake in calculating the variance of 4 values?", "body": "<p>You've divided <code>var1+var2+var3+var4</code> by 3 rather than 4.</p>\n"}], "owner": {"reputation": 51, "user_id": 2803082, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09350861f8044d27dbbb3aa7f8547d38?s=128&d=identicon&r=PG&f=1", "display_name": "user2803082", "link": "https://stackoverflow.com/users/2803082/user2803082"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1516833129, "accepted_answer_id": 48432650, "answer_count": 1, "score": 0, "last_activity_date": 1516832590, "creation_date": 1516832251, "last_edit_date": 1516832590, "question_id": 48432618, "link": "https://stackoverflow.com/questions/48432618/where-is-my-mistake-in-calculating-the-variance-of-4-values", "closed_reason": "Not suitable for this site", "title": "Where is my mistake in calculating the variance of 4 values?", "body": "<p>I get the correct output for mean, but I do not get the correct output for variance. Sample input is 8, 10, 12, 14.</p>\n\n<p>It should output the mean as 11, and variance as 5. However, I get the mean is 11, and variance is 6.66667.</p>\n\n<pre><code>// Include statements\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\n// Main function\nint main ()\n{\n  // Input values\n  float n1, n2, n3, n4;\n  cout &lt;&lt; \"Enter four numbers:\\n\";\n  cin &gt;&gt; n1 &gt;&gt; n2 &gt;&gt; n3 &gt;&gt; n4;\n\n  // Calculate mean of 4 values\n  float mean;\n  mean = (n1+n2+n3+n4)/4;\n\n  // Calculate variance of 4 values\n  float variance;\n  float var1 = ((n1-mean)*(n1-mean));\n  float var2 = ((n2-mean)*(n2-mean));\n  float var3 = ((n3-mean)*(n3-mean));\n  float var4 = ((n4-mean)*(n4-mean));\n\n  variance = (var1+var2+var3+var4)/3;\n\n\n  // Print the output\n  cout &lt;&lt; \"mean = \" &lt;&lt; mean &lt;&lt; endl;\n  cout &lt;&lt; \"variance = \" &lt;&lt; variance &lt;&lt; endl;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "python-embedding"], "comments": [{"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1517040359, "post_id": 48432577, "comment_id": 83941302, "body": "Just to help your debugging, recall that a NULL return typically means that a Python exception was raised. You can call PyErr_Print() or similar to show which exception occurred."}], "answers": [{"tags": [], "owner": {"reputation": 2474, "user_id": 6664305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b8bd5952ac4906f4a632e9f6d0129890?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Torba", "link": "https://stackoverflow.com/users/6664305/dmitry-torba"}, "is_accepted": true, "score": 1, "last_activity_date": 1516836412, "creation_date": 1516836412, "answer_id": 48433353, "question_id": 48432577, "link": "https://stackoverflow.com/questions/48432577/extracting-value-from-python-after-its-embedded-in-c/48433353#48433353", "title": "Extracting value from Python after it&#39;s embedded in C++", "body": "<p>I have actually figured out how to do that myself. There is no need to use <code>eval()</code> in order to extract the result of the execution of the function. Instead, you can do the following:</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;iostream&gt;\n\nint main() {\n  // Initialize Python\n  Py_Initialize();\n\n  // Create a function\n  PyRun_SimpleString(\"f = lambda x: x * 2 - 3\");\n\n  // Import __main__ where the f is stored\n  PyObject *main = PyImport_ImportModule(\"__main__\");\n  PyObject *function = PyObject_GetAttrString(main, \"__function\");\n\n  // Create an argument tuple for the function\n  PyObject * args = PyTuple_New(1);\n  PyObject * first_argument = PyInt_FromLong(10);\n  PyTuple_SetItem(args, 0, first_argument);\n\n  // Call the function and get its result\n  PyObject * result = PyObject_CallObject(function, args);\n\n  // Output the result\n  cout &lt;&lt; PyInt_AsLong(result) &lt;&lt; endl;\n\n  // Destroy Python frame\n  Py_Finalize();\n}\n</code></pre>\n\n<p>However, I am still curious why <code>eval</code> did not work as shown in my original question</p>\n"}], "owner": {"reputation": 2474, "user_id": 6664305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b8bd5952ac4906f4a632e9f6d0129890?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Torba", "link": "https://stackoverflow.com/users/6664305/dmitry-torba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 1, "accepted_answer_id": 48433353, "answer_count": 1, "score": 3, "last_activity_date": 1516836412, "creation_date": 1516832025, "question_id": 48432577, "link": "https://stackoverflow.com/questions/48432577/extracting-value-from-python-after-its-embedded-in-c", "title": "Extracting value from Python after it&#39;s embedded in C++", "body": "<p>I have the following shortened program that embeds Python (it's stripped of all error handling, etc for shortness). It creates Python function as a string (which is required for my problem at hand) and then tries to call it and get whatever it returned using <code>__builtin__.eval</code>.</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;iostream&gt;\n\nint main() {\n  // Initialize Python\n  Py_Initialize();\n\n  // Import builtin to get an access to eval\n  PyObject *builtins = PyImport_ImportModule(\"__builtin__\");\n  PyObject *eval = PyObject_GetAttrString(builtins, \"eval\");\n\n  // Create an argument tuple for the eval\n  PyObject * args = PyTuple_New(1);\n  PyObject * name = PyString_FromString(\"f(10)\");\n  PyTuple_SetItem(args, 0, name);\n\n  // Create a function\n  PyRun_SimpleString(\"f = lambda x: x * 2 - 3\");\n\n  // Try to get the result of the function execution by calling eval on it\n  PyObject * result = PyObject_CallObject(eval, args);\n\n  // Fail if the result is null pointer\n  assert(result != NULL);\n\n  // Destroy Python frame\n  Py_Finalize();\n}\n</code></pre>\n\n<p>In other words, this program is analogous to the following Python program:</p>\n\n<pre><code>f = lambda x: x * 2 - 3\nimport __builtin__\nprint __builtin__.eval(\"f(10)\")\n</code></pre>\n\n<p>The problem is: it works flawlessly in Python (returning 17). But in C++, <code>PyObject_CallObject</code> returns NULL pointer and the program fails at assert, even though eval should clearly have returned the result of f(10). My question is why?</p>\n\n<p>Thank you for your answer!</p>\n\n<p>P.S. If you want to try to compile that yourself, use the following command on Unix systems (I am using it on Ubuntu):</p>\n\n<pre><code>g++ -I/usr/include/python2.7 progname.cpp -lpython2.7 -g\n</code></pre>\n"}, {"tags": ["c++", "class", "oop", "reference"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1516831562, "post_id": 48432442, "comment_id": 83856055, "body": "Because this is an <code>int</code>, which is a &quot;small&quot; value which is trivial to copy, taking the parameter by value is appropriate, but it was probably written as <code>const int &amp;</code> as habit for the types which are not small"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1516831610, "post_id": 48432442, "comment_id": 83856083, "body": "It isn&#39;t an address. It&#39;s a reference. For an integer there isn&#39;t much point, but for a million byte-long element, the time savings can be amazing."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516831685, "post_id": 48432442, "comment_id": 83856112, "body": "Related: <a href=\"https://stackoverflow.com/q/31402796/1896169\">stackoverflow.com/q/31402796/1896169</a> , <a href=\"https://stackoverflow.com/q/21035417/1896169\">stackoverflow.com/q/21035417/1896169</a> (although for some of the points made in those Q&amp;A, this <a href=\"https://stackoverflow.com/q/46549000/1896169\">Q</a> has some relevant discussion too)"}, {"owner": {"reputation": 2249, "user_id": 5162426, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/87ad09f80bf6b32bbbbdbc4930475607?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/5162426/anonymous"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516831691, "post_id": 48432442, "comment_id": 83856117, "body": "@user4581301 can you elaborate on the distinction?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516831994, "post_id": 48432442, "comment_id": 83856256, "body": "Please fix your title. It says &#39;getters&#39; but your question is about &#39;setters&#39;."}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "edited": false, "score": 0, "creation_date": 1516832077, "post_id": 48432442, "comment_id": 83856283, "body": "@Anonymous   <b>void setIntegerVar(int var)..</b> takes the parameter by value which means it copies it. However in <b>void setIntegerVar(const int &amp;var)...</b> it takes the reference. For POD types since they&#39;re relatively smaller in size it doesn&#39;t differ much but for user-defined types e.g with lots of member variables as they are bigger in size, pass-by-value will copy the whole object wheras pass-by-reference to will just copy its address which saves time and memory"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516832210, "post_id": 48432442, "comment_id": 83856346, "body": "A reference is an alias. A different name for something that already exists. There may or may not be any storage associated with the reference (the storage used by the variable referenced is another matter). A pointer is a variable that can store the location of another variable. For the nitty gritty details give this a read: <a href=\"https://stackoverflow.com/questions/57483/what-are-the-differences-between-a-pointer-variable-and-a-reference-variable-in\">What are the differences between a pointer variable and a reference variable in C++?</a>"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1516832217, "post_id": 48432442, "comment_id": 83856351, "body": "Here&#39;s an example where passing by reference makes a big difference: <a href=\"https://www.reddit.com/r/cpp/comments/7r2e2j/question_about_surprising_performance_benchmark/?ref=share&amp;ref_source=link\" rel=\"nofollow noreferrer\">reddit.com/r/cpp/comments/7r2e2j/&hellip;</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516832918, "post_id": 48432442, "comment_id": 83856714, "body": "Side note on setters: A setter that is public and does nothing to ensure the provided value causes no harm to the object or provide some other service is useful only as a place to hang a debugger breakpoint. By itself this is a good thing, but if you approach from the goal of encapsulation, encapsulation has been broken. Anyone can set the value to anything and there&#39;s nothing the object can do to defend itself. A good setter is gatekeeper protecting the object from harm, even if that&#39;s only by announcing the change."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1516837342, "post_id": 48432442, "comment_id": 83858292, "body": "<a href=\"http://www.yegor256.com/2014/09/16/getters-and-setters-are-evil.html\" rel=\"nofollow noreferrer\">yegor256.com/2014/09/16/getters-and-setters-are-evil.html</a>"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1516837377, "post_id": 48432442, "comment_id": 83858297, "body": "<a href=\"https://martinfowler.com/bliki/TellDontAsk.html\" rel=\"nofollow noreferrer\">martinfowler.com/bliki/TellDontAsk.html</a>"}], "owner": {"reputation": 2249, "user_id": 5162426, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/87ad09f80bf6b32bbbbdbc4930475607?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/5162426/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "closed_date": 1516832703, "answer_count": 0, "score": 0, "last_activity_date": 1516832015, "creation_date": 1516831460, "last_edit_date": 1516832015, "question_id": 48432442, "link": "https://stackoverflow.com/questions/48432442/why-should-a-setter-method-take-an-address-rather-than-a-value", "closed_reason": "Duplicate", "title": "Why should a setter method take an address rather than a value?", "body": "<p>I'm looking at some source code with a large class, containing lots of getters and setters. All of the setters look generally like this:</p>\n\n<pre><code>void setIntegerVar(const int &amp;var) {local_var = var;}\n</code></pre>\n\n<p>What is the motivation behind declaring the setter's argument to be an address like this? Why not just</p>\n\n<pre><code>void setIntegerVar(int var) {local_var = var;}\n</code></pre>\n\n<p>I assume that the answer is because the latter is not an efficient use of memory, and will be copying <code>var</code> somewhere else other than where the caller is storing it. In either case, why should <code>const</code> be necessary?</p>\n"}, {"tags": ["c++", "c++11", "templates", "template-specialization", "sfinae"], "comments": [{"owner": {"reputation": 8790, "user_id": 1261432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3cd64a8b152ef096abdd8d03925bf34?s=128&d=identicon&r=PG&f=1", "display_name": "Synxis", "link": "https://stackoverflow.com/users/1261432/synxis"}, "edited": false, "score": 1, "creation_date": 1516831311, "post_id": 48432342, "comment_id": 83855932, "body": "What you want is concepts, which will (hopefully) come in C++20. Meanwhile, it is more or less possible to do it, but this won&#39;t be that clean / simple. What is your use case ?"}, {"owner": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "reply_to_user": {"reputation": 8790, "user_id": 1261432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3cd64a8b152ef096abdd8d03925bf34?s=128&d=identicon&r=PG&f=1", "display_name": "Synxis", "link": "https://stackoverflow.com/users/1261432/synxis"}, "edited": false, "score": 0, "creation_date": 1516831840, "post_id": 48432342, "comment_id": 83856184, "body": "I have a searching problem to which I have 5 different solutions. I&#39;ve coded each solution in a separate cpp file. Now I want to test these solutions and compare their performance, in particular I want to test the search functionality. So I built a generic test class that uses the search function. What I would like to do is plug in the class name of each solution and the test runs on its own and gives me the results."}, {"owner": {"reputation": 607, "user_id": 6243726, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1adb79bb70c6a3db74d7e9512b9c69e4?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/6243726/francis"}, "edited": false, "score": 2, "creation_date": 1516869643, "post_id": 48432342, "comment_id": 83868428, "body": "<code>T.search(x)</code>?  Shouldn&#39;t suppose to be <code>T::search(x)</code> or something like<code>T().search(x)</code>? BTW, your class template will generate an ill-formed code when you instantiate it with a <code>T</code> doesn&#39;t has a member function <code>search</code>. That&#39;s also a kind of restriction."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 8790, "user_id": 1261432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3cd64a8b152ef096abdd8d03925bf34?s=128&d=identicon&r=PG&f=1", "display_name": "Synxis", "link": "https://stackoverflow.com/users/1261432/synxis"}, "edited": false, "score": 0, "creation_date": 1516870462, "post_id": 48432342, "comment_id": 83868878, "body": "@Synxis: That can already be done by SFINAE. No need for concepts! But indeed, concepts will make it a lot easier!"}, {"owner": {"reputation": 1157, "user_id": 6261163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927deeb08bce28096a053a9e33f1a713?s=128&d=identicon&r=PG&f=1", "display_name": "ROX", "link": "https://stackoverflow.com/users/6261163/rox"}, "edited": false, "score": 1, "creation_date": 1516902280, "post_id": 48432342, "comment_id": 83890456, "body": "If T has no search function, then attempting to use A&lt;T&gt; will fail to compile. What more restriction would you require?"}, {"owner": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "reply_to_user": {"reputation": 1157, "user_id": 6261163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927deeb08bce28096a053a9e33f1a713?s=128&d=identicon&r=PG&f=1", "display_name": "ROX", "link": "https://stackoverflow.com/users/6261163/rox"}, "edited": false, "score": 0, "creation_date": 1516914519, "post_id": 48432342, "comment_id": 83896863, "body": "@ROX so is it ok to use search without declaring it anyway in the generic template?"}, {"owner": {"reputation": 1157, "user_id": 6261163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927deeb08bce28096a053a9e33f1a713?s=128&d=identicon&r=PG&f=1", "display_name": "ROX", "link": "https://stackoverflow.com/users/6261163/rox"}, "edited": false, "score": 0, "creation_date": 1516964044, "post_id": 48432342, "comment_id": 83912682, "body": "if T implements search its OK, If you try to use a T that does not implement search then you&#39;ll get a compile time error. In C# you would have to declare that T had a search by declaring that it implemented a certain interface (declared beforehand to contain search), but you don&#39;t need to do the same for C++."}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1516833152, "last_edit_date": 1516833152, "creation_date": 1516831949, "answer_id": 48432563, "question_id": 48432342, "link": "https://stackoverflow.com/questions/48432342/is-there-a-wayin-c-to-create-a-template-class-that-implements-certain-functi/48432563#48432563", "title": "Is there a way(in C++) to create a template class that implements certain functions?", "body": "<blockquote>\n  <p>I want to create a generic class that works for all classes that have the search functionality. Is there a way to do this?</p>\n</blockquote>\n\n<p>By example, using <code>decltype()</code> as follows</p>\n\n<pre><code>template &lt;typename T,\n          typename = decltype(std::declval&lt;T&gt;().search(std::declval&lt;T&gt;()))&gt;\nclass A\n {\n };\n</code></pre>\n\n<p>The following is a full compiling example for a <code>size()</code> enabled <code>class A</code></p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename T, typename = decltype(std::declval&lt;T&gt;().size())&gt;\nclass A\n {\n };\n\nint main()\n {\n   A&lt;std::string&gt;  as;\n   //A&lt;int&gt;          ai;  // compilation error\n }\n</code></pre>\n\n<p>There is a drawback in this solution: you can hijack it explicating the second template parameter; by example, the following code compile</p>\n\n<pre><code>A&lt;int, void&gt;  ai;\n</code></pre>\n\n<p>To avoid this problem you can use partial specialization as follows</p>\n\n<pre><code>template &lt;typename T,\n          typename = decltype(std::declval&lt;T&gt;().search(std::declval&lt;T&gt;()))&gt;\nclass A;\n\ntemplate &lt;typename T&gt;\nclass A&lt;T&gt;\n {\n };\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 48432563, "answer_count": 1, "score": 0, "last_activity_date": 1516914358, "creation_date": 1516831096, "last_edit_date": 1516914358, "question_id": 48432342, "link": "https://stackoverflow.com/questions/48432342/is-there-a-wayin-c-to-create-a-template-class-that-implements-certain-functi", "title": "Is there a way(in C++) to create a template class that implements certain functions?", "body": "<p>I want to create a class that accepts only certain types of template classes. I know that there exists template specialization, but I want my class to accept all templates that implement a specific function, search.</p>\n\n<p>Let's say I have a <code>class A</code> as follows:</p>\n\n<pre><code>template&lt;class T&gt; //add a restriction that T implements bool search(T)\nclass A\n{\n    T t;\n    //do something that uses T.search(T x)\n    if(t.search(x))\n        //Do something\n};\n</code></pre>\n\n<p>So basically, I want to create a generic class that works for all classes that have the search functionality. Is there a way to do this?</p>\n"}, {"tags": ["c++", "qt"], "answers": [{"tags": [], "owner": {"reputation": 657, "user_id": 4325153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1Uh6h.jpg?s=128&g=1", "display_name": "Stanton", "link": "https://stackoverflow.com/users/4325153/stanton"}, "is_accepted": true, "score": 2, "last_activity_date": 1516833806, "creation_date": 1516833806, "answer_id": 48432928, "question_id": 48432345, "link": "https://stackoverflow.com/questions/48432345/qt-pro-file-get-qtkit-name/48432928#48432928", "title": "Qt .pro file get Qtkit name", "body": "<p>Looks  like I figured it out on my own. The term I was looking for was stored in the <code>CONFIG</code> variable.</p>\n\n<p>if you do a <code>message($$CONFIG)</code>, you will see a whole bunch of stuff printed, but the one you're looking for is the <code>win32-msvc2013</code> or <code>win32-msvc2015</code> items.</p>\n\n<p>So a check on this would look something like the following:</p>\n\n<pre><code>CONFIG(\"win32-msvc2013\") {\n    # do something specific to the msvc2013 kit\n}\nCONFIG(\"win32-msvc2015\") {\n    # do something else specific to the msvc2015 kit\n}\n</code></pre>\n"}], "owner": {"reputation": 657, "user_id": 4325153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1Uh6h.jpg?s=128&g=1", "display_name": "Stanton", "link": "https://stackoverflow.com/users/4325153/stanton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48432928, "answer_count": 1, "score": 2, "last_activity_date": 1516833806, "creation_date": 1516831094, "question_id": 48432345, "link": "https://stackoverflow.com/questions/48432345/qt-pro-file-get-qtkit-name", "title": "Qt .pro file get Qtkit name", "body": "<p>I have a Qt project that is dependent on other 3rd party libraries that I've compiled from source. When compiling these 3rd party libraries I specify what Qt kit to use for compiling (as these 3rd party libs are dependent on Qt)</p>\n\n<p>For example, these 3rd party libs might have been compiled using Qt5.9.2_x64_msvc2015, they also might have been compiled using Qt5.7.2_x64_msvc2013.</p>\n\n<p>So in the project I'm developing, if I want to compile using the Qt5.9.2_x64_msvc2015 kit, then I would like the project to automatically switch the <code>LIBS</code> and <code>INCLUDEPATH</code> to the 3rd party libraries that I compiled with the same Qt kit.</p>\n\n<p>I know I can use the <code>QT_MAJOR_VERSION</code>, <code>QT_MINOR_VERSION</code>, and <code>QT_PATCH_VERSION</code> to check what \"version\" of the qt kit I'm using, but how could I get in the .pro file if the kit being used is <code>x64</code> vs <code>x86</code> as well as <code>msvc2013</code> vs <code>msvc2015</code>?</p>\n"}, {"tags": ["c++", "pointers", "static-cast"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1516830884, "post_id": 48432270, "comment_id": 83855690, "body": "<code>const PVOID</code> &quot;is&quot; <code>const (void *)</code> which is <code>void * const</code>, so a constant pointer to void, whereas CPVOID is a pointer to constant void"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1516830952, "post_id": 48432270, "comment_id": 83855729, "body": "<a href=\"https://stackoverflow.com/q/2253738/1896169\">Some</a> <a href=\"https://stackoverflow.com/q/1808471/1896169\">things</a> that are near duplicates. Together with <a href=\"https://stackoverflow.com/q/1143262/1896169\">this</a>, that should complete all the information needed to answer this question"}], "owner": {"reputation": 239, "user_id": 2464169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6263742c33ce18d5c232d88820547b9c?s=128&d=identicon&r=PG", "display_name": "Vizor", "link": "https://stackoverflow.com/users/2464169/vizor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "closed_date": 1516834489, "answer_count": 0, "score": 0, "last_activity_date": 1516830816, "creation_date": 1516830816, "question_id": 48432270, "link": "https://stackoverflow.com/questions/48432270/why-i-cannot-static-cast-from-const-char-to-const-pvoid-typedef-void", "closed_reason": "Duplicate", "title": "Why I cannot `static_cast` from `const char *` to `const PVOID` (`typedef void *`)?", "body": "<p>But <code>static_cast</code> from <code>const char *</code> to <code>CPVOID</code>, which is <code>typedef const void *</code>, is seamless.</p>\n\n<p>Is there some difference between <code>const PVOID</code> and <code>CPVOID</code>, that I don't understand?</p>\n\n<p>Code:</p>\n\n<pre><code>typedef void * PVOID;\ntypedef const void * CPVOID;\n\nint main()\n{\n    const char * c = nullptr;\n\n    CPVOID e = static_cast&lt;CPVOID&gt;(c);             // Ok\n    const PVOID f = static_cast&lt;const PVOID&gt;(c);   // Error\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/eca6956ed5ad8ba3\" rel=\"nofollow noreferrer\">Wider example on Coliru</a></p>\n"}, {"tags": ["c++", "arrays", "pointers"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1516830726, "post_id": 48432199, "comment_id": 83855613, "body": "How do you define &quot;working&quot;?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1516830796, "post_id": 48432199, "comment_id": 83855643, "body": "Both what you do and <code>arr + 0x100</code> are equally undefined."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1516830821, "post_id": 48432199, "comment_id": 83855657, "body": "um.  Like reading 254 entries off then end of the array?  Sorry, but reading past the end of an array is never clean or good practice.  Either way is also UB."}, {"owner": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1516831032, "post_id": 48432199, "comment_id": 83855768, "body": "@StoryTeller I don&#39;t think it&#39;s equivalent. Logically it is, but <code>&amp;arr[0x100]</code> is equivalent to <code>*(arr+0x100)</code> which derefences the address and thus is undefined behavior. <code>arr + 0x100</code> is just an adress computation."}, {"owner": {"reputation": 312, "user_id": 4984257, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/646010c759c5ce7394bed0d9ff9021a9?s=128&d=identicon&r=PG&f=1", "display_name": "iBent", "link": "https://stackoverflow.com/users/4984257/ibent"}, "edited": false, "score": 0, "creation_date": 1516831054, "post_id": 48432199, "comment_id": 83855781, "body": "I only do this to calculate the pointer to the theoretical member and never want to access any data."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 1, "creation_date": 1516831089, "post_id": 48432199, "comment_id": 83855802, "body": "@Jens - This isn&#39;t what I think. This is what the C++ standard says about pointer arithmetic."}, {"owner": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1516831482, "post_id": 48432199, "comment_id": 83856028, "body": "@StoryTeller I am not concerned about the addition which is of course valid. But then &#167;5.2.1 includes the dereferencing of the result."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 1, "creation_date": 1516831753, "post_id": 48432199, "comment_id": 83856143, "body": "@Jens - The addition is not valid, no matter how much one may think it is. Says as much in black and white over at &#167;5.7.5"}, {"owner": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1516832093, "post_id": 48432199, "comment_id": 83856292, "body": "@StoryTeller And you are right again. I found the reference in $8.7.4 where it says that &quot;P + J and J + P (where J has the value j) point to the (possibly-hypothetical) element x[i + j] if 0 &lt;= i + j &lt;= n; otherwise, the behavior is undefined.&quot;. Thanks."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 0, "creation_date": 1516832179, "post_id": 48432199, "comment_id": 83856330, "body": "@Jens - Well, you aren&#39;t far off the mark yourself. Most compilers I worked with go the length of making it defined. It&#39;s just that one should be careful when picking an implementation to read the fine print on this matter."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1516830914, "post_id": 48432280, "comment_id": 83855706, "body": "Site the standard or give a bit more reason as to why this is UB.  This answer is only a comment as it stands."}, {"owner": {"reputation": 312, "user_id": 4984257, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/646010c759c5ce7394bed0d9ff9021a9?s=128&d=identicon&r=PG&f=1", "display_name": "iBent", "link": "https://stackoverflow.com/users/4984257/ibent"}, "edited": false, "score": 0, "creation_date": 1516830939, "post_id": 48432280, "comment_id": 83855720, "body": "Well, I never really access the data as it should only give me the pointer to the theoretical member at 0x100."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1516831035, "post_id": 48432280, "comment_id": 83855769, "body": "@MichaelDorgan I don&#39;t think that the statement &quot;accessing memory you don&#39;t own is UB&quot; requires documentation. I <b>do</b> however think that he needs to explain the implicit assumption that the memory is actually &quot;accessed&quot; (as OP doesn&#39;t seem to understand what the subscript operator is doing)"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1516831139, "post_id": 48432280, "comment_id": 83855837, "body": "Actually,  I think OP (Original OP - lol) does - he states as much.  Regardless, I was pretty sure that pointer arithmetic more than 1 entry past the end of owned memory was considered UB as well - deferenced or not.  I saw this in another post earlier today.  Hmm..."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1516831329, "post_id": 48432280, "comment_id": 83855943, "body": "&quot;<i>Well, I never really access the data</i>&quot; makes it sound like he doesn&#39;t realize it&#39;s actually de-referencing. But I don&#39;t believe pointer arithmetic outside owned memory should be UB...I&#39;d be happy to be proved wrong on this one if you can find that post tho! :)"}, {"owner": {"reputation": 350, "user_id": 5667718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7a984655c6836629b1609398e18f64?s=128&d=identicon&r=PG&f=1", "display_name": "Ernie Mur", "link": "https://stackoverflow.com/users/5667718/ernie-mur"}, "edited": false, "score": 0, "creation_date": 1516833129, "post_id": 48432280, "comment_id": 83856816, "body": "I wrote &quot;access&quot; memory outside the range because of the [] operator. According to my understanding, it first accesses the integer which is not existing and only after this the address is evaluated. But it is never good practice, as the original question was. I still don&#39;t understand what the OP wanted to achieve with this term."}, {"owner": {"reputation": 350, "user_id": 5667718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7a984655c6836629b1609398e18f64?s=128&d=identicon&r=PG&f=1", "display_name": "Ernie Mur", "link": "https://stackoverflow.com/users/5667718/ernie-mur"}, "reply_to_user": {"reputation": 312, "user_id": 4984257, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/646010c759c5ce7394bed0d9ff9021a9?s=128&d=identicon&r=PG&f=1", "display_name": "iBent", "link": "https://stackoverflow.com/users/4984257/ibent"}, "edited": false, "score": 0, "creation_date": 1516834065, "post_id": 48432280, "comment_id": 83857220, "body": "@iBent: I do not see a connection between your first code snipet and your function &quot;removeFirst&quot;. The function works, if m_size is the size of the array, here 2, and T ist an int. You just move the contents of the array one integer distance to the lower index. But why would one need to access an int outside the array in C++?"}, {"owner": {"reputation": 312, "user_id": 4984257, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/646010c759c5ce7394bed0d9ff9021a9?s=128&d=identicon&r=PG&f=1", "display_name": "iBent", "link": "https://stackoverflow.com/users/4984257/ibent"}, "edited": false, "score": 0, "creation_date": 1516834718, "post_id": 48432280, "comment_id": 83857472, "body": "@Ernie Mur yeah, I admit that my example is a bit bad. I actually meant &quot;if (m_size) m_size--;&quot;. Consider m_size being 0 when the function is being called. (ofc &quot;if (m_size == 0) return;&quot; would be better here)."}], "tags": [], "owner": {"reputation": 350, "user_id": 5667718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7a984655c6836629b1609398e18f64?s=128&d=identicon&r=PG&f=1", "display_name": "Ernie Mur", "link": "https://stackoverflow.com/users/5667718/ernie-mur"}, "is_accepted": false, "score": 0, "last_activity_date": 1516929379, "last_edit_date": 1516929379, "creation_date": 1516830854, "answer_id": 48432280, "question_id": 48432199, "link": "https://stackoverflow.com/questions/48432199/c-array-out-of-range-access-to-calculate-pointer-valid/48432280#48432280", "title": "C++ Array out of Range access to calculate pointer valid?", "body": "<p>In the first line you allocate 2 integer values. In the second line, you access memory outside this range. This is not allowed at all.</p>\n\n<p>Edit: Some interesting comments here. But I cannot understand, why it should be needed to cite the standard for such a simple answer and why is pointer arithmetic discussed here so much?</p>\n\n<p>From a logical view, std::cout &lt;&lt; &amp;arr[0x100] consists of 3 steps:\n1. access the non existing member of an array\n2. get the address of the non existing member\n3. use the address of the non existing member</p>\n\n<p>If the first step is invalid, aren't all the following undefined?</p>\n"}, {"comments": [{"owner": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 0, "creation_date": 1516832164, "post_id": 48432591, "comment_id": 83856322, "body": "I recommend to read <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">blog.llvm.org/2011/05/what-every-c-programmer-should-know.ht&zwnj;&#8203;ml</a> ..."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1516832883, "post_id": 48432591, "comment_id": 83856694, "body": "<i>&quot;C++ allows getting these addresses&quot;</i> - No it doesn&#39;t, the standard says it&#39;s UB"}, {"owner": {"reputation": 684, "user_id": 7117084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJwkv.jpg?s=128&g=1", "display_name": "9Breaker", "link": "https://stackoverflow.com/users/7117084/9breaker"}, "reply_to_user": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 0, "creation_date": 1516832996, "post_id": 48432591, "comment_id": 83856743, "body": "@Jens Thanks for the link, I updated based on the info. Very helpful."}, {"owner": {"reputation": 684, "user_id": 7117084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJwkv.jpg?s=128&g=1", "display_name": "9Breaker", "link": "https://stackoverflow.com/users/7117084/9breaker"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1516833024, "post_id": 48432591, "comment_id": 83856760, "body": "@UnholySheep true, taken out."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1516833076, "post_id": 48432591, "comment_id": 83856788, "body": "Now this answer still makes it sound like the code doesn&#39;t invoke UB - it does, just like your sample code. The pointer arithmetic is also UB"}, {"owner": {"reputation": 684, "user_id": 7117084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJwkv.jpg?s=128&g=1", "display_name": "9Breaker", "link": "https://stackoverflow.com/users/7117084/9breaker"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1516834282, "post_id": 48432591, "comment_id": 83857315, "body": "@UnholySheep thanks for the help, I saw my flaw there and edited accordingly. Do you agree now?"}, {"owner": {"reputation": 684, "user_id": 7117084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJwkv.jpg?s=128&g=1", "display_name": "9Breaker", "link": "https://stackoverflow.com/users/7117084/9breaker"}, "reply_to_user": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 0, "creation_date": 1516834310, "post_id": 48432591, "comment_id": 83857321, "body": "@Jens, do you agree with this answer now? I appreciate the help."}], "tags": [], "owner": {"reputation": 684, "user_id": 7117084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJwkv.jpg?s=128&g=1", "display_name": "9Breaker", "link": "https://stackoverflow.com/users/7117084/9breaker"}, "is_accepted": false, "score": 1, "last_activity_date": 1516834748, "last_edit_date": 1516834748, "creation_date": 1516832087, "answer_id": 48432591, "question_id": 48432199, "link": "https://stackoverflow.com/questions/48432199/c-array-out-of-range-access-to-calculate-pointer-valid/48432591#48432591", "title": "C++ Array out of Range access to calculate pointer valid?", "body": "<p>With my compiler (Cygwin GCC) getting the address at this value is the same as doing pointer arithmetic, although each is undefined behavior (UB). As mentioned in the comment below by Jens, at <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html</a>, I found the following helpful. </p>\n\n<blockquote>\n  <p>It is also worth pointing out that both Clang and GCC nail down a few behaviors that the C standard leaves undefined. The things I'll describe are both undefined according to the standard and treated as undefined behavior by both of these compilers in their default modes.</p>\n  \n  <p>Dereferences of Wild Pointers and Out of Bounds Array Accesses: Dereferencing random pointers (like NULL, pointers to free'd memory, etc) and the special case of accessing an array out of bounds is a common bug in C applications which hopefully needs no explanation. To eliminate this source of undefined behavior, array accesses would have to each be range checked, and the ABI would have to be changed to make sure that range information follows around any pointers that could be subject to pointer arithmetic. This would have an extremely high cost for many numerical and other applications, as well as breaking binary compatibility with every existing C library.</p>\n</blockquote>\n\n<p>The pointer arithmetic is also UB. So you have an address, but you cannot dereference the pointer to it. So there is really no use in having this address at all. Just getting the address is UB and should not be used in code. </p>\n\n<p>See this answer for out-of-bounds pointers:\n<a href=\"https://stackoverflow.com/questions/10473573/why-is-out-of-bounds-pointer-arithmetic-undefined-behaviour\">Why is out-of-bounds pointer arithmetic undefined behaviour?</a></p>\n\n<p>My sample code:</p>\n\n<pre><code>    int* arr = new int[2];\n    std::cout &lt;&lt; arr &lt;&lt; std::endl;\n    std::cout &lt;&lt; &amp;(arr[0])&lt;&lt; std::endl;\n    std::cout &lt;&lt; &amp;(arr[1])&lt;&lt; std::endl;\n    std::cout &lt;&lt; &amp;arr[0x100] &lt;&lt; std::endl; // UB, cannot be dereferenced\n    std::cout &lt;&lt; &amp;arr[256] &lt;&lt; std::endl;   // cannot be dereferenced, so no use in having it\n    std::cout &lt;&lt; arr + 0x100; // UB here too, no use in having this address \n</code></pre>\n\n<p>Sample Output:</p>\n\n<pre><code>0x60003ae50\n0x60003ae50\n0x60003ae54\n0x60003b250\n0x60003b250\n0x60003b250\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 4984257, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/646010c759c5ce7394bed0d9ff9021a9?s=128&d=identicon&r=PG&f=1", "display_name": "iBent", "link": "https://stackoverflow.com/users/4984257/ibent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1516929379, "creation_date": 1516830591, "last_edit_date": 1516834921, "question_id": 48432199, "link": "https://stackoverflow.com/questions/48432199/c-array-out-of-range-access-to-calculate-pointer-valid", "title": "C++ Array out of Range access to calculate pointer valid?", "body": "<p>Is the following code guaranteed to be working?</p>\n\n<pre><code>int* arr = new int[2];\nstd::cout &lt;&lt; &amp;arr[0x100];\n</code></pre>\n\n<p>Is this considered good practice or would it be cleaner to add an offset the regular way?</p>\n\n<p>Edit: By \"working\" I mean that it should print the pointer to the theoretical member at 0x100. Basically if this is equivalent to \"std::cout &lt;&lt; ((unsigned int)arr + 0x100*sizeof(int));\".</p>\n"}, {"tags": ["c++", "for-loop", "vector"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516830651, "post_id": 48432185, "comment_id": 83855569, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/ascii\" rel=\"nofollow noreferrer\">ascii</a>, but I believe that C++ doesn&#39;t place too many requirements on the exact char encoding (i.e. doesn&#39;t have to be ascii). Although in practice, I don&#39;t know if there&#39;s any platform that wouldn&#39;t be ascii"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516835286, "post_id": 48432185, "comment_id": 83857683, "body": "@Justin: There is also <a href=\"https://en.wikipedia.org/wiki/EBCDIC\" rel=\"nofollow noreferrer\">EBCDIC</a> instead of Ascii (even if not really used)."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1516838045, "post_id": 48432185, "comment_id": 83858473, "body": "Since you are using literal characters (and of course correctly telling your compiler the source character encoding), the character encoding in question is whatever you are telling it to use as the execution character encoding (gcc <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Invocation.html\" rel=\"nofollow noreferrer\">-fexec-charset</a>; msvc:<a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/execution-charset-set-execution-character-set\" rel=\"nofollow noreferrer\">/execution-charset</a> ). Neither is likely to be ASCII. Maybe UTF-8. Maybe Windows-1252. Whatever it is, you are in control and are creating a contract with your users."}], "answers": [{"tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 1, "last_activity_date": 1516830691, "creation_date": 1516830691, "answer_id": 48432238, "question_id": 48432185, "link": "https://stackoverflow.com/questions/48432185/what-is-the-order-of-characters-when-looping-through/48432238#48432238", "title": "What is the order of characters when looping through", "body": "<p>Each character has an ASCII code. </p>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/ASCII</a></p>\n\n<p>It just so happens that some symbols, but not all are located between '9' and 'A'.</p>\n\n<p>As others have pointed out, it's probably not even guaranteed which symbols are where in that table. But I guess 'A' to 'Z', 'a' to 'z' and '0' to '9' are guaranteed to be contiguous.</p>\n\n<p>Also, see:\n<a href=\"https://stackoverflow.com/questions/29381067/does-c-and-c-guarantee-the-ascii-of-a-f-and-a-f-characters\">Does C and C++ guarantee the ASCII of [a-f] and [A-F] characters?</a></p>\n"}, {"tags": [], "owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "is_accepted": false, "score": 2, "last_activity_date": 1516830730, "creation_date": 1516830730, "answer_id": 48432247, "question_id": 48432185, "link": "https://stackoverflow.com/questions/48432185/what-is-the-order-of-characters-when-looping-through/48432247#48432247", "title": "What is the order of characters when looping through", "body": "<p>I think the following will be of help to you:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JHpOu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JHpOu.png\" alt=\"enter image description here\"></a></p>\n\n<p>What that means is, if you start your loop from '0' character, that corresponds to number 48 in that table. You are simply incrementing from there and going up until 'Z'. If you want just the alphanumeric characters, just seperate your loop to two pieces.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1516832081, "last_edit_date": 1516832081, "creation_date": 1516831752, "answer_id": 48432514, "question_id": 48432185, "link": "https://stackoverflow.com/questions/48432185/what-is-the-order-of-characters-when-looping-through/48432514#48432514", "title": "What is the order of characters when looping through", "body": "<blockquote>\n  <p>(b) what is the order of this?</p>\n</blockquote>\n\n<p>It is the order specified in the native character encoding of the system that you use. It is probably one of ASCII, ISO/IEC 8859 or UTF-8 all of which are identical in the range [0, 128).</p>\n\n<blockquote>\n  <p>Why do they have some symbols after the numbers but not all of them?</p>\n</blockquote>\n\n<p>Because some of the symbols are before the numbers, and some more are after the letters.</p>\n\n<p>That's just the order that was chosen by whatever committee designed the encoding. There's not necessarily a deep philosophy behind that choice. It may be an anomaly inherited from teletype codes that preceded computer systems.</p>\n\n<blockquote>\n  <p>How can I (a) get all of the characters</p>\n</blockquote>\n\n<p>You can use numeric limits to find the minimum and maximum values, and a loop to iterate over them:</p>\n\n<pre><code>for(int i = std::numeric_limits&lt;char&gt;::min();\n        i &lt; std::numeric_limits&lt;char&gt;::max(); i++) {\n    char c = i;\n    Chars.push_back(c);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9115014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2900ea47b6ed449397880aa82fbe705a?s=128&d=identicon&r=PG&f=1", "display_name": "MicroWither", "link": "https://stackoverflow.com/users/9115014/microwither"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 48432514, "answer_count": 3, "score": 1, "last_activity_date": 1516832081, "creation_date": 1516830525, "question_id": 48432185, "link": "https://stackoverflow.com/questions/48432185/what-is-the-order-of-characters-when-looping-through", "title": "What is the order of characters when looping through", "body": "<p>Alright so this is super hard to put in words. So I have some code:</p>\n\n<pre><code>vector &lt;char&gt; Chars;\nfor(char c = '0'; c &lt;='z'; c++) {\n    Chars.push_back(c);\n}\n</code></pre>\n\n<p>And so it helps with adding characters to my character <code>vector</code> because it will add the select amount. Example:</p>\n\n<pre><code>vector &lt;char&gt; Chars;\nfor(char c = '0'; c &lt;='9'; c++) {\n    Chars.push_back(c);\n}\n</code></pre>\n\n<p>Gets you 0123456789 and:</p>\n\n<pre><code>vector &lt;char&gt; Chars;\nfor(char c = '0'; c &lt;='Z'; c++) {\n    Chars.push_back(c);\n}\n</code></pre>\n\n<p>Gets you 0123456789:;&lt;=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ. How can I (a) get all of the characters and (b) what is the order of this? Why do they have some symbols after the numbers but not all of them?</p>\n"}, {"tags": ["c++", "hash"], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1516830231, "creation_date": 1516830231, "answer_id": 48432107, "question_id": 48431937, "link": "https://stackoverflow.com/questions/48431937/crypthashdata-returns-error-invalid-parameter-capi/48432107#48432107", "title": "CryptHashData returns ERROR_INVALID_PARAMETER (CAPI)", "body": "<pre><code>if (!CryptHashData(\n    hHashKeyProvider,\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (!CryptHashData(\n    hHash,\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "is_accepted": true, "score": 2, "last_activity_date": 1516830279, "creation_date": 1516830279, "answer_id": 48432123, "question_id": 48431937, "link": "https://stackoverflow.com/questions/48431937/crypthashdata-returns-error-invalid-parameter-capi/48432123#48432123", "title": "CryptHashData returns ERROR_INVALID_PARAMETER (CAPI)", "body": "<p>Watch out, you've accidentally passed <code>hHashKeyProvider</code> instead of <code>hHash</code> into <code>CryptHashData()</code>.</p>\n\n<p>In addition, your <code>GetLastError()</code> call should come before <code>CryptReleaseContext()</code>, otherwise an error in the latter might seem like it came from <code>CryptHashData()</code> instead.</p>\n"}], "owner": {"reputation": 939, "user_id": 1246117, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e7ff09de72724c2415872886fc1f9bf?s=128&d=identicon&r=PG", "display_name": "Timothy John Laird", "link": "https://stackoverflow.com/users/1246117/timothy-john-laird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 48432123, "answer_count": 2, "score": 1, "last_activity_date": 1516830279, "creation_date": 1516829517, "question_id": 48431937, "link": "https://stackoverflow.com/questions/48431937/crypthashdata-returns-error-invalid-parameter-capi", "title": "CryptHashData returns ERROR_INVALID_PARAMETER (CAPI)", "body": "<p>CryptHashData (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa380202(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa380202(v=vs.85).aspx</a>) is consistently returning FALSE. When I call GetLastError I am returned a value of 87 which is constant ERROR_INVALID_PARAMETER. I have verified my parameters (MSDN notes said to check pointers passed in) and everything looks OK. I've put it as close to the MSDN code sample as possible.</p>\n\n<p>My goal is simply to hash a password and derive a key from it.</p>\n\n<p>I am running this code on Windows 10.</p>\n\n<p>My code:</p>\n\n<pre><code>std::string sPassword = \"123P@ssword\"; //password to hash\nHCRYPTHASH hHash = NULL; //password hash handle\nHCRYPTPROV hHashKeyProvider = NULL; //provider to make the key derived from the hash\nHCRYPTKEY hHashDerivedKey = NULL; //key derived from password hash\n\n//get provider to the hash based password\nif (!CryptAcquireContext(\n    &amp;hHashKeyProvider,\n    0,\n    MS_ENHANCED_PROV,\n    PROV_RSA_FULL,\n    CRYPT_VERIFYCONTEXT\n))\n{\n    throw std::runtime_error(\"Could not acquire context to make key from hash\");\n}\n\n//create hash object from provider\nif (!CryptCreateHash(\n    hHashKeyProvider,\n    CALG_SHA1,\n    0,\n    0,\n    &amp;hHash\n))\n{\n    CryptReleaseContext(hHashKeyProvider, 0);\n    throw std::runtime_error(\"Could not create hash\");\n}\n\n//get hash of password\n//https://msdn.microsoft.com/en-us/library/windows/desktop/aa380202(v=vs.85).aspx\nBYTE* pbPasswordBuffer = (BYTE*)sPassword.c_str();\nDWORD dwPasswordBufferLength = strlen((char*)pbPasswordBuffer);\nif (!CryptHashData(\n    hHashKeyProvider,\n    pbPasswordBuffer,\n    dwPasswordBufferLength,\n    0\n))\n{\n    CryptReleaseContext(hHashKeyProvider, 0);\n    DWORD dwLast = GetLastError(); //THIS EQUALS 87 for ERROR_INVALID_PARAMETER WHY???\n    throw std::runtime_error(\"Could not hash password\");\n}\n\n//create key from hash\nif (!CryptDeriveKey(\n    hHashKeyProvider,\n    CALG_AES_256,\n    hHash,\n    0,\n    &amp;hHashDerivedKey\n))\n{\n    CryptDestroyHash(hHash);\n    CryptReleaseContext(hHashKeyProvider, 0);\n    throw std::runtime_error(\"Could not create key from password hash\");\n}\n\n//free the hash\nCryptDestroyHash(hHash);\n</code></pre>\n\n<p>Suggestions?</p>\n"}, {"tags": ["c++", "visual-studio", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1516831147, "post_id": 48431918, "comment_id": 83855844, "body": "According to <a href=\"https://msdn.microsoft.com/en-us/library/0zza0de8.aspx\" rel=\"nofollow noreferrer\">msdn</a>, <i>compiler flag</i> <code>&#47;GL</code> should be accompanied with <b>linker flag</b> <code>&#47;LTCG</code>. Have you tried to set the linker flag too? <code>set_target_properties(Wpo PROPERTIES LINK_FLAGS &quot;$&lt;$&lt;CONFIG:Release&gt;:&#47;LTCG&gt;&quot;)</code>."}, {"owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1516831447, "post_id": 48431918, "comment_id": 83856002, "body": "@Tsyvarev You are correct, the goal was to also have LTCG set. I updated my question accordingly. BTW, it was always set during my tests."}, {"owner": {"reputation": 702, "user_id": 574092, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1adcafa88a8afef49a2b26f7fba64e14?s=128&d=identicon&r=PG", "display_name": "Ation", "link": "https://stackoverflow.com/users/574092/ation"}, "edited": false, "score": 0, "creation_date": 1516832349, "post_id": 48431918, "comment_id": 83856425, "body": "Can you try to generate project for VS2015 and open with your VS2017? And check whether it is set after upgrade. Looks like cmake issue - in project generated for VS2015 it is located in same section as in your sample."}], "answers": [{"comments": [{"owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "edited": false, "score": 0, "creation_date": 1516831687, "post_id": 48432457, "comment_id": 83856113, "body": "Unfortunately, it does not work with my configuration. Which Visual Studio versions and CMake versions do you have ?"}, {"owner": {"reputation": 702, "user_id": 574092, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1adcafa88a8afef49a2b26f7fba64e14?s=128&d=identicon&r=PG", "display_name": "Ation", "link": "https://stackoverflow.com/users/574092/ation"}, "reply_to_user": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "edited": false, "score": 0, "creation_date": 1516831721, "post_id": 48432457, "comment_id": 83856128, "body": "cmake 3.4 + VS 2015"}, {"owner": {"reputation": 702, "user_id": 574092, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1adcafa88a8afef49a2b26f7fba64e14?s=128&d=identicon&r=PG", "display_name": "Ation", "link": "https://stackoverflow.com/users/574092/ation"}, "reply_to_user": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "edited": false, "score": 0, "creation_date": 1516831748, "post_id": 48432457, "comment_id": 83856135, "body": "which flag is not set?"}, {"owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "edited": false, "score": 0, "creation_date": 1516831813, "post_id": 48432457, "comment_id": 83856171, "body": "/GL is not set."}, {"owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "edited": false, "score": 0, "creation_date": 1516831856, "post_id": 48432457, "comment_id": 83856192, "body": "If you edit the vcxproj, were is the WholeProgramOptimization line ?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1516832473, "post_id": 48432457, "comment_id": 83856493, "body": "How do you know /GL is not set? Can you post the cl command that is executed?"}, {"owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1516833883, "post_id": 48432457, "comment_id": 83857147, "body": "@rustyx I thought I kenw it because the option was not set in the properties of the project furthermore, the &quot;Whole Program Optimization&quot; Property sheet was missing but the command line does indeed contain a /GL: <code>&#47;GS &#47;TP &#47;GL &#47;analyze- &#47;W3 &#47;Zc:wchar_t &#47;Gm- &#47;O2 &#47;Ob2 &#47;Fd&quot;Wpo.dir\\Release\\vc141.pdb&quot; &#47;Zc:inline &#47;fp:precise &#47;D &quot;WIN32&quot; &#47;D &quot;_WINDOWS&quot; &#47;D &quot;NDEBUG&quot; &#47;D &quot;CMAKE_INTDIR=\\&quot;Release\\&quot;&quot; &#47;D &quot;_MBCS&quot; &#47;errorReport:prompt &#47;WX- &#47;Zc:forScope &#47;GR &#47;Gd &#47;Oy- &#47;MD &#47;Fa&quot;Release&#47;&quot; &#47;EHsc &#47;nologo &#47;Fo&quot;Wpo.dir\\Release\\&quot; &#47;Fp&quot;Wpo.dir\\Release\\Wpo.pch&quot; &#47;diagnostics:classic</code>"}, {"owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1516835299, "post_id": 48432457, "comment_id": 83857688, "body": "@rustyx Please add an answer stating that the option is really set. Visual studio does not display it in its Properties dialog but it is passed to the compiler anyway. You deserve the credits for this."}], "tags": [], "owner": {"reputation": 702, "user_id": 574092, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1adcafa88a8afef49a2b26f7fba64e14?s=128&d=identicon&r=PG", "display_name": "Ation", "link": "https://stackoverflow.com/users/574092/ation"}, "is_accepted": false, "score": 2, "last_activity_date": 1516831527, "creation_date": 1516831527, "answer_id": 48432457, "question_id": 48431918, "link": "https://stackoverflow.com/questions/48431918/wholeprogramoptimization-in-cmake/48432457#48432457", "title": "WholeProgramOptimization in CMake", "body": "<p>To use this feature you need to add compiler option /GL(whole program optimization) and linker option /LTCG (Link-time Code Generation).</p>\n\n<pre><code>SET_TARGET_PROPERTIES(Wpo PROPERTIES COMPILE_FLAGS \"/GL\")\nSET_TARGET_PROPERTIES(Wpo PROPERTIES LINK_FLAGS \"/LTCG\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2853, "user_id": 137261, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/a33ce1c031e87fc21e5f30509780f78a?s=128&d=identicon&r=PG", "display_name": "tommyk", "link": "https://stackoverflow.com/users/137261/tommyk"}, "edited": false, "score": 0, "creation_date": 1552055267, "post_id": 48439179, "comment_id": 96878206, "body": "Linker option should be /LTCG and not /LTGC."}, {"owner": {"reputation": 2241, "user_id": 404734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4c30170453a44d900f8e03dd40461059?s=128&d=identicon&r=PG", "display_name": "Kaiserludi", "link": "https://stackoverflow.com/users/404734/kaiserludi"}, "edited": false, "score": 0, "creation_date": 1582736517, "post_id": 48439179, "comment_id": 106883039, "body": "Does this mean that values set through 2) and 3) override any value that is set through 1)? What is the point in even offering option 1) then?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1590417090, "post_id": 48439179, "comment_id": 109664340, "body": "Option 1 is the convenience meta-option that drives <i>both</i> 2) and 3) <i>together</i> when they&#39;re unset, which is normally the case. So normally WholeProgramOptimization is enabled at one place, which is simply convenient."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 5, "last_activity_date": 1552056006, "last_edit_date": 1552056006, "creation_date": 1516871316, "answer_id": 48439179, "question_id": 48431918, "link": "https://stackoverflow.com/questions/48431918/wholeprogramoptimization-in-cmake/48439179#48439179", "title": "WholeProgramOptimization in CMake", "body": "<p>There are <strong>3</strong> places in a Visual Studio project where Whole Program Optimization settings come into picture -</p>\n\n<p><strong>1) At Project level (Project &rarr; General tab)</strong></p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/Rr0dl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rr0dl.png\" alt=\"WholeProgramOptimization\"></a></p>\n</blockquote>\n\n<p>This is a convenience meta-setting to enable Whole Program Optimization.</p>\n\n<p>In the project XML it's located at<code>&lt;PropertyGroup&gt;</code>/<code>&lt;WholeProgramOptimization&gt;</code> </p>\n\n<p><strong>2) At compiler level (C/C++ &rarr; Optimization tab)</strong></p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/dWq4j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dWq4j.png\" alt=\"WholeProgramOptimization /GL\"></a></p>\n</blockquote>\n\n<p>This is the actual <code>/GL</code> setting, it defaults to the project-level setting.</p>\n\n<p>In the project XML it's located at<code>&lt;ItemDefinitionGroup&gt;</code>/<code>&lt;ClCompile&gt;</code>/<code>&lt;WholeProgramOptimization&gt;</code> </p>\n\n<p><strong>3) At linker level (Linker &rarr; Optimization tab)</strong></p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/UwLC6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UwLC6.png\" alt=\"Link-Time Code Generation /LTGC\"></a></p>\n</blockquote>\n\n<p>This is the actual <code>/LTCG</code> setting, it defaults to the project-level setting.</p>\n\n<p>In the project XML it's located at <code>&lt;ItemDefinitionGroup&gt;</code>/<code>&lt;Link&gt;</code>/<code>&lt;LinkTimeCodeGeneration&gt;</code> </p>\n\n<p>The following CMake commands won't set <code>WholeProgramOptimization</code> at project level, but at compiler and linker level. That's why the \"convenience\" setting in the General tab is blank. The net effect, however, is the same. WholeProgramOptimization is on.</p>\n\n<pre><code>set_target_properties(Wpo PROPERTIES COMPILE_FLAGS \"$&lt;$&lt;CONFIG:Release&gt;:/GL&gt;\")\nset_target_properties(Wpo PROPERTIES LINK_FLAGS \"$&lt;$&lt;CONFIG:Release&gt;:/LTCG&gt;\")\n</code></pre>\n"}], "owner": {"reputation": 3549, "user_id": 1824274, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/QRBsv.png?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/1824274/arnaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2426, "favorite_count": 2, "accepted_answer_id": 48439179, "answer_count": 2, "score": 6, "last_activity_date": 1552056006, "creation_date": 1516829447, "last_edit_date": 1516831471, "question_id": 48431918, "link": "https://stackoverflow.com/questions/48431918/wholeprogramoptimization-in-cmake", "title": "WholeProgramOptimization in CMake", "body": "<p><strong>What can I do to enable <code>WholeProgramOptimization</code> from CMake ?</strong></p>\n\n<p>Here is what I tried:</p>\n\n<ul>\n<li>I have CMake 3.10.2 installed</li>\n<li>I have Visual Studio 2017 15.5.4 installed</li>\n<li>I created a directory C:\\Wpo</li>\n<li>I created an empty directory C:\\Wpo\\Build</li>\n<li>I created a C:\\Wpo\\Wpo.cpp file containing <code>int main(){return 0;}</code></li>\n<li><p>I created a C:\\Wpo\\CMakeLists.txt file containing the following:</p>\n\n<pre><code>CMAKE_MINIMUM_REQUIRED (VERSION 3.10)\nPROJECT(Wpo)\nADD_EXECUTABLE(Wpo \"../Wpo.cpp\")\nTARGET_COMPILE_OPTIONS(Wpo PRIVATE \"$&lt;$&lt;CONFIG:Release&gt;:/GL&gt;\")\nSET_TARGET_PROPERTIES(Wpo PROPERTIES LINK_FLAGS_RELEASE \"/LTCG\")\n</code></pre></li>\n<li><p>I openned a command line and created my Visual Studio solution:</p>\n\n<pre><code>cd C:\\Wpo\\Build\ncmake ..\n</code></pre></li>\n</ul>\n\n<p>But when I open my solution in Visual Studio, Whole program Optimization is not set. Interestingly enough, there is a <code>WholeProgramOptimization</code> in the vcxproj file:</p>\n\n<pre><code>      &lt;ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\"&gt;\n        &lt;ClCompile&gt;\n          &lt;AdditionalIncludeDirectories&gt;%(AdditionalIncludeDirectories)&lt;/AdditionalIncludeDirectories&gt;\n          &lt;AssemblerListingLocation&gt;Release/&lt;/AssemblerListingLocation&gt;\n          &lt;CompileAs&gt;CompileAsCpp&lt;/CompileAs&gt;\n          &lt;ExceptionHandling&gt;Sync&lt;/ExceptionHandling&gt;\n          &lt;InlineFunctionExpansion&gt;AnySuitable&lt;/InlineFunctionExpansion&gt;\n          &lt;Optimization&gt;MaxSpeed&lt;/Optimization&gt;\n          &lt;PrecompiledHeader&gt;NotUsing&lt;/PrecompiledHeader&gt;\n          &lt;RuntimeLibrary&gt;MultiThreadedDLL&lt;/RuntimeLibrary&gt;\n          &lt;RuntimeTypeInfo&gt;true&lt;/RuntimeTypeInfo&gt;\n          &lt;WarningLevel&gt;Level3&lt;/WarningLevel&gt;\n\n          &lt;WholeProgramOptimization&gt;true&lt;/WholeProgramOptimization&gt;\n\n          &lt;PreprocessorDefinitions&gt;WIN32;_WINDOWS;NDEBUG;CMAKE_INTDIR=\"Release\";%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n          &lt;ObjectFileName&gt;$(IntDir)&lt;/ObjectFileName&gt;\n          &lt;DebugInformationFormat&gt;&lt;/DebugInformationFormat&gt;\n        &lt;/ClCompile&gt;\n      &lt;/ItemDefinitionGroup&gt;\n</code></pre>\n\n<p>If I manually select Whole Program Optimizations from the Properties of the Project, an entry is added in another part of the vcxproj file:</p>\n\n<pre><code>      &lt;PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\"&gt;\n        &lt;ConfigurationType&gt;Application&lt;/ConfigurationType&gt;\n        &lt;CharacterSet&gt;MultiByte&lt;/CharacterSet&gt;\n        &lt;PlatformToolset&gt;v141&lt;/PlatformToolset&gt;\n\n        &lt;WholeProgramOptimization&gt;true&lt;/WholeProgramOptimization&gt;\n\n      &lt;/PropertyGroup&gt;\n</code></pre>\n\n<ul>\n<li><strong>Is it a bug from CMake ?</strong> It looks like it is adding this <code>WholeProgramOptimization</code> section in the wrong place.</li>\n<li><strong>Is it a bug from Visual Studio ?</strong> It could be a regression too.</li>\n<li>Am I employing a deprecated way of doing this ? This happens a lot with CMake ;-)</li>\n</ul>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "templates", "generics"], "comments": [{"owner": {"reputation": 1098, "user_id": 7606400, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/SdaHX.jpg?s=128&g=1", "display_name": "Tornike Gomareli", "link": "https://stackoverflow.com/users/7606400/tornike-gomareli"}, "edited": false, "score": 1, "creation_date": 1516829543, "post_id": 48431909, "comment_id": 83855016, "body": "Your code isn&#39;t readable because of variable names."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1516829793, "post_id": 48431909, "comment_id": 83855149, "body": "Did you mean <code>template&lt;int stepen&gt; class Polinom&lt;Complex, stepen&gt;</code>? In the future, please read on how to produce a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Most of the code here isn&#39;t necessary and distracts from the problem."}, {"owner": {"reputation": 21, "user_id": 8940474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670e03f3a24e64669cad8682984425b9?s=128&d=identicon&r=PG&f=1", "display_name": "Danilo Djokic", "link": "https://stackoverflow.com/users/8940474/danilo-djokic"}, "edited": false, "score": 0, "creation_date": 1516830027, "post_id": 48431909, "comment_id": 83855265, "body": "Well, that seemed to have fixed the proble, but...why?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516830255, "post_id": 48431909, "comment_id": 83855378, "body": "Because that&#39;s the syntax for partial specialization."}], "answers": [{"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1516830167, "creation_date": 1516830167, "answer_id": 48432089, "question_id": 48431909, "link": "https://stackoverflow.com/questions/48431909/c-template-specialization-with-non-generic-arguments/48432089#48432089", "title": "C++ Template Specialization with non-generic arguments", "body": "<p>The specialization should look like:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename T, int N&gt;\nstruct Array {\n    T var[N];\n    T sum() { \n        T res{};\n        for (T v:var) {\n            res += v;\n        }\n        return res;\n    }\n};\n\nstruct Complex {};\n\ntemplate &lt;int N&gt;\nstruct Array&lt;Complex, N&gt; {\n    Complex var[N];\n    Complex sum() {\n        std::cout &lt;&lt;\"Complex sum called\\n\";\n        return {};\n    }\n};\n\n\nint main()\n{\n    Array&lt;Complex,5&gt; array;\n    array.sum();\n}\n</code></pre>\n\n<p>Note that this is a minimal (I think), complete, and verifiable example.  You will get better answers if you take the time to create something similar when you ask a question.</p>\n\n<p>To answer your question: I know of no way to simply specialize just one function in a template - which is why you get complex things like the CRTP and individual functions which are invoked from the members (and which can be individually specialized).</p>\n"}], "owner": {"reputation": 21, "user_id": 8940474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670e03f3a24e64669cad8682984425b9?s=128&d=identicon&r=PG&f=1", "display_name": "Danilo Djokic", "link": "https://stackoverflow.com/users/8940474/danilo-djokic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516830167, "creation_date": 1516829388, "question_id": 48431909, "link": "https://stackoverflow.com/questions/48431909/c-template-specialization-with-non-generic-arguments", "title": "C++ Template Specialization with non-generic arguments", "body": "<p>i have a quiestion regarding template specializations when i have multiple arguments and some of them are non generic</p>\n\n<p>I have a class called Polinom(polynomian) which is basically an array of T objects with a size declared in the template definition(as an int). I also have a class called Complex. Now what I want is to create a template specialization so that I will call different functions(overloaded operator functions) when I have a polinomial with Complex as T. My question is how can I do this, I am getting an error \"type name not allowed, stepen undefined\" when trying to create the specialization, if someone could clear up what is going on here that would be great.</p>\n\n<pre><code>  #pragma once\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\ntemplate&lt;class T, int stepen&gt;\nclass Polinom\n{\nprivate:\n    T koeficijenti[stepen];\npublic:\n    Polinom() {};\n    ~Polinom() {};\n    void ucitajKoef();\n    T vrednost(T x);\n};\n\ntemplate&lt;&gt;\nclass Polinom&lt;Complex, int stepen&gt; //error type name not allowed\n{\n\n};\n\ntemplate&lt;class T, int stepen&gt;\nT Polinom&lt;T, stepen&gt;::vrednost(T x)\n{\n    T suma = koeficijenti[1] * (T)pow(x, stepen);\n    for (int i = 1; i &lt; stepen; i++)\n    {\n        suma += koeficijenti[i] * pow(x, stepen - i);\n    }\n    return suma;\n}\n\ntemplate&lt;class T, int stepen&gt;\nvoid Polinom&lt;T, stepen&gt;::ucitajKoef()\n{\n    T uneseniKoef;\n    for (int i = 0; i &lt; stepen; i++)\n    {\n        cout &lt;&lt; \"Unesite koeficijent\" &lt;&lt; endl;\n        cin &gt;&gt; uneseniKoef;\n        koeficijenti[i] = uneseniKoef;\n    }\n}\n</code></pre>\n\n<p>P.S. Is there a workaround to having to rewrite all the other functions of the class since I am only specializing so I can overload the function vrednost(value)</p>\n"}, {"tags": ["c++", "c++11", "lambda", "compiler-errors"], "comments": [{"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1516829508, "post_id": 48431887, "comment_id": 83855009, "body": "I don&#39;t think this will ever work. I think that a (static) member function of A would have be the one to change it."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516829566, "post_id": 48431887, "comment_id": 83855027, "body": "You can&#39;t declare the lambda as a friend. If you want behavior like this, there are some tricks you can do to expose <code>c</code>, but it depends on how much you are willing to change / whether the lambda is internal code or not"}], "answers": [{"tags": [], "owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "is_accepted": true, "score": 2, "last_activity_date": 1516830061, "last_edit_date": 1516830061, "creation_date": 1516829747, "answer_id": 48431986, "question_id": 48431887, "link": "https://stackoverflow.com/questions/48431887/how-to-access-private-member-from-lambda-that-is-passed-to-constructor-of-friend/48431986#48431986", "title": "How to access private member from lambda that is passed to constructor of friendly class?", "body": "<p>You cannot access static member from lambda here.</p>\n\n<p>You mark class <code>A</code> as a friend, but the lambda you create is not related to <code>A</code> or <code>B</code> directly - it has it's own type which, of course, is not a friend of <code>B</code>. That's why you have an error trying to access <code>B::c</code>.</p>\n\n<p>You might consider passing <code>B::c</code> to <code>f</code> from <code>A</code> constructor as an alternative:</p>\n\n<pre><code>class A;\n\nclass B\n{\nprivate:\n    friend class A;\n    static bool c;\n};\n\nbool B::c = false;\n\nclass A\n{\npublic:\n    A(std::function&lt;void(bool&amp;)&gt; f)\n    {\n        f(B::c);\n    }\n};\n\nA a([](bool&amp; value) { value = true; });\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9173149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a3c9011d4d6a8947b05bceef505ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Forge", "link": "https://stackoverflow.com/users/9173149/tony-forge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 48431986, "answer_count": 1, "score": 1, "last_activity_date": 1516830510, "creation_date": 1516829302, "last_edit_date": 1516830510, "question_id": 48431887, "link": "https://stackoverflow.com/questions/48431887/how-to-access-private-member-from-lambda-that-is-passed-to-constructor-of-friend", "title": "How to access private member from lambda that is passed to constructor of friendly class?", "body": "<p>How can I access static member from lambda here?</p>\n\n<pre><code>class A\n{\npublic:\n    A(std::function&lt;void()&gt; f)\n    {\n        f();\n    }\n};\n\nclass B\n{\nprivate:\n    friend class A;\n    static bool c;\n};\n\nbool B::c = false;\n\nA a([]() { B::c = true; });\n</code></pre>\n\n<p>This code gives me error C2248:</p>\n\n<blockquote>\n  <p>'B::c': cannot access private member declared in class 'B'</p>\n</blockquote>\n"}, {"tags": ["c++", "asynchronous", "boost", "boost-asio"], "comments": [{"owner": {"reputation": 3443, "user_id": 3008984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd04fa3de31354f4acde7fd261e2a63?s=128&d=identicon&r=PG&f=1", "display_name": "common sense", "link": "https://stackoverflow.com/users/3008984/common-sense"}, "edited": false, "score": 0, "creation_date": 1516830122, "post_id": 48431848, "comment_id": 83855319, "body": "Welcome to StackOverflow. Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> an read <a href=\"https://stackoverflow.com/help/on-topic\">What topics can I ask about</a> and <a href=\"https://stackoverflow.com/help/dont-ask\">What topics to avoid</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a> and <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">the perfect question</a> and how to create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9264336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45adf2854a6d8e536469fa1249ccc9c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Angeli", "link": "https://stackoverflow.com/users/9264336/ricardo-angeli"}, "edited": false, "score": 0, "creation_date": 1516896425, "post_id": 48433123, "comment_id": 83886645, "body": "I don&#39;t think this is what I was asking for since the connection is being explicitly closed by the program on each iteration.  I want it to keep it open and only re-connect if the client disconnects and wants to connect again.  I still want to thank you since your answer led me to figuring out how to do what I was asking.  I&#39;m still evaluating it and I may end up posting the code here."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 13, "user_id": 9264336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45adf2854a6d8e536469fa1249ccc9c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Angeli", "link": "https://stackoverflow.com/users/9264336/ricardo-angeli"}, "edited": false, "score": 0, "creation_date": 1516900579, "post_id": 48433123, "comment_id": 83889440, "body": "@RicardoAngeli That&#39;s merely the demo, right. You <b>can</b> wait until the connection is dropped. Even then it&#39;s /nice/ to make sure the socket isn&#39;t in the open state (otherwise, you&#39;d need a new instance to accept a new connection on)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 13, "user_id": 9264336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45adf2854a6d8e536469fa1249ccc9c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Angeli", "link": "https://stackoverflow.com/users/9264336/ricardo-angeli"}, "edited": false, "score": 0, "creation_date": 1516901896, "post_id": 48433123, "comment_id": 83890221, "body": "Here&#39;s, to drive the point home, a version that makes it clear there is no need to forcibly close a socket: <a href=\"http://coliru.stacked-crooked.com/a/eb1185f894c3a521\" rel=\"nofollow noreferrer\">on coliru&#185;</a>. I just test it by pointing <code>netcat -C</code> at it - <a href=\"http://stackoverflow-sehe.s3.amazonaws.com/4f25141b-6e6b-49da-bce6-a7f2507865aa/demo.mp4\" rel=\"nofollow noreferrer\">demo vid (4.6Mb)</a> (&#185; boost version is out of date so it doesn&#39;t support <code>run_for</code>)."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 0, "last_activity_date": 1516834808, "creation_date": 1516834808, "answer_id": 48433123, "question_id": 48431848, "link": "https://stackoverflow.com/questions/48431848/boost-asio-asynchronous-server-limit-to-one-connection/48433123#48433123", "title": "Boost.Asio asynchronous server. Limit to one connection", "body": "<p>Just don't accept the new connection until the previous is done.</p>\n\n<p>Simplest possible program I can come up with:</p>\n\n<pre><code>#define BOOST_ASIO_HAS_CHRONO 1\n#include &lt;boost/asio.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n\nnamespace ba = boost::asio;\nusing ba::ip::tcp;\nusing boost::system::error_code;\n\nclass Server {\n    ba::io_service _svc;\n    tcp::acceptor _acc{_svc};\n    tcp::socket _conn{_svc};\n\n    ba::streambuf _request, _response;\n\n  public:\n    void start(unsigned short port, std::chrono::high_resolution_clock::duration time) {\n        _acc.open(tcp::v4());\n        _acc.bind({{}, port});\n        _acc.listen(5);\n\n        do_accept();\n\n        _svc.run_for(time);\n    }\n\n  private:\n    void do_accept() {\n        if (_conn.is_open())\n            _conn.close();\n\n        _acc.async_accept(_conn, [=](error_code ec) { handle_accept(ec); });\n    }\n\n    void handle_accept(error_code ec) {\n        if (!ec) std::cout &lt;&lt; \"Accepted: \" &lt;&lt; _conn.remote_endpoint() &lt;&lt; \", \" &lt;&lt; ec &lt;&lt; \" (\" &lt;&lt; ec.message() &lt;&lt; \")\\n\";\n        else     std::cout &lt;&lt; \"Accepted, \" &lt;&lt; ec &lt;&lt; \" (\" &lt;&lt; ec.message() &lt;&lt; \")\\n\";\n\n        ba::async_read_until(_conn, _request, \"\\r\\n\", [=](error_code ec, size_t xfr) { handle_read(ec, xfr); });\n    }\n\n    void handle_read(error_code ec, size_t transferred) {\n        std::cout &lt;&lt; \"Read request: \" &lt;&lt; transferred &lt;&lt; \" bytes, \" &lt;&lt; ec &lt;&lt; \" (\" &lt;&lt; ec.message() &lt;&lt; \")\\n\";\n\n        std::vector&lt;char&gt; v(std::istreambuf_iterator&lt;char&gt;(&amp;_request), {});\n        std::reverse_copy(begin(v), end(v), std::ostreambuf_iterator&lt;char&gt;(&amp;_response));\n\n        ba::async_write(_conn, _response, [=](error_code ec, size_t xfr) { handle_write(ec, xfr); });\n    }\n\n    void handle_write(error_code ec, size_t transferred) {\n        std::cout &lt;&lt; \"Written request: \" &lt;&lt; transferred &lt;&lt; \" bytes, \" &lt;&lt; ec &lt;&lt; \" (\" &lt;&lt; ec.message() &lt;&lt; \")\\n\";\n\n        do_accept(); // ONLY HERE initiate new accept. Could be back-log pending\n    }\n};\n\nusing namespace std::chrono_literals;\nint main() {\n    Server s;\n\n    s.start(6767, 3s); // For demo, run 3 seconds\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>./sotest &amp; sleep .5; for w in Hello Bye; do echo -ne \"$w world\\!\\\\r\\\\n\" | netcat localhost 6767; done\nAccepted: 127.0.0.1:43764, system:0 (Success)\nRead request: 15 bytes, system:0 (Success)\n\n!\\dlrow olleHWritten request: 15 bytes, system:0 (Success)\nAccepted: 127.0.0.1:43766, system:0 (Success)\nRead request: 13 bytes, system:0 (Success)\n\n!\\dlrow eyBWritten request: 13 bytes, system:0 (Success)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9264336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45adf2854a6d8e536469fa1249ccc9c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Angeli", "link": "https://stackoverflow.com/users/9264336/ricardo-angeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "accepted_answer_id": 48433123, "answer_count": 1, "score": 1, "last_activity_date": 1516834808, "creation_date": 1516829125, "last_edit_date": 1516834724, "question_id": 48431848, "link": "https://stackoverflow.com/questions/48431848/boost-asio-asynchronous-server-limit-to-one-connection", "title": "Boost.Asio asynchronous server. Limit to one connection", "body": "<p>I'm fairly new to Boost.Asio and I want to develop an asynchronous server that limits the number of active connections to one.  In other words, when a connection is established, additional connections will be denied.  Once that connection is closed, another one can take its spot.</p>\n\n<p>It's not immediately clear how to accomplish this and still be able to re-connect if the connection gets closed.</p>\n\n<p>Could someone provide a simple example of how to do this?</p>\n\n<p>EDIT:  How would you take the Boost.Asio Asynchronous Server <a href=\"http://www.boost.org/doc/libs/1_54_0/doc/html/boost_asio/tutorial/tutdaytime3.html\" rel=\"nofollow noreferrer\">example code</a> and edit it to limit the number of connections?</p>\n"}, {"tags": ["c++", "allegro", "allegro5"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "edited": false, "score": 0, "creation_date": 1516898401, "post_id": 48444759, "comment_id": 83888058, "body": "I put these files in projectName &gt; projectName and added #include &quot;algif.h&quot;. I get these errors: unresolved external symbol _algif_load_animation referenced in function _mainLearnAllegroC:\\Users\\User\\source\\repos\\LearnAllegro\\Lea&zwnj;&#8203;rnAllegro\\LearnAlleg&zwnj;&#8203;ro.objunresolved external symbol _algif_destroy_animation referenced in function _main\tLearnAllegroC:\\Users\\User\\source\\repos\\LearnAllegro\\Le&zwnj;&#8203;arnAllegro\\LearnAlle&zwnj;&#8203;gro.obunresolved external symbol_algif_get_bitmap referenced in function &quot;void__cdecldrawBoss(structBoss &amp;,struct ALGIF_ANIMATION *)&quot;(?drawBoss@@YAXAAUBoss@@PAUALGIF_ANIMATION@@@Z)\tLearn..."}, {"owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "edited": false, "score": 0, "creation_date": 1516898453, "post_id": 48444759, "comment_id": 83888091, "body": "Do I need to add some other &quot;include&quot; or only this is needed: #include &quot;algif.h&quot;?"}, {"owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "edited": false, "score": 0, "creation_date": 1516898706, "post_id": 48444759, "comment_id": 83888248, "body": "If I add all &quot;include&quot; like this: #include &quot;algif.h&quot; #include &quot;algif.c&quot; #include &quot;bitmap.c&quot; #include &quot;gif.c&quot; #include &quot;lzw.c&quot;"}, {"owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "edited": false, "score": 0, "creation_date": 1516898773, "post_id": 48444759, "comment_id": 83888298, "body": "..then there are some other bugs: &#39;initializing&#39;: cannot convert from &#39;void *&#39; to &#39;ALGIF_BITMAP *&#39;LearnAllegro\tc:\\users\\user\\source\\repos\\learnallegro\\learn&zwnj;&#8203;allegro\\bitmap.c4\tEr&zwnj;&#8203;rorC2440&#39;=&#39;: cannot convert from &#39;void *&#39; to &#39;uint8_t *&#39;LearnAllegroc:\\users\\user\\source\\repos\\learnallegro\\learna&zwnj;&#8203;llegro\\bitmap.c7 ErrorC2440&#39;initializing&#39;: cannot convert from &#39;void *&#39; to &#39;ALGIF_ANIMATION *&#39;\tLearnAllegroc:\\users\\user\\source\\repos\\learnallegro\\learn&zwnj;&#8203;allegro\\gif.c\t69\t ErrorC2440&#39;=&#39;: cannot convert from &#39;void *&#39; to &#39;ALGIF_FRAME *&#39;LearnAllegroc:\\users\\user\\source\\repos\\learnallegro\\learna&zwnj;&#8203;llegro\\gif.c158"}, {"owner": {"reputation": 69, "user_id": 281268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54f6d8c575abfda92d0bac1062f4c27?s=128&d=identicon&r=PG", "display_name": "allefant", "link": "https://stackoverflow.com/users/281268/allefant"}, "reply_to_user": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "edited": false, "score": 0, "creation_date": 1516900246, "post_id": 48444759, "comment_id": 83889229, "body": "make sure to compile those files as C and not as C++"}, {"owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "edited": false, "score": 0, "creation_date": 1516900908, "post_id": 48444759, "comment_id": 83889644, "body": "So my program is in C++ and this extension is in C. What exacly should I do to use it?"}], "tags": [], "owner": {"reputation": 69, "user_id": 281268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54f6d8c575abfda92d0bac1062f4c27?s=128&d=identicon&r=PG", "display_name": "allefant", "link": "https://stackoverflow.com/users/281268/allefant"}, "is_accepted": false, "score": 1, "last_activity_date": 1516889024, "creation_date": 1516889024, "answer_id": 48444759, "question_id": 48431812, "link": "https://stackoverflow.com/questions/48431812/how-to-use-gifs-in-allegro-5-with-the-algif5-addon/48444759#48444759", "title": "How to use GIFs in Allegro 5 with the Algif5 addon?", "body": "<p>There is no official library - instead you need to add  algif.c, bitmap.c, gif.c and lzw.c to your source files.</p>\n\n<p>Alternatively if you know how to create a library you can create a library out of those 4 files and then link against that library.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1516908042, "creation_date": 1516908042, "answer_id": 48450368, "question_id": 48431812, "link": "https://stackoverflow.com/questions/48431812/how-to-use-gifs-in-allegro-5-with-the-algif5-addon/48450368#48450368", "title": "How to use GIFs in Allegro 5 with the Algif5 addon?", "body": "<p>The library did not work for me and I ended up inputting gif frames separately. This for loop I used might help you: \nA simplified version: </p>\n\n<pre><code>for (int i = 0; i &lt; maxFrameBoss1; i++) {\n    std::string filename;\n    filename = \"boss1//frame_\" + std::to_string(i) + \"_delay-0.03s.png\";\n\n\n    boss1Image[i] = al_load_bitmap(filename.c_str());\n    if (!boss1Image[i]) {\n        fprintf(stderr, \"failed to create boss1Image bitmap!\\n\");\n        return -1*i;\n    }\n}\n</code></pre>\n\n<p>Make sure to include this at the beginning of your program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7453623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78f55e88ff78e156d517da63df04788a?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7453623/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516908042, "creation_date": 1516828971, "question_id": 48431812, "link": "https://stackoverflow.com/questions/48431812/how-to-use-gifs-in-allegro-5-with-the-algif5-addon", "title": "How to use GIFs in Allegro 5 with the Algif5 addon?", "body": "<p>I try to use this: <a href=\"https://github.com/allefant/algif5\" rel=\"nofollow noreferrer\">https://github.com/allefant/algif5</a> but this doesn't work.</p>\n\n<pre><code>#include \"algif.h\"\n\nchar const* pathBoss1 = \"boss1.gif\";\nALGIF_ANIMATION *boss1Gif = NULL;\nboss1Gif = algif_load_animation(pathBoss1);\n// in a function: \nal_draw_bitmap(algif_get_bitmap(bossGif, al_get_time()), boss.x, boss.y, 0);\n</code></pre>\n\n<p>It throws lots of bugs like this</p>\n\n<blockquote>\n  <p>Severity  Code    Description Project File    Line    Suppression State\n  Error LNK2019 unresolved external symbol _algif_get_bitmap referenced\n  in function \"void __cdecl drawBoss(struct Boss &amp;,struct\n  ALGIF_ANIMATION *)\"\n  (?drawBoss@@YAXAAUBoss@@PAUALGIF_ANIMATION@@@Z)   LearnAllegro    C:\\Users\\User\\source\\repos\\LearnAllegro\\LearnAllegro\\LearnAllegro.obj   1</p>\n</blockquote>\n\n<p>As if the library was not found. \n(I put all the downloaded files into ProjectName>ProjectName as there are other .h files there)</p>\n\n<p>What should I do?</p>\n"}, {"tags": ["c++", "opencv", "templates", "matrix", "typedef"], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1516829187, "creation_date": 1516829187, "answer_id": 48431863, "question_id": 48431803, "link": "https://stackoverflow.com/questions/48431803/opencv-c-declaring-a-matrix-of-type-uint8/48431863#48431863", "title": "Opencv C++ Declaring a matrix of type uint8", "body": "<p>The standard type in C++ is <code>uint8_t</code>, i.e. <code>Mat_&lt; uint8_t &gt; mymatrix;</code>. You need to <code>#include &lt;cstdint&gt;</code>.</p>\n\n<p>You can also make your own typedef</p>\n\n<pre><code>typedef Mat_&lt; uint8_t &gt; uint8_matrix_type;\n</code></pre>\n\n<p>or something like that.</p>\n"}, {"tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": false, "score": 0, "last_activity_date": 1516832400, "creation_date": 1516832400, "answer_id": 48432651, "question_id": 48431803, "link": "https://stackoverflow.com/questions/48431803/opencv-c-declaring-a-matrix-of-type-uint8/48432651#48432651", "title": "Opencv C++ Declaring a matrix of type uint8", "body": "<p>You should use the built-in:</p>\n\n<pre><code>cv::Mat1b\n</code></pre>\n\n<p>which is defined in <code>mat.hpp</code> as:</p>\n\n<pre><code>typedef Mat_&lt;uchar&gt; Mat1b;\n</code></pre>\n\n<p>where <code>uchar</code> is defined in <code>interface.h</code>:</p>\n\n<pre><code>//! - uchar  - unsigned 1 byte integer\ntypedef unsigned char uchar;\n</code></pre>\n\n<hr>\n\n<p>You can also <code>typedef</code> a matrix with your preferred type, but you <em>may</em> encounter weird errors since its <code>DataType</code> (in <code>traits.hpp</code>) won't be specified and so it <em>may</em> be incompatible with some OpenCV functions. </p>\n"}], "owner": {"reputation": 389, "user_id": 4893245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ab14bb287e61eabba4f2fb1a864ed040?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Martin", "link": "https://stackoverflow.com/users/4893245/terry-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516832400, "creation_date": 1516828931, "question_id": 48431803, "link": "https://stackoverflow.com/questions/48431803/opencv-c-declaring-a-matrix-of-type-uint8", "title": "Opencv C++ Declaring a matrix of type uint8", "body": "<p>Fairly simple question: I was wondering how to specify the type of a matrix in opencv.  I was looking at this page <a href=\"https://docs.opencv.org/trunk/dc/d84/group__core__basic.html\" rel=\"nofollow noreferrer\">https://docs.opencv.org/trunk/dc/d84/group__core__basic.html</a>, which specifies typedefs for float matrices with cv::Mat1f and so on.  I'm not familiar with C++; can I just make my own uint8 matrix using a similar thing they are doing in the typedefs? </p>\n\n<p><code>Mat_&lt; uint8 &gt; mymatrix;</code> or something like that?  Can I make my own typedef?</p>\n"}, {"tags": ["c++", "casting", "floating-point", "double", "standards"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1516829209, "post_id": 48431752, "comment_id": 83854841, "body": "I think it defers to ieee754 (if the implementation supports it)."}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 3, "last_activity_date": 1516830122, "creation_date": 1516830122, "answer_id": 48432077, "question_id": 48431752, "link": "https://stackoverflow.com/questions/48431752/type-conversion-of-nan-between-float-and-double/48432077#48432077", "title": "Type conversion of NaN between float and double", "body": "<p>There's nothing explicit in the C++ standard that addresses conversions of NaNs, so you have to rely on the standard conversions.  In particular, floats can be promoted to double and the value is unchanged, and doubles converted to floats will have the same value if it can be represented in the smaller type.  Since both types support a NaN, the value should stay a NaN.</p>\n"}], "owner": {"reputation": 1886, "user_id": 1012773, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/0d62ac65da881c3b7db2982c98e243b5?s=128&d=identicon&r=PG", "display_name": "davide", "link": "https://stackoverflow.com/users/1012773/davide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1516830122, "creation_date": 1516828735, "question_id": 48431752, "link": "https://stackoverflow.com/questions/48431752/type-conversion-of-nan-between-float-and-double", "title": "Type conversion of NaN between float and double", "body": "<p>Do the c++ standards define the behavior of casting a <code>NaN</code> from float to double or vice-versa, or such outcome is implementation-defined or undefined?</p>\n\n<p>The architecture I'm pragmatically concerned with is x86-64 with GCC, but I'd appreciate a broader theoretical understanding.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 3, "creation_date": 1516828578, "post_id": 48431684, "comment_id": 83854514, "body": "I don&#39;t know how good ibm&#39;s documentation is, but I usually find <a href=\"http://en.cppreference.com/w/cpp\" rel=\"nofollow noreferrer\">cppreference</a> to be excellent; maybe it would be easier to understand <a href=\"http://en.cppreference.com/w/cpp/language/dependent_name\" rel=\"nofollow noreferrer\">the documentation there</a>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1516829088, "post_id": 48431684, "comment_id": 83854766, "body": "@HolyBlackCat: Yes, something like that would probably be an example.  Some code later in the program would have to change also, but I think we could come up with an example of two lines that both are part of a valid program and differ only in presence of the <code>template</code> keyword.  <code>template&lt;int&gt; class TC;</code>  followed by <code>TC&lt;N&gt;::template x&lt;1 &amp;&amp; 2&gt; y;</code> and <code>TC&lt;N&gt;::x&lt;1 &amp;&amp; 2&gt;y;</code> could both be legal depending on the later specializations."}, {"owner": {"reputation": 1220, "user_id": 2544357, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c7fb3487565a778da963c39ca169836?s=128&d=identicon&r=PG", "display_name": "Nickolai", "link": "https://stackoverflow.com/users/2544357/nickolai"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516844695, "post_id": 48431684, "comment_id": 83860299, "body": "@Justin thanks for the reference. The section &quot;The <code>template</code> disambiguator for dependent names&quot; was helpful. Still don&#39;t feel like I&#39;ve fully grokked this stuff, but this is helpful."}], "answers": [{"comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1516830882, "post_id": 48432178, "comment_id": 83855688, "body": "You may have uncovered a gcc bug.  I tried a near-identical example, but used gcc with different results.  <a href=\"http://coliru.stacked-crooked.com/a/2a25cabc3ea70f72\" rel=\"nofollow noreferrer\">Here&#39;s your example with gcc</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1517345752, "post_id": 48432178, "comment_id": 84056039, "body": "With your argument about [temp.arg.explicit]/3, can you explain why the example from the standard that you linked, <code>a.template f(t);</code> is an error?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1517346452, "post_id": 48432178, "comment_id": 84056359, "body": "@M.M - The note above the example says &quot;The keyword template may not be applied to non-template members of class templates.&quot; Which is the case in the standard&#39;s example. I didn&#39;t find anything similar for member templates of non-template classes. I did look, that&#39;s why I deleted and undeleted the answer."}, {"owner": {"reputation": 1220, "user_id": 2544357, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c7fb3487565a778da963c39ca169836?s=128&d=identicon&r=PG", "display_name": "Nickolai", "link": "https://stackoverflow.com/users/2544357/nickolai"}, "edited": false, "score": 0, "creation_date": 1518401411, "post_id": 48432178, "comment_id": 84476932, "body": "Really awesome example and explanation, thank you. It sounds like there&#39;s nothing inherent about why this needs to be so. It seem like, apart from cases where the template parameter is a numerical value, the compiler should have enough information to deduce which overload to use, but the current standard simply doesn&#39;t allow it? This reminds of a while ago when code of the form <code>vector&lt;vector&lt;int&gt;&gt;</code> wouldn&#39;t compile without a space between &gt;&gt; to disambiguate it from the extraction operator. Later compilers could handle this. Would you say this is similar?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1220, "user_id": 2544357, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c7fb3487565a778da963c39ca169836?s=128&d=identicon&r=PG", "display_name": "Nickolai", "link": "https://stackoverflow.com/users/2544357/nickolai"}, "edited": false, "score": 0, "creation_date": 1518413533, "post_id": 48432178, "comment_id": 84479663, "body": "@Nickolai - I&#39;m not sure I follow you. The standard doesn&#39;t allow what exactly?"}, {"owner": {"reputation": 1220, "user_id": 2544357, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c7fb3487565a778da963c39ca169836?s=128&d=identicon&r=PG", "display_name": "Nickolai", "link": "https://stackoverflow.com/users/2544357/nickolai"}, "edited": false, "score": 0, "creation_date": 1518415453, "post_id": 48432178, "comment_id": 84480257, "body": "Let me put it this way, could you answer my original question without using default values for the template parameter, or using a template parameters that&#39;s not a primitive type? I have yet to see such an example, and if that&#39;s the case, then why is the <code>template</code> keyword required? It would seem that the compiler has enough information to resolve whatever is ambiguous without disambiguating statements like <code>template</code>, and it&#39;s only the standard that&#39;s preventing it from doing so?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1220, "user_id": 2544357, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c7fb3487565a778da963c39ca169836?s=128&d=identicon&r=PG", "display_name": "Nickolai", "link": "https://stackoverflow.com/users/2544357/nickolai"}, "edited": false, "score": 1, "creation_date": 1518415714, "post_id": 48432178, "comment_id": 84480341, "body": "@Nickolai - Well, the same <a href=\"http://coliru.stacked-crooked.com/a/cf68bdb399562716\" rel=\"nofollow noreferrer\">tweaked example</a>. With a type parameter. And it&#39;s not <i>required</i>. Templates participate in overload resolution regardless.  But regular functions with matching parameter types are favored over generated template specializations (again see the example). You can also disambiguate with <code>some_function&lt;&gt;</code>."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1517344419, "last_edit_date": 1517344419, "creation_date": 1516830486, "answer_id": 48432178, "question_id": 48431684, "link": "https://stackoverflow.com/questions/48431684/can-template-keyword-qualifier-cause-code-to-compile-successfully-but-differe/48432178#48432178", "title": "Can `template` keyword qualifier cause code to compile successfully, but differently?", "body": "<p>Yes, you could write something like that, have it be well-formed, and give different results. Basically your own example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct foo {\n    template &lt;int = 0&gt;\n    void some_function() { std::cout &lt;&lt; \"template\\n\"; }\n\n    void some_function() { std::cout &lt;&lt; \"non-template\\n\"; }\n};\n\n\nint main(void) {\n    foo f{};\n\n    f.some_function();\n    f.template some_function();\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/ade129561fdc18f6\" rel=\"nofollow noreferrer\">Will print what you expect</a>. When the compiler sees the first call to <code>some_function</code>, it must check if it can synthesize the template overload. Which it can, since we provided a default argument to the template parameter. Then it does overload resolution with both candidates, and <a href=\"http://eel.is/c++draft/over.match.best#1.6\" rel=\"nofollow noreferrer\">[over.match.best]/1</a> tells us that </p>\n\n<blockquote>\n  <p>Given these definitions, a viable function F1 is defined to be a\n  better function than another viable function F2 if for all arguments\n  i, ICSi(F1) is not a worse conversion sequence than ICSi(F2), and then</p>\n  \n  <ul>\n  <li>F1 is not a function template specialization and F2 is a function template specialization, or, if not that,</li>\n  </ul>\n</blockquote>\n\n<p>We have two equally good implicit conversion sequences (empty), and that bullet explicitly says the non-template version is a better candidate given everything else is the same.</p>\n\n<p>But when the <code>template</code> keyword is used, we defer to <a href=\"http://eel.is/c++draft/temp.names#5\" rel=\"nofollow noreferrer\">[temp.names]/5</a>:</p>\n\n<blockquote>\n  <p>A name prefixed by the keyword template shall be a template-id or the\n  name shall refer to a class template or an alias template.</p>\n</blockquote>\n\n<p>A template-id has this grammar production in <a href=\"http://eel.is/c++draft/temp.names#1\" rel=\"nofollow noreferrer\">paragraph 1</a>:</p>\n\n<blockquote>\n<pre><code>simple-template-id:\n  template-name &lt; template-argument-list &gt;\n\ntemplate-id:\n  simple-template-id\n  operator-function-id &lt; template-argument-list &gt;\n  literal-operator-id &lt; template-argument-list &gt;\n</code></pre>\n</blockquote>\n\n<p>The template-argument-list is optional in all of the above. But an astute reader will notice that the angle brackets aren't specified as optional. It seems that we must name the template member function as <code>some_function&lt;&gt;</code>. But fortunately we are doing a function call. Template argument deduction is happening, and it is for this reason that <a href=\"http://eel.is/c++draft/temp.arg.explicit#3\" rel=\"nofollow noreferrer\">[temp.arg.explicit]/3</a> can be applied:</p>\n\n<blockquote>\n  <p>... If all of the template arguments can be deduced, they may all be omitted; in this case, the empty template argument list <code>&lt;&gt;</code> itself may also be omitted. ...</p>\n</blockquote>\n\n<p>So we indeed may write <code>f.template some_function();</code>, and it <em>must</em> refer to a template, according to [temp.names]/5. That should have the effect of removing the non-template overload from consideration.</p>\n"}], "owner": {"reputation": 1220, "user_id": 2544357, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c7fb3487565a778da963c39ca169836?s=128&d=identicon&r=PG", "display_name": "Nickolai", "link": "https://stackoverflow.com/users/2544357/nickolai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1517344419, "creation_date": 1516828403, "question_id": 48431684, "link": "https://stackoverflow.com/questions/48431684/can-template-keyword-qualifier-cause-code-to-compile-successfully-but-differe", "title": "Can `template` keyword qualifier cause code to compile successfully, but differently?", "body": "<p>I'm reading about the template keyword qualifier (<a href=\"https://www.ibm.com/support/knowledgecenter/SSPSQF_9.0.0/com.ibm.xlcpp111.aix.doc/language_ref/keyword_template_qualifier.html\" rel=\"noreferrer\">https://www.ibm.com/support/knowledgecenter/SSPSQF_9.0.0/com.ibm.xlcpp111.aix.doc/language_ref/keyword_template_qualifier.html</a>, and <a href=\"https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords\">Where and why do I have to put the &quot;template&quot; and &quot;typename&quot; keywords?</a>), but there's still something that confuses me.</p>\n\n<p>Is it possible to have code like this, that compiles successfully, but results in two different operations?</p>\n\n<pre><code>SomeObjectInstance.template some_function();\nSomeObjectInstance.some_function();\n</code></pre>\n"}, {"tags": ["c++", "templates", "pointers"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1516827491, "post_id": 48431460, "comment_id": 83853973, "body": "What errors are you getting? Without posting the errors, this isn&#39;t a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1, "user_id": 7411418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481c9c33beab132f7d17ffd64e203d84?s=128&d=identicon&r=PG&f=1", "display_name": "Iloveasparagus", "link": "https://stackoverflow.com/users/7411418/iloveasparagus"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516827816, "post_id": 48431460, "comment_id": 83854147, "body": "Thanks Francois, seems it was my misunderstanding. I was under the impression floats and doubles were similar but a double was larger and more precise. How would I improve my example to avoid this error? Is a simple cast sufficient?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1516827823, "post_id": 48431460, "comment_id": 83854150, "body": "Yes, an MCVE is required. However, in addition, throwing the error message into a websearch also prevents asking redundant questions in the first place."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516827857, "post_id": 48431460, "comment_id": 83854171, "body": "@Iloveasparagus I&#39;ve made an answer from my comment. It contains a possible change to fix your problem."}], "answers": [{"comments": [{"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1516839801, "post_id": 48431517, "comment_id": 83859031, "body": "Change the previous line to float y = 5.1f;  As it stands, the program is telling the compiler to create a double(5.1) and then narrow it to float. VC++ gives the warning, warning C4305: &#39;initializing&#39;: truncation from &#39;double&#39; to &#39;float&#39;"}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 3, "last_activity_date": 1516888895, "last_edit_date": 1516888895, "creation_date": 1516827710, "answer_id": 48431517, "question_id": 48431460, "link": "https://stackoverflow.com/questions/48431460/template-function-using-pointers/48431517#48431517", "title": "Template Function using Pointers", "body": "<p><code>&amp;y</code> has the type <code>float*</code> where as <code>7.9</code> has the type <code>double</code>. The compiler could deduce <code>T</code> to be <code>float</code> by matching <code>float*</code> to <code>T* Value</code> or it could deduce <code>double</code> by matching <code>double</code> to <code>T NewValue</code>. For template argument deduction to succeed it must be unambiguous. Try this instead : </p>\n\n<pre><code>float y = 5.1f;\nChangeValue(&amp;y, 7.9f);\n</code></pre>\n\n<p>With this change, <code>T</code> is deduced to be <code>float</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1516839823, "post_id": 48431575, "comment_id": 83859038, "body": "Change the previous line to float y = 5.1f;  As it stands, the program is telling the compiler to create a double(5.1) and then narrow it to float. VC++ gives the warning, warning C4305: &#39;initializing&#39;: truncation from &#39;double&#39; to &#39;float&#39;"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1516827917, "creation_date": 1516827917, "answer_id": 48431575, "question_id": 48431460, "link": "https://stackoverflow.com/questions/48431460/template-function-using-pointers/48431575#48431575", "title": "Template Function using Pointers", "body": "<p>When you use:</p>\n\n<pre><code>float y = 5.1;\nChangeValue(&amp;y, 7.9);\n</code></pre>\n\n<p>The type of the first argument is <code>float*</code> while the type of the second argument is <code>double</code>. Hence, the compiler cannot deduce <code>T</code>.</p>\n\n<p>One way to fix it is by using:</p>\n\n<pre><code>template &lt;typename T1, typename T2 = T1&gt;\nvoid ChangeValue(T1* Value, T2 NewValue)\n{\n    *Value = NewValue;\n}\n</code></pre>\n\n<p>With that, <code>T2</code> is deduced from <code>T1</code> unless the user explicitly overrides it.</p>\n\n<pre><code>float y = 5.1;\nChangeValue&lt;float, double&gt;(&amp;y, 7.9);\n</code></pre>\n\n<p>What would work as long as </p>\n\n<pre><code>    *Value = NewValue;\n</code></pre>\n\n<p>is valid for the given <code>T1</code> and <code>T2</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7411418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481c9c33beab132f7d17ffd64e203d84?s=128&d=identicon&r=PG&f=1", "display_name": "Iloveasparagus", "link": "https://stackoverflow.com/users/7411418/iloveasparagus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516888895, "creation_date": 1516827429, "question_id": 48431460, "link": "https://stackoverflow.com/questions/48431460/template-function-using-pointers", "title": "Template Function using Pointers", "body": "<p>am I doing something fundamentally wrong here? I'm playing around with templates and pointers but I'm getting errors here. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\ntemplate &lt;class T&gt;\nvoid ChangeValue(T*, T);\n\nint main()\n{\nint x = 51;\n\nChangeValue(&amp;x, 7);\n\nstd::cout &lt;&lt; x;\n\nfloat y = 5.1;\n\nChangeValue(&amp;y, 7.9);\n\nstd::cout &lt;&lt; y;\n}\n\ntemplate &lt;class T&gt;\nvoid ChangeValue(T* Value, T NewValue)\n{\n    *Value = NewValue;\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "mutex", "condition-variable"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1516826856, "post_id": 48431296, "comment_id": 83853662, "body": "Have you identified the offending line with your debugger?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1516826886, "post_id": 48431296, "comment_id": 83853679, "body": "&quot;abort() has been called&quot; is not an exception. If an exception was thrown and not caught, you got a more detailed message that includes the type of the exception."}, {"owner": {"reputation": 41, "user_id": 8969711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f95265cf504b4abba90758052b6807ab?s=128&d=identicon&r=PG&f=1", "display_name": "I.Klein", "link": "https://stackoverflow.com/users/8969711/i-klein"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516826908, "post_id": 48431296, "comment_id": 83853686, "body": "@Fran&#231;oisAndrieux I can&#39;t because the work with the threads is very unstable..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9212993"}, "edited": false, "score": 0, "creation_date": 1516827029, "post_id": 48431296, "comment_id": 83853740, "body": "@I.Klein <i>&quot;because the work with the threads is very unstable&quot;</i> Huh??"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1516827061, "post_id": 48431296, "comment_id": 83853759, "body": "@I.Klein I don&#39;t understand what you mean. Most debuggers will be able to break on <code>abort</code>, providing you with a nice call stack."}], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "is_accepted": true, "score": 1, "last_activity_date": 1516827349, "creation_date": 1516827349, "answer_id": 48431443, "question_id": 48431296, "link": "https://stackoverflow.com/questions/48431296/exceptions-while-using-mutex-and-condition-variable/48431443#48431443", "title": "Exceptions while using mutex and condition_variable", "body": "<p>One possible error is that you are repeatedly unlocking the <code>mutex</code> in your <code>while</code>-loop, even though the mutex is not locked:</p>\n\n<pre><code>if (output.is_open())\n    {\n        std::unique_lock&lt;mutex&gt; locker(mtx, std::defer_lock);\n        locker.lock();\n        cond.wait(locker);\n        while (!(this-&gt;messages.empty()))\n        {\n            tempMessage = this-&gt;messages.front();\n            this-&gt;messages.pop();\n            // if multiple messages are in the queue, you unlock multiple times \n            // even though the mutex is not locked\n            locker.unlock();   \n            for (std::vector&lt;string&gt;::iterator it = this-&gt;userNames.begin(); it != this-&gt;userNames.end(); ++it)\n            {\n                tempString = *it;\n                tempString += \": \";\n                tempString += tempMessage;\n                tempString += \"\\n\";\n                output &lt;&lt; tempString;\n            }\n        }\n        output.close();\n    }\n</code></pre>\n\n<p>According to <a href=\"http://en.cppreference.com/w/cpp/thread/unique_lock/unlock\" rel=\"nofollow noreferrer\">unique_lock::unlock</a> this throws a <code>std::system_error</code></p>\n"}], "owner": {"reputation": 41, "user_id": 8969711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f95265cf504b4abba90758052b6807ab?s=128&d=identicon&r=PG&f=1", "display_name": "I.Klein", "link": "https://stackoverflow.com/users/8969711/i-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 48431443, "answer_count": 1, "score": 0, "last_activity_date": 1516827349, "creation_date": 1516826708, "question_id": 48431296, "link": "https://stackoverflow.com/questions/48431296/exceptions-while-using-mutex-and-condition-variable", "title": "Exceptions while using mutex and condition_variable", "body": "<p>I'm writing a program to read data from .txt file and using it in output .txt file. I'm using two threads; The first thread is for reading the data from the .txt file, and the second one is for writing it in the output file. I'm a beginner in the programming with mutex and condition_variable and for somehow my program handles exceptions... The exception is</p>\n\n<pre><code>abort() has been called.\n</code></pre>\n\n<p>These are the two threads methods:</p>\n\n<pre><code>void MessagesSender::readsData()\n{\n    ifstream data;\n    data.open(\"data.txt\");\n    string buffer;\n    bool toEmpty = false;\n    std::unique_lock&lt;mutex&gt; locker(mtx, std::defer_lock);\n    if (data.is_open())\n    {\n        while (std::getline(data, buffer)) //reads line to the buffer.\n        {\n            locker.lock();\n            this-&gt;messages.push(buffer); //push the message to the queue.\n            locker.unlock();\n            cond.notify_one();\n        }\n        data.close();\n        toEmpty = true;\n    }\n    else\n    {\n        cout &lt;&lt; \"Error opening file... \" &lt;&lt; endl;\n    }\n    if (toEmpty) //empty the data file.\n    {\n        ofstream emptyFile; \n        emptyFile.open(\"data.txt\", ofstream::out | ofstream::trunc);\n        emptyFile.close();\n    }\n}\n\nvoid MessagesSender::sendsData()\n{\n    ofstream output;\n    output.open(\"output.txt\");\n    string tempString;\n    string tempMessage;\n\n    if (output.is_open())\n    {\n        std::unique_lock&lt;mutex&gt; locker(mtx, std::defer_lock);\n        locker.lock();\n        cond.wait(locker);\n        while (!(this-&gt;messages.empty()))\n        {\n            tempMessage = this-&gt;messages.front();\n            this-&gt;messages.pop();\n            locker.unlock();\n            for (std::vector&lt;string&gt;::iterator it = this-&gt;userNames.begin(); it != this-&gt;userNames.end(); ++it)\n            {\n                tempString = *it;\n                tempString += \": \";\n                tempString += tempMessage;\n                tempString += \"\\n\";\n                output &lt;&lt; tempString;\n            }\n        }\n        output.close();\n    }\n    else\n    {\n        cout &lt;&lt; \"Error opening file... \" &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>Why is the program handling exception?</p>\n"}, {"tags": ["c++", "opencv", "colors", "hsv"], "comments": [{"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1516828196, "post_id": 48431159, "comment_id": 83854351, "body": "unsigned byte (Vec3b) can&#39;t represent values between 0 and 360, that&#39;s why openCV reduces the hue resolution by half and uses values from 0 to 180 by default  S and V channels are 0..255 . there is a special flag that uses 0..255 on hue channel that are scaled from 0..360 (some more resolution than 0..180) but default is 0..180"}], "answers": [{"comments": [{"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 1, "creation_date": 1516828558, "post_id": 48431611, "comment_id": 83854506, "body": "&quot;funny&quot; means &quot;efficient&quot; here: 360 just doesn&#39;t fit in an unsigned byte ;)"}], "tags": [], "owner": {"reputation": 135, "user_id": 2748979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f87acb810257b7690138cf77348c9106?s=128&d=identicon&r=PG&f=1", "display_name": "CynicalPassion63", "link": "https://stackoverflow.com/users/2748979/cynicalpassion63"}, "is_accepted": false, "score": 2, "last_activity_date": 1517141765, "last_edit_date": 1517141765, "creation_date": 1516828091, "answer_id": 48431611, "question_id": 48431159, "link": "https://stackoverflow.com/questions/48431159/opencv-hsv-parsing-issue-c/48431611#48431611", "title": "OpenCV HSV Parsing Issue (C++)", "body": "<p>OpenCV has a funny way of representing its colors.</p>\n\n<p><strong>Hue</strong> - Represented as a number from 0-179 instead of 0-360.  Therefore, multiply the H value by two before plugging it into a traditional color picker.</p>\n\n<p><strong>Saturation/Value</strong> - Represented as a number from 0-255.  To get a percentage, divide given answer by 255 and multiply by 100 to get a percentage.</p>\n\n<p>Everything works much more sensibly now. See <a href=\"http://www.shervinemami.info/colorConversion.html\" rel=\"nofollow noreferrer\">this website</a> for more details on OpenCV and HSV. </p>\n"}], "owner": {"reputation": 135, "user_id": 2748979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f87acb810257b7690138cf77348c9106?s=128&d=identicon&r=PG&f=1", "display_name": "CynicalPassion63", "link": "https://stackoverflow.com/users/2748979/cynicalpassion63"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517366488, "creation_date": 1516826123, "question_id": 48431159, "link": "https://stackoverflow.com/questions/48431159/opencv-hsv-parsing-issue-c", "title": "OpenCV HSV Parsing Issue (C++)", "body": "<p>First of all, I realize there are existing questions about converting an RGB image to an HSV image out there; I used one of those questions to help me write my code.  However, I am getting values for HSV that don't make sense to me.  </p>\n\n<p>What I know about HSV I have gotten from <a href=\"http://infohost.nmt.edu/tcc/help/pubs/colortheory/web/hsv.html\" rel=\"nofollow noreferrer\">this website</a>.  From <a href=\"http://colorizer.org/\" rel=\"nofollow noreferrer\">this colorpicker</a>, I have inferred that H is a number ranging from 0-360 degrees, S is a number ranging from 0-100%, and V is a number ranging from 0-100%.  Therefore, I had assumed that my code (as follows) would return an H value between 0 and 360, and S/V values between 0 and 100.  However, this is not the case.  </p>\n\n<p>I plugged my program's output into the above color picker, which all S/V values down to 100 when they exceeded 100.  As you can see, the output is <em>close</em> to what it should be, but is not accurate.  I feel like this is because I am interpreting the HSV values incorrectly.</p>\n\n<p>For contex, I am going to establish a range for each color on the cube and from there look at the other faces and fill out the current setup of the cube in another program I have.  </p>\n\n<p>My code: </p>\n\n<pre><code>void get_color(Mat img, int x_offset, int y_offset) \n{\n    Rect outline(x_offset - 2, y_offset - 2, 5, 5);\n    rectangle(img, outline, Scalar(255, 0, 0), 2);\n\n    Rect sample(x_offset, y_offset, 1, 1);\n    Mat rgb_image = img(sample);\n    Mat hsv_image;\n    cvtColor(rgb_image, hsv_image, CV_BGR2HSV);\n\n    Vec3b hsv = hsv_image.at&lt;Vec3b&gt;(0, 0);\n    int hue = hsv.val[0]; \n    int saturation = hsv.val[1];\n    int value = hsv.val[2];\n\n    printf(\"H: %d, S: %d, V: %d \\n\", hue, saturation, value);\n}\n</code></pre>\n\n<p>Output of the program:</p>\n\n<pre><code>H: 21, S: 120, V: 191 // top left cubie\nH: 1, S: 180, V: 159  // top center cubie\nH: 150, S: 2, V: 142  // top right cubie\nH: 86, S: 11, V: 159  // middle left cubie\nH: 75, S: 12, V: 133  // middle center cubie\nH: 5, S: 182, V: 233  // middle right cubie\nH: 68, S: 7, V: 156   // bottom left cubie\nH: 25, S: 102, V: 137 // bottom center cubie\nH: 107, S: 155, V: 69 // bottom right cubie\n</code></pre>\n\n<p>Starting image (pixel being extracted @ center of each blue square):</p>\n\n<p><a href=\"https://i.stack.imgur.com/1EzSD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1EzSD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Resulting colors (as the above color picker gave):</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vz78L.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vz78L.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, the red and white is fairly accurate, but the orange and yellow are not correct and the blue is blatantly wrong; it is impossible for the pixel I looked at to actually be that color.  What am I doing wrong?  Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "opencv", "dll", "visual-studio-2017"], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 9236834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d697eda50093f82fefe950e65cc209e3?s=128&d=identicon&r=PG&f=1", "display_name": "user9236834", "link": "https://stackoverflow.com/users/9236834/user9236834"}, "is_accepted": true, "score": 0, "last_activity_date": 1516830699, "creation_date": 1516830699, "answer_id": 48432242, "question_id": 48431086, "link": "https://stackoverflow.com/questions/48431086/opencv-3-4-0-zlibd1-dll-was-not-found/48432242#48432242", "title": "OpenCV 3.4.0 - zlibd1.dll was not found", "body": "<p>Okay, apparently it was a problem regarding my system path. It was not set right, Before, what I had was the path variable set to the following:</p>\n\n<pre><code>%OPENCV_DIR%\\lib\n%OPENCV_DIR%\\bin\n</code></pre>\n\n<p>with $(OPENCV_DIR) being just the build directory of OpenCV 3.4.0.</p>\n\n<p>But the directories there do not exist, and hence the libraries couldn't be found. So, I replaced them with this:</p>\n\n<pre><code>%OPENCV_DIR%\\x64\\vc15\\bin\n%OPENCV_DIR%\\x64\\vc15\\lib\n</code></pre>\n\n<p>and the program now runs. What was I thinking back there?</p>\n\n<p>Either way, important lesson to note: <strong>When you are getting a popup message saying the program cannot be opened because a library is missing, and is part of OpenCV 3.4.0, <em>be sure that your system path</em> in the Windows 10 System Advanced Settings is an OpenCV directory that <em>exists</em>.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 4224564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b051238d39410458e050fa9e68339f7?s=128&d=identicon&r=PG&f=1", "display_name": "globalex", "link": "https://stackoverflow.com/users/4224564/globalex"}, "is_accepted": false, "score": 0, "last_activity_date": 1549567520, "creation_date": 1549567520, "answer_id": 54580816, "question_id": 48431086, "link": "https://stackoverflow.com/questions/48431086/opencv-3-4-0-zlibd1-dll-was-not-found/54580816#54580816", "title": "OpenCV 3.4.0 - zlibd1.dll was not found", "body": "<p>This package has a problem to run under debug and result in zlibd1.dll problem. Switch to release if you can or use different nuget package.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6ENOf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6ENOf.png\" alt=\"**enter image description here**\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Y5Avi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5Avi.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 153, "user_id": 9236834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d697eda50093f82fefe950e65cc209e3?s=128&d=identicon&r=PG&f=1", "display_name": "user9236834", "link": "https://stackoverflow.com/users/9236834/user9236834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1544, "favorite_count": 0, "accepted_answer_id": 48432242, "answer_count": 2, "score": 3, "last_activity_date": 1549567520, "creation_date": 1516825788, "question_id": 48431086, "link": "https://stackoverflow.com/questions/48431086/opencv-3-4-0-zlibd1-dll-was-not-found", "title": "OpenCV 3.4.0 - zlibd1.dll was not found", "body": "<p>I have the following program, which is the same as <a href=\"https://docs.opencv.org/3.4.0/dd/d6e/tutorial_windows_visual_studio_opencv.html\" rel=\"nofollow noreferrer\">this tutorial page for OpenCV 3.4.0</a>. I am using Visual Studio 2017 Community on a 64-bit laptop with Windows 10 Enterprise 64-bit.</p>\n\n<pre><code>#include &lt;opencv2/core.hpp&gt;\n#include &lt;opencv2/imgcodecs.hpp&gt;\n#include &lt;opencv2/highgui.hpp&gt;\n#include &lt;iostream&gt;\n\nusing namespace cv;\nusing namespace std;\n\nint main( int argc, char** argv )\n{\n    if( argc != 2)\n    {\n     cout &lt;&lt;\" Usage: display_image ImageToLoadAndDisplay\" &lt;&lt; endl;\n     return -1;\n    }\n\n    Mat image;\n    image = imread(argv[1], IMREAD_COLOR); // Read the file\n\n    if( image.empty() ) // Check for invalid input\n    {\n        cout &lt;&lt; \"Could not open or find the image\" &lt;&lt; std::endl ;\n        return -1;\n    }\n\n    namedWindow( \"Display window\", WINDOW_AUTOSIZE ); // Create a window for display.\n    imshow( \"Display window\", image ); // Show our image inside it.\n\n    waitKey(0); // Wait for a keystroke in the window\n    return 0;\n}\n</code></pre>\n\n<p>With the includes and linker directories and libraries set up for this project, the solution builds just fine. But when I run the program, I get the following error:</p>\n\n<p><strong>\"The code execution cannot proceed because zlibd1.dll was not found. Reinstalling the program may fix this problem.\"</strong></p>\n\n<p>From my initial research, it's not necessarily coming from Visual Studio 2017. When I try to create a new project, I do not have the option to select \"Win32 Console Application.\" The project this source code sits in is of type Windows Console Application under Visual C++, supporting .NET Framework 4.5.</p>\n\n<p>What am I missing here? </p>\n\n<p>Based on the tutorial, I should be using only the libraries and the dynamic link libraries OpenCV 3.4.0 provides. I remember at one point using NuGET to try to install OpenCV 3.4.0 again, <a href=\"http://funvision.blogspot.com/2017/04/simple-install-opencv-visual-studio.html\" rel=\"nofollow noreferrer\">as explained here</a>, when I was trying to solve the compiler error regarding fopen from a file within OpenCV 3.4.0 itself.</p>\n"}, {"tags": ["c++", "enums"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516825505, "post_id": 48430995, "comment_id": 83852939, "body": "Why do you have the unnecessary parentheses around your return value? Why do you have <code>getType(void)</code>; that should be <code>getType()</code>."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516825620, "post_id": 48430995, "comment_id": 83852999, "body": "<code>return (Double);</code> probably fails because it looks like a cast; <code>Double</code> there would be referring to your class <code>Double</code>"}, {"owner": {"reputation": 3930, "user_id": 1474291, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/049bfa78ff2d185b51f711f74de58339?s=128&d=identicon&r=PG", "display_name": "Zingam", "link": "https://stackoverflow.com/users/1474291/zingam"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1516825625, "post_id": 48430995, "comment_id": 83853004, "body": "@Justin White spaces and new lines can also be unnecessary!"}, {"owner": {"reputation": 3930, "user_id": 1474291, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/049bfa78ff2d185b51f711f74de58339?s=128&d=identicon&r=PG", "display_name": "Zingam", "link": "https://stackoverflow.com/users/1474291/zingam"}, "edited": false, "score": 0, "creation_date": 1516825707, "post_id": 48430995, "comment_id": 83853066, "body": "@TheoWalton Try not using <code>eOperandType::</code> before the enumeration value."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 3930, "user_id": 1474291, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/049bfa78ff2d185b51f711f74de58339?s=128&d=identicon&r=PG", "display_name": "Zingam", "link": "https://stackoverflow.com/users/1474291/zingam"}, "edited": false, "score": 2, "creation_date": 1516825731, "post_id": 48430995, "comment_id": 83853080, "body": "@Zingam Yes, but <code>return (...)</code> easily leads to bugs in some cases. Thus I claim it&#39;s best to avoid it entirely. And it&#39;s completely unneeded, even for readability"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1516825770, "post_id": 48430995, "comment_id": 83853103, "body": "You might want to check out <a href=\"https://stackoverflow.com/q/18335861/1896169\"><code>enum class</code></a>"}, {"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 5, "creation_date": 1516825845, "post_id": 48430995, "comment_id": 83853134, "body": "Your class and the enum value are both called <code>Double</code>"}, {"owner": {"reputation": 3930, "user_id": 1474291, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/049bfa78ff2d185b51f711f74de58339?s=128&d=identicon&r=PG", "display_name": "Zingam", "link": "https://stackoverflow.com/users/1474291/zingam"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1516826039, "post_id": 48430995, "comment_id": 83853229, "body": "@Justin You may be right but I once read the opposite argumentation to your claim. My point is - the original question is not about style."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1516827019, "post_id": 48430995, "comment_id": 83853735, "body": "Please note that <i>&quot;changing the line to <code>return (::Double);</code>&quot;</i> doesn&#39;t really fix your code: <a href=\"https://ideone.com/PQFLJX\" rel=\"nofollow noreferrer\">ideone.com/PQFLJX</a> You should use an enum class, a scoped enum or better, change the names."}], "answers": [{"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1516825790, "creation_date": 1516825790, "answer_id": 48431087, "question_id": 48430995, "link": "https://stackoverflow.com/questions/48430995/use-of-enumeration-in-a-nested-name-specifier-compiler-warning/48431087#48431087", "title": "use of enumeration in a nested name specifier (compiler warning)", "body": "<p>If you want to used scoped enumerations you need to make the enum:</p>\n\n<pre><code>enum struct eOperandType\n</code></pre>\n\n<p>(or\"enum class\")</p>\n"}, {"comments": [{"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1516827555, "post_id": 48431169, "comment_id": 83854020, "body": "I don&#39;t think that changing the line to <code>return (::Double);</code>&quot; would be enough: <a href=\"https://ideone.com/PQFLJX\" rel=\"nofollow noreferrer\">ideone.com/PQFLJX</a> , but OP could limit the scope of the enum using a namespace: <a href=\"https://ideone.com/pAqw8b\" rel=\"nofollow noreferrer\">ideone.com/pAqw8b</a>"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1516828142, "post_id": 48431169, "comment_id": 83854329, "body": "@Bob__ The error in your example has nothing to do with the return statement, it&#39;s in the declaration of <code>a</code> within <code>main</code>. Since the code is using the same name for the class and enumerator, you must use an <a href=\"http://en.cppreference.com/w/cpp/language/elaborated_type_specifier\" rel=\"nofollow noreferrer\">elaborated type specifier</a>, <code>class Double a;</code> - <a href=\"https://ideone.com/Vss3OI\" rel=\"nofollow noreferrer\">ideone.com/Vss3OI</a>"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1516828567, "post_id": 48431169, "comment_id": 83854512, "body": "You are right and that&#39;s just a further reason to use different names."}], "tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 8, "last_activity_date": 1516826150, "creation_date": 1516826150, "answer_id": 48431169, "question_id": 48430995, "link": "https://stackoverflow.com/questions/48430995/use-of-enumeration-in-a-nested-name-specifier-compiler-warning/48431169#48431169", "title": "use of enumeration in a nested name specifier (compiler warning)", "body": "<p>Prior to C++11, you were not allowed to refer to enumerators as <em><code>enum-name::enumerator</code></em>. So <code>eOperandType::Double</code> is invalid if you're using an old compiler or haven't enabled C++11 mode. If you're using gcc or clang, pass the <code>-std=c++11</code> flag to the compiler.</p>\n\n<p>If that's not an option, then change <code>return (Double);</code> to <code>return ::Double;</code>, or <code>return (::Double);</code> if you're fond of unnecessary parentheses. Without the <code>::</code>, <code>Double</code> refers to the name of the enclosing class. By adding the scope resolution operator, you're telling the compiler you're referring to <code>Double</code> in the global namespace, i.e. the enumerator.</p>\n\n<p>The third option is to not give your class the same name as enumerators.</p>\n"}], "owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2736, "favorite_count": 0, "accepted_answer_id": 48431169, "answer_count": 2, "score": 2, "last_activity_date": 1516826150, "creation_date": 1516825430, "last_edit_date": 1516826149, "question_id": 48430995, "link": "https://stackoverflow.com/questions/48430995/use-of-enumeration-in-a-nested-name-specifier-compiler-warning", "title": "use of enumeration in a nested name specifier (compiler warning)", "body": "<p>I have an enum:</p>\n\n<pre><code>enum eOperandType\n{\n    Int8,\n    Int16,\n    Int32,\n    Float,\n    Double\n};\n</code></pre>\n\n<p>and a member function of the class 'Double'</p>\n\n<pre><code>eOperandType    Double::getType(void) const\n{\n        return (eOperandType::Double);\n}\n</code></pre>\n\n<p>and it gives me a compiler warning about using enumeration in nested name specifier.</p>\n\n<p>I also switched the  return line to: <code>return (Double);</code> but then it just gave me an error regarding an expected expression.</p>\n\n<p>How do i resolve this?</p>\n\n<hr>\n\n<p>edit: changing the line to <code>return (::Double);</code> did fix both the warning and the error. Could someone explain why this fixes it?</p>\n"}, {"tags": ["c++", "windows", "visual-studio", "dll", "loadlibrary"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9212993"}, "edited": false, "score": 0, "creation_date": 1516824168, "post_id": 48430688, "comment_id": 83852273, "body": "What makes you think you should/can directly use specific memory addresses in explicitly loaded DLLs`?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516824534, "post_id": 48430688, "comment_id": 83852465, "body": "<i>I assume that the value of X gets patched when that other DLL is loaded.</i> - very strong doubt in this. better look in file disasm - what originally was here"}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "edited": false, "score": 0, "creation_date": 1516824592, "post_id": 48430688, "comment_id": 83852492, "body": "I&#39;m just trying to fix this crash. Loading these DLLs to all be within 31-bit offsets from each other is one way to fix it, but I&#39;d be happy with any solution."}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516824759, "post_id": 48430688, "comment_id": 83852578, "body": "@RbMm I&#39;m no expert on DLLs, however the value at this location is different every time I run, but always points to the same location within that other DLL."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516824874, "post_id": 48430688, "comment_id": 83852632, "body": "absolute sure your crash nothing common with dll load addresses. you are on wrong way. you have absolute address - <code>018393916B72</code> - convert it to <code>RVA</code> (sub dll load base) and then convert rva to file offset and look what instruction originally here. compare code in memory and on disk at begin"}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516825050, "post_id": 48430688, "comment_id": 83852725, "body": "@RbMM The crash happens intermittently, and only ever happens when these DLLs are loaded more than 0x7FFFFFFF bytes from each other. Next time the crash occurs I will find the info you want and reply again."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516825173, "post_id": 48430688, "comment_id": 83852781, "body": "you are on absolute wrong way. crash not depend from dll load addresses. you must not try force LoadLibrary at some base. here something else"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516826322, "post_id": 48430688, "comment_id": 83853402, "body": "I don&#39;t see what distance has to do with this issue.  Whether a library is 32 bytes away or 32k away doesn&#39;t make a difference.  However, there may be an issue when using 64-bit addressing and 32-bit addressing.  A 64-bit application can access anything in that 64-bit range.  However, 32-bit library may not be able to <i>cross</i> a 32-bit boundary.  Everything that the 32-bit library needs to access should be within the 32-bit boundary, otherwise extended addressing techniques may be employed (successfully or unsucessfully)."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1516826451, "post_id": 48430688, "comment_id": 83853471, "body": "Best guess: in the original code there is some legacy 32 bit pointer arithmetic which was not correctly ported to 64 bit.  With ALSR being integral to Windows security you normally have no control over where a particular module is loaded."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516826626, "post_id": 48430688, "comment_id": 83853558, "body": "<code>cmp dword ptr [1831C1F95A0h],3 </code> look like access some global variable - <code>if (g_x == 3)</code> - paste several instruction before and after  crash one. convert VA - &gt; RVA -&gt; file offset - look dll disasm. paste original instructions from this file offset. begin from this"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1516826975, "post_id": 48430688, "comment_id": 83853717, "body": "@RichardCritten - <i>Best guess: in the original code there is some legacy 32 bit pointer arithmetic</i> - not think. this is or access global variable in code or modified code."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516827116, "post_id": 48430688, "comment_id": 83853784, "body": "also possible wrong rip at all - point to random place, due invalid indirect call, or return after damaged return address. for this and need look instructions around and mandatory compare with original code from disk"}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516833169, "post_id": 48430688, "comment_id": 83856831, "body": "@ThomasMatthews 32 bytes or 32k away would be fine. The problem is the two dlls are over 2 billion bytes away from each other, and then using a memory access instruction which uses a signed 32-bit immediate offset from <code>rip</code> (instruction pointer). If this offset is more than 2 billion bytes away, then there is no way for this instruction to actually reach the correct location, since the offset from <code>rip</code> will be more than what can be stored in a signed 32 bits immediate value."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516834054, "post_id": 48430688, "comment_id": 83857216, "body": "The premise sounds fishy.  It&#39;s hard to imagine a compiler intentionally concocting a relative reference to code or data that&#39;s in a different DLL or executable.  I suspect a corrupted binary or a disassembly that started from a wrong address or just a plain old bug (that&#39;s possibly intermittently obscured when the DLLs happend to load closer together)."}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1516835093, "post_id": 48430688, "comment_id": 83857613, "body": "@AdrianMcCarthy <a href=\"https://godbolt.org/g/JkJ8HF\" rel=\"nofollow noreferrer\">godbolt.org/g/JkJ8HF</a> Take a look at the disassembly binary. 83 3d 00 00 00 00 03 disassembles to <code>cmp    DWORD PTR [rip+0x0],0x3</code> The 0s are a signed 32-bit immediate value which are an offset from the current instruction pointer. It&#39;s then patched by the linker to be the offset to the global variable <code>g</code>. So, it&#39;s not so hard for me to imagine how this happened."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1516837059, "post_id": 48430688, "comment_id": 83858214, "body": "@David Clamage:  Your example doesn&#39;t cross a DLL boundary.  If I define <code>g</code> in a separate DLL, then the code generated to reference it is not a relative offset into the DLL&#39;s address range.  Instead, it&#39;s an indirect load through the import table, which the loader patches up with an absolute address.  Otherwise, any 32-bit application would run a risk of failure whenever they&#39;re executed on a 64-bit machine."}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1516837946, "post_id": 48430688, "comment_id": 83858446, "body": "@AdrianMcCarthy Adding the <code>__declspec(dllimport)</code> annotation to g changes the generated code, but not in a meaningful way (still a 32-bit relative load from <code>rip</code>). <a href=\"https://godbolt.org/g/R6escg\" rel=\"nofollow noreferrer\">godbolt.org/g/R6escg</a> I also have the evidence that this is indeed happening with this set of dlls that are causing me trouble. The dlls do not crash and function perfectly fine as long as they are loaded within &quot;range&quot; of each other. I honestly don&#39;t know why this isn&#39;t a more common occurrence, but it could be that with my particular application, it happens to occur much more frequently than in other applications."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516841270, "post_id": 48430688, "comment_id": 83859452, "body": "@David Clamage:  I&#39;m getting different code from from VS 2017 than Godbolt is showing in your example.  I have <code>mov rax, qword ptr [__imp_g]; cmp dword ptr [rax],3</code>.  The __imp_g resolves to an address within the same module, so it doesn&#39;t seem to matter where the other module actually loads.  Maybe the app was compiled with a buggy version of VS that&#39;s since been fixed."}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516843460, "post_id": 48430688, "comment_id": 83859995, "body": "@AdrianMcCarthy Could you provide the actual bytecode of the <code>mov rax</code> instruction? I&#39;m interested to know if it&#39;s still in the rip+X form."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516867623, "post_id": 48430688, "comment_id": 83867402, "body": "if <code>g</code> is imported from another module it must be defined or as <code>__declspec(dllimport) int g;</code> or as <code>extern int* g</code> - pointer to <code>int</code> but not <code>int</code>. in both case asm code will be equal - <code>mov r,[xxx], cmp r,3</code> - nothing common with <code>cmp [xxx],3</code>. the code <code>cmp [xxx],3</code> where <code>xxx</code> some hardcoded relative rip offset never can be access of data in another dll, if code generated by linker, but not patched. ant this is of course not <i>legacy 32 bit pointer arithmetic</i> (foolishness). you not want listen. show original instructions at this place from dll (on disk). and before and after this one"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516915220, "post_id": 48430688, "comment_id": 83897232, "body": "The mov is <code>48 8B 05 9B E8 00 00</code> and the cmp is <code>83 38 03</code>.  The debugger shows that the mov&#39;s source address is within the address range of the current module (presumably the import address table)."}, {"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "edited": false, "score": 1, "creation_date": 1516929362, "post_id": 48430688, "comment_id": 83902002, "body": "Using <a href=\"https://defuse.ca/online-x86-assembler.htm\" rel=\"nofollow noreferrer\">defuse.ca/online-x86-assembler.htm</a> you can see that <code>48 8b 05 9b e8 00 00</code> is <code>mov    rax,QWORD PTR [rip+0xe89b]</code> and the <code>0xe89b</code> is the last 4 bytes of the instruction in little-endian form. Thus, if this offset ends up &gt;2 billion, there will be problems. EDIT: Ah, I see what you&#39;re saying about it being in the current module. So the problem is indeed likely that the global variable from the other DLL is not declared as dllimport. I&#39;ll try to investigate that."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "edited": false, "score": 0, "creation_date": 1517250012, "post_id": 48468245, "comment_id": 84009726, "body": "I ran this command on all the DLLs for this library, and all of them were untouched except for exactly one of them. I will use this changed DLL and see if the crash continues to occur."}], "tags": [], "owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "is_accepted": false, "score": 0, "last_activity_date": 1516994842, "creation_date": 1516994842, "answer_id": 48468245, "question_id": 48430688, "link": "https://stackoverflow.com/questions/48430688/delay-loaded-dlls-are-loaded-too-far-away-in-memory-from-each-other/48468245#48468245", "title": "Delay loaded DLLs are loaded too far away in memory from each other", "body": "<p>There is no guarantee that this will work, but you could try to edit the DLLs in question with the EDITBIN command so that they are flagged as not supporting ASLR.</p>\n\n<p>The command to do that would be: </p>\n\n<p><code>editbin /DYNAMICBASE:NO /HIGHENTROPYVA:NO foo.dll</code></p>\n\n<p>Editbin comes with your msvc / windows sdk installations.</p>\n\n<p>For more info, see:\n<a href=\"https://msdn.microsoft.com/en-us/library/d25ddyfc.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/d25ddyfc.aspx</a></p>\n\n<p>If mandatory ASLR is enabled, the loader will search for a base address for such DLLs starting from the bottom of the address space. So <em>maybe</em> that means they end up close enough with each other. </p>\n\n<p>This behavior is explained in:</p>\n\n<p><a href=\"https://blogs.technet.microsoft.com/srd/2017/11/21/clarifying-the-behavior-of-mandatory-aslr/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/srd/2017/11/21/clarifying-the-behavior-of-mandatory-aslr/</a></p>\n\n<p>The last bit to try would be to load the DLL as early as possbile in the execution of your application so as much as possible of the address space would be free.</p>\n\n<p>Good luck :-).</p>\n"}], "owner": {"reputation": 103, "user_id": 5270352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c0aec070bd59eb9c682dbcaac606d4?s=128&d=identicon&r=PG&f=1", "display_name": "David Clamage", "link": "https://stackoverflow.com/users/5270352/david-clamage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1516994842, "creation_date": 1516824003, "last_edit_date": 1516830535, "question_id": 48430688, "link": "https://stackoverflow.com/questions/48430688/delay-loaded-dlls-are-loaded-too-far-away-in-memory-from-each-other", "title": "Delay loaded DLLs are loaded too far away in memory from each other", "body": "<p>I have an x64 Windows application which sometimes crashes within a DLL library which I unfortunately have no control over. This library is actually a large set of inter-dependent DLLs (~40 of them). The crash isn't always in the same place, but here's an example of what is happening:</p>\n\n<pre><code>Exception thrown at 0x0000018393916B72 (foo.dll) in bar.exe: 0xC0000005: Access violation reading location 0x000001831C1F95A0.\n</code></pre>\n\n<p>At this location, the disassembly in Visual Studio shows the following:</p>\n\n<pre><code>0000018393916B72  cmp         dword ptr [1831C1F95A0h],3  \n</code></pre>\n\n<p>This at first seemed odd to me, since that means the DLL would be hard-coded to load a value at a bad location. So, I took a look at the actual instruction memory and found the following:</p>\n\n<pre><code>83 3d 27 2a 8e 88 03\n</code></pre>\n\n<p>Which disassembles exactly to:</p>\n\n<pre><code>cmp    DWORD PTR [rip+0xffffffff888e2a27],0x3\n</code></pre>\n\n<p>What's happened here is that an instruction was generated in the DLL which says \"Compare the value located X bytes after this instruction to 3.\" This memory resides in a different DLL from this one, and X is a 32-bit value. I assume that the value of X gets patched when that other DLL is loaded.</p>\n\n<p>Looking at the actual bytes of the instruction, it's clear that it wants rip+0x888e2a27, which does point to where one of the DLLs in this library resides, but unfortunately this 32-bit value gets sign extended and it ends up looking backwards in memory instead of forwards.</p>\n\n<p>Ultimately, the root cause is that these DLLs were loaded into memory more than 0x7FFFFFFF bytes from each other, and thus when they try to reference each other with a 32-bit offset, they fail to do so. I'm unsure why the compiler which generated these DLLs opted to use an RIP+32-bit instruction instead of a 64-bit absolute address, but it seems to have done so quite frequently. Possibly a size-saving measure?</p>\n\n<p>Either way, I figure the easiest way to resolve this issue is to force <code>LoadLibrary</code> to load these DLLs next to each other, or at least relatively close to each other. I have tried various way to do this, but it seems Windows is purposefully random and opaque about where it decides to load DLLs.</p>\n\n<p>Is there any way around this problem? Here are my potential solutions, but I don't know how to do any of them:</p>\n\n<ol>\n<li><p>Force <code>LoadLibrary</code> to load the DLLs either at a specific address, or with some kind of option which forces these DLLs to be near each other in memory.</p></li>\n<li><p>Modify the DLLs themselves to remove any RIP+(32-bit value) instructions, and replace them with an instruction which supports 64-bit address values.</p></li>\n<li><p>If I could potentially get the vendor to recompile the DLLs, have them use a specific compiler flag to prevent these RIP+(32-bit value) instructions from being used. I don't know what this compiler flag would be, however. I assume they used MSVC but I'm not actually sure.</p></li>\n</ol>\n"}, {"tags": ["c++", "multithreading", "stdthread"], "comments": [{"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 4, "creation_date": 1516823968, "post_id": 48430634, "comment_id": 83852166, "body": "Platform? OS, hardware, complier?"}, {"owner": {"reputation": 68, "user_id": 5669025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbe5c92661c0eff7247372eb8cc5c58?s=128&d=identicon&r=PG&f=1", "display_name": "Borislav Kostov", "link": "https://stackoverflow.com/users/5669025/borislav-kostov"}, "edited": false, "score": 2, "creation_date": 1516824083, "post_id": 48430634, "comment_id": 83852215, "body": "You can see this question for more information <a href=\"https://stackoverflow.com/questions/16116952/can-multithreading-be-implemented-on-a-single-processor-system\">Can multithreading be implemented on a single processor system?</a>"}, {"owner": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "edited": false, "score": 0, "creation_date": 1516824347, "post_id": 48430634, "comment_id": 83852381, "body": "Microsoft Visual studio 2012, windows, the CPU is i7-4790 3.6Hz"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1516824930, "post_id": 48430634, "comment_id": 83852660, "body": "You can check which processor a thread is on with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683181(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetCurrentProcessorNumber</a> (Windows). Also, keep in mind, any race conditions in the thread proc can slow down performance."}, {"owner": {"reputation": 38119, "user_id": 3959454, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d3d3eb6143879550d0e5bd67a6bf647?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Savin", "link": "https://stackoverflow.com/users/3959454/anton-savin"}, "edited": false, "score": 1, "creation_date": 1516824991, "post_id": 48430634, "comment_id": 83852692, "body": "Hard to tell anything without <code>threadinternalenergy</code> source"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1516825672, "post_id": 48430634, "comment_id": 83853037, "body": "Why cast to <code>(float)</code> ? And Do you use <code>end_node</code> anywhere?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1516825969, "post_id": 48430634, "comment_id": 83853196, "body": "You should not have to do anything special. You might get this because the logic within the threads depends on a shared resource. Do you use any explicit locking? Another, less likely, explanation would be that only one core is available for work."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1516825981, "post_id": 48430634, "comment_id": 83853204, "body": "@rustyx Good point. If <code>first</code> doesn&#39;t get <code>end_node</code> it will most likely process the entire data set (guessing). <code>second</code> will do half the data. And <code>first.join()</code> will wait for <code>first</code> to complete so there is no speed improvement."}, {"owner": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "edited": false, "score": 0, "creation_date": 1516826253, "post_id": 48430634, "comment_id": 83853351, "body": "About the end_node, that information was missing,  I compute it in threadinternalenergy, they both do half the data"}, {"owner": {"reputation": 38119, "user_id": 3959454, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d3d3eb6143879550d0e5bd67a6bf647?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Savin", "link": "https://stackoverflow.com/users/3959454/anton-savin"}, "edited": false, "score": 2, "creation_date": 1516826296, "post_id": 48430634, "comment_id": 83853382, "body": "@M-ABouBou edit your question and add the source code of <code>threadinternalenergy</code>. And better, create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "edited": false, "score": 0, "creation_date": 1516827303, "post_id": 48430634, "comment_id": 83853872, "body": "I used the GetCurrentProcessorNumber() and for a 4 threads example, I have 3 different numbers 4,4,7,1... And I do have two consecutives &quot;process&quot; output and two &quot;start cell&quot; output like it is running in parallel... I am not sure how to interpret that but is it possible that it is running in parallel? If so, why do I not see my CPU % utilisation changing or gain in time?"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1516841025, "post_id": 48430634, "comment_id": 83859384, "body": "FYI - 1 data point: On my older Dell with dual cores, the (Ubuntu 15.10 version of) Posix Process Local Mode Semaphore completes both &quot;::sem_wait()&quot; AND &quot;::sem_post()&quot; in about 23 ns (when no context switch).  The context switch (controlled by the PPLSem_t between 2 C++ std::threads) measures about 270 ns."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "edited": false, "score": 0, "creation_date": 1516828476, "post_id": 48431172, "comment_id": 83854467, "body": "Thanks, about the memory sharing, the threads indeed all work with the same data: activemesh, does it create complication that increases time? Should I avoid that?                                                                         For the time, normally it could take between 1 or 2 seconds (it is used in an optimization which do thousands of iterations), is 1 seconds too short to optimize with multithreads?"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "reply_to_user": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "edited": false, "score": 0, "creation_date": 1516829004, "post_id": 48431172, "comment_id": 83854729, "body": "When two threads access the same cache-line with at least one of them writing to it, the hardware or OS has to scramble to get them into agreement.  That can take 30 x the time to do a simple cache access. I can&#39;t give a lesson here. Get a book written by someone who knows a lot more about it than I do."}, {"owner": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "edited": false, "score": 0, "creation_date": 1516829359, "post_id": 48431172, "comment_id": 83854923, "body": "Ok it is only reading for the share data, but maybe it stills do something similar... I will try to find more informations"}], "tags": [], "owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "is_accepted": false, "score": 1, "last_activity_date": 1516827166, "last_edit_date": 1516827166, "creation_date": 1516826175, "answer_id": 48431172, "question_id": 48430634, "link": "https://stackoverflow.com/questions/48430634/c-multithread-algorithm-creating-several-threads-running-on-the-same-cpu-threa/48431172#48431172", "title": "C++ multithread algorithm creating several threads running on the same CPU thread", "body": "<p>The threads probably run on different cores. That does not necessarily mean the program will be faster. It could possibly run much slower than with one thread. The threads must do enough work concurrently to justify the overhead of thread-creation and synchronization. There are lots of pitfalls. A likely problem is that the threads are sharing (or \"false sharing\") memory too often.</p>\n\n<p>Yes, one main idea behind threading is to \"do concurrency.\" But that can be done with a CPU that only has one core! Or it can fail to do it well with lots of cores.</p>\n\n<p>I wrote a system for controlling a robot that handled computer wafers. It ran on a CPU with one core, yet it depended strongly on concurrency. The concurrency resulted from having devices other than the CPU running concurrently with it, e.g. a servo amplifier and a network card. One high priority thread dealt exclusively with managing the servo via the network. Other threads used the slack time to plan trajectories, communicate with a host computer, etc. ... When the the servo-control thread woke up because the network card had a response from the servo, it immediately took over the CPU and did its thing.</p>\n\n<p>There was a talk this year at cppCon titled \"When a microsecond is an eternity\". The guy programs one of those sneaky stock-trade systems. All that matters to him is how fast he can deal with the network that connects him to the market. To get the throughput he needs, he uses a 4-core machine with three cores disabled. Why? Because he can't find a good enough 1 core machine.</p>\n\n<p>I also wrote a class that used multi-threading to do some calculations on a multi-core machine. It failed miserably. Some tasks are just not suited to divide-and-conquer.</p>\n"}], "owner": {"reputation": 11, "user_id": 9074155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa7fb0204d8af0ddc7e3d42050342b0?s=128&d=identicon&r=PG&f=1", "display_name": "M-A BouBou", "link": "https://stackoverflow.com/users/9074155/m-a-boubou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516827166, "creation_date": 1516823769, "last_edit_date": 1516826960, "question_id": 48430634, "link": "https://stackoverflow.com/questions/48430634/c-multithread-algorithm-creating-several-threads-running-on-the-same-cpu-threa", "title": "C++ multithread algorithm creating several threads running on the same CPU thread", "body": "<p>I am new to multithreading and I will try to be as clear as possible. I am creating a multithread algorithm in C++ with standard library, std::thread. My code is compiling and running with no errors. I put the code for  two threads. Two threads are creating with different id than the main one (I checked with getid() and the thread window in Visual Studio). The problem is that  I have no gain in time, and the % utilization of my CPU is the same so it seems that they run on the same CPU thread.</p>\n\n<p>Does it means that threading doesn't automatically mean running on different CPU cores and threads to gain time? </p>\n\n<p>Do I need to add instructions or combine this code with a multithread library? Or is there just a mistake?\nAny help would be really appreciated, thanks</p>\n\n<pre><code>double internalenergy=0;\nunsigned int NUM_THREADS = std::thread::hardware_concurrency();\nNUM_THREADS=2;\n vtkIdType num_cells = referencemesh_-&gt;GetNumberOfCells();\n int start_node[8];\n int end_node[8];\n int intervalle=num_cells/NUM_THREADS;\nfor( unsigned int i=0; i &lt; NUM_THREADS; ++i )\n{\n    start_node[i] = (float)num_cells*i/NUM_THREADS;       \n    end_node[i]   = (float)num_cells*(i+1)/NUM_THREADS;\n}\nconst double* pointeurpara;\npointeurpara=&amp;params(0);\n\ndouble value1=0;\ndouble* P_value1;\nP_value1=&amp;value1;\n\ndouble value2=0;\ndouble* P_value2;\nP_value2=&amp;value2;\n\nstd::thread first(threadinternalenergy,activemesh,referencemesh_,start_node[0],P_value1,pointeurpara);\nstd::thread second (threadinternalenergy,activemesh,referencemesh_,start_node[1],P_value2,pointeurpara);\nfirst.join(); \nsecond.join();\ndouble displacementneighpoint=*P_value1+*P_value2;\n</code></pre>\n\n<p>Here is the source code of threadinternalenergy</p>\n\n<pre><code>void threadinternalenergy(vtkSmartPointer&lt;vtkPolyData&gt;, \nactivemesh,vtkSmartPointer&lt;vtkPolyData&gt; referencemesh,int startcell,double* \ndisplacementneighpoint,const double* p) \n{\n unsigned long processnumber;\n processnumber=GetCurrentProcessorNumber();\n cout&lt;&lt;\"process \"&lt;&lt;processnumber&lt;&lt;endl;\n\nunsigned int NUM_THREADS = std::thread::hardware_concurrency();\nNUM_THREADS=2;\nvtkIdType num_cells = referencemesh-&gt;GetNumberOfCells();\nint intervalle=num_cells/NUM_THREADS;\nint endcell=startcell+intervalle;\n//cout&lt;&lt;\"start cell \"&lt;&lt;startcell&lt;&lt;endl;\n//cout&lt;&lt;\"end cell \"&lt;&lt;endcell&lt;&lt;endl;\nint numcell_th=startcell-endcell;\n\n vtkSmartPointer&lt;vtkEdgeTable&gt; vtk_edge_tableT = \nvtkSmartPointer&lt;vtkEdgeTable&gt;::New();\n  vtk_edge_tableT-&gt;InitEdgeInsertion(numcell_th*3);\n\n  // Initialize edge table\n  vtkSmartPointer&lt;vtkEdgeTable&gt; vtk_edge_table = \nvtkSmartPointer&lt;vtkEdgeTable&gt;::New();\n  vtk_edge_table-&gt;InitEdgeInsertion( numcell_th*3 );\n\n  cout&lt;&lt;\"start cell \"&lt;&lt;startcell&lt;&lt;endl;\n\n for( vtkIdType i=startcell; i &lt; endcell; ++i )\n  {   \n    vtkCell* cell = referencemesh-&gt;GetCell( i );\n // cout&lt;&lt;\"cell\"&lt;&lt;endl;\n    // Traverse edges in cell -- assuming a linear cell (line, triangle; NOT \n  rectangle)\n    for( vtkIdType j=0; j &lt; cell-&gt;GetNumberOfEdges(); ++j )\n    {\n        // cout&lt;&lt;\"edge\"&lt;&lt;endl;\n      vtkCell* edge = cell-&gt;GetEdge( j );\n\n      vtkIdType pt0 = edge-&gt;GetPointId(0);\n      vtkIdType pt1 = edge-&gt;GetPointId(1);\n\n\n    //consider edge if a displacement has been point by at least one point\n        //if(params(pt0)!=0 || params(pt1)!=0){\n\n\n          if( vtk_edge_table-&gt;IsEdge( pt0, pt1 ) == -1 ){     // If this edge \n     is not in the edge table\n                vtk_edge_table-&gt;InsertEdge( pt0, pt1 );\n              //acess point coordinate\n             // vtkPoints* listpoints=edge-&gt;GetPoints();\n              double p0 [3];\n              double p1 [3];\n              referencemesh-&gt;GetPoint(pt0,p0);\n              referencemesh-&gt;GetPoint(pt1,p1);\n\n\n                //2e Mesh (Mesh transform)\n                 double p0T [3];\n              double p1T [3];\n              activemesh-&gt;GetPoint(pt0,p0T);\n              activemesh-&gt;GetPoint(pt1,p1T);\n\n\n                    // If this edge is not in the edge table\n                vtk_edge_tableT-&gt;InsertEdge( pt0, pt1 );\n\n\n                //find displacement difference for 2 points sharing an edge\n                double squaredDistancep0 = \n                vtkMath::Distance2BetweenPoints(p0, p0T);\n                double distancep0 = sqrt(squaredDistancep0);\n                double squaredDistancep1 = \n                vtkMath::Distance2BetweenPoints(p1, p1T);\n                double distancep1 = sqrt(squaredDistancep1);\n                double difference = abs(distancep0 - distancep1);\n                difference=((difference+1)*(difference+1))-1;\n                //if(difference&gt;0.25){\n                    //cout&lt;&lt;\"grosse difference \"&lt;&lt;difference&lt;&lt;endl;\n                //}\n                *displacementneighpoint+=difference;\n                //displacementpointneigh.push_back(difference);\n\n\n\n             }\n\n        //}\n\n    } \n  }\n cout&lt;&lt;\"Fin du thread \"&lt;&lt;endl;\n }\n</code></pre>\n"}, {"tags": ["c++", "templates", "name-mangling"], "comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516823984, "post_id": 48430527, "comment_id": 83852178, "body": "You lack guards against multiple inclusion ... (like #pragma once)?"}, {"owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516827312, "post_id": 48430527, "comment_id": 83853879, "body": "The file is definitely included only once. At this time the project consists of only two files. Anyway I have include guards in place. I replaced them by #pragma once --&gt; did not change anything at all."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516830881, "post_id": 48430527, "comment_id": 83855687, "body": "Perhaps try to find what is up by erasing code and compiling until the error stops. Posted code does not compile because of misplaced }."}, {"owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516913287, "post_id": 48430527, "comment_id": 83896219, "body": "Here is the full file: <a href=\"https://gist.github.com/anonymous/ea3e450ec3562b99b65e94fce50941e9\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/ea3e450ec3562b99b65e94fce50941e9</a>"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516916302, "post_id": 48430527, "comment_id": 83897768, "body": "May be it does not like anonymous struct in union there or apparent usage of designated initializers data_t data = {.buffer = {}}; that is not C++."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516916832, "post_id": 48430527, "comment_id": 83897995, "body": "Other issue may be that since only return value of different instantiations of that template differs it may be that it causes issue with particular name mangling scheme when there are multiple different instantiations."}, {"owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516916838, "post_id": 48430527, "comment_id": 83898000, "body": "It compiles with all fabi-versions but 1 and 2. However I would have expected that the Arduino IDE does not explicitly set it and thus the default version (which is 0) should be applied. If I set it explicitly this works perfectly well. Seems the Arduino IDE does something behind my back. How would I find out which ABI version it actually uses?"}, {"owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516916868, "post_id": 48430527, "comment_id": 83898022, "body": "There is only one instantiation of the this specific template."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516917332, "post_id": 48430527, "comment_id": 83898224, "body": "I have noticed that for Arduino it is odd C++ compiler. Sometimes we need to move enum into separate header just to get some such strange error to be fixed. It is because it does generate some code on its own behind scenes."}, {"owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516917608, "post_id": 48430527, "comment_id": 83898324, "body": "I am aware of this behind my back mechanism. However this is a separate h file and it did not touch it. My impression is that it sets an abi version != 0 behind my back. However I could not find any place (incl. platform.txt) where this would be configured. If I configure fabi-version = 0 in platform.txt then the issue is fixed."}, {"owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1516918062, "post_id": 48430527, "comment_id": 83898489, "body": "By now I found that gcc 4.* defaults to abi version 2: <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html</a>"}], "owner": {"reputation": 6371, "user_id": 2036917, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xBapf.png?s=128&g=1", "display_name": "Udo Klein", "link": "https://stackoverflow.com/users/2036917/udo-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516918220, "creation_date": 1516823305, "last_edit_date": 1516918220, "question_id": 48430527, "link": "https://stackoverflow.com/questions/48430527/fabi-version-6-or-0-avoids-this-error-with-a-change-in-mangling", "title": "-fabi-version=6 (or =0) avoids this error with a change in mangling", "body": "<p>I have code like so:</p>\n\n<pre><code>namespace MLX90393 {\n\nstruct status_t {\n    // simplified for example, real implementation is more involved\n    uint8_t data;\n    explicit operator uint8_t const () { return 0; };\n};\n}\n\nstruct zyxt_t {\n    uint16_t z;\n    uint16_t y;\n    uint16_t x;\n    uint16_t t;\n};\n}\n\ntemplate &lt;uint8_t A1, uint8_t A0, TwoWire &amp;i2c, int8_t drdy_pin&gt;\nclass MLX90393_raw {\n\npublic:\n    MLX90393::status_t readMeasurement(uint8_t axis_mask, MLX90393::zyxt_t&amp; result);\n\n//\n//  Implementation starts here\n//\nusing namespace MLX90393;\n\ntemplate &lt;uint8_t A1, uint8_t A0, TwoWire &amp;i2c, int8_t drdy_pin&gt;\nstatus_t MLX90393_raw&lt;A1, A0, i2c, drdy_pin&gt;::\nreadMeasurement(uint8_t axis_mask, zyxt_t&amp; result) {\n// some implementation\n}\n</code></pre>\n\n<p>The compliler complains like so:</p>\n\n<pre><code>MLX90393_raw.h:230: error: 'MLX90393::status_t MLX90393_raw&lt;A1, A0, i2c, drdy_pin&gt;::readMeasurement(uint8_t, MLX90393::zyxt_t&amp;) [with unsigned char A1 = 0u; unsigned char A0 = 0u; TwoWire&amp; i2c = (* &amp; Wire); signed char drdy_pin = 10; uint8_t = unsigned char]' conflicts with a previous declaration\n status_t MLX90393_raw&lt;A1, A0, i2c, drdy_pin&gt;::\n          ^\n~/MLX90393_raw.h:230:10: note: previous declaration 'MLX90393::status_t MLX90393_raw&lt;A1, A0, i2c, drdy_pin&gt;::readMeasurement(uint8_t, MLX90393::zyxt_t&amp;) [with unsigned char A1 = 0u; unsigned char A0 = 0u; TwoWire&amp; i2c = (* &amp; Wire); signed char drdy_pin = 10; uint8_t = unsigned char]'\n~/MLX90393_raw.h:230:10: note: -fabi-version=6 (or =0) avoids this error with a change in mangling\n\n'MLX90393::status_t MLX90393_raw&lt;A1, A0, i2c, drdy_pin&gt;::readMeasurement(uint8_t, MLX90393::zyxt_t&amp;) [with unsigned char A1 = 0u; unsigned char A0 = 0u; TwoWire&amp; i2c = (* &amp; Wire); signed char drdy_pin = 10; uint8_t = unsigned char]' conflicts with a previous declaration\n</code></pre>\n\n<p>I have other similar members in my class and they compile fine.\nIf I add the -fabi-version=6 (or 0) then it compiles fine. However my library is aiming at Arduino users and this would require them to patch the platform.txt file. This in turn will probably discourage most users of the library.</p>\n\n<p>The issue is that  <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html\" rel=\"nofollow noreferrer\">according to the manual</a> gcc 4.* defaults to version 2. So this should be fixable by defaulting to 0.</p>\n\n<p>What is wrong with readMeasurement? Or how can I convince the compiler to mangle it without setting the compiler option from outside?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516822974, "post_id": 48430419, "comment_id": 83851544, "body": "From the context, I assume that <code>dataLen</code> is not a compile time constant. In that case, <code>char contentData[dataLen];</code> is not standard c++. It uses an extension known as variable length arrays. Some compilers like gcc support it by default, but it&#39;s not portable."}, {"owner": {"reputation": 1, "user_id": 9249024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b481fc9208bec5d46889d9bdb2c83b0e?s=128&d=identicon&r=PG&f=1", "display_name": "dafi", "link": "https://stackoverflow.com/users/9249024/dafi"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516823036, "post_id": 48430419, "comment_id": 83851582, "body": "@Fran&#231;oisAndrieux I&#39;ve read that I can use this in <code>g++</code>: <a href=\"https://stackoverflow.com/a/15013295/9249024\">stackoverflow.com/a/15013295/9249024</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516823091, "post_id": 48430419, "comment_id": 83851612, "body": "It&#39;s not wrong to use them, but you should prefer portable alternatives such as <code>std::vector</code>. Though on Stack Overflow, unless otherwise specified, c++ code is expected to be standard conforming."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1516823122, "post_id": 48430419, "comment_id": 83851633, "body": "It seems unlikely that <code>contentData</code> is null terminated, meaning it wouldn&#39;t be a string. Passing it to <code>strcpy</code> would be undefined behavior."}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "edited": false, "score": 0, "creation_date": 1516832284, "post_id": 48430419, "comment_id": 83856382, "body": "Could you put the declarations for the member variables of your Answer class?"}], "owner": {"reputation": 1, "user_id": 9249024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b481fc9208bec5d46889d9bdb2c83b0e?s=128&d=identicon&r=PG&f=1", "display_name": "dafi", "link": "https://stackoverflow.com/users/9249024/dafi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516822875, "creation_date": 1516822875, "question_id": 48430419, "link": "https://stackoverflow.com/questions/48430419/copy-part-of-array-and-pass-to-constructor", "title": "Copy part of array and pass to constructor", "body": "<p>I have an array <code>char buffer[]</code>. What I want to do, is to copy values from <code>buffer</code> from <code>foundSecondComma+1</code> to <code>foundSecondComma+1+dataLen</code>. </p>\n\n<p>Next, I want to creat object <code>Answer a</code> and pass to constructor few data with part of <code>buffer</code>.</p>\n\n<pre><code>// here extracted buffer will be stored\nchar contentData[dataLen];\n\n// extract data from buffer\ncopy(buffer + foundSecondComma+1, buffer+foundSecondComma+1+dataLen, contentData);\n\n//create new object and push to list\nAnswer a(dataLen, header, contentData);\nanswers.push_back(a);\n</code></pre>\n\n<p>And this is my <code>Answer</code> class:</p>\n\n<pre><code>Answer::Answer(int dataLen, string header, char* content) {\n    this-&gt;dataLen = dataLen;\n    this-&gt;header = header;\n\n    this-&gt;content = new char[strlen(content)+1];\n    strcpy(this-&gt;content, content);\n}\n</code></pre>\n\n<p>So for some reason <code>a.content</code> stores different data than part of <code>buffer</code>. This simple loop:</p>\n\n<pre><code>for(int i=0; i&lt;v.dataLen; i++)\n{\n    printf(\"buffer[%d]=%c  a.content[%d]=%c\\n\", i, buffer[foundSecondComma+1+i], i, a.content[i]);\n}\n</code></pre>\n\n<p>Is showing, that values are not the same. Where I make mistake? I am using <code>g++</code> to compile program.</p>\n"}, {"tags": ["c++", "linux", "g++", "linux-mint"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 6, "creation_date": 1516822827, "post_id": 48430356, "comment_id": 83851459, "body": "Set the standard you want to use explicitly in your buildsystem, you don&#39;t want your build to break because some system happens to have different defaults than yours."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 4, "creation_date": 1516822933, "post_id": 48430356, "comment_id": 83851526, "body": "In the makefile, add <code>-stdc++14</code> to the compilation flags   (e.g. to <code>CXXFLAGS</code> variable).   In other words, set up the makefile which orchestrates building to do the build as required, not the compiler."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1516825759, "post_id": 48430356, "comment_id": 83853092, "body": "The most complete remediation is likely to change GCC&#39;s <a href=\"https://stackoverflow.com/q/5778449/608639\">SPEC file</a> so <code>-std=c++14</code> is added if and <code>-std</code> option is missing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9212993"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1516826898, "post_id": 48430356, "comment_id": 83853682, "body": "@jww You should consider to write another answer referring to that Q&amp;A you linked, or propose this as a possible duplicate."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1516841374, "post_id": 48430356, "comment_id": 83859478, "body": "@jww not if your code is also meant to be build by other people who haven&#39;t done that...  the source (including makefiles or whatever) should be written to work with default compiler installs"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1516842637, "post_id": 48430356, "comment_id": 83859766, "body": "Thanks @M.M. That sounds like a different problem - the code does not compile without C++14. I think OP wants to use <code>-std=c++14</code> as a default for his local installation."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1586469771, "post_id": 48430356, "comment_id": 108147755, "body": "This shows how to modify <code>gcc</code> spec file in-place: <a href=\"https://stackoverflow.com/a/17224826/412080\">stackoverflow.com/a/17224826/412080</a>"}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1516825638, "post_id": 48430432, "comment_id": 83853012, "body": "Too many Autotools projects don&#39;t honor <code>CFLAGS</code> and <code>CXXFLAGS</code>. Neither does CMake. It is a pandemic problem. The most complete remediation is likely to change GCC&#39;s <a href=\"https://stackoverflow.com/q/5778449/608639\">SPEC file</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9212993"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1516825759, "post_id": 48430432, "comment_id": 83853093, "body": "@jww Good idea. Though it&#39;s still unclear if the OP want&#39;s to use autotools generated build systems, or their own."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9212993"}, "is_accepted": false, "score": 2, "last_activity_date": 1516823551, "last_edit_date": 1516823551, "creation_date": 1516822912, "answer_id": 48430432, "question_id": 48430356, "link": "https://stackoverflow.com/questions/48430356/how-to-make-g-std-c14-the-default-option/48430432#48430432", "title": "How to make g++ -std=c++14 the default option", "body": "<p>Set an environment variable in one of your <code>.rc</code> scripts:</p>\n\n<pre><code>export CXXFLAGS = \"$CXXFLAGS -std=c++14\"\n</code></pre>\n\n<p>that should affect all calls to <code>make</code> unless the variable is explicitly set in the <code>Makefile</code> again.</p>\n\n<hr>\n\n<p>Another option is to provide a <code>config.mak</code> file, you can include in your <code>Makefile</code>s:</p>\n\n<h3><code>Makefile</code>:</h3>\n\n<pre><code>include config.mak\n\n# ... rules and actions\n</code></pre>\n\n<h3><code>config.mak</code>:</h3>\n\n<pre><code>CXXFLAGS += \"-std=c++14\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "is_accepted": false, "score": 0, "last_activity_date": 1516840907, "creation_date": 1516840907, "answer_id": 48433933, "question_id": 48430356, "link": "https://stackoverflow.com/questions/48430356/how-to-make-g-std-c14-the-default-option/48433933#48433933", "title": "How to make g++ -std=c++14 the default option", "body": "<p>That's just not how compilers and software distribution on Linux distributions work.</p>\n\n<p>There are many build systems, ranging from plan Makefiles, Autotools, scons, CMake, qmake, waf, Bazel, Buck, Mezon... you name it. Each and every one of these has a distinct method on how to specify the compiler and its options.</p>\n\n<p>A compiler's default settings also affect behavior, and these defaults are different in each compiler's version. </p>\n\n<p>Also, as a user, or someone who is \"just\" compiling software written by someone else, you should not be overriding the author's idea about a language standard in the general case. Doing that it potentially dangerous.</p>\n\n<p>If, however, this is about your own software and your convenience, then my suggestion is to use a real build system which lets you specify the compiler options <em>and</em> the language standard globally, from one location. You are also setting other non-default flags such as <code>-Wall</code>, aren't you?</p>\n"}], "owner": {"reputation": 11, "user_id": 7631802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ad14ff019b15df9270d9b8815a8f4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Quijano", "link": "https://stackoverflow.com/users/7631802/sergio-quijano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6529, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586469334, "creation_date": 1516822648, "last_edit_date": 1586469334, "question_id": 48430356, "link": "https://stackoverflow.com/questions/48430356/how-to-make-g-std-c14-the-default-option", "title": "How to make g++ -std=c++14 the default option", "body": "<p>I have been using Ubuntu for so long, and a few days before I decided to switch to Linux Mint. On ubuntu, I never had any problems on compiling C++ source code written for the <code>c++14</code> standard. But on Mint, the default standard is <code>c++98</code>. I tried to make an alias as follows:</p>\n\n<p><code>alias g++=\"g++ -std=c++14</code></p>\n\n<p>and it worked for small programs that I manually compile. However, this is not a solution for automatic software building with Makefiles, so I want to tell g++ to use <code>c++14</code> as the default ISO. Thanks for your help</p>\n\n<p>I want this for me, more concretly I want to do something like:</p>\n\n<p><code>std::vector&lt;int&gt; numbers = {1, 2, 3, 4, 5};</code></p>\n"}, {"tags": ["c++", "vector", "systemc"], "answers": [{"tags": [], "owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "is_accepted": true, "score": 2, "last_activity_date": 1516826346, "last_edit_date": 1516826346, "creation_date": 1516824300, "answer_id": 48430761, "question_id": 48430350, "link": "https://stackoverflow.com/questions/48430350/declare-vector-of-systemc-type-sc-fix/48430761#48430761", "title": "Declare vector of SystemC type sc_fix", "body": "<p>You have to remove the <code>*</code> after <code>sc_fix</code> do declare a variable of type <code>sc_fix</code>, not pointer-to <code>sc_fix*</code>, and call it's constructor:</p>\n\n<pre><code>sc_fix img_num (32, 15, SC_RND_ZERO, SC_SAT_ZERO);\n</code></pre>\n\n<p>The compiler tried to initialize a pointer and complained about the too many initializes provided.</p>\n\n<p>But I think what you want to do is allocate vector with 4 numbers:</p>\n\n<pre><code>std::vector&lt;sc_fix&gt; img_num (4, sc_fix(32, 15, SC_RND_ZERO, SC_SAT_ZERO));\nimg_num[0] = 12.12;\nimg_num[1] = 12.12;\nimg_num[2] = 12.12;\nimg_num[3] = 12.12;\n</code></pre>\n"}], "owner": {"reputation": 1013, "user_id": 1260632, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/naaTn.png?s=128&g=1", "display_name": "Tropical_Peach", "link": "https://stackoverflow.com/users/1260632/tropical-peach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 48430761, "answer_count": 1, "score": 1, "last_activity_date": 1523819855, "creation_date": 1516822615, "last_edit_date": 1523819855, "question_id": 48430350, "link": "https://stackoverflow.com/questions/48430350/declare-vector-of-systemc-type-sc-fix", "title": "Declare vector of SystemC type sc_fix", "body": "<p>I am trying to make a <code>std::vector</code> of type <code>sc_fix</code> .  I know that I can make <code>std::vector&lt;sc_fixed&lt;WL,IWL, ...&gt;&gt; name;</code> . However I would like to use the non-template version <code>sc_fixed</code>. However I am not sure how to instantiate this vector and set the word and integer bit lengths as I can not declare it the same was as the templated version. </p>\n\n<p>I have tried making an array to fill in a memory space of the same  type, but this gives me an error as well. </p>\n\n<pre><code>sc_fix* img_num (32, 15, SC_RND_ZERO, SC_SAT_ZERO);\nimg_num[0] = 12.12;\nimg_num[1] = 12.12;\nimg_num[2] = 12.12;\nimg_num[3] = 12.12;\nstd::vector&lt;sc_fix&gt; img (img_num, img_num+sizeof(img_num) / sizeof(img_num[0]));\n</code></pre>\n\n<p>This gives me the error </p>\n\n<pre><code>Main_Test.cpp: In function \u2018int sc_main(int, char**)\u2019:\nMain_Test.cpp:24: error: initializer expression list treated as compound expression\nMain_Test.cpp:24: error: cannot convert \u2018sc_dt::sc_o_mode\u2019 to \u2018sc_dt::sc_fix*\u2019 in initialization\nmake: *** [Main_Test] Error 1\n</code></pre>\n\n<p>What is causing this error and how can I fix it?</p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1516832680, "post_id": 48430337, "comment_id": 83856588, "body": "Don&#39;t use 1,2,3... , but <code>CV_8U</code>, <code>CV_16U</code>, <code>CV_16S</code>, <code>CV_32S</code>, <code>CV_32F</code> respectively. Also you can&#39;t cast a <code>pointer</code> like that"}, {"owner": {"reputation": 65, "user_id": 5957244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e7b3d2351ecc6328ece85e65a1e1cfaa?s=128&d=identicon&r=PG&f=1", "display_name": "Weilliam", "link": "https://stackoverflow.com/users/5957244/weilliam"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1516834769, "post_id": 48430337, "comment_id": 83857494, "body": "@Miki Thank you for pointing it out, I though they are the same since OpenCV define those them with numbers.  Do you have any workaround for this situation?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5957244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e7b3d2351ecc6328ece85e65a1e1cfaa?s=128&d=identicon&r=PG&f=1", "display_name": "Weilliam", "link": "https://stackoverflow.com/users/5957244/weilliam"}, "edited": false, "score": 0, "creation_date": 1516827098, "post_id": 48430778, "comment_id": 83853773, "body": "Thank you, it looks like a good method and I will look into that. Sorry forgot to mention the input type.  It&#39;s a cv::Mat type input for images from OpenCV"}], "tags": [], "owner": {"reputation": 170, "user_id": 8641205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb48f50b89f29ec4d2f9f025b030c801?s=128&d=identicon&r=PG&f=1", "display_name": "SirHeadshot", "link": "https://stackoverflow.com/users/8641205/sirheadshot"}, "is_accepted": false, "score": 0, "last_activity_date": 1516824431, "creation_date": 1516824431, "answer_id": 48430778, "question_id": 48430337, "link": "https://stackoverflow.com/questions/48430337/c-type-conversion-according-to-different-input-types-opencv/48430778#48430778", "title": "C++ type conversion according to different input types (OpenCV)", "body": "<p>Since you gave no information about this src structure, I can't really figure out what your goal is.</p>\n\n<p>It seems like bad design in sense of structure and relationship between objects since you can't just simply change the type of a value.</p>\n\n<p>What you could actually do (if that helps) is specializing the structure of your src variable like this:</p>\n\n<pre><code>template &lt;typename T, unsigned int depth&gt;\nstruct Image;\n\ntemplate &lt;typename T&gt;\nstruct Image&lt;0&gt; {}; // Implement with char*\n\ntemplate &lt;typename T&gt;\nstruct Image&lt;1&gt; {}; // Implement with unsigned char*\n\ntemplate &lt;typename T&gt;\nstruct Image&lt;2&gt; {}; // Implement with short*\n\n// and so on...\n</code></pre>\n\n<p>This will make an own struct for each depth and is even faster since you don't have to do runtime conditions.</p>\n"}], "owner": {"reputation": 65, "user_id": 5957244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e7b3d2351ecc6328ece85e65a1e1cfaa?s=128&d=identicon&r=PG&f=1", "display_name": "Weilliam", "link": "https://stackoverflow.com/users/5957244/weilliam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516827150, "creation_date": 1516822573, "last_edit_date": 1516827150, "question_id": 48430337, "link": "https://stackoverflow.com/questions/48430337/c-type-conversion-according-to-different-input-types-opencv", "title": "C++ type conversion according to different input types (OpenCV)", "body": "<p>I'm building a function which involves looping to each pixel in the input image.</p>\n\n<p>I want to use pointers to access each value since it's faster to do it.</p>\n\n<p>However, since input image could have different depths (8bits,16bits,32bits), I need to create the correct type of pointer accordingly in order to access the pixel values.</p>\n\n<p>Here's what I do: //src is a cv::Mat type input from OpenCV</p>\n\n<pre><code>uchar *pointer = src.ptr&lt;uchar&gt;(0);\nif (src.depth() == 1) { (char)*pointer; *pointer = src.ptr&lt;char&gt;(0); }\nif (src.depth() == 2) { (ushort)*pointer; *pointer = src.ptr&lt;ushort&gt;(0); }\nif (src.depth() == 3) { (short)*pointer; *pointer = src.ptr&lt;short&gt;(0); }\nif (src.depth() == 4) { (int)*pointer; *pointer = src.ptr&lt;int&gt;(0); }\nif (src.depth() == 5) { (float)*pointer; *pointer = src.ptr&lt;float&gt;(0); }\n</code></pre>\n\n<p>It gives me the error: <strong>a value of type 'char/ushort/short/int/float' can't not be assign to entity of of type 'uchar'</strong></p>\n\n<p>If there any way I can solve this problem? Thanks in advance.</p>\n"}, {"tags": ["c++", "raspberry-pi", "imagemagick", "embedded-linux", "affdex-sdk"], "comments": [{"owner": {"reputation": 5862, "user_id": 781332, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/163e3a2823db42ff072854eae18d033f?s=128&d=identicon&r=PG", "display_name": "Andy Dennie", "link": "https://stackoverflow.com/users/781332/andy-dennie"}, "edited": false, "score": 0, "creation_date": 1516834607, "post_id": 48430316, "comment_id": 83857436, "body": "from the symptoms described, it sounds like the error is coming from ImageMagick, not the Affex SDK.  Can you debug into the ImageMagick code and determine why it&#39;s throwing that exception?"}, {"owner": {"reputation": 3, "user_id": 9256229, "user_type": "registered", "profile_image": "https://graph.facebook.com/1392939200816118/picture?type=large", "display_name": "Ben Ammar Hazem", "link": "https://stackoverflow.com/users/9256229/ben-ammar-hazem"}, "reply_to_user": {"reputation": 5862, "user_id": 781332, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/163e3a2823db42ff072854eae18d033f?s=128&d=identicon&r=PG", "display_name": "Andy Dennie", "link": "https://stackoverflow.com/users/781332/andy-dennie"}, "edited": false, "score": 0, "creation_date": 1516867801, "post_id": 48430316, "comment_id": 83867495, "body": "yes , i found this error : what(): basic_string::_M_construct null not valid"}, {"owner": {"reputation": 5862, "user_id": 781332, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/163e3a2823db42ff072854eae18d033f?s=128&d=identicon&r=PG", "display_name": "Andy Dennie", "link": "https://stackoverflow.com/users/781332/andy-dennie"}, "edited": false, "score": 1, "creation_date": 1517067493, "post_id": 48430316, "comment_id": 83947900, "body": "that&#39;s just the exception message.  Why is it throwing the exception?  ImageMagick is open source, you should be able to debug into it and see why it&#39;s throwing."}, {"owner": {"reputation": 5862, "user_id": 781332, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/163e3a2823db42ff072854eae18d033f?s=128&d=identicon&r=PG", "display_name": "Andy Dennie", "link": "https://stackoverflow.com/users/781332/andy-dennie"}, "edited": false, "score": 0, "creation_date": 1517067874, "post_id": 48430316, "comment_id": 83948018, "body": "also, you may get more assistance if you change the title and tag of your question to reference ImageMagick, as the problem  you&#39;re encountering doesn&#39;t seem to have anything to do with the Affectiva SDK."}, {"owner": {"reputation": 3, "user_id": 9256229, "user_type": "registered", "profile_image": "https://graph.facebook.com/1392939200816118/picture?type=large", "display_name": "Ben Ammar Hazem", "link": "https://stackoverflow.com/users/9256229/ben-ammar-hazem"}, "reply_to_user": {"reputation": 5862, "user_id": 781332, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/163e3a2823db42ff072854eae18d033f?s=128&d=identicon&r=PG", "display_name": "Andy Dennie", "link": "https://stackoverflow.com/users/781332/andy-dennie"}, "edited": false, "score": 0, "creation_date": 1517089040, "post_id": 48430316, "comment_id": 83954500, "body": "thank you for your response sir , sorry i&#39;m a beginner  i don&#39;t know how to debug into the ImageMagick code can you help me"}, {"owner": {"reputation": 5862, "user_id": 781332, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/163e3a2823db42ff072854eae18d033f?s=128&d=identicon&r=PG", "display_name": "Andy Dennie", "link": "https://stackoverflow.com/users/781332/andy-dennie"}, "edited": false, "score": 0, "creation_date": 1517491733, "post_id": 48430316, "comment_id": 84123495, "body": "I&#39;m not familiar with that library, however, I think you may get more assistance for this issue if you change the title of the question to something like &quot;Magick::ErrorResourceLimit error from ImageMagick library&quot; and reduce your code example to just the couple of lines that are relevant:  \t//Initialize the imagemagick library \tMagick::InitializeMagick(*argsv); \t \t// Read Image into Memory \tMagick::Image img(argsv[1]); \tchar * pixels = new char [img.columns() * img.rows() * 1]; \timg.write(0,0,img.columns(), img.rows(), &quot;RGB&quot;, MagickCore::StorageType::CharPixel, pixels);"}], "answers": [{"tags": [], "owner": {"reputation": 20869, "user_id": 438117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec2e8d45b1a0210065d1a4e3800f151?s=128&d=identicon&r=PG", "display_name": "emcconville", "link": "https://stackoverflow.com/users/438117/emcconville"}, "is_accepted": true, "score": 0, "last_activity_date": 1518017578, "creation_date": 1518017578, "answer_id": 48667574, "question_id": 48430316, "link": "https://stackoverflow.com/questions/48430316/affectiva-affdex-issue-with-detecting-emotions-from-a-photo/48667574#48667574", "title": "affectiva affdex issue with detecting emotions from a photo", "body": "<p>The <code>pixels</code> buffer isn't large enough to accept all the data.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>size_t pixels_size = img.columns() // Width\n                   * img.rows()    // Height\n                   * sizeof(char)  // Size of storage\n                   * 3;            // Number of parts per pixel (\"RGB\")\nchar * pixels = new char [pixels_size];\nimg.write(0,0,img.columns(), img.rows(), \"RGB\", MagickCore::StorageType::CharPixel, pixels);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9256229, "user_type": "registered", "profile_image": "https://graph.facebook.com/1392939200816118/picture?type=large", "display_name": "Ben Ammar Hazem", "link": "https://stackoverflow.com/users/9256229/ben-ammar-hazem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 1, "accepted_answer_id": 48667574, "answer_count": 1, "score": 0, "last_activity_date": 1518017578, "creation_date": 1516822492, "last_edit_date": 1517078304, "question_id": 48430316, "link": "https://stackoverflow.com/questions/48430316/affectiva-affdex-issue-with-detecting-emotions-from-a-photo", "title": "affectiva affdex issue with detecting emotions from a photo", "body": "<p>i\u2019m trying to analyse an image with affdex SDK (like the seconde example done by Abdelrahman Mahmoud <a href=\"https://www.youtube.com/watch?v=8tSx3xlWNnc&amp;list=PL4uhb2yWZJbxnoqeLQ5O_EsKMUiGYy5zt&amp;index=3\" rel=\"nofollow noreferrer\">link for tutorial</a> ) i\u2019m using raspberry pi 3b running Raspbian stretch with gcc 6.3.0</p>\n\n<p>the code :</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#include &lt;iostream&gt;\r\n#include &lt;string&gt;\r\n#include \"Magick++.h\"\r\n#include \"PhotoDetector.h\"\r\n\r\nclass Listener : public affdex::ImageListener{\r\n\tvoid onImageResults(std::map&lt;affdex::FaceId,affdex::Face&gt; faces,affdex::Frame image){\r\n\t\tstd::cout &lt;&lt; \"Found Faces: \"&lt;&lt; faces.size() &lt;&lt; std::endl;\r\n\r\n\t\tfor (auto pair : faces){\r\n\t\t\tstd::string pronoun=\"they\";\r\n\t\t\tstd::string emotion=\"neutral\";\r\n\t\t\taffdex::Face face=pair.second;\r\n\r\n\t\t\tif(face.appearance.gender == affdex::Gender::Male){\r\n\t\t\t\tpronoun=\"He\";\r\n\t\t\t}\r\n\t\t\telse if(face.appearance.gender == affdex::Gender::Female){\r\n\t\t\t\tpronoun=\"She\";\r\n\t\t\t}\r\n\t\t\tif(face.emotions.joy&gt;25){\r\n\t\t\t\temotion=\"Happy :)\";\r\n\t\t\t}\r\n\t\t\telse if(face.emotions.sadness&gt;25){\r\n\t\t\t\temotion=\"Sad :(\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tstd::cout &lt;&lt; face.id &lt;&lt; \" : \" &lt;&lt; pronoun &lt;&lt; \" looks \" &lt;&lt; emotion &lt;&lt; std::endl;\r\n\t\t}\r\n\t};\r\n\t\r\n\tvoid onImageCapture(affdex::Frame image){};\r\n};\r\n\r\nint main(int argc, char ** argsv)\r\n{\r\n\t\r\n\t//Initialize the imagemagick library\r\n\tMagick::InitializeMagick(*argsv);\r\n\t\r\n\t// Read Image into Memory\r\n\tMagick::Image img(argsv[1]);\r\n\tchar * pixels = new char [img.columns() * img.rows() * 1];\r\n\timg.write(0,0,img.columns(), img.rows(), \"RGB\", MagickCore::StorageType::CharPixel, pixels);\r\n\t\r\n\taffdex::Frame frame(img.columns(), img.rows(), pixels, affdex::Frame::COLOR_FORMAT::BGR);\r\n\t\r\n\taffdex::PhotoDetector detector(1);\r\n\taffdex::ImageListener * listen = new Listener();\r\n\t\r\n\tdetector.setImageListener(listen);\r\n\t\r\n\tdetector.setClassifierPath(\"/home/pi/affdex-sdk/data\");\r\n\tdetector.setDetectAllEmotions(true);\r\n\tdetector.setDetectAllAppearances(true);\r\n\tdetector.setDetectAllExpressions(true);\r\n\t\r\n\tdetector.start();\r\n\tdetector.process(frame);\r\n\tdetector.stop();\r\n\r\n\tdelete listen;\r\n\tdelete [] pixels;\r\n\treturn 0;\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>when i run the script with</p>\n\n<blockquote>\n  <p>./test-app image.jpg</p>\n</blockquote>\n\n<p>i got this error (the same if i use .bmp image ):</p>\n\n<blockquote>\n  <p>segmentation fault</p>\n</blockquote>\n\n<p>i tried with an other image and i got this error :</p>\n\n<blockquote>\n  <p>terminate called after throwing an instance of \u2018Magick::ErrorResourceLimit\u2019 ** what(): test-app: memory allocation failed `download.png\u2019 @ error/png.c/ReadOnePNGImage/2341 \n  Aborted</p>\n</blockquote>\n\n<p>Any pointers, thanks </p>\n"}, {"tags": ["c++", "multithreading", "boost", "c++14", "shared-ptr"], "comments": [{"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1516829067, "post_id": 48430287, "comment_id": 83854757, "body": "Have you checked if the <code>io_service</code> has successfully stopped?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1516831669, "post_id": 48430287, "comment_id": 83856106, "body": "Run with asan/ubsan and you&#39;ll see it actually crashes and burns, if it appears to &quot;hang&quot; it&#39;s merely because of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behaviour</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "edited": false, "score": 0, "creation_date": 1516848432, "post_id": 48430287, "comment_id": 83861142, "body": "I haven&#39;t checked if the <code>io_service</code> has actually stopped. I gets past that call so i just assumed, but that&#39;s a good point. I&#39;ll go ahead and compile it with asan and see if that helps. thanks all!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "edited": false, "score": 0, "creation_date": 1516847951, "post_id": 48432291, "comment_id": 83861031, "body": "Thanks for the answer! I&#39;ll have to take a look at the documentation and get back!"}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": false, "score": 0, "last_activity_date": 1516830887, "creation_date": 1516830887, "answer_id": 48432291, "question_id": 48430287, "link": "https://stackoverflow.com/questions/48430287/boost-threads-and-shared-ptrs/48432291#48432291", "title": "Boost threads and shared_ptrs", "body": "<p>You fatal problem is here:</p>\n\n<pre><code>std::shared_ptr&lt;boost::thread&gt; t1(new boost::thread(\n    boost::bind(&amp;boost::asio::io_service::run, &amp;ioService)));\nthreads.add_thread(t1.get());\n</code></pre>\n\n<p>From the documentation of <code>boost::thread_group</code>(<a href=\"http://www.boost.org/doc/libs/1_42_0/doc/html/thread/thread_management.html#thread.thread_management.threadgroup.destructor\" rel=\"nofollow noreferrer\">http://www.boost.org/doc/libs/1_42_0/doc/html/thread/thread_management.html#thread.thread_management.threadgroup.destructor</a>), the effect of its destructor is</p>\n\n<blockquote>\n  <p>Destroy *this and delete all boost::thread objects in the group.</p>\n</blockquote>\n\n<p>Thus <code>boost::thread_group</code> will exclusively participate in the resource management of its threads, you cannot store those threads in a <code>shared_ptr</code>.</p>\n\n<p>To solve it, you need to read the linked documentation for <code>boost::thread_group</code> carefully, use <code>create_thread()</code> and store it as a raw pointer instead.</p>\n"}, {"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1516831465, "post_id": 48432404, "comment_id": 83856013, "body": "Loose other notes: handle exceptions emanating from <code>io_service::run</code> (see  <a href=\"https://stackoverflow.com/a/46935201/85371\">also</a>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "edited": false, "score": 0, "creation_date": 1516847880, "post_id": 48432404, "comment_id": 83861012, "body": "Thanks for the great answer! So the reason I have threads in the <code>thread_group</code>  and in the vector is because in order for <code>thread_group</code> to be able to remove threads it needs the thread object you want to remove. So i figured if I save the threads in a vector then I can build the capability to remove the thread by popping it from the vector and passing it to the <code>thread_group</code>. But I will have to try your solution tomorrow! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "edited": false, "score": 0, "creation_date": 1516848750, "post_id": 48432404, "comment_id": 83861216, "body": "Also thanks for all your advice and points you made. I definitely, see what you are talking about."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1516890971, "post_id": 48432404, "comment_id": 83882385, "body": "If you insist on tracking the thread objects (why?) here&#39;s how you could write it: <a href=\"http://coliru.stacked-crooked.com/a/9318ce6b4cd3545d\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/9318ce6b4cd3545d</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "edited": false, "score": 0, "creation_date": 1516932934, "post_id": 48432404, "comment_id": 83902827, "body": "Wow awesome! Thanks a bunch for help! So i guess the only reason I wanted to track the individual thread objects was so then i could pass it to <code>boost::thread_group::remove()</code>. Would you recommend against that feature? Or would it be better to use a different object instead of <code>thread_group</code>"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1516933029, "post_id": 48432404, "comment_id": 83902844, "body": "I showed you what I&#39;d do. A thread pool, by definition, should not care which individual thread is which. Removing any individual thread is... not a feature for me. Indeed, you can have a <code>reduce</code>, maybe <code>resize</code> operation. As you can see, it&#39;s not too hard to implement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "edited": false, "score": 0, "creation_date": 1516933624, "post_id": 48432404, "comment_id": 83902972, "body": "Ya I see what you&#39;re saying. Well i appreciate your advice! You clearly know a ton so its been cool to learn from you&#39;r examples!"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1516831835, "last_edit_date": 1516831835, "creation_date": 1516831330, "answer_id": 48432404, "question_id": 48430287, "link": "https://stackoverflow.com/questions/48430287/boost-threads-and-shared-ptrs/48432404#48432404", "title": "Boost threads and shared_ptrs", "body": "<p>To be honest I looked at the code for a good few minutes and got more and more concerned.</p>\n\n<p>Why are threads in two collections (thread_group and the vector)? Why are threads owned in another collection? Why is the work object permanent? Why are you axing the service instead of letting the pool drain?</p>\n\n<p>Why is poolsize redundantly stored?</p>\n\n<p>Why is the constructor 99% duplicated?</p>\n\n<p>Why is <code>add1</code> taking a mutable reference, but the bind is by value?</p>\n\n<h2>Simplify</h2>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/cb999df3036b0da1\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/asio.hpp&gt;\n#include &lt;boost/thread.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nnamespace Experimental { \n    namespace ba = boost::asio;\n\n    class Pool {\n      private:\n        ba::io_service ioService;\n        boost::thread_group threads;\n        boost::optional&lt;ba::io_service::work&gt; work { ioService };\n\n      public:\n        Pool(std::size_t psize = boost::thread::hardware_concurrency()) {\n            for (size_t i = 0; i &lt; psize; i++) {\n                threads.create_thread(boost::bind(&amp;ba::io_service::run, &amp;ioService));\n            }\n        }\n\n        template &lt;typename F, typename... Args&gt; void add_work(F f, Args... args) {\n            ioService.post(boost::bind(f, args...));\n        }\n\n        ~Pool() {\n            work.reset();\n            threads.join_all();\n        }\n\n        std::size_t size() const { return threads.size(); }\n    };\n}\n\nvoid add1(int &amp;num) { std::cout &lt;&lt; ++num &lt;&lt; std::endl; }\n\nint main() {\n    int temp = 5;\n\n    Experimental::Pool xpool(2);\n    std::cout &lt;&lt; \"Xpool \" &lt;&lt; xpool.size() &lt;&lt; \"\\n\";\n    xpool.add_work(add1, std::ref(temp));\n\n    std::this_thread::sleep_for(std::chrono::seconds(1));\n    std::cout &lt;&lt; \"End\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>Xpool 2\n6\nEnd\ntemp: 6\n</code></pre>\n\n<p>And it is only ~50% of the code.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3854783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 1, "accepted_answer_id": 48432404, "answer_count": 2, "score": 1, "last_activity_date": 1516831835, "creation_date": 1516822358, "last_edit_date": 1516822791, "question_id": 48430287, "link": "https://stackoverflow.com/questions/48430287/boost-threads-and-shared-ptrs", "title": "Boost threads and shared_ptrs", "body": "<p>I am working on a side project with friends and am building a thread pool with Boost threads and asio. I already have a basic pool up and running but wanted to be able to delete threads from the pool. The class below keeps a vector of <code>std::shared_ptr&lt;boost::thread&gt;</code>. </p>\n\n<p>The issue I am having is when I run a simple test, the program never exits. It appears to reach the end (see output) but never terminates. I have a feeling it has to do with the threads still being alive and have tried to kill them but to no avail. I did some searches on clearing a vector of shared pointers and it seems like you really shouldn't have to. As well, the <code>thread_group</code> call to <code>join_all()</code> should join and end all threads, at least i thought so.</p>\n\n<p>I am still fully learning boost threads, asio, and shared_ptr's so any help or advice would be greatly appreciated.</p>\n\n<p><strong>Compile:</strong>`</p>\n\n<pre><code>g++ -std=c++14 main.cpp -lboost_system -lboost_thread -lpthread\n</code></pre>\n\n<p><strong>Class:</strong></p>\n\n<pre><code>  class experimentalPool {\n      private:\n        boost::asio::io_service ioService;\n        boost::asio::io_service::work work;\n        boost::thread_group threads;\n        std::vector&lt;std::shared_ptr&lt;boost::thread&gt;&gt; workers;\n        std::size_t poolsize;\n      public:\n        experimentalPool(): work( ioService ) {\n            poolsize = boost::thread::hardware_concurrency();\n            for (size_t i = 0; i &lt; poolsize; i++) {\n                std::shared_ptr&lt;boost::thread&gt; t1(new boost::thread(\n                    boost::bind(&amp;boost::asio::io_service::run, &amp;ioService)));\n                threads.add_thread(t1.get());\n                workers.push_back(std::move(t1));\n            }\n        }\n\n        experimentalPool( std::size_t psize )\n          : work( ioService ),\n            poolsize( psize )\n        {\n            for (size_t i = 0; i &lt; poolsize; i++) {\n                std::shared_ptr&lt;boost::thread&gt; t1(new boost::thread(\n                    boost::bind(&amp;boost::asio::io_service::run, &amp;ioService)));\n                threads.add_thread(t1.get());\n                workers.push_back(std::move(t1));\n            }\n        }\n\n        template &lt;typename F, typename... Args&gt;\n        void add_work(F f, Args... args){\n            ioService.post(boost::bind(f, args...));\n        };\n\n        ~experimentalPool(){\n          ioService.stop();\n          try {\n            std::cout &lt;&lt; \"here\" &lt;&lt; \"\\n\";\n            threads.join_all();\n            //threads.interrupt_all();\n            std::cout &lt;&lt; \"here\" &lt;&lt; \"\\n\";\n            //for (size_t i = 0; i &lt; workers.size(); i++) {\n              //(*workers[i]).interrupt();\n            //}\n          }\n          catch ( const std::exception&amp; ) {std::cout &lt;&lt; \"Caught Exception\" &lt;&lt; \"\\n\";}\n        }\n\n        std::size_t size() const { return poolsize;}\n    };\n</code></pre>\n\n<p><strong>Main:</strong></p>\n\n<pre><code>void add1(int&amp; num){\n    std::cout &lt;&lt; ++num &lt;&lt; std::endl;\n}\n\nint main(){\n\n    int temp = 5;\n\n    experimentalPool xpool(2);\n    std::cout &lt;&lt; \"Xpool \" &lt;&lt; pool2.size() &lt;&lt; \"\\n\";\n    xpool.add_work(add1, temp);\n\n    std::this_thread::sleep_for (std::chrono::seconds(1));\n    std::cout &lt;&lt; \"End\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Xpool 1\n6\nhere\nxpool here\nxpool here\n^C\nap@ubuntu:~/Desktop$ \n</code></pre>\n"}, {"tags": ["c++", "windows"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1516821522, "post_id": 48429983, "comment_id": 83850720, "body": "In Windows 10 it is always running.  I can&#39;t think of a legit use case for &quot;patching&quot; Windows system files, but if there is one maybe you could get file system updates instead and &quot;patch&quot; files when they change."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1516821899, "post_id": 48429983, "comment_id": 83850949, "body": "Perhaps have a look at this question: <a href=\"https://stackoverflow.com/questions/1591342/c-how-to-determine-if-a-windows-process-is-running/1591370\" title=\"c how to determine if a windows process is running\">stackoverflow.com/questions/1591342/&hellip;</a>."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1516822744, "post_id": 48429983, "comment_id": 83851414, "body": "@DaveS Is not always running. It starts either manually or by trigger and then exits. As for question itself it might be worth to check whether <code>wuauserv</code>  service is running."}, {"owner": {"reputation": 31, "user_id": 8228642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2b57256716d89518e9657bcabdcd66?s=128&d=identicon&r=PG&f=1", "display_name": "Joanna Zhou", "link": "https://stackoverflow.com/users/8228642/joanna-zhou"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516828250, "post_id": 48429983, "comment_id": 83854384, "body": "@VTT, thanks for the suggestion. I tried to manually run windows update on Windows 10 and monitor wuauserv&#39;s status on task manager and the result is not very accurate. Even after I finished checking for updates, the service still showed the status &quot;Running&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 2666354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730f85d7656ffab5e9e597258666c04a?s=128&d=identicon&r=PG", "display_name": "nodchip", "link": "https://stackoverflow.com/users/2666354/nodchip"}, "is_accepted": false, "score": 0, "last_activity_date": 1584429385, "creation_date": 1584429385, "answer_id": 60717792, "question_id": 48429983, "link": "https://stackoverflow.com/questions/48429983/visual-c-how-to-detect-windows-update-is-running/60717792#60717792", "title": "Visual C++ How to detect windows update is running?", "body": "<p>We could use the IUpdateInstaller::get_IsBusy method in the wuapi.h header to detect if Windows update is installing patches.  I used it from C#, and confirmed that the sample code below detects if Windows Update is installing patches.</p>\n\n<pre><code>var session = new UpdateSession();\nvar installer = session.CreateUpdateInstaller();\n\nwhile (true)\n{\n    Console.WriteLine(DateTime.Now.ToString());\n    Console.WriteLine($\"installer.IsBusy={installer.IsBusy}\");\n    Thread.Sleep(TimeSpan.FromSeconds(1));\n}\n</code></pre>\n\n<p>\"WUAPI 2.0 Type Library\" needs to be added as a reference.\nThe code above could be re-written with C++.</p>\n\n<p>I don'know know how to detect if Windows Update is downloading patches, though...</p>\n"}], "owner": {"reputation": 31, "user_id": 8228642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2b57256716d89518e9657bcabdcd66?s=128&d=identicon&r=PG&f=1", "display_name": "Joanna Zhou", "link": "https://stackoverflow.com/users/8228642/joanna-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1584429385, "creation_date": 1516821182, "question_id": 48429983, "link": "https://stackoverflow.com/questions/48429983/visual-c-how-to-detect-windows-update-is-running", "title": "Visual C++ How to detect windows update is running?", "body": "<p>I have an application that periodically checks and patches windows updates. However, it can cause conflicts when windows update is already running (either downloading KBs or installing them). I want to know how do you programmatically check if windows update is already running?</p>\n"}, {"tags": ["c++", "move-semantics", "c++17"], "comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 10, "creation_date": 1516820422, "post_id": 48429756, "comment_id": 83850135, "body": "Remove <code>explicit</code>"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1516820482, "post_id": 48429756, "comment_id": 83850163, "body": "Doesn&#39;t C++17 require RVO in this context?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 1, "creation_date": 1516820613, "post_id": 48429756, "comment_id": 83850226, "body": "@\u6c34\u98f2\u307f\u9ce5 RVO is an optional optimization and still requires move/copy constructor. Copy elision introduced in C++17 is not applied here since <code>Foo</code> has move constructor. It just should be implicit."}, {"owner": {"reputation": 10448, "user_id": 1405560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89713245814986078240c73bca26916b?s=128&d=identicon&r=PG", "display_name": "Maximus", "link": "https://stackoverflow.com/users/1405560/maximus"}, "edited": false, "score": 0, "creation_date": 1516820647, "post_id": 48429756, "comment_id": 83850246, "body": "Also, because you define move constructor, you shall define move operator too."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1516820678, "post_id": 48429756, "comment_id": 83850258, "body": "Possibly related: <a href=\"https://stackoverflow.com/questions/21872972/explicit-move-constructor\" title=\"explicit move constructor\">stackoverflow.com/questions/21872972/explicit-move-construct&zwnj;&#8203;or</a>"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 2, "creation_date": 1516820860, "post_id": 48429756, "comment_id": 83850349, "body": "@Ivan According to <a href=\"http://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/copy_elision</a>, RVO is not optional in C++17. NRVO is optional."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516821109, "post_id": 48429756, "comment_id": 83850473, "body": "which g++ version is this?"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 2, "creation_date": 1516821718, "post_id": 48429756, "comment_id": 83850820, "body": "@Ivan The link also says that the statement &quot;RVO is an optional optimization and still requires move/copy constructor.&quot; is wrong on both accounts. (Edit: In C++17)"}, {"owner": {"reputation": 7937, "user_id": 1413793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8c593877e04020316731318e597c80e4?s=128&d=identicon&r=PG&f=1", "display_name": "user1413793", "link": "https://stackoverflow.com/users/1413793/user1413793"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516821886, "post_id": 48429756, "comment_id": 83850941, "body": "@VTT g++ version:  g++-7 (Homebrew GCC 7.2.0_1) 7.2.0 Copyright (C) 2017 Free Software Foundation, Inc. This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1516880351, "post_id": 48429756, "comment_id": 83875053, "body": "<b>I don&#39;t think this is a duplicate.</b> The referred question is tagged with C++11/14 and in C++17 whole situation is quite different. As for this question, there is also another viable (and maybe for someone better) solution, namely, you can substitute <code>Foo f; return f</code>;` by <code>return Foo{};</code> and then you don&#39;t need to remove the <code>explicit</code> specifier, which may be useful for some other reason."}], "owner": {"reputation": 7937, "user_id": 1413793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8c593877e04020316731318e597c80e4?s=128&d=identicon&r=PG&f=1", "display_name": "user1413793", "link": "https://stackoverflow.com/users/1413793/user1413793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516967633, "creation_date": 1516820274, "last_edit_date": 1516947180, "question_id": 48429756, "link": "https://stackoverflow.com/questions/48429756/c-move-on-function-return", "title": "C++ move on function return?", "body": "<p>I have the following code:</p>\n\n<pre><code>class Foo {\n    public:\n      Foo() {}\n      explicit Foo(Foo &amp;&amp;other) noexcept {}\n\n      static Foo from() {\n        Foo f;\n        return f;\n      }\n};\n</code></pre>\n\n<p>When I compile it with <code>g++ --std=c++17 move.cpp</code>, I get the following error:</p>\n\n<pre><code>move.cpp: In static member function 'static Foo Foo::from()':\nmove.cpp:8:12: error: use of deleted function 'constexpr Foo::Foo(const Foo&amp;)'\n     return f;\n            ^\nmove.cpp:1:7: note: 'constexpr Foo::Foo(const Foo&amp;)' is implicitly declared as deleted because 'Foo' declares a move constructor or move assignment operator\n class Foo {\n       ^~~\n</code></pre>\n\n<p>I thought the function should be moving Foo when the statement <code>return f</code> is compiled (so, it should use the declared move constructor, right?). But, it looks like it is looking for a copy constructor. Can someone please explain what is going on here?</p>\n\n<p>EDIT: This question was marked duplicate for <a href=\"https://stackoverflow.com/questions/21872972/explicit-move-constructor\">this one</a>. However, this question is asking about C++17, while the other one is about C++11/C++14. Therefore, this is NOT a duplicate.</p>\n"}, {"tags": ["c++", "opencv", "rust", "ffi"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516820525, "post_id": 48429742, "comment_id": 83850178, "body": "I would strongly recommend templates instead of macros for <code>Result</code>. A simple templated <code>struct</code>, with a type alias would work just fine. It&#39;s also not necessary to <code>typedef struct</code> in c++. <code>struct</code> are implicitly proper type names."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516820619, "post_id": 48429742, "comment_id": 83850230, "body": "@Fran&#231;oisAndrieux IIRC templates cannot be used in <code>extern C</code> interfaces. See <a href=\"https://stackoverflow.com/questions/4877705/why-cant-templates-be-within-extern-c-blocks\" title=\"why cant templates be within extern c blocks\">stackoverflow.com/questions/4877705/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516820699, "post_id": 48429742, "comment_id": 83850265, "body": "I hadn&#39;t noticed it was <code>extern C</code>."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 2, "creation_date": 1516820859, "post_id": 48429742, "comment_id": 83850346, "body": "The documentation on <a href=\"https://doc.rust-lang.org/stable/std/ffi/struct.CString.html#method.from_raw\" rel=\"nofollow noreferrer\"><code>CString::from_raw</code></a> already answers the first part of the question: <i>&quot;This should only ever be called with a pointer that was earlier obtained by calling into_raw on a <code>CString</code>&quot;</i>. This question is then narrowed down to returning an owning string from C into Rust code."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1516821007, "post_id": 48429742, "comment_id": 83850421, "body": "@E_net4 when I saw OpenCV examples from documentation (<a href=\"https://docs.opencv.org/2.4/modules/core/doc/intro.html#error-handling\" rel=\"nofollow noreferrer\">link</a>) I didn&#39;t see they free <code>e.what()</code> so probably it&#39;s a static string which can be safely converted into <code>CStr</code>. But i&#39;m not sure. However, I see your point, good catch."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 2, "creation_date": 1516821368, "post_id": 48429742, "comment_id": 83850625, "body": "In C++, exceptions and their contents are already freed automatically. The <code>what</code> member function usually either returns a static string or returns a pointer to a string that was previously built and kept as a member of the exception. In OpenCV, it seems to be the latter. I&#39;m afraid that it is not safe to return that pointer in particular."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1516822082, "post_id": 48429742, "comment_id": 83851039, "body": "Are <code>try</code>/<code>catch</code> allowed in <code>extern &quot;C&quot;</code> sections since <code>try</code> and <code>catch</code> are not in the C language?"}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516822160, "post_id": 48429742, "comment_id": 83851080, "body": "@ThomasMatthews I think it&#39;s ok since it isn&#39;t used in public API."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 3, "creation_date": 1516822279, "post_id": 48429742, "comment_id": 83851148, "body": "Can you check whether that <code>return ResultDouble{value: cv::someOpenCvMethod(), message: nullptr};</code> compiles? I don&#39;t think naming the arguments like that is valid C++."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1516822547, "post_id": 48429742, "comment_id": 83851291, "body": "@E_net4 i&#39;m sure it does and I actually get the error message on rust side: <code>running 1 test OpenCV Error: Assertion failed (A.size == arrays[i0]-&gt;size) in init, file C:\\Users\\Alex\\Documents\\foo\\opencv\\modules\\core\\src\\matrix.c&zwnj;&#8203;pp, line 4845 error: test failed, to rerun pass &#39;--test test_imgproc&#39; </code>. I think it&#39;s works because of gcc, see <a href=\"https://stackoverflow.com/a/14101575/2559709\">link</a>"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1516824315, "post_id": 48429742, "comment_id": 83852364, "body": "@AlexZhukovskiy: That&#39;s not C initializer syntax. Designated initializers would look like <code>{.value = ..., .message = ...}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1516824951, "post_id": 48430677, "comment_id": 83852667, "body": "If you want C-strings, I suggest you use C-like code instead. The entire catch clause can be rewritten: <code>return ResultDouble{0, std::strdup(e.what())};</code>, then you have to rewrite the body of <code>free_result</code> to <code>std::free(res-&gt;message);</code>."}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1516825023, "post_id": 48430677, "comment_id": 83852708, "body": "The <code>str_slice</code> you create on the Rust side is never used... I think it&#39;s a left-over. Or that there is a mix-up as <code>s</code> is not a <code>String</code>."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1516825783, "post_id": 48430677, "comment_id": 83853112, "body": "@MatthiewM I deliberately avoided <code>strdup</code> because it is not ISO C (although it should work in practice, all right). As for the <code>str_slice </code>, yep, I meant to return it instead of <code>s</code>. That&#39;s fixed."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "edited": false, "score": 0, "creation_date": 1516829861, "post_id": 48430677, "comment_id": 83855183, "body": "@E_net4 nice one. However, your <code>exercise to the reader</code> has been already solved in the question :)"}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "reply_to_user": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "edited": false, "score": 0, "creation_date": 1516829997, "post_id": 48430677, "comment_id": 83855248, "body": "@AlexZhukovskiy Well, yet another reason to omit the solution here for brevity. :)"}], "tags": [], "owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "is_accepted": true, "score": 7, "last_activity_date": 1520602935, "last_edit_date": 1520602935, "creation_date": 1516823930, "answer_id": 48430677, "question_id": 48429742, "link": "https://stackoverflow.com/questions/48429742/map-c-exceptions-to-result/48430677#48430677", "title": "Map C++ exceptions to Result", "body": "<blockquote>\n  <ol>\n  <li>Is it ok that I use *const char on C++ side but *mut c_char on Rust one? I need it because CString::from_raw requires mutable reference.</li>\n  </ol>\n</blockquote>\n\n<p>The documentation on <a href=\"https://doc.rust-lang.org/stable/std/ffi/struct.CString.html#method.from_raw\" rel=\"nofollow noreferrer\"><code>CString::from_raw</code></a> already answers the first part of the question:</p>\n\n<blockquote>\n  <p>\"This should only ever be called with a pointer that was earlier obtained by calling into_raw on a <code>CString</code>\".</p>\n</blockquote>\n\n<p>Attempting to use a pointer to a string which was not created by <code>CString</code> is inappropriate here, and will eat your laundry.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Should I use CStr instead? If yes, how should I manage its lifetime? Should I free this memory or maybe it has static lifetime?</li>\n  </ol>\n</blockquote>\n\n<p>If the returned C-style string is guaranteed to have a static lifetime (as in, it has <a href=\"http://en.cppreference.com/w/c/language/storage_duration\" rel=\"nofollow noreferrer\">static duration</a>), then you could create a <code>&amp;'static CStr</code> from it and return that. However, this is not the case: <a href=\"https://docs.opencv.org/3.3.1/d1/dee/classcv_1_1Exception.html\" rel=\"nofollow noreferrer\"><code>cv::Exception</code></a> contains multiple members, some of which are owning string objects. Once the program leaves the scope of <code>myFunc</code>, the caught exception object <code>e</code> is destroyed, and so, anything that came from <code>what()</code> is invalidated.</p>\n\n<pre><code>        const char* err_msg = e.what();\n        return ResultDouble{0, err_msg}; // oops! a dangling pointer is returned\n</code></pre>\n\n<p>While it is possible to transfer values across the FFI boundary, the responsibility of ownership should always stay at the source of that value. In other words, if the C++ code is creating exceptions and we want to provide that information to Rust code, then it's the C++ code that must retain that value and free it in the end. I took the liberty of choosing one possible approach below.</p>\n\n<p>By following <a href=\"https://stackoverflow.com/q/9593798/1233251\">this question on duplicating C strings</a>, we can reimplement <code>myFunc</code> to store the string in a dynamically allocated array:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cstring&gt;\n\nResultDouble myFunc() \n{\n    try\n    {\n        return ResultDouble{value: cv::someOpenCvMethod(), message: nullptr};\n    }\n    catch( cv::Exception&amp; e )\n    {\n        const char* err_msg = e.what();\n        auto len = std::strlen(err_msg);\n        auto retained_err = new char[len + 1];\n        std::strcpy(retained_err, err_msg);\n        return ResultDouble{value: 0, message: retained_err};\n    }\n}\n</code></pre>\n\n<p>This makes it so that we are returning a pointer to valid memory. Then, a new public function will have to be exposed to free the result:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// in extern \"C\"\nvoid free_result(ResultDouble* res) {\n    delete[] res-&gt;message;\n}\n</code></pre>\n\n<p>In Rust-land, we'll retain a copy of the same string with the approach described in <a href=\"https://stackoverflow.com/q/24145823/1233251\">this question</a>. Once that is done, we no longer need the contents of <code>result</code>, and so it can be freed with an FFI function call to <code>free_result</code>. Handling the outcome of <code>to_str()</code> without <code>unwrap</code> is left as an exercise to the reader.</p>\n\n<pre><code>extern \"C\" {\n    fn myFunc() -&gt; CResult&lt;c_double&gt;;\n    fn free_result(res: *mut CResult&lt;c_double&gt;);\n}\n\npub fn my_func() -&gt; Result&lt;f64, String&gt; {\n    let result = unsafe {\n        myFunc()\n    };\n    if result.message.is_null() {\n        Ok(result.value)\n    } else {\n        unsafe {\n            let s = std::ffi::CStr::from_ptr(result.message);\n            let str_slice: &amp;str = c_str.to_str().unwrap();\n            free_result(&amp;mut result);\n            Err(str_slice.to_owned())\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 2, "accepted_answer_id": 48430677, "answer_count": 1, "score": 4, "last_activity_date": 1520602935, "creation_date": 1516820230, "last_edit_date": 1517305886, "question_id": 48429742, "link": "https://stackoverflow.com/questions/48429742/map-c-exceptions-to-result", "title": "Map C++ exceptions to Result", "body": "<p>I'm writing a Rust library which is a wrapper over a C++ library.</p>\n\n<p>Here is the C++ side:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define Result(type,name) typedef struct { type value; const char* message; } name\n\nextern \"C\" \n{\n    Result(double, ResultDouble);\n\n    ResultDouble myFunc() \n    {\n        try\n        {\n            return ResultDouble{value: cv::someOpenCvMethod(), message: nullptr};\n        }\n        catch( cv::Exception&amp; e )\n        {\n            const char* err_msg = e.what();\n            return ResultDouble{value: 0, message: err_msg};\n        }\n    }\n}\n</code></pre>\n\n<p>and corresponding Rust side:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>#[repr(C)]\nstruct CResult&lt;T&gt; {\n    value: T,\n    message: *mut c_char,\n}\n\nextern \"C\" {\n    fn myFunc() -&gt; CResult&lt;c_double&gt;;\n}\n\npub fn my_func() -&gt; Result&lt;f64, Cow&lt;'static, str&gt;&gt; {\n    let result = unsafe { myFunc() };\n    if result.message.is_null() {\n        Ok(result.value)\n    } else {\n        unsafe {\n            let str = std::ffi::CString::from_raw(result.message);\n            let err = match str.into_string() {\n                Ok(message) =&gt; message.into(),\n                _ =&gt; \"Unknown error\".into(),\n            };\n            Err(err)\n        }\n    }\n}\n</code></pre>\n\n<p>I have two questions here:</p>\n\n<ol>\n<li>Is it ok that I use <code>*const char</code> on C++ side but <code>*mut c_char</code> on Rust one? I need it because <code>CString::from_raw</code> requires mutable reference.</li>\n<li>Should I use <code>CStr</code> instead? If yes, how should I manage its lifetime? Should I free this memory or maybe it has static lifetime?</li>\n</ol>\n\n<p>Generally I just want to map a C++ exception which occurs in FFI call to Rust <code>Result&lt;T,E&gt;</code></p>\n\n<p>What is the idiomatic way to do it?</p>\n"}, {"tags": ["c++", "templates", "language-lawyer", "partial-ordering"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1516821157, "post_id": 48429659, "comment_id": 83850499, "body": "Informal C++ documentation sources (cppreference, msvc documentation etc) say that implicit conversions are not considered when performing deductions for partial ordering. I cannot find any relevant standardese myself. (I have initially posted a comment to this effect under the linked question, then deleted it because it doesn&#39;t seem relevant there; but it could be relevant here)."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516821749, "post_id": 48429659, "comment_id": 83850843, "body": "@n.m. So the call <code>func1(buf)</code> would not compile too, so neither of the 2 templates would be more specialized. Is that your idea? That would be an answer I would accept if you posted it."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516822817, "post_id": 48429659, "comment_id": 83851453, "body": "These are function templates, and AFAIK there is no such thing as partial specialization of a function template; rather, at the point of the function call, each of the two candidate templates is fully specialized (if possible) on its own terms, producing candidate <i>overloads</i> of the function name, and then the overload resolution rules are applied, as-if there had never been any templates involved at all.  That would reduce the question to &quot;why are <code>void func(char (&amp;buf)[42])</code> and <code>void func(char *buf)</code> an ambiguous overload pair?&quot; and I don&#39;t know the answer to that."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516824489, "post_id": 48429659, "comment_id": 83852441, "body": "@zwol Your right and then the process of selection the best viable function continues:  the conversion sequence of these two functions calls are equaly ranked, then this following rule is applied <a href=\"https://timsong-cpp.github.io/cppwp/n4659/over.match.best#1.7\" rel=\"nofollow noreferrer\">&#91;over.match.best&#93;</a>: <i>F1 and F2 are function template specializations, and the function template for F1 is more specialized than the template for F2 according to the partial ordering rules described in [temp.func.order],</i>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516825166, "post_id": 48429659, "comment_id": 83852778, "body": "@Oliv yes exactly this is the idea, but I need to find this in the actual standard text to be absolutely sure,"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516825395, "post_id": 48429659, "comment_id": 83852888, "body": "@zwol <i>partial specialization</i> No one is talking about it. <i>as-if there had never been any templates involved at all</i> No, this is most definitely not the case. There is such thing as <i>function template partial ordering</i> which is different from overload resolution,"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516825660, "post_id": 48429659, "comment_id": 83853030, "body": "@zwol with your interpretation it is not possible to choose between <code>template&lt;class T&gt; void f(T t)</code> and <code>template&lt;class T&gt; void f(T* t)</code> when calling with a pointer argument. The standard prescribes that the second template is used as strictly more specialised."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516825875, "post_id": 48429659, "comment_id": 83853150, "body": "@n.m. Ugh, more special rules to memorize."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516826606, "post_id": 48429659, "comment_id": 83853547, "body": "@zwol the rule is conceptually very simple. The template that accepts the smallest set of argument types wins. In my example the first template accepts everything and the second one just pointers, so the second one wins. But of course there are exceptions and corner cases."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516828893, "post_id": 48429659, "comment_id": 83854661, "body": "@n.m. For function call there is this paragraph <a href=\"https://timsong-cpp.github.io/cppwp/n4659/temp.deduct.call#2\" rel=\"nofollow noreferrer\">&#91;temp.deduc.call&#93;/2</a> then furthur transformation of reference types are describles in the next paragraph. For partial ordering type deduction, there is only this paragraph <a href=\"https://timsong-cpp.github.io/cppwp/n4659/temp.deduct.partial#5\" rel=\"nofollow noreferrer\">&#91;temp.deduct.partial&#93;</a> which is about argument and parameter type transformation, and it only talk about removing the reference. Nothing about array to pointer conversion of the argument as is the case in [temp.deduc.call]. I believe you are right"}], "answers": [{"comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1516868175, "post_id": 48436333, "comment_id": 83867666, "body": "This is indeed the n.m. conclusion in its comment. Thank you for having written it."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1516869975, "post_id": 48436333, "comment_id": 83868595, "body": "@Oliv Sorry that I didn&#39;t notice the comment... Now I add &quot;as n.m. pointed out&quot; since the comment is earlier than my answer."}], "tags": [], "owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "is_accepted": true, "score": 3, "last_activity_date": 1516869907, "last_edit_date": 1592644375, "creation_date": 1516858927, "answer_id": 48436333, "question_id": 48429659, "link": "https://stackoverflow.com/questions/48429659/why-c-template-accepting-array-is-not-more-specialized-than-one-accepting-poin/48436333#48436333", "title": "Why C++ template accepting array is not more specialized than one accepting pointer (bis)?", "body": "<p>As n.m. pointed out in the comment, the reason is that type <code>T*</code> cannot be deduced from type <code>char (&amp;buf)[invented_N]</code>.</p>\n<p>In <code>is_template_II_more_specialized</code>, an extra array-to-pointer conversion is applied according to <a href=\"http://eel.is/c++draft/temp.fct.spec#temp.deduct.call-2.1\" rel=\"nofollow noreferrer\">[temp.deduct.call]/2.1</a>:</p>\n<blockquote>\n<p>If P is not a reference type:</p>\n<ul>\n<li><p>If A is an array type, the pointer type produced by the array-to-pointer standard conversion is used in place of A for type deduction; otherwise,</p>\n</li>\n<li><p>...</p>\n</li>\n</ul>\n</blockquote>\n<p>This rule only applies for deducing template arguments <strong>from a function call</strong>. For deducing template arguments <strong>during partial ordering</strong>, there is no such conversion applying.</p>\n<p><sub> Conversions that can be applied during partial ordering are described in [temp.deduct.partial]/<a href=\"http://eel.is/c++draft/temp.deduct.partial#5\" rel=\"nofollow noreferrer\">5</a>,<a href=\"http://eel.is/c++draft/temp.deduct.partial#6\" rel=\"nofollow noreferrer\">6</a>,<a href=\"http://eel.is/c++draft/temp.deduct.partial#7\" rel=\"nofollow noreferrer\">7</a>. </sub></p>\n"}], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 48436333, "answer_count": 1, "score": 7, "last_activity_date": 1516869907, "creation_date": 1516819842, "last_edit_date": 1516820151, "question_id": 48429659, "link": "https://stackoverflow.com/questions/48429659/why-c-template-accepting-array-is-not-more-specialized-than-one-accepting-poin", "title": "Why C++ template accepting array is not more specialized than one accepting pointer (bis)?", "body": "<p><sub> In reference to <a href=\"https://stackoverflow.com/questions/48405963/why-c-template-accepting-array-is-not-more-specialized-than-one-accepting-poin\">this question</a>, which has indeed the same title but for which I found an answer in the standard. I have continued to dig the subject and finaly find out an example code for which this answer does not apply.</sub></p>\n\n<p>Let's consider this piece of code:</p>\n\n<pre><code>template&lt;class T&gt; void func(T* buf);           //template I\ntemplate&lt;size_t N&gt; void func(char (&amp;buf) [N]); //template II\n\nvoid g(char (&amp;buf)[3])\n   {\n   func(buf) //Error: ambiguous function call (Clang, GCC, ICC, MSVC)\n   }\n</code></pre>\n\n<p>According to the partial ordering rules in <a href=\"https://timsong-cpp.github.io/cppwp/n4659/temp.func.order\" rel=\"noreferrer\">[temp.func.order]</a> and <a href=\"https://timsong-cpp.github.io/cppwp/n4659/temp.deduct.partial\" rel=\"noreferrer\">[temp.deduct.partial]</a>, <em>template II</em> shall be more specialized than <em>template I</em> if one interpreted this rules through the execution of this piece of code:</p>\n\n<pre><code>template &lt;class T&gt; void func1(T* buf) {}\ntemplate &lt;std::size_t N&gt; void func2(char (&amp;buf)[N]) {}\n\nstruct invented_T{};\nconstexpr std::size_t invented_N=42;\n\nvoid is_template_I_more_specialized(invented_T* buf)\n  {\n  func2(buf);\n  //DO NOT COMPILE\n  // =&gt; template I is not more specialized than func2\n  }\n\nvoid is_template_II_more_specialized(char (&amp;buf)[invented_N])\n  {\n  func1(buf);\n  //DO COMPILE\n  // =&gt; template II is more specialized than func1\n  }\n</code></pre>\n\n<p>So according to this interpretation, <em>template II</em> should be <em>more specialized</em>. Why would it not be the case?</p>\n"}, {"tags": ["c++", "math", "calculation"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 2, "creation_date": 1516819215, "post_id": 48429480, "comment_id": 83849563, "body": "The local variable you create in each of the scopes shadows the one declared at function scope. You&#39;re effectively assinging to a variable that&#39;s destroyed right away. Your compiler should&#39;ve warned you about this."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 8, "creation_date": 1516819423, "post_id": 48429480, "comment_id": 83849661, "body": "Dear teachers of new C/C++ students:  Please teach them to enable warnings and teach them what those warnings mean.  It saves so much hassle.  Thank you."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516819638, "post_id": 48429480, "comment_id": 83849761, "body": "i always think that the default compiler options should be -wall -werror (or whatever equivalent). This will help new coders enormously. Experienced ones will know how to turn these options off"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1516819687, "post_id": 48429480, "comment_id": 83849786, "body": "except, of course , really experienced ones know to have these options on always :-)"}, {"owner": {"reputation": 43, "user_id": 7641587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3c4d183f36995865ff9b2c8528f7fe?s=128&d=identicon&r=PG&f=1", "display_name": "mastercooker", "link": "https://stackoverflow.com/users/7641587/mastercooker"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516822325, "post_id": 48429480, "comment_id": 83851171, "body": "@pm100 what do those options do? Also, how can I enable these in codeblocks?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516822519, "post_id": 48429480, "comment_id": 83851277, "body": "thes are gcc options. -wall means issue all warnings. Some warnings are off by default in many compilers. -werror means treat warnings as errors. Read the docs - i have never used codeblocks"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7641587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3c4d183f36995865ff9b2c8528f7fe?s=128&d=identicon&r=PG&f=1", "display_name": "mastercooker", "link": "https://stackoverflow.com/users/7641587/mastercooker"}, "edited": false, "score": 0, "creation_date": 1516822168, "post_id": 48429516, "comment_id": 83851082, "body": "Thank you! Sorry for the stupid mistake, I only started learning C++ today"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 9, "last_activity_date": 1516819266, "creation_date": 1516819266, "answer_id": 48429516, "question_id": 48429480, "link": "https://stackoverflow.com/questions/48429480/c-calculator-always-returns-7208640/48429516#48429516", "title": "C++ Calculator always returns 7208640", "body": "<pre><code>if(op == \"+\"){\n    int sum = fNumber + sNumber;\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>if(op == \"+\"){\n    sum = fNumber + sNumber;\n</code></pre>\n\n<p>and the same for all the other <code>int sum</code> except the first. You declare a variable once, not every time you use it.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7641587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3c4d183f36995865ff9b2c8528f7fe?s=128&d=identicon&r=PG&f=1", "display_name": "mastercooker", "link": "https://stackoverflow.com/users/7641587/mastercooker"}, "edited": false, "score": 0, "creation_date": 1516822375, "post_id": 48430144, "comment_id": 83851209, "body": "Thank you, hadn&#39;t thought that one through!"}], "tags": [], "owner": {"reputation": 704, "user_id": 7595618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51cf59e6785bbd9f82f28e8cfc0f2935?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Borkland", "link": "https://stackoverflow.com/users/7595618/mike-borkland"}, "is_accepted": false, "score": 2, "last_activity_date": 1516821832, "creation_date": 1516821832, "answer_id": 48430144, "question_id": 48429480, "link": "https://stackoverflow.com/questions/48429480/c-calculator-always-returns-7208640/48430144#48430144", "title": "C++ Calculator always returns 7208640", "body": "<p>As above, remove the int declarations from inside the if statements.</p>\n\n<p>Also, please change the name of the sum variable to something like \"answer.\" A result from subtraction, multiplication, division and modulo is referred to as difference, product, quotient, and remainder, respectively.</p>\n"}], "owner": {"reputation": 43, "user_id": 7641587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3c4d183f36995865ff9b2c8528f7fe?s=128&d=identicon&r=PG&f=1", "display_name": "mastercooker", "link": "https://stackoverflow.com/users/7641587/mastercooker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 48429516, "answer_count": 2, "score": -1, "last_activity_date": 1516821832, "creation_date": 1516819148, "question_id": 48429480, "link": "https://stackoverflow.com/questions/48429480/c-calculator-always-returns-7208640", "title": "C++ Calculator always returns 7208640", "body": "<p>This is the code for my calculator:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    int fNumber, sNumber, sum;\n    string op;\n    cout &lt;&lt; \"You will be asked for two numbers and the operator to use on them.\\nCurrently supported operators are:\\n\";\n    cout &lt;&lt; \"    Addition: +\\n    Subtraction: -\\n    Multiplication: *\\n    Division: \\\\\\n    Modulo: %\\n\\n\";\n\n    cout &lt;&lt; \"First Number: \";\n    cin &gt;&gt; fNumber;\n    cout &lt;&lt; \"\\nSecond Number: \";\n    cin &gt;&gt; sNumber;\n    cout &lt;&lt; \"\\nOperator: \";\n    cin &gt;&gt; op;\n\n    if(op == \"+\"){\n        int sum = fNumber + sNumber;\n    } else if(op == \"x\" || op == \"*\"){\n        int sum = fNumber * sNumber;\n    } else if(op == \"/\"){\n        int sum = fNumber / sNumber;\n    } else if(op == \"-\"){\n        int sum = fNumber - sNumber;\n    } else if(op == \"%\"){\n        int sum = fNumber % sNumber;\n    } else{\n        cout &lt;&lt; \"\\nPlease use a correct Operator\\n\";\n        return 1;\n    }\n\n    cout &lt;&lt; \"\\n\" &lt;&lt; fNumber &lt;&lt; \" \" &lt;&lt; op &lt;&lt; \" \" &lt;&lt; sNumber &lt;&lt; \" = \" &lt;&lt; sum &lt;&lt; \"\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>I have absolutely no idea why, but for some reason, whatever numbers or operators I give it it returns \"7208640\" as the answer:</p>\n\n<blockquote>\n  <p>You will be asked for two numbers and the operator to use on them.</p>\n  \n  <p>Currently supported operators are:</p>\n  \n  <p>Addition: +</p>\n  \n  <p>Subtraction: -</p>\n  \n  <p>Multiplication: *</p>\n  \n  <p>Division: \\</p>\n  \n  <p>Modulo: %</p>\n  \n  <p>First Number: 6</p>\n  \n  <p>Second Number: 2</p>\n  \n  <p>Operator: /</p>\n  \n  <p>6 / 2 = 7208640</p>\n  \n  <p>Process returned 0 (0x0)   execution time : 4.612 s Press any key to\n  continue.</p>\n</blockquote>\n"}, {"tags": ["c++", "list"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1516818509, "post_id": 48429240, "comment_id": 83849167, "body": "Do you know that <code>#define {in|out} blah</code> don&#39;t do anything unless you use <code>in</code> or <code>out</code>?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1516818554, "post_id": 48429240, "comment_id": 83849195, "body": "All of those <code>#define</code> look suspicious to me."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516818557, "post_id": 48429240, "comment_id": 83849199, "body": "I highly recommend not using <code>#define</code> to abbreviate function calls.  If you want to develop faster, take a keyboarding class.  When people read your code and encounter <code>revs()</code>, they will have to hunt for the macro, then insert the macro at the invocation.  Bad form."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516818628, "post_id": 48429240, "comment_id": 83849231, "body": "If you want to speed up I/O, block read the data into a buffer, then parse the buffer.  Input is faster when it is continuous."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516819078, "post_id": 48429240, "comment_id": 83849469, "body": "you are modifying your list while iterating over it - this is not allowed. Similar issue with sets <a href=\"https://stackoverflow.com/questions/2088495/how-to-remove-all-even-integers-from-setint-in-c/2088542#2088542\" title=\"how to remove all even integers from setint in c\">stackoverflow.com/questions/2088495/&hellip;</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516819195, "post_id": 48429240, "comment_id": 83849546, "body": "your problem is Undefined Behaviour. Dont try to reason about UB. What you see is that UB code does different things in different places. In one case it even seems to work - the worst kind of UB"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516819246, "post_id": 48429240, "comment_id": 83849577, "body": "@Fran&#231;oisAndrieux - on the bright side he doesnt use them so its all good :-)"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516819354, "post_id": 48429240, "comment_id": 83849631, "body": "use std::vector instead of List. You can use direct indexing rather than all that iterator messing."}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 9139161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fbf6ef3e46c0589e5f356f351aaddc?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammadali Nazarov", "link": "https://stackoverflow.com/users/9139161/muhammadali-nazarov"}, "edited": false, "score": 0, "creation_date": 1516818914, "post_id": 48429328, "comment_id": 83849377, "body": "The problem is in while loop. But I don&#39;t know what is exactly the problem. Code works in main function but in other function not."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 36, "user_id": 9139161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fbf6ef3e46c0589e5f356f351aaddc?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammadali Nazarov", "link": "https://stackoverflow.com/users/9139161/muhammadali-nazarov"}, "edited": false, "score": 0, "creation_date": 1516819357, "post_id": 48429328, "comment_id": 83849635, "body": "@MuhammadaliNazarov If you have undefined behavior, it doesn&#39;t matter <i>where</i> you see the problem. It&#39;s just a symptom. The real problem is whatever caused the undefined behavior. In cases of undefined behavior, the error and the consequences of that error can be very distant from one another. It&#39;s been demonstrated that, in some situations, the behavior can be affected before the line containing the undefined behavior is executed due to how the compiler manipulates your code."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1516821029, "last_edit_date": 1516821029, "creation_date": 1516818603, "answer_id": 48429328, "question_id": 48429240, "link": "https://stackoverflow.com/questions/48429240/different-behavior-of-list-c/48429328#48429328", "title": "Different behavior of list C++", "body": "<p>Your program had undefined behavior.</p>\n\n<p>You have:</p>\n\n<pre><code>list &lt; int &gt;::iterator end = li.begin();\n</code></pre>\n\n<p>before anything is added to the list, which is the same as</p>\n\n<pre><code>list &lt; int &gt;::iterator end = li.end();\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>advance(end, r+1);\n</code></pre>\n\n<p>that is a problem since you can not advance <code>end</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9139161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fbf6ef3e46c0589e5f356f351aaddc?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammadali Nazarov", "link": "https://stackoverflow.com/users/9139161/muhammadali-nazarov"}, "is_accepted": true, "score": 0, "last_activity_date": 1516820293, "creation_date": 1516820293, "answer_id": 48429762, "question_id": 48429240, "link": "https://stackoverflow.com/questions/48429240/different-behavior-of-list-c/48429762#48429762", "title": "Different behavior of list C++", "body": "<p>I have found the answer. </p>\n\n<pre><code>    while(*i&gt;1)\n    {\n        buffer = *i;\n        i = li.erase(i);\n        li.insert(i, buffer/2);\n        li.insert(i, buffer%2);\n        li.insert(i, buffer/2);\n    }\n</code></pre>\n\n<p>In this part of code. When iterator 'i' reaches the end and erases the value, it points to (right) unexisted part of list, so program behaves unexpectedly.</p>\n"}], "owner": {"reputation": 36, "user_id": 9139161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fbf6ef3e46c0589e5f356f351aaddc?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammadali Nazarov", "link": "https://stackoverflow.com/users/9139161/muhammadali-nazarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 48429762, "answer_count": 2, "score": -2, "last_activity_date": 1516821029, "creation_date": 1516818315, "last_edit_date": 1516818614, "question_id": 48429240, "link": "https://stackoverflow.com/questions/48429240/different-behavior-of-list-c", "title": "Different behavior of list C++", "body": "<p>I need help. I can't figure out why my program works differently in main function and in any other function, lets say solve() function. I want to solve this problem <a href=\"http://codeforces.com/contest/768/problem/B?locale=en\" rel=\"nofollow noreferrer\">http://codeforces.com/contest/768/problem/B?locale=en</a>. \nI have written the code and it works fine, but gets time limit in the server.\nMy code is like this and it works fine when I compile it: </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;windows.h&gt;\n#include&lt;math.h&gt;\n#include&lt;algorithm&gt;\n#include&lt;map&gt;\n#include&lt;list&gt;\n#include&lt;iterator&gt;\n\nusing namespace std;\n\nmain()\n{\n    list &lt; int &gt; li;\n    list &lt; int &gt;::iterator i;\n    list &lt; int &gt;::iterator end = li.begin();\n    int n, l, r, buffer, ans = 0;\n    cin &gt;&gt; n &gt;&gt; l &gt;&gt; r;\n    li.push_back(n);\n    for(i=li.begin(); i!=li.end(); i++)\n    {\n        while(*i&gt;1)\n        {\n            buffer = *i;\n            i = li.erase(i);\n            li.insert(i, buffer/2);\n            li.insert(i, buffer%2);\n            li.insert(i, buffer/2);\n        }\n    }\n    advance(end, r+1);\n    i = li.begin();\n    for(advance(i, l-1); i!=end; i++)\n        ans += *i; \n    cout &lt;&lt; ans &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>When I rewrited the code like this, it stopps working properly, so I think the time limit is because of this:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;windows.h&gt;\n#include&lt;math.h&gt;\n#include&lt;algorithm&gt;\n#include&lt;map&gt;\n#include&lt;list&gt;\n#include&lt;iterator&gt;\n\nusing namespace std;\n\nint solve()\n{\n    list &lt; int &gt; li;\n    list &lt; int &gt;::iterator i;\n    list &lt; int &gt;::iterator end = li.begin();\n    int n, l, r, buffer, ans = 0;\n    cin &gt;&gt; n &gt;&gt; l &gt;&gt; r;\n    li.push_back(n);\n    for(i=li.begin(); i!=li.end(); i++)\n    {\n        while(*i&gt;1)\n        {\n            buffer = *i;\n            i = li.erase(i);\n            li.insert(i, buffer/2);\n            li.insert(i, buffer%2);\n            li.insert(i, buffer/2);\n        }\n    }\n    advance(end, r+1);\n    i = li.begin();\n    for(advance(i, l-1); i!=end; i++)\n        ans += *i; \n    cout &lt;&lt; ans &lt;&lt; endl;\n}\n\nmain()\n{\n    ios_base::sync_with_stdio(false);\n    solve();\n    return 0;\n}\n</code></pre>\n\n<p>Anybody knows why?</p>\n"}, {"tags": ["c++", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1516817689, "post_id": 48429021, "comment_id": 83848723, "body": "I find your question a bit weird because you are using <code>std::uintptr_t</code> to store the pointer. You could have also used <code>std::intptr_t</code>, which is signed. Did you mean to use <code>X*</code> instead?"}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1516817852, "post_id": 48429021, "comment_id": 83848811, "body": "Overflow for <code>uintptr_t</code> is defined. For <code>intptr_t</code> is not. For <code>*</code> is not."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1516818312, "post_id": 48429021, "comment_id": 83849065, "body": "A pointer is neither signed nor unsigned. Pointer arithmetic has its own rules. <code>element[minus1]</code> attempts to access an element that&#39;s waaaay off the upper end of the array, so the program has undefined behavior."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1516819141, "post_id": 48429021, "comment_id": 83849510, "body": "Are ppl downvoting because the question is poorly started, or because they don&#39;t like the question?"}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1516819619, "post_id": 48429021, "comment_id": 83849752, "body": "@Rakete1111, no, I&#39;m using <code>std::uintptr_t</code> to store an offset using modulo arithmetic. Yes, I could have used <code>std::intptr_t</code>, but that isn&#39;t the question. I&#39;m curious if this is defined."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1516822451, "post_id": 48429021, "comment_id": 83851240, "body": "The calculation of <code>element + minus1</code> gives undefined behaviour, both in the <code>printf()</code> and the <code>assert()</code>, since the result is outside the range of <code>array</code> (not between the first element and one past the end, inclusive)."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1516817867, "post_id": 48429093, "comment_id": 83848816, "body": "I think the question is asking if asking if <code>ptr + static_cast&lt;std::uintptr_t&gt;(-1)</code> will properly provide the element before <code>ptr</code>, assuming <code>ptr</code> is a pointer to an element in an array."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1516818161, "post_id": 48429093, "comment_id": 83848979, "body": "Yes. That is what I am asking."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1516818598, "post_id": 48429093, "comment_id": 83849217, "body": "@Fran&#231;oisAndrieux: Added that part."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1516818520, "last_edit_date": 1516818520, "creation_date": 1516817775, "answer_id": 48429093, "question_id": 48429021, "link": "https://stackoverflow.com/questions/48429021/is-a-pointer-considered-an-unsigned-value-in-c/48429093#48429093", "title": "Is a pointer considered an unsigned value in C++?", "body": "<ul>\n<li><code>std::uintptr_t</code> is an unsigned integral.</li>\n<li><code>std::intptr_t</code> is an signed integral.</li>\n</ul>\n\n<p>And so overflow of <code>std::uintptr_t</code> is defined, whereas the one of <code>std::intptr_t</code> lead to UB.</p>\n\n<p>In addition, pointer arithmetic is only valid within array (to one past the end of an array).</p>\n\n<p><code>minus1</code> is the greatest number that <code>std::uintptr_t</code> can hold.</p>\n\n<p>From <a href=\"http://en.cppreference.com/w/cpp/language/operator_arithmetic\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/operator_arithmetic</a></p>\n\n<blockquote>\n  <ul>\n  <li>If the pointer P points to the ith element of an array, then the expressions P+n, n+P, and P-n are pointers of the same type that point to the i+nth, i+nth, and i-nth element of the same array, respectively. The result of pointer addition may also be a one-past-the-end pointer (that is, pointer P such that the expression P-1 points to the last element of the array). Any other situations (that is, attempts to generate a pointer that isn't pointing at an element of the same array or one past the end) invoke undefined behavior.</li>\n  </ul>\n</blockquote>\n\n<p><code>element + minus1</code> is not the same as <code>element - 1</code>.<br>\n<code>element + minus1</code> is outside valid range of array, and so lead to UB.</p>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1516818055, "post_id": 48429154, "comment_id": 83848924, "body": "Note that compilers would be perfectly justified in optimizing <code>element + minus1 == array</code> to be <code>false</code>.  There is no unsigned integer addition (under the standard) that can make <code>element</code> equal to <code>array</code>, and that is easy to prove.  So relying on it &quot;work&quot;ing may result in surprises the next time you change optimziation settings, update your compiler, or the moon&#39;s phase changes."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 3, "last_activity_date": 1516817981, "creation_date": 1516817981, "answer_id": 48429154, "question_id": 48429021, "link": "https://stackoverflow.com/questions/48429021/is-a-pointer-considered-an-unsigned-value-in-c/48429154#48429154", "title": "Is a pointer considered an unsigned value in C++?", "body": "<p>Pointer arithmetic is only well defined as long as the pointers involved remain within a single array object or just past the end of the array. So technically, the expression <code>element + minus1</code> is undefined behavior -- because <code>minus1</code> is a very large value, it runs past the end of the array.</p>\n\n<p>Now in practice, this is likely to work, but it is still technically undefined.</p>\n"}, {"comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1516819908, "post_id": 48429312, "comment_id": 83849885, "body": "So your saying that a pointer is treated as an unsigned value in this case? Is this statement listed in the standard somewhere?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1516820364, "post_id": 48429312, "comment_id": 83850106, "body": "@Adrian No I am not.  I am stating that pointer arithmetic is defined in terms of integers, as in mathematics, not in terms of <code>int</code>s.  And pointers are not integers in C++.  But you can add integers to them, and if the integers you add are within a certain range, you get a pointer back.  If not, the result is undefined.  Math on signed integral types has different cases where the result is undefined.  Math on unsigned integral types is mathematics mod 2^n for some n."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1516822183, "post_id": 48429312, "comment_id": 83851091, "body": "So what you are saying is that pointer arithmetic is not defined in terms of modulo operations.  That&#39;s fair.  And it defined in the standard that way?  Or is it omitted and is assumed that way?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 1, "creation_date": 1516823889, "post_id": 48429312, "comment_id": 83852124, "body": "@Adrian What is there to modulo against?  Again, pointers are not integers.  The modulo of (ptr+integer) is meaningless.  So yes, no mention of a meaningless modulo operation on a kind of thing that doesn&#39;t support modulo is made.  Pointers are thing to which integers can be added to, but the result is not an integer, it is a pointer (presuming the integer is within a certain bound)."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 3, "last_activity_date": 1516818567, "creation_date": 1516818567, "answer_id": 48429312, "question_id": 48429021, "link": "https://stackoverflow.com/questions/48429021/is-a-pointer-considered-an-unsigned-value-in-c/48429312#48429312", "title": "Is a pointer considered an unsigned value in C++?", "body": "<p>Pointer arithmetic is defined in the abstract machine.</p>\n\n<p>In the abstract machine, <code>ptr+x</code> is only valid if <code>ptr</code> exists within an object such that its address is within <code>-x</code> of the edge.</p>\n\n<p>This abstract machine does not care about the specific size of pointers or signed or unsigned integers.  In this abstract machine, signed and unsigned integers have values that are <em>real integers</em>, or unspecified values.</p>\n\n<p><code>minus1</code> with a 32 bit <code>uintptr_t</code> is equal to 0xffffffff, a large positive integer.</p>\n\n<p>Does <code>element</code> point within an object that is large enough that 0xffffffff*sizeof(X) later it is still within the object?  No it does not.</p>\n\n<p>So <code>element+minus1</code> is an undefined operation.  Anything can happen.</p>\n\n<p>On your hardware, a naive interpritation of pointer arithmetic into machine code <em>may</em> result in it wrapping around.  But relying on this isn't safe.</p>\n\n<p>For one thing, optimizers sometimes like proving things.  If they prove <code>element</code> is greater than <code>array</code>'s address, then <em>no unsigned addition to <code>element</code> can possibly make it equal to <code>array</code></em>.  So the compiler could optimize <code>element+unsigned value == array</code> to <code>false</code>.</p>\n\n<p>Such optimizations can occur if you change optimization settings, upgrade your compiler, or completely innocuous things like change where it is inlined, or other code that is inlined, or heuristics at link time optimization, or the phase of the moon changing.</p>\n\n<p>Relying on it working is dangerous, even when it does, as you now become responsible for auditing not the source code, but the machine code it generates.</p>\n"}], "owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 48429312, "answer_count": 3, "score": 1, "last_activity_date": 1516818567, "creation_date": 1516817467, "question_id": 48429021, "link": "https://stackoverflow.com/questions/48429021/is-a-pointer-considered-an-unsigned-value-in-c", "title": "Is a pointer considered an unsigned value in C++?", "body": "<p>Signed overflow is undefined.  Unsigned overflow is defined as modulo arithmetic.</p>\n\n<p>So my question is, is the following defined or undefined:</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;cstdint&gt;\n\nstruct X { int x;/* ... anything ... */ };\n\nX array[3] = { 2, 3, 4 /* or other init values that is compatible with X */};\nX* element = array + 1;\n\nstd::uintptr_t plus1 = 1;\nstd::uintptr_t minus1 = 0-plus1;\n\n\nint main()\n{\n    printf(\"%p\\n%p\\n\", element + plus1, array + 2);\n    printf(\"\\n\");\n    printf(\"%p\\n%p\\n\", element + minus1, array);\n    assert(element + plus1 == array + 2);\n    assert(element + minus1 == array);\n}\n</code></pre>\n\n<p>Though I state <code>plus1</code>/<code>minus1</code>, I really mean any +/- value.  If I understand it correctly, this should work.  Am I correct?</p>\n"}, {"tags": ["c++", "templates", "instantiation"], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1516817312, "creation_date": 1516817312, "answer_id": 48428997, "question_id": 48428905, "link": "https://stackoverflow.com/questions/48428905/how-to-pass-certain-typedef-of-a-class-to-template/48428997#48428997", "title": "How to pass certain typedef of a class to template", "body": "<p>You might use <code>static_assert</code> to report misusage:</p>\n\n<pre><code>template &lt;typename DF, int SIZE&gt;\nclass CFilter{\nstatic_assert(std::is_same&lt;CDataFormat::element_t, DF&gt;::value\n           || std::is_same&lt;CDataFormat::accumulation_t, DF&gt;::value\n           || std::is_same&lt;CDataFormat::division_t, DF&gt;::value, \"Unexpected type\");\n\nprivate:\n    DF m_memberName[SIZE];\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1516821097, "last_edit_date": 1516821097, "creation_date": 1516817907, "answer_id": 48429127, "question_id": 48428905, "link": "https://stackoverflow.com/questions/48428905/how-to-pass-certain-typedef-of-a-class-to-template/48429127#48429127", "title": "How to pass certain typedef of a class to template", "body": "<p>You can use a helper class and <code>static_assert</code> to meet your needs.</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\nclass CDataFormat{\npublic:\n    typedef unsigned short  element_t;\n    typedef unsigned int accumulation_t;\n    typedef double division_t;\n\n}; \n\ntemplate &lt;typename T&gt; struct is_valid_type\n{\n   static const bool value = std::is_same&lt;T, CDataFormat::element_t&gt;::value ||\n                             std::is_same&lt;T, CDataFormat::accumulation_t&gt;::value ||\n                             std::is_same&lt;T, CDataFormat::division_t&gt;::value ;\n};\n\ntemplate&lt;typename DF, int SIZE&gt;\nclass CFilter{\n  static_assert(is_valid_type&lt;DF&gt;::value, \"Unsupported type\");\n  private:\n    DF m_memberName[SIZE];\n  public: \n    void whatever(){\n    }\n};\n</code></pre>\n\n<p>With that, </p>\n\n<pre><code>CFilter&lt;CDataFormat::element_t, 10&gt; f1;\n</code></pre>\n\n<p>will work without any problem but use of</p>\n\n<pre><code>CFilter&lt;int, 20&gt; f2;\n</code></pre>\n\n<p>will result in a compile time error.</p>\n"}], "owner": {"reputation": 49, "user_id": 5514803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/516db1f473097cb7cae247b9e5b339b3?s=128&d=identicon&r=PG&f=1", "display_name": "Deweird", "link": "https://stackoverflow.com/users/5514803/deweird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 48429127, "answer_count": 2, "score": 0, "last_activity_date": 1516821097, "creation_date": 1516816949, "last_edit_date": 1516817118, "question_id": 48428905, "link": "https://stackoverflow.com/questions/48428905/how-to-pass-certain-typedef-of-a-class-to-template", "title": "How to pass certain typedef of a class to template", "body": "<p>In the following task I want to create a template which only accepts typedefs defined in the following class CDataFormat:</p>\n\n<pre><code>class CDataFormat{\npublic:\n    typedef unsigned short  element_t;\n    typedef unsigned int accumulation_t;\n    typedef double division_t;\n}; \n</code></pre>\n\n<p>Now the following implemention works fine.</p>\n\n<pre><code>template&lt;typename DF, int SIZE&gt;\nclass CFilter{\nprivate:\n    DF m_memberName[SIZE];\npublic: \n    void whatever(){\n    //CFilter&lt;CDataFormat::division_t, 8&gt; smth; // Just a small test\n    }\n};\n</code></pre>\n\n<p>However it's not ensured that the template only accepts a member of CDataFormat. </p>\n\n<p>How do I do it?</p>\n"}, {"tags": ["c++", "mfc", "listcontrol"], "comments": [{"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 3, "creation_date": 1516821604, "post_id": 48428771, "comment_id": 83850768, "body": "This is the only way to copy data between list view controls, but if you&#39;re concerned about efficiency you can use <a href=\"https://docs.microsoft.com/en-us/cpp/mfc/virtual-list-controls\" rel=\"nofollow noreferrer\">Virtual List Controls</a>"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516822268, "post_id": 48428771, "comment_id": 83851141, "body": "Good idea. With a virtual list control, the data would not be stored in the list control so it could be copied directly without calling any listview methods (except to update the visual representation of the target listview once after the copy is finished)."}], "owner": {"reputation": 47, "user_id": 8359698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37545853962771f31fb448df89883eda?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/8359698/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516822010, "creation_date": 1516816407, "last_edit_date": 1516822010, "question_id": 48428771, "link": "https://stackoverflow.com/questions/48428771/how-to-efficiently-copy-contents-between-two-list-controls", "title": "How to efficiently copy contents between two list controls", "body": "<p>I want to copy rows from one List Control to another List Control. I am only able to copy them by sub item. I think this is not very efficient. There must be a method to copy the content by rows. The following is my code that copies content one sub item at a time.</p>\n\n<pre><code>CString CurItem, tem, copystr;\nint j = 0;\nm_combo_list.GetLBText(m_combo_list.GetCurSel(), CurItem);\nfor (int i = 0; i &lt; m_list.GetItemCount(); i++) {\n    tem = m_list.GetItemText(i, 0);\n    if (CurItem == tem) {\n        m_report_list.InsertItem(j, _T(\"\"));\n        for (int k = 0; k &lt; 14; k++) { // 14 items per row.\n            copystr = m_list.GetItemText(i, k);// get one item per time from one list control.\n            m_report_list.SetItemText(j, k, copystr); // this is another list control. Copy the item to this list control.\n\n        }\n        j++;\n    }\n}\n</code></pre>\n\n<p>Could anyone give a method to replace the for loop by copy a row from <code>m_list</code> to <code>m_report_list</code> directly? I think such a way must save a lot of time.</p>\n"}, {"tags": ["c++", "qt", "qstring"], "comments": [{"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1516817520, "post_id": 48428741, "comment_id": 83848632, "body": "what do you mean in last comment <i>this detected in line variable in Qt deb</i>"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 3, "creation_date": 1516818480, "post_id": 48428741, "comment_id": 83849150, "body": "did you mean you <i><b>verified</b></i> that those are true <b>Tab</b>s, if not , why should you assume they are? for testing did you try <code>\\s</code> (white space) instead of <code>\\t</code>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 3, "creation_date": 1516820161, "post_id": 48428741, "comment_id": 83850012, "body": "<code>list = line.split(QRegExp(&quot;\\\\s+&quot;), QString::SkipEmptyParts);</code>?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1516829778, "post_id": 48428741, "comment_id": 83855140, "body": "<code>QByteArray::toHex()</code> is a great function for investigating stuff like this."}, {"owner": {"reputation": 15, "user_id": 8648678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/056bdc50502915eba6d0e138fd6598e7?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/8648678/javad"}, "edited": false, "score": 0, "creation_date": 1516860369, "post_id": 48428741, "comment_id": 83864457, "body": "deb=&gt; debug(edited in original post)"}, {"owner": {"reputation": 15, "user_id": 8648678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/056bdc50502915eba6d0e138fd6598e7?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/8648678/javad"}, "edited": false, "score": 0, "creation_date": 1516861367, "post_id": 48428741, "comment_id": 83864786, "body": "the problem solved. thanks all and thanks Wiktor Stribi\u017cew. the bug is using &#39;\\t&#39; instead of &quot;\\t&quot;."}, {"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1516869443, "post_id": 48428741, "comment_id": 83868319, "body": "@javad post an answer if you solved it, save time to future readers"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1516908582, "post_id": 48428741, "comment_id": 83893874, "body": "Does it mean <code>list=line.split(&quot;\\t&quot;, QString::SkipEmptyParts);</code> works?"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 8648678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/056bdc50502915eba6d0e138fd6598e7?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/8648678/javad"}, "is_accepted": true, "score": 0, "last_activity_date": 1517068816, "creation_date": 1517068816, "answer_id": 48477606, "question_id": 48428741, "link": "https://stackoverflow.com/questions/48428741/how-to-split-t-in-qt-text-reading/48477606#48477606", "title": "how to split \\t in Qt text reading", "body": "<p>the problem solved. thanks all and thanks Wiktor Stribi\u017cew. the bug is using '\\t' instead of \"\\t\"</p>\n"}], "owner": {"reputation": 15, "user_id": 8648678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/056bdc50502915eba6d0e138fd6598e7?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/8648678/javad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 48477606, "answer_count": 1, "score": 0, "last_activity_date": 1517068816, "creation_date": 1516816290, "last_edit_date": 1516873279, "question_id": 48428741, "link": "https://stackoverflow.com/questions/48428741/how-to-split-t-in-qt-text-reading", "title": "how to split \\t in Qt text reading", "body": "<p>i'm using split to detect some number in a text file in Qt.</p>\n\n<pre><code> QString line = my_file.readLine();\n QStringList list ;\n if(file_format==\"csv\")\n    list=line.split(',', QString::SkipEmptyParts);\n else\n    list=line.split('\\t', QString::SkipEmptyParts);\n</code></pre>\n\n<p>this code works good for csv file. but for txt file it does not detect any number. what can i do? any idea?\n sample text:</p>\n\n<pre><code>-0.0050000000000000001  0.0018503982665486619   1.7510645161290324\n</code></pre>\n\n<p>this detected in line variable in Qt debug</p>\n\n<pre><code>-0.0050000000000000001\\t0.0018503982665486619\\t1.7510645161290324\n</code></pre>\n"}, {"tags": ["c++", "winapi", "visual-studio-2017"], "comments": [{"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 2, "creation_date": 1516816561, "post_id": 48428728, "comment_id": 83848095, "body": "Modern Win32 programming is always using <code>UNICODE</code> and <code>_UNICODE</code> so you should be using wide-character strings. The old <code>TCHAR</code> and <code>TEXT</code> macro stuff was last useful when we still cared about Windows 95..."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1516816635, "post_id": 48428728, "comment_id": 83848139, "body": "Another thing to keep in mind is that you can <i>read</i> from HKLM without administrator rights, you can&#39;t write it."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1516816887, "post_id": 48428728, "comment_id": 83848288, "body": "You did not initialize the size for reading. <b><i>it works in debug mode, but still fails in release with error code</i></b> Probably because uninitialized stack data is filled with 0xcc in debug mode but no initialization is done in release. <code>size</code> should be initialized to the size of your buffer."}, {"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 0, "creation_date": 1516817006, "post_id": 48428728, "comment_id": 83848348, "body": "Please produce a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> instead of small code snippets."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516834235, "post_id": 48428728, "comment_id": 83857286, "body": "You didn&#39;t set the size variable.  It&#39;s an in/out argument to RegGetValue."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1516834330, "post_id": 48428728, "comment_id": 83857331, "body": "<code>LPCTSTR str_data = TEXT(path.c_str());</code>  The <code>TEXT</code> macro is for string literals and <code>path.c_str()</code> is not a string literal.  The fact that this compiles tells me the compiler is in ANSI mode rather than Unicode mode.  This isn&#39;t the cause of your problem, but it is a problem if you ever want to use Unicode."}], "answers": [{"comments": [{"owner": {"reputation": 442, "user_id": 6240151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/879a60dac8aa295273729f5d806f2a38?s=128&d=identicon&r=PG&f=1", "display_name": "GpG", "link": "https://stackoverflow.com/users/6240151/gpg"}, "edited": false, "score": 0, "creation_date": 1516881863, "post_id": 48429359, "comment_id": 83876075, "body": "thanks for great answer, unfortunately I am still getting an error -&gt; I edited the original question."}, {"owner": {"reputation": 442, "user_id": 6240151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/879a60dac8aa295273729f5d806f2a38?s=128&d=identicon&r=PG&f=1", "display_name": "GpG", "link": "https://stackoverflow.com/users/6240151/gpg"}, "edited": false, "score": 0, "creation_date": 1516915043, "post_id": 48429359, "comment_id": 83897138, "body": "the last problem was calling RegGetValueA with RRF_RT_REG_EXPAND_SZ, instead with RRF_NOEXPAND | RRF_RT_REG_EXPAND_SZ, which triggers 87 error. I added the final working example. Thank you again for your help!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 442, "user_id": 6240151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/879a60dac8aa295273729f5d806f2a38?s=128&d=identicon&r=PG&f=1", "display_name": "GpG", "link": "https://stackoverflow.com/users/6240151/gpg"}, "edited": false, "score": 0, "creation_date": 1516918666, "post_id": 48429359, "comment_id": 83898701, "body": "@GpG: That error is a <a href=\"https://stackoverflow.com/a/47097895/65863\">known bug in Windows 7 and earlier</a>, <code>RRF_RT_REG_EXPAND_SZ</code> must be used with <code>RRF_NOEXPAND</code>. That was fixed in Windows 8.1 so <code>RRF_NOEXPAND</code> is optional, as it should have been all along."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 442, "user_id": 6240151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/879a60dac8aa295273729f5d806f2a38?s=128&d=identicon&r=PG&f=1", "display_name": "GpG", "link": "https://stackoverflow.com/users/6240151/gpg"}, "edited": false, "score": 0, "creation_date": 1516918730, "post_id": 48429359, "comment_id": 83898719, "body": "@GpG: in your &quot;final solution&quot;, you need to check if <code>RegOpenKeyExA()</code> (why not <code>RegCreateKeyExA()</code>?) succeeds before you call <code>RegSetValueExA()</code>. DO NOT use <code>KEY_ALL_ACCESS</code>, it only works for admins. Non-admins don&#39;t have write access to HKLM. You should NEVER open a key for reading and writing at the same time. Open a key for writing, write what you need, close the key. Open a key for reading, read what you need, close the key. You will have less errors that way."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 5, "last_activity_date": 1516919512, "last_edit_date": 1516919512, "creation_date": 1516818711, "answer_id": 48429359, "question_id": 48428728, "link": "https://stackoverflow.com/questions/48428728/writing-reading-to-windows-registry-with-windows-api/48429359#48429359", "title": "Writing &amp; reading to windows registry with windows API", "body": "<p>On the writing side:</p>\n\n<p><code>std::string</code> uses <code>char</code> elements, but <code>TCHAR</code> maps to either <code>char</code> or <code>wchar_t</code> depending on whether your code is compiled with <code>UNICODE</code> defined or not.</p>\n\n<p>The <code>TEXT()</code> macro only works with <em>compile-time literals</em>, you can't use it with <em>runtime data</em>.  <code>TEXT(path.c_str())</code> is an invalid type-cast, and won't even compile if <code>UNICODE</code> is enabled.</p>\n\n<p>You are clearly working with <code>char</code> data, so you should be using the <code>char</code>-based API functions instead of the <code>TCHAR</code>-based functions.</p>\n\n<p>You are also not following one of the most important rules of <code>RegSetValueEx()</code>:</p>\n\n<blockquote>\n  <p>For string-based types, such as REG_SZ, <strong>the string must be null-terminated</strong>. With the REG_MULTI_SZ data type, the string must be terminated with two null characters... The size of the information pointed to by the lpData parameter, in bytes. <strong>If the data is of type REG_SZ, REG_EXPAND_SZ, or REG_MULTI_SZ, cbData must include the size of the terminating null character or characters</strong>. </p>\n</blockquote>\n\n<p><code>std::string::c_str()</code> returns a pointer to null-terminated data, but you are not including the null terminator when reporting the size of the data you are writing to the Registry.  <code>RegGetValue()</code> knows how to deal with that mistake, but <code>RegGetValueEx()</code> does not.  You might not be the only person to ever read the value, so make sure you include the null terminator properly.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>std::string path = \"c:\\\\\";\nLONG setRes = RegSetValueExA(*key, \"DumpFolder\", 0, REG_EXPAND_SZ, (LPCBYTE)path.c_str(), path.size()+1);\n</code></pre>\n\n<p>On the reading side:</p>\n\n<p>You are getting errors because you are not telling <code>RegGetValue()</code> how large your <code>str_data</code> buffer is.  You have to set your <code>size</code> variable to the size of <code>str_data</code>, in bytes, before you pass it in.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>char str_data[1028];\nDWORD size = sizeof(str_data);\nDWORD dwFlags = RRF_RT_REG_EXPAND_SZ;\n// NOTE: when using RRF_RT_REG_EXPAND_SZ, RRF_NOEXPAND is *required* prior to Windows 8.1!\nauto status = RegGetValueA(HKEY_LOCAL_MACHINE, \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error reporting\\\\LocalDumps\", \"DumpFolder\", RRF_RT_REG_EXPAND_SZ | RRF_NOEXPAND, NULL, str_data, &amp;size);\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>std:string str_data;\nDWORD size = 0;\nconst char *sk = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error reporting\\\\LocalDumps\";\n// NOTE: when using RRF_RT_REG_EXPAND_SZ, RRF_NOEXPAND is *required* prior to Windows 8.1!\nconst DWORD dwFlags = RRF_RT_REG_EXPAND_SZ | RRF_NOEXPAND;\nauto status = RegGetValueA(HKEY_LOCAL_MACHINE, sk, \"DumpFolder\", dwFlags, NULL, NULL, &amp;size);\nif ((status == ERROR_SUCCESS) &amp;&amp; (size &gt; 1))\n{\n    str_data.resize(size-1);\n    status = RegGetValueA(HKEY_LOCAL_MACHINE, sk, \"DumpFolder\", dwFlags, NULL, &amp;str_data[0], &amp;size);\n}\n</code></pre>\n\n<p><strong>UPDATE</strong>: your new code fails because you have introduced new bugs.</p>\n\n<p>You are using legacy Registry functions that are meant for 16bit apps. You need to use <code>RegOpenKeyEx</code>/<code>RegCreateKeyEx</code> instead of <code>RegOpenKey</code>/<code>RegCreateKey</code>, and then you can specify only the specific access rights that you actually need (create subkeys, set values, read values, etc). Even better, <code>RegCreateKeyEx()</code> creates missing keys for you, so you don't need to manually open a parent key separately just to create a new subkey.</p>\n\n<p>Also, you changed <code>HKEY_LOCAL_MACHINE</code> to <code>HKEY_CURRENT_USER</code>, but not consistently. Some of your steps use one root, other steps use the other root. You are not able to read back the value you are writing because you are not reading from the same key you wrote to.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>LPCSTR sk = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\LocalDumps\";\nHKEY default_key;\nauto status = RegCreateKeyExA(HKEY_LOCAL_MACHINE, sk, 0, NULL, REG_OPTION_NON_VOLATILE, KEY_SET_VALUE, NULL, &amp;default_key, NULL); \nif (status == ERROR_SUCCESS)\n{\n    std::string path = \"c:\\\\\";\n    status = RegSetValueExA(default_key, \"DumpFolder\", 0, REG_EXPAND_SZ, (LPCBYTE)path.c_str(), path.size() + 1);\n    RegCloseKey(default_key);\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>LPCSTR sk = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error reporting\\\\LocalDumps\";\nstd::string str_data;\nDWORD size = 0;\n// NOTE: when using RRF_RT_REG_EXPAND_SZ, RRF_NOEXPAND is *required* prior to Windows 8.1!\nconst DWORD dwFlags = RRF_RT_REG_EXPAND_SZ | RRF_NOEXPAND;\nauto status = RegGetValueA(HKEY_LOCAL_MACHINE, sk, \"DumpFolder\", dwFlags, NULL, NULL, &amp;size);\nif ((status == ERROR_SUCCESS) &amp;&amp; (size &gt; 1))\n{\n    str_data.resize(size - 1);\n    status = RegGetValueA(HKEY_LOCAL_MACHINE, sk, \"DumpFolder\", dwFlags, NULL, &amp;str_data[0], &amp;size);\n}\n</code></pre>\n\n<p>On the other hand, when you have to make multiple API calls to read a value (ie, to query the size, then query the data), you should explicitly open the parent key first: </p>\n\n<pre><code>const char *sk = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error reporting\\\\LocalDumps\";\nstd:string str_data;\nHKEY default_key;\nauto status = RegOpenKeyExA(HKEY_LOCAL_MACHINE, sk, 0, KEY_QUERY_VALUE, &amp;dumps_key); \nif (status == ERROR_SUCCESS)\n{\n    DWORD size = 0;\n    // NOTE: when using RRF_RT_REG_EXPAND_SZ, RRF_NOEXPAND is *required* prior to Windows 8.1!\n    const DWORD dwFlags = RRF_RT_REG_EXPAND_SZ | RRF_NOEXPAND;\n\n    status = RegGetValueA(default_key, \"\", \"DumpFolder\", dwFlags, NULL, NULL, &amp;size);\n    if ((status == ERROR_SUCCESS) &amp;&amp; (size &gt; 1))\n    {\n        str_data.resize(size-1);\n        status = RegGetValueA(default_key, \"\", \"DumpFolder\", dwFlags, NULL, &amp;str_data[0], &amp;size);\n    }\n\n    RegCloseKey(default_key);\n}\n</code></pre>\n"}], "owner": {"reputation": 442, "user_id": 6240151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/879a60dac8aa295273729f5d806f2a38?s=128&d=identicon&r=PG&f=1", "display_name": "GpG", "link": "https://stackoverflow.com/users/6240151/gpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2568, "favorite_count": 2, "accepted_answer_id": 48429359, "answer_count": 1, "score": 1, "last_activity_date": 1516921824, "creation_date": 1516816221, "last_edit_date": 1516921824, "question_id": 48428728, "link": "https://stackoverflow.com/questions/48428728/writing-reading-to-windows-registry-with-windows-api", "title": "Writing &amp; reading to windows registry with windows API", "body": "<p>I am trying to write&amp;read from the windows register:</p>\n\n<p>Writting:</p>\n\n<pre><code>std::string path = \"c:\\\\\"\nLPCTSTR str_data = TEXT(path.c_str());\nauto size = static_cast&lt;DWORD&gt;(strlen(str_data));\nLONG setRes = RegSetValueEx(*key, TEXT(\"DumpFolder\"), 0, REG_EXPAND_SZ, (LPBYTE)str_data, size);\n</code></pre>\n\n<p>Reading:</p>\n\n<pre><code>char str_data[1028];\nDWORD keyType;\nDWORD size;\nauto sk = TEXT(\"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error reporting\\\\LocalDumps\");\nauto status = RegGetValue(HKEY_LOCAL_MACHINE, sk, TEXT(\"DumpFolder\"), RF_RT_REG_EXPAND_SZ, &amp;keyType, str_data, &amp;size);\n</code></pre>\n\n<p>Writing appears to work fine, at least it looks fine in regedit.exe.</p>\n\n<p>Reading fails with ERROR_INVALID_PARAMETER = 87. If I change RF_RT_REG_EXPAND_SZ to RRF_RT_ANY, it works in debug mode, but still fails in release with error code ERROR_MORE_DATA = 234. I tried:</p>\n\n<pre><code>std::string path = \"c:\\\\\";\npath = path + \"\\0\"  (it should be null terminated anyway\n</code></pre>\n\n<p>but it doesn't help</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>First of all, thanks for answers, I understand the thing a little better now. Unfortunately, I am still unable to read the string successfully.</p>\n\n<p>Here is the test example combined from the answer below:</p>\n\n<pre><code>HKEY registry_key;\nLPCTSTR sk = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\";\n\n// open registry key\nauto openRes = RegOpenKey(HKEY_CURRENT_USER, sk, &amp;registry_key);\n\n// set default dump options\nHKEY default_key;\nauto createRes = RegCreateKey(registry_key, \"LocalDumps\", &amp;default_key);\nif (createRes != ERROR_SUCCESS) {\n    auto b = createRes;\n}    \n\nstd::string path = \"c:\\\\\";\nLONG setRes = RegSetValueExA(default_key, \"DumpFolder\", 0, REG_EXPAND_SZ, (LPCBYTE)path.c_str(), path.size() + 1);\n\nstd::string str_data;\nDWORD size = 0;\nconst char *sak = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error reporting\\\\LocalDumps\";\nauto status = RegGetValueA(HKEY_CURRENT_USER, sak, \"DumpFolder\", RRF_RT_REG_EXPAND_SZ, NULL, NULL, &amp;size);\nif ((status == ERROR_SUCCESS) &amp;&amp; (size &gt; 1)) {\n    str_data.resize(size - 1);\n    status = RegGetValueA(HKEY_CURRENT_USER, sk, \"DumpFolder\", RRF_RT_REG_EXPAND_SZ, NULL, &amp;str_data[0], &amp;size);\n}\n</code></pre>\n\n<p>Writing again works fine (checked in regedit, and the return error code). On the other hand, reading the size of string register sets the size to 0 and returns error code 87 = ERROR_INVALID_PARAMETER.</p>\n\n<p>Apparently, I am still missing something. (the project is set to multy-byte character set)</p>\n\n<p><strong>SOLUTION</strong></p>\n\n<p>After fixing things proposed by the answers below, the following code worked for me:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\n#define reg_type HKEY_LOCAL_MACHINE\n\nvoid main() {\n\n    const std::string reg_path = \"Software\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\LocalDumps\";\n    const std::string dump_folder = \"DumpFolder\";\n    const std::string path = \"c:\\\\\";\n\n    // WRITING\n    HKEY default_key;\n    auto status = RegCreateKeyExA(reg_type, reg_path.c_str(), 0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE | KEY_QUERY_VALUE, NULL, &amp;default_key, NULL);\n    if (status != ERROR_SUCCESS) {\n        std::cout &lt;&lt; \"Creating key failed.\";\n        return;\n    }\n    status = RegSetValueExA(default_key, dump_folder.c_str(), 0, REG_EXPAND_SZ, (LPCBYTE)path.c_str(), path.size() + 1);\n    if (status != ERROR_SUCCESS) {\n        std::cout &lt;&lt; \"Setting key value failed.\";\n        return;\n    }\n\n    // READING\n    std::string str_data;\n    DWORD size = 0;\n    status = RegGetValueA(default_key, \"\", dump_folder.c_str(), RRF_NOEXPAND | RRF_RT_REG_EXPAND_SZ, NULL, NULL, &amp;size);\n    if ((status == ERROR_SUCCESS) &amp;&amp; (size &gt; 1)){\n        str_data.resize(size - 1);\n        status = RegGetValueA(default_key, \"\", dump_folder.c_str(), RRF_NOEXPAND | RRF_RT_REG_EXPAND_SZ, NULL, &amp;str_data[0], &amp;size);\n        std::cout &lt;&lt; \"Successfully read key value: \" &lt;&lt; str_data;\n    } else {\n        std::cout &lt;&lt; \"Unable to retrive value. Error: \" &lt;&lt; status;\n    }\n\n    RegCloseKey(default_key);\n}\n</code></pre>\n\n<p>I found, that RegGetValueA should be called with a </p>\n\n<pre><code>RRF_NOEXPAND | RRF_RT_REG_EXPAND_SZ \n</code></pre>\n\n<p>flag, which appears strange, but is described in header where it is defined, so I guess it is correct. If using only </p>\n\n<pre><code>RRF_RT_REG_EXPAND_SZ\n</code></pre>\n\n<p>error 87 occurs ERROR_INVALID_PARAMETER.</p>\n"}, {"tags": ["c++", "c++14", "smart-pointers"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1516816661, "post_id": 48428550, "comment_id": 83848157, "body": "@RickAstley: Decrease optimization level: <a href=\"http://coliru.stacked-crooked.com/a/b33a3d123f16ee10\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1516816729, "post_id": 48428550, "comment_id": 83848200, "body": "@Jarod42 Good one"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1516817511, "last_edit_date": 1516817511, "creation_date": 1516815856, "answer_id": 48428646, "question_id": 48428550, "link": "https://stackoverflow.com/questions/48428550/undefined-reference-error-when-initializing-unique-ptr-with-a-static-const/48428646#48428646", "title": "Undefined reference error when initializing unique_ptr with a static const", "body": "<p><code>make_unique</code> takes (forwardind) reference of its parameter, and so odr-use it.</p>\n\n<p><code>My_class(Outside_library::my_const)</code> only use the value.</p>\n\n<p>One solution is to define the member in a TU:</p>\n\n<pre><code>const int Outside_library::my_const;\n</code></pre>\n\n<p><strike>or using <code>constexpr</code> value (since C++11):</p>\n\n<pre><code>class Outside_library\n{\npublic:\n    static constexpr int my_const = 100;\n};\n</code></pre>\n\n<p></strike></p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1516816916, "post_id": 48428746, "comment_id": 83848296, "body": "Wonder if <code>constexpr</code> is enough, clang still has linker issue <a href=\"http://coliru.stacked-crooked.com/a/ab8083f98deca80f\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1516817271, "post_id": 48428746, "comment_id": 83848492, "body": "@Jarod42 I didn&#39;t know <code>constexpr</code>&#39;s could be odr-used but I guess so: <a href=\"https://stackoverflow.com/questions/26196095/static-constexpr-odr-used-or-not\" title=\"static constexpr odr used or not\">stackoverflow.com/questions/26196095/&hellip;</a> and gcc just doesn&#39;t diagnose it. Interesting."}], "tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": true, "score": 4, "last_activity_date": 1516816299, "creation_date": 1516816299, "answer_id": 48428746, "question_id": 48428550, "link": "https://stackoverflow.com/questions/48428550/undefined-reference-error-when-initializing-unique-ptr-with-a-static-const/48428746#48428746", "title": "Undefined reference error when initializing unique_ptr with a static const", "body": "<p>C++ has something known as the <a href=\"http://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">One-Definition Rule (ODR)</a>:</p>\n\n<blockquote>\n  <p>Informally, an object is odr-used if its value is read (unless it is a compile time constant) or written, its address is taken, or a reference is bound to it; a reference is odr-used if it is used and its referent is not known at compile time; and a function is odr-used if a function call to it is made or its address is taken. If an object, a reference or a function is odr-used, its definition must exist somewhere in the program; a violation of that is usually a link-time error.</p>\n</blockquote>\n\n<p>The linked site gives the following example:</p>\n\n<pre><code>struct S {\n    static const int x = 0; // static data member\n    // a definition outside of class is required if it is odr-used\n};\nconst int&amp; f(const int&amp; r);\n\nint n = b ? (1, S::x) // S::x is not odr-used here\n          : f(S::x);  // S::x is odr-used here: a definition is required\n</code></pre>\n\n<p>Your explicit constructor invocation does not \"odr-use\" <code>Outside_library::my_const</code> but the call to <code>std::make_unique()</code> does. When an object is odr-used it must have exactly one <em>definition</em> (not <em>declaration</em>). Your example has a declaration only. Again from <a href=\"http://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">cppreference</a>:</p>\n\n<blockquote>\n  <ol>\n  <li><p>a variable x in a <em>potentially-evaluated</em> expression ex is odr-used unless both of the following are true:</p>\n  \n  <ul>\n  <li>applying lvalue-to-rvalue conversion to x yields a constant expression that doesn't invoke non-trivial functions</li>\n  <li>either x is not an object (that is, x is a reference) or, if x is an object, it is one of the <em>potential results</em> of a larger expression e, where that larger expression is either a discarded-value expression or has the lvalue-to-rvalue conversion applied to it</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<p>The solution as suggested by Jarod42 is to use <code>constexpr</code> instead of <code>const</code> (if you have control over the \"outside library\" code). If you do not, then you'll need to link the program against the library that contains the <em>definition</em> of <code>Outside_library::my_const</code>.</p>\n\n<pre><code>g++ main.cpp -std=c++14 -lOutside_library\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5848690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7d33e0451978f3dc97fe006148f37c?s=128&d=identicon&r=PG&f=1", "display_name": "eswens13", "link": "https://stackoverflow.com/users/5848690/eswens13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2437, "favorite_count": 1, "accepted_answer_id": 48428746, "answer_count": 2, "score": 8, "last_activity_date": 1516817511, "creation_date": 1516815501, "question_id": 48428550, "link": "https://stackoverflow.com/questions/48428550/undefined-reference-error-when-initializing-unique-ptr-with-a-static-const", "title": "Undefined reference error when initializing unique_ptr with a static const", "body": "<p>When I try to use a <code>static const</code> to initialize a <code>unique_ptr</code>, I get an \"undefined reference\" error. However, when I <code>new</code> a pointer using the same constant, the symbol seems to be magically defined.</p>\n\n<p>Here is a simple program that reproduces the error:</p>\n\n<p><strong>Outside_library.h</strong></p>\n\n<pre><code>class Outside_library\n{\npublic:\n  static const int my_const = 100;\n};\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"Outside_library.h\"\n\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nclass My_class\n{\npublic:\n  My_class(int num)\n  {\n    m_num = num;\n  };\n\n  virtual ~My_class(){};\n\nprivate:\n  int m_num;\n};\n\nint main(int, char* [])\n{\n  My_class* p_class = new My_class(Outside_library::my_const);\n  delete p_class;\n\n  // ==== ERROR HERE: When I comment this line out, the program runs fine.\n  std::unique_ptr&lt;My_class&gt; p_unique\n      = std::make_unique&lt;My_class&gt;(Outside_library::my_const);\n\n  std::cout &lt;&lt; \"I made it through!\" &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p>I compiled the program using</p>\n\n<pre><code>g++ main.cpp -std=c++14\n</code></pre>\n\n<p>and got the following error.</p>\n\n<pre><code>/tmp/ccpJSQJS.o: In function `main':\nmain.cpp:(.text+0x51): undefined reference to `Outside_library::my_const'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Can someone please help me understand why the constant is defined when using <code>new</code>, but not when using <code>make_unique</code>?</p>\n"}, {"tags": ["c++", "openssl", "libcurl"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1516816566, "post_id": 48428492, "comment_id": 83848101, "body": "<i>&quot;... but for some reason it gets sent out as TLS 1.0...&quot;</i> - We probably need to see a Wireshark trace, but... There are two versions in play. First is the record layer version, and second is the TLS version used in handshake and subsequently cipher selection and bulk encryption. Also see <a href=\"https://wiki.openssl.org/index.php/SSL/TLS_Client\" rel=\"nofollow noreferrer\">TLS Client</a> on the OpenSSL wiki. The images on the right show you the fields, like the TLS handshake version."}], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 470, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517327727, "creation_date": 1516815273, "last_edit_date": 1517327727, "question_id": 48428492, "link": "https://stackoverflow.com/questions/48428492/tls-version-not-set-correctly-cant-pull-session-info", "title": "TLS version not set correctly, can&#39;t pull session info", "body": "<p><strong>RESOLVED</strong></p>\n\n<p>Build configuration error.</p>\n\n<p>The officially \"blessed\" implementations of curl and OpenSSL on our system are <em>woefully</em> out of date (OpenSSL 0.9.8).  All the applications I communicate with won't accept anything below TLS v1.2, so I had downloaded and built OpenSSL 1.1 and Curl 7.48 under my home directory.</p>\n\n<p>However, even though I specified <code>--with-ssl=/my/tools/ssl</code> in the <code>configure</code> command for building Curl, it was still picking up the old version of libssl under /etc/lib.  </p>\n\n<p>I had to do the following to get everything to build Curl properly:</p>\n\n<pre><code>#\n# make sure prefix in /my/tools/lib/pkgconfig/libcurl.pc is set to\n# /my/tools\n#\nCFG_PACKAGE_PATH=/my/tools/lib/pkgconfig:$CFG_PACKAGE_PATH\nCPPFLAGS=\"-I/my/tools/include\"\nLDFLAGS=\"-L/my/tools/lib/\"\n\n./configure --prefix=/my/local --with-ssl\n</code></pre>\n\n<p>After that, Curl properly linked against my local OpenSSL build and worked correctly.</p>\n\n<p><strong>ORIGINAL</strong></p>\n\n<p>Particulars-</p>\n\n<pre><code>OS: SLES 10\nCompiler: g++ 4.1.2\nlibcurl: 7.48.0\nOpenSSL: 1.0.21\n</code></pre>\n\n<p>We have a C++ application that's using libcurl to connect to a URL through OpenSSL.  I'm getting an SSL connect error because, according to the admin of the remote site, we're trying to connect with TLS 1.0, which they have disabled.  However, I'm explicitly setting the protocol to TLS version 1.2 in my code as follows:</p>\n\n<pre><code>if ( curl_easy_setopt( m_curlHandle, CURLOPT_SSLVERSION, CURL_SSLVERSION_TLSv1_2 ) != CURLE_OK)\n  m_log.logv( LOG_ERR, \"%s - Cannot set SSL version to TLS 1.2!\", __PRETTY_FUNCTION__ );\n</code></pre>\n\n<p>I don't get the error message, so the SSL version <em>should</em> be set to TLS 1.2, but for some reason it gets sent out as TLS 1.0.  </p>\n\n<p>I'm trying to pull session information to try to verify that things are set the way I think, so I'm using the <code>curl_easy_getinfo</code> function, but it's returning an error code of CURLE_BAD_FUNCTION_ARGUMENT.  I've gone over my call against the CURL documentation, and as far as I can tell I'm passing the things it expects.  </p>\n\n<p>Here's the meat of the code (not the <em>exact</em> code, but the order of operations and calls themselves reflect it accurately):</p>\n\n<pre><code>CURL *m_curlHandle;\n...\ncurl_global_init( CURL_GLOBAL_ALL );\nm_curlHandle = curl_easy_init( ) ;\n\ncurl_easy_setopt( m_curlHandle, CURLOPT_USERAGENT, \"libcurl-agent/1.0\" );\ncurl_easy_setopt( m_curlHandle, CURLOPT_SSL_VERIFYPEER, 1 );\ncurl_easy_setopt( m_curlHandle, CURLOPT_SSL_VERIFYHOST, 2 );\ncurl_easy_setopt( m_curlHandle, CURLOPT_POST, 1L );\ncurl_easy_setopt( m_curlHandle, CURLOPT_TIMEOUT, 60 );\ncurl_easy_setopt( m_curlHandle, CURLOPT_NOPROGRESS, 1L );\ncurl_easy_setopt( m_curlHandle, CURLOPT_ERRORBUFFER, &amp;m_curlErrBuffer );\ncurl_easy_setopt( m_curlHandle, CURLOPT_WRITEFUNCTION, write_data );\ncurl_easy_setopt( m_curlHandle, CURLOPT_READFUNCTION, read_data );\ncurl_easy_setopt( m_curlHandle, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\n...\nif ( curl_easy_setopt( m_curlHandle, CURLOPT_SSLVERSION, CURL_SSLVERSION_TLSv1_2 ) != CURLE_OK)\n  m_log.logv( LOG_ERR, \"%s - Cannot set SSL version to TLS 1.2!\", __PRETTY_FUNCTION__ );\n...\nstruct curl_tlssessioninfo *session;\nCURLcode result;\n\nresult = curl_easy_getinfo( m_curlHandle, CURLINFO_TLS_SSL_PTR, &amp;session );\n</code></pre>\n\n<p>Based on the documentation <a href=\"https://curl.haxx.se/libcurl/c/CURLINFO_TLS_SSL_PTR.html\" rel=\"nofollow noreferrer\">here</a>, I'm passing the right arguments to <code>curl_easy_getinfo</code>, so this is becoming especially frustrating.  </p>\n\n<p>Anyone have <em>any</em> ideas on a) how I can verify that I'm using TLS 1.2 or not on outgoing messages, and 2) how I can pull session information correctly?</p>\n\n<p>Thanks in advance.  </p>\n"}, {"tags": ["c++", "bluetooth"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1516815329, "post_id": 48428220, "comment_id": 83847386, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11583205/c-how-to-obtain-context-when-callback-doesnt-provide-user-arg\">c++: How to obtain context when callback doesn&#39;t provide user arg?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 80, "user_id": 2926044, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/532702508/picture?type=large", "display_name": "Cagri Candan", "link": "https://stackoverflow.com/users/2926044/cagri-candan"}, "edited": false, "score": 0, "creation_date": 1544131494, "post_id": 48428489, "comment_id": 94178025, "body": "I had same problem however I could&#39;t solve this with your suggestion , could you give specific example @Mihayl about this because no meter what I can try I am facing same error which mentions about his  in the questions"}], "tags": [], "owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "is_accepted": true, "score": 0, "last_activity_date": 1544517243, "last_edit_date": 1544517243, "creation_date": 1516815272, "answer_id": 48428489, "question_id": 48428220, "link": "https://stackoverflow.com/questions/48428220/how-do-i-pass-a-member-function-as-a-parameter-callback-function-with-regards-to/48428489#48428489", "title": "How do I pass a member function as a parameter callback function with regards to Bluetooth on Windows?", "body": "<p>That's what the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/bluetoothleapis/nf-bluetoothleapis-bluetoothgattregisterevent\" rel=\"nofollow noreferrer\"><code>BluetoothGATTRegisterEvent</code>'s</a> <code>CallbackContext</code> parameter is for.</p>\n\n<p>Have to pass a <code>static</code> member function as a callback and <code>this</code> as a <code>CallbackContext</code>. Non-static member functions have an implicit <code>this</code> as first parameter (<a href=\"https://docs.microsoft.com/en-us/cpp/cpp/thiscall?view=vs-2017\" rel=\"nofollow noreferrer\"><code>__thiscall</code></a>) and cannot be used as callback.</p>\n\n<p>In the callback you can cast the <code>Context</code> to <code>this</code> and access the other members of your class.</p>\n\n<p>Example:</p>\n\n<pre><code>class HeartRateMonitor {\npublic:\n    //...\n    void MemberFun(BTH_LE_GATT_EVENT_TYPE EventType, PVOID EventOutParameter, PVOID Context)\n    {}\n\n    static void StaticMemberFun(BTH_LE_GATT_EVENT_TYPE EventType, PVOID EventOutParameter, PVOID Context)\n    {\n        HeartRateMonitor* pThis = static_cast&lt;HeartRateMonitor*&gt;(Context);\n\n        /* Function code */\n        // and here you could access your class non-static data by pThis-&gt;...\n        // or call a non-static method, so you don't need to always writhe `pThis`\n    }\n\n    HeartRateMonitor()\n    {\n        HANDLE hLEDevice = 0;\n        BTH_LE_GATT_EVENT_TYPE EventType = CharacteristicValueChangedEvent;\n        PVOID EventParameterIn = 0;\n        BLUETOOTH_GATT_EVENT_HANDLE EventHandle = 0;\n        HRESULT hr = 0;\n\n        hr = ::BluetoothGATTRegisterEvent(  // ok\n                hLEDevice,\n                EventType,\n                &amp;EventParameterIn,\n                &amp;HeartRateMonitor::StaticMemberFun,\n                this,\n                &amp;EventHandle,\n                BLUETOOTH_GATT_FLAG_NONE);\n\n        hr = ::BluetoothGATTRegisterEvent(  // error C2664: 'unsigned long BluetoothGATTRegisterEvent(HANDLE,BTH_LE_GATT_EVENT_TYPE,void *,PFNBLUETOOTH_GATT_EVENT_CALLBACK,void *,BLUETOOTH_GATT_EVENT_HANDLE *,unsigned long)': cannot convert argument 4 from 'void (__cdecl HeartRateMonitor::* )(BTH_LE_GATT_EVENT_TYPE,void *,void *)' to 'PFNBLUETOOTH_GATT_EVENT_CALLBACK'\n                hLEDevice,\n                EventType,\n                &amp;EventParameterIn,\n                &amp;HeartRateMonitor::MemberFun,\n                this,\n                &amp;EventHandle,\n                BLUETOOTH_GATT_FLAG_NONE);\n    }\n};\n</code></pre>\n\n<p><kbd><a href=\"https://gcc.godbolt.org/z/d-MSNy\" rel=\"nofollow noreferrer\">Example</a></kbd></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15388707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bzgSR.png?s=128&g=1", "display_name": "prakash", "link": "https://stackoverflow.com/users/15388707/prakash"}, "is_accepted": false, "score": 0, "last_activity_date": 1615643174, "creation_date": 1615643174, "answer_id": 66614234, "question_id": 48428220, "link": "https://stackoverflow.com/questions/48428220/how-do-i-pass-a-member-function-as-a-parameter-callback-function-with-regards-to/66614234#66614234", "title": "How do I pass a member function as a parameter callback function with regards to Bluetooth on Windows?", "body": "<p>Put &quot;CALLBACK&quot; before a function name:</p>\n<pre><code>// Function definition\nvoid CALLBACK SomeEvent(BTH_LE_GATT_EVENT_TYPE EventType, PVOID EventOutParameter, PVOID Context)\n{ /* Function code */}\n</code></pre>\n<p>It works for me (VC 2019 and mingw).</p>\n"}], "owner": {"reputation": 51, "user_id": 8549803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363389efe102913ddf5df77dcac08376?s=128&d=identicon&r=PG&f=1", "display_name": "MattBT12", "link": "https://stackoverflow.com/users/8549803/mattbt12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 48428489, "answer_count": 2, "score": 0, "last_activity_date": 1615643174, "creation_date": 1516814331, "question_id": 48428220, "link": "https://stackoverflow.com/questions/48428220/how-do-i-pass-a-member-function-as-a-parameter-callback-function-with-regards-to", "title": "How do I pass a member function as a parameter callback function with regards to Bluetooth on Windows?", "body": "<p>I'm trying to get a heart rate from a heart rate monitor using Windows' Bluetooth API, but I've encountered a problem with the <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/hh450804(v=vs.85).aspx\" rel=\"nofollow noreferrer\">BluetoothGATTRegisterEvent</a> function, namely the fourth parameter which expects a PFNBLUETOOTH_GATT_EVENT_CALLBACK callback function as a parameter. Doing the following code works fine:</p>\n\n<pre><code>// Function definition\nvoid SomeEvent(BTH_LE_GATT_EVENT_TYPE EventType, PVOID EventOutParameter, PVOID Context)\n{ /* Function code */}\n\n// Calling BluetoothGATTRegisterEvent\nhr = BluetoothGATTRegisterEvent(\n                hLEDevice,\n                EventType,\n                &amp;EventParameterIn,\n                SomeEvent,\n                NULL,\n                &amp;EventHandle,\n                BLUETOOTH_GATT_FLAG_NONE);\n</code></pre>\n\n<p>However, if I attempt to pass a member function (e.g. HeartRateMonitor::SomeEvent instead of just SomeEvent) I get the following error:</p>\n\n<pre><code>argument of type \"void (HeartRateMonitor::*)(BTH_LE_GATT_EVENT_TYPE EventType, PVOID EventOutParameter, PVOID Context)\" is incompatible with parameter of type \"PFNBLUETOOTH_GATT_EVENT_CALLBACK\"\n</code></pre>\n\n<p>My first instinct was to try to use a function pointer or std::bind object, but neither of these worked either. Are there some special considerations that need to be made when passing a callback function as this parameter, or am I missing something obvious regarding member functions?</p>\n"}, {"tags": ["c#", "c++", "dll", "glfw"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516814527, "post_id": 48428117, "comment_id": 83846880, "body": "Show us the definition of <code>GlfwImage</code> in the C++!"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516814605, "post_id": 48428117, "comment_id": 83846927, "body": "Also, does <code>GlfwImage</code> use one byte per pixel, or several?  You are responsible for making sure that <code>pixels</code> points to <code>width*height</code> actual pixel data."}, {"owner": {"reputation": 91, "user_id": 8059376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bb08437bbc917850b41601582d9c03?s=128&d=identicon&r=PG&f=1", "display_name": "S. Mense", "link": "https://stackoverflow.com/users/8059376/s-mense"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516814798, "post_id": 48428117, "comment_id": 83847062, "body": "<a href=\"http://www.glfw.org/docs/latest/structGLFWimage.html\" rel=\"nofollow noreferrer\">glfw.org/docs/latest/structGLFWimage.html</a> This is the documentation on it. I don&#39;t have the actual source code."}, {"owner": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "edited": false, "score": 0, "creation_date": 1516862041, "post_id": 48428117, "comment_id": 83865066, "body": "Is your program running as 32-bit? If so this is probably a calling convention mismatch. In 32-bit programs, C functions are by default exported as <code>__cdecl</code>, but P/Invoke defaults to <code>__stdcall</code> on x86 Windows. Use <code>[DllImport(&#47;*...*&#47;, CallingConvention=CallingConvention.Cdecl)]</code> if that&#39;s the case. See <a href=\"https://stackoverflow.com/a/15664100/3446285\">this</a> for more details."}, {"owner": {"reputation": 91, "user_id": 8059376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bb08437bbc917850b41601582d9c03?s=128&d=identicon&r=PG&f=1", "display_name": "S. Mense", "link": "https://stackoverflow.com/users/8059376/s-mense"}, "edited": false, "score": 0, "creation_date": 1516897323, "post_id": 48428117, "comment_id": 83887345, "body": "I&#39;m already loading other methods with more simple parameters that work just fine. I tried it anyways but to no effect. I think the issue is the way the struct is defined. It is supposed to contain a pointer to a C char*, which can either be a string or just a pointer to a byte[] array right?"}], "owner": {"reputation": 91, "user_id": 8059376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bb08437bbc917850b41601582d9c03?s=128&d=identicon&r=PG&f=1", "display_name": "S. Mense", "link": "https://stackoverflow.com/users/8059376/s-mense"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516814951, "creation_date": 1516813972, "last_edit_date": 1516814951, "question_id": 48428117, "link": "https://stackoverflow.com/questions/48428117/pass-char-argument-containing-image-data-to-c-c-dll-glfw", "title": "Pass char* argument containing image data to C/C++ DLL (Glfw)", "body": "<p>I want to pass image data to a C++ DLL function that looks like this:</p>\n\n<pre><code>GLFWcursor* glfwCreateCursor    (\n    const GLFWimage* image,\n    int xhot,\n    int yhot \n)   \n</code></pre>\n\n<p>It crashes supposedly because of this struct (C#):</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct GlfwImage\n{\n    public int width;\n    public int height;\n    public byte[] pixels;\n}\n</code></pre>\n\n<p>\"pixels\" is of type \"unsigned char *\", width and height are simple int-values.</p>\n\n<p>While the method can be load with that signature, I always\nget a System.AccessViolationException when actually calling it.</p>\n\n<p>I tried several datatypes for \"pixels\", including IntPtr and\nactual pointers but to no effect.</p>\n\n<p>Here is how I get the data and call it:</p>\n\n<pre><code>var bufferSize = texture.Size.Width * texture.Size.Height * 4;\n\nIntPtr imageData = Marshal.AllocHGlobal(bufferSize);\n\nGL.GetTexImage(TextureTarget.Texture2D, 0, PixelFormat.Rgba, PixelType.Bitmap, imageData);\n\nbyte[] imageChars = new byte[bufferSize];\n\nMarshal.Copy(imageData, imageChars, 0, bufferSize);\n\nGlfwImage cursorImage = new GlfwImage\n{\n    pixels = imageChars,\n    width = texture.Size.Width,\n    height = texture.Size.Height\n};\n\nGlfwCursor cursor = Glfw.CreateCursor(cursorImage, texture.Size.Width / 2, texture.Size.Height / 2);\n</code></pre>\n\n<p>Is there something I'm overlooking?</p>\n"}, {"tags": ["c++", "algorithm", "performance", "primes", "sieve-of-eratosthenes"], "comments": [{"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 6, "creation_date": 1516813908, "post_id": 48428006, "comment_id": 83846495, "body": "VLA not a good idea in C++. Big size VLA a different problem altogether. Prefer a container."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1516814036, "post_id": 48428006, "comment_id": 83846590, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2582732/time-complexity-of-sieve-of-eratosthenes-algorithm\">Time complexity of Sieve of Eratosthenes algorithm</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1516814144, "post_id": 48428006, "comment_id": 83846650, "body": "All multiples of the numbers smaller than <code>i</code> have already been eliminated in the previous iterations. Thus, <code>i * i</code> is the smallest multiple of <code>i</code> that hasn&#39;t been eliminated yet. (Write down the numbers from 1 to 100 on paper and execute the algorithm by hand to see it.)"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 1, "creation_date": 1516814196, "post_id": 48428006, "comment_id": 83846677, "body": "As for the <code>i * i</code> question, it doesn&#39;t skip anything, because every number less than <code>i^2</code> is either prime or has a prime factor less than <code>i</code> and has therefore already been marked at a previous step."}, {"owner": {"reputation": 3463, "user_id": 508175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ca8c547ecf1fad821a9932396820baf2?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Teruzzi", "link": "https://stackoverflow.com/users/508175/alessandro-teruzzi"}, "edited": false, "score": 0, "creation_date": 1516814605, "post_id": 48428006, "comment_id": 83846925, "body": "&quot;According to my understanding we have 2 full iterations and 1 partial iteration, therefore O(n^2 * logn)&quot; complexity is difficult to calculate, especially in not trivial cases, how do you come up with O(n^2*logn)?"}], "answers": [{"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 7, "last_activity_date": 1516814739, "last_edit_date": 1516814739, "creation_date": 1516814328, "answer_id": 48428219, "question_id": 48428006, "link": "https://stackoverflow.com/questions/48428006/efficiency-of-sieve-of-eratosthenes-algorithm/48428219#48428219", "title": "Efficiency of Sieve of Eratosthenes algorithm", "body": "<blockquote>\n  <p>Why i * i more efficient than i * 2? Yes, I can understand it would be less iteration, therefore more efficiency, but then doesn't it skip some numbers (for example i = 9 => j = 81 skip 18 27 36 ...)?</p>\n</blockquote>\n\n<p>You are referring to</p>\n\n<pre><code>for (int j = i * i; j &lt; arrSize; j += i)\n</code></pre>\n\n<p>Note that <code>i * i</code> is the <strong>initial</strong> value for the loop counter <code>j</code>. So the values of <code>j</code> greater than <code>i * i</code> will all be marked off. The values which we skip from <code>i * 2</code> to <code>i * i</code> have already been marked off during previous iterations. Let's think about the first few:</p>\n\n<p>When <code>i == 2</code>, we mark off all multiples of 2 (2, 4, 6, 8, etc.). When <code>i == 3</code>, if we start <code>j = 3 * 2 = 6</code> then we will mark off 6 again before reaching 9, 12, 15, etc. Since 6 is a multiple of 2 and was already marked off, we can skip straight to <code>3 * 3 == 9</code>.</p>\n\n<p>When we reach <code>i == 5</code> and if we start at <code>j == 5 * 2 == 10</code>, then we will mark off 10, which was already taken care of since it is a multiple of 2, 15 which is a multiple of 3, and 20 which is also a multiple of 2 before we finally reach 25 which is not a multiple of any primer less than 5.</p>\n\n<blockquote>\n  <p>time complexity here is where things get confusing. I found this notation O(n(logn)(loglogn)) -- what is that? According to my understanding we have 2 full iterations and 1 partial iteration, therefore O(n^2 * logn).</p>\n</blockquote>\n\n<p>Your analysis reaches correct result that this algorithm is <code>O(n^2 * logn)</code>. <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes#Computational_analysis\" rel=\"noreferrer\">A more detailed analysis</a> can prove a tighter upper bound as <code>O(n(logn)(loglogn))</code>. Note that <code>O(n(logn)(loglogn))</code> is a subset of <code>O(n^2 * logn)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": false, "score": 3, "last_activity_date": 1516814488, "creation_date": 1516814488, "answer_id": 48428275, "question_id": 48428006, "link": "https://stackoverflow.com/questions/48428006/efficiency-of-sieve-of-eratosthenes-algorithm/48428275#48428275", "title": "Efficiency of Sieve of Eratosthenes algorithm", "body": "<blockquote>\n  <p>Why i * i more efficient than i * 2? Doesn't it skip some numbers?</p>\n</blockquote>\n\n<p>No it doesn't because smaller multiple of <code>i</code> (For example 18, 27 etc in your case are covered while running loop for <code>i = 2</code>, <code>i = 3</code> etc)</p>\n\n<p>Every number can be represented as unique prime factorization. If <code>i</code> is a prime number, any multiple of <code>i</code> greater than <code>i</code> and smaller than <code>i * i</code> would be multiple of one or more primes smaller than <code>i</code>. </p>\n\n<blockquote>\n  <p>nasty notation <code>O(n(logn)(loglogn))</code></p>\n</blockquote>\n\n<p>From <a href=\"https://stackoverflow.com/questions/2582732/time-complexity-of-sieve-of-eratosthenes-algorithm\">this answer</a><BR>\nNumber of operations are 1/2 + 1/3 + 1/5 + 1/7 ... = n log log n<BR>\nIf you count bit operations, since you're dealing with numbers up to n, they have about log n bits, which is where the factor of log n comes in, giving O(n log n log log n) bit operations.</p>\n"}], "owner": {"reputation": 2165, "user_id": 7852453, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-X8ECFPBAa9Y/AAAAAAAAAAI/AAAAAAAAAao/YDTJtVbzr58/photo.jpg?sz=128", "display_name": "Ramzan Chasygov", "link": "https://stackoverflow.com/users/7852453/ramzan-chasygov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1518865725, "creation_date": 1516813617, "last_edit_date": 1516814460, "question_id": 48428006, "link": "https://stackoverflow.com/questions/48428006/efficiency-of-sieve-of-eratosthenes-algorithm", "title": "Efficiency of Sieve of Eratosthenes algorithm", "body": "<p>I am trying to understand the \"Sieve of Eratosthenes\". Here is my algorithm (code below), and a list of features that I cannot understand (in order).</p>\n\n<ol>\n<li>Why is <code>i * i</code> more efficient than <code>i * 2</code>? Yes, I can understand it would be less iterations, therefore more efficient, but then doesn't it skip some numbers (for example <code>i = 9</code> <code>=&gt;</code> <code>j = 81</code> <code>skips 18 27 36 ...</code>)?</li>\n<li>On Wikipedia I found that space complexity is equal to <code>O(n)</code> and that's understandable; whatever number we enter it creates an array of the size entered, but time complexity here is where things get confusing. I found this notation <code>O(n(logn)(loglogn))</code> -- what is that? According to my understanding we have 2 full iterations and 1 partial iteration, therefore <code>O(n^2 * logn)</code>.</li>\n</ol>\n\n\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n  cout &lt;&lt; \"Enter number:\" &lt;&lt; endl;\n\n  int arrSize;\n  cin &gt;&gt; arrSize;\n\n  bool primesArr[arrSize];\n  primesArr[0] = false;\n  for (int i = 1; i &lt; arrSize; i++) primesArr[i] = true;\n\n  for (int i = 2; i &lt; arrSize; i++)\n\n    if (primesArr[i - 1]) {\n      cout &lt;&lt; i &lt;&lt; endl;\n   /* for (int j = i * 2; j &lt; arrSize; j += i) less efficient */\n      for (int j = i * i; j &lt; arrSize; j += i)\n        primesArr[j - 1] = false;\n    }\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 6, "creation_date": 1516813558, "post_id": 48427938, "comment_id": 83846272, "body": "<i>&quot;<code>FindFirstFile</code> unfortunately doesn&#39;t support wildcards in directory names.&quot;</i> <b>Yes</b> it does.  I use this for a complete directory tree traversal program.  You can&#39;t have more than 1 <code>*</code> so you have to write the code yourself."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1516829615, "post_id": 48427938, "comment_id": 83855052, "body": "@RichardCritten: You are referring to the fact that both files and directories matching the last component are returned, and not claiming that wildcards are allowed anywhere except the last component, correct?  Also, you&#39;re claiming that <code>c:\\path\\file*.*</code> isn&#39;t allowed?  I find that very surprising."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1516869336, "post_id": 48427938, "comment_id": 83868255, "body": "@BenVoigt  - need understand how <code>FindFirstFile[Ex]</code> work. this is shell over <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntifs/nf-ntifs-ntquerydirectoryfile\" rel=\"nofollow noreferrer\"><code>ZwQueryDirectoryFile</code></a>. <code>FindFirstFile</code> need divide input name to folder name (which will be opened in used as <i>FileHandle</i>) and search mask used as <i>FileName</i>. mask can be only in file name. folder must have exact name without wildcards to opened first. and <code>*.*</code> common mistake, converted to <code>*</code> by <code>FindFirstFile</code>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516869371, "post_id": 48427938, "comment_id": 83868278, "body": "so <code>c:\\path\\file*</code> - search <code>file*</code> in <code>c:\\path</code> folder. when <code>c:\\path\\file\\*</code> - search <code>*</code> (all files) in <code>c:\\path\\file</code> folder"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516874429, "post_id": 48427938, "comment_id": 83871350, "body": "for recursive directory search we anyway need recursive call <code>FindFirstFileEx</code>. all what wee need - use <b>different search masks</b> on different level. <code>Data*Set</code> on level 0, <code>Files*</code> on level 1,  <code>*.txt</code> on level 2"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1516894929, "post_id": 48427938, "comment_id": 83885406, "body": "@RbMm: Yes, that matches my understanding, but is completely different from what Critten said.  Also the conversion of <code>*.*</code> to just <code>*</code> doesn&#39;t matter, you can have a filespec like <code>file*.t*</code> which can&#39;t be collapsed that way so it really does have multiple wildcards."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1516895696, "post_id": 48427938, "comment_id": 83886032, "body": "@BenVoigt - yes, you correct.  wildcards allowed only in the last component and in the last component can be any count of *, ? symbols. simply file-system support search by any mask (containing any count of * and ? or at all by empty mask) but only in single folder, which must be exactly specified. the <code>FindFirstFile[Ex]</code> normalize name and divide it by last \\ symbol to folder path (which must be exactly) and mask."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516895983, "post_id": 48427938, "comment_id": 83886305, "body": "Two different answers demonstrate two fundamentally different approaches. or maximal efficient and optimization, but only for windows and more low-level. another try use high level general libs and complex constructs like Regex. this make source code OS independent, but serious loses in memory and speed"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516904922, "post_id": 48427938, "comment_id": 83891914, "body": "@RbMm Do you have anything to substantiate the claims of &quot;serious loses in memory and speed&quot;?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1516912561, "post_id": 48427938, "comment_id": 83895839, "body": "@JonathanMee - for example you enumerate all subfolders/files. and on generated full path you apply <code>Regex</code> (better use <a href=\"https://msdn.microsoft.com/en-us/library/hh551132(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>RtlIsNameInExpression</code></a> here). in another approaches we list not all subfolder, just restrict search. this already can give huge advantage. the <code>FindFirstFile</code> serious loses compare <code>FindFirstFileEx</code> or <code>NtQueryDirectoryFile</code>, i in self solution not allocate any memory, etc. it really very optimized, but of course for windows only"}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1516829881, "post_id": 48428780, "comment_id": 83855196, "body": "Won&#39;t this break if you don&#39;t have &quot;List Directory&quot; permission in parent directories which are fully specified?  With the &quot;Bypass File System Traversal Checking&quot; privilege, that should work.  e.g. it should be possible to glob <code>C:\\Users\\me\\.*\\*.tmp</code>  without being able to list contents of <code>C:\\Users</code>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1516830892, "post_id": 48428780, "comment_id": 83855698, "body": "I think you end up wanting to split on the first separator (e.g. <code>&#47;</code> or <code>\\ </code>) following each wildcard (<code>*</code> and <code>?</code>)"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516831921, "post_id": 48428780, "comment_id": 83856219, "body": "Note that OP is asking about Windows, and VC++2017 still has filesystem in an experimental namespace."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1516832610, "post_id": 48428780, "comment_id": 83856547, "body": "@AdrianMcCarthy: A nearly-compatible version of filesystem that works on Windows should be included in Boost, right?"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1516833711, "post_id": 48428780, "comment_id": 83857065, "body": "@Ben Voigt:  &lt;shrug&gt; I haven&#39;t used Boost.  You <i>can</i> use filesystem with VC++2017, but you have to be aware that it&#39;s in  <code>std::experimental</code> rather than <code>std</code> and make the appropriate adjustments.  Details:  <a href=\"https://docs.microsoft.com/en-us/cpp/standard-library/filesystem\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/standard-library/filesystem</a>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516872612, "post_id": 48428780, "comment_id": 83870199, "body": "we not need any regexp. simply need use different file mask in calls <code>FindFirstFileEx</code> exist much more efficient solution"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516904827, "post_id": 48428780, "comment_id": 83891863, "body": "@RbMm I like where your brain is at. Efficiency sounds good, but if you&#39;re speaking of efficiency meaning speed, then no, if there are any variations in speed between this and <code>FindFirstFileEx</code> those will be far less significant than variations in the file access time. If you&#39;re speaking of efficiency as simplicity to read and write code, then no again... but only because the OP is trying to do this cross platform. Were this a Windows only question, it would be simpler to use only <code>FindFirstFileEx</code>."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1516907240, "post_id": 48428780, "comment_id": 83893139, "body": "@BenVoigt OK, I finally got around to updating this. Thank you for the good suggestion. I really enjoy the Filesystem Library, this has been a fun opportunity to practice it."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516912706, "post_id": 48428780, "comment_id": 83895924, "body": "which code is more easy to read is indefinitely. can be different results for different peoples :)"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516914600, "post_id": 48428780, "comment_id": 83896904, "body": "@RbMm There&#39;s no question simply calling <code>FindFirstFileEx</code> is easier to read, but it&#39;s not cross platform. Nor is Microsoft bound to continue to supporting it. The Filesystem library not only gives you cross platform consistent support, but guarantees the presence of your library on any C++17 compiler."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516914861, "post_id": 48428780, "comment_id": 83897055, "body": "we simply have fundamentally different approaches. and different opinion what is more easy to read too"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1516916132, "post_id": 48428780, "comment_id": 83897692, "body": "@RbMm I... don&#39;t think so. I agree with you that yours is better for Microsoft only code."}, {"owner": {"reputation": 846, "user_id": 7200084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3f015adb015ff957d7924beb4be217?s=128&d=identicon&r=PG&f=1", "display_name": "f4f", "link": "https://stackoverflow.com/users/7200084/f4f"}, "edited": false, "score": 0, "creation_date": 1574416858, "post_id": 48428780, "comment_id": 104234417, "body": "I think it may have sense to change <code>&#39;.&#39;</code> dot symbols in string passed to <code>GenerateRegex</code> into <code>&quot;[.]&quot;</code> in generated regex. Since filename will generally may some and it may lead to search results slightly different from original wildcard."}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": true, "score": 6, "last_activity_date": 1516908521, "last_edit_date": 1516908521, "creation_date": 1516816437, "answer_id": 48428780, "question_id": 48427938, "link": "https://stackoverflow.com/questions/48427938/files-in-directory-with-wildcard-on-windows/48428780#48428780", "title": "Files in directory with wildcard on Windows", "body": "<p>So you should do away with using OS specific file access, in favor of the OS independent: <a href=\"http://en.cppreference.com/w/cpp/filesystem\" rel=\"nofollow noreferrer\">Filesystem Library</a></p>\n\n<p>Let's say that you're given <code>filesystem::path input</code> which contains the path with wildcards. To use this to solve your problem you'd need to:</p>\n\n<ol>\n<li>Use <a href=\"http://en.cppreference.com/w/cpp/filesystem/path/parent_path\" rel=\"nofollow noreferrer\"><code>parent_path</code></a> to break apart <code>input</code> into directories</li>\n<li>Use <a href=\"http://en.cppreference.com/w/cpp/filesystem/path/filename\" rel=\"nofollow noreferrer\"><code>filename</code></a> to obtain the <code>input</code> filename</li>\n<li>Obtain a <a href=\"http://en.cppreference.com/w/cpp/filesystem/directory_iterator\" rel=\"nofollow noreferrer\"><code>directory_iterator</code></a> to the relative or absolute path where the <code>input</code> begins</li>\n<li>Create a recursive function which takes in <code>begin</code> and <code>end</code> iterators to the obtained parent path, the directory iterator, and the filename</li>\n<li>Any time a directory or filename uses a <code>'*'</code> use a <code>regex</code> with the iterator to determine the directory which should be progressed to next</li>\n<li>Either return the path to the matching file or an empty <code>path</code></li>\n</ol>\n\n<p>Due to <a href=\"https://stackoverflow.com/questions/48427938/files-in-directory-with-wildcard-on-windows/48428780#comment83855196_48428780\">the excellent Ben Voigt's comment</a> I've updated the algorithm to step over unwildcarded directories.</p>\n\n<p>For example:</p>\n\n<pre><code>regex GenerateRegex(string&amp; arg) {\n    for (auto i = arg.find('*'); i != string::npos; i = arg.find('*', i + 2)) {\n        arg.insert(i, 1, '.');\n    }\n\n    return regex(arg);\n}\n\nfilesystem::path FindFirstFile(filesystem::path directory, filesystem::path::const_iterator&amp; start, const filesystem::path::const_iterator&amp; finish, string&amp; filename) {\n    while (start != finish &amp;&amp; start-&gt;string().find('*') == string::npos) {\n        directory /= *start++;\n    }\n    filesystem::directory_iterator it(directory);\n    filesystem::path result;\n\n    if (it != filesystem::directory_iterator()) {\n        if (start == finish) {\n            for (auto i = filename.find('.'); i != string::npos; i = filename.find('.', i + 2)) {\n                filename.insert(i, 1, '\\\\');\n            }\n            const auto re = GenerateRegex(filename);\n\n            do {\n                if (!filesystem::is_directory(it-&gt;status()) &amp;&amp; regex_match(it-&gt;path().string(), re)) {\n                    result = *it;\n                    break;\n                }\n            } while (++it != filesystem::directory_iterator());\n        }\n        else {\n            const auto re = GenerateRegex(start-&gt;string());\n\n            do {\n                if (it-&gt;is_directory() &amp;&amp; regex_match(prev(it-&gt;path().end())-&gt;string(), re)) {\n                    result = FindFirstFile(it-&gt;path(), next(start), finish, filename);\n\n                    if (!result.empty()) {\n                        break;\n                    }\n                }\n            } while (++it != filesystem::directory_iterator());\n        }\n    }\n    return result;\n}\n</code></pre>\n\n<p>Which can be called with:</p>\n\n<pre><code>const filesystem::path input(\"C:/Test/Data*Set/Files*/*.txt\");\n\nif (input.is_absolute()) {\n    const auto relative_parent = input.parent_path().relative_path();\n\n    cout &lt;&lt; FindFirstFile(input.root_path(), begin(relative_parent), end(relative_parent), input.filename().string()) &lt;&lt; endl;\n} else {\n    const auto parent = input.parent_path();\n\n    cout &lt;&lt; FindFirstFile(filesystem::current_path(), begin(parent), end(parent), input.filename().string()) &lt;&lt; endl;\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/f7RUBEE3O9JAUGHk\" rel=\"nofollow noreferrer\"><kbd>Live Example</kbd></a></p>\n"}, {"comments": [{"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "edited": false, "score": 0, "creation_date": 1516989065, "post_id": 48440053, "comment_id": 83927063, "body": "Very nice answer, could you please answer mine too ?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "edited": false, "score": 0, "creation_date": 1535718447, "post_id": 48440053, "comment_id": 91181407, "body": "@NorbertBoros are you asking for assistance on <a href=\"https://stackoverflow.com/questions/47182253/c-queryfullprocessimagenamea-alternative-for-windows-xp\">this question</a>?"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1535718572, "post_id": 48440053, "comment_id": 91181477, "body": "@JonathanMee - At that time yes, at this time I still don&#39;t have a definitive solution..."}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 6, "last_activity_date": 1516876719, "last_edit_date": 1516876719, "creation_date": 1516874195, "answer_id": 48440053, "question_id": 48427938, "link": "https://stackoverflow.com/questions/48427938/files-in-directory-with-wildcard-on-windows/48440053#48440053", "title": "Files in directory with wildcard on Windows", "body": "<p>need understand how <code>FindFirstFile[Ex]</code> work. this is shell over <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntifs/nf-ntifs-ntquerydirectoryfile\" rel=\"noreferrer\"><code>NtQueryDirectoryFile</code></a>. <code>FindFirstFile[Ex]</code> need divide input name to folder name (which will be opened in used as <em>FileHandle</em>) and search mask used as <em>FileName</em>. mask can be only in file name. folder must have exact name without wildcard to opened first. </p>\n\n<p>as result <code>FindFirstFile[Ex]</code> always open concrete single folder and search in this folder by mask. for recursive search files - we need recursive call <code>FindFirstFile[Ex]</code>. simply usual we use the same constant search mask on all levels. for example when we want find all files begin from <code>X:\\SomeFolder</code> we first call <code>FindFirstFile[Ex]</code> with <code>X:\\SomeFolder\\*</code> on level 0. if we found <code>SomeSubfolder</code> - we call <code>FindFirstFile[Ex]</code> with <code>X:\\SomeFolder\\SomeSubfolder\\*</code> on level 1 and so on.  but we can use <strong>different search masks</strong> on different levels. <code>Data*Set</code> on level 0, <code>Files*</code> on level 1, <code>*.txt</code> on level 2 </p>\n\n<p>so we need call <code>FindFirstFileEx</code> recursive and on different recursions level use different masks. for example we want found <code>c:\\Program*\\*\\*.txt</code>. we need start from <code>c:\\Program*</code>, then for every founded result append <code>\\*</code> mask, then append <code>\\*.txt</code> on next level. or we can for example want next - search files by next mask - <code>c:\\Program Files*\\Internet Explorer\\*</code> with any deep level. we can use constant deep search folder mask (optional) with final mask (also optional) used already on all more deep levels.\nall this can be really not so hard and efficient implemented:</p>\n\n<pre><code>struct ENUM_CONTEXT : WIN32_FIND_DATA \n{\n    PCWSTR _szMask;\n    PCWSTR *_pszMask;\n    ULONG _MaskCount;\n    ULONG _MaxLevel;\n    ULONG _nFiles;\n    ULONG _nFolders;\n    WCHAR _FileName[MAXSHORT + 1];\n\n    void StartEnum(PCWSTR pcszRoot, PCWSTR pszMask[], ULONG MaskCount, PCWSTR szMask, ULONG MaxLevel, PSTR prefix)\n    {\n        SIZE_T len = wcslen(pcszRoot);\n\n        if (len &lt; RTL_NUMBER_OF(_FileName))\n        {\n            memcpy(_FileName, pcszRoot, len * sizeof(WCHAR));\n\n            _szMask = szMask, _pszMask = pszMask, _MaskCount = MaskCount;\n            _MaxLevel = szMask ? MaxLevel : MaskCount;\n            _nFolders = 0, _nFolders = 0;\n\n            Enum(_FileName + len, 0, prefix);\n        }\n    }\n\n    void Enum(PWSTR pszEnd, ULONG nLevel, PSTR prefix);\n};\n\nvoid ENUM_CONTEXT::Enum(PWSTR pszEnd, ULONG nLevel, PSTR prefix)\n{\n    if (nLevel &gt; _MaxLevel)\n    {\n        return ;\n    }\n\n    PCWSTR lpFileName = _FileName;\n\n    SIZE_T cb = lpFileName + RTL_NUMBER_OF(_FileName) - pszEnd;\n\n    PCWSTR szMask = nLevel &lt; _MaskCount ? _pszMask[nLevel] : _szMask;\n\n    SIZE_T cchMask = wcslen(szMask) + 1;\n\n    if (cb &lt; cchMask + 1)\n    {\n        return ;\n    }\n\n    *pszEnd++ = L'\\\\', cb--;\n\n    DbgPrint(\"%s[&lt;%.*S&gt;]\\n\", prefix, pszEnd - lpFileName, lpFileName);\n\n    memcpy(pszEnd, szMask, cchMask * sizeof(WCHAR));\n\n    ULONG dwError;\n\n    HANDLE hFindFile = FindFirstFileEx(lpFileName, FindExInfoBasic, this, FindExSearchNameMatch, 0, FIND_FIRST_EX_LARGE_FETCH);\n\n    if (hFindFile != INVALID_HANDLE_VALUE)\n    {\n        PWSTR FileName = cFileName;\n\n        do \n        {\n            SIZE_T FileNameLength = wcslen(FileName);\n\n            switch (FileNameLength)\n            {\n            case 2:\n                if (FileName[1] != '.') break;\n            case 1:\n                if (FileName[0] == '.') continue;\n            }\n\n            if (dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY)\n            {\n                _nFolders++;\n\n                if (!(dwFileAttributes &amp; FILE_ATTRIBUTE_REPARSE_POINT))\n                {\n                    if (cb &lt; FileNameLength)\n                    {\n                        __debugbreak();\n                    }\n                    else\n                    {\n                        memcpy(pszEnd, FileName, FileNameLength * sizeof(WCHAR));\n                        Enum(pszEnd + FileNameLength, nLevel + 1, prefix - 1);\n                    }\n                }\n            }\n            else if (nLevel &gt;= _MaskCount || (!_szMask &amp;&amp; nLevel == _MaskCount - 1))\n            {\n                _nFiles++;\n\n                DbgPrint(\"%s%u%u &lt;%.*S&gt;\\n\", prefix, nFileSizeLow, nFileSizeHigh, FileNameLength, FileName);\n            }\n\n        } while (FindNextFile(hFindFile, this));\n\n        if ((dwError = GetLastError()) == ERROR_NO_MORE_FILES)\n        {\n            dwError = NOERROR;\n        }\n\n        FindClose(hFindFile);\n    }\n    else\n    {\n        dwError = GetLastError();\n    }\n\n    if (dwError &amp;&amp; dwError != ERROR_FILE_NOT_FOUND)\n    {\n        DbgPrint(\"%s[&lt;%.*S&gt;] err = %u\\n\", prefix, pszEnd - lpFileName, lpFileName, dwError);\n    }\n}\n\nvoid Test(PCWSTR pcszRoot)\n{\n    char prefix[MAXUCHAR + 1];\n    memset(prefix, '\\t', RTL_NUMBER_OF(prefix) - 1);\n    prefix[RTL_NUMBER_OF(prefix) - 1] = 0;\n\n    ENUM_CONTEXT ectx;\n\n    static PCWSTR Masks[] = { L\"Program*\", L\"*\", L\"*.txt\" };\n    static PCWSTR Masks2[] = { L\"Program*\", L\"*\" };\n    static PCWSTR Masks3[] = { L\"Program Files*\", L\"Internet Explorer\" };\n\n    // search Program*\\*\\*.txt with fixed deep level\n    ectx.StartEnum(pcszRoot, Masks, RTL_NUMBER_OF(Masks), 0, RTL_NUMBER_OF(prefix) - 1, prefix + RTL_NUMBER_OF(prefix) - 1);\n    // search *.txt files from Program*\\*\\ - any deep level\n    ectx.StartEnum(pcszRoot, Masks2, RTL_NUMBER_OF(Masks2), L\"*.txt\", RTL_NUMBER_OF(prefix) - 1, prefix + RTL_NUMBER_OF(prefix) - 1);\n    // search all files (*) from Program Files*\\Internet Explorer\\ \n    ectx.StartEnum(pcszRoot, Masks3, RTL_NUMBER_OF(Masks3), L\"*\", RTL_NUMBER_OF(prefix) - 1, prefix + RTL_NUMBER_OF(prefix) - 1);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 5375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e184304aed19914b51f5f2daef8f32?s=128&d=identicon&r=PG&f=1", "display_name": "Mikolaj", "link": "https://stackoverflow.com/users/5375505/mikolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3462, "favorite_count": 2, "accepted_answer_id": 48428780, "answer_count": 2, "score": 3, "last_activity_date": 1516908521, "creation_date": 1516813395, "last_edit_date": 1516830162, "question_id": 48427938, "link": "https://stackoverflow.com/questions/48427938/files-in-directory-with-wildcard-on-windows", "title": "Files in directory with wildcard on Windows", "body": "<p>how can I easy get all files paths from path containing a wildcards? For example: <em>C:/Data*Set/Files*/*.txt</em> and I wrote it on Linux using <code>glob</code> function but I can't do it on Windows :/ </p>\n\n<p><code>FindFirstFile</code> unfortunately doesn't support wildcards in directory names.</p>\n\n<p>I think there should be a Windows solution available but I can't find it.</p>\n"}, {"tags": ["c++", "pjsip"], "comments": [{"owner": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "edited": false, "score": 0, "creation_date": 1516841389, "post_id": 48427920, "comment_id": 83859482, "body": "The error messages are not in English, so people who don&#39;t speak Italian cannot help you. You can get English error messages by something like <code>export LANG=C</code> and re-running these commands."}, {"owner": {"reputation": 21, "user_id": 3677313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba5e3a0e5b1f6e1a67228ace9ea427?s=128&d=identicon&r=PG&f=1", "display_name": "Sebd77", "link": "https://stackoverflow.com/users/3677313/sebd77"}, "reply_to_user": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "edited": false, "score": 0, "creation_date": 1516888062, "post_id": 48427920, "comment_id": 83880169, "body": "Hi Jan, sorry, I translated the messages"}, {"owner": {"reputation": 21, "user_id": 3677313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba5e3a0e5b1f6e1a67228ace9ea427?s=128&d=identicon&r=PG&f=1", "display_name": "Sebd77", "link": "https://stackoverflow.com/users/3677313/sebd77"}, "reply_to_user": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "edited": false, "score": 0, "creation_date": 1516888105, "post_id": 48427920, "comment_id": 83880204, "body": "[root@localhost pjsip]# make  cc -o myapp myapp.cpp <code>pkg-config --cflags --libs libpjproject</code>  cc: error: @PJ_INSTALL_CXXFLAGS@: The file or the directory does  not exist  cc: error: @PJ_LDXXLIBS@: The file or the directory does not exist  make: *** [myapp] Error 1"}, {"owner": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "edited": false, "score": 0, "creation_date": 1516900420, "post_id": 48427920, "comment_id": 83889335, "body": "The original question still contains non-English text."}], "owner": {"reputation": 21, "user_id": 3677313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba5e3a0e5b1f6e1a67228ace9ea427?s=128&d=identicon&r=PG&f=1", "display_name": "Sebd77", "link": "https://stackoverflow.com/users/3677313/sebd77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516813342, "creation_date": 1516813342, "question_id": 48427920, "link": "https://stackoverflow.com/questions/48427920/gcc-fails-to-compile-pjsip-2-7-1-sample-c-code", "title": "gcc fails to compile pjsip 2.7.1. sample c++ code", "body": "<p>I am trying to compile with the following Makefile the sample code pjsua2_demo.cpp (renamed as myapp.cpp), provided by pjsip project, however I get the follwoing errors:\nThe OS is Centos 7.. </p>\n\n<pre><code>[root@localhost pjsip]# make\ncc -o myapp myapp.cpp `pkg-config --cflags --libs libpjproject`\ncc: error: @PJ_INSTALL_CXXFLAGS@: No existe el fichero o el directorio\ncc: error: @PJ_LDXXLIBS@: No existe el fichero o el directorio\nmake: *** [myapp] Error 1\n\n\n   [root@localhost pjsip]# cat Makefile\n    # If your application is in a file named myapp.cpp or myapp.c\n    # this is the line you will need to build the binary.\n    all: myapp\n\n    myapp: myapp.cpp\n                $(CC) -o $@ $&lt; `pkg-config --cflags --libs libpjproject`\n\n    clean:\n                          rm -f myapp.o myapp\n    [root@localhost pjsip]# \n</code></pre>\n\n<p>I could not figure out the way to set these variables, I even tried with pkg_config, as some articles indicate, however it did not work.</p>\n\n<pre><code>[root@localhost pjsip]# pkg-config --cflags libpjproject\n@PJ_INSTALL_CXXFLAGS@ -I@INCLUDEDIR@  \n[root@localhost pjsip]# \n\n[root@localhost pjsip]# pkg-config --libs  libpjproject\n@PJ_LDXXLIBS@ -L@LIBDIR@  \n[root@localhost pjsip]# \n\n[root@localhost pjsip]# pkg-config --version\n0.27.1\n\n[root@localhost pjsip]# pkg-config --modversion libpjproject\n@PJ_VERSION@\n[root@localhost pjsip]# \n\n\n[root@localhost pjsip]# env|grep PKG\nPKG_CONFIG_PATH=/home/sd/Downloads/pjproject-2.7.1\n[root@localhost pjsip]# \n</code></pre>\n\n<p>Would you have any idea?\nOn the other hand, I followed the follwoing instructions to install pjsip, and I got some errors druing the 'make dep' command (I copied them below). Might this be a problem? I tried disabling the libyuv, however it didn't help. Thanks in advance</p>\n\n<pre><code>[root@localhost pjsip]# cd pjproject-2.7.1\n[root@localhost pjproject-2.7.1]# ./configure --enable-shared\n[root@localhost pjproject-2.7.1]# make dep\n[root@localhost pjproject-2.7.1]# make\n[root@localhost pjproject-2.7.1]# make install  \n\nmake[2]: Leaving directory `/home/sd/Downloads/pjproject-2.7.1/pjsip-apps/build'\nmake -f Samples.mak depend\nmake[2]: Entering directory `/home/sd/Downloads/pjproject-2.7.1/pjsip-apps/build'\nmake[2]: Nothing to be done for `depend'.\nmake[2]: Leaving directory `/home/sd/Downloads/pjproject-2.7.1/pjsip-apps/build'\nmake[1]: se sale del directorio `/home/sd/Downloads/pjproject-2.7.1/pjsip-apps/build'\n[root@localhost pjproject-2.7.1]# \n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 3, "creation_date": 1516813753, "post_id": 48427891, "comment_id": 83846387, "body": "<a href=\"http://en.cppreference.com/w/cpp/iterator/back_inserter\" rel=\"nofollow noreferrer\">std::back_inserter</a> does fine <a href=\"http://coliru.stacked-crooked.com/a/e3e8d813936600c0\" rel=\"nofollow noreferrer\">see example</a>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1516813778, "post_id": 48427891, "comment_id": 83846401, "body": "You don&#39;t need a cast to convert <code>int</code> to <code>double</code>. Just use <code>std::copy_if</code> with an ordinary insert iterator: <code>std::copy_if(std::begin(va), std::end(va), std::back_inserter(vb), valid);</code>."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1516814221, "post_id": 48427891, "comment_id": 83846698, "body": "Are you actually asking about <code>vector&lt;Base *&gt; base = ...; vector&lt;Derived *&gt; derived;</code>  and wanting a <code>copy_if_derived(base, inserter(derived))</code>?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1516816017, "post_id": 48427891, "comment_id": 83847764, "body": "&quot;int and double are just for illustration&quot; -- yes, and what they illustrate apparently is <b>not the actual question</b>. So the code in the question is <b>wrong</b>, and you need to fix it."}], "answers": [{"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 3, "last_activity_date": 1516814767, "creation_date": 1516814767, "answer_id": 48428347, "question_id": 48427891, "link": "https://stackoverflow.com/questions/48427891/define-custom-iterator-that-calls-function-to-passed-element/48428347#48428347", "title": "Define custom iterator that calls function to passed element", "body": "<p>I think you want boost's <a href=\"http://www.boost.org/doc/libs/1_66_0/libs/iterator/doc/html/iterator/specialized/function_output.html\" rel=\"nofollow noreferrer\"><code>function_output_iterator</code></a>. In your example it would be</p>\n\n<pre><code>auto cast_back_iterator = make_function_output_iterator([&amp;b](int i){ b.push_back(static_cast&lt;double&gt;(i)); });\nstd::copy_if(a.begin(), a.end(), cast_back_iterator, valid);\n</code></pre>\n\n<p>Which makes more sense when there isn't an implicit conversion between the two types, such as with <code>Base *</code> -> <code>Derived *</code> conversion</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1516816756, "post_id": 48428681, "comment_id": 83848218, "body": "Oops, just noticed that you cannot use boost."}, {"owner": {"reputation": 10897, "user_id": 179120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ac838f4dcaf02d4663451d9e7ba8932?s=128&d=identicon&r=PG", "display_name": "skeept", "link": "https://stackoverflow.com/users/179120/skeept"}, "edited": false, "score": 0, "creation_date": 1516826137, "post_id": 48428681, "comment_id": 83853281, "body": "Actually boost seems to have really cool things. I would be glad to use this if I could."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1516816660, "last_edit_date": 1516816660, "creation_date": 1516816032, "answer_id": 48428681, "question_id": 48427891, "link": "https://stackoverflow.com/questions/48427891/define-custom-iterator-that-calls-function-to-passed-element/48428681#48428681", "title": "Define custom iterator that calls function to passed element", "body": "<p>You can do filtering with <code>std::copy_if</code> and <code>std::back_inserter</code>:</p>\n\n<pre><code>std::vector&lt;double&gt; vc;\nstd::copy_if(va.begin(), va.end(), std::back_inserter(vc), valid);\n</code></pre>\n\n<p>Or use <a href=\"http://www.boost.org/doc/libs/1_65_1/libs/range/doc/html/range/reference/adaptors/reference/filtered.html\" rel=\"nofollow noreferrer\"><code>boost::range::adaptors::filtered</code></a> (same example problem as yours):</p>\n\n<pre><code>#include &lt;boost/range/adaptor/filtered.hpp&gt;\n#include &lt;boost/range/algorithm/copy.hpp&gt;\n\n#include &lt;vector&gt;\n\nbool valid(int i) { return i % 2 == 0;}\n\nint main() {\n    std::vector&lt;int&gt; va {1 ,2, 3};\n\n    using namespace boost::adaptors;\n    auto vb = boost::copy_range&lt;std::vector&lt;double&gt;&gt;(va | filtered(valid));\n}\n</code></pre>\n\n<p>Note that conversion of <code>int</code> to <code>double</code> is implicit and doesn't require a cast.</p>\n\n<p>If you do need a conversion, just throw in <a href=\"http://www.boost.org/doc/libs/1_65_1/libs/range/doc/html/range/reference/adaptors/reference/transformed.html\" rel=\"nofollow noreferrer\"><code>transformed</code></a>:</p>\n\n<pre><code>auto vb = boost::copy_range&lt;std::vector&lt;double&gt;&gt;(va\n    | filtered(valid)\n    | transformed([](int a) { return static_cast&lt;double&gt;(a); })\n    );\n</code></pre>\n"}], "owner": {"reputation": 10897, "user_id": 179120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ac838f4dcaf02d4663451d9e7ba8932?s=128&d=identicon&r=PG", "display_name": "skeept", "link": "https://stackoverflow.com/users/179120/skeept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1516816660, "creation_date": 1516813250, "last_edit_date": 1516815645, "question_id": 48427891, "link": "https://stackoverflow.com/questions/48427891/define-custom-iterator-that-calls-function-to-passed-element", "title": "Define custom iterator that calls function to passed element", "body": "<p>I am often writing code like the following (here int and double are just example, types are usually pointers)</p>\n\n<pre><code>std::vector&lt;int&gt; va {1 ,2, 3};\nstd::vector&lt;double&gt; vb;\n\nbool valid(int i) { return i % 2 == 0;}\n\nfor(auto a : va)\n   if (valid(a))\n      vb.push_back(static_cast&lt;double&gt;(a));\n</code></pre>\n\n<p>Since we don't have <code>transform_if</code> I would like to know if there is a way to do this by definining some special iterator:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct inserterStaticCast\n{\n    // not sure what to put here...\n}\n</code></pre>\n\n<p>Then I could write code like </p>\n\n<pre><code>std::vector&lt;double&gt; vc(a.size());\nstd::copy_if(a.begin(), a.end(), inserterStaticCast&lt;double&gt;(vc), &amp;valid);\n</code></pre>\n\n<p>I would also be interested in the <code>backInserterStaticCast</code> version.</p>\n\n<p>Is this possible in C++11?</p>\n\n<p>Thank you</p>\n\n<p>A few clarifications...</p>\n\n<p>I cannot use boost. And to again in this case int and double are just for illustration, in the general case I do need a cast, usually something like\n<code>static_cast&lt;derived *&gt;(base_ptr)</code>.</p>\n"}, {"tags": ["c++", "visual-c++", "template-meta-programming", "boost-mpl", "tag-dispatching"], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1516816412, "creation_date": 1516816412, "answer_id": 48428772, "question_id": 48427712, "link": "https://stackoverflow.com/questions/48427712/tag-dispatching-with-transformed-boostmplvectors/48428772#48428772", "title": "Tag dispatching with transformed `boost::mpl::vector`s", "body": "<blockquote>\n  <p>Is Boost.MPL inherently incompatible with variadic templates?</p>\n</blockquote>\n\n<p>Basically. <code>MPL</code> predates C++11, so to use MPL, you <em>need</em> to use their algorithms - so their Sequence concept with their Iterators, etc. There's almost certainly a really short, clever way to do this, but I can only ever find those out with guess and check.</p>\n\n<hr />\n\n<p>At least, if all you need to do is reverse, this is straightforward to implement in C++11:</p>\n\n<pre><code>template &lt;typename...&gt; struct typelist { };\n\ntemplate &lt;typename TL, typeanme R&gt;\nstruct reverse_impl;\n\ntemplate &lt;typename T, typename... Ts, typename... Us&gt;\nstruct reverse_impl&lt;typelist&lt;T, Ts...&gt;, typelist&lt;Us...&gt;&gt;\n: reverse_impl&lt;typelist&lt;Ts...&gt;, typelist&lt;Us..., T&gt;&gt;\n{ };\n\ntemplate &lt;typename... Us&gt;\nstruct reverse_impl&lt;typelist&lt;&gt;, typelist&lt;Us...&gt;&gt;\n{\n    using type = typelist&lt;Us...&gt;;\n};\n\ntemplate &lt;typename TL&gt;\nusing reverse = typename reverse_impl&lt;TL, typelist&lt;&gt;&gt;::type;\n</code></pre>\n\n<p>So given:</p>\n\n<pre><code>using InitOrder = typelist&lt;struct Foo, struct Bar, struct Baz&gt;;\n</code></pre>\n\n<p>Then <code>reverse&lt;InitOrder&gt;</code> would be <code>typelist&lt;struct Baz, struct Bar, struct Foo&gt;</code>, and so would be usable in the way you'd want.</p>\n"}], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 48428772, "answer_count": 1, "score": 1, "last_activity_date": 1516816412, "creation_date": 1516812668, "question_id": 48427712, "link": "https://stackoverflow.com/questions/48427712/tag-dispatching-with-transformed-boostmplvectors", "title": "Tag dispatching with transformed `boost::mpl::vector`s", "body": "<p>I am trying to tag-dispatch into a function with a reversed copy of a <code>boost::mpl::vector</code>:</p>\n\n<pre><code>using InitOrder = boost::mpl::vector&lt;\n    struct Foo,\n    struct Bar,\n    struct Baz\n&gt;;\n\ntemplate &lt;class... Stuff&gt;\nvoid initialize(boost::mpl::vector&lt;Stuff...&gt;) {\n    // Initialize in-order\n}\n\ntemplate &lt;class... Stuff&gt;\nvoid destroy(boost::mpl::vector&lt;Stuff...&gt;) {\n    // Exit in-order\n}\n\nvoid initializeAll() {\n    initialize(InitOrder{});\n}\n\nvoid destroyAll() {\n    destroy(typename boost::mpl::reverse&lt;InitOrder&gt;::type{});\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/a12d37844025ecda\" rel=\"nofollow noreferrer\">Coliru demo</a></p>\n\n<p>As you can see, the goal is to have two processes in <code>initialize</code> and <code>destroy</code> that have access to the <code>Stuff</code> pack. However, as answered <a href=\"https://stackoverflow.com/a/26683599/3233393\">here</a>, <code>boost::mpl::reverse&lt;InitOrder&gt;::type</code> is actually <em>not</em> a <code>boost::mpl::vector</code>, and the dispatching fails:</p>\n\n<pre>main.cpp:27:2: error: no matching function for call to 'destroy'\n        destroy(typename boost::mpl::reverse::type{});\n        ^~~~~~~\nmain.cpp:18:6: note: candidate template ignored: could not match 'vector' against 'v_item'\nvoid destroy(boost::mpl::vector) {\n     ^</pre>\n\n<ul>\n<li>How can I operate on a type list in both directions easily?</li>\n<li>Is Boost.MPL inherently incompatible with variadic templates?</li>\n</ul>\n\n<p>I can ditch Boost.MPL if needed, provided the alternative is standard or Boost. I'm using MSVC 14.1.</p>\n"}, {"tags": ["c++", "string", "erase", "letters"], "comments": [{"owner": {"reputation": 5631, "user_id": 1198321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f792e733fbf4e4edd6d64842093b7691?s=128&d=identicon&r=PG", "display_name": "lxop", "link": "https://stackoverflow.com/users/1198321/lxop"}, "edited": false, "score": 1, "creation_date": 1516812178, "post_id": 48427526, "comment_id": 83845335, "body": "Can you also state some example inputs with your desired output?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516812238, "post_id": 48427526, "comment_id": 83845367, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">Learn how to debug your programs</a> and it should become obvious."}, {"owner": {"reputation": 1706, "user_id": 1836030, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/WkH4g.png?s=128&g=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/1836030/scott"}, "edited": false, "score": 0, "creation_date": 1516812253, "post_id": 48427526, "comment_id": 83845379, "body": "Nice <code>return</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 5631, "user_id": 1198321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f792e733fbf4e4edd6d64842093b7691?s=128&d=identicon&r=PG", "display_name": "lxop", "link": "https://stackoverflow.com/users/1198321/lxop"}, "is_accepted": false, "score": 0, "last_activity_date": 1516812231, "creation_date": 1516812231, "answer_id": 48427583, "question_id": 48427526, "link": "https://stackoverflow.com/questions/48427526/terminate-called-after-throwing-an-instance-c-error/48427583#48427583", "title": "Terminate called after throwing an instance - C++ error?", "body": "<p>Your <code>return</code> is inside the loop - the loop will only run on the first character then return.</p>\n"}, {"tags": [], "owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "is_accepted": false, "score": 0, "last_activity_date": 1518176271, "last_edit_date": 1518176271, "creation_date": 1516828464, "answer_id": 48431698, "question_id": 48427526, "link": "https://stackoverflow.com/questions/48427526/terminate-called-after-throwing-an-instance-c-error/48431698#48431698", "title": "Terminate called after throwing an instance - C++ error?", "body": "<p>After the first <code>erase(i)</code> all the characters shift one left and the indices change. Instead of calling <code>s.erase(i+1)</code> you have to call again <code>s.erase(i)</code> to not try to access beyond the end of the string:</p>\n\n<pre><code>s.erase(i);\ns.erase(i);\n</code></pre>\n\n<p>or just <code>s.erase(i, 2)</code>.</p>\n"}], "owner": {"reputation": 5, "user_id": 9244865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffed4e4a2f7d11a2bb67c02cd22e084d?s=128&d=identicon&r=PG&f=1", "display_name": "P.Petrov", "link": "https://stackoverflow.com/users/9244865/p-petrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1518176271, "creation_date": 1516812055, "last_edit_date": 1516822743, "question_id": 48427526, "link": "https://stackoverflow.com/questions/48427526/terminate-called-after-throwing-an-instance-c-error", "title": "Terminate called after throwing an instance - C++ error?", "body": "<p>In this program I have a string which I pass as a parameter to a function. I want the function to erase all adjacent letters from a string containing only letters from a-z, always ordered alphabetically. For example if i enter aaabbccd, the program ought to output ad. I want to ask why the program stops working? </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\nvector&lt;char&gt; rez;\nstring reduce_string(string s)\n{\n    for(int i=0; i&lt;s.length()-1; i++)\n    {\n        if(s[i]==s[i+1])\n        {\n            s[i]=s[i+1]='0';\n            s.erase(i);\n            s.erase(i+1);\n        }\n\n    }\n    return s;\n}\nint main()\n{\n\n    string s;\n    cin &gt;&gt; s;\n    cout&lt;&lt;reduce_string(s);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 35, "user_id": 4622902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9Hi6.jpg?s=128&g=1", "display_name": "Subrata Das", "link": "https://stackoverflow.com/users/4622902/subrata-das"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516811770, "post_id": 48427265, "comment_id": 83845066, "body": "Sir i want like output both threading and my public function would be at a time run but it is first public function running then thread starting ."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 4, "creation_date": 1516811774, "post_id": 48427265, "comment_id": 83845068, "body": "There&#39;s a LOT of code here  - I would suggest that you trim it down to something minimal"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4622902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9Hi6.jpg?s=128&g=1", "display_name": "Subrata Das", "link": "https://stackoverflow.com/users/4622902/subrata-das"}, "edited": false, "score": 0, "creation_date": 1517149081, "post_id": 48480011, "comment_id": 83967416, "body": "Actually i wants to display loading busy gif animation while main gui thread is busy so that&#39;s why i have done worker thread but problem is that when i am calling worker thread ,first my main thread task is working then my worker thread is running ."}, {"owner": {"reputation": 149, "user_id": 5673090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UyHerFXAPk/AAAAAAAAAAI/AAAAAAABH_A/ZUUq_UaMMb4/photo.jpg?sz=128", "display_name": "Daniel Nicoletti", "link": "https://stackoverflow.com/users/5673090/daniel-nicoletti"}, "reply_to_user": {"reputation": 35, "user_id": 4622902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9Hi6.jpg?s=128&g=1", "display_name": "Subrata Das", "link": "https://stackoverflow.com/users/4622902/subrata-das"}, "edited": false, "score": 0, "creation_date": 1517200852, "post_id": 48480011, "comment_id": 83982027, "body": "That&#39;s what you think is happening because the way you are trying to see it happening, since the signals you emit are queued on the event loop queue, and you print the thread changed values from the main thread, but the main thread is busy and is not returning to the event loop to process each valueChanged() signal."}, {"owner": {"reputation": 35, "user_id": 4622902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9Hi6.jpg?s=128&g=1", "display_name": "Subrata Das", "link": "https://stackoverflow.com/users/4622902/subrata-das"}, "edited": false, "score": 0, "creation_date": 1517204133, "post_id": 48480011, "comment_id": 83982891, "body": "In this case what i have to do ?i had checked by while loop but same issues coming .can you edit my code ?"}, {"owner": {"reputation": 149, "user_id": 5673090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UyHerFXAPk/AAAAAAAAAAI/AAAAAAABH_A/ZUUq_UaMMb4/photo.jpg?sz=128", "display_name": "Daniel Nicoletti", "link": "https://stackoverflow.com/users/5673090/daniel-nicoletti"}, "reply_to_user": {"reputation": 35, "user_id": 4622902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9Hi6.jpg?s=128&g=1", "display_name": "Subrata Das", "link": "https://stackoverflow.com/users/4622902/subrata-das"}, "edited": false, "score": 0, "creation_date": 1517227827, "post_id": 48480011, "comment_id": 83995083, "body": "The code you pasted here should have a processEvents() on the while loop, but that loop is also too fast so you should also have some kind of sleep. Another option is to print a debug message before you emit the value."}], "tags": [], "owner": {"reputation": 149, "user_id": 5673090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UyHerFXAPk/AAAAAAAAAAI/AAAAAAABH_A/ZUUq_UaMMb4/photo.jpg?sz=128", "display_name": "Daniel Nicoletti", "link": "https://stackoverflow.com/users/5673090/daniel-nicoletti"}, "is_accepted": false, "score": 0, "last_activity_date": 1517083404, "creation_date": 1517083404, "answer_id": 48480011, "question_id": 48427265, "link": "https://stackoverflow.com/questions/48427265/how-to-run-thread-before-third-party-function-call-concurently/48480011#48480011", "title": "How to run thread before third party function call concurently?", "body": "<p>A few issues:</p>\n\n<ul>\n<li>You connect QThread::started to StartWork() <strong>after</strong> you started your thread, so it's likely that you miss the signal.</li>\n<li>Doing a while() loop of 1000 is something that is done in a very short time, so chances are that it will run before you get the chance to signal to the other thread.</li>\n<li>And the most important issue is that when you emit valueChanged() on the thread it will be queued to your main thread on myFunc().</li>\n</ul>\n\n<p>And you can always call QThread::currentThread() to see if it's running on the right thread, it's also UP to the OS to schedule your threads so expecting to see output from both threads is unlikely to happen at the same time the way you are trying to do.</p>\n"}], "owner": {"reputation": 35, "user_id": 4622902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9Hi6.jpg?s=128&g=1", "display_name": "Subrata Das", "link": "https://stackoverflow.com/users/4622902/subrata-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517083404, "creation_date": 1516811301, "last_edit_date": 1516819476, "question_id": 48427265, "link": "https://stackoverflow.com/questions/48427265/how-to-run-thread-before-third-party-function-call-concurently", "title": "How to run thread before third party function call concurently?", "body": "<p>I have made a worker thread task and another is my public third party function.\nI want to run both threading slot (e.g:StartWork())and my public function(e.g:on_pushButton_4_clicked()) concurrently, but they won't. Please give me any idea how to do that. here is my code:</p>\n\n<p>Mythread.cpp</p>\n\n<pre><code>#include \"mythread.h\"\n#include \"ui_mythread.h\"\nMythread::Mythread(QWidget *parent) :\n    QWidget(parent),\n    ui(new Ui::Mythread)\n{\n    ui-&gt;setupUi(this);\n    //Debug\n    this-&gt;dumpObjectInfo();\n    //myWorker-&gt;dumpObjectInfo();\n}\n\nMythread::~Mythread()\n{\n    myWorker-&gt;abort();\n    WorkerThread-&gt;wait();\n    qDebug()&lt;&lt;\"Deleting thread and worker in Thread \"&lt;&lt;this-&gt;QObject::thread()-&gt;currentThreadId();\n    delete WorkerThread;\n    delete myWorker;\n    delete ui;\n}\nvoid Mythread::on_pushButton_2_clicked()\n{\n    qDebug() &lt;&lt; \"stopwork signal emmitted\";\n    emit stopWorkSignal();\n}\n\nvoid Mythread::on_pushButton_4_clicked()\n{\n    myWorker = new worker;\n    WorkerThread = new QThread;\n    myWorker-&gt;moveToThread(WorkerThread);\n    WorkerThread-&gt;start();\n\n    connect(myWorker, SIGNAL(valueChanged(QString)),this, SLOT(myfunc(QString)));\n    connect(WorkerThread, SIGNAL(started()), myWorker, SLOT(StartWork()));\n    connect(this, SIGNAL(stopWorkSignal()), myWorker, SLOT(abort()));\n    qDebug()&lt;&lt;\"inside work\";\n    int i =0;\n    while (i&lt;1000)\n    {\n    qDebug()&lt;&lt;\":count *i=========&gt;\"&lt;&lt;i;\n    i++;\n    }\n    return;\n}\n\nvoid Mythread::myfunc(QString s)\n{\n    qDebug()&lt;&lt;\"thread TXT\"&lt;&lt;s;\n    //\n    ui-&gt;label-&gt;setText(s);\n}\n</code></pre>\n\n<p>worker.cpp</p>\n\n<pre><code>#include \"worker.h\"\n#include&lt;QDebug&gt;\n#include&lt;mythread.h&gt;\n\nworker::worker(QObject *parent) :\n    QObject(parent)\n{\n    _working =false;\n    _abort = false;\n}\n\nvoid worker::do_Work()\n{\n    qDebug() &lt;&lt; \"inside do Work\";\n    qDebug()&lt;&lt;\"Starting worker process in Thread   \"&lt;&lt;thread()-&gt;currentThreadId();\n    for (int i = 1; i&lt;100; i ++) {\n    // Checks if the process should be aborted\n    mutex.lock();\n    bool abort = _abort;\n    mutex.unlock();\n    if (abort) {\n        qDebug()&lt;&lt;\"Aborting worker process in Thread \"&lt;&lt;thread()-&gt;currentThreadId();\n        break;\n    }\n\n    // This will stupidly wait 1 sec doing nothing...\n    QEventLoop loop;\n    loop.processEvents(QEventLoop::AllEvents);\n    QTimer::singleShot(100, &amp;loop, SLOT(quit()));\n    loop.exec();\n\n     //Once we're done waiting, value is updated\n    emit valueChanged(QString(\"%1\").arg(i++));\n    }\n\n    mutex.lock();\n    _working = false;\n    mutex.unlock();\n\n    qDebug()&lt;&lt;\"Worker process finished in Thread \"&lt;&lt;thread()-&gt;currentThreadId();\n    emit finished();\n}\n\n\nvoid worker::abort()\n{\n    qDebug()&lt;&lt;\"Stop Thread\";\n    mutex.lock();\n    if (_working) {\n    _abort = true;\n    qDebug()&lt;&lt;\"Request worker aborting in Thread \"&lt;&lt;thread()-&gt;currentThreadId();\n    }\n    mutex.unlock();\n    emit finished();\n    //lbl-&gt;close();\n    //lbl-&gt;deleteLater();\n}\nvoid worker::StartWork()\n{\n    qDebug() &lt;&lt; \"inside StartWork\";\n    _working = true;\n    _abort = false;\n\n    //emit running();\n    do_Work();\n}\n</code></pre>\n\n<p>output coming like this:</p>\n\n<pre><code>  :count *i=========&gt; 988 \n  :count *i=========&gt; 989 \n  :count *i=========&gt; 990 \n  :count *i=========&gt; 991 \n  :count *i=========&gt; 992 \n\n thread TXT \"1\" \n thread TXT \"3\" \n thread TXT \"5\" \n thread TXT \"7\" \n</code></pre>\n"}, {"tags": ["c++", "linux", "fork"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516811427, "post_id": 48427197, "comment_id": 83844823, "body": "Have I got this right?  The sequence is:  A starts; B starts; A ends (leaving B an orphan); A restarts.  At this point you do <i>not</i> want B to be started again."}, {"owner": {"reputation": 2340, "user_id": 927438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mB0T5.jpg?s=128&g=1", "display_name": "NadavRub", "link": "https://stackoverflow.com/users/927438/nadavrub"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516811474, "post_id": 48427197, "comment_id": 83844855, "body": "Yup, U got it right"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 2, "creation_date": 1516811543, "post_id": 48427197, "comment_id": 83844907, "body": "Make B create a named pipe like <code>mkfifo(&quot;&#47;tmp&#47;singleton&quot;, 0666)</code>, if this command fails is because the pipe already exists meaning you already have a process B running."}, {"owner": {"reputation": 2340, "user_id": 927438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mB0T5.jpg?s=128&g=1", "display_name": "NadavRub", "link": "https://stackoverflow.com/users/927438/nadavrub"}, "edited": false, "score": 0, "creation_date": 1516811612, "post_id": 48427197, "comment_id": 83844954, "body": "So in a way w/ this approach, &#39;B&#39; is always created but quickly dies if the pipe already exist, right ?"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1516811645, "post_id": 48427197, "comment_id": 83844981, "body": "Well you can check if the pipe exists before forking too if you want. I suppose this would be faster."}, {"owner": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1516811676, "post_id": 48427197, "comment_id": 83844994, "body": "@Havenard Why a fifo?  More typical would be a directory (which also has atomic create-or-fail semantics) or a file with a set lock."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "edited": false, "score": 1, "creation_date": 1516811706, "post_id": 48427197, "comment_id": 83845019, "body": "@Alfe Because it disappears by itself if the process dies."}, {"owner": {"reputation": 449, "user_id": 9131933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272423f6785184b9d180ef6a5bd16504?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/9131933/newbie"}, "edited": false, "score": 0, "creation_date": 1516811733, "post_id": 48427197, "comment_id": 83845041, "body": "<a href=\"https://stackoverflow.com/questions/6898337/determine-programmatically-if-a-program-is-running\" title=\"determine programmatically if a program is running\">stackoverflow.com/questions/6898337/&hellip;</a>"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1516811896, "post_id": 48427197, "comment_id": 83845147, "body": "@Havenard : If the FIFO disappears by itself when the creating process dies, you absolutely need process B to create the FIFO (because otherwise the first time A dies, it will take the FIFO with it).  You <i>could</i> check before the <code>fork</code> <i>as well</i>, but that only optimizes start-up for not much benefit.   If process B does an <code>exec</code>, there is no reason not to create the FIFO in the child process, but before the <code>exec</code>."}, {"owner": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1516811898, "post_id": 48427197, "comment_id": 83845149, "body": "@Havenard How come you think that?  The fifo lingers on the file system like any other file after the process terminates.  I just tested on my system to make sure my knowledge wasn&#39;t outdated."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "edited": false, "score": 0, "creation_date": 1516838383, "post_id": 48427197, "comment_id": 83858598, "body": "@Alfe Sorry, it disposes of itself after it is no longer attached to any input. Indeed, just creating the fifo is not enough, you have to <code>fopen()</code> it too with <code>w</code> mode. Once you close this handle the fifo disappears. Gotta do some testing that right now I don&#39;t have the time to, but pretty sure that&#39;s the way. Also because it&#39;s not a real file it doesn&#39;t mess with the hard drive, so there&#39;s that advantage over doing it with files."}, {"owner": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "edited": false, "score": 0, "creation_date": 1516877977, "post_id": 48427197, "comment_id": 83873576, "body": "I have to disappoint you concerning hard drive:  It <i>is</i> a directory entry which is stored on the hard drive.  It is also kept over reboots, and when you unplug the drive and attach it to another computer you can see it there.  Opening the fifo in &#39;w&#39; mode hangs until some else opens it for reading; you can avoid that using async io, but in any case, termination of the process <b><i>does not</i></b> remove the fifo from the file system."}, {"owner": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1516878139, "post_id": 48427197, "comment_id": 83873691, "body": "@Havenard Maybe your idea derives from using sockets.  These are really not on any file system and will disappear as soon as the process is gone.  But you wouldn&#39;t make them using <code>mkfifo()</code>."}], "owner": {"reputation": 2340, "user_id": 927438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mB0T5.jpg?s=128&g=1", "display_name": "NadavRub", "link": "https://stackoverflow.com/users/927438/nadavrub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516811539, "creation_date": 1516811100, "last_edit_date": 1516811539, "question_id": 48427197, "link": "https://stackoverflow.com/questions/48427197/optimal-forking-approach-when-child-is-running-24x7-and-parent-constantly-restar", "title": "Optimal forking approach when child is running 24x7 and parent constantly restart", "body": "<h2>Environment</h2>\n\n<ul>\n<li>Ubuntu 16.04</li>\n<li>C++</li>\n</ul>\n\n<h2>Use-case</h2>\n\n<ul>\n<li>Process A, constantly starting and stopping</li>\n<li>B, a Child process of A, forked only once and is running 24x7</li>\n<li>In other words: A starts, spawns B, A dies ( B orphan ), A start again ( at this point I don;t want B to be spawned again )</li>\n</ul>\n\n<h2>Problem at hand</h2>\n\n<p>How can I make sure that only a single instance of process B is being created, that is, although process A constantly start and stop.</p>\n"}, {"tags": ["c++", "oop", "class-design"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516811205, "post_id": 48427061, "comment_id": 83844669, "body": "Questions about design and architecture are (a bit) off-topic for SO format."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1516811405, "post_id": 48427061, "comment_id": 83844797, "body": "If your algorithm classes have methods that expect THE SAME arguments, you can use templates. Why you cannot have the same base for all algorithms?"}, {"owner": {"reputation": 1074, "user_id": 1910621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/49396e91640467667f9d4cfa339aed82?s=128&d=identicon&r=PG", "display_name": "TheBlueNotebook", "link": "https://stackoverflow.com/users/1910621/thebluenotebook"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516811622, "post_id": 48427061, "comment_id": 83844965, "body": "@Ron Should I move this elsewhere?"}, {"owner": {"reputation": 1074, "user_id": 1910621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/49396e91640467667f9d4cfa339aed82?s=128&d=identicon&r=PG", "display_name": "TheBlueNotebook", "link": "https://stackoverflow.com/users/1910621/thebluenotebook"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1516811624, "post_id": 48427061, "comment_id": 83844966, "body": "@Ptaq666 The library was written by someone else and I do not have the option of editing that right now. Also, the methods in algorithm class might have different arguments."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516811683, "post_id": 48427061, "comment_id": 83844998, "body": "@TheBlueNotebook I guess Software Engineering SE or Computer Science SE would be a better match."}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516813780, "post_id": 48427061, "comment_id": 83846403, "body": "@Ron when referring other sites, it is often helpful to point that <a href=\"https://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "edited": false, "score": 0, "creation_date": 1516813841, "post_id": 48427061, "comment_id": 83846458, "body": "@gnat Indeed. I left it out in this case given the OP&#39;s reputation and badges."}], "answers": [{"tags": [], "owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "is_accepted": false, "score": 1, "last_activity_date": 1516812746, "creation_date": 1516812746, "answer_id": 48427737, "question_id": 48427061, "link": "https://stackoverflow.com/questions/48427061/how-to-design-a-class-with-methods-which-have-similar-functions-but-different-si/48427737#48427737", "title": "How to design a class with methods which have similar functions but different signatures", "body": "<p>According to the comments under the question, I think in this case this is the only reasonable approach:</p>\n\n<pre><code>// structure of all possible arguments to all your algorithms\nstruct AlgorithmArgs {\n    int arg1;\n    int arg2;  // etc ...\n}\n\nclass AlgorithmWrapper {\npublic:\n    AlgorithmWrapper(int algorithmId, const AlgorithmArgs args) {\n        if (algorithmId == 1) {\n            algorithm_ = Algorithm1{};  // or whatever you do to construct that Algorithm1 object\n        } else if ( /* etc ... */ ) {}\n    }\n\n    void someMethodToUnifyAllAlgorithmInterfaces1();\n    void someMethodToUnifyAllAlgorithmInterfaces2();\n    void someMethodToUnifyAllAlgorithmInterfaces3();\n\nprivate:\n    std::variant&lt;Algorithm1, Algorithm2, Algorithm3&gt; algorithm_;\n};\n\ntaskAlgorithm::taskAlgorithm(int algorithmCode, int argument1){\n    AlgorithmArgs args;\n    args.arg1 = argument1;\n    algorithmWrapperPtr_ = new AlgorithmWrapper(algorithmCode, args);\n\n    executeSomeUnifiedProcedureCommonForAllAlgorithms();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "is_accepted": true, "score": 2, "last_activity_date": 1516835278, "last_edit_date": 1516835278, "creation_date": 1516813126, "answer_id": 48427847, "question_id": 48427061, "link": "https://stackoverflow.com/questions/48427061/how-to-design-a-class-with-methods-which-have-similar-functions-but-different-si/48427847#48427847", "title": "How to design a class with methods which have similar functions but different signatures", "body": "<p>If they are related algorithms, perhaps you can think of the \"common\" interface that, if it existed, would be capable of calling into any of the algorithms if you knew which parts to use, or which transformations to perform.</p>\n\n<p>This would allow you to write a wrapper interface to all the algorithms, so they can be called uniformly.  Each wrapper could \"know\" how to take its inputs to call the underlying algorithm that it wraps.  I didn't do it here, but you could do the same for the return value.</p>\n\n<p>For example Algorithm A is a sort taking a pair of iterators into a vector of ints, and a comparator, while Algorithm B is a different kind of sort, taking a pointer to an int array, a length, and a comparator.</p>\n\n<pre><code>class Algo {\npublic:\n    using Iter = std::vector&lt;int&gt;::iterator;\n    using Compare = ...;\n    virtual void call(Iter b, Iter e, Compare comp) = 0;\n    virtual ~Algo() = default;\n};\n\nclass A : public Algo {\n    void call(Iter b, Iter e, Compare comp) override {\n      algorithmA(b, e, comp);\n    }\n};\n\nclass B : public Algo {\n    void call(Iter b, Iter e, Compare comp) override {\n        if (b != e) {\n            algorithmB(&amp;*b, std::distance(b, e), comp);\n        }\n    }\n};\n</code></pre>\n\n<p>Now you can wrap algorithm A with class A, and algorithm b with class B, and they are invoked identically, and the wrappers share a common base class so they can be used polymorphicly.</p>\n\n<p>Of course, you can't templatize virtual functions so the iterator type is fixed, but the example here is about making a wrapper hierarchy that normalizes the interface to the algorithms.  Then you can avoid a nasty switch statement (which requires editing working code every time you add a new algorithm.)  With a class wrapper approach, just wrap new algorithm with a new wrapper class and it should just fit into any system that already works with the existing algorithms (provided you don't change the signature of the virtual call() function).</p>\n\n<p>This isn't exactly answering your question but I think it's close enough to maybe be useful.  :)</p>\n"}], "owner": {"reputation": 1074, "user_id": 1910621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/49396e91640467667f9d4cfa339aed82?s=128&d=identicon&r=PG", "display_name": "TheBlueNotebook", "link": "https://stackoverflow.com/users/1910621/thebluenotebook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "closed_date": 1516822258, "accepted_answer_id": 48427847, "answer_count": 2, "score": 1, "last_activity_date": 1516835278, "creation_date": 1516810671, "question_id": 48427061, "link": "https://stackoverflow.com/questions/48427061/how-to-design-a-class-with-methods-which-have-similar-functions-but-different-si", "closed_reason": "Needs more focus", "title": "How to design a class with methods which have similar functions but different signatures", "body": "<p>The task I have at hand is to write a system to test out <code>n</code> different algorithms in a library - all doing the same broad task but with different methodologies. I thought about creating a <code>main</code> class to which I send an argument defining the algorithm to be used. This <code>main</code> class in-turn calls the <code>taskAlgorithm</code> class passing on the parameter to be used and the required input parameters for the algorithm to be used. The <code>taskAlgorithm</code> class should then instantiate the specific algorithm class to be used in its constructor. <code>taskAlgorithm::Process</code> should run the algorithm and store the result and <code>taskAlgorithm::Result</code> should return the result. </p>\n\n<p>I am stuck on figuring out how to write this <code>taskAlgorithm</code> class. In the constructor of this class, based on the <code>algorithmCode</code> parameter I want to instantiate an object of the specific algorithm, however, all algorithm classes are different and do not necessarily have a common base class. What's the best way to tackle this problem?</p>\n\n<p>Specifically in</p>\n\n<pre><code>taskAlgorithm::taskAlgorithm(int algorithmCode, int argument1){\n   if(algorithmCode == 1){\n      //instantiate the algorithm1 object\n   }\n   else if(algorithmCode == 2){\n      //instantiate algorithm2 object\n   }\n}\n</code></pre>\n\n<p>how should I instantiate objects for each of different algorithm classes if they don't necessarily share a common base class?</p>\n"}, {"tags": ["c++", "opencv", "perspective"], "comments": [{"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516811598, "post_id": 48426835, "comment_id": 83844947, "body": "As can be seen in the image, the straight red line does not pass through the middle of extreme contours. Also my contour areas are not even/uniform for the ones I expect."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516855139, "post_id": 48431823, "comment_id": 83862838, "body": "I would like to avoid using camera calibration or the intrinsic parameters.  Like i mentioned before, the TL and BR are not straight. Is it possible to straighten them based on some parameters?"}, {"owner": {"reputation": 1326, "user_id": 2518618, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6d3411b164af7bf0550b27b720755fd?s=128&d=identicon&r=PG", "display_name": "user2518618", "link": "https://stackoverflow.com/users/2518618/user2518618"}, "reply_to_user": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516856452, "post_id": 48431823, "comment_id": 83863232, "body": "I would draw quad_pts on your original pre-transformed image and see what contour has found. As the edges of the rectangle in the image are not straight (they are kind of round or wavy), the quad that it finds may have a small error of 1 or 2 pixels, which is enough  for causing the error that you notice in the output,"}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516858366, "post_id": 48431823, "comment_id": 83863777, "body": "Added corner_0.png to the original post. You are right that the lines are wavy, could MatSize play a role in final transformation (basically pixel ratio)?"}, {"owner": {"reputation": 1326, "user_id": 2518618, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6d3411b164af7bf0550b27b720755fd?s=128&d=identicon&r=PG", "display_name": "user2518618", "link": "https://stackoverflow.com/users/2518618/user2518618"}, "reply_to_user": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516878699, "post_id": 48431823, "comment_id": 83874032, "body": "ApproxPolyDP is not locating the corners accurately because they look rounded in your image, maybe they are just blurred. If a corner is round, the function picks one of those pixels, and it is not picking the central one. You should print a square with sharper corners (not rounded). Another option is locating the corners with a more complex algorithm, for example finding the sides with the Hough Transform and then calculating the intersection of the lines (this would be more precise as the corners would have decimal precision)"}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516889459, "post_id": 48431823, "comment_id": 83881268, "body": "Thanks @user2518618, this could be the reason. Will try your suggestion.  Was trying something more complex like calculate median center (TL-BR and TR-BL), and then computing the transformation points off that, but still notice a skew."}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516891247, "post_id": 48431823, "comment_id": 83882594, "body": "Changed the inner contour to square, quite visible that the edges are not being detected correctly (new square corner link in original post). Any suggestion to improve on approxPolyDP?"}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516891779, "post_id": 48431823, "comment_id": 83882992, "body": "One issue that I notice is that I am using Point for edge detection from approxPolyDP, while I use float in the rest of the places. The edge seems to have improved after using vector&lt;Point2f&gt; contours_poly(1). The blurriness of edges is having an impact, not sure if switching to threshold/canny image will help."}, {"owner": {"reputation": 1326, "user_id": 2518618, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6d3411b164af7bf0550b27b720755fd?s=128&d=identicon&r=PG", "display_name": "user2518618", "link": "https://stackoverflow.com/users/2518618/user2518618"}, "reply_to_user": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516913913, "post_id": 48431823, "comment_id": 83896529, "body": "After you have roughly located the corners, maybe you can use cornersubpix <a href=\"https://docs.opencv.org/2.4/doc/tutorials/features2d/trackingmotion/corner_subpixeles/corner_subpixeles.html\" rel=\"nofollow noreferrer\">docs.opencv.org/2.4/doc/tutorials/features2d/trackingmotion/&zwnj;&#8203;&hellip;</a> to improve the location"}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1516980417, "post_id": 48431823, "comment_id": 83921999, "body": "Thanks @user2518618,  Currently improved the edge detection by adjusting threshold parameters. Also switched from medianBlur to GaussianBlur. Will try out your suggestion as well, but figured the amount of points in Contours stored will be key to finer detection. Currently 480x640 pixels to avoid hitting processing performance."}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1517060569, "post_id": 48431823, "comment_id": 83945894, "body": "I was able to use your suggestion on cornerSubPix (ref: [link] (<a href=\"https://i.stack.imgur.com/p9T6k.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/p9T6k.png</a>) here to arrive very close. The final transformation is not shaping up perfectly, but that is probably the maths that need to be tweaked. I had to use a mask to avoid detection corners anywhere in the image, which included masking the contour outside(with threshold) as well as inside. Really appreciate your help. Final transformation still has a skew of around 0.5 degree across."}, {"owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "edited": false, "score": 0, "creation_date": 1517064938, "post_id": 48431823, "comment_id": 83947137, "body": "Would you mind taking a look at this question - <a href=\"https://stackoverflow.com/questions/48429502/opencv-optimized-shared-library-for-android\" title=\"opencv optimized shared library for android\">stackoverflow.com/questions/48429502/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1326, "user_id": 2518618, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6d3411b164af7bf0550b27b720755fd?s=128&d=identicon&r=PG", "display_name": "user2518618", "link": "https://stackoverflow.com/users/2518618/user2518618"}, "is_accepted": true, "score": 1, "last_activity_date": 1517006019, "last_edit_date": 1517006019, "creation_date": 1516829025, "answer_id": 48431823, "question_id": 48426835, "link": "https://stackoverflow.com/questions/48426835/perspective-transformation-for-birds-eye-view-opencv-c/48431823#48431823", "title": "Perspective Transformation for bird&#39;s eye view opencv c++", "body": "<p>Your original pre-transformation image is not so good, the squares have different sizes there and it looks wavy. The results you get are quite good given the quality of your input.</p>\n\n<p>You could try to calibrate your camera (<a href=\"https://docs.opencv.org/2.4/doc/tutorials/calib3d/camera_calibration/camera_calibration.html\" rel=\"nofollow noreferrer\">https://docs.opencv.org/2.4/doc/tutorials/calib3d/camera_calibration/camera_calibration.html</a>) to compensate lens distortion, and your results may improve.</p>\n\n<p>EDIT: Just to summarize the comments below, approxPolyDp may not locate the corners properly if the square has rounded corners or it is blurred. You may need to improve the corner location by other means such as a sharper original image, different preprocessing (median filter or threshold, as you suggest in the comments), or other algorithms for finer corner location (such as using the cornersubpix function or detecting the sides with Hough Transform and then calculating the intersections of them)</p>\n"}], "owner": {"reputation": 145, "user_id": 3722796, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e133ba08f993805956a5184c87a73e1?s=128&d=identicon&r=PG&f=1", "display_name": "banerjk", "link": "https://stackoverflow.com/users/3722796/banerjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "accepted_answer_id": 48431823, "answer_count": 1, "score": 0, "last_activity_date": 1517060317, "creation_date": 1516810072, "last_edit_date": 1517060317, "question_id": 48426835, "link": "https://stackoverflow.com/questions/48426835/perspective-transformation-for-birds-eye-view-opencv-c", "title": "Perspective Transformation for bird&#39;s eye view opencv c++", "body": "<p>I am interested in perspective transformation to bird's eye view. So far I have tried getPerspectiveTransform and findHomography and then passing it onto warpPerspective. The results are quite close but a skew in TL and BR is present. Also the contourArea are not translated equally post transformation.</p>\n\n<p>The contour is a square with multiple shapes inside.</p>\n\n<p>Any suggestion on how to go ahead.</p>\n\n<p>Code block of what I have done so far.</p>\n\n<pre><code>    std::vector&lt;Point2f&gt; quad_pts;\n    std::vector&lt;Point2f&gt; squre_pts;    \n\n    cv::approxPolyDP( Mat(validContours[largest_contour_index]), contours_poly[0], epsilon, true );\n\n    if (approx_poly.size() &gt; 4) return false;\n\n    for (int i=0; i&lt; 4; i++)\n            quad_pts.push_back(contours_poly[0][i]);\n\n    if (! orderRectPoints(quad_pts))\n            return false;\n\n    float widthTop = (float)distanceBetweenPoints(quad_pts[1], quad_pts[0]); // sqrt( pow(quad_pts[1].x - quad_pts[0].x, 2) + pow(quad_pts[1].y - quad_pts[0].y, 2));\n    float widthBottom = (float)distanceBetweenPoints(quad_pts[2], quad_pts[3]); // sqrt( pow(quad_pts[2].x - quad_pts[3].x, 2) + pow(quad_pts[2].y - quad_pts[3].y, 2));\n\n    float maxWidth = max(widthTop, widthBottom);\n\n    float heightLeft = (float)distanceBetweenPoints(quad_pts[1], quad_pts[2]); // sqrt( pow(quad_pts[1].x - quad_pts[2].x, 2) + pow(quad_pts[1].y - quad_pts[2].y, 2));\n    float heightRight = (float)distanceBetweenPoints(quad_pts[0], quad_pts[3]); // sqrt( pow(quad_pts[0].x - quad_pts[3].x, 2) + pow(quad_pts[0].y - quad_pts[3].y, 2));\n\n    float maxHeight = max(heightLeft, heightRight);\n    int mDist = (int)max(maxWidth, maxHeight);\n\n    // transform TO points\n    const int offset = 50;\n    squre_pts.push_back(Point2f(offset, offset));\n    squre_pts.push_back(Point2f(mDist-1, offset));\n    squre_pts.push_back(Point2f(mDist-1, mDist-1));\n    squre_pts.push_back(Point2f(offset, mDist-1));\n\n    maxWidth += offset; maxHeight += offset;\n    Size matSize ((int)maxWidth, (int)maxHeight);\n\n    Mat transmtx = getPerspectiveTransform(quad_pts, squre_pts);\n   //  Mat homo = findHomography(quad_pts, squre_pts);\n    warpPerspective(mRgba, mRgba, transmtx, matSize);\n    return true;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/x1JJn.png\" rel=\"nofollow noreferrer\">Link to transformed image</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/IqCg6.png\" rel=\"nofollow noreferrer\">Image pre-transformation</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/o0ZzI.png\" rel=\"nofollow noreferrer\">corner on pre-transformed image</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/p9T6k.png\" rel=\"nofollow noreferrer\">Corners from CornerSubPix</a></p>\n"}, {"tags": ["c++", "multithreading", "web-services", "wcf", "c++-cli"], "comments": [{"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1516810215, "post_id": 48426777, "comment_id": 83843928, "body": "What is the scope of leaking ? global ? Is it ever assigned something else, like null? Is the thread killed without the shared_ptr being assigned something else?"}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "reply_to_user": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1516810303, "post_id": 48426777, "comment_id": 83844000, "body": "Yes it is leaking globally. It is only assigned once: At initialisation. i don&#39;t manually kill the thread as it is managed by WCF. I would be suprised if WCF killed the thread but it is defnitely something I can check !"}, {"owner": {"reputation": 488, "user_id": 7384437, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/386e2d14621537e11c4790308b91dbd0?s=128&d=identicon&r=PG&f=1", "display_name": "lars", "link": "https://stackoverflow.com/users/7384437/lars"}, "edited": false, "score": 0, "creation_date": 1516814197, "post_id": 48426777, "comment_id": 83846680, "body": "Having a <code>thread_local shared_ptr&lt;&gt;</code> in a simple console app makes the program crash instantly.  The thread_local variable is in a method <code>void Run()</code> in a static c++ library. A C++/CLI console program links against this static library and calls <code>Run()</code>.  A reproducable example would be nice."}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516818916, "post_id": 48426777, "comment_id": 83849379, "body": "As said earlier the c++/cli part is only a stub. It calls a function defined in a a native dll (compiled without /clr) which allocates the thread_local variable"}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1517018010, "post_id": 48426777, "comment_id": 83937676, "body": "Here is a simple project to reproduce the problem <a href=\"https://github.com/elmadj/LeakingServer.git\" rel=\"nofollow noreferrer\">github.com/elmadj/LeakingServer.git</a> After building the project, you just need to start the WCFServer application call the two methods of the service (DoWork and StopServer)"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 1, "creation_date": 1516810681, "post_id": 48426945, "comment_id": 83844280, "body": "Well the object held by a std::shared_ptr is also destroyed when the last remaining shared_ptr owning the object is destroyed.  <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/shared_ptr</a>.  thread_local variables should go out of scope and be destroyed when the thread ends so why is my std:shared_ptr not destroyed ?"}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516811254, "post_id": 48426945, "comment_id": 83844708, "body": "Depends how cleanly the thread ends. See edit for reproducing something similar in non-MS specific C++11"}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516815611, "post_id": 48426945, "comment_id": 83847538, "body": "The thread seems to exit normally (exit code 0). I checked by tracing the native thread id right after the variable is allocated. and comparing it to the debugger&#39;s output which shows the exit codes for all threads"}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516819169, "post_id": 48426945, "comment_id": 83849525, "body": "we tried compiling your code. It does not leak. This beahviour is expected since the documentation for thread::detach says : &quot;Separates the thread of execution from the thread object, allowing execution to continue independently. Any allocated resources will be freed once the thread exits. &quot;"}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 1, "last_activity_date": 1516811190, "last_edit_date": 1516811190, "creation_date": 1516810374, "answer_id": 48426945, "question_id": 48426777, "link": "https://stackoverflow.com/questions/48426777/leaking-stdshared-ptr-thread-local-variable-in-c-c-cli-environment/48426945#48426945", "title": "Leaking std::shared_ptr thread_local variable in C++ - C++/CLI environment", "body": "<p>A shared_ptr is not a magic bullet. It will only delete its content when it is assigned something else. From your comments, it seems you keep it forever, once assigned. As such, it will not delete the object, by design.</p>\n\n<p>The scenario I imagine is the same as:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nclass Foo\n{\npublic:\n    ~Foo() { std::cout &lt;&lt; \"Deleted\" &lt;&lt; std::endl;}\n};\n\nthread_local std::shared_ptr&lt;Foo&gt; f;\n\nvoid t()\n{\n    f = std::shared_ptr&lt;Foo&gt;(new Foo);\n}\n\nint main()\n{\n    std::thread thread(t);\n    thread.detach();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1516813497, "post_id": 48427421, "comment_id": 83846244, "body": "I assume WCF does not kill the thread at all. Most probably it allocates a thread pool and calls your thread function in a thread from a pool."}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "reply_to_user": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516813568, "post_id": 48427421, "comment_id": 83846276, "body": "@elmadj I have quoted the most modern draft 4659 that I have. 3.7.2 was from the older draft 3337."}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516813591, "post_id": 48427421, "comment_id": 83846287, "body": "As I said in my question I enumerate the process threads right before exit. Only the mainthread remains."}, {"owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "edited": false, "score": 0, "creation_date": 1516814816, "post_id": 48427421, "comment_id": 83847080, "body": ":) sorry I didn&#39;t check the version on the draft I used !"}], "tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1516812876, "last_edit_date": 1592644375, "creation_date": 1516811758, "answer_id": 48427421, "question_id": 48426777, "link": "https://stackoverflow.com/questions/48426777/leaking-stdshared-ptr-thread-local-variable-in-c-c-cli-environment/48427421#48427421", "title": "Leaking std::shared_ptr thread_local variable in C++ - C++/CLI environment", "body": "<blockquote>\n<p><strong>6.7.2 Thread storage duration.</strong></p>\n<p>All variables declared with the <strong>thread_local</strong> keyword have <em>thread storage duration</em>. The storage for these entities shall last for the duration of the thread in which they are created. There is a distinct object or reference per thread, an use  of the declared name refers to the entity associated with the current thread.</p>\n<p>A variable with the <strong>storage duration</strong> shall be initialized before its first odr-use (6.2) and, if constructed, shall be destroyed on thread exit.</p>\n</blockquote>\n"}], "owner": {"reputation": 27, "user_id": 1704574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89325e7177943014054e4f6ab6c1802e?s=128&d=identicon&r=PG", "display_name": "elmadj", "link": "https://stackoverflow.com/users/1704574/elmadj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516893555, "creation_date": 1516809914, "last_edit_date": 1516893555, "question_id": 48426777, "link": "https://stackoverflow.com/questions/48426777/leaking-stdshared-ptr-thread-local-variable-in-c-c-cli-environment", "title": "Leaking std::shared_ptr thread_local variable in C++ - C++/CLI environment", "body": "<p>So I have this WCF webservice server where one of my webservices is written in C++/CLI. The webservice method is only a stub. It is used to call native C++ useful code.</p>\n\n<p>In the useful C++ code, I have this thread_local std::shared_ptr variable. It is allocated in a method called by the web service.</p>\n\n<pre><code>thread_local std::shared_ptr&lt;MyClass&gt; leaking(new MyClass());\n</code></pre>\n\n<p>The problem is: my variable is never deallocated. The destructor is never called. \nI am compiling my code using Microsoft C++ 14.0 64-bit compiler.</p>\n\n<p><strong>My question is : Is there some weird limitation with thread_local support and the Microsoft compiler ?</strong> </p>\n\n<p>I couldn't find anything on MSDN.</p>\n\n<p><strong>What I have tried :</strong> </p>\n\n<p>I know WCF uses a .NET thread pool to handle web service requests.I read somewhere that a .Net thread is not guaranteed to be mapped to the same native thread during its lifetime. However, in the  current implementation, .Net threads <em>are</em> mapped 1 to 1 to the same native thread. </p>\n\n<p>I tried enumerating the active threads right before process exit and only the process main thread was active. </p>\n\n<p><strong>Edit:</strong> </p>\n\n<p>I just found this on MSDN:</p>\n\n<blockquote>\n  <p>Automatic data objects cannot be declared with the thread attribute. </p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/6yh4a9k1.aspx\" rel=\"nofollow noreferrer\">Link to MSDN</a></p>\n\n<p>However this seems to apply only to Microsoft's 'thread' modifier. Compilation does show the documented error with 'thread' but not with 'thread_local' so I guess this does not solve my problem.</p>\n"}, {"tags": ["c++", "matrix", "boost", "intervals"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1516811067, "post_id": 48426636, "comment_id": 83844573, "body": "C++ is a compiled language.  Are you getting an error when you compile or run the program?  If you get an error when you compile it, the compiler should tell you exactly which line.  The text it prints out is very verbose and informative; a summary usually is less useful.  Copy it all  and put it in <code>&gt;</code> quote with 5 leading spaces."}, {"owner": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1516813057, "post_id": 48426636, "comment_id": 83845943, "body": "@Yakk I attached the full error. I guess I have to somehow rewrite the matrix type to also take in intervals as scalars, but I really don&#39;t know how one would go about this"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1516813265, "post_id": 48426636, "comment_id": 83846090, "body": "Don&#39;t use the convenience typedef MatrixXd, use the main Matrix type with the right template parameters (see the doc, the right choice is obvious). Depending on the operations you want to do, you may need to specialize some eigen traits for this (interval) number type, see the doc about custom number types."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1516813830, "post_id": 48426636, "comment_id": 83846452, "body": "That isn&#39;t the full error.  The full error would include among other things the line number.  It may also include a whole pile of other knock-on stuff.  The line the error occurs on is useful.  As are any other knock-on other error spam.  If you are using a gui the gui may be hiding the full error from you."}, {"owner": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1516814817, "post_id": 48426636, "comment_id": 83847081, "body": "@Yakk I&#39;m using atom and I left out the line (it&#39;s separated in the output so I kinda forgot, but in this specific code I get errors on all the m and v assignments), otherwise this is everything that is displayed :/"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "edited": false, "score": 0, "creation_date": 1516864035, "post_id": 48428113, "comment_id": 83865831, "body": "in principle exactly what I am looking for, but the &quot;(m*v).eval();&quot; line throws the error that * operand type is ambiguous between &quot;matrix&quot; and &quot;vector&quot;, am I missing something? compiling with g++, c++14, boost 1.66 and eigen 3.3.4. The corresponding error is too long for the comment section :/"}, {"owner": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "edited": false, "score": 0, "creation_date": 1516865709, "post_id": 48428113, "comment_id": 83866506, "body": "I can resolve it by using m.lazyProduct(v), but I don&#39;t understand what the problem is and there may be a performance price I&#39;m paying for this, am I right?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "edited": false, "score": 0, "creation_date": 1516888758, "post_id": 48428113, "comment_id": 83880689, "body": "I guess you used <code>Dynamic</code>, and/or Eigen in another version/configured differently in which case <code>m*v</code> might not result in an expression-template. See <a href=\"https://eigen.tuxfamily.org/dox/TopicLazyEvaluation.html\" rel=\"nofollow noreferrer\">eigen.tuxfamily.org/dox/TopicLazyEvaluation.html</a> - Anyhoops, <a href=\"http://coliru.stacked-crooked.com/a/8a8f5655f673a07d\" rel=\"nofollow noreferrer\">this</a> works for me too."}, {"owner": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "edited": false, "score": 0, "creation_date": 1516890419, "post_id": 48428113, "comment_id": 83881981, "body": "didn&#39;t use dynamic, but maybe a different version. Which version and compiler did you run this on?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "edited": false, "score": 0, "creation_date": 1516891289, "post_id": 48428113, "comment_id": 83882629, "body": "gcc 7, eigen3 (3.3~beta1-2 ubuntu package libeigen3-dev), boost 1.66"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1516829948, "last_edit_date": 1516829948, "creation_date": 1516813959, "answer_id": 48428113, "question_id": 48426636, "link": "https://stackoverflow.com/questions/48426636/matrices-of-boost-intervals/48428113#48428113", "title": "Matrices of boost intervals", "body": "<p><a href=\"https://eigen.tuxfamily.org/dox/group__TutorialMatrixClass.html\" rel=\"nofollow noreferrer\">Docs say</a> that </p>\n\n<pre><code>typedef Matrix&lt;double, Dynamic, Dynamic&gt; MatrixXd;\n</code></pre>\n\n<p>Here's some fixes:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/ae501f7ce9daa05d\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/numeric/interval.hpp&gt;\n#include &lt;boost/numeric/interval/utility.hpp&gt;\n#include &lt;boost/numeric/interval/io.hpp&gt;\n\nnamespace bn = boost::numeric;\nnamespace bi = bn::interval_lib;\n\nusing Interval = bn::interval&lt;\n        double, \n        bi::policies&lt;\n            bi::save_state&lt;bi::rounded_transc_std&lt;double&gt; &gt;,\n            bi::checking_base&lt;double&gt;\n        &gt; \n    &gt;;\n\n#include &lt;eigen3/Eigen/Dense&gt;\nusing Matrix = Eigen::Matrix&lt;Interval, 2, 2&gt;;\nusing Vector = Eigen::Matrix&lt;Interval, 2, 1&gt;;\n\n#include &lt;iostream&gt;\n\nint main() {\n    Matrix m;\n    m &lt;&lt; \n       Interval {0.0, 1.0},\n       Interval {0.0, 0.0},\n       Interval {0.0, 0.0},\n       Interval {0.0, 1.0};\n\n    Vector v;\n    v &lt;&lt; \n       Interval {0.0, 1.0},\n       Interval {1.0, 2.0};\n\n    Vector prod = (m*v).eval();\n\n    std::cout &lt;&lt; prod(0,0) &lt;&lt; std::endl;\n    std::cout &lt;&lt; prod(1,0) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>[0,1]\n[0,2]\n</code></pre>\n\n<p>Of course you can use <code>Dynamic</code> extents.</p>\n"}], "owner": {"reputation": 37, "user_id": 9262529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33c72c3dd654644e030ead87b9b8a5fe?s=128&d=identicon&r=PG&f=1", "display_name": "bernhard_e", "link": "https://stackoverflow.com/users/9262529/bernhard-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 48428113, "answer_count": 1, "score": 1, "last_activity_date": 1516829948, "creation_date": 1516809549, "last_edit_date": 1516813726, "question_id": 48426636, "link": "https://stackoverflow.com/questions/48426636/matrices-of-boost-intervals", "title": "Matrices of boost intervals", "body": "<p>I am trying to write a \"divide and conquer\" root estimating algorithm for a R^n->R^m function using interval arithmetics. I did this in python before, but the performance was too slow so I decided to give C++ a go, I am a total beginner. </p>\n\n<p>I searched for a while to find Boosts interval library which seems convenient in dealing with my problem. However, I am required to do calculations with matrices of such intervals. Because I need to later on use matrices of interval midpoints and (pseudo-) invert them, I figured that <code>Eigen</code> might be a good way to represent my matrices. </p>\n\n<p>My question: Is this approach really a good idea, especially regarding performance? And if so, how would I go on to make it possible for such a matrix to contain intervals as entry and work with the basic operations (matrix multiplication etc.)</p>\n\n<p>An example of what I want to be able to do:</p>\n\n<pre><code>#include &lt;eigen3/Eigen/Dense&gt;\n#include &lt;boost/numeric/interval.hpp&gt;\nusing Eigen::MatrixXd;\nusing Eigen::VectorXd;\nint main()\n{\n  MatrixXd m(2,2);\n  VectorXd v(2);\n  Interval i1(0.0, 1.0);\n  Interval i2(1.0, 2.0);\n  Interval i3(0.0, 0.0);\n  m(0,0) = i1;\n  m(1,0) = i3;\n  m(0,1) = i3;\n  m(1,1) = i1;\n\n  v(0) = i1;\n  v(1) = i2;\n\n  std::cout &lt;&lt; m*v &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The specifications I made for the interval type are</p>\n\n<pre><code> typedef boost::numeric::interval&lt;double, boost::numeric::interval_lib::policies\n                            &lt;boost::numeric::interval_lib::save_state\n                            &lt;boost::numeric::interval_lib::rounded_transc_std&lt;double&gt; &gt;,\n                            boost::numeric::interval_lib::checking_base&lt;double&gt; &gt; &gt; Interval;\n</code></pre>\n\n<p>This should ultimately output something like (0.0,1.0), (0.0,2.0). Right now this raises the error \"Assigning scalar to incomparible type Interval\" and I don't have any idea on how to fix it, because Eigens matrix type naturally does not support intervals as entries.</p>\n\n<blockquote>\n<pre><code>assigning to 'Scalar' (aka 'double') from incompatible type 'Interval'\n(aka 'interval &lt; double, boost::numeric::interval_lib::policies &lt;\nboost::numeric::interval_lib::save_state &lt;\nboost::numeric::interval_lib::rounded_transc_std &lt; double &gt; &gt;,\nboost::numeric::interval_lib::checking_base&lt;double&gt; &gt; &gt;')\n</code></pre>\n</blockquote>\n\n<p>Any (noob-level!) references and suggestions are welcome.</p>\n"}, {"tags": ["c++", "qt", "qml", "qt5", "qt-signals"], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516810742, "post_id": 48426715, "comment_id": 83844322, "body": "I am using the slot from other functions on Qt, so I was trying to avoid to change the type from Qt side if possible... is there any other option?"}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516810831, "post_id": 48426715, "comment_id": 83844400, "body": "No, that&#39;s set in the QML engine - JS arrays become QVariantList - as simple as that, if you want, iterate the QVariantList and fill a list of strings from it. Mind you that Qt also has a QStringList specialization which is preferable to using QList&lt;QString&gt;. Keep in mind that JS arrays are not typed, so you need to use variants as a mediator, it is unavoidable. It works out of the box for integers and bools because the type is known."}, {"owner": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516811562, "post_id": 48426715, "comment_id": 83844922, "body": "ok, thanks. How should I declare the variable on the QML side to recognize it as a QVariantList on Qt?"}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516811898, "post_id": 48426715, "comment_id": 83845150, "body": "You don&#39;t have to do anything, any JS array will be converted to QVariantList  when passed to C++. Just as any JS object will be converted to QVariantMap."}, {"owner": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516812468, "post_id": 48426715, "comment_id": 83845541, "body": "I might be doing something wrong, because the slot is not called by setting the connect with QVariantList: QObject::connect(d-&gt;m_item, SIGNAL(casesClicked(QVariantList)), this, SLOT(onCasesClicked(QVariantList)));"}, {"owner": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516812749, "post_id": 48426715, "comment_id": 83845741, "body": "just as a reference, it needs to be declared as a QVariant (QVariantList does not work), and then I use: .toStringList() &quot;When a QML object type is used as a signal parameter, the parameter should use var as the type, and the value should be received in C++ using the QVariant type&quot; <a href=\"https://doc-snapshots.qt.io/qt5-5.9/qtqml-cppintegration-interactqmlfromcpp.html#connecting-to-qml-signals\" rel=\"nofollow noreferrer\">doc-snapshots.qt.io/qt5-5.9/&hellip;</a>"}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "edited": false, "score": 0, "creation_date": 1516812818, "post_id": 48426715, "comment_id": 83845777, "body": "Your connection looks bad, what is <code>this</code>? You are using <code>QObject::connect</code> so the connection doesn&#39;t happen in the scope of a QObject."}], "tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": false, "score": 1, "last_activity_date": 1516814595, "last_edit_date": 1516814595, "creation_date": 1516809756, "answer_id": 48426715, "question_id": 48426521, "link": "https://stackoverflow.com/questions/48426521/connecting-signals-from-qml-to-qt-var-to-qlistqstring/48426715#48426715", "title": "Connecting signals from QML to Qt: var to QList&lt;QString&gt;", "body": "<p>IIRC JS arrays are converted to <code>QVariantList</code> in C++, so try using that instead.</p>\n\n<p>EDIT:</p>\n\n<p>Ok, it appears that although the above is the default automatic conversion, it doesn't work for some reason when the connection is made from C++.</p>\n\n<p>In this scenario the signal value is converted to a <code>QVariant</code> instead, which can directly be converted to a <code>QStringList</code> which is convenient. However that approach will not work if you have a JS array with different data types in it, which is perfectly legal and quite frequently used in JS.</p>\n\n<p><code>QVariantList</code> will still work if you pass the JS array as a parameter to a C++ function call thou. So you can iterate each value and handle a \"polymorphic\" array.</p>\n\n<p>Whether or not it is recommended practice to create connections from to QML objects from C++ depends on the usage scenario, overall, I'd say that it isn't. The recommended practice is to expose the C++ core interface to QML and do the connections from there and to avoid touching any QML from C++ whatsoever. But there are a few corner cases where exceptions can be made.</p>\n"}, {"comments": [{"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1516814422, "post_id": 48428068, "comment_id": 83846833, "body": "The <code>Connections</code> element is redundant in this case, as you have direct access to the signal handler hook in this context. You only need the <code>onCasesClicked: Test.onCasesClicked(cases)</code> part."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1516814785, "post_id": 48428068, "comment_id": 83847053, "body": "@dtech Yes, I know, but if the connection is not given in the same item what you say would not work, my example is simple."}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1516814849, "last_edit_date": 1516814849, "creation_date": 1516813827, "answer_id": 48428068, "question_id": 48426521, "link": "https://stackoverflow.com/questions/48426521/connecting-signals-from-qml-to-qt-var-to-qlistqstring/48428068#48428068", "title": "Connecting signals from QML to Qt: var to QList&lt;QString&gt;", "body": "<p>I do not think it is appropriate to make the connection on the C ++ side since when compiling it does not know the signal created in QML, a possible solution is to make the connection on the QML side. In the following I show an example</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQuickView&gt;\n#include &lt;QQmlContext&gt;\n#include &lt;QDebug&gt;\nclass Test: public QObject{\nQQuickView *view;\nQ_OBJECT\npublic:\n    Test(QObject *parent=Q_NULLPTR):QObject(parent)\n    {\n        view = new QQuickView;\n        view-&gt;rootContext()-&gt;setContextProperty(\"Test\", this);\n        view-&gt;setSource(QUrl(\"qrc:/main.qml\"));\n        view-&gt;show();\n    }\npublic slots:\n    void onCasesClicked(QVariantList cases){\n        qDebug()&lt;&lt;cases;\n    }\n};\n\nint main(int argc, char *argv[])\n{\n#if defined(Q_OS_WIN)\n    QCoreApplication::setAttribute(Qt::AA_EnableHighDpiScaling);\n#endif\n\n    QGuiApplication app(argc, argv);\n    Test test;\n    return app.exec();\n}\n\n#include \"main.moc\"\n</code></pre>\n\n<p><strong>main.qml</strong></p>\n\n<pre><code>import QtQuick 2.9\n\nItem {\n    id: it\n    visible: true\n    width: 640\n    height: 480\n\n    signal casesClicked(var cases)\n\n    MouseArea {\n        id: mouseArea\n        anchors.fill: parent\n        onClicked: it.casesClicked([\"B\", 1, \"D\"])\n    }\n\n    Connections{\n        target: it\n        onCasesClicked: Test.onCasesClicked(cases)\n    }\n    // or\n    // onCasesClicked: Test.onCasesClicked(cases)\n    // if the connection is made in the same item\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>(QVariant(QString, \"B\"), QVariant(int, 1), QVariant(QString, \"D\"))\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 2359027, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a60a1053b4605c12fb2ab53d9995418c?s=128&d=identicon&r=PG", "display_name": "laurapons", "link": "https://stackoverflow.com/users/2359027/laurapons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 48428068, "answer_count": 2, "score": 2, "last_activity_date": 1559888142, "creation_date": 1516809180, "last_edit_date": 1559888142, "question_id": 48426521, "link": "https://stackoverflow.com/questions/48426521/connecting-signals-from-qml-to-qt-var-to-qlistqstring", "title": "Connecting signals from QML to Qt: var to QList&lt;QString&gt;", "body": "<p>I am trying to connect a signal from QML to a SLOT from Qt. The signal passes a QList variable.</p>\n\n<p>QML:</p>\n\n<pre><code>property var cases: [\"A\", \"B\", \"C\"]\n\nsignal casesClicked(list cases)\n</code></pre>\n\n<p>Qt:</p>\n\n<pre><code>d-&gt;m_view-&gt;setSource(QUrl(\"qrc:/qml/main.qml\"));\nd-&gt;m_item = d-&gt;m_view-&gt;rootObject();\nQObject::connect(d-&gt;m_item, SIGNAL(casesClicked(QList&lt;QString&gt;)), this, SLOT(onCasesClicked(QList&lt;QString&gt;)));\n</code></pre>\n\n<p>The issue I am having is that I don't know how to declare QList from the QML side, so it is taken directly. If I declare it with:</p>\n\n<pre><code>signal casesClicked(var cases)\n</code></pre>\n\n<p>then, the signal is not connected, and I if I declare it as a list or an Array it says <code>\"Invalid signal parameter type: list/Array\"</code></p>\n\n<p>Any tip? I don't have any problems with single int, bool or string. Thanks,</p>\n"}, {"tags": ["c++", "outlook", "outlook-addin"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 8207239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b451e3bfb464296fea37eb9a246d3cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GMX Rider", "link": "https://stackoverflow.com/users/8207239/gmx-rider"}, "edited": false, "score": 0, "creation_date": 1516811879, "post_id": 48427349, "comment_id": 83845138, "body": "But I need to disable links in email body. When user validates and click a button on Toolbar saying &quot;I trust this email&quot; I would like to put back original email body with links. How can I do this?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 157, "user_id": 8207239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b451e3bfb464296fea37eb9a246d3cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GMX Rider", "link": "https://stackoverflow.com/users/8207239/gmx-rider"}, "edited": false, "score": 0, "creation_date": 1516833183, "post_id": 48427349, "comment_id": 83856839, "body": "You can try to play with the Document object returned from Inspector.WordEditor and see if you can disable links in the message body."}, {"owner": {"reputation": 157, "user_id": 8207239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b451e3bfb464296fea37eb9a246d3cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GMX Rider", "link": "https://stackoverflow.com/users/8207239/gmx-rider"}, "edited": false, "score": 0, "creation_date": 1516900820, "post_id": 48427349, "comment_id": 83889598, "body": "Thanks Dmitry, but editing WordEditor data would still change the MailItem, isn&#39;t it?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 157, "user_id": 8207239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b451e3bfb464296fea37eb9a246d3cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GMX Rider", "link": "https://stackoverflow.com/users/8207239/gmx-rider"}, "edited": false, "score": 0, "creation_date": 1516920492, "post_id": 48427349, "comment_id": 83899370, "body": "Not if you only change the document or app properties, but not its contents."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1516811541, "creation_date": 1516811541, "answer_id": 48427349, "question_id": 48426501, "link": "https://stackoverflow.com/questions/48426501/c-outlook-mailitem-replace-body-and-discard-on-close/48427349#48427349", "title": "C++ Outlook MailItem replace body and discard on close", "body": "<p>The solution is to avoid modifying the message body if you do not want to keep the changes.</p>\n\n<p>If you want to show a warning to the user, add a task pane to the inspector. Or simply stamp the message with a category - it will be shown in the inspector.</p>\n"}, {"tags": [], "owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1518354261, "creation_date": 1518354261, "answer_id": 48731778, "question_id": 48426501, "link": "https://stackoverflow.com/questions/48426501/c-outlook-mailitem-replace-body-and-discard-on-close/48731778#48731778", "title": "C++ Outlook MailItem replace body and discard on close", "body": "<p>The Outlook object model doesn't provide anything for handling hyperlinks clicks. As a possible workaround you may consider implementing the following functionality:</p>\n\n<ol>\n<li><p>When the item is selected or opened in Outlook you may replace the original URL with your own where you can pass the original URL as an encoded parameter if needed. So, if it is allowed to open the URL you can redirect the request further. Note, you can use the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/explorer-selectionchange-event-outlook?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">SelectionChange</a> event of the Explorer class which is fired when the user selects a different or additional Microsoft Outlook item programmatically or by interacting with the user interface. This event also occurs when the user (either programmatically or via the user interface) clicks or switches to a different folder that contains items, because Outlook automatically selects the first item in that folder. However, this event does not occur if the folder is a file-system folder or if any folder with a current Web view is displayed. \nAlso you may consider handling the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-open-event-outlook\" rel=\"nofollow noreferrer\">Open</a> event of Outlook items which is fired when an instance of the parent object is being opened in an <code>Inspector</code>.  When this event occurs, the <code>Inspector</code> object is initialized but not yet displayed. The Open event differs from the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/appointmentitem-read-event-outlook\" rel=\"nofollow noreferrer\">Read</a> event in that <code>Read</code> occurs whenever the user selects the item in a view that supports in-cell editing as well as when the item is being opened in an inspector. </p></li>\n<li><p>Another possible solution is to register a custom URL handler. So, basically, your registered application will be launched instead of a web browser where you can decide whether to launch a web browser and follow the URL or not. See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb266527%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Installing and Registering Protocol Handlers</a> for more information. </p></li>\n</ol>\n"}], "owner": {"reputation": 157, "user_id": 8207239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b451e3bfb464296fea37eb9a246d3cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GMX Rider", "link": "https://stackoverflow.com/users/8207239/gmx-rider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518354261, "creation_date": 1516809128, "question_id": 48426501, "link": "https://stackoverflow.com/questions/48426501/c-outlook-mailitem-replace-body-and-discard-on-close", "title": "C++ Outlook MailItem replace body and discard on close", "body": "<p>I have an addon in Outlook which adds warning to mailbody and links in the email when email is coming from external or untrusted sources. \nAnyway, when I replace something in body, when email is opened in full view (no reading pane, double click full view of mail item), I hook mailItem close even and I discard changes, everything works well. (<code>mailitem.onclose(olDiscard)</code>)</p>\n\n<p>When I do this with reading pane on, when I discard the changes, Outlook still either saves the changes or when user is trying to close Outlook it asks user \"Do you want to save changes to .....\" and if user clicked on multiple emails during this period, it shows popup question for ALL emails user clicked and we replaced its body.</p>\n\n<p>What's the solution here? What can I do to fix this? I want to make changes to link and to body, but discard them when user clicks away on another email. End goal is not having Outlook to ask user \"Do you want to save changes ...\" popups. Please advise.</p>\n\n<p>I can't also make changes to inspector, because inspector is read-only.</p>\n\n<p>P.S. plugin is written in C++.</p>\n"}, {"tags": ["c++", "clang"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1516877892, "post_id": 48426484, "comment_id": 83873516, "body": "<code>#pragma</code> is the way to do it, I am afraid. The compiler is not <b>allowed</b> to interpret e.g. a comment the way you outlined, as that would affect fully-conforming programs in a non-standard way."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1562774149, "post_id": 48426484, "comment_id": 100485181, "body": "I don&#39;t see why it wouldn&#39;t be allowed to enable or disable <i>warnings</i> based on comments. The standard has nothing to say about warnings at all. As long as it never emits an error due to parsing a comment it wouldn&#39;t affect compilation at all."}], "answers": [{"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1516877436, "post_id": 48426846, "comment_id": 83873240, "body": "That does it for everything after that line in the file though. Not what I want. I just want to suppress <i>one instance</i> of the warning."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1516884395, "post_id": 48426846, "comment_id": 83877738, "body": "Ok but I already mentioned this possibility in the question. I wanted a more concise way to do it (I&#39;m pretty sure it is impossible at the moment, but worth asking)."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1516885691, "post_id": 48426846, "comment_id": 83878587, "body": "@Timmmm Unfortunately those are the only available options."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1516889015, "post_id": 48426846, "comment_id": 83880898, "body": "@Timmmm: As I commented above, <code>#pragma</code> is the way reserved by the language standard to allow for implementation-defined behaviour. A comment, for example, <b>must</b> be ignored by the compiler, because otherwise the compiler would not be standard-compliant. So you have to do compiler-specific things via <code>#pragma</code>."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1516891952, "post_id": 48426846, "comment_id": 83883121, "body": "Well... sure, but I would be happy with non standard-compliant behaviour."}, {"owner": {"reputation": 677, "user_id": 254035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd741cea9b0f6e6f57f8fce7b5f0576b?s=128&d=identicon&r=PG", "display_name": "wardw", "link": "https://stackoverflow.com/users/254035/wardw"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 1, "creation_date": 1548448267, "post_id": 48426846, "comment_id": 95559118, "body": "@Timmmm For some context, Visual Studio does provide what you&#39;re looking for. In fact they provide <a href=\"https://stackoverflow.com/a/25447795\">both alternatives</a>."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 15, "last_activity_date": 1516879515, "last_edit_date": 1516879515, "creation_date": 1516810089, "answer_id": 48426846, "question_id": 48426484, "link": "https://stackoverflow.com/questions/48426484/concise-way-to-disable-specific-warning-instances-in-clang/48426846#48426846", "title": "Concise way to disable specific warning instances in Clang", "body": "<p>As described in the <a href=\"https://clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-via-pragmas\" rel=\"noreferrer\">Controlling Diagnostics via Pragmas</a> article it would be:</p>\n\n<pre><code>#pragma clang diagnostic ignored \"-Wno-padded\"\n</code></pre>\n\n<p>If you want to suppress a warning in a certain chunk of code (be it a single line of code or multiple statements) then you need to utilize the <code>push</code> / <code>pop</code> mechanism:</p>\n\n<pre><code>#pragma clang diagnostic push\n#pragma clang diagnostic ignored \"-Wno-padded\"\n// your code for which the warning gets suppressed \n#pragma clang diagnostic pop\n// not suppressed here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 2770331, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002979863990/picture?type=large", "display_name": "T S", "link": "https://stackoverflow.com/users/2770331/t-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1616068571, "last_edit_date": 1616068571, "creation_date": 1615829980, "answer_id": 66642898, "question_id": 48426484, "link": "https://stackoverflow.com/questions/48426484/concise-way-to-disable-specific-warning-instances-in-clang/66642898#66642898", "title": "Concise way to disable specific warning instances in Clang", "body": "<p>If you have some include file where you can put a macro definition like this:</p>\n<pre><code>#define DO_PRAGMA(x) _Pragma(#x)\n#define NOWARN(warnoption, ...)                    \\\n    DO_PRAGMA(GCC diagnostic push)                 \\\n    DO_PRAGMA(GCC diagnostic ignored #warnoption)  \\\n    __VA_ARGS__                                    \\\n    DO_PRAGMA(GCC diagnostic pop)\n</code></pre>\n<p>Then you can disable a warning within your code like this:</p>\n<pre><code>NOWARN(-Wpadded,\n// your code for which the warning gets suppressed \n)\n</code></pre>\n<p>Example: <a href=\"https://godbolt.org/z/oW87ej\" rel=\"nofollow noreferrer\">https://godbolt.org/z/oW87ej</a></p>\n<hr />\n<p>Slightly off-topic note:</p>\n<p>gcc does not allow <code>GCC diagnostic ....</code> pragmas within expressions. So something like this:</p>\n<pre><code>#define MY_MYCRO(type) NOWARN(-Wpadded, sizeof(struct{char c; type t;}))\nint myval = MY_MYCRO(int);\n</code></pre>\n<p>will produce a error in gcc and won't compile. Note: Using <code>clang diagnostic ....</code> pragmas will not produce an error in gcc (but also doesn't disable the warning in gcc).</p>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5264, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1616068571, "creation_date": 1516809075, "last_edit_date": 1516877534, "question_id": 48426484, "link": "https://stackoverflow.com/questions/48426484/concise-way-to-disable-specific-warning-instances-in-clang", "title": "Concise way to disable specific warning instances in Clang", "body": "<p>Suppose there is some warning in my code, e.g. that Clang has added padding to a struct. I am find with that particular instance and I want to mark it as \"Noted; don't warn me about this instance again\".</p>\n\n<p>Is there a way to do this that isn't insanely verbose (i.e. <code>#pragma clang diagnostic push</code> etc)? Ideally something like a comment on the same line as the warning, something like this:</p>\n\n<pre><code>// clang(-Wno-padded)\n</code></pre>\n\n<p>To be clear, I only want to suppress <em>one specific instance</em> of the warning (which normally requires <code>#pragma diagnostic push</code>/<code>pop</code>), not all warnings in the file.</p>\n"}, {"tags": ["c++", "validation", "parsing", "serialization", "protocol-buffers"], "comments": [{"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1516809433, "post_id": 48426422, "comment_id": 83843345, "body": "Instead of defining the additional field with the name, you can use <code>Reflection</code> or <code>Descriptor</code>."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1516809947, "post_id": 48426422, "comment_id": 83843719, "body": "Protobuf encoding format is not self-describing. Basically, a binary encoding of any message can be successfully decoded into any other message; the latter may just end up with missing and/or unknown fields. The two parties must somehow agree on the type of the messages being exchanged, usually by documenting the communication protocol. Why again is one side sending <code>Bar</code> when the other side expects <code>Foo</code>?"}, {"owner": {"reputation": 3253, "user_id": 891439, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ada8f2c41ec630fd97a051b3369e8d59?s=128&d=identicon&r=PG", "display_name": "Florian Wolters", "link": "https://stackoverflow.com/users/891439/florian-wolters"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1516810315, "post_id": 48426422, "comment_id": 83844008, "body": "@Ptaq666 I can <b>not</b> use these features, since I have to create the <b>expected</b> message of a concrete type on the receiving side. Therefore both reflection and descriptor <b>always</b> return the expected type."}, {"owner": {"reputation": 3253, "user_id": 891439, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ada8f2c41ec630fd97a051b3369e8d59?s=128&d=identicon&r=PG", "display_name": "Florian Wolters", "link": "https://stackoverflow.com/users/891439/florian-wolters"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1516810808, "post_id": 48426422, "comment_id": 83844386, "body": "@IgorTandetnik I know that Protobuf is not self-describing, but I thought that there may be a functionality that can detect such a case, since we are talking about distinct types (not missing/unknown fields). The contract between sender and receiver <b>is</b> well-defined. We are not talking about a functionality here, this is about non-functional software quality, i.e. making the software robust against invalid/malformed input data. IMO this isn&#39;t such a special requirement. If there is no built-in feature I will go with the field approach and use <code>Descriptor::full_name()</code> on both sides."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 1, "creation_date": 1516813290, "post_id": 48426422, "comment_id": 83846108, "body": "@Florian no such feature exists, because it would be impossible to implement. Messages are fundamentally interchangeable as long as they don&#39;t have conflicting wire-type expectations (field 2 being a string in one, and a varint in the other, for example)"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1516815019, "post_id": 48426422, "comment_id": 83847213, "body": "Well, malformed data can contain the correct <code>full_name</code> and then garbage in the rest of the fields. For all protobuf parser knows, the binary representation of <code>Bar</code> is merely a different (newer or older) revision of <code>Foo</code> - protobufs were specifically designed to be robust in the face of protocol evolution."}, {"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 0, "creation_date": 1517094382, "post_id": 48426422, "comment_id": 83955919, "body": "@FlorianWolters Whenever I&#39;ve had to solve this problem in GPB I&#39;ve always ended up putting alll the different messages I want to send in a oneof inside a wrapper message. Thus I&#39;m alway only ever sending the wrapper, and it desribes what flavour of its oneoff it contains. I usually end up using ZMQ too, that takes care of message boundaries nicely. Serialisations like ASN.1 BER are self describing, allows one to &quot;peek ahead&quot; to see what&#39;s coming next. Very handy."}, {"owner": {"reputation": 3253, "user_id": 891439, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ada8f2c41ec630fd97a051b3369e8d59?s=128&d=identicon&r=PG", "display_name": "Florian Wolters", "link": "https://stackoverflow.com/users/891439/florian-wolters"}, "reply_to_user": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 0, "creation_date": 1517249351, "post_id": 48426422, "comment_id": 84009361, "body": "@bazza I do the same, as you can see in the OP. Though, this does not help if you want to protect yourself from wire compatible message of another type. I can&#39;t use one top-level messages for all messages, since I am dealing with multiple logical interfaces that do not share the same message bodies (also refer to OP)."}, {"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 0, "creation_date": 1517262940, "post_id": 48426422, "comment_id": 84016150, "body": "@FlorianWolters, you could add a type string; I&#39;ve seen this done (with a type int32 actually, but the principle is the same) but it is highly unsatisfactory because it has to be set / tested consistently everywhere; not very maintainable. If the generated classes have a handy function to return the object type as a string (I think the C++ classes do), you could use that to programatically set / test the type string. Failing all that, you&#39;d have to have some other outer wrapper describing the contained GPB message&#39;s type."}, {"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 0, "creation_date": 1517264950, "post_id": 48426422, "comment_id": 84016977, "body": "@FlorianWolters, yes it looks like there&#39;s a method <code>name()</code> on the C++ objects. If you put that into a string field, then you could test for that at the other end without ever having to define string constants; it would all be sourced from the message names in the .proto file. So kind of a halfway solution, but at least easily maintained."}], "owner": {"reputation": 3253, "user_id": 891439, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ada8f2c41ec630fd97a051b3369e8d59?s=128&d=identicon&r=PG", "display_name": "Florian Wolters", "link": "https://stackoverflow.com/users/891439/florian-wolters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1537, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1516808858, "creation_date": 1516808858, "question_id": 48426422, "link": "https://stackoverflow.com/questions/48426422/check-whether-a-parsed-protocol-buffers-protobuf-proto3-message-is-valid", "title": "Check whether a parsed Protocol Buffers (Protobuf) proto3 message is valid", "body": "<p>I currently need to transfer a Protobuf message of a given type <code>Foo</code> over the network and handle it on reception.</p>\n\n<p>I am using Protobuf 3.5.1 and the <code>proto3</code> language.</p>\n\n<p>On reception I do the following:</p>\n\n<ol>\n<li>Create an empty instance of the expected type <code>Foo</code> (via a <em>Factory Method</em>, since it may change).</li>\n<li>Parse the message from a <code>CodedInputStream</code> (constructed from the data received from the network).</li>\n<li>Validate whether the parsing has been successful.</li>\n</ol>\n\n<p>Here is a minimal code snippet illustrating the concrete problem:</p>\n\n<pre><code>// Create the empty Protobuf message of the EXPECTED type.\nstd::shared_ptr&lt;google::protobuf::Message&gt; message = std::make_unique&lt;Foo&gt;();\n\n// Create the CodedInputStream from the network data.\ngoogle::protobuf::io::CodedInputStream stream{receive_buffer_.data(), static_cast&lt;int&gt;(bytes_transferred)};\n\nif (message-&gt;ParseFromCodedStream(&amp;stream) &amp;&amp; stream.ConsumedEntireMessage() &amp;&amp; message-&gt;IsInitialized()) {\n  // Message is of correct type and correctly parsed.\n} else {\n  // Message is NOT VALID.\n  // TODO: This does not work if sending a message of type `Bar`.\n}\n</code></pre>\n\n<p>Everything works flawless if the sender transfers messages of the expected type <code>Foo</code>, but things get weird if sending a message of another type <code>Bar</code>.</p>\n\n<p>Both messages have a similar structure (they only difference is the <code>oneof</code> type which uses different types (but may use identical field identity values):</p>\n\n<pre><code>message Foo {\n\n  First first = 1;\n\n  oneof second {\n\n    A a = 2;\n    B b = 3;\n  }\n}\n\nmessage Bar {\n\n  First first = 1;\n\n  oneof second {\n\n    C c = 2;\n    D d = 3;\n  }\n}\n</code></pre>\n\n<p>I haven't found a way yet, that detects whether the received Protobuf message type is \"valid\".</p>\n\n<p>So my question is: How can I safely detect whether the parsed instance of <code>Foo</code> is valid and it is not an instance of another (similarly structured but completely different) Protobuf message type? Do I need to manually add the name of the message sent as a field (that would be stupid, but should work)?</p>\n"}, {"tags": ["c++", "text", "sfml", "text-alignment"], "comments": [{"owner": {"reputation": 33251, "user_id": 409744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b055a62302498782454622c61e44aa51?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/409744/mario"}, "edited": false, "score": 1, "creation_date": 1516809416, "post_id": 48426141, "comment_id": 83843334, "body": "Both <code>sf::Text::getLocalBounds()</code> and <code>sf::Text::draw()</code> call the same internal member to update the geometry, so there shouldn&#39;t be any difference. Did you assign a <code>sf::Font</code> before updating the text?"}], "answers": [{"tags": [], "owner": {"reputation": 492, "user_id": 7321499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/080ec081685e05dcb2fe9f20f1f36553?s=128&d=identicon&r=PG&f=1", "display_name": "micka190", "link": "https://stackoverflow.com/users/7321499/micka190"}, "is_accepted": true, "score": 1, "last_activity_date": 1516813842, "creation_date": 1516813842, "answer_id": 48428072, "question_id": 48426141, "link": "https://stackoverflow.com/questions/48426141/sfml-2-4-2-getting-localbounds-before-drawing-sftext-object/48428072#48428072", "title": "SFML 2.4.2 getting localBounds before drawing sf::Text object", "body": "<p>The setFont() function was called after the setString() function, which meant that the localBounds were still 0, since there was no font to indicate a width or a height.</p>\n"}], "owner": {"reputation": 492, "user_id": 7321499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/080ec081685e05dcb2fe9f20f1f36553?s=128&d=identicon&r=PG&f=1", "display_name": "micka190", "link": "https://stackoverflow.com/users/7321499/micka190"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 48428072, "answer_count": 1, "score": 1, "last_activity_date": 1516960100, "creation_date": 1516807942, "last_edit_date": 1516960100, "question_id": 48426141, "link": "https://stackoverflow.com/questions/48426141/sfml-2-4-2-getting-localbounds-before-drawing-sftext-object", "title": "SFML 2.4.2 getting localBounds before drawing sf::Text object", "body": "<p>I'm working on a project that needs some buttons done with SFML. We're using version 2.4.2. I've managed to accomplish everything but the text alignment, and I'm very confused as to what the problem is.</p>\n\n<p>In order to set the text's alignment, I know that I must set its origin and position properly. Since people may change a button's text, I decided to put the alignment feature into the setString function.</p>\n\n<p>For debugging purposes, I've added a couple of console outputs to show me some of my data. Here's what the function looks like:</p>\n\n<pre><code>void rgf::Button::setString(const sf::String &amp; str)\n{\n    text.setString(str);\n\n    std::cout &lt;&lt; \"Original Origin: \" &lt;&lt; text.getOrigin().x &lt;&lt; \", \" &lt;&lt; text.getOrigin().y &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Original Position: \" &lt;&lt; text.getPosition().x &lt;&lt; \", \" &lt;&lt; text.getPosition().y &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Original LocalBounds: \" &lt;&lt; text.getLocalBounds().width &lt;&lt; \", \" &lt;&lt; text.getLocalBounds().height &lt;&lt; std::endl;\n\n    auto textRect = text.getLocalBounds();\n    auto btnRect = body.getLocalBounds();\n    text.setOrigin(textRect.left + textRect.width / 2, textRect.height + textRect.height / 2);\n    text.setPosition(btnRect.left + btnRect.width / 2, btnRect.top + btnRect.height / 2);\n\n    std::cout &lt;&lt; \"New Origin: \" &lt;&lt; text.getOrigin().x &lt;&lt; \", \" &lt;&lt; text.getOrigin().y &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"New Position: \" &lt;&lt; text.getPosition().x &lt;&lt; \", \" &lt;&lt; text.getPosition().y &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"New LocalBounds: \" &lt;&lt; text.getLocalBounds().width &lt;&lt; \", \" &lt;&lt; text.getLocalBounds().height &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The console outputs all positons, new and old, as 0 (except new position which returns the expected coords of 50 and 25).</p>\n\n<p>According to what I've found online, as soon as I set the text's string, my text object's localBounds should change. This doesn't happen unless the text has been drawn once already in an sf::RenderWindow.</p>\n\n<p>I made it so that the button's function would set the string to another value, this had the effect of setting the origin and position properly. Setting the string's value in a container's constructor (before it is drawn) doesn't set the origin properly.</p>\n\n<p>I've spent a day on this and I don't understand what I'm missing. Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 4, "creation_date": 1516807837, "post_id": 48426096, "comment_id": 83842093, "body": "Have a look at the same question on <a href=\"https://softwareengineering.stackexchange.com/questions/305930/if-i-need-to-use-a-piece-of-memory-throughout-the-lifespan-of-my-program-is-it\">soft-eng</a>."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516807866, "post_id": 48426096, "comment_id": 83842113, "body": "There is way more than meets the eye. Especially with C++."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 1, "creation_date": 1516808011, "post_id": 48426096, "comment_id": 83842229, "body": "When I die, people will come and take away everything in my house, so why should I take out the trash while I&#39;m alive?"}, {"owner": {"reputation": 1223, "user_id": 2366842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db1f21d133e897903c931feb815012b?s=128&d=identicon&r=PG", "display_name": "user2366842", "link": "https://stackoverflow.com/users/2366842/user2366842"}, "edited": false, "score": 0, "creation_date": 1516808012, "post_id": 48426096, "comment_id": 83842230, "body": "It&#39;s much less of a problem with applications that run for a minute or two.  If something&#39;s being written that will run for hours, days, or even weeks, this becomes much more important.  If nothing else, this is always best practice.  EDIT: also even for a short running program, depending on how it&#39;s written, a large number of objects may be created that can eat through an unacceptable amount of memory..."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1516808188, "post_id": 48426096, "comment_id": 83842386, "body": "Because destructors might do more than release memory and close file handles (or whatever else your OS does)."}], "answers": [{"tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": true, "score": 4, "last_activity_date": 1516808654, "last_edit_date": 1516808654, "creation_date": 1516808203, "answer_id": 48426212, "question_id": 48426096, "link": "https://stackoverflow.com/questions/48426096/cleaning-up-when-process-goes-down-why/48426212#48426212", "title": "Cleaning up when process goes down - WHY", "body": "<p>Because it forces you to write clean reusable software. Let's imagine the situation where, say, you finish your game and all is fine even though you don't have clean-up code.</p>\n\n<p>Now, given the huge success, you make a sequel and plan to reuse the code. But this time round you have a coop mode, a matchmaking lobby and a story mode. You realize you could simply delete the main <code>Game* object</code>, and create a new one with different parameters, when switching modes.</p>\n\n<p>Then you realize: oops, although this would work nicely, all the unallocated memory prevents your from using this approach.</p>\n\n<p>This is the pattern that always happen. It comes in different flavors. You want to write unit tests but between tests you need to clean-up everything. No clean-up: no way to have a clean test after the first one.</p>\n\n<p>It looks like extra work, but it will pay off <em>a lot</em> in the future.</p>\n"}, {"tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": false, "score": 0, "last_activity_date": 1516809118, "last_edit_date": 1516809118, "creation_date": 1516808790, "answer_id": 48426399, "question_id": 48426096, "link": "https://stackoverflow.com/questions/48426096/cleaning-up-when-process-goes-down-why/48426399#48426399", "title": "Cleaning up when process goes down - WHY", "body": "<p>I can think of multiple reasons:</p>\n\n<p><strong>Modularity</strong></p>\n\n<ul>\n<li>An application is usually a collection of modules</li>\n<li>Modules should have a well defined purpose, and should be reusable throughout your application, or even better, applications</li>\n<li>When writing a module, one should not assume how or when someone else is going to use it, so s/he should exercise best-practices and write it correctly</li>\n</ul>\n\n<p><strong>Analysis</strong></p>\n\n<p>When intentionally leaking resources, analyzing actual memory leaks\nbecomes a nearly impossible task. You can't differentiate modules that should free resources and those that shouldn't.</p>\n"}, {"comments": [{"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1516809655, "post_id": 48426535, "comment_id": 83843503, "body": "@Jeffrey Absolutely not. But A a; is ;-) - my bad"}, {"owner": {"reputation": 63, "user_id": 8144915, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1de7e965e14e213b9ddc0e4d5bb7b4e7?s=128&d=identicon&r=PG&f=1", "display_name": "zonzor18", "link": "https://stackoverflow.com/users/8144915/zonzor18"}, "edited": false, "score": 0, "creation_date": 1516869684, "post_id": 48426535, "comment_id": 83868449, "body": "I understand the concept of memory leaks and sure the concept of freeing needed memory, but the question was about instances that leave all the time until program ends, in this case it won&#39;t be a memory leak and all a[12] memory will be returned to the OS .."}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": false, "score": 0, "last_activity_date": 1516809616, "last_edit_date": 1516809616, "creation_date": 1516809231, "answer_id": 48426535, "question_id": 48426096, "link": "https://stackoverflow.com/questions/48426096/cleaning-up-when-process-goes-down-why/48426535#48426535", "title": "Cleaning up when process goes down - WHY", "body": "<p>Because what you think is wrong. In some cases indeed, you are right. If you instanciate objects like this: <code>A a;</code>, then A will be destroyed when getting outside its context. Now if you do <code>A *a = new A[12];</code> then 12 memory spaces the size of an instance of <code>A</code> are reserved. If you do nothing, at the end of the context, then <code>a</code> will be destroyed. But <code>a</code> is a pointer, so only the address of the array will be destroyed, the 12 spaces will still be allocated in memory and not accessible. They are lost for everyone.</p>\n\n<p>And there are many other examples. Try to use Valgrind and you will see.</p>\n\n<p>Now if your program gets more and more complicated, adding all these memory leaks could become a problem in the context of your own program. Of course when your program is over, the memory is given back to the OS, but that is definitely not a reason to tolerate memory leaks.</p>\n"}, {"tags": [], "owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "is_accepted": false, "score": 0, "last_activity_date": 1516809680, "creation_date": 1516809680, "answer_id": 48426689, "question_id": 48426096, "link": "https://stackoverflow.com/questions/48426096/cleaning-up-when-process-goes-down-why/48426689#48426689", "title": "Cleaning up when process goes down - WHY", "body": "<p>There are many good reasons.</p>\n\n<p>1) Some systems do not clean up after you.  Especially true in embedded systems, or systems running without an OS.</p>\n\n<p>2) Usually an application main() is merely instantiating modules and subsystems that are reusable and should manage their own resources.  If main() is simply a minor function that instantiates some objects then runs the event loop, then your \"application cleanup\" code is not really application cleanup, but <em>module</em> cleanup.  A big difference.</p>\n\n<p>3) Imagine your library was to run in someone else's code and you do not know how long it will be used, relative to the lifetime of the whole application.  If your code leaks, it will quickly be discarded as a low quality piece of code.</p>\n\n<p>4) If it is difficult to clean up after yourself, it likely is an indicator of bugs in your design and memory / resource management.  By properly managing resources, you force a clean design and do not leave such management as an afterthought.  Therefore, I argue that <em>your code is less buggy when you design it to clean up when it is finished</em>.</p>\n"}], "owner": {"reputation": 63, "user_id": 8144915, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1de7e965e14e213b9ddc0e4d5bb7b4e7?s=128&d=identicon&r=PG&f=1", "display_name": "zonzor18", "link": "https://stackoverflow.com/users/8144915/zonzor18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 48426212, "answer_count": 4, "score": 2, "last_activity_date": 1516809680, "creation_date": 1516807784, "question_id": 48426096, "link": "https://stackoverflow.com/questions/48426096/cleaning-up-when-process-goes-down-why", "title": "Cleaning up when process goes down - WHY", "body": "<p>I'm writing c++ and have multiple objects I created during the life of the process, when the process goes down all its memory release to the OS so why should I clean up and release stuff ?</p>\n"}, {"tags": ["c++", "pointers", "object", "methods", "scope"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 5, "creation_date": 1516807793, "post_id": 48426032, "comment_id": 83842059, "body": "Did you mean to call <code>Trampoline::bounding_box()</code>? If so, you need to add the empty parentheses. I.e., <code>if (detect_collision(this-&gt;bounding_box(), thrower-&gt;bounding_box()))</code>"}, {"owner": {"reputation": 968, "user_id": 5391777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JpKwN.jpg?s=128&g=1", "display_name": "Mahathi Vempati", "link": "https://stackoverflow.com/users/5391777/mahathi-vempati"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1516808752, "post_id": 48426032, "comment_id": 83842840, "body": "@FredLarson, thanks! that was the issue."}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 3434901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5efd464fb109b3ef3f0a5eb91a47cc4b?s=128&d=identicon&r=PG&f=1", "display_name": "dvd8719", "link": "https://stackoverflow.com/users/3434901/dvd8719"}, "is_accepted": true, "score": 3, "last_activity_date": 1516808670, "creation_date": 1516808670, "answer_id": 48426368, "question_id": 48426032, "link": "https://stackoverflow.com/questions/48426032/passing-objects-in-c-gives-invalid-use-of-non-static-member-error/48426368#48426368", "title": "Passing objects in C++ gives &#39;invalid use of non-static member&#39; error", "body": "<p>Seems like you have defined <code>thrower-&gt;bounding_box</code> as a member <em>function</em> not a member <em>variable</em>. So you need to use it as <code>thrower-&gt;bounding_box()</code></p>\n\n<p>So your code should be</p>\n\n<pre><code>#include \"trampoline.h\"\n#include \"main.h\"\n#include \"thrower.h\"\n\n//other functions\n\nvoid Trampoline::landed(Thrower* thrower){\n    if (detect_collision(this-&gt;bounding_box, thrower-&gt;bounding_box()))\n        thrower-&gt;speed.y = -2* thrower-&gt;speed.y;\n  }\n</code></pre>\n"}], "owner": {"reputation": 968, "user_id": 5391777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JpKwN.jpg?s=128&g=1", "display_name": "Mahathi Vempati", "link": "https://stackoverflow.com/users/5391777/mahathi-vempati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48426368, "answer_count": 1, "score": 0, "last_activity_date": 1516808670, "creation_date": 1516807612, "question_id": 48426032, "link": "https://stackoverflow.com/questions/48426032/passing-objects-in-c-gives-invalid-use-of-non-static-member-error", "title": "Passing objects in C++ gives &#39;invalid use of non-static member&#39; error", "body": "<p>So, I'm making a game in which when the thrower(a ball) lands on the trampoline, I need to make the thrower's speed change.\nI already have a function called <code>detect_collision</code> in <code>main</code> which is in the file <code>main.cpp</code></p>\n\n<p>So, in the trampoline class, I have this function:</p>\n\n<p>trampoline.cpp:</p>\n\n<pre><code>#include \"trampoline.h\"\n#include \"main.h\"\n#include \"thrower.h\"\n\n//other functions\n\nvoid Trampoline::landed(Thrower* thrower){\n    if (detect_collision(this-&gt;bounding_box, thrower-&gt;bounding_box))\n        thrower-&gt;speed.y = -2* thrower-&gt;speed.y;\n  }\n</code></pre>\n\n<p>In main.cpp:</p>\n\n<pre><code>#include \"trampoline.h\"\n#include \"main.h\"\n#include \"thrower.h\"\n\n// other functions    \n\nbool detect_collision(bounding_box_t a, bounding_box_t b) {\n        return (abs(a.x - b.x) * 2 &lt; (a.width + b.width)) &amp;&amp;\n               (abs(a.y - b.y) * 2 &lt; (a.height + b.height));\n    }\n</code></pre>\n\n<p>When I compile, I get the following error:</p>\n\n<pre><code>error: invalid use of non-static member function \u2018bounding_box_t Trampoline::bounding_box()\u2019\n     if (detect_collision(this-&gt;bounding_box, thrower-&gt;bounding_box))\n                                                                   ^\n</code></pre>\n\n<p>Other similar questions haven't helped much.</p>\n"}, {"tags": ["c++", "copy-constructor", "dereference"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 4, "creation_date": 1516806536, "post_id": 48425643, "comment_id": 83841120, "body": "The copy constructor of <i>what</i> is being called? I suggest you show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 4, "creation_date": 1516806547, "post_id": 48425643, "comment_id": 83841131, "body": "This looks interesting. Please add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it is very hard to reason about in its current form."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "edited": false, "score": 0, "creation_date": 1516806668, "post_id": 48425643, "comment_id": 83841235, "body": "I will try to replicate the exact behavior on a minimal example, as suggested.  The code comes from a project with large objects. Will report back very soon."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1516806787, "post_id": 48425643, "comment_id": 83841314, "body": "<code>std::make_pair(a.first, a.second *b)</code> would make a copy of <code>a.first</code>, and possibly of <code>a.second</code> and/or <code>b</code> depending on what <code>*</code> means there."}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1516807009, "post_id": 48425643, "comment_id": 83841489, "body": "Also, although incidental to the issue you perceive, the contents of *result are rewritten during each iteration of the while loop, so it looks like a lot of computation is wasted --- *result end up just being fn(--last,x), barring edge cases."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807274, "post_id": 48425643, "comment_id": 83841667, "body": "@IgorTandetnik The copy constructor of the a is called, that is, before the function fn is entered, the copy constructor of *first, is being called."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "reply_to_user": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1516807334, "post_id": 48425643, "comment_id": 83841704, "body": "@jwimberley No, elements are being added to the collection. In the end, the final iterator is being returned in case the client needs it."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807379, "post_id": 48425643, "comment_id": 83841748, "body": "I doubt it. You are likely mis-interpreting your observations. MCVE would help."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1516807547, "post_id": 48425643, "comment_id": 83841865, "body": "Does <code>fn</code> accept <code>std::pair&lt;Key, Value&gt;</code>, by any chance? If you are iterating over <code>std::map&lt;Key, Value&gt;</code>, <code>*first</code> is of type <code>std::pair&lt;const Key, Value&gt;</code> - a different type, so an implicit conversion is performed."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807557, "post_id": 48425643, "comment_id": 83841874, "body": "@IgorTandetnik You are right, it told it wrong. The copy constructor of first-&gt;second is being called, as *first is being passed as an argument. I am woring on MCVE."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807654, "post_id": 48425643, "comment_id": 83841942, "body": "@IgorTandetnik It accepts std::pair&lt;T*,T&gt;. So your point could be valid."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807730, "post_id": 48425643, "comment_id": 83842000, "body": "But the iterator&#39;s value is likely of type <code>std::pair&lt;T* const, T&gt;</code>, necessitating a conversion."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807846, "post_id": 48425643, "comment_id": 83842098, "body": "@IgorTandetnik Please provide a longer description of why and how, and I will accept. You seem to be correct. Thank you!"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1516807859, "post_id": 48425643, "comment_id": 83842108, "body": "@LeastSquaresWonderer I am fairly sure that the intermediate values of *result are unusued, but perhaps this is just an artifact of a simplification you have made"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1516807969, "post_id": 48425643, "comment_id": 83842195, "body": "Why and how what? I&#39;m not sure I understand your request."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "edited": false, "score": 0, "creation_date": 1516808332, "post_id": 48425643, "comment_id": 83842508, "body": "Sorry. Your point seems valid, and I will look into it right now. The map type is defined to be std::map&lt;T*,T&gt; and not std::map&lt;T* const,T&gt;, but perhaps something to this effect is going on behind the scenes."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1516810355, "post_id": 48425643, "comment_id": 83844038, "body": "The key type of a <code>std::map</code> is <code>const</code> whether the template parameter is or not. This is so that you cannot change keys that are already in the map, which could change the way they compare and thus corrupt the map&#39;s internal structure."}, {"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1516813120, "post_id": 48425643, "comment_id": 83845989, "body": "@SebastianRedl Thank you.  You and Igor answered my question. Please, one of you, provide an answer, so I can accept and close this question. Again, thank you very much, I did not know that the key is always const."}], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "edited": false, "score": 0, "creation_date": 1516807779, "post_id": 48425912, "comment_id": 83842046, "body": "The operator is overloaded with a const referece for lhs and rhs, aswell for rvalue references. The copy constructor is being called before entering the fn."}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": false, "score": 1, "last_activity_date": 1516807682, "last_edit_date": 1516807682, "creation_date": 1516807235, "answer_id": 48425912, "question_id": 48425643, "link": "https://stackoverflow.com/questions/48425643/dereferencing-a-pointer-while-passing-to-a-reference-expecting-function-creates/48425912#48425912", "title": "Dereferencing a pointer while passing to a reference expecting function creates a copy, why?", "body": "<p>I think the copy is made in <code>std::make_pair()</code> method, which returns a reference to a new object composed of two instances of the class T and V that are copied from <code>a-&gt;first</code> and  <code>a-&gt;second *b</code>. Else, modifying anything in the returned pair would also modify the object you passed by reference in <code>fn()</code>.</p>\n\n<p>edit: now you have given more information, I think the copy constructor of (*first).second is called when you are performing : <code>a-&gt;second *b</code>. As I don't know how is overloaded your operator *, I guess it implies a copy.</p>\n"}], "owner": {"reputation": 422, "user_id": 5642720, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3309fa36d2a2a309d0f6520047c9f7f?s=128&d=identicon&r=PG", "display_name": "LeastSquaresWonderer", "link": "https://stackoverflow.com/users/5642720/leastsquareswonderer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516816960, "creation_date": 1516806379, "last_edit_date": 1516816960, "question_id": 48425643, "link": "https://stackoverflow.com/questions/48425643/dereferencing-a-pointer-while-passing-to-a-reference-expecting-function-creates", "title": "Dereferencing a pointer while passing to a reference expecting function creates a copy, why?", "body": "<p>Consider a simple example</p>\n\n<pre><code>template&lt;class InputIterator,class InputIterator2, class OutputIterT, class Function, class T2&gt;\n    OutputIterT foo(InputIterator first, InputIterator2 last, OutputIterT result, Function fn, const T2&amp; x)\n  {\n    while (first!=last) {\n     *result=fn(*first,x);\n      ++first;\n    }\n    return result;\n}\n</code></pre>\n\n<p>where the Function fn that is passed is</p>\n\n<pre><code>template&lt;class T, class V&gt;\n T fn(const T&amp; a, const V&amp; b) {\n   return std::make_pair(a.first, a.second *b);\n}\n</code></pre>\n\n<p>When I use this code and check for the constructors being called, I see that at each call fn(*first,x), the copy constructor is being called. I find this hard to understand, as the function parameter is a reference. Please note that the iterators being used, are map iterators. To avoid the unnecessary copy I changed the code to accept the iterator directly (fn function), so that the line now is</p>\n\n<pre><code>*result=fn(first,x);\n</code></pre>\n\n<p>and the fn is</p>\n\n<pre><code>template&lt;class Iter, class V&gt;\n T fn(Iter a, const V&amp; b) {\n   return std::make_pair(a-&gt;first, a-&gt;second *b);\n}\n</code></pre>\n\n<h3>Question</h3>\n\n<p>Why is the copy being created in the first case, with the call to fn? When can this happen? Why does it happen, even though the function parameter is a const reference? Thank you for helping me understand.</p>\n\n<p>To clarify, the copy constructor of the </p>\n\n<pre><code>(*first).second\n</code></pre>\n\n<p>is being called, before entering the function fn.</p>\n\n<h2>Answer</h2>\n\n<p>@IgorTandetnik provided the correct answer in the comments bellow, and @SebastianRedl  provided further rational on why this happens.</p>\n\n<p>The map object of the type</p>\n\n<pre><code>map&lt;Key,Value&gt;;\n</code></pre>\n\n<p>is really </p>\n\n<pre><code>map&lt;Key const,Value&gt;;\n</code></pre>\n\n<p>even if the programmer does not specify it as such (if you omit the const).</p>\n\n<p>Now, when instantiating the foo function, if you (as I did) provide the pair type as</p>\n\n<pre><code>pair&lt;Key,Value&gt;\n</code></pre>\n\n<p>this does not match the pairs contained in the map, which are</p>\n\n<pre><code>pair&lt;Key const, Value&gt;\n</code></pre>\n\n<p>(again, even if you did not explicitly say key should be const). This causes a need for conversion as when passing to the function fn.</p>\n\n<p>Thank you both!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516806500, "post_id": 48425621, "comment_id": 83841089, "body": "Are values actually of type <code>char</code>?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1516806507, "post_id": 48425621, "comment_id": 83841099, "body": "how do you store the data? Some code would really help to understand the problem"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1516806510, "post_id": 48425621, "comment_id": 83841104, "body": "What do you mean by &quot;table&quot;? What do you <i>really</i> have? Please take some time to <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> of your current attempt."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1516806542, "post_id": 48425621, "comment_id": 83841127, "body": "<a href=\"http://www.boost.org/doc/libs/1_66_0/libs/bimap/doc/html/index.html\" rel=\"nofollow noreferrer\">Boost Bimap</a>, maybe?"}, {"owner": {"reputation": 41, "user_id": 6380478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2022c0a2e2de043bb8927364b3e5e8?s=128&d=identicon&r=PG&f=1", "display_name": "FreddyKay", "link": "https://stackoverflow.com/users/6380478/freddykay"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516806892, "post_id": 48425621, "comment_id": 83841396, "body": "@Someprogrammerdude I edited the question. As I am asking whether to use a map of tuples or something else, I do not have a solution of how to store the data yet. At least none, that seems suitable yet."}, {"owner": {"reputation": 41, "user_id": 6380478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2022c0a2e2de043bb8927364b3e5e8?s=128&d=identicon&r=PG&f=1", "display_name": "FreddyKay", "link": "https://stackoverflow.com/users/6380478/freddykay"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1516807004, "post_id": 48425621, "comment_id": 83841485, "body": "@BartekBanachewicz If it makes a difference, it will be a primitive numeric type, currently I am working with chars, as all values I have seem so far fit into a char."}, {"owner": {"reputation": 1971, "user_id": 2096824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fzfxa.jpg?s=128&g=1", "display_name": "Justin Randall", "link": "https://stackoverflow.com/users/2096824/justin-randall"}, "edited": false, "score": 1, "creation_date": 1516807081, "post_id": 48425621, "comment_id": 83841527, "body": "This is the <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516807122, "post_id": 48425621, "comment_id": 83841562, "body": "In that case I would say that the question is less about finding specific elements, but more about how to create such a &quot;table&quot;. And that really depends on your use-cases... What are you going to use this &quot;table&quot; for? Where are you getting the data from? What is the real problem this table is supposed to solve? Once you know all this, and manage to get a suitable container (standard or custom) to work as you want, then finding specific elements should be pretty straightforward and probably very trivial."}, {"owner": {"reputation": 41, "user_id": 6380478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2022c0a2e2de043bb8927364b3e5e8?s=128&d=identicon&r=PG&f=1", "display_name": "FreddyKay", "link": "https://stackoverflow.com/users/6380478/freddykay"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516808185, "post_id": 48425621, "comment_id": 83842379, "body": "@Someprogrammerdude That is why I am saying I am bumped on how to go about this. The matter of fact is that I am provided a function like above, which expects me to return the corresponding ID. Currently this table is in Excel and will not be available at runtime. I have a hard time coming up with a non convoluted way of storing and retrieving the data (like using tuples and maps). And I am asking whether I am just too blind to see the trivial solution."}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516806794, "post_id": 48425714, "comment_id": 83841321, "body": "As a side note, I&#39;m a big fan of composite indices, <a href=\"http://blog.banachewicz.pl/2015/01/29/unorthodox-index-types.html\" rel=\"nofollow noreferrer\">and wrote a blog post</a> quite a while back that explains the issues and solutions, including the mentioned <code>hash_combine</code>."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1516807643, "post_id": 48425714, "comment_id": 83841932, "body": "I don&#39;t think there&#39;s really any point mentioning <code>std::tuple</code> in your post; even if you don&#39;t use a string, all of the keys in the index are the same type, so <code>array</code> is enough and much easier to use, and then later you transition in <code>array</code> anyhow."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1516807015, "last_edit_date": 1516807015, "creation_date": 1516806603, "answer_id": 48425714, "question_id": 48425621, "link": "https://stackoverflow.com/questions/48425621/how-to-find-item-using-multiple-search-values-in-c/48425714#48425714", "title": "How to find item using multiple search values in c++?", "body": "<p>Yes, the easiest way is to store a mapping from a tuple of values to a name. If your values are <code>char</code>s, however, it's the easiest to simply use <code>string</code> for that, and pack everything into <code>std::unordered_map&lt;std::string, std::string&gt;</code>, the key being all values packed into the string, and the value your name.</p>\n\n<p>If your values aren't <code>char</code>s, it's still not that complex. Instead of using a tuple, you might just use a structure:</p>\n\n<pre><code>struct Key {\n    std::array&lt;Value, n&gt; vals;\n};\n</code></pre>\n\n<p>And then provide <code>std::hash</code> instance that'd fold the array with <code>boost::hash_combine</code>:</p>\n\n<pre><code>class KeyHash  {\n    std::size_t operator()(Key const&amp; k)\n    {\n        std::size_t h = 42;\n        for (Value const&amp; v : k.vals) {\n            boost::hash_combine(h, v);\n        }\n        return h;\n    }\n};\n</code></pre>\n\n<p>The question you've linked and the presented solution aren't bad either, though, and are generic enough to be put into some reusable library.</p>\n"}, {"comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1516807300, "post_id": 48425733, "comment_id": 83841679, "body": "Even if not all vals are chars; I would go with hashing it ... the lookup gains of using std::map are significant enough that the cost of hashing will go away for large data sets."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516807390, "post_id": 48425733, "comment_id": 83841757, "body": "@YSC I don&#39;t understand this comment, <code>unordered_map&lt;string, string&gt;</code> doesn&#39;t need a user provided hash either and it&#39;s way faster."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1516807516, "post_id": 48425733, "comment_id": 83841840, "body": "I have not talked about user-provided hash function, ofc it is better to use map than reinventing fire."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516807539, "post_id": 48425733, "comment_id": 83841857, "body": "@YSC <code>map</code> never uses a hash function though. I just don&#39;t understand your comment at all then."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516807811, "post_id": 48425733, "comment_id": 83842075, "body": "@YSC No, it&#39;s not unneeded, because he said &quot;hash table&quot; not &quot;hash&quot; or &quot;hash function&quot;. <code>unordered_map</code> is a hash table. That comes with its own hash function, for common types, including string."}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": false, "score": 5, "last_activity_date": 1516806645, "creation_date": 1516806645, "answer_id": 48425733, "question_id": 48425621, "link": "https://stackoverflow.com/questions/48425621/how-to-find-item-using-multiple-search-values-in-c/48425733#48425733", "title": "How to find item using multiple search values in c++?", "body": "<p>If all values are characters, I think you'd better transform each line of your table into strings and provide a hash table for the couple ID/stringID. When you get 5 values as char to test you then just have to concat them and run your search.</p>\n"}, {"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516807788, "post_id": 48425735, "comment_id": 83842055, "body": "Why is it downvoted? I appreciate feedback, both good and bad."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1516807976, "post_id": 48425735, "comment_id": 83842201, "body": "Because this not any simpler than other solutions and is O(N), mostly. And if you are already going to declare classes it would make way more sense to declare a class instead of where the tuple is used, making the code clearer. The outside class doesn&#39;t contribute anything to the problem at all."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1516808213, "post_id": 48425735, "comment_id": 83842413, "body": "@NirFriedman Don&#39;t forget than SO encourage multiple answers; the fact than other answers are better than this one (note the <i>&quot;as an alternative&quot;</i> opening) should not be a reason to downvote, though this is your final prerogative. About the outside class... it let me make <code>_data</code> a member instead of a global. It is a subjective choice, it&#39;s mine though."}, {"owner": {"reputation": 41, "user_id": 6380478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2022c0a2e2de043bb8927364b3e5e8?s=128&d=identicon&r=PG&f=1", "display_name": "FreddyKay", "link": "https://stackoverflow.com/users/6380478/freddykay"}, "edited": false, "score": 0, "creation_date": 1516808301, "post_id": 48425735, "comment_id": 83842485, "body": "This is actually something I should&#39;ve thought of too. This completely avoids hashing. Cheers."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 0, "last_activity_date": 1516806654, "creation_date": 1516806654, "answer_id": 48425735, "question_id": 48425621, "link": "https://stackoverflow.com/questions/48425621/how-to-find-item-using-multiple-search-values-in-c/48425735#48425735", "title": "How to find item using multiple search values in c++?", "body": "<p>As an alternative, you can go with <code>std::vector&lt;std::tuple&lt;std::string, char, char, char, char&gt;&gt;</code>:</p>\n\n<pre><code>struct somestruct\n{    \n    std::vector&lt;std::tuple&lt;std::string, char, char, char, char&gt;&gt; _data;\n\n    std::string findID(char val1, char val2, char val3, char val4)\n    {\n        auto it = std::find(begin(_data), end(_data) [](const auto&amp; item) {\n            return item.get&lt;1&gt;() == val1 &amp;&amp; /*...*/;\n        });\n        return it-&gt;get&lt;0&gt;();\n    }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": false, "score": 1, "last_activity_date": 1516863544, "last_edit_date": 1516863544, "creation_date": 1516861708, "answer_id": 48436877, "question_id": 48425621, "link": "https://stackoverflow.com/questions/48425621/how-to-find-item-using-multiple-search-values-in-c/48436877#48436877", "title": "How to find item using multiple search values in c++?", "body": "<p>It appears that you have a 1 to many relationship in your data table, knowing that we can create a simple class that represents an arbitrary row. From there we can create another simple class that takes a row from its constructor and it also has an addRow method to add additional rows. There are no limits on the rows. The table is confined to the size of the first row passed in. So if <code>row1</code> has 3 elements and is passed into <code>table1</code>'s constructor, every other row that is added to this instantiated table must be of the same <code>types</code> and size. These sets of classes are template for both the <code>ID</code> &amp; <code>Types</code>. Here are the basic declarations - definitions of these classes' structures.</p>\n\n<pre><code>template&lt;class ID, class Type&gt;\nclass TableRow {\nprivate:\n    ID id_;\n    std::vector&lt;Type&gt; values_;\n\npublic:\n    template&lt;class... Params&gt;\n    TableRow( const ID&amp; id, Params&amp;&amp;... valuePack ) :\n        id_( id ),\n        values_ { std::forward&lt;Params&gt;( valuePack )... }\n    {}\n\n    ID getID() const {\n        return id_;\n    }\n\n    std::vector&lt;Type&gt; getValues() const {\n        return values_;\n    }\n\n    std::size_t getSize() const {\n        return values_.size();\n    }\n\n};\n\ntemplate&lt;class ID, class Type&gt;\nclass Table {\nprivate:\n    std::size_t rowSize_;\n    std::vector&lt;TableRow&lt;ID, Type&gt;&gt; table_;\n\npublic:\n    explicit Table( TableRow&lt;ID, Type&gt; row ) {\n        table_.push_back( row );\n        rowSize_ = row.getSize();\n    }\n\n    void addRow( TableRow&lt;ID, Type&gt; row ) {\n        // Check to see if row's size == our table's first index size\n        if ( row.getSize() == rowSize_ ) {\n            // This row's size is a match and this row of data is compatabile with our current table\n            table_.push_back( row );\n        } else {\n            std::ostringstream strStream;\n            strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" row passed in does not match size of this table's row size.\" &lt;&lt; std::endl;\n            throw std::exception( strStream.str().c_str() );\n        }\n    }\n\n    // methods to retrieve a row, an id, or a specific element to an id, \n    // comparison operators, ostream friend operators etc. here...\n};\n</code></pre>\n\n<p>And here is an example of instantiating them...</p>\n\n<pre><code>int main() {\n\n    try {\n        std::string id = std::string( \"John\" );\n        std::string val1 = std::string( \"a\" ), val2 = std::string( \"b\" );\n        std::string val3 = std::string( \"c\" ), val4 = std::string( \"d\" );\n        TableRow&lt;std::string, std::string&gt; tr1 { id, val1, val2, val3, val4 };\n\n        Table&lt;std::string, std::string&gt; table( tr1 );\n\n        TableRow&lt;std::string, std::string&gt; tr2( \"Mike\", \"e\", \"f\", \"g\", \"h\" );\n        table.addRow( tr2 );\n\n        TableRow&lt;std::string, std::string&gt; tr3( \"Susan\", \"a\", \"b\", \"c\" );\n        //table.addRow( tr3 ); // exception thrown\n\n        TableRow&lt;unsigned, float&gt; trf1( 0, 2.3f, 4.5f );\n        TableRow&lt;unsigned, float&gt; trf2( 1, 4.5f, 7.8f );\n        Table&lt;unsigned, float&gt; table2( trf1 );\n        table2.addRow( trf2 );\n        TableRow&lt;unsigned, float&gt; trf3( 2, 3.5f, 8.7f, 9.2f, 4.8f );\n\n        //table2.addRow( trf3 ); // exception thrown\n\n        //table.addRow( trf3 ); // will not compile - mismatched TYPES  \n\n    } catch ( std::exception e ) {\n        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;\n\n        std::cout &lt;&lt; \"\\nPress any key and enter to quit.\" &lt;&lt; std::endl;\n        char q;\n        std::cin &gt;&gt; q;\n\n        return -1;\n    }\n\n    std::cout &lt;&lt; \"\\nPress any key and enter to quit.\" &lt;&lt; std::endl;\n    char q;\n    std::cin &gt;&gt; q;\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>If you uncomment either line that says an exception will be thrown you can see how the table catches the mismatch in sizes of different rows as they must be equal in length.</p>\n\n<p>As for the functions to compare, find, display this table; I'll leave that as a continuing exercise.</p>\n\n<p>However I can give you some guidance. Now as for finding an ID based on an entire row or set of data; this should be fairly simple. You would have to compare one vector with another and then return that ID.</p>\n\n<p>However there is a problem with this... Here's an example of the problem...</p>\n\n<pre><code>IDs | val1, val1, val3, val4\n 1  |  a     b      c     d\n 2  |  e     f      g     h\n 3  |  a     b      c     d\n</code></pre>\n\n<p>Here if we are searching this table that has a set with <code>(a,b,c,d)</code>. There are <code>2</code> possible solutions. So you would not be able to directly return a single answer or a single <code>ID</code> as this is an <code>X|Y</code> problem, however because we have nice <code>vectors</code> instead of returning a single answer in this situation you can return a <code>set</code> of answers a container of valid <code>rows</code> or <code>row - ids</code>, but to do this you would have to search through the entire table and for each one that is a match you would have to push that into a temporary container until all matches are found, then return that container back, if there is only a single match you would still be returning a container but it would only contain a single element as it will only be a set of <code>1</code>. </p>\n\n<p>However you did mention this:</p>\n\n<blockquote>\n  <p>Currently I am free to choose how that data will be stored. Essentially I have IDs with some values, which are assigned to the IDs. A set of values is unique to the ID (no set will be repeated for another ID). Individual values can be repeated across IDs.</p>\n</blockquote>\n\n<p>So if the data that already exists does not exhibit this problem, then it should not be of a concern.</p>\n\n<p>So your search would then be something like this from the <code>Table</code>'s class</p>\n\n<pre><code>template&lt;class ID, class Type&gt;\nID Table&lt;ID, Type&gt;::find( const std::vector&lt;Type&gt;&amp; data ) {\n    for ( auto&amp; row : table_ ) {\n        if ( data == row.getValues() ) {\n            return row.getId();\n        } else {\n            std::ostringstream strStream;\n            strStream &lt;&lt; __FUNCTION__ &lt;&lt; \" could not find matching set.\" &lt;&lt; std::endl;\n            throw std::exception( strStream.str().c_str() );\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>As for the classes above, you can even expand on them to increase the table's size if needed.</p>\n\n<p>You would have to add an <code>addItem</code> or <code>addElement</code> method to the <code>TableRow</code> class template, and then in the <code>Table</code> class template you would have to add an <code>addColumn</code> method, there would be two tricks with the <code>addColumn</code> method. The first is that it would be <code>variadic</code> like <code>TableRow</code>'s constructor but the size of the elements would have to be equal to the amount of rows in the table. The other trick would be having to append each element in the parameter pack to each individual row within the table, but this function would also have to update the <code>row's</code> size which shouldn't be all that hard to do.</p>\n\n<p>Another thing to consider would be is if each element in the list of data that belongs to an ID are not of the same type, these class's would have to be modified a little bit, instead of using <code>std::vector&lt;T&gt;</code> you could use <code>std::tuple&lt;...&gt;</code> and from there compare two tuples. </p>\n"}], "owner": {"reputation": 41, "user_id": 6380478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2022c0a2e2de043bb8927364b3e5e8?s=128&d=identicon&r=PG&f=1", "display_name": "FreddyKay", "link": "https://stackoverflow.com/users/6380478/freddykay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 2, "answer_count": 4, "score": 4, "last_activity_date": 1516863544, "creation_date": 1516806317, "last_edit_date": 1516806760, "question_id": 48425621, "link": "https://stackoverflow.com/questions/48425621/how-to-find-item-using-multiple-search-values-in-c", "title": "How to find item using multiple search values in c++?", "body": "<p>Conceptually my data represents a table like this one</p>\n\n<pre><code>+-------+------+------+------+------+  \n|  ID   | Val1 | Val2 | Val3 | Val4 |  \n+-------+------+------+------+------+  \n| Name1 | a    | b    | c    | d    |  \n| Name2 | a    | b    | c    | e    |  \n| Name3 | h    | b    | c    | d    |  \n| Name4 | i    | j    | k    | l    |  \n+-------+------+------+------+------+  \n</code></pre>\n\n<p>Currently I am free to choose how that data will be stored. Essentially I have IDs with some values, which are assigned to the IDs. A set of values is unique to the ID (no set will be repeated for another ID). Individual values can be repeated across IDs.</p>\n\n<p>Now, what I need to do in C++ is to find the name by using a set of Values. So essentially something like this:</p>\n\n<pre><code>std::string findID(char val1, char val2, char val3, char val4)\n{\n    //Do something to find the corresponding Name\n\n    return result;\n}\n</code></pre>\n\n<p>I am currently a bit bumbed on how to go about this. I thought about using a map with tuples, but providing a hash function for the tuples seems like overcomplicating the problem. So basically like described here: <a href=\"https://stackoverflow.com/questions/20834838/using-tuple-in-unordered-map\">Using tuple in unordered_map</a></p>\n\n<p>Is there a simpler solution that I just seem to overlook?</p>\n"}, {"tags": ["c++", "vector", "outofrangeexception"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 2, "creation_date": 1516806036, "post_id": 48425459, "comment_id": 83840729, "body": "<code>And I have a copy constructor which looks fine aswell:</code> no it doesn&#39;t.  reserve doesn&#39;t do what you think it does."}, {"owner": {"reputation": 1971, "user_id": 2096824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fzfxa.jpg?s=128&g=1", "display_name": "Justin Randall", "link": "https://stackoverflow.com/users/2096824/justin-randall"}, "edited": false, "score": 1, "creation_date": 1516806090, "post_id": 48425459, "comment_id": 83840778, "body": "You need to <code>push_back()</code> after <code>reserve()</code> or even better just <code>resize()</code> it which is probably what you wanted."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1516806094, "post_id": 48425459, "comment_id": 83840784, "body": "<code>_matrix = matrix._matrix;</code> seems enough."}, {"owner": {"reputation": 57, "user_id": 7412250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k72y2.jpg?s=128&g=1", "display_name": "Torayl", "link": "https://stackoverflow.com/users/7412250/torayl"}, "edited": false, "score": 0, "creation_date": 1516806207, "post_id": 48425459, "comment_id": 83840880, "body": "Actually, I think I know. It allocates enough memory to contain n elements of type T (the one of the vector) but doesn&#39;t initialize those memory emplacements. But in my case, it doesn&#39;t matter since I&#39;m initializing them right after. I just didn&#39;t want to &quot;waste&quot; operations to null-initialize everything when I&#39;m properly initializing them anyway. Where did I get something wrong?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1516806319, "post_id": 48425459, "comment_id": 83840954, "body": "<code>it doesn&#39;t matter since I&#39;m initializing them right after</code> no you&#39;re not; you&#39;re assigning to them.  There might not seem like much difference but how can operator = be called on an object that doesn&#39;t exist?"}, {"owner": {"reputation": 57, "user_id": 7412250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k72y2.jpg?s=128&g=1", "display_name": "Torayl", "link": "https://stackoverflow.com/users/7412250/torayl"}, "edited": false, "score": 0, "creation_date": 1516806378, "post_id": 48425459, "comment_id": 83841001, "body": "Alright, I see now. Thank you so much for the clarification!"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1516806404, "post_id": 48425459, "comment_id": 83841016, "body": "Side note - your debugger, with a breakpoint in your copy constructor should&#39;ve given you everything you needed :)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1516806548, "post_id": 48425459, "comment_id": 83841137, "body": "<i>vector subscript out of range&quot; exception</i> -- I think that is an <i>assertion</i>, not an exception.  The Visual C++ debug runtime issues a call to <code>assert()</code> to see if your indices exceed <code>vector::size() - 1</code>.  If you want a true exception, throw in a few <code>at()</code> calls instead of using <code>[ ]</code> to access the elements.  Then a <code>std::out_of_range</code> exception would be thrown.."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516806797, "post_id": 48425459, "comment_id": 83841325, "body": "Your coding style is evil.  Identifiers should differ by more than case.  For example, you have a class <code>Perspective</code> and a variable <code>perspective</code>.  This can lead to injected defects when the code is misread or typos.  Also search the internet for &quot;c++ leading underscore&quot;"}, {"owner": {"reputation": 57, "user_id": 7412250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k72y2.jpg?s=128&g=1", "display_name": "Torayl", "link": "https://stackoverflow.com/users/7412250/torayl"}, "edited": false, "score": 0, "creation_date": 1516807049, "post_id": 48425459, "comment_id": 83841513, "body": "<code>Perspective()</code> is actually a method. I appreciate the concern, though, and I see how this can cause issues. I will take a look at leading underscores."}, {"owner": {"reputation": 57, "user_id": 7412250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k72y2.jpg?s=128&g=1", "display_name": "Torayl", "link": "https://stackoverflow.com/users/7412250/torayl"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1516807641, "post_id": 48425459, "comment_id": 83841930, "body": "@PaulMcKenzie It was more of a confusion from me between both terms, I actually meant assertion. I edited my original post for it to be consistent with my issue and for future people with similar issues to find it easier."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1516806087, "creation_date": 1516806087, "answer_id": 48425535, "question_id": 48425459, "link": "https://stackoverflow.com/questions/48425459/vector-subscript-out-of-range-at-return-statement/48425535#48425535", "title": "&quot;Vector subscript out of range&quot;, at return statement?", "body": "<p>In your copy constructor, change this:</p>\n\n<pre><code>_matrix.reserve(4);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>_matrix.resize(4);\n</code></pre>\n\n<p>since you want to actually allocate space with <a href=\"http://www.cplusplus.com/reference/vector/vector/resize/\" rel=\"nofollow noreferrer\"><code>vector::resize</code></a>, in order for <code>_matrix[i][j] = matrix[i][j];</code> to work smoothly. <a href=\"http://www.cplusplus.com/reference/vector/vector/reserve/\" rel=\"nofollow noreferrer\"><code>vector::reserve</code></a> sets the vector's capacity.</p>\n\n<p>Read more in <a href=\"https://stackoverflow.com/questions/7397768/choice-between-vectorresize-and-vectorreserve\">vector resize VS reverse</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1971, "user_id": 2096824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fzfxa.jpg?s=128&g=1", "display_name": "Justin Randall", "link": "https://stackoverflow.com/users/2096824/justin-randall"}, "edited": false, "score": 1, "creation_date": 1516806354, "post_id": 48425573, "comment_id": 83840979, "body": "This is the technically superior copy constructor.  @Torayl go with this."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1516806180, "creation_date": 1516806180, "answer_id": 48425573, "question_id": 48425459, "link": "https://stackoverflow.com/questions/48425459/vector-subscript-out-of-range-at-return-statement/48425573#48425573", "title": "&quot;Vector subscript out of range&quot;, at return statement?", "body": "<p>You wrongly use <code>reserve</code> instead of <code>resize</code>.</p>\n\n<p>But you can simplify your copy constructor to</p>\n\n<pre><code>Matrix4(const Matrix4&amp; rhs) : _matrix(rhs._matrix) {}\n</code></pre>\n\n<p>or even, if applicable:</p>\n\n<pre><code>Matrix4(const Matrix4&amp;) = default;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 3, "last_activity_date": 1516806218, "creation_date": 1516806218, "answer_id": 48425591, "question_id": 48425459, "link": "https://stackoverflow.com/questions/48425459/vector-subscript-out-of-range-at-return-statement/48425591#48425591", "title": "&quot;Vector subscript out of range&quot;, at return statement?", "body": "<p>You have a common mistake. <a href=\"http://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"nofollow noreferrer\"><code>std::vector::reserve</code></a>:</p>\n\n<blockquote>\n  <p>[i]ncrease[s] the capacity of the vector</p>\n</blockquote>\n\n<p>, not the size, Thus you either have to use <code>push_back</code> after reserve, or use resize, like in your normal constructor.</p>\n"}], "owner": {"reputation": 57, "user_id": 7412250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k72y2.jpg?s=128&g=1", "display_name": "Torayl", "link": "https://stackoverflow.com/users/7412250/torayl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 48425535, "answer_count": 3, "score": 3, "last_activity_date": 1516808268, "creation_date": 1516805821, "last_edit_date": 1516808268, "question_id": 48425459, "link": "https://stackoverflow.com/questions/48425459/vector-subscript-out-of-range-at-return-statement", "title": "&quot;Vector subscript out of range&quot;, at return statement?", "body": "<p>My program raises a \"vector subscript out of range\" <s>exception</s> (<strong>EDIT</strong>: assertion) on a return statement. Well, it seems like it since it raises it exactly on that breakpoint.</p>\n\n<p>Here is the function that causes it :</p>\n\n<pre><code>Matrix4 Perspective(float fov, float aspect, float near, float far) const {\n    double yScale = 1.0 / tan(TO_RADIANS * fov / 2);\n    double xScale = yScale / aspect;\n    double depth = near - far;\n\n    Matrix4 perspective;\n\n    perspective[0][0] = xScale;\n    perspective[1][1] = yScale;\n    perspective[2][2] = (far + near) / depth;\n    perspective[2][3] = 2 * far * near / depth;\n    perspective[3][2] = -1;\n    perspective[3][3] = 0;\n\n    return perspective; // Raises exception here?\n}\n</code></pre>\n\n<p>My default <code>Matrix4</code> constructor is fine, it basically does this:</p>\n\n<pre><code>_matrix.resize(4);\n\nfor (unsigned int i = 0; i &lt; 4; ++i)\n    _matrix[i].resize(4);\n</code></pre>\n\n<p><code>_matrix</code> being a <code>std::vector&lt;std::vector&lt;float&gt;&gt;</code> attribute. So everything is set to 0.</p>\n\n<p>Finally, the piece of code that uses the result of the return statement is this:</p>\n\n<p><code>Matrix4 camera = Perspective(70, 1, 0.2, 10);</code></p>\n\n<p>And I have a copy constructor which looks fine aswell:</p>\n\n<pre><code>Matrix4(const Matrix4&amp; matrix) {\n\n    _matrix.reserve(4);\n\n    for (unsigned int i = 0; i &lt; 4; ++i) {\n        _matrix[i].reserve(4);\n\n        for (unsigned int j = 0; j &lt; 4; ++j)\n            _matrix[i][j] = matrix[i][j];\n    }\n}\n</code></pre>\n\n<p>(I also have an overloaded operator[] but the problem really cannot be caused by it.)</p>\n\n<p>The <s>exception</s> assertion seems to be raised on the <code>return perspective;</code>, but maybe it is raised by the line of code that called the method, and the copy constructor somehow failed to copy? But in that case, Visual Studio should bring me inside the constructor since I'm using detailed step-by-step...</p>\n\n<p>I'm lost at this point...</p>\n"}, {"tags": ["c++", "types"], "comments": [{"owner": {"reputation": 249, "user_id": 9184070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c732459e7796687d0a1527b5e93e238?s=128&d=identicon&r=PG&f=1", "display_name": "PPenguin", "link": "https://stackoverflow.com/users/9184070/ppenguin"}, "edited": false, "score": 0, "creation_date": 1516805889, "post_id": 48425324, "comment_id": 83840597, "body": "@BartekBanachewicz Hmm... that&#39;s a good point. For my purposes, &quot;non-pointer&quot; would be adequate, but yes I guess the more general concept would be &quot;trivially serializable&quot;."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1516805925, "post_id": 48425324, "comment_id": 83840627, "body": "There is a <a href=\"http://en.cppreference.com/w/cpp/types/is_pod\" rel=\"nofollow noreferrer\">std::is_pod</a> function."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1516805932, "post_id": 48425324, "comment_id": 83840637, "body": "<i>&quot;I can grab from memory and store on disk,&quot;</i> There is still endianness..."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1516805989, "post_id": 48425324, "comment_id": 83840679, "body": "@Ron <code>struct A { int* p; }</code> is a POD."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516806112, "post_id": 48425324, "comment_id": 83840804, "body": "Storing pointers would still constitute as POD even if the type is trivially constructible and destructible. Even a type storing integers might suffer from invalidation issues if the integers are indexing something in memory that you unload and store on disk, e.g., and then add back later to a different index position. Unfortunately there&#39;s not an easy and automatic way to solve this typically by just looking at data types. You have to kind of consider the design and nature of the data in a less generalized way typically and write the appropriate kind of serialization code."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516806145, "post_id": 48425324, "comment_id": 83840845, "body": "Also it&#39;s a <a href=\"https://stackoverflow.com/questions/32880990/how-to-check-if-class-has-pointers-in-c14#comment53592777_32880990\">potential duplicate</a>, but I don&#39;t want to dupehammer that because it asks a subtly different question."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 2, "creation_date": 1516806280, "post_id": 48425324, "comment_id": 83840930, "body": "I don&#39;t think there is a term for that, and testing it at compile time would be very hard. For instance, you could store addresses existing only in the execution context as integers, and the compiler is not aware of the meaning of what you stored."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516806474, "post_id": 48425324, "comment_id": 83841068, "body": "Consider a case like struct <code>Foo {int idx};</code>  with <code>idx</code> indexing an object of <code>struct Bar {float x, y};</code> stored in <code>std::vector</code>. If you write Bar to disk and remove it from the vector and then add it back later in a different position, <code>Foo</code> would still be invalidated. To me the most practical solution to this kind of problem is going to be a lot less generalized and really consider the context and nature of the data you&#39;re trying to write to disk and then read back out again later on."}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 3, "last_activity_date": 1516805881, "creation_date": 1516805881, "answer_id": 48425484, "question_id": 48425324, "link": "https://stackoverflow.com/questions/48425324/non-pointer-pod-type-in-c/48425484#48425484", "title": "&quot;Non-pointer POD&quot; type in C++", "body": "<p>This can depend on semantics of the structure. I could imagine a struct having <code>int</code> fields being keys into some volatile temporary data store (or cache). You still shouldn't serialize those, but you need internal knowledge about that struct to be able to tell<sup>1</sup>.</p>\n\n<p>In general, C++ lacks features for generic serialization. Making this automatic just on pointers is just a tip of the iceberg (if possibly pretty accurate in general) - it's also <a href=\"https://stackoverflow.com/questions/32880990/how-to-check-if-class-has-pointers-in-c14#comment53592777_32880990\">impossible</a> in a generic way. C++ still has no reflection, and thus no way to check \"every member\" for some condition.</p>\n\n<p>The realistic approaches could be:</p>\n\n<ul>\n<li>preprocessing the class sources before build to scan for pointers</li>\n<li>declaring all structs that are to be serialized with some macros that track the types</li>\n<li>the regular template check could be implemented for a set of known names for fields</li>\n</ul>\n\n<p>All of those have their limitations, though, and together with my earlier reservations, I'm not sure how practical they'd be.</p>\n\n<hr>\n\n<p><sup>1</sup> This of course goes both ways; pointers could be used to store relative offsets, and thus be perfectly serializable.</p>\n"}], "owner": {"reputation": 249, "user_id": 9184070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c732459e7796687d0a1527b5e93e238?s=128&d=identicon&r=PG&f=1", "display_name": "PPenguin", "link": "https://stackoverflow.com/users/9184070/ppenguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 1, "accepted_answer_id": 48425484, "answer_count": 1, "score": 8, "last_activity_date": 1516805881, "creation_date": 1516805491, "question_id": 48425324, "link": "https://stackoverflow.com/questions/48425324/non-pointer-pod-type-in-c", "title": "&quot;Non-pointer POD&quot; type in C++", "body": "<p>Is there a term for a class/struct that is both trivial and standard-layout but also has no pointer members?</p>\n\n<p>Basically I'd like to refer to \"really\" plain-old-data types. Data that I can grab from memory and store on disk, and read back into memory for later processing because it is nothing more than a collection of ints, characters, enums, etc.</p>\n\n<p>Is there a way to test at compile time if a type is a \"really\" plain-old-data type?</p>\n\n<p>related:<br>\n<a href=\"https://stackoverflow.com/questions/146452/what-are-pod-types-in-c\">What are POD types in C++?</a><br>\n<a href=\"https://stackoverflow.com/questions/4178175/what-are-aggregates-and-pods-and-how-why-are-they-special/7189821#7189821\">What are Aggregates and PODs and how/why are they special?</a></p>\n"}, {"tags": ["c++", "parallel-processing", "pipeline", "tbb", "tbb-flow-graph"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 3, "creation_date": 1516805076, "post_id": 48425121, "comment_id": 83840008, "body": "First you have TBB built without exceptions which makes it terminate instead of propagating exceptions. But the reason your source is throwing is that you&#39;re trying to construct <code>std::string</code> from a null pointer which is an error (actually UB but your implementation seems to check that condition, possibly just for debug). You might use an empty string instead, <code>string()</code>, instead of <code>NULL&#47;nullptr</code>."}, {"owner": {"reputation": 1311, "user_id": 3478780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1619710975/picture?type=large", "display_name": "david.t_92", "link": "https://stackoverflow.com/users/3478780/david-t-92"}, "edited": false, "score": 0, "creation_date": 1516805351, "post_id": 48425121, "comment_id": 83840211, "body": "Sorry i&#39;m very new using intel TBB, where I have to use and empy string?, when i declare `orden_fichero&#39;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 1, "creation_date": 1516805468, "post_id": 48425121, "comment_id": 83840286, "body": "When you encounter EOF, you have a <code>return NULL</code>. I believe that&#39;s where you&#39;re trying to construct std::string from a null pointer. If you replace that with <code>return string()</code>, that should take care of the immediate problem at least. The immediate issue is not with how you&#39;re using TBB so much as how you&#39;re using <code>std::string</code>."}, {"owner": {"reputation": 1311, "user_id": 3478780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1619710975/picture?type=large", "display_name": "david.t_92", "link": "https://stackoverflow.com/users/3478780/david-t-92"}, "edited": false, "score": 1, "creation_date": 1516805633, "post_id": 48425121, "comment_id": 83840401, "body": "I&#39;ve just tested if it works at 100%, thousand graces"}, {"owner": {"reputation": 1311, "user_id": 3478780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1619710975/picture?type=large", "display_name": "david.t_92", "link": "https://stackoverflow.com/users/3478780/david-t-92"}, "edited": false, "score": 0, "creation_date": 1516811916, "post_id": 48425121, "comment_id": 83845163, "body": "@TeamUpvote It is possible to parallelize the first statge of the pipline `when I read the document&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516812276, "post_id": 48425121, "comment_id": 83845406, "body": "It&#39;s a little bit tricky with text files but you might do it in two passes. First one can just load the entire thing to memory in a big string. Then you might count the number of lines along with the length of each line in one thread along with the starting string position of each line. This is done in one thread. Then, in a second parallel pass, go through the lines in the string across threads (read-only access) using the starting position and length you captured for each line and do all your parsing and splitting and so forth while writing results to an array of strings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516813289, "post_id": 48425121, "comment_id": 83846107, "body": "This is some very hasty pseudocode but it should communicate the idea: <a href=\"https://paste.ofcode.org/q5XF5GB7UspPHWztAPrWzN\" rel=\"nofollow noreferrer\">paste.ofcode.org/q5XF5GB7UspPHWztAPrWzN</a>"}], "owner": {"reputation": 1311, "user_id": 3478780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1619710975/picture?type=large", "display_name": "david.t_92", "link": "https://stackoverflow.com/users/3478780/david-t-92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516812183, "creation_date": 1516804888, "last_edit_date": 1516812183, "question_id": 48425121, "link": "https://stackoverflow.com/questions/48425121/intel-tbb-read-a-file-apply-a-function-for-each-line-and-save-the-result-to-a", "title": "Intel TBB: read a file, apply a function for each line and save the result to a vector", "body": "<p>With intel TBB I'm trying to read a file `serial', apply a function on each line of the file, and save the result to a vector of a type A.</p>\n\n<pre><code>struct A\n{\n   long long time;\n   double price;\n   A(long long t, double p) : time(t),price(p){};\n}\n</code></pre>\n\n<p>I have created the following pipeline</p>\n\n<pre><code>vector&lt;A&gt; parallelFile(string fileName) {\n\nifstream fe(fileName);\nstring orden_fichero;\nvector&lt;A&gt; ord;\nparallel_pipeline( /*max_number_of_tokens=*/16,\n  make_filter&lt;void,string&gt;(\n          filter::serial,\n          [&amp;](flow_control&amp; fc)-&gt;string\n          {\n            getline(fe,orden_fichero);\n            if(fe.eof())\n                {\n              fc.stop(); // stop processing\n              return NULL;\n                }\n                else\n            {\n              return orden_fichero;\n            }\n          }\n        ) &amp;\n        make_filter&lt;string,A&gt;(\n          filter::parallel,\n          [](string p) -&gt;A{\n           auto position = p.find('\"',28);\n                 auto price = stod(p.substr(position+2));\n                 auto time = dateToMs2(p.substr(0,26).c_str());\n            return A(time, price);\n          }\n        ) &amp;\n        make_filter&lt;A,void&gt;(\n          filter::serial,\n          [&amp;ord](A x) {ord.push_back(x);}\n        )\n      );\n      return ord;\n }\n\n int main()\n {\n    vector&lt;A&gt; david=parallelFile(\"input.txt\");\n\n    return 0;\n }\n</code></pre>\n\n<p>where dateToMs is a function that returns a long long.</p>\n\n<p>Executing this pipline y have the following error:</p>\n\n<pre><code>TBB Warning: Exact exception propagation is requested by application but the \nlinked library is built without support for it\nterminate called after throwing an instance of 'tbb::captured_exception'\n  what():  basic_string::_M_construct null not valid\nAborted (core dumped)\n</code></pre>\n\n<p>I have seen that the first filter of the pipline reads all the file and the error comes at the end of the file.</p>\n\n<p>What I'm doing wrong?</p>\n\n<p>edit: each line of the file have the following structure:\ndd-mm-yyyy hh:mm:ss.msmsms \"CompanyName\" ff.ff</p>\n\n<p>where:</p>\n\n<ul>\n<li>dd-mm-yyyy is the date in form day-month-year</li>\n<li>hh:mm:ss.212313  is the date in hours minutes seconds and miliseconds</li>\n<li>\"companyName\"  is a string</li>\n<li>ff.ff is a double</li>\n</ul>\n"}, {"tags": ["c++", "performance", "blas", "eigen3", "avx2"], "comments": [{"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 2, "creation_date": 1516805244, "post_id": 48425071, "comment_id": 83840135, "body": "Please give a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> of the code."}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1516862461, "post_id": 48425071, "comment_id": 83865241, "body": "With clang, both versions take 180ms (Haswell 2.6GHz), but be careful with such benchmark about 1) aggressive compiler and 2) the fact that there is really too few computations within two time stamps. I would recommend you to look for differences in the generated assembly, there is no reason for them to be different (expect that MSVC is not very good...)"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 0, "creation_date": 1516867340, "post_id": 48425071, "comment_id": 83867268, "body": "As expected from my previous comment, if I replace the call to <code>quadraticMetricNorm</code> by <code>x1.x()</code>, then I get 177ms, so you&#39;re not benchmarking anything relevant."}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 0, "creation_date": 1516871356, "post_id": 48425071, "comment_id": 83869431, "body": "OK, from your assembly it is pretty clear that MSVC failed to generate a proper code because some trivial functions have not been inlined (we can see the calls). Are you sure you enabled full compiler optimizations? I cannot believe that MSVC is that bad at inlining."}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1516871579, "post_id": 48425071, "comment_id": 83869552, "body": "BTW, writing <code>x1.dot(D * x2)</code> might helps MSVC to do its job, but I really think that you are missing a compiler option. MSVC has never been really good at inlining, but I never seen something that bad. Or maybe they completely rewrote their inlining heuristics in the 2017 version, with severe shortcomings..."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 1, "creation_date": 1516871616, "post_id": 48425071, "comment_id": 83869571, "body": "Could you try what happens if you make <code>quadraticMetricNorm</code> return <code>T</code> instead of <code>auto</code>? (generally, avoid using <code>auto</code> for results of Eigen operations)"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1516872720, "post_id": 48425071, "comment_id": 83870265, "body": "chtz&#39;s comment is relevant, especially when using the <code>.transpose() *</code> version which returns an expression. After fixing your code to prevent the compiler from removing everything (I added <code>return arr[argc];</code>), I get 241ms for Eigen vs 263ms for the handwritten code thanks to explicit vectorization for the Eigen version. Recall that among these 241ms, 180ms are spent in calls to <code>high_resolution_clock</code>., so the relative difference is 61ms vs 83ms."}], "owner": {"reputation": 305, "user_id": 9197434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3dc4d24e9ec1122880f639d9be6db2b?s=128&d=identicon&r=PG&f=1", "display_name": "thogra", "link": "https://stackoverflow.com/users/9197434/thogra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1516869459, "creation_date": 1516804785, "last_edit_date": 1516869459, "question_id": 48425071, "link": "https://stackoverflow.com/questions/48425071/eigenlib-and-performance-of-small-matrix-operations", "title": "Eigenlib and performance of small matrix operations", "body": "<p>I chose eigenlib for my project, since I deal with a lot of small scale vector- and matrix-operations. Naturally, I implemented the simple the vector-Matrix-vector product in eigenlib as this function:</p>\n\n<pre><code>const int dims = 2;\n\ntemplate &lt;typename T&gt;\nusing Vec = Eigen::Matrix&lt;T, dims, 1&gt;;\n\ntemplate &lt;typename T&gt;\nusing Mat = Eigen::Matrix&lt;T, dims, dims&gt;;\n\ntemplate &lt;typename T&gt;\ninline auto quadraticMetricNorm(const Vec&lt;T&gt;&amp; x1, const Vec&lt;T&gt;&amp; x2, const Mat&lt;T&gt;&amp; D)\n{\n    return x1.transpose() * D * x2;\n}\n</code></pre>\n\n<p>I expected that the resulting code would be similar to a handcrafted solution:</p>\n\n<pre><code>template &lt;typename T&gt;\ninline auto quadraticMetricNorm(const Vec&lt;T&gt;&amp; x1, const Vec&lt;T&gt;&amp; x2, const Mat&lt;T&gt;&amp; D)\n{\n    return (x1(0, 0) * D(0, 0) + x1(1, 0) * D(1, 0)) * x2(0, 0) \n         + (x1(0, 0) * D(0, 1) + x1(1, 0) * D(1, 1)) * x2(1, 0);\n}\n</code></pre>\n\n<p>and even a bit quicker if I activated AVX2, but after some testing I found out that the handcrafted solution is nearly 3 times as fast according to my profiler in my project. Did I do something wrong, or is Eigenlib's performance just inferior for these small scale problems?</p>\n\n<p>Example:</p>\n\n<pre><code>int main()\n{\n    random_device rd;\n    mt19937 mt(rd());\n    uniform_real_distribution&lt;double&gt; dist(1.0, 10.0);\n\n    std::chrono::nanoseconds total{};\n    const uint64_t max_loops = 10000000;\n    std::vector&lt;double&gt; arr(max_loops);\n\n    for (uint64_t i = 0; i &lt; max_loops; i++)\n    {\n        Vec&lt;double&gt; x1;\n        x1 &lt;&lt; dist(mt), dist(mt);\n\n        Vec&lt;double&gt; x2;\n        x2 &lt;&lt; dist(mt), dist(mt);\n\n        Mat&lt;double&gt; D;\n        D &lt;&lt; dist(mt), dist(mt), dist(mt), dist(mt);\n\n        auto start = chrono::high_resolution_clock::now();\n        arr[i] = quadraticMetricNorm(x1, x2, D);\n        total += chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(chrono::high_resolution_clock::now() - start);\n    }\n\n    cout &lt;&lt; \"Loop took \" &lt;&lt; total.count() / 1000000 &lt;&lt; \"ms\" &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Loop took ~850ms for the first version vs. ~440ms for the second version on my computer.</p>\n\n<p>I'm running Intel i7-5820K CPU on Visual Studio Community 2017, with activated AVX2 in Release mode (Maximize Speed (/O2)).</p>\n\n<p>Thank you for your help in advance!</p>\n\n<h2>Edit</h2>\n\n<p>Since requested, here are the two assemblies. The faster one:</p>\n\n<pre><code>addsd   xmm1, xmm0\nmulsd   xmm1, xmm10\nmulsd   xmm12, xmm7\nmulsd   xmm13, xmm9\naddsd   xmm12, xmm13\nmulsd   xmm12, xmm11\naddsd   xmm1, xmm12\n</code></pre>\n\n<p>The generated code from Eigenlib is much more complex (no AVX2):</p>\n\n<pre><code>lea r8, QWORD PTR D$11[rbp-256]\nlea rdx, QWORD PTR $T7[rbp-256]\nlea rcx, QWORD PTR $T3[rsp]\ncall    ??$?DV?$Matrix@N$01$01$0A@$01$01@Eigen@@@?$MatrixBase@V?$Transpose@$$CBV?$Matrix@N$01$00$0A@$01$00@Eigen@@@Eigen@@@Eigen@@QEBA?BV?$Product@V?$Transpose@$$CBV?$Matrix@N$01$00$0A@$01$00@Eigen@@@Eigen@@V?$Matrix@N$01$01$0A@$01$01@2@$0A@@1@AEBV?$MatrixBase@V?$Matrix@N$01$01$0A@$01$01@Eigen@@@1@@Z ; Eigen::MatrixBase&lt;Eigen::Transpose&lt;Eigen::Matrix&lt;double,2,1,0,2,1&gt; const &gt; &gt;::operator*&lt;Eigen::Matrix&lt;double,2,2,0,2,2&gt; &gt;\nmov rcx, rax\nlea r8, QWORD PTR x2$9[rbp-256]\nlea rdx, QWORD PTR $T5[rsp]\ncall    ??$?DV?$Matrix@N$01$00$0A@$01$00@Eigen@@@?$MatrixBase@V?$Product@V?$Transpose@$$CBV?$Matrix@N$01$00$0A@$01$00@Eigen@@@Eigen@@V?$Matrix@N$01$01$0A@$01$01@2@$0A@@Eigen@@@Eigen@@QEBA?BV?$Product@V?$Product@V?$Transpose@$$CBV?$Matrix@N$01$00$0A@$01$00@Eigen@@@Eigen@@V?$Matrix@N$01$01$0A@$01$01@2@$0A@@Eigen@@V?$Matrix@N$01$00$0A@$01$00@2@$0A@@1@AEBV?$MatrixBase@V?$Matrix@N$01$00$0A@$01$00@Eigen@@@1@@Z ; Eigen::MatrixBase&lt;Eigen::Product&lt;Eigen::Transpose&lt;Eigen::Matrix&lt;double,2,1,0,2,1&gt; const &gt;,Eigen::Matrix&lt;double,2,2,0,2,2&gt;,0&gt; &gt;::operator*&lt;Eigen::Matrix&lt;double,2,1,0,2,1&gt; &gt;\n; File ...\\eigenlib\\eigen\\src\\core\\coreevaluators.h\n\n; 155  :     : m_data(m.data()), m_outerStride(IsVectorAtCompileTime ? 0 : m.outerStride()) \n\nlea rax, QWORD PTR $T10[rbp-240]\nmov QWORD PTR $T10[rbp-256], rax\n; File ...\\eigenlib\\eigen\\src\\core\\cwisebinaryop.h\n\n; 105  :       : m_lhs(aLhs), m_rhs(aRhs), m_functor(func)\n\nmovups  xmm0, XMMWORD PTR $T5[rsp]\nmovups  XMMWORD PTR $T6[rsp+8], xmm0\nmov rax, QWORD PTR $T5[rsp+16]\nmov QWORD PTR $T6[rbp-232], rax\n; File ...\\eigenlib\\eigen\\src\\core\\redux.h\n\n; 453  :   return derived().redux(Eigen::internal::scalar_sum_op&lt;Scalar,Scalar&gt;());\n\nlea rdx, QWORD PTR $T1[rsp]\nlea rcx, QWORD PTR $T6[rsp]\ncall    ??$redux@U?$scalar_sum_op@NN@internal@Eigen@@@?$DenseBase@V?$CwiseBinaryOp@U?$scalar_product_op@NN@internal@Eigen@@$$CBV?$Transpose@$$CBV?$Product@V?$Transpose@$$CBV?$Matrix@N$01$00$0A@$01$00@Eigen@@@Eigen@@V?$Matrix@N$01$01$0A@$01$01@2@$0A@@Eigen@@@3@$$CBV?$Matrix@N$01$00$0A@$01$00@3@@Eigen@@@Eigen@@QEBANAEBU?$scalar_sum_op@NN@internal@1@@Z ; Eigen::DenseBase&lt;Eigen::CwiseBinaryOp&lt;Eigen::internal::scalar_product_op&lt;double,double&gt;,Eigen::Transpose&lt;Eigen::Product&lt;Eigen::Transpose&lt;Eigen::Matrix&lt;double,2,1,0,2,1&gt; const &gt;,Eigen::Matrix&lt;double,2,2,0,2,2&gt;,0&gt; const &gt; const ,Eigen::Matrix&lt;double,2,1,0,2,1&gt; const &gt; &gt;::redux&lt;Eigen::internal::scalar_sum_op&lt;double,double&gt; &gt;\nmovsd   QWORD PTR $T10[rbp-240], xmm0\n</code></pre>\n\n<p>So Visual Studio and Eigenlib simply do not get along very well together?</p>\n"}, {"tags": ["c++", "random"], "comments": [{"owner": {"reputation": 5275, "user_id": 62999, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5ab6fcdfe33af4651586fc92e8faea8b?s=128&d=identicon&r=PG", "display_name": "EKS", "link": "https://stackoverflow.com/users/62999/eks"}, "edited": false, "score": 2, "creation_date": 1516804640, "post_id": 48424998, "comment_id": 83839682, "body": "Post the code you  have?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 3, "creation_date": 1516804641, "post_id": 48424998, "comment_id": 83839684, "body": "1.  define &quot;not work&quot;.   2.  did you seed it?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 5, "creation_date": 1516804662, "post_id": 48424998, "comment_id": 83839702, "body": "C++ standard library does not provide a function named <code>random()</code>. Show your code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 3, "creation_date": 1516804690, "post_id": 48424998, "comment_id": 83839724, "body": "<code>random()</code> isn&#39;t a standard (portable, i..e) function AFAIK. <code>rand()</code> is."}, {"owner": {"reputation": 483, "user_id": 1138688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a351fb5d7eb25907f5136ffa23f18fb?s=128&d=identicon&r=PG", "display_name": "retinotop", "link": "https://stackoverflow.com/users/1138688/retinotop"}, "edited": false, "score": 0, "creation_date": 1516804746, "post_id": 48424998, "comment_id": 83839756, "body": "Could it be that you miss srand(time(NULL)) or something at the beginning?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1516804797, "post_id": 48424998, "comment_id": 83839796, "body": "The <b>operating system</b> has nothing to do with what language and library details the <b>compiler</b> accepts. Some compilers have a thing named <code>random()</code>, but <code>random()</code> is not part of the C or C++ standard libraries."}, {"owner": {"reputation": 38771, "user_id": 31317, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3fde1f239875d7d7ce65c12108d6fdd8?s=128&d=identicon&r=PG", "display_name": "peterchen", "link": "https://stackoverflow.com/users/31317/peterchen"}, "edited": false, "score": 1, "creation_date": 1516804804, "post_id": 48424998, "comment_id": 83839808, "body": "<a href=\"http://www.cplusplus.com/reference/cstdlib/rand/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdlib/rand</a>"}, {"owner": {"reputation": 54, "user_id": 9179901, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4989b2fccd9972a11e68449c988c12a3?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph ", "link": "https://stackoverflow.com/users/9179901/christoph"}, "edited": false, "score": 0, "creation_date": 1516805167, "post_id": 48424998, "comment_id": 83840076, "body": "updated the code into the question"}], "answers": [{"tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": true, "score": 7, "last_activity_date": 1516804799, "creation_date": 1516804799, "answer_id": 48425075, "question_id": 48424998, "link": "https://stackoverflow.com/questions/48424998/why-does-random-not-work-in-windows/48425075#48425075", "title": "Why does random() not work in windows?", "body": "<p>The <a href=\"http://man7.org/linux/man-pages/man3/random.3.html\" rel=\"noreferrer\"><code>random()</code></a> function from <code>stdlib.h</code> is actually a POSIX function, not a C one. So it is only guaranteed to be available in POSIX systems, such as Linux.</p>\n\n<p>If you want to be portable to other C environments, use <a href=\"http://en.cppreference.com/w/cpp/numeric/random/rand\" rel=\"noreferrer\"><code>rand()</code></a>.</p>\n\n<p>Or if you use <code>C++</code>, as your tag suggest, and a not too old compiler, you can use the functions from <a href=\"http://en.cppreference.com/w/cpp/numeric/random\" rel=\"noreferrer\"><code>&lt;random&gt;</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1098, "user_id": 7606400, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/SdaHX.jpg?s=128&g=1", "display_name": "Tornike Gomareli", "link": "https://stackoverflow.com/users/7606400/tornike-gomareli"}, "is_accepted": false, "score": 3, "last_activity_date": 1516804885, "creation_date": 1516804885, "answer_id": 48425118, "question_id": 48424998, "link": "https://stackoverflow.com/questions/48424998/why-does-random-not-work-in-windows/48425118#48425118", "title": "Why does random() not work in windows?", "body": "<p>random() and srandom() are part of POSIX and not available on Windows.\n rand() and srand() are part of the standard library and will be provided by any standard conforming implementation of C++.</p>\n\n<p>You can use <code>&lt;random&gt;</code>, which was implemented in C++11.</p>\n"}], "owner": {"reputation": 54, "user_id": 9179901, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4989b2fccd9972a11e68449c988c12a3?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph ", "link": "https://stackoverflow.com/users/9179901/christoph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1516805064, "accepted_answer_id": 48425075, "answer_count": 2, "score": -6, "last_activity_date": 1516805255, "creation_date": 1516804559, "last_edit_date": 1516805255, "question_id": 48424998, "link": "https://stackoverflow.com/questions/48424998/why-does-random-not-work-in-windows", "closed_reason": "Not suitable for this site", "title": "Why does random() not work in windows?", "body": "<p>Why does the C++ <code>random()</code> command not work on Windows? I made a running program with the <code>random()</code> command on Ubuntu. This command generates a random integer. Online there isn't much to find about this command. What confuses me is that the code is not altered in any way, and the same program is used on both operating systems to run the code. </p>\n\n<p>Is there any structural difference in these 2 operating systems that prohibits the command from working on one of them? </p>\n\n<p>simple code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main() {\n    int r = 0;\n    for (int i=0; i&lt;25; i++){\n        r = random();\n        cout &lt;&lt; r &lt;&lt;endl;\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "texture-mapping"], "comments": [{"owner": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "edited": false, "score": 1, "creation_date": 1516809502, "post_id": 48424988, "comment_id": 83843399, "body": "clamp the edges <code>GL_CLAMP_TO_EDGE</code> or <code>GL_CLAMP</code>"}, {"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "reply_to_user": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "edited": false, "score": 0, "creation_date": 1516810000, "post_id": 48424988, "comment_id": 83843762, "body": "I used GL_CLAMP_TO_EDGE, I forgot to mention, the outer black color outside the square actually data also when the z = 0;  So I don&#39;t believe it&#39;s because the texturewrap."}, {"owner": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "edited": false, "score": 0, "creation_date": 1516810291, "post_id": 48424988, "comment_id": 83843989, "body": "you&#39;re going to have to provide all the <code>::glTexParameteri</code> calls so we can see what you&#39;re doing"}, {"owner": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "edited": false, "score": 0, "creation_date": 1516810384, "post_id": 48424988, "comment_id": 83844054, "body": "what happens if you do <code>gl_FragColor = texture2D(diffuse, tex)</code>"}, {"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "reply_to_user": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "edited": false, "score": 0, "creation_date": 1516810928, "post_id": 48424988, "comment_id": 83844481, "body": "I&#39;m using texture to avoid using the vertices &amp; indices (reduces memory).  In the texture (red) data is contain the heightmap that will be show in color based on the calculation in fragment shader.  So if I do <code>gl_FragColor = texture2D(diffuse, tex)</code> it won&#39;t display the data that I want to show."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1516809986, "post_id": 48426675, "comment_id": 83843758, "body": "I used GL_CLAMP_TO_EDGE, I forgot to mention, the outer black color outside the square actually data also when the z = 0;  So I don&#39;t believe it&#39;s because the texturewrap."}, {"owner": {"reputation": 11, "user_id": 9263071, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e0862f5a79d69a38104cf0adb551b0e8?s=128&d=identicon&r=PG", "display_name": "Honolorakahl", "link": "https://stackoverflow.com/users/9263071/honolorakahl"}, "reply_to_user": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1516811092, "post_id": 48426675, "comment_id": 83844592, "body": "Ok, then maybe this line is the problem: base = colorTable[colorSizeI - 1].xyz;} Looks wrong but can&#39;t help you more because I don&#39;t know the uniform values."}, {"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1516811649, "post_id": 48426675, "comment_id": 83844986, "body": "I prepare buffer in <code>uniform vec4 colorTable[512]</code> because have some option for my colorTable and every option of that has different number of color.  The <code>colorSizeI - 1</code> is to make sure if the height more than some value, color will be the last valid value in colorTable.  So I tried to change it like you suggest, but the interpolation artifacts still there."}, {"owner": {"reputation": 11, "user_id": 9263071, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e0862f5a79d69a38104cf0adb551b0e8?s=128&d=identicon&r=PG", "display_name": "Honolorakahl", "link": "https://stackoverflow.com/users/9263071/honolorakahl"}, "reply_to_user": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1516812543, "post_id": 48426675, "comment_id": 83845585, "body": "I think now I understand what you&#39;re trying to do: you have a texture with values from 0.0 to 1.0 for height but this texture has a border with value 1.0 = maximum height. OpenGL is now interpolating these values in the middle along the border with 1.0. - Looks like you have to remove the border from the texture or stay with GL_NEAREST."}], "tags": [], "owner": {"reputation": 11, "user_id": 9263071, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e0862f5a79d69a38104cf0adb551b0e8?s=128&d=identicon&r=PG", "display_name": "Honolorakahl", "link": "https://stackoverflow.com/users/9263071/honolorakahl"}, "is_accepted": false, "score": 1, "last_activity_date": 1516809625, "creation_date": 1516809625, "answer_id": 48426675, "question_id": 48424988, "link": "https://stackoverflow.com/questions/48424988/outer-artifacts-when-using-gl-linear-in-texture-opengl/48426675#48426675", "title": "Outer artifacts when using GL_LINEAR in Texture OpenGL", "body": "<p>I assume your wrapping for the texture is currently GL_REPEAT. You should try another one.</p>\n\n<p>GL_MIRRORED_REPEAT or GL_CLAMP_TO_EDGE should work.</p>\n"}, {"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1516824411, "post_id": 48430669, "comment_id": 83852411, "body": "Could use &quot;transparent (alpha = 0.0)&quot; as the null color, and then the predefined blend functions should work again."}, {"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1516824809, "post_id": 48430669, "comment_id": 83852601, "body": "Sadly not. It would at best remove half a texelwidth of artifacts but the null color would still bleed into non-null texels, e.g. top of top-left texel would turn from red to yellow whereas zufry wants it to blue to the border."}, {"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1516828202, "post_id": 48430669, "comment_id": 83854353, "body": "For the area with black color, I will put alpha = 0 there.  I show it in black color for make thing easier to explain here.  And also the area with black color it has height = 0 and it goes into these <code>if (color == 0.0f) {base = vec3(0.0f, 0.0f, 0.0f);}</code>.  @Andreas: so in the end it&#39;s a limitation of GL_LINEAR ?  can you give reading material about method your suggest ?"}, {"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "reply_to_user": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1517058509, "post_id": 48430669, "comment_id": 83945414, "body": "@zufryy It is not a method I know of from before. If you want to read something check the documentation for GL_LINEAR and GL_NEAREST. Make sure you understand why you get the erroneous image output, and try figure out an algorithm that satisfies youy requirements from there. Good luck."}, {"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "edited": false, "score": 0, "creation_date": 1517066017, "post_id": 48430669, "comment_id": 83947458, "body": "@Andreas:  The things is when using GL_LINEAR when the pixel try to calculate interpolation and there is null point in the neighbour pixels it will have this kind of situation.  Thus, I just make &quot;dummy&quot; point as an outer boundaries then apply alpha = 0 there."}], "tags": [], "owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "is_accepted": false, "score": 1, "last_activity_date": 1516824228, "last_edit_date": 1516824228, "creation_date": 1516823903, "answer_id": 48430669, "question_id": 48424988, "link": "https://stackoverflow.com/questions/48424988/outer-artifacts-when-using-gl-linear-in-texture-opengl/48430669#48430669", "title": "Outer artifacts when using GL_LINEAR in Texture OpenGL", "body": "<p>The error is because of interpolating from \"null color\" to actual colors in the colr table. To put it short: you can't do that. The concept is broken. Back to the drawing board.</p>\n\n<p>The simplest solution is not having null color, limiting the quad to only the valid area, and doing GL_CLAMP_TO_EDGE as others suggested. </p>\n\n<p>A trickier way is setting GL_NEAREST and then writing the linear sampling yourself in the shader, sampling the texture with <code>tex</code> plus some offsets (manhattan distance should be fine) and skip the null color when blending (the skip part is what is missing from your original concept). The tricky part is getting the offsets right.</p>\n"}, {"comments": [{"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1517057604, "post_id": 48471142, "comment_id": 83945191, "body": "please post a picture of the final result"}, {"owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "reply_to_user": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1517065767, "post_id": 48471142, "comment_id": 83947392, "body": "little bit blurry on the edge. But I can accept it."}], "tags": [], "owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "is_accepted": true, "score": 1, "last_activity_date": 1517065727, "last_edit_date": 1517065727, "creation_date": 1517010359, "answer_id": 48471142, "question_id": 48424988, "link": "https://stackoverflow.com/questions/48424988/outer-artifacts-when-using-gl-linear-in-texture-opengl/48471142#48471142", "title": "Outer artifacts when using GL_LINEAR in Texture OpenGL", "body": "<p>I managed to fixed it with making an outer boundary with the value of interpolation of nearest pixels and put alpha = 0 for that.</p>\n\n<p>It worked nicely, however it cost 2 times of original memory consumption since I need to store the alpha map also.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nNqNG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nNqNG.png\" alt=\"final\"></a></p>\n"}], "owner": {"reputation": 167, "user_id": 551609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72a98b7bc2f09c1ead44c215b9c3f323?s=128&d=identicon&r=PG", "display_name": "zufryy", "link": "https://stackoverflow.com/users/551609/zufryy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 48471142, "answer_count": 3, "score": 2, "last_activity_date": 1517065727, "creation_date": 1516804522, "last_edit_date": 1516810573, "question_id": 48424988, "link": "https://stackoverflow.com/questions/48424988/outer-artifacts-when-using-gl-linear-in-texture-opengl", "title": "Outer artifacts when using GL_LINEAR in Texture OpenGL", "body": "<p>I success to generate the height map using texture in openGL. The full picture of this data is shown in the figure below. However, when I'm using GL_LINEAR option in my glTexParameteri (MinMag) it give me outer artifacts.</p>\n\n<p>this is my glTexParameter</p>\n\n<pre><code>if (interpolate) {\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n}\nelse {\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n}\n\nglTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\nglTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n</code></pre>\n\n<p>Here is my fragment shader code</p>\n\n<pre><code>    \"varying vec2 tex;\\n\"\n    \"uniform int colorSizeI;\\n\"\n    \"uniform vec4 colorTable[512];\\n\"\n    \"uniform vec2 minmaxZ;\\n\"\n    \"uniform vec3 backgroundColor;\\n\"\n    \"uniform sampler2D diffuse;\\n\"\n    \"uniform float transparency;\\n\"\n    \"void main() {\\n\"\n    \"   float color = texture2D(diffuse, tex).r;\\n\"\n    \"   float h = (color - minmaxZ[0])/(minmaxZ[1] - minmaxZ[0]);\\n\"\n    \"   float colorSizeF = float(colorSizeI);\\n\"\n    \"   int i = 0;\\n\"\n    \"   float j = 0.0f;\\n\"\n    \"   vec3 base;\\n\"\n    \"   if (color == 0.0f) {\\n\"\n    \"       base = vec3(0.0f, 0.0f, 0.0f);}\\n\"\n    \"   else if (color &lt;= minmaxZ[0]) {\\n\"\n    \"       base = colorTable[0].xyz;}\\n\"\n    \"   else if (color &gt;= minmaxZ[1]) {\\n\"\n    \"       base = colorTable[colorSizeI - 1].xyz;}\\n\"\n    \"   else { \\n\"\n    \"       while (h &gt;= (j + 1.0f)/colorSizeF) {\\n\"\n    \"           i += 1;\\n\"\n    \"           j += 1.0f;}\\n\"\n    \"       base = mix(colorTable[i].xyz, colorTable[i+1].xyz, colorSizeF*(h - (j/colorSizeF)));}\\n\"\n    \"   gl_FragColor = vec4(base, transparency);\\n\"\n    \"}\\n\";\n</code></pre>\n\n<p>Here is the image when using GL_Nearest (everything is OK)\n<a href=\"https://i.stack.imgur.com/HwV1F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HwV1F.png\" alt=\"using GL Nearest\"></a></p>\n\n<p>Here is the image when using GL_Linear (outer interpolated artifacts comes out)\n<a href=\"https://i.stack.imgur.com/sHlme.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sHlme.png\" alt=\"using GL Linear\"></a></p>\n\n<p>So, anyone know how to remove this artifacts ?</p>\n\n<p>NB: The outer black color is consider the data also when color = 0.</p>\n"}, {"tags": ["c++", "templates", "lambda", "sfinae"], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 5473016, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c81298e5616be0ce939ff6977488a564?s=128&d=identicon&r=PG&f=1", "display_name": "drus", "link": "https://stackoverflow.com/users/5473016/drus"}, "edited": false, "score": 0, "creation_date": 1516807672, "post_id": 48425003, "comment_id": 83841956, "body": "Amazing! I have slightly updated with SFINAE :  <a href=\"https://wandbox.org/permlink/JFJPOiisPPui8MJa\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 401, "user_id": 5473016, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c81298e5616be0ce939ff6977488a564?s=128&d=identicon&r=PG&f=1", "display_name": "drus", "link": "https://stackoverflow.com/users/5473016/drus"}, "edited": false, "score": 0, "creation_date": 1517253270, "post_id": 48425003, "comment_id": 84011493, "body": "Interesting if there is a way to make the following code compile : int i1 = Apply([](int i) { return i; });. In this case, I need explicitely &#39;int&#39; to Function() when deducing Result ( = class Return = std::result_of_t&lt;Function(int)&gt;). But is there a more generic way to deduce lambda parameters ?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 401, "user_id": 5473016, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c81298e5616be0ce939ff6977488a564?s=128&d=identicon&r=PG&f=1", "display_name": "drus", "link": "https://stackoverflow.com/users/5473016/drus"}, "edited": false, "score": 0, "creation_date": 1517304254, "post_id": 48425003, "comment_id": 84030257, "body": "@drus the keyword you&#39;re looking for is (perfect) forwarding. And this can be achieved with C++17. Look around, test, and if you&#39;re stuck ask a new question about it."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 3, "last_activity_date": 1516804579, "creation_date": 1516804579, "answer_id": 48425003, "question_id": 48424942, "link": "https://stackoverflow.com/questions/48424942/overloading-function-when-passing-lambda-as-parameter/48425003#48425003", "title": "Overloading function when passing lambda as parameter", "body": "<p>This is because <a href=\"http://en.cppreference.com/w/cpp/language/template_argument_deduction\" rel=\"nofollow noreferrer\">template deduction</a> needs a perfect-ish match for each of the function arguments in order to successfully deduce  the template parameters.</p>\n\n<p>You'd need to templetize the function object itself:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\ntemplate &lt;class Function, class Return = std::result_of_t&lt;Function()&gt;&gt;\nReturn Apply(Function func)\n{\n    return func();\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; Apply([]() { return 42; }) &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/170452850bacbcfb\" rel=\"nofollow noreferrer\">live demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516805082, "post_id": 48425143, "comment_id": 83840012, "body": "Writting too mutch C++98 deter me from using <code>auto</code> when appropriate :/ +1"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516805377, "post_id": 48425143, "comment_id": 83840231, "body": "@YSC This is really powerful feature of C++11/C++14, we should use them as more as possible."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516805565, "post_id": 48425143, "comment_id": 83840359, "body": "@YSC &quot;when appropriate&quot; sometimes it&#39;s not though ... and the code just gets confusing since you don&#39;t know what type things are.  Not my favorite C# import to the language I&#39;ve got to admit!   (here though it seems to work!)"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1516805914, "post_id": 48425143, "comment_id": 83840615, "body": "@songyuanyao If it wasn&#39;t clear, this is exactly my opinion."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1516808226, "post_id": 48425143, "comment_id": 83842425, "body": "&quot;implicit conversion is not considered in template argument deduction&quot; this is commonly said, but it&#39;s not quite true, I think this phrase is guilty of confusing people. Derived-&gt;base, CV, and array pointer conversions are all implicit and all can occur while calling a function template whose parameters are deduced."}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": false, "score": 4, "last_activity_date": 1516808438, "last_edit_date": 1516808438, "creation_date": 1516804967, "answer_id": 48425143, "question_id": 48424942, "link": "https://stackoverflow.com/questions/48424942/overloading-function-when-passing-lambda-as-parameter/48425143#48425143", "title": "Overloading function when passing lambda as parameter", "body": "<p>Unfortunately you can't do that because the implicit conversion (from lambda closure type to <code>std::function</code>) is not considered in <a href=\"http://en.cppreference.com/w/cpp/language/template_argument_deduction\" rel=\"nofollow noreferrer\">template argument deduction</a>; the code fails because <code>T</code> can't be deduced.</p>\n\n<p>You can use the lambda closure type as the parameter type directly, and declare the return type as <code>auto</code> to be deduced automatically. e.g.</p>\n\n<pre><code>template &lt;typename T&gt;\nauto Apply(T func)\n{\n    return func();\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/i1QnFtO1j4cPuyTF\" rel=\"nofollow noreferrer\">LIVE</a></p>\n"}], "owner": {"reputation": 401, "user_id": 5473016, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c81298e5616be0ce939ff6977488a564?s=128&d=identicon&r=PG&f=1", "display_name": "drus", "link": "https://stackoverflow.com/users/5473016/drus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 48425003, "answer_count": 2, "score": 4, "last_activity_date": 1516808438, "creation_date": 1516804403, "last_edit_date": 1516805952, "question_id": 48424942, "link": "https://stackoverflow.com/questions/48424942/overloading-function-when-passing-lambda-as-parameter", "title": "Overloading function when passing lambda as parameter", "body": "<p>I'm trying to implement template function when return parameter is either void or T. I tried different variations of the code above using sfinae but still not sure if that is in general possible in case lamdba is function parameter.\nThe following code does not compile :</p>\n\n<pre><code>#include &lt;functional&gt;\n\ntemplate &lt;typename T&gt;\nT Apply(const std::function&lt;T()&gt;&amp; func)\n{\n    return func();\n}\n\ntemplate &lt;&gt;\nvoid Apply(const std::function&lt;void()&gt;&amp; func)\n{\n    func();\n}\n\nint main(int argc, char *argv[])\n{\n    int i1 = Apply([]() { return 10; });\n    bool b1 = Apply([]() { return true; });\n    Apply([]() { return; });\n\n    return 0;\n}\n</code></pre>\n\n<p>Error :</p>\n\n<pre><code>error C2672: 'Apply': no matching overloaded function found\nerror C2784: 'T Apply(const std::function&lt;T(void)&gt; &amp;)': could not deduce     template argument for 'const std::function&lt;T(void)&gt; &amp;' from 'main::&lt;lambda_536cc9cae26ef6d0d1fbeb7b66a2e26b&gt;'\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/dpZKMmrc6bMX0tdF\" rel=\"nofollow noreferrer\">wandbox live</a></p>\n"}, {"tags": ["c++", "if-statement", "floating-point", "equality"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1516803973, "post_id": 48424778, "comment_id": 83839128, "body": "sorry, no these two lines are not enough. what is <code>b</code> what is <code>a</code> ? Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1516803978, "post_id": 48424778, "comment_id": 83839135, "body": "They are different. So what&#39;s the question?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1516804074, "post_id": 48424778, "comment_id": 83839213, "body": "do you expect <code>double x = 1; std::cout &lt;&lt; (x == 1);</code> to print <code>1</code> ?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1516804112, "post_id": 48424778, "comment_id": 83839238, "body": "...erm sorry misleading example, but still I guess the dupe has the answer for you"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1516804208, "post_id": 48424778, "comment_id": 83839321, "body": "@HolyBlackCat I just realized 1 sec after hitting return. Nevertheless, in prinicple thats the misunderstanding (i guess...)"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1516804234, "post_id": 48424778, "comment_id": 83839344, "body": "<a href=\"https://repl.it/repls/OrnateFancyRacerunner\" rel=\"nofollow noreferrer\">Cannot reproduce</a>, assuming the first expression produces a value of 1, and the second uses the same unchanged values."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1516804388, "post_id": 48424778, "comment_id": 83839453, "body": "@ArnavBorborah <a href=\"https://repl.it/repls/BleakSpicyNutcracker\" rel=\"nofollow noreferrer\">reproduced</a>"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1516804450, "post_id": 48424778, "comment_id": 83839510, "body": "@harold, Ah, well there wasn&#39;t any of the current information available before, so my comment really has no value. There was no indication whether the values were doubles, or ints."}, {"owner": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1516804600, "post_id": 48424778, "comment_id": 83839637, "body": "@tobi303 I expect it to print 1 when the first statement prints 1."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 1, "creation_date": 1516804814, "post_id": 48424778, "comment_id": 83839823, "body": "@ArnavBorborah actually it doesn really matter, because <code>sqrt</code> returns a floating point in any case and just because in your case it printed <code>1</code> you cannot conclude that it is fine in general. Floating points should (almost) never be compared with <code>==</code>, even if sometimes it seems to work as expected"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1516805056, "post_id": 48424778, "comment_id": 83839988, "body": "If integers are used, then don&#39;t use <code>pow</code> using integers, as even that is not guaranteed to be exact."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1516881689, "post_id": 48424778, "comment_id": 83875963, "body": "A tip: <code>std::hypot()</code> has much less error than <code>std::sqrt(std::pow()+std::pow()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "edited": false, "score": 0, "creation_date": 1516804516, "post_id": 48424917, "comment_id": 83839566, "body": "I already suspected this, my question is effectively why is this happening it seems absurd to store data as such, and how does one deal with this problem."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "edited": false, "score": 1, "creation_date": 1516804634, "post_id": 48424917, "comment_id": 83839677, "body": "@JonathanWoollett-light  For example, if you require exact maths for something like currency then you hold cents rather then dollars in an integer variable of the appropriate size.  Otherwise you need to deal with the fact that there are not enough bits in the universe to exactly represent number like 0.1 (base10) in base2 floating point."}, {"owner": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "edited": false, "score": 0, "creation_date": 1516804759, "post_id": 48424917, "comment_id": 83839768, "body": "Do you know any resources explaining why this occurs? From my knowledge of floating point values using mantissa and exponent it just doesn&#39;t seem reasonable that it cannot simply store 1 as 1 rather than some approximation."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 1, "creation_date": 1516804787, "post_id": 48424917, "comment_id": 83839791, "body": "The value <code>0.1</code> is irrational in binary. Multiplying it by 10 does not give you one because of this. How would you design a storage system to hold an infinite number of numbers in a finite space? The absurdity you see is a well-considered and intentional engineering decision upon which we have, literally, built the world you live in."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1516804887, "post_id": 48424917, "comment_id": 83839870, "body": "floats use binary fractions 1/2; 1/4; 1/8; 1/16 etc so in decimal they are 0.5, 0.25, 0.125; 0.0625 etc have a play trying to make 0.1 out of the above fractions.  Link to info: <a href=\"https://randomascii.wordpress.com/category/floating-point/\" rel=\"nofollow noreferrer\">randomascii.wordpress.com/category/floating-point</a>   In summary <code>0.1f * 10.0f != 1</code> it will be very close though."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "reply_to_user": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "edited": false, "score": 0, "creation_date": 1516804959, "post_id": 48424917, "comment_id": 83839926, "body": "@Jonathan: It can store 1. The problem is that if you ever do math on the 1, which you do here, it is very probably no longer exactly 1. Just very close. One typically does math to get a variable <code>a</code> and then asks if <code>std::abs (a-1)&lt;1e-6</code> or some such. That is, you see if something is close enough."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1516806085, "post_id": 48424917, "comment_id": 83840774, "body": "@Richard: .1 is not irrational. Irrationality is a property of numbers; it is independent of any base used to represent them. You mean .1 is not exactly representable in a finite binary format."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1516807365, "post_id": 48424917, "comment_id": 83841738, "body": "@RichardCritten Well, <a href=\"https://ideone.com/Crih7r\" rel=\"nofollow noreferrer\">it <i>can</i> be</a> <code>0.1f * 10.0f == 1</code>. Implementations are allowed to use a greater precision for intermediate values. Still, for floating point values, it is always better to check if two  values are <i>almost</i> equal."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "reply_to_user": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516810107, "post_id": 48424917, "comment_id": 83843846, "body": "Thanks, @EricPostpischil. This was what I meant."}], "tags": [], "owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "is_accepted": false, "score": 2, "last_activity_date": 1516804342, "creation_date": 1516804342, "answer_id": 48424917, "question_id": 48424778, "link": "https://stackoverflow.com/questions/48424778/floating-point-value-equality-with-integral/48424917#48424917", "title": "Floating point value equality with integral", "body": "<p>The stream output operator is rounding because you don't really want to see 0.999999999999999999997. The math is inexact, and that is being hidden from you. The comparison operator does care about this, though. </p>\n\n<p>Floating point operations require care. </p>\n\n<p>Using <code>std::setprecision ()</code> will allow you to see more digits after the decimal, at which point your problem will be more obvious. </p>\n"}], "owner": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1516804255, "answer_count": 1, "score": 0, "last_activity_date": 1516804639, "creation_date": 1516803887, "last_edit_date": 1516804639, "question_id": 48424778, "link": "https://stackoverflow.com/questions/48424778/floating-point-value-equality-with-integral", "closed_reason": "Duplicate", "title": "Floating point value equality with integral", "body": "<p>This issue fundementally comes down to 2 lines, the 1st line will output 1.    </p>\n\n<pre><code>std::cout &lt;&lt; sqrt(pow(b-&gt;x - a-&gt;x, 2) + pow(b-&gt;y - a-&gt;y, 2) + pow(b-&gt;z - a-&gt;z, 2)) &lt;&lt; std::endl;\n</code></pre>\n\n<p>Yet the 2nd line will output 0, how is this possible?</p>\n\n<pre><code>std::cout &lt;&lt; (sqrt(pow(b-&gt;x - a-&gt;x, 2) + pow(b-&gt;y - a-&gt;y, 2) + pow(b-&gt;z - a-&gt;z, 2)) == 1) &lt;&lt; std::endl;\n</code></pre>\n\n<p>Minimal complete verifiable example:</p>\n\n<pre><code>struct vertice {\n    double x, y, z;\n    vertice(double x, double y, double z) {\n        this-&gt;x = x;\n        this-&gt;y = y;\n        this-&gt;z = z;\n    }\n};\n\nvoid cartDistance(const vertice * a, const vertice * b);\n\nint main() {\n    cartDistance(new vertice(0, 0, 0), new vertice(0, 0, 1));\n    system(\"pause\");\n    return 0;\n}\n\nvoid cartDistance(const vertice * a, const vertice * b) {\n    std::cout &lt;&lt; \"dist: \" &lt;&lt; sqrt(pow(b-&gt;x - a-&gt;x, 2) + pow(b-&gt;y - a-&gt;y, 2) + pow(b-&gt;z - a-&gt;z, 2)) &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"dist check: \" &lt;&lt; (sqrt(pow(b-&gt;x - a-&gt;x, 2) + pow(b-&gt;y - a-&gt;y, 2) + pow(b-&gt;z - a-&gt;z, 2)) == 1) &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "dynamic-allocation", "listiterator"], "comments": [{"owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "edited": false, "score": 4, "creation_date": 1516803530, "post_id": 48424630, "comment_id": 83838776, "body": "What do you mean by breakpoint"}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 13, "creation_date": 1516803556, "post_id": 48424630, "comment_id": 83838795, "body": "change to <code>delete []</code>"}, {"owner": {"reputation": 128, "user_id": 3560035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rvtzn.jpg?s=128&g=1", "display_name": "acco93", "link": "https://stackoverflow.com/users/3560035/acco93"}, "edited": false, "score": 0, "creation_date": 1516803616, "post_id": 48424630, "comment_id": 83838841, "body": "An exception (iterators.exe has triggered a breakpoint.)"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1516803619, "post_id": 48424630, "comment_id": 83838845, "body": "<code>delete [] iterators;</code>"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1516803648, "post_id": 48424630, "comment_id": 83838868, "body": "What is <code>void main()</code>? It&#39;s <i>ancient</i>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1516803886, "post_id": 48424630, "comment_id": 83839050, "body": "<i>Why does this code executed in debug mode trigger a breakpoint?</i> -- Ok, I have to ask the question -- does your real code actually do things like this?"}, {"owner": {"reputation": 128, "user_id": 3560035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rvtzn.jpg?s=128&g=1", "display_name": "acco93", "link": "https://stackoverflow.com/users/3560035/acco93"}, "edited": false, "score": 0, "creation_date": 1516803907, "post_id": 48424630, "comment_id": 83839071, "body": "Forgive me the &#39;void main&#39; it was just to write a code snippet, thanks for the answers. I have to store some linked list element pointers, do you have a better way to do it? I know that they might be invalidated by some operations but I need to know given an element where it is placed in the list."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1516804102, "post_id": 48424630, "comment_id": 83839227, "body": "@acco93 <i>I have to store some linked list element pointers, do you have a better way to do it</i> -- <code>std::vector&lt;std::list&lt;int&gt;::iterator&gt; iterators(50);</code>  Then there is no need for <code>delete []</code>,"}], "answers": [{"tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": true, "score": 3, "last_activity_date": 1516804372, "last_edit_date": 1516804372, "creation_date": 1516803885, "answer_id": 48424777, "question_id": 48424630, "link": "https://stackoverflow.com/questions/48424630/c-array-of-iterators/48424777#48424777", "title": "c++ array of iterators", "body": "<p>As said in comments, if you instantiate an array using</p>\n\n<pre><code>... = new name[];\n</code></pre>\n\n<p>you must use</p>\n\n<pre><code>delete [] name;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 8946639, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_cNeTwyyu4o/AAAAAAAAAAI/AAAAAAAAAWs/Hwm-tsh_j-c/photo.jpg?sz=128", "display_name": "Sebi", "link": "https://stackoverflow.com/users/8946639/sebi"}, "is_accepted": false, "score": 2, "last_activity_date": 1516803972, "creation_date": 1516803972, "answer_id": 48424809, "question_id": 48424630, "link": "https://stackoverflow.com/questions/48424630/c-array-of-iterators/48424809#48424809", "title": "c++ array of iterators", "body": "<p>When you use the operator new[] you must also use the operator delete[], otherwise it is an undefined behavior.</p>\n\n<p>You can check this question for more information:\n<a href=\"https://stackoverflow.com/questions/1553382/is-delete-equal-to-delete\">Is delete[] equal to delete?</a></p>\n"}], "owner": {"reputation": 128, "user_id": 3560035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rvtzn.jpg?s=128&g=1", "display_name": "acco93", "link": "https://stackoverflow.com/users/3560035/acco93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 48424777, "answer_count": 2, "score": -2, "last_activity_date": 1516804372, "creation_date": 1516803473, "last_edit_date": 1516803543, "question_id": 48424630, "link": "https://stackoverflow.com/questions/48424630/c-array-of-iterators", "title": "c++ array of iterators", "body": "<p>Why does this code executed in debug mode trigger a breakpoint?</p>\n\n<pre><code>#include &lt;list&gt;\n\nvoid main() {\n\n  std::list&lt;int&gt;::iterator* iterators = new std::list&lt;int&gt;::iterator[50];\n\n  delete iterators;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "operator-keyword", "copy-elision", "return-value-optimization", "effective-c++"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1516803493, "post_id": 48424584, "comment_id": 83838753, "body": "You can instrument the destructor (have it print something), and this way count how many temporaries are actually created by your compiler. However, you would be hard-pressed to find a compiler where you can disable RVO; all modern compilers I know of perform it unconditionally, even in debug builds with optimizations disabled. Moreover, C++17 standard makes RVO mandatory, rendering the question unequivocally moot."}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1516803495, "post_id": 48424584, "comment_id": 83838756, "body": "do not return <code>const Rational</code> - I mean skip <code>const</code> (but not related to question)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1516803546, "post_id": 48424584, "comment_id": 83838788, "body": "This is a nice question (+1) but I dislike the sentiment intensely. You are asking a &quot;what happens if a soon-to-be-compulsory&quot; feature of C++ is disabled?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1516803659, "post_id": 48424584, "comment_id": 83838875, "body": "<i>How many temporary variables would be created by operator+</i> -- Doesn&#39;t this really depend on the compiler, even if you were able to turn off RVO?  A &quot;bad&quot; compiler may create more temporaries than a &quot;good&quot; compiler, but still achieve the same end result."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1516804151, "post_id": 48424584, "comment_id": 83839272, "body": "@PaulMcKenzie: I think there is an upper limit especially if the constructor or destructor has side-effects."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1516804441, "post_id": 48424584, "comment_id": 83839507, "body": "@Bathsheba -- If the quote from the OP is correct, it looks like even Scott M. isn&#39;t sure -- <i>Probably uses 3 temporary objects,</i> -- the keyword being &quot;Probably&quot;."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1516804519, "post_id": 48424584, "comment_id": 83839570, "body": "@PaulMcKenzie: I&#39;m hoping that the great Scott M. is using &quot;Probably&quot; to mean &quot;Upper bounded by&quot;."}, {"owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1516805189, "post_id": 48424584, "comment_id": 83840087, "body": "@PaulMcKenzie The quote is taken directly from page 108 of the book."}, {"owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1516805258, "post_id": 48424584, "comment_id": 83840142, "body": "@Bathsheba wouldn&#39;t the upper bound be 6 temporaries?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1516805324, "post_id": 48424584, "comment_id": 83840186, "body": "@user3266738: Strictly no more than 3, by my reading. The expression is grouped as ((a + b) + c) + d"}, {"owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1516805550, "post_id": 48424584, "comment_id": 83840347, "body": "@Bathsheba But what about the temporaries created inside <code>operator+</code> when <code>Rational(lhs)</code> is executed to be able to call <code>operator+=</code>? If you consider those, the upper bound is 6? Or are those optimized out of existence in some way?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1516806222, "post_id": 48424584, "comment_id": 83840888, "body": "@user3266738: FYI: &quot;<i>if the return value optimization were disabled, how many temporary variables would be created by operator+?</i>&quot; The same number as would be created if RVO were enabled."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516806960, "post_id": 48424584, "comment_id": 83841451, "body": "Assuming no RVO: (a+b) creates a temporary and creates another to be passed to (b + c), (b+c) creates a temporary and another to be passed to (c+d), (c+d) creates a temporary and another which is assigned to result. That leads to 6 temporaries. The key thing to note is that ((a+b) + c) will pass the result of (a+b) directly to <code>operator+</code> even without RVO since it&#39;s passed by const reference, not by value. Meanwhile with RVO, all those &quot;return and pass somewhere else&quot; temps are eliminated, and you end up with half the temporaries."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516807199, "post_id": 48424584, "comment_id": 83841607, "body": "Not saying that&#39;s how things actually work but probably how he arrived at the estimate of &quot;probably 6 temporaries&quot; without RVO. There&#39;s no &quot;partial RVO&quot; required to pass the result of <code>operator+</code> to another invocation of <code>operator+</code> provided the operands are accepted by const ref. There&#39;s a temp involved local to the function, another to return without RVO, but not another to pass the result as an operand to another call to <code>operator+</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516807358, "post_id": 48424584, "comment_id": 83841728, "body": "So that leads to 3 invocations of <code>operator+</code>, and each one creates two temporaries (one local, another to return the result by value without RVO)."}], "answers": [{"comments": [{"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1516807019, "post_id": 48424753, "comment_id": 83841495, "body": "correct me if I am wrong, but even with Expression templates you still have all the temporaries. That is the language syntax. With expression templates you just delay the computation to the very end (before the assignment)."}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1516807679, "post_id": 48424753, "comment_id": 83841960, "body": "@bolov (If my memory is accurate) suppose the <code>operator+</code> is implemented as <code>return Ratinal(lhs.numerator + rhs.numerator, lhs.denominator + rhs.denominator)</code>, then expression templates could expand <code>a + b + c + d</code> to <code>Ratinal(a.numerator + b.numerator + c.numerator + d.numerator, a.denominator + b.denominator + c.denominator + d.denominator</code>, at least we don&#39;t need 3 temporaries."}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": true, "score": 3, "last_activity_date": 1516808232, "last_edit_date": 1516808232, "creation_date": 1516803808, "answer_id": 48424753, "question_id": 48424584, "link": "https://stackoverflow.com/questions/48424584/how-many-temporary-objects-are-created-when-two-objects-are-added-together-witho/48424753#48424753", "title": "How many temporary objects are created when two objects are added together without the return value optimization?", "body": "<p>I think you're just considering too much, especially with the details of optimization. </p>\n\n<p>For <code>result = a + b + c + d;</code>, the author just want to state that 3 temporaries will be created, the 1st one is for the result of <code>a + b</code>, then 2nd one is for the result of <code>temporary#1 + c</code>, the 3rd one is for <code>temporary#2 + d</code> and then it's assigned to <code>result</code>. After that, 3 temporaries are destroyed. All the temporaries are only used as the intermediate results.</p>\n\n<p>On the other hand, some idioms such like <a href=\"https://stackoverflow.com/a/2598596/3309790\">expression templates</a> could make it possible to get the final result directly with elimination of temporaries.</p>\n"}, {"tags": [], "owner": {"reputation": 1574, "user_id": 239189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUAlH.png?s=128&g=1", "display_name": "jszpilewski", "link": "https://stackoverflow.com/users/239189/jszpilewski"}, "is_accepted": false, "score": 1, "last_activity_date": 1516805531, "creation_date": 1516805531, "answer_id": 48425339, "question_id": 48424584, "link": "https://stackoverflow.com/questions/48424584/how-many-temporary-objects-are-created-when-two-objects-are-added-together-witho/48425339#48425339", "title": "How many temporary objects are created when two objects are added together without the return value optimization?", "body": "<p>Compiler may detect accumulation and apply optimizations but generally shifting and reducing an expression from left to right is somehow tricky as it may be hit by an expression of style a + b * c * d</p>\n\n<p>It is more cautious to take approach of form: </p>\n\n<blockquote>\n  <p>a + (b + (c + d))</p>\n</blockquote>\n\n<p>which will not consume a variable before it might be required by an operator with higher priority. But evaluating it requires temporaries.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1516805799, "creation_date": 1516805799, "answer_id": 48425449, "question_id": 48424584, "link": "https://stackoverflow.com/questions/48424584/how-many-temporary-objects-are-created-when-two-objects-are-added-together-witho/48425449#48425449", "title": "How many temporary objects are created when two objects are added together without the return value optimization?", "body": "<p>No variables are created by the compiler. Because variables are those appearing in the source code, and <strong>variables don't exist at execution time</strong>, or in the executable (they might become memory locations, or be \"ignored\").</p>\n\n<p>Read about the <a href=\"https://en.wikipedia.org/wiki/As-if_rule\" rel=\"nofollow noreferrer\">as-if rule</a>. Compilers are often <a href=\"https://en.wikipedia.org/wiki/Optimizing_compiler\" rel=\"nofollow noreferrer\">optimizing</a>.</p>\n\n<p>See CppCon 2017 <a href=\"https://youtu.be/bSkpMdDe4g4\" rel=\"nofollow noreferrer\">Matt Godbolt \u201cWhat Has My Compiler Done for Me Lately? Unbolting the Compiler's Lid\u201d talk</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": false, "score": 1, "last_activity_date": 1516836445, "last_edit_date": 1592644375, "creation_date": 1516834709, "answer_id": 48433100, "question_id": 48424584, "link": "https://stackoverflow.com/questions/48424584/how-many-temporary-objects-are-created-when-two-objects-are-added-together-witho/48433100#48433100", "title": "How many temporary objects are created when two objects are added together without the return value optimization?", "body": "<p>In the expression <code>a+b+c+d</code> 6 temporaries will be created and destroyed, this is mandatory (with and without RVO). You can check it <a href=\"https://godbolt.org/g/AUcPfs\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>Inside <code>operator +</code> definition, in the expression <code>Rational(lhs)+=a</code>, the prvalue <code>Rational(lhs)</code> will be bound to the <em>implied object parameter</em> of <code>operator+=</code> which is authorized according to this very specific rule <a href=\"https://timsong-cpp.github.io/cppwp/over.match.funcs#5.1\" rel=\"nofollow noreferrer\">[over.match.func]/5.1</a> (refered in <a href=\"https://timsong-cpp.github.io/cppwp/expr.ref#4.3\" rel=\"nofollow noreferrer\">[expr.call]/4</a>)</p>\n<blockquote>\n<p>even if the implicit object parameter is not const-qualified, an rvalue can be bound to the parameter as long as in all other respects the argument can be converted to the type of the implicit object parameter.</p>\n</blockquote>\n<p>Then to bind a prvalue to a reference, temporary materialization must occurs <a href=\"https://timsong-cpp.github.io/cppwp/class.temporary#2.1\" rel=\"nofollow noreferrer\">[class.temporary]/2.1</a></p>\n<blockquote>\n<p>Temporary objects are materialized [...]:</p>\n<ul>\n<li>when binding a reference to a prvalue</li>\n</ul>\n</blockquote>\n<p>So a temporary is created during the excution of each <code>operator +</code> call.</p>\n<p>Then the expression <code>Rational(lhs)+=a</code> which once is returned can <em>conceptualy</em> seen as <code>Rational(Rational(lhs)+=a)</code> is a prvalue (a <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.lval#1.2\" rel=\"nofollow noreferrer\">prvalue</a> is an <em>expression whose evaluation initializes an object</em> - phi:an object in power) which is then bound to the first argument of the 2 subsequent calls to <code>operator +</code>. The cited rule [class.temporary]/2.1 applies twice again and will create 2 temporaries:</p>\n<ol>\n<li>One for materializing the result of <code>a+b</code>,</li>\n<li>the other for materializing the result of <code>(a+b)+c</code></li>\n</ol>\n<p>So at this point 4 temporaries have been created. Then, the third call to <code>operator+</code> creates the 5th temporary inside the function body</p>\n<p>Finaly the result of the last call to <code>operator +</code> is a <em>discarded value expression</em>. This last rule of the standard applies [class.temporary]/2.6:</p>\n<blockquote>\n<p>Temporary objects are materialized [...]:</p>\n<ul>\n<li>when a prvalue appears as a discarded-value expression.</li>\n</ul>\n</blockquote>\n<p>Which produces the 6th temporaries.</p>\n<p>Without RVO the return value is directly materialized, which makes temporary materialization of the return prvalues not necessary anymore. This is why GCC produces the exact same assembly with and without <code>-fno-elide-constructors</code> compiler option.</p>\n<p>In order to avoid temporary materialization, you could define <code>operator +</code>:</p>\n<pre><code>const Rational operator+(Rational lhs, const Rational&amp; rhs)\n{\n    return lhs += rhs;\n}\n</code></pre>\n<p>With such a definition, the prvalue <code>a+b</code> and <code>(a+b)+c</code> would be directly used to initialize to first parameter of <code>operator +</code> which would save you from the materialization of 2 temporaries. See the assembly <a href=\"https://godbolt.org/g/3mVswx\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 48424753, "answer_count": 4, "score": 6, "last_activity_date": 1516836445, "creation_date": 1516803323, "last_edit_date": 1516806741, "question_id": 48424584, "link": "https://stackoverflow.com/questions/48424584/how-many-temporary-objects-are-created-when-two-objects-are-added-together-witho", "title": "How many temporary objects are created when two objects are added together without the return value optimization?", "body": "<p>I decided to ask this question after reading items 20 and 22 of the book \"More Effective C++\" by Scott Meyers.</p>\n\n<p>Let's say you wrote a class to represent rational numbers:</p>\n\n\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Rational\n{\npublic:\n    Rational(int numerator = 0, int denominator = 1);\n\n    int numerator() const;\n    int denominator() const;\n\n    Rational&amp; operator+=(const Rational&amp; rhs); // Does not create any temporary objects\n    ...\n};\n</code></pre>\n\n<p>Now let's say that you decided to implement <code>operator+</code> using <code>operator+=</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const Rational operator+(const Rational&amp; lhs, const Rational&amp; rhs)\n{\n    return Rational(lhs) += rhs;\n}\n</code></pre>\n\n<p>My question is: if the <em>return value optimization</em> were disabled, how many temporary variables would be created by <code>operator+</code>?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Rational result, a, b;\n...\nresult = a + b;\n</code></pre>\n\n<p>I believe 2 temporaries are created: one when <code>Rational(lhs)</code> is executed inside the body of <code>operator+</code>, and another when the value returned by <code>operator+</code> is created by copying the first temporary.</p>\n\n<p>My confusion arose when Scott presented this operation:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Rational result, a, b, c, d;\n...\nresult = a + b + c + d;\n</code></pre>\n\n<p>And wrote: \"Probably uses 3 temporary objects, one for each call to <code>operator+</code>\". I believe that if the <em>return value optimization</em> were disabled, the operation above would use 6 temporary objects (2 for each call to <code>operator+</code>), while if it were enabled, the operation above would use no temporaries at all. How did Scott arrive at his result? I think the only way to do so would be to partially apply the <em>return value optimization</em>.</p>\n"}, {"tags": ["c++", "qt", "qt5", "qtextedit"], "comments": [{"owner": {"reputation": 93, "user_id": 9255461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d20e8aa2bf1916e96585bec6f3700a?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/9255461/kamran"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1516806319, "post_id": 48424541, "comment_id": 83840955, "body": "@eyllanesc They are in two different classes as they they are part of a much bigger project. anyway, in your case it seems it has worked fine, which i have no idea why, what did you do? I&#39;m on ubuntu linux."}], "answers": [{"comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1516809029, "post_id": 48426301, "comment_id": 83843062, "body": ":) Works great!"}, {"owner": {"reputation": 93, "user_id": 9255461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d20e8aa2bf1916e96585bec6f3700a?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/9255461/kamran"}, "edited": false, "score": 0, "creation_date": 1516823917, "post_id": 48426301, "comment_id": 83852139, "body": "@eyllanesc This works great! I marked your answer, thank you for your efforts. I think the painters destructor calls the end and it does go out of scope before I use the image so that might not be the case, and you didn&#39;t use the setLineWrapMode so maybe it has some thing to do with it, It&#39;s late night right now but I will try to fix my code based on yours tomorrow and I&#39;ll update the post. thank you again. :)"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 2, "last_activity_date": 1547855770, "last_edit_date": 1547855770, "creation_date": 1516808506, "answer_id": 48426301, "question_id": 48424541, "link": "https://stackoverflow.com/questions/48424541/qtextdocumentdrawcontents-skips-resources/48426301#48426301", "title": "QTextDocument::DrawContents skips resources?", "body": "<p>In the following code I show how an image should be loaded, then save it to a file, probably the error is that you have not finished painting, for this you must call <code>painter.end()</code> or delete painter from memory.</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QtWidgets&gt;\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n\n    QWidget widget;\n    QVBoxLayout vlayout(&amp;widget);\n    QTextEdit textEdit;\n    QPushButton button(\"save image\");\n    QPushButton loadButton(\"Load and Insert\");\n    vlayout.addWidget(&amp;loadButton);\n    vlayout.addWidget(&amp;textEdit);\n    vlayout.addWidget(&amp;button);\n\n    widget.show();\n\n    textEdit.append(\"some text\");\n\n    QObject::connect(&amp;loadButton, &amp;QPushButton::clicked,[&amp;textEdit](){\n        QString filename =  QFileDialog::getOpenFileName(&amp;textEdit, \"Select\", \"\", \"*.png\");\n        if(!filename.isEmpty()){\n            QImage image(filename);\n            QUrl url = QUrl::fromLocalFile(filename);\n            image = image.scaledToHeight(100, Qt::SmoothTransformation);\n            textEdit.document()-&gt;addResource(QTextDocument::ImageResource, url, image);\n            textEdit.textCursor().insertImage(image);\n        }\n    });\n\n    QObject::connect(&amp;button, &amp;QPushButton::clicked, [&amp;textEdit](){\n        QImage image(textEdit.document()-&gt;size().toSize() , QImage::Format_ARGB32_Premultiplied);\n        image.fill(Qt::transparent);\n        QPainter painter(&amp;image);\n        textEdit.document()-&gt;drawContents(&amp;painter);\n        painter.end();\n        image.save(\"image.png\");\n\n    });\n\n    return a.exec();\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9255461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d20e8aa2bf1916e96585bec6f3700a?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/9255461/kamran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 48426301, "answer_count": 1, "score": 2, "last_activity_date": 1547855770, "creation_date": 1516803205, "last_edit_date": 1592644375, "question_id": 48424541, "link": "https://stackoverflow.com/questions/48424541/qtextdocumentdrawcontents-skips-resources", "title": "QTextDocument::DrawContents skips resources?", "body": "<p>I have this setup:</p>\n<pre><code>// ...\n\n// variable document is a QTextDocument* which has some 'RichText' + 'Images'\n\nQTextEdit textEdit;\n\ntextEdit.setDocument(document);\n\ntextEdit.setLineWrapMode(QTextEdit::LineWrapMode::NoWrap);\n\nauto image = QImage(document-&gt;size().width(), document-&gt;size().height(),\n                       QImage::Format_ARGB32_Premultiplied);\n\nimage.fill(Qt::transparent);\n\nQPainter painter(&amp;image);\n\ndocument-&gt;drawContents(&amp;painter);\n     \n// ...\n</code></pre>\n<p>I'm doing this to have my text rendered in a long horizontal QImage (hence the &quot;NoWrap&quot; LineWrapMode), so I can select a small part of it at a time with QImage::copy(QRect) and create a scrolling text effect.</p>\n<p>The reason I'm doing it this way is that I need to have a QImage at the end which then I would feed its buffer (QImage::bits()) to the hardware that I'm using as my final output.</p>\n<p>So it works great, it displays formatted text with fonts and colors and everything except for the images, it seems to skip them, notice the file icon in &quot;result of text with image&quot; picture.</p>\n<p>This is text only in editor</p>\n<p><img src=\"https://i.stack.imgur.com/U6bDq.png\" alt=\"\" /></p>\n<p>This is result of text only</p>\n<p><img src=\"https://i.stack.imgur.com/d0GZp.png\" alt=\"\" /></p>\n<p>This is text with image in editor</p>\n<p><img src=\"https://i.stack.imgur.com/8faF2.png\" alt=\"\" /></p>\n<p>This is result of text with image</p>\n<p><img src=\"https://i.stack.imgur.com/hNH5B.png\" alt=\"\" /></p>\n<p>This is how I'm inserting images to my QTextDocument:</p>\n<pre><code>QImage image(url.toLocalFile());\n\nif (image.isNull())\n    return;\n\nimage = image.scaledToHeight(getDocumentHeight(), Qt::SmoothTransformation);\n\nauto filename = QUrl(url.fileName());\n\ntextEdit-&gt;document()-&gt;addResource(QTextDocument::ImageResource, filename, image);\n\ntextEdit-&gt;textCursor().insertImage(filename);\n</code></pre>\n<p>So I don't think it's because &quot;DrawContents&quot; fails to find the image resource file or something like this.</p>\n<p>What should I do? Is there something that I'm missing? Any kind of help in the matter is highly appreciated! ;)</p>\n"}, {"tags": ["java", "c++", "asynchronous", "process"], "comments": [{"owner": {"reputation": 5658, "user_id": 8041461, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-nR0Gs4YyO0M/AAAAAAAAAAI/AAAAAAAAAKk/ld4ET5Sgzvw/photo.jpg?sz=128", "display_name": "jrtapsell", "link": "https://stackoverflow.com/users/8041461/jrtapsell"}, "edited": false, "score": 1, "creation_date": 1516804772, "post_id": 48424524, "comment_id": 83839780, "body": "Is it possible the error message goes to STDERR?"}, {"owner": {"reputation": 53, "user_id": 8377372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9109a2355a4db08ef1e438438227f287?s=128&d=identicon&r=PG&f=1", "display_name": "im dumb", "link": "https://stackoverflow.com/users/8377372/im-dumb"}, "reply_to_user": {"reputation": 5658, "user_id": 8041461, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-nR0Gs4YyO0M/AAAAAAAAAAI/AAAAAAAAAKk/ld4ET5Sgzvw/photo.jpg?sz=128", "display_name": "jrtapsell", "link": "https://stackoverflow.com/users/8041461/jrtapsell"}, "edited": false, "score": 0, "creation_date": 1516805481, "post_id": 48424524, "comment_id": 83840293, "body": "@jrtapsell, It might, which is why my code has <code>processBuilder.redirectErrorStream(true);</code> . However, when trying to test the stdout/stderr output, I piped the command into a text file by running <code>command &amp;&gt; test.txt</code> and it seems to not get the lines that I want at all. So, I think the issue might be with the C++ program. Unsure of it though."}, {"owner": {"reputation": 5658, "user_id": 8041461, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-nR0Gs4YyO0M/AAAAAAAAAAI/AAAAAAAAAKk/ld4ET5Sgzvw/photo.jpg?sz=128", "display_name": "jrtapsell", "link": "https://stackoverflow.com/users/8041461/jrtapsell"}, "edited": false, "score": 0, "creation_date": 1516806369, "post_id": 48424524, "comment_id": 83840994, "body": "It could be something to do with either the program not liking being piped, or something changing in the environment which is not the same"}, {"owner": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 1, "creation_date": 1516806559, "post_id": 48424524, "comment_id": 83841146, "body": "There is no reason to use an Executor here.   Just process all the lines before calling <code>process.waitFor()</code>.  This may or may not solve your problem, but simplifying the code will help narrow down the cause.  Also, <i>never</i> write an empty <code>catch</code> block\u2014at the very least, put <code>e.printStackTrace();</code> in there, so you\u2019ll know if something went wrong."}, {"owner": {"reputation": 53, "user_id": 8377372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9109a2355a4db08ef1e438438227f287?s=128&d=identicon&r=PG&f=1", "display_name": "im dumb", "link": "https://stackoverflow.com/users/8377372/im-dumb"}, "reply_to_user": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 0, "creation_date": 1516807369, "post_id": 48424524, "comment_id": 83841741, "body": "@VGR there&#39;s no empty catch block, it was just deleted for brevity. And, I need to process output as the program is running (concurrently), so that way I can see what&#39;s happening with the program. Isn&#39;t the proper way to do that through another thread?"}, {"owner": {"reputation": 275558, "user_id": 522444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16b6783e9b99b1199c75761eaf5c0685?s=128&d=identicon&r=PG", "display_name": "Hovercraft Full Of Eels", "link": "https://stackoverflow.com/users/522444/hovercraft-full-of-eels"}, "reply_to_user": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 0, "creation_date": 1516808281, "post_id": 48424524, "comment_id": 83842465, "body": "??? but you&#39;re calling <code>get()</code> immediately within the calling code -- how is any concurrency going on here? I&#39;m with @VGR, your threading is not &quot;threading&quot;."}, {"owner": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 0, "creation_date": 1516808556, "post_id": 48424524, "comment_id": 83842694, "body": "While it is true that the <a href=\"https://docs.oracle.com/javase/9/docs/api/java/lang/Process.html\" rel=\"nofollow noreferrer\">documentation</a> states \u201cThere is no requirement that the process represented by a Process object execute asynchronously or concurrently with respect to the Java process that owns the Process object,\u201d in practice the process executes asynchronously on every Windows, Unix, and Linux system I\u2019ve encountered.  I suspect the statement was originally intended to cover Windows 9x runtimes."}], "owner": {"reputation": 53, "user_id": 8377372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9109a2355a4db08ef1e438438227f287?s=128&d=identicon&r=PG&f=1", "display_name": "im dumb", "link": "https://stackoverflow.com/users/8377372/im-dumb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516803905, "creation_date": 1516803162, "last_edit_date": 1516803905, "question_id": 48424524, "link": "https://stackoverflow.com/questions/48424524/process-getinputstream-seems-to-overwrite-the-output-from-the-subprocess", "title": "Process.getInputStream() seems to overwrite the output from the subprocess?", "body": "<p>I am trying to get the output of a program (written in C++) from Java by listening to the STDOUT/STDERR. When I run the C++ program through the console, I am able to properly see the expected output, and it works fine. However, when the program ends (I am basically looking for error codes), it spits out 3-4 lines almost immediately and then ends the output. When looking at the output from the console, this is fine. However, when listening to STDOUT from java, I am missing the final line from the output and lines seems to be \"colliding\", like this:</p>\n\n<pre><code>INFO: max_encoded_bytes = 76475 aERROR: RTMP_Connect0, failed to connect socket. 110 (Connection timed out).\n</code></pre>\n\n<p>When they should look like this:</p>\n\n<pre><code>INFO: max_encoded_bytes = 76475 at [line 939: program.cpp]\nERROR: RTMP_Connect0, failed to connect\nFATAL: Error code 200\n</code></pre>\n\n<p>My code currently looks like this:</p>\n\n<pre><code>processBuilder.redirectErrorStream(true);\n\nprocessLock.lock();\n\nlogger.debug(\"Starting \" + name + \" process\");\n\ntry {\n    Process process = processBuilder.start();\n\n    InputStream is = process.getInputStream();\n    InputStreamReader isr = new InputStreamReader(is);\n    BufferedReader br = new BufferedReader(isr);\n\n    Future&lt;?&gt; outputFuture = executor.submit(() -&gt; {\n        br.lines().forEach(line -&gt; {\n            outputHandler.handleOutput(line);\n        });\n    });\n\n    try {\n        process.waitFor();\n        outputFuture.get();\n        logger.debug(name + \" process completed naturally\");\n    } catch (ExecutionException e) {\n        logger.error(\"ExecutionException during \" + name + \" process: \" + e.getMessage());\n    } catch (InterruptedException e) {\n        logger.debug(name + \" process interrupted\");\n        process.destroy();\n    } finally {\n        br.close();\n        isr.close();\n        is.close();\n    }\ncatch (IOException e) { } //etc\n</code></pre>\n\n<p>Which, based on me looking at resources on the web, seems to be pretty standard for processing output.\nI was reviewing some other SO questions that seemed similar, but I wasn't exactly sure since their situations are not identical to mine (see <a href=\"https://stackoverflow.com/questions/6108750/java-output-from-process-buider-overwritten-when-using-bufferedreader\">here</a> and <a href=\"https://stackoverflow.com/questions/22832324/output-from-process-getinputstream-buffered-too-long\">here</a>).</p>\n\n<p>I have tried changing how I am reading from STDOUT through a whole bunch of different libs (removing BufferedStream, using InputStream directly, using ByteArrayOutputStream, changing buffer sizes to some absurdly large and small values, etc..). With the goal of matching the console output and printing out each line as it happens, what can I do to get the output that I think I should be getting?</p>\n"}, {"tags": ["c++", "eigen", "eigen3"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 1, "creation_date": 1516802938, "post_id": 48424257, "comment_id": 83838383, "body": "Oh wait, brain fart! I don&#39;t understand how <code>sizeof</code> of a reference could ever be 1. This question is more interesting than I initially thought. I thought initially there was some kind of implicit type conversion going on, but <code>sizeof</code> for a reference should still be analogical to doing sizeof on a pointer."}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 1, "creation_date": 1516803113, "post_id": 48424257, "comment_id": 83838500, "body": "@TeamUpvote - sizeof  for reference is just sizeof for referenced type. Add to <code>main()</code> <code>std::cout &lt;&lt; sizeof(MatrixBase&lt;float&gt;) &lt;&lt; std::endl;</code> and you&#39;ll see why all of this is as it is"}], "answers": [{"tags": [], "owner": {"reputation": 4795, "user_id": 683905, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7bc5b9f8f9c6f0e5d25b2d88e2cc1386?s=128&d=identicon&r=PG", "display_name": "Jaa-c", "link": "https://stackoverflow.com/users/683905/jaa-c"}, "is_accepted": false, "score": 3, "last_activity_date": 1516804048, "last_edit_date": 1516804048, "creation_date": 1516802997, "answer_id": 48424475, "question_id": 48424257, "link": "https://stackoverflow.com/questions/48424257/story-behind-derived-to-matrixbasederived-conversion/48424475#48424475", "title": "Story behind Derived to MatrixBase&lt;Derived&gt; conversion", "body": "<p><code>sizeof</code> works on compile time types. See <a href=\"http://en.cppreference.com/w/cpp/language/sizeof\" rel=\"nofollow noreferrer\">sizeof</a></p>\n\n<blockquote>\n  <p>When applied to an expression, sizeof does not evaluate the\n  expression, and even if the expression designates a polymorphic\n  object, the result is the size of the static type of the expression.</p>\n</blockquote>\n\n<p>This means that you get the size of <code>MatrixBase&lt;Derived&gt;</code> regardless of what type the instance is.</p>\n\n<p>The expression <code>sizeof(b)</code> is exactly the same as if you wrote <code>sizeof(MatrixBase&lt;Derived&gt;)</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516803192, "post_id": 48424494, "comment_id": 83838552, "body": "The part about ignoring the reference I didn&#39;t quite get. I thought <code>sizeof(reference_type)</code> would be analogical to <code>sizeof(pointer)</code>, like 4 bytes on 32-bit or 8 bytes on 64-bit. It felt like there was slicing going on but I&#39;m still confused why <code>sizeof</code> for a reference type could ever be 1 byte."}, {"owner": {"reputation": 4795, "user_id": 683905, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7bc5b9f8f9c6f0e5d25b2d88e2cc1386?s=128&d=identicon&r=PG", "display_name": "Jaa-c", "link": "https://stackoverflow.com/users/683905/jaa-c"}, "edited": false, "score": 3, "creation_date": 1516803283, "post_id": 48424494, "comment_id": 83838613, "body": "@TeamUpvote sizeof applied to a reference returns size of the referenced type. That is just how it is defined."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1516803319, "post_id": 48424494, "comment_id": 83838638, "body": "@TeamUpvote When <code>sizeof</code> is applied to a reference or reference type, it gives the size of the referenced type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516803466, "post_id": 48424494, "comment_id": 83838738, "body": "Wow! I always thought it was synonymous with doing <code>sizeof</code> on a pointer. Thanks for teaching me something new!"}, {"owner": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "edited": false, "score": 0, "creation_date": 1516803611, "post_id": 48424494, "comment_id": 83838835, "body": "But, sizeof(MatrixBase &lt;Matrix&lt;float, 2, 2&gt;&gt;) also gives 1. Even though the reference is removed."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "edited": false, "score": 2, "creation_date": 1516803636, "post_id": 48424494, "comment_id": 83838859, "body": "@OnurA Exactly. As the answer says, <code>sizeof</code> ignores references (that is, it gives the exact same value for <code>T</code> and for <code>T&amp;</code>, for any <code>T</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516804148, "post_id": 48424494, "comment_id": 83839270, "body": "@Angew Actually I had a super brain fart there because that makes total sense -- just as <code>sizeof(*ptr)</code> would give sizeof a pointee type, <code>sizeof(ref)</code> makes sense to give size of referenced type! I&#39;ve been working in C at my workplace lately and have forgotten some basics of C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "reply_to_user": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "edited": false, "score": 0, "creation_date": 1516804304, "post_id": 48424494, "comment_id": 83839390, "body": "@OnurA I had to look up the <code>Eigen::Matrix</code> docs real quick but it looks like it has 6 different template parameters, not 3. The other 3 are apparently optional but you&#39;d probably need to pass them in to avoid the implicit conversion."}, {"owner": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "edited": false, "score": 0, "creation_date": 1516805237, "post_id": 48424494, "comment_id": 83840130, "body": "@TeamUpvote what I actually wanted to find out was, what happens when the argument is passed. Why would the conversion necessary in that case?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "reply_to_user": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "edited": false, "score": 0, "creation_date": 1516805349, "post_id": 48424494, "comment_id": 83840209, "body": "@OnurA Mismatching types combined with some kind of conversion operator or implicit constructor. I would have thought you could omit the optional template parameters though. I&#39;m not 100% sure why it implicitly converts in this case if you at least specify the 3 template parameters, but only explanation with different <code>sizeof</code> values given these answers."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "edited": false, "score": 3, "creation_date": 1516807150, "post_id": 48424494, "comment_id": 83841580, "body": "@OnurA The only implicit conversion going on is the derived-to-base <i>reference</i> conversion on binding. In reality, it&#39;s just the case of static vs. dynamic type. See the live example I&#39;ve added to the answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1516807709, "post_id": 48424494, "comment_id": 83841979, "body": "I need to get some new glasses because the whole time I failed to notice that <code>MatrixBase</code> was used in the function while <code>Matrix</code> was used by the caller. Thought <code>Matrix</code> was used for both. I&#39;m reaching that age where I&#39;m neither near-sighted nor far-sighted. I just can&#39;t see anything unless it&#39;s at a perfect distance. If it&#39;s too far I can&#39;t see it, if it&#39;s too close I can&#39;t see it. Doh!"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1516813687, "post_id": 48424494, "comment_id": 83846351, "body": "I can confirm your assumption that <code>MatrixBase&lt;Derived&gt;</code> is an empty base class. Eigen uses the CRTP here. If you want the actual size, you can write either <code>sizeof(Derived)</code> or <code>sizeof b.derived()</code>"}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 7, "last_activity_date": 1516807120, "last_edit_date": 1516807120, "creation_date": 1516803069, "answer_id": 48424494, "question_id": 48424257, "link": "https://stackoverflow.com/questions/48424257/story-behind-derived-to-matrixbasederived-conversion/48424494#48424494", "title": "Story behind Derived to MatrixBase&lt;Derived&gt; conversion", "body": "<p><code>sizeof</code> is evaluated at compile time, so it is concerned with the declared (static) type of objects. <code>b</code> is of type <code>MatrixBase&lt;Derived&gt;</code> (ignoring the reference, just like <code>sizeof</code> does), which is most likely an empty base class, and hence has size 1.</p>\n\n<p><code>m</code>, on the other hand, is of type <code>Matrix&lt;float, 2, 2&gt;</code>, which apparently has size 16 on your platform.</p>\n\n<p>I've created a <a href=\"http://coliru.stacked-crooked.com/a/66fecd496c09b2df\" rel=\"nofollow noreferrer\">live example</a> demonstrating this behaviour of <code>sizeof</code>.</p>\n"}], "owner": {"reputation": 541, "user_id": 3599381, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5bf6b2842709d67b8f1d479bfd7decb1?s=128&d=identicon&r=PG&f=1", "display_name": "OnurA", "link": "https://stackoverflow.com/users/3599381/onura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 48424494, "answer_count": 2, "score": 4, "last_activity_date": 1516807120, "creation_date": 1516802311, "last_edit_date": 1516805265, "question_id": 48424257, "link": "https://stackoverflow.com/questions/48424257/story-behind-derived-to-matrixbasederived-conversion", "title": "Story behind Derived to MatrixBase&lt;Derived&gt; conversion", "body": "<p>What happens when you pass a matrix object into a function as a MatrixBase reference? I do not get what really happens behind the scenes.</p>\n\n<p>An example function code would be:</p>\n\n<pre><code>#include &lt;Eigen/Core&gt;\n#include &lt;iostream&gt;\n\nusing namspace Eigen;\n\ntemplate &lt;typename Derived&gt;\nvoid print_size(const MatrixBase&lt;Derived&gt;&amp; b)\n{\n  std::cout &lt;&lt; \"size (rows, cols): \" &lt;&lt; b.size() &lt;&lt; \" (\" &lt;&lt; b.rows()\n            &lt;&lt; \", \" &lt;&lt; b.cols() &lt;&lt; \")\" &lt;&lt; std::endl;\n  std::cout &lt;&lt; sizeof(b) &lt;&lt; std::endl;\n}\n\nint main() {\n    Matrix&lt;float, 2, 2&gt; m;\n    m &lt;&lt; 0.0, 0.1,\n         0.2, 0.3;\n\n    print_size(m);\n    std::cout &lt;&lt; sizeof(m) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>It gives the following output:</p>\n\n<pre><code>size (rows, cols): 4 (2, 2)\n1\n16\n</code></pre>\n\n<p>Where does the 16 vs. 1 difference come from?</p>\n\n<p>And also why would a conversion be necessary?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "netbeans", "netbeans-8"], "comments": [{"owner": {"reputation": 12435, "user_id": 2985643, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eaacaf1426f7e6d02914fcf99dc0a33b?s=128&d=identicon&r=PG&f=1", "display_name": "skomisa", "link": "https://stackoverflow.com/users/2985643/skomisa"}, "edited": false, "score": 1, "creation_date": 1516821189, "post_id": 48424068, "comment_id": 83850525, "body": "Re using Xmx, here is a NetBeans 8.1 bug report response which urges the user to use Xmx to prevent OutOfMemoryError: <a href=\"https://netbeans.org/bugzilla/show_bug.cgi?id=257737\" rel=\"nofollow noreferrer\">netbeans.org/bugzilla/show_bug.cgi?id=257737</a> So what happens when you specify Xmx?"}, {"owner": {"reputation": 932, "user_id": 2516892, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a78c2843e4352a71a47af54c43ecaae1?s=128&d=identicon&r=PG", "display_name": "Qohelet", "link": "https://stackoverflow.com/users/2516892/qohelet"}, "reply_to_user": {"reputation": 12435, "user_id": 2985643, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eaacaf1426f7e6d02914fcf99dc0a33b?s=128&d=identicon&r=PG&f=1", "display_name": "skomisa", "link": "https://stackoverflow.com/users/2985643/skomisa"}, "edited": false, "score": 0, "creation_date": 1516892150, "post_id": 48424068, "comment_id": 83883277, "body": "Using <code>.&#47;netbeans -J-Xmx1500m</code> now, the issue is gone now. Seems I did use the parameter wrong"}, {"owner": {"reputation": 932, "user_id": 2516892, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a78c2843e4352a71a47af54c43ecaae1?s=128&d=identicon&r=PG", "display_name": "Qohelet", "link": "https://stackoverflow.com/users/2516892/qohelet"}, "reply_to_user": {"reputation": 12435, "user_id": 2985643, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eaacaf1426f7e6d02914fcf99dc0a33b?s=128&d=identicon&r=PG&f=1", "display_name": "skomisa", "link": "https://stackoverflow.com/users/2985643/skomisa"}, "edited": false, "score": 0, "creation_date": 1518605400, "post_id": 48424068, "comment_id": 84571983, "body": "@skomisa - I built the project externally. Netbeans really has issues with that. Parsing the trunk like hell"}], "answers": [{"tags": [], "owner": {"reputation": 11811, "user_id": 1215291, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/lorbp.gif?s=128&g=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/1215291/kamil"}, "is_accepted": false, "score": 0, "last_activity_date": 1535141897, "creation_date": 1535141897, "answer_id": 52011203, "question_id": 48424068, "link": "https://stackoverflow.com/questions/48424068/prevent-netbeans-8-1-from-scanning-the-project/52011203#52011203", "title": "Prevent NetBeans 8.1 from Scanning the Project", "body": "<p><strong>Just give it more memory.</strong></p>\n\n<p>Find \"netbeans_default_options\" in your <em>netbeans.conf</em> file add -J-Xmx option:</p>\n\n<blockquote>\n  <p>netbeans_default_options=\"-J-client -J-Xss4m -J-Xms64m <strong><em>-J-Xmx5G</em></strong>\n  -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dsun.java2d.dpiaware=true -J-Dsun.zip.disableMemoryMapping=true\"</p>\n</blockquote>\n\n<p>My NetBeans works pretty good with 5GB of RAM when I open whole linux kernel as a project.</p>\n"}], "owner": {"reputation": 932, "user_id": 2516892, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a78c2843e4352a71a47af54c43ecaae1?s=128&d=identicon&r=PG", "display_name": "Qohelet", "link": "https://stackoverflow.com/users/2516892/qohelet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 795, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535141897, "creation_date": 1516801710, "question_id": 48424068, "link": "https://stackoverflow.com/questions/48424068/prevent-netbeans-8-1-from-scanning-the-project", "title": "Prevent NetBeans 8.1 from Scanning the Project", "body": "<p>I am well aware this issue exists but I wasn't able to find a fix (that works) yet. \nThere's a quite big project I have to import/open in NetBeans 8.1 and this process just takes an eternity and causes several problems every time.</p>\n\n<p>I started it in the command-line on Linux so here's the output:</p>\n\n<pre><code>qohelet@PC ~/netbeans-8.1/bin $ ./netbeans \njava.lang.OutOfMemoryError: GC overhead limit exceeded\nDumping heap to /home/users/qohelet/.netbeans/8.1/var/log/heapdump.hprof ...\nHeap dump file created [1552345961 bytes in 15.428 secs]\n</code></pre>\n\n<p>You can see the problem right here, while the project scans I get several \"<strong>Lack of Memory</strong>\" messages which give forward me to the following Notification:</p>\n\n<blockquote>\n  <p>Resolve Parsing Problem</p>\n  \n  <p>The IDE has detected slowness in parsing the project, which is caused\n  by a lack of available memory. For solutions to this problem, search\n  the IDE help for \"Memory Requirements for Large Projects\"</p>\n</blockquote>\n\n<p><strong>What do I actually want and why do I have 8.1?</strong></p>\n\n<p>I'm working on a C++ project that contains several Python and Perl Scripts. NB 8.1 is the last version that has (quite good) plugins for Python and Perl. </p>\n\n<p>Just canceling the process doesn't work.</p>\n\n<p>There are \"solutions\" to that, I know, so far none of them worked for me:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/18076705/netbeans-scanning-of-project-too-slow\">Netbeans scanning of project too slow</a>\n\n<ul>\n<li>Basically the same with me, just unchecking that box did nothing </li>\n</ul></li>\n<li><a href=\"https://stackoverflow.com/questions/4515622/is-there-a-way-to-stop-netbeans-scanning-projects\">Is there a way to stop NetBeans scanning projects?</a> \n\n<ul>\n<li>Not helpful, I just have one project and it's not Java</li>\n</ul></li>\n<li><a href=\"http://wiki.netbeans.org/FaqSlowNetBeans\" rel=\"nofollow noreferrer\">http://wiki.netbeans.org/FaqSlowNetBeans</a>\n\n<ul>\n<li>Seems NetBeans is well aware of that problem but the article is pretty old and probably doesn't refer to 8.1</li>\n</ul></li>\n</ul>\n\n<p>There are some switches for the <code>netbeans.conf</code> apparently to give more memory to the IDE, but it seems most of them are non existent any more. (Xmx)</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2015"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 6, "creation_date": 1516801543, "post_id": 48423922, "comment_id": 83837416, "body": "You&#39;re initializing a non-const reference with a temporary. This doesn&#39;t look right. What&#39;s the intent here?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516803046, "post_id": 48423922, "comment_id": 83838452, "body": "What @BartekBanachewicz says plus why does this function need a default at all ?"}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516803263, "post_id": 48423922, "comment_id": 83838595, "body": "@BartekBanachewicz yep - that the warning just said - VS has this non-standard extension since the beginning - one of many"}, {"owner": {"reputation": 106, "user_id": 5811471, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b983e7ff6010e45f6b27a54a1a11d01d?s=128&d=identicon&r=PG&f=1", "display_name": "da-chiller", "link": "https://stackoverflow.com/users/5811471/da-chiller"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516867972, "post_id": 48423922, "comment_id": 83867562, "body": "@BartekBanachewicz: Intention? This is an old grown project and the signature actually has another argument. So I can only guess that this method had only the other once and for compatibility reasons the second had to came up with a default value. No docs at all.... But thank you all, I will correct this, since there is no real value in initialization at this point."}], "owner": {"reputation": 106, "user_id": 5811471, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b983e7ff6010e45f6b27a54a1a11d01d?s=128&d=identicon&r=PG&f=1", "display_name": "da-chiller", "link": "https://stackoverflow.com/users/5811471/da-chiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516801335, "creation_date": 1516801335, "question_id": 48423922, "link": "https://stackoverflow.com/questions/48423922/vs-compiler-warning-4239-caused-by-default-argument", "title": "VS Compiler warning 4239 caused by default argument", "body": "<p>I have this declaration of a method and faced to a VS2015 compiler warning C4239: </p>\n\n<blockquote>\n  <p>warning C4239: nonstandard extension used: 'default argument': conversion from 'std::shared_ptr' to 'std::shared_ptr &amp;'</p>\n  \n  <blockquote>\n    <p>note: A non-const reference may only be bound to an lvalue</p>\n  </blockquote>\n</blockquote>\n\n<p><code>void checkMe(shared_ptr&lt;string&gt;&amp; param = shared_ptr&lt;string&gt;());</code></p>\n\n<p>This <a href=\"https://msdn.microsoft.com/query/dev14.query?appId=Dev14IDEF1&amp;l=EN-US&amp;k=k(C4239)&amp;rd=true\" rel=\"nofollow noreferrer\">MSDN</a> article says it is a /W4 warning. Fun fact: /W3 is set.</p>\n\n<p>To be honest, I'm not a pro regarding default arguments, but in the implementation is no real use of having an empty instance of the <code>shared_ptr</code> without usage afterwards. But I'd rather understand the issue than adjusting  the functionality.</p>\n\n<p>How and why then can I get rid of the warning? Or is there any legal way of doing this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1516801420, "post_id": 48423850, "comment_id": 83837339, "body": "what version of c++?  11, 17, 98?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516801422, "post_id": 48423850, "comment_id": 83837340, "body": "What do you mean by &quot;max coordinates&quot;? Coordinates where <code>double</code> is maxed?"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1516801445, "post_id": 48423850, "comment_id": 83837356, "body": "use 3 nested <code>for</code> loop is simpler and maybe more clear"}, {"owner": {"reputation": 177, "user_id": 8099840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/02f373de9cc39dd88d6f99b7155d48ec?s=128&d=identicon&r=PG&f=1", "display_name": "Mar", "link": "https://stackoverflow.com/users/8099840/mar"}, "edited": false, "score": 2, "creation_date": 1516801541, "post_id": 48423850, "comment_id": 83837413, "body": "I use c++11. And for the maximum coordinates I mean moutain_table[i][j][k] whose value (a double) is the maximum."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 4, "creation_date": 1516801790, "post_id": 48423850, "comment_id": 83837571, "body": "You cannot use <code>max_element</code> because the standard algorithms work on ranges and your data is not arranged in such a way. I&#39;d advise you to linearize your data."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1516802120, "post_id": 48423850, "comment_id": 83837801, "body": "@Mar I suggest you to edit your question, your &quot;max coordinates&quot; statement is pretty confusing."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 2, "creation_date": 1516802578, "post_id": 48423850, "comment_id": 83838117, "body": "I think that the answers highlight how much you should change your data organisation..."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1516802663, "post_id": 48423850, "comment_id": 83838168, "body": "What do you expect to be returned when 2 values are the same?  I don&#39;t think you need to answer that here; but it&#39;s something you should know the answer to."}], "answers": [{"tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1516802272, "last_edit_date": 1516802272, "creation_date": 1516801518, "answer_id": 48423995, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector/48423995#48423995", "title": "Find max position in a vector of vector of vector", "body": "<pre><code>std::size_t rv[3] = {0};\nstd::size_t i = 0;\ndouble max_value = mountain_table[0][0][0];\nfor (const auto&amp; x : mountain_table) {\n  std::size_t j = 0;\n  for (const auto&amp; y : x) {\n    auto it = std::max_element(y.begin(), y.end());\n    if (*it &gt; max_value) {\n      rv[0] = i; rv[1] = j; rv[2] = it - y.begin();\n      max_value = *it;\n    }\n    ++j;\n  }\n  ++i;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 5, "creation_date": 1516802055, "post_id": 48424020, "comment_id": 83837752, "body": "typo &quot;don&#39;t&quot; -&gt; &quot;do&quot; ?"}], "tags": [], "owner": {"reputation": 326, "user_id": 4532644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e73a60c15edb6141cd387cb00544cea2?s=128&d=identicon&r=PG&f=1", "display_name": "hagor", "link": "https://stackoverflow.com/users/4532644/hagor"}, "is_accepted": false, "score": -1, "last_activity_date": 1516801576, "creation_date": 1516801576, "answer_id": 48424020, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector/48424020#48424020", "title": "Find max position in a vector of vector of vector", "body": "<p>You should use \"for\" loop , because you don't have 3d vector.</p>\n\n<pre><code>for (size_t i = 0; i &lt;mountain_table.size(); ++i)\n{\n  for (size_t j = 0; j &lt; mountain_table[i].size() ++j)\n    {\n     // find max element index k here and check if it is maximum.\n     // If yes save i, j, k and update max val\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 0, "creation_date": 1516802322, "post_id": 48424208, "comment_id": 83837947, "body": "The most obvious being <code>highestValue</code> should be a <code>double</code>"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 0, "creation_date": 1516802389, "post_id": 48424208, "comment_id": 83837989, "body": "@NickA My mistake; fixed it"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1516802404, "post_id": 48424208, "comment_id": 83838002, "body": "@Salva size_t is unsigned and there&#39;s 3 comparisons?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1516802447, "post_id": 48424208, "comment_id": 83838034, "body": "@UKMonkey indeed"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516802533, "post_id": 48424208, "comment_id": 83838085, "body": "@Slava fixed the unsigned thing as well. What is the third warning."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1516802611, "post_id": 48424208, "comment_id": 83838136, "body": "@ArnavBorborah you&#39;re assigning -1 to an unsigned variable?"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516802699, "post_id": 48424208, "comment_id": 83838194, "body": "@Slava <i>facepalm</i>. Fixed anyways."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1516802786, "post_id": 48424208, "comment_id": 83838270, "body": "<code>double highestValue = -1;</code> all doubles could be negative, less than -1 then you have wrong output"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 1, "creation_date": 1516802817, "post_id": 48424208, "comment_id": 83838290, "body": "@KillzoneKid made changes to take care of that as well."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516803576, "post_id": 48424208, "comment_id": 83838814, "body": "Another issue that nobody said that all vectors are not empty, so <code>mountain_table[0][0][0]</code> could be UB :)"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516803938, "post_id": 48424208, "comment_id": 83839102, "body": "I am not sure if my current fix is valid @Slava, could you verify?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516808643, "post_id": 48424208, "comment_id": 83842751, "body": "@ArnavBorborah it depends if jagged matrix is allowed. If yes then your code is not valid (you cannot be sure that element with index 0,0,0 exists)"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516809965, "post_id": 48424208, "comment_id": 83843735, "body": "Initialize <code>highestValue </code> with -inf"}], "tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": true, "score": 3, "last_activity_date": 1516810104, "last_edit_date": 1516810104, "creation_date": 1516802144, "answer_id": 48424208, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector/48424208#48424208", "title": "Find max position in a vector of vector of vector", "body": "<p>Here is how I would do it, by looping over the matrix, checking for highest values, and recording its indexes.</p>\n\n<pre><code>size_t highestI = 0;\nsize_t highestJ = 0;\nsize_t highestK = 0;\n\ndouble highestValue = -std::numeric_limits&lt;double&gt;::infinity(); // Default value (Include &lt;limits&gt;)\n\nfor (size_t i = 0; i &lt; mountain_table.size(); ++i)\n{\n    for (size_t j = 0; j &lt; mountain_table[i].size(); ++j)\n    {\n        for (size_t k = 0; k &lt; mountain_table[i][j].size(); ++k)\n        {\n            if (mountain_table[i][j][k] &gt; highestValue)\n            {\n                highestValue = mountain_table[i][j][k]; // Highest \n                // value needed to figure out highest indexes\n                // Stores the current highest indexes\n                highestI = i; \n                highestJ = j;\n                highestK = k;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This may not be the most efficient algorithm, but it gets the job done in an understandable way.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516830913, "post_id": 48424292, "comment_id": 83855705, "body": "How do you know that you can access <code>vector[0][0][0]</code> ?"}, {"owner": {"reputation": 1736, "user_id": 7216259, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NyCby.jpg?s=128&g=1", "display_name": "Maro\u0161 Be\u0165ko", "link": "https://stackoverflow.com/users/7216259/maro%c5%a1-be%c5%a5ko"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516832839, "post_id": 48424292, "comment_id": 83856670, "body": "@Slava I don&#39;t and this example isn&#39;t the exact code I would use myself but rather a demonstration of how the problem can be solved. Like for example if I were to add <code>if (vector.empty()) return ...;</code> what should the function return?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516832918, "post_id": 48424292, "comment_id": 83856713, "body": "I think you did not understand, <code>vector[0][0][0]</code> can be inaccessible even when vector is not empty"}, {"owner": {"reputation": 1736, "user_id": 7216259, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NyCby.jpg?s=128&g=1", "display_name": "Maro\u0161 Be\u0165ko", "link": "https://stackoverflow.com/users/7216259/maro%c5%a1-be%c5%a5ko"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516833016, "post_id": 48424292, "comment_id": 83856754, "body": "@Slava And how exacly?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516833186, "post_id": 48424292, "comment_id": 83856841, "body": "Look for jagged array, for example <code>vector[0][0].size()</code> can be equal to 0, but <code>vector[0][1].size()</code> is not."}, {"owner": {"reputation": 1736, "user_id": 7216259, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NyCby.jpg?s=128&g=1", "display_name": "Maro\u0161 Be\u0165ko", "link": "https://stackoverflow.com/users/7216259/maro%c5%a1-be%c5%a5ko"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516833373, "post_id": 48424292, "comment_id": 83856916, "body": "Yes I know that every layer of the vector can be empty and also using 3 vectors to represent a 3d matrix makes no sense since each &#39;row&#39; can be of different size. That&#39;s why I added the suggestion at the end instead of trying to make this function for badly designed base optimal and error proof."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516833813, "post_id": 48424292, "comment_id": 83857119, "body": "It depends, actual data may need different row to be different size, enforce it to have the same size everywhere could be not practical"}], "tags": [], "owner": {"reputation": 1736, "user_id": 7216259, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NyCby.jpg?s=128&g=1", "display_name": "Maro\u0161 Be\u0165ko", "link": "https://stackoverflow.com/users/7216259/maro%c5%a1-be%c5%a5ko"}, "is_accepted": false, "score": 3, "last_activity_date": 1516804564, "last_edit_date": 1516804564, "creation_date": 1516802412, "answer_id": 48424292, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector/48424292#48424292", "title": "Find max position in a vector of vector of vector", "body": "<p>Since the <a href=\"http://en.cppreference.com/w/cpp/algorithm/max_element\" rel=\"nofollow noreferrer\"><code>max_element</code></a> function is pretty short and easy to implement, I would suggest to write something similar yourself to fit your exact scenario.</p>\n\n<pre><code>// For types like this I would suggest using a type alias\nusing Vector3d = std::vector&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;;\n\nstd::array&lt;size_t, 3&gt; max_element(const Vector3d&amp; vector) {\n    std::std::array&lt;size_t, 3&gt; indexes;\n    double biggest = vector[0][0][0];\n    for (unsigned i = 0; i &lt; vector.size(); ++i)\n        for (unsigned j = 0; j &lt; vector[i].size(); ++j)\n            for (unsigned k = 0; k &lt; vector[i][j].size(); ++k)\n                if (value &gt; biggest) {\n                    biggest =  value;\n                    indexes = { i, j, k };\n                }\n    return indexes;\n}\n</code></pre>\n\n<p>One other suggestion I could give you is to write your custom class <code>Vector3d</code>, with convenient functions like <code>operator()(int x, int y, int z)</code> etc. and save the data internally in simple <code>vector&lt;double&gt;</code> of size <code>width * height * depth</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10545, "user_id": 238902, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BRFti.png?s=128&g=1", "display_name": "Default", "link": "https://stackoverflow.com/users/238902/default"}, "edited": false, "score": 0, "creation_date": 1516804114, "post_id": 48424437, "comment_id": 83839241, "body": "this doesn&#39;t support a jagged matrix though"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 10545, "user_id": 238902, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BRFti.png?s=128&g=1", "display_name": "Default", "link": "https://stackoverflow.com/users/238902/default"}, "edited": false, "score": 0, "creation_date": 1516804307, "post_id": 48424437, "comment_id": 83839396, "body": "@Default Indeed! A <code>std::map&lt;std::size_t, value_type&gt;</code> would be used to support parsed matrixes. But since OP don&#39;t need it ;)"}, {"owner": {"reputation": 10545, "user_id": 238902, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BRFti.png?s=128&g=1", "display_name": "Default", "link": "https://stackoverflow.com/users/238902/default"}, "edited": false, "score": 0, "creation_date": 1516804540, "post_id": 48424437, "comment_id": 83839589, "body": "really? I&#39;m intrigued but unfortunately I cannot visualize it. Would you mind giving a hint on how map would solve jagged arrays?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 10545, "user_id": 238902, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BRFti.png?s=128&g=1", "display_name": "Default", "link": "https://stackoverflow.com/users/238902/default"}, "edited": false, "score": 0, "creation_date": 1516804989, "post_id": 48424437, "comment_id": 83839945, "body": "@Default just replace <code>std::vector&lt;value_type&gt;</code> with <code>std::map&lt;std::size_t, value_type&gt;</code>. <code>_data[index]</code> will still be valid but will have a different meaning, creating values <i>on demand</i>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1516830954, "post_id": 48424437, "comment_id": 83855732, "body": "It can be std::map&lt;std::tuple&lt;int,int,int&gt;,double&gt;"}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 4, "last_activity_date": 1516803233, "last_edit_date": 1516803233, "creation_date": 1516802882, "answer_id": 48424437, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector/48424437#48424437", "title": "Find max position in a vector of vector of vector", "body": "<p>I'd suggest to linearize your data in order to be able to use standard algorithms. The idea is to provide a couple of functions to get an index from 3D coords and <em>vice et versa</em>:</p>\n\n<pre><code>template&lt;class T&gt;\nclass Matrix3D // minimal\n{\npublic:\n    using value_type = T;\n    using iterator   = std::vector&lt;value_type&gt;::iterator;\n\nprivate:\n    std::vector&lt;value_type&gt; _data;\n    size_t _sizex, _sizey, _sizez;\n\n    size_t index_from_coords(size_t x, size_t y, size_t z) const\n    {\n        return x*_sizex*_sizey + y*_sizey + z;\n    }\n    std::tuple&lt;size_t, size_t, size_t&gt; coords_from_index(size_t index) const\n    {\n        const size_t x = index / (_sizex * _sizey);\n        index = index % x;\n        const size_t y = index / _sizey;\n        const size_t z = index % _sizey;\n        return make_tuple(x, y, z);\n    }\n\npublic:\n    Matrix3D(size_t sizex, sizey, sizez) : _sizex(sizex), ... {}\n    T&amp; operator()(size_t x, size_t y, size_t z) // add const version\n    {\n        return _data[index_from_coords(x, y, z)];\n    }\n    std::tuple&lt;size_t, size_t, size_t&gt; coords(iterator it)\n    {\n        size_t index = std::distance(begin(_data), it);\n        return coords_from_index(index);\n    }\n    iterator begin() { return begin(_data); }\n    iterator end()   { return end(_data);   }\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>Matrix3D&lt;double&gt; m(3, 3, 3);\nauto it = std::max_element(m.begin(), m.end()); // or min, or whatever from http://en.cppreference.com/w/cpp/header/algorithm\nauto coords = m.coords(it);\nstd::cout &lt;&lt; \"x=\" &lt;&lt; coords.get&lt;0&gt;() &lt;&lt; ... &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>This is untested and incomplete code to give you a kickstart into better data design. i'd be happy to answer further questions about this idea in the comment below ;)</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1516810122, "last_edit_date": 1516810122, "creation_date": 1516805846, "answer_id": 48425466, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector/48425466#48425466", "title": "Find max position in a vector of vector of vector", "body": "<p>I do not think you can use <code>std::max_element</code> for such data. You can use <code>std::accumulate()</code>:</p>\n\n<pre><code>using dvect = std::vector&lt;double&gt;;\nusing ddvect = std::vector&lt;dvect&gt;;\nusing dddvect = std::vector&lt;ddvect&gt;;\ndddvect mx = { { { 1, 2, 3 }, { -1, 3 }, { 8,-2, 3 } },\n               { {}, { -1, 25, 3 }, { 7, 3, 3 } },\n               { { -1, -2, -3 }, {}, { 33 } } };\n\nstruct max_value {\n    size_t i = 0;\n    size_t j = 0;\n    size_t k = 0;\n\n    double value = -std::numeric_limits&lt;double&gt;::infinity();\n\n    max_value() = default;\n    max_value( size_t i, size_t j, size_t k, double v ) : i( i ), j( j ), k( k ), value( v ) {}\n\n    max_value operator&lt;&lt;( const max_value &amp;v ) const\n    {\n        return value &gt; v.value ? *this : v;\n    }\n\n};\n\nauto max = std::accumulate( mx.begin(), mx.end(), max_value{}, [&amp;mx]( const max_value &amp;val, const ddvect &amp;ddv ) {\n    auto i = std::distance( &amp;*mx.cbegin(), &amp;ddv );\n    return std::accumulate( ddv.begin(), ddv.end(), val, [i,&amp;ddv]( const max_value &amp;val, const dvect &amp;dv ) {\n        auto j = std::distance( &amp;*ddv.cbegin(), &amp;dv );\n        return std::accumulate( dv.begin(), dv.end(), val, [i,j,&amp;dv]( const max_value &amp;val, const double &amp;d ) {\n            auto k = std::distance( &amp;*dv.cbegin(), &amp;d );\n            return val &lt;&lt; max_value( i, j, k, d );\n        } );\n    } );\n} );\n</code></pre>\n\n<p><a href=\"https://ideone.com/UBDoyo\" rel=\"nofollow noreferrer\">live example</a>. Code could be simplified if C++14 or later allowed but I am not sure that it would worse the effort and data reorganization most probably would work better (you would be able to use <code>std::max_element()</code> on singe vector for example). On another side this layout supports jagged matrix as shown on example (different size subarrays)</p>\n"}], "owner": {"reputation": 177, "user_id": 8099840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/02f373de9cc39dd88d6f99b7155d48ec?s=128&d=identicon&r=PG&f=1", "display_name": "Mar", "link": "https://stackoverflow.com/users/8099840/mar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 48424208, "answer_count": 6, "score": 4, "last_activity_date": 1516810122, "creation_date": 1516801095, "last_edit_date": 1516803475, "question_id": 48423850, "link": "https://stackoverflow.com/questions/48423850/find-max-position-in-a-vector-of-vector-of-vector", "title": "Find max position in a vector of vector of vector", "body": "<p>I have a vector of vector of vector </p>\n\n<pre><code>std::vector&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt; mountain_table\n</code></pre>\n\n<p>and I would like to find the coordinates i, j, k of this vector for which it is the highest. I know that I should use <code>max_element</code> but I don't know how to use it in a 3d vector.</p>\n\n<p>How should I get those coordinates?</p>\n"}, {"tags": ["c++", "fstream"], "comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1516802136, "post_id": 48423808, "comment_id": 83837821, "body": "It would have been useful if you had error checking. <code>if (!P_file) { cerr &lt;&lt; strerror(errno) &lt;&lt; endl; }</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 2, "creation_date": 1516802264, "post_id": 48423808, "comment_id": 83837910, "body": "OT: if Player isn&#39;t a trivial type, you can&#39;t <code>write</code> it."}, {"owner": {"reputation": 59, "user_id": 8280064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2W4p.jpg?s=128&g=1", "display_name": "Snowfox", "link": "https://stackoverflow.com/users/8280064/snowfox"}, "edited": false, "score": 0, "creation_date": 1516802940, "post_id": 48423808, "comment_id": 83838387, "body": "I can save it in other ways but however that seekp(0,ios::end); is required after writing data and I don&#39;t know why"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1516803072, "post_id": 48423808, "comment_id": 83838474, "body": "Your question is unclear. You should provide some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> but you did not. Stack Overflow is not a <i>debug-my-code</i> service"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1516803207, "post_id": 48423808, "comment_id": 83838559, "body": "Your full code is <i>not</i> an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 8280064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2W4p.jpg?s=128&g=1", "display_name": "Snowfox", "link": "https://stackoverflow.com/users/8280064/snowfox"}, "edited": false, "score": 0, "creation_date": 1516803061, "post_id": 48424426, "comment_id": 83838464, "body": "Thanks, by the way I am in windows. and with conio.h and using digital Mars compiler"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 59, "user_id": 8280064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2W4p.jpg?s=128&g=1", "display_name": "Snowfox", "link": "https://stackoverflow.com/users/8280064/snowfox"}, "edited": false, "score": 0, "creation_date": 1516803127, "post_id": 48424426, "comment_id": 83838509, "body": "But I still hope for you that you have some debugger available. AFAIK, <code>sqlite</code> exists on Windows. If you don&#39;t have a debugger, consider getting a compiler and a debugger capable of working together. BTW, Linux is an excellent system for developers and students, you should consider installing some Linux distribution (they all have compilers and debuggers)"}, {"owner": {"reputation": 59, "user_id": 8280064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2W4p.jpg?s=128&g=1", "display_name": "Snowfox", "link": "https://stackoverflow.com/users/8280064/snowfox"}, "edited": false, "score": 0, "creation_date": 1516803624, "post_id": 48424426, "comment_id": 83838849, "body": "that flush()... thanks for saving my project for class 12 board exams."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1516802843, "creation_date": 1516802843, "answer_id": 48424426, "question_id": 48423808, "link": "https://stackoverflow.com/questions/48423808/object-is-not-being-saved-even-after-fstream-clear-in-c/48424426#48424426", "title": "object is not being saved even after fstream.clear() in c++", "body": "<p>Compile with all warnings and debug info (<code>g++ -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>) then <strong>use the debugger</strong> (<a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">e.g. <code>gdb</code></a>).</p>\n\n<p>Read carefully <a href=\"http://en.cppreference.com/w/cpp/io\" rel=\"nofollow noreferrer\">documentation of C++ IO</a> functions.</p>\n\n<p>Check that your file has been opened correctly; after:</p>\n\n<pre><code>fstream P_file(\"PLAYER_DATA.DAT\",ios::out|ios::in|ios::binary);\n</code></pre>\n\n<p>add</p>\n\n<pre><code>if (!P_file) { std::cerr &lt;&lt; \"failed to open PLAYER_DATA.DAT\" &lt;&lt; std::endl; };\n</code></pre>\n\n<p>On some systems (e.g. Linux), you might also display <code>strerror(errno)</code>.</p>\n\n<p>After  some intermediate call to <a href=\"http://en.cppreference.com/w/cpp/io/basic_ostream/write\" rel=\"nofollow noreferrer\"><code>write</code></a>, consider using <a href=\"http://en.cppreference.com/w/cpp/io/basic_ostream/flush\" rel=\"nofollow noreferrer\"><code>flush</code></a>.</p>\n\n<p>Be sure that your program is started in the correct <a href=\"https://en.wikipedia.org/wiki/Working_directory\" rel=\"nofollow noreferrer\">working directory</a>.</p>\n\n<p>On Linux, you might also use <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">strace(1)</a> to understand the system calls done by your program.</p>\n\n<p>At last, did you consider using some simple <a href=\"https://en.wikipedia.org/wiki/Database\" rel=\"nofollow noreferrer\">database</a>, e.g. with <a href=\"https://www.sqlite.org/\" rel=\"nofollow noreferrer\">sqlite</a>, or some indexed file, e.g. with <a href=\"http://www.gnu.org.ua/software/gdbm/manual/gdbm.html\" rel=\"nofollow noreferrer\">gdbm</a> ?</p>\n"}], "owner": {"reputation": 59, "user_id": 8280064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2W4p.jpg?s=128&g=1", "display_name": "Snowfox", "link": "https://stackoverflow.com/users/8280064/snowfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1516992394, "accepted_answer_id": 48424426, "answer_count": 1, "score": 0, "last_activity_date": 1516803459, "creation_date": 1516800951, "last_edit_date": 1592644375, "question_id": 48423808, "link": "https://stackoverflow.com/questions/48423808/object-is-not-being-saved-even-after-fstream-clear-in-c", "closed_reason": "Needs details or clarity", "title": "object is not being saved even after fstream.clear() in c++", "body": "<p>I am using C++ to write a music memorize game for my school project, here the Player <strong>objects are not being saved</strong> in the PLAYER_DATA.DAT file even i tried <strong>clear()</strong> function</p>\n<p>here is the peace of code (as the whole code is 600+ lines)</p>\n<pre><code>    Player p_dat,plyr;\n    plyr.getData();\n    fstream P_file(&quot;PLAYER_DATA.DAT&quot;,ios::out|ios::in|ios::binary);\n    while(P_file.read((char*)&amp;p_dat, sizeof(p_dat)))\n    {\n        if(nameEqual(plyr,p_dat))\n        {\n            P_file.clear();\n            gotoxy(1,10);\n            delline();\n            textcolor(RED);\n            cout&lt;&lt;&quot;\\t\\t      EXIXTING PLAYER PROFILE FOUND!\\n&quot;;\n            int ch = playPanel(&quot;It's me&quot;, &quot;Change Name&quot;);\n            if(ch == 0)\n            {\n                P_file.seekp(P_file.tellg() - sizeof(Player));\n                GameStarted = 1;\n                if(c == 1)\n                    Campaign(p_dat,P_file);\n                else\n                    Endless(p_dat,P_file);\n                return;\n            }\n            else\n            {\n                startGame(c);\n                return;\n            }\n        }\n    }\n    P_file.clear();\n    P_file.seekp(0,ios::end);\n    P_file.write((char*)&amp;plyr,sizeof(plyr)); \n</code></pre>\n<p>Just to make it short, The last line of the code is not doing anything the file already exists and of size 0kb\nhowever,</p>\n<pre><code>fstream P_file(&quot;PLAYER_DATA.DAT&quot;,ios::out|ios::in|ios::binary)\nP_file.write((char*)&amp;plyr,sizeof(plyr)); \n</code></pre>\n<p>is saving the file. Please help me.</p>\n<h1>EDIT 1.1</h1>\n<p>finally found this line is problematic</p>\n<pre><code>P_file.seekp(0,ios::end);\n</code></pre>\n<p>Its working for code, i.e correctly saving objects</p>\n<pre><code> P_file.clear();\n P_file.write((char*)&amp;plyr,sizeof(plyr));\n P_file.seekp(0,ios::end);\n</code></pre>\n<p>while removing</p>\n<pre><code> P_file.seekp(0,ios::end);\n</code></pre>\n<p>making the code look like,</p>\n<pre><code>P_file.clear();\n P_file.write((char*)&amp;plyr,sizeof(plyr));\n</code></pre>\n<p>after the while loop, is not saving the file</p>\n<p>again does not save the object\nthis line is making problem, are there any alternatives or solutions?</p>\n"}, {"tags": ["c++", "inheritance", "virtual", "final", "virtual-inheritance"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1516801071, "post_id": 48423743, "comment_id": 83837105, "body": "Since virtual inheritance allows the base class to be shared (i.e., only have once instance), and final is used to mark a class as not being allowed to be derived from... those two things are independent of one another.  If you remove the virtual, the base class is no longer being shared.  Only of concern for multiple inheritance."}, {"owner": {"reputation": 23, "user_id": 9262269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71664effb113e64b038613f1710170d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ironbell", "link": "https://stackoverflow.com/users/9262269/ironbell"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516801227, "post_id": 48423743, "comment_id": 83837204, "body": "Could you provide a (multiple inheritance) example where omitting the <code>virtual</code> really makes a difference?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516801297, "post_id": 48423743, "comment_id": 83837257, "body": "<a href=\"https://en.wikipedia.org/wiki/Virtual_inheritance\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Virtual_inheritance</a> has an example.   Imagine <code>struct Bat final : Mammal, WingedAnimal, virtual Animal</code> being changed to <code>struct Bat final : Mammal, WingedAnimal, Animal</code> ... whoops, bat.eat() became ambiguous."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1517446780, "post_id": 48423743, "comment_id": 84104032, "body": "@Eljay &quot;<i>Only of concern for multiple inheritance.</i>&quot; Not exactly. Virtual blurs the distinction between direct and indirect base class."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9262269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71664effb113e64b038613f1710170d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ironbell", "link": "https://stackoverflow.com/users/9262269/ironbell"}, "edited": false, "score": 0, "creation_date": 1516801509, "post_id": 48423898, "comment_id": 83837390, "body": "Perfect. That means that the virtual could <b>always</b> be ommited when <b>not</b> using multiple inheritance?"}, {"owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "reply_to_user": {"reputation": 23, "user_id": 9262269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71664effb113e64b038613f1710170d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ironbell", "link": "https://stackoverflow.com/users/9262269/ironbell"}, "edited": false, "score": 0, "creation_date": 1516801623, "post_id": 48423898, "comment_id": 83837465, "body": "@Ironbell yes, <code>virtual</code> in this context was added exactly to handle diamond problem."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "reply_to_user": {"reputation": 23, "user_id": 9262269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71664effb113e64b038613f1710170d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ironbell", "link": "https://stackoverflow.com/users/9262269/ironbell"}, "edited": false, "score": 0, "creation_date": 1516802531, "post_id": 48423898, "comment_id": 83838082, "body": "@Ironbell \u2022 I never found a need for multiple inheritance of concrete base classes or abstract base classes in the production C++ code I&#39;ve worked on.  I have used multiple inheritance for having one-and-only-one concrete-or-abstract base class, and multiple interface classes.  (C++ doesn&#39;t enforce the constraint by having an <code>interface</code> keyword, so it is only by convention and discipline.)"}, {"owner": {"reputation": 23, "user_id": 9262269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71664effb113e64b038613f1710170d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ironbell", "link": "https://stackoverflow.com/users/9262269/ironbell"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516803553, "post_id": 48423898, "comment_id": 83838792, "body": "@Eljay It was not a question about whether and when to use MI, but whether this combination was ever useful. For MI, well, one size does not fit them all. Thanks for your answers, I sadly do not have enough rep yet to upvote comments."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528332263, "post_id": 48423898, "comment_id": 88470777, "body": "&quot;<i>call to foo would be ambiguous</i>&quot; Not only that that (remark not applicable to your simple example where <code>A</code> has no state and no constructor that does much) <b>without virtual, you cannot even write a constructor that initializes either base class subobject <code>A</code></b>"}], "tags": [], "owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "is_accepted": true, "score": 1, "last_activity_date": 1516801255, "creation_date": 1516801255, "answer_id": 48423898, "question_id": 48423743, "link": "https://stackoverflow.com/questions/48423743/is-declaring-a-class-in-c-as-final-public-virtual-ever-useful/48423898#48423898", "title": "Is declaring a class in C++ as &quot;final : public virtual&quot; EVER useful?", "body": "<pre><code>struct A { void foo() { cout &lt;&lt; \"foo\" &lt;&lt; endl; } };\nstruct B : virtual A {};\nstruct D final : virtual A, B {};\n\nD d;\nd.foo();\n</code></pre>\n\n<p>Without <code>virtual</code> before <code>A</code> call to <code>foo</code> would be ambiguous.</p>\n"}], "owner": {"reputation": 23, "user_id": 9262269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71664effb113e64b038613f1710170d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ironbell", "link": "https://stackoverflow.com/users/9262269/ironbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 1, "accepted_answer_id": 48423898, "answer_count": 1, "score": 2, "last_activity_date": 1516801255, "creation_date": 1516800759, "question_id": 48423743, "link": "https://stackoverflow.com/questions/48423743/is-declaring-a-class-in-c-as-final-public-virtual-ever-useful", "title": "Is declaring a class in C++ as &quot;final : public virtual&quot; EVER useful?", "body": "<p>When declaring a c++ class as final, is it ever needed to inherit base classes using virtual inheritance? I know what virtual inheritance is for and use it to avoid member duplication.</p>\n\n<p>As an example, if I have these class definitions (imagine all of them having some members and virtual deconstructors)</p>\n\n<pre><code>class B : public virtual A {};\nclass C : public virtual A {};\nclass D : public virtual C {};\n</code></pre>\n\n<p>Does it make sense to define a next class as</p>\n\n<pre><code>class E final : public virtual D {}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>class F final : public virtual B, public virtual C {};\n</code></pre>\n\n<p>or is the default inheritance, i.e.</p>\n\n<pre><code>class E final : public D {}\nclass F final : public B, public C {};\n</code></pre>\n\n<p><strong>always</strong> enough?</p>\n\n<p>This has bothered me for a long time now, as I see from time to time code, that includes</p>\n\n<pre><code>\"final : public virtual\"\n</code></pre>\n\n<p>Could the <code>virtual</code> be safely omitted here in <strong>any</strong> case?</p>\n\n<p>Any hints/explanations are greatly appreciated</p>\n"}, {"tags": ["c++", "sum", "digits"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1516800770, "post_id": 48423705, "comment_id": 83836907, "body": "Show the the expected output, the actual output, and your debugging attempts."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1516800844, "post_id": 48423705, "comment_id": 83836954, "body": "And it would probably be significantly easier to turn the number into a String, then turn each character of the string back into a integer. That&#39;ll likely be much slower though."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 4, "creation_date": 1516800863, "post_id": 48423705, "comment_id": 83836966, "body": "You know in C++ there are also <code>&gt;=</code> and <code>&lt;=</code> operators"}, {"owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "edited": false, "score": 0, "creation_date": 1516800969, "post_id": 48423705, "comment_id": 83837038, "body": "what is the output you get?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1516800974, "post_id": 48423705, "comment_id": 83837041, "body": "You don&#39;t have to store the digits into a vector, you can sum them directly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1516801772, "post_id": 48423705, "comment_id": 83837556, "body": "OT: Why is a a global variable?"}], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 4, "last_activity_date": 1516800971, "creation_date": 1516800971, "answer_id": 48423810, "question_id": 48423705, "link": "https://stackoverflow.com/questions/48423705/function-which-outputs-the-sum-of-the-digits-of-an-integer-in-c/48423810#48423810", "title": "Function, which outputs the sum of the digits of an integer in C++?", "body": "<p>It's way too complex. This should work (except for negative numbers)</p>\n\n<pre><code>int sumDigits(int n)\n{\n    int total = 0;\n    while (n &gt; 0)\n    {\n        total += n%10;\n        n /= 10;\n    }\n    return total;\n}\n</code></pre>\n\n<p>Combination of n%10 and n/10 in a loop gives you each digit in the number, then just add them up.</p>\n\n<p>The error in your original code is that <code>tmp</code> is not initialised to zero.</p>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 8952196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4hJs.jpg?s=128&g=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/8952196/shawn"}, "is_accepted": false, "score": 1, "last_activity_date": 1516801202, "creation_date": 1516801202, "answer_id": 48423880, "question_id": 48423705, "link": "https://stackoverflow.com/questions/48423705/function-which-outputs-the-sum-of-the-digits-of-an-integer-in-c/48423880#48423880", "title": "Function, which outputs the sum of the digits of an integer in C++?", "body": "<pre><code>int tmp = 0;\n</code></pre>\n\n<p>remember that inside a function, tmp will not be initialized by default!</p>\n"}, {"tags": [], "owner": {"reputation": 888, "user_id": 6087479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-5I8NM_JIDkU/AAAAAAAAAAI/AAAAAAAAAAA/MAhvpTXecww/photo.jpg?sz=128", "display_name": "Eziz Durdyyev", "link": "https://stackoverflow.com/users/6087479/eziz-durdyyev"}, "is_accepted": false, "score": 1, "last_activity_date": 1516801257, "creation_date": 1516801257, "answer_id": 48423900, "question_id": 48423705, "link": "https://stackoverflow.com/questions/48423705/function-which-outputs-the-sum-of-the-digits-of-an-integer-in-c/48423900#48423900", "title": "Function, which outputs the sum of the digits of an integer in C++?", "body": "<p>you forgot to init sum to 0 (sum = 0;)</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint sumDigits(int n)\n{\n    int tmp = 0;\n    while(n&gt;0) {\n        tmp+=n%10;\n        n/=10;\n    }\n    return tmp;\n}\n\nint main()\n{\n    cout&lt;&lt;sumDigits(12745);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1457, "user_id": 8815948, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b0f69dcdff68cb3df3bb410569cd49f3?s=128&d=identicon&r=PG&f=1", "display_name": "RAM", "link": "https://stackoverflow.com/users/8815948/ram"}, "is_accepted": false, "score": 0, "last_activity_date": 1516801444, "creation_date": 1516801444, "answer_id": 48423958, "question_id": 48423705, "link": "https://stackoverflow.com/questions/48423705/function-which-outputs-the-sum-of-the-digits-of-an-integer-in-c/48423958#48423958", "title": "Function, which outputs the sum of the digits of an integer in C++?", "body": "<p>Your implementation of <code>sumDigits</code> doesn't initialize <code>tmp</code> if <code>n&gt;9</code>, which fits exactly the case covered by your example. Therefore, <code>tmp+=a[i]</code> keeps on adding stuff to an integer filled with garbage. </p>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 9079337, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4pyf_OGm3YY/AAAAAAAAAAI/AAAAAAAAAKY/C1zZYfoIuyM/photo.jpg?sz=128", "display_name": "Cpp Forever", "link": "https://stackoverflow.com/users/9079337/cpp-forever"}, "is_accepted": false, "score": 0, "last_activity_date": 1516805230, "last_edit_date": 1516805230, "creation_date": 1516803956, "answer_id": 48424803, "question_id": 48423705, "link": "https://stackoverflow.com/questions/48423705/function-which-outputs-the-sum-of-the-digits-of-an-integer-in-c/48424803#48424803", "title": "Function, which outputs the sum of the digits of an integer in C++?", "body": "<p>You must set the tmp variable as 0<br>\nHere is your corrected code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\nvector &lt;int&gt; a;\nint sumDigits(int n)\n{\n    int tmp=0;\n\n    if((n&gt;1 &amp;&amp; n&lt;9) || n==1 || n==9)\n    {\n        tmp=n;\n        return tmp;\n    }\n    while(n&gt;9)\n    {\n\n        a.push_back(n%10);\n        n/=10;\n        if((n&gt;1 &amp;&amp; n&lt;9) || n==1 || n==9)\n        {\n            a.push_back(n);\n        }\n    }\n    for(int i=0; i&lt;a.size(); i++)\n    {\n\n        tmp+=a[i];\n\n    }\n    return tmp;\n}\nint main()\n{\n    cout&lt;&lt;sumDigits(12745);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9244865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffed4e4a2f7d11a2bb67c02cd22e084d?s=128&d=identicon&r=PG&f=1", "display_name": "P.Petrov", "link": "https://stackoverflow.com/users/9244865/p-petrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 48423810, "answer_count": 5, "score": 0, "last_activity_date": 1516805230, "creation_date": 1516800647, "last_edit_date": 1516801153, "question_id": 48423705, "link": "https://stackoverflow.com/questions/48423705/function-which-outputs-the-sum-of-the-digits-of-an-integer-in-c", "title": "Function, which outputs the sum of the digits of an integer in C++?", "body": "<p>I have written a function that ought  to print the sum of all digits of a given integer. However the program outputs incorrect result, it should output 19. I want to ask why this happens? The program outputs 2686935.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\nvector &lt;int&gt; a;\nint sumDigits(int n)\n{\n    int tmp;\n    if((n&gt;1 &amp;&amp; n&lt;9) || n==1 || n==9)\n    {\n        tmp=n;\n        return tmp;\n    }\n    while(n&gt;9)\n    {\n\n        a.push_back(n%10);\n        n/=10;\n        if((n&gt;1 &amp;&amp; n&lt;9) || n==1 || n==9)\n        {\n            a.push_back(n);\n        }\n    }\n    for(int i=0; i&lt;a.size(); i++)\n    {\n\n        tmp+=a[i];\n\n    }\n    return tmp;\n}\nint main()\n{\n    cout&lt;&lt;sumDigits(12745);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "enums"], "answers": [{"comments": [{"owner": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "edited": false, "score": 0, "creation_date": 1516803115, "post_id": 48423789, "comment_id": 83838501, "body": "Doesn&#39;t one need to define/forward declare <code>e_mode_base_t</code> ?"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "edited": false, "score": 0, "creation_date": 1516803194, "post_id": 48423789, "comment_id": 83838554, "body": "@LukaRahne it will be defined by the <code>typedef</code>."}, {"owner": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "edited": false, "score": 0, "creation_date": 1516803891, "post_id": 48423789, "comment_id": 83839055, "body": "If I understand this, and I am not wrong one will need to include <code>typedef</code> from somewhere. Question is. Can <code>e_mode_base_t</code>  be hidden, just like <code>e_mode</code> is?"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "edited": false, "score": 1, "creation_date": 1516804224, "post_id": 48423789, "comment_id": 83839332, "body": "No. You would just place the definition of <code>e_mode_base_t</code> in a header file with <i>include guards</i> to avoid multiple inclusion and include that header before referring to <code>e_mode_base_t</code>."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 6, "last_activity_date": 1516802783, "last_edit_date": 1516802783, "creation_date": 1516800900, "answer_id": 48423789, "question_id": 48423582, "link": "https://stackoverflow.com/questions/48423582/enum-class-underlying-type-with-forward-declaration/48423789#48423789", "title": "enum class underlying type with forward declaration", "body": "<p>The <code>enum</code>'s underlying type could be previously defined by means of <code>typedef</code>:</p>\n\n<pre><code>typedef bool e_mode_base_t;\n</code></pre>\n\n<p>Then, you can use this type for the <code>enum</code>'s forward declaration:</p>\n\n<pre><code>enum class e_mode: e_mode_base_t;\n</code></pre>\n\n<p>and for the <code>enum</code>'s definition as well:</p>\n\n<pre><code>enum class e_mode : e_mode_base_t\n{\n     SYNC,\n     ASYNC\n};\n</code></pre>\n\n<p>This way, you only need to modify the definition of <code>e_mode_base_t</code> when you wish to change the <code>enum</code>'s underlying type.</p>\n\n<p>You could as well create a type alias by means of <code>using</code> instead of <code>typedef</code>:</p>\n\n<pre><code>using e_mode_base_t = bool;\n</code></pre>\n\n<p>which may be more readable.</p>\n"}, {"tags": [], "owner": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "is_accepted": false, "score": 1, "last_activity_date": 1516802897, "creation_date": 1516802897, "answer_id": 48424440, "question_id": 48423582, "link": "https://stackoverflow.com/questions/48423582/enum-class-underlying-type-with-forward-declaration/48424440#48424440", "title": "enum class underlying type with forward declaration", "body": "<p>You can have a \".h\" file that defines only forward declaration of enum. Insted of forward declaring enum, you then include this \"cheap\" h file.</p>\n"}], "owner": {"reputation": 447, "user_id": 6071697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea2947bcc835bb3b6ab9ca5303272b8b?s=128&d=identicon&r=PG&f=1", "display_name": "Epic", "link": "https://stackoverflow.com/users/6071697/epic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 48423789, "answer_count": 2, "score": 2, "last_activity_date": 1516802897, "creation_date": 1516800276, "last_edit_date": 1516802612, "question_id": 48423582, "link": "https://stackoverflow.com/questions/48423582/enum-class-underlying-type-with-forward-declaration", "title": "enum class underlying type with forward declaration", "body": "<p>I have a small enum class which I would like to forward declare in a few places. Is there a way to decouple the base type from the forward declaration? I am afraid that at some later point someone will change the type.</p>\n\n<p>for example I have the enum</p>\n\n<pre><code>enum class e_mode : bool\n{\n     SYNC,\n     ASYNC\n};\n</code></pre>\n\n<p>the forward declaration will be:</p>\n\n<pre><code>enum class e_mode : bool;\n</code></pre>\n\n<p>if someone adds another value he will need to change the bool to char and then go around changing the forward declarations. I would like to avoid that...</p>\n"}, {"tags": ["c++", "windows", "mfc"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516802616, "post_id": 48423526, "comment_id": 83838143, "body": "Well, MFC is a wrapper for the underlying native API which uses <code>INT_PTR</code> for dialog results, so it would be a <i>bug</i> if the return type of <code>DoModal()</code> would be <code>int</code>. Simply replace your types accordingly or use <code>static_cast&lt;int&gt;(someDialog.DoModal())</code> if you can be sure there is no overflow."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516803386, "post_id": 48423526, "comment_id": 83838678, "body": "@zett42 OK, that sounds convincing, so the question should rather by &quot;why did they switch from <code>int</code> to <code>INT_PTR</code> as return type in native  functions such as <code>DialogBoxParam</code> which return <code>INT_PTR</code> now and <code>int</code> in old SDKs."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1516805967, "post_id": 48423526, "comment_id": 83840665, "body": "I guess some people passed a pointer to <code>EndDialog</code>. The cast to <code>int</code> would be valid only for 32-bit. To be able to build such programs with only minor modifications for 64-bit, they had to extend the <code>EndDialog</code> parameter to <code>INT_PTR</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516813099, "post_id": 48423526, "comment_id": 83845972, "body": "@zett42&#39;s your last comment sounds most convincing to me. That makes sense."}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "closed_date": 1516854833, "answer_count": 0, "score": 3, "last_activity_date": 1516801417, "creation_date": 1516800124, "last_edit_date": 1516801417, "question_id": 48423526, "link": "https://stackoverflow.com/questions/48423526/why-does-cdialogdomodal-return-an-int-ptr-and-not-an-int-as-in-very-old-sdks", "closed_reason": "Opinion-based", "title": "Why does CDialog::DoModal return an INT_PTR and not an int as in very old SDKs", "body": "<p>In the old times when 64 programming was something exotic, the <code>CDialag::DoModal()</code> function returned simply an <code>int</code>.</p>\n\n<p>Now with recent SDKs <code>DoModal</code> returns an <code>INT_PTR</code> which is typedefed to an <code>int</code> if you compile for 32 bits, and it is typedefed to an <code>__int64</code> if you compile for 64 bits.</p>\n\n<p>I'm currently adapting an old 32 bit application to 64 bits and of course I get a warning each time I have something like <code>int answer = someDialog.DoModal();</code>. The only clean solution is probably to replace all those <code>int</code>s by <code>INT_PTR</code>s (If anyone has a better idea, let me know).</p>\n\n<p>Now does anybody know why the MFC folks at Microsoft didn't simply leave <code>int</code> as return type for <code>DoModal</code>? IMO there is no benefit using 64 bits rather than 32 bits for return values such as <code>IDOK</code>, <code>IDCANCEL</code> etc. There is probably a good reason but I cannot find one.</p>\n"}, {"tags": ["c++", "linux", "debugging", "gdb"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1516799798, "post_id": 48423394, "comment_id": 83836275, "body": "You want a dump but keep the program running?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1516800044, "post_id": 48423394, "comment_id": 83836448, "body": "You might get more expert responses if you ask this on the C tag, rather than C++."}], "owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 0, "closed_date": 1516801478, "answer_count": 0, "score": 3, "last_activity_date": 1516800125, "creation_date": 1516799648, "question_id": 48423394, "link": "https://stackoverflow.com/questions/48423394/create-core-dump-on-purpose-in-c-c", "closed_reason": "Duplicate", "title": "Create core dump on purpose in C/C++?", "body": "<p>I would like to create a core dump in my application on purpose, not only when it gets terminated.</p>\n\n<p>I don't know if this is the right question, but is there any kernel function to call in my program like <code>dump_core(\"core.XXXX\")</code>?\nThe goal I want to achieve is, to dump my core on some points in my application and later to debug this core dumps with gdb.</p>\n"}, {"tags": ["c++", "qt", "qlistwidget"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1516800525, "post_id": 48423343, "comment_id": 83836738, "body": "please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 701, "user_id": 8265841, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c31729e54e05fd94f818207a1155f4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Tang", "link": "https://stackoverflow.com/users/8265841/theodore-tang"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1516801550, "post_id": 48423343, "comment_id": 83837419, "body": "@eyllanesc Ok, I edit that."}, {"owner": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1516801662, "post_id": 48423343, "comment_id": 83837490, "body": "Well, when you double-click, you <i>change</i> the flags of your item, so this item <i>has changed</i> in a way, right ? You may be looking for something that looks more like <i>itemTextChanged</i> (not sure if this one exists though). After a quick look, there is <i>currentTextChanged</i> signal -- <a href=\"http://doc.qt.io/archives/qt-4.8/qlistwidget.html#currentTextChanged\" rel=\"nofollow noreferrer\">doc.qt.io/archives/qt-4.8/qlistwidget.html#currentTextChange&zwnj;&#8203;d</a>"}, {"owner": {"reputation": 701, "user_id": 8265841, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c31729e54e05fd94f818207a1155f4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Tang", "link": "https://stackoverflow.com/users/8265841/theodore-tang"}, "reply_to_user": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1516801953, "post_id": 48423343, "comment_id": 83837688, "body": "@Rafalon Yes, an <code>itemTextChanged</code> signal is what I am looking for, but it does not exist. What I want to achieve there is to detect if the text of the item has been changed. Unfortunately, I do not know how to do that."}, {"owner": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1516801995, "post_id": 48423343, "comment_id": 83837720, "body": "Isn&#39;t <i>currentTextChanged</i> what you are looking for ?"}, {"owner": {"reputation": 701, "user_id": 8265841, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c31729e54e05fd94f818207a1155f4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Tang", "link": "https://stackoverflow.com/users/8265841/theodore-tang"}, "reply_to_user": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1516802194, "post_id": 48423343, "comment_id": 83837868, "body": "@Rafalon I tried that signal out before and after you left a comment, but somehow this signal will only emit once whenever my program starts, and later when I try to change its name, the signal will not be emitted."}, {"owner": {"reputation": 701, "user_id": 8265841, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c31729e54e05fd94f818207a1155f4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Tang", "link": "https://stackoverflow.com/users/8265841/theodore-tang"}, "reply_to_user": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1516802274, "post_id": 48423343, "comment_id": 83837921, "body": "@Rafalon the debug out put is <code>Name: &quot;Testing name_1&quot;(when the program started) Name edit(when I double clicked the list to change its name) Name edit</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1516802559, "creation_date": 1516802559, "answer_id": 48424332, "question_id": 48423343, "link": "https://stackoverflow.com/questions/48423343/qlistwidgetitemchanged-signal-triggered-twice-in-qt/48424332#48424332", "title": "QListWidget::itemChanged signal triggered twice in qt", "body": "<p>You can use the item delegate <code>commitData</code> signal, this way:</p>\n\n<pre><code>QObject::connect(listWidget-&gt;itemDelegate(), SIGNAL(commitData(QWidget*)), this, SLOT(dataCommited(QWidget*)));\n</code></pre>\n\n<p>the slot is like this:</p>\n\n<pre><code>void dataCommited(QWidget * w)\n{\n    QString data = (static_cast&lt;QLineEdit *&gt;(w))-&gt;text();\n    //...\n}\n</code></pre>\n\n<p>The signal will be emitted at the end of the editing (i.e. enter key pressed or focus lost etc.)</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4929591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e854c4877cd7f4c414c0768f83476b2a?s=128&d=identicon&r=PG&f=1", "display_name": "epicanriome", "link": "https://stackoverflow.com/users/4929591/epicanriome"}, "is_accepted": false, "score": 0, "last_activity_date": 1516812303, "creation_date": 1516812303, "answer_id": 48427607, "question_id": 48423343, "link": "https://stackoverflow.com/questions/48423343/qlistwidgetitemchanged-signal-triggered-twice-in-qt/48427607#48427607", "title": "QListWidget::itemChanged signal triggered twice in qt", "body": "<p>As @Rafalon said, calling setFlags calls your slot changeUserName, and the signal <em>currentTextChanged</em> is emitted when the current item changed, it is the same as <em>currentItemChanged</em> except it gives you the text instead of the item.</p>\n\n<p>What you can do is, make your item editable as you instantiate it:</p>\n\n<pre><code>QListWidgetItem* pItem = new QListWidgetItem();\npItem-&gt;setText(\"Testing name_1\");\npItem-&gt;setFlags(pItem-&gt;flags() | Qt::ItemIsEditable);\nlistWidget-&gt;addItem(pItem);\n</code></pre>\n\n<p>or you can activate/deactivate the connection when you need it:</p>\n\n<pre><code>void MainWindow::makeListEditable(QListWidgetItem *editItem)\n{\n    editItem-&gt;setFlags(editItem-&gt;flags() | Qt::ItemIsEditable);\n    connect(ui-&gt;listWidget, SIGNAL(itemChanged(QListWidgetItem *)), this, SLOT(changeUserName(QListWidgetItem *)));\n    qDebug() &lt;&lt; \"Name edit\";\n}\nvoid MainWindow::changeUserName(QListWidgetItem *editItem)\n{\n    qDebug() &lt;&lt; \"Name:\" &lt;&lt; editItem-&gt;text();\n    disconnect(ui-&gt;listWidget, SIGNAL(itemChanged(QListWidgetItem *)), this, SLOT(changeUserName(QListWidgetItem *)));\n}\n</code></pre>\n\n<p>but you will have to make another connection when the current element is not modified after a double click, maybe with the signal <em>currentItemChanged</em>.</p>\n"}], "owner": {"reputation": 701, "user_id": 8265841, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c31729e54e05fd94f818207a1155f4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Tang", "link": "https://stackoverflow.com/users/8265841/theodore-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516812303, "creation_date": 1516799479, "last_edit_date": 1516802836, "question_id": 48423343, "link": "https://stackoverflow.com/questions/48423343/qlistwidgetitemchanged-signal-triggered-twice-in-qt", "title": "QListWidget::itemChanged signal triggered twice in qt", "body": "<p>I have a <code>QListWidget</code> to store usernames, and I use this signal to detect if username is being changed:</p>\n\n<pre><code>connect(listWidget, &amp;QListWidget::itemChanged, this, &amp;MainWindow::changeUserName);\n\nvoid MainWindow::changeUserName(QListWidgetItem *editItem)\n{\n    qDebug() &lt;&lt; \"Name:\" &lt;&lt; editItem-&gt;text();\n}\n</code></pre>\n\n<p>And this is how I make <code>QListWidget</code> editable in another function:</p>\n\n<pre><code>connect(listWidget, &amp;QListWidget::itemDoubleClicked, this, &amp;MainWindow::makeListEditable);\n\nvoid MainWindow::makeListEditable()\n{\n    QListWidgetItem *editItem = listWidget-&gt;currentItem();\n    editItem-&gt;setFlags(editItem-&gt;flags() | Qt::ItemIsEditable);\n    qDebug() &lt;&lt; \"Name edit\";\n}\n</code></pre>\n\n<p>But which confused me is, whenever I double clicked the list widget, the <code>itemChanged</code> signal will be triggered once, and when I input a new username, the signal will be triggered again. Why would this happen?</p>\n\n<p>This is the debug output, when I double clicked the list, it says:</p>\n\n<pre><code>Name: \"Testing name_1\"\nName edit\n</code></pre>\n\n<p>after I entered a new name and hit the enter, it says:</p>\n\n<pre><code>Name: \"Testing name_2\" //a new name I changed to\n</code></pre>\n\n<p>And what if I only want a signal be triggered once whenever I input a new name and hit the enter, what should I do to achieve this? <br>\nThanks</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 12, "creation_date": 1516798959, "post_id": 48423126, "comment_id": 83835685, "body": "<i>If I want a function to be inlined</i> that is worng. The compiler decides when which function is inlined."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1516798992, "post_id": 48423126, "comment_id": 83835707, "body": "You can can get that functionality if you really want to already.  <code>inline void ilfoo() {...}  void foo() {ilfoo();}</code>"}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1516799020, "post_id": 48423126, "comment_id": 83835728, "body": "The inline keyword is pretty much defunct the compiler is the ultimate judge now"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 1, "creation_date": 1516799201, "post_id": 48423126, "comment_id": 83835865, "body": "@JakeFreeman <a href=\"https://stackoverflow.com/questions/1759300/when-should-i-write-the-keyword-inline-for-a-function-method\" title=\"when should i write the keyword inline for a function method\">stackoverflow.com/questions/1759300/&hellip;</a>  has an example of where inline isn&#39;t defunct - ie &quot;function is defined in multiple units&quot;."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 1, "creation_date": 1516799207, "post_id": 48423126, "comment_id": 83835871, "body": "@JakeFreeman The <code>inline</code> keyword still works perfectly well, only its role has now changed and it no longer suggests inlining."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1516799250, "post_id": 48423126, "comment_id": 83835904, "body": "<a href=\"https://stackoverflow.com/q/29796264/1782465\">Related reading</a>"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 2, "creation_date": 1516799351, "post_id": 48423126, "comment_id": 83835978, "body": "(why is often a hard question.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1516799436, "post_id": 48423126, "comment_id": 83836043, "body": "See also <a href=\"https://isocpp.org/wiki/faq/inline-functions#where-to-put-inline-keyword\" rel=\"nofollow noreferrer\">C++ Super FAQ</a>"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1516800003, "post_id": 48423126, "comment_id": 83836422, "body": "@Angew @JakeFreeman Wrong. GCC will happily listen to <code>inline</code> advise and will inline functions it would not inline otherwise. At least when building in C mode. I <i>does</i> make a difference."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 2, "creation_date": 1516800268, "post_id": 48423126, "comment_id": 83836583, "body": "@Ivan C is not C++."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1516800331, "post_id": 48423126, "comment_id": 83836610, "body": "@manni66 The question includes &quot;various other languages&quot;. Which basically means C too."}], "answers": [{"comments": [{"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516806332, "post_id": 48423372, "comment_id": 83840962, "body": "There may be more than one definition of an inline function or variable (since C++17) in the program as long as each definition appears in a different translation unit.  <a href=\"http://en.cppreference.com/w/cpp/language/inline\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/inline</a>"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516806490, "post_id": 48423372, "comment_id": 83841078, "body": "@MohammadKanan - I think that&#39;s what I said,"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516806962, "post_id": 48423372, "comment_id": 83841454, "body": "<i>the linker should <b>ignore</b> multiple definitions from separate compilation units.</i> and just  pick one .. this appeared as if you mean those others won&#39;t be inlined"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 2, "creation_date": 1516827496, "post_id": 48423372, "comment_id": 83853981, "body": "@Mohammad Appearances can be deceiving. :-) The linker does not know whether the compiler rolled a function out in-line in a given compilation unit or just never saw it."}], "tags": [], "owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "is_accepted": false, "score": 1, "last_activity_date": 1516800284, "last_edit_date": 1516800284, "creation_date": 1516799576, "answer_id": 48423372, "question_id": 48423126, "link": "https://stackoverflow.com/questions/48423126/why-are-there-inline-function-declarations-instead-of-inline-function-calls/48423372#48423372", "title": "Why are there inline function declarations instead of inline function calls?", "body": "<p>Short but sweet answer: \"Inline\" does not do what it used to. These days, all it means is that the linker should ignore multiple definitions from separate compilation units, and just pick one and go with it. The compiler is free to do as it pleases. Most or all modern compilers ignore \"inline\".</p>\n\n<p>Bonus fact: In the latest and greatest C++, you can declare a variable as inline.</p>\n"}, {"comments": [{"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516805869, "post_id": 48423420, "comment_id": 83840584, "body": "<i>A call to a non-inline function can be <b>expanded</b> inline by the compiler if the function is <b>defined</b> in the same translation unit.</i> my point: is that true even when the function has/gets multiple calls (because you said it is non-inline)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516806417, "post_id": 48423420, "comment_id": 83841026, "body": "@MohammadKanan yes. Multipe calls can be expanded inline."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516806654, "post_id": 48423420, "comment_id": 83841214, "body": "10x, I just read they will be shared across all translation units (static objects &amp; variables)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1516807458, "post_id": 48423420, "comment_id": 83841797, "body": "@MohammadKanan I added clarifying foreword. Perhaps it will be of use to you."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1517491666, "last_edit_date": 1517491666, "creation_date": 1516799715, "answer_id": 48423420, "question_id": 48423126, "link": "https://stackoverflow.com/questions/48423126/why-are-there-inline-function-declarations-instead-of-inline-function-calls/48423420#48423420", "title": "Why are there inline function declarations instead of inline function calls?", "body": "<p>Foreword:</p>\n\n<p>To <em>inline a function</em> i.e. the act of <em>inlining</em> i.e. <em>inline expansion</em> is an optimization where a function call is replaced by duplicated set of instructions.</p>\n\n<p>To declare an <em>inline function</em> is to declare to the linker that the function is to be treated differently than non-inline functions. Specifically, the one-definition-rule is different for inline functions. Inline functions are allowed to be defined in multiple translation units (and in fact required to be defined in all translation units where the function is odr-used). This is different from non-inline functions, which must be defined in exactly one translation unit. The <code>inline</code> keyword can be used the declare an inline function.</p>\n\n<p>While inline declaration is named similarly to the inlining optimization, and while former can indirectly affect whether latter is possible, these two concepts are separate.</p>\n\n<p>Now, to the answer.</p>\n\n<hr>\n\n<blockquote>\n  <p>If I want a function to be inlined, I have to use the <code>inline</code> keyword in the declaration.</p>\n</blockquote>\n\n<p>You don't necessarily have to use the inline keyword. A call to a non-inline function can be expanded inline by the compiler if the function is defined in the same translation unit. Even that is not a requirement for a linktime optimizer which sees all translation units.</p>\n\n<p>Example:</p>\n\n<pre><code>// a.cpp\nvoid foo(){}        // a non-inline function\ninline void qux(){} // an inline function\nvoid bar(){\n    foo(); // this call to a non-inline function can be expanded inline\n           // because the function is defined in the same TU\n}\n\n// b.cpp\nvoid foo(); // the non-inline function must not be defined\n            // in multiple translation units\ninline void qux(){} // the inline function can and must be defined\n                    // in both translation units\nvoid xeb(){\n    foo(); // this call to a non-inline function can not be expanded inline by\n           // the compiler because the function is not defined in the same TU\n           // the call can be expanded by a linker\n    qux(); // this call can be expanded by the compiler\n           // because the function is defined in the same TU\n}\n</code></pre>\n\n<p>That said, linktime optimization isn't always an option, and function calls do happen across translation units, so inline definition is in some cases indeed necessary to allow inline expansion.</p>\n\n<p>A pedantic point: A function can declared inline without the <code>inline</code> keyword (if it is a member function).</p>\n\n<blockquote>\n  <p>Why can't I just use inline when calling a function?</p>\n</blockquote>\n\n<p>There just isn't such syntax in the language.</p>\n\n<p>Note that the function would still have to be defined in the same translation unit or else it cannot be expanded inline by the compiler. Thus the function would still need to be declared inline if you wanted inline expansion in more than one translation unit.</p>\n\n<p>I suspect that the reason why there is no syntax to force inline expansion is probably the same as why there is no way to select which branch of an <code>if</code> statement is the \"default\" branch which might have marginal effect on performance (the reasoning is just my guess in both cases): Humans are notoriously bad at optimization. I see no technical reason why such language feature couldn't be introduced. But I wouldn't expect such feature to be very useful.</p>\n"}, {"comments": [{"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516805580, "post_id": 48424230, "comment_id": 83840370, "body": "what do you mean by: does not mean that the <b><i>calls should get inlined</i></b>"}, {"owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 1, "creation_date": 1516808798, "post_id": 48424230, "comment_id": 83842886, "body": "It means this keyword is not about substituting a function&#39;s body into the locating where the function is called."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "reply_to_user": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 0, "creation_date": 1516818207, "post_id": 48424230, "comment_id": 83849004, "body": "@TheTechel, but by definition its a suggestion to do that  .. while the rest explains its properties , from point 2 in description <a href=\"http://en.cppreference.com/w/cpp/language/inline\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/inline</a>"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1516827651, "post_id": 48424230, "comment_id": 83854074, "body": "@Mohammad - The current definition of inline does not say it is a suggestion. It only says what M-ou-se and I say it says. The standards committee simply did not want to introduce a new keyword, so instead they used &quot;inline&quot; which no longer meant anything at all."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "reply_to_user": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1516827947, "post_id": 48424230, "comment_id": 83854215, "body": "@JiveDadson, in case you missed my point, its a <i>suggestion</i> to the compiler .. Its not my <i>word</i> .. read it in the first note here: <a href=\"http://www.cplusplus.com/articles/2LywvCM9/\" rel=\"nofollow noreferrer\">cplusplus.com/articles/2LywvCM9</a>"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1516828103, "post_id": 48424230, "comment_id": 83854303, "body": "@Mohammad - cplusplus.com has too many errors, and that&#39;s one of them. Prefer cppreference.com. This gets it right: <a href=\"http://en.cppreference.com/w/cpp/language/inline\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/inline</a> &quot;The original intent of the inline keyword was ...&quot;"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "reply_to_user": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1516828371, "post_id": 48424230, "comment_id": 83854428, "body": "@JiveDadson, Yes that was my reference source in answer to TheTechel"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1516828687, "post_id": 48424230, "comment_id": 83854558, "body": "@Mohammad - But it is no longer a suggestion. You&#39;re not going all backfire effect I hope. :-) Have the last word...."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "reply_to_user": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1516829001, "post_id": 48424230, "comment_id": 83854724, "body": "@JiveDadson, :)  for the most part the doc intro emphasizes  <i>implicitly</i>  in-lined funcs .. so no more suggestions :)"}], "tags": [], "owner": {"reputation": 815, "user_id": 1150292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQ2aZ.jpg?s=128&g=1", "display_name": "Mara Bos", "link": "https://stackoverflow.com/users/1150292/mara-bos"}, "is_accepted": false, "score": 3, "last_activity_date": 1516802236, "creation_date": 1516802236, "answer_id": 48424230, "question_id": 48423126, "link": "https://stackoverflow.com/questions/48423126/why-are-there-inline-function-declarations-instead-of-inline-function-calls/48424230#48424230", "title": "Why are there inline function declarations instead of inline function calls?", "body": "<p>In C++ <code>inline</code> <em>does not</em> mean that the calls should get inlined. It means that the definition is allowed to occur in multiple translation units, whereas normally only one definition is allowed.</p>\n\n<p>Since header files are usually included in many translation units of the C++ program, any function definition in a header file will end up in multiple translation units. So, to make that work, you need the <code>inline</code> keyword for those definitions. It's still related to inlining though, since in this case (where the definition is in the header), the definition is available at all call sites that include the header, allowing the compiler to inline it, since it knows the full definition. If only a declaration would be available in the header, inlining would only be possible during linking (with 'link time optimization' aka LTO).</p>\n"}], "owner": {"reputation": 349, "user_id": 6336988, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4af92b77ea977b9f3eb75cbbe009138e?s=128&d=identicon&r=PG&f=1", "display_name": "NyxMC", "link": "https://stackoverflow.com/users/6336988/nyxmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 48423420, "answer_count": 3, "score": 5, "last_activity_date": 1517491666, "creation_date": 1516798747, "question_id": 48423126, "link": "https://stackoverflow.com/questions/48423126/why-are-there-inline-function-declarations-instead-of-inline-function-calls", "title": "Why are there inline function declarations instead of inline function calls?", "body": "<p>C++ (and various other languages) support inline functions. If I want a function to be inlined, I have to use the <code>inline</code> keyword in the declaration. To me, this seams pretty unintuitive: Why can't I just use <code>inline</code> when calling a function? Example: </p>\n\n<pre><code>void foo(){...}\ninline foo();\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>inline void foo(...){...}\nfoo();\n</code></pre>\n\n<p>This would allow me to inline the function in only specific places without having to duplicate the function. Also, every function could be inlined, which would make the mechanism much more flexible. Is there a reason for why this is not support?</p>\n"}]