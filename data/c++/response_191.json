[{"tags": ["c++", "cuda", "gpu", "nvidia", "pi"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1536190275, "post_id": 52194547, "comment_id": 91338852, "body": "To take advantage of the multiple cores on a graphics card, you will need to split this into pieces that can be delegated to different cores; think of multi-threading.  For example you can divide the algorithm into two threads, one thread calculates the even values of <code>k</code>, the other thread calculates the odd values of <code>k</code>.  The <code>main</code> program can add these two together after the threads finish."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1536190404, "post_id": 52194547, "comment_id": 91338876, "body": "You can speed up your program by keeping 3 <i>running</i> factorial values.  Each factorial value will be multiplied by the next value of <code>k</code> (rather than restarting the factorial calculation from 1.0)."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1536190502, "post_id": 52194547, "comment_id": 91338900, "body": "Another optimization is to calculate <code>fac(k)</code>, place into a temporary variable and multiply itself 3 times:  <code>double m = fac(k); double power3 = m * m * m;</code>."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1536201695, "post_id": 52194547, "comment_id": 91341023, "body": "according to my testing, all of the time in this code is spent in the <code>cout &lt;&lt; setprecision(100000000)...</code> statement.  Replace that with a more reasonable <code>setprecision(40)</code> (although <code>double</code> is only going to give 10-15 digits of precision, at best) and the execution time drops to approximately 0 (~1 millisecond).  As a result of this, none of the proposed optimizations in the answer provided make any tangible difference."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1536203436, "post_id": 52194547, "comment_id": 91341362, "body": "for a bit of amusement, try running this code: <code>#include &lt;iostream&gt; #include &lt;iomanip&gt; using namespace std; int main() {   double pi=1.0&#47;3.0;   cout &lt;&lt; setprecision(100000000)  &lt;&lt; pi &lt;&lt; endl;   return 0;}</code>  Take note of the output as well as the execution time."}], "answers": [{"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 1, "last_activity_date": 1536192718, "last_edit_date": 1536192718, "creation_date": 1536191559, "answer_id": 52194727, "question_id": 52194547, "link": "https://stackoverflow.com/questions/52194547/making-c-pi-approximation-running-in-paralell-on-gpu-nvidia-970m-cudas/52194727#52194727", "title": "Making C++ Pi approximation running in Paralell on GPU Nvidia 970M CUDA&#39;s", "body": "<p>Before delegating to a GPU with multiple cores, I suggest you optimize the algorithm with one core first.  </p>\n\n<h2>Running Factorial Values</h2>\n\n<p>Your factorial function is always starting at 2.0 for each value of k.  This has the following calculations:  </p>\n\n<pre><code>+----+-------------------+  \n| 1! | 1                 |   \n+----+-------------------+  \n| 2! | 1 * 2             |  \n+----+-------------------+  \n| 3! | 1 * 2 * 3         |  \n+----+-------------------+  \n| 5! | 1 * 2 * 3 * 4 * 5 |   \n+----+-------------------+  \n</code></pre>\n\n<p>These time of these iterations will add up as the values of <code>k</code> get larger.  </p>\n\n<p>The factorial can be expressed iteratively as:</p>\n\n<pre><code>+----+--------+   \n| 1! | 1      |   \n+----+--------+  \n| 2! | 1! * 2 |  \n+----+--------+  \n| 3! | 2! * 3 |  \n+----+--------+  \n| 5! | 4! * 5 |   \n+----+--------+  \n</code></pre>\n\n<p>In other words, the next factorial uses the previous <em>factorial value</em> and multiplies by the value of <code>k</code>.</p>\n\n<p>Your <code>main</code> could look like:  </p>\n\n<pre><code>    int main()\n    {\n      double k_factorial = 1.0;\n      //...\n      for (/* ... */)\n      {\n        if (k &gt; 1.0) k_factorial *= k;\n        //...\n                / (fac(3.0 * k) * pow(k_factorial, 3.0) * pow(640320.0, 3.0 * k + 3.0/2.0));\n    //...\n  }\n</code></pre>\n\n<p>Since you have 3 different factorials:  <code>fac(3.0 * k), fac(k),</code> and <code>fac(6.0 * k)</code>, you could use 3 different factorial variables and update their values inside the <code>for</code> loop.  </p>\n\n<h2>Running <code>pow</code> variables</h2>\n\n<p>Similar to the factorial variables, you can have running values for the <code>pow</code> functions.<br>\nThe <code>pow(-1.0, k)</code> can be replaced by:</p>\n\n<pre><code>double pow_sign = 1.0; // pow(-1.0, 0)\n//...\nfor (//...\n{\n  pow_sign *= -1.0;\n  pi += (pow_sign * //...\n</code></pre>\n\n<p>Also, we know that <code>pow(x, 3)</code> is the same as <code>x * x * x</code>.  Making the substitution:<br>\n<code>pow(fac(k), 3.0)</code> --> <code>factorial_k * factorial_k * factorial_k</code></p>\n\n<h2>Algebraic Simplification</h2>\n\n<p>You can also simplify your assignment statement algebraically.\nFor example, make a table consisting of the following columns:  </p>\n\n<pre><code>+-----+--------------+--------------+  \n|  k  | fac(6.0 * k) | fac(3.0 * k) |  \n+-----+--------------+--------------+  \n|  0  |              |              |  \n+-----+--------------+--------------+  \n|  1  |              |              |  \n+-----+--------------+--------------+  \n</code></pre>\n\n<p>See if you notice any patterns.<br>\nAlso rewrite the assignment vertically to see if you can simplify by factoring.  </p>\n\n<h2>Exploiting GPU cores</h2>\n\n<p>Once you have optimized the calculation to a running or iterative approach, you can delegate to multiple cores.</p>\n\n<p>The first step is to figure out how you can divide the work into pieces that can be run in parallel.  </p>\n\n<p>Split your calculations into three pieces and run (on one core).  Verify correctness.  </p>\n\n<p>Next step is to either research \"c++ parallel programming\" for instructions on how to run the program using parallel processing on your platform, or search the internet on \"c++ use gpu multiple cores\".</p>\n\n<p>You want the amount of work that each core receives to consume more time that the overhead of setting up the cores.  </p>\n"}], "owner": {"reputation": 53, "user_id": 3587527, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002143813145/picture?type=large", "display_name": "user3587527", "link": "https://stackoverflow.com/users/3587527/user3587527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "closed_date": 1536219824, "answer_count": 1, "score": -1, "last_activity_date": 1536192718, "creation_date": 1536189693, "question_id": 52194547, "link": "https://stackoverflow.com/questions/52194547/making-c-pi-approximation-running-in-paralell-on-gpu-nvidia-970m-cudas", "closed_reason": "Not suitable for this site", "title": "Making C++ Pi approximation running in Paralell on GPU Nvidia 970M CUDA&#39;s", "body": "<p>I got this code from The Chudnovsky formula for Pi approximation and I want to do it faster and faster. But I have no experience or idea of how to deal with GPU's. How to make this code runs on GPU Nvidea 970M? It's on C++. There's some easy lib to make it? With my processor it's running about 3~4s... </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;windows&gt;\n#include &lt;iomanip&gt;\n#include &lt;cmath&gt;\n\ndouble fac(double num) {\n    double result = 1.0;\n    for (double i=2.0; i&lt;num; i++)\n       result *= i;\n    return result;\n}\n\nint main() {\n    using namespace std;\n    double pi=0.0;\n    for (double k = 0.0; k &lt; 10.0; k++) {\n        pi += (pow(-1.0,k) * fac(6.0 * k) * (13591409.0 + (545140134.0 * k)))\n            / (fac(3.0 * k) * pow(fac(k), 3.0) * pow(640320.0, 3.0 * k + 3.0/2.0));\n    }\n    pi *= 12.0;\n    cout &lt;&lt; setprecision(100000000) &lt;&lt; 1.0 / pi &lt;&lt; endl;\nsystem(\"Pause\");    \nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "bit-fields", "enum-class"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1536255893, "post_id": 52194486, "comment_id": 91368553, "body": "It is interesting that GCC gives a spurious warning <code>10:9: warning: &#39;S::e&#39; is too small to hold all values of &#39;enum class E&#39;</code> for any bit field size except 32, and clang doesn&#39;t warn about this even when the enum range really won&#39;t fit. perhaps this special handling of bitfields is partially why GCC can&#39;t perform the aggregate initialisation?"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1536200016, "post_id": 52195376, "comment_id": 91340679, "body": "instead of &quot;From the description of list initialization used in a return statement&quot; it would be good to provide Standard quotes, and in particular point out why aggregate initialization should not apply here"}, {"owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 2, "creation_date": 1536200171, "post_id": 52195376, "comment_id": 91340719, "body": "@1201ProgramAlarm I think you&#39;re right, but I also think that gcc is trying to do some narrowing conversation on the scoped enum(with <code>int</code> as it underlaying type) to the bit field, which is prohibited in a list-initialization that is not direct, like in the case of the return, i do think this because if you turn the enum into an unscoped one(for which implicit conversion to <code>int</code> is allowed) or increase the bit field to 32 so that perfect match happens, the error disappear even leaving the initialization as copy-list-initialzation"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 0, "creation_date": 1536201088, "post_id": 52195376, "comment_id": 91340912, "body": "@xhamr After further investigation I&#39;ve changed my verdict and rewrote the answer."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 4, "last_activity_date": 1536201025, "last_edit_date": 1536201025, "creation_date": 1536198371, "answer_id": 52195376, "question_id": 52194486, "link": "https://stackoverflow.com/questions/52194486/enum-bitfield-and-aggregate-initialization/52195376#52195376", "title": "Enum bitfield and aggregate initialization", "body": "<p><code>return {E::Good, 100};</code> performs <a href=\"https://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">copy list initialization</a> of the return value.  The effect of this list initialization is an <a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">aggregate initialization</a>.</p>\n\n<p>So is <code>S</code> an aggregate?  The description of an <a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">aggregate</a> varies depending on which version of C++ you're using, but in all cases <code>S</code> should be an aggregate so this should compile.  Clang (and MSVC) have the correct behavior.</p>\n\n<p>The fix is simple, though.  Change your return statement to return the correctly typed object:</p>\n\n<pre><code>return S{E::Good, 100};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 3, "last_activity_date": 1536363102, "last_edit_date": 1536363102, "creation_date": 1536360899, "answer_id": 52230496, "question_id": 52194486, "link": "https://stackoverflow.com/questions/52194486/enum-bitfield-and-aggregate-initialization/52230496#52230496", "title": "Enum bitfield and aggregate initialization", "body": "<p>This should be well-formed and so this is a gcc bug.</p>\n\n<p>We end up at aggregate initialization via <a href=\"https://timsong-cpp.github.io/cppwp/n3337/stmt.return#2\" rel=\"nofollow noreferrer\">[stmt.return]p2</a> which says:</p>\n\n<blockquote>\n  <p>\u2026 A return statement with a braced-init-list initializes the object or reference to be returned from the function by copy-list-initialization ([dcl.init.list]) from the specified initializer list.  \u2026</p>\n</blockquote>\n\n<p>then  <a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.init.list#3.2\" rel=\"nofollow noreferrer\">[dcl.init.list]p3.2</a> says:</p>\n\n<blockquote>\n  <p>Otherwise, if T is an aggregate, aggregate initialization is performed ([dcl.init.aggr]). \u2026</p>\n</blockquote>\n\n<p>At this point we may wonder if this is a narrowing conversion and therefore ill-formed but <a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.init.list#7\" rel=\"nofollow noreferrer\">[dcl.init.list]p7</a> does not have any clauses that cover this case and no other cases in [dcl.init.list] apply to make this ill-formed. </p>\n\n<p>We can see with a similar example which removes enum from the equation but keeps the bit-field shows neither gcc nor clang gives us a narrowing conversion diagnostic, which we expect to be the case, although this similar problem is covered by <a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.init.list#7.4\" rel=\"nofollow noreferrer\">[dcl.init.list]p7.4</a> although not ill-formed:</p>\n\n<pre><code>struct S2 {\n    int e : 2 ;\n    int dummy ;\n} ;\n\nS2 foo( int x ) {\n   return {x, 100} ;\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/avrylO\" rel=\"nofollow noreferrer\">see it live in godbolt</a></p>\n\n<p>As observed gcc does not seem to have a problem in other contexts i.e.</p>\n\n<pre><code>S f(E e1, int x) {  \n  S s {e1,100} ;\n  return s;\n}\n</code></pre>\n\n<p>So you do have work-arounds available.</p>\n"}], "owner": {"reputation": 7736, "user_id": 875044, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/19f2cbd347ab25e98b5aa05ee5673453?s=128&d=identicon&r=PG", "display_name": "Kan Li", "link": "https://stackoverflow.com/users/875044/kan-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 3, "accepted_answer_id": 52230496, "answer_count": 2, "score": 13, "last_activity_date": 1536363102, "creation_date": 1536189072, "last_edit_date": 1536362168, "question_id": 52194486, "link": "https://stackoverflow.com/questions/52194486/enum-bitfield-and-aggregate-initialization", "title": "Enum bitfield and aggregate initialization", "body": "<p>The following code is accepted by clang 6.0.0 but rejected by gcc 8.2</p>\n\n<pre><code>enum class E {\n  Good, Bad,\n};\n\nstruct S {\n  E e : 2;\n  int dummy;\n};\n\nS f() {\n  return {E::Good, 100};\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/A4LBuZ\" rel=\"nofollow noreferrer\">Live godbolt example</a></p>\n\n<p>The GCC complains</p>\n\n<blockquote>\n  <p>error: could not convert '<code>{Good, 100}</code>' from '<code>&lt;brace-enclosed initializer list&gt;</code>' to '<code>S</code>'</p>\n</blockquote>\n\n<p>Which one is correct? Where in the standard talks about this situation?</p>\n"}, {"tags": ["c++", "visual-studio", "clr"], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 3455833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/95380e309cb0d90b9ec2bf0028b5f410?s=128&d=identicon&r=PG&f=1", "display_name": "ekremer", "link": "https://stackoverflow.com/users/3455833/ekremer"}, "is_accepted": true, "score": 0, "last_activity_date": 1536246389, "creation_date": 1536246389, "answer_id": 52207130, "question_id": 52194482, "link": "https://stackoverflow.com/questions/52194482/c-project-compilation-forcing-the-option-clr-though-executing-it-with-no-comm/52207130#52207130", "title": "C++ project compilation forcing the option /clr though executing it with no Common Language Runtime support", "body": "<p>For those into this question, the answer is that you might try many advices on the internet related to adjusting the compilation options. If nothing works which is likely (trust me config files tend to get messy), I advise you to create a new Win32 project and put all your sources into this project. </p>\n"}], "owner": {"reputation": 315, "user_id": 3455833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/95380e309cb0d90b9ec2bf0028b5f410?s=128&d=identicon&r=PG&f=1", "display_name": "ekremer", "link": "https://stackoverflow.com/users/3455833/ekremer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 52207130, "answer_count": 1, "score": -1, "last_activity_date": 1536246389, "creation_date": 1536189020, "last_edit_date": 1536189973, "question_id": 52194482, "link": "https://stackoverflow.com/questions/52194482/c-project-compilation-forcing-the-option-clr-though-executing-it-with-no-comm", "title": "C++ project compilation forcing the option /clr though executing it with no Common Language Runtime support", "body": "<p>I have a CLI/C++ project in which I removed the code in .NET and left only the code in C++. Though I already switched off the option /clr from the project by selecting <strong>No Common Language Runtime support</strong>, during compilation the code throws the error:</p>\n\n<pre><code>Command line error D8016 : '/EHs' and '/clr' command-line options are incompatible\n</code></pre>\n\n<p>In addition, the log file generated during the compilation shows:</p>\n\n<pre><code>...\n...\n/FD /EHsc /MTd /Fo\"C:\\Users\\Ende\\Desktop\\Slot2008\\build\\Debug\\\\\" /Fd\"C:\\Users\\Ende\\Desktop\\Slot2008\\build\\Debug\\\\vc90.pdb\"\n/W3 /c /Zi /clr /TP /wd4945 .\\MAIN.cpp\n</code></pre>\n\n<p>So, one way or another, VC++ is forcing the compilation with the option /clr though it is off. Thanks in advance for any explanation for this behavior. </p>\n"}, {"tags": ["c++", "casting", "bytebuffer", "strict-aliasing"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1536188019, "post_id": 52194327, "comment_id": 91338413, "body": "I have yet to see any utility for std::byte. Does anyone have a good example of where it might be useful?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1536189306, "post_id": 52194327, "comment_id": 91338649, "body": "&gt; &quot;which would allow me to be more expressive, and let me alias the raw data pixel by pixel.&quot; I&#39;m pretty sure that&#39;s still UB. to_integer() is basically just a wrapper around memcpy."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1536189994, "post_id": 52194327, "comment_id": 91338795, "body": "Note an <code>unsigned char</code> array is already ideal for accessing the data pixel by pixel. (Not sure what you mean by &quot;alias&quot; there). The advantages of <code>std::byte</code> are making it less likely you&#39;ll accidentally use it in some types of arithmetic, and as you mentioned, expressing the nature of the data more obviously."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1536190160, "post_id": 52194327, "comment_id": 91338833, "body": "@NeilButterworth I think the main point of it is to disable implicit conversions, in comparison to use of <code>unsigned char</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536190193, "post_id": 52194327, "comment_id": 91338837, "body": "@NeilButterworth Its usefulness is thin but not absent; even just looking at streaming it (versus the gymnastics required when using the semantically-overloaded <code>char</code>) is a benefit in itself. Arguably. I&#39;d say it&#39;s mostly a self-documentation thing tbh."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1536190406, "post_id": 52194327, "comment_id": 91338878, "body": "@M.M Most C++ and C code depends on completely harmless implicit integer conversions (unless we are Haskell programmers, of course). std::byte seems to involve so many problems with explicit conversions (vide this question) that I still doubt its utility. I would like to see an example of a medium to large scale C++ library or executable where std::byte was used and found to be worthwhile."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1536190452, "post_id": 52194327, "comment_id": 91338886, "body": "@NeilButterworth Personally I agree with you, although many people seem to be strongly opposed to implicit conversions"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 5, "last_activity_date": 1536189850, "creation_date": 1536189850, "answer_id": 52194568, "question_id": 52194327, "link": "https://stackoverflow.com/questions/52194327/is-there-a-legal-way-to-convert-a-unsigned-char-pointer-to-stdbyte-pointer/52194568#52194568", "title": "Is there a legal way to convert a unsigned char pointer to std::byte pointer?", "body": "<p>The strict aliasing rule never forbids any pointer conversions. It is about the type of an expression accessing an object. </p>\n\n<p><code>std::byte</code> may alias any other type, this is mentioned in the cppreference page you linked, as well as in the strict aliasing rule in the Standard of course (C++17 basic.lval/8.8).  So it is fine to use <code>reinterpret_cast&lt;std::byte *&gt;</code> and then read or write the array of <code>unsigned char</code>.</p>\n\n<p>If you use an expression of type <code>uint32_t</code> to read or write an array of <code>unsigned char</code>, that would violate the strict aliasing rule. </p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1536190081, "post_id": 52194573, "comment_id": 91338814, "body": "<code>std::byte</code> certainly does not inherit from <code>unsigned char</code>, if for no other reason than such a thing is impossible. The latter is the underlying type of the former, however, which is a scoped enum."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536190098, "post_id": 52194573, "comment_id": 91338819, "body": "(Admittedly the distinction seems largely academic in the grand scheme of things)"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1536190328, "post_id": 52194573, "comment_id": 91338859, "body": "It&#39;s not relevant that <code>unsigned char</code> is the underlying type of <code>std::byte</code>, since there is no general allowance for aliasing between an enumeration and its underlying type in either direction. Instead, there&#39;s a specific allowance for accessing any object via <code>std::byte</code>."}], "tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": false, "score": 4, "last_activity_date": 1536190217, "last_edit_date": 1536190217, "creation_date": 1536189906, "answer_id": 52194573, "question_id": 52194327, "link": "https://stackoverflow.com/questions/52194327/is-there-a-legal-way-to-convert-a-unsigned-char-pointer-to-stdbyte-pointer/52194573#52194573", "title": "Is there a legal way to convert a unsigned char pointer to std::byte pointer?", "body": "<blockquote>\n  <p>Can I legally convert a unsigned char* to std::byte* according to the strict aliasing rule?</p>\n</blockquote>\n\n<p>Yes, that's specifically why <code>std::byte</code> \"inherits\" from <code>unsigned char</code>. But you have to go through <code>reinterpret_cast&lt;&gt;</code> much like you have to when casting an arbitrary type to <code>char*</code> or <code>unsigned char*</code></p>\n\n<blockquote>\n  <p>And then can I cast the data to another datatype like std::uint32_t* and mutate it.</p>\n</blockquote>\n\n<p>No. You cannot do anything with <code>std::byte</code> that you cannot with <code>char*</code> or <code>unsigned char*</code>.</p>\n\n<p>The main thing <code>std::byte</code> seems to be useful for is to have functions that can have both string and raw-data overloads. </p>\n\n<p>Also, it gets rid of the following annoyance:</p>\n\n<pre><code>char val = foo();\nstd::cout &lt;&lt; (int)val &lt;&lt; \"\\n\";\n</code></pre>\n"}], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 1, "accepted_answer_id": 52194568, "answer_count": 2, "score": 0, "last_activity_date": 1536190217, "creation_date": 1536187768, "last_edit_date": 1536188219, "question_id": 52194327, "link": "https://stackoverflow.com/questions/52194327/is-there-a-legal-way-to-convert-a-unsigned-char-pointer-to-stdbyte-pointer", "title": "Is there a legal way to convert a unsigned char pointer to std::byte pointer?", "body": "<p>I use the <a href=\"https://github.com/nothings/stb\" rel=\"nofollow noreferrer\">STB</a> library to load images into memory. The specific function, <a href=\"https://github.com/nothings/stb/blob/master/stb_image.h#L364\" rel=\"nofollow noreferrer\"><code>stbi_load</code></a>, returns a pointer to an <code>unsigned char</code>, which is an array.</p>\n\n<p>I'm tempted to use the new C++17 API for raw data, <a href=\"https://en.cppreference.com/w/cpp/types/byte\" rel=\"nofollow noreferrer\"><code>std::byte</code></a>, which would allow me to be more expressive, and let me alias the raw data pixel by pixel, or color by color by casting it to different data type (integers of different size).</p>\n\n<p>Now I tried this:</p>\n\n<pre><code>std::unique_ptr&lt;std::byte[], stbi_deleter&gt;(stbi_load(...));\n</code></pre>\n\n<p>Of course it didn't work due to the lack of implicit conversion.</p>\n\n<p>Then I tried that:</p>\n\n<pre><code>std::unique_ptr&lt;std::byte[], stbi_deleter&gt;(\n  static_cast&lt;std::byte*&gt;(stbi_load(...))\n);\n</code></pre>\n\n<p>Again, it still didn't worked. I had to resolve to use <code>reinterpret_cast</code> instead. And made me question whether this conversion is legal or not. Can I legally convert a <code>unsigned char*</code> to <code>std::byte*</code> <strong>according to the strict aliasing rule</strong>? And then can I cast the data to another datatype like <code>std::uint32_t*</code> and mutate it? Will that also break the aliasing rule? </p>\n"}, {"tags": ["c++", "qt", "qpainter"], "comments": [{"owner": {"reputation": 821, "user_id": 7120215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fd56db37a030fa5ac42d45f06df3f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Gurushant", "link": "https://stackoverflow.com/users/7120215/gurushant"}, "edited": false, "score": 0, "creation_date": 1536207881, "post_id": 52194141, "comment_id": 91342203, "body": "Do you want a three pixel large dot or a dash? If you want dash then you should have used Qt::DotLine instead of SolidLine. Edit your question to make your objective clear"}, {"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "reply_to_user": {"reputation": 821, "user_id": 7120215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fd56db37a030fa5ac42d45f06df3f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Gurushant", "link": "https://stackoverflow.com/users/7120215/gurushant"}, "edited": false, "score": 0, "creation_date": 1536213870, "post_id": 52194141, "comment_id": 91344080, "body": "@Gurushant I though the first sentence already says that I want a point. Isn&#39;t <i>point</i> a synonym for <i>dot</i>?"}, {"owner": {"reputation": 821, "user_id": 7120215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fd56db37a030fa5ac42d45f06df3f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Gurushant", "link": "https://stackoverflow.com/users/7120215/gurushant"}, "edited": false, "score": 1, "creation_date": 1536214331, "post_id": 52194141, "comment_id": 91344249, "body": "Yeah of course, but later you said &quot;then I get normal point, not a &quot;dash&quot;&quot;. I don&#39;t understand what you meant here."}, {"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "reply_to_user": {"reputation": 821, "user_id": 7120215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fd56db37a030fa5ac42d45f06df3f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Gurushant", "link": "https://stackoverflow.com/users/7120215/gurushant"}, "edited": false, "score": 0, "creation_date": 1536214782, "post_id": 52194141, "comment_id": 91344452, "body": "@Gurushant OK, I&#39;ve tried to clarify, please see if it&#39;s better."}], "answers": [{"comments": [{"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1536229964, "post_id": 52197905, "comment_id": 91353004, "body": "I&#39;ve found the culprit, see my answer."}], "tags": [], "owner": {"reputation": 821, "user_id": 7120215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fd56db37a030fa5ac42d45f06df3f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Gurushant", "link": "https://stackoverflow.com/users/7120215/gurushant"}, "is_accepted": false, "score": 0, "last_activity_date": 1536225483, "last_edit_date": 1536225483, "creation_date": 1536215924, "answer_id": 52197905, "question_id": 52194141, "link": "https://stackoverflow.com/questions/52194141/why-does-qpainterdrawpoint-draw-a-horizontal-line-segment/52197905#52197905", "title": "Why does QPainter::drawPoint draw a horizontal line segment?", "body": "<p>Though I have not been able to pin point why exactly the problem occurs, I have got relatively close to the solution. The problem lies with scaling. I did a lots of trial and error with different scaling and width of point with the below code.</p>\n\n<pre><code>const int w=500, h=500;\nconst int scale = 100;\nfloat xPos = 250;\nfloat yPos = 250;\nfloat widthF = 5;\nQImage img(w, h, QImage::Format_RGBX8888);\n{\n    QPainter p(&amp;img);\n    p.setRenderHints(QPainter::Antialiasing);\n    p.fillRect(0,0,w,h,Qt::black);\n    p.scale(scale, scale);\n    p.setPen(QPen(Qt::red, widthF/(scale), Qt::SolidLine, Qt::RoundCap));\n    p.drawPoint(QPointF(xPos/scale, yPos/scale));\n}\nimg.save(\"test.png\");\n</code></pre>\n\n<p>The above code produces the image<br>\n<a href=\"https://i.stack.imgur.com/EJUMP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EJUMP.png\" alt=\"enter image description here\"></a></p>\n\n<p>My observations are<br>\n1) Due to high scaling, the point (which is just 3 pixel wide) is not able to scale proportionally at lower width (width of point), if you set width as something like 30 the round shape is visible.<br>\n2) If you want to keep the width of point low then you have to decrease the scaling.<br>\n Sadly I can not explain why at high scaling it is not expanding proportionally.</p>\n"}, {"comments": [{"owner": {"reputation": 821, "user_id": 7120215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fd56db37a030fa5ac42d45f06df3f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Gurushant", "link": "https://stackoverflow.com/users/7120215/gurushant"}, "edited": false, "score": 0, "creation_date": 1536230846, "post_id": 52202079, "comment_id": 91353505, "body": "This explains why! Thanks, I could not concentrate on other work because of this"}], "tags": [], "owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "is_accepted": true, "score": 2, "last_activity_date": 1536231343, "last_edit_date": 1536231343, "creation_date": 1536229915, "answer_id": 52202079, "question_id": 52194141, "link": "https://stackoverflow.com/questions/52194141/why-does-qpainterdrawpoint-draw-a-horizontal-line-segment/52202079#52202079", "title": "Why does QPainter::drawPoint draw a horizontal line segment?", "body": "<p>It appears that <code>QPaintEngineEx::drawPoints</code> renders points as line segments of length <code>1/63.</code>. See the following code from <a href=\"http://code.qt.io/cgit/qt/qtbase.git/tree/src/gui/painting/qpaintengineex.cpp#n846\" rel=\"nofollow noreferrer\">qtbase/src/gui/painting/qpaintengineex.cpp</a> in the Qt sources:</p>\n\n<pre><code>void QPaintEngineEx::drawPoints(const QPointF *points, int pointCount)\n{\n    QPen pen = state()-&gt;pen;\n    if (pen.capStyle() == Qt::FlatCap)\n        pen.setCapStyle(Qt::SquareCap);\n\n    if (pen.brush().isOpaque()) {\n        while (pointCount &gt; 0) {\n            int count = qMin(pointCount, 16);\n            qreal pts[64];\n            int oset = -1;\n            for (int i=0; i&lt;count; ++i) {\n                pts[++oset] = points[i].x();\n                pts[++oset] = points[i].y();\n                pts[++oset] = points[i].x() + 1/63.;\n                pts[++oset] = points[i].y();\n            }\n            QVectorPath path(pts, count * 2, qpaintengineex_line_types_16, QVectorPath::LinesHint);\n            stroke(path, pen);\n            pointCount -= 16;\n            points += 16;\n        }\n    } else {\n        for (int i=0; i&lt;pointCount; ++i) {\n            qreal pts[] = { points[i].x(), points[i].y(), points[i].x() + qreal(1/63.), points[i].y() };\n            QVectorPath path(pts, 2, 0);\n            stroke(path, pen);\n        }\n    }\n}\n</code></pre>\n\n<p>Notice the <code>pts[++oset] = points[i].x() + 1/63.;</code> line in the opaque brush branch. This is the second vertex of the path \u2014 shifted with respect to the desired position of the point.</p>\n\n<p>This explains why the line extends to the right of the position requested and why it depends on the scale. So, it seems the code in the OP isn't wrong for an ideal <code>QPainter</code> implementation, but just has come across a Qt bug (be it in the implementation of the method or in its documentation).</p>\n\n<p>So the conclusion: one <em>has</em> to work around this problem by either using different scale, or drawing ellipses, or drawing line segments with much smaller lengths than what <code>QPainter::drawPoints</code> does.</p>\n\n<p>I've reported this as <a href=\"https://bugreports.qt.io/browse/QTBUG-70409\" rel=\"nofollow noreferrer\">QTBUG-70409</a>.</p>\n"}], "owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 52202079, "answer_count": 2, "score": 2, "last_activity_date": 1536231343, "creation_date": 1536186435, "last_edit_date": 1536216676, "question_id": 52194141, "link": "https://stackoverflow.com/questions/52194141/why-does-qpainterdrawpoint-draw-a-horizontal-line-segment", "title": "Why does QPainter::drawPoint draw a horizontal line segment?", "body": "<p>I'm trying to draw a 3-pixel large point with <code>QPainter</code>. But the following code instead draws a horizontal line with width of 3 pixels.</p>\n\n<pre><code>#include &lt;QPainter&gt;\n#include &lt;QImage&gt;\n\nint main()\n{\n    const int w=1000, h=1000;\n    QImage img(w, h, QImage::Format_RGBX8888);\n    {\n        QPainter p(&amp;img);\n        p.fillRect(0,0,w,h,Qt::black);\n        p.scale(w,h);\n        p.setPen(QPen(Qt::red, 3./w, Qt::SolidLine, Qt::RoundCap));\n        p.drawPoint(QPointF(0.1,0.1));\n    }\n    img.save(\"test.png\");\n}\n</code></pre>\n\n<p>Here's the top left corner of the resulting image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MyHLo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MyHLo.png\" alt=\"line instead of a point\"></a></p>\n\n<p>I am expecting to get a point which is red circle, or at least a square\u00a0\u2014 but instead I get this line segment. If I comment out <code>p.scale(w,h)</code> and draw the point with width <code>3</code> (instead of <code>3./w</code>) at position <code>(100,100)</code>, then I get a small mostly symmetric 3-pixel in height and width point.</p>\n\n<p>What's going on? Why do I get a line segment instead of point as expected? And how to fix it, without resorting to drawing an ellipse or to avoiding <code>QPainter::scale</code>?</p>\n\n<p>I'm using Qt 5.10.0 on Linux x86 with g++ 5.5.0. The same happens on Qt 5.5.1.</p>\n"}, {"tags": ["c++", "pointers", "inheritance"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1536186177, "post_id": 52194013, "comment_id": 91337973, "body": "Is every <code>Animal</code> supposed to be have a <code>breed</code>? If so, then class <code>Animal</code> should have  a <code>breed</code> member. If not, then <code>animals[0]-&gt;breed</code> is not sensible since not every <code>Animal</code> has a <code>breed</code> so there is no way to get a <code>breed</code> from an <code>Animal</code>. Heck, who even knows what type it is? <code>Cat</code> could be derived from <code>Animal</code> and have an <code>int</code> called <code>breed</code> for all the compiler knows."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1536186598, "post_id": 52194067, "comment_id": 91338087, "body": "When using <code>dynamic_cast</code>, make sure to check the return value for NULL before using the pointer, eg: <code>Dog *d = dynamic_cast&lt;Dog*&gt;(animals[0]); if (d) { cout &lt;&lt; d-&gt;breed &lt;&lt; endl; } else { &#47;* not a Dog, do something else *&#47; }</code>"}, {"owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "edited": false, "score": 0, "creation_date": 1536187306, "post_id": 52194067, "comment_id": 91338245, "body": "Casting from <code>Animal</code> to <code>Dog</code> would be downcast, not upcast, right?"}], "tags": [], "owner": {"reputation": 15340, "user_id": 1560035, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fe3aa4a1766a44d8f27db8a95cb573ed?s=128&d=identicon&r=PG", "display_name": "TheoretiCAL", "link": "https://stackoverflow.com/users/1560035/theoretical"}, "is_accepted": false, "score": 0, "last_activity_date": 1536277140, "last_edit_date": 1536277140, "creation_date": 1536185889, "answer_id": 52194067, "question_id": 52194013, "link": "https://stackoverflow.com/questions/52194013/how-to-dynamically-create-and-use-a-derived-class-from-a-base-class/52194067#52194067", "title": "How to dynamically create and use a derived class from a base class?", "body": "<p>An <code>Animal</code> (the base class) does not have a <code>breed</code> member variable, as a result you are receiving the error. Even though a <code>Dog</code> has a breed member variable, the <code>Animal</code> knows nothing about it. The correct code would be to cast the <code>Animal</code> pointer to a <code>Dog</code> using a <code>dynamic_cast</code> to cast down the class hierarchy, then you will have access to the class member:</p>\n\n<pre><code>cout&lt;&lt;dynamic_cast&lt;Dog*&gt;(animals[0])-&gt;breed&lt;&lt;endl;\n</code></pre>\n\n<p>Note in general its good practice to check if the pointer returned by the <code>dynamic_cast</code> is not <code>NULL</code> before using it, as it can return <code>NULL</code> if the cast failed. </p>\n"}], "owner": {"reputation": 1, "user_id": 9795089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55d36ae2b9855c9b0ab507d73aa6f5f?s=128&d=identicon&r=PG&f=1", "display_name": "Foxly", "link": "https://stackoverflow.com/users/9795089/foxly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536277140, "creation_date": 1536185476, "last_edit_date": 1536185897, "question_id": 52194013, "link": "https://stackoverflow.com/questions/52194013/how-to-dynamically-create-and-use-a-derived-class-from-a-base-class", "title": "How to dynamically create and use a derived class from a base class?", "body": "<p>I want to use a pointer to a parent class to allocate and use a child class object. I have an Animal class with a child Dog class, the Assign class should add a Dog class to its Animal pointer array (<code>Animal**animals</code>). At the moment <code>cout&lt;&lt;animals[0]-&gt;weight</code> outputs correctly, but <code>animals[0]-&gt;breed</code> gives error:  <code>Class 'Animal' has no member named 'breed'</code>. I have to do it like this as this is for a practical (this is also a simplified example, as in the real example we'll have an array of Animal/derived Animal objects). Here is the code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;iomanip&gt;\n\nusing namespace std;\n\nclass Animal{\npublic:\n  double weight;\n  Animal(double w){\n    weight=w;\n  }\n  void shout(){\n    cout&lt;&lt;\"Weight: \"&lt;&lt;weight&lt;&lt;endl;\n  }\n};\n\nclass Dog: public Animal{\npublic:\n  string breed;\n  Dog(string b,double w): Animal(w){\n    breed=b;\n    weight=w;\n  }\n};\n\nclass Asign{\npublic:\n  Animal**animals;\n  Asign(){\n    animals=new Animal*[2];\n    animals[0]=new Dog(\"Great Dane\",12.2);\n    cout&lt;&lt;animals[0]-&gt;breed&lt;&lt;endl;//Does not work\n  }\n};\n\nint main(){\n  Dog Duke(\"Great dane\",12.2);\n  Asign a;\n}\n</code></pre>\n"}, {"tags": ["c++", "lambda", "eigen"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 884553, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/396bdb6e7cdbfc4629d6c081d4a2b8e0?s=128&d=identicon&r=PG", "display_name": "TMS", "link": "https://stackoverflow.com/users/884553/tms"}, "edited": false, "score": 0, "creation_date": 1536188474, "post_id": 52194289, "comment_id": 91338504, "body": "what do you mean &quot;using the head of Eigen&quot; ? i don&#39;t think a(c) = b(c) working"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "reply_to_user": {"reputation": 301, "user_id": 884553, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/396bdb6e7cdbfc4629d6c081d4a2b8e0?s=128&d=identicon&r=PG", "display_name": "TMS", "link": "https://stackoverflow.com/users/884553/tms"}, "edited": false, "score": 0, "creation_date": 1536218231, "post_id": 52194289, "comment_id": 91346047, "body": "I meant the devel branch, also called the default branch: <a href=\"http://bitbucket.org/eigen/eigen/get/default.tar.bz2\" rel=\"nofollow noreferrer\">eigen_default.tar.bz2</a>"}, {"owner": {"reputation": 301, "user_id": 884553, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/396bdb6e7cdbfc4629d6c081d4a2b8e0?s=128&d=identicon&r=PG", "display_name": "TMS", "link": "https://stackoverflow.com/users/884553/tms"}, "edited": false, "score": 0, "creation_date": 1536249337, "post_id": 52194289, "comment_id": 91365299, "body": "ah, I can not use the devel branch, but your std::vector suggestion is good enough. Thanks"}], "tags": [], "owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "is_accepted": true, "score": 1, "last_activity_date": 1536187421, "creation_date": 1536187421, "answer_id": 52194289, "question_id": 52193865, "link": "https://stackoverflow.com/questions/52193865/how-to-use-eigen-unaryexpr-and-lambda-function-without-return-values/52194289#52194289", "title": "How to use (eigen) unaryExpr and lambda function without return values?", "body": "<p>You are using a functional programming style to produce pure side-effects, that's not very elegant, and this is not how <code>unaryExpr</code> is supposed to be used. I would suggest a <code>std::vector&lt;int&gt;</code> for <code>c</code> and a for loop to make your intent clearer:</p>\n\n<pre><code>std::vector&lt;int&gt; c = {0, 2, 5, 7};\nfor(auto i:c) a[i] = b[i];\n</code></pre>\n\n<p>or using the head of Eigen:</p>\n\n<pre><code>a(c) = b(c);\n</code></pre>\n\n<p>with <code>c</code> either a <code>VectorXi</code> or a <code>std::vector&lt;int&gt;</code> or whatever...</p>\n"}], "owner": {"reputation": 301, "user_id": 884553, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/396bdb6e7cdbfc4629d6c081d4a2b8e0?s=128&d=identicon&r=PG", "display_name": "TMS", "link": "https://stackoverflow.com/users/884553/tms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 52194289, "answer_count": 1, "score": 0, "last_activity_date": 1553693893, "creation_date": 1536184480, "question_id": 52193865, "link": "https://stackoverflow.com/questions/52193865/how-to-use-eigen-unaryexpr-and-lambda-function-without-return-values", "title": "How to use (eigen) unaryExpr and lambda function without return values?", "body": "<p>Here is my example code:</p>\n\n<pre><code>using namespace Eigen;\nVectorXi a = VectorXi::Random(10);\nVectorXi b = VectorXi::Random(10);\nVectorXi c;\nc &lt;&lt; 0, 2, 5, 7;\nc.unaryExpr([&amp;](int i) { a[i] = b[i]; }); // This will not work\nc.unaryExpr([&amp;](int i) { a[i] = b[i]; return 0; }); // This works\n</code></pre>\n\n<p>I want to copy elements from b to a using indices stored in c. Is this the correct way to use a lambda function in eigen unaryExpr ? How do I avoid the code \"return 0;\" since I'm not returning anything.</p>\n\n<p>I'm using g++ 8.1.0</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "enums", "constants"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1536184023, "post_id": 52193770, "comment_id": 91337352, "body": "If it&#39;s a value, the use of <code>const</code> is debatable in utility."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1536184040, "post_id": 52193770, "comment_id": 91337361, "body": "It should make no difference whether it is an enum, another built-in type, or a user defined type. What this does is prevent you from modifying <code>var</code> in the body of the function. That&#39;s it. It follows that it only makes sense in a function definition, not a declaration."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1536184060, "post_id": 52193770, "comment_id": 91337370, "body": "<code>const</code> can be used to signal intent, even if it&#39;s a value-type."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1536184100, "post_id": 52193770, "comment_id": 91337380, "body": "@juanchopanza I think the reviewer is coming from the fact that the enum is already &quot;const&quot; so the addition of it is unneeded."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536184134, "post_id": 52193770, "comment_id": 91337391, "body": "@NathanOliver I don&#39;t even know what that would mean."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1536184178, "post_id": 52193770, "comment_id": 91337408, "body": "The question isn&#39;t whether an enum is already const.  It&#39;s already clear that if it&#39;s an enum that the const has no effect..  My point is that the ownership of the typedef of that type is elsewhere and may change so that it becomes an object where const matters."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1536184271, "post_id": 52193770, "comment_id": 91337437, "body": "@juanchopanza You can&#39;t modify a enum value, <code>enum FOO { bar }; int main() { bar = 2; }</code> fails to compile so a <code>const FOO</code> isn&#39;t needed as you can&#39;t modify the enumeration."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1536184295, "post_id": 52193770, "comment_id": 91337443, "body": "&quot; so that it becomes pass-by-ref &quot; - that can&#39;t happen unless the signature of the function changes."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536184397, "post_id": 52193770, "comment_id": 91337466, "body": "@NathanOliver <code>FOO x = FOO::a; x = FOO::b;</code>"}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1536184419, "post_id": 52193770, "comment_id": 91337476, "body": "@NeilButterworth - thanks for helping me clarify, I&#39;ve edited my above comment."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1536184469, "post_id": 52193770, "comment_id": 91337498, "body": "@dai - I don&#39;t believe this is a duplicate, can you see the edits I&#39;ve added to the question?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1536184496, "post_id": 52193770, "comment_id": 91337507, "body": "@juanchopanza Durp.  Must need more coffee.  Not sure why I went down that rabbit hole."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1536184575, "post_id": 52193770, "comment_id": 91337529, "body": "&quot;should we use const if we the definition of the type is in another part of the codebase and we can&#39;t guarantee that the type will stay an enum&quot; - really do not see what this has to do specifically with enum types, as  opposed  to (say) ints."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1536184703, "post_id": 52193770, "comment_id": 91337570, "body": "Your question just taught me something about C++.  I don&#39;t think, normally, you need to worry much about what some_type may become in the future.  If you are concerned, you could add some <code>static_assert</code> to check that some_type is-and-continues-to-be an enum.  I think that is supported in the type traits."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1536185192, "post_id": 52193770, "comment_id": 91337706, "body": "It really doesn&#39;t matter, the underlying type of <code>enum</code> is <i>typically</i> <code>int</code> but it can be any integral type equivalent to or smaller than <code>int</code>. Your reviewer is probably saying that using <code>const</code> is a mistake because from a performance pov it doesn&#39;t matter, which is dogmatic, <code>const</code> signifies intent. Also if <code>some_type</code> becomes some massively large type and needs to be changed to pass by reference then you&#39;d need to change the function signature in your code. It&#39;s six of one or half dozen of the other but making the argument <code>const</code> isn&#39;t a mistake, it&#39;s just unnecessary for type <code>int</code>."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1536185303, "post_id": 52193770, "comment_id": 91337732, "body": "@NeilButterworth  The difference between an enum type and a plain int is that we can see the type of an int from it&#39;s typename, which is int.  If it&#39;s an enum we can&#39;t tell that from the type name."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1536185472, "post_id": 52193770, "comment_id": 91337785, "body": "int was an example - I don&#39;t see why it makes any difference whatever the type is - it will always be a value, unless the signature of the function is changed"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1536185555, "post_id": 52193770, "comment_id": 91337807, "body": "@DavidLjungMadison Yes you can see it&#39;s type, just not its underlying type. Which is what <code>std::underlying_type</code> is for."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1536185818, "post_id": 52193770, "comment_id": 91337881, "body": "Here is info on <code>is_enum</code>: <a href=\"https://en.cppreference.com/w/cpp/types/is_enum\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/is_enum</a>"}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1536261472, "post_id": 52193770, "comment_id": 91371011, "body": "@Eljay It&#39;s an interesting idea to check the type at compile time and break if it&#39;s not enum, so if the data type ever changed you could add the const.   <i>Or...</i> you could just add the const now and never have to worry about it.  Why not just do that?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1536268189, "post_id": 52193770, "comment_id": 91373746, "body": "I&#39;m not sure I understand what you are worrying about.  I think you misunderstand what adding <code>const</code> does here on the function parameter.  It makes it so the body of the function cannot change the pass-by-value parameter, which is a local parameter copy.  (Unless the code also &quot;cheats&quot; by using a const_cast or C style cast.)"}], "owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "closed_date": 1536184057, "answer_count": 0, "score": 0, "last_activity_date": 1536184305, "creation_date": 1536183892, "last_edit_date": 1536184305, "question_id": 52193770, "link": "https://stackoverflow.com/questions/52193770/c-using-const-for-a-function-parameter-that-is-currently-an-enum", "closed_reason": "Duplicate", "title": "C++: Using const for a function parameter that is currently an enum", "body": "<p>We define a function that uses a type defined elsewhere:</p>\n\n<pre><code>auto some_func(const some_type var) -&gt; bool  { ... }\n</code></pre>\n\n<p>Let's say that currently some_type is an enum.  But it's defined elsewhere in the codebase, and arguably could be changed.  I believe because the type of \"some_type\" isn't necessarily guaranteed to be an enum primitive type, the const makes sense.  My code reviewer believes that it's a mistake to use const because some_type <em>is</em> an enum.</p>\n\n<p>Does it make sense to leave the \"const\" in here because someday some_type may change, or does it make sense to leave it out because it is an enum and will likely always be an enum?</p>\n\n<p>For those marking this question as a duplicate, the question is <strong>NOT</strong> \"should I use const on enums\" - the question <strong>IS</strong> \"should we use const if we the definition of the type is in another part of the codebase and we can't guarantee that the type will stay an enum\"</p>\n"}, {"tags": ["c++", "string", "input"], "comments": [{"owner": {"reputation": 846, "user_id": 9572393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z7AXs.png?s=128&g=1", "display_name": "GKE", "link": "https://stackoverflow.com/users/9572393/gke"}, "edited": false, "score": 0, "creation_date": 1536182796, "post_id": 52193562, "comment_id": 91336960, "body": "What have you tried? Have you attempted to open the text file and read it using <code>&lt;fstream&gt;</code>?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 5, "creation_date": 1536182800, "post_id": 52193562, "comment_id": 91336962, "body": "<a href=\"https://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\"><code>std::getline</code></a> is probably going to make its way in to your code sooner or later."}, {"owner": {"reputation": 19, "user_id": 10182990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1902620999793993/picture?type=large", "display_name": "Alon Emanuel", "link": "https://stackoverflow.com/users/10182990/alon-emanuel"}, "edited": false, "score": 0, "creation_date": 1536182932, "post_id": 52193562, "comment_id": 91337010, "body": "Editing my question to make it clearer: I opened and read the file as an &quot;ifstream&quot;, and I retrieved the first line using &quot;std::getline&quot;."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1536183170, "post_id": 52193562, "comment_id": 91337088, "body": "Use it <i>again</i>. this time by wrapping the line you read into a <a href=\"https://en.cppreference.com/w/cpp/io/basic_istringstream\" rel=\"nofollow noreferrer\"><code>std::istringstream</code></a>, and sucking data in delimited by <code>:</code>. If the resulting <i>word</i> matches one of your predefined labels, you&#39;re on your way. There are other ways of doing this; this approach isn&#39;t some magic bullet. But it would probably suffice for you"}, {"owner": {"reputation": 19, "user_id": 10182990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1902620999793993/picture?type=large", "display_name": "Alon Emanuel", "link": "https://stackoverflow.com/users/10182990/alon-emanuel"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536183609, "post_id": 52193562, "comment_id": 91337229, "body": "@drescherjm, I&#39;ve edited my code in."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1536183780, "post_id": 52193562, "comment_id": 91337279, "body": "You need a while loop like this: <code>while (std::getline(inputFile, lineToParse)) {</code> And then do what @WhozCraig said with lineToParse in the loop."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1536192209, "post_id": 52193562, "comment_id": 91339177, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/7868936/608639\">Read file line by line in C++</a>, <a href=\"https://stackoverflow.com/q/27006958/608639\">Parsing key/value pairs from a string in C++</a> and <a href=\"https://stackoverflow.com/q/38812780/608639\">Split string into key-value pairs using C++</a>"}], "answers": [{"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 2, "last_activity_date": 1536185020, "last_edit_date": 1536185020, "creation_date": 1536184517, "answer_id": 52193876, "question_id": 52193562, "link": "https://stackoverflow.com/questions/52193562/reading-formatted-text-from-input-stream/52193876#52193876", "title": "Reading formatted text from input stream", "body": "<p>You can use <code>std::getline</code> to parse up to a specific character like <code>':'</code>.</p>\n\n<p>Something like:</p>\n\n<pre><code>int line_number = 0;\nwhile(std::getline(inputFile, lineToParse))\n{\n    ++line_number;\n\n    // check for empty lines here and skip them\n\n    // make a stream out of the line\n    std::istringstream iss(lineToParse);\n\n    std::string key, value;\n    if(!std::getline(std::getline(iss, key, ':') &gt;&gt; std::ws, value))\n    {\n        std::cerr &lt;&lt; \"bad format at line: \" &lt;&lt; line_number &lt;&lt; '\\n';\n        continue;\n    }\n\n    // do something with key and value here...\n}\n</code></pre>\n\n<p>One you have your <code>key</code> and <code>value</code> the <code>key</code> should tell you how to convert the value (be it integer, float, date/time etc...).</p>\n"}], "owner": {"reputation": 19, "user_id": 10182990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1902620999793993/picture?type=large", "display_name": "Alon Emanuel", "link": "https://stackoverflow.com/users/10182990/alon-emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1536199829, "answer_count": 1, "score": -1, "last_activity_date": 1536186620, "creation_date": 1536182577, "last_edit_date": 1536183551, "question_id": 52193562, "link": "https://stackoverflow.com/questions/52193562/reading-formatted-text-from-input-stream", "closed_reason": "Duplicate", "title": "Reading formatted text from input stream", "body": "<p>I have a .txt file and I'm expecting to get a certain line format from it that contains data that I need to keep.</p>\n\n<p>For instance:</p>\n\n<p>input.txt:</p>\n\n<pre><code>Number: 654\nName: Alon\n-----\n</code></pre>\n\n<p>I need to:</p>\n\n<p><strong>1. extract the 654 and \"Alon\" into their appropriate variables.</strong></p>\n\n<p><strong>2. throw an error if the format is not exact.</strong></p>\n\n<p>If this was C I would probably use:</p>\n\n<pre><code>if (fscanf(inputFile, \"Number: %d\", &amp;num) == 0)\n{\n    // raise an error\n}\n</code></pre>\n\n<p>Assuming using C's functions are not a good idea, I'm left with std::cin that might give me access to the data that I need to extract, but no control over the exact format of the string wrapping the data.</p>\n\n<p>I have already opened and read the file as an \"ifstream\" using . I've also retrieved the first line using std::getline(...). \nThis is what I've got:</p>\n\n<pre><code>std::ifstream inputFile;\nstring lineToParse;\ninputFile.open(\"input.txt\", std::fstream::in);\nif (inputFile.fail())\n{\n    // throw exception\n}\nelse\n{\n    std::getline(inputFile, lineToParse);\n    int data;\n    inputFile &gt;&gt; data;\n}\n</code></pre>\n\n<p>Assuming input.txt is the file above, I expect lineToParse to be \"Number: 654\" and data to be 654.\nBut as I said, I gain no control over the format of the line this way.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "filesystems"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 4, "creation_date": 1536181645, "post_id": 52193380, "comment_id": 91336545, "body": "Pretty OS-dependent."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1536181836, "post_id": 52193380, "comment_id": 91336625, "body": "I see that &quot;Pretty&quot; and raise you a &quot;Very.&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1536181954, "post_id": 52193380, "comment_id": 91336671, "body": "It  really sounds like something a shell script should check before the script runs the test(s)."}, {"owner": {"reputation": 1, "user_id": 9076746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794bd5a99c990c1e9e7a74564f6b8886?s=128&d=identicon&r=PG&f=1", "display_name": "Clavnormroth-saxendale", "link": "https://stackoverflow.com/users/9076746/clavnormroth-saxendale"}, "edited": false, "score": 0, "creation_date": 1536194606, "post_id": 52193380, "comment_id": 91339607, "body": "I&#39;ll take a shell-script answer then :-)"}, {"owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 0, "creation_date": 1536220678, "post_id": 52193380, "comment_id": 91347391, "body": "@NeilButterworth What if the shell script passes and immediately after (but before the unit test is running) the directory becomes not writeable? ok, worst case but... sh*t happens"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 0, "creation_date": 1536231742, "post_id": 52193380, "comment_id": 91354043, "body": "@roalz the same could happen with the C++ program"}, {"owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 0, "creation_date": 1536233538, "post_id": 52193380, "comment_id": 91355149, "body": "@NeilButterworth Right, with a (much) smaller time interval between check and operate if all done in C++, but still not atomic ;-)"}], "owner": {"reputation": 1, "user_id": 9076746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794bd5a99c990c1e9e7a74564f6b8886?s=128&d=identicon&r=PG&f=1", "display_name": "Clavnormroth-saxendale", "link": "https://stackoverflow.com/users/9076746/clavnormroth-saxendale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536181563, "creation_date": 1536181563, "question_id": 52193380, "link": "https://stackoverflow.com/questions/52193380/how-to-non-destructively-check-in-c-that-nothing-in-directory-can-be-written-d", "title": "How to non-destructively check in C++ that nothing in directory can be written/deleted", "body": "<p>I would like to make sure a directory that a unit test is about to access has permissions that would stop that test from changing anything. In particular, it should not be allowed to modify, create, or delete files/subdirectories. There is too much data to copy to a temporary location.</p>\n\n<p>I am aware of std::filesystem::permissions, but to use that I would still need to know who owns what file, who I am, and same again for groups. If the directory is empty, I would also need to know if I have write permission in the parent directory, and whether the sticky flag is set. Then I would probably have the answer. It still assumes I want to run under some flavour of Unix (true as it happens), and also that no-one is modifying anything in parallel (fine for now).</p>\n\n<p>I guess a fallback in the absence of a general cross-platform solution would be to just check that I don't own the directory and group/other permissions are off. It would not be bullet-proof, but it would probably be safe enough for my purposes. Is there a better way?</p>\n"}, {"tags": ["c++", "function", "qt", "connect", "qobject"], "comments": [{"owner": {"reputation": 13, "user_id": 10322278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e047f1df01aa670925a039c912cbd9?s=128&d=identicon&r=PG&f=1", "display_name": "ShivaDef", "link": "https://stackoverflow.com/users/10322278/shivadef"}, "edited": false, "score": 0, "creation_date": 1536182184, "post_id": 52193330, "comment_id": 91336755, "body": "ohh my god you are my hero! Thanks alot!"}], "answers": [{"tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1536182116, "creation_date": 1536182116, "answer_id": 52193476, "question_id": 52193330, "link": "https://stackoverflow.com/questions/52193330/qt-connect-no-matching-function-to-call-to/52193476#52193476", "title": "QT connect no matching function to call to", "body": "<p>You have to pass the instance pointer:</p>\n\n<pre><code>connect(&amp;Enviroment::instance(), &amp;Enviroment::enviromentChanged,\n        this, &amp;consoleRender::renderField);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10322278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e047f1df01aa670925a039c912cbd9?s=128&d=identicon&r=PG&f=1", "display_name": "ShivaDef", "link": "https://stackoverflow.com/users/10322278/shivadef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 52193476, "answer_count": 1, "score": 1, "last_activity_date": 1536182116, "creation_date": 1536181251, "question_id": 52193330, "link": "https://stackoverflow.com/questions/52193330/qt-connect-no-matching-function-to-call-to", "title": "QT connect no matching function to call to", "body": "<p>Hey guys I know there are already some threads for this question but I think I made none of the mistakes others did which led to the problem. So here is my code:</p>\n\n<pre><code>#include \"consolerender.h\"\n\nconsoleRender::consoleRender(QObject *parent) :\n    QObject(parent) {\n    connect(Enviroment::instance, &amp;Enviroment::enviromentChanged,\n            this, &amp;consoleRender::renderField);\n}\n</code></pre>\n\n<p>And the header:</p>\n\n<pre><code>class consoleRender : public QObject\n{\n    Q_OBJECT\n\npublic:\n    explicit consoleRender(QObject *parent = 0);\n\npublic slots:\n    void renderField();\n\n};\n</code></pre>\n\n<p>And the Enviroment.h</p>\n\n<pre><code>class Enviroment : public QObject\n{\n    Q_OBJECT\n\npublic:\n\n    static Enviroment&amp; instance();\n    virtual ~Enviroment();\n\n//stuff...\n\nsignals:\n    void enviromentChanged();\n</code></pre>\n\n<p>I already tried to do the connect in a separate class, I tried to use the old connect syntax (SIGNAL/SLOT(function)) and tried it with >>all&lt;&lt; my classes inheriting from QObject but it showed the same error. Also it says something that the function expects 3 arguments but gets 4. and seems to point at the connect(...renderField). I heard of a solution to just do all of that in the MainWindow class but that is not an option for me. </p>\n"}, {"tags": ["c++", "openssl"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1536180340, "post_id": 52193119, "comment_id": 91336048, "body": "<code>result_str = BN_bn2hex(point_compressed_dec);</code> &quot;throws away&quot; the object you <code>new</code>ed and makes the pointer point to a different object"}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 1, "creation_date": 1536180454, "post_id": 52193119, "comment_id": 91336093, "body": "From the <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/BN_bn2hex.html\" rel=\"nofollow noreferrer\">documentation</a> you need to free the returned string by calling <code>OPENSSL_free()</code> - &quot;The string must be freed later using OPENSSL_free().&quot;  This is why calling <code>delete result_str</code> isn&#39;t working. You don&#39;t need to allocate the string before calling the openssl function, it will allocate it and return it.  You have to later free it using their free function <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/OPENSSL_malloc.html\" rel=\"nofollow noreferrer\">OPENSSL_free()</a>"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1536181444, "post_id": 52193119, "comment_id": 91336459, "body": "It was good that people could help you, but there are guidelines about providing complete examples of your problem.   The guidelines aren\u2019t just pedantry.  Distilling of your problem into a small enough example that people can try often illustrates the problem.   Helping yourself is a much greater experience than having somebody help you."}, {"owner": {"reputation": 571, "user_id": 4096272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345c800d1d42a321a26ce5033e75f437?s=128&d=identicon&r=PG&f=1", "display_name": "Tony J", "link": "https://stackoverflow.com/users/4096272/tony-j"}, "edited": false, "score": 0, "creation_date": 1536188530, "post_id": 52193119, "comment_id": 91338512, "body": "Since you are new to C++, I feel I need to point out OepnSSL is written in C, and there are other problems mixing C and C++, so be careful."}], "answers": [{"comments": [{"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 0, "creation_date": 1536181048, "post_id": 52193275, "comment_id": 91336311, "body": "Very clear and detailed answer dealing with each part of the issue."}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "reply_to_user": {"reputation": 19, "user_id": 10294175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1652e09d8e52bd4a1be1931d7931bd2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u043b\u044c\u044f \u042f\u043a\u043e\u0432\u043b\u0435\u0432", "link": "https://stackoverflow.com/users/10294175/%d0%98%d0%bb%d1%8c%d1%8f-%d0%af%d0%ba%d0%be%d0%b2%d0%bb%d0%b5%d0%b2"}, "edited": false, "score": 2, "creation_date": 1536182474, "post_id": 52193275, "comment_id": 91336851, "body": "@\u0418\u043b\u044c\u044f\u042f\u043a\u043e\u0432\u043b\u0435\u0432 - Please learn from this, reading the documentation should ALWAYS come before asking someone else.  ALWAYS. I can&#39;t stress that enough. You will be amazed what you will learn just by reading the documentation and paying attention to examples, requirements, etc. I am not trying to sound mean in what I am saying. I am just trying to stress the importance of documentation. It is there to help you."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 2, "last_activity_date": 1536181436, "last_edit_date": 1536181436, "creation_date": 1536180917, "answer_id": 52193275, "question_id": 52193119, "link": "https://stackoverflow.com/questions/52193119/memory-leak-how-to-use-delete-properly-bn-bn2hex-crtisvalidheappointerblock/52193275#52193275", "title": "Memory leak. How to use delete properly? BN_bn2hex _CrtIsValidHeapPointer(block)", "body": "<h1>Problem: Leak</h1>\n\n<pre><code>char *result_str = new char;\n</code></pre>\n\n<p>Allocates a single character points <code>result_str</code>  at it.</p>\n\n<pre><code>result_str = BN_bn2hex(point_compressed_dec);\n</code></pre>\n\n<p>reassigns <code>result_str</code> to point at something returned by <code>BN_bn2hex</code> that may or may not be <code>delete</code>-able. The single character assigned on the line above is leaked because nothing points at it anymore.</p>\n\n<h1>Solution: Leak</h1>\n\n<p>Do not allocate that character. You don't need it. Instead assign the result of <code>BN_bn2hex</code> directly to <code>result_str</code>.</p>\n\n<pre><code>char *result_str = BN_bn2hex(point_compressed_dec);\n</code></pre>\n\n<h1>Problem: delete</h1>\n\n<p>After </p>\n\n<pre><code>result_str = BN_bn2hex(point_compressed_dec);\n</code></pre>\n\n<p><code>result_str</code> points at a string returned by <code>BN_bn2hex</code>. Since you don't know how the memory was allocated (you can only safely <code>delete</code> that which was <code>new</code>ed) you cannot safely release it yourself. <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/BN_bn2hex.html\" rel=\"nofollow noreferrer\">The documentation for <code>BN_bn2hex</code></a> instructs you to free this memory with <code>OPENSSL_free</code>.</p>\n\n<h1>Solution: delete</h1>\n\n<p>Do not <code>delete</code>. Instead follow the instructions in the documentation and use <code>OPENSSL_free</code>.</p>\n\n<h1>Sidenote</h1>\n\n<p>Check that <code>result_str</code> is not <code>NULL</code> before attempting to use it. If the result is <code>NULL</code>, use <code>ERR_get_error</code> to find out why.</p>\n"}], "owner": {"reputation": 19, "user_id": 10294175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1652e09d8e52bd4a1be1931d7931bd2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u043b\u044c\u044f \u042f\u043a\u043e\u0432\u043b\u0435\u0432", "link": "https://stackoverflow.com/users/10294175/%d0%98%d0%bb%d1%8c%d1%8f-%d0%af%d0%ba%d0%be%d0%b2%d0%bb%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 52193275, "answer_count": 1, "score": -1, "last_activity_date": 1536181436, "creation_date": 1536180138, "question_id": 52193119, "link": "https://stackoverflow.com/questions/52193119/memory-leak-how-to-use-delete-properly-bn-bn2hex-crtisvalidheappointerblock", "title": "Memory leak. How to use delete properly? BN_bn2hex _CrtIsValidHeapPointer(block)", "body": "<p>I am new to C++.  I can't declare result_str as *result_str. What am I doing wrong? How to avoid memory leak? BN_bn2hex function is: char *BN_bn2hex(const BIGNUM *a);</p>\n\n<pre><code>    point_compressed_dec = EC_POINT_point2bn(group, pub_key, POINT_CONVERSION_COMPRESSED, NULL, ctx); //public DEC format\n\n    char *result_str = new char;\n    result_str = BN_bn2hex(point_compressed_dec); \n\n    out &lt;&lt; result_str &lt;&lt; endl;\n\n    char *result_str2 = new char; // Works fine\n    *result_str2 = 5;             //\n\n    delete result_str;  // Doesn't work\n    delete result_str2; // Works fine\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors", "linker"], "owner": {"reputation": 484, "user_id": 4521764, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-f_Z1nxWKV5I/AAAAAAAAAAI/AAAAAAAAB64/0BoYk1vCNeg/photo.jpg?sz=128", "display_name": "Abhay", "link": "https://stackoverflow.com/users/4521764/abhay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536179853, "creation_date": 1536179853, "question_id": 52193068, "link": "https://stackoverflow.com/questions/52193068/crypto-liberr-c-obj-warning-lnk4204-vc140-pdb-is-missing-debugging-inform", "title": "crypto.lib(err.c.obj) : warning LNK4204: &#39;vc140.pdb&#39; is missing debugging information for referencing module; linking object as if no debug info", "body": "<p>I am trying to integrate grpc with existing project. \nI get this warning. \ncrypto.lib(err.c.obj) : warning LNK4204: 'vc140.pdb' is missing debugging information for referencing module; linking object as if no debug info</p>\n\n<p>First can someone explain what this means.</p>\n\n<p>I used sample vcxproj provided by grpc and it works fine. but when I include it in existing project it gives me above warning. </p>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536179125, "post_id": 52192869, "comment_id": 91335557, "body": "<b><i>Under VC++ Directories, in the &quot;Include Directories&quot; field, I added the location of the file I am attempting to include. The other location is under C/C++ / General in the Additional Include Directories,</i></b> That is what you are supposed to do. Prefer the per project includes if you don&#39;t plan on including this library in most of your projects in the future."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536179256, "post_id": 52192869, "comment_id": 91335604, "body": "Remember that the project settings are per configuration unless you selected multiple configurations."}, {"owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536179372, "post_id": 52192869, "comment_id": 91335649, "body": "I&#39;m not sure how your comment is supposed to help.  This is a fresh project, I&#39;ve included the files I want to use, that didn&#39;t work, so I tried including the directory where it lives, and it still doesn&#39;t work.  From your comment, I&#39;m not seeing how this is supposed to fix the issue.  I figure it has to be something I&#39;m doing wrong, either that or I start pointing fingers at VS2017 and playing the blame game."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536179396, "post_id": 52192869, "comment_id": 91335655, "body": "My advice is open the file explorer and paste the exact folder you added to your include directories to make sure it is correct."}, {"owner": {"reputation": 1588, "user_id": 1158478, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ddb1be4e64fb48abf2a9a2de981ea99c?s=128&d=identicon&r=PG", "display_name": "ArtHare", "link": "https://stackoverflow.com/users/1158478/arthare"}, "edited": false, "score": 0, "creation_date": 1536179470, "post_id": 52192869, "comment_id": 91335683, "body": "Another trick is to install procmon from Microsoft and watch the filepaths that VS is trying to hit while searching for your .h file.  Set up the filter so that it only includes paths that include your thefile.h filename.  That&#39;s usually enough for me to discover how I&#39;ve messed up my build settings."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536179472, "post_id": 52192869, "comment_id": 91335688, "body": "<b><i>I tried including the directory where it lives, and it still doesn&#39;t work</i></b> I expect you entered the wrong folder. That is why I want you to test it in explorer. Perhaps you have spaces in your path and you did not quote the path."}, {"owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536179739, "post_id": 52192869, "comment_id": 91335791, "body": "@drescherjm I just removed all my paths, removed the file I am trying to include, opened a explorer window, found my file, opened it to make sure it was what I want, dragged and dropped it in &quot;Header Files&quot; section of my project.  Same exact issue.  I readded the paths, same exact issue."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1536179916, "post_id": 52192869, "comment_id": 91335857, "body": "@Zulukas Including a file in the &quot;header files&quot; section of Solution Explorer doesn&#39;t mean that the <code>#include </code> statement will succeed"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536180003, "post_id": 52192869, "comment_id": 91335909, "body": "<b><i>dragged and dropped it in &quot;Header Files&quot;</i></b> You don&#39;t want to do that. You need to add the folder containing the file in your projects <code>c++</code> settings in the &quot;Additional Include Directories&quot; setting."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1536181114, "post_id": 52192869, "comment_id": 91336336, "body": "It may take a bit of work to interpret the results, but try right clicking on the file that&#39;s causing trouble in Solution Explorer, and selecting Properties.  Open up the C/C++ section, and the very last entry is &quot;Command Line&quot;.  Select your Configuration and Platform, and it&#39;ll show the exact command line handed to CL.EXE.  In particular, you care about the <code>&#47;I</code> options."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1536181638, "post_id": 52192869, "comment_id": 91336541, "body": "You&#39;re probably change the settings for one build configuration and build another one. If you&#39;re compiling Debug 64, opening project properties does not take you automatically to Debug 64 Properties - you must check that in the upper part of properties page."}, {"owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536183052, "post_id": 52192869, "comment_id": 91337045, "body": "@drescherjm Could you write up an answer for what you&#39;re suggesting I do, or if you know of a post that outlines what you&#39;re trying to explain could you link it?  I&#39;m having a difficult time following what you&#39;re trying to instruct me to do."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536183276, "post_id": 52192869, "comment_id": 91337124, "body": "I did not write an answer because I have yet to figure out how you have done this wrongly. We need some more info. Perhaps a minimal example and pictures of your settings."}, {"owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "edited": false, "score": 0, "creation_date": 1536184581, "post_id": 52192869, "comment_id": 91337531, "body": "What settings do you need to see?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536184820, "post_id": 52192869, "comment_id": 91337601, "body": "A small program that has your #include statements. Your error messages. The folder that contains your headers. And exactly what was typed in the &quot;Additional Include Directories&quot; setting."}, {"owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "edited": false, "score": 1, "creation_date": 1536185919, "post_id": 52192869, "comment_id": 91337911, "body": "Okay, I added some photos.  If you need to see anything else let me know."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536187651, "post_id": 52192869, "comment_id": 91338346, "body": "I would remove <code>test.h</code> from your project. The &quot;Additional Include Directories&quot; should be enough. Make sure you enabled this setting for every configuration (Release, Debug ...) the settings are independent."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536188026, "post_id": 52192869, "comment_id": 91338414, "body": "I think someone else may have to help with a suggestion. I have done this 1000s of times but not sure how this is failing for you."}], "answers": [{"tags": [], "owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "is_accepted": false, "score": 1, "last_activity_date": 1536249073, "last_edit_date": 1536249073, "creation_date": 1536248747, "answer_id": 52207863, "question_id": 52192869, "link": "https://stackoverflow.com/questions/52192869/visual-studio-c-unable-to-find-a-header-file-from-another-directory/52207863#52207863", "title": "Visual Studio C++ Unable to find a header file from another directory", "body": "<p>It would appear this issue is something on my work PC.  I ran the same test on my personal PC at home and following drescherjm's final suggestions about removing the .h file from the project allowed me to build the project.</p>\n\n<p>One final update that <strong>got it working</strong></p>\n\n<p>Enter project properties, make sure that the configuration and platform are what you need.  I set mine to \"All Configurations\" and \"All Platforms\". Adding the path to my include directory allowed the path to be discovered and the header included.</p>\n"}], "owner": {"reputation": 911, "user_id": 4168440, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fc2847008c105df28fec343c68e5cede?s=128&d=identicon&r=PG&f=1", "display_name": "Zulukas", "link": "https://stackoverflow.com/users/4168440/zulukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2064, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1602789495, "creation_date": 1536178873, "last_edit_date": 1536185790, "question_id": 52192869, "link": "https://stackoverflow.com/questions/52192869/visual-studio-c-unable-to-find-a-header-file-from-another-directory", "title": "Visual Studio C++ Unable to find a header file from another directory", "body": "<p>I know this question has been asked else where, but none of the posts I have tried seem to offer any fixes for my problem.</p>\n\n<p>I have a fresh project in Visual Studio 2017 to build a DLL file that will be using some C++ code from another project (that project is done in Eclipse, however for what I'm doing, it's more convenient to have this project in Visual Studio).</p>\n\n<p>So, I've created the fresh project, and then I tried adding the files I need directly.  When I include them with \"Add Existing\", the file gets added into the project, inspecting the new file shows that the file lives out at the location I added it from, as expected.  Attempting #include this file into my main, just to simply test it out, the #include is underlined indicating an error which says, \"cannot open source file \"thefile.h\"\".</p>\n\n<p>\"thefile.h\" (not the actual name) has no other dependencies, and simply contains an enum.  I've seen two separate places suggested to use to add includes, both are contained into the project properties (alt-enter the project name).  Under VC++ Directories, in the \"Include Directories\" field, I added the location of the file I am attempting to include.  The other location is under C/C++ / General in the Additional Include Directories, where I added the location once again.  In the directory where this file comes from, there is an \"inc\" and a \"src\" folder, it is unclear whether I am supposed to use the parent directory of \"inc\" or use \"inc\" itself, but I have tried both with no success.</p>\n\n<p>Maybe I just don't know how to ask Google the right questions for exactly my problem, but I am going nuts with this.  I've tried reloading the project, I've tried closing Visual Studio and reopening the solution, both without success.  I figure I must be missing something, but I just can't figure it out and figured I'd ask online to see if anyone has an wisdom to what I could be doing wrong.</p>\n\n<p>EDIT: </p>\n\n<p>Here are some photos of my process:</p>\n\n<p>1) The photo below shows my basic main function, compiles without the <code>#include \"test.h\"</code> or the <code>int result = Test();</code> lines.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LhzNQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LhzNQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>2) The relative path to <code>test.h</code> shown.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YNlzS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YNlzS.png\" alt=\"enter image description here\"></a></p>\n\n<p>3) The relative path to <code>test.cpp</code> shown.\n<a href=\"https://i.stack.imgur.com/69puj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/69puj.png\" alt=\"enter image description here\"></a></p>\n\n<p>4) My VC++ Directories > Include Directories shown.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7zapl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7zapl.png\" alt=\"enter image description here\"></a></p>\n\n<p>5) My C/C++ > General > Additional Include Directories shown.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zHRRa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zHRRa.png\" alt=\"enter image description here\"></a></p>\n\n<p>These are all the steps I took to create my example project.  Am I missing a step here?  Are my directories wrong?  My folder containing the .h and .cpp file I'm trying to use are located at C:\\ExampleExternalSource.  My project is located out of the default Visual Studio 2017 Projects folder, C:\\Users\\MyUser\\Documents\\Visual Studio 2017\\Projects\\Example.</p>\n"}, {"tags": ["c++", "visual-studio", "terminal", "mpi"], "comments": [{"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1536182183, "post_id": 52192653, "comment_id": 91336754, "body": "VS only runs <code>mpiexec</code>, it does not control how <code>mpiexec</code> runs the processes. You want <code>mpiexec</code> to do a strange thing. Probably, you should use some other way of IPC, and MPI is not what you need."}], "answers": [{"tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 1, "last_activity_date": 1536450634, "creation_date": 1536450634, "answer_id": 52240258, "question_id": 52192653, "link": "https://stackoverflow.com/questions/52192653/run-mpi-application-from-visual-studio-2017-with-each-process-in-a-different-cmd/52240258#52240258", "title": "Run MPI Application from Visual Studio 2017 with each process in a different cmd window", "body": "<p>I think this is not possible.</p>\n\n<p>I have tried to use <code>AllocConsole()</code> on an mpi test program  and each process returns an error because it considers that there is already a console attached to it.</p>\n\n<p>In a way it seems logic because mpiexec will launch the processes and every stdout will directed to the same output (file or console), as for stdin you have to choose which process will handle it (judging by the manual <a href=\"https://www.open-mpi.org/doc/v3.0/man1/mpiexec.1.php\" rel=\"nofollow noreferrer\">https://www.open-mpi.org/doc/v3.0/man1/mpiexec.1.php</a> -stdin option). </p>\n\n<p>These redirections being surely managed by the process manager (<a href=\"https://wiki.mpich.org/mpich/index.php/Frequently_Asked_Questions\" rel=\"nofollow noreferrer\">https://wiki.mpich.org/mpich/index.php/Frequently_Asked_Questions</a>) </p>\n\n<p>As @Evg said judging by \"the Spades game\" allusion I think MPI is not what you need. Maybe more unix domain socket. But they are other ways to do inter-process com (<a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Inter-process_communication</a>) </p>\n"}], "owner": {"reputation": 9, "user_id": 10322039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j2ods_M9AZE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOB47uO3ExXscJtr8rqAQxc0c2N5A/mo/photo.jpg?sz=128", "display_name": "Andy", "link": "https://stackoverflow.com/users/10322039/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1536450634, "creation_date": 1536177824, "question_id": 52192653, "link": "https://stackoverflow.com/questions/52192653/run-mpi-application-from-visual-studio-2017-with-each-process-in-a-different-cmd", "title": "Run MPI Application from Visual Studio 2017 with each process in a different cmd window", "body": "<p>Using Visual Studio 2017 I am trying to run a MPI Application which resembles a Spades game. Upon running it I want to open a cmd terminal for each of the 4 players so that each of them can input his card choice upon his turn to act. </p>\n\n<p>I tried a ton of options, including going to Project Properties -> Debugging and changing the <strong>Command</strong> to <code>$(MSMPI_BIN)\\mpiexec</code> and <strong>Command Arguments</strong> to <code>-np 4 \"$(TargetPath)\"</code> - see link below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/H6EcC.png\" rel=\"nofollow noreferrer\">Command and Command Arguments</a></p>\n\n<p>but, apart from getting 4 processes to run at the same time I still get a single terminal open which doesn't react to any of my keyboard input.</p>\n\n<p>Is there any way to open 4 terminals using the Visual Studio debug? Or any other way? running \"mpiexec.exe -np 4 MyExec.exe\" in a cmd / bash provides the same result as above.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "data-structures", "queue"], "comments": [{"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 2, "creation_date": 1536177233, "post_id": 52192421, "comment_id": 91334769, "body": "what appears to be the problem?"}, {"owner": {"reputation": 105, "user_id": 8390260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef3c0fcad1c87d895d3e454222842b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Jigar Patel", "link": "https://stackoverflow.com/users/8390260/jigar-patel"}, "reply_to_user": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1536177354, "post_id": 52192421, "comment_id": 91334818, "body": "I&#39;m trying to figure out if there is a problem. I think it might be inside the while loop"}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 1, "creation_date": 1536177399, "post_id": 52192421, "comment_id": 91334840, "body": "I meant, what is the question? is something not working right? did you try compiling and running it?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1536177610, "post_id": 52192421, "comment_id": 91334919, "body": "More to the point, you never asked a <i>question</i>. Regardless, I have absolutely no doubt that <code>sizeof adjMatrix &#47; sizeof adjMatrix[0]</code> is wrong. <code>adjMatrix</code> is a pointer-to-pointer (to <code>bool</code>, but that isn&#39;t really relevant right now), so <code>sizeof adjMatrix &#47; sizeof adjMatrix[0]</code> will be <code>1</code> <i>always</i>. Pretty sure <code>numVerticies</code> will be entering this picture instead, assuming your pointer array is indeed tha wide across all rows."}, {"owner": {"reputation": 105, "user_id": 8390260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef3c0fcad1c87d895d3e454222842b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Jigar Patel", "link": "https://stackoverflow.com/users/8390260/jigar-patel"}, "edited": false, "score": 0, "creation_date": 1536177791, "post_id": 52192421, "comment_id": 91335007, "body": "Sorry for not being clear. Its telling me that temp is unused variable and I&#39;m trying to use it like this example: <a href=\"https://imgur.com/a/lgxK89C\" rel=\"nofollow noreferrer\">imgur.com/a/lgxK89C</a>. But I dont know how"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1536177847, "post_id": 52192421, "comment_id": 91335027, "body": "If you&#39;re not sure what&#39;s going on, a good first step to fixing it is to step through the code in a debugger."}, {"owner": {"reputation": 105, "user_id": 8390260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef3c0fcad1c87d895d3e454222842b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Jigar Patel", "link": "https://stackoverflow.com/users/8390260/jigar-patel"}, "edited": false, "score": 0, "creation_date": 1536177849, "post_id": 52192421, "comment_id": 91335029, "body": "also I am not sure how I would use some test cases to see if its working properly. Can anyone help with that?"}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1536178022, "post_id": 52192421, "comment_id": 91335117, "body": "that image is just your code. Also, what you described is probably a warning at best unless you used a flag like <code>-Werror</code> to compile. (if you are using gcc). I meant what happens when you actually run the program? do you have any basic test cases?"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1536180289, "post_id": 52192421, "comment_id": 91336018, "body": "&quot;Its telling me that temp is unused variable&quot; - in your post (not in comments) please include verbatim every warning and error from your compile or link or build."}], "answers": [{"tags": [], "owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "is_accepted": true, "score": 2, "last_activity_date": 1536185727, "last_edit_date": 1536185727, "creation_date": 1536185216, "answer_id": 52193973, "question_id": 52192421, "link": "https://stackoverflow.com/questions/52192421/bfs-breadth-first-search-adjacency-matrix-c/52193973#52193973", "title": "BFS (breadth first search) adjacency matrix C++", "body": "<p>Okay, since you didn't attach your error log or test case output consider the below implementation</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;queue&gt;\n#include &lt;vector&gt;\n#include &lt;set&gt;\n#include &lt;cstdlib&gt;\n\n// using namespace std;   Don't do this. Good CPP production code uses separate namespaces \n\nconst int BUFFER_CLEAR_VALUE = 999;\n\nclass Graph {\nprivate:\n    std::vector&lt;std::vector&lt;bool&gt; &gt; adj_mat;\n\npublic:\n    //constructor\n    Graph() {\n        std::cout &lt;&lt; \"Enter vertex num\" &lt;&lt; std::endl;\n        int num_vertices;\n        std::cin &gt;&gt; num_vertices;\n        while (std::cin.fail()) {\n            std::cout &lt;&lt; \"Enter a valid num\" &lt;&lt; std::endl;\n            std::cin.clear();\n            std::cin.ignore(BUFFER_CLEAR_VALUE, '\\n');\n            std::cin &gt;&gt; num_vertices;\n        }\n        for (int i = 0; i &lt; num_vertices; i++) {\n            std::vector&lt;bool&gt; temp;\n            temp.resize(num_vertices);\n            adj_mat.push_back(temp);\n        }\n    }\n\n    // member fn\n    void initialize() {\n        for (int i = 0; i &lt; adj_mat.size(); i++) {\n            for (int j = 0; j &lt; adj_mat[0].size(); j++) {\n                char choice;\n                do {\n                    std::cout &lt;&lt; \"Enter adj mat value for [y/n] \" &lt;&lt; i &lt;&lt; \":\" &lt;&lt; j &lt;&lt; std::endl;\n                    std::cin &gt;&gt; choice;\n                    if (choice == 'y') {\n                        adj_mat[i][j] = true;\n                    } else {\n                        adj_mat[i][j] = false;\n                    }\n\n                    if (std::cin.fail() || (choice!='y' &amp;&amp; choice!='n' )) {\n                        std::cout &lt;&lt; \"enter a valid value please!!\" &lt;&lt; std::endl;\n                        std::cin.clear();\n                        std::cin.ignore(BUFFER_CLEAR_VALUE,'\\n');\n                    }\n                } while( std::cin.fail() || (choice!='y' &amp;&amp; choice!='n' ));\n            }\n        }\n    }\n\n    // member fn\n    void showMatrix() {\n        std::cout &lt;&lt; std::endl &lt;&lt; \"Adjacency Matrix\" &lt;&lt; std::endl;\n        for (int i = 0; i &lt; adj_mat.size(); i ++) {\n            for (int j = 0; j &lt; adj_mat[i].size(); j++) {\n                std::cout &lt;&lt; adj_mat[i][j] &lt;&lt; \"\\t\";\n            }\n            std::cout &lt;&lt; std::endl;\n        }\n    }\n\n    // member fn\n    void breadthFirstSearch(int start_point, int end_point) {\n        std::queue&lt;int&gt; vertex_queue;\n        std::set&lt;int&gt; visited_vertices;\n        vertex_queue.push(start_point);\n\n        while(!vertex_queue.empty()) {\n            // Get next vertex\n            int current_vertex = vertex_queue.front();\n            vertex_queue.pop();\n\n            // Make note of current visit\n            visited_vertices.insert(current_vertex);\n            std::cout &lt;&lt; \"Looking at \" &lt;&lt; current_vertex &lt;&lt; std::endl;\n\n            for (int j = 0; j &lt; adj_mat[current_vertex].size(); j++) {\n                if (adj_mat[current_vertex][j]) {\n                    if (j == end_point) {\n                        std::cout &lt;&lt; \"Found it \" &lt;&lt; j &lt;&lt; std::endl;\n                        return;\n                    } else if (!(visited_vertices.find(j) != visited_vertices.end())) {\n                        vertex_queue.push(j);\n                    }\n                }\n            }\n        }\n        std::cout &lt;&lt; \"Could not find it!\" &lt;&lt; std::endl;\n    }\n};\n\n\nint main() {\n    Graph g;\n    g.initialize();\n    g.showMatrix();\n    g.breadthFirstSearch(0, 1);\n    g.breadthFirstSearch(0, 4);\n    return 0;\n}\n</code></pre>\n\n<p>Some points</p>\n\n<ul>\n<li>This is C++, why not use <code>vector</code> etc that handle stuff like memory for you instead? (if this is not what you want you haven't indicated so)</li>\n<li>They key idead behind a BFS is\n\n<ul>\n<li>Look at all the neighbors of the current node, start processing the neighbors of the neighbors</li>\n<li>only process a node if you haven't before</li>\n</ul></li>\n<li>The way you are doing it nothing is next to anything. The matrix only has <code>false</code>. Did you meant to change this at some point?</li>\n<li>Your size calculations are wrong, they operate only on the pointers!</li>\n<li>You don;t have a valid termination criterion. What are you searching for with BFS? You also need to know when to stop the search. and report what happened</li>\n<li>What I've changed\n\n<ul>\n<li>Used cpp's std containers instead</li>\n<li>Removed usage of <code>using namespace std;</code></li>\n<li>provided a very basic test case in <code>main</code></li>\n<li>added methods to initialize and print the matrix</li>\n</ul></li>\n</ul>\n\n<p>Running the code I shared above for a graph like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/jPTgR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jPTgR.png\" alt=\"Simple Graph\"></a></p>\n\n<pre><code>$ ./Adjacency                       \nEnter vertex num                             \n5                                            \nEnter adj mat value for [y/n] 0:0            \ny                                            \nEnter adj mat value for [y/n] 0:1            \ny                                            \nEnter adj mat value for [y/n] 0:2            \nn                                            \nEnter adj mat value for [y/n] 0:3            \nn                                            \nEnter adj mat value for [y/n] 0:4            \nn                                            \nEnter adj mat value for [y/n] 1:0            \ny                                            \nEnter adj mat value for [y/n] 1:1            \ny                                            \nEnter adj mat value for [y/n] 1:2            \ny                                            \nEnter adj mat value for [y/n] 1:3            \ny                                            \nEnter adj mat value for [y/n] 1:4            \nn                                            \nEnter adj mat value for [y/n] 2:0            \nn                                            \nEnter adj mat value for [y/n] 2:1            \ny                                            \nEnter adj mat value for [y/n] 2:2\ny\nEnter adj mat value for [y/n] 2:3\nn\nEnter adj mat value for [y/n] 2:4\nn\nEnter adj mat value for [y/n] 3:0\nn\nEnter adj mat value for [y/n] 3:1\ny\nEnter adj mat value for [y/n] 3:2\nn\nEnter adj mat value for [y/n] 3:3\ny\nEnter adj mat value for [y/n] 3:4\nn\nEnter adj mat value for [y/n] 4:0\nn\nEnter adj mat value for [y/n] 4:1\nn\nEnter adj mat value for [y/n] 4:2\nn\nEnter adj mat value for [y/n] 4:3\nn\nEnter adj mat value for [y/n] 4:4\ny\n\nAdjacency Matrix\n1       1       0       0       0\n1       1       1       1       0\n0       1       1       0       0\n0       1       0       1       0\n0       0       0       0       1\nLooking at 0\nFound it 1\nLooking at 0\nLooking at 1\nLooking at 2\nLooking at 3\nCould not find it!\n</code></pre>\n\n<p>Suggested possible improvements</p>\n\n<ol>\n<li>Abstract the functionality better, right now <code>Graph</code> is a god class</li>\n<li>Don't gather input for inputs in the adjacency matrix where column = row</li>\n<li>Extrapolate values of the matrix based on previous values, eg: if 1 is next to 2 then you know that 2 is next to 1</li>\n<li>handle input getting better, I have forgotten the clean way to <code>cin</code> stuff</li>\n</ol>\n\n<h3>If you insist on pointers to arrays all you ned to do is change the constructor and <code>.size()</code> invocations.</h3>\n"}], "owner": {"reputation": 105, "user_id": 8390260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef3c0fcad1c87d895d3e454222842b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Jigar Patel", "link": "https://stackoverflow.com/users/8390260/jigar-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2169, "favorite_count": 2, "accepted_answer_id": 52193973, "answer_count": 1, "score": 0, "last_activity_date": 1536185727, "creation_date": 1536176744, "last_edit_date": 1536181973, "question_id": 52192421, "link": "https://stackoverflow.com/questions/52192421/bfs-breadth-first-search-adjacency-matrix-c", "title": "BFS (breadth first search) adjacency matrix C++", "body": "<p>I'm trying to learn BFS (breadth first search) with adjacency matrix. </p>\n\n<p>What I tried:</p>\n\n<ul>\n<li>didn't really know what BFS was at all so I learned the concept &amp; pseudocode </li>\n<li>tried looking at examples</li>\n<li>tried implementing with pointer to an array version below</li>\n</ul>\n\n<p>Objective: </p>\n\n<ul>\n<li>want to make sure I'm doing BFS correctly using pointer to an array matrix</li>\n</ul>\n\n<p>Graph Class for adjacency matrix:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;queue&gt;\nusing namespace std;\n\nclass Graph {\nprivate:\n    bool** adjMatrix;\n    int numVertices;\n    bool* visited;\npublic:\n    //constructor\n    Graph(int numVertices) {\n        this-&gt;numVertices = numVertices;\n        adjMatrix = new bool*[numVertices];\n        for(int i = 0; i &lt; numVertices; i++) {\n            adjMatrix[i] = new bool[numVertices];\n            for(int j = 0; j &lt; numVertices; j++)\n                adjMatrix[i][j] = false;\n        }\n\n        visited[numVertices]; //init visited array\n\n\n    }\n\n    //member function\n    void BFS(int sp) {\n        //make a queue of type int\n        queue&lt;int&gt; Q;\n\n        //make bool visited array &amp; mark all positions unvisited\n        for(int i = 0; i &lt; numVertices; i++)\n            visited[i] = false;\n\n        //push sp into queue\n        Q.push(sp);\n\n        //mark sp as visited\n        visited[sp] = true;\n\n        //while queue isn't empty\n        while(!Q.empty()) {\n\n            //make temp node\n            int temp = Q.front();\n\n            //pop temp node\n            Q.pop();\n\n            //use loop &amp; check if it has children\n            int rows =  sizeof adjMatrix / sizeof adjMatrix[0]; //get row size\n            for(int i = 0; i &lt; rows; i++) { //check neighboring nodes\n                if(!visited[i] &amp;&amp; adjMatrix[sp][i] == true) {\n                    Q.push(i); //if so push them into queue\n                    visited[i] = true; //mark children as visited\n                }\n            }\n        }\n\n    }\n\n\n\n};\n</code></pre>\n"}, {"tags": ["c++", "lambda", "language-lawyer", "c++17", "auto"], "comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 2, "creation_date": 1536176926, "post_id": 52192389, "comment_id": 91334633, "body": "clang looks more decent at this moment, I wonder if such a construct can even typecheck, more likely it ends up in an infinite tree."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1536177622, "post_id": 52192389, "comment_id": 91334924, "body": "When I <a href=\"http://rextester.com/BFZX43120\" rel=\"nofollow noreferrer\">run this example</a> with msvc sometimes it passes, but usually it ends with seg fault."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 2, "creation_date": 1536180061, "post_id": 52192389, "comment_id": 91335933, "body": "Your asking if it is legal which says this is a language-lawyer question but several of the answers don&#39;t really take that approach ... it is important to get the tags right"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 2, "creation_date": 1536181975, "post_id": 52192389, "comment_id": 91336679, "body": "@ShafikYaghmour Thanks, aded a tag"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1536215343, "post_id": 52192389, "comment_id": 91344724, "body": "@ArneVogel yes the updated one uses <code>auto&amp; self</code> which eliminates the dangling reference problem."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 146, "user_id": 5577239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c763a6f299c59fcfd538f0e036f0911c?s=128&d=identicon&r=PG&f=1", "display_name": "user64742", "link": "https://stackoverflow.com/users/5577239/user64742"}, "edited": false, "score": 1, "creation_date": 1536300320, "post_id": 52192389, "comment_id": 91381166, "body": "@TheGreatDuck the C++ lambdas are not really theoretical lambda expressions. C++ has built-in recursive <i>types</i> which the original simple typed lambda calculus cannot express, so it can have things isomorphic to a: a-&gt;a and other impossible constructs."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1536316831, "post_id": 52192389, "comment_id": 91390007, "body": "Vaguely related: <a href=\"https://stackoverflow.com/q/8595061/560648\">stackoverflow.com/q/8595061/560648</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1536177195, "post_id": 52192483, "comment_id": 91334754, "body": "I&#39;m not familiar with generic lambdas, but couldn&#39;t you make <code>self</code> a reference?"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1536177288, "post_id": 52192483, "comment_id": 91334795, "body": "@Fran&#231;oisAndrieux Yes, if you make <code>self</code> a reference, this problem <a href=\"https://wandbox.org/permlink/WMD6tORuvbARpbWc\" rel=\"nofollow noreferrer\">goes away</a>, but Clang still <a href=\"https://wandbox.org/permlink/nSvJsZrLwzkoRyUw\" rel=\"nofollow noreferrer\">rejects it for another reason</a>"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1536177433, "post_id": 52192483, "comment_id": 91334857, "body": "@Fran&#231;oisAndrieux Indeed and I&#39;ve added that to the answer, thank you!"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1536179120, "post_id": 52192483, "comment_id": 91335553, "body": "The problem with this approach is that it does not eliminate possible compiler bugs. So maybe it should work but the implementation is broken."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536182612, "post_id": 52192483, "comment_id": 91336895, "body": "Thank you, I&#39;ve looked at this for hours and didn&#39;t see that <code>self</code> is captured by reference!"}], "tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": false, "score": 34, "last_activity_date": 1536198747, "last_edit_date": 1536198747, "creation_date": 1536177008, "answer_id": 52192483, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal/52192483#52192483", "title": "Lambda returning itself: is this legal?", "body": "<p><strong><em>Edit</em></strong>: <em>There seems to be some controversy over whether this construction is strictly valid per the C++ specification. Prevailing opinion seems to be that it is not valid. See the other answers for a more thorough discussion. The remainder of this answer applies <strong>if</strong> the construction is valid; the tweaked code below works with MSVC++ and gcc, and the OP has posted further modified code that works with clang also.</em></p>\n\n<p>This is undefined behavior, because the inner lambda captures the parameter <code>self</code> by reference, but <code>self</code> goes out of scope after the <code>return</code> on line 7. Thus, when the returned lambda is executed later, it's accessing a reference to a variable that has gone out of scope.</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main(int argc, char* argv[]) {\n\n  int a = 5;\n\n  auto it = [&amp;](auto self) {\n      return [&amp;](auto b) {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(self); // &lt;-- using reference to 'self'\n      };\n  };\n  it(it)(4)(6)(42)(77)(999); // &lt;-- 'self' is now out of scope\n}\n</code></pre>\n\n<p>Running the program with <code>valgrind</code> illustrates this:</p>\n\n<pre><code>==5485== Memcheck, a memory error detector\n==5485== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==5485== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==5485== Command: ./test\n==5485== \n9\n==5485== Use of uninitialised value of size 8\n==5485==    at 0x108A20: _ZZZ4mainENKUlT_E_clIS0_EEDaS_ENKUlS_E_clIiEEDaS_ (test.cpp:8)\n==5485==    by 0x108AD8: main (test.cpp:12)\n==5485== \n==5485== Invalid read of size 4\n==5485==    at 0x108A20: _ZZZ4mainENKUlT_E_clIS0_EEDaS_ENKUlS_E_clIiEEDaS_ (test.cpp:8)\n==5485==    by 0x108AD8: main (test.cpp:12)\n==5485==  Address 0x4fefffdc4 is not stack'd, malloc'd or (recently) free'd\n==5485== \n==5485== \n==5485== Process terminating with default action of signal 11 (SIGSEGV)\n==5485==  Access not within mapped region at address 0x4FEFFFDC4\n==5485==    at 0x108A20: _ZZZ4mainENKUlT_E_clIS0_EEDaS_ENKUlS_E_clIiEEDaS_ (test.cpp:8)\n==5485==    by 0x108AD8: main (test.cpp:12)\n==5485==  If you believe this happened as a result of a stack\n==5485==  overflow in your program's main thread (unlikely but\n==5485==  possible), you can try to increase the size of the\n==5485==  main thread stack using the --main-stacksize= flag.\n==5485==  The main thread stack size used in this run was 8388608.\n</code></pre>\n\n<p>Instead you can change the outer lambda to take self by reference instead of by value, thus avoiding a bunch of unnecessary copies and also solving the problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main(int argc, char* argv[]) {\n\n  int a = 5;\n\n  auto it = [&amp;](auto&amp; self) { // &lt;-- self is now a reference\n      return [&amp;](auto b) {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(self);\n      };\n  };\n  it(it)(4)(6)(42)(77)(999);\n}\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>==5492== Memcheck, a memory error detector\n==5492== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==5492== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==5492== Command: ./test\n==5492== \n9\n11\n47\n82\n1004\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1536179428, "post_id": 52192578, "comment_id": 91335667, "body": "The return type of <code>Lambda1::operator()</code> is simply <code>Lambda2</code>. Then within that inner lambda expression the return type of <code>self(self)</code>, a call of <code>Lambda1::operator()</code>, is known to also be <code>Lambda2</code>. Possibly the formal rules stand in the way of making that trivial deduction, but the logic presented here doesn&#39;t. The logic here just amounts to an assertion. If the formal rules do stand in the way, then that&#39;s a flaw in the formal rules."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1536180073, "post_id": 52192578, "comment_id": 91335937, "body": "@Cheersandhth.-Alf I agree that the return type is Lambda2, but you do know that you can&#39;t have an undeduced call operator just because, because this is what you&#39;re proposing: Delay the deduction of Lambda2&#39;s call operator return type. But you can&#39;t change the rules for this, as it&#39;s pretty fundamental."}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 13, "last_activity_date": 1536177408, "creation_date": 1536177408, "answer_id": 52192578, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal/52192578#52192578", "title": "Lambda returning itself: is this legal?", "body": "<p>It seems like clang is right. Consider a simplified example:</p>\n\n<pre><code>auto it = [](auto&amp; self) {\n    return [&amp;self]() {\n      return self(self);\n    };\n};\nit(it);\n</code></pre>\n\n<p>Let's go through it like a compiler (a bit):</p>\n\n<ul>\n<li>The type of <code>it</code> is <code>Lambda1</code> with a template call operator. </li>\n<li><code>it(it);</code> triggers instantiation of the call operator</li>\n<li>The return type of the template call operator is <code>auto</code>, so we must deduce it.</li>\n<li>We are returning a lambda capturing the first parameter of type <code>Lambda1</code>.</li>\n<li>That lambda has a call operator too which returns the type of the invocation <code>self(self)</code></li>\n<li>Notice: <code>self(self)</code> is exactly what we started with!</li>\n</ul>\n\n<p>As such, the type cannot be deduced.</p>\n"}, {"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1536180092, "post_id": 52192642, "comment_id": 91335947, "body": "How would you specify the return type explicitly? I can&#39;t figure it out."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1536180171, "post_id": 52192642, "comment_id": 91335971, "body": "@Rakete1111 Which one? In the original, you can&#39;t."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1536180378, "post_id": 52192642, "comment_id": 91336061, "body": "oh ok. I&#39;m not a native, but &quot;so you have to explicitly provide a return type&quot; seems to imply that there is a way, that&#39;s why I was asking :)"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1536180443, "post_id": 52192642, "comment_id": 91336086, "body": "@Rakete1111 Oh yeah, that&#39;s misleading. I meant for the case where maybe you know what the return type is (e.g. you&#39;re writing recursive fibonacci, so you know it&#39;s <code>int</code> even though it depends on <code>self</code>)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536182226, "post_id": 52192642, "comment_id": 91336771, "body": "&quot;If the name of an entity with an undeduced placeholder type appears in an expression, the program is ill-formed&quot; I don&#39;t see an occurrence of this in the program."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536182708, "post_id": 52192642, "comment_id": 91336929, "body": "@n.m. Yeah... the wording should probably say &quot;If an expression with an undeduced placeholder type&quot; rather than &quot;name of an entity,&quot; but this rule is intended to apply to cases like this (the example there is about functions with deduced placeholders, which is exactly this case - except instead of using a function like that by name, we&#39;re referring to it in a different way)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536182936, "post_id": 52192642, "comment_id": 91337012, "body": "It&#39;s hard to imagine how an expression with an undeduced placeholder type can avoid containing a name of an entity with an undeduced placeholder type. I don&#39;t see such an expression here either. clang doesn&#39;t complain about this, it complains about <code>operator()</code> of the lambda."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536188072, "post_id": 52192642, "comment_id": 91338423, "body": "@n.m. Does that addition help?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536203009, "post_id": 52192642, "comment_id": 91341267, "body": "Yes, knowing which names are dependent seems to be the key here."}, {"owner": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "reply_to_user": {"reputation": 2497, "user_id": 4135063, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e7ad6fb5dc2f10279b43129570737497?s=128&d=identicon&r=PG", "display_name": "Pedro A", "link": "https://stackoverflow.com/users/4135063/pedro-a"}, "edited": false, "score": 4, "creation_date": 1536289635, "post_id": 52192642, "comment_id": 91378584, "body": "@PedroA <a href=\"https://stackoverflow.com/users/2756719/t-c\">stackoverflow.com/users/2756719/t-c</a> is a C++ contributor. He is also either <i>not</i> an AI, or resourceful enough to convince a human who is also knowledgeable about C++ to attend the recent LWG mini-meeting in Chicago."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "edited": false, "score": 3, "creation_date": 1536379237, "post_id": 52192642, "comment_id": 91413124, "body": "@Casey Or maybe the human is just parroting what the AI told him...you never know ;)"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 69, "last_activity_date": 1536188058, "last_edit_date": 1536188058, "creation_date": 1536177774, "answer_id": 52192642, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal/52192642#52192642", "title": "Lambda returning itself: is this legal?", "body": "<p>The program is ill-formed (clang is right) per <a href=\"http://eel.is/c++draft/dcl.spec.auto#9\" rel=\"noreferrer\">[dcl.spec.auto]/9</a>:</p>\n\n<blockquote>\n  <p>If the name of an entity with an undeduced placeholder type appears in an expression, the program is ill-formed. Once a non-discarded return statement has been seen in a function, however, the return type deduced from that statement can be used in the rest of the function, including in other return statements.</p>\n</blockquote>\n\n<p>Basically, the deduction of the return type of the inner lambda depends on itself (the entity being named here is the call operator) - so you have to explicitly provide a return type. In this particular case, that's impossible, because you need the type of the inner lambda but can't name it. But there are other cases where trying to force recursive lambdas like this, that can work. </p>\n\n<p>Even without that, you have a <a href=\"https://stackoverflow.com/a/52192483/2069064\">dangling reference</a>. </p>\n\n<hr />\n\n<p>Let me elaborate some more, after discussing with somebody much smarter (i.e. T.C.) There is an important difference between the original code (slightly reduced) and the proposed new version (likewise reduced):</p>\n\n<pre><code>auto f1 = [&amp;](auto&amp; self) {\n  return [&amp;](auto) { return self(self); } /* #1 */ ; /* #2 */\n};\nf1(f1)(0);\n\nauto f2 = [&amp;](auto&amp; self, auto) {\n  return [&amp;](auto p) { return self(self,p); };\n};\nf2(f2, 0);\n</code></pre>\n\n<p>And that is that the inner expression <code>self(self)</code> is not dependent for <code>f1</code>, but <code>self(self, p)</code> is dependent for <code>f2</code>. When expressions are non-dependent, they can be used... eagerly (<a href=\"http://eel.is/c++draft/temp.res#8\" rel=\"noreferrer\">[temp.res]/8</a>, e.g. how <code>static_assert(false)</code> is a hard error regardless of whether the template it finds itself in is instantiated or not). </p>\n\n<p>For <code>f1</code>, a compiler (like, say, clang) can try to instantiate this eagerly. You know the deduced type of of the outer lambda once you get to that <code>;</code> at point <code>#2</code> above (it's the inner lambda's type), but we're trying to use it earlier than that (think of it as at point <code>#1</code>) - we're trying to use it while we're still parsing the inner lambda, before we know what it's type actually is. That runs afoul of dcl.spec.auto/9.</p>\n\n<p>However, for <code>f2</code>, we cannot try to instantiate eagerly, because it's dependent. We can only instantiate at point of use, by which point we know everything. </p>\n\n<hr />\n\n<p>In order to really do something like this, you need a <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0200r0.html\" rel=\"noreferrer\">y-combinator</a>. The implementation from the paper:</p>\n\n<blockquote>\n<pre><code>template&lt;class Fun&gt;\nclass y_combinator_result {\n    Fun fun_;\npublic:\n    template&lt;class T&gt;\n    explicit y_combinator_result(T &amp;&amp;fun): fun_(std::forward&lt;T&gt;(fun)) {}\n\n    template&lt;class ...Args&gt;\n    decltype(auto) operator()(Args &amp;&amp;...args) {\n        return fun_(std::ref(*this), std::forward&lt;Args&gt;(args)...);\n    }\n};\n\ntemplate&lt;class Fun&gt;\ndecltype(auto) y_combinator(Fun &amp;&amp;fun) {\n    return y_combinator_result&lt;std::decay_t&lt;Fun&gt;&gt;(std::forward&lt;Fun&gt;(fun));\n}\n</code></pre>\n</blockquote>\n\n<p>And what you want is:</p>\n\n<pre><code>auto it = y_combinator([&amp;](auto self, auto b){\n    std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n    return self;\n});\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1536180381, "post_id": 52192650, "comment_id": 91336062, "body": "@Cheersandhth.-Alf I ended up finding the standard quote after reading the paper so it is not relevant since the standard quote makes it clear why neither approach works"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536182336, "post_id": 52192650, "comment_id": 91336806, "body": "&quot;&quot;If the name of an entity with an undeduced placeholder type appears in an expression, the program is ill-formed&quot; I don&#39;t see an occurrence of this in the program though. <code>self</code> doesn&#39;t seem such an entity."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536183161, "post_id": 52192650, "comment_id": 91337084, "body": "@n.m. besides possible wording nits the examples seem to make sense with the wording and I believe the examples demonstrate the issue clearly. I don&#39;t think I could add more currently to help."}], "tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": false, "score": 21, "last_activity_date": 1536183898, "last_edit_date": 1536183898, "creation_date": 1536177797, "answer_id": 52192650, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal/52192650#52192650", "title": "Lambda returning itself: is this legal?", "body": "<h3>TL;DR;</h3>\n\n<p>clang is correct.</p>\n\n<p>It looks like the section of the standard that makes this ill-formed is <a href=\"http://eel.is/c++draft/dcl.spec.auto#9\" rel=\"noreferrer\">[dcl.spec.auto]p9</a>:</p>\n\n<blockquote>\n  <p><strong>If the name of an entity with an undeduced placeholder type appears in an expression, the program is\n  ill-formed.</strong> Once a non-discarded return statement has been seen in a function, however, the return type\n  deduced from that statement can be used in the rest of the function, including in other return statements.\n  [ Example:</p>\n\n<pre><code>auto n = n; // error, n\u2019s initializer refers to n\nauto f();\nvoid g() { &amp;f; } // error, f\u2019s return type is unknown\n\nauto sum(int i) {\n  if (i == 1)\n    return i; // sum\u2019s return type is int\n  else\n    return sum(i-1)+i; // OK, sum\u2019s return type has been deduced\n}\n</code></pre>\n  \n  <p>\u2014end example ]</p>\n</blockquote>\n\n<h3>Original work through</h3>\n\n<p>If we look at the proposal <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0200r0.html\" rel=\"noreferrer\">A Proposal to Add Y Combinator to the Standard Library</a> it provides a working solution:</p>\n\n<pre><code>template&lt;class Fun&gt;\nclass y_combinator_result {\n    Fun fun_;\npublic:\n    template&lt;class T&gt;\n    explicit y_combinator_result(T &amp;&amp;fun): fun_(std::forward&lt;T&gt;(fun)) {}\n\n    template&lt;class ...Args&gt;\n    decltype(auto) operator()(Args &amp;&amp;...args) {\n        return fun_(std::ref(*this), std::forward&lt;Args&gt;(args)...);\n    }\n};\n\ntemplate&lt;class Fun&gt;\ndecltype(auto) y_combinator(Fun &amp;&amp;fun) {\n    return y_combinator_result&lt;std::decay_t&lt;Fun&gt;&gt;(std::forward&lt;Fun&gt;(fun));\n}\n</code></pre>\n\n<p>and it explicitly says your example is not possible:</p>\n\n<blockquote>\n  <p>C++11/14 lambdas do not encourage recursion: there is no way to reference the lambda object from the body of the lambda function.</p>\n</blockquote>\n\n<p>and it references a <a href=\"https://groups.google.com/a/isocpp.org/d/msg/std-proposals/7p7J1C5jFzk/FIb3r5RZCgAJ\" rel=\"noreferrer\">dicussion in which Richard Smith alludes to the error that clang is giving you</a>:</p>\n\n<blockquote>\n  <p>I think this would be better as a first-class language feature. I ran out of time for the pre-Kona meeting, but I was intending on writing a paper to allow giving a lambda a name (scoped to its own body):</p>\n\n<pre><code>auto x = []fib(int a) { return a &gt; 1 ? fib(a - 1) + fib(a - 2) : a; };\n</code></pre>\n  \n  <p><strong>Here, 'fib' is the equivalent of the lambda's *this (with some annoying special rules to allow this to work despite the lambda's closure type being incomplete).</strong></p>\n</blockquote>\n\n<p>Barry pointed me to the follow-up proposal <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0839r0.html\" rel=\"noreferrer\">Recursive lambdas</a> which explains why this is not possible and works around the <code>dcl.spec.auto#9</code> restriction and also shows methods to achieve this today without it:</p>\n\n<blockquote>\n  <p>Lambdas are a useful tool for local code refactoring. However, we sometimes want to use the lambda from within itself, either to permit direct recursion or to allow the closure to be registered as a continuation. This is surprisingly difficult to accomplish well in current C++.</p>\n  \n  <p>Example:</p>\n\n<pre><code>  void read(Socket sock, OutputBuffer buff) {\n  sock.readsome([&amp;] (Data data) {\n  buff.append(data);\n  sock.readsome(/*current lambda*/);\n}).get();\n</code></pre>\n  \n  <p>}</p>\n  \n  <p><strong>One natural attempt to reference a lambda from itself is to store it in a variable and capture that variable by reference:</strong></p>\n\n<pre><code> auto on_read = [&amp;] (Data data) {\n  buff.append(data);\n  sock.readsome(on_read);\n};\n</code></pre>\n  \n  <p><strong>However, this is not possible due to a semantic circularity</strong>: the type of the auto variable is not deduced until after the lambda-expression is processed, which means the lambda-expression cannot reference the variable.</p>\n  \n  <p>Another natural approach is to use a std::function:</p>\n\n<pre><code> std::function on_read = [&amp;] (Data data) {\n  buff.append(data);\n  sock.readsome(on_read);\n};\n</code></pre>\n  \n  <p>This approach compiles, but typically introduces an abstraction penalty: the std::function may incur a memory allocation and the invocation of the lambda will typically require an indirect call.</p>\n  \n  <p>For a zero-overhead solution, there is often no better approach than defining a local class type explicitly. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1536182336, "post_id": 52192779, "comment_id": 91336805, "body": "See, the problem is that <code>template&lt; class &gt; class Inner;</code>&#39;s template <code>operator()</code> is ...instantiated?  Well, wrong word.  Written? ... during <code>Outer::operator()&lt;Outer&gt;</code> before the return type of outer operator is deduced.  And <code>Inner&lt;Outer&gt;::operator()</code> has a call to <code>Outer::operator()&lt;Outer&gt;</code> itself.  And that isn&#39;t allowed.  Now, most compilers don&#39;t <i>notice</i> the <code>self(self)</code> because they wait to deduce the return type of <code>Outer::Inner&lt;Outer&gt;::operator()&lt;int&gt;</code> for when <code>int</code> is passed in.  Sensible.  But it misses the ill formed ness of the code."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1536182999, "post_id": 52192779, "comment_id": 91337029, "body": "Well I think they <i>must</i> wait to deduce the function template&#39;s return type until that function template, <code>Innner&lt;T&gt;::operator()&lt;U&gt;</code>, is instantiated. After all the return type could depend on the <code>U</code> here. It doesn&#39;t, but in general."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1536186840, "post_id": 52192779, "comment_id": 91338143, "body": "sure; but any expression whose type is determined by an incomplete return type deduction remains illegal.  Just some compilers are lazy and don&#39;t check until later, by which point everuthing works."}], "tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": false, "score": 7, "last_activity_date": 1536180984, "last_edit_date": 1536180984, "creation_date": 1536178375, "answer_id": 52192779, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal/52192779#52192779", "title": "Lambda returning itself: is this legal?", "body": "<p>It's easy enough to rewrite the code in terms of the classes that a compiler would, or rather should, generate for the lambda expressions.</p>\n\n<p>When that's done it's clear that the main problem is just the dangling reference, and that a compiler that doesn't accept the code is somewhat challenged in the lambda department.</p>\n\n<p>The rewrite shows that there are no circular dependencies.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Outer\n{\n    int&amp; a;\n\n    // Actually a templated argument, but always called with `Outer`.\n    template&lt; class Arg &gt;\n    auto operator()( Arg&amp; self ) const\n        //-&gt; Inner\n    {\n        return Inner( a, self );    //! Original code has dangling ref here.\n    }\n\n    struct Inner\n    {\n        int&amp; a;\n        Outer&amp; self;\n\n        // Actually a templated argument, but always called with `int`.\n        template&lt; class Arg &gt;\n        auto operator()( Arg b ) const\n            //-&gt; Inner\n        {\n            std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n            return self( self );\n        }\n\n        Inner( int&amp; an_a, Outer&amp; a_self ): a( an_a ), self( a_self ) {}\n    };\n\n    Outer( int&amp; ref ): a( ref ) {}\n};\n\nint main() {\n\n  int a = 5;\n\n  auto&amp;&amp; it = Outer( a );\n  it(it)(4)(6)(42)(77)(999);\n}\n</code></pre>\n\n<hr>\n\n<p>A fully templated version to reflect the way that the inner lambda in the original code, captures an item that's of a templated type:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Outer\n{\n    int&amp; a;\n\n    template&lt; class &gt; class Inner;\n\n    // Actually a templated argument, but always called with `Outer`.\n    template&lt; class Arg &gt;\n    auto operator()( Arg&amp; self ) const\n        //-&gt; Inner\n    {\n        return Inner&lt;Arg&gt;( a, self );    //! Original code has dangling ref here.\n    }\n\n    template&lt; class Self &gt;\n    struct Inner\n    {\n        int&amp; a;\n        Self&amp; self;\n\n        // Actually a templated argument, but always called with `int`.\n        template&lt; class Arg &gt;\n        auto operator()( Arg b ) const\n            //-&gt; Inner\n        {\n            std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n            return self( self );\n        }\n\n        Inner( int&amp; an_a, Self&amp; a_self ): a( an_a ), self( a_self ) {}\n    };\n\n    Outer( int&amp; ref ): a( ref ) {}\n};\n\nint main() {\n\n  int a = 5;\n\n  auto&amp;&amp; it = Outer( a );\n  it(it)(4)(6)(42)(77)(999);\n}\n</code></pre>\n\n<p>I guess that it's this templating in the internal machinery, that the formal rules are designed to forbid. If they do forbid the original construct.</p>\n"}, {"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1536184139, "post_id": 52193479, "comment_id": 91337395, "body": "Possibly (IDK) this description is correct for the formal rules about lambdas. But in terms of the template rewrite, the return type of the inner lambda&#39;s templated <code>operator()</code>, can&#39;t in general be deduced until it&#39;s instantiated (by being called with some argument of some type). And so <a href=\"https://stackoverflow.com/a/52192779/464581\">a manual machine-like rewrite to template based code</a> works nicely."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1536186977, "post_id": 52193479, "comment_id": 91338170, "body": "@cheers your code is different; inner is a template class in your code, but it is not in my or the OP code.  And that matters, as template class methods are delay instantiated until called."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1536188118, "post_id": 52193479, "comment_id": 91338433, "body": "A class defined within a templated function, is equivalent to a templated class outside that function. Defining it outside the function is necessary for the demo code when it has a templated member function, because the C++ rules don&#39;t permit a member template in a local user-defined class. That formal restriction doesn&#39;t hold for whatever the compiler generates itself."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 9, "last_activity_date": 1536182501, "last_edit_date": 1536182501, "creation_date": 1536182136, "answer_id": 52193479, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal/52193479#52193479", "title": "Lambda returning itself: is this legal?", "body": "<p>Well, your code doesn't work.  But this does:</p>\n\n<pre><code>template&lt;class F&gt;\nstruct ycombinator {\n  F f;\n  template&lt;class...Args&gt;\n  auto operator()(Args&amp;&amp;...args){\n    return f(f, std::forward&lt;Args&gt;(args)...);\n  }\n};\ntemplate&lt;class F&gt;\nycombinator(F) -&gt; ycombinator&lt;F&gt;;\n</code></pre>\n\n<p>Test code:</p>\n\n<pre><code>ycombinator bob = {[x=0](auto&amp;&amp; self)mutable{\n  std::cout &lt;&lt; ++x &lt;&lt; \"\\n\";\n  ycombinator ret = {self};\n  return ret;\n}};\n\nbob()()(); // prints 1 2 3\n</code></pre>\n\n<hr>\n\n<p>Your code is both UB and ill-formed no diagnostic required.  Which is funny; but both can be fixed independently.</p>\n\n<p>First, the UB:</p>\n\n<pre><code>auto it = [&amp;](auto self) { // outer\n  return [&amp;](auto b) { // inner\n    std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n    return self(self);\n  };\n};\nit(it)(4)(5)(6);\n</code></pre>\n\n<p>this is UB because outer takes <code>self</code> by value, then inner captures <code>self</code> by reference, then proceeds to return it after <code>outer</code> finishes running.  So segfaulting is definitely ok.</p>\n\n<p>The fix:</p>\n\n<pre><code>[&amp;](auto self) {\n  return [self,&amp;a](auto b) {\n    std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n    return self(self);\n  };\n};\n</code></pre>\n\n<hr>\n\n<p>The code remains is ill-formed.  To see this we can expand the lambdas:</p>\n\n<pre><code>struct __outer_lambda__ {\n  template&lt;class T&gt;\n  auto operator()(T self) const {\n    struct __inner_lambda__ {\n      template&lt;class B&gt;\n      auto operator()(B b) const {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(self);\n      }\n      int&amp; a;\n      T self;\n    };\n    return __inner_lambda__{a, self};\n  }\n  int&amp; a;\n};\n__outer_lambda__ it{a};\nit(it);\n</code></pre>\n\n<p>this instantiates <code>__outer_lambda__::operator()&lt;__outer_lambda__&gt;</code>:</p>\n\n<pre><code>  template&lt;&gt;\n  auto __outer_lambda__::operator()(__outer_lambda__ self) const {\n    struct __inner_lambda__ {\n      template&lt;class B&gt;\n      auto operator()(B b) const {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(self);\n      }\n      int&amp; a;\n      __outer_lambda__ self;\n    };\n    return __inner_lambda__{a, self};\n  }\n  int&amp; a;\n};\n</code></pre>\n\n<p>So we next have to determine the return type of <code>__outer_lambda__::operator()</code>.</p>\n\n<p>We go through it line by line.  First we create <code>__inner_lambda__</code> type:</p>\n\n<pre><code>    struct __inner_lambda__ {\n      template&lt;class B&gt;\n      auto operator()(B b) const {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(self);\n      }\n      int&amp; a;\n      __outer_lambda__ self;\n    };\n</code></pre>\n\n<p>Now, look there -- its return type is <code>self(self)</code>, or <code>__outer_lambda__(__outer_lambda__ const&amp;)</code>.  But we are in the middle of trying to deduce the return type of <code>__outer_lambda__::operator()(__outer_lambda__)</code>.</p>\n\n<p>You aren't allowed to do that.</p>\n\n<p>While in fact the return type of <code>__outer_lambda__::operator()(__outer_lambda__)</code> is not actually dependent on the return type of <code>__inner_lambda__::operator()(int)</code>, C++ doesn't care when deducing return types; it simply checks the code line by line.</p>\n\n<p>And <code>self(self)</code> is used before we deduced it.  Ill formed program.</p>\n\n<p>We can patch this by hiding <code>self(self)</code> until later:</p>\n\n<pre><code>template&lt;class A, class B&gt;\nstruct second_type_helper { using result=B; };\n\ntemplate&lt;class A, class B&gt;\nusing second_type = typename second_type_helper&lt;A,B&gt;::result;\n\nint main(int argc, char* argv[]) {\n\n  int a = 5;\n\n  auto it = [&amp;](auto self) {\n      return [self,&amp;a](auto b) {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(second_type&lt;decltype(b), decltype(self)&amp;&gt;(self) );\n      };\n  };\n  it(it)(4)(6)(42)(77)(999);\n}\n</code></pre>\n\n<p>and now the code is correct and compiles.  But I think this is a bit of hack; just use the ycombinator.</p>\n"}], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9783, "favorite_count": 24, "accepted_answer_id": 52192642, "answer_count": 6, "score": 127, "last_activity_date": 1536720231, "creation_date": 1536176570, "last_edit_date": 1536720231, "question_id": 52192389, "link": "https://stackoverflow.com/questions/52192389/lambda-returning-itself-is-this-legal", "title": "Lambda returning itself: is this legal?", "body": "<p>Consider this fairly useless program:</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main(int argc, char* argv[]) {\n\n  int a = 5;\n\n  auto it = [&amp;](auto self) {\n      return [&amp;](auto b) {\n        std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n        return self(self);\n      };\n  };\n  it(it)(4)(6)(42)(77)(999);\n}\n</code></pre>\n\n<p>Basically we are trying to make a lambda that returns itself. </p>\n\n<ul>\n<li>MSVC compiles the program, and it runs</li>\n<li>gcc compiles the program, and it segfaults</li>\n<li>clang rejects the program with a message:\n\n<blockquote>\n  <p><code>error: function 'operator()&lt;(lambda at lam.cpp:6:13)&gt;' with deduced return type cannot be used before it is defined</code></p>\n</blockquote></li>\n</ul>\n\n<p>Which compiler is right? Is there a static constraint violation, UB, or neither?</p>\n\n<p><strong>Update</strong> this slight modification is accepted by clang:</p>\n\n<pre><code>  auto it = [&amp;](auto&amp; self, auto b) {\n          std::cout &lt;&lt; (a + b) &lt;&lt; std::endl;\n          return [&amp;](auto p) { return self(self,p); };\n  };\n  it(it,4)(6)(42)(77)(999);\n</code></pre>\n\n<p><strong>Update 2</strong>: I understand how to write a functor that returns itself, or how to use the Y combinator, to achieve this. This is more a language-lawyer question.</p>\n\n<p><strong>Update 3</strong>: the question is <em>not</em> whether it is legal for a lambda to return itself in general, but about the legality of this specific way of doing this. </p>\n\n<p>Related question: <a href=\"https://stackoverflow.com/questions/52173762/c-lambda-returning-itself\">C++ lambda returning itself</a>.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1536176525, "post_id": 52192355, "comment_id": 91334441, "body": "&quot;how to assign a new object correctly to an existed array?&quot; Like you&#39;re doing, <code>the_array[3] = something;</code>"}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1536176857, "post_id": 52192355, "comment_id": 91334602, "body": "@JesperJuhl no, the elements of the array are class objects, not pointers."}, {"owner": {"reputation": 175, "user_id": 9685251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K-T_vt_x4a0/AAAAAAAAAAI/AAAAAAAAAA0/ZWNgDb9zAY4/photo.jpg?sz=128", "display_name": "iry", "link": "https://stackoverflow.com/users/9685251/iry"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1536176890, "post_id": 52192355, "comment_id": 91334611, "body": "@juanchopanza if the previous object used heap resource and should be freed in destructor then it will cause a resource leak. Should we call the destructor manually?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536176943, "post_id": 52192355, "comment_id": 91334639, "body": "@iry No, in those cases you write your own <code>operator=</code> to handle cleaning up the resources before they are reassigned."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1536176946, "post_id": 52192355, "comment_id": 91334642, "body": "@iry No, and no."}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 2, "last_activity_date": 1536176564, "creation_date": 1536176564, "answer_id": 52192387, "question_id": 52192355, "link": "https://stackoverflow.com/questions/52192355/why-the-destructor-of-an-object-in-an-array-isnt-called-when-being-replaced-by/52192387#52192387", "title": "Why the destructor of an object in an array isn&#39;t called when being replaced by another?", "body": "<p>It's not replaced with, it's assigned to. The object in the array continues live its lifetime happily, until the whole array is destroyed.</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 9685251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K-T_vt_x4a0/AAAAAAAAAAI/AAAAAAAAAA0/ZWNgDb9zAY4/photo.jpg?sz=128", "display_name": "iry", "link": "https://stackoverflow.com/users/9685251/iry"}, "edited": false, "score": 0, "creation_date": 1536178271, "post_id": 52192403, "comment_id": 91335215, "body": "So = operator is just an operator to modify the content of the object to make the object same as the object on the right side of the operator, I&#39;m I right this time :P? I learn Java before C++ and assigning pointers are giving me kind of sense that = operator is used to replacing the previous object by a new object, so sorry for my ignorance xD"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 175, "user_id": 9685251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K-T_vt_x4a0/AAAAAAAAAAI/AAAAAAAAAA0/ZWNgDb9zAY4/photo.jpg?sz=128", "display_name": "iry", "link": "https://stackoverflow.com/users/9685251/iry"}, "edited": false, "score": 2, "creation_date": 1536178569, "post_id": 52192403, "comment_id": 91335326, "body": "@iry Java and C++ are very different.  In C++ we have value semantics and variables are objects, not pointers like they are in Java (very generalized, there are pointers to in C++).  When you write <code>A = B</code> you don&#39;t make <code>A</code> point to the same object <code>B</code> points to but instead you you copy the object <code>B</code> into <code>A</code> so you now have two objects with the same value.  If you have not done so I suggest you get yourself a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>.  Trying to code C++ as Java will just lead to issues."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 3, "last_activity_date": 1536176661, "creation_date": 1536176661, "answer_id": 52192403, "question_id": 52192355, "link": "https://stackoverflow.com/questions/52192355/why-the-destructor-of-an-object-in-an-array-isnt-called-when-being-replaced-by/52192403#52192403", "title": "Why the destructor of an object in an array isn&#39;t called when being replaced by another?", "body": "<p>A destructor is called when the lifetime  of an object ends (goes out of scope, delete is called on the pointer  that was returned by new).  When you do</p>\n\n<pre><code>someClasses[2] = SomeClass(40);\n</code></pre>\n\n<p>the lifetime of <code>someClasses[2]</code> doesn't end, you just give it a new value.  It isn't until</p>\n\n<pre><code>delete[] someClasses;\n</code></pre>\n\n<p>when you delete the array that you end the lifetime of all the objects in the array, that the destructor is called.</p>\n"}, {"tags": [], "owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 2, "last_activity_date": 1536177007, "creation_date": 1536177007, "answer_id": 52192482, "question_id": 52192355, "link": "https://stackoverflow.com/questions/52192355/why-the-destructor-of-an-object-in-an-array-isnt-called-when-being-replaced-by/52192482#52192482", "title": "Why the destructor of an object in an array isn&#39;t called when being replaced by another?", "body": "<p>The assignments aren't calling a constructor or destructor, you're calling an assignment operator <code>operator=</code>. Since you didn't provide one for your <code>SomeClass</code>, the compiler generated one for you. This default <code>operator=</code> copies the member variable. For a simple class like yours this default is exactly what you need, which is why you see the result you expect in the array.</p>\n"}], "owner": {"reputation": 175, "user_id": 9685251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K-T_vt_x4a0/AAAAAAAAAAI/AAAAAAAAAA0/ZWNgDb9zAY4/photo.jpg?sz=128", "display_name": "iry", "link": "https://stackoverflow.com/users/9685251/iry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52192403, "answer_count": 3, "score": 3, "last_activity_date": 1536177007, "creation_date": 1536176395, "question_id": 52192355, "link": "https://stackoverflow.com/questions/52192355/why-the-destructor-of-an-object-in-an-array-isnt-called-when-being-replaced-by", "title": "Why the destructor of an object in an array isn&#39;t called when being replaced by another?", "body": "<p>Just see code</p>\n\n<pre><code>class SomeClass {\nprivate:\n    int i;\npublic:\n    int getI() {\n        return i;\n    }\n\n    SomeClass() {\n        i = 0;\n    }\n\n    explicit SomeClass(int i) {\n        this-&gt;i = i;\n    }\n\n    ~SomeClass(){\n        cout &lt;&lt; \"SomeClass destructed with i=\" &lt;&lt; i &lt;&lt; \".\" &lt;&lt; endl;\n    }\n};\n</code></pre>\n\n<p>And the main function</p>\n\n<pre><code>int main() {\n    auto* someClasses = new SomeClass[5];\n    someClasses[2] = SomeClass(20);\n    cout &lt;&lt; \"A new SomeClass Assigned.\" &lt;&lt; endl;\n    someClasses[2] = SomeClass(40);\n    cout &lt;&lt; \"A new SomeClass Assigned.\" &lt;&lt; endl;\n    delete[] someClasses;\n}\n</code></pre>\n\n<p>The array is initialized with all objects constructed with i=0, and we do some modification to someClasses[2].</p>\n\n<p>When ending up an object, the destructor of the object should be called. However, the result shows that the destructor is not being invoked.</p>\n\n<pre><code>SomeClass destructed with i=20. // destructed after copy constructor is done.\nA new SomeClass Assigned.\nSomeClass destructed with i=40. // destructed after copy constructor is done.\nA new SomeClass Assigned.\nSomeClass destructed with i=0. // okay.\nSomeClass destructed with i=0. // okay.\nSomeClass destructed with i=40. // okay.\nSomeClass destructed with i=0. // okay.\nSomeClass destructed with i=0. // okay.\n\nProcess finished with exit code 0\n</code></pre>\n\n<p>If the destructor is designed not be called in this situation, how to assign a new object correctly to an existed array?</p>\n\n<p>Using an object pointer array is an option but I'm just curious.</p>\n"}, {"tags": ["c++", "linux", "mmap", "temporary-files", "file-management"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1536217746, "post_id": 52192309, "comment_id": 91345817, "body": "If you have a file store, you can use a swap file instead of a swap partition."}], "answers": [{"comments": [{"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1536176668, "post_id": 52192359, "comment_id": 91334512, "body": "This is <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/unlink.html\" rel=\"nofollow noreferrer\">POSIX defined behavior</a>, it works on all normal fs and Unix os"}, {"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1536176905, "post_id": 52192359, "comment_id": 91334623, "body": "@thatotherguy: true, but I would bet that not all filesystem drivers implement it in a way which ensures these files are properly cleaned up without additional work. For example, how would the FAT32 filesystem do this? <a href=\"https://superuser.com/a/486104/14348\">This question</a> indicates a hard reboot might leave orphan files on this filesystem. Since he said flash, who knows which filesystem is in use?"}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1536177383, "post_id": 52192359, "comment_id": 91334835, "body": "It works just fine on fat32. Orphan files are an issue on all FS, and they get cleaned up by fsck or journal recovery"}], "tags": [], "owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "is_accepted": false, "score": 1, "last_activity_date": 1536176417, "creation_date": 1536176417, "answer_id": 52192359, "question_id": 52192309, "link": "https://stackoverflow.com/questions/52192309/linux-non-persistent-backing-store-for-mmap/52192359#52192359", "title": "Linux non-persistent backing store for mmap()", "body": "<p>I believe this is filesystem-specific, but most Linux filesystems allow deletion of open files. The file will still exist until the last handle to it is closed. I would recommend that you open the file then delete it immediately and it will be automatically cleaned up when your process exits for any reason.</p>\n\n<p>For further details, see this post: <a href=\"https://stackoverflow.com/questions/2028874/what-happens-to-an-open-file-handle-on-linux-if-the-pointed-file-gets-moved-del\">What happens to an open file handle on Linux if the pointed file gets moved, delete</a></p>\n"}, {"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 2, "last_activity_date": 1536176571, "creation_date": 1536176571, "answer_id": 52192390, "question_id": 52192309, "link": "https://stackoverflow.com/questions/52192309/linux-non-persistent-backing-store-for-mmap/52192390#52192390", "title": "Linux non-persistent backing store for mmap()", "body": "<p>Yes, You create/open the file. Then you <code>remove()</code> the file by its filename.</p>\n\n<p>The file will still be open by your process and you can read/write it just like any opened file, and it will disappear when the process having the file opened exits.</p>\n\n<p>I believe this behavior is mandated by posix, so it will work on any unix like system. Even at a hard reboot, the space will be reclaimed.</p>\n"}, {"comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1536180385, "post_id": 52192541, "comment_id": 91336064, "body": "Great answer, thanks!  Given that I&#39;m going to be treating this data as if it was in RAM (i.e. with no need for persistence), is there any reason why I might care when/how/if the data is ever flushed to disk?"}, {"owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 2, "creation_date": 1536183529, "post_id": 52192541, "comment_id": 91337208, "body": "@JeremyFriesner: Possibly, because by assumption you do not have enough physical RAM... The kernel will flush and load pages based on its caching logic, but you might be able to do (much) better since you know your own access patterns. In particular, if you know that some part of the array is &quot;cold&quot;, you can probably improve performance by explicitly syncing it to disk and advising the kernel to reclaim those pages. If your access patterns are truly random, then sure, just let the kernel handle it."}], "tags": [], "owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "is_accepted": true, "score": 3, "last_activity_date": 1536177293, "creation_date": 1536177293, "answer_id": 52192541, "question_id": 52192309, "link": "https://stackoverflow.com/questions/52192309/linux-non-persistent-backing-store-for-mmap/52192541#52192541", "title": "Linux non-persistent backing store for mmap()", "body": "<p>Yes, and I do this all the time...</p>\n\n<p><code>open</code> the file, <code>unlink</code> it, use <code>ftruncate</code> or (better) <code>posix_fallocate</code> to make it the right size, then use <code>mmap</code> with <code>MAP_SHARED</code> to map it into your address space. You can then <code>close</code> the descriptor immediately if you want; the memory mapping itself will keep the file around.</p>\n\n<p>For speed, you might find you want to help Linux manage its page cache. You can use <code>posix_madvise</code> with <code>POSIX_MADV_WILLNEED</code> to advise the kernel to page data in and <code>POSIX_MADV_DONTNEED</code> to advise the kernel to release the pages.</p>\n\n<p>You might find that last does not work the way you want, especially for dirty pages. You can use <code>sync_file_range</code> to explicitly control flushing to disk. (Although in that case you will want to keep the file descriptor open.)</p>\n\n<p>All of this is perfectly standard POSIX except for the Linux-specific <code>sync_file_range</code>.</p>\n"}], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 1, "accepted_answer_id": 52192541, "answer_count": 3, "score": 0, "last_activity_date": 1536177293, "creation_date": 1536176232, "question_id": 52192309, "link": "https://stackoverflow.com/questions/52192309/linux-non-persistent-backing-store-for-mmap", "title": "Linux non-persistent backing store for mmap()", "body": "<p>First, a little motivating background info:  I've got a C++-based server process that runs on an embedded ARM/Linux-based computer.  It works pretty well, but as part of its operation it creates a fairly large fixed-size array (e.g. dozens to hundreds of megabytes) of temporary/non-persistent state information, which it currently keeps on the heap, and it accesses and/or updates that data from time to time.</p>\n\n<p>I'm investigating how far I can scale things up, and one problem I'm running into is that eventually (as I stress-test the server by making its configuration larger and larger), this data structure gets big enough to cause out-of-memory problems, and then the OOM killer shows up, and general unhappiness ensues.  Note that this embedded configuration of Linux doesn't have swap enabled, and I can't (easily) enable a swap partition.</p>\n\n<p>One idea I have on how to ameliorate the issue is to allocate this large array on the computer's local flash partition, instead of directly in RAM, and then use mmap() to make it appear to the server process like it's still in RAM.  That would reduce RAM usage considerably, and my hope is that Linux's filesystem-cache would mask most of the resulting performance cost.</p>\n\n<p>My only real concern is file management -- in particular, I'd like to avoid any chance of filling up the flash drive with \"orphan\" backing-store files (i.e. old files whose processes don't exist any longer, but the file is still present because its creating process crashed or by some other mistake forgot to delete it on exit).  I'd also like to be able to run multiple instances of the server simultaneously on the same computer, without the instances interfering with each other.</p>\n\n<p>My question is, does Linux have any built-it facility for handling this sort of use-case?  I'm particularly imagining some way to flag a file (or an mmap() handle or similar) so that when the file that created the process exits-or-crashes, the OS automagically deletes the file (similar to the way Linux already automagically recovers all of the RAM that was allocated by a process, when the process exits-or-crashes).</p>\n\n<p>Or, if Linux doesn't have any built-in auto-temp-file-cleanup feature, is there a \"best practice\" that people use to ensure that large temporary files don't end up filling up a drive due to unintentionally becoming persistent?</p>\n\n<p>Note that AFAICT simply placing the file in /tmp won't help me, since /tmp is using a RAM-disk and therefore doesn't give me any RAM-usage advantage over simply allocating in-process heap storage.</p>\n"}, {"tags": ["c++", "stdmap"], "comments": [{"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1536176343, "post_id": 52192294, "comment_id": 91334374, "body": "Do you get the same problem if you just try to create a <code>std::pair&lt;int,double[2]&gt;</code> <i>without</i> inserting it into a map? In other words, is the problem really the insertion, or the construction?"}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 8111353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c35c119a0ea571a0ebd31d7c1b1c23?s=128&d=identicon&r=PG&f=1", "display_name": "Notrius", "link": "https://stackoverflow.com/users/8111353/notrius"}, "is_accepted": true, "score": 0, "last_activity_date": 1536177049, "creation_date": 1536177049, "answer_id": 52192493, "question_id": 52192294, "link": "https://stackoverflow.com/questions/52192294/insert-an-array-element-in-an-stdmap/52192493#52192493", "title": "insert an array element in an std::map", "body": "<p>The answer you are loooking for is here:\n<a href=\"https://stackoverflow.com/questions/2582529/using-array-as-map-value-cant-see-the-error\">Using array as map value: can&#39;t see the error</a></p>\n\n<p>Where the last answer explains it as arrays are not assignable or copy constructible, therefore cannot be mapped to.</p>\n\n<p>As an alternative, you can use pointer arrays or vectors.</p>\n"}], "owner": {"reputation": 3, "user_id": 10322063, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-saCwxe1HcQs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMNh5e87S9a-VRM_i29Ki2VaP--Qw/mo/photo.jpg?sz=128", "display_name": "Jose Soto", "link": "https://stackoverflow.com/users/10322063/jose-soto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "closed_date": 1536177290, "accepted_answer_id": 52192493, "answer_count": 1, "score": 0, "last_activity_date": 1536177049, "creation_date": 1536176189, "question_id": 52192294, "link": "https://stackoverflow.com/questions/52192294/insert-an-array-element-in-an-stdmap", "closed_reason": "Duplicate", "title": "insert an array element in an std::map", "body": "<p>I don't understand why this code works:</p>\n\n<pre><code>std::map&lt;int,char&gt; map2;\nmap2.insert (std::pair&lt;int,char&gt;(3,'a'));\n</code></pre>\n\n<p>But this doesn't:</p>\n\n<pre><code>std::map&lt;int,double[2]&gt; map1;\nmap1.insert (std::pair&lt;int,double[2]&gt;(100,{0,0}));\n</code></pre>\n"}, {"tags": ["c++", "opc", "opc-ua"], "comments": [{"owner": {"reputation": 896, "user_id": 6488109, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cpnSP.jpg?s=128&g=1", "display_name": "Papipone", "link": "https://stackoverflow.com/users/6488109/papipone"}, "edited": false, "score": 0, "creation_date": 1536177399, "post_id": 52192278, "comment_id": 91334839, "body": "Could you provide us some piece of code please?"}, {"owner": {"reputation": 1, "user_id": 10322030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wU2IA-dsbJs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOUUNXftRIdte04DmEYeNQp0V1fVw/mo/photo.jpg?sz=128", "display_name": "curious mind", "link": "https://stackoverflow.com/users/10322030/curious-mind"}, "reply_to_user": {"reputation": 896, "user_id": 6488109, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cpnSP.jpg?s=128&g=1", "display_name": "Papipone", "link": "https://stackoverflow.com/users/6488109/papipone"}, "edited": false, "score": 0, "creation_date": 1536179501, "post_id": 52192278, "comment_id": 91335704, "body": "i have added the code and the debugger screenshot."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10322030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wU2IA-dsbJs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOUUNXftRIdte04DmEYeNQp0V1fVw/mo/photo.jpg?sz=128", "display_name": "curious mind", "link": "https://stackoverflow.com/users/10322030/curious-mind"}, "edited": false, "score": 0, "creation_date": 1537826005, "post_id": 52257583, "comment_id": 91916973, "body": "Thanks for the information. I figured out that the order of DataValue match with order in the read request."}], "tags": [], "owner": {"reputation": 2461, "user_id": 1716583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2dn6h.jpg?s=128&g=1", "display_name": "Camille G.", "link": "https://stackoverflow.com/users/1716583/camille-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1536753219, "last_edit_date": 1536753219, "creation_date": 1536581717, "answer_id": 52257583, "question_id": 52192278, "link": "https://stackoverflow.com/questions/52192278/how-to-get-nodeid-details-from-datavalue-response-in-callback-of-async-read-oper/52257583#52257583", "title": "How to get NodeId details from DataValue response in callback of async read operation from OPC UA server using Softing toolkit", "body": "<p>Please take a look at the <a href=\"https://opcfoundation.org/developer-tools/specifications-unified-architecture/part-4-services/\" rel=\"nofollow noreferrer\">OPC UA Specification Part 4 - Services</a> Chapter 5.10.2 Read</p>\n\n<p>An OPC UA Read Response contains an array of DataValue. Each OPC UA DataValue structure contains </p>\n\n<ul>\n<li>StatusCode</li>\n<li>SourceTimestamp</li>\n<li>ServerTimestamp</li>\n<li>SourcePicoseconds</li>\n<li>ServerPicoseconds</li>\n<li><strong>Value</strong></li>\n</ul>\n\n<p>An OPC UA Value structure contains </p>\n\n<ul>\n<li>ArrayType (0 in your case = Scalar)</li>\n<li>DataType (6 in your case = OpcUaType_Int32) </li>\n<li>Value (from an Union depending on the ArrayType and the DataType value)</li>\n</ul>\n\n<p>So actually in your case the value is Int32 Variant Union value = 46132370</p>\n\n<p><strong>Edit</strong></p>\n\n<p>The order of the DataValue in the ReadResponse DataValue Array match with the order of Read NodeId from the ReadRequest you have sent. You should then save the information before sending the ReadRequest in order to know for which NodeId the DataValue [\"X\"] is the value.</p>\n"}], "owner": {"reputation": 1, "user_id": 10322030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wU2IA-dsbJs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOUUNXftRIdte04DmEYeNQp0V1fVw/mo/photo.jpg?sz=128", "display_name": "curious mind", "link": "https://stackoverflow.com/users/10322030/curious-mind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536753219, "creation_date": 1536176134, "last_edit_date": 1536179176, "question_id": 52192278, "link": "https://stackoverflow.com/questions/52192278/how-to-get-nodeid-details-from-datavalue-response-in-callback-of-async-read-oper", "title": "How to get NodeId details from DataValue response in callback of async read operation from OPC UA server using Softing toolkit", "body": "<p><a href=\"https://i.stack.imgur.com/RGSQc.jpg\" rel=\"nofollow noreferrer\">image shows the uint32 value but i need the NodeId details too, which is \"Counter1\" as in the NodeId in readAsync  </a>I am using Softing OPC UA toolkit to develop a client. With session->readAsync() i try to read value from OPC UA server, the callback method onReadComplete is invoked  with the vector of DataValue requested for, i could get the value from the DataValue but unable to get the NodeId with namespaceIndex, indentifierType, identifier. In Visual Studio debugger these values are Unable to read memory.</p>\n\n<p>read async:</p>\n\n<pre><code>std::vector&lt;ReadValueId&gt; readValueId1s;\nReadValueId ReadValueId1;\nReadValueId1.setNodeId(NodeId(2, _T(\"Counter1\")));\nReadValueId1.setAttributeId(EnumAttributeId_Value);\nreadValueId1s.push_back(ReadValueId1);\n\n// read the variable asynchronously\nresult = session-&gt;readAsync(pRdReq, EnumTimestampsToReturn_Both, \nreadValueId1s, 0, pRdReq-&gt;getTransId());\n</code></pre>\n\n<p>callback method:</p>\n\n<pre><code>void TestSession::onReadComplete(void* requestHandle, EnumStatusCode \nserviceResult, std::vector&lt;DataValue&gt;&amp; values)\n{\n    for (unsigned int i = 0; i &lt; values.size(); i++) {\n        std::wcout &lt;&lt; values[i].getValue()-&gt;getNodeId().toString() &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "qt-creator"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536177233, "post_id": 52192271, "comment_id": 91334770, "body": "The bug is most likely in code that you have not shown.."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536177375, "post_id": 52192271, "comment_id": 91334832, "body": "Perhaps you are running out of virtual memory."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1536177453, "post_id": 52192271, "comment_id": 91334862, "body": "<b><i>my code randomly crashes</i></b> Usually this is a clear indication of Undefined Behavior (assuming your PC is stable)."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1536177656, "post_id": 52192271, "comment_id": 91334947, "body": "You have a naming conflict.  There already exists a <code>sort</code> function in <code>namespace std</code>.  The <code>using namespace std;</code> brings the <code>std::sort</code> into the namespace to collide with your <code>sort</code> class.  I recommend not <code>using namespace std;</code>.  You would be safer by identifying individual symbols, such as <code>using std::ifstream;</code>, rather including the entire namespace."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1536177716, "post_id": 52192271, "comment_id": 91334976, "body": "Turn the warnings level to maximum and resolve them."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1536178043, "post_id": 52192271, "comment_id": 91335123, "body": "Also, be aware that <code>random</code> is also in the <code>std::</code> namespace."}], "answers": [{"tags": [], "owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "is_accepted": false, "score": 0, "last_activity_date": 1536185791, "last_edit_date": 1536185791, "creation_date": 1536185080, "answer_id": 52193958, "question_id": 52192271, "link": "https://stackoverflow.com/questions/52192271/error-on-heap-in-my-sorting-algorithms-program/52193958#52193958", "title": "Error on Heap in my Sorting Algorithms Program", "body": "<p>The function sort::load() can be the problem: the vector dataset is continiously reallocated when push_back() is called. With a big enought data set, your program will get a memory allocation failure.</p>\n\n<p>one way to fix that is using dataset.reserve( MAX_DATASET_SIZE) to initialize its capacity at the begining of your program.</p>\n"}], "owner": {"reputation": 25, "user_id": 9313541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74dd4c24df2216374ee9d4c90e303c3?s=128&d=identicon&r=PG&f=1", "display_name": "zavier", "link": "https://stackoverflow.com/users/9313541/zavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536185791, "creation_date": 1536176108, "question_id": 52192271, "link": "https://stackoverflow.com/questions/52192271/error-on-heap-in-my-sorting-algorithms-program", "title": "Error on Heap in my Sorting Algorithms Program", "body": "<p>In this program I am loading in different data sets to test the Merge, Bubble and Insertion sorting algorithms. I have been working on bits and pieces and this is an early iteration. For some reason my code randomly crashes, more so these last 10 runs. After running the debugger it takes me to random spot on the heap, but doesn't give any more information on the problem with the program, I have pinpointed it to my sort.cpp file but still cant get it. I don't believe its a memory leak, and I am not using pointers so everything should exist. If you could help me troubleshoot the program I would appreciate it.</p>\n\n<p>Main</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"merge.h\"\n#include \"bubble.h\"\n#include \"insertion.h\"\n#include \"createfile.h\"\n#include \"sort.h\"\nusing namespace std;\n\n    int main()\n    {\n        cout &lt;&lt; \"You can do it Xavier, I believe in you\" &lt;&lt; endl;\n        //========================================\n        //Sort Random Sets\n        //========================================\n        SortRandom();\n        //========================================\n        //Sort Backward Sets\n        //========================================\n       // SortBackwards();\n        //========================================\n        //Sort sets with 20% Unique\n        //========================================\n    //    Sort20Percent();\n        //========================================\n        //Sort sets with 30% randomized\n        //========================================\n     //   Sort30Percent();\n\n    }\n</code></pre>\n\n<p>sort.cpp</p>\n\n<pre><code>#include \"sort.h\"\n#include \"fstream\"\n#include \"iostream\"\n#include \"bubble.h\"\n#include \"insertion.h\"\n#include \"merge.h\"\nusing namespace std;\n\n    void SortRandom()\n    {\n        sort random;\n        //Sorts 10 set\n        random.load(\"Random(10).txt\");\n        random.execute();\n        random.stats();\n        random.save(\"Random(10)Stats.txt\");\n        cout &lt;&lt; \"====================\" &lt;&lt; endl;\n        //Sorts 1000 set\n        random.load(\"Random(1000).txt\");\n        random.execute();\n        random.stats();\n        random.save(\"Random(1000)Stats.txt\");\n        cout &lt;&lt; \"====================\" &lt;&lt; endl;\n        //Sorts 10,000 set\n        random.load(\"Random(10000).txt\");\n        random.execute();\n        random.stats();\n        random.save(\"Random(10000)Stats.txt\");\n        cout &lt;&lt; \"====================\" &lt;&lt; endl;\n        //Sorts 100,000 set\n        random.load(\"Random(100000).txt\");\n        random.execute();\n        random.stats();\n        random.save(\"Random(100000)Stats.txt\");\n\n    }\n</code></pre>\n\n<p>sort.h</p>\n\n<pre><code>#ifndef SORT_H\n#define SORT_H\n#include \"algorithm.h\"\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;chrono&gt;\nusing namespace std;\nclass sort : public algorithm\n{\n    private:\n        vector&lt;int&gt; dataset;\n        string file;\n        string time1;\n        string time2;\n        string time3;\npublic:\n    //loads file into program\n    void load(string filename)\n    {\n        ifstream inFile;\n        ofstream writefile;\n        inFile.open(filename);\n        file = filename;\n        int entry;\n        string str;\n            while(std::getline(inFile, str))\n            {\n                inFile &gt;&gt; entry;\n                dataset.push_back(entry);\n            }\n\n    }\n\n    //Print the unsorted vector\n    void print()\n    {\n        for(int i=0;i&lt;dataset.size();i++)\n        {\n            cout &lt;&lt; dataset[i] &lt;&lt; endl;\n        }\n    }\n\n    //Sort set and time it\n    void execute()\n    {\n        vector&lt;int&gt; temp1 = dataset;\n        vector&lt;int&gt; temp2 = dataset;\n        vector&lt;int&gt; temp3 = dataset;\n        //Time for bubblesort\n        using timer = std::chrono::high_resolution_clock;\n                timer::time_point start_time = timer::now();\n        bubblesort(temp1);\n        timer::time_point end_time = timer::now();\n            cout &lt;&lt; \"Total Time for BubbleSort: \" &lt;&lt; chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time - start_time).count() &lt;&lt; \"ms\" &lt;&lt; endl;\n\n        //Time for MergeSort\n        using timer = std::chrono::high_resolution_clock;\n                timer::time_point start_time2 = timer::now();\n        MergeSort(temp2,0,temp2.size());\n        timer::time_point end_time2 = timer::now();\n            cout &lt;&lt; \"Total Time for MergeSort \" &lt;&lt; chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time2 - start_time2).count() &lt;&lt; \"ms\" &lt;&lt; endl;\n\n        //Time for Insertion Sort\n        using timer = std::chrono::high_resolution_clock;\n                timer::time_point start_time3 = timer::now();\n        insertionsort(temp3,temp3.size());\n        timer::time_point end_time3 = timer::now();\n            cout &lt;&lt; \"Total Time for Insertion Sort \" &lt;&lt; chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time3 - start_time3).count() &lt;&lt; \"ms\" &lt;&lt; endl;\n\n        //Save time variables\n        ostringstream x,y,z;\n        x &lt;&lt; chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time - start_time).count();\n        time1 = x.str();\n        y &lt;&lt; chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time2 - start_time2).count();\n        time2 = y.str();\n        z &lt;&lt; chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time3 - start_time3).count();\n        time3 = z.str();\n\n        dataset = temp1;\n    }\n\n    //print sorted vector to screen\n    void display()\n    {\n        insertionsort(dataset,dataset.size());\n        for(int i=0;i&lt;dataset.size();i++)\n        {\n            cout &lt;&lt; dataset[i] &lt;&lt; ',';\n        }\n        cout &lt;&lt; endl;\n        cout &lt;&lt; \"===============================================\" &lt;&lt; endl;\n    }\n\n    //Print the size of the dataset,method and time it took\n    void stats()\n    {\n        cout &lt;&lt; \"To sort this data set of size \" &lt;&lt; dataset.size() &lt;&lt; \" using the bubblesort method took \" &lt;&lt; time1 &lt;&lt; \" ms.\" &lt;&lt; endl;\n        cout &lt;&lt; \"To sort this data set of size \" &lt;&lt; dataset.size() &lt;&lt; \" using the mergesort method took \" &lt;&lt; time2 &lt;&lt; \" ms.\" &lt;&lt; endl;\n        cout &lt;&lt; \"To sort this data set of size \" &lt;&lt; dataset.size() &lt;&lt; \" using the insert sort method took \" &lt;&lt; time3 &lt;&lt; \" ms.\" &lt;&lt; endl;\n    }\n\n    //Save stats to a file\n    void save(string filename)\n    {\n        ofstream writefile;\n        writefile.open(filename);\n        writefile &lt;&lt; \"\\n\";\n        writefile &lt;&lt; \"===========================================================================\" &lt;&lt; \"\\n\" &lt;&lt; endl;\n        writefile &lt;&lt; \"To sort this data set of size \" &lt;&lt; dataset.size() &lt;&lt; \" using the bubblesort method took \" &lt;&lt; time1 &lt;&lt; \" ms.\" &lt;&lt; endl;\n        writefile &lt;&lt; \"To sort this data set of size \" &lt;&lt; dataset.size() &lt;&lt; \" using the mergesort method took \" &lt;&lt; time2 &lt;&lt; \" ms.\" &lt;&lt; endl;\n        writefile &lt;&lt; \"To sort this data set of size \" &lt;&lt; dataset.size() &lt;&lt; \" using the insert sort method took \" &lt;&lt; time3 &lt;&lt; \" ms.\" &lt;&lt; endl;\n        writefile &lt;&lt; \"===========================================================================\" &lt;&lt; \"\\n\" &lt;&lt; endl;\n        for(int i=0;i&lt;dataset.size();i++)\n        {\n            writefile &lt;&lt; dataset[i];\n            writefile &lt;&lt; ',';\n            }\n\n            dataset.clear();\n        }\n\n\n};\nvoid SortRandom();\nvoid SortBackwards();\nvoid Sort20Percent();\nvoid Sort30Percent();\n\n#endif // SORT_H\n</code></pre>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "is_accepted": false, "score": 1, "last_activity_date": 1536176838, "last_edit_date": 1536176838, "creation_date": 1536176354, "answer_id": 52192344, "question_id": 52192268, "link": "https://stackoverflow.com/questions/52192268/insert-into-container-of-container-if-new-or-append-to-existing/52192344#52192344", "title": "Insert into container of container if new or append to existing", "body": "<p>You can just use <a href=\"https://en.cppreference.com/w/cpp/container/map/operator_at\" rel=\"nofollow noreferrer\"><code>operator[]</code></a>.  It will return a reference to the object with the specified key if it is in the map, or if the lookup fails, it will create a new value-initialized object (an empty <code>vector</code> in your case) and return a reference to the new object.</p>\n\n<pre><code>id_values[key].push_back(val);\n</code></pre>\n\n<p>Alternatively, if you need to use different constructor arguments instead of default-constructing the mapped_type, you can use <a href=\"https://en.cppreference.com/w/cpp/container/map/try_emplace\" rel=\"nofollow noreferrer\"><code>try_emplace</code></a> (or regular <a href=\"https://en.cppreference.com/w/cpp/container/map/emplace\" rel=\"nofollow noreferrer\"><code>emplace</code></a> if you can't use C++17):</p>\n\n<pre><code>auto [itr, inserted] = id_values.try_emplace(key, vector_constructor_args...);\nitr-&gt;second.push_back(val);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536186373, "post_id": 52192463, "comment_id": 91338020, "body": "What is <code>map1</code> ? if it is a <code>std::map</code>, then <code>it</code> is misleading name, as it would be a <code>std::pair&lt;const Key, Value&gt;</code>. and your <code>it-&gt;first</code> invalid... and if <code>map2</code> is a <code>std::map</code>, <code>!map2.find(..)</code> is invalid, did you meant <code>map::count</code>, and your insertion with hint is suspicious."}, {"owner": {"reputation": 677, "user_id": 1418351, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7a7dba2123954dce6d12c48c0c74d785?s=128&d=identicon&r=PG", "display_name": "John_Sharp1318", "link": "https://stackoverflow.com/users/1418351/john-sharp1318"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536208506, "post_id": 52192463, "comment_id": 91342329, "body": "map1 is effectively a std::map and it is actually a cont std::pair&lt;cons std::string, std::vector&lt;double &gt; &gt;. You are right it-&gt; is invalid I edit the post accordingly. &#39;it&#39; have the same type as an typename std::map&lt;key,value&gt;::iterator::value_type. You can replace &#39;for(auto it: map1)&#39; by for(std::map&lt;std::string,std::vector&lt;double&gt; &gt;::const_iterator it = map1.begin(); it! = map1.end(); it++) in that &#39;first&#39; and &#39;second&#39; are easily accessible by -&gt; rather than."}, {"owner": {"reputation": 677, "user_id": 1418351, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7a7dba2123954dce6d12c48c0c74d785?s=128&d=identicon&r=PG", "display_name": "John_Sharp1318", "link": "https://stackoverflow.com/users/1418351/john-sharp1318"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536208565, "post_id": 52192463, "comment_id": 91342345, "body": "However map2.find is valid. You should take a look to c++ reference in order to have an idea about the existing methods of every containers."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536221258, "post_id": 52192463, "comment_id": 91347736, "body": "Better with edit (now your code should compile...), but still, add declarations of your variables as they doesn&#39;t match OP&#39;s ones. <code>auto it : map1</code> is misleading: <code>it</code> is <b>not</b> an iterator, as its name suggests; prefer <code>p</code> (as <code>pair</code>) or more meaningful name. Your <b>hint</b> for insertion will be most of the time wrong. <code>map2.insert(p);</code> should be enough. but anyway, you do 2 look-up instead of one. In addition <i>&quot;By using the <code>operator []</code>&quot;</i>, you don&#39;t use it."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536221395, "post_id": 52192463, "comment_id": 91347821, "body": "Moreover, I think your answer doesn&#39;t match with OP&#39;s question."}, {"owner": {"reputation": 677, "user_id": 1418351, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7a7dba2123954dce6d12c48c0c74d785?s=128&d=identicon&r=PG", "display_name": "John_Sharp1318", "link": "https://stackoverflow.com/users/1418351/john-sharp1318"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536229434, "post_id": 52192463, "comment_id": 91352719, "body": "My code after edit compiled :-). &#39;It&#39; is the result of the dereferencing of an iterator at the position. Yes effectively the name is a little bit misleading. But it is related to an iterator. Look at how range for loop works. you&#39;ll see that if map container doesn&#39;t had iteration or internal pointer accessor the range loop won&#39;t work. In your you specified that the insertion &#39;must be at the end&#39; that why I used the overloaded method of &#39;insert&#39; that take the position of insertion as argument."}], "tags": [], "owner": {"reputation": 677, "user_id": 1418351, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7a7dba2123954dce6d12c48c0c74d785?s=128&d=identicon&r=PG", "display_name": "John_Sharp1318", "link": "https://stackoverflow.com/users/1418351/john-sharp1318"}, "is_accepted": false, "score": -1, "last_activity_date": 1536209117, "last_edit_date": 1536209117, "creation_date": 1536176936, "answer_id": 52192463, "question_id": 52192268, "link": "https://stackoverflow.com/questions/52192268/insert-into-container-of-container-if-new-or-append-to-existing/52192463#52192463", "title": "Insert into container of container if new or append to existing", "body": "<p>Hello I think what you want to do is ether to insert an element in your container using the method <code>insert</code> or the <code>operator[]</code>.\nBy using the <code>operator []</code> what you want to do is simply:</p>\n\n<pre><code>for(auto it: map1)    \n  if(map2.find(it.first) == map2.end() )\n    map2.insert(map2.end(),it);\n</code></pre>\n"}], "owner": {"reputation": 903, "user_id": 5339398, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/dd9da7f9c11bf0f13cc812c55b37bf96?s=128&d=identicon&r=PG&f=1", "display_name": "Madden", "link": "https://stackoverflow.com/users/5339398/madden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536209117, "creation_date": 1536176088, "question_id": 52192268, "link": "https://stackoverflow.com/questions/52192268/insert-into-container-of-container-if-new-or-append-to-existing", "title": "Insert into container of container if new or append to existing", "body": "<p>I have a container that looks like this:</p>\n\n<pre><code>std::map&lt;std::string, std::vector&lt;double&gt;&gt; id_values;\n</code></pre>\n\n<p>I will iterate through other pairs of doubles and strings, and I want to add a new element to the map if it doesn't exist, or append to the vector if it does. Is there a more succinct solution than the following?</p>\n\n<pre><code>auto loc = id_values.find(key);\nif (loc != id_values.end()) {\n    loc-&gt;second.push_back(val);\n} else {\n    loc.insert({key, {val}});\n}\n</code></pre>\n\n<p>I suppose I could do a ternary operator but I feel that will make the code less readable, I'm more wondering if there is a better pattern for what I'm trying to achieve rather than conditional.</p>\n"}, {"tags": ["c++", "c++11", "condition-variable", "spurious-wakeup"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1536175931, "post_id": 52192203, "comment_id": 91334200, "body": "<code>1)</code> and <code>2)</code> are the same code. Did you mean to show something different?"}, {"owner": {"reputation": 75, "user_id": 5884110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a829d0d48297806ce33cf4eb73223163?s=128&d=identicon&r=PG&f=1", "display_name": "ImAUser", "link": "https://stackoverflow.com/users/5884110/imauser"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1536225250, "post_id": 52192203, "comment_id": 91350214, "body": "Yes, sorry, I just modified"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1603457478, "last_edit_date": 1603457478, "creation_date": 1536176916, "answer_id": 52192458, "question_id": 52192203, "link": "https://stackoverflow.com/questions/52192203/whats-the-correct-way-to-deal-with-spurious-wakeups-in-general/52192458#52192458", "title": "What&#39;s the correct way to deal with spurious wakeups, in general?", "body": "<p>The short answer is, your code may be correct or wrong; you didn't show exactly how <code>full</code> is manipulated.</p>\n<p>Individual bits of C++ code are never thread safe.  Thread safety is a <em>relational</em> property of code; two bits of code can be thread safe with respect to each other if they can never cause a race condition.</p>\n<p>But one bit of code is never thread safe; saying something is thread safe is like saying something is &quot;the same height&quot;.</p>\n<hr />\n<p>The &quot;monkey see monkey do&quot; condition variable pattern is this:</p>\n<pre><code>template&lt;class T&gt;\nclass cv_bundle {\n  std::mutex m;\n  T payload;\n  std::condition_variable cv;\npublic:\n  explicit cv_bundle( T in ):payload(std::move(in)) {}\n\n  template&lt;class Test, class Extract&gt;\n  auto wait( Test&amp;&amp; test, Extract&amp;&amp; extract ) {\n    std::unique_lock&lt;std::mutex&gt; l(m);\n    cv.wait( l, [&amp;]{ return test(payload); } );\n    return extract(payload);\n  }\n  template&lt;class Setter&gt;\n  void load( Setter&amp;&amp; setter, bool only_one = true ) {\n    std::unique_lock&lt;std::mutex&gt; l(m);\n    bool is_set = setter( payload );\n\n    if (!is_set) return; // nothing to notify\n    if (only_one)\n      cv.notify_one();\n    else\n      cv.notify_all();\n  }\n};\n</code></pre>\n<p><code>test</code> takes a <code>T&amp; payload</code> and returns true if there is something to consume (ie, the wakeup is not-spurious).</p>\n<p><code>extract</code> takes a <code>T&amp; payload</code> and returns whatever information you want from it.  It should reset the payload usually.</p>\n<p><code>setter</code> modifies the <code>T&amp; payload</code> in a way that <code>test</code> will return <code>true</code>.  If it does so, it returns <code>true</code>.  If it chooses not to, it returns <code>false</code>.</p>\n<p>All 3 get called within a mutex locking access to the <code>T payload</code>.</p>\n<p>Now, you can generate variations on this, but doing so is very hard to get right.  Do not, for example, assume an atomic payload means you don't have to lock a mutex.</p>\n<p>While I bundled these 3 things together, you could use a single mutex for a pile of condition variables, or use the mutex for more than just the condition variable.  The payload could be a bool, a counter, a vector of data, or something more alien; in general, it must always be protected by the mutex.  If it is atomic, during some point in the open interval between the value being modified and the notification the mutex must be locked, or you risk losing the notification.</p>\n<p>Manual loop control instead of passing in the lambda is a modification, but describing what kind of manual loops are legal and which are race conditions is a complex problem.</p>\n<p>In effect, I avoid leaving this monkey-see monkey-do &quot;cargo cult&quot; style of use of condition variables unless I have extremely good reason.  And then I am forced to read up on the C++ memory and threading model, which doesn't make my day, and it means my code is most likely not going to be correct.</p>\n<p>Note that if any of the lambdas passed in go and call back into <code>cv_bundle</code> the code I showed is no longer valid.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1536238706, "last_edit_date": 1536238706, "creation_date": 1536177196, "answer_id": 52192520, "question_id": 52192203, "link": "https://stackoverflow.com/questions/52192203/whats-the-correct-way-to-deal-with-spurious-wakeups-in-general/52192520#52192520", "title": "What&#39;s the correct way to deal with spurious wakeups, in general?", "body": "<p>Either 1 or 3 way is fine for dealing with spurious wakeups (assuming that <code>full</code> modification is protected by the same mutex) except you get predicate condition wrong, it should be:</p>\n\n<pre><code>unique_lock&lt;mutex&gt; ul(m); \ncv.wait(ul, [&amp;](){return full;});\n</code></pre>\n\n<p>to make this code equal to variant 1. </p>\n\n<p>Variant 2 is not fine though as on spurious wakeup wait condition would not be rechecked, unlike 2 other cases.</p>\n"}], "owner": {"reputation": 75, "user_id": 5884110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a829d0d48297806ce33cf4eb73223163?s=128&d=identicon&r=PG&f=1", "display_name": "ImAUser", "link": "https://stackoverflow.com/users/5884110/imauser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "accepted_answer_id": 52192458, "answer_count": 2, "score": 3, "last_activity_date": 1603457478, "creation_date": 1536175774, "last_edit_date": 1536225266, "question_id": 52192203, "link": "https://stackoverflow.com/questions/52192203/whats-the-correct-way-to-deal-with-spurious-wakeups-in-general", "title": "What&#39;s the correct way to deal with spurious wakeups, in general?", "body": "<p>Among the options below, is there any correct way to deal with spurious wakeups when using conditional variables? </p>\n\n<p>1) Put the <code>wait(unique_lock_ul)</code> into an infinite <code>while</code> loop, using a boolean</p>\n\n<pre><code>unique_lock&lt;mutex&gt; ul(m); \nwhile(!full)\n  cv.wait(ul);\n</code></pre>\n\n<p>2) Same with if</p>\n\n<pre><code>unique_lock&lt;mutex&gt; ul(m); \nif(!full)\n  cv.wait(ul);\n</code></pre>\n\n<p>3) Put a condition inside the <code>wait()</code>, for example by using lambda functions</p>\n\n<pre><code>unique_lock&lt;mutex&gt; ul(m); \ncv.wait(ul, [&amp;](){return !full;});\n</code></pre>\n\n<p>If none of this is correct, how does one deal with spurious wakeups easily?</p>\n\n<p>I'm rather new to conditional variables in C++ and I'm not sure if some of the code I read deals with the case of spurious wakeups or not.</p>\n"}, {"tags": ["c++", "string", "windows", "winapi", "registry"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1536175993, "post_id": 52192146, "comment_id": 91334224, "body": "Not related to your question, but I just <i>have</i> to say that &quot;ugly stuff like this is why I really <i>hate</i> writing Windows specific code&quot;. Gaah, the pain, it hurts."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1536176102, "post_id": 52192146, "comment_id": 91334274, "body": "Out of curiosity, gamepath[2] is what ? Any chance the encoding happens to be more than 8 bytes per char? (Not a Windows programmer)"}, {"owner": {"reputation": 532, "user_id": 1136512, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9daefbec8cdaf952907fa33f6492eb76?s=128&d=identicon&r=PG", "display_name": "bur", "link": "https://stackoverflow.com/users/1136512/bur"}, "edited": false, "score": 0, "creation_date": 1536176287, "post_id": 52192146, "comment_id": 91334349, "body": "It&#39;s a REG_SZ &quot;string value&quot;. I&#39;m new to this stuff so I don&#39;t know any more than that."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1536176779, "post_id": 52192146, "comment_id": 91334568, "body": "@bur please provide the output of  for(int x = 0; x &lt; MAX_PATH; x++){cout &lt;&lt; gamepath[x];}"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536181696, "post_id": 52192146, "comment_id": 91336566, "body": "@jes: You <i>have</i> to write code like that, <b>every time</b> you access a C API. Of course, you have the option to use abstractions. C++ suits itself well to condense that code into a single line of code. Do you not understand abstractions, or C++, to understand, that this <b>isn&#39;t</b> specific to Windows?"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1536245670, "post_id": 52192527, "comment_id": 91362955, "body": "&quot;<i>The hint is that you needed a type cast for that parameter, it shouldn&#39;t be necessary</i>&quot; - actually it is, even if <code>gamePath</code> where declared as <code>wchar_t[]</code> instead. That parameter expects a <code>BYTE*</code> pointer, since <code>RegQueryValueEx()</code> can read binary data. The <i>real</i> hint is that <i>other</i> parameters are passing in <code>wchar_t</code> strings"}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1536247755, "post_id": 52192527, "comment_id": 91364294, "body": "@RemyLebeau good catch. I&#39;m so used to seeing unnecessary casts as a red flag that I assumed this was another instance. I&#39;ll modify the answer."}], "tags": [], "owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": true, "score": 0, "last_activity_date": 1536248116, "last_edit_date": 1536248116, "creation_date": 1536177227, "answer_id": 52192527, "question_id": 52192146, "link": "https://stackoverflow.com/questions/52192146/c-getting-registry-value-only-gives-first-character/52192527#52192527", "title": "C++: Getting registry value only gives first character", "body": "<p>You have an array of <code>char</code> but <code>RegQueryValueEx</code> requires an array of <code>wchar_t</code> in a wide-character build. Most programs today will be wide-character applications, but you can use the Microsoft-defined constant <code>TCHAR</code> instead of <code>char</code> or <code>wchar_t</code> if you're unsure.</p>\n\n<p>The reason you only get a single character is because the first character has a value between 1 and 255. The high byte of such a 16-bit character code is zero, so in memory it looks like a string terminator.</p>\n"}], "owner": {"reputation": 532, "user_id": 1136512, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9daefbec8cdaf952907fa33f6492eb76?s=128&d=identicon&r=PG", "display_name": "bur", "link": "https://stackoverflow.com/users/1136512/bur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "closed_date": 1536181923, "accepted_answer_id": 52192527, "answer_count": 1, "score": -1, "last_activity_date": 1536248116, "creation_date": 1536175517, "last_edit_date": 1536223202, "question_id": 52192146, "link": "https://stackoverflow.com/questions/52192146/c-getting-registry-value-only-gives-first-character", "closed_reason": "Duplicate", "title": "C++: Getting registry value only gives first character", "body": "<p>I'm trying to get a string value from the registry, but I'm only getting the first letter.</p>\n\n<pre><code>HKEY hKey;\nchar gamePath[MAX_PATH];\nif(RegOpenKeyEx(HKEY_CURRENT_USER,L\"Software\\\\Blizzard Entertainment\\\\Warcraft III\",0,KEY_READ,&amp;hKey) == ERROR_SUCCESS)\n{\n   DWORD type=REG_SZ, size=MAX_PATH;\n   int error = RegQueryValueEx(hKey,L\"GamePath\",NULL,&amp;type,(LPBYTE)&amp;gamePath,&amp;size);\n   if(error != ERROR_SUCCESS)\n       cout &lt;&lt; \"Failed to read registry value: \" &lt;&lt; error &lt;&lt; endl;\n\n   RegCloseKey(hKey);\n}\nelse cout &lt;&lt; \"Failed to read registry key.\" &lt;&lt; endl;\n\ncout &lt;&lt; gamePath &lt;&lt; endl; //output: C\n</code></pre>\n\n<p>What am I doing wrong? Thanks.</p>\n"}, {"tags": ["python", "c++", "python-3.x", "c++11", "c++14"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1536175283, "post_id": 52191948, "comment_id": 91333908, "body": "&quot;I&#39;d like to expose some of the private members of Scenario to Python scripts -- without using the explicit getter/setter functions:&quot; - <i>Why</i>? Why wouldn&#39;t you want to use the getter functions to get data from the object? That makes no sense to me."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1536176399, "post_id": 52191948, "comment_id": 91334401, "body": "@JesperJuhl: Presumably they&#39;re trying to take advantage of <code>PyMemberDef</code>&#39;s ability to generate accessors for simple values for them, rather than having to write custom functions for use with the somewhat more complicated/powerful <code>PyGetSetDef</code> approach to accessors. CPython is mostly C++-blind, so it can&#39;t use member functions directly, meaning they&#39;d have to write wrappers to call the member function."}, {"owner": {"reputation": 2357, "user_id": 1747834, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cea2583950ba41bcbbac8c8705ec1965?s=128&d=identicon&r=PG", "display_name": "Mikhail T.", "link": "https://stackoverflow.com/users/1747834/mikhail-t"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1536179630, "post_id": 52191948, "comment_id": 91335752, "body": "Thank you, @ShadowRanger. That&#39;s correct - I want the speed and the simplicity of direct access to the fields of standard scalar types, yes."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1536184311, "post_id": 52191948, "comment_id": 91337450, "body": "@MikhailT.: I&#39;ll note, while it&#39;s obviously more complex to write the <code>GetSet</code> descriptors vs. the <code>Member</code>, speed-wise, they should be roughly equivalent; <code>Member</code>s are just a special case of descriptors where the accessor functions are written for you; they&#39;re not faster in general (except possibly by an accident of using shared hot code paths)."}], "answers": [{"comments": [{"owner": {"reputation": 2357, "user_id": 1747834, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cea2583950ba41bcbbac8c8705ec1965?s=128&d=identicon&r=PG", "display_name": "Mikhail T.", "link": "https://stackoverflow.com/users/1747834/mikhail-t"}, "edited": false, "score": 0, "creation_date": 1536194413, "post_id": 52194876, "comment_id": 91339578, "body": "Well, this would likely work, but the <a href=\"https://en.cppreference.com/w/cpp/language/friend\" rel=\"nofollow noreferrer\">C++ manual</a> claims, beginning with C++11 (which I use), types can already be &quot;friends&quot; -- not just functions/classes... Am I misreading it?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 2357, "user_id": 1747834, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cea2583950ba41bcbbac8c8705ec1965?s=128&d=identicon&r=PG", "display_name": "Mikhail T.", "link": "https://stackoverflow.com/users/1747834/mikhail-t"}, "edited": false, "score": 0, "creation_date": 1536198433, "post_id": 52194876, "comment_id": 91340340, "body": "@MikhailT.: &quot;<i>types can already be &quot;friends&quot; -- not just functions/classes...</i>&quot; Classes <i>are</i> types. And no, you can&#39;t declare <code>int</code> a friend. And my point is that friendship and access is about where the code the code that&#39;s accessing the member is. Code in a braced-init-list does not gain any additional rights to access members of a type. Code inside of a function gains the access rights of the function. Code inside a class definition gains the access rights of the class. Code in a braced-init-list has the access rights of the location where that code lives, nothing more."}, {"owner": {"reputation": 2357, "user_id": 1747834, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cea2583950ba41bcbbac8c8705ec1965?s=128&d=identicon&r=PG", "display_name": "Mikhail T.", "link": "https://stackoverflow.com/users/1747834/mikhail-t"}, "edited": false, "score": 0, "creation_date": 1536202482, "post_id": 52194876, "comment_id": 91341158, "body": "But then, what does the 4th section <a href=\"https://en.cppreference.com/w/cpp/language/friend\" rel=\"nofollow noreferrer\">here</a> mean? I thought, by declaring the <code>PyMemberDef</code> a friend, I&#39;m allowing exactly the usage I&#39;m trying for..."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 2357, "user_id": 1747834, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cea2583950ba41bcbbac8c8705ec1965?s=128&d=identicon&r=PG", "display_name": "Mikhail T.", "link": "https://stackoverflow.com/users/1747834/mikhail-t"}, "edited": false, "score": 1, "creation_date": 1536203459, "post_id": 52194876, "comment_id": 91341366, "body": "@MikhailT.: <code>friend T;</code> is merely shorthand for <code>friend class&#47;struct&#47;union T;</code>, as clearly stated in that section. My point is this: if <code>X</code> is a friend of <code>Y</code>, that means that the members and definitions <i>within <code>X</code></i> can access <code>Y</code>&#39;s privates. An initializer that is applied to an object of type <code>X</code> is not &quot;within <code>X</code>&quot; and therefore doesn&#39;t count."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 1, "last_activity_date": 1536193116, "creation_date": 1536193116, "answer_id": 52194876, "question_id": 52191948, "link": "https://stackoverflow.com/questions/52191948/how-to-get-offsetof-a-private-class-member/52194876#52194876", "title": "How to get offsetof() a private class-member?", "body": "<p>The fundamental problem with what you're doing is that the initializer for a (presumably) global variable is in the global context. The initializer is not a part of a class nor a component of a function, so it can't be the friend of anything.</p>\n\n<p>You should make the variable a function-<code>static</code> variable. And the function that contains the variable can be the friend of the class.</p>\n\n<pre><code>PyMemberDef *PyMemberInitializers()\n{\n    static PyMemberDef scenarioMembers[] {\n        {\n            (char *)\"a\",\n            T_DOUBLE, offsetof(PyScenario, scen._a),\n            \"The a\"\n        },\n        {\n            (char *)\"b\",\n            T_INT, offsetof(PyScenario, scen._b),\n            \"The b\"\n        },\n        NULL\n    };\n\n    return scenarioMembers;\n}\n</code></pre>\n"}], "owner": {"reputation": 2357, "user_id": 1747834, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cea2583950ba41bcbbac8c8705ec1965?s=128&d=identicon&r=PG", "display_name": "Mikhail T.", "link": "https://stackoverflow.com/users/1747834/mikhail-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "accepted_answer_id": 52194876, "answer_count": 1, "score": 0, "last_activity_date": 1536193116, "creation_date": 1536174639, "question_id": 52191948, "link": "https://stackoverflow.com/questions/52191948/how-to-get-offsetof-a-private-class-member", "title": "How to get offsetof() a private class-member?", "body": "<p>I have a C++ class (<code>Scenario</code>) wrapped in a Python type:</p>\n\n<pre><code>struct PyScenario {\n    PyObject_HEAD\n    Scenario scen;\n};\n</code></pre>\n\n<p>I'd like to expose some of the private members of <code>Scenario</code> to Python scripts -- without using the explicit getter/setter functions:</p>\n\n<pre><code>static PyMemberDef scenarioMembers[] {\n    {\n        (char *)\"a\",\n        T_DOUBLE, offsetof(PyScenario, scen._a),\n        \"The a\"\n    },\n    {\n        (char *)\"b\",\n        T_INT, offsetof(PyScenario, scen._b),\n        \"The b\"\n    },\n    NULL\n};\n</code></pre>\n\n<p>Unfortunately, when I compile the above, I get an error like: <code>'double Scenario::_a' is private within this context</code>.</p>\n\n<p>I don't want to make the <code>_a</code> and <code>_b</code> public, so I tried declaring the <code>PyMemberDef</code> a <code>friend</code> of <code>Scenario</code>:</p>\n\n<pre><code>class Scenario {\n#ifdef PY_MAJOR_VERSION\n    friend   struct PyMemberDef;\n#endif\nprivate:\n    double   _a;\n    int      _b;\n    ....\n};\n</code></pre>\n\n<p>Unfortunately, that didn't help... What's the right way?</p>\n"}, {"tags": ["c++", "gcc", "clang", "language-lawyer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536175959, "post_id": 52191903, "comment_id": 91334213, "body": "I&#39;ve rolled back the edit you made to add the answer into the Q as that is not where it belongs."}], "answers": [{"comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1536175440, "post_id": 52191964, "comment_id": 91333991, "body": "Would you want to be my <code>friend</code>?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1536176359, "post_id": 52191964, "comment_id": 91334382, "body": "@Barry probably won&#39;t let you access his private parts regardless if you are a <code>friend</code> or not."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1536175327, "last_edit_date": 1536175327, "creation_date": 1536174710, "answer_id": 52191964, "question_id": 52191903, "link": "https://stackoverflow.com/questions/52191903/accessing-protected-type-in-a-class-through-a-friend-gcc-allows-clang-doesnt/52191964#52191964", "title": "Accessing protected type in a class through a friend - gcc allows, clang doesn&#39;t", "body": "<p>clang is right. Note that gcc has <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=59002\" rel=\"nofollow noreferrer\">many bugs</a> with access checking in templates. </p>\n\n<p><code>Impl</code> is a protected member of <code>A</code>, <code>WrapperBuilder&lt;A&gt;</code> neither derives from <code>A</code> nor is it a <code>friend</code> of <code>A</code>.</p>\n\n<p><code>LetMeIn</code> does not bestow friendship in a relevant way. The explicit template instantiation makes <code>WrapperBuilder&lt;A&gt;</code> a <code>friend</code> of <code>LetMeIn&lt;A&gt;</code>, but friendship isn't transitive - that does not make it a <code>friend</code> of <code>A</code>. </p>\n\n<hr />\n\n<p><code>LetMinIn&lt;A&gt;::Impl</code> works... but very indirectly. You could do it more directly if you want:</p>\n\n<pre><code>struct LetMeIn : A {\n    using Impl = A::Impl;\n};\n</code></pre>\n\n<p>And now it's public. </p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1536175269, "creation_date": 1536175269, "answer_id": 52192084, "question_id": 52191903, "link": "https://stackoverflow.com/questions/52191903/accessing-protected-type-in-a-class-through-a-friend-gcc-allows-clang-doesnt/52192084#52192084", "title": "Accessing protected type in a class through a friend - gcc allows, clang doesn&#39;t", "body": "<p>Clang has it right here.  When you do</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct LetMeIn : public T {\n    friend struct WrapperBuilder&lt;T&gt;;\n};\n</code></pre>\n\n<p><code>WrapperBuilder&lt;T&gt;</code> becomes a friend of <code>LetMeIn&lt;T&gt;</code>.  That means <code>WrapperBuilder&lt;T&gt;</code> can access anything in <code>LetMeIn&lt;T&gt;</code>.  Since <code>LetMeIn&lt;T&gt;</code> inherits from <code>T</code> it also means that <code>WrapperBuilder&lt;T&gt;</code> can access the <code>T</code> part of <code>LetMeIn&lt;T&gt;</code> that <code>LetMeIn&lt;T&gt;</code> has access to.  It does not mean that <code>WrapperBuilder&lt;T&gt;</code> becomes a friend of <code>T</code></p>\n\n<p>To show this</p>\n\n<pre><code>template&lt;&gt;\nstruct WrapperBuilder&lt;A&gt; {\n\n   LetMeIn&lt;A&gt;::Impl* foo;\n\n};\n</code></pre>\n\n<p>Compiles in both clang and gcc since <code>WrapperBuilder&lt;A&gt;</code> can access <code>LetMeIn&lt;A&gt;</code> members.</p>\n"}], "owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 52191964, "answer_count": 2, "score": 3, "last_activity_date": 1536175921, "creation_date": 1536174378, "last_edit_date": 1536175921, "question_id": 52191903, "link": "https://stackoverflow.com/questions/52191903/accessing-protected-type-in-a-class-through-a-friend-gcc-allows-clang-doesnt", "title": "Accessing protected type in a class through a friend - gcc allows, clang doesn&#39;t", "body": "<p>Which compiler is right - or is this a defect in the standard?</p>\n\n<p>GCC compiles the following code, but clang complains:</p>\n\n<pre><code>&lt;source&gt;:20:7: error: 'Impl' is a protected member of 'A'\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct WrapperBuilder;\n\ntemplate &lt;typename T&gt;\nstruct LetMeIn : public T {\n    friend struct WrapperBuilder&lt;T&gt;;\n};\n\nclass A {\nprotected:\n    struct Impl;\n};\n\n// without this line, gcc complains too (but I think I understand why)\nextern template struct LetMeIn&lt;A&gt;;\n\ntemplate&lt;&gt;\nstruct WrapperBuilder&lt;A&gt; {\n\n   A::Impl * i; // Clang doesn't like this line\n};\n</code></pre>\n\n<p>Thank you.</p>\n\n<p><a href=\"https://godbolt.org/z/Qa7zZ6\" rel=\"nofollow noreferrer\">https://godbolt.org/z/Qa7zZ6</a></p>\n\n<p>Also, anyone know a workaround for clang that doesn't involve changing <code>A</code>?</p>\n"}, {"tags": ["c++", "nlohmann-json"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536173037, "post_id": 52191576, "comment_id": 91332915, "body": "&quot;But it would be nice if get had an overload taking a reference as an argument&quot; - why do you not get in touch with the library author then and suggest that. Maybe even contribute a patch. ?"}], "answers": [{"comments": [{"owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "edited": false, "score": 0, "creation_date": 1536174673, "post_id": 52191841, "comment_id": 91333628, "body": "Well, it doesn&#39;t seem to always work. You commented on another related <a href=\"https://stackoverflow.com/q/50881469/2640636\">question</a> I asked a couple months ago."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "edited": false, "score": 0, "creation_date": 1536174813, "post_id": 52191841, "comment_id": 91333690, "body": "@SU3 When it doesn&#39;t work, it&#39;s because it can&#39;t determine which <code>ValueType</code> to deduce for the templated conversion operator. It could convert to multiple different types, so it&#39;s ambiguous."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "edited": false, "score": 0, "creation_date": 1536174938, "post_id": 52191841, "comment_id": 91333749, "body": "@SU3 It worked fine on Godbolt but not on your machine because you need to update nlohmann json. Select an older version of nlohmann json and you can see the same error (you removed that part of your comment, just want to be clear why it happened)."}, {"owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "edited": false, "score": 0, "creation_date": 1536175079, "post_id": 52191841, "comment_id": 91333814, "body": "I removed that part because I noticed that there were still warnings."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "edited": false, "score": 0, "creation_date": 1536175306, "post_id": 52191841, "comment_id": 91333916, "body": "@SU3 That is... peculiar. Indeed there is apparently a warning (but it looks a lot like an error), but it&#39;s just giving us the stack trace instead of any diagnostic. That&#39;s probably a GCC bug (would want to verify it offline to be sure). Clang rejects it with a more reasonable error message (<a href=\"https://godbolt.org/z/AGTc8T\" rel=\"nofollow noreferrer\">godbolt.org/z/AGTc8T</a>)"}, {"owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "edited": false, "score": 0, "creation_date": 1536175681, "post_id": 52191841, "comment_id": 91334085, "body": "<code>GCC 7.2.0</code> gives an error with <code>-std=c++14</code> (that&#39;s what I normally use for compatibility reasons with other libraries) and the same warnings as Godbolt with <code>-std=c++17</code>."}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": false, "score": 2, "last_activity_date": 1536174117, "creation_date": 1536174117, "answer_id": 52191841, "question_id": 52191576, "link": "https://stackoverflow.com/questions/52191576/nlohmann-json-get-with-type-deduction/52191841#52191841", "title": "Nlohmann json get with type deduction", "body": "<blockquote>\n  <p>However, <code>type x; x = json;</code> doesn't work</p>\n</blockquote>\n\n<p>It actually does work. The <code>basic_json</code> type <a href=\"https://github.com/nlohmann/json/blob/d713727f2277f2eb919a2dbbfdd534f8988aa493/single_include/nlohmann/json.hpp#L13945\" rel=\"nofollow noreferrer\">has a templated conversion operator</a> which just calls <code>get&lt;T&gt;()</code> for you. The following code <a href=\"https://godbolt.org/z/bamKvC\" rel=\"nofollow noreferrer\">compiles just fine</a>:</p>\n\n<pre><code>#include &lt;nlohmann/json.hpp&gt;\n\nusing nlohmann::json;\n\nnamespace ns {\n    struct MyType {\n        int i;\n    };\n\n    void to_json(json&amp; j, MyType m) {\n        j = json{{\"i\", m.i}};\n    }\n\n    void from_json(json const&amp; j, MyType&amp; m) {\n        m.i = j.at(\"i\");\n    }\n}\n\nint main() {\n    json j{{\"i\", 42}};\n    ns::MyType type;\n    type = j;\n}\n</code></pre>\n"}], "owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538287182, "creation_date": 1536172845, "last_edit_date": 1538287182, "question_id": 52191576, "link": "https://stackoverflow.com/questions/52191576/nlohmann-json-get-with-type-deduction", "title": "Nlohmann json get with type deduction", "body": "<p>With <a href=\"https://github.com/nlohmann/json/\" rel=\"nofollow noreferrer\"><code>nlohmann::json</code></a> an object can be parsed using a couple different expressions:</p>\n\n<ol>\n<li><code>type x = json;</code></li>\n<li><code>type x; x = json.get&lt;type&gt;();</code></li>\n</ol>\n\n<p>However, <code>type x; x = json;</code> doesn't work, because that would require adding a new assignment operator for <code>type</code>.</p>\n\n<p>I find myself needing to use expression (2) more often then expression (1). This can get quite annoying, especially if <code>type</code> is something complicated.\nIn a few cases, I defined</p>\n\n<pre><code>template &lt;typename U&gt;\nvoid convert(const json&amp; j, U&amp; x) { x = j.get&lt;U&gt;(); }\n</code></pre>\n\n<p>But it would be nice if <code>get</code> had an overload taking a reference as an argument, so that the following would be possible.</p>\n\n<pre><code>type x;\njson.get(x);\n</code></pre>\n\n<p>Is there already a function that does that, that just has a different name? I couldn't find one in the documentation.</p>\n\n<p><strong>Edit</strong>: I've submitted an <a href=\"https://github.com/nlohmann/json/issues/1227\" rel=\"nofollow noreferrer\">issue</a> on GitHub.</p>\n\n<p><strong>Edit 2</strong>: An alternative to the <code>get</code> function, <code>T&amp; get_to(T&amp;)</code>, will be included in release 3.3.0.</p>\n"}, {"tags": ["c++", "c-preprocessor", "language-lawyer"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 8, "creation_date": 1536172610, "post_id": 52191496, "comment_id": 91332750, "body": "Any time you see the term <code>pragma</code> it usually means what comes next is non-Standard. It might appear in multiple toolchains, but you can&#39;t expect it in all or without differences."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1536172674, "post_id": 52191496, "comment_id": 91332777, "body": "Macro push and pop is not standard C++."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 3, "creation_date": 1536172716, "post_id": 52191496, "comment_id": 91332798, "body": "Try to find solutions to problems that <i>do NOT</i> involve macros."}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1536172994, "post_id": 52191496, "comment_id": 91332900, "body": "@user4581301 I see, so even though <code>_Pragma</code> keyword is standardized, how the program interprets the contents is not?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1536173088, "post_id": 52191496, "comment_id": 91332936, "body": "Documentation for <code>pragma</code> and <code>_Pragma</code>: <a href=\"https://en.cppreference.com/w/cpp/preprocessor/impl\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/preprocessor/impl</a> Key concepts: <i>The ISO C++ language standard does not require the compilers to support any pragmas</i> and <i>Any pragma that is not recognized is ignored.</i>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1536175808, "post_id": 52191496, "comment_id": 91334148, "body": "While macros have their application (less in C++ than in C), this looks like you are already past the gate to macro-hell. Whatever you try to accomplish: stop here, two steps back and sleep over it. Then rethink your system architecture."}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1536179662, "post_id": 52191496, "comment_id": 91335762, "body": "@toohonestforthissite funnily enough, the document I have with that code is called <code>macro_hell.cpp</code>"}], "answers": [{"tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 2, "last_activity_date": 1536183428, "last_edit_date": 1536183428, "creation_date": 1536176354, "answer_id": 52192343, "question_id": 52191496, "link": "https://stackoverflow.com/questions/52191496/what-is-the-behavior-when-pushing-popping-a-macro-inside-that-macro-definition-a/52192343#52192343", "title": "What is the behavior when pushing/popping a macro inside that macro definition according to c++ standard", "body": "<blockquote>\n  <p>What is the behavior when pushing/popping a macro inside that macro definition according to c++ standard?</p>\n</blockquote>\n\n<p>In both the C and C++ the result of <code>#pragma</code> and <code>_Pragma</code> are implementation defined, so the standard does not govern their behavior. See C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.6p1\" rel=\"nofollow noreferrer\">6.10.6p1</a>:</p>\n\n<blockquote>\n  <p>A preprocessing directive of the form</p>\n\n<pre><code> # pragma pp-tokensopt new-line\n</code></pre>\n  \n  <p>where the preprocessing token STDC does not immediately follow pragma in the directive (prior to any macro replacement)174) <strong>causes the implementation to behave in an implementation-defined manner.</strong> The behavior might cause translation to fail or cause the translator or the resulting program to behave in a non-conforming manner. Any such pragma that is not recognized by the implementation is ignored. </p>\n</blockquote>\n\n<p>and <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.9\" rel=\"nofollow noreferrer\">6.10.9</a> covers <code>_Pragma</code>.</p>\n\n<p>and the latest C++ draft <a href=\"http://eel.is/c++draft/cpp#pragma\" rel=\"nofollow noreferrer\">[cpp.pragma]</a>:</p>\n\n<blockquote>\n  <p>A preprocessing directive of the form</p>\n\n<pre><code># pragma pp-tokensopt new-line\n</code></pre>\n  \n  <p><strong>causes the implementation to behave in an implementation-defined manner.*</strong>\n  The behavior might cause translation to fail or cause the translator or the resulting program to behave in a non-conforming manner.\n  Any pragma that is not recognized by the implementation is ignored.</p>\n</blockquote>\n\n<p>and also see <a href=\"http://eel.is/c++draft/cpp#pragma.op\" rel=\"nofollow noreferrer\">[cpp.pragma.op]</a></p>\n\n<p>None of the documentation for these pragams from <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.4.0/gcc/Push_002fPop-Macro-Pragmas.html\" rel=\"nofollow noreferrer\">gcc</a> or <a href=\"https://docs.microsoft.com/en-us/cpp/preprocessor/pop-macro?view=vs-2017\" rel=\"nofollow noreferrer\">MSVC</a> seem to be very detailed. So they don't offer much in the way of guidance.</p>\n"}], "owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 52192343, "answer_count": 1, "score": 0, "last_activity_date": 1536183428, "creation_date": 1536172480, "last_edit_date": 1536175655, "question_id": 52191496, "link": "https://stackoverflow.com/questions/52191496/what-is-the-behavior-when-pushing-popping-a-macro-inside-that-macro-definition-a", "title": "What is the behavior when pushing/popping a macro inside that macro definition according to c++ standard", "body": "<p>I answered a question a while ago about appending to C macros \nat <a href=\"https://stackoverflow.com/questions/4550075/can-i-append-to-a-preprocessor-macro/45761452#45761452\">Can I append to a preprocessor macro?</a></p>\n\n<p>As the answer says, the following works in both clang and g++, but not in msvc</p>\n\n<pre><code>#define pushfoo _Pragma(\"push_macro(\\\"foo\\\")\") //for convenience\n#define popfoo _Pragma(\"pop_macro(\\\"foo\\\")\") //I tried __pragma and __Pragma for msvc as well\n\n#define foo 1\n\npushfoo                           //push the old value\n#undef foo                        //so you don't get a warning on the next line\n#define foo popfoo foo , 2        //append to the previous value of foo\n\npushfoo\n#undef foo\n#define foo popfoo foo , 3\n\npushfoo\n#undef foo\n#define foo popfoo foo , 4\n\n\nfoo //this whole list will expand to something like popfoo foo popfoo foo popfoo foo , 4\n    //which will in turn expand to 1 , 2 , 3 , 4\n\nfoo //the second time this will expand to just 1\n</code></pre>\n\n<p>While this does seem to work, I want to know if this is just something that happens to work out for gcc\nand clang, but msvc is also (or only) correct, or if the behavior they exhibit is the behavior mandated\nby the language specification. I am interested in both C and C++ if they differ (mostly interested in the\nnewest editions, C18 and C++17 at the time of writing)</p>\n"}, {"tags": ["c++", "c++11", "comparison"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1536172248, "post_id": 52191326, "comment_id": 91332591, "body": "A term I&#39;ve heard for this case is a <i>projection</i> (would look like <code>sort(students.begin(), students.end(), &amp;student::id)</code>). The standard library doesn&#39;t support it"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536172558, "post_id": 52191326, "comment_id": 91332723, "body": "With C++14 you can reduce the pain <i>a bit</i> by changing <code>[](const student&amp; l, const student&amp; r)</code> to <code>[](const auto&amp; l, const auto&amp; r)</code>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536172936, "post_id": 52191326, "comment_id": 91332878, "body": "@JesperJuhl - yup, good point, it reduces the declaration boilerplate, but it doesn&#39;t get rid of the main problems that I see: you still need to declare both left and right, and implement the comparison logic yourself. Since comparison functions are generally symmetric in their arguments, the first seems redundant. Implementing the &quot;logic&quot; yourself isn&#39;t too bad when it&#39;s just <code>l.f &lt; r.f</code>, but consider if you wanted to compare on two fields, then you are left writing some abomination like <code>l.f1 &lt; r.f1 || (l.f1 == r.f1 &amp;&amp; l.f2 &lt; r.f2)</code> etc."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1536172956, "post_id": 52191326, "comment_id": 91332885, "body": "Related: <a href=\"https://codereview.stackexchange.com/q/169887\">codereview.stackexchange.com/q/169887</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1536174910, "post_id": 52191326, "comment_id": 91333733, "body": "@BeeOnRope I wasn&#39;t trying to solve the entire problem. Just the easy bit ;-)"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536175276, "post_id": 52191326, "comment_id": 91333906, "body": "@Jesper - thanks makes sense! As it turns out it&#39;s actually the hard bit for me as I&#39;m stuck on c++11 at the moment."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1536342476, "post_id": 52191326, "comment_id": 91404176, "body": "@BeeOnRope: <code>std::tie</code> might help with several members: <code>return std::tie(l.f1, l.f2) &lt; std::tie(r.f1, r.f2);</code> and you might even write lambda/function <code>as_tuple</code> to avoid to repeat <code>.f1, .f2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1536172502, "post_id": 52191459, "comment_id": 91332697, "body": "Consider using <code>std::invoke</code> to call <code>get</code>, which would make this possible: <code>std::sort(students.begin(), students.end(), compare_on(&amp;student::id))</code>. In C++11, there are <a href=\"https://stackoverflow.com/q/32918679/1896169\">alternatives</a>"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1536172629, "post_id": 52191459, "comment_id": 91332757, "body": "Thanks. It seems like this would be easy to extend, e.g., by passing N rather than 1 extractor method and internally implementing the &quot;lexicographic&quot; comparison <code>get1(lhs) &lt; get1(rhs) || (get1(lhs) == get1(rhs) &amp;&amp; get2(rhs) &lt; get2(rhs) ...)</code> too. Yes, I agree that in principle the comparison operator itself shouldn&#39;t be hardcoded to <code>&lt;</code> but also be a template parameter, perhaps defaulting to <code>std::less</code>."}, {"owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1536173354, "post_id": 52191459, "comment_id": 91333037, "body": "@BeeOnRope The class itself does&#39;t need to be extended to achive that, instead pass a lamdba that returns a tuple: <code>compare_on([](const student&amp; s){ return std::make_tuple(s.id, s.name); })</code>."}], "tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": false, "score": 4, "last_activity_date": 1536173099, "last_edit_date": 1536173099, "creation_date": 1536172339, "answer_id": 52191459, "question_id": 52191326, "link": "https://stackoverflow.com/questions/52191326/shortcut-for-creating-a-comparator-based-on-a-member-field-or-function/52191459#52191459", "title": "Shortcut for creating a comparator based on a member field or function", "body": "<p>You can define a utility class</p>\n\n<pre><code>template &lt;class Fct&gt; class compare_on {\n  public:\n    compare_on(Fct&amp;&amp; get) : get(std::forward&lt;Fct&gt;(get)) {}\n\n    template &lt;class T&gt; bool operator()(const T&amp; lhs, const T&amp; rhs)\n    {\n       return get(lhs) &lt; get(rhs);\n    }\n\n  private:\n    Fct get;\n};\n</code></pre>\n\n<p>and then pass it to <code>std::sort</code> just like you depicted it (using C++17 class template argument deduction)</p>\n\n<pre><code>std::sort(students.begin(), students.end(),\n    compare_on([](const student&amp; s){ return s.id; }));\n</code></pre>\n\n<p>As of C++17, @Justin pointed out int the comments that the actual comparison can be improved (with <code>#include &lt;functional&gt;</code>) such that</p>\n\n<pre><code>return std::invoke(get, lhs) &lt; std::invoke(get, rhs);\n</code></pre>\n\n<p>which allows for an instantiation with data member references:</p>\n\n<pre><code>std::sort(students.begin(), students.end(), compare_on(&amp;student::id));\n</code></pre>\n\n<p>When bound to C++11, forget about <code>std::invoke</code> and go with an explicit instantiation of <code>compare_on</code>. The latter isn't suitable for lambdas, hence the usual argument-deduction <code>make_*</code> helper:</p>\n\n<pre><code>template &lt;class Fct&gt; auto make_compare_on(Fct&amp;&amp; get)\n    -&gt; decltype(compare_on&lt;Fct&gt;(std::forward&lt;Fct&gt;(get)))\n{\n    return compare_on&lt;Fct&gt;(std::forward&lt;Fct&gt;(get));\n}\n</code></pre>\n\n<p>Note that you can remove the trailing return type in C++14.</p>\n\n<p>As a final note, the naming here should be improved: <code>compare_on</code> is misleading, as it hides what the function object really does - comparing by <code>operator &lt;</code>. Maybe <code>compare_less_then</code> or something similar would be better, or adding another template parameter that can be specified as one of the standard predicates (<code>std::less</code> etc.).</p>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1536173132, "post_id": 52191534, "comment_id": 91332952, "body": "Similar to Justin&#39;s comment on the other answer (and, in fact, for the inverse reason), use <code>invoke()</code> instead of explicitly mandating a pointer to member data (this solution wouldn&#39;t even allow a pointer to member function, much less an arbitrary operation)."}], "tags": [], "owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "is_accepted": false, "score": 3, "last_activity_date": 1536173393, "last_edit_date": 1536173393, "creation_date": 1536172633, "answer_id": 52191534, "question_id": 52191326, "link": "https://stackoverflow.com/questions/52191326/shortcut-for-creating-a-comparator-based-on-a-member-field-or-function/52191534#52191534", "title": "Shortcut for creating a comparator based on a member field or function", "body": "<p>With Your suggestion I propose such <code>compare_on</code>:</p>\n\n<pre><code>template&lt;class T&gt;\nauto compare_on(T &amp;&amp;t){\n    return [t](const auto &amp;l, const auto &amp;r){\n        return l.*t &lt; r.*t; \n    };\n}\n... \nstd::sort(students.begin(), students.end(), compare_on(&amp;student::id));\n</code></pre>\n\n<p>It requires C++14. It uses pointer to member to get exactly the behaviour You asked for.</p>\n\n<p>In C++11, using similar idea it would look like this:</p>\n\n<pre><code>template&lt;class U&gt;\nclass comparison{\npublic:\n    comparison(const U &amp;ptr) : memberPtr(ptr){}\n\n    template&lt;class T&gt;\n    int operator()(const T &amp;l, const T &amp;r){\n        return l.*memberPtr &lt; r.*memberPtr;\n    }\n\nprivate:\n    U memberPtr;\n};\n\ntemplate&lt;class T&gt;\ncomparison&lt;T&gt; compare_on(T &amp;&amp;t){\n    return comparison&lt;T&gt;(std::forward&lt;T&gt;(t));\n}\n</code></pre>\n\n<p>As @Barry suggests, You should replace all the <code>l.*t</code> with <code>std::invoke(t, l)</code> to make it more generic in C++17.</p>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 7, "last_activity_date": 1536174372, "last_edit_date": 1536174372, "creation_date": 1536173704, "answer_id": 52191770, "question_id": 52191326, "link": "https://stackoverflow.com/questions/52191326/shortcut-for-creating-a-comparator-based-on-a-member-field-or-function/52191770#52191770", "title": "Shortcut for creating a comparator based on a member field or function", "body": "<p>What you're effectively looking for is to allow <em>projections</em> to be passed into algorithms. <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4128.html#algorithms-should-take-invokable-projections\" rel=\"noreferrer\">N4128</a> proposed this for the standard library, and C++20 will have these for many of the algorithms.</p>\n\n<p>But until then, we can do this ourselves. Write a new overload of <code>sort</code>:</p>\n\n<pre><code>struct identity {\n    template &lt;typename T&gt;\n    T&amp;&amp; operator()(T&amp;&amp; t) const noexcept { return std::forward&lt;T&gt;(t); }\n};\n\n// because no std::less&lt;&gt; in C++11 yet\nstruct less {\n    template &lt;typename T, typename U&gt;\n    constexpr bool operator()(T const&amp; lhs, U const&amp; rhs) const {\n        return lhs &lt; rhs;\n    }\n};\n\ntemplate &lt;typename Range, typename Comp=less, typename Proj=identity&gt;\nvoid sort_proj(Range&amp; range, Comp comp={}, Proj proj={}) {\n    using std::begin;\n    using std::end;\n    auto first = begin(range), last = end(range);\n    using reference = typename std::iterator_traits&lt;decltype(first)&gt;::reference;\n\n    std::sort(first, last,\n        [&amp;](reference lhs, reference rhs) {\n            return comp(std::ref(proj)(lhs), std::ref(proj)(rhs));\n        });\n}\n</code></pre>\n\n<p><code>std::ref(f)(x)</code> is a trick to get <code>INVOKE</code> functionality in C++11. It basically allows you to pass pointers to members as the projection. This implementation would let you write:</p>\n\n<pre><code>sort_proj(students, less{}, &amp;student::id);\n</code></pre>\n\n<p>Note that the projection is independent of the ordering. So I could do all kinds of things pretty easily:</p>\n\n<pre><code>sort_proj(students);                            // sort on students, if they're ordered\nsort_proj(students, greater{}, &amp;student::name); // decreasing, by name\nsort_proj(students, less{},                     // by name, then id\n    [](student const&amp; s) {\n        return std::tie(s.name, s.id);\n    });\n</code></pre>\n\n<hr />\n\n<p>This kind of approach is <em>super</em> useful at eliminating a lot of boilerplate from algorithms in general. I have a header that's just full of projection-based overloads of many of the commonly used standard algorithms. </p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1536187159, "creation_date": 1536187159, "answer_id": 52194247, "question_id": 52191326, "link": "https://stackoverflow.com/questions/52191326/shortcut-for-creating-a-comparator-based-on-a-member-field-or-function/52194247#52194247", "title": "Shortcut for creating a comparator based on a member field or function", "body": "<p><a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">range-v3</a> implements <em>projection</em>:</p>\n\n<pre><code>// sort by ID\nranges::sort(students, std::less&lt;&gt;{}, &amp;student::id);\n</code></pre>\n"}], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 2, "answer_count": 4, "score": 10, "last_activity_date": 1536190435, "creation_date": 1536171798, "last_edit_date": 1536190435, "question_id": 52191326, "link": "https://stackoverflow.com/questions/52191326/shortcut-for-creating-a-comparator-based-on-a-member-field-or-function", "title": "Shortcut for creating a comparator based on a member field or function", "body": "<p>I often find myself wanting to create a comparator objects for a <code>struct</code> or <code>class</code> which simply extracts one member of the class and does the usual <code>&lt;</code> comparison on that.</p>\n\n<p>For example:</p>\n\n<pre><code>struct student {\n   int id;\n   std::string name;\n};\n\n// sort by ID\nstd::sort(students.begin(), students.end(), [](const student&amp; l, const student&amp; r){ return l.id &lt; r.id; });\n</code></pre>\n\n<p>There's a lot of boilerplate there, in particular because we have to repeat the declaration for <code>l</code> and <code>r</code>. Is there a way in the standard library to create a comparator based on an \"extractor\" function which returns an object to compare on? </p>\n\n<p>Something like:</p>\n\n<pre><code>std::sort(students.begin(), students.end(), compare_on([](const student&amp; s){ return s.id; });\n</code></pre>\n\n<p>I'm using C++11, but also interested if there are solutions in later standards that don't apply in C++11 (so I can add something to my \"reasons to upgrade\" list).</p>\n\n<p>I'm asking here about using a single member as the comprand, and also the default comparison \"less than\", but bonus points for techniques that compose easily, e.g. that allow you use two fields in lexicographic order, or to change the comparison operator. </p>\n"}, {"tags": ["c++", "unreal-engine4"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7654474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1209963109073266/picture?type=large", "display_name": "jsjogren", "link": "https://stackoverflow.com/users/7654474/jsjogren"}, "is_accepted": false, "score": 0, "last_activity_date": 1536179762, "creation_date": 1536179762, "answer_id": 52193049, "question_id": 52191151, "link": "https://stackoverflow.com/questions/52191151/access-function-within-childactorclass-of-uchildactorcomponent/52193049#52193049", "title": "Access Function within ChildActorClass of UChildActorComponent", "body": "<p>Found out how to solve this issue. You just need to get the child actor, then cast to the child actor class. Then you're able to call the function.</p>\n\n<pre><code>((APlayerWeapon *)Weapon-&gt;GetChildActor())-&gt;Shoot();\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7654474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1209963109073266/picture?type=large", "display_name": "jsjogren", "link": "https://stackoverflow.com/users/7654474/jsjogren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536179762, "creation_date": 1536170993, "question_id": 52191151, "link": "https://stackoverflow.com/questions/52191151/access-function-within-childactorclass-of-uchildactorcomponent", "title": "Access Function within ChildActorClass of UChildActorComponent", "body": "<p>Okay, so on UE4 I'm attempting to make a UChildActorComponent that serves as the player's weapon. But when I go to call a function within the APlayerWeapon class, it says:</p>\n\n<blockquote>\n  <p>error: no member named 'Shoot' in 'UChildActorComponent'</p>\n</blockquote>\n\n<p>Here's the code I use to initialize the weapon:</p>\n\n<pre><code>void ABaseCharacter::CreatePlayerWeapon()\n{\n    //Create the weapon actor as a UChildActorComponent\n    Weapon = CreateDefaultSubobject&lt;UChildActorComponent&gt;(TEXT(\"PlayerWeapon\"));\n    Weapon-&gt;SetChildActorClass(WeaponClass);\n    Weapon-&gt;CreateChildActor();\n\n    //Attach it at the socket called \"GunSocket\" that I created on the right hand\n    Weapon-&gt;SetupAttachment(GetMesh(), FName(\"GunSocket\"));\n}\n</code></pre>\n\n<p>Then in the SetupPlayerInputComponent function, I use this to try and bind \"Shoot()\" to the spacebar key (which is set as the input in game settings):</p>\n\n<pre><code>InputComponent-&gt;BindAction(\"Shoot\", IE_Pressed, this, Weapon-&gt;Shoot());\n</code></pre>\n\n<p>And here are the relevant lines of code from the ABaseCharacter header file:</p>\n\n<pre><code>UPROPERTY(VisibleDefaultsOnly)\n    class UChildActorComponent* Weapon;\n\n\nUPROPERTY(VisibleAnywhere, Category = \"Base Character\")\n    TSubclassOf&lt;class APlayerWeapon&gt; WeaponClass;\n</code></pre>\n\n<p>And then the relevant lines of code from the APlayerWeapon class:</p>\n\n<pre><code>void APlayerWeapon::Shoot()\n{\n    UE_LOG(LogTemp, Error, TEXT(\"Shooting\"));\n}\n</code></pre>\n\n<p>tldr; How can I access the Shoot() function from APlayerWeapon if the weapon is currently a ChildActorComponent?</p>\n"}, {"tags": ["c++", "centos7", "c++17"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1536171231, "post_id": 52191127, "comment_id": 91332132, "body": "In a nutshell: Launch your process (plain <code>fork</code>/<code>exec*</code>). Connect a <code>pipe</code> from the <code>stdout</code> of the new process to your process. <code>read</code> data from the pipe when available and store it in some container/buffer in your process. When the child process terminates, parse the data in your container (the output from the child).  That&#39;s <i>one</i>, fairly simple, way of doing it."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1536172147, "post_id": 52191127, "comment_id": 91332541, "body": "No. I&#39;m not going to write up an example for you that you should be able to easily find online yourself based on the keywords given - this is fairly basic stuff with lots of material covering it online, if you do a bit of research. SO is not a free code writing service (nor am I)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1536172238, "post_id": 52191127, "comment_id": 91332589, "body": "<a href=\"http://coliru.stacked-crooked.com/a/0a055ba0ca0d8043\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/0a055ba0ca0d8043</a> what truncated output do you mean? Please show your code, its expected output, and its actual (truncated) output."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 1, "creation_date": 1536172308, "post_id": 52191127, "comment_id": 91332619, "body": "For code snippet 1) you state <code>&quot;execution doesn&#39;t even enter the while&quot;</code>.  Why not?  Have you run it under a debugger?  Note that the code shown in 1) is not quite the same as for your <a href=\"https://stackoverflow.com/questions/52187867/how-to-run-a-process-and-get-its-output-using-c-libboost\">previous question</a> -- in that question you also had shell redirection <code>2&gt;&amp;1</code> which could cause problems.  The code shown in 1) here works exactly as expected for me."}, {"owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1536172402, "post_id": 52191127, "comment_id": 91332648, "body": "@G.M. yes I&#39;ve debugged it and that&#39;s how I acknowledge that it is not entering the while loop, now if you ask me why, I don&#39;t know. Indeed I removed the <code>2&gt;&amp;1</code> to see if the problem stops. You are not the first one who told me that my examples works for you, the only thing I may conclude this is that either my system or my libs are broken or too outdated because this all makes no sense"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1536209424, "post_id": 52191127, "comment_id": 91342585, "body": "You should explain <i>why</i> you run <code>ps aux</code> and what processes do you really care about. For example, if you are searching some process, you should explain that (and what are you searching for). I see no gain in running <code>ps aux</code> programmatically"}, {"owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1536228967, "post_id": 52191127, "comment_id": 91352473, "body": "@BasileStarynkevitch I don&#39;t think this is the scope of the question but since you insist: I need to know if some processes are running given both its name and arguments. I can&#39;t know this using <code>pidof</code> or <code>pregp</code> because these don&#39;t consider the arguments passed. For the same reason I can&#39;t grep inside <code>proc</code> folder, running <code>find &#47;proc | grep my_process</code> and returned zero results"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1536229381, "post_id": 52191127, "comment_id": 91352692, "body": "But why can&#39;t you code (without creating any process) some functions accessing <code>&#47;proc&#47;</code> directly (as mentioned in my answer)?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1536237601, "post_id": 52191127, "comment_id": 91357713, "body": "@Fabiotk: next time you ask some question, please <i>motivate it</i> and <i>give some context</i> in the question itself, not in some comments for it. Do you understand that the initial form of your question was some <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY problem</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1536175218, "post_id": 52191701, "comment_id": 91333875, "body": "The problem with scanning the /proc directory is that it changes while you read it."}, {"owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "edited": false, "score": 0, "creation_date": 1536176019, "post_id": 52191701, "comment_id": 91334237, "body": "the examples are not clear in how to write into the pipe the outputs from <code>execve</code> since execve will halt and only return if an error happens"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1536206904, "post_id": 52191701, "comment_id": 91342011, "body": "But <code>ps aux</code> is scanning <code>&#47;proc</code> and it is also changing while <code>ps</code> runs"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "edited": false, "score": 0, "creation_date": 1536211349, "post_id": 52191701, "comment_id": 91343201, "body": "@Fabiotk: take several hours or days to read more. That matter is very well explained."}, {"owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "edited": false, "score": 0, "creation_date": 1536237083, "post_id": 52191701, "comment_id": 91357384, "body": "I see it, the fact that it has separating null bytes kind makes things harder since passing to <code>strcmp</code>, <code>strstr</code> only compares until the end of the string (ie, the null byte). But thanks for the help, now the problem is easy to solve"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1536237199, "post_id": 52191701, "comment_id": 91357449, "body": "No, that should make things <i>easier</i>. You just fill a buffer with all the content of <code>&#47;proc&#47;1234&#47;cmdline</code> (e.g. looping till <code>fread</code> fails), and you can use pointers <i>inside</i> that buffer (and pass such internal pointers to <code>strcmp</code>)"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1536236106, "last_edit_date": 1536236106, "creation_date": 1536173394, "answer_id": 52191701, "question_id": 52191127, "link": "https://stackoverflow.com/questions/52191127/what-is-a-reliable-way-to-get-output-from-instantiated-processes-in-c/52191701#52191701", "title": "What is a reliable way to get output from instantiated processes in c++?", "body": "<p>Use the relevant system calls <em>directly</em>: <a href=\"http://man7.org/linux/man-pages/man2/pipe.2.html\" rel=\"nofollow noreferrer\">pipe(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/dup2.2.html\" rel=\"nofollow noreferrer\">dup2(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/close.2.html\" rel=\"nofollow noreferrer\">close(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow noreferrer\">execve(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\">waitpid(2)</a>. Read some good Linux programming book (perhaps the old <a href=\"http://www.makelinux.net/alp/\" rel=\"nofollow noreferrer\">ALP</a> which has several chapters related to your question). Look for inspiration into the source code of other free software programs dealing with pipes (e.g. of some simple shell like <code>sash</code>) and/or into your <code>libc</code> (or <a href=\"http://musl-libc.org/\" rel=\"nofollow noreferrer\">musl-libc</a>, it has very readable code) for the code of <code>popen</code>.</p>\n\n<p>We don't have the space and time to explain in details, but you'll find many resources on the Web, and ALP is freely downloadable; of course <code>execve</code> is the last system call that usually runs in the child process, since it is re-initializing the virtual address space.</p>\n\n<p>To read from the pipe without limiting the line length. Either use <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\">read(2)</a> manually (and care about the buffering), or consider <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">getline(3)</a> (see also f<a href=\"http://man7.org/linux/man-pages/man3/fdopen.3.html\" rel=\"nofollow noreferrer\">dopen(3)</a>)</p>\n\n<p>You might be interested by frameworks like <a href=\"http://pocoproject.org/\" rel=\"nofollow noreferrer\">POCO</a> or <a href=\"http://qt.io/\" rel=\"nofollow noreferrer\">Qt</a>.</p>\n\n<p>You probably want to avoid <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">popen(3)</a> (and you don't need something using <code>/bin/sh</code>, unless your command needs to be expanded for <a href=\"https://en.wikipedia.org/wiki/Glob_(programming)\" rel=\"nofollow noreferrer\">globbing</a>; see <a href=\"http://man7.org/linux/man-pages/man7/glob.7.html\" rel=\"nofollow noreferrer\">glob(7)</a>).</p>\n\n<p>Be aware of <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">signal(7)</a> and <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">signal-safety(7)</a> (and perhaps <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">poll(2)</a> ...)</p>\n\n<hr>\n\n<blockquote>\n  <p>The program I want to run in my c++ application is just a <code>ps aux</code></p>\n</blockquote>\n\n<p>Then you probably should <a href=\"https://stackoverflow.com/q/939778/841108\">not</a> run any external process, but instead <strong>access <code>/proc/</code> <em>directly</em></strong> (see <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow noreferrer\">proc(5)</a>; you'll need <a href=\"http://man7.org/linux/man-pages/man3/opendir.3.html\" rel=\"nofollow noreferrer\">opendir(3)</a>, <a href=\"http://man7.org/linux/man-pages/man3/readdir.3.html\" rel=\"nofollow noreferrer\">readdir(3)</a> etc...) or perhaps thru some <code>libproc</code>. Of course <code>ps aux</code> is accessing <code>/proc/</code> itself (so you don't gain anything except some simplicity by running <code>ps</code>, and you lose some performance and some robustness by using it). See also <a href=\"https://stackoverflow.com/a/50397466/841108\">this</a>, <a href=\"https://stackoverflow.com/a/48346065/841108\">this</a>, <a href=\"https://stackoverflow.com/a/47194864/841108\">this</a>, <a href=\"https://stackoverflow.com/a/47110393/841108\">this</a>, <a href=\"https://stackoverflow.com/a/48089620/841108\">this</a> answers.</p>\n\n<p>In a comment you mention</p>\n\n<blockquote>\n  <p>I need to know if some processes are running given both its name and arguments. </p>\n</blockquote>\n\n<p>That is a good case for accessing <code>/proc/</code> programmatically: loop on <code>/proc/</code> directory with <code>opendir</code>, looping <code>readdir</code>, <code>enddir</code>. For each entry given by <code>readdir</code> check that it has a numerical name (starting with a digit) otherwise skip it. With that numerical name (for example <code>1234</code>) construct a path like <code>/proc/1234/cmdline</code> and <a href=\"https://stackoverflow.com/a/12237783/841108\">open it then parse its content</a> (it has separating <kbd>NUL</kbd> bytes). This is probably not harder than starting a <code>ps aux</code> process, getting and parsing its output, and is certainly more efficient. (To understand details, run <code>od -cx /proc/self/cmdline</code> then <code>od -cx /proc/$(pidof systemd-journald)/cmdline</code> and understand its output).</p>\n"}], "owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 52191701, "answer_count": 1, "score": 0, "last_activity_date": 1536236106, "creation_date": 1536170876, "last_edit_date": 1536172961, "question_id": 52191127, "link": "https://stackoverflow.com/questions/52191127/what-is-a-reliable-way-to-get-output-from-instantiated-processes-in-c", "title": "What is a reliable way to get output from instantiated processes in c++?", "body": "<p>Basically what I want to do is to instantiate a program in a Linux shell and get the outputs that it emits to stdout into a string or list of strings (per line, depending). The program I want to run in my c++ application is just a <code>ps aux</code>.</p>\n\n<ul>\n<li>All the \"solutions\" I've found didn't completely solved my problem. Most of them fell under the error described in <a href=\"https://stackoverflow.com/a/25857954/2414842\">this answer</a>. Basically <code>popen</code> fails and doesn't return the complete output from the shell execution. Let's call this \"error 1\" for the sake of this question.</li>\n</ul>\n\n<p>What I've tried so far:</p>\n\n<p>1) Using boost, I tried this following their <a href=\"https://www.boost.org/doc/libs/1_65_1/doc/html/boost_process/tutorial.html#boost_process.tutorial.io\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<pre><code>#include &lt;boost/process.hpp&gt;\nnamespace bp = boost::process;\nbool is_process_running(std::string p_name){\n    string cmd = \"ps aux\";\n    bp::ipstream out;\n    std::string line;\n    bp::child c(cmd, bp::std_out &gt; out);\n\n    // the while is supposed to read each line of the output\n    // but the execution doesn't even enter the while\n    while(c.running() &amp;&amp; std::getline(out, line) &amp;&amp; !line.empty())\n    {\n        if(line.find(p_name) != std::string::npos)\n        {\n            return true;\n        }\n    }\n    c.wait();\n    return false;\n}\n</code></pre>\n\n<p>2) I also tried:</p>\n\n<pre><code>bool is_process_running(std::string p_name){\n    string cmd = \"ps aux\";\n    std::array&lt;char, 256&gt; buffer;\n    std::shared_ptr&lt;FILE&gt; pipe(popen(cmd.c_str(), \"r\"), pclose);\n    if (!pipe) throw std::runtime_error(\"popen() failed!\");\n    while (!feof(pipe.get())) {\n        if (fgets(buffer.data(), 256, pipe.get()) != nullptr)\n        {\n            // here the line comes incomplete\n            std::string line(buffer.data());\n            if(line.find(p_name) != std::string::npos)\n            {\n                return true;\n            }\n\n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>But this last one also fell into \"error 1\".</p>\n\n<p>3) <a href=\"https://stackoverflow.com/a/10702464/2414842\">This code snippet</a> fell into the \"error 1\"<br>\n4) <a href=\"https://stackoverflow.com/a/20617844/2414842\">This one</a> also fell into \"error 1\"\n<br>\nI don't this it is necessary to put the codes for 3) and 4) because it is literally what is in these answers, I didn't change anything, but if you guys need I can edit my question. So my question is just this, how to get the command output in a way that will work? Thanks in advance.</p>\n\n<p><strong>Edit</strong>:\nI've tried with the code snipped provided:</p>\n\n<pre><code>bool is_process_running(std::string p_name)\n    FILE* p = popen(cmd.c_str(), \"r\");\n    if (!p) { cerr &lt;&lt; \"oops\"; return 2; }\n    char line[500];\n    while (fgets(line, 500, p))\n    {\n        std::string linha(line);\n        if(linha.find(p_name) != std::string::npos)\n            return true;\n    }\n    fclose(p);\n    return false;\n}\n</code></pre>\n\n<p>In this case, here is an example of the truncated output from popen/fgets:</p>\n\n<pre><code>[fabio ~]$ ps aux | grep 391\nroot       391  0.0  0.1  48580 12864 ?        Ss   Sep03   0:06 /usr/lib/systemd/systemd-journald\nfabio 15435  0.0  0.0 112548   960 pts/2    S+   15:40   0:00 grep --color=auto 391\n</code></pre>\n\n<p>The line for the process 391 is as this one but at runtime it only returns me <code>\"root       391  0.0  0.1  48580 12856 ?        Ss   Sep03   0:06 /usr/lib/system\\n\"</code></p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1536169961, "post_id": 52190897, "comment_id": 91331599, "body": "<i>&quot;though I have not used assignment operator?&quot;</i> You use it twice in <code>operator-</code>. <code>feet = -feet;</code> and <code>inches = -inches;</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1536170089, "post_id": 52190897, "comment_id": 91331646, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 I&#39;m not sure it&#39;s a duplicate. The question isn&#39;t asking how to override <code>operator-</code>. It&#39;s asking about why the code is behaving the way it does."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1536170142, "post_id": 52190897, "comment_id": 91331668, "body": "@Fran&#231;oise Feel free to reopen."}, {"owner": {"reputation": 55, "user_id": 9106621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5383f454e2887d7729e70a0074fe2?s=128&d=identicon&r=PG&f=1", "display_name": "Michelle", "link": "https://stackoverflow.com/users/9106621/michelle"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1536170172, "post_id": 52190897, "comment_id": 91331687, "body": "@Fran&#231;oisAndrieux thank you, I don&#39;t know how I missed it. I was focusing on the return statement. Silly me."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1536170202, "post_id": 52190897, "comment_id": 91331702, "body": "@Michelle If a member function (including operators) isn&#39;t intended to modify it&#39;s instance, make is <code>const</code> so the compiler can signal these kinds of mistakes. Ex. <code>Distance operator-() const</code>."}, {"owner": {"reputation": 55, "user_id": 9106621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5383f454e2887d7729e70a0074fe2?s=128&d=identicon&r=PG&f=1", "display_name": "Michelle", "link": "https://stackoverflow.com/users/9106621/michelle"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1536170278, "post_id": 52190897, "comment_id": 91331745, "body": "@Fran&#231;oisAndrieux yes I will surely keep that in mind, thank you."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1536170887, "post_id": 52190897, "comment_id": 91331978, "body": "The dupe is dead, but <a href=\"https://stackoverflow.com/questions/4421706/what-are-the-basic-rules-and-idioms-for-operator-overloading\">What are the basic rules and idioms for operator overloading?</a> is still a highly recommended read and bookmark. Much wisdom contained therein."}], "answers": [{"tags": [], "owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "is_accepted": true, "score": 0, "last_activity_date": 1536182705, "last_edit_date": 1536182705, "creation_date": 1536182324, "answer_id": 52193515, "question_id": 52190897, "link": "https://stackoverflow.com/questions/52190897/overloading-of-operator-in-c/52193515#52193515", "title": "Overloading of - operator in c++", "body": "<p>If you don't want a specific function to change your class variables, you have to use <code>const</code> word right after it's declaration. So when ever you will use assignment sentences inside this function, the compiler will throw an error to you.\nThe following lines are change the current object you are working on:</p>\n\n<pre><code>feet = -feet;\ninches = -inches;\n</code></pre>\n\n<p>When you use <code>const</code>, the following function will throw you a compiler time exception:</p>\n\n<pre><code>Distance operator- () const {\n    feet = -feet; // Compiler exception..\n    inches = -inches; // Compiler exception..\n    return Distance(-feet, -inches);\n}\n</code></pre>\n\n<p>The following code, as I understood you, do what you want:</p>\n\n<pre><code>Distance operator- () const {\n    return Distance(-feet, -inches);\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9106621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5383f454e2887d7729e70a0074fe2?s=128&d=identicon&r=PG&f=1", "display_name": "Michelle", "link": "https://stackoverflow.com/users/9106621/michelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 52193515, "answer_count": 1, "score": -3, "last_activity_date": 1536182705, "creation_date": 1536169881, "question_id": 52190897, "link": "https://stackoverflow.com/questions/52190897/overloading-of-operator-in-c", "title": "Overloading of - operator in c++", "body": "<p>Why does the code below change the value of <code>D1</code> though I have not used assignment operator?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Distance {\n   private:\n      int feet;             // 0 to infinite\n      int inches;           // 0 to 12\n\n   public:\n      // required constructors\n      Distance() {\n         feet = 0;\n         inches = 0;\n      }\n      Distance(int f, int i) {\n         feet = f;\n         inches = i;\n      }\n\n      // method to display distance\n      void displayDistance() {\n         cout &lt;&lt; \"F: \" &lt;&lt; feet &lt;&lt; \" I:\" &lt;&lt; inches &lt;&lt;endl;\n      }\n\n      // overloaded minus (-) operator\n      Distance operator- () {\n         feet = -feet;\n         inches = -inches;\n         return Distance(feet, inches);\n      }\n};\n\nint main() {\n   Distance D1(1, 10), D2(-5, 11);\n\n   -D1;                     // apply negation\n   D1.displayDistance();    // display D1\n\n   -D2;                     // apply negation\n   D2.displayDistance();    // display D2\n\n   return 0;\n}\n</code></pre>\n\n<p>The output is </p>\n\n<blockquote>\n  <p>F: -1 I:-10 <br> F: 5 I:-11</p>\n</blockquote>\n"}, {"tags": ["c++", "c++11", "trailing-return-type"], "comments": [{"owner": {"reputation": 501, "user_id": 1997315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee21f9d6b51b301bd72bfe3fccbe8fd0?s=128&d=identicon&r=PG", "display_name": "jingyu9575", "link": "https://stackoverflow.com/users/1997315/jingyu9575"}, "edited": false, "score": 1, "creation_date": 1536208976, "post_id": 52190625, "comment_id": 91342450, "body": "In C++14, you can remove the trailing return type instead, and use <code>return f;</code> to deduce the return type."}], "answers": [{"comments": [{"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 6, "creation_date": 1536171524, "post_id": 52190653, "comment_id": 91332249, "body": "life made easy by <code>decltype</code> ;)"}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 50, "last_activity_date": 1536168920, "creation_date": 1536168920, "answer_id": 52190653, "question_id": 52190625, "link": "https://stackoverflow.com/questions/52190625/can-the-return-type-of-the-function-be-obtained-from-within-the-function/52190653#52190653", "title": "Can the return type of the function be obtained from within the function?", "body": "<p>Call the function with a <code>decltype</code>.</p>\n\n<pre><code>decltype(foo(p)) f{};\n</code></pre>\n"}], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 3, "accepted_answer_id": 52190653, "answer_count": 1, "score": 42, "last_activity_date": 1536171856, "creation_date": 1536168799, "last_edit_date": 1536171856, "question_id": 52190625, "link": "https://stackoverflow.com/questions/52190625/can-the-return-type-of-the-function-be-obtained-from-within-the-function", "title": "Can the return type of the function be obtained from within the function?", "body": "<p>Can the return type of a function be obtained in a simple way within the function?</p>\n\n<p>For example, given:</p>\n\n<pre><code>template &lt;typename P&gt;\nstatic inline auto foo(P p) -&gt; typename std::remove_reference&lt;decltype(*p)&gt;::type {\n    typename std::remove_reference&lt;decltype(*p)&gt;::type f{};  // &lt;-- here\n\n    ...\n}\n</code></pre>\n\n<p>In C++11 can I refer to the big nasty return type of <code>foo</code>, within <code>foo</code> itself, without repeating it, at the line marked <code>// &lt;-- here</code>?</p>\n"}, {"tags": ["c++", "compilation"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1536168222, "post_id": 52190432, "comment_id": 91330713, "body": "Object files and libraries are usually made for a specific <i>target</i>. It is usually possible to use object files made for a specific target by one compiler, together with a object files made for the same specific target by another compiler. The important thing is that both compilers use the same <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\"><i>Application Binary Interface (ABI)</i></a>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1536168422, "post_id": 52190432, "comment_id": 91330819, "body": "<i>&quot;Object files are consisted of binarny code, so it is tempting to assume that I can use them with all compillers.&quot;</i> Why&#39;s that? They don&#39;t exist in a vacuum! They almost always link with some runtime, at the very least."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "edited": false, "score": 0, "creation_date": 1536169247, "post_id": 52190479, "comment_id": 91331197, "body": "Could you go into more detail why static libraries list match with compillers? I trying to understand it"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "edited": false, "score": 0, "creation_date": 1536169459, "post_id": 52190479, "comment_id": 91331327, "body": "@KasataAta It&#39;s just what <a href=\"https://stackoverflow.com/questions/52190432/compilation-products-portability/52190479?noredirect=1#comment91330713_52190432\">@someprogrammerdude commented</a> and that&#39;s already true for <code>.o</code> files. As mentioned a static library is just a collection of <code>.o</code> files."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 1, "last_activity_date": 1536168137, "creation_date": 1536168137, "answer_id": 52190479, "question_id": 52190432, "link": "https://stackoverflow.com/questions/52190432/compilation-products-portability/52190479#52190479", "title": "Compilation products portability", "body": "<blockquote>\n  <p>As far as I know, static libraries must match with compilers, so they are compiler-specific. Is it true?</p>\n</blockquote>\n\n<p>Yes, that's true.</p>\n\n<blockquote>\n  <p>Object files are consisted of binarny code, so it is tempting to assume that I can use them with all compillers.</p>\n</blockquote>\n\n<p>Static libraries aren't anything else than accumulated <code>.o</code> files, so no other rule applies for these.</p>\n"}, {"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1536168547, "post_id": 52190486, "comment_id": 91330871, "body": "<i>&quot;No idea about .o or .a&quot;</i> Merely the same as <code>.obj</code> and <code>.lib</code>."}], "tags": [], "owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "is_accepted": false, "score": -1, "last_activity_date": 1536168155, "creation_date": 1536168155, "answer_id": 52190486, "question_id": 52190432, "link": "https://stackoverflow.com/questions/52190432/compilation-products-portability/52190486#52190486", "title": "Compilation products portability", "body": "<p>VISUAL STUDIO ANSWER</p>\n\n<p>For visual studio, a <code>.lib</code> is just a container of <code>.obj</code> and so which one doesn't change the answer.</p>\n\n<p>Also whether a LIB must match a specific version of the compiler depends. With ltcg they must match. Without it ... it depends. A clean, c interface library probably is ok to use with different versions of a compiler. When C++/STL gets in the mix things can start to go wrong. So the best advice is just use the same version - don't risk it. You may get away with it for a while but unless you're very careful you'll eventually trip up.</p>\n\n<p>And by the same version generally the same <em>major</em> version is suffice - VS team really try to not break binary compat in minor version updates</p>\n\n<p>No idea about .o or .a</p>\n"}], "owner": {"reputation": 165, "user_id": 10023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d88fe0ff393523aee72bf40dd983b3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kasata Ata", "link": "https://stackoverflow.com/users/10023636/kasata-ata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1536169718, "answer_count": 2, "score": 0, "last_activity_date": 1536168155, "creation_date": 1536167951, "question_id": 52190432, "link": "https://stackoverflow.com/questions/52190432/compilation-products-portability", "closed_reason": "Duplicate", "title": "Compilation products portability", "body": "<p>I want to ask you about object files (*.o, <em>.obj) and static libraries (</em>.a, *.lib). As far as I know, static libraries must match with compilers, so they are compiler-specific. Is it true? How does it look like if it comes to object files? Object files are consisted of binarny code, so it is tempting to assume that I can use them with all compillers. I am looking forward your answears. </p>\n"}, {"tags": ["c++", "googletest"], "answers": [{"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 1, "last_activity_date": 1536167065, "creation_date": 1536167065, "answer_id": 52190242, "question_id": 52190174, "link": "https://stackoverflow.com/questions/52190174/getting-multiple-definition-of-func-name-when-trying-to-compile-main-with-goog/52190242#52190242", "title": "Getting &quot;multiple definition of func_name&quot; when trying to compile main with google tests", "body": "<p>The googletest library already contains a definition for <code>main()</code>.</p>\n\n<p>To solve that, separate your definitions for <code>showMenu()</code> out into another library, and link that one to your testrunner and productive executable separately.</p>\n\n<p>And don't <code>#include</code> your <code>.cpp</code> file with the test code.</p>\n"}], "owner": {"reputation": 19, "user_id": 10182990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1902620999793993/picture?type=large", "display_name": "Alon Emanuel", "link": "https://stackoverflow.com/users/10182990/alon-emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536167065, "creation_date": 1536166786, "question_id": 52190174, "link": "https://stackoverflow.com/questions/52190174/getting-multiple-definition-of-func-name-when-trying-to-compile-main-with-goog", "title": "Getting &quot;multiple definition of func_name&quot; when trying to compile main with google tests", "body": "<p>I have a simple .cpp file that looks like this:</p>\n\n<pre><code>void showMenu()\n{\n    std::cout &lt;&lt; \"Hi!\";\n}\n\nint main()\n{\n    showMenu();\n    return 0;\n}\n</code></pre>\n\n<p>In addition, I have an empty google-test that looks like this:</p>\n\n<pre><code>TEST(Name, SubName)\n{\n\n}\n</code></pre>\n\n<p>When I try to compile, I get:</p>\n\n<pre><code>multiple definition of `showMenu()'\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>multiple definition of `main()'\n</code></pre>\n\n<p>errors.\nHow do I set my configurations so that I would be able to run my main when I went to, and my google-test when I want to, without them clashing into each other?</p>\n"}, {"tags": ["c++", "linux", "gcc", "assembly"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1536167340, "post_id": 52190139, "comment_id": 91330335, "body": "C++ has no concept of &quot;stack protection&quot; - this is entirely a GCC feature. Arguably, the <code>c++</code> tag should be removed."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 2, "creation_date": 1536168040, "post_id": 52190139, "comment_id": 91330643, "body": "@NeilButterworth On the other hand, the question is about specific C++ code examples."}], "answers": [{"comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1536167472, "post_id": 52190298, "comment_id": 91330403, "body": "Ahhh. that&#39;s my mistake, I thought the default was <code>-fstack-protector</code> for some reason."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 12, "last_activity_date": 1536167474, "last_edit_date": 1536167474, "creation_date": 1536167319, "answer_id": 52190298, "question_id": 52190139, "link": "https://stackoverflow.com/questions/52190139/whats-the-expected-behavior-of-stack-protection-with-statically-sized-arrays/52190298#52190298", "title": "What&#39;s the expected behavior of stack protection with statically-sized arrays?", "body": "<p><strong>The default on Ubuntu's gcc is <code>-fstack-protector-strong</code></strong>, not <code>-fstack-protector-all</code>.  (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html\" rel=\"noreferrer\">The gcc manual lists available options</a>).</p>\n\n<p><a href=\"https://lwn.net/Articles/584225/\" rel=\"noreferrer\">https://lwn.net/Articles/584225/</a> describes \"strong\".  It really likes to protect arrays, but structs with no array members can't be indexed so there's much less chance of overflow.</p>\n\n<p><a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;struct+VecA+%7B%0A++float+data%5B4%5D%3B%0A%7D%3B%0A%0Astruct+VecB+%7B%0A++float+x%3B%0A++float+y%3B%0A++float+z%3B%0A++float+w%3B%0A%7D%3B%0A%0A//+Requires+stack+protection%0AVecA+getA()+%7Breturn+%7B1.0f,+1.0f,+1.0f,+1.0f%7D%3B%7D%0A%0A//+Does+not+require+stack+protection%0AVecB+getB()+%7Breturn+%7B1.0f,+1.0f,+1.0f,+1.0f%7D%3B%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:35.69370508264983,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-std%3Dgnu%2B%2B14++-fstack-protector-strong+-O3+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:30.97296158401685,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3+-fstack-protector&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"noreferrer\">On Godbolt</a>, that produces stack protection for VecA but not VecB, like on your desktop.  (And BTW, you can use <code>g++ -S -masm=intel -O3</code> to get Intel-syntax, or <code>objdump -drwC -Mintel</code>, since you linked to Intel-syntax on Godbolt.)</p>\n\n<p>You can use <code>g++ -S -fverbose-asm -O3 foo.cpp</code> to include comments showing all the implied and explicit options gcc used when compiling.  On Godbolt, uncheck the <code>//</code> icon to not hide asm comments, <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;struct+VecA+%7B%0A++float+data%5B4%5D%3B%0A%7D%3B%0A%0Astruct+VecB+%7B%0A++float+x%3B%0A++float+y%3B%0A++float+z%3B%0A++float+w%3B%0A%7D%3B%0A%0A//+Requires+stack+protection%0AVecA+getA()+%7Breturn+%7B1.0f,+1.0f,+1.0f,+1.0f%7D%3B%7D%0A%0A//+Does+not+require+stack+protection%0AVecB+getB()+%7Breturn+%7B1.0f,+1.0f,+1.0f,+1.0f%7D%3B%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:35.69370508264983,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;1&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-std%3Dgnu%2B%2B14++-fstack-protector-strong+-O3+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:30.97296158401685,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3+-fstack-protector&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"noreferrer\">like this</a>.</p>\n\n<pre><code># GNU C++14 (GCC-Explorer-Build) version 7.3.0 (x86_64-linux-gnu)\n#       compiled by GNU C version 5.4.0 20160609, GMP version 6.1.0, MPFR version 3.1.4, MPC version 1.0.3, isl version isl-0.16.1-GMP\n\n# GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072\n# options passed:  -fdiagnostics-color=always -imultiarch x86_64-linux-gnu\n# -iprefix /opt/compiler-explorer/gcc-7.3.0/bin/../lib/gcc/x86_64-linux-gnu/7.3.0/\n# -D_GNU_SOURCE\n# /tmp/compiler-explorer-compiler11885-54-1u26why.tdoy/example.cpp\n# -masm=intel -mtune=generic -march=x86-64\n# -auxbase-strip /tmp/compiler-explorer-compiler11885-54-1u26why.tdoy/output.s\n# -g -O3 -std=gnu++14 -fstack-protector-strong -fverbose-asm\n# options enabled:  -faggressive-loop-optimizations -falign-labels\n# -fasynchronous-unwind-tables -fauto-inc-dec -fbranch-count-reg\n# -fcaller-saves -fchkp-check-incomplete-type -fchkp-check-read\n# -fchkp-check-write -fchkp-instrument-calls -fchkp-narrow-bounds\n# -fchkp-optimize -fchkp-store-bounds -fchkp-use-static-bounds\n# -fchkp-use-static-const-bounds -fchkp-use-wrappers -fcode-hoisting\n# -fcombine-stack-adjustments -fcommon -fcompare-elim -fcprop-registers\n# -fcrossjumping -fcse-follow-jumps -fdefer-pop\n...\n</code></pre>\n"}], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 52190298, "answer_count": 1, "score": 8, "last_activity_date": 1536167474, "creation_date": 1536166648, "last_edit_date": 1536167233, "question_id": 52190139, "link": "https://stackoverflow.com/questions/52190139/whats-the-expected-behavior-of-stack-protection-with-statically-sized-arrays", "title": "What&#39;s the expected behavior of stack protection with statically-sized arrays?", "body": "<p>If I compile the following in Ubuntu 16.04 / gcc 7.3</p>\n\n<pre><code>struct VecA {\n  float data[4];\n};\n\nstruct VecB {\n  float x;\n  float y;\n  float z;\n  float w;\n};\n\n// Requires stack protection\nVecA getA() {return {1.0f, 1.0f, 1.0f, 1.0f};}\n\n// Does not require stack protection\nVecB getB() {return {1.0f, 1.0f, 1.0f, 1.0f};}\n</code></pre>\n\n<p>Like so:</p>\n\n<pre><code>g++ -O3 -c -o result test.cpp\nobjdump -d result\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>0000000000000000 &lt;_Z4getAv&gt;:\n   0:   48 83 ec 18             sub    $0x18,%rsp\n   4:   64 48 8b 04 25 28 00    mov    %fs:0x28,%rax\n   b:   00 00 \n   d:   48 89 44 24 08          mov    %rax,0x8(%rsp)\n  12:   31 c0                   xor    %eax,%eax\n  14:   f3 0f 7e 05 00 00 00    movq   0x0(%rip),%xmm0        # 1c &lt;_Z4getAv+0x1c&gt;\n  1b:   00 \n  1c:   48 8b 44 24 08          mov    0x8(%rsp),%rax\n  21:   64 48 33 04 25 28 00    xor    %fs:0x28,%rax\n  28:   00 00 \n  2a:   75 09                   jne    35 &lt;_Z4getAv+0x35&gt;\n  2c:   66 0f 6f c8             movdqa %xmm0,%xmm1\n  30:   48 83 c4 18             add    $0x18,%rsp\n  34:   c3                      retq   \n  35:   e8 00 00 00 00          callq  3a &lt;_Z4getAv+0x3a&gt;\n  3a:   66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)\n\n0000000000000040 &lt;_Z4getBv&gt;:\n  40:   f3 0f 7e 05 00 00 00    movq   0x0(%rip),%xmm0        # 48 &lt;_Z4getBv+0x8&gt;\n  47:   00 \n  48:   66 0f 6f c8             movdqa %xmm0,%xmm1\n  4c:   c3                      retq \n</code></pre>\n\n<p>Which \"looks\" like linux stack protection is being applied to <code>VecA</code>. A little bit on the defensive side, but I can understand how a compiler could reach that conclusion.</p>\n\n<p>However, This is where i'm getting confused:</p>\n\n<p>I can't reproduce this on godbolt.org, even with stack protection explicitly on. I can make it happen for BOTH functions with <code>-fstack-protector-all</code> but that's expected, and uninteresting.</p>\n\n<p><a href=\"https://gcc.godbolt.org/z/ePR98P\" rel=\"noreferrer\">https://gcc.godbolt.org/z/ePR98P</a></p>\n\n<p>Also, it seems that, on my system, explicitly using the stack protector is removing the protection from <code>getA()</code></p>\n\n<pre><code>g++ -O3 -c -o -fstack-protector result test.cpp\nobjdump -d result\n\n0000000000000000 &lt;_Z4getAv&gt;:\n   0:   f3 0f 7e 05 00 00 00    movq   0x0(%rip),%xmm0        # 8 &lt;_Z4getAv+0x8&gt;\n   7:   00 \n   8:   66 0f 6f c8             movdqa %xmm0,%xmm1\n   c:   c3                      retq   \n   d:   0f 1f 00                nopl   (%rax)\n\n0000000000000010 &lt;_Z4getBv&gt;:\n  10:   f3 0f 7e 05 00 00 00    movq   0x0(%rip),%xmm0        # 18 &lt;_Z4getBv+0x8&gt;\n  17:   00 \n  18:   66 0f 6f c8             movdqa %xmm0,%xmm1\n  1c:   c3                      retq   \n</code></pre>\n\n<p>So my questions are:</p>\n\n<ol>\n<li><p>Why are my local results that much different than what's being generated on godbolt.org?</p></li>\n<li><p>Is there a reasonable explanation behind the behavior on my system? Especially regarding <code>-fstack-protector</code> removing protection.</p></li>\n<li><p>It is reasonable to assert that both functions should be generating equivalent assembly in optimized code?</p></li>\n</ol>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Full version string:</p>\n\n<pre><code>g++ --version\ng++ (Ubuntu 7.3.0-21ubuntu1~16.04) 7.3.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n"}, {"tags": ["c++", "c++11", "lambda", "closures"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1536166426, "post_id": 52190078, "comment_id": 91329902, "body": "A lambda function <a href=\"https://stackoverflow.com/questions/28746744/passing-lambda-as-function-pointer\">cannot decay into a raw function pointer if it captures</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 0, "creation_date": 1536166602, "post_id": 52190093, "comment_id": 91329974, "body": "I see, thanks. Can you recommend a way of tackling this? I guess then the best would be to change the signature of <code>AWS::subscribe</code> to expect a lambda but somehow it transforms it to a function pointer under the hood. So that <code>aws_iot_mqtt_subscribe</code> would &quot;eat&quot; it. Note, that the AWS library is not an official library, it&#39;s just a snippet, so it wouldn&#39;t be an issue changing it."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1536170117, "post_id": 52190093, "comment_id": 91331657, "body": "@JeJo That&#39;s not &quot;conversion&quot; in the C++ sense. Of course you can &quot;convert&quot; it by putting the lambda object itself the <code>void*</code> and having a wrapper function that just calls that. Not to mention the lifetime drawbacks regarding the lambda itself (which must stay in scope until the call happens...)."}, {"owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 0, "creation_date": 1537016568, "post_id": 52190093, "comment_id": 91635725, "body": "@MaxLanghof Can you tell me how would it look like with a lambda as data instead of string? Thanks"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 5, "last_activity_date": 1536167019, "last_edit_date": 1536167019, "creation_date": 1536166431, "answer_id": 52190093, "question_id": 52190078, "link": "https://stackoverflow.com/questions/52190078/c-lambda-error-no-matching-function-for-call-to/52190093#52190093", "title": "C++ Lambda - error: no matching function for call to", "body": "<p>The issue is that the <code>AWS::subscribe</code> function expects a function pointer, not a lambda. Capture-less lambdas can be converted to function pointers, but lambdas with captures (i.e. state) cannot.</p>\n\n<p>You can see the \"conventional\" solution to this already in the signature: There is a <code>void*</code> parameter that you should pack all your callback-specific data into. Presumably this is the last argument of <code>aws_iot_mqtt_subscribe</code> that you currently set to <code>NULL</code> (prefer using <code>nullptr</code> btw).</p>\n\n<p>This is uglier than using lambdas, but it's basically the only option for C-compatible library interfaces:</p>\n\n<pre><code>// Your callback (could also be a capture-less lambda):\nvoid callbackFunc(/* etc. */, void *pData) \n{\n    std::string* someVarPtr = static_cast&lt;std::string*&gt;(pData);\n    char *text = (char *)params-&gt;payload;\n    sprintf(*someVarPtr, \"%s\", text);\n}\n\n// To subscribe:\nstd::string someVar;\nvoid* callbackData = &amp;someVar; // Or a struct containing e.g. pointers to all your data.\naws_iot_mqtt_subscribe(/* etc. */, callbackFunc, callbackData);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 0, "creation_date": 1536234867, "post_id": 52191196, "comment_id": 91355997, "body": "The only problem here I&#39;m getting various error messages when trying to compile. :-/ <code>utils.cpp:7:7: error: expected primary-expression before &#39;return&#39;        return [](Args...args, void* fptr)-&gt;void {</code> and <code>utils.cpp:12:29: error: &#39;f&#39; was not declared in this scope        return std::addressof(f);</code> and few more. Can you check it please? Thanks"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 2, "creation_date": 1536238934, "post_id": 52191196, "comment_id": 91358534, "body": "@haxpanel 3 typos fixed.  The nastiest is a function that returns a function pointer, which is not something I&#39;d usually do directly like that.  Live example added with a minimal fake AWS test harness."}, {"owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 0, "creation_date": 1536242773, "post_id": 52191196, "comment_id": 91360938, "body": "I&#39;m still getting the <code>error: no matching function for call to</code> but this time even with a capture-less lambda. I did everything according to your example, and I have no idea what could go wrong."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 1, "creation_date": 1536243060, "post_id": 52191196, "comment_id": 91361154, "body": "@haxpanel If the error is in <code>get_callback</code>, the signature of the lambda (and the arguments passed to <code>get_callback</code>) shouldn&#39;t have a &quot;trailing <code>void*</code>&quot;; that is added by <code>get_callback</code>.  That <code>void*</code> is being used to store the pointer-to-lambda for you."}, {"owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 0, "creation_date": 1536244088, "post_id": 52191196, "comment_id": 91361848, "body": "Removing <code>task.get_pvoid()</code> from where I call <code>subscribe</code> solved this issue! I missed out that the signature of <code>subscribe</code> was different. I&#39;m not quite sure what&#39;s going on under the hood, would it be ever useful to pass the address of the function?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "edited": false, "score": 0, "creation_date": 1536245191, "post_id": 52191196, "comment_id": 91362612, "body": "@haxpanel I had to modify <code>subscribe</code> to get the pvoid passed into <code>::aws_iot_mqtt_subscribe</code> as its last argument.  The <a href=\"http://aws-iot-device-sdk-embedded-c-docs.s3-website-us-east-1.amazonaws.com/aws__iot__mqtt__client__subscribe_8c.html\" rel=\"nofollow noreferrer\">last two arguments are</a> the function pointer, and a pvoid passed to it.  Your <code>AWS::subscribe</code> passed NULL as the hard-coded pvoid value; that is where you are supposed to put your pointer-to-function state (in this case a pointer-to-lambda)."}, {"owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1536245300, "post_id": 52191196, "comment_id": 91362692, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/179561/discussion-between-haxpanel-and-yakk-adam-nevraumont\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1536245386, "last_edit_date": 1536245386, "creation_date": 1536171199, "answer_id": 52191196, "question_id": 52190078, "link": "https://stackoverflow.com/questions/52190078/c-lambda-error-no-matching-function-for-call-to/52191196#52191196", "title": "C++ Lambda - error: no matching function for call to", "body": "<pre><code>void AWS::subscribe(const char *topic,\n                    pApplicationHandler_t iot_subscribe_callback_handler,\n                    void* ptr) {\n  m_error =\n      ::aws_iot_mqtt_subscribe(&amp;m_client, topic, (uint16_t)std::strlen(topic),\n                              QOS1, iot_subscribe_callback_handler, ptr);\n\n}\n</code></pre>\n\n<p>then a little utility type:</p>\n\n<pre><code>namespace utils {\n  template&lt;class F&gt;\n  struct c_style_callback_t {\n    F f;\n    template&lt;class...Args&gt;\n    static void(*get_callback())(Args..., void*) {\n      return [](Args...args, void* fptr)-&gt;void {\n        (*static_cast&lt;F*&gt;(fptr))(std::forward&lt;Args&gt;(args)...);\n      };\n    }\n    void* get_pvoid() {\n      return std::addressof(f);\n    }\n  };\n  template&lt;class F&gt;\n  c_style_callback_t&lt; std::decay_t&lt;F&gt; &gt;\n  c_style_callback( F&amp;&amp; f ) { return {std::forward&lt;F&gt;(f)}; }\n}\n</code></pre>\n\n<p>now we can do:</p>\n\n<pre><code>auto task = utils::c_style_callback(\n  [&amp;] (AWS_IoT_Client *pClient, char *topicName, uint16_t topicNameLen, IoT_Publish_Message_Params *params) {\n    char *text = (char *)params-&gt;payload;\n    sprintf(someVar, \"%s\", text);\n  }\n);\naws-&gt;subscribe(\n  topic,\n  task.get_callback&lt;AWS_IoT_Client*, char*, uint16_t, IoT_Publish_Message_Params*&gt;(),\n  task.get_pvoid()\n);\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/2f6647d41e098996\" rel=\"nofollow noreferrer\">Live example</a>.</p>\n\n<hr>\n\n<p>As I have learned you can modify <code>AWS</code> class, I'd do this:</p>\n\n<pre><code>template&lt;class Handler&gt;\nvoid AWS::subscribe(const char *topic,\n                    Handler iot_subscribe_callback_handler) {\n  auto task = utils::c_style_callback(iot_subscribe_callback_handler);\n\n  m_error =\n    ::aws_iot_mqtt_subscribe(\n      &amp;m_client,\n      topic,\n      (uint16_t)std::strlen(topic),\n       QOS1,\n      task.get_callback&lt;AWS_IoT_Client*, char*, uint16_t, IoT_Publish_Message_Params*&gt;(),\n      task.get_pvoid()\n    );\n}\n</code></pre>\n\n<p>where <code>subscribe</code> now takes a lambda with signature <code>void(AWS_IoT_Client*, char*, uint16_t, IoT_Publish_Message_Params*)</code>.</p>\n"}], "owner": {"reputation": 3200, "user_id": 789076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9551a9b6a0a91d255274fd5bbd2991d6?s=128&d=identicon&r=PG", "display_name": "haxpanel", "link": "https://stackoverflow.com/users/789076/haxpanel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1538, "favorite_count": 0, "accepted_answer_id": 52190093, "answer_count": 2, "score": 3, "last_activity_date": 1536245386, "creation_date": 1536166355, "last_edit_date": 1536168179, "question_id": 52190078, "link": "https://stackoverflow.com/questions/52190078/c-lambda-error-no-matching-function-for-call-to", "title": "C++ Lambda - error: no matching function for call to", "body": "<p>I am trying to pass a lambda as parameter to a function but once I attempt to access a variable inside the lambda which was declared outside, the build fails: <code>error: no matching function for call to 'AWS::subscribe(char [128], mainTask(void*)::&lt;lambda(AWS_IoT_Client*, char*, uint16_t, IoT_Publish_Message_Params*, void*)&gt;)'</code></p>\n\n<p>I was thinking that the <code>[&amp;]</code> would take care of capturing variables. I also tried <code>[=]</code> as well as <code>[someVar]</code>, <code>[&amp;someVar]</code>.</p>\n\n<p>I'm using C++11.</p>\n\n<pre><code>char someVar[128];\n\naws-&gt;subscribe(\n  topic,\n  [&amp;] (AWS_IoT_Client *pClient, char *topicName, uint16_t topicNameLen, IoT_Publish_Message_Params *params, void *pData) {\n    char *text = (char *)params-&gt;payload;\n    sprintf(someVar, \"%s\", text);\n  }\n);\n</code></pre>\n\n<p>From the AWS library:</p>\n\n<pre><code>void AWS::subscribe(const char *topic,\n                    pApplicationHandler_t iot_subscribe_callback_handler) {\n  m_error =\n      ::aws_iot_mqtt_subscribe(&amp;m_client, topic, (uint16_t)std::strlen(topic),\n                              QOS1, iot_subscribe_callback_handler, NULL);\n\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "typedef"], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 0, "last_activity_date": 1536166763, "creation_date": 1536166763, "answer_id": 52190167, "question_id": 52190077, "link": "https://stackoverflow.com/questions/52190077/template-class-compile-issue-with-typedef-variables/52190167#52190167", "title": "Template Class Compile Issue with Typedef Variables", "body": "<p>Because <code>size_type</code> is a dependent type, so you need to refer to it as <code>typename Vector::size_type</code> to reassure the compiler that this symbol denotes a type in each possible <code>Vector</code> specialization. Ancient Visual C could accept it without <code>typename</code> (but had much funnier fails in other aspects of C++ templates.)</p>\n"}], "owner": {"reputation": 1, "user_id": 10321438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oZifz.jpg?s=128&g=1", "display_name": "j_martin", "link": "https://stackoverflow.com/users/10321438/j-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "closed_date": 1536166511, "answer_count": 1, "score": 0, "last_activity_date": 1536166763, "creation_date": 1536166352, "question_id": 52190077, "link": "https://stackoverflow.com/questions/52190077/template-class-compile-issue-with-typedef-variables", "closed_reason": "Duplicate", "title": "Template Class Compile Issue with Typedef Variables", "body": "<p>I'm having an issue compiling a template class using a newer C++ compiler (going from Visual C++ 6.0 to Visual C++ 2015). All of the errors center around a handful of typedefs within the class. Here is a snippet of the header file:</p>\n\n<pre><code>template&lt;class Type&gt; class Vector\n{\npublic:\n    typedef Type* iterator;\n    typedef const Type* const_iterator;\n    typedef Type&amp; reference;\n    typedef const Type&amp; const_reference;\n    typedef size_t size_type;\n\n    Vector();\n    Vector( size_type Size, const_reference Object = Type() );\n\n    ...\n\nprivate:\n    VectorImpl&lt;Type&gt;* m_pImpl;\n};\n\ntemplate &lt;typename Type&gt; Vector&lt;Type&gt;::Vector()\n{\n    m_pImpl = new VectorImpl&lt;Type&gt;();\n};\n\ntemplate &lt;typename Type&gt; Vector&lt;Type&gt;::Vector(Vector&lt;Type&gt;::size_type Size, Vector&lt;Type&gt;::const_reference Object)\n{\n    m_pImpl = new VectorImpl&lt;Type&gt;(Size, Object);\n};\n\n...\n</code></pre>\n\n<p>When the compiler attempts to build the template method implementation it throws an error when encountering the typedef parameter (i.e. '<strong>Vector::size_type Size</strong>') I get an '<em>C2988 unrecognizable template declaration/definition</em>' error. In other instances I get an '<em>C2061 syntax error: identifier 'size_type'</em>' error.</p>\n\n<p>Is there a formatting issue or could there be a compatibility issue with using typedefs in a template class? </p>\n"}, {"tags": ["c++", "dll"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1536169599, "post_id": 52190004, "comment_id": 91331406, "body": "Do <b>not</b> compile with /MT, you absolutely must use /MD to bring this to a good end."}], "answers": [{"tags": [], "owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "is_accepted": false, "score": 0, "last_activity_date": 1536166518, "creation_date": 1536166518, "answer_id": 52190118, "question_id": 52190004, "link": "https://stackoverflow.com/questions/52190004/pass-data-between-exe-dll/52190118#52190118", "title": "Pass data between EXE/DLL", "body": "<p>Memory for the vector is being allocated in the DLL and free'd in the exe as the vector is probably using move semantics in its return (or even just RVO) which just moves the pointer to the allocated internals. As you're using a static CRT this means the memory is being allocated with one crt and free'd with a different instance which leads to badness.</p>\n\n<p>Short story - don't do this. Exposing C++ objects across DLL boundaries is bad. You should use a C interface or an interface that is designed for this - e.g. WinRT.</p>\n\n<p>If you do choose to expose c++ objects across a DLL interface you must make sure that both the EXE and the DLL use the same version of the compiler and you link with /MD. If you can't use /MD you'll never get this to work reliably.</p>\n\n<p>Sure you could pre-allocate the vector and fill it in in the call but that's just masking the issue until things inevitably change down the line.</p>\n"}], "owner": {"reputation": 499, "user_id": 6281636, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/95524308f4f33ad7dac2540300946ba8?s=128&d=identicon&r=PG&f=1", "display_name": "drewpol", "link": "https://stackoverflow.com/users/6281636/drewpol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536166518, "creation_date": 1536166001, "last_edit_date": 1536166165, "question_id": 52190004, "link": "https://stackoverflow.com/questions/52190004/pass-data-between-exe-dll", "title": "Pass data between EXE/DLL", "body": "<p>I have DLL and EXE app. DLL is registered in EXE. Then in EXE instance of class <code>A</code> is created as <code>shared_ptr</code>. Next, this instance is passed to the DLL and method <code>example</code> of this instance is called on DLL side. </p>\n\n<pre><code>class Result\n{\n//Some attributes e.g std::vector\n}\n\nclass A\n{\npublic:\n    A(){}\n    ~A(){}\n\n    Result example(){\n        Result r;\n        //Fill data in r object....\n        return r;\n    }\n}\n</code></pre>\n\n<p>The problem is that when <code>example</code> is called somewhere in DLL :</p>\n\n<pre><code>void someDLLMethod()\n{\n    //a is a shared pointer of A class\n    {\n        Result r = a-&gt;example();\n    }//PROBLEM IS HERE DURING DEALLOCATING Result OBJECT\n\n    //some stuff...\n}\n</code></pre>\n\n<p>It seems that the problem occurs during deleting <code>r</code> object. I understand when I will try to allocate some memory in EXE and then try to deallocate this memory in DLL then memory issues can occur, but in this case, <code>Result</code> object is copied from EXE to DLL. Also, vector stored in <code>Result</code> object doesn't contain any pointers so it should be deep copy of vector. \nOne solution is to allocate <code>Result</code> object in DLL, pass it as reference to called method and fill all necessary data, but I want to get copy as result.\nWhy this problem occurs? How it is possible to fix it? EXE and DLL are in this same solution of Visual studio and must be compiled with \\MT or \\MTd and there is no possibility to change it.</p>\n"}, {"tags": ["c++", "guid", "credential-providers"], "answers": [{"tags": [], "owner": {"reputation": 886, "user_id": 3868464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3JnBN.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3868464/alexander"}, "is_accepted": true, "score": 0, "last_activity_date": 1536591223, "creation_date": 1536591223, "answer_id": 52260479, "question_id": 52189782, "link": "https://stackoverflow.com/questions/52189782/procedure-to-change-credential-provider-guid-for-deployment/52260479#52260479", "title": "Procedure to change Credential Provider GUID for deployment", "body": "<p>Changing the GUID in <code>.vcproj</code>, <code>.vcxproj</code> and <code>.sln</code> files is not required.</p>\n\n<p>You must change the GUID in <code>guid.h</code>, <code>Register.reg</code> and <code>Unregister.reg</code> files.</p>\n"}], "owner": {"reputation": 141, "user_id": 10145818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2a32adad3350a8a2fb359dc3f902ad?s=128&d=identicon&r=PG&f=1", "display_name": "js.hrt", "link": "https://stackoverflow.com/users/10145818/js-hrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 52260479, "answer_count": 1, "score": 0, "last_activity_date": 1536591223, "creation_date": 1536164987, "last_edit_date": 1536165459, "question_id": 52189782, "link": "https://stackoverflow.com/questions/52189782/procedure-to-change-credential-provider-guid-for-deployment", "title": "Procedure to change Credential Provider GUID for deployment", "body": "<p>I have modified the 'SampleAllControlsCredentialProvider' from Windows Vista samples using Visual Studio 2013. I need to change its GUID before deploying it to the production systems. I have generated the GUID using visual studio create gui tool and changed the GUID in .vcproj, .vcxproj and .sln files. Also, put the same GUID in register.reg file. Now, the registry entries are made with this new GUID but credential provider does not load. If I use the old GUID in register.reg (that came with the sample), only then the credential provider loads on startup.</p>\n\n<p>As I am new to deployment of such projects involving GUIDs, what is the right way to change the GUID properly before deployment?</p>\n"}, {"tags": ["c++", "class"], "comments": [{"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 1, "creation_date": 1536165503, "post_id": 52189724, "comment_id": 91329478, "body": "is there any special reason that you do not want <code>std::vector&lt;Person&gt; personArray</code>?"}, {"owner": {"reputation": 87, "user_id": 9421462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fdb94dd6d864c2d7b4a9497284bcdf1?s=128&d=identicon&r=PG", "display_name": "Mark Scheer", "link": "https://stackoverflow.com/users/9421462/mark-scheer"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1536166608, "post_id": 52189724, "comment_id": 91329980, "body": "I am being tasked with using an array specifically. Vector is generally preferred because the size being dynamically adjusted, correct?"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1536166767, "post_id": 52189724, "comment_id": 91330053, "body": "Yes. But here the size seems to be fixed. Then you can use <a href=\"https://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"nofollow noreferrer\"><code>std::vector::reserve</code></a> to reserve the size of your array(probably in the constructor of  <code>Roster</code>) and no re allocation will occur. Or simply use <code>std::array</code> with a fixed size."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1536166826, "post_id": 52189724, "comment_id": 91330083, "body": "@MarkScheer First, there is no &quot;Person&quot; array anywhere in your code.  You have an array of pointers to Persons.  If you really did have a Person array, then it is a simple matter of creating a Person and assigning it to one of the array elements, no different than if you had an <code>int</code> array and want to assing an <code>int</code> to one of the array entries."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1536167606, "post_id": 52189724, "comment_id": 91330451, "body": "<i>Vector is generally preferred because the size being dynamically adjusted, correct?</i> -- Your <code>printPersonArray</code> accesses uninitialized pointers, since your loop just assumes there are 5 valid entries.  If there is any reason for <code>vector</code>, that alone is one of them, regardless if <code>vector</code> is dynamic or not."}, {"owner": {"reputation": 87, "user_id": 9421462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fdb94dd6d864c2d7b4a9497284bcdf1?s=128&d=identicon&r=PG", "display_name": "Mark Scheer", "link": "https://stackoverflow.com/users/9421462/mark-scheer"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1536167623, "post_id": 52189724, "comment_id": 91330456, "body": "@PaulMcKenzie - Thank you for the clarification. I am tasked with using the array of pointers to Person objects. I was not clear before."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536168572, "post_id": 52189724, "comment_id": 91330882, "body": "This is why you shouldn&#39;t store pointers in containers. Almost every time I&#39;ve seen it done, it&#39;s been done wrong. And if you want to do it, you are probably wrong. Exceptions to this rule include (but are not limited to) building &quot;indexes&quot; of things, but even then a std::weak_ptr will be appropriate and not be prone to scope mistakes like this."}], "answers": [{"tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": true, "score": 2, "last_activity_date": 1536171310, "last_edit_date": 1536171310, "creation_date": 1536166232, "answer_id": 52190049, "question_id": 52189724, "link": "https://stackoverflow.com/questions/52189724/exc-bad-access-when-adding-object-to-array/52190049#52190049", "title": "EXC_BAD_ACCESS when adding object to array", "body": "<p>The problem is here:</p>\n\n<pre><code>void addToPersonArray(string name, string age) {\n    Person person(name, stoi(age));\n    personArray[personCount] = &amp;person;\n}\n</code></pre>\n\n<p><code>person</code> is a local variable in the member function <code>addToPersonArray()</code>, which will be destroyed after the function scope. </p>\n\n<p>Hence, storing the address of a local variable(and trying to accessing it latter in <code>printPersonArray()</code>)  will give you, nothing but an <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You are lucky that your programme got the exception.</p>\n\n<hr>\n\n<p>One more thing to note that, you are not actually using your <code>roster</code> to test the program. Instead, all you do is parsing and saving to <code>result</code> vector. You can add this after the <code>while</code> loop, to make it actually work.</p>\n\n<pre><code>if (result.size() == 2) {\n     roster.addToPersonArray(result[0], result[1]);\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Suggestion</strong>: Since you have a fixed array size, you probably wanna do it with <code>std::array&lt;Person, 5&gt;</code> or with <code>std::vector&lt;Person&gt;</code> by <a href=\"https://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"nofollow noreferrer\">reserving the memory</a> for 5 <code>Person</code> in the c'tor of <code>Roster</code>.</p>\n\n<p>See a sample output: <a href=\"https://wandbox.org/permlink/tAGqqnhCfwz1wPrH\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/tAGqqnhCfwz1wPrH</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;vector&gt;\n#include &lt;array&gt;\n\nclass Person {\npublic:\n    Person(const std::string&amp; name, int age): name(name), age(age) {}\n    std::string getName()const { return name;   }\n    void setName(const std::string&amp; n){ name = n;   }\n    int getAge()const     { return age;     }\n    void setAge(int a)    { age = a;    }\nprivate:\n    std::string name;\n    int age;\n};\n\nclass Roster {\npublic:\n    Roster() { personArray.reserve(5); } // reserve some memory\n    void addToPersonArray(const std::string&amp; name, const std::string&amp; age) {\n        personArray.emplace_back(name, stoi(age));\n    }\n    void printPersonArray() {\n        // use range loop, which will assure, access what you have.\n        for (const Person&amp; person: personArray)\n            std::cout &lt;&lt; person.getName() &lt;&lt; '\\t' &lt;&lt; person.getAge() &lt;&lt; '\\n';\n    }\nprivate:\n    std::vector&lt;Person&gt; personArray;\n    //int personCount = 0; --------------&gt; no need anymore\n};\n\nint main() {\n    std::array&lt;std::string,5&gt; studentData{ \"Dan,45\", \"Mark,33\", \"Mary,22\", \"April,17\", \"Jill,22\" };\n    Roster roster;\n    for(const std::string&amp; str: studentData)\n    {\n        std::stringstream ss(str);\n        std::vector&lt;std::string&gt; result;    \n        while (ss.good()) {\n            std::string substr;\n            std::getline(ss, substr, ',');\n            result.emplace_back(substr);\n        }\n        if (result.size() == 2) {\n            roster.addToPersonArray(result\n                [0], result[1]);\n        }\n    }\n    roster.printPersonArray();\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Dan     45\nMark    33\nMary    22\nApril   17\nJill    22\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1536168639, "creation_date": 1536168639, "answer_id": 52190595, "question_id": 52189724, "link": "https://stackoverflow.com/questions/52189724/exc-bad-access-when-adding-object-to-array/52190595#52190595", "title": "EXC_BAD_ACCESS when adding object to array", "body": "<p>In addition to storing pointers to local variables in your <code>addToPersonArray()</code> function, your <code>main()</code> function does not add any entries to the <code>personArray</code>.  </p>\n\n<p>Instead, <code>main</code> creates a <code>Roster</code> object, and after some code that doesn't affect anything with <code>Roster</code>, you go straight into calling <code>roster.printPersonArray</code>, which does this:</p>\n\n<pre><code>void printPersonArray() \n{\n    for (int i = 0; i &lt; 5; i++)  // &lt;-- This will loop for all 5 entries\n        cout &lt;&lt; personArray[i]-&gt;getName() &lt;&lt; '\\t' &lt;&lt; personArray[i]-&gt;getAge() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Since <code>personArray</code> was never initialized to contain valid pointers to <code>Person</code> objects, that loop will cause undefined behavior.</p>\n\n<p>The issue is that you have a <code>personCount</code> member variable, but fail to make use of it to control how many valid entries there are in the array.  The loop should have been written as below:</p>\n\n<pre><code>void printPersonArray() \n{\n    for (int i = 0; i &lt; personCount; i++)  \n        cout &lt;&lt; personArray[i]-&gt;getName() &lt;&lt; '\\t' &lt;&lt; personArray[i]-&gt;getAge() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>In addition to the storage of pointers to local variables, your <code>Roster::addToPersonArray()</code> doesn't check if <code>personCount</code> is greater than 4, thus this is another place in your code where you failed to use <code>personCount</code> to control how many <code>Person</code> objects are being referenced.</p>\n"}], "owner": {"reputation": 87, "user_id": 9421462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fdb94dd6d864c2d7b4a9497284bcdf1?s=128&d=identicon&r=PG", "display_name": "Mark Scheer", "link": "https://stackoverflow.com/users/9421462/mark-scheer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 52190049, "answer_count": 2, "score": 0, "last_activity_date": 1536209363, "creation_date": 1536164770, "last_edit_date": 1536209363, "question_id": 52189724, "link": "https://stackoverflow.com/questions/52189724/exc-bad-access-when-adding-object-to-array", "title": "EXC_BAD_ACCESS when adding object to array", "body": "<p>I am new programming and C++. I am trying to create a <code>Roster</code> of <code>Person</code> objects using an array and then printing the attributes of the People in the <code>Roster</code>.</p>\n\n<p>When I attempt to add a Person to the <code>personArray</code>, I am getting an </p>\n\n<pre><code>Exception = EXC_BAD_ACCESS (code=1, address=0x0).\n</code></pre>\n\n<p>I think this has to do with the scope of my <code>personArray</code> but I can't seem to figure it out.</p>\n\n<p>Here is the code I am using:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nclass Person \n{\npublic:\n    Person(string name, int age);\n    string getName() {\n        return name;\n    }\n    void setName(string n) {\n        name = n;\n    }\n    int getAge() {\n        return age;\n    }\n    void setAge(int a) {\n        age = a;\n    }\nprivate:\n    string name;\n    int age;\n};\n\nclass Roster {\npublic:\n    void addToPersonArray(string name, string age) {\n        Person person(name, stoi(age));\n        personArray[personCount] = &amp;person;\n    }\n    void printPersonArray() {\n        for (int i = 0; i &lt; 5; i++)\n            cout &lt;&lt; personArray[i]-&gt;getName() &lt;&lt; '\\t' &lt;&lt; personArray[i]-&gt;getAge() &lt;&lt; '\\n';\n    }\nprivate:\n    Person *personArray[5];\n    int personCount = 0;\n};\n\nint main() {\n    const string studentData[] = {\"Dan,45\", \"Mark,33\", \"Mary,22\", \n\"April,17\", \"Jill,22\"};\n    Roster roster;\n\n    stringstream ss(studentData[0]); // just testing the first entry\n    vector&lt;string&gt; result;\n\n    while (ss.good()) {\n        string substr;\n        getline(ss, substr, ',');\n        result.push_back(substr);\n    }\n    roster.printPersonArray();\n}\n</code></pre>\n"}, {"tags": ["c++", "tensorflow"], "comments": [{"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1536224799, "post_id": 52189676, "comment_id": 91349886, "body": "Umh, that&#39;s a strange error. Can you put another print statement after <code>session-&gt;Run(...);</code>, to know whether the problem is with <code>Run</code> or reading the output data? Also, <code>Run</code> returns a <a href=\"https://www.tensorflow.org/api_docs/cc/class/tensorflow/status#classtensorflow_1_1_status\" rel=\"nofollow noreferrer\"><code>Status</code></a>, you should always check it to make sure things went well before trying to retrieve the output."}, {"owner": {"reputation": 63, "user_id": 10255946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uiaa6ihgGgk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO-QGKsv-nLbIgUhaGlFXl6xS4FJA/mo/photo.jpg?sz=128", "display_name": "Ross", "link": "https://stackoverflow.com/users/10255946/ross"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1536237476, "post_id": 52189676, "comment_id": 91357629, "body": "I did and it is the run command that is breaking"}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1536238461, "post_id": 52189676, "comment_id": 91358246, "body": "I don&#39;t think this should make any difference but have you tried to pass the tensors to <code>get_prediction</code> by reference instead of by copy? In theory tensor copies share the internal storage and should work without problem but just in case there might be something wrong with that?"}, {"owner": {"reputation": 63, "user_id": 10255946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uiaa6ihgGgk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO-QGKsv-nLbIgUhaGlFXl6xS4FJA/mo/photo.jpg?sz=128", "display_name": "Ross", "link": "https://stackoverflow.com/users/10255946/ross"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1536238648, "post_id": 52189676, "comment_id": 91358356, "body": "Yeah I&#39;ve tried that as well unfortunately along with a bunch of other stuff. I am going off [this example] (<a href=\"https://github.com/sansinghsanjay/loading_python_tensorflow_model_in_cpp_tensorflow/blob/c520ab95c1ea7a3fba7f1576a45ffaa4641a3a1d/cpp_code/loading_mnist_model.cpp\" rel=\"nofollow noreferrer\">github.com/sansinghsanjay/&hellip;</a>) and that seems to be working but mine isn&#39;t. My program also seg faults randomly but only sometimes."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 10255946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uiaa6ihgGgk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO-QGKsv-nLbIgUhaGlFXl6xS4FJA/mo/photo.jpg?sz=128", "display_name": "Ross", "link": "https://stackoverflow.com/users/10255946/ross"}, "edited": false, "score": 0, "creation_date": 1536165749, "post_id": 52189874, "comment_id": 91329587, "body": "Thanks! That&#39;s what I had originally so I must be doing something else wrong in my code."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 63, "user_id": 10255946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uiaa6ihgGgk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO-QGKsv-nLbIgUhaGlFXl6xS4FJA/mo/photo.jpg?sz=128", "display_name": "Ross", "link": "https://stackoverflow.com/users/10255946/ross"}, "edited": false, "score": 1, "creation_date": 1536165906, "post_id": 52189874, "comment_id": 91329664, "body": "@Ross Well if this is giving you trouble maybe you can update the question with the code and the output you are seeing (or open a new question if you prefer)."}], "tags": [], "owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "is_accepted": false, "score": 5, "last_activity_date": 1536165410, "creation_date": 1536165410, "answer_id": 52189874, "question_id": 52189676, "link": "https://stackoverflow.com/questions/52189676/how-to-set-element-of-3d-tensorflow-tensor-c/52189874#52189874", "title": "How to set element of 3D tensorflow Tensor c++", "body": "<p>You can access the data as an <a href=\"http://eigen.tuxfamily.org/index.php?title=Tensor_support\" rel=\"noreferrer\">Eigen tensor</a> (or more precisely an <code>Eigen::TensorMap</code>) through the <a href=\"https://www.tensorflow.org/api_docs/cc/class/tensorflow/tensor#tensor_20\" rel=\"noreferrer\"><code>tensor</code></a> method:</p>\n\n<pre><code>inputX.tensor&lt;double, 3&gt;()(0, 0, 3) = 2.5;\n</code></pre>\n\n<p>You can also access the data through <a href=\"https://www.tensorflow.org/api_docs/cc/class/tensorflow/tensor#flat\" rel=\"noreferrer\"><code>flat</code></a> and <a href=\"https://www.tensorflow.org/api_docs/cc/class/tensorflow/tensor#shaped\" rel=\"noreferrer\"><code>shaped</code></a>:</p>\n\n<pre><code>inputY.flat&lt;int32&gt;()(0) = 5;\n*inputY.shaped&lt;int32, 1&gt;({1}).data() = 10;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 10255946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uiaa6ihgGgk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO-QGKsv-nLbIgUhaGlFXl6xS4FJA/mo/photo.jpg?sz=128", "display_name": "Ross", "link": "https://stackoverflow.com/users/10255946/ross"}, "is_accepted": true, "score": 0, "last_activity_date": 1536248264, "creation_date": 1536248264, "answer_id": 52207714, "question_id": 52189676, "link": "https://stackoverflow.com/questions/52189676/how-to-set-element-of-3d-tensorflow-tensor-c/52207714#52207714", "title": "How to set element of 3D tensorflow Tensor c++", "body": "<p>Figured it out- I was incorrectly accessing the Tensor inputX with the line\ninputX.matrix()(0,col_no) = temp; because I was calling an index outside of the 14 initialized.</p>\n"}], "owner": {"reputation": 63, "user_id": 10255946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uiaa6ihgGgk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO-QGKsv-nLbIgUhaGlFXl6xS4FJA/mo/photo.jpg?sz=128", "display_name": "Ross", "link": "https://stackoverflow.com/users/10255946/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 2, "accepted_answer_id": 52207714, "answer_count": 2, "score": 3, "last_activity_date": 1536248264, "creation_date": 1536164495, "last_edit_date": 1536168674, "question_id": 52189676, "link": "https://stackoverflow.com/questions/52189676/how-to-set-element-of-3d-tensorflow-tensor-c", "title": "How to set element of 3D tensorflow Tensor c++", "body": "<p>I have the following 3D tensor below:</p>\n\n<pre><code>auto inputX = Tensor(DT_DOUBLE, TensorShape({1,1,9}));\n</code></pre>\n\n<p>How would I set a value to an element in the tensor?</p>\n\n<p>Additionally for the 1D tensor below how would I set a value?</p>\n\n<pre><code>auto inputY = Tensor(DT_INT32, TensorShape({1}));\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>UPDATE BELOW:</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fstream&gt;\n#include &lt;string.h&gt;\n#include &lt;vector&gt;\n#include &lt;sstream&gt;\n#include &lt;typeinfo&gt;\n#include &lt;sys/time.h&gt;\n#include \"tensorflow/cc/client/client_session.h\"\n#include \"tensorflow/cc/ops/standard_ops.h\"\n#include \"tensorflow/core/framework/tensor.h\"\n#include \"tensorflow/core/public/session.h\"\n#include \"tensorflow/core/platform/env.h\"\n\nusing namespace std;\nusing namespace tensorflow;\nusing namespace tensorflow::ops;\n\nSession* session; // tensorflow session\nStatus status;  // tensorflow status\n\ndouble get_prediction(Tensor a);\n\ndouble get_prediction(Tensor a, Tensor b) {\n\n  double prediction;\n  vector&lt;Tensor&gt; outputs;\n\n  // preparing input\n  // TODO: Update this line\n  std::vector&lt;std::pair&lt;string, tensorflow::Tensor&gt;&gt; inputs = {{\"InputDataLayer/InputXPlaceHolder\", a}, {\"InputDataLayer/LabelYPlaceHolder\", b}};\n\n  // getting prediction for test data\n  // TODO: Update this line\n  printf(\"Reached5\");\n  status = session-&gt;Run(inputs, {\"OutputLayer/outputLogits\"}, {}, &amp;outputs);\n\n  if (!status.ok()) {\n    cout&lt;&lt;\"Error@get_prediction: \"&lt;&lt;status.ToString()&lt;&lt;\"\\n\";\n    return 1l;\n  }\n\n  prediction = outputs[0].scalar&lt;double&gt;()(0);\n\n  return prediction;\n}\n\nint main(int argc, char *argv[]) {\n\n  ifstream f;\n  string line = \"\";\n  string token = \"\";\n  double temp = 0.0;\n  int temp1 = 0;\n  double matches = 0.0, accuracy = 0.0;\n  int row_no=0, col_no=0;\n  double prediction = 0.0, actual = 0.0;\n\n  status = NewSession(SessionOptions(), &amp;session);\n  if (!status.ok()) {\n    std::cout &lt;&lt; status.ToString() &lt;&lt; \"\\n\";\n    return 1;\n  }\n\n  GraphDef graph_def;\n\n  status = ReadTextProto(Env::Default(), \"/home/user/Desktop/tensorflow/tensorflow/loader/models.pbtxt\", &amp;graph_def);\n\n  if (!status.ok()) {\n    std::cout &lt;&lt; status.ToString() &lt;&lt; \"\\n\";\n    return 1;\n  }\n\n  status = session-&gt;Create(graph_def);\n  if (!status.ok()) {\n    std::cout &lt;&lt; status.ToString() &lt;&lt; \"\\n\";\n    return 1;\n  }\n\n  session-&gt;Run({}, {}, {\"init_all_vars_op\"}, nullptr); //Initializes all the variables in C++\n\n  printf(\"Reached1\");\n\n  auto inputX = Tensor(DT_DOUBLE, TensorShape({1,1,9}));\n  auto inputY = Tensor(DT_INT32, TensorShape({1}));\n\n  printf(\"Reached2\");\n\n  f.open(\"/home/user/Desktop/tensorflow/tensorflow/loader/signals_p.csv\"); //processed csv\n\n  while(getline(f, line)) {\n\n    if (row_no == 0) {\n        row_no += 1;\n        continue;\n    }\n\n    istringstream iss(line);\n\n    while(getline(iss, token, ',')) {\n\n      // filling feature tensors\n      if(col_no &gt;= 6 &amp;&amp; col_no &lt;= 14) {\n        temp = stod(token.c_str());\n        printf(\"Reached3\");\n        inputX.tensor&lt;double,3&gt;()(0, 0,col_no) = temp;\n      }\n\n      // filling label tensor\n      if(col_no == 16) {\n        temp1 = stoi(token.c_str());\n        actual = temp1;\n        inputY.vec&lt;int&gt;()(col_no) = temp1;\n      }\n\n      col_no += 1;\n\n   }\n\n    col_no = 0;\n    row_no += 1;\n\n    printf(\"Reached4\");\n    // getting prediction\n    prediction = get_prediction(inputX, inputY);\n\n    // if actual and prediction matches, increment matches\n    if(actual == prediction)\n      matches += 1;\n  }\n\n  accuracy = matches / (row_no);\n  cout&lt;&lt;\"Total Rows: \"&lt;&lt;(row_no)&lt;&lt;endl;\n  cout&lt;&lt;\"Accuracy: \"&lt;&lt;accuracy&lt;&lt;endl;\n\n  session-&gt;Close();\n  return 0;\n}\n</code></pre>\n\n<p>I am trying to read a .pbtxt file and perform inference in C++. Here is a visualization of my .pbtxt file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/27tTT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/27tTT.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/NOWYh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NOWYh.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/g1zjU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g1zjU.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/CXjr5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CXjr5.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5v6vw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5v6vw.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code is breaking right after the \"Reached5\" print statement.\nOutput is as follows:</p>\n\n<pre><code>*** Error in `./ml': corrupted double-linked list: 0x0000000004fa1290 ***\n</code></pre>\n"}, {"tags": ["c++", "qt", "sockets", "udp"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536164698, "post_id": 52189251, "comment_id": 91329093, "body": "<code>bool</code>ean variables should be set to/tested against <code>true</code>/<code>false</code>, not <code>1</code>/<code>0</code>. Even though it&#39;s <i>possible</i> it&#39;s just a bad idea and confusing (you make readers think it&#39;s a <code>int</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536164507, "post_id": 52189444, "comment_id": 91329010, "body": "What would error checking look like in this case? This is a stripped down version of my code where the problem lies, idk, but I might have &quot;error checking&quot; already, would you mind clarifying?"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 1, "creation_date": 1536171898, "post_id": 52189444, "comment_id": 91332419, "body": "When you call a method on a socket, don&#39;t ignore its return value unless you can explain why you do so. In your example code you must check return values of <code>bind</code>, <code>writeDatagram</code>, etc."}, {"owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536259091, "post_id": 52189444, "comment_id": 91369977, "body": "I&#39;ve been working on this again for a day and I am not sure where it is trying to bind the port again. It binds it once then moves to ready read. Where is the second failed bind?"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536331214, "post_id": 52189444, "comment_id": 91398719, "body": "Ports for a given IP address+IP protocol pair are a system-global resource. You have to think of all the processes that bind to the ports, not just the one process you think of. Remember that you&#39;re starting <i>two</i> processes. They <i>each</i> try to bind. Only the first <i>process</i> will succeed. And no other <i>process</i> will until the very first process terminate or unbind the socket, whichever comes first. It doesn&#39;t matter that <i>within the process</i> you only bind once - you bind multiple times across the processes."}, {"owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536347563, "post_id": 52189444, "comment_id": 91406311, "body": "Thank you, I fixed the problem. If you have time, how would I get the ports to change with each instance I bring up?"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536371985, "post_id": 52189444, "comment_id": 91412175, "body": "For the either socket: just don&#39;t specify the bind port - remove the port argument. <code>bind()</code> will then bind to a random port. You don&#39;t need a fixed receive port as long as one end of the conversation has a known port number. The endpoint <code>R</code> with a random port first sends a packet to the other endpoint <code>K</code> with known port. The <code>K</code>endpoint sets up a &quot;conversation partner&quot; record for the host_address/random_port combination of the <code>R</code> endpoint, and sends all replies to <code>R</code> based on that record. The record would keep the state of the protocol that runs on top of UDP, i.e. pending command, etc."}], "tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1536163698, "creation_date": 1536163698, "answer_id": 52189444, "question_id": 52189251, "link": "https://stackoverflow.com/questions/52189251/how-to-constantly-read-udp-packets-in-qt/52189444#52189444", "title": "How to constantly read UDP packets in QT?", "body": "<p>That's to be expected: each invocation of the process attempts to bind the input socket. The first time, with the socket not bound yet - it succeeds. The second time - it fails, as the port is already bound - so reading won't work. Everything aside, <strong>the code never checks for errors</strong>, and thus leaves the user (i.e. you) unaware that things have failed. With error checking it'd be obvious why it doesn't work. The output socket doesn't need to be bound to an explicitly specified port number. The input socket should only be bound when the program is in receive mode.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536168709, "post_id": 52190303, "comment_id": 91330963, "body": "I use buttons to change the state. When Read is pressed, <code>readMode</code> is changed to true and when Write is pressed <code>readMode</code> is changed to false."}, {"owner": {"reputation": 61, "user_id": 933585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbyI.jpg?s=128&g=1", "display_name": "Rinat Gadelshin", "link": "https://stackoverflow.com/users/933585/rinat-gadelshin"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536169072, "post_id": 52190303, "comment_id": 91331115, "body": "So  we have the following scenario:"}, {"owner": {"reputation": 61, "user_id": 933585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbyI.jpg?s=128&g=1", "display_name": "Rinat Gadelshin", "link": "https://stackoverflow.com/users/933585/rinat-gadelshin"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536169190, "post_id": 52190303, "comment_id": 91331170, "body": "2. push &#39;&#39;Write&quot; button and the readMode is set to false and a datagrame  will be sent"}, {"owner": {"reputation": 61, "user_id": 933585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbyI.jpg?s=128&g=1", "display_name": "Rinat Gadelshin", "link": "https://stackoverflow.com/users/933585/rinat-gadelshin"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536169286, "post_id": 52190303, "comment_id": 91331217, "body": "3.  readyRead() called (by  socket&#39;s signal) but  readMode is false and we don&#39;t read received datagram."}, {"owner": {"reputation": 61, "user_id": 933585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbyI.jpg?s=128&g=1", "display_name": "Rinat Gadelshin", "link": "https://stackoverflow.com/users/933585/rinat-gadelshin"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536169334, "post_id": 52190303, "comment_id": 91331241, "body": "4. Next  writing will not  produce socket&#39;s readyRead  signal and  our readyRead slot will not  be called."}, {"owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536172660, "post_id": 52190303, "comment_id": 91332769, "body": "I follow up until step 4 why isn&#39;t readyRead signal produced. For clarification I am opening two instances of this program and I set one to Read and the other to Write."}, {"owner": {"reputation": 61, "user_id": 933585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbyI.jpg?s=128&g=1", "display_name": "Rinat Gadelshin", "link": "https://stackoverflow.com/users/933585/rinat-gadelshin"}, "reply_to_user": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1536178542, "post_id": 52190303, "comment_id": 91335319, "body": "my application just present, that readyRead will not be emitted till the socket has at least one not read datagram. The steps descibed above are all about your program."}], "tags": [], "owner": {"reputation": 61, "user_id": 933585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbyI.jpg?s=128&g=1", "display_name": "Rinat Gadelshin", "link": "https://stackoverflow.com/users/933585/rinat-gadelshin"}, "is_accepted": false, "score": 1, "last_activity_date": 1536168738, "last_edit_date": 1536168738, "creation_date": 1536167357, "answer_id": 52190303, "question_id": 52189251, "link": "https://stackoverflow.com/questions/52189251/how-to-constantly-read-udp-packets-in-qt/52190303#52190303", "title": "How to constantly read UDP packets in QT?", "body": "<p>QUdpSocket doesn't emit readyRead if it already contains (not read) datagramms when it receives a new datagram. You source code doesn't complete. So we can't see how do you change your global variable 'readMode'.</p>\n\n<p>here the simple demo application:</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QWidget&gt;\n#include &lt;QUdpSocket&gt;\n#include &lt;QPushButton&gt;\n#include &lt;QListWidget&gt;\n#include &lt;QGridLayout&gt;\n#include &lt;QDebug&gt;\n#include &lt;QUuid&gt;\n\nint main( int argc, char** argv ) {\n    QApplication app( argc, argv );\n\n    QWidget form;\n    auto*const log_widget = new QListWidget( &amp;form );\n    auto*const client = new QUdpSocket( qApp );\n    auto*const server = new QUdpSocket( qApp );\n    const quint16 TEST_PORT = 31088;\n\n    if( ! server-&gt;bind( QHostAddress::LocalHost, TEST_PORT ) ) {\n        exit( 1 );\n    }\n\n    QObject::connect( server, &amp;QUdpSocket::readyRead, [=]() {\n        log_widget-&gt;insertItem( 0, \"readyRead() has been received\" );\n    });\n\n    auto*const write_button = new QPushButton( \"&amp;Write\", &amp;form );\n    QObject::connect( write_button, &amp;QPushButton::clicked, [=]() {\n        const auto packet = QUuid::createUuid().toByteArray();\n        client-&gt;writeDatagram( packet, QHostAddress::LocalHost, TEST_PORT );\n        log_widget-&gt;insertItem( 0, \"A datagram has been sent.\" );\n    });\n\n    auto*const read_button = new QPushButton( \"&amp;Read\", &amp;form );\n    QObject::connect( read_button, &amp;QPushButton::clicked, [=]() {\n        if( server-&gt;hasPendingDatagrams() ) {\n            const int size = static_cast&lt; int &gt;( server-&gt;pendingDatagramSize() );\n            if( size &gt; 0 ) {\n                QByteArray packet;\n                packet.resize( size );\n                server-&gt;readDatagram( packet.data(), size );\n                log_widget-&gt;insertItem( 0, \"Read OK: datagram have been read.\" );\n            } else {\n                log_widget-&gt;insertItem( 0, \"Read Error: invalid datagram size.\" );\n            }\n        } else {\n            log_widget-&gt;insertItem( 0, \"Read Error: there is no any datagram.\" );\n        }\n    });\n\n    auto*const check_button = new QPushButton( \"&amp;Check\", &amp;form );\n    QObject::connect( check_button, &amp;QPushButton::clicked, [=]() {\n        if( server-&gt;hasPendingDatagrams() ) {\n            log_widget-&gt;insertItem( 0, \"Check: there is at least one datagram.\" );\n        } else {\n            log_widget-&gt;insertItem( 0, \"Check: there is no any datagram.\" );\n        }\n    });\n\n    auto*const grid = new QGridLayout( &amp;form );\n    grid-&gt;addWidget( write_button, 0, 0 );\n    grid-&gt;addWidget( read_button, 0, 1 );\n    grid-&gt;addWidget( check_button, 0, 2 );\n    grid-&gt;addWidget( log_widget, 1, 0, 1, 3 );\n\n    form.show();\n\n    return app.exec();\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 52189444, "answer_count": 2, "score": 2, "last_activity_date": 1536172755, "creation_date": 1536162972, "last_edit_date": 1536172755, "question_id": 52189251, "link": "https://stackoverflow.com/questions/52189251/how-to-constantly-read-udp-packets-in-qt", "title": "How to constantly read UDP packets in QT?", "body": "<p>I am sending myself UDP packets generally using this method here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42714700/how-to-receive-proper-udp-packet-in-qt\">How to receive proper UDP packet in QT?</a></p>\n\n<p>I am setting up modes so that in Write mode, it sends UDP packets every second, and in Read mode, it just receives packets. To do this I set up a simple boolean variable called <code>readmode</code> when readmode = <code>true</code> it reads and writes when = <code>false</code>. I left the <code>connect(socket, SIGNAL(readyRead()), this,SLOT(readyRead()));</code> and the call to the send function in the <code>MainWindow</code> constructor and put the <code>if</code> statements, testing the state of <code>readMode</code> to actually do something, in the send function and <code>readyRead()</code> function themselves.</p>\n\n<p>My problem is that I only receive packets whenever I start the program in Read mode first before opening the window for the program to write. If I start sending packets before I open the Read program, I get nothing.</p>\n\n<p>For clarification I am opening two instances of this program and I set one to Read and the other to Write, but the Read has to be started first for it to work, but once states are changed, it stops working. </p>\n\n<p>How can I get it to read all the time?</p>\n\n<p>Code sample:</p>\n\n<pre><code>bool readMode = true; //Write mode = false, Read Mode = true\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n    timer = new QTimer(this);\n    timer-&gt;start(1000);\n\n    ui-&gt;buttonBox-&gt;button(QDialogButtonBox::Ok)-&gt;setText(\"Read\");\n    ui-&gt;buttonBox-&gt;button(QDialogButtonBox::Cancel)-&gt;setText(\"Write\");\n\n    out_socket = new QUdpSocket(this);\n    out_socket-&gt;bind(60500);\n\n    in_socket = new QUdpSocket(this);\n    in_socket-&gt;bind(60510);\n\n    connect(timer, SIGNAL(timeout()),this,SLOT(UDP_test()));\n\n    connect(in_socket,SIGNAL(readyRead()),this,SLOT(readyRead()));\n}    \n\nvoid MainWindow::UDP_test()                                             //Write Mode\n{    \nif (readMode == false) //Write Mode                                         \n{\n\n    QByteArray Data;\n    Data.append(fullResultString);\n    out_socket-&gt;writeDatagram(Data,QHostAddress(\"192.168.127.10\"),60510);\n}           \n\nvoid MainWindow::readyRead()                                            //Read Mode\n{\n    if (readMode == true) //Readmode\n    {\n        while(in_socket-&gt;hasPendingDatagrams())\n        {\n            QByteArray UDPBuffer;\n\n             UDPBuffer.resize(in_socket-&gt;pendingDatagramSize());\n             QHostAddress sender;\n             quint16 senderPort;\n             in_socket-&gt;readDatagram(UDPBuffer.data(),UDPBuffer.size(), &amp;sender, &amp;senderPort);\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "recursion"], "comments": [{"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1536163291, "post_id": 52189137, "comment_id": 91328372, "body": "why don&#39;t you focus on writing a recursive function which compute the product and merely display its result ?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1536163724, "post_id": 52189137, "comment_id": 91328596, "body": "Debugger.  Use a debugger.  A debugger will allow you to step through your code line by line and <i>watch</i> values of variables.  Often, debugging your program is faster than correctly posting to StackOverflow and waiting for somebody to inspect or debug your program for you."}], "answers": [{"comments": [{"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1536164136, "post_id": 52189512, "comment_id": 91328822, "body": "note that I assume here that the array has at least n elements."}], "tags": [], "owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "is_accepted": false, "score": 0, "last_activity_date": 1536164486, "last_edit_date": 1536164486, "creation_date": 1536163913, "answer_id": 52189512, "question_id": 52189137, "link": "https://stackoverflow.com/questions/52189137/writing-a-c-recursive-function-that-computes-and-displays-the-product-of-the-f/52189512#52189512", "title": "Writing a C++ recursive function that computes and displays the product of the first n doubles in an array", "body": "<p>The function you wrote doesnt have an explicit return value if n != 1. This is undefined behavior, which in your case means the value effectively returned is garbage.</p>\n\n<p>A simple modification to your program does the trick. Note that you need to account for sizes smaller than 1 otherwise you are going to have a segfault.</p>\n\n<pre><code>double computeProduct(const double anArray[], int n)\n{\n    if (n &lt;= 0) {\n        return 0.0;\n    } else if (n == 1) {\n        return anArray[0];\n    }\n    else {\n        return anArray[n-1] * computeProduct(anArray, n-1);    \n    }\n}\n...\ncout &lt;&lt; computeProduct(Array, 4)&lt;&lt; endl;\n</code></pre>\n\n<p>The best recursive function is broken in two, one using an accumulator, and the other which provide the desired interface :</p>\n\n<pre><code>double computeProductAcc(const double anArray[], int n, double acc)\n{\n    if (n &lt;= 0) {\n        return acc;\n    } else {\n        return  computeProductAcc(anArray, n-1, anArray[n-1] * acc); \n    }\n}\n\ndouble computeProduct(const double anArray[], int arraySize, int n) \n{\n    if(n &gt; arraySize || n &lt;= 0) {\n      return 0.0\n    }\n    return computeProductAcc(anArray, n, 1.0)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "is_accepted": false, "score": 2, "last_activity_date": 1536172776, "last_edit_date": 1536172776, "creation_date": 1536164312, "answer_id": 52189625, "question_id": 52189137, "link": "https://stackoverflow.com/questions/52189137/writing-a-c-recursive-function-that-computes-and-displays-the-product-of-the-f/52189625#52189625", "title": "Writing a C++ recursive function that computes and displays the product of the first n doubles in an array", "body": "<p>Your function computeProduct() works only when n = 1. Otherwise, it returns an undefined value. \nYour compiler probably gave you a warning such as \"Not all control paths return a value\". </p>\n\n<p>One way to fix this is adding an additional variable:</p>\n\n<pre><code> double computeProduct(const double anArray[], int n)\n {                \n     double product = 0.0; \n\n     if (n == 1) {                        \n         product = anArray[0];                        \n     }\n     else {\n         product = anArray[n-1] * computeProduct(anArray, n-1);                        \n     }                \n     //add your debug information here ...\n     cout &lt;&lt; \"return value for index n = \" &lt;&lt; n &lt;&lt; \" is \" &lt;&lt; product;\n\n     return product ;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10321150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4fb5867aeebd18ace3adf404c0949bf?s=128&d=identicon&r=PG&f=1", "display_name": "LeGuepard", "link": "https://stackoverflow.com/users/10321150/leguepard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1536172776, "creation_date": 1536162642, "question_id": 52189137, "link": "https://stackoverflow.com/questions/52189137/writing-a-c-recursive-function-that-computes-and-displays-the-product-of-the-f", "title": "Writing a C++ recursive function that computes and displays the product of the first n doubles in an array", "body": "<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nvoid countDown(int n);\ndouble computeProduct(const double anArray[], int n);\n\nint main()\n{\n    //Stand alone test of computeProduct function.\n\n    double Array[10] = {1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0};\n    computeProduct(Array, 4);\n    cout &lt;&lt; endl;\n    system(\"pause\");\n\n\n\n    return 0;\n}\ndouble computeProduct(const double anArray[], int n)\n{\n\n    if (n == 1) {\n\n        return anArray[0];\n\n    }\n    else {\n\n        cout &lt;&lt; anArray[n-1] * computeProduct(anArray, n-1);    \n\n    }\n}\n</code></pre>\n\n<p>This should work, but for some reason when I run the program the console returns:\n2-nan(ind)-nan(ind)\nPress any key to continue...</p>\n\n<p>I have never seen -nan(ind) before and have no idea what to do or what I did.<br>\nAny and all help would be greatly appreciated!  :)</p>\n"}, {"tags": ["c++", "vector", "linear-algebra", "rotational-matrices"], "comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536167347, "post_id": 52189123, "comment_id": 91330339, "body": "You could simplify to <code>rcos=dot(normal,direction)</code> and <code>rsin=norm(V)</code>."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1536167566, "post_id": 52189123, "comment_id": 91330440, "body": "Then to solve your problem, add this line before computing matrix elements: <code>V=V&#47;norm(V)</code>. The axis vector must be normalized ;)!"}, {"owner": {"reputation": 647, "user_id": 605710, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/EAnHE.png?s=128&g=1", "display_name": "bsabiston", "link": "https://stackoverflow.com/users/605710/bsabiston"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536176909, "post_id": 52189123, "comment_id": 91334625, "body": "Adding the normalization did not fix it, unfortunately."}, {"owner": {"reputation": 647, "user_id": 605710, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/EAnHE.png?s=128&g=1", "display_name": "bsabiston", "link": "https://stackoverflow.com/users/605710/bsabiston"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536183447, "post_id": 52189123, "comment_id": 91337180, "body": "Could this be made for a left-handed coordinate system?  I am using Metal and I think I have a right-handed coordinate system.   Would that make a difference?"}, {"owner": {"reputation": 647, "user_id": 605710, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/EAnHE.png?s=128&g=1", "display_name": "bsabiston", "link": "https://stackoverflow.com/users/605710/bsabiston"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1536183960, "post_id": 52189123, "comment_id": 91337334, "body": "Yes, that was the problem!  I read that in order to switch between right and left-handed systems, you can just reverse the angle of rotation.  So I multiply phi by -1 and it works, finally.  Whew."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536217391, "post_id": 52189123, "comment_id": 91345653, "body": "An other way to change orientation is to reverse the cross product: <code>V=cross(direction,normal)</code>."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536217515, "post_id": 52189123, "comment_id": 91345718, "body": "Also consider the special cases where <code>norm(V)&lt;1e-6</code>. And finaly, also take into account error propagation, the computation can be simplified if you consider the fact that <code>rsin=norm(V)</code>."}, {"owner": {"reputation": 647, "user_id": 605710, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/EAnHE.png?s=128&g=1", "display_name": "bsabiston", "link": "https://stackoverflow.com/users/605710/bsabiston"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536270010, "post_id": 52189123, "comment_id": 91374415, "body": "what do you mean by norm()?  Metal does not have that.  I was thinking it was the same thing as length(), except that does not work.  I am fine with sin() as long as it works."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1536277924, "post_id": 52189123, "comment_id": 91376438, "body": "Note that there is no <i>unique</i> way to rotate from one vector to another: there is always one free continuous parameter, or two if the vectors are opposite.  In the one-parameter case, there is, however, a <i>smallest</i> rotation, which is usually what is meant."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1536300329, "post_id": 52189123, "comment_id": 91381173, "body": "<a href=\"https://en.m.wikipedia.org/wiki/Norm_(mathematics)\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Norm_(mathematics)</a>"}, {"owner": {"reputation": 647, "user_id": 605710, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/EAnHE.png?s=128&g=1", "display_name": "bsabiston", "link": "https://stackoverflow.com/users/605710/bsabiston"}, "edited": false, "score": 0, "creation_date": 1536327770, "post_id": 52189123, "comment_id": 91396717, "body": "so, length?  That doesn&#39;t work."}], "owner": {"reputation": 647, "user_id": 605710, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/EAnHE.png?s=128&g=1", "display_name": "bsabiston", "link": "https://stackoverflow.com/users/605710/bsabiston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1085, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536184060, "creation_date": 1536162579, "last_edit_date": 1536184060, "question_id": 52189123, "link": "https://stackoverflow.com/questions/52189123/calculate-rotation-matrix-to-transform-one-vector-to-another", "title": "Calculate rotation matrix to transform one vector to another?", "body": "<p>There are several questions about this on Stack Overflow, but most use Quaternions and I am looking for something that does not.  And this question is all over the web, but it is surprisingly hard to find a straightforward example in code.  I am looking for a C/C++, or GLSL/Metal solution for the rotation matrix to transform one vector to another.  I found this which seems to answer the question: <a href=\"http://www.j3d.org/matrix_faq/matrfaq_latest.html#Q38\" rel=\"nofollow noreferrer\">http://www.j3d.org/matrix_faq/matrfaq_latest.html#Q38</a></p>\n\n<p>However, it is not working for me in practice.  With this I am getting the correct transformations at the ninety-degree angles (ie transforming 0,0,1 to 0,1,0), but in between it twists in the wrong direction.  Here is the code I am using -- does anyone see what is wrong with it?</p>\n\n<p>In this case I am always transforming from a fixed start normal of (0,0,1).</p>\n\n<pre><code>// matrix to rotate from (0,0,1) to specified direction\n\nfloat4x4 directionMatrix(float3 direction) {\n\n    float3 normal = float3(0.0,0.0,1.0);\n    float3 V = normalize(cross(normal, direction));\n    float phi = acos(dot(normal,direction));\n\n    float rcos = cos(phi);\n    float rsin = sin(phi);\n\n    float4x4 M;\n\n    M[0].x =        rcos + V.x * V.x * (1.0 - rcos);\n    M[1].x =  V.z * rsin + V.y * V.x * (1.0 - rcos);\n    M[2].x = -V.y * rsin + V.z * V.x * (1.0 - rcos);\n    M[3].x = 0.0;\n\n    M[0].y = -V.z * rsin + V.x * V.y * (1.0 - rcos);\n    M[1].y =        rcos + V.y * V.y * (1.0 - rcos);\n    M[2].y = -V.x * rsin + V.z * V.y * (1.0 - rcos);\n    M[3].y = 0.0;\n\n    M[0].z =  V.y * rsin + V.x * V.z * (1.0 - rcos);\n    M[1].z = -V.x * rsin + V.y * V.z * (1.0 - rcos);\n    M[2].z =        rcos + V.z * V.z * (1.0 - rcos);\n    M[3].z = 0.0;\n\n    M[0].w = 0.0;\n    M[1].w = 0.0;\n    M[2].w = 0.0;\n    M[3].w = 1.0;\n\n    return M;\n}\n</code></pre>\n\n<p>I tried transposing this, in case the original article used the opposite column-row majority of mine, but it did not help.</p>\n\n<p>EDIT:  The problem here turned out to be that this code works for a left-handed coordinate system, where mine is right-handed.  So to get this to work you just have to multiply phi by -1.  I also edited the code to add normalization of the cross vector, as suggested in the comments.</p>\n"}, {"tags": ["c++", "macos", "opencl"], "comments": [{"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 2, "creation_date": 1536162162, "post_id": 52188902, "comment_id": 91327725, "body": "Perhaps you should share the code you&#39;re having trouble with instead of the &quot;C++ version&quot;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1536162367, "post_id": 52188902, "comment_id": 91327842, "body": "10 x 17 is 170, not 87. Is this performance critical code? If so, you&#39;ll need to give a minimum, complete example so we can reproduce the problem."}, {"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1536226354, "post_id": 52188902, "comment_id": 91350899, "body": "A few things: (1) The Intel HD Graphics 4000 is supported by the macOS OpenCL implementation, so if it&#39;s not showing up in your device enumeration, you&#39;ve got a problem with your code right there. You haven&#39;t shared your code so there&#39;s not much I can say beyond that. Note that OS X 10.7 is long out of support and has various security issues so you really shouldn&#39;t be using it anymore. (2) If your data set is only a one-off calculation with 1000 items, that&#39;s probably too small to see the advantages of OpenCL. Your startup and coordination overhead will exceed your actual algorithm runtime."}, {"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1536226586, "post_id": 52188902, "comment_id": 91351025, "body": "(3) Your kernel code isn&#39;t actually equivalent to the C++ code: surely you want <code>input[c] - n[c]</code>, not <code>input[0] - n[0]</code> 3 times in a row."}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "is_accepted": false, "score": 0, "last_activity_date": 1536339254, "creation_date": 1536339254, "answer_id": 52226753, "question_id": 52188902, "link": "https://stackoverflow.com/questions/52188902/opencl-gpu-programming-with-intel-hd-graphics-4000/52226753#52226753", "title": "OpenCL GPU Programming with Intel HD Graphics 4000", "body": "<p>I finally found the issue.\nThe problem was that OpenCL on Mac OS X returns the wrong maximum device work group size of 1024.\nI tested with various work group sizes and ended up having 200% performance gains when using a work group size of 128 work items per group.\nHere is a clearer benchmark picture. IGPU stands for Integrated GPU.\n(X-Axis: the array size, Y-Axis: The Time Duration in microseconds)\n<a href=\"https://i.stack.imgur.com/K0XzI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K0XzI.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1031, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1536339254, "creation_date": 1536161776, "last_edit_date": 1536242146, "question_id": 52188902, "link": "https://stackoverflow.com/questions/52188902/opencl-gpu-programming-with-intel-hd-graphics-4000", "title": "OpenCL GPU Programming with Intel HD Graphics 4000", "body": "<p>I have been trying to implement a simple parallel algorithm using OpenCL c++ bindings (version 1.2).\nRoughly here is the c code (no OpenCL):</p>\n\n<pre><code>typedef struct coord{\n    double _x;\n    double _y;\n    double _z;\n}__coord;\n\ntypedef struct node{\n    __coord _coord;\n     double _dist;\n} __node;\ndouble input[3] = {-1.0, -2, 3.5};\n//nodeVector1D is a 1Dim random array of struct __node\n//nodeVectorSize is the Size of the above array (&gt;1,000)\ndouble d = 0.0;\n     for(int i=0; i &lt; nodeVectorSize; i++){\n         __node n = nodeVector1D[i];\n         d += (input[0] - n._coord._x)*(input[0] - n._coord._x);\n         d += (input[1] - n._coord._y)*(input[1] - n._coord._y);\n         d += (input[2] - n._coord._z)*(input[2] - n._coord._z);\n         n._dist = d;\n     }\n</code></pre>\n\n<p>I use a MacBook Pro 13\" Late 2013, running on Mac Os X Lion.\nOpenCL only detects the CPU.\nThe CPU: an Intel Ivy i5 2.6GHz, has an integrated GPU of 1Gb at 1.6Ghz (Intel HD Graphics 4000).\nThe maximum detected Group Item Size is 1024 bytes.\nWhen I run the flat code above (with 1024 nodes), it takes around 17 micro seconds.+</p>\n\n<p>When I run its parallel version using OpenCL, C++ library, it takes 10 times as long, around 87 micro seconds\n(excluding the program creation, buffer allocation and writing).\nWhat am I doing wrong here?</p>\n\n<p>NB: the OpenCL kernel for this algorithm is obvious to guess, but I can post it if needed.\nThanks in advance.</p>\n\n<p><strong>EDIT N#1:</strong> THE KERNEL CODE</p>\n\n<pre><code>__kernel void  _computeDist(\n   __global void* nodeVector1D,\n   const unsigned int nodeVectorSize,\n   const unsigned int itemsize, \n   __global const double* input){\n    double d = 0.;\n    int i,c;\n    double* n;\n    i = get_global_id(0);\n    if (i &gt;= nodeVectorSize) return;\n    n = (double*)(nodeVector1D + i*itemsize);\n    for (c=0; c&lt;3;c++){\n        d += (input[c] - n[c])*(input[c] - n[c]);\n    }\n    n[3] = d;\n\n}\n</code></pre>\n\n<p>Sorry for the void pointer arithmetic, but it works (no seg default).\nI can also post the OpenCL initialization routine, but I think it's all over the Internet. However, I will post it, if someone asks.</p>\n\n<p>@pmdj: As I said above OpenCL recognizes my CPU, otherwise I wouldn't have been able to run the tests and get the performance results presented above.</p>\n\n<p>@pmdj: OpenCL kernel code, to my knowledge are always written in C. However, I tagged C++ because (as I said above), I'm using the OpenCL C++ bindings.</p>\n"}, {"tags": ["c++", "visual-studio", "c++11", "templates"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1536161834, "post_id": 52188878, "comment_id": 91327557, "body": "Your template argument <code>tail</code> has the same name as the function argument <code>tail</code>. I&#39;m pretty sure that&#39;s not valid C++ (especially when you later try to unpack the argument in <code>f</code>), and it seems like you actually managed to trip up the compiler doing that. Regardless of whether or not it&#39;s technically valid or not, it&#39;s probably going to be fixed by changing the name."}, {"owner": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1536161902, "post_id": 52188878, "comment_id": 91327595, "body": "Good point i changed the code to Tail and still not working giving this error:&#39;void f(T,Tail...)&#39;: expects 2 arguments - 0 provided // f no matching overloaded function found"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1536162046, "post_id": 52188878, "comment_id": 91327660, "body": "Yes... think about what happens to <code>f(tail...)</code> if <code>tail</code> is empty."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1536162093, "post_id": 52188878, "comment_id": 91327685, "body": "Also, please update the question if that&#39;s your actual question now, otherwise we&#39;ll have to close this one as being a typo."}, {"owner": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "edited": false, "score": 0, "creation_date": 1536162349, "post_id": 52188878, "comment_id": 91327830, "body": "Old edit sorry! check it now."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1536162436, "post_id": 52188878, "comment_id": 91327886, "body": "@Cubic is correct, at some point <code>tail... </code> is empty, and you call <code>f(tail... )</code>, which fails since <code>f</code> needs at least one parameter. Add <code>void f() { }</code> above your function and this solves your problem."}, {"owner": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "edited": false, "score": 0, "creation_date": 1536162704, "post_id": 52188878, "comment_id": 91328034, "body": "That solve the problem thanks!! I forgot that when its empty and f is defined after so it basically undefined..Forgot some basics"}], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "edited": false, "score": 0, "creation_date": 1536162784, "post_id": 52189092, "comment_id": 91328078, "body": "Holt and Cubic answered very well above thanks for more explanation!"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "edited": false, "score": 0, "creation_date": 1536163055, "post_id": 52189092, "comment_id": 91328223, "body": "@Omarito Added 3 solutions to your problem."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1536162814, "last_edit_date": 1536162814, "creation_date": 1536162455, "answer_id": 52189092, "question_id": 52188878, "link": "https://stackoverflow.com/questions/52188878/variadic-templates-not-compiling-in-msvc/52189092#52189092", "title": "Variadic templates not compiling in MSVC?", "body": "<p>First a MCVE:</p>\n\n<pre><code>template&lt;typename T, typename... Tail&gt;\nvoid f(T head, Tail... tail) {\n    f(tail...); // tr y again with tail\n}\nf(1, 2, 3);\n</code></pre>\n\n<p>now instantiate:</p>\n\n<pre><code>f&lt;int, int, int&gt;(1, 2, 3);\n</code></pre>\n\n<p>compiles to:</p>\n\n<pre><code>template&lt;T = int, Tail...={int,int}&gt;\nvoid f(int head, int tail0, int tail1) {\n    f(tail0, tail1); // tr y again with tail\n}\n</code></pre>\n\n<p>The recursive call is:</p>\n\n<pre><code>    f&lt;int,int&gt;(tail0, tail1); // tr y again with tail\n</code></pre>\n\n<p>which compiles to:</p>\n\n<pre><code>template&lt;T = int, Tail...={int}&gt;\nvoid f(int head, int tail0) {\n    f(tail0); // tr y again with tail\n}\n</code></pre>\n\n<p>the recursive call resolves to:</p>\n\n<pre><code>    f&lt;int&gt;(tail0); // tr y again with tail\n</code></pre>\n\n<p>which compiles to:</p>\n\n<pre><code>template&lt;T = int, Tail...={}&gt;\nvoid f(int head) {\n    f(); // tr y again with tail\n}\n</code></pre>\n\n<p>and here we try to call <code>f()</code>.</p>\n\n<p>There is no valid call to <code>f()</code> visible, so you get an error.</p>\n\n<p>A <code>void f() {}</code> <em>under</em> the call to <code>f()</code> doesn't help here, because in the template the lookup is done before <code>f()</code> is visible.</p>\n\n<p>If you want to fix this the easy way, you can add <code>inline void f(){}</code> above your <code>f</code> template.</p>\n\n<p>The more complex way?</p>\n\n<pre><code>template&lt;class...Ts&gt;\nvoid f(Ts...ts) {\n  using discard=int[];\n  (void)discard{ 0, ( void(\n    g(ts)\n  ),0)...};\n}\n</code></pre>\n\n<p>which also does away with recursion.  Or in <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a>:</p>\n\n<pre><code>template&lt;class...Ts&gt;\nvoid f(Ts...ts) {\n  ( (void)(g(ts)), ... );\n}\n</code></pre>\n\n<p>this is also faster to compile, as it creates way fewer (and shorter) symbols.</p>\n"}, {"tags": [], "owner": {"reputation": 3085, "user_id": 7309666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be91537cdd23587efcab0afbe2ed0023?s=128&d=identicon&r=PG&f=1", "display_name": "coder3101", "link": "https://stackoverflow.com/users/7309666/coder3101"}, "is_accepted": true, "score": 2, "last_activity_date": 1536166392, "last_edit_date": 1536166392, "creation_date": 1536162672, "answer_id": 52189144, "question_id": 52188878, "link": "https://stackoverflow.com/questions/52188878/variadic-templates-not-compiling-in-msvc/52189144#52189144", "title": "Variadic templates not compiling in MSVC?", "body": "<p>There are three things incorrect here.</p>\n\n<ol>\n<li><code>tail</code> argument shadows template name <code>tail</code></li>\n<li>No viable function to handle base case of recursive call to <code>f()</code></li>\n<li><code>f()</code> must be defined before the other <code>f(...)</code> because advanced function lookup doesn't take place in such recursive functions.</li>\n</ol>\n\n<p><strong>Solutions</strong></p>\n\n<p>Change the name of argument <code>tail</code> to something else like</p>\n\n<pre><code>template&lt;typename T, typename... tail&gt;\nvoid f(T head, tail... ftail) { //tail here was shadowing actual template name tail so changed to ftail\n    g(head); // do something to head\n    f(ftail...); // try again with tail\n}\n</code></pre>\n\n<p>When you make a recursive call to <code>f()</code> there comes a time when no value is passed to <code>f(..)</code> because every recursive call will decrease the number of arguments passed by 1. </p>\n\n<p>So let's say you started with <code>f(1, \"Lol\", 2)</code>, internally the recursive call is made to <code>f(\"Lol\", 2)</code> this inturns makes a call <code>f(2)</code> which calls <code>f()</code>, but your function <code>f</code> expects at least 1 parameter. Hence the error</p>\n\n<p>To resolve this , Simply overload the <code>f</code> for base case scenario with no argument like</p>\n\n<pre><code>void f(){\n    //last recursive call made\n}\n</code></pre>\n\n<p>Here is the complete code </p>\n\n<pre><code>#include&lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nvoid g(T x)\n{\n    std::cout &lt;&lt; x &lt;&lt; \" \";\n}\n\nvoid f(){ }\n\ntemplate&lt;typename T, typename... tail&gt;\nvoid f(T head, tail... ftail) {\n    g(head); // do something to head\n    f(ftail...); // try again with tail\n}\n\nint main()\n{\n    f(1, \"Lol\", 5);\n    getchar();\n}\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52189144, "answer_count": 2, "score": 1, "last_activity_date": 1618245302, "creation_date": 1536161691, "last_edit_date": 1618245302, "question_id": 52188878, "link": "https://stackoverflow.com/questions/52188878/variadic-templates-not-compiling-in-msvc", "title": "Variadic templates not compiling in MSVC?", "body": "<p>Trying to compile the following code snippet:\nThis code is clearly using C++11 feature and been described in The C++ Programming Language book \u00a73.4.4</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid g(T x)\n{\n    std::cout &lt;&lt; x &lt;&lt; \" \";\n}\n\ntemplate&lt;typename T, typename... Tail&gt;\nvoid f(T head, Tail... tail) {\n    g(head); // do something to head\n    f(tail...); // tr y again with tail\n}\n\nvoid f() {}\n\nint main()\n{\n    f(1, \"Lol\", 5);\n    getchar();\n}\n</code></pre>\n\n<p>VS17 output : </p>\n\n<blockquote>\n  <p>C2672 'f': no matching overloaded function found  Line:21  </p>\n  \n  <p>'void f(T,Tail...)': expects 2 arguments - 0 provided Line:19</p>\n</blockquote>\n\n<p>any ideas ?</p>\n"}, {"tags": ["c++", "visual-studio-code", "code-formatting"], "comments": [{"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 0, "creation_date": 1536161533, "post_id": 52188779, "comment_id": 91327396, "body": "ctrl+K+F is core VS functionality, it&#39;s unclear what tool you&#39;re talking about. I&#39;d say, you should redirect it to other site (maybe VS tech support?)"}, {"owner": {"reputation": 5013, "user_id": 1619432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8SFy2.png?s=128&g=1", "display_name": "handle", "link": "https://stackoverflow.com/users/1619432/handle"}, "edited": false, "score": 0, "creation_date": 1571383061, "post_id": 52188779, "comment_id": 103230001, "body": "Related: <a href=\"https://stackoverflow.com/questions/29973357/how-do-you-format-code-in-visual-studio-code-vscode\" title=\"how do you format code in visual studio code vscode\">stackoverflow.com/questions/29973357/&hellip;</a>"}, {"owner": {"reputation": 119, "user_id": 12207627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c553d759e43dddcb0eca20c17f48a8?s=128&d=identicon&r=PG&f=1", "display_name": "nomad", "link": "https://stackoverflow.com/users/12207627/nomad"}, "edited": false, "score": 0, "creation_date": 1618750494, "post_id": 52188779, "comment_id": 118691176, "body": "I get confused between <code>Ctrl</code> + <code>K</code> +<code>F</code> (format) and <code>Ctrl</code> + <code>K</code>, <code>F</code> (close directory) all the time."}], "answers": [{"comments": [{"owner": {"reputation": 500, "user_id": 5700318, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cfc8b3b1656705249f2fbd7bffd4ddba?s=128&d=identicon&r=PG&f=1", "display_name": "ywiyogo", "link": "https://stackoverflow.com/users/5700318/ywiyogo"}, "edited": false, "score": 0, "creation_date": 1536223573, "post_id": 52189020, "comment_id": 91349062, "body": "Thanks Michael, actually I&#39;ve read the docs. Today I found the issue. I placed a .clangformat file outside the workspace (inside my Windows user folder), which contains a wrong format in a line. After I removed it or repaired the content it works again. I thought this file should not have effect. So the VS-Code not just look after the file inside the workspace."}], "tags": [], "owner": {"reputation": 703, "user_id": 9753452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Michael Surette", "link": "https://stackoverflow.com/users/9753452/michael-surette"}, "is_accepted": false, "score": 4, "last_activity_date": 1571383023, "last_edit_date": 1571383023, "creation_date": 1536162190, "answer_id": 52189020, "question_id": 52188779, "link": "https://stackoverflow.com/questions/52188779/how-can-i-modify-the-code-formatting-for-c-in-visual-studio-code/52189020#52189020", "title": "How can I modify the code formatting for C++ in Visual Studio Code?", "body": "<p>I use clang-format, which integrates quite well and is very configurable.  See <a href=\"https://code.visualstudio.com/docs/cpp/cpp-ide#_code-formatting\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/docs/cpp/cpp-ide#_code-formatting</a></p>\n"}, {"comments": [{"owner": {"reputation": 905, "user_id": 1423254, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/74a1ae4e5bd523b4eeb6a6f43b32ae71?s=128&d=identicon&r=PG", "display_name": "Lukas Salich", "link": "https://stackoverflow.com/users/1423254/lukas-salich"}, "edited": false, "score": 0, "creation_date": 1569716427, "post_id": 52200544, "comment_id": 102686216, "body": "It&#39;s funny that I use Chromium instead, but searched for this answer to override just those 2 settings (column limit and pointer alignment) :D"}, {"owner": {"reputation": 905, "user_id": 1423254, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/74a1ae4e5bd523b4eeb6a6f43b32ae71?s=128&d=identicon&r=PG", "display_name": "Lukas Salich", "link": "https://stackoverflow.com/users/1423254/lukas-salich"}, "edited": false, "score": 0, "creation_date": 1569716879, "post_id": 52200544, "comment_id": 102686279, "body": "So I have {BasedOnStyle: Chromium, ColumnLimit: 150, PointerAlignment: Left}"}, {"owner": {"reputation": 121, "user_id": 1653204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc7abf40ecadd138d3d2ba5450be2827?s=128&d=identicon&r=PG", "display_name": "Pulseczar", "link": "https://stackoverflow.com/users/1653204/pulseczar"}, "edited": false, "score": 1, "creation_date": 1615574465, "post_id": 52200544, "comment_id": 117742607, "body": "I don&#39;t understand why anyone would want type information, such as whether something is a pointer or not, to be grouped with the identifier. If <code>class Student</code> is a large structure, like 100,000 bytes in size, there is a big difference between a <code>Student</code> and a pointer to a <code>Student</code>, since pointers are generally 4 bytes or 8 bytes, depending on the architecture. And this is only taking into consideration the difference in size, not the fact that they are two very different things, conceptually."}], "tags": [], "owner": {"reputation": 500, "user_id": 5700318, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cfc8b3b1656705249f2fbd7bffd4ddba?s=128&d=identicon&r=PG&f=1", "display_name": "ywiyogo", "link": "https://stackoverflow.com/users/5700318/ywiyogo"}, "is_accepted": true, "score": 4, "last_activity_date": 1592925646, "last_edit_date": 1592925646, "creation_date": 1536225017, "answer_id": 52200544, "question_id": 52188779, "link": "https://stackoverflow.com/questions/52188779/how-can-i-modify-the-code-formatting-for-c-in-visual-studio-code/52200544#52200544", "title": "How can I modify the code formatting for C++ in Visual Studio Code?", "body": "<p>After some experiments, the simple solution is to add this line in the User Settings (settings.json):</p>\n<p><code>&quot;C_Cpp.clang_format_fallbackStyle&quot;: &quot;{ PointerAlignment: Left}&quot;</code></p>\n<p>However, this settings allow me to keep my previous settings without breaking my function line:</p>\n<p><code>&quot;C_Cpp.clang_format_fallbackStyle&quot;: &quot;{ BasedOnStyle: WebKit, ColumnLimit: 120, PointerAlignment: Left}&quot;</code></p>\n<p>Using &quot;BasedOnStyle: Visual Studio&quot; such as this line:</p>\n<p><code>&quot;C_Cpp.clang_format_fallbackStyle&quot;: &quot;{ BasedOnStyle: Visual Studio, ColumnLimit: 120, PointerAlignment: Left}&quot;</code></p>\n<p><strong>doesn't work</strong>. It is may be a bug.\nI used Visual Studio Code version 1.26.1.</p>\n<p>Additionally, a .clangformat outside the workspace folder will still be applied. So, if this file is corrupt the auto-format will not work.</p>\n"}], "owner": {"reputation": 500, "user_id": 5700318, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cfc8b3b1656705249f2fbd7bffd4ddba?s=128&d=identicon&r=PG&f=1", "display_name": "ywiyogo", "link": "https://stackoverflow.com/users/5700318/ywiyogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10200, "favorite_count": 1, "accepted_answer_id": 52200544, "answer_count": 2, "score": 10, "last_activity_date": 1592925646, "creation_date": 1536161311, "last_edit_date": 1592924857, "question_id": 52188779, "link": "https://stackoverflow.com/questions/52188779/how-can-i-modify-the-code-formatting-for-c-in-visual-studio-code", "title": "How can I modify the code formatting for C++ in Visual Studio Code?", "body": "<p>So far after installing the C++ extension tool, I can use <kbd>Ctrl</kbd> + <kbd>K</kbd> + <kbd>F</kbd> to auto-format my C++ code. However, I would like to make some modification, for example I would like to force the pointer alignment to be near the type, instead of next to the variable name, such as this rule:</p>\n<pre><code># Force pointers to the type for C++.\nDerivePointerAlignment: false\nPointerAlignment: Left\n</code></pre>\n<p>How can I do this modification? I've tried to create a .clang-format file, but it doesn't work.</p>\n"}, {"tags": ["c++", "ros"], "comments": [{"owner": {"reputation": 2069, "user_id": 2084944, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8bDYe.jpg?s=128&g=1", "display_name": "Tik0", "link": "https://stackoverflow.com/users/2084944/tik0"}, "edited": false, "score": 0, "creation_date": 1536166771, "post_id": 52188739, "comment_id": 91330056, "body": "Your question is confusing. Do you want the second result of all tests, the second result of the second test, or all results of the second test?"}], "answers": [{"tags": [], "owner": {"reputation": 2069, "user_id": 2084944, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8bDYe.jpg?s=128&g=1", "display_name": "Tik0", "link": "https://stackoverflow.com/users/2084944/tik0"}, "is_accepted": false, "score": 0, "last_activity_date": 1536166481, "last_edit_date": 1536166481, "creation_date": 1536165584, "answer_id": 52189909, "question_id": 52188739, "link": "https://stackoverflow.com/questions/52188739/access-a-nested-ros-message/52189909#52189909", "title": "Access a nested ROS-Message", "body": "<p>You can change the range-based (aka for-each) loop to an index based for loop like this which iterates over the second, third, ..., and final result of test 42:</p>\n\n<pre><code>std::size_t test_idx      = 42; // Second element of results\nstd::size_t result_start  = 1; // start from the second result\nstd::size_t result_end    = your_msg_obj.test.at(test_idx).size(); // run until end of all in the given test\n\n// For loop that iterates over all results in a given test\nfor ( std::size_t result_idx = result_start; idx &lt; result_end; ++idx ) {\n  uint32_t c = your_msg_obj.test.at(test_idx).result.at(result_idx);\n  // ... fancy stuff\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8645, "user_id": 5235574, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wEodm.jpg?s=128&g=1", "display_name": "Fruchtzwerg", "link": "https://stackoverflow.com/users/5235574/fruchtzwerg"}, "is_accepted": false, "score": 0, "last_activity_date": 1537018351, "creation_date": 1537018351, "answer_id": 52345164, "question_id": 52188739, "link": "https://stackoverflow.com/questions/52188739/access-a-nested-ros-message/52345164#52345164", "title": "Access a nested ROS-Message", "body": "<p>The <a href=\"http://wiki.ros.org/msg\" rel=\"nofollow noreferrer\">ROS documentatation of messages</a> explains that array message fields are generated as <code>std::vector</code> in C++. In your case the field <code>test</code> is of type <code>std::vector&lt;message_b&gt;</code>, <code>result</code> of type <code>std::vector&lt;uint32_t&gt;</code>.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/vector/vector/\" rel=\"nofollow noreferrer\">C++ vectors</a> can be accessed in serval ways, you can find them in <a href=\"https://stackoverflow.com/questions/409348/iteration-over-stdvector-unsigned-vs-signed-index-variable\">in this answer</a>. In your case simply accessing the items by index should be possible like:</p>\n\n<pre><code>for(size_t i = 0; i != your_message_a.test.size(); i++)\n{\n    //Access the second result item of each test item\n    uint32_t c = your_message_a.test[i].result[1];\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10320845, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r_FLqb3oUhU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPPgknZ9SOnAWEjmufm7I2W9sqWwg/mo/photo.jpg?sz=128", "display_name": "marv", "link": "https://stackoverflow.com/users/10320845/marv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 949, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537018351, "creation_date": 1536161202, "last_edit_date": 1536167047, "question_id": 52188739, "link": "https://stackoverflow.com/questions/52188739/access-a-nested-ros-message", "title": "Access a nested ROS-Message", "body": "<p>I would like to access the second element of ROS-Message <code>message_a</code>.</p>\n\n<pre><code># ROS-Message message_a\nHeader header\nmessage_b[] test\n</code></pre>\n\n<p>ROS-Message 1 contains ROS-Message 2!</p>\n\n<pre><code># ROS-Message message_b\nHeader header\nuint32[] result\n</code></pre>\n\n<p>In my main code I loop with a for-each loop through the message test with the datatyp <code>message_a</code>.  </p>\n\n<pre><code>for ( message_a::Test1 test : message_a.message_b ) {\n  uint32_t c = test.result;\n}\n</code></pre>\n\n<p>How can I access for example the second element of message_b? I need that because I want to get the result of the second test.</p>\n\n<p>With the for-each loop that you see above, it will loop through all elements of <code>message_b</code>. How can I change this for-each loop to a general for-loop? Then I could just loop from 2 to 3...</p>\n"}, {"tags": ["c++", "tensorflow", "memory", "gpu"], "answers": [{"comments": [{"owner": {"reputation": 19375, "user_id": 1735003, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qNeQo.png?s=128&g=1", "display_name": "P-Gn", "link": "https://stackoverflow.com/users/1735003/p-gn"}, "edited": false, "score": 0, "creation_date": 1536223944, "post_id": 52189291, "comment_id": 91349293, "body": "Is that entirely true though? In eager mode, tensorflow is able to allocate and deallocate device memory on the fly. I wonder whether eager mode relies on something else than the C++ library to achieve this? Somebody knowledgeable could perhaps cast some light on this."}, {"owner": {"reputation": 51, "user_id": 787387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cc34953763d5acf0eaed97cb7d9304?s=128&d=identicon&r=PG", "display_name": "Mark Davey", "link": "https://stackoverflow.com/users/787387/mark-davey"}, "edited": false, "score": 0, "creation_date": 1536333227, "post_id": 52189291, "comment_id": 91399970, "body": "Does this apply to CPU as well as GPU memory?"}], "tags": [], "owner": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1536163101, "creation_date": 1536163101, "answer_id": 52189291, "question_id": 52188697, "link": "https://stackoverflow.com/questions/52188697/using-tensorflow-in-c-application-how-to-release-gpu-memory/52189291#52189291", "title": "Using Tensorflow in C++ application: How to release GPU memory", "body": "<p>Tensorflow allocates memory for the lifetime of the process. There is unfortunately no way around that, you only get the memory back once the process finishes.</p>\n\n<p>One way to solve this would be to \"modularize\" your application into multiple distinct processes. Have one process for performing inference, and a parent process (your application) which calls it. You can run the child process blocking, so your entire app behaves as if it was executing the code itself (apart from handling resource sharing of course).</p>\n"}], "owner": {"reputation": 51, "user_id": 787387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cc34953763d5acf0eaed97cb7d9304?s=128&d=identicon&r=PG", "display_name": "Mark Davey", "link": "https://stackoverflow.com/users/787387/mark-davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1536163101, "creation_date": 1536161038, "question_id": 52188697, "link": "https://stackoverflow.com/questions/52188697/using-tensorflow-in-c-application-how-to-release-gpu-memory", "title": "Using Tensorflow in C++ application: How to release GPU memory", "body": "<p>I am trying to use Tensorflow for inference within my C++ application. Other parts of the application need access to large amounts of GPU memory (not at exactly the same time as Tensorflow). However, once Tensorflow has been used to perform inference, it hogs the GPU memory and does not release it until the application ends. Ideally, after inference, I would be able to free the GPU memory used by Tensorflow to allow other algorithms to use the GPU.</p>\n\n<p>Has anyone else faced this problem, and did you find a solution?</p>\n"}, {"tags": ["c++", "cmake", "arm", "g++", "cross-compiling"], "comments": [{"owner": {"reputation": 7205, "user_id": 9288200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1c4dc5d3f7433e18f4aa04319ebaec?s=128&d=identicon&r=PG&f=1", "display_name": "Ondrej K.", "link": "https://stackoverflow.com/users/9288200/ondrej-k"}, "edited": false, "score": 0, "creation_date": 1536496697, "post_id": 52188686, "comment_id": 91437566, "body": "Since <code>cmake</code> is involved, it could make sense to add its tag. Also if you could add the command line <code>cmake</code> divined for your system and <code>make</code> actually ran, it might provide further clues. You can also try running the same thing, but stop after <code>cpp</code> is done with your source file. I suspect something went pear shape at that point, looking at my <code>features.h</code>, unless <code>__clang_major__</code> and <code>__clang_minor__</code> are defined (presumably that would be the case when using <code>clang</code>) it the macro would be: <code>#define __glibc_clang_prereq(maj, min) 0</code> -&gt; read harmless and could not yield the same error."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 14249238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8sx0JqVft3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciXh72HWzE2exoUxrP8XkYXTS8Yg/photo.jpg?sz=128", "display_name": "stryga", "link": "https://stackoverflow.com/users/14249238/stryga"}, "is_accepted": false, "score": 2, "last_activity_date": 1599730821, "last_edit_date": 1599730821, "creation_date": 1599667005, "answer_id": 63815307, "question_id": 52188686, "link": "https://stackoverflow.com/questions/52188686/cross-compiling-raspberry-pi/63815307#63815307", "title": "Cross compiling raspberry pi", "body": "<p>Maybe your include paths is missing the (correct) <code>features.h</code></p>\n<p>I ran into the same error when cross compiling witgh QTCreator using Qt 5.15 for Raspberry Pi.</p>\n<p>Adding <code>INCLUDEPATH += somepath/sysroot/usr/include</code> in the pro file fixed it. That is, add the <code>/usr/include</code> of the target machine to your include path. (Use the correct sysroot path on your system, of course...)</p>\n"}], "owner": {"reputation": 61, "user_id": 9961558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7f2104dc77050507d351a3db78f8a9?s=128&d=identicon&r=PG&f=1", "display_name": "J W", "link": "https://stackoverflow.com/users/9961558/j-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1599817573, "creation_date": 1536160983, "last_edit_date": 1599817573, "question_id": 52188686, "link": "https://stackoverflow.com/questions/52188686/cross-compiling-raspberry-pi", "title": "Cross compiling raspberry pi", "body": "<p>i want to cross-compile a program for my raspberry pi. I decided to use the arm-linux-gnueabihf-gcc-7 compiler, copy /usr and /lib/ to my host into the directory ~/raspberrypi/rootfs and set up a cmake configurated as follows:</p>\n\n<pre><code>SET(CMAKE_SYSTEM_NAME Linux)\nSET(CMAKE_SYSTEM_VERSION 1)\n\nSET(CMAKE_FIND_ROOT_PATH $ENV{HOME}/raspberrypi/rootfs)\nSET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\nSET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nSET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n\n# Specify the cross compiler\nSET(CMAKE_C_COMPILER arm-linux-gnueabihf-gcc-7)\nSET(CMAKE_CXX_COMPILER arm-linux-gnueabihf-g++-7)\n</code></pre>\n\n<p>everything is working fine until i run make, then i get the error:</p>\n\n<pre><code>/usr/arm-linux-gnueabihf/include/sys/cdefs.h:467:49: error: missing binary operator before token \"(\"\n#if __GNUC_PREREQ (4,8) || __glibc_clang_prereq (3,5)\n                                                 ^\n</code></pre>\n\n<p>and some more of the same type...</p>\n\n<p>Does anyone has an idea of what is going wrong there?</p>\n\n<p>Thanks for helping!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1536161239, "post_id": 52188661, "comment_id": 91327219, "body": "How do you specify <code>a_member</code> to the iterator? Please provide more examples and the things you have tried on your own."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1536161341, "post_id": 52188661, "comment_id": 91327287, "body": "@ Vittorio Romeo, there can be some kind of a getter class that returns the reference to a member, or probably a pointer to a member."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536161441, "post_id": 52188661, "comment_id": 91327341, "body": "Have you thought about using <a href=\"https://en.cppreference.com/w/cpp/language/structured_binding\" rel=\"nofollow noreferrer\">structured bindings</a> instead?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1536161693, "post_id": 52188661, "comment_id": 91327469, "body": "@HolyBlackCat yes, something like this, or probably TheCoolIter&lt;&amp;type::member&gt;(my_map.begin()) or TheCoolIter&lt;MemberAccessor&gt;(my_map.begin()), but with the map it should be SecondAccessor."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536161768, "post_id": 52188661, "comment_id": 91327517, "body": "Alright, then next question: Do you want the same instantination to work with different containers? Or you&#39;re willing to add a container-specific iterator as an another template parameter? The first one would require more work, and would add some overhead."}, {"owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "edited": false, "score": 2, "creation_date": 1536161801, "post_id": 52188661, "comment_id": 91327538, "body": "Have you tried boost::tranform_iterator yet?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536161862, "post_id": 52188661, "comment_id": 91327571, "body": "@HolyBlackCat, no, there should a specific template instantiation for each container/iterator type."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "edited": false, "score": 0, "creation_date": 1536162355, "post_id": 52188661, "comment_id": 91327834, "body": "@paler123 I took a look, at least it is a good example"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536162647, "post_id": 52188661, "comment_id": 91328008, "body": "@AlexeyStarinsky Then it seems somewhat trivial. Have you tried writing it yet?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536162690, "post_id": 52188661, "comment_id": 91328027, "body": "Do you need the iterator, or is a ranged-for acceptable? <code>for (auto &amp; val : myMap | boost::adaptors::map_values)</code> <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/range/doc/html/range/reference/adaptors/reference/map_values.html\" rel=\"nofollow noreferrer\">works well</a> for me"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536162827, "post_id": 52188661, "comment_id": 91328104, "body": "@HolyBlackCat, probably yes, it is really trivial. It should be something like this <a href=\"https://gist.github.com/eruffaldi/93d09ed6644ae3fa279f\" rel=\"nofollow noreferrer\">gist.github.com/eruffaldi/93d09ed6644ae3fa279f</a>. But there is a lot of typing... for const and non-const, etc..."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536162895, "post_id": 52188661, "comment_id": 91328133, "body": "@Caleth boost::adaptors::map_values is a good example and something close to what I need."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536164290, "post_id": 52188661, "comment_id": 91328894, "body": "@NathanOliver how can they help?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536164475, "post_id": 52188661, "comment_id": 91328988, "body": "@AlexeyStarinsky So you know how to do it in general, but not sure if you&#39;re able to get all details right? Then why not actually start writing the thing, and ask here if you face any problems?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536164799, "post_id": 52188661, "comment_id": 91329151, "body": "@HolyBlackCat Yes probably my question is too broad, but at least I found a good example boost::transform_iterator&lt;xfunc,map::iterator&gt;, now I am starting to use my keyboard and type the code."}], "answers": [{"comments": [{"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1536162171, "post_id": 52188807, "comment_id": 91327737, "body": "I need to iterate without knowing that I need &#39;coolValue&#39;. The same code should iterator on std::vector&lt;int&gt; and on the values of std::map&lt;string, int&gt;"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1536163718, "post_id": 52188807, "comment_id": 91328593, "body": "Yes, probably I need something like boost::transform_iterator"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1536165667, "post_id": 52188807, "comment_id": 91329538, "body": "I&#39;ll mark this as answer if you remove &#39;CoolValue&#39;. The answer is boost::transform_iterator."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 4, "last_activity_date": 1536162155, "last_edit_date": 1536162155, "creation_date": 1536161422, "answer_id": 52188807, "question_id": 52188661, "link": "https://stackoverflow.com/questions/52188661/what-is-the-easiest-way-to-create-a-generic-template-iterator-that-can-iterate-t/52188807#52188807", "title": "What is the easiest way to create a generic template iterator that can iterate through std::map values, in particular?", "body": "<p>Just have function overloads:</p>\n\n<pre><code>template&lt;typename Key, typename Value&gt;\nauto coolValue( const std::pair&lt;Key,Value&gt; &amp;p ) { return p.second; }\n\nauto coolValue( const MyStruct &amp;st ) { return st.a_member; }\n</code></pre>\n\n<p>then use it in a loop:</p>\n\n<pre><code>for( auto i = container.begin(); i != container.end(); ++i ) {\n   auto val = coolValue( *i );\n   ...\n}\n</code></pre>\n\n<p>if you need more generic solution you should look into <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/iterator/doc/index.html\" rel=\"nofollow noreferrer\">Boost.Iterator</a> library, and into <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/iterator/doc/transform_iterator.html\" rel=\"nofollow noreferrer\"><code>boost::transform_iterator</code></a> in particular</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 0, "last_activity_date": 1536183995, "creation_date": 1536183995, "answer_id": 52193784, "question_id": 52188661, "link": "https://stackoverflow.com/questions/52188661/what-is-the-easiest-way-to-create-a-generic-template-iterator-that-can-iterate-t/52193784#52193784", "title": "What is the easiest way to create a generic template iterator that can iterate through std::map values, in particular?", "body": "<p><a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">range-v3</a> has <code>transform</code> views:</p>\n\n<pre><code>std::vector&lt;MyStruct&gt; v /* = ..*/;\n\nfor (int e : v | ranges::view::transform(&amp;MyStruct::a_member)) { /*..*/}\nfor (int e : v | ranges::view::transform([](const MyStruct&amp; s){ return -s.a_number; })) { /*..*/}\n</code></pre>\n\n<p>and with \"<code>pair</code>\", there are already some helpers</p>\n\n<pre><code>std::map&lt;string, int&gt; m /* = ..*/; // or std::vector&lt;std::pair&lt;/*const*/std::string, int&gt;&gt;\n\nfor (int e : m | ranges::view::values) { /*..*/ }\nfor (const std::string&amp; keys : m | ranges::view::keys) { /*..*/ }\n</code></pre>\n"}], "owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52193784, "answer_count": 2, "score": 0, "last_activity_date": 1536183995, "creation_date": 1536160907, "last_edit_date": 1536163585, "question_id": 52188661, "link": "https://stackoverflow.com/questions/52188661/what-is-the-easiest-way-to-create-a-generic-template-iterator-that-can-iterate-t", "title": "What is the easiest way to create a generic template iterator that can iterate through std::map values, in particular?", "body": "<p>I'd like to have a generic template iterator that iterates through a container of elements and accesses a specific member of the element. For example, if I have a <code>map&lt;string, int&gt;</code>, I iterate on the map values in a way like this:</p>\n\n<pre><code>for (TheCoolIter i = TheCoolIter(my_map.begin()); i != TheCoolIter(my_map.end()); ++i)\n    int val = *i;\n</code></pre>\n\n<p>and <code>*i</code> return <code>p.second</code>.</p>\n\n<p>But if I iterate through a vector of struct-s <code>*i</code> returns <code>MyStruct::a_member</code>;</p>\n\n<p>This iterator can used if a class has <code>std::map</code> internally but exposes an interface for enumerating the map values without knowing the map type and key type, for example.</p>\n\n<p>EDIT1:</p>\n\n<p>The same code should iterate on <code>std::vector&lt;int&gt;</code> and on the values of <code>std::map&lt;string, int&gt;</code></p>\n\n<p>EDIT2:</p>\n\n<p>A <a href=\"https://gist.github.com/eruffaldi/93d09ed6644ae3fa279f\" rel=\"nofollow noreferrer\">good example</a>.</p>\n"}, {"tags": ["c++", "matlab"], "comments": [{"owner": {"reputation": 388, "user_id": 10252378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cX6kb.jpg?s=128&g=1", "display_name": "Hasan Patel", "link": "https://stackoverflow.com/users/10252378/hasan-patel"}, "edited": false, "score": 0, "creation_date": 1536161472, "post_id": 52188653, "comment_id": 91327363, "body": "Have you check if your Matlab and C++ are running on the same platform (32bit or 64bit)?"}, {"owner": {"reputation": 45, "user_id": 10288962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad0de12ffb0e3b84e619a9e8f57229e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza amin naji", "link": "https://stackoverflow.com/users/10288962/morteza-amin-naji"}, "reply_to_user": {"reputation": 388, "user_id": 10252378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cX6kb.jpg?s=128&g=1", "display_name": "Hasan Patel", "link": "https://stackoverflow.com/users/10252378/hasan-patel"}, "edited": false, "score": 0, "creation_date": 1536162083, "post_id": 52188653, "comment_id": 91327677, "body": "my MATLAB is 64bit  and c++ is 32bit which are both running in my widows 64bit"}, {"owner": {"reputation": 388, "user_id": 10252378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cX6kb.jpg?s=128&g=1", "display_name": "Hasan Patel", "link": "https://stackoverflow.com/users/10252378/hasan-patel"}, "edited": false, "score": 0, "creation_date": 1536162404, "post_id": 52188653, "comment_id": 91327870, "body": "You could try changing the path for VC++ to target 64bit and see if that help you with the issue: <a href=\"https://msdn.microsoft.com/en-us/library/9yb4317s.aspx\" rel=\"nofollow noreferrer\">How to Change VC++ to target 64bit</a>"}, {"owner": {"reputation": 45, "user_id": 10288962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad0de12ffb0e3b84e619a9e8f57229e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza amin naji", "link": "https://stackoverflow.com/users/10288962/morteza-amin-naji"}, "reply_to_user": {"reputation": 388, "user_id": 10252378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cX6kb.jpg?s=128&g=1", "display_name": "Hasan Patel", "link": "https://stackoverflow.com/users/10252378/hasan-patel"}, "edited": false, "score": 0, "creation_date": 1536162975, "post_id": 52188653, "comment_id": 91328179, "body": "thanks a lot, it is solved now, but I got another error: as &quot;the code execution cannot proceed because libmx.dll and libeng.dll was not found&quot;  what should I do now?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10288962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad0de12ffb0e3b84e619a9e8f57229e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza amin naji", "link": "https://stackoverflow.com/users/10288962/morteza-amin-naji"}, "edited": false, "score": 0, "creation_date": 1536165653, "post_id": 52189547, "comment_id": 91329535, "body": "I can find these files in MATLABROOT/bin/win32. How can I add this location to the system environmental?"}], "tags": [], "owner": {"reputation": 388, "user_id": 10252378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cX6kb.jpg?s=128&g=1", "display_name": "Hasan Patel", "link": "https://stackoverflow.com/users/10252378/hasan-patel"}, "is_accepted": false, "score": 1, "last_activity_date": 1536164052, "creation_date": 1536164052, "answer_id": 52189547, "question_id": 52188653, "link": "https://stackoverflow.com/questions/52188653/how-to-connect-c-to-matlab/52189547#52189547", "title": "How to Connect C++ to Matlab", "body": "<p>The first thing to check if both Matlab and C++ are running on the same version (32bit or 64bit). You can change the settings on VC++ to run on 64 using this information from Microsfot: <a href=\"https://msdn.microsoft.com/en-us/library/9yb4317s.aspx\" rel=\"nofollow noreferrer\">How to: Configure Visual C++ Projects to Target 64-Bit Platforms</a></p>\n\n<p>For the Error related to <strong>libmx.dll was not found</strong> try the following:</p>\n\n<ol>\n<li>The DLL is located in MATLABROOT/bin/win32. Add this location to the\nsystem environmental variable \"Path\".</li>\n<li>This error may also indicate that the file \"libmx.dll\" is missing from your MATLAB installation directory. This can occur if certain antivirus software is installed and it quarantines the file. To resolve the issue, open the antivirus software and restore the quarantined file \"libmx.dll\".</li>\n</ol>\n\n<p>Hope this helps; Cheers</p>\n"}], "owner": {"reputation": 45, "user_id": 10288962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad0de12ffb0e3b84e619a9e8f57229e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza amin naji", "link": "https://stackoverflow.com/users/10288962/morteza-amin-naji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536164052, "creation_date": 1536160890, "question_id": 52188653, "link": "https://stackoverflow.com/questions/52188653/how-to-connect-c-to-matlab", "title": "How to Connect C++ to Matlab", "body": "<p>I've tried to link between C++(Win32) and MATLAB(win64).I added the path under the VC++ directories and also added \"libeng.lib libmx.lib libmex.lib libmat.lib\" under linker>>input>. \nbut I got the error: error LNK2019: unresolved external symbol _engOpen referenced in function _main.</p>\n\n<p>any idea to solve this problem?</p>\n\n<p>C++ code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"engine.h\"\n#include \"mex.h\"\n\n#pragma comment (lib,\"libmat.lib\")\n#pragma comment (lib,\"libmx.lib\")\n#pragma comment (lib,\"libmex.lib\")\n#pragma comment (lib,\"libeng.lib\")\n\nusing namespace std;\n\n\nint main()\n{\n\n    Engine *m_pEngine;\n    m_pEngine=engOpen(\"null\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "constructor", "default-constructor"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1536160375, "post_id": 52188474, "comment_id": 91326663, "body": "I take it you tried to run it?"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1536160423, "post_id": 52188474, "comment_id": 91326697, "body": "Did you try copying the class with this code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1536160474, "post_id": 52188474, "comment_id": 91326735, "body": "Yes, potentially it will. You can do weird things like make a default constructor that is also the copy constructor. See <a href=\"https://punchlet.wordpress.com/2009/12/03/letter-the-third/\" rel=\"nofollow noreferrer\">punchlet.wordpress.com/2009/12/03/letter-the-third</a>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1536160617, "post_id": 52188474, "comment_id": 91326836, "body": "<a href=\"https://stackoverflow.com/q/2787569/3002139\">stackoverflow.com/q/2787569/3002139</a> is closely related."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 2, "creation_date": 1536160649, "post_id": 52188474, "comment_id": 91326851, "body": "I think it&#39;s not <i>copy constructor</i>."}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1536160620, "post_id": 52188539, "comment_id": 91326838, "body": "@HolyBlackCat: Also, the standard wording is somewhat more reliable than cppreference.  A couple times the cppreference paraphrase has changed the meaning in an important way."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1536162635, "post_id": 52188539, "comment_id": 91327999, "body": "... and this is why we use <code>explicit</code>, to guard against unintended conversions"}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 4, "last_activity_date": 1536160556, "last_edit_date": 1536160556, "creation_date": 1536160538, "answer_id": 52188539, "question_id": 52188474, "link": "https://stackoverflow.com/questions/52188474/in-c-if-i-create-a-constructor-that-takes-one-argument-which-has-a-default-va/52188539#52188539", "title": "In c++, if I create a constructor that takes one argument which has a default value - will that serve as a default (empty) constructor?", "body": "<p>Yes, the definition of default constructor allows parameters as long as they have default values:</p>\n\n<blockquote>\n  <p>A <em>default constructor</em> for a class <code>X</code> is a constructor of class <code>X</code> for which each parameter that is not a function parameter pack has a default argument (including the case of a constructor with no parameters).</p>\n</blockquote>\n\n<p>(from the C++1z draft)</p>\n\n<p>Older phrasing:</p>\n\n<blockquote>\n  <p>A <em>default constructor</em> for a class <code>X</code> is a constructor of class <code>X</code> that can be called without an argument.</p>\n</blockquote>\n\n<hr>\n\n<p>In addition, your copy constructor will be implicitly defined as defaulted, because you haven't declared one.</p>\n\n<p>There is no such thing as a \"default copy constructor\".  But \"default constructor\" and \"defaulted copy constructor\" are meaningful.</p>\n"}], "owner": {"reputation": 19, "user_id": 10182990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1902620999793993/picture?type=large", "display_name": "Alon Emanuel", "link": "https://stackoverflow.com/users/10182990/alon-emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1536160652, "accepted_answer_id": 52188539, "answer_count": 1, "score": 0, "last_activity_date": 1536163255, "creation_date": 1536160340, "last_edit_date": 1536163255, "question_id": 52188474, "link": "https://stackoverflow.com/questions/52188474/in-c-if-i-create-a-constructor-that-takes-one-argument-which-has-a-default-va", "closed_reason": "Duplicate", "title": "In c++, if I create a constructor that takes one argument which has a default value - will that serve as a default (empty) constructor?", "body": "<p>Does the following one-parameter constructor also serve as a default constructor?</p>\n\n<pre><code>class SomeClass\n    {\n    public:\n        SomeClass(const int &amp;a = 4);\n    }\n</code></pre>\n\n<p>(Assuming the constructor is well defined etc.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1536161188, "post_id": 52188394, "comment_id": 91327183, "body": "The question is very unclear and it is hard to understand what is your problem. For instance, <i>the problem is that if i drop the dragged item into an area that doesn&#39;t accept dropping that child won&#39;t be removed</i> does not seem to be true, as I have just tested your code and here is the result from dropping into an area, which does not accept drops: <code>Left childs:  9 Object:  &quot;left_table&quot;  Event:  QEvent::Type(ChildAdded) Childs:  10 Object:  &quot;left_table&quot;  Event:  QEvent::Type(ChildRemoved) Childs:  9</code>. The ChildRemoved event is fired for sure. So, could you please clarify your question."}, {"owner": {"reputation": 805, "user_id": 7908019, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wBTC1gSxMPU/AAAAAAAAAAI/AAAAAAAAABY/85JVWoAxQI0/photo.jpg?sz=128", "display_name": "Gerard097", "link": "https://stackoverflow.com/users/7908019/gerard097"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1536162734, "post_id": 52188394, "comment_id": 91328045, "body": "Well thats weird, because when i run the program it doesn&#39;t happen like that, the ChildRemoved event wont trigger if i do the same. Idk if this is a bug but my program should have the behavior that you are describing."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1536162883, "post_id": 52188394, "comment_id": 91328127, "body": "Then prepare a <a href=\"https://stackoverflow.com/help/mcve\">mvce</a> to reproduce the issue."}], "owner": {"reputation": 805, "user_id": 7908019, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wBTC1gSxMPU/AAAAAAAAAAI/AAAAAAAAABY/85JVWoAxQI0/photo.jpg?sz=128", "display_name": "Gerard097", "link": "https://stackoverflow.com/users/7908019/gerard097"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536160085, "creation_date": 1536160085, "question_id": 52188394, "link": "https://stackoverflow.com/questions/52188394/qtablewidget-drag-item-not-removing-when-dropping-on-invalid-area", "title": "QTableWidget Drag Item not Removing when Dropping on Invalid area", "body": "<p>Pretty much as the tittle says, when i drag an item from QTableWidget it adds a child to ui->table->children, and then it launches ChildAdded event to my eventFilter, the problem is that if i drop the dragged item into an area that doesn't accept dropping that child won't be removed from ui->table->children whereas releasing the dragged item within an area that has dropping enabled it will, and also launches ChildRemoved event.</p>\n\n<p>Here is my init code:</p>\n\n<pre><code>MainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    m_ui(new Ui::MainWindow)\n{\n    m_ui-&gt;setupUi(this);\n\n    m_ui-&gt;left_table-&gt;installEventFilter(this);\n    m_ui-&gt;right_table-&gt;installEventFilter(this);\n\n    m_ui-&gt;left_table-&gt;setColumnCount(1);\n    m_ui-&gt;left_table-&gt;setRowCount(25);\n    m_ui-&gt;left_table-&gt;setHorizontalHeaderLabels({\"Source\"});\n    m_ui-&gt;left_table-&gt;horizontalHeader()-&gt;setStretchLastSection(true);\n    m_ui-&gt;left_table-&gt;setAcceptDrops(false);\n    m_ui-&gt;left_table-&gt;setDragEnabled(true);\n\n    m_ui-&gt;right_table-&gt;setColumnCount(1);\n    m_ui-&gt;right_table-&gt;setHorizontalHeaderLabels({\"Receiver\"});\n    m_ui-&gt;right_table-&gt;horizontalHeader()-&gt;setStretchLastSection(true);\n    m_ui-&gt;right_table-&gt;setAcceptDrops(true);\n\n    for (int i = 0; i &lt; 25; ++i) {\n        m_ui-&gt;left_table-&gt;setItem(i, 0, new QTableWidgetItem(QString::number(i)));\n    }\n\n    qDebug() &lt;&lt; \"Left childs: \" &lt;&lt; m_ui-&gt;left_table-&gt;children().size();\n}\n</code></pre>\n\n<p>and the event filter:</p>\n\n<pre><code>bool MainWindow::eventFilter(QObject *watched, QEvent *event)\n{\n    if (event-&gt;type() == QEvent::ChildAdded || event-&gt;type() == QEvent::ChildRemoved) {\n        qDebug() &lt;&lt; \"Object: \" &lt;&lt; watched-&gt;objectName()\n                 &lt;&lt; \" Event: \" &lt;&lt; event-&gt;type()\n                 &lt;&lt; \"Childs: \" &lt;&lt; m_ui-&gt;left_table-&gt;children().size();\n    }\n    return false;\n}\n</code></pre>\n\n<p>Example of dropping on invalid area, this wont remove the child added before: </p>\n\n<p><a href=\"https://i.stack.imgur.com/awV7W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/awV7W.png\" alt=\"enter image description here\"></a></p>\n\n<p>Example of dropping on valid area, this will remove the child and call the ChildRemoved event:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nsv8S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nsv8S.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "gstreamer"], "answers": [{"comments": [{"owner": {"reputation": 2699, "user_id": 66191, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a4aa80c6d37add423ce861e9c69745b9?s=128&d=identicon&r=PG", "display_name": "ScaryAardvark", "link": "https://stackoverflow.com/users/66191/scaryaardvark"}, "edited": false, "score": 0, "creation_date": 1536163885, "post_id": 52188591, "comment_id": 91328690, "body": "Thanks. I appreciate your help."}], "tags": [], "owner": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "is_accepted": true, "score": 2, "last_activity_date": 1536160675, "creation_date": 1536160675, "answer_id": 52188591, "question_id": 52188272, "link": "https://stackoverflow.com/questions/52188272/gstreamer-add-an-element-to-a-pipline-created-through-gst-parse-launch/52188591#52188591", "title": "gstreamer add an element to a pipline created through gst_parse_launch", "body": "<p>You can't connect it to a bin. You need to specify a pad - or an element from where it tries to pick a pad. So you would need iterate through the bin and pick the <code>imagefreeze</code> element from the list.</p>\n\n<p>Alternative approach - add the sink and get it from the pipeline:</p>\n\n<pre><code>pipeline = gst_parse_launch( \"filesrc location=file.svg ! rsvgdec ! imagefreeze ! glimagesink name=mysink\", &amp;err );\n\nGstElement *sink = gst_bin_get_by_name( GST_BIN( pipeline ), \"mysink\" );\n\ngst_video_overlay_set_window_handle( GST_VIDEO_OVERLAY( sink ), this-&gt;winId() );\n\ngst_object_unref( sink );\n</code></pre>\n\n<p>You may have issues here as well tough as you may require a <code>videoconvert</code> to satisfy the sink's format requirements.</p>\n\n<pre><code>filesrc location=file.svg ! rsvgdec ! imagefreeze ! videoconvert ! glimagesink\n</code></pre>\n\n<p>or maybe</p>\n\n<pre><code>filesrc location=file.svg ! rsvgdec ! imagefreeze ! glupload ! glcolorconvert ! glimagesink\n</code></pre>\n"}], "owner": {"reputation": 2699, "user_id": 66191, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a4aa80c6d37add423ce861e9c69745b9?s=128&d=identicon&r=PG", "display_name": "ScaryAardvark", "link": "https://stackoverflow.com/users/66191/scaryaardvark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 52188591, "answer_count": 1, "score": 2, "last_activity_date": 1536160675, "creation_date": 1536159706, "question_id": 52188272, "link": "https://stackoverflow.com/questions/52188272/gstreamer-add-an-element-to-a-pipline-created-through-gst-parse-launch", "title": "gstreamer add an element to a pipline created through gst_parse_launch", "body": "<p>I am trying to create a pipeline and then add on a videosink after I've created it. I need to do this so I can set the video overlay window id of the videosink before I commit it to the pipeline.</p>\n\n<p>so I have this code</p>\n\n<pre><code>pipeline = gst_parse_launch( \"filesrc location=file.svg ! rsvgdec ! imagefreeze\", &amp;err );\n\nsink = gst_element_factory_make( \"glimagesink\" );\n\ngst_video_overlay_set_window_handle( GST_VIDEO_OVERLAY( sink ), this-&gt;winId() );\n\ngst_bin_add_many( GST_BIN( pipeline ), sink, nullptr );\n\nif ( !gst_element_link_many( pipeline, sink, nullptr ) )\n{\n    qCritical() &lt;&lt; \"Unable to link elements\";\n}\n</code></pre>\n\n<p>When I run it it fails to link the elements.</p>\n\n<p>Any idea why this is happening. I'm assuming it's because I'm trying to link an element to a \"bin\" rather than another element. However, I can't see any examples of where someone adds an element to a pipeline which was created through gst_parse_launch.</p>\n"}, {"tags": ["c++", "qt", "opencv", "bit", "converters"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1536159760, "post_id": 52188100, "comment_id": 91326269, "body": "What is the actual <a href=\"https://docs.opencv.org/3.1.0/d3/d63/classcv_1_1Mat.html#aa6477efc7399fbe742418250ccf99a4b\" rel=\"nofollow noreferrer\">type of the elements</a> of <code>Mat_In</code>? | Why not use <a href=\"https://docs.opencv.org/3.1.0/d3/d63/classcv_1_1Mat.html#a3f356665bb0ca452e7d7723ccac9a810\" rel=\"nofollow noreferrer\"><code>cv::Mat::convertTo</code></a> (and then just work with the entire raw buffer, rather than looping over it pixel by pixel)."}, {"owner": {"reputation": 103, "user_id": 9956118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f791d02f88eb16812b00561421cf3709?s=128&d=identicon&r=PG&f=1", "display_name": "Kemendil", "link": "https://stackoverflow.com/users/9956118/kemendil"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1536160514, "post_id": 52188100, "comment_id": 91326766, "body": "<code>Mat_In.type();</code> returns <code>0</code>. I tried to use <code>cv::Mat::convertTo</code> but failed, so i tried this way. I also like, that i exactly know what happens there and can manipulate any time i want to."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1536163759, "post_id": 52188100, "comment_id": 91328618, "body": "Type of <code>0</code> corresponds to <code>CV_8U</code>, meaning the image is already 8bit. That would explain the crash (I&#39;d expect once it gets though half the rows). Can you provide a sample image that produces this issue?"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1536177869, "post_id": 52188100, "comment_id": 91335037, "body": "show how you read the image file. OpenCV reads as 8UC3 type by default"}, {"owner": {"reputation": 103, "user_id": 9956118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f791d02f88eb16812b00561421cf3709?s=128&d=identicon&r=PG&f=1", "display_name": "Kemendil", "link": "https://stackoverflow.com/users/9956118/kemendil"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1536212812, "post_id": 52188100, "comment_id": 91343696, "body": "@Micka My read-method is shown above. Good hint, thanks. I&#39;ll try to figure out how to read it as 16bit."}, {"owner": {"reputation": 103, "user_id": 9956118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f791d02f88eb16812b00561421cf3709?s=128&d=identicon&r=PG&f=1", "display_name": "Kemendil", "link": "https://stackoverflow.com/users/9956118/kemendil"}, "edited": false, "score": 0, "creation_date": 1536213847, "post_id": 52188100, "comment_id": 91344068, "body": "Jhon_Sharp1318s Answer worked when i added <code>cv::IMREAD_ANYDEPTH|cv::IMREAD_ANYCOLOR</code> as flags to <code>imreadmulti</code>, so Dan Masek your thought was correct, thanks."}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1536218166, "post_id": 52188100, "comment_id": 91346019, "body": "@kemedil ah ok, I didn&#39;t know the <code>imreadmulti</code> function yet and thought it was some user function."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9956118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f791d02f88eb16812b00561421cf3709?s=128&d=identicon&r=PG&f=1", "display_name": "Kemendil", "link": "https://stackoverflow.com/users/9956118/kemendil"}, "edited": false, "score": 1, "creation_date": 1536213688, "post_id": 52188577, "comment_id": 91344012, "body": "Adding <code>cv::IMREAD_ANYDEPTH|cv::IMREAD_ANYCOLOR</code> as flags for <code>imreadmulti</code> solved the problem, the rest of my code worked as it is. Thank you very much! Now i can start doing the cool stuff."}], "tags": [], "owner": {"reputation": 677, "user_id": 1418351, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7a7dba2123954dce6d12c48c0c74d785?s=128&d=identicon&r=PG", "display_name": "John_Sharp1318", "link": "https://stackoverflow.com/users/1418351/john-sharp1318"}, "is_accepted": true, "score": 1, "last_activity_date": 1536160624, "creation_date": 1536160624, "answer_id": 52188577, "question_id": 52188100, "link": "https://stackoverflow.com/questions/52188100/read-opencv-mat-16bit-to-qimage-8bit-greyscale/52188577#52188577", "title": "Read OpenCV Mat 16bit to QImage 8bit Greyscale", "body": "<p>I faced the same type kind of issue.\nThe following code is the solution I used to fix that case.</p>\n\n<pre><code>   #include &lt;opencv2/core.hpp&gt;\n   #include &lt;opencv2/imgproc.hpp&gt;\n   #include &lt;opencv2/highgui.hpp&gt;\n\n   #include &lt;QImage&gt;\n\n    int main(void)\n    {\n\n      //Read the 16 bit per pixel image.\n      cv::Mat I = cv::imread('16BitsPerPixelImage.tiff',cv::IMREAD_ANYDEPTH|cv::IMREAD_ANYCOLOR);\n\n     //Convert from 16 bit per pixel to 8 bit per pixel using a min max normalization and store it a 8 bit per pixel.\n     cv::normalize(I,I,0.,255.,cv::NORM_MINMAX,CV_8U);\n\n    // Then actualy the easiest way to convert it to a QImage is to save a temporary file and open it using QT functions.\n    // PNG use a compression without loss algorithm.\n      cv::imwrite(\"/tmp/convert16to8.png\",I);\n\n      QImage QI;\n\n      QI.load(\"/tmp/convert16to8.png\");\n\n      return EXIT_SUCCESS;\n    }\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9956118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f791d02f88eb16812b00561421cf3709?s=128&d=identicon&r=PG&f=1", "display_name": "Kemendil", "link": "https://stackoverflow.com/users/9956118/kemendil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 52188577, "answer_count": 1, "score": 0, "last_activity_date": 1536160624, "creation_date": 1536159124, "question_id": 52188100, "link": "https://stackoverflow.com/questions/52188100/read-opencv-mat-16bit-to-qimage-8bit-greyscale", "title": "Read OpenCV Mat 16bit to QImage 8bit Greyscale", "body": "<h2>What i want to do</h2>\n\n<ol>\n<li><strong>File</strong>: TIFF, 2 Pages, Greyscale, 16bit</li>\n<li><strong>OpenCV</strong>: 2x Mat, Greyscale, 16bit (CV_16UC1)</li>\n<li><strong>Qt</strong>: 2x QImage, Greyscale, 8bit (Format_Greyscale8)</li>\n</ol>\n\n<p>I want to read a 16bit Tiff and then convert it to show it as 8bit.</p>\n\n<h2>Reading</h2>\n\n<pre><code>void ImgProc::Load_Image_2xTiff_16bit_G(Mat *Mat_A_in, Mat *Mat_B_in, string file_name)\n{  \n    vector&lt;Mat&gt; vec_Mat;\n    vec_Mat.reserve(2);\n\n    imreadmulti(file_name, vec_Mat);\n\n    *Mat_A_in = vec_Mat[0];\n    *Mat_B_in = vec_Mat[1];\n}\n</code></pre>\n\n<h2>Conversion</h2>\n\n<pre><code>void ImgProc::Convert_Mat16_2_QIm8(QImage *QIm_Out, Mat *Mat_In, double scale_factor)\n{\n    unsigned int rows = Mat_In-&gt;rows;\n    unsigned int cols = Mat_In-&gt;cols;\n    *QIm_Out = QImage(cols, rows, QImage::Format_Grayscale8);\n    unsigned char* line_QIm;\n\n    if (!Mat_In-&gt;data)\n        return;\n\n    for(unsigned int y = 0; y &lt; rows; y++)\n    {\n        line_QIm = QIm_Out-&gt;scanLine(y);\n        for(unsigned int x = 0; x &lt; cols; x++)\n        {\n            line_QIm[x] = (unsigned char)(Mat_In-&gt;at&lt;ushort&gt;(y, x) * scale_factor);\n        }\n    }\n}\n</code></pre>\n\n<h2>Problem</h2>\n\n<p>When i use <code>Mat_In-&gt;at&lt;ushort&gt;(y, x)</code> (read 16bits) it crashes with <code>abort() has been called</code>. Same happens if i use <code>&lt;short&gt;</code> instead.</p>\n\n<p>When i use <code>Mat_In-&gt;at&lt;uchar&gt;(y, x)</code> (read 8bits) it works, but cuts off information without scaling. That shows up as \"black holes\" in the brighter areas of the image, probably an overflow effect.</p>\n\n<p>I think i should mention, that the camera that took the images only uses 14bit depth.</p>\n"}, {"tags": ["c++", "wxwidgets"], "comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 2, "creation_date": 1536159083, "post_id": 52188016, "comment_id": 91325775, "body": "<code>delete</code> is a C++ keyword which is covered in any introductory C++ learning material. I have no idea what <code>Destroy()</code> is, but it&#39;s probably covered in WxWidgets&#39;s documentation."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1536159099, "post_id": 52188016, "comment_id": 91325791, "body": "<code>delete</code> is a keyword and is part of the <a href=\"https://en.cppreference.com/w/cpp/language/delete\" rel=\"nofollow noreferrer\">delete expression</a>.  <code>Destroy</code> is a member function and you&#39;ll have to find it to see what it does."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1536159133, "post_id": 52188016, "comment_id": 91325825, "body": "<code>delete</code> is to be used to release the memory, that was <code>new</code>ed, while <code>Destroy</code>, in your case, is a class method, and you would need to look at its implementation to know what it does."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1536159175, "post_id": 52188016, "comment_id": 91325857, "body": "Destroy is a function which is a member of <code>CTaskBarIcon</code>. You can look up what it does in either the documentation or the source code. <code>delete</code> is an operator that frees memory and calls the destructor of an object previously allocated with <code>new</code>. Instead <code>new</code> and <code>delete</code> you should use smart pointers, though."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1536159316, "post_id": 52188016, "comment_id": 91325956, "body": "I do not see the reason to downvote this question."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1536159323, "post_id": 52188016, "comment_id": 91325966, "body": "@Swordfish In this case OP shouldn&#39;t use smart pointers, or atleast, not the default deallocator."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1536159418, "post_id": 52188016, "comment_id": 91326040, "body": "@Swordfish your answer not applicable here. The question is specifically about vxwidgets framework, and one should not use smart pointers for vxwidget-managed pointer."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 704, "user_id": 7595618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51cf59e6785bbd9f82f28e8cfc0f2935?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Borkland", "link": "https://stackoverflow.com/users/7595618/mike-borkland"}, "edited": false, "score": 0, "creation_date": 1536159676, "post_id": 52188016, "comment_id": 91326204, "body": "@MikeBorkland That&#39;s not true"}, {"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 1, "creation_date": 1536160865, "post_id": 52188016, "comment_id": 91326976, "body": "TL;DR <code>Destroy()</code> is work around  the dangling reference problem in asynchronous framework, it delays deletion of object to the point where it safely can be done."}], "answers": [{"comments": [{"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 0, "creation_date": 1536160429, "post_id": 52188089, "comment_id": 91326702, "body": "similar with Qt&#39;s <code>deleteLater()</code> if you delete Widget in context where an event is handled or a nest event loop is created. Framework takes ownership of some aspects of object and deleting it without removing all dangling references from framework is incorrect. The limitation comes from fact that the deletion happens in context where possibly a cached copy of reference or pointer to deleted object exists."}, {"owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "edited": false, "score": 0, "creation_date": 1536235786, "post_id": 52188089, "comment_id": 91356560, "body": "This is perfectly correct, just notice that this explanation is not from the <a href=\"https://wiki.wxwidgets.org/\" rel=\"nofollow noreferrer\">wiki</a> but from the <a href=\"https://docs.wxwidgets.org/\" rel=\"nofollow noreferrer\">official documentation</a> site."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 11, "last_activity_date": 1536159095, "creation_date": 1536159095, "answer_id": 52188089, "question_id": 52188016, "link": "https://stackoverflow.com/questions/52188016/whats-the-difference-between-delete-and-destroy-in-wxwidgets/52188089#52188089", "title": "What&#39;s the difference between &#39;delete&#39; and &#39;destroy&#39; in wxWidgets?", "body": "<p>WXWidgets has an explanation on their <a href=\"https://docs.wxwidgets.org/3.1/overview_windowdeletion.html\" rel=\"noreferrer\">wiki</a>:</p>\n\n<blockquote>\n  <p>The wxCloseEvent handler should only call <code>wxWindow::Destroy()</code> to delete\n  the window, and not use the <code>delete</code> operator. This is because for some\n  window classes, wxWidgets delays actual deletion of the window until\n  all events have been processed, since otherwise there is the danger\n  that events will be sent to a non-existent window.</p>\n</blockquote>\n\n<p>The core keeps a list of open windows and it will decide when to actually call <code>delete</code> on these objects. The client should never call it themselves directly.</p>\n"}], "owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536166572, "creation_date": 1536158902, "last_edit_date": 1536166572, "question_id": 52188016, "link": "https://stackoverflow.com/questions/52188016/whats-the-difference-between-delete-and-destroy-in-wxwidgets", "title": "What&#39;s the difference between &#39;delete&#39; and &#39;destroy&#39; in wxWidgets?", "body": "<p>I have confused between using <code>delete</code> and <code>destroy</code> in my case when you want to delete an object, for example:</p>\n\n<p><strong>app.h</strong></p>\n\n<pre><code>#include \"taskBarIcon.h\"\nclass myApp: public wxApp{\npublic:\n    // ....\nprivate:\n    CTaskBarIcon *m_pTaskbar; // = NULL\n};\n</code></pre>\n\n<p><strong>app.cpp</strong></p>\n\n<pre><code>int myApp::OnExit() {\n    if (m_pTaskbar != NULL) {\n        delete m_pTaskbar; // &lt;-- The problem here\n        m_pTaskbar = NULL;\n    }\n    return 0;\n}\nint myApp::OnRun() {\n    mainFrm *_mainFrm = mainFrm::getInstance(); // The main window\n    _mainFrm-&gt;Show(false);\n    m_pTaskbar = new CTaskBarIcon(_mainFrm);\n    m_pTaskbar-&gt;SetIcon(wxIcon(\"appIcon\"), _mainFrm-&gt;GetTitle());      \n    return wxApp::OnRun();\n}\n</code></pre>\n\n<p><strong>CTaskBarIcon.cpp</strong></p>\n\n<pre><code>void CTaskBarIcon::rightButton_Click(wxTaskBarIconEvent &amp; event) {\n    PopupMenu(CreatePopupMenu());\n}\n\nvoid CTaskBarIcon::popupMenu_showWindow(wxCommandEvent &amp; event) {\n    m_pHandler-&gt;Iconize(false); // 'm_pHandler' is the main window\n    m_pHandler-&gt;Show();\n    m_pHandler-&gt;Raise();\n    this-&gt;Destroy();\n}\n\nvoid CTaskBarIcon::popupMenu_showAbout(wxCommandEvent &amp; event) {\n    aboutFrm aboutWindow(m_pHandler, \"About\");\n    aboutWindow.ShowModal();\n    aboutWindow.Raise();\n}\n\nvoid CTaskBarIcon::popupMenu_exit(wxCommandEvent &amp; event) {\n    m_pHandler-&gt;Close(true);\n    this-&gt;Destroy();\n}\n</code></pre>\n\n<p>The previous code cause a runtime error when quitting the program and the reason for that is to delete the member variable <code>m_pTaskbar</code>:</p>\n\n<pre><code>// app.cpp\nint myApp::OnExit() {\n    if (m_pTaskbar != NULL) {\n        delete m_pTaskbar; // &lt;-- The problem here\n        m_pTaskbar = NULL;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>But note that I was used <code>this-&gt;Destroy()</code> in different places in <code>CTaskBarIcon.cpp</code> codes.</p>\n\n<p><strong>What the difference between <code>delete</code> and <code>destroy</code>, and are they do the same thing?</strong></p>\n"}, {"tags": ["c++", "vector", "lambda", "find", "pointer-to-member"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536158669, "post_id": 52187899, "comment_id": 91325469, "body": "Is <code>isNextPoint</code> a static or non static function?"}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 1, "last_activity_date": 1536158717, "creation_date": 1536158717, "answer_id": 52187948, "question_id": 52187899, "link": "https://stackoverflow.com/questions/52187899/how-to-use-find-if-to-find-a-matching-object-of-a-class-or-any-other-way-to-ac/52187948#52187948", "title": "How to use find_if to find a matching object of a class? (Or any other way to achieve the result)", "body": "<p>Assuming that <code>isNextPoint</code> is marked <code>static</code>, you need to explicitly qualify it:</p>\n\n<pre><code>find_if(BS_stimulus_list.begin(), \n        BS_stimulus_list.end(), \n        StimulusCollection::isNextPoint)\n</code></pre>\n\n<p>If it's not <code>static</code> you can use a <em>lambda expression</em> in order to bind the invocation of <code>isNextPoint</code> to a particular instance of <code>StimulusCollection</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9725757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a6421bcdcd2a430829551074ffd24?s=128&d=identicon&r=PG&f=1", "display_name": "ni5arg", "link": "https://stackoverflow.com/users/9725757/ni5arg"}, "edited": false, "score": 0, "creation_date": 1536160116, "post_id": 52188087, "comment_id": 91326506, "body": "Thanks, this works with a little modification.         [this](const auto&amp; stimulus) { return isNextPoint(stimulus); }); is changed to          [this](const Stimulus&amp; stimulus) { return isNextPoint(stimulus); });"}], "tags": [], "owner": {"reputation": 293, "user_id": 10175089, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8e02341885a5deb7306e7049d659cbdf?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/10175089/dan"}, "is_accepted": true, "score": 1, "last_activity_date": 1536317822, "last_edit_date": 1536317822, "creation_date": 1536159094, "answer_id": 52188087, "question_id": 52187899, "link": "https://stackoverflow.com/questions/52187899/how-to-use-find-if-to-find-a-matching-object-of-a-class-or-any-other-way-to-ac/52188087#52188087", "title": "How to use find_if to find a matching object of a class? (Or any other way to achieve the result)", "body": "<p>you have to specify the instance, either by using a lambda (see below) or <code>std::bind</code></p>\n\n<pre><code>void StimulusCollection::NextBSStimulus(char e) {\n    currentEye = e;\n    if (currentEye=='L'){\n        vector&lt;Stimulus&gt;::iterator idx = find_if(\n            BS_stimulus_list.begin(), \n            BS_stimulus_list.end(),\n            [this](const auto&amp; stimulus) { return isNextPoint(stimulus); });\n    }\n}\n</code></pre>\n\n<p>(for C++14, change <code>const auto&amp;</code> to <code>const Stimulus&amp;</code> for older versions)</p>\n"}], "owner": {"reputation": 3, "user_id": 9725757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/899a6421bcdcd2a430829551074ffd24?s=128&d=identicon&r=PG&f=1", "display_name": "ni5arg", "link": "https://stackoverflow.com/users/9725757/ni5arg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52188087, "answer_count": 2, "score": -1, "last_activity_date": 1536317822, "creation_date": 1536158568, "question_id": 52187899, "link": "https://stackoverflow.com/questions/52187899/how-to-use-find-if-to-find-a-matching-object-of-a-class-or-any-other-way-to-ac", "title": "How to use find_if to find a matching object of a class? (Or any other way to achieve the result)", "body": "<p>I'm trying to traverse through a vector of \"Stimulus\" class objects. And if the properties of the object match the criteria, I want that Stimulus object returned.</p>\n\n<pre><code>std::vector&lt;Stimulus&gt; BS_stimulus_list;\n\nbool StimulusCollection::isNextPoint(Stimulus it){\nif(it.GetPointDeg()==\"(Some json value)\" &amp; it.GetEye()==currentEye){\n    return true;\n}\nelse{\n    return false;\n}\n\nvoid StimulusCollection::NextBSStimulus(char e){\ncurrentEye = e;\nif (currentEye=='L'){\n    vector&lt;Stimulus&gt;::iterator idx = find_if(BS_stimulus_list.begin(), BS_stimulus_list.end(),isNextPoint);\n}\n</code></pre>\n\n<p>The code above gives me a compile error : must use '.<em>' or '-></em>' to call pointer-to-member function in.....\nWhat am I doing wrong? Or what should I do differently to avoid this altogether? </p>\n"}, {"tags": ["c++", "boost", "c++17"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536158642, "post_id": 52187867, "comment_id": 91325444, "body": "please be more specific on what is the output and what output you expect. How do you know that &quot;the execution doesn&#39;t enter here&quot; ? Did you already use a debugger?"}, {"owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536158814, "post_id": 52187867, "comment_id": 91325575, "body": "yes, I&#39;m debugging it. The point is, it is not entering the while loop and according to the example in the docs this is how I&#39;d get the output from the <code>cmd</code> execution line by line"}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1536159035, "post_id": 52187867, "comment_id": 91325742, "body": "Answer to <a href=\"https://stackoverflow.com/questions/478898/how-to-execute-a-command-and-get-output-of-command-within-c-using-posix\">this question</a> should solve your problem. You can execute for example <code>ps aux | grep PROC_NAME | grep -v &quot;grep .* PROC_NAME&quot;</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1536173455, "post_id": 52187867, "comment_id": 91333081, "body": "Does boost documentation tell you it will launch a shell? If not, you cannot use shell syntax like <code>2&gt;&amp;1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536179881, "post_id": 52191597, "comment_id": 91335845, "body": "This is in principle over complicating. It might be required when input/output are truly async and need to be intermixed - i.e. deadlock would occur if you kept synchronously reading when the process required input. The command in the example does not take any input (in fact one could <code>bp::std_in.close()</code> or <code>bp::std_in &lt; bp::null</code>)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536179941, "post_id": 52191597, "comment_id": 91335877, "body": "Also, <code>tstring(exeName_) + _T(&quot; &quot;) + args</code> will not work as advertised. Is that from real working code? That looks suspicuous."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536181402, "post_id": 52191597, "comment_id": 91336449, "body": "That&#39;s how I got it to work, after turning around in circles for hours, like the OP.   I did need all three streams.  That was for an encryption utility.  This is production code, not an example."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536181458, "post_id": 52191597, "comment_id": 91336467, "body": "But there is no way that <code>bp::child</code> will accept the arguments separated by just a space there. What version of boost is that? And is it unmodified? (If that works it either is or used to be a weird bug)"}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536181706, "post_id": 52191597, "comment_id": 91336573, "body": "@sehe: <code>tstring(exeName_&#176; + T(&quot; &quot; ) + args</code> works as advertized, since  exeName_ is a <code>const TCHAR*</code>.  It would also work as <code>tstring{} + exeName_ + _T(&quot; &quot;) + args</code>, but not without the reference to <code>tstring</code>."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536181792, "post_id": 52191597, "comment_id": 91336610, "body": "@sehe.  It&#39;s using boost 1.62.0.  And it does work in the field.  bp::child accepts a simple command line."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536182060, "post_id": 52191597, "comment_id": 91336712, "body": "This is based on another boosrt::process example, that is also buggy.  The vOut buffer is empty in the example, which makes it fail."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536182876, "post_id": 52191597, "comment_id": 91336995, "body": "I&#39;m miffed. It&#39;s expressly documented to only accept a binary name (fully path-qualified even)."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536182878, "post_id": 52191597, "comment_id": 91336996, "body": "Oh wait up a second. Boost 1.62 <b>doesn&#39;t even have Boost Process</b>. You must have been using alpha versions (and I remember them being highly volatile). I wouldn&#39;t advertise solutions based on that version as &quot;good practice&quot;."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536185028, "post_id": 52191597, "comment_id": 91337658, "body": "It&#39;s 1.64.  Project is a few months old, sorry.  By the way, my post is about helping OP solve his issue.  Not about gleaning a few poiints, dude."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536189370, "post_id": 52191597, "comment_id": 91338660, "body": "(I&#39;m not a dude. And I don&#39;t remember talking about points. Why bring that up?) I&#39;m also here helping others/learning, which is why I think it&#39;s important to discuss correctness issues/bugs with answers, right. If it surprises me and contradicts documented behaviour, then a fair warning is in order. If the docs need to be fixed, I&#39;m all for it."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536190056, "post_id": 52191597, "comment_id": 91338807, "body": "I think I found the solution though. Apparently though the examples only mention <code>bp::system</code> here <a href=\"https://www.boost.org/doc/libs/1_65_1/doc/html/boost_process/design.html#boost_process.design.arg_cmd_style\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_65_1/doc/html/boost_process/&hellip;</a> the same logic is also applied to the other API entry points (? just guessing here) like <code>bp::system</code> or <code>bp::child</code>. It would be really nice to have the documentation improved."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536190059, "post_id": 52191597, "comment_id": 91338808, "body": "I had assumed that, since we can supply the arguments separately, they must be (except for <code>system()</code> which has that documented, and always had that behaviour even <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\">in POSIX</a>). Indeed <a href=\"http://coliru.stacked-crooked.com/a/174422822f219c48\" rel=\"nofollow noreferrer\">this works</a> but <a href=\"http://coliru.stacked-crooked.com/a/8ded2188a0d68152\" rel=\"nofollow noreferrer\">not with redirection</a>. So I wouldn&#39;t recommend it because apparently the parsing is really limited and breaks common shell constructs."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536190568, "post_id": 52191597, "comment_id": 91338913, "body": "Bootom line is:  the code above works, with boost 1.64.  I haven&#39;t had any issues with it. And yes, the examples provided in the doc leave to be desired, since they don&#39;t work."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1536193019, "post_id": 52191597, "comment_id": 91339328, "body": "Yup. I learned another surprising thing about Boost Process again. Thanks. I&#39;d love if the interface was more consistent (e.g. <a href=\"https://github.com/boostorg/process/issues/37\" rel=\"nofollow noreferrer\">github.com/boostorg/process/issues/37</a>). For completeness, here&#39;s a version modernized to Boost 1.67 and correctly handling shell redirects: <a href=\"http://coliru.stacked-crooked.com/a/4be23435f72b6021\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/4be23435f72b6021</a>"}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 2, "last_activity_date": 1536173731, "last_edit_date": 1536173731, "creation_date": 1536172918, "answer_id": 52191597, "question_id": 52187867, "link": "https://stackoverflow.com/questions/52187867/how-to-run-a-process-and-get-its-output-using-c-libboost/52191597#52191597", "title": "How to run a process and get its output using c++ libboost?", "body": "<p>I've had this issue...  I could only get process to work using boost::asio.</p>\n\n<p>Here's the code, hopefully that will help.  The code below handles all three of the child process's streams.</p>\n\n<p>The only external is exename_, and tstring is a std::basic_string&lt;TCHAR&gt;.</p>\n\n<pre><code>void UBC::Run(\n    const tstring&amp; args,\n    const std::string&amp; input,\n    std::string&amp; output,\n    std::string&amp; error)\n{\n    using namespace boost;\n\n    asio::io_service ios;\n\n    std::vector&lt;char&gt; vOut(128 &lt;&lt; 10);\n    auto outBuffer{ asio::buffer(vOut) };\n    process::async_pipe pipeOut(ios);\n\n    std::function&lt;void(const system::error_code &amp; ec, std::size_t n)&gt; onStdOut;\n    onStdOut = [&amp;](const system::error_code &amp; ec, size_t n)\n    {\n        output.reserve(output.size() + n);\n        output.insert(output.end(), vOut.begin(), vOut.begin() + n);\n        if (!ec)\n        {\n            asio::async_read(pipeOut, outBuffer, onStdOut);\n        }\n    };\n\n    std::vector&lt;char&gt; vErr(128 &lt;&lt; 10);\n    auto errBuffer{ asio::buffer(vErr) };\n    process::async_pipe pipeErr(ios);\n    std::function&lt;void(const system::error_code &amp; ec, std::size_t n)&gt; onStdErr;\n    onStdErr = [&amp;](const system::error_code &amp; ec, size_t n)\n    {\n        error.reserve(error.size() + n);\n        error.insert(error.end(), vErr.begin(), vErr.begin() + n);\n        if (!ec)\n        {\n            asio::async_read(pipeErr, errBuffer, onStdErr);\n        }\n    };\n\n    auto inBuffer{ asio::buffer(input) };\n    process::async_pipe pipeIn(ios);\n\n    process::child c(\n        tstring(exeName_) + _T(\" \") + args, \n        process::std_out &gt; pipeOut, \n        process::std_err &gt; pipeErr, \n        process::std_in &lt; pipeIn\n    );\n\n\n    asio::async_write(pipeIn, inBuffer, \n        [&amp;](const system::error_code &amp; ec, std::size_t n) \n        {\n            pipeIn.async_close();\n        });\n\n    asio::async_read(pipeOut, outBuffer, onStdOut);\n    asio::async_read(pipeErr, errBuffer, onStdErr);\n\n    ios.run();\n    c.wait();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536239138, "post_id": 52193030, "comment_id": 91358664, "body": "But why? Why not just <code>..., bp::std_out &gt; out, bp::std_err &gt; out)</code>?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536246582, "post_id": 52193030, "comment_id": 91363558, "body": "@n.m. Mmm. That might actually work. But I don&#39;t think that&#39;s the essence of the question. Also the &quot;semantics&quot; of that might be different from the shells redirect depending on how exactly it&#39;s implemented. I&#39;d say the question as posed has merit for that reason, and your comment is a welcome addition."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1536179672, "creation_date": 1536179672, "answer_id": 52193030, "question_id": 52187867, "link": "https://stackoverflow.com/questions/52187867/how-to-run-a-process-and-get-its-output-using-c-libboost/52193030#52193030", "title": "How to run a process and get its output using c++ libboost?", "body": "<p>Simply use a shell (or use <code>bp::system</code>):</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/2d40dfee2f8fb737\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/process.hpp&gt;\nnamespace bp = boost::process;\n\nbool is_process_running(std::string p_name){\n    std::vector&lt;std::string&gt; args { \"-c\", \"ps aux 2&gt;&amp;1\" };\n    bp::ipstream out;\n    bp::child c(bp::search_path(\"sh\"), args, bp::std_out &gt; out);\n\n    for (std::string line; c.running() &amp;&amp; std::getline(out, line);) {\n        if (line.find(p_name) != std::string::npos) {\n            return true;\n        }\n    }\n    c.wait();\n\n    return false;\n}\n\n#include &lt;iostream&gt;\nint main() {\n    std::cout &lt;&lt; \"bogus: \" &lt;&lt; is_process_running(\"bogus\") &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"a.out: \" &lt;&lt; is_process_running(\"a.out\") &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>bogus: 0\na.out: 1\n</code></pre>\n"}], "owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 0, "accepted_answer_id": 52193030, "answer_count": 2, "score": 1, "last_activity_date": 1536204016, "creation_date": 1536158487, "question_id": 52187867, "link": "https://stackoverflow.com/questions/52187867/how-to-run-a-process-and-get-its-output-using-c-libboost", "title": "How to run a process and get its output using c++ libboost?", "body": "<p>I'm trying to run an external shell command and read its output using the Boost libraries for C++ but it seems that either the command is not running or I just can't access the output. I'm using <a href=\"https://www.boost.org/doc/libs/1_65_1/doc/html/boost_process/tutorial.html#boost_process.tutorial.io\" rel=\"nofollow noreferrer\">their documentation</a> as example and wrote this: </p>\n\n<pre><code>#include &lt;boost/process.hpp&gt;\nnamespace bp = boost::process;\n\nbool is_process_running(std::string p_name){\n        string cmd = \"ps aux 2&gt;&amp;1\";\n        bp::ipstream out;\n        std::string line;\n        bp::child c(cmd, bp::std_out &gt; out);\n\n        // the while is supposed to read each line of the output\n        // but the execution doesn't enter here\n        while(c.running() &amp;&amp; std::getline(out, line) &amp;&amp; !line.empty())\n        {\n            if(line.find(p_name) != std::string::npos)\n            {\n                return true;\n            }\n        }\n        c.wait();\n        return false;\n}\n</code></pre>\n\n<p>The goal is to verify each line output of <code>ps aux</code> and search if a process is running. So, what could be the problem here? Or, can you provide a simple snippet for doing this?</p>\n"}, {"tags": ["c++", "constructor", "c++17", "move-constructor"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1536157733, "post_id": 52187539, "comment_id": 91324835, "body": "You would implement one by not implementing one. Use <code>std::string</code> or <code>std::array</code> and let the compiler do it."}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 4, "creation_date": 1536157766, "post_id": 52187539, "comment_id": 91324853, "body": "Your move constructor will be the same as your copy constructor.  There&#39;s no clever way to &quot;move&quot; a fixed size array.  But why don&#39;t you want to use a <code>std::array</code>?  It seems like a good idea to me."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 5, "creation_date": 1536157785, "post_id": 52187539, "comment_id": 91324865, "body": "There is nothing to move in this class. You don&#39;t need it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1536157810, "post_id": 52187539, "comment_id": 91324881, "body": "Any reason you aren&#39;t using a <code>std::string</code> and the rule of zero?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1536157814, "post_id": 52187539, "comment_id": 91324885, "body": "And if you don&#39;t use <code>std::string</code>, your class gains nothing from moving."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1536157986, "post_id": 52187539, "comment_id": 91325005, "body": "This doesn&#39;t address the question, but if the goal is for the class to hold a nul-terminated C string, the code in <code>set_name</code> is wrong. If the string pointed to by <code>s</code> is longer than the buffer size, the call to <code>memcpy</code> will copy characters from <code>s</code> into the buffer up to the limit. The result will be that the text in <code>name</code> is not nul terminated."}, {"owner": {"reputation": 200, "user_id": 7890728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PS94H.png?s=128&g=1", "display_name": "usernameiwantedwasalreadytaken", "link": "https://stackoverflow.com/users/7890728/usernameiwantedwasalreadytaken"}, "edited": false, "score": 0, "creation_date": 1536158205, "post_id": 52187539, "comment_id": 91325133, "body": "I&#39;m not using <code>std::string</code> to avoid memory allocations."}, {"owner": {"reputation": 200, "user_id": 7890728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PS94H.png?s=128&g=1", "display_name": "usernameiwantedwasalreadytaken", "link": "https://stackoverflow.com/users/7890728/usernameiwantedwasalreadytaken"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1536158271, "post_id": 52187539, "comment_id": 91325169, "body": "@Petebecker, yeah, this is because I tried to type quickly a minimal working example... the real class is not like that... But thanks!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536158420, "post_id": 52187539, "comment_id": 91325262, "body": "if you used <code>std::string</code> it was quicker to type :P"}, {"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1536158668, "post_id": 52187539, "comment_id": 91325465, "body": "[...] <i>avoid memory allocations</i> [...] Probalby interesting to know for you is <b>short string optimization</b>. libc for example 10 byte on 32bit systems, 22byte on 64bit systems. I think most names fill fit..."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536159005, "post_id": 52187539, "comment_id": 91325716, "body": "You don&#39;t need to count the non-null <code>char</code>s of <code>name</code> in the copy (and move) constructor, you can just use a flat <code>name_length + 1</code>."}, {"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1536159177, "post_id": 52187539, "comment_id": 91325860, "body": "BTW: Why is <code>name_length = 64</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1536158782, "post_id": 52187939, "comment_id": 91325552, "body": "Pointers or not has nothing to do with it, though there is a correlation."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1536158848, "post_id": 52187939, "comment_id": 91325606, "body": "@Deduplicator That is a statement too strong to be correct. In this specific case your statement is plainly incorrect."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1536159086, "post_id": 52187939, "comment_id": 91325777, "body": "&quot;There are no resources owned by this class&quot; is probably a better phrasing"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536159138, "post_id": 52187939, "comment_id": 91325828, "body": "@Caleth I take that line."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1536159435, "last_edit_date": 1536159435, "creation_date": 1536158685, "answer_id": 52187939, "question_id": 52187539, "link": "https://stackoverflow.com/questions/52187539/c-move-constructor-of-class-with-a-fixed-size-c-style-array-member/52187939#52187939", "title": "C++ - Move constructor of class with a fixed size, c-style array member", "body": "<blockquote>\n  <p>how would I implement a move constructor?</p>\n</blockquote>\n\n<p>There are no resources owned by this class, no pointer members, so its move constructor is identical to its copy constructor.</p>\n\n<p>Also, you do not need to define the copy constructor manually here, the compiler-generated one does the right thing - member-wise copy:</p>\n\n<pre><code>some(const some&amp; s) = default;\n</code></pre>\n\n<p>Alternatively, you can remove both constructors. This will also allow you to initialized your class with aggregate initializer syntax like: <code>some s = {\"it is something\"};</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 3, "last_activity_date": 1536159723, "last_edit_date": 1536159723, "creation_date": 1536159104, "answer_id": 52188092, "question_id": 52187539, "link": "https://stackoverflow.com/questions/52187539/c-move-constructor-of-class-with-a-fixed-size-c-style-array-member/52188092#52188092", "title": "C++ - Move constructor of class with a fixed size, c-style array member", "body": "<p>As your class doesn't own any resource directly (nor indirectly through a member), don't waste your time writing move-ctor and / or move-assignment, there's no advantage to be gained:<br>\nThey have to do the same as the copy-variants anyway.</p>\n\n<p>Also, writing your own custom copy-ctor is a waste of time, as the default one is perfectly fine, and has the disadvantage of making the class non-trivial. Though if you have to be demonstrative, explicitly default it in-class to preserve triviality.</p>\n\n<p>As an aside, consider whether you need 0-termination at all, or can use 0-padded sequences of maximum length instead. Just one more than a power of two is quite an awkward size.</p>\n"}], "owner": {"reputation": 200, "user_id": 7890728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PS94H.png?s=128&g=1", "display_name": "usernameiwantedwasalreadytaken", "link": "https://stackoverflow.com/users/7890728/usernameiwantedwasalreadytaken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "accepted_answer_id": 52187939, "answer_count": 2, "score": -1, "last_activity_date": 1536159723, "creation_date": 1536157608, "last_edit_date": 1536159502, "question_id": 52187539, "link": "https://stackoverflow.com/questions/52187539/c-move-constructor-of-class-with-a-fixed-size-c-style-array-member", "title": "C++ - Move constructor of class with a fixed size, c-style array member", "body": "<p>I have a class with a fixed size, c-style array member, something like <a href=\"https://ideone.com/luzr2D\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>struct some {\n    static const size_t name_length = 64;\n\n    char name[name_length+1];\n\n    some() = default;\n\n    some(const some&amp; s) {\n        memcpy(name, s.name, strlen(s.name)+1);\n    }\n\n    // other constructors...\n\n    void set_name(const char* s) {\n        auto len = strlen(s);\n        if (len &gt; name_length) {\n            len = name_length;\n        }\n        memcpy(name, s, len);\n        name[len] = '\\0';\n    }\n};\n</code></pre>\n\n<p>Copy constructor works fine, but <strong>how would I implement a move constructor?</strong></p>\n\n<p>I know I could replace the c-style array with <code>std::array</code>, but is there anyway to do this without it?</p>\n\n<p>P.S.: A lot of people are suggesting for me to use the compiler-generated copy/move constructors... Unfortunately, in the real class, I cannot do that because this class has other members and other constructors... I just wanted to know if there were a way to move the fixed-size members. I guess there isn't, and the move constructor will have to just copy the bytes. I wonder if this is what <code>std::array</code> does...</p>\n"}, {"tags": ["c++", "rabbitmq", "amqp", "event-loop", "libev"], "answers": [{"tags": [], "owner": {"reputation": 2907, "user_id": 1928515, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a01ce6c702f6514136cfecc06b8cdb25?s=128&d=identicon&r=PG", "display_name": "nabroyan", "link": "https://stackoverflow.com/users/1928515/nabroyan"}, "is_accepted": true, "score": 0, "last_activity_date": 1536327051, "creation_date": 1536327051, "answer_id": 52223623, "question_id": 52187515, "link": "https://stackoverflow.com/questions/52187515/amqp-cpp-libev-stop-ev-loop-from-another-thread/52223623#52223623", "title": "AMQP-CPP, libev &gt; stop ev_loop from another thread", "body": "<p>Here is an example:</p>\n\n<pre><code>void asyncCallback(EV_P_ ev_async*, int)\n{\n    ev_break(m_loop, EVBREAK_ONE);\n}\n\nvoid MyClass::stopLoop()\n{\n    ev_async_init(&amp;m_asyncWatcher, asyncCallback);\n    ev_async_start(m_loop, &amp;m_asyncWatcher);\n    ev_async_send(m_loop, &amp;m_asyncWatcher);\n\n    m_thread-&gt;join();\n}\n\n// in the class async watcher should be defined\nev_async m_asyncWatcher;\n</code></pre>\n\n<p>By calling <code>stopLoop()</code> function from another thread it stops the loop that started from m_thread worker thread.</p>\n"}], "owner": {"reputation": 2907, "user_id": 1928515, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a01ce6c702f6514136cfecc06b8cdb25?s=128&d=identicon&r=PG", "display_name": "nabroyan", "link": "https://stackoverflow.com/users/1928515/nabroyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 52223623, "answer_count": 1, "score": 0, "last_activity_date": 1536327051, "creation_date": 1536157546, "question_id": 52187515, "link": "https://stackoverflow.com/questions/52187515/amqp-cpp-libev-stop-ev-loop-from-another-thread", "title": "AMQP-CPP, libev &gt; stop ev_loop from another thread", "body": "<p>I use <a href=\"https://github.com/CopernicaMarketingSoftware/AMQP-CPP\" rel=\"nofollow noreferrer\">AMQP-CPP</a> lib with <code>libev</code> backend. I try to create a class which will open a connection and do consuming. I want to run connection's loop in a worker thread in order not to block the main thread. That part of code looks like this</p>\n\n<pre><code>...\nm_thread.reset(new std:thread([this]()\n    {\n        ev_run(m_loop, 0);\n    }));\n...\n</code></pre>\n\n<p>Then at some point I want to stop the loop. I have read that it is possible to do it with <code>ev_break()</code> function. However, it should be called from the same thread as <code>ev_run()</code> was called. More search showed that <code>ev_async_send()</code> function might do that, but I cannot figure out how. </p>\n\n<p>How can I do it? Any ideas?</p>\n"}, {"tags": ["c++", "scope", "global-variables", "local-variables"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1536157212, "post_id": 52187401, "comment_id": 91324486, "body": "1) No. It is called variable shadowing, and the compiler typically warns about it. 2) <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h/31816096\">Why should I not #include &lt;bits/stdc++.h&gt;?</a> 3) <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">Why is \u201cusing namespace std\u201d considered bad practice?</a>"}, {"owner": {"reputation": 289239, "user_id": 704848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9be2c2958e208c8d9b629ac43c9c42?s=128&d=identicon&r=PG", "display_name": "EdChum", "link": "https://stackoverflow.com/users/704848/edchum"}, "edited": false, "score": 2, "creation_date": 1536157250, "post_id": 52187401, "comment_id": 91324516, "body": "Why name the variables the same? If they had different names you wouldn&#39;t need to care"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536157318, "post_id": 52187401, "comment_id": 91324552, "body": "yes it is possible, simply use distinct names. I know that sometimes it is helpful for gereral understanding how to do something even if normally you dont need it, but when you see a variable that shadows another one, your first reflex should really be to give them proper names (<code>i</code> isnt a good name anyhow)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1536157399, "post_id": 52187401, "comment_id": 91324602, "body": "The first two lines, <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h/31816096\"><code>#include &lt;bits&#47;stdc++.h&gt;</code></a> and <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\"><code>using namespace std;</code></a>, indicate that your resource for learning C++ needs to be replaced."}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1536157609, "post_id": 52187401, "comment_id": 91324750, "body": "Sorry to bombard you, but I&#39;d like to add one more why using <a href=\"http://chris-sharpe.blogspot.co.uk/2016/02/why-you-shouldnt-use-stdendl.html\" rel=\"nofollow noreferrer\"><code>endl</code></a> is a bad practice. (Actually <a href=\"https://www.youtube.com/watch?v=6WeEMlmrfOI\" rel=\"nofollow noreferrer\">two more</a>."}, {"owner": {"reputation": 13, "user_id": 10305617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sx7U8fhH8Bk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP2fcQE1t2DTOLkQgDRf9-dGimu2w/mo/photo.jpg?sz=128", "display_name": "Nitin Pathak", "link": "https://stackoverflow.com/users/10305617/nitin-pathak"}, "reply_to_user": {"reputation": 289239, "user_id": 704848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9be2c2958e208c8d9b629ac43c9c42?s=128&d=identicon&r=PG", "display_name": "EdChum", "link": "https://stackoverflow.com/users/704848/edchum"}, "edited": false, "score": 1, "creation_date": 1536157622, "post_id": 52187401, "comment_id": 91324761, "body": "@EdChum just want to explore the features of the language"}], "owner": {"reputation": 13, "user_id": 10305617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sx7U8fhH8Bk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP2fcQE1t2DTOLkQgDRf9-dGimu2w/mo/photo.jpg?sz=128", "display_name": "Nitin Pathak", "link": "https://stackoverflow.com/users/10305617/nitin-pathak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1536157696, "answer_count": 0, "score": 0, "last_activity_date": 1536157914, "creation_date": 1536157168, "last_edit_date": 1536157914, "question_id": 52187401, "link": "https://stackoverflow.com/questions/52187401/accessing-local-variable-declared-outside-loop-in-loop-scope-in-c", "closed_reason": "Duplicate", "title": "Accessing local variable declared outside loop in loop scope in c++?", "body": "<p>This question is NOT the same as how to access same name global variable in a function. I know it is done using :: operator, please do not assign this as already answered,  please go though the complete question, I will mark the question as answered myself once I get a satisfactory response.</p>\n\n<p><strong>Please look at following c++ code</strong></p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\nint var = 10;                    // global declaration 1\n\nint main ()\n{\n   int var = 20; // local declaration 2\n\n      for (int j = 0; j &lt; 1; j++)\n      {\n        int var = 30; //local declaration 2\n        cout &lt;&lt; var &lt;&lt; endl;    // this considers var of local declaration 2 and prints 30;\n        cout &lt;&lt; ::var &lt;&lt; endl;  // this considers global var and prints 10\n      }\n\n}\n</code></pre>\n\n<p>Is there any way to print i of local declaration 1 i.e. i = 20 like there is a way to print the global i using the scope resolution operator(::) ??</p>\n\n<p>I am new to C++ and would really appreciate your help. ;-)</p>\n"}, {"tags": ["c++", "visual-studio-code", "alignment", "clang-format"], "comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1536157536, "post_id": 52187397, "comment_id": 91324689, "body": "Have you looked at <code>clang-format</code>?"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1536157642, "post_id": 52187397, "comment_id": 91324777, "body": "Please only tag actual code as code, not words or names of things."}, {"owner": {"reputation": 25, "user_id": 6385535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867968e6bb7924150ef5b6eab38ad5a?s=128&d=identicon&r=PG&f=1", "display_name": "elch10", "link": "https://stackoverflow.com/users/6385535/elch10"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1536157806, "post_id": 52187397, "comment_id": 91324877, "body": "@DanM. I can&#39;t found option that does such alignment. Maybe I do not see it?"}], "answers": [{"comments": [{"owner": {"reputation": 15498, "user_id": 519814, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3b512420352799f21d1e7933b59b9ed?s=128&d=identicon&r=PG", "display_name": "Subin Sebastian", "link": "https://stackoverflow.com/users/519814/subin-sebastian"}, "edited": false, "score": 1, "creation_date": 1559734741, "post_id": 52187589, "comment_id": 99510904, "body": "The clang-format was spot-on."}], "tags": [], "owner": {"reputation": 56338, "user_id": 4573247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JHd9a.png?s=128&g=1", "display_name": "dfrib", "link": "https://stackoverflow.com/users/4573247/dfrib"}, "is_accepted": true, "score": 5, "last_activity_date": 1536159013, "last_edit_date": 1536159013, "creation_date": 1536157736, "answer_id": 52187589, "question_id": 52187397, "link": "https://stackoverflow.com/questions/52187397/c-vertically-align-declarations-in-visual-studio-code/52187589#52187589", "title": "C++ vertically align declarations in Visual Studio Code", "body": "<h2>Clang-format</h2>\n\n<p><em>Possibly</em>, you should also be able to use <code>clang-format</code> and its <code>AlignConsecutiveDeclarations</code> option, but I haven't yet verified whther this is viable also for consecutive class member declarations (if not, this section will be removed):</p>\n\n<blockquote>\n  <p><strong><code>AlignConsecutiveDeclarations</code> (<code>bool</code>)</strong></p>\n  \n  <p>If <code>true</code>, aligns consecutive declarations.</p>\n  \n  <p>This will align the declaration names of consecutive lines. This will\n  result in formattings like</p>\n\n<pre><code>int         aaaa = 12;\nfloat       b = 23;\nstd::string ccc = 23;\n</code></pre>\n</blockquote>\n\n<h2>Visual Studio Code Formatter: Code alignment</h2>\n\n<p>The extension mentioned in the stricken parts below applies to Visual Studio; not Visual Studio Code (as was requested by OP). The same author has released an early adapted version of Code alignment for VSCode, however:</p>\n\n<ul>\n<li><a href=\"https://marketplace.visualstudio.com/items?itemName=cpmcgrath.codealignment-vscode\" rel=\"nofollow noreferrer\">Visual Studio Code > Formatters > Code alignment </a></li>\n</ul>\n\n<blockquote>\n  <h3>Current State</h3>\n  \n  <p>Many of Code alignment's best features are currently missing. The plan\n  is to release early and release often, and to eventually reach parity.</p>\n  \n  <p>Main code alignment repository:\n  <a href=\"https://github.com/cpmcgrath/codealignment\" rel=\"nofollow noreferrer\">https://github.com/cpmcgrath/codealignment</a></p>\n  \n  <p>...</p>\n</blockquote>\n\n<p><s>\nThe Visual Studio extension <a href=\"https://marketplace.visualstudio.com/items?itemName=cpmcgrath.Codealignment\" rel=\"nofollow noreferrer\">Code alignment</a> allows you to format e.g. struct members in the way you show in your example.</p>\n\n<p>Citing <a href=\"http://www.codealignment.com/Details.html\" rel=\"nofollow noreferrer\">it's documentation</a>:</p>\n\n<blockquote>\n  <p>The Code alignment extension allows you to align by more than just the equals ...</p>\n  \n  <h3>Some more examples</h3>\n\n<pre><code>private string m_firstName = string.Empty; =&gt; private string  m_firstName = string.Empty; \nprivate string m_surname = string.Empty;   =&gt; private string  m_surname   = string.Empty; \nprivate int m_age = 18;                    =&gt; private int     m_age       = 18; \nprivate Address m_address;                 =&gt; private Address m_address;\n</code></pre>\n  \n  <p>...\n  </s></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3819, "user_id": 4289700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GGKsgSVN_n4/AAAAAAAAAAI/AAAAAAAAAvQ/_IAucbb8ss8/photo.jpg?sz=128", "display_name": "HugoTeixeira", "link": "https://stackoverflow.com/users/4289700/hugoteixeira"}, "is_accepted": false, "score": -1, "last_activity_date": 1536158041, "creation_date": 1536158041, "answer_id": 52187696, "question_id": 52187397, "link": "https://stackoverflow.com/questions/52187397/c-vertically-align-declarations-in-visual-studio-code/52187696#52187696", "title": "C++ vertically align declarations in Visual Studio Code", "body": "<p>For those who use <a href=\"https://www.jetbrains.com/clion/\" rel=\"nofollow noreferrer\">Clion</a>, there is an option in <code>Editor &gt; Code Style &gt; C/C++</code>. In the <code>Wrapping and Braces</code> tab, you can check the <code>Variable groups | Align in columns</code> checkbox.</p>\n\n<p><a href=\"https://i.stack.imgur.com/C3iNQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C3iNQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 6385535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867968e6bb7924150ef5b6eab38ad5a?s=128&d=identicon&r=PG&f=1", "display_name": "elch10", "link": "https://stackoverflow.com/users/6385535/elch10"}, "edited": false, "score": 0, "creation_date": 1536159091, "post_id": 52187768, "comment_id": 91325784, "body": "yes it is, thank you"}], "tags": [], "owner": {"reputation": 293, "user_id": 10175089, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8e02341885a5deb7306e7049d659cbdf?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/10175089/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1536158254, "creation_date": 1536158254, "answer_id": 52187768, "question_id": 52187397, "link": "https://stackoverflow.com/questions/52187397/c-vertically-align-declarations-in-visual-studio-code/52187768#52187768", "title": "C++ vertically align declarations in Visual Studio Code", "body": "<p><a href=\"https://clang.llvm.org/docs/ClangFormatStyleOptions.html\" rel=\"nofollow noreferrer\">clang-format</a> with \"AlignConsecutiveDeclarations\" outputs:</p>\n\n<pre><code>struct A {\n  double a;\n  int    b;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6385535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867968e6bb7924150ef5b6eab38ad5a?s=128&d=identicon&r=PG&f=1", "display_name": "elch10", "link": "https://stackoverflow.com/users/6385535/elch10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1131, "favorite_count": 0, "closed_date": 1536159566, "accepted_answer_id": 52187589, "answer_count": 3, "score": 1, "last_activity_date": 1590418870, "creation_date": 1536157162, "last_edit_date": 1590418870, "question_id": 52187397, "link": "https://stackoverflow.com/questions/52187397/c-vertically-align-declarations-in-visual-studio-code", "closed_reason": "Not suitable for this site", "title": "C++ vertically align declarations in Visual Studio Code", "body": "<p>I try to do vertical declaration alignment in Visual Studio Code.</p>\n\n<p>This code:</p>\n\n<pre><code>struct A {\n  double a;\n  int b;\n}\n</code></pre>\n\n<p>must be converted into this:</p>\n\n<pre><code>struct A {\n  double a;\n  int    b;\n}\n</code></pre>\n\n<p>Note, that here is not assignment, this is only declaration of struct with aligned fields.</p>\n\n<p>Is there any extension for Visual Studio Code that does this?</p>\n"}, {"tags": ["c++", "jenkins", "cmake"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1536157541, "post_id": 52187283, "comment_id": 91324696, "body": "Topology used when you have a project that depends on other (sub)projects varies greatly.  I find that having each project and (sub)project in a root directory as peers, and each peer project contains its own independent git repository works best for me and my work style."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1536158826, "post_id": 52187283, "comment_id": 91325586, "body": "<i>cough cough</i> <code>git submodules</code> <i>cough cough</i>"}, {"owner": {"reputation": 10552, "user_id": 643393, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a2cb19c975ede804712de8fcc0435f6e?s=128&d=identicon&r=PG", "display_name": "ixSci", "link": "https://stackoverflow.com/users/643393/ixsci"}, "edited": false, "score": 0, "creation_date": 1536159848, "post_id": 52187283, "comment_id": 91326338, "body": "Their is no best practice. They all are different for different lib kinds and teams. To my taste the gtest practice is awful and for in-house libs, which are tightly related to the project, the submodules approach works best."}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 7266357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O-axeJvU9Z4/AAAAAAAAAAI/AAAAAAAADNw/bwo_pQXfzK4/photo.jpg?sz=128", "display_name": "Gergely Nyiri", "link": "https://stackoverflow.com/users/7266357/gergely-nyiri"}, "is_accepted": true, "score": 1, "last_activity_date": 1536168998, "creation_date": 1536168998, "answer_id": 52190675, "question_id": 52187283, "link": "https://stackoverflow.com/questions/52187283/best-practice-to-include-c-libraries-on-my-project/52190675#52190675", "title": "Best practice to include C++ libraries on my project", "body": "<p>The best option would be a kind of mixed version. I usually track the external libraries as git submodules (in PROJECT_ROOT/submodules) and create a generic CMake file for all of them like this:</p>\n\n<pre><code>find_package(GTest)\n\nif(GTEST_FOUND)\n  message(STATUS \"googletest was found!\")\nelse()\n  message(STATUS \"googletest was not found, local build is needed!\")\n\n  include(ExternalProject)\n\n  ExternalProject_Add(googletest-project\n    URL ${CMAKE_SOURCE_DIR}/submodules/googletest/\n    PREFIX \"${CMAKE_CURRENT_BINARY_DIR}/ext/googletest\"\n    CMAKE_ARGS -DCMAKE_BUILD_TYPE:STRING=Release -DBUILD_GTEST=ON \n      DCMAKE_INSTALL_PREFIX=&lt;INSTALL_DIR&gt;\n    LOG_DOWNLOAD ON\n    LOG_CONFIGURE ON\n    LOG_BUILD ON\n    LOG_INSTALL ON\n  )\n\n  ExternalProject_Get_Property(googletest-project install_dir)\n  ExternalProject_Get_Property(googletest-project source_dir)\n\n  file(MAKE_DIRECTORY ${install_dir}/include)\n\n  add_library(gtest STATIC IMPORTED)\n  add_library(gtest_main STATIC IMPORTED)\n\n  set_property(TARGET gtest PROPERTY IMPORTED_LOCATION \n    ${install_dir}/lib/libgtest.a)\n  set_property(TARGET gtest_main PROPERTY IMPORTED_LOCATION \n    ${install_dir}/lib/libgtest_main.a)\n\n  set_property(TARGET gtest APPEND PROPERTY INTERFACE_INCLUDE_DIRECTORIES \n    ${install_dir}/include)\n  set_property(TARGET gtest_main APPEND PROPERTY INTERFACE_INCLUDE_DIRECTORIES \n    ${install_dir}/include)\n\n  add_dependencies(gtest googletest-project)\n  add_dependencies(gtest_main googletest-project)\n\n  set(GTEST_LIBRARIES gtest)\n  set(GTEST_MAIN_LIBRARIES gtest_main)\n\n  set(GTEST_INCLUDE_DIRS ${install_dir}/include)\nendif()\n</code></pre>\n\n<p>This way googletest will not be built when it is already installed on your system (e.g. in a Docker image with all the external dependencies pre-installed). As you can see, I build googletest from the submodule directory and will not clone from github. </p>\n"}], "owner": {"reputation": 366, "user_id": 2735636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/390f3dbe8ad717e3dabd332678da89dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ricard Molins", "link": "https://stackoverflow.com/users/2735636/ricard-molins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 1, "accepted_answer_id": 52190675, "answer_count": 1, "score": 1, "last_activity_date": 1536168998, "creation_date": 1536156830, "question_id": 52187283, "link": "https://stackoverflow.com/questions/52187283/best-practice-to-include-c-libraries-on-my-project", "title": "Best practice to include C++ libraries on my project", "body": "<p>I am facing some problems related to how to handle C++ projects. I have a set of repositories all of the tracked with git (hosted on gitlab).</p>\n\n<ul>\n<li><code>repo_A</code>: my current project</li>\n<li><code>repo_B</code>: a library I have created and need to use in <code>repo_A</code></li>\n</ul>\n\n<p><strong>Which is the best practice to include <code>repo_B</code> in <code>repo_A</code>?</strong>.</p>\n\n<ol>\n<li>Installing <code>repo_B</code> at system level? And then use <code>repo_B</code> from <code>repo_A</code> by using the CMakelists</li>\n<li>Adding <code>repo_B</code> as submodule on <code>repo_A</code></li>\n<li><p>Adding it in the CMakeLists by using something similar to what is explained in the <a href=\"https://github.com/google/googletest\" rel=\"nofollow noreferrer\">googletest repository</a></p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8.2)\n\nproject(googletest-download NONE)\n\ninclude(ExternalProject)\nExternalProject_Add(googletest\nGIT_REPOSITORY    https://github.com/google/googletest.git\nGIT_TAG           master\nSOURCE_DIR        \"${CMAKE_BINARY_DIR}/googletest-src\"\nBINARY_DIR        \"${CMAKE_BINARY_DIR}/googletest-build\"\nCONFIGURE_COMMAND \"\"\nBUILD_COMMAND     \"\"\nINSTALL_COMMAND   \"\"\nTEST_COMMAND      \"\"\n)\n</code></pre></li>\n</ol>\n\n<p>We are were originillay intalling libraries at user level. However, after starting to use Jenkins we are facing some problems.</p>\n"}, {"tags": ["c++", "matlab", "c++11", "simulink"], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 1076211, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bc0a2e04f43cd2c0151b657f701028b0?s=128&d=identicon&r=PG", "display_name": "dunadar", "link": "https://stackoverflow.com/users/1076211/dunadar"}, "edited": false, "score": 0, "creation_date": 1536157882, "post_id": 52187143, "comment_id": 91324932, "body": "Thanks! That worked, but only in combination with an additional protection against concurrent access. Will write it down in my question. I feel a bit dumb right now... probably need to take some rest."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1536156383, "creation_date": 1536156383, "answer_id": 52187143, "question_id": 52186889, "link": "https://stackoverflow.com/questions/52186889/simulink-access-violation-writing-to-pwork-variable-in-capture-list-of-c-lam/52187143#52187143", "title": "Simulink &quot;Access Violation&quot; writing to PWork variable in capture list of C++ lambda function", "body": "<p>You are capturing <code>copy_buffer_ptr</code> (a stack-local variable) by reference. That reference will be dangling as soon as <code>mdlStart</code> returns, after which invoking the lambda is undefined behavior. (This also applies to <code>assembler</code>).</p>\n\n<p>The fix is to simply capture <code>copy_buffer_ptr</code> and <code>assembler</code> by value (they are simple pointers, you can just copy them without issue):</p>\n\n<pre><code>server-&gt;attachDataHandler([copy_buffer_ptr, assembler](const ThreadedDataServer::buffer_t &amp; buffer, size_t num_bytes)\n{\n  /* etc. */\n});\n</code></pre>\n\n<p>If you have a lambda that will outlive the current scope, think long and hard before capturing anything by reference - if it's stack-local, you're probably about to get burnt.</p>\n"}, {"tags": [], "owner": {"reputation": 1609, "user_id": 1076211, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bc0a2e04f43cd2c0151b657f701028b0?s=128&d=identicon&r=PG", "display_name": "dunadar", "link": "https://stackoverflow.com/users/1076211/dunadar"}, "is_accepted": false, "score": 0, "last_activity_date": 1536158547, "creation_date": 1536158547, "answer_id": 52187893, "question_id": 52186889, "link": "https://stackoverflow.com/questions/52186889/simulink-access-violation-writing-to-pwork-variable-in-capture-list-of-c-lam/52187893#52187893", "title": "Simulink &quot;Access Violation&quot; writing to PWork variable in capture list of C++ lambda function", "body": "<p>Thanks to @max-langhof answer (dangling pointer) and some additional work, I finally reached a solution:</p>\n\n<pre><code>static void mdlStart(SimStruct *S)\n{\n    ssGetPWork(S)[0] = (void *) new ThreadedDataServer();\n    ssGetPWork(S)[1] = (void *) new DatagramAssembler();\n    ssGetPWork(S)[2] = (void *) new MyBufferType(); // actually an std::array&lt;char, LARGENUMBER&gt;\n    ssGetPWork(S)[3] = (void *) new std::mutex();\n\n    auto server          = (ThreadedDataServer *) ssGetPWork(S)[0];\n    auto assembler       = (DatagramAssembler*)   ssGetPWork(S)[1];\n    auto copy_buffer_ptr = (MyBufferType *)       ssGetPWork(S)[2];\n    auto assembly_mutex  = (std::mutex *)         ssGetPWork(S)[3];\n\n    server-&gt;attachDataHandler([copy_buffer_ptr, assembler, assembly_mtx](const ThreadedDataServer::buffer_t &amp; buffer, size_t num_bytes)\n    {\n        // Mutex scoped lock\n        {\n            std::lock_guard&lt;std::mutex&gt; lckg(assembly_mutex);\n            std::copy(buffer.begin(), buffer.begin() + num_bytes, copy_buffer_ptr.data());\n            assembler.feedData(copy_buffer_ptr, num_bytes);\n        }\n    });\n</code></pre>\n\n<p>This implementation solves two problems:</p>\n\n<ul>\n<li>Variables in capture list were reference to pointer-in-the-stack, which ended as dangling pointers and caused a crash.</li>\n<li>Several calls to data handler were accessing the buffer and the Assembler object concurrently, apparently causing a different Access Violation.</li>\n</ul>\n\n<p>It's working now :-)</p>\n"}], "owner": {"reputation": 1609, "user_id": 1076211, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bc0a2e04f43cd2c0151b657f701028b0?s=128&d=identicon&r=PG", "display_name": "dunadar", "link": "https://stackoverflow.com/users/1076211/dunadar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536158547, "creation_date": 1536155662, "question_id": 52186889, "link": "https://stackoverflow.com/questions/52186889/simulink-access-violation-writing-to-pwork-variable-in-capture-list-of-c-lam", "title": "Simulink &quot;Access Violation&quot; writing to PWork variable in capture list of C++ lambda function", "body": "<p>I have a C++ S-Function that handles a set of threaded operations through std::thread, std::async and callbacks.\nThe thing is that one of the callbacks is an S-function that has a buffer in the capture list. This buffer is in the PWork of the Simulink model. However, it seems that Matlab crashes as soon as I try to write to it.</p>\n\n<p>Below is a minimal crashing example of my S-Function (only the mdlStart function), which contains the relevant code:</p>\n\n<pre><code>static void mdlStart(SimStruct *S)\n{\n    ssGetPWork(S)[0] = (void *) new ThreadedDataServer();\n    ssGetPWork(S)[1] = (void *) new DatagramAssembler();\n    ssGetPWork(S)[2] = (void *) new MyBufferType(); // actually an std::array&lt;char, LARGENUMBER&gt;\n\n    auto server          = (ThreadedDataServer *) ssGetPWork(S)[0];\n    auto assembler       = (DatagramAssembler*)   ssGetPWork(S)[1];\n    auto copy_buffer_ptr = (MyBufferType *)       ssGetPWork(S)[2];\n\n    server-&gt;attachDataHandler([&amp;copy_buffer_ptr, &amp;assembler](const ThreadedDataServer::buffer_t &amp; buffer, size_t num_bytes)\n    {\n        /* Minimal crashing action */\n        copy_buffer_ptr-&gt;at(5) = 'b'; // Any index != 0\n        /* Original code */\n        //std::copy(buffer.begin(), buffer.begin() + num_bytes, copy_buffer_ptr-&gt;data());\n        //assembler-&gt;feedData(*copy_buffer_ptr, num_bytes);\n    });\n}\n</code></pre>\n\n<p>The handler is invoked from the data server worker thread (different from Simulink main thread). Other actions inside the callback function work smoothly (reading parameters, doing other operations...).</p>\n\n<p>Any hint why this happens? The same code was working in an independent executeble before integrating it in Simulink.</p>\n"}, {"tags": ["c++", "vector", "language-lawyer", "c++17"], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1536156981, "post_id": 52187099, "comment_id": 91324346, "body": "Only if they would have called it <code>std::initializer_list_view</code>, then it would have been intuitively obvious."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1536157447, "post_id": 52187099, "comment_id": 91324631, "body": "Thanks Vittorio. Oddly no warnings from my code with gcc8.2, even with -Wextra -pedantic <a href=\"https://godbolt.org/z/dU2xXZ\" rel=\"nofollow noreferrer\">godbolt.org/z/dU2xXZ</a>"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 6, "last_activity_date": 1536156274, "creation_date": 1536156274, "answer_id": 52187099, "question_id": 52186866, "link": "https://stackoverflow.com/questions/52186866/constructing-a-stdinitializer-list-of-dynamic-size-part-ii/52187099#52187099", "title": "Constructing a std::initializer_list of dynamic size, part II", "body": "<p>The following code produces a warning on <em>gcc (trunk)</em>:</p>\n\n<pre><code>auto foo()\n{\n    return std::initializer_list&lt;int&gt;{0, 1, 2};\n}\n</code></pre>\n\n<blockquote>\n<pre><code>warning: returning temporary initializer_list does not extend the lifetime of the\n         underlying array [-Winit-list-lifetime]\n\n     return std::initializer_list&lt;int&gt;{0, 1, 2};\n                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n</blockquote>\n\n<p><a href=\"https://gcc.godbolt.org/z/nIIqEX\" rel=\"noreferrer\"><strong>live example on wandbox.org</strong></a></p>\n\n<hr>\n\n<p>This happens because <code>std::initializer_list</code> very roughly behaves like a pair of pointers to an array created on the stack. The lifetime of the array is not tied to the lifetime of the <code>std::initializer_list</code> instance.</p>\n\n<p>Your <code>as_init_list</code> function has the same issue. Marking <code>ret</code> as <code>static</code> works around the issue: <a href=\"http://coliru.stacked-crooked.com/a/e0ef17af8b398fb7\" rel=\"noreferrer\">http://coliru.stacked-crooked.com/a/e0ef17af8b398fb7</a></p>\n"}, {"comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1536157185, "post_id": 52187296, "comment_id": 91324467, "body": "Great. Thanks for the quote from the standard."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 5, "last_activity_date": 1536157280, "last_edit_date": 1536157280, "creation_date": 1536156867, "answer_id": 52187296, "question_id": 52186866, "link": "https://stackoverflow.com/questions/52186866/constructing-a-stdinitializer-list-of-dynamic-size-part-ii/52187296#52187296", "title": "Constructing a std::initializer_list of dynamic size, part II", "body": "<p>In</p>\n\n<pre><code>auto as_init_list(std::vector&lt;T&gt; const&amp; v, std::index_sequence&lt;Is...&gt;)\n{\n    auto ret = std::initializer_list&lt;T&gt;\n    {\n        v[Is]...\n    };\n    return ret;\n}\n</code></pre>\n\n<p>The array you build with <code>{ v[Is]... }</code> is a temporary object and and has it's lifetime bound to <code>ret</code>.  Once <code>ret</code> goes out of scope the array is destroyed and you are left with a dangling <code>std::initializer_list</code>.  This is covered under <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init.list#6\" rel=\"nofollow noreferrer\">[dcl.init.list]/6</a>:</p>\n\n<blockquote>\n  <p>The array has the same lifetime as any other temporary object ([class.temporary]), except that initializing an <code>initializer_\u00adlist</code> object from the array extends the lifetime of the array exactly like binding a reference to a temporary. [\u2009Example:</p>\n\n<pre><code>typedef std::complex&lt;double&gt; cmplx;\nstd::vector&lt;cmplx&gt; v1 = { 1, 2, 3 };\n\nvoid f() {\n  std::vector&lt;cmplx&gt; v2{ 1, 2, 3 };\n  std::initializer_list&lt;int&gt; i3 = { 1, 2, 3 };\n}\n\nstruct A {\n  std::initializer_list&lt;int&gt; i4;\n  A() : i4{ 1, 2, 3 } {}            // ill-formed, would create a dangling reference\n};\n</code></pre>\n  \n  <p>For <code>v1</code> and <code>v2</code>, the initializer_\u00adlist object is a parameter in a function call, so the array created for <code>{ 1, 2, 3 }</code> has full-expression lifetime. <strong>For <code>i3</code>, the <code>initializer_\u00adlist</code> object is a variable, so the array persists for the lifetime of the variable</strong>. For <code>i4</code>, the <code>initializer_\u00adlist</code> object is initialized in the constructor's <em>ctor-initializer</em> as if by binding a temporary array to a reference member, so the program is ill-formed ([class.base.init]). \u2014\u2009end example\u2009] [\u2009Note: The implementation is free to allocate the array in read-only memory if an explicit array with the same initializer could be so allocated. \u2014\u2009end note\u2009]</p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<p>You would have to extend <code>ret</code>'s lifetime to the point where you use it in order to not have undefined behavior.</p>\n"}], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 1, "accepted_answer_id": 52187296, "answer_count": 2, "score": 3, "last_activity_date": 1536157542, "creation_date": 1536155624, "last_edit_date": 1536157542, "question_id": 52186866, "link": "https://stackoverflow.com/questions/52186866/constructing-a-stdinitializer-list-of-dynamic-size-part-ii", "title": "Constructing a std::initializer_list of dynamic size, part II", "body": "<p>Inspired by <a href=\"https://stackoverflow.com/questions/52183608/is-it-possible-to-programmatically-construct-a-stdinitializer-list\">this question</a> I started wondering if there was a way to create an <code>std::initializer_list</code> from a <code>std::vector</code>.</p>\n\n<p>Given that c++17 guarantees RVO, it seemed to me that it might be possible by building a compile-time dispatch table of initialisation functions.</p>\n\n<p>Here's the first attempt at the code to do it:</p>\n\n<pre><code>#include &lt;initializer_list&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;array&gt;\n#include &lt;stdexcept&gt;\n\nnamespace impl\n{\n    template&lt;class T, std::size_t...Is&gt;\n    auto as_init_list(std::vector&lt;T&gt; const&amp; v, std::index_sequence&lt;Is...&gt;)\n    {\n        auto ret = std::initializer_list&lt;T&gt;\n        {\n            v[Is]...\n        };\n        return ret;\n    }\n\n    template&lt;class T, std::size_t N&gt;\n    auto as_init_list(std::vector&lt;T&gt; const&amp; v)\n    {\n        auto ret = as_init_list(v, std::make_index_sequence&lt;N&gt;());\n        return ret;\n    }\n\n    template&lt;class T, std::size_t...Is&gt;\n    constexpr auto as_init_list_vtable(std::index_sequence&lt;Is...&gt;)\n    {\n        using ftype = std::initializer_list&lt;T&gt;(*)(std::vector&lt;T&gt; const&amp;);\n        auto ret = std::array&lt;ftype, sizeof...(Is)&gt;\n        {{\n            &amp;as_init_list&lt;T, Is&gt;...\n        }};\n        return ret;\n    }\n\n    template&lt;class T, std::size_t N&gt;\n    constexpr auto as_init_list_vtable()\n    {\n        auto ret = as_init_list_vtable&lt;T&gt;(std::make_index_sequence&lt;N&gt;());\n        return ret;\n    }\n}\n\ntemplate&lt;class T, std::size_t Limit = 100&gt;\nauto as_init_list(std::vector&lt;T&gt; const&amp; vec)\n-&gt; std::initializer_list&lt;T&gt;\n{\n    if (vec.size() &gt;= Limit)\n        throw std::invalid_argument(\"too long\");\n    static const auto table = impl::as_init_list_vtable&lt;T, Limit&gt;();\n    auto ret = table[vec.size()](vec);\n    return ret;\n}\n\nint main()\n{\n    std::vector&lt;int&gt; v = { 1, 2, 3, 4 };\n    auto i = as_init_list(v);\n    for (auto&amp;&amp; x : i)\n    {\n        std::cout &lt;&lt; x &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p>Of course, as half-expected, the output appears to be UB:</p>\n\n<pre><code>4200240\n32765\n0\n0\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/1bf92111619317dd\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/1bf92111619317dd</a></p>\n\n<p>In this (admittedly unusual and perverse case) I seem to have transgressed some rule around the lifetime of the elements of the items in the initializer_list, but at first glance it seems to me that the code should be valid (because of guaranteed RVO).</p>\n\n<p>Am I right or wrong? Does the standard cover this scenario?</p>\n"}, {"tags": ["python", "c++", "cntk", "softmax"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 8132335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92919cc6a14b0cbec3f00203107e4f34?s=128&d=identicon&r=PG&f=1", "display_name": "ueezb", "link": "https://stackoverflow.com/users/8132335/ueezb"}, "is_accepted": false, "score": 0, "last_activity_date": 1536166468, "creation_date": 1536166468, "answer_id": 52190099, "question_id": 52186821, "link": "https://stackoverflow.com/questions/52186821/cntk-how-to-get-the-class-probabilities-in-the-c-api/52190099#52190099", "title": "CNTK: How to get the Class-Probabilities in the C++-API?", "body": "<p>Ok I solved the problem myself. It worked when I passed the model to the softmax-function BEFORE training and trained the network with the returned model of the softmax.</p>\n"}], "owner": {"reputation": 43, "user_id": 8132335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92919cc6a14b0cbec3f00203107e4f34?s=128&d=identicon&r=PG&f=1", "display_name": "ueezb", "link": "https://stackoverflow.com/users/8132335/ueezb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536166468, "creation_date": 1536155481, "question_id": 52186821, "link": "https://stackoverflow.com/questions/52186821/cntk-how-to-get-the-class-probabilities-in-the-c-api", "title": "CNTK: How to get the Class-Probabilities in the C++-API?", "body": "<p>I want to get the class-specific probabilities (where the sum of all probabilities equals to 1) from a trained cnn in cntk. In Python this works as expected by applying a softmax-function:</p>\n\n<pre><code>import cntk as C\nfrom skimage import io\n\nmodel_path = \"...\"\nimage_path = \"...\"\nimage = io.imread(image_path)\nmodel = C.load_model(model_path)\nsm_classifier = C.softmax(model)\nclass_prob = sm_classifier.eval({model.arguments[0]: [image]})\n</code></pre>\n\n<p>Here, class_prob is a 2-dimensional numpy-array which holds values that seem to be the desired class-probabilities.</p>\n\n<p>In C++ I have the following code:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;float&gt;&gt; CnnClassifier::evaluateNet(std::vector&lt;float&gt; flattenedImage)\n{\n    CNTK::FunctionPtr classifier = CNTK::Softmax(m_cnn); // m_cnn is of type CNTK::FunctionPtr\n\n    // Get input variable. The model has only one single input.\n    CNTK::Variable inputVar = m_cnn-&gt;Arguments()[0];\n\n    // The model has only one output.\n    // If the model has more than one output, use modelFunc-&gt;Outputs to get the list of output variables.\n    CNTK::Variable outputVar = m_cnn-&gt;Output();\n\n    CNTK::ValuePtr inputVal = CNTK::Value::CreateBatch(inputVar.Shape(), flattenedImage, m_device);\n\n    std::unordered_map&lt;CNTK::Variable, CNTK::ValuePtr&gt; inputDataMap = { { inputVar, inputVal } };\n    std::unordered_map&lt;CNTK::Variable, CNTK::ValuePtr&gt; outputDataMap = { { outputVar, nullptr } };\n\n    classifier-&gt;Evaluate(inputDataMap, outputDataMap, m_device);\n\n    CNTK::ValuePtr outputVal = outputDataMap[outputVar];\n    std::vector&lt;std::vector&lt;float&gt;&gt; outputData;\n    outputVal-&gt;CopyVariableValueTo(outputVar, outputData);\n\n    return outputData;\n}\n</code></pre>\n\n<p>In outputData, there are no values per class which add up to 1. The values it holds can be very high (up to 15 in my examples) and also can benegative. I believe these are \"raw\" output values from the last fully-connected-layer. How can I apply the softmax-function to them?</p>\n\n<p>Thanks in advance and best regards</p>\n"}, {"tags": ["c++", "queue"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1536155086, "post_id": 52186676, "comment_id": 91323055, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536155608, "post_id": 52186676, "comment_id": 91323419, "body": "In addition to stepping through the code, line by line, you can examine the value of your variables, which will be useful, as this sounds like a pointer problem. Btw, if you use Linux, then the DDD debugger might be of use for this particular problem. Just take a look at <a href=\"https://www.gnu.org/software/ddd/all.png\" rel=\"nofollow noreferrer\">this picture</a> !"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1536156363, "post_id": 52186676, "comment_id": 91323942, "body": "Review Issues:   front() returns char? (instead return int)    &quot;char str[20];&quot;?  (instead use &quot;string str&quot;) for loop in main uses int? (instead use uint)"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1536156717, "post_id": 52186676, "comment_id": 91324175, "body": "Another review issue: Use proper indentation and don&#39;t add an empty line after your control statements. The formatting around <code>if (front_ == -1)</code> is extremely misleading. Also, the problem with <code>front()</code> is not that it returns <code>char</code>, it&#39;s that it doesn&#39;t read from <code>data_</code>. That will probably get you started."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1536160402, "post_id": 52186676, "comment_id": 91326681, "body": "@2785528 <i>for loop in main uses int? (instead use uint)</i> I&#39;ve read long debates whether an array index should be <i>signed</i> or <i>unsigned</i>. However, <a href=\"https://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\"><code>strlen()</code></a> returns <code>size_t</code>. Hence, if <code>int</code> is a bad candidate then <code>uint</code> (actually <code>unsigned</code>) is not much better but <code>size_t</code> might be. (I learnt this the hard way when we ported our software from 32 to 64 bit.) ;-)"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1536181412, "post_id": 52186676, "comment_id": 91336452, "body": "@Scheff - good response, thanks. I have no problems either way, I was reacting to my compiler&#39;s warning about comparing uint to int in that loop.  Because this code is marked C++, I think the var &#39;str&#39; should be std::string (and a few more related changes)."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1536211767, "post_id": 52186676, "comment_id": 91343354, "body": "@2785528 When I was developing 32 bit only I had the imagination that <code>unsigned</code> would&#39;ve machine word width (i.e. pointer size) and used it extensively. The day we switched to x64, there was a &quot;bad awakening&quot;. - I had to fix tons of warnings. However, concerning <code>std::string</code>, I fully agree."}], "owner": {"reputation": 59, "user_id": 8257206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ddd860115218913e90767637a789e5?s=128&d=identicon&r=PG&f=1", "display_name": "Ayush Mishra", "link": "https://stackoverflow.com/users/8257206/ayush-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536155598, "creation_date": 1536155060, "last_edit_date": 1536155598, "question_id": 52186676, "link": "https://stackoverflow.com/questions/52186676/printing-the-final-queue-after-performing-several-operations-on-it", "title": "Printing the final queue after performing several operations on it", "body": "<p>I am learning c++ and while executing the following code i am getting the garbage value.I checked the algorithm part and it seems to be correct but if wrong please tell me.I have used the functions like add to add or insert element ,del function to delete,empty function to empty the queue and finally i have function front whose work is to return the front value.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string.h&gt;\nusing namespace std;\n\nclass Queue {\n    private :\n\n        vector&lt;char&gt; data_;\n\n        int front_, rear_;\n    public :\n    Queue(): front_(-1),rear_(-1) { data_.resize(20); }\n\n        ~Queue() {};\n\n        int empty() {\n\n            if (front_==rear_) {\n\n                front_ = rear_ = -1 ;\n                return 1;\n            }\n            else\n                return 0;\n        }\n        void add(char x) {\n\n            if (front_ == -1)\n\n                front_ = 0 ;\n                rear_=rear_+1;\n                data_[rear_]=x;\n\n        }\n        void del( ) {front_=front_+1;}\n\n\n        char front() { return front_ ; }\n\n} ; // End of the class\nint main( ) {\n    Queue q;\n    char str[20];\n\n    cin &gt;&gt; str;\n    for (int i = 0; i &lt; strlen(str); ++i)\n\n        q.add(str[i]);\n\n    while (!q.empty()) {\n\n        cout &lt;&lt; q.front();\n\n        q.del();\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "compilation"], "comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1536154798, "post_id": 52186537, "comment_id": 91322849, "body": "You don&#39;t use include guards or #pragma once in your header files?"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1536164893, "post_id": 52186537, "comment_id": 91329188, "body": "@&#214;&#246;Tiib I do, but this example shall remain short."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 1, "last_activity_date": 1536154841, "creation_date": 1536154841, "answer_id": 52186615, "question_id": 52186537, "link": "https://stackoverflow.com/questions/52186537/selective-compilation-of-template/52186615#52186615", "title": "selective compilation of template", "body": "<p>You can use <code>extern template</code> to prevent a particular instantiation of a template in a given TU. </p>\n\n<pre><code>// src0.cpp\n\ntemplate class foo&lt;int&gt;;\n    // Oblige instantiation of `foo&lt;int&gt;` in this TU\n</code></pre>\n\n<p></p>\n\n<pre><code>// src1.cpp\n\nextern template class foo&lt;int&gt;;\n    // Prevent instantiation of `foo&lt;int&gt;` in this TU\n</code></pre>\n\n<p>As long as <code>src0</code> and <code>src1</code> are linked together, your program will work.</p>\n"}], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52186615, "answer_count": 1, "score": 0, "last_activity_date": 1536154841, "creation_date": 1536154656, "question_id": 52186537, "link": "https://stackoverflow.com/questions/52186537/selective-compilation-of-template", "title": "selective compilation of template", "body": "<p>Is there a way to pre-compile some template instantinations (of a class template) but not all, so that the remaining are compiled when instantinated (w/o errors at linking)?</p>\n\n<p>To demonstrate the issue, consider this example:</p>\n\n<pre><code>// file.h\ntemplate&lt;typename T&gt; class object { /* lots of code */ };\n\n// file.inc\ntemplate&lt;typename T&gt;\nobject::object(const T*data) { /* ... */ }\n    // and more: definitions of all non-inline functionality of class object&lt;&gt;\n\n// file.cc to be compiled and linked\n#include \"file.h\"\n#include \"file.inc\" \n\ntemplate struct&lt;int&gt;;\ntemplate struct&lt;double&gt;;\n\n// user.cc\n#include \"user.h\"\n#include \"file.h\"\n\nobject&lt;double&gt; x{0.4}                              // okay: uses pre-compiled code\nobject&lt;user_defined&gt; z(user_defined{\"file.dat\"});  // error: fails at linking\n</code></pre>\n\n<p>If instead the user <code>#include</code>s <code>\"file.inc\"</code></p>\n\n<pre><code>// user.cc\n#include \"user.h\"\n#include \"file.h\"\n#include \"file.inc\"\n\nobject&lt;double&gt;  x{0.4}                            // error: duplicate code \nobject&lt;user_defined&gt; z(user_defined{\"file.dat\"}); // okay\n</code></pre>\n\n<p>the compiler will find another compiled version due to the pre-compiled code from <code>file.cc</code>.</p>\n\n<p>So how can I avoid both of these problems? I reckon a related question would be \"how can I specify that a pre-compiled header fully compiles a template for certain template parameters (only)?\"</p>\n"}, {"tags": ["c++", "c", "qt", "ffmpeg", "h.264"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1536159377, "post_id": 52186274, "comment_id": 91326017, "body": "In what part of your example is there some Qt code that is not just print?"}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 8135119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HnvmQAoA_8Y/AAAAAAAAAAI/AAAAAAAAAEU/fDJr7wUow3o/photo.jpg?sz=128", "display_name": "niraj gandha", "link": "https://stackoverflow.com/users/8135119/niraj-gandha"}, "is_accepted": true, "score": 1, "last_activity_date": 1537351263, "creation_date": 1537351263, "answer_id": 52403223, "question_id": 52186274, "link": "https://stackoverflow.com/questions/52186274/issue-in-opening-the-8mp-h264-stream-from-tcp-server/52403223#52403223", "title": "Issue in opening the 8MP H264 Stream from tcp server", "body": "<p>I got the answer for my above asked question. Code for the issue and getting rgb frames from raw H.264 Frame for 8MP resolution is as follows:</p>\n\n<pre><code>avcodec_register_all();\nav_register_all();\navformat_network_init();\n\nAVDictionary *options = NULL;\nAVFormatContext *refrenceFormatCtx = NULL;\nAVInputFormat *fmts = av_find_input_format(\"h264\");\nchar errorsdef[100];\nAVCodecContext* codec_ctx = NULL;\nint video_stream_index = 0;    \nSwsContext *img_convert_ctx = NULL;\nAVFrame* picture_yuv = NULL;\nAVFrame* picture_rgb = NULL;\nuint8_t* picture_buffer_rgb;\nuint8_t *rgb_image_data;\nint sizeofrgbpicture = 0;\nint initialize_rgb_requirements=1;\npicture_yuv = av_frame_alloc();\n\nav_dict_set(&amp;options, \"flags\", \"bicubic\", 0);\nav_opt_set(refrenceFormatCtx,\"f\",\"h264\", AV_OPT_SEARCH_CHILDREN);\nav_opt_set(refrenceFormatCtx,\"codec:v\",\"h264\",AV_OPT_SEARCH_CHILDREN);\nav_opt_set(refrenceFormatCtx,\"probesize\",\"32M\", AV_OPT_SEARCH_CHILDREN);\n\n// Open video file\nint err = avformat_open_input(&amp;refrenceFormatCtx,\"tcp://192.168.42.129:2226\", fmts, &amp;options);\nif (!options) {\n    int dict_count = av_dict_count(options);\n    qDebug() &lt;&lt; \"dict_count \" &lt;&lt; dict_count;\n}\nav_strerror(err,errorsdef,100);\nqDebug() &lt;&lt; \"OPening Stream error: \"&lt;&lt; err &lt;&lt; \" \"&lt;&lt; errorsdef;\nif (refrenceFormatCtx!=NULL){\n    err = avformat_find_stream_info(refrenceFormatCtx, &amp;options);\n    if( err&lt; 0){\n        av_strerror(err,errorsdef,100);\n        qDebug() &lt;&lt; \"Not able to find stream: \"&lt;&lt; err &lt;&lt; \" \"&lt;&lt; errorsdef;\n    }\n}else{\n    qDebug() &lt;&lt; \"referencecontext null\";\n    exit(1);\n}\n//search video stream\nfor (int i = 0; i &lt; (int)refrenceFormatCtx-&gt;nb_streams; i++) {\n    AVStream* s = refrenceFormatCtx-&gt;streams[i];\n    if (s-&gt;codec == NULL){\n        continue;\n    }\n    codec_ctx = (s-&gt;codec);\n    if (codec_ctx-&gt;codec_type == AVMEDIA_TYPE_VIDEO){\n        video_stream_index = i;\n    }\n}\nAVPacket packet;\nav_init_packet(&amp;packet);\n\n//open output file\nAVFormatContext* output_ctx = avformat_alloc_context();\nAVStream* stream = NULL;\n\n//start reading packets from stream and emit data pointer to slot\nav_read_play(refrenceFormatCtx);    //play RTSP\navcodec_copy_context(codec_ctx, refrenceFormatCtx-&gt;streams[video_stream_index]-&gt;codec);\n\nif (avcodec_open2(codec_ctx, avcodec_find_decoder(AV_CODEC_ID_H264), NULL) &lt; 0){\n    qDebug() &lt;&lt; \"avcodec_open2 null\";\n}\nwhile (av_read_frame(refrenceFormatCtx, &amp;packet) &gt;= 0) {\n    if (packet.stream_index == video_stream_index) {    //packet is video\n        if (stream == NULL) {    //create stream in file\n            stream = avformat_new_stream(output_ctx, refrenceFormatCtx-&gt;streams[video_stream_index]-&gt;codec-&gt;codec);\n            avcodec_copy_context(stream-&gt;codec, refrenceFormatCtx-&gt;streams[video_stream_index]-&gt;codec);\n            stream-&gt;sample_aspect_ratio = refrenceFormatCtx-&gt;streams[video_stream_index]-&gt;codec-&gt;sample_aspect_ratio;\n        }\n        int check = 0;\n        packet.stream_index = stream-&gt;id;\n        int result = avcodec_decode_video2(codec_ctx, picture_yuv, &amp;check, &amp;packet);\n        av_free_packet(&amp;packet);\n        av_packet_unref(&amp;packet);\n        if(result &lt;= 0 || check == 0){\n            continue;\n        }\n        if(initialize_rgb_requirements)\n        {\n            sizeofrgbpicture = avpicture_get_size(AV_PIX_FMT_RGB24, codec_ctx-&gt;width, codec_ctx-&gt;height);\n            picture_rgb = av_frame_alloc();\n            picture_buffer_rgb = (uint8_t*) (av_malloc(sizeofrgbpicture));\n            avpicture_fill((AVPicture *) picture_rgb, picture_buffer_rgb, AV_PIX_FMT_RGB24, codec_ctx-&gt;width, codec_ctx-&gt;height);\n            img_convert_ctx = sws_getContext(codec_ctx-&gt;width, codec_ctx-&gt;height, AV_PIX_FMT_YUV420P, codec_ctx-&gt;width, codec_ctx-&gt;height, AV_PIX_FMT_RGB24, SWS_BICUBIC, NULL, NULL, NULL);\n            initialize_rgb_requirements=0;\n        }\n        int height = 0;\n        if(picture_yuv-&gt;data != NULL)\n        {\n            height = sws_scale(img_convert_ctx, ((AVPicture*)picture_yuv)-&gt;data, ((AVPicture*)picture_yuv)-&gt;linesize, 0, codec_ctx-&gt;height, ((AVPicture*)picture_rgb)-&gt;data,((AVPicture*)picture_rgb)-&gt;linesize);\n        }\n        rgb_image_data = (uint8_t *)malloc(sizeofrgbpicture * sizeof(uint8_t));\n        int ret = avpicture_layout((AVPicture *)picture_rgb, AV_PIX_FMT_RGB24, codec_ctx-&gt;width, codec_ctx-&gt;height, rgb_image_data, sizeofrgbpicture);\n        emit imageQueued(rgb_image_data, codec_ctx-&gt;width,codec_ctx-&gt;height);\n    }\n    msleep(1);\n}\nav_freep(picture_buffer_rgb);\nav_frame_free(&amp;picture_rgb);\navio_close(output_ctx-&gt;pb);\navformat_free_context(output_ctx);\navformat_close_input(&amp;refrenceFormatCtx);\n</code></pre>\n\n<p>I came to know that for raw H.264 stream we have to tell ffmpeg that the format is h264.  For that I have used <code>AVInputFormat</code>, to set other options like video codec and probesize, I have used <code>av_op_set()</code>. To set the default flags in ffmpeg, I have used <code>av_dict_set()</code>. I have emitted the data pointer to my required slot. If any one wants to create a file from it, then it can generate .ppm file by writing this pointer into file.</p>\n"}], "owner": {"reputation": 84, "user_id": 8135119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HnvmQAoA_8Y/AAAAAAAAAAI/AAAAAAAAAEU/fDJr7wUow3o/photo.jpg?sz=128", "display_name": "niraj gandha", "link": "https://stackoverflow.com/users/8135119/niraj-gandha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 52403223, "answer_count": 1, "score": 0, "last_activity_date": 1537351263, "creation_date": 1536153868, "last_edit_date": 1536212937, "question_id": 52186274, "link": "https://stackoverflow.com/questions/52186274/issue-in-opening-the-8mp-h264-stream-from-tcp-server", "title": "Issue in opening the 8MP H264 Stream from tcp server", "body": "<p>I am facing issue in opening the raw h264 stream of 8MP resolution over tcp server from Android in Qt Application. To open the stream in ffplay, I give following command in terminal and it is able to play it</p>\n\n<pre><code>ffplay -f h264 -codec:v h264 -probesize 32M &lt;tcp://ipaddress:port&gt;\n</code></pre>\n\n<p>But when I try to open the stream in Qt Application, <strong>avformat_open_input()</strong> gives error <strong>Invalid data found while processing input</strong>.\nBelow is the code I am using in Qt Application:</p>\n\n<pre><code> av_register_all();\n avcodec_register_all();\n avformat_network_init();\n AVFormatContext *refrenceFormatCtx = NULL;\n SwsContext *img_convert_ctx;\n AVIOContext *avio_ctx = NULL;\n int video_stream_index = 0;\n AVCodecContext* codec_ctx = NULL;\n AVSampleFormat *fmt = NULL;\n char errorsdef[100];\n AVDictionary *options = NULL;\n av_dict_set(&amp;options, \"video_size\",\"3264x2448\",0);\n av_dict_set(&amp;options,\"pixel_format\",\"yuv420p\",0);\n av_dict_set(&amp;options, \"f\", \"h264\", 0);\n av_dict_set(&amp;options, \"codec:v\", \"h264\", 0);\n av_dict_set(&amp;options, \"codec:a\", \"aac\", 0);\n av_dict_set(&amp;options, \"probesize\", \"32M\", 0);\n\n  int err = avformat_open_input(&amp;refrenceFormatCtx,\"tcp://192.168.42.129:2226\", NULL, &amp;options);\n  av_strerror(err,errorsdef,100);\n  qDebug() &lt;&lt; \"OPening Stream error: \"&lt;&lt; err &lt;&lt; \" \"&lt;&lt; errorsdef;\n  if(err&lt;0)\n      abort();\n  av_dict_free(&amp;options);\n</code></pre>\n\n<p>Is the path to set the options in avformat_open_input is correct? Are parameters set by me are correct?</p>\n"}, {"tags": ["c++", "unreal-engine4", "unreal-development-kit", "unreal-umg"], "comments": [{"owner": {"reputation": 3555, "user_id": 1713208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vbQQH.jpg?s=128&g=1", "display_name": "JSmith", "link": "https://stackoverflow.com/users/1713208/jsmith"}, "edited": false, "score": 1, "creation_date": 1536154575, "post_id": 52186172, "comment_id": 91322685, "body": "can you add the code directly in the post please, I mean written not as an image . Thx"}, {"owner": {"reputation": 11, "user_id": 10320347, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yqWZdVXSySI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPjoZD4rX9ysXeyfSWmE2nafWSQJA/mo/photo.jpg?sz=128", "display_name": "Ido Mtn", "link": "https://stackoverflow.com/users/10320347/ido-mtn"}, "reply_to_user": {"reputation": 3555, "user_id": 1713208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vbQQH.jpg?s=128&g=1", "display_name": "JSmith", "link": "https://stackoverflow.com/users/1713208/jsmith"}, "edited": false, "score": 1, "creation_date": 1536155288, "post_id": 52186172, "comment_id": 91323186, "body": "Of course, my bad"}, {"owner": {"reputation": 11, "user_id": 10320347, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yqWZdVXSySI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPjoZD4rX9ysXeyfSWmE2nafWSQJA/mo/photo.jpg?sz=128", "display_name": "Ido Mtn", "link": "https://stackoverflow.com/users/10320347/ido-mtn"}, "reply_to_user": {"reputation": 3555, "user_id": 1713208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vbQQH.jpg?s=128&g=1", "display_name": "JSmith", "link": "https://stackoverflow.com/users/1713208/jsmith"}, "edited": false, "score": 0, "creation_date": 1536155531, "post_id": 52186172, "comment_id": 91323372, "body": "well no apperntly not, I need 10 reputation or something like that...."}], "owner": {"reputation": 11, "user_id": 10320347, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yqWZdVXSySI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPjoZD4rX9ysXeyfSWmE2nafWSQJA/mo/photo.jpg?sz=128", "display_name": "Ido Mtn", "link": "https://stackoverflow.com/users/10320347/ido-mtn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536153561, "creation_date": 1536153561, "question_id": 52186172, "link": "https://stackoverflow.com/questions/52186172/sviewtrees-children-dosent-work-after-first-level", "title": "SViewTree&#39;s Children dosen&#39;t work after first level", "body": "<p>I created a Slate TreeView widget.\nIt works fine until I extend the first level of the tree.\nThen it dosent allow me to select any of the children (That are in the second level of the tree), And it dosent even show me the subfolders of the next level of the tree.\nIm aware that I need to tinker with the \n.OnSetExpansionRecursive and the other elements of code but even after looking at the source code of other classes I cant seem to figure it out.\nPics included to show you whats going on.</p>\n\n<p><a href=\"https://i.stack.imgur.com/keoQS.png\" rel=\"nofollow noreferrer\">Code snippet</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/DkV0q.png\" rel=\"nofollow noreferrer\">InGame View</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/KvBLy.png\" rel=\"nofollow noreferrer\">InGame View </a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 2, "creation_date": 1536153034, "post_id": 52185948, "comment_id": 91321607, "body": "Define &quot;not working&quot;? Compile error? Runtime error? Crash?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536153074, "post_id": 52185948, "comment_id": 91321637, "body": "no offense, but this code has too many mistakes. Seems like you could use a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good book</a>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1536153089, "post_id": 52185948, "comment_id": 91321643, "body": "I&#39;m guessing that you get an &quot;unknown identifier error&quot; about <code>head</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1536153169, "post_id": 52185948, "comment_id": 91321710, "body": "Don&#39;t use <code>malloc</code>, use <code>new</code>. It&#39;s never too late or too early to stop writing C in C++."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1536153209, "post_id": 52185948, "comment_id": 91321738, "body": "Move <code>node *head = NULL;</code> above your add function to fix the compile error."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1536153375, "post_id": 52185948, "comment_id": 91321857, "body": "You should not be making these kinds of very fundamental mistakes when you&#39;ve reached the point in your C++ education where you&#39;re implementing linked lists. Get <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">a good book</a>, don&#39;t skip over the things you think that you already know."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536153694, "post_id": 52186158, "comment_id": 91322098, "body": "There are <i>plenty</i> of reasons not to use <code>new</code> in a C++ program. If you need dynamic allocation, use something sensible like <code>std::make_unique</code>. In 2018 <code>new</code> should be rare (though some applications do still exist)."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1536153711, "post_id": 52186158, "comment_id": 91322112, "body": "I would upvote, if not the <i>&quot;And there really is no reason not to use <code>new</code> in a C++ program</i>&quot;. There are plenty of reasons why <b>not</b> to use <code>new</code>. Use a smart pointer, if you are going to own something"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1536153730, "post_id": 52186158, "comment_id": 91322124, "body": "@Fureeish I lol&#39;d"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536153762, "post_id": 52186158, "comment_id": 91322151, "body": "@LightnessRacesinOrbit 18 secs lol"}, {"owner": {"reputation": 96, "user_id": 5568851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98040feaf6fc8fe41f328a965311d57?s=128&d=identicon&r=PG&f=1", "display_name": "heke", "link": "https://stackoverflow.com/users/5568851/heke"}, "edited": false, "score": 0, "creation_date": 1536153780, "post_id": 52186158, "comment_id": 91322166, "body": "There is a reason not to use new in C++, actually you shouldn&#39;t use it in modern C++ which has smart pointers."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 96, "user_id": 5568851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98040feaf6fc8fe41f328a965311d57?s=128&d=identicon&r=PG&f=1", "display_name": "heke", "link": "https://stackoverflow.com/users/5568851/heke"}, "edited": false, "score": 0, "creation_date": 1536153809, "post_id": 52186158, "comment_id": 91322185, "body": "@heke slipping into third place there"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536153816, "post_id": 52186158, "comment_id": 91322194, "body": "@LightnessRacesinOrbit Well I meant as opposed to malloc, updated."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536153830, "post_id": 52186158, "comment_id": 91322207, "body": "@john: Somewhat better :P <code>malloc</code> should certainly be avoided."}, {"owner": {"reputation": 96, "user_id": 5568851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98040feaf6fc8fe41f328a965311d57?s=128&d=identicon&r=PG&f=1", "display_name": "heke", "link": "https://stackoverflow.com/users/5568851/heke"}, "edited": false, "score": 0, "creation_date": 1536154236, "post_id": 52186158, "comment_id": 91322482, "body": "@ Lightness Races in Orbit: Damn, should use the refresh button to make sure that &quot;winning&quot; is still possible :D"}, {"owner": {"reputation": 1210, "user_id": 8271180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d1c0eef0a6675a8926f8db35b9ad67?s=128&d=identicon&r=PG&f=1", "display_name": "Tomer Wolberg", "link": "https://stackoverflow.com/users/8271180/tomer-wolberg"}, "edited": false, "score": 0, "creation_date": 1536167707, "post_id": 52186158, "comment_id": 91330500, "body": "@john you shouldn&#39;t use global variable. You can put it as private static and have the function add and traverse friends"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1536153839, "last_edit_date": 1536153839, "creation_date": 1536153497, "answer_id": 52186158, "question_id": 52185948, "link": "https://stackoverflow.com/questions/52185948/creating-single-linked-list-in-c/52186158#52186158", "title": "Creating single linked list in c++", "body": "<p>This is wrong</p>\n\n<pre><code>void add(int n){\n    node *head = NULL;\n    node *temp = (node*)malloc(sizeof(node));\n    ...\n</code></pre>\n\n<p>If you are going to make a linked list in this way you need to make <code>head</code> a global variable, otherwise it gets created and destroyed each time you call <code>add</code>.</p>\n\n<pre><code>node *head = NULL;\n\nvoid add(int n){\n    node *temp = (node*)malloc(sizeof(node));\n    ...\n</code></pre>\n\n<p>And there's really no reason not to use <code>new</code> in preference to <code>malloc</code> in a C++ program</p>\n\n<pre><code>    node *temp = new node;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1536153738, "creation_date": 1536153738, "answer_id": 52186229, "question_id": 52185948, "link": "https://stackoverflow.com/questions/52185948/creating-single-linked-list-in-c/52186229#52186229", "title": "Creating single linked list in c++", "body": "<ol>\n<li>Your program leaks all the dynamic memory that it allocates. Always free all resources that you allocate.</li>\n<li>Don't ever use <code>malloc</code> in C++. Use <code>new</code> expressions instead.</li>\n<li>Don't use bare owing pointers. Use <code>std::unique_ptr</code> instead (although, understanding unique pointers requires understanding of classes).</li>\n</ol>\n\n<p>Finally, the problem is that <code>traverse</code> refers to identifier <code>head</code> which you've not declared. Sure, you have local variable <code>head</code> within the scope of <code>add</code>, but local variables only exist within the (potential) scope where they are declared. Futhermore, <code>add</code> isn't constructing a linked list, since it always uses a separate <code>head</code> for each element.</p>\n\n<p>A procedural linked list implementation should take the head of the list as an argument:</p>\n\n<pre><code>void add(int n, node&amp; head)\n\nvoid traverse(const node&amp; head)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7088499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06dd04bb4b2e1e5d95c27c26e0c6f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Rishabh", "link": "https://stackoverflow.com/users/7088499/rishabh"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1536153906, "answer_count": 2, "score": -6, "last_activity_date": 1536153839, "creation_date": 1536152907, "question_id": 52185948, "link": "https://stackoverflow.com/questions/52185948/creating-single-linked-list-in-c", "closed_reason": "Not suitable for this site", "title": "Creating single linked list in c++", "body": "<p>I am a beginner in coding and i am creating a linked list(without using class concept), but this is not working, please help.</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;malloc.h&gt;\nusing namespace std;\n\nstruct node{\n    int data;\n    node *next;\n};\n\nvoid add(int n){\n    node *head = NULL;\n    node *temp = (node*)malloc(sizeof(node));\n    temp-&gt;data = n;\n    temp-&gt;next = head;\n    head=temp;\n}\nvoid traverse(){\n    node *temp1 = head;\n    while(temp1!=NULL){\n        cout&lt;&lt;temp1-&gt;data;\n        temp1 = temp1-&gt;next;\n    }\n}\nint main(){\n    add(1);\n    add(2);\n    add(3);\n    traverse();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 7, "creation_date": 1536152699, "post_id": 52185857, "comment_id": 91321387, "body": "Sounds like you want a container of <a href=\"https://en.cppreference.com/w/cpp/utility/variant\" rel=\"nofollow noreferrer\"><code>std::variant</code></a>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1536152781, "post_id": 52185857, "comment_id": 91321442, "body": "If you have a limited set of parameter types you want to handle <code>std::variant</code> with <code>std::visit</code> might be the way you want to go."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536154485, "post_id": 52185857, "comment_id": 91322624, "body": "Or add virtual methods to <code>Parameter</code> as <code>virtual void print() const = 0</code>"}, {"owner": {"reputation": 31, "user_id": 6570585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a86b3f50e096f0cb0868b3df726a24?s=128&d=identicon&r=PG&f=1", "display_name": "tupanu", "link": "https://stackoverflow.com/users/6570585/tupanu"}, "edited": false, "score": 0, "creation_date": 1536154658, "post_id": 52185857, "comment_id": 91322745, "body": "I don&#39;t see what can I do with <code>virtual void print()</code>. I need to get the value of the parameter."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1536155235, "post_id": 52185857, "comment_id": 91323155, "body": "@Fran&#231;oisAndrieux or <a href=\"https://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\"><code>std::any</code></a>. At any rate, a cast is necessary"}, {"owner": {"reputation": 293, "user_id": 10175089, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8e02341885a5deb7306e7049d659cbdf?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/10175089/dan"}, "edited": false, "score": 0, "creation_date": 1536156261, "post_id": 52185857, "comment_id": 91323888, "body": "in almost all cases, you have a design flaw here. when <code>foo</code> only knows your base class, it only knows your base class. when it&#39;s necessary to &quot;upcast&quot; to concrete types, you shouldn&#39;t use polymorphism. you code is neither extendable, open-closed, or any other paradigm used in the object-oriented world."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536156754, "post_id": 52185857, "comment_id": 91324194, "body": "@tupanu: <code>void foo(const Parameter&amp; p) {     p.print(); }</code> would do the job with <code>virtual</code> <code>Parameter::print</code>. you don&#39;t necessary require value with getter, but generic actions."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536156835, "post_id": 52185857, "comment_id": 91324245, "body": "BTW, you might be surprised as you move <code>p</code> twice."}], "answers": [{"tags": [], "owner": {"reputation": 3276, "user_id": 746547, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iL90.jpg?s=128&g=1", "display_name": "Louen", "link": "https://stackoverflow.com/users/746547/louen"}, "is_accepted": false, "score": 1, "last_activity_date": 1536155719, "last_edit_date": 1592644375, "creation_date": 1536155719, "answer_id": 52186910, "question_id": 52185857, "link": "https://stackoverflow.com/questions/52185857/unique-container-for-template-class/52186910#52186910", "title": "unique container for template class", "body": "<p>You don't have to reinvent the wheel. There are a couple of classes you can use from the standard library:</p>\n<h2><a href=\"https://en.cppreference.com/w/cpp/utility/variant\" rel=\"nofollow noreferrer\"><code>std::variant</code></a>.</h2>\n<p>As suggested by the comments, <code>variant</code> is a type-safe union of a pre-defined set of data types, which you put in the templates argument of <code>variant</code>.\nFor example, a <code>std::variant&lt;int,float,double&gt;</code> can hold any value of type <code>int</code>, <code>float</code>, or <code>double</code>, but nothing else.</p>\n<p>To use the stored value, you can either use the visitor pattern with the <code>std::visit()</code> function. Other functions allow you to know which of the preset types is stored in the variable (<code>index()</code>) and to extract the value from it (using <code>get()</code>). If you try to extract the value of the wrong type, the <code>get()</code> function throws an exception</p>\n<h2><a href=\"https://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\"><code>std::any</code></a></h2>\n<p>is another utility that can hold different data types. As opposed to <code>variant</code>, you don't have to know the types at compile-time. Basically, it stores a <code>void*</code> to the data with a <code>typeinfo</code> to remember its original type. You can then use <code>any_cast</code> to cast the variable back to its original type. Just like <code>variant</code>, an exception is thrown when trying to cast to the wrong type.</p>\n<p>These two classes are available in C++ 17. If these features are not available to you, they were also included in boost (respectively <a href=\"https://www.boost.org/doc/libs/1_68_0/doc/html/variant.html\" rel=\"nofollow noreferrer\"><code>boost:variant</code></a> and <a href=\"https://www.boost.org/doc/libs/1_68_0/doc/html/any.html\" rel=\"nofollow noreferrer\"><code>boost:any</code></a>)</p>\n<p>You can store the set of values in a standard library container, e.g. in a <code>std::vector&lt;std::variant&lt;int,float,double&gt;&gt;</code> or a <code>std::vector&lt;std::any&gt;&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1536184824, "creation_date": 1536184824, "answer_id": 52193917, "question_id": 52185857, "link": "https://stackoverflow.com/questions/52185857/unique-container-for-template-class/52193917#52193917", "title": "unique container for template class", "body": "<p>Alternative to <code>std::variant</code>/<code>std::any</code> is the old way polymorphism:</p>\n\n<pre><code>class Parameter\n{\npublic:\n    Parameter(const std::string&amp; param_name) : name(param_name) {}\n    virtual ~Parameter() = default;\n\n    const std::string&amp; get_name() const { return name;  }\n\n    virtual void printValue() const = 0;\n    // Other virtual methods\n\nprivate:\n    std::string name;\n};\n\ntemplate&lt;class T&gt;\nclass TypeParameter : public Parameter\n{\npublic:\n    TypeParameter(const std::string&amp; name, const T&amp; t) : Parameter(name), value(t) {}\n\n    // Non virtual method when we don't access it by base class.\n    const T&amp; get_value() const { return value; }\n\n    void printValue() const { std::cout &lt;&lt; value; }\n\nprivate:\n    T value;\n};\n</code></pre>\n\n<p>And then your</p>\n\n<pre><code>void foo(const Parameter&amp; p)\n{\n    std::cout &lt;&lt; p.get_value(); // ERROR\n}\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>void foo(const Parameter&amp; p)\n{\n    p.print();\n}\n</code></pre>\n\n<p>If you don't want to add many virtual methods to <code>Parameter</code>, then <a href=\"https://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"nofollow noreferrer\">Visitor pattern</a> can help, but then you have to know each derived types.</p>\n"}], "owner": {"reputation": 31, "user_id": 6570585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a86b3f50e096f0cb0868b3df726a24?s=128&d=identicon&r=PG&f=1", "display_name": "tupanu", "link": "https://stackoverflow.com/users/6570585/tupanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536184824, "creation_date": 1536152634, "question_id": 52185857, "link": "https://stackoverflow.com/questions/52185857/unique-container-for-template-class", "title": "unique container for template class", "body": "<p>I have an algorithm (not preseted here) which takes as input different parameters (int, float, vectors).\nMy idea of design was to have an container which holds all these differents parameters. \n<br>To achive this, I have a base class Parameter and a derivated template class TypeParameter.\nThese parameters will be holded in a container.</p>\n\n<p>The design is presented below:</p>\n\n<pre><code>    #pragma once\n\n#include &lt;utility&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nnamespace parameter\n{\n    /*\n        Interface for parameter\n    */\n    class Parameter\n    {\n    public:\n        Parameter() {}\n        Parameter(std::string param_name) : name(param_name) {}\n        Parameter(const Parameter&amp;&amp; other) noexcept : name(std::move(other.name)) {}\n        virtual ~Parameter() {}\n\n        inline const std::string get_name() { return name;  }\n\n    private:\n        std::string name;\n    };\n\n    /*\n\n    */\n    template&lt;class T&gt;\n    class TypeParameter\n        : public Parameter\n    {\n    public:\n        TypeParameter(std::string param_name, T new_value) : Parameter(param_name), value(new_value) {}\n        TypeParameter(const TypeParameter&amp;&amp; other) noexcept : Parameter(std::move(other)), value(std::move(other.T)) {}\n\n        inline const T get_value() { return value; }\n\n    private:\n        T value;\n    };\n\n    /*\n        Container for parameters\n    */\n\n    class ParameterSet\n    {\n    public:\n        ParameterSet() {}\n\n        void add(std::unique_ptr&lt;Parameter&gt; param) { data.push_back(std::move(param)); }\n\n    private:\n        std::vector &lt;std::unique_ptr&lt;Parameter&gt;&gt; data;\n    };\n\n} //namespace parameter\n</code></pre>\n\n<p>The main is:</p>\n\n<pre><code>    #include &lt;iostream&gt;\n#include &lt;string&gt;\n\n#include \"Parameter.h\"\n\nusing parameter::TypeParameter;\nusing parameter::Parameter;\nusing parameter::ParameterSet;\n\nvoid foo(std::unique_ptr&lt;Parameter&gt; p)\n{\n    std::cout &lt;&lt; p-&gt;get_value(); // ERROR\n}\n\nint main(int argc, char *argv[])\n{\n    TypeParameter&lt;int&gt; *iparam = new TypeParameter&lt;int&gt;(\"ee\", 3);\n    std::unique_ptr&lt;Parameter&gt; p = std::make_unique &lt;TypeParameter&lt;int&gt;&gt;(\"foo\", 3);\n\n\n    foo(std::move(p));\n\n    ParameterSet param_set;\n    param_set.add(std::unique_ptr&lt;Parameter&gt;(iparam));\n    param_set.add(std::move(p));\n\n    getchar();\n}\n</code></pre>\n\n<p>My problem is I cannot get the value without a cast. </p>\n\n<p>Hence, my question is how do I cast the unique_ptr from a Parameter class to derived TypeParameter.\nIs there another way to design the container? </p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["c++", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1536152716, "post_id": 52185464, "comment_id": 91321398, "body": "If this were ill-formed NDR, <code>vector&lt;Incomplete&gt;</code> would also be for the same reason. But we can have <code>vector</code>s of incomplete types just fine."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 3, "creation_date": 1536176010, "post_id": 52185464, "comment_id": 91334231, "body": "An explicit specialization is not a POI of anything. Your first snippet is ill-formed by <a href=\"https://timsong-cpp.github.io/cppwp/temp.expl.spec#6.sentence-1\" rel=\"nofollow noreferrer\">&#91;temp.expl.spec&#93;/6</a>."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1536186398, "post_id": 52185464, "comment_id": 91338025, "body": "@T.C.: I meant <code>Foo&lt;int&gt; x = { &quot;bar&quot; };</code> as POI. <code>Foo&lt;int&gt;</code>&#39;s meaning is different there than at <code>Foo&lt;int&gt; x = { 42 };</code>. Isn&#39;t this correct thinking?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1536190733, "post_id": 52185464, "comment_id": 91338938, "body": "@geza <a href=\"http://eel.is/c++draft/temp.point#8.sentence-2\" rel=\"nofollow noreferrer\">eel.is/c++draft/temp.point#8.sentence-2</a>"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1536191306, "post_id": 52185464, "comment_id": 91339028, "body": "@Barry (and T.C.): thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1536152304, "post_id": 52185538, "comment_id": 91321127, "body": "Thanks for the answer! Note (and sorry), I&#39;ve expanded it a little bit, it is more useful for the original problem."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1536152347, "post_id": 52185538, "comment_id": 91321157, "body": "The strange this is, that <code>T</code> as member doesn&#39;t compile, but <code>new T</code> in a constructor does."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1536153601, "post_id": 52185538, "comment_id": 91322009, "body": "@geza <code>new T</code> only needs <code>T</code> complete at runtime ;)"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1536153973, "post_id": 52185538, "comment_id": 91322313, "body": "An incomplete type cannot be <code>new</code>d"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536154258, "post_id": 52185538, "comment_id": 91322498, "body": "Don&#39;t forget two-phase-ness (does that apply? (meh))"}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 1, "last_activity_date": 1536151678, "creation_date": 1536151678, "answer_id": 52185538, "question_id": 52185464, "link": "https://stackoverflow.com/questions/52185464/is-instantiating-a-class-template-with-an-incomplete-type-ill-formed-if-the-typ/52185538#52185538", "title": "Is instantiating a class template with an incomplete type ill-formed, if the type is defined afterwards?", "body": "<p>Fortunatly, yes this is well-defined. For the exact same reason this is well-defined:</p>\n\n<pre><code>struct A;\n\nclass Foo { A* value; };\n\nFoo foo; // note A is incomplete here\n\nstruct A {};\n</code></pre>\n\n<p>and this is ill-formed:</p>\n\n<pre><code>struct A;\n\ntemplate &lt;class T&gt; class Foo { T value; }; // error: 'Foo&lt;T&gt;::value' has incomplete type\n\nFoo&lt;A&gt; foo; // note A is incomplete here\n\nstruct A {};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 7, "last_activity_date": 1536351786, "last_edit_date": 1536351786, "creation_date": 1536151735, "answer_id": 52185561, "question_id": 52185464, "link": "https://stackoverflow.com/questions/52185464/is-instantiating-a-class-template-with-an-incomplete-type-ill-formed-if-the-typ/52185561#52185561", "title": "Is instantiating a class template with an incomplete type ill-formed, if the type is defined afterwards?", "body": "<pre><code>struct A;\ntemplate &lt;typename&gt; class Foo { };\nFoo&lt;A&gt; foo; // note A is incomplete here\nstruct A {};\n</code></pre>\n\n<p><code>Foo&lt;A&gt;</code> only depends on the name of <code>A</code> not its complete type.</p>\n\n<p>So this is well-formed; however, this kind of thing can still break (become ill-formed) yet compile in every compiler you test.</p>\n\n<p>First, we steal <a href=\"https://stackoverflow.com/a/21121104/1774667\">is_complete</a>.  Then we do this:</p>\n\n<pre><code>struct A;\ntemplate &lt;class T&gt; class Foo {\n  enum{ value = is_complete&lt;T&gt;::value };\n};\nFoo&lt;A&gt; foo; // note A is incomplete here\nstruct A {};\n</code></pre>\n\n<p>We are ok, despite this:</p>\n\n<blockquote>\n  <p>[...] for any such specialization that has a point of instantiation within the translation unit, the end of the translation unit is also considered a point of instantiation. [...]</p>\n</blockquote>\n\n<p>because that clause does not apply to template classes.  Here, the only instantiation of the template class is fine.</p>\n\n<p>Now, if in another file you have:</p>\n\n<pre><code>struct A {};\nFoo&lt;A&gt; foo2;\n</code></pre>\n\n<p>your program is ill formed.</p>\n\n<p>However, in the one-file case:</p>\n\n<pre><code>struct A;\ntemplate &lt;class T&gt; class Foo {\n  enum{ value = is_complete&lt;T&gt;::value };\n};\nFoo&lt;A&gt; foo; // note A is incomplete here\nstruct A {};\nFoo&lt;A&gt; foo2; // ill-formed\n</code></pre>\n\n<p>your code is fine.  There is one point of instantiation for <code>Foo&lt;A&gt;</code> in a given compilation unit; the second one is a reference to the first point of instantiation.</p>\n\n<p>Both the one and two file versoins will almost certainly compile in C++ compilers with no errors or warnings.</p>\n\n<p>Some compilers memoize template instantiations even from one compilation unit to anther; <code>Foo&lt;A&gt;</code> will have a <code>::value</code> that is <code>false</code> even after <code>foo2</code> is created (with a complete <code>A</code>).  Others will have two different <code>Foo&lt;A&gt;</code>s in each compilation unit; its methods will be marked inline (and be different), the size of the classes may disagree, and you'll get cascades of ill formed program problems.</p>\n\n<hr>\n\n<p>Finally, note that many types in <code>std</code> require that their template arguments are complete in older versions of C++ (including <a href=\"/questions/tagged/c%2b%2b11\" class=\"post-tag\" title=\"show questions tagged &#39;c++11&#39;\" rel=\"tag\">c++11</a>: \u201c17.6.4.8 Other functions (...) 2. the effects are undefined in the following cases: (...) In particular - if an incomplete type (3.9) is used as a template argument when instantiating a template component, unless specifically allowed for that component\u201d -- copied from boost incomplete container docs).  To be concrete, <code>std::vector&lt;T&gt;</code> used to require <code>T</code> to be complete.</p>\n\n<p>By <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> that has <a href=\"https://stackoverflow.com/a/44675477/1774667\">changed for <code>std::vector</code></a>:</p>\n\n<p>[vector.overview]/3</p>\n\n<blockquote>\n  <p>An incomplete type T may be used when instantiating vector if the allocator satisfies the allocator completeness requirements 17.6.3.5.1. T shall be complete before any member of the resulting specialization of vector is referenced.</p>\n</blockquote>\n\n<p>Now, even prior to <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a>, most implementations of <code>std::vector&lt;T&gt;</code> are fine with an incomplete <code>T</code> until you try to use a method (including many of its constructors or the destructor), but the standard stated that <code>T</code> <em>must</em> be complete.</p>\n\n<p>This actually gets in the way of some unuseful code, like having a function type that returns vectors of its own type<sup>1</sup>.  <a href=\"https://www.boost.org/doc/libs/1_48_0/doc/html/container/containers_of_incomplete_types.html\" rel=\"nofollow noreferrer\">Boost</a> has a library to solve this problem.</p>\n\n<hr>\n\n<pre><code>template &lt;typename T&gt;\nstruct Foo {\n  Foo() {\n    new T;\n  }\n};\n</code></pre>\n\n<p>The body of <code>Foo&lt;T&gt;::Foo()</code> is only instantiated \"when called\".  So <code>T</code>'s lack of completion has no impact until <code>Foo::Foo()</code> is called.</p>\n\n<pre><code>Foo&lt;A&gt; foo;\n</code></pre>\n\n<p>^^ will fail to compile with a non-complete <code>A</code>.</p>\n\n<pre><code>using foo_t = Foo&lt;A&gt;;\n</code></pre>\n\n<p>^^ will compile, and cause no problems.</p>\n\n<pre><code>using foo_t = Foo&lt;A&gt;;\nstruct A {};\nfoo_t foo;\n</code></pre>\n\n<p>also no problems.  The body of <code>foo_t::foo_t</code> gets instantiated when we try to construct a <code>foo_t</code>, and all definitions match.</p>\n\n<hr>\n\n<p><sup>1</sup> Can you say state machine transition function?</p>\n"}, {"tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 4, "last_activity_date": 1536329620, "last_edit_date": 1592644375, "creation_date": 1536329620, "answer_id": 52224361, "question_id": 52185464, "link": "https://stackoverflow.com/questions/52185464/is-instantiating-a-class-template-with-an-incomplete-type-ill-formed-if-the-typ/52224361#52224361", "title": "Is instantiating a class template with an incomplete type ill-formed, if the type is defined afterwards?", "body": "<p>Assuming we only have one translation unit, <a href=\"https://timsong-cpp.github.io/cppwp/temp.point#8.sentence-2\" rel=\"nofollow noreferrer\">[temp.point]</a> rules out your quote as a possible source of ill-formedness</p>\n<blockquote>\n<p>A specialization for a class template has at most one point of instantiation within a translation unit.</p>\n</blockquote>\n<p>Instead, the problem with the first snippet is <a href=\"https://timsong-cpp.github.io/cppwp/temp.expl.spec#6.sentence-1\" rel=\"nofollow noreferrer\">[temp.expl.spec]</a></p>\n<blockquote>\n<p>If a template, a member template or a member of a class template is explicitly specialized then that specialization shall be declared before the first use of that specialization that would cause an implicit instantiation to take place, in every translation unit in which such a use occurs; no diagnostic is required.</p>\n</blockquote>\n<p>The second snippet is well-formed, there is no requirement that template parameters need to have complete type.</p>\n<p>The third snippet is ill-formed, <code>new T</code> requires that <code>T</code> be a complete type. A slight catch here is that the definition of the constructor is implicitly instantiated at <code>Foo&lt;A&gt; foo;</code>. If however, the snippet is changed to</p>\n<pre><code>struct A;\n\ntemplate &lt;typename T&gt;\nstruct Foo {\n    Foo() {\n        new T;\n    }\n};\n\nusing FooA = Foo&lt;A&gt;;\n\nstruct A {};\n</code></pre>\n<p>Then the definition of the constructor <em>isn't</em> instantiated and will therefore be well-formed. <a href=\"https://timsong-cpp.github.io/cppwp/temp#inst-2.1\" rel=\"nofollow noreferrer\">[temp.inst]</a></p>\n<blockquote>\n<p>The implicit instantiation of a class template specialization causes</p>\n<ul>\n<li>the implicit instantiation of the declarations, but not of the definitions, of the non-deleted class member functions, member classes, scoped member enumerations, static data members, member templates, and friends; and [...]</li>\n</ul>\n</blockquote>\n<p>The fourth snippet is ill-formed because members need to have complete type. <a href=\"https://timsong-cpp.github.io/cppwp/class.mem#15\" rel=\"nofollow noreferrer\">[class.mem]</a></p>\n<blockquote>\n<p>The type of a non-static data member shall not be an incomplete type [...]</p>\n</blockquote>\n"}], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 3, "accepted_answer_id": 52224361, "answer_count": 3, "score": 11, "last_activity_date": 1536351786, "creation_date": 1536151482, "last_edit_date": 1536154242, "question_id": 52185464, "link": "https://stackoverflow.com/questions/52185464/is-instantiating-a-class-template-with-an-incomplete-type-ill-formed-if-the-typ", "title": "Is instantiating a class template with an incomplete type ill-formed, if the type is defined afterwards?", "body": "<p>This code is surely ill-formed, because <code>Foo</code> is specialized after an instantiation point:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct Foo {\n    int a;\n};\n\nFoo&lt;int&gt; x = { 42 };\n\ntemplate &lt;&gt;\nstruct Foo&lt;int&gt; {\n    const char *a;\n};\n\nFoo&lt;int&gt; x = { \"bar\" };\n</code></pre>\n\n<p>It is ill formed because of the part of the <a href=\"http://eel.is/c++draft/temp.point#8\" rel=\"noreferrer\">standard</a> I've put emphasis:</p>\n\n<blockquote>\n  <p>A specialization for a function template, a member function template, or of a member function or static data member of a class template may have multiple points of instantiations within a translation unit, and in addition to the points of instantiation described above, for any such specialization that has a point of instantiation within the translation unit, the end of the translation unit is also considered a point of instantiation. A specialization for a class template has at most one point of instantiation within a translation unit. A specialization for any template may have points of instantiation in multiple translation units. <strong>If two different points of instantiation give a template specialization different meanings according to the one-definition rule, the program is ill-formed, no diagnostic required.</strong></p>\n</blockquote>\n\n<p>Now, is <strong>this</strong> code ill-formed?</p>\n\n<pre><code>struct A;\n\ntemplate &lt;typename&gt; class Foo { };\n\nFoo&lt;A&gt; foo; // note A is incomplete here\n\nstruct A {};\n</code></pre>\n\n<p>Does the ill-formedness change, if <code>Foo</code> declared like this?</p>\n\n<pre><code>struct A;\n\ntemplate &lt;typename T&gt;\nstruct Foo {\n    Foo() {\n        new T;\n    }\n};\n\nFoo&lt;A&gt; foo; // note A is incomplete here\n\nstruct A {};\n</code></pre>\n\n<p>I asked this question, because of the discussion under this <a href=\"https://stackoverflow.com/questions/52180744/pimpl-why-can-make-unique-be-called-on-an-incomplete-type\">question</a>.</p>\n\n<p>Note, this is not a duplicate. That question is about why the code compiles, this question is about whether it is ill-formed. They differ, because an ill-formed program isn't necessarily a non-compiling program.</p>\n\n<hr>\n\n<p>Note, with clang and gcc, my example with <code>new T</code> compiles, while this example (<code>T</code> as a member) doesn't:</p>\n\n<pre><code>struct A;\n\ntemplate &lt;typename T&gt;\nstruct Foo {\n    T t;\n};\n\nFoo&lt;A&gt; foo; // note A is incomplete here\n\nstruct A {};\n</code></pre>\n\n<p>Maybe both are ill-formed, and diagnostic is given only for this last case?</p>\n"}, {"tags": ["c++", "makefile", "g++"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 9164755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/906fa34e9dc88650d1e52512335de76d?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk", "link": "https://stackoverflow.com/users/9164755/dirk"}, "edited": false, "score": 0, "creation_date": 1536152375, "post_id": 52185592, "comment_id": 91321178, "body": "The problem was indeed in the text matching. I removed the &#39;./&#39; from the string. Also I&#39;m very glad that you could provide me a more efficient way for creating the objects variable. Thanks alot!!!"}], "tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": true, "score": 0, "last_activity_date": 1536151861, "creation_date": 1536151861, "answer_id": 52185592, "question_id": 52185417, "link": "https://stackoverflow.com/questions/52185417/c-how-would-i-combine-two-makefile-object-target-rules-which-are-located-in-a/52185592#52185592", "title": "C++ How would I combine two makefile object target rules (which are located in another folder) into one target/rule?", "body": "<p>You need to change:</p>\n\n<pre><code>OBJECTS = ./bin/main.o \\\n          ./bin/hellolib.o\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>OBJECTS = bin/main.o \\\n          bin/hellolib.o\n</code></pre>\n\n<p>(Removing leading \"<code>./</code>\"). Either that, or change your pattern rule to include the leading \"<code>./</code>\":</p>\n\n<pre><code>./bin/%.o : src/%.cpp\n        $(CC) -c $&lt; -o $@\n</code></pre>\n\n<p>Make rule matching uses <em>text matching</em>.  It's not based on filenames, so \"<code>./././foo</code>\" and \"<code>foo</code>\" are not the same thing.</p>\n\n<p>Personally I recommend rewriting like this:</p>\n\n<pre><code>SOURCES = src/main.cpp \\\n          src/hellolib.cpp\n\nOBJECTS = $(patsubst src/%.cpp,bin/%.o,$(SOURCES))\n</code></pre>\n\n<p>so you only need to keep the list of files in one place.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 9164755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/906fa34e9dc88650d1e52512335de76d?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk", "link": "https://stackoverflow.com/users/9164755/dirk"}, "edited": false, "score": 0, "creation_date": 1536152685, "post_id": 52185693, "comment_id": 91321379, "body": "Indeed, that&#39;s what I thought. But it didn&#39;t work for me. According to @MadScientist it was because I had to remove the leading &#39;./&#39; from the pattern. Thanks alot, I will change the variable name and keep that in mind."}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 0, "last_activity_date": 1536152168, "creation_date": 1536152168, "answer_id": 52185693, "question_id": 52185417, "link": "https://stackoverflow.com/questions/52185417/c-how-would-i-combine-two-makefile-object-target-rules-which-are-located-in-a/52185693#52185693", "title": "C++ How would I combine two makefile object target rules (which are located in another folder) into one target/rule?", "body": "<p>You can make a rule that builds anything conforming to a specific pattern like this:</p>\n\n<pre><code>bin/%.o : src/%.cpp\n    $(CC) -c -o $@ $&lt;\n</code></pre>\n\n<p>That will compile any <code>bin/%.o</code> dependency from the corresponding source <code>src/%.cpp</code>.</p>\n\n<p>Also it is standard when compiling <code>C++</code> to use <code>CXX</code> rather than <code>CC</code> (which is for <code>C</code> code).</p>\n"}], "owner": {"reputation": 95, "user_id": 9164755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/906fa34e9dc88650d1e52512335de76d?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk", "link": "https://stackoverflow.com/users/9164755/dirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 52185592, "answer_count": 2, "score": 0, "last_activity_date": 1536152168, "creation_date": 1536151319, "question_id": 52185417, "link": "https://stackoverflow.com/questions/52185417/c-how-would-i-combine-two-makefile-object-target-rules-which-are-located-in-a", "title": "C++ How would I combine two makefile object target rules (which are located in another folder) into one target/rule?", "body": "<p>My C++ program consists of three files:</p>\n\n<ul>\n<li>two source files 'main.cpp' and 'hellolib.cpp'</li>\n<li>a header file 'hellolib.h'</li>\n</ul>\n\n<p>I am creating a makefile for this program. For my assignment I need one target ('hello') that compiles all source files in an executable. \nAnother target ('obj') should compile all '.cpp' files into objects and link them together in an executable.</p>\n\n<p>When running make I prefer the object files to be created in a seperate folder called 'bin'. The source files are would be in a folder called 'src'. These folders are siblings, the makefile is in it's parent folder.</p>\n\n<p>My makefile works fine but I wish two combine the two targets 'bin/main.o' and 'bin/hellolib.o' into one to reduce the amount of rules, especially for later when I am dealing with more source files.\nI imagined the replacement would look something like this, but it doesn't seem to work. </p>\n\n<blockquote>\n  <p>It gives me the error: \"*** No rule ot make target 'bin/main.o',\n  needed by 'obj'. Stop.</p>\n</blockquote>\n\n<pre><code>bin/%.o : src/%.cpp\n    $(CC) -c $&lt; -o $@\n</code></pre>\n\n<p>Working Makefile:</p>\n\n<pre><code>CC      = g++\nSOURCES = ./src/main.cpp \\\n          ./src/hellolib.cpp\nOBJECTS = ./bin/main.o \\\n          ./bin/hellolib.o\n\nhello : $(SOURCES)\n    $(CC) -o $@ $^\n\nobj : $(OBJECTS)\n    $(CC) -o $@ $^\n\nbin/main.o : src/main.cpp\n    $(CC) -c $&lt; -o $@\n\nbin/hellolib.o : src/hellolib.cpp\n    $(CC) -c $&lt; -o $@\n\nclean:\n    @rm -rf hello obj bin/*.o\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>#include \"hellolib.h\"\n\nint main() {\n    Hello h(\"Name\");\n    h.Print();\n    return 0;\n}\n</code></pre>\n\n<p>hellolib.cpp</p>\n\n<pre><code>#include \"hellolib.h\"\n\n#include &lt;iostream&gt;\n\nHello::Hello(std::string name) {\n    if (name.empty()) {\n        cout &lt;&lt; \"Name is not valid!\";\n        return;\n    }\n    _name = name;\n}\n\nvoid Hello::Print() {\n    cout &lt;&lt; \"Hello \" &lt;&lt; _name &lt;&lt; endl;\n}\n</code></pre>\n\n<p>hellolib.h</p>\n\n<pre><code>#ifndef HELLO_LIB_H\n#define HELLO_LIB_H\n\n#include &lt;string&gt;\nusing namespace std;\n\nclass Hello {\n    std::string _name;\n    public:\n        Hello(std::string name);\n        void Print();\n};\n\n#endif\n</code></pre>\n"}, {"tags": ["c++", "linux", "posix", "semaphore"], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 6162459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ec22a9e2a1a0f196a0bdbe3b56adb?s=128&d=identicon&r=PG&f=1", "display_name": "Rhnbmpl", "link": "https://stackoverflow.com/users/6162459/rhnbmpl"}, "is_accepted": true, "score": 0, "last_activity_date": 1537028384, "creation_date": 1537028384, "answer_id": 52346579, "question_id": 52185377, "link": "https://stackoverflow.com/questions/52185377/executable-crashingsegv-maperr-on-access-posix-semaphore-on-target-machine/52346579#52346579", "title": "Executable crashing(SEGV_MAPERR) on access POSIX Semaphore on target machine", "body": "<p>Solved it. I just had to remove the O_EXCL flag and I also had to run my application as root.</p>\n"}], "owner": {"reputation": 78, "user_id": 6162459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ec22a9e2a1a0f196a0bdbe3b56adb?s=128&d=identicon&r=PG&f=1", "display_name": "Rhnbmpl", "link": "https://stackoverflow.com/users/6162459/rhnbmpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 52346579, "answer_count": 1, "score": 0, "last_activity_date": 1537028384, "creation_date": 1536151217, "question_id": 52185377, "link": "https://stackoverflow.com/questions/52185377/executable-crashingsegv-maperr-on-access-posix-semaphore-on-target-machine", "title": "Executable crashing(SEGV_MAPERR) on access POSIX Semaphore on target machine", "body": "<p>I have made a executable which tries to access and get the state or change the state of an existing named POSIX semaphore created by the process on the target machine(Ubuntu 16.04) running at niceness level:-19.\nMy program, I have made in C++ on Ubuntu 16.04. On accessing the semaphore on the target machine by program compiled by the target machine, the semaphore is being accessed and changed properly. But when accessed by my machine's compiled executable, it gives SEGV_MAPERR segmentation fault.\nOn testing with another semaphore locking/unlocking program on my machine, the program works.I am keeping the permissions as 777 and flags as O_CREAT | O_EXCL on programs on both programs on both machines.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ghc0R.png\" rel=\"nofollow noreferrer\">Erro on running on target machine.</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ASuvc.png\" rel=\"nofollow noreferrer\">Backtrace by GDB on Target machine</a></p>\n\n<p>I am using semaphore.h library on both the machines.\nThanks.</p>\n"}, {"tags": ["c++", "memory-management", "allocation", "memory-alignment", "placement-new"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1536149572, "post_id": 52184761, "comment_id": 91319419, "body": "All your <code>for</code> loops are wrong, <code>pB + i</code> performs pointer arithmetic on a pointer of type <code>WE*</code>, not <code>char*</code>"}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1536149935, "post_id": 52184761, "comment_id": 91319620, "body": "@UnholySheep Well, that is what I want, I want to &quot;place&quot; <code>WE</code> objects not chars. Chars were only for the allocation part."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1536150034, "post_id": 52184761, "comment_id": 91319693, "body": "Yes, but you allocated an array of size <code>nbytes * sizeof(char)</code>, not <code>nbytes * sizeof(WE)</code> - you are iterating way past the bounds of it with your <code>for</code> loops"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1536150431, "post_id": 52184761, "comment_id": 91319955, "body": "The for loops should be <code>i &lt; elements; i++</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": true, "score": 1, "last_activity_date": 1536152269, "last_edit_date": 1536152269, "creation_date": 1536151933, "answer_id": 52185622, "question_id": 52184761, "link": "https://stackoverflow.com/questions/52184761/properly-allocate-an-array-with-placement-new/52185622#52185622", "title": "Properly allocate an array with placement new", "body": "<p>For objects construction (placement new), you can either iterate byte/char-wise:</p>\n\n<pre><code>for (int i = 0; i &lt; nbytes; i += step) new (memory + i) WE();\n</code></pre>\n\n<p>or element-wise:</p>\n\n<pre><code>for (int i = 0; i &lt; elements; i++) new (pB + i) WE();\n</code></pre>\n\n<p>In the remaining loops, where you access the elements, you need to use the second option.</p>\n\n<p>As for alignment, dynamic memory allocation returns a memory chunk aligned at <code>alignof(std::max_align_t)</code> (C++11). The exemplary value is 16 (GCC/x86_64), which is what you want, but this value is of course not guaranteed by the Standard. </p>\n\n<p>If I am not wrong, before C++17 <code>operator new</code> cannot allocate memory for over-aligned objects directly and <code>std::aligned_storage</code> does not help here. From C++17, there are special versions of <code>operator new</code> that accept alignment information, see: <a href=\"https://en.cppreference.com/w/cpp/memory/new/operator_new\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/memory/new/operator_new</a>.</p>\n"}], "owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 52185622, "answer_count": 1, "score": 0, "last_activity_date": 1536152269, "creation_date": 1536149312, "question_id": 52184761, "link": "https://stackoverflow.com/questions/52184761/properly-allocate-an-array-with-placement-new", "title": "Properly allocate an array with placement new", "body": "<p>I'm building a memory allocator and making use of placement new. \nSay I want to \"place\" 10 elements to an already allocated array on the heap. </p>\n\n<p>First regular new allocates the necessary amount of Bytes on the heap, then i construct my <code>WE</code> objects at appropriate locations. </p>\n\n<pre><code>struct WE {\n    WE() {\n        std::cout &lt;&lt; \"WE default constructed\\n\";\n    }\n    ~WE() {\n        std::cout &lt;&lt; \"WE default destructed\\n\";\n    }\n\n    double d;\n    int i;\n    char c;\n};\n</code></pre>\n\n<p>Is the following usage of placement new correct? </p>\n\n<p>Code compiles and output seems correct, but I have some doubts. </p>\n\n<pre><code>// 1. allocate\nconst int elements = 10;\nint nbytes = elements * sizeof(WE);\nchar* memory = new char[nbytes];\nWE* pB = (WE*)memory;\nint step = sizeof(WE);\n// 2. construct\nfor (int i = 0; i &lt; nbytes; i += step)\n    new (pB + i) WE();\n// 3. process\nfor (int i = 0; i &lt; nbytes; i += step)\n    pB[i].i = i * 2;\nfor (int i = 0; i &lt; nbytes; i += step)\n    std::cout &lt;&lt; '[' &lt;&lt; i &lt;&lt; ']' &lt;&lt; '=' &lt;&lt; pB[i].i &lt;&lt; '\\n';\n// 4. destruct\nfor (int i = 0; i &lt; nbytes; i += step)\n    pB[i].~WE();\n// 5. deallocate\ndelete[] memory;\npB = nullptr;\nmemory = nullptr;\n</code></pre>\n\n<p>If all is well with question above, then allow me an addition question, how would I align this array on an arbitrary byte boundary?\nSay I want alignment at a <code>sizeof(WE)</code> which is <code>16</code> (and not at <code>alignof(WE)</code> which is <code>8</code>). Would this modification: <code>alignas(sizeof(WE)) char* memory = new char[nbytes];</code> be enough to do the trick? I've also heard of <code>std::aligned_storage</code>. I'm not sure whether it could provide any benefits. (If the second question confused you, or if I've messed things up on part 1, forget about it.) Thanks in advance. </p>\n"}, {"tags": ["c#", "c++", "dll", "digital-signature"], "comments": [{"owner": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 1, "creation_date": 1536149466, "post_id": 52184681, "comment_id": 91319344, "body": "Does the Win7 system actually check the signature? Can you verify the behaviour of signed/unsigned on both systems? The other thing worth checking would be the crypto provider used for signature verification (that&#39;s probably something internal to the .Net Platform since it&#39;s invoked from C#?)."}, {"owner": {"reputation": 385, "user_id": 4965642, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ed6921390414c649b9c1073f5e64f115?s=128&d=identicon&r=PG&f=1", "display_name": "Carles", "link": "https://stackoverflow.com/users/4965642/carles"}, "reply_to_user": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1536150550, "post_id": 52184681, "comment_id": 91320050, "body": "How do I find out whether Win7 is checking the signature or not? Do you think is this something to do with the time that takes to verify the signature? In that case, is this done for every function call?"}, {"owner": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1536151031, "post_id": 52184681, "comment_id": 91320320, "body": "If Win7 is not checking the signature, it is obviously cheating &gt;:) Just break the signature for a quick answer (use mismatching key for signing) or google it. It is weird the signature has to be checked per function call, maybe you&#39;re invoking <code>dllopen</code> too often - can you perhaps cache the extracted functions addresses? (sorry if it makes no sense, taking a guess here)"}, {"owner": {"reputation": 385, "user_id": 4965642, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ed6921390414c649b9c1073f5e64f115?s=128&d=identicon&r=PG&f=1", "display_name": "Carles", "link": "https://stackoverflow.com/users/4965642/carles"}, "reply_to_user": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1536217273, "post_id": 52184681, "comment_id": 91345594, "body": "@hauron thanks for your time, but this does not fix the issues. Is it normal that a digital signature has a negative effect in the performance of a DLL? I would find this normal if the DLL would be encrypted, but I don&#39;t think this is the case."}, {"owner": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 1, "creation_date": 1536228647, "post_id": 52184681, "comment_id": 91352302, "body": "Encryption is a different story, not sure how they relate in Windows library loading, but I can easily imagine a DLL that&#39;s just signed. I&#39;m sorry, but I do not know the right answer, beyond the intuition shared before."}, {"owner": {"reputation": 385, "user_id": 4965642, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ed6921390414c649b9c1073f5e64f115?s=128&d=identicon&r=PG&f=1", "display_name": "Carles", "link": "https://stackoverflow.com/users/4965642/carles"}, "reply_to_user": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1536244072, "post_id": 52184681, "comment_id": 91361834, "body": "Thanks anyway @hauron"}], "owner": {"reputation": 385, "user_id": 4965642, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ed6921390414c649b9c1073f5e64f115?s=128&d=identicon&r=PG&f=1", "display_name": "Carles", "link": "https://stackoverflow.com/users/4965642/carles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536149247, "creation_date": 1536149009, "last_edit_date": 1536149247, "question_id": 52184681, "link": "https://stackoverflow.com/questions/52184681/digital-signature-slowing-down-dll", "title": "Digital signature slowing down DLL", "body": "<p>I\u2019m facing a very strange issue: I have a DLL developed in C++ &amp; Visual Studio which have been working fine for some years (being constantly updated). Recently I noticed that when moved to other PCs was slowing down the performance. As an example, I measured a function that takes around 120ms to be executed in my PC (Win7, Core i3 second generation), but in a brand new PC (Win10, Core i5 8th generation) takes around 700ms, which didn't make sense (this very same effect happens in any PC).</p>\n\n<p>After two days of testing and trying different optimizations approaches (linker, compiler, platforms, etc) I realised that performance was normal when the DLL was not signed.</p>\n\n<p>This delay is not caused the first time that it is used, but in any function call while the application is running.</p>\n\n<p>I didn't mention that this DLL is being used from a C# program.</p>\n\n<p>The signature was provided by Comodo and applied to the DLL using signtool.exe</p>\n\n<p>I would appreciate any clue or information that could clarify the source of this issue.</p>\n"}, {"tags": ["c++", "centos7", "c++17"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1536148298, "post_id": 52184429, "comment_id": 91318583, "body": "What shell are you using? If you want guarancy, run <code>popen</code> 3 times for each process <code>ps</code>, <code>grep</code> and <code>egrep</code> with pipes between them."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1536148402, "post_id": 52184429, "comment_id": 91318637, "body": "It&#39;s better to use <code>pgrep my_process</code> to check if a process named my_process is running. Using <code>ps | grep</code> pipe will may give you false positives."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536148437, "post_id": 52184429, "comment_id": 91318665, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52164723/how-to-execute-a-command-and-get-return-code-stdout-and-stderr-of-command-in-c\">How to execute a command and get return code stdout and stderr of command in C++</a>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1536148660, "post_id": 52184429, "comment_id": 91318806, "body": "If you want to understand how something works, you need to cut through the layers of abstraction.  You can implement this using <code>fork</code>, <code>pipe</code>, and <code>exec</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536150727, "post_id": 52184429, "comment_id": 91320145, "body": "Oof, that function gives me tingles. Be <i>very very careful</i> about what you allow to pass into <code>is_process_running</code>. You&#39;d be better off taking some non-shell approach: does your OS not provide an API for this kind of thing?"}], "answers": [{"comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "edited": false, "score": 2, "creation_date": 1536149918, "post_id": 52184635, "comment_id": 91319611, "body": "@Fabiotk There are several thousands of examples on how to use these functions, all over the Internet (and quite a few of them here on this site). Please do some searching first."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1536149278, "last_edit_date": 1536149278, "creation_date": 1536148844, "answer_id": 52184635, "question_id": 52184429, "link": "https://stackoverflow.com/questions/52184429/what-is-the-safe-way-of-get-the-return-status-from-an-executed-shell-command-in/52184635#52184635", "title": "What is the safe way of get the return status from an executed shell command in c++", "body": "<p>The problem is that <a href=\"http://man7.org/linux/man-pages/man1/bash.1.html#EXIT_STATUS\" rel=\"nofollow noreferrer\">the exit status of Bash</a> isn't guaranteed to be the exit status of the last executed command. If there's an error in the command you pass, you can't really distinguish it from <code>egrep</code> failing to match anything.</p>\n\n<p>What you need to do is to do is to both get the exit status <em>and</em> parse the output (both to standard output and standard error). This can be accomplished by copying much of what the <code>system</code> function does: First <a href=\"http://man7.org/linux/man-pages/man2/pipe.2.html\" rel=\"nofollow noreferrer\">create a pipe</a> for the output (both <code>stderr</code> and <code>stdout</code> could be using the same pipe), then <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork a new process</a> to run the shell, and then <a href=\"http://man7.org/linux/man-pages/man3/exec.3.html\" rel=\"nofollow noreferrer\">execute the shell and the pipeline</a>.</p>\n\n<p>In the parent process you <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\">wait for the child to exit</a>, and get its exit status. If it's zero then you know everything worked fine, and you can discard all the output from the pipe. If it's non-zero you have to read the output from the pipe to see what happened, if there was some error except <code>egrep</code> failing.</p>\n"}], "owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536149278, "creation_date": 1536148128, "question_id": 52184429, "link": "https://stackoverflow.com/questions/52184429/what-is-the-safe-way-of-get-the-return-status-from-an-executed-shell-command-in", "title": "What is the safe way of get the return status from an executed shell command in c++", "body": "<p>Since the function <code>std::system(const char* command)</code> from <code>cstdlib</code> <a href=\"http://www.cplusplus.com/reference/cstdlib/system/#return\" rel=\"nofollow noreferrer\">doesn't guarantee that will return the correct return status from the shell</a>, then how can I run a command in shell using c/c++ and have a guarantee that will give me the right return value?</p>\n\n<p>In my case, for example, I ran a command with:</p>\n\n<pre><code>bool is_process_running(std::string p_name){\n  std::string command_str= \"ps aux | grep '\" + p_name + \"' | egrep -v '(grep|bash)'\";\n\n  int result(0);\n  result= system(command_str.c_str());\n\n  return result == 0;\n}\n</code></pre>\n\n<p>If I run, for example, <code>ps aux | grep 'my_process' | egrep -v '(grep|bash)'</code> directly into the terminal and after that <code>echo $?</code>, I see it returning <code>0</code> because <code>my_process</code> is running and also returning <code>1</code> when I use a non running process. But, the code above returns a different value. This code used to work when I tested in CentOs 6 but now in CentOs 7 doesn't work anymore. So, what can I use to run the shell command and get the correct result?</p>\n\n<p>I also found a solution using <code>pidof</code> command but I can't use this because pidof doesn't consider the parameters passed to <code>my_process</code> which I need since I have many instances of this process each with different arguments.</p>\n"}, {"tags": ["c++", "encryption", "openssl", "rsa"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 4, "creation_date": 1536147587, "post_id": 52184170, "comment_id": 91318085, "body": "This isn&#39;t really C++, is it? I mean, yeah, you use <code>std::string</code> once (and for the minimum time necessary) while base-64 decoding, but other than that it&#39;s pure C and you won&#39;t find much help for your <code>malloc</code>-related problems in a modern C++ community. Having a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would really help, especially if you could provide the failing input."}, {"owner": {"reputation": 67, "user_id": 5562310, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/86262d8bafccb3b8434b3b7471605e23?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Farrukh", "link": "https://stackoverflow.com/users/5562310/hamza-farrukh"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1536148115, "post_id": 52184170, "comment_id": 91318448, "body": "Agree that there is a mixture of C and C++ but the error is coming out from the if condition which is C++ and it is producing the following error (not every time). <code>Error decrypting message: error:04099079:rsa routines:RSA_padding_check_PKCS1_OAEP_mgf1:oaep decoding error.</code>"}, {"owner": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1536148282, "post_id": 52184170, "comment_id": 91318570, "body": "Have you seen this: <a href=\"https://stackoverflow.com/questions/25506611/openssl-rsa-private-decrypt-fails-with-oaep-decoding-error\" title=\"openssl rsa private decrypt fails with oaep decoding error\">stackoverflow.com/questions/25506611/&hellip;</a> If you&#39;re suspecting memory problem, does the problem disappear when you increased allocated size? (like - double it) Does it sometimes fail for the same input or is input randomized?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1536148623, "post_id": 52184170, "comment_id": 91318777, "body": "Everything about that <code>if</code> is C. From C-style casts over <code>strlen</code> and the RSA function call (which is probably <a href=\"https://github.com/openssl/openssl\" rel=\"nofollow noreferrer\">implemented in C</a>, not that it matters) to C-style error handling and <code>fprintf</code>. Not an ounce of C++."}, {"owner": {"reputation": 67, "user_id": 5562310, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/86262d8bafccb3b8434b3b7471605e23?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Farrukh", "link": "https://stackoverflow.com/users/5562310/hamza-farrukh"}, "edited": false, "score": 1, "creation_date": 1536148645, "post_id": 52184170, "comment_id": 91318797, "body": "Yes I have seen and tried this link. The input is always same. The encrypted characters are different but the length is same. So might not be a memory issue."}, {"owner": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 1, "creation_date": 1536148889, "post_id": 52184170, "comment_id": 91318968, "body": "What does the <code>base64_decode</code> function return? Could be it returning bytes in <code>const char*</code> or similar holder, and sometimes 0 cause the string to be truncated?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1536148909, "post_id": 52184170, "comment_id": 91318975, "body": "Are you sure that the decoded <code>msgascii</code> does not contain any null characters? That would result in <code>strlen(c)</code> being different from <code>msgascii.size()</code>, with only the latter being what you probably want. Or, to account for what @hauron said: Where does <code>base64_decode</code> come from? Again, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would help us help you."}, {"owner": {"reputation": 67, "user_id": 5562310, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/86262d8bafccb3b8434b3b7471605e23?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Farrukh", "link": "https://stackoverflow.com/users/5562310/hamza-farrukh"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1536148949, "post_id": 52184170, "comment_id": 91319009, "body": "@Max I am a beginner with C/C++ so please bear with me. I thought my question was clear enough to have the answer."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1536149039, "post_id": 52184170, "comment_id": 91319062, "body": "As you see, it isn&#39;t. Time to update your question and answer those comments (as an edit in your question) ;)"}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1536166077, "post_id": 52184170, "comment_id": 91329743, "body": "The problem is what @MaxLanghof pointed out. Ciphertext is essentially a sequence of random bytes, not a string. If your ciphertext happens to contain a &#39;\\0&#39; byte then your decryption will fail. Instead of using <code>std::string</code> you should use <code>std::vector&lt;unsigned char&gt;</code>."}, {"owner": {"reputation": 67, "user_id": 5562310, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/86262d8bafccb3b8434b3b7471605e23?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Farrukh", "link": "https://stackoverflow.com/users/5562310/hamza-farrukh"}, "reply_to_user": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 1, "creation_date": 1536229304, "post_id": 52184170, "comment_id": 91352649, "body": "Thanks @hauron, your answer helped me solve my problem"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 5562310, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/86262d8bafccb3b8434b3b7471605e23?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Farrukh", "link": "https://stackoverflow.com/users/5562310/hamza-farrukh"}, "is_accepted": true, "score": 1, "last_activity_date": 1536229264, "creation_date": 1536229264, "answer_id": 52201876, "question_id": 52184170, "link": "https://stackoverflow.com/questions/52184170/openssl-rsa-decryption-fails-randomly-c-c/52201876#52201876", "title": "OpenSSL RSA Decryption fails randomly C/C++", "body": "<p>Using strlen(c) in the if condition caused the char array to terminate when the encrypted characters contained a null character, so instead I used msgascii.size() and it solved the problem.</p>\n"}], "owner": {"reputation": 67, "user_id": 5562310, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/86262d8bafccb3b8434b3b7471605e23?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Farrukh", "link": "https://stackoverflow.com/users/5562310/hamza-farrukh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "accepted_answer_id": 52201876, "answer_count": 1, "score": 0, "last_activity_date": 1536229264, "creation_date": 1536147275, "last_edit_date": 1536149362, "question_id": 52184170, "link": "https://stackoverflow.com/questions/52184170/openssl-rsa-decryption-fails-randomly-c-c", "title": "OpenSSL RSA Decryption fails randomly C/C++", "body": "<p>I am implementing RSA algorithm where I am reading the public and private keys from .crt and .pem certificates respectively. It encrypts the data correctly but the problem comes in decryption. Sometimes it decrypts fine and sometimes it gives the following error:</p>\n\n<blockquote>\n  <p>Error decrypting message: error:04099079:rsa\n  routines:RSA_padding_check_PKCS1_OAEP_mgf1:oaep decoding error.</p>\n</blockquote>\n\n<p>The decryption fails when the following if condition is true</p>\n\n<pre><code>if ((decrypt_len = RSA_private_decrypt(strlen(c), (unsigned char*)c,\n        (unsigned char*)decrypt, rsa, RSA_PKCS1_OAEP_PADDING)) == -1)\n</code></pre>\n\n<p>The code chunk is given below:</p>\n\n<pre><code>void DecryptRSA(const char *message)\n{\n    char *privateCertPath = \"privateCertificate.pem\";\n\n    const char *msg = message; //message in base64 characters\n    BIO *bo = BIO_new_file(privateCertPath, \"rb\");\n\n    EVP_PKEY *pri;\n    OpenSSL_add_all_algorithms();\n    pri = PEM_read_bio_PrivateKey(bo, NULL, NULL,  NULL);\n    if (pri == NULL) {\n        /* Error */\n    }\n\n    RSA* rsa = EVP_PKEY_get1_RSA(pri);\n\n    unsigned char *decrypt = (unsigned char *) malloc(RSA_size(rsa));\n    int decrypt_len;\n    char *err = (char *) malloc(130);\n    string msgascii = base64_decode(msg); //converting \n    const char *c = msgascii.c_str();   \n\n    if ((decrypt_len = RSA_private_decrypt(strlen(c), (unsigned char*)c,\n        (unsigned char*)decrypt, rsa, RSA_PKCS1_OAEP_PADDING)) == -1)\n    {\n        ERR_load_crypto_strings();\n        ERR_error_string(ERR_get_error(), err);\n        fprintf(stderr, \"Error decrypting message: %s\\n\", err);     \n    }\n\n    printf(\"%s\", decrypt);\n\n    RSA_free(rsa);\n    BIO_free(bo);\n    free((char*)msg);\n    free((char*)c);\n    free(decrypt);  \n    free(err);  \n}\n</code></pre>\n"}, {"tags": ["c++", "htc-vive", "openvr"], "answers": [{"tags": [], "owner": {"reputation": 231, "user_id": 1856343, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/58d53ae20bac7723c1048df7ecd34dc5?s=128&d=identicon&r=PG", "display_name": "Guntram", "link": "https://stackoverflow.com/users/1856343/guntram"}, "is_accepted": true, "score": 0, "last_activity_date": 1536744452, "creation_date": 1536744452, "answer_id": 52291840, "question_id": 52184129, "link": "https://stackoverflow.com/questions/52184129/openvr-ivrsystemgetcontrollerstate-always-returns-empty-structs/52291840#52291840", "title": "OpenVR - IVRSystem::GetControllerState always returns empty structs", "body": "<p>Apparently I was making two mistakes. \nMistake #1 was that I was using the wrong sample file. I used hellovr_opengl from the OpenVr sample folder, but instead hellovr_dx12 was the working solution. It must have a different kind of configration as well, since I copied a function which was working into the hellovr_opengl project and there, it did not work! Then I copied the functions I added to the hellovr_dx12 project and was able to get the controller states of the Vive controller. </p>\n\n<p>However, I wanted to get the states of the Vive Tracker, which didn't work. After some googling I found out about an <a href=\"https://community.viveport.com/t5/Developer-Discussion/Vive-Tracker-pogo-pins-no-longer-working-after-steamvr-update-on/td-p/21452\" rel=\"nofollow noreferrer\">issue with the current SteamVR driver</a>, so I reverted it back to a beta hoftix, which solved the Vive Tracker issue for me. </p>\n"}, {"tags": [], "owner": {"reputation": 44, "user_id": 11347759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCxza.png?s=128&g=1", "display_name": "negativezforward", "link": "https://stackoverflow.com/users/11347759/negativezforward"}, "is_accepted": false, "score": -1, "last_activity_date": 1556650943, "creation_date": 1556650943, "answer_id": 55927234, "question_id": 52184129, "link": "https://stackoverflow.com/questions/52184129/openvr-ivrsystemgetcontrollerstate-always-returns-empty-structs/55927234#55927234", "title": "OpenVR - IVRSystem::GetControllerState always returns empty structs", "body": "<p>You have to call;<br>\nvr::VRInput()->SetActionManifestPath</p>\n"}], "owner": {"reputation": 231, "user_id": 1856343, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/58d53ae20bac7723c1048df7ecd34dc5?s=128&d=identicon&r=PG", "display_name": "Guntram", "link": "https://stackoverflow.com/users/1856343/guntram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 52291840, "answer_count": 2, "score": 1, "last_activity_date": 1556650943, "creation_date": 1536147165, "question_id": 52184129, "link": "https://stackoverflow.com/questions/52184129/openvr-ivrsystemgetcontrollerstate-always-returns-empty-structs", "title": "OpenVR - IVRSystem::GetControllerState always returns empty structs", "body": "<p>I've been following Kamran Bigdely-Shamloo's <a href=\"https://www.codeproject.com/Articles/1171122/How-to-Get-Raw-Positional-Data-from-HTC-Vive\" rel=\"nofollow noreferrer\">article</a> on how to get positional information from the HTC Vive and it has worked well so far. My next step was to \"listen\" to button presses. I've read the documentation and it says <a href=\"https://github.com/ValveSoftware/openvr/wiki/IVRSystem::GetControllerState\" rel=\"nofollow noreferrer\">here</a> that all I need to do is query <code>IVRSystem::GetControllerState</code>and it'll return a </p>\n\n<blockquote>\n  <p>\"struct with the current state of the controller\"</p>\n</blockquote>\n\n<p>This struct however always contains variables that have the 0 value. The following function is called in a <code>while (true)</code> loop from the <code>main</code> function. </p>\n\n<pre><code>bool CMainApplication::HandleInput()\n{\nSDL_Event sdlEvent;\nbool bRet = false;\n\nwhile ( SDL_PollEvent( &amp;sdlEvent ) != 0 )\n{\n    if ( sdlEvent.type == SDL_QUIT )\n    {\n        bRet = true;\n    }\n    else if ( sdlEvent.type == SDL_KEYDOWN )\n    {\n        if ( sdlEvent.key.keysym.sym == SDLK_ESCAPE \n             || sdlEvent.key.keysym.sym == SDLK_q )\n        {\n            bRet = true;\n        }\n        if( sdlEvent.key.keysym.sym == SDLK_c )\n        {\n            m_bShowCubes = !m_bShowCubes;\n        }\n    }\n}\n\n// Process SteamVR events\n// Periodically returns an event of type 404 (\"VREvent_SceneApplicationChanged      = 404, // data is process - The App actually drawing the scene changed (usually to or from the compositor)\"\nvr::VREvent_t event;\nvr::VREvent_Controller_t controllerEvent;\nstd::chrono::milliseconds ms4;\nwhile( m_pHMD-&gt;PollNextEvent( &amp;event, sizeof( event ) ) )\n{\n    ms4 = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(\n        std::chrono::system_clock::now().time_since_epoch()\n        );\n    ProcessVREvent( &amp;event);\n    printPositionalData(&amp;event, ms4);\n}\n\nvr::VRControllerState_t state;\n\n// Check every device attached, usually it's four devices\n// Second if statement is never reached\nfor (int i = 0; i &lt; 1000; i++) {\n    if (m_pHMD-&gt;GetControllerState(i, &amp;state, sizeof(state))) {\n        dprintf(\"%d\", i);\n            if (state.ulButtonPressed != 0 || state.unPacketNum != 0 || state.ulButtonTouched != 0) {\n                dprintf(\"Some action?\");\n            }\n    }\n}\ndprintf(\"\\n\");\n\n// Process SteamVR action state\n// UpdateActionState is called each frame to update the state of the actions themselves. The application\n// controls which action sets are active with the provided array of VRActiveActionSet_t structs.\nvr::VRActiveActionSet_t actionSet = { 0 };\nactionSet.ulActionSet = m_actionsetDemo;\nvr::VRInput()-&gt;UpdateActionState( &amp;actionSet, sizeof(actionSet), 1 );\n\nm_bShowCubes = !GetDigitalActionState( m_actionHideCubes );\n\nvr::VRInputValueHandle_t ulHapticDevice;\nif ( GetDigitalActionRisingEdge( m_actionTriggerHaptic, &amp;ulHapticDevice ) )\n{\n    if ( ulHapticDevice == m_rHand[Left].m_source )\n    {\n        vr::VRInput()-&gt;TriggerHapticVibrationAction( m_rHand[Left].m_actionHaptic, 0, 1, 4.f, 1.0f, vr::k_ulInvalidInputValueHandle );\n    }\n    if ( ulHapticDevice == m_rHand[Right].m_source )\n    {\n        vr::VRInput()-&gt;TriggerHapticVibrationAction( m_rHand[Right].m_actionHaptic, 0, 1, 4.f, 1.0f, vr::k_ulInvalidInputValueHandle );\n    }\n}\n\nvr::InputAnalogActionData_t analogData;\nif ( vr::VRInput()-&gt;GetAnalogActionData( m_actionAnalongInput, &amp;analogData, sizeof( analogData ), vr::k_ulInvalidInputValueHandle ) == vr::VRInputError_None &amp;&amp; analogData.bActive )\n{\n    m_vAnalogValue[0] = analogData.x;\n    m_vAnalogValue[1] = analogData.y;\n}\n\nm_rHand[Left].m_bShowController = true;\nm_rHand[Right].m_bShowController = true;\n\nvr::VRInputValueHandle_t ulHideDevice;\nif ( GetDigitalActionState( m_actionHideThisController, &amp;ulHideDevice ) )\n{\n    if ( ulHideDevice == m_rHand[Left].m_source )\n    {\n        m_rHand[Left].m_bShowController = false;\n    }\n    if ( ulHideDevice == m_rHand[Right].m_source )\n    {\n        m_rHand[Right].m_bShowController = false;\n    }\n}\n\nfor ( EHand eHand = Left; eHand &lt;= Right; ((int&amp;)eHand)++ )\n{\n    vr::InputPoseActionData_t poseData;\n    if ( vr::VRInput()-&gt;GetPoseActionData( m_rHand[eHand].m_actionPose, vr::TrackingUniverseStanding, 0, &amp;poseData, sizeof( poseData ), vr::k_ulInvalidInputValueHandle ) != vr::VRInputError_None\n        || !poseData.bActive || !poseData.pose.bPoseIsValid )\n    {\n        m_rHand[eHand].m_bShowController = false;\n    }\n    else\n    {\n        m_rHand[eHand].m_rmat4Pose = ConvertSteamVRMatrixToMatrix4( poseData.pose.mDeviceToAbsoluteTracking );\n\n        vr::InputOriginInfo_t originInfo;\n        if ( vr::VRInput()-&gt;GetOriginTrackedDeviceInfo( poseData.activeOrigin, &amp;originInfo, sizeof( originInfo ) ) == vr::VRInputError_None \n            &amp;&amp; originInfo.trackedDeviceIndex != vr::k_unTrackedDeviceIndexInvalid )\n        {\n            std::string sRenderModelName = GetTrackedDeviceString( originInfo.trackedDeviceIndex, vr::Prop_RenderModelName_String );\n            if ( sRenderModelName != m_rHand[eHand].m_sRenderModelName )\n            {\n                m_rHand[eHand].m_pRenderModel = FindOrLoadRenderModel( sRenderModelName.c_str() );\n                m_rHand[eHand].m_sRenderModelName = sRenderModelName;\n            }\n        }\n    }\n}\n\nreturn bRet;\n</code></pre>\n\n<p>m_pHMD is initalized as follows:</p>\n\n<pre><code>vr::IVRSystem *m_pHMD;\n....\nm_pHMD = vr::VR_Init( &amp;eError, vr::VRApplication_Background );\n</code></pre>\n\n<p>I must be doing something wrong because in the following snippet, the if statement is passed only for the first four iterations, which should be a controller, the vive tracker, the headset and the lighthouses. This tells me that I am able to access these states, but I am somehow not able to read the information.</p>\n\n<pre><code>for (int i = 0; i &lt; 1000; i++) {\n    if (m_pHMD-&gt;GetControllerState(i, &amp;state, sizeof(state))) {\n        dprintf(\"%d\", i);\n            if (state.ulButtonPressed != 0 || state.unPacketNum != 0 || state.ulButtonTouched != 0) {\n                dprintf(\"Some action?\");\n            }\n    }\n</code></pre>\n\n<p>I can't imagine its a bug, so my guess is that my configuration is faulty, or I'm doing the wrong query. \nAny help is greatly appreciated!</p>\n"}, {"tags": ["c++", "qt", "layout", "qlayout", "qgroupbox"], "comments": [{"owner": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "edited": false, "score": 0, "creation_date": 1536154597, "post_id": 52183998, "comment_id": 91322701, "body": "you want to get rid of the red line? can you show us the code where you fill the box with the checkboxes?"}, {"owner": {"reputation": 686, "user_id": 1419127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/N9sv6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1419127/charles"}, "reply_to_user": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "edited": false, "score": 0, "creation_date": 1536155179, "post_id": 52183998, "comment_id": 91323110, "body": "In a way, yes, I want to get rid of the red line (which I drew myself on the screenshot). That is to say, if I were to draw it on the screenshot of the result I want, I would find no room to do so, because I want the misalignment to disappear."}, {"owner": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "edited": false, "score": 0, "creation_date": 1536156378, "post_id": 52183998, "comment_id": 91323955, "body": "ah ok, now i understand the question. So can you post the relevant code?"}, {"owner": {"reputation": 686, "user_id": 1419127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/N9sv6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1419127/charles"}, "reply_to_user": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "edited": false, "score": 0, "creation_date": 1536156781, "post_id": 52183998, "comment_id": 91324212, "body": "There is none, it&#39;s all via ui file - except to create the checkboxes inside the empty group. There all I do is addWidget on the layout of the groupBox with MinimumExpanding for size policy ... see edited post."}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 1419127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/N9sv6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1419127/charles"}, "edited": false, "score": 0, "creation_date": 1536157770, "post_id": 52187439, "comment_id": 91324855, "body": "What style to use then to get exactly the looks of a group box without a caption ?"}, {"owner": {"reputation": 686, "user_id": 1419127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/N9sv6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1419127/charles"}, "edited": false, "score": 0, "creation_date": 1536157874, "post_id": 52187439, "comment_id": 91324930, "body": "But that&#39;s definitely it though, thanks. I had not thought of that."}], "tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": true, "score": 4, "last_activity_date": 1536157280, "creation_date": 1536157280, "answer_id": 52187439, "question_id": 52183998, "link": "https://stackoverflow.com/questions/52183998/qt-gui-misaligned-things-in-groupbox-with-horizontal-layout/52187439#52187439", "title": "Qt GUI : misaligned things in groupBox with horizontal Layout", "body": "<p>Qt groupboxes leave some room on top, outside the frame, for the groupbox caption. To avoid that, if you don't need a caption, use a QFrame, instead. Newly created checkboxes inside the frame will keep their mutually exclusive beahviour.</p>\n"}], "owner": {"reputation": 686, "user_id": 1419127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/N9sv6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1419127/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 52187439, "answer_count": 1, "score": 1, "last_activity_date": 1536158130, "creation_date": 1536146672, "last_edit_date": 1536158130, "question_id": 52183998, "link": "https://stackoverflow.com/questions/52183998/qt-gui-misaligned-things-in-groupbox-with-horizontal-layout", "title": "Qt GUI : misaligned things in groupBox with horizontal Layout", "body": "<p>Very simple :</p>\n\n<p>Ui file : \n<a href=\"https://i.stack.imgur.com/hULTQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hULTQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Result :\n<a href=\"https://i.stack.imgur.com/vCcKt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vCcKt.png\" alt=\"enter image description here\"></a></p>\n\n<p>\"Scans to display\" is a groupBox with a horizontal layout which contains two elements :</p>\n\n<ul>\n<li>Left, a vertical layout with three radio buttons.</li>\n<li>Right, an empty group box.</li>\n</ul>\n\n<p>A red line (added manually on the screenshot) marks the misalignment between those two elements within the \"Scans to display\" group box.</p>\n\n<p>Of note : the empty groupBox on the right gets automatically filled with numbered checkboxes on startup, the number of which is only known then.</p>\n\n<p>What is going on ? What should I do ?</p>\n\n<p>PS : code to create some number of checkboxes inside the empty groupbox on the right :</p>\n\n<pre><code>m_historyButtons[i] = new QCheckBox();\nm_historyButtons[i]-&gt;setText(QString::number(i));\nm_historyButtons[i]-&gt;setObjectName(QString(\"m_pbDisplayEntry%1\").arg(i));\n\nQSizePolicy sizePolicy(QSizePolicy::MinimumExpanding, QSizePolicy::MinimumExpanding);\nsizePolicy.setHorizontalStretch(0);\nsizePolicy.setVerticalStretch(0);\nsizePolicy.setHeightForWidth(true);\nm_historyButtons[i]-&gt;setSizePolicy(sizePolicy);\n\n((QGridLayout*)(ui.m_groupBoxHistoryEntries-&gt;layout()))-&gt;addWidget(m_historyButtons[i], i/m_grid_width, i%m_grid_width);\n</code></pre>\n"}, {"tags": ["android", "c++", "cmake", "android-ndk", "java-native-interface"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1536147327, "post_id": 52183875, "comment_id": 91317915, "body": "During <code>cmake ...</code> invocation it should be output about toolchain is used, which compiler is used and so on. Is that output corresponds to the Android? You may add that output to the question post, so we can check it. BTW, in <code>CMakeLists.txt</code> it is very recommended to use <code>project(...)</code> call. While CMake may perform such call automatically, it may miss some specifics. Hint: If you want specify output directory for all static libraries, you may set <code>CMAKE_ARCHIVE_OUTPUT_DIRECTORY</code> variable instead of setting the property <code>ARCHIVE_OUTPUT_DIRECTORY</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 5913846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rD1Hv.jpg?s=128&g=1", "display_name": "ausan", "link": "https://stackoverflow.com/users/5913846/ausan"}, "is_accepted": true, "score": 3, "last_activity_date": 1536160754, "creation_date": 1536160754, "answer_id": 52188615, "question_id": 52183875, "link": "https://stackoverflow.com/questions/52183875/create-cmake-c-c-library-to-android-without-android-studio/52188615#52188615", "title": "Create (Cmake) C/C++ Library to Android without Android Studio", "body": "<p>Use cmake toolchain from ndk, not sdk:</p>\n\n<pre><code>cmake -DCMAKE_TOOLCHAIN_FILE= /Users/vcanato/Library/Android/sdk/ndk-bundle/build/cmake/android.toolchain.cmake  -DCMAKE_MAKE_PROGRAM= /Users/vcanato/Library/Android/sdk/ndk-bundle/ -DANDROID_ABI=\"arm64-v8a\"\n</code></pre>\n"}], "owner": {"reputation": 2094, "user_id": 3117650, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Yrzh5.jpg?s=128&g=1", "display_name": "Canato", "link": "https://stackoverflow.com/users/3117650/canato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1790, "favorite_count": 0, "accepted_answer_id": 52188615, "answer_count": 1, "score": 2, "last_activity_date": 1536160754, "creation_date": 1536146338, "question_id": 52183875, "link": "https://stackoverflow.com/questions/52183875/create-cmake-c-c-library-to-android-without-android-studio", "title": "Create (Cmake) C/C++ Library to Android without Android Studio", "body": "<p>My goal is create a external library made in C/C++ which I can import in my Android Project.</p>\n\n<p>I know how to <strong>import</strong>, I know how to <strong>create</strong> a library from C/C++ <strong>inside</strong> the project using JNI, Cmake, etc. But this is not my goal.</p>\n\n<p>For this I'm using small steps, first with a simple library:</p>\n\n<p><strong>gmath.c</strong></p>\n\n<pre><code>#include \"gmath.h\"\n\n#if defined(__GNUC__) &amp;&amp; __GNUC__ &gt;= 4\n#define GMATH_EXPORT __attribute__((visibility(\"default\")))\n#elif defined(__SUNPRO_C) &amp;&amp; (__SUNPRO_C &gt;= 0x590)\n#define GMATH_EXPORT __attribute__((visibility(\"default\")))\n#else\n#define GMATH_EXPORT\n#endif\n\nGMATH_EXPORT unsigned gpower(unsigned n) {\n    return 44;\n}\n</code></pre>\n\n<p><strong>gmath.h</strong></p>\n\n<pre><code>#ifndef __POWER_HPP__\n#define __POWER_HPP__\n/*\n * return pow(2, n)\n*/\n#ifdef __cplusplus\nextern \"C\"\n#endif // __cplusplus\n       unsigned gpower(unsigned n);\n\n#endif //__POWER_HPP__\n</code></pre>\n\n<p>What I'm using the create the library:\n<code>cmake \n-DCMAKE_TOOLCHAIN_FILE=\n/Users/vcanato/Library/Android/sdk/cmake/3.6.4111459/android.toolchain.cmake \n-DCMAKE_MAKE_PROGRAM=\n/Users/vcanato/Library/Android/sdk/ndk-bundle/ -DANDROID_ABI=\"arm64-v8a\"</code></p>\n\n<p><strong>CMake</strong></p>\n\n<pre><code>cmake_minimum_required(VERSION 3.4.1)\n\nset(CMAKE_VERBOSE_MAKEFILE on)\n\nset(CMAKE_TOOLCHAIN_FILE \"/Users/vcanato/Library/Android/sdk/cmake/3.6.4111459/android.toolchain.cmake\")\nset(ANDROID_NDK \"/Users/vcanato/Library/Android/sdk/ndk-bundle/\")\n\nadd_library(gmath STATIC src/gmath.c)\n\nset(distribution_DIR \"${CMAKE_CURRENT_SOURCE_DIR}/../../../../../distribution\")\nset_target_properties(gmath\n                  PROPERTIES\n                  ARCHIVE_OUTPUT_DIRECTORY\n                  \"${distribution_DIR}/gmath/lib/${ANDROID_ABI}\")\n</code></pre>\n\n<p>The problem is, when I use the <code>lipo -info libgmath.a</code>by terminal it show a different ABI:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cT1Fi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cT1Fi.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>How can I build this external library to android using the rights parameters?</strong></p>\n"}, {"tags": ["c++", "templates", "compiler-errors", "g++"], "owner": {"reputation": 277, "user_id": 6595955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cxPAj.png?s=128&g=1", "display_name": "HolgerBarlt", "link": "https://stackoverflow.com/users/6595955/holgerbarlt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1536146381, "answer_count": 0, "score": 1, "last_activity_date": 1536146169, "creation_date": 1536146169, "question_id": 52183808, "link": "https://stackoverflow.com/questions/52183808/new-to-c-and-i-get-compiler-error-when-using-template-function", "closed_reason": "Duplicate", "title": "New to C++ and I get compiler error when using template function", "body": "<p>I'm quite new to C++ programming and it seams that I have fundamental problems in understanding how the compiling and linking works. Here is my Minimum example:\nI have thre files a.hpp, a.cpp and b.cpp.</p>\n\n<p>a.hpp:</p>\n\n<pre><code>namespace A {\n   template&lt;typename T&gt;\n   double helpA(T t1,T t2);\n}\n</code></pre>\n\n<p>a.cpp:</p>\n\n<pre><code>#include \"a.hpp\"\nnamespace A {\n   template&lt;typename T&gt;\n   double helpA(T t1, T t2){\n      return(t1 +t2);\n   }\n}\n</code></pre>\n\n<p>b.cpp (main)                                                                        </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"a.hpp\"\n\n\nint main (int argc, char *argv[]){\n\n        double t = A::helpA(1.0,2.3);\n        std::cout &lt;&lt; t &lt;&lt; \"\\n\";\n\n}\n</code></pre>\n\n<p>When I now try to compile the Thing by calling</p>\n\n<pre><code>g++ b.cpp a.cpp\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>b.cpp:(.text+0x24): undefined reference to `double A::helpA&lt;double&gt;(double, double)' \ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Every help is appriciated</p>\n"}, {"tags": ["c++", "initializer-list"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 3, "creation_date": 1536146250, "post_id": 52183608, "comment_id": 91317285, "body": "When you say &quot;programatically&quot;, do you mean &quot;of a runtime-defined length&quot;?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536146295, "post_id": 52183608, "comment_id": 91317307, "body": "Not clear what is the problem. <code>std::initializer_list&lt;int&gt; list{1,2,3};</code> what did you try?"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1536149855, "post_id": 52183608, "comment_id": 91319578, "body": "@RichardHodges Yes. Sorry I didn&#39;t make that clear.  I&#39;m actually wrapping the C++ function for Java."}], "answers": [{"tags": [], "owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "is_accepted": false, "score": 0, "last_activity_date": 1536146687, "last_edit_date": 1536146687, "creation_date": 1536146197, "answer_id": 52183816, "question_id": 52183608, "link": "https://stackoverflow.com/questions/52183608/is-it-possible-to-programmatically-construct-a-stdinitializer-list/52183816#52183816", "title": "Is it possible to programmatically construct a std::initializer_list?", "body": "<pre><code>void test() {\n  double d1 = 1.1;\n  double d2 = 2.2;\n  double d3 = 3.3;\n  std::initializer_list&lt;int&gt; init_list{ static_cast&lt;int&gt;(d1), static_cast&lt;int&gt;(d2), static_cast&lt;int&gt;(d3) };\n}\n</code></pre>\n\n<p>So you can, but for fixed sized lists only.</p>\n"}, {"comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1536147536, "post_id": 52184175, "comment_id": 91318051, "body": "Do tell more stories."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 3, "creation_date": 1536147628, "post_id": 52184175, "comment_id": 91318117, "body": "@SombreroChicken - I&#39;m thinking of changing my user handle. Whenever someone leaves such a comment, I can&#39;t tell if they <i>like</i> what I wrote, or are telling me I&#39;m misleading people."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1536147684, "post_id": 52184175, "comment_id": 91318151, "body": "Haha. I quite like your handle, I was just messing around as usual. I like what you wrote, don&#39;t worry. When are you writing a novel? That&#39;d truly be about stories. Not just answers."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1536147867, "post_id": 52184175, "comment_id": 91318267, "body": "@SombreroChicken - Probably when I&#39;ll be done with this software development side gig :P"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536149719, "post_id": 52184175, "comment_id": 91319498, "body": "You certainly <i>can</i> instantiate your own <code>std::initializer_list</code> (and populate it, ironically, by list-initialization) but it&#39;s not particularly useful."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536150046, "post_id": 52184175, "comment_id": 91319703, "body": "@LightnessRacesinOrbit - Well, I was thinking that &quot;<i>when doing list initialization</i>&quot; would cover that too. How can the answer be improved?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536150272, "post_id": 52184175, "comment_id": 91319854, "body": "By removing the lies? ;)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536150299, "post_id": 52184175, "comment_id": 91319875, "body": "Nah it&#39;s fine - I guess you can only <i>directly</i> default-construct a <code>std::initializer_list</code> which is pointless. But in practice we can consider the sort of code that darune shows to be perfectly &quot;the programmer did it&quot;, and your answer seems to suggest that such things wouldn&#39;t be possible or somehow rely on extensions. I get that you&#39;re not <i>actually</i> saying that."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1536147293, "creation_date": 1536147293, "answer_id": 52184175, "question_id": 52183608, "link": "https://stackoverflow.com/questions/52183608/is-it-possible-to-programmatically-construct-a-stdinitializer-list/52184175#52184175", "title": "Is it possible to programmatically construct a std::initializer_list?", "body": "<p>There is no way in standard C++. <code>std::initializer_list</code> is a language support type. It exists to make it possible for us to use a language construct (list initialization). </p>\n\n<p>As such, it's only the implementation that can create them, and an implementation is only required to do so when doing list initialization. Your implementation may offer an extension that allows their creation, but that is unlikely to result in standard code.</p>\n"}], "owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 52184175, "answer_count": 2, "score": 2, "last_activity_date": 1536147293, "creation_date": 1536145538, "question_id": 52183608, "link": "https://stackoverflow.com/questions/52183608/is-it-possible-to-programmatically-construct-a-stdinitializer-list", "title": "Is it possible to programmatically construct a std::initializer_list?", "body": "<p>I am wrapping a C++ fn of the form </p>\n\n<pre><code>foo(input, std::initializer_list&lt;Option&gt; options);\n</code></pre>\n\n<p>I need to construct a list of options from data in another format, and pass them into <code>foo</code>. <a href=\"https://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"nofollow noreferrer\">I can't see</a> a way of constructing a <code>std::initializer_list</code>  programmatically \u2013 is this right?  (It would make sense if  one was forced to use a more standard container, but I would like to check before re-factoring.)</p>\n"}, {"tags": ["c++", "data-conversion"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 4, "creation_date": 1536145614, "post_id": 52183582, "comment_id": 91316905, "body": "What does &quot;divided by a non-alpha char&quot; mean? The <code>vector&lt;string&gt;</code> is already divided into strings."}, {"owner": {"reputation": 334, "user_id": 3429661, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DvaaJ.jpg?s=128&g=1", "display_name": "malle", "link": "https://stackoverflow.com/users/3429661/malle"}, "edited": false, "score": 0, "creation_date": 1536146036, "post_id": 52183582, "comment_id": 91317156, "body": "The test requires a const char* const* !"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1536146294, "post_id": 52183582, "comment_id": 91317306, "body": "Are you sure about &quot;divided by a non-alpha char&quot;? Normally you don&#39;t need any extra division, in addition to null-terminating your strings."}], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1536146362, "creation_date": 1536146362, "answer_id": 52183884, "question_id": 52183582, "link": "https://stackoverflow.com/questions/52183582/how-do-i-convert-a-vectorstring-to-a-const-char-const-in-c/52183884#52183884", "title": "How do I convert a vector&lt;string&gt; to a const char* const* in c++?", "body": "<p>Seems easy enough</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;functional&gt;\n\n// ...\n\nstd::vector&lt;char const*&gt; result_owner(Words.size());\nstd::transform(begin(Words), end(Words), begin(result_owner), \n               std::mem_fn(&amp;std::string::c_str));\n\nconst char* const* Result = result_owner.data();\n</code></pre>\n\n<p>Just because <code>Result</code> must provide a const view of the buffer, doesn't mean the buffer has to really be const itself. So it's just another vector that we obtain by projecting <code>Words</code> on the <code>std::string::c_str</code> member.</p>\n\n<p>After that <code>Result</code> can simply be another reference to <code>result_owner.data();</code>.</p>\n\n<p>This of course assumes that <code>Result</code> doesn't have to <em>own</em> the buffer it points at. Owning raw pointers are best avoided.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 6, "last_activity_date": 1536157202, "last_edit_date": 1536157202, "creation_date": 1536146384, "answer_id": 52183892, "question_id": 52183582, "link": "https://stackoverflow.com/questions/52183582/how-do-i-convert-a-vectorstring-to-a-const-char-const-in-c/52183892#52183892", "title": "How do I convert a vector&lt;string&gt; to a const char* const* in c++?", "body": "<p>You cannot meaningfully convert one to the other. However, you can convert an array of <code>std::string</code> into an array of pointers to char, and a pointer to the first element of such array would be compatible with your desired result:</p>\n\n<pre><code>std::vector&lt;const char*&gt; Ptrs;\nstd::transform(\n    std::cbegin(Words), std::cend(Words),\n    std::back_inserter(Ptrs),\n    [](auto&amp; str)  { return str.c_str(); }\n);\nconst char* const* Result = Ptrs.data();\n</code></pre>\n\n<p>Just remember that the strings themselves are still stored in the <code>std::string</code> objects and those pointers within the new vector are only valid as long as the strings in the original vector exist, aren't resized, and the original vector itself isn't resized.</p>\n\n<p>And the pointer to first element of the new vector is only valid as long as that vector exists and isn't resized.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1536147366, "post_id": 52184123, "comment_id": 91317942, "body": "Have a +1 for the sheer audacity :D"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1536156807, "post_id": 52184123, "comment_id": 91324232, "body": "Callers responsibility to do a <code>free(Result);</code> when done using Result."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1536157123, "post_id": 52184123, "comment_id": 91324429, "body": "@Eljay not only <code>Result</code> but <code>Result[i]</code> for each <code>i</code> as well."}], "tags": [], "owner": {"reputation": 3212, "user_id": 3357352, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/nfb7n.jpg?s=128&g=1", "display_name": "OrenIshShalom", "link": "https://stackoverflow.com/users/3357352/orenishshalom"}, "is_accepted": false, "score": 4, "last_activity_date": 1536147144, "creation_date": 1536147144, "answer_id": 52184123, "question_id": 52183582, "link": "https://stackoverflow.com/questions/52183582/how-do-i-convert-a-vectorstring-to-a-const-char-const-in-c/52184123#52184123", "title": "How do I convert a vector&lt;string&gt; to a const char* const* in c++?", "body": "<p>And the caveman way to do it :)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;string.h&gt;\nusing namespace std;\n\nchar **foo(const vector&lt;string&gt; &amp;vec_of_strings)\n{\n    int num_strings = vec_of_strings.size();\n    int max_str_len = 0;\n\n    for (int i=0;i&lt;num_strings;i++)\n    {\n        if (max_str_len &lt; vec_of_strings[i].length()) {\n            max_str_len = vec_of_strings[i].length();\n        }\n    }\n\n    // for null termination ...\n    max_str_len++;\n\n    char **result = (char **) malloc(num_strings);\n\n    for (int i=0;i&lt;num_strings;i++)\n    {\n        result[i] = (char *) malloc(max_str_len);\n        strcpy(result[i],vec_of_strings[i].c_str());\n    }\n    return result;\n}\n\nint main(int argc, char **argv)\n{\n    vector&lt;string&gt; vec_of_strings;\n\n    vec_of_strings.push_back(\"Long\");\n    vec_of_strings.push_back(\"Livvvvvvvve\");\n    vec_of_strings.push_back(\"The\");\n    vec_of_strings.push_back(\"King\");\n\n    const char * const * Result = foo(vec_of_strings);\n\n    for (int i=0;i&lt;4;i++)\n    {\n        printf(\"%s\\n\",Result[i]);\n    }\n}   \n</code></pre>\n"}], "owner": {"reputation": 334, "user_id": 3429661, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DvaaJ.jpg?s=128&g=1", "display_name": "malle", "link": "https://stackoverflow.com/users/3429661/malle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 52183892, "answer_count": 3, "score": 3, "last_activity_date": 1536157202, "creation_date": 1536145464, "last_edit_date": 1536146343, "question_id": 52183582, "link": "https://stackoverflow.com/questions/52183582/how-do-i-convert-a-vectorstring-to-a-const-char-const-in-c", "title": "How do I convert a vector&lt;string&gt; to a const char* const* in c++?", "body": "<p>I am trying to convert data into the right format for a specific unit test.\nThe task is to mine a set of words, the unit tests will make sure the results are correct. I have no access to the unit tests, just the declaration which takes a  const char* const* Result.</p>\n\n<p>So I need to get my </p>\n\n<pre><code>std::vector&lt;string&gt; Words; \n</code></pre>\n\n<p>to </p>\n\n<pre><code>const char* const* Result;\n</code></pre>\n\n<p>divided by a non-alpha char (for example space). </p>\n\n<p>I am aware that this is a constant pointer to a constant character, so I am not sure what to do here since they both constant? </p>\n\n<p>Any pointers (word pun not really intended) are appreciated! </p>\n"}, {"tags": ["c++", "gcc", "g++", "mingw"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1536149056, "post_id": 52183515, "comment_id": 91319076, "body": "have you tried using gcc outside visual studio code? does <code>g++.exe</code> exist in the <code>C:\\MinGW\\bin</code> directory?"}, {"owner": {"reputation": 197, "user_id": 8076266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5L8gQ.jpg?s=128&g=1", "display_name": "Dimen", "link": "https://stackoverflow.com/users/8076266/dimen"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1536156081, "post_id": 52183515, "comment_id": 91323766, "body": "@AlanBirtles Yes but the same error occurs. There is g++.exe in the C:\\MinGW\\bin and typing gcc -v or g++ -v in command prompt works"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1536163475, "post_id": 52183515, "comment_id": 91328459, "body": "If it fails outside visual studio code then I suggest you simplify your question by removing all reference to vs-code and just show the gcc commands that are failing"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1536165533, "post_id": 52183515, "comment_id": 91329492, "body": "How exactly did you install MinGW? Which installer (if any did you use) and which options did you select?"}, {"owner": {"reputation": 197, "user_id": 8076266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5L8gQ.jpg?s=128&g=1", "display_name": "Dimen", "link": "https://stackoverflow.com/users/8076266/dimen"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1536208201, "post_id": 52183515, "comment_id": 91342252, "body": "@AlanBirtles I used MinGW installation manager and selected mingw-developer-toolkit, mingw32-base, mingw32-gcc-g++ and msys-base. I am using administrator account, if that&#39;s necessary."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1536217161, "post_id": 52183515, "comment_id": 91345533, "body": "sounds like something went wrong, try re-installing"}, {"owner": {"reputation": 197, "user_id": 8076266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5L8gQ.jpg?s=128&g=1", "display_name": "Dimen", "link": "https://stackoverflow.com/users/8076266/dimen"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1536223268, "post_id": 52183515, "comment_id": 91348887, "body": "@AlanBirtles Yes, re-installing solved the issue. I am still not sure what the problem was but thank you for your help :)"}], "answers": [{"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 0, "last_activity_date": 1536224437, "creation_date": 1536224437, "answer_id": 52200339, "question_id": 52183515, "link": "https://stackoverflow.com/questions/52183515/gcc-cannot-find-lgcc-g-exe-error-createprocess-no-such-file-or-directory/52200339#52200339", "title": "gcc cannot find -lgcc, g++.exe: error: CreateProcess: No such file or directory", "body": "<p>It seems like MinGW wasn't installed correctly.</p>\n\n<p>Re-installing it will likely fix the issue.</p>\n"}], "owner": {"reputation": 197, "user_id": 8076266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5L8gQ.jpg?s=128&g=1", "display_name": "Dimen", "link": "https://stackoverflow.com/users/8076266/dimen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 1, "accepted_answer_id": 52200339, "answer_count": 1, "score": 0, "last_activity_date": 1536224437, "creation_date": 1536145252, "last_edit_date": 1536165359, "question_id": 52183515, "link": "https://stackoverflow.com/questions/52183515/gcc-cannot-find-lgcc-g-exe-error-createprocess-no-such-file-or-directory", "title": "gcc cannot find -lgcc, g++.exe: error: CreateProcess: No such file or directory", "body": "<p>I'm trying to use MingGW on Windows but when I try to compile my c/c++ files, following error occurs when I compile with C(gcc)</p>\n\n<pre><code>&gt; gcc c:\\Users\\Administrator\\Desktop\\C_C++\\helloworld\\hello.c - o c:\\Users\\Administrator\\Desktop\\C_C++\\helloworld/hello\n\nc:/mingw/bin/../lib/gcc/mingw32/6.3.0/../../../../mingw32/bin/ld.exe: cannot find -lgcc\nc:/mingw/bin/../lib/gcc/mingw32/6.3.0/../../../../mingw32/bin/ld.exe: cannot find -lgcc_eh\nc:/mingw/bin/../lib/gcc/mingw32/6.3.0/../../../../mingw32/bin/ld.exe: cannot find -lgcc\nc:/mingw/bin/../lib/gcc/mingw32/6.3.0/../../../../mingw32/bin/ld.exe: cannot find -lgcc_eh\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>and following error occurs when I compile with C++(g++)</p>\n\n<pre><code>&gt; g++ c:\\Users\\Administrator\\Desktop\\C_C++\\helloworldcpp\\hello.cpp -o c:\\Users\\Administrator\\Desktop\\C_C++\\helloworldcpp/hello\n\ng++.exe: error: CreateProcess: No such file or directory\n</code></pre>\n\n<p>The path variable is <em>C:\\MinGW\\bin</em> . I've downloaded mingw-developer-toolkit, mingw32-base, mingw32-gcc-g++ and msys-base among the basic setup packages. Also I'm getting #include error for iostream. I've tried almost all of the methods out in the internet but couldn't fix.</p>\n"}, {"tags": ["c++", "class"], "comments": [{"owner": {"reputation": 3990, "user_id": 6095394, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e512acda63343ac20eedd20c3964911?s=128&d=identicon&r=PG&f=1", "display_name": "pschill", "link": "https://stackoverflow.com/users/6095394/pschill"}, "edited": false, "score": 0, "creation_date": 1536144577, "post_id": 52183280, "comment_id": 91316282, "body": "What command did you use to compile?"}, {"owner": {"reputation": 528, "user_id": 3083333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aea2d9f71f42d8984a03edcd0b7b918?s=128&d=identicon&r=PG", "display_name": "garlix", "link": "https://stackoverflow.com/users/3083333/garlix"}, "edited": false, "score": 0, "creation_date": 1536144603, "post_id": 52183280, "comment_id": 91316300, "body": "How you compile it?"}, {"owner": {"reputation": 9, "user_id": 9465221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b8624eee73db5cef0db45512c61ea0?s=128&d=identicon&r=PG&f=1", "display_name": "CWhite", "link": "https://stackoverflow.com/users/9465221/cwhite"}, "edited": false, "score": 0, "creation_date": 1536144825, "post_id": 52183280, "comment_id": 91316435, "body": "I wrote it in codeblocks, so whatever basic compiler that comes with is what I used."}, {"owner": {"reputation": 9, "user_id": 9465221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b8624eee73db5cef0db45512c61ea0?s=128&d=identicon&r=PG&f=1", "display_name": "CWhite", "link": "https://stackoverflow.com/users/9465221/cwhite"}, "edited": false, "score": 0, "creation_date": 1536145068, "post_id": 52183280, "comment_id": 91316589, "body": "I compiled it all from main"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1536145619, "post_id": 52183280, "comment_id": 91316910, "body": "This is a common pitfall when trying to learn programming using some pretty little GUI, with many little buttons and menus that attempt to hide all the complexity and dress it up in pretty little colors, and hide the actual, dirty, low-down mechanics beneath a layer of makeup. You don&#39;t really understand what happens. But if one were to actually get down to a shell prompt, and learn how to run the compiler yourself, one would immediately acquire a direct, first-hand knowledge of what really happens when compiling a program that consists of multiple translation modules, and linking it together."}], "owner": {"reputation": 9, "user_id": 9465221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b8624eee73db5cef0db45512c61ea0?s=128&d=identicon&r=PG&f=1", "display_name": "CWhite", "link": "https://stackoverflow.com/users/9465221/cwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1536144587, "answer_count": 0, "score": 0, "last_activity_date": 1536144450, "creation_date": 1536144450, "question_id": 52183280, "link": "https://stackoverflow.com/questions/52183280/undefined-reference-to-personperson", "closed_reason": "Duplicate", "title": "undefined reference to `person::person()&#39;", "body": "<p>Using the exact same code as my professor I get an error. The error is \"undefined reference to 'person::person()'. He can compile it fine, but I can not.</p>\n\n<pre><code>// person.h\n\n#ifndef PERSON_H\n#define PERSON_H\n\n#include &lt;string&gt;\nusing namespace std;\n\nclass person\n{\nprivate:\n    string name;\n    int age;\npublic:\n    person();\n    string get_name();\n    int get_age();\n};\n\n#endif // PERSON_H\n\n\n\n// person.cpp\n\n#include \"person.h\"\n\nperson::person()\n{\n    name = \"no name\";\n    age = -1;\n}\n\nstring person::get_name()\n{\n    return name;\n}\n\nint person::get_age()\n{\n    return age;\n}\n\n\n\n// main.cpp\n\n#include &lt;iostream&gt;\n#include &lt;cassert&gt;\nusing namespace std;\n\n#include \"person.h\"\n\nint main()\n{\n    person p1;\n    assert(p1.get_name() == \"no name\");\n    assert(p1.get_age() == -1);\n\n    return 0;\n}\n</code></pre>\n\n<p>Like I said, this is my professors code and for him it compiles fine. Thanks for your time!</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 1, "last_activity_date": 1536144479, "creation_date": 1536144479, "answer_id": 52183285, "question_id": 52183033, "link": "https://stackoverflow.com/questions/52183033/disabling-the-effect-of-glibcxx-debug-for-a-specific-variable/52183285#52183285", "title": "Disabling the effect of _GLIBCXX_DEBUG for a specific variable", "body": "<p>you can <code>#undef _GLIBCXX_DEBUG</code> before using the <code>#include&lt;vector&gt;</code> in your main program.</p>\n\n<p>Just to be sure I would declare a non template class inheriting <code>std::vector&lt;char&gt;</code> in which you use the <code>#undef _GLIBCXX_DEBUG</code> trick and use the instance of this class to pass data to libB.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536145161, "post_id": 52183462, "comment_id": 91316652, "body": "Is this definitely safe? Intuitively I&#39;d expect this to be a sort of &quot;UB&quot; from the runtime&#39;s perspective, mixing flags like that. Mind you, I guess it has to support this in order to avoid insane constraints on what things you can link together. Though if that were the case then the OP wouldn&#39;t have a problem in the first place. Meh"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536145923, "post_id": 52183462, "comment_id": 91317098, "body": "It&#39;s indeed technically UB, and a reasonable implementation might have some <code>std::vector</code> methods precompiled in its CRT. You can see how that might break. But it&#39;s pretty much UB from the start, given that you have two vector definitions in the program at large."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 1, "last_activity_date": 1536145074, "creation_date": 1536145074, "answer_id": 52183462, "question_id": 52183033, "link": "https://stackoverflow.com/questions/52183033/disabling-the-effect-of-glibcxx-debug-for-a-specific-variable/52183462#52183462", "title": "Disabling the effect of _GLIBCXX_DEBUG for a specific variable", "body": "<p>It's probably most robust to create a <code>void* createNDebugVec(char const* begin, char const* end);</code> function, and put that in its own .cpp file. In that .cpp file, explicitly <code>#undef GLIBCXX_DEBUG</code> before including anything. This allows you to create a non-debug <code>std::vector</code> and return it pre-cast to <code>void*</code>. You'll probably need a matching <code>void destroyNDebugVec(void*);</code>.</p>\n\n<p>Note that <code>void* createNDebugVec(std::vector&lt;char&gt; const&amp; src);</code> won't work, for essentiall the same reason.  </p>\n"}], "owner": {"reputation": 5281, "user_id": 1028138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/cacbc58817a6b78919f4a44e8d269b15?s=128&d=identicon&r=PG", "display_name": "sunmat", "link": "https://stackoverflow.com/users/1028138/sunmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 52183462, "answer_count": 2, "score": 1, "last_activity_date": 1536145074, "creation_date": 1536143709, "question_id": 52183033, "link": "https://stackoverflow.com/questions/52183033/disabling-the-effect-of-glibcxx-debug-for-a-specific-variable", "title": "Disabling the effect of _GLIBCXX_DEBUG for a specific variable", "body": "<p>If a C++ program is compiled with <code>-D_GLIBCXX_DEBUG</code>, is there a way to specify in its source code that for a specific variable of type <code>std::vector</code> I DO NOT want the \"debug\" version of this class but the \"normal\" version instead?</p>\n\n<p>My use-case is the following:</p>\n\n<p>I have a C library (which I will call <code>libA</code>) and a C++ library (which I will call <code>libB</code>) presenting a C interface. Those libraries haven't been compiled with <code>-D_GLIBCXX_DEBUG</code>. The main program (which is compiled with <code>-D_GLIBCXX_DEBUG</code>) must call a function of <code>libA</code> and pass it an <code>std::vector&lt;char&gt;*</code> converted into a <code>void*</code>. <code>libA</code> calls a <code>libB</code> function that is given the <code>void*</code> and casts it back into an <code>std::vector&lt;char&gt;*</code> to use it (oh the joy of passing C++ data through a C layer...). Since the main program is compiled with <code>-D_GLIBCXX_DEBUG</code> but <code>libB</code> isn't, the <code>std::vector&lt;char&gt;</code> class in the main program and in <code>libB</code> actually have a different implementation, which leads to errors. </p>\n"}, {"tags": ["c++", "compiler-errors", "linker-errors", "static-linking"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1536144692, "post_id": 52182961, "comment_id": 91316343, "body": "The way you&#39;re described it, when compiling files separately you&#39;re not linking in the static libraries.  It is necessary to link in the static libraries, preferably by listing them at the end of the command line (since that will ensure all object files can resolve calls into the library).     It is not necessary to include libraries when compiling individually, but is when linking them together."}, {"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1536144735, "post_id": 52182961, "comment_id": 91316383, "body": "you need to include the libraries when creating the executable: <code>g++ your_object_files.o -o FILE $(LIBS)</code>"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 1, "creation_date": 1536145838, "post_id": 52182961, "comment_id": 91317038, "body": "passing linker flags to <code>g++ -c</code> does nothing. You need to specify them when you&#39;re linking everything together, as @MikevanDyke said."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1536149224, "post_id": 52182961, "comment_id": 91319181, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 311, "user_id": 8401696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Hqt3.png?s=128&g=1", "display_name": "resolritter", "link": "https://stackoverflow.com/users/8401696/resolritter"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1536203706, "post_id": 52182961, "comment_id": 91341415, "body": "Thank you for your advice! Following your tips, I was able to compile them together after putting the linking options <b>at the end</b> of the command instead. And as @Botje noticed, the linker flags aren&#39;t useful for generating each individual file object, only the path includes; so I went ahead and removed that. Now it works."}], "owner": {"reputation": 311, "user_id": 8401696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Hqt3.png?s=128&g=1", "display_name": "resolritter", "link": "https://stackoverflow.com/users/8401696/resolritter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536143437, "creation_date": 1536143437, "question_id": 52182961, "link": "https://stackoverflow.com/questions/52182961/source-code-files-compiles-to-object-files-individually-but-the-object-files-do", "title": "Source code files compiles to object files individually, but the object files don&#39;t compile together", "body": "<p>I have a C++ project which uses multiple external static libraries and a huge code base.</p>\n\n<p>If I put it all together like this:</p>\n\n<pre><code>g++ (ALL INCLUDE PATHS) (FLAGS) (ALL LIBRARIES) (ALL SOURCES) -o FILE\n</code></pre>\n\n<p><strong>All at once in the same command, it works.</strong></p>\n\n<hr>\n\n<p>However I want to use a Makefile to generate file objects and speed up the compiling process.</p>\n\n<p>I am able to generate a object file for each individual source file, but when trying to put them all together like this:</p>\n\n<pre><code>g++ -o FILE (ALL OBJECT FILES FOUND RECURSIVELY IN THE PATH)\n</code></pre>\n\n<p>I get the following errors, as if they had not been compiled with the static libraries</p>\n\n<pre><code>Linux_Release/.compilation_libs/linux.o: In function `WndProc(int, int, int)':\nmain_Linux.cpp:(.text+0xc6): undefined reference to `XRefreshKeyboardMapping'\nmain_Linux.cpp:(.text+0x18c): undefined reference to `XLookupKeysym'\nmain_Linux.cpp:(.text+0x20b): undefined reference to `Xutf8LookupString'\n...\n</code></pre>\n\n<p>I've tried to put the includes/flags/libraries back into the command once again, but it doesn't make a difference.</p>\n\n<p>Here are the flags I'm using for compiling each source file individually:</p>\n\n<blockquote>\n  <p>CFLAGS := -fmessage-length=0 -std=c++11 -Wno-sign-compare\n  -Wno-unused-local-typedefs -Wno-reorder -Wno-switch -fpermissive -static-libstdc++ -static-libgc\n       c -Wl,-rpath=.</p>\n</blockquote>\n\n<p>And here are some of the libs included in the command above</p>\n\n<blockquote>\n  <p>LIBS := -lcurl -lz -lX11 -lXi -lGL -lGLU -lGLEW -lfreetype -lbass -lbass_fx -lOpenCL (and more...)</p>\n</blockquote>\n\n<p>And the target for building each file object looks like this:</p>\n\n<blockquote>\n  <p>$(COMPILATION_LIBS_FOLDER)/%.o: %.cpp<br>\n  mkdir -p '$(@D)'<br>\n  g++ $(CFLAGS) $(FIXED_INCLUDES) $(LIBPATH) $(LIBS) -c $&lt; -o $@</p>\n</blockquote>\n"}, {"tags": ["c++", "c++17", "visitor-pattern", "multiple-dispatch"], "comments": [{"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1536143865, "post_id": 52182938, "comment_id": 91315866, "body": "Note: <code>Base</code> should have <code>virtual ~Base()</code>."}, {"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 0, "creation_date": 1536144965, "post_id": 52182938, "comment_id": 91316533, "body": "purpose of visitor class is to perform action with class which called its overloaded method (in your case <code>visit</code>) with <code>*this</code> as an argument. So your general description of Visitor is useless, because you need two instances of class. A possible solution might be a visitor Compare, which would take reference to a second class as an argument on construction, though I not sure if visitor pattern is beneficial here. Another variant is to design a custom accept\\visitor dispatcher  in base class, which would take <code>Base*</code> as an argument and perform comparison."}, {"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 0, "creation_date": 1536145343, "post_id": 52182938, "comment_id": 91316746, "body": "it could be an <code>operator==</code> :P"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536145836, "post_id": 52182938, "comment_id": 91317037, "body": "&quot;If the nodes have different types, they are not equal.&quot; This violates LSP and so isn&#39;t really OO-style polymorphism."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536147602, "post_id": 52182938, "comment_id": 91318097, "body": "@n.m. how? the operation is &quot;are these trees equal&quot;. It&#39;s entirely expected that different values are unequal"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536147798, "post_id": 52182938, "comment_id": 91318228, "body": "@Caleth Say &quot;triangle&quot; and &quot;coloured triangle&quot; are different types, but LSP suggests that two such triangles with equal vertices should be equal."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536147977, "post_id": 52182938, "comment_id": 91318339, "body": "@n.m. no it doesn&#39;t. And even if it did, the <i>value</i> of an <code>A</code> object is always unequal to the <i>value</i> of a <code>B</code> or <code>C</code> object <i>in this case</i>"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536148120, "post_id": 52182938, "comment_id": 91318454, "body": "@n.m. you might define an equivalence relation for &quot;triangle&quot; and &quot;coloured triangle&quot;, where the base is not abstract, but this case is more like &quot;triangle&quot;, &quot;rectangle&quot;, &quot;circle&quot;. <i>by definition</i> the vertices are unequal collections"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536149006, "post_id": 52182938, "comment_id": 91319049, "body": "@Caleth &quot;no it doesn&#39;t&quot; I cannot agree with this. If you can guarantee that an object of a concrete class is never compared with an object of its subclass, then it&#39;s possible define comparison that meets the requirement and is LSP compliant. Otherwise, no."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536152047, "post_id": 52182938, "comment_id": 91320955, "body": "@n.m. We aren&#39;t discussing subclasses of concrete classes. All the concrete classes here are <code>final</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536153942, "post_id": 52182938, "comment_id": 91322289, "body": "@Caleth OK so in this special case it is possible."}], "answers": [{"comments": [{"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536145964, "post_id": 52183630, "comment_id": 91317119, "body": "Interesting. I wonder if <code>AEqualVisitor</code> can become <code>EqualVisitor&lt;Node&gt;</code> somehow"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536146482, "post_id": 52183630, "comment_id": 91317414, "body": "@Kerndog73 on second thought, not easily. I don&#39;t think you can have a template member override a base class&#39;s virtual member"}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536146568, "post_id": 52183630, "comment_id": 91317455, "body": "Hmm... I think I&#39;ll have a play around with this"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536146769, "post_id": 52183630, "comment_id": 91317560, "body": "If you made the <code>accept</code>s templates, you could drop the <code>Visitor</code> class, and then it would work fine to just call <code>vistor.visit(*this);</code>. You swap an interface for a concept"}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536146957, "post_id": 52183630, "comment_id": 91317695, "body": "I&#39;m not quite sure what you mean. At some point you would need to do a virtual call or a dynamic cast."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536147083, "post_id": 52183630, "comment_id": 91317764, "body": "Nope, you just assume that the type deduced for <code>template &lt;typename Visitor&gt;</code> has a member <code>visit</code> that can be called with an <code>A</code>, <code>B</code> or <code>C</code>. see <a href=\"https://en.cppreference.com/w/cpp/utility/variant/visit\" rel=\"nofollow noreferrer\"><code>std::visit</code></a> (which uses <code>operator()</code> as the member to call)"}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536147251, "post_id": 52183630, "comment_id": 91317865, "body": "Could you update your answer with an example? It almost sounds like you&#39;re getting the runtime type at compile-time."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536147439, "post_id": 52183630, "comment_id": 91317989, "body": "I&#39;m not sure it&#39;s worth it. You still need <code>RhsVisitor</code> to declare all the required <code>visit</code>s, because you need the runtime polymorphism in <code>LhsVisitor</code>"}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536150743, "post_id": 52183630, "comment_id": 91320152, "body": "I ended up using an approach very similar to this. I used LhsVisitor to get the type of the left node. Then I passed the type as a template parameter to RhsVisitor&lt;LeftType&gt; which gets the type of the right node. The visit method of RhsVisitor calls equalNode. There is a templated overload of equalNode which returns false if the given types are different. I think I see what you mean by templating the accept methods because the bodies of the visit methods for each type are identical. I used macros to handle to duplication but I think there\u2019s a way to use templates instead."}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536150970, "post_id": 52183630, "comment_id": 91320288, "body": "I\u2019ll except this answer (because it\u2019s the solution I\u2019m using) in 24 hours (to give others a chance to suggest a better solution). I know that saying \u201cthank you\u201d is frowned upon here but I have to say it! Thank you @Caleth, this discussion was very helpful"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 1, "last_activity_date": 1536146319, "last_edit_date": 1536146319, "creation_date": 1536145606, "answer_id": 52183630, "question_id": 52182938, "link": "https://stackoverflow.com/questions/52182938/elegantly-comparing-polymorphic-trees-in-c/52183630#52183630", "title": "Elegantly comparing polymorphic trees in C++", "body": "<p>Something like</p>\n\n<pre><code>struct RhsVisitor : public Visitor\n{\n    bool result;\n};\n\nstruct AEqualVisitor : public RhsVisitor\n{\n    void visit(const A &amp; rhs) override { result = equalNode(lhs, rhs); }\n    void visit(const B &amp;) override { result = false; }\n    void visit(const C &amp;) override { result = false; }\n\n    const A &amp; lhs;\n};\n</code></pre>\n\n<p>And similar for <code>B</code> and <code>C</code></p>\n\n<pre><code>struct LhsVisitor : public Visitor\n{\n    void visit(const A &amp; a) override { rhsVisitor = std::make_unique&lt;AEqualVisitor&gt;(a); }\n    void visit(const B &amp; b) override { rhsVisitor = std::make_unique&lt;BEqualVisitor&gt;(b); }\n    void visit(const C &amp; c) override { rhsVisitor = std::make_unique&lt;CEqualVisitor&gt;(c); }\n\n    std::unique_ptr&lt;RhsVisitor&gt; rhsVisitor;\n};\n\nbool equalTree(const Base * lhs, const Base * rhs)\n{\n    LhsVisitor vis;\n    lhs-&gt;accept(vis);\n    rhs-&gt;accept(*vis.rhsVisitor);\n    return vis.rhsVisitor-&gt;result;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536162104, "post_id": 52188814, "comment_id": 91327694, "body": "I don&#39;t think the second works, surely<code>typeid(*lhs)</code> is <code>typeid(Base)</code>?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536168563, "post_id": 52188814, "comment_id": 91330877, "body": "@Caleth No, it&#39;s not. <code>typeid</code> gives run-time type information. So while <code>typeid(lhs)</code> would give you the same thing as <code>typeid(Base const*)</code>, <code>typeid(*lhs)</code> would give you <code>typeid(A)</code> or something."}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1536205374, "post_id": 52188814, "comment_id": 91341722, "body": "Your first approach is what I ended up doing. Although your second approach looks a lot cleaner. Is the second approach faster than the first? Is comparing stings faster than 4 virtual calls? Your third approach can\u2019t be used in my situation as I am already using the polymorphic tree in a lot of other code."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 0, "last_activity_date": 1536161435, "creation_date": 1536161435, "answer_id": 52188814, "question_id": 52182938, "link": "https://stackoverflow.com/questions/52182938/elegantly-comparing-polymorphic-trees-in-c/52188814#52188814", "title": "Elegantly comparing polymorphic trees in C++", "body": "<p>There are three approaches here.</p>\n\n<hr />\n\n<p>The first is - you need to do double dispatch. You have one visitor for one side and one visitor for the other side. Once you pick one side, you \"save\" that type as a template parameter, which you can use to visit the other side:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct Right : Visitor {\n     Right(T const* lhs) : lhs(lhs) { }\n     T const* lhs;\n     bool result;\n\n     void visit(A const&amp; x) override { visit_impl(x); }\n     void visit(B const&amp; x) override { visit_impl(x); }\n     void visit(C const&amp; x) override { visit_impl(x); }\n\n     void visit_impl(T const&amp; x) { result = equalNode(*lhs, x); }\n     template &lt;typename U&gt; void visit_impl(U const&amp;) { result = false; }\n};\n\nstruct Left : Visitor {\n    Left(Base const* lhs, Base const* rhs) : rhs(rhs) {\n        lhs-&gt;accept(*this);\n    }\n    Base const* rhs;\n    bool result;\n\n    void visit(A const&amp; x) override { visit_impl(x); }\n    void visit(B const&amp; x) override { visit_impl(x); }\n    void visit(C const&amp; x) override { visit_impl(x); }\n\n    template &lt;typename U&gt;\n    void visit_impl(U const&amp; lhs) {\n        Right&lt;U&gt; right(&amp;lhs);\n        rhs-&gt;accept(right);\n        result = right.result;\n    }\n};\n\nbool equalTree(const Base *lhs, const Base *rhs) {\n    return Left(lhs, rhs).result;\n}\n</code></pre>\n\n<hr />\n\n<p>The second is - you cheat. You only care about the cases where the two sides are the same type, so you only need single dispatch:</p>\n\n<pre><code>struct Eq : Vistor {\n    Eq(Base const* lhs, Base const* rhs) : rhs(rhs) {\n        lhs-&gt;accept(*this);\n    }\n\n    Base const* rhs;\n    bool result;\n\n    void visit(A const&amp; x) override { visit_impl(x); }\n    void visit(B const&amp; x) override { visit_impl(x); }\n    void visit(C const&amp; x) override { visit_impl(x); }\n\n    template &lt;typename U&gt;\n    void visit_impl(U const&amp; x) {\n        result = equalNode(x, *static_cast&lt;U const*&gt;(rhs));\n    }\n};\n\nbool equalTree(Base const* lhs, Base const* rhs) {\n    if (typeid(*lhs) == typeid(*rhs)) {\n        return Eq(lhs, rhs).result;\n    } else {\n        return false;\n    }\n}\n</code></pre>\n\n<hr />\n\n<p>The third is - you don't do this through OO and instead use a <code>variant</code>:</p>\n\n<pre><code>using Element = std::variant&lt;A, B, C&gt;;\n\nstruct Eq {\n    template &lt;typename T&gt;\n    bool operator()(T const&amp; lhs, T const&amp; rhs) const {\n        return equalNode(lhs, rhs);\n    }\n\n    template &lt;typename T, typename U&gt;\n    bool operator()(T const&amp;, U const&amp;) const {\n        return false;\n    }\n};\n\nbool equalTree(Element const&amp; lhs, Element const&amp; rhs) {\n    return std::visit(Eq{}, lhs, rhs);\n}\n</code></pre>\n"}], "owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 1, "accepted_answer_id": 52188814, "answer_count": 2, "score": 0, "last_activity_date": 1536161435, "creation_date": 1536143357, "last_edit_date": 1536145397, "question_id": 52182938, "link": "https://stackoverflow.com/questions/52182938/elegantly-comparing-polymorphic-trees-in-c", "title": "Elegantly comparing polymorphic trees in C++", "body": "<p>I have a tree of polymorphic objects. I need to traverse the two trees and compare the nodes. If the nodes have different types, they are not equal. Consider this hierarchy:</p>\n\n<pre><code>struct Visitor;\n\nstruct Base {\n  virtual ~Base() = default;\n  virtual void accept(Visitor &amp;) = 0;\n};\nusing BasePtr = std::unique_ptr&lt;Base&gt;;\n\nstruct A final : Base {\n  void accept(Visitor &amp;) override;\n  int data;\n};\nstruct B final : Base {\n  void accept(Visitor &amp;) override;\n  BasePtr child;\n};\nstruct C final : Base {\n  void accept(Visitor &amp;) override;\n  std::vector&lt;BasePtr&gt; children;\n};\n\nstruct Visitor {\n  virtual void visit(const A &amp;) = 0;\n  virtual void visit(const B &amp;) = 0;\n  virtual void visit(const C &amp;) = 0;\n};\n</code></pre>\n\n<p>I know how to implement these functions:</p>\n\n<pre><code>bool equalNode(const A &amp;, const A &amp;);\nbool equalNode(const B &amp;, const B &amp;);\nbool equalNode(const C &amp;, const C &amp;);\n</code></pre>\n\n<p>I'm asking about how I should implement this function:</p>\n\n<pre><code>bool equalTree(const Base *, const Base *);\n</code></pre>\n\n<p>How do I elegantly go from <code>equalTree</code> to <code>equalNode</code> possibly using the visitor pattern?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 1140, "user_id": 9252020, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PDrj2.jpg?s=128&g=1", "display_name": "Rhathin", "link": "https://stackoverflow.com/users/9252020/rhathin"}, "edited": false, "score": 0, "creation_date": 1536143467, "post_id": 52182826, "comment_id": 91315656, "body": "Did you change anything using refactor tool?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1536143598, "post_id": 52182826, "comment_id": 91315725, "body": "Search for and delete any generated files under <i>source dir</i>. Sounds like case of that..."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1536143641, "post_id": 52182826, "comment_id": 91315754, "body": "Also, check that any of these haven&#39;t been accidentally added to version control."}, {"owner": {"reputation": 78, "user_id": 7525494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J-rQqnBFA3Y/AAAAAAAAAAI/AAAAAAAABFA/gvUUDZ63laU/photo.jpg?sz=128", "display_name": "claude joliat", "link": "https://stackoverflow.com/users/7525494/claude-joliat"}, "edited": false, "score": 0, "creation_date": 1536148297, "post_id": 52182826, "comment_id": 91318581, "body": "No generated files under source dir or under version control. It seems that all projects are broken, even the Qt examples. I just notice that qwidgets.h has changed yesterday evening ??? I don&#39;t know how this append, but that is for sure origin of problem. Does anybody knows where I can get a fresh &lt;qt&gt;/include/qwidgets.h? Anyway, thanks guys"}, {"owner": {"reputation": 78, "user_id": 7525494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J-rQqnBFA3Y/AAAAAAAAAAI/AAAAAAAABFA/gvUUDZ63laU/photo.jpg?sz=128", "display_name": "claude joliat", "link": "https://stackoverflow.com/users/7525494/claude-joliat"}, "edited": false, "score": 0, "creation_date": 1536149286, "post_id": 52182826, "comment_id": 91319230, "body": "Oh sorry, I put the mess in my include files. Now it is ok, thanks again, and sorry for this"}], "answers": [{"comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1536159247, "post_id": 52184925, "comment_id": 91325907, "body": "On Windows the Qt installation done without administrative privileges is not read-only... You could make it read-only, but that&#39;s a bit of a bummer indeed. Perhaps you could install and maintain your Qt installation under administrative privileges, essentially making Qt invariant for your use case."}], "tags": [], "owner": {"reputation": 78, "user_id": 7525494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J-rQqnBFA3Y/AAAAAAAAAAI/AAAAAAAABFA/gvUUDZ63laU/photo.jpg?sz=128", "display_name": "claude joliat", "link": "https://stackoverflow.com/users/7525494/claude-joliat"}, "is_accepted": true, "score": 0, "last_activity_date": 1536149858, "creation_date": 1536149858, "answer_id": 52184925, "question_id": 52182826, "link": "https://stackoverflow.com/questions/52182826/qt-qwidgetcloseevent-link-issue/52184925#52184925", "title": "qt QWidget::closeEvent link issue", "body": "<p>The issue was coming from a modification of Qt includes files</p>\n"}], "owner": {"reputation": 78, "user_id": 7525494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J-rQqnBFA3Y/AAAAAAAAAAI/AAAAAAAABFA/gvUUDZ63laU/photo.jpg?sz=128", "display_name": "claude joliat", "link": "https://stackoverflow.com/users/7525494/claude-joliat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 52184925, "answer_count": 1, "score": 0, "last_activity_date": 1536149858, "creation_date": 1536143023, "last_edit_date": 1536145212, "question_id": 52182826, "link": "https://stackoverflow.com/questions/52182826/qt-qwidgetcloseevent-link-issue", "title": "qt QWidget::closeEvent link issue", "body": "<p>I have a pretty big app, which was running fine on windows with Qt5.10.0 and minGW32 compiler.\nAnd then I added a new window based on QDialog. In that new class, I try to reimplement <em>QDialog::closeEvent</em>. In header file:</p>\n\n<pre><code>virtual void closeEvent(QEvent *pEvent) override;\n</code></pre>\n\n<p>Then, I get a warning</p>\n\n<pre><code>xxx::closeEvent hides overloaded virtual function\n</code></pre>\n\n<p>, because parameter is <em>QCloseEvent</em> type, and link errors.</p>\n\n<p>So, I have tried to:</p>\n\n<ul>\n<li>reimplement closeEvent(Q<strong>Close</strong>Event *pEvent) </li>\n<li>delete closeEvent method</li>\n<li>stop to use that window and delete it from .pro</li>\n</ul>\n\n<p>No matter my trials, the following links error remain, and avoid me to compile anymore:</p>\n\n<pre><code>undefined reference to `QWidget::closeEvent(QEvent*)'\n</code></pre>\n\n<p>on many moc_\"guifile\".o. All <em>moc_files.o</em> are generated though. Final error is:</p>\n\n<pre><code>collect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>(Furthermore, Qt creator, claims that it can't find these moc files when I try to follow link from \"issue\" tab.)</p>\n\n<p>The weird thing is that I never use <em>closeEvent</em> anymore, in any of source or generated files. <em>moc_files.cpp</em> do not contains any <em>closeEvent</em> string.</p>\n\n<p><strong>But</strong>\n<em>moc_files.o</em>  <strong>do</strong> contain references to  <em>__ZN7QWidget10closeEventEP6QEvent</em>, for example, which is wrong (right signature is QWidget::closeEvent(QCloseEvent *e)), but how can I avoid it to be generated?</p>\n\n<p>I have tried several time to clean/recompile/delete build folder.</p>\n\n<p>Obviously, I don't hope to receive a solution here, but any tips for helping me to figure out where to search would be appreciated.</p>\n\n<p>What could help? Reinstalling Qt/minGW seems no use, as it has worked from months?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1536142360, "post_id": 52182533, "comment_id": 91314963, "body": "Of course you can&#39;t access private members from outside the class, that&#39;s kind of the point of them being private."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1536142409, "post_id": 52182533, "comment_id": 91314994, "body": "<a href=\"https://en.cppreference.com/w/cpp/numeric/complex/real2\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/numeric/complex/real2</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1536142546, "post_id": 52182533, "comment_id": 91315071, "body": "Also, what is &quot;a HLS tools&quot;? What are you really trying to do? Please  <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a> and <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Then learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1536143102, "post_id": 52182533, "comment_id": 91315410, "body": "<code>#define private public</code>, seriously don&#39;t do this"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1536153959, "post_id": 52182533, "comment_id": 91322303, "body": "Present your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1536143187, "post_id": 52182705, "comment_id": 91315467, "body": "I did not know that! Where does it say that we have <code>explicit permission to reinterpret a complex number as an array of two scalars</code>?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 2, "creation_date": 1536146898, "post_id": 52182705, "comment_id": 91317650, "body": "@Pi <a href=\"http://eel.is/c++draft/complex.numbers#4\" rel=\"nofollow noreferrer\"><code>[complex.numbers&#47;4]</code></a>"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 4, "last_activity_date": 1536142665, "creation_date": 1536142665, "answer_id": 52182705, "question_id": 52182533, "link": "https://stackoverflow.com/questions/52182533/is-there-any-way-to-access-private-member-variable-of-c-complex-number-class/52182705#52182705", "title": "Is there any way to access private member variable of C++ complex number class?", "body": "<p>The <code>std::complex</code> template is somewhat magic: You have explicit permission to reinterpret a complex number as an array of two scalars. More generally, the following is valid:</p>\n\n<pre><code>std::complex&lt;float&gt; a[10];\n\nfloat* r = reinterpret_cast&lt;float*&gt;(a);\n\nfor (int i = 0; i != 20; ++i) std::cout &lt;&lt; r[i] &lt;&lt; '\\n';\n</code></pre>\n\n<p>That is, you can treat an array of complex numbers like an array of twice as many real numbers. You can use this approach to access the elements of your complex number individually.</p>\n\n<p>Do beware of the following constraint, though ([complex.numbers]p2):</p>\n\n<blockquote>\n  <p>The effect of instantiating the template <code>complex</code> for any type other than <code>float</code>, <code>double</code>, or <code>long double</code> is\n  unspecified.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "is_accepted": false, "score": 4, "last_activity_date": 1536147489, "creation_date": 1536147489, "answer_id": 52184235, "question_id": 52182533, "link": "https://stackoverflow.com/questions/52182533/is-there-any-way-to-access-private-member-variable-of-c-complex-number-class/52184235#52184235", "title": "Is there any way to access private member variable of C++ complex number class?", "body": "<p>Just to be complete, another way to access the members is using the corresponding getters, for example like this</p>\n\n<pre><code>#include &lt;complex&gt;\n\nint main()\n{\n   std::complex&lt;float&gt; c;\n   c.real(1);\n   c.imag(2);\n   return c.real();\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9475755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c810619a33f980238040c010566788?s=128&d=identicon&r=PG&f=1", "display_name": "Md Tariq-ul-Islam chowdhury", "link": "https://stackoverflow.com/users/9475755/md-tariq-ul-islam-chowdhury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1536961409, "answer_count": 2, "score": 0, "last_activity_date": 1536147489, "creation_date": 1536142162, "last_edit_date": 1536142629, "question_id": 52182533, "link": "https://stackoverflow.com/questions/52182533/is-there-any-way-to-access-private-member-variable-of-c-complex-number-class", "closed_reason": "Not suitable for this site", "title": "Is there any way to access private member variable of C++ complex number class?", "body": "<p>I am using the built in complex number class <code>std::complex</code> from the Standard C++ Library header. I applied a code in a HLS tools. The tool can not access a private member variable of that complex class. Is it possible to make it public or what can i do?  </p>\n\n<pre><code>Error: /usrf01/prog/mentor/2015-16/RHELx86/QUESTA-SV-AFV_10.4c-5/questasim/gcc-4.7.4-linux_x86_64/bin/../lib/gcc/x86_64-unknown-linux-gnu/4.7.4/../../../../include/c++/4.7.4/complex(222): \nerror: 'fpml::fixed_point&lt;int, 16u, 15u&gt; std::complex&lt;fpml::fixed_point&lt;int, 16u, 15u&gt; &gt;::_M_real' is private\n</code></pre>\n"}, {"tags": ["c++", "c++14"], "answers": [{"tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 7, "last_activity_date": 1536142534, "last_edit_date": 1536142534, "creation_date": 1536142050, "answer_id": 52182499, "question_id": 52182420, "link": "https://stackoverflow.com/questions/52182420/variadic-template-perfect-forwarding-of-integer-parameter-to-lambda/52182499#52182499", "title": "Variadic template: Perfect forwarding of integer parameter to lambda", "body": "<p><code>args...</code> is constant because a lambda's call operator is implicitly <code>const</code>. So, if you make your lambda mutable, then it works:</p>\n\n<pre><code>[=]() mutable -&gt; T*\n     { return new T( std::forward&lt; Args&gt;( args)...);  }\n</code></pre>\n\n<p>The reason it didn't work with <code>decltype(args)</code> is that the types themselves are not <code>const</code>, just the call operator.</p>\n"}, {"comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 1, "creation_date": 1536157830, "post_id": 52182510, "comment_id": 91324893, "body": "Does <code>forward&lt;Args&gt;(args)...</code> here actually forward?"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 4, "last_activity_date": 1536142764, "last_edit_date": 1536142764, "creation_date": 1536142087, "answer_id": 52182510, "question_id": 52182420, "link": "https://stackoverflow.com/questions/52182420/variadic-template-perfect-forwarding-of-integer-parameter-to-lambda/52182510#52182510", "title": "Variadic template: Perfect forwarding of integer parameter to lambda", "body": "<p>The <code>operator()</code> of the <em>closure type</em> generated by your <em>lambda expression</em> is <code>const</code>-qualified. <code>std::forward</code> can attempt to move <code>args...</code>, which are data members of the closure. <code>const</code> objects cannot be moved.</p>\n\n<p>You can mark your lambda as <code>mutable</code>:</p>\n\n<pre><code>  mpCreator( [=]() mutable -&gt; T*\n     { return new T( std::forward&lt; Args&gt;( args)...);  }\n  ),\n</code></pre>\n\n<p>This removes the implicit <code>const</code> qualfiier from the <em>closure type</em>'s generated <code>operator()</code>.</p>\n\n<p><a href=\"https://wandbox.org/permlink/AuRlvSkH2GFM6HWO9\" rel=\"nofollow noreferrer\"><strong>live example on wandbox.org</strong></a></p>\n"}], "owner": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 52182510, "answer_count": 2, "score": 6, "last_activity_date": 1536142764, "creation_date": 1536141795, "question_id": 52182420, "link": "https://stackoverflow.com/questions/52182420/variadic-template-perfect-forwarding-of-integer-parameter-to-lambda", "title": "Variadic template: Perfect forwarding of integer parameter to lambda", "body": "<p>There are similar questions, but I did not find an answer that works for my problem.</p>\n\n<p>Consider the following code:</p>\n\n<pre><code>#include &lt;cassert&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;utility&gt;\n\nclass TestClass\n{\npublic:\n   TestClass( int value): mValue( value) { }\nprivate:\n   int  mValue;\n};\n\ntemplate&lt; typename T&gt; class DeferredCreator\n{\npublic:\n   template&lt; class... Args&gt; DeferredCreator( Args&amp;&amp;... args):\n      mpCreator( [=]() -&gt; T*\n         { return new T( std::forward&lt; Args&gt;( args)...);  }\n      ),\n      mpObject()\n   { }\n\n   T* get() {\n      if (mpObject == nullptr)\n         mpObject.reset( mpCreator());\n      return mpObject.get();\n   }\nprivate:\n   std::function&lt; T*( void)&gt;  mpCreator;\n   std::unique_ptr&lt; T&gt;        mpObject;\n};\n\n\nint main() {\n   DeferredCreator&lt; int&gt;  dcInt( 42);\n\n   assert( dcInt.get() != nullptr);\n   return 0;\n}\n</code></pre>\n\n<p>The idea is that the class DeferredCreator creates an object only when it is really needed. I got this work e.g. for strings, but I can't figure out how to pass a simple integer into my lambda.</p>\n\n<p>The error message I get is:</p>\n\n<pre><code>prog.cpp:19:26: error: no matching function for call to 'forward'\n         { return new T( std::forward&lt; Args&gt;( args)...);  }\n                         ^~~~~~~~~~~~~~~~~~~\nprog.cpp:36:27: note: in instantiation of function template specialization 'DeferredCreator&lt;int&gt;::DeferredCreator&lt;int&gt;' requested here\n   DeferredCreator&lt; int&gt;  dcInt( 42);\n                          ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/6.3.0/../../../../include/c++/6.3.0/bits/move.h:76:5: note: candidate function not viable: 1st argument ('const int') would lose const qualifier\n    forward(typename std::remove_reference&lt;_Tp&gt;::type&amp; __t) noexcept\n    ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/6.3.0/../../../../include/c++/6.3.0/bits/move.h:87:5: note: candidate function not viable: 1st argument ('const int') would lose const qualifier\n    forward(typename std::remove_reference&lt;_Tp&gt;::type&amp;&amp; __t) noexcept\n    ^\n2 errors generated.\n</code></pre>\n\n<p>I already tried to use <code>decltype( args)</code> as template argument for <code>std::forward&lt;&gt;</code>, but that did not help.</p>\n\n<p>The code is also available here: <a href=\"https://ideone.com/MIhMkt\" rel=\"noreferrer\">https://ideone.com/MIhMkt</a></p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1536141186, "post_id": 52182112, "comment_id": 91314256, "body": "<a href=\"http://doc.qt.io/qt-5/qpair.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qpair.html</a>"}, {"owner": {"reputation": 5161, "user_id": 3065406, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6697e5c2ff5cfdf8f196fe42a309598?s=128&d=identicon&r=PG", "display_name": "deW1", "link": "https://stackoverflow.com/users/3065406/dew1"}, "reply_to_user": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 7, "creation_date": 1536141227, "post_id": 52182112, "comment_id": 91314280, "body": "Return your own data structure aka a struct. This is unrelated to Qt and a fundamental C++ problem. @Jiu pairs shouldn&#39;t be used anywhere whether it being QPair or std::pair as it hides the underlying information."}, {"owner": {"reputation": 486, "user_id": 8016180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f-1ZzXKs7nk/AAAAAAAAAAI/AAAAAAAAAKQ/oy5pT4VpAMs/photo.jpg?sz=128", "display_name": "Rolf Winter", "link": "https://stackoverflow.com/users/8016180/rolf-winter"}, "edited": false, "score": 0, "creation_date": 1536141609, "post_id": 52182112, "comment_id": 91314507, "body": "Use a QVariant, which can hold the most common types: <a href=\"http://doc.qt.io/qt-5/qvariant.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qvariant.html</a> if you want to return different things depending on function internals, or a struct/object as already mentioned if you always want to return the same set of things"}, {"owner": {"reputation": 154, "user_id": 5908973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d49e8e2ae710bd689ad93c48cd31260?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5908973/mike"}, "edited": false, "score": 0, "creation_date": 1536157109, "post_id": 52182112, "comment_id": 91324421, "body": "QVariant is a useful return type. You can also pass in references as parameters and assign to them in the function rather than return. Aside from that, templates also work."}, {"owner": {"reputation": 54, "user_id": 6545245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94212af06dff255f3a342b8a003e3bd0?s=128&d=identicon&r=PG&f=1", "display_name": "mr.alaa", "link": "https://stackoverflow.com/users/6545245/mr-alaa"}, "edited": false, "score": 0, "creation_date": 1536157607, "post_id": 52182112, "comment_id": 91324748, "body": "thanks but i need an example"}, {"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1536157961, "post_id": 52182112, "comment_id": 91324983, "body": "This is more a design question than a code question, you must first think of how and where you will use this data, and then which class should have the data-members, which class will call the DB-query etc."}], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 6545245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94212af06dff255f3a342b8a003e3bd0?s=128&d=identicon&r=PG&f=1", "display_name": "mr.alaa", "link": "https://stackoverflow.com/users/6545245/mr-alaa"}, "edited": false, "score": 0, "creation_date": 1536157245, "post_id": 52184249, "comment_id": 91324512, "body": "will i add user struct in header file and source file or  only in source file as i have call this method from header file  it will be like this bool test_query(QList&lt;Userdata&gt; &amp;namesList); and what about passing username and password for function to select from database as in c# checkuser(string username , string pass)"}, {"owner": {"reputation": 54, "user_id": 6545245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94212af06dff255f3a342b8a003e3bd0?s=128&d=identicon&r=PG&f=1", "display_name": "mr.alaa", "link": "https://stackoverflow.com/users/6545245/mr-alaa"}, "edited": false, "score": 0, "creation_date": 1536157345, "post_id": 52184249, "comment_id": 91324566, "body": "in the login form how will it ?"}, {"owner": {"reputation": 733, "user_id": 3840951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c08ea58dbc2a5238bee0c168bc94b368?s=128&d=identicon&r=PG", "display_name": "Pedro LM", "link": "https://stackoverflow.com/users/3840951/pedro-lm"}, "reply_to_user": {"reputation": 54, "user_id": 6545245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94212af06dff255f3a342b8a003e3bd0?s=128&d=identicon&r=PG&f=1", "display_name": "mr.alaa", "link": "https://stackoverflow.com/users/6545245/mr-alaa"}, "edited": false, "score": 0, "creation_date": 1536221936, "post_id": 52184249, "comment_id": 91348130, "body": "I edited my answer to give you an idea of how to structure your source files. As for your other questions, I don&#39;t understand what you mean..."}, {"owner": {"reputation": 54, "user_id": 6545245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94212af06dff255f3a342b8a003e3bd0?s=128&d=identicon&r=PG&f=1", "display_name": "mr.alaa", "link": "https://stackoverflow.com/users/6545245/mr-alaa"}, "edited": false, "score": 0, "creation_date": 1536248906, "post_id": 52184249, "comment_id": 91365056, "body": "i have the previous steps and then in my main window i have called the function in this way  database_mysql db;     QList&lt;User&gt; names;     db.test_query(names);      foreach(User , names){       qDebug()&lt;&lt; &quot;Name: &quot; &lt;&lt; name;      }   but i got the error   error: extra qualification &#39;database_mysql::&#39; on member &#39;test_query&#39; [-fpermissive] bool database_mysql::test_query(QList&lt;User&gt;&amp; users); ^"}], "tags": [], "owner": {"reputation": 733, "user_id": 3840951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c08ea58dbc2a5238bee0c168bc94b368?s=128&d=identicon&r=PG", "display_name": "Pedro LM", "link": "https://stackoverflow.com/users/3840951/pedro-lm"}, "is_accepted": false, "score": 0, "last_activity_date": 1536221866, "last_edit_date": 1536221866, "creation_date": 1536147533, "answer_id": 52184249, "question_id": 52182112, "link": "https://stackoverflow.com/questions/52182112/how-to-return-multi-different-datatype-using-qt-c-function/52184249#52184249", "title": "How to return multi different datatype using qt c++ function?", "body": "<p>You should declare your own <code>class</code>/<code>struct</code> to hold this data. For example, you could create a file <code>User.h</code> with the declaration:</p>\n\n<pre><code>#pragma once\n\nstruct User {\n    int       id;\n    QString   name;\n    QDateTime joined;\n    // anything else in your DB\n};\n</code></pre>\n\n<p>In your DB module's header (e.g., <code>database_mysql.h</code>):</p>\n\n<pre><code>#pragma once\n\nstruct User; // forward declaration\n\nclass database_mysql {\npublic:\n    bool database_mysql::test_query(QList&lt;User&gt;&amp; users);\n};\n</code></pre>\n\n<p>Then, in the DB source file (e.g., <code>database_mysql.cpp</code>):</p>\n\n<pre><code>#include &lt;database_mysql.h&gt;\n#include &lt;User.h&gt;\n\nbool database_mysql::test_query(QList&lt;User&gt;&amp; users) {\n    ...\n}\n</code></pre>\n\n<p>The <code>test_query</code> function should then retrieve rows from the DB, instantiate <code>User</code> objects, and insert these objects into the <code>users</code> list.</p>\n"}], "owner": {"reputation": 54, "user_id": 6545245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94212af06dff255f3a342b8a003e3bd0?s=128&d=identicon&r=PG&f=1", "display_name": "mr.alaa", "link": "https://stackoverflow.com/users/6545245/mr-alaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536221866, "creation_date": 1536140994, "last_edit_date": 1536141919, "question_id": 52182112, "link": "https://stackoverflow.com/questions/52182112/how-to-return-multi-different-datatype-using-qt-c-function", "title": "How to return multi different datatype using qt c++ function?", "body": "<p>I have started qt recently and i was asked i if we can build simple function that return data with different type of int string datatime in one method like login in case i pass the method username and password it i will return all user data where can i call the function in the main form and use the user data there . i have searched and find some example but still  difficult to  a chive i have used this one but it returns only one value no more this is the  code </p>\n\n<pre><code>bool database_mysql::test_query(QList&lt;QString&gt;&amp; namesList)\n{\n    bool result = false;\n    namesList.clear();//clear possible old entries\n\n    if(!connect()){\n        qDebug() &lt;&lt; \"Database Not Connected!\";\n    }else{\n        QSqlQuery query;\n        query.exec(\"SELECT * FROM Users\");\n        while (query.next()){\n            QString name = query.value(2).toString();\n            namesList.append(name);\n         }\n        result = true;\n    }\n    return result;\n}\n</code></pre>\n\n<p>and the code where to pass user name and password to check user \ncan any one help.</p>\n"}, {"tags": ["c++", "c++-cli"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1536141429, "post_id": 52182095, "comment_id": 91314400, "body": "You should add <code>..&#47;OtherLibrary&#47;drm&#47;adept&#47;src</code> as one of the places where your project looks for header files. And you should change <code>#include &quot;..&#47;OtherLibrary&#47;drm&#47;adept&#47;src&#47;adept_provider.h&quot;</code> to <code>#include &quot;adept_provider.h&quot;</code>. What&#39;s happening is that the compiler is looking for <code>dp_all.h</code> relative to your project not to the other project. Compilation is not totally separate in C++, headers files are shared between projects and are recompiled in each project where they are used."}, {"owner": {"reputation": 33829, "user_id": 7850, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Eql2x.jpg?s=128&g=1", "display_name": "Shaul Behr", "link": "https://stackoverflow.com/users/7850/shaul-behr"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1536142097, "post_id": 52182095, "comment_id": 91314809, "body": "@john Is that in the Property Pages, &quot;Additional #using directories&quot;? I&#39;ve added it there, but it gives me a compiler error if I just do <code>#include &quot;adept_provider.h&quot;</code>: <code>No such file or directory</code>"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1536142219, "post_id": 52182095, "comment_id": 91314878, "body": "No, I don&#39;t have a copy of Visual Studio handy right now, but it&#39;s something like C++/General/Additional Include Directories"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1536142502, "post_id": 52182095, "comment_id": 91315046, "body": "I&#39;ve just checked Project/Properties/Configuration Properties/C++/General/Additional Include Directories, just above Additional #using Directories as it happens."}, {"owner": {"reputation": 33829, "user_id": 7850, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Eql2x.jpg?s=128&g=1", "display_name": "Shaul Behr", "link": "https://stackoverflow.com/users/7850/shaul-behr"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1536142585, "post_id": 52182095, "comment_id": 91315098, "body": "@john Yep, that&#39;s it. Thanks! Please convert your comments into an answer I can accept."}], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 2, "last_activity_date": 1536142679, "creation_date": 1536142679, "answer_id": 52182715, "question_id": 52182095, "link": "https://stackoverflow.com/questions/52182095/newbie-help-for-visual-c-project-references/52182715#52182715", "title": "Newbie help for Visual C++ project references", "body": "<p>You should add <code>../OtherLibrary/drm/adept/src</code> as one of the places where your project looks for header files (in C++/General/Additional Include Directories). </p>\n\n<p>You should change <code>#include \"../OtherLibrary/drm/adept/src/adept_provider.h\"</code> to <code>#include \"adept_provider.h\"</code>. </p>\n\n<p>What's happening is that the compiler is looking for <code>dp_all.h</code> relative to your project not to the other project. Compilation is not totally separate in C++, headers files are shared between projects and are recompiled in each project where they are used. </p>\n"}], "owner": {"reputation": 33829, "user_id": 7850, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Eql2x.jpg?s=128&g=1", "display_name": "Shaul Behr", "link": "https://stackoverflow.com/users/7850/shaul-behr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52182715, "answer_count": 1, "score": 0, "last_activity_date": 1536142679, "creation_date": 1536140933, "question_id": 52182095, "link": "https://stackoverflow.com/questions/52182095/newbie-help-for-visual-c-project-references", "title": "Newbie help for Visual C++ project references", "body": "<p>I know next to nothing about C++, except that I have a missing to take someone else's C++ library and wrap it for use by C#. I found a few posts about how to do it, and I'm making my way there, bit by bit. But I've hit a wall at this point.</p>\n\n<p>According to <a href=\"https://stackoverflow.com/a/18151259/7850\">this post</a> I'm supposed to create a new managed C++ project. This I have done, and I added a reference to the project I'm supposed to be wrapping. So my code looks like this:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"DrmWrapper.h\"\n#include \"../OtherLibrary/drm/adept/src/adept_provider.h\"\n\nDrmWrapper::DrmWrapper(dpdrm::DRMProcessorClient * client, dpdev::Device * device)\n{\n    adept::DRMProviderImpl * provider = new adept::DRMProviderImpl();\n    drm_processor_ = provider-&gt;createDRMProcessor(client, device);\n}\n\nunsigned DrmWrapper::initSignInWorkflow(unsigned workflows, const dp::String&amp; authProvider, const dp::String&amp; username,\n    const dp::String&amp; password)\n{\n    return drm_processor_-&gt;initSignInWorkflow(workflows, authProvider, username, password);\n}\n</code></pre>\n\n<p>All looks good. But when I try compile my wrapper project, I get an error:</p>\n\n<blockquote>\n  <p>d:\\src\\drm-wrapper\\OtherLibrary\\drm\\adept\\src\\adept_provider.h(26): fatal error C1083: Cannot open include file: 'dp_all.h': No such file or directory</p>\n</blockquote>\n\n<p>Eh...whut? I'm not trying to compile the <code>adept</code> library. That already built fine by itself. I just want to compile my own wrapper project. And the <code>dp_all.h</code> file <em>does</em> exist, in the same folder as <code>adept_provider.h</code>.</p>\n\n<p>Clearly there's some paradigm shift I'm not making from C# to C++; it seems like the code is being rebuilt as if the referenced project's source file were in my project folder.</p>\n\n<p>What's the secret switch to get this working?</p>\n"}, {"tags": ["c++", "pointers", "member-function-pointers"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 5, "creation_date": 1536140963, "post_id": 52182009, "comment_id": 91314110, "body": "A pointer type that can only have one specific value (two if you count null) doesn\u2019t seem very useful. What\u2019s your use case?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536141117, "post_id": 52182009, "comment_id": 91314208, "body": "if you want to point only to one specific method, why dont you use the method itself instead of a pointer?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 6, "creation_date": 1536141255, "post_id": 52182009, "comment_id": 91314296, "body": "It&#39;s a bit like wanting a pointer that can only point to the number 5. Why would you need such a thing? Just use 5."}, {"owner": {"reputation": 557, "user_id": 2490611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0851f1c138a55b39588e02f9c33ea84?s=128&d=identicon&r=PG", "display_name": "Sonny D", "link": "https://stackoverflow.com/users/2490611/sonny-d"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1536141302, "post_id": 52182009, "comment_id": 91314319, "body": "@molbdnilo Use case isn&#39;t important. You&#39;re right, this kind of pointer wouldn&#39;t be useful. It&#39;s just purely academic reasoning. I&#39;m lenring QT5 and <code>static_cast&lt;void(QComboBox::*)(int)&gt;(&amp;QComboBox::activated)</code> came up, and just wondering."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536141720, "post_id": 52182009, "comment_id": 91314581, "body": "Objects which contain specific values which should not be changed are commonly called &quot;constants&quot; ;-). @n.m. The use case you describe is not uncommon; you may have encountered a <code>const int</code> now and then, and will remember with a bit of nudging why it is preferable to a literal <code>5</code>;-). The same reasoning can be applied to function pointers, member functions or not. So the answer to the OP is &quot;yes, of course you can, just make the pointer <code>const</code>&quot;. (Disclaimer: I have never done that but suppose it works for member function pointers.)-- P.S. Marek&#39;s better alternatives notwithstanding."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536141823, "post_id": 52182009, "comment_id": 91314639, "body": "@PeterA.Schneider a type that can only hold one value is not the same as a variable that is <code>const</code>, just saying..."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1536141915, "post_id": 52182009, "comment_id": 91314693, "body": "Possibly add enum/type <code>EDoorId</code>, then signature is <code>void (Car::*action)(EDoorId)</code>."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536142327, "post_id": 52182009, "comment_id": 91314946, "body": "@user463035818 I always thought that the way to declare that &quot;a type [...] can only hold one value&quot; is <b>exactly</b> decorating it with <code>const</code>. <code>const</code>ness is a property of the type; sometimes the language converts between (non-)const types for you; sometimes it doesn&#39;t, and you have to cast explicitly. What else would you suggest to express the fact in the type system that an object of that type can only hold a specific value?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536142668, "post_id": 52182009, "comment_id": 91315137, "body": "@PeterA.Schneider  &quot;constnees is a property of the type&quot;. I never thought about it that way and I am not sure if I do agree. Anyhow, there is a difference between <code>struct Foo { const int x = 5; }; Foo f;</code> and <code>const int x = 5;</code>. Nevermind, I think we are going offtopic ;)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536143903, "post_id": 52182009, "comment_id": 91315891, "body": "@PeterA.Schneider <code>const</code> lets you create <i>objects</i> that can only have one value. There&#39;s nothing about <code>const</code> that limits the potential value an object can have. OP wants a <i>type</i> that can only hold one predetermined specific value, not an immutable but arbitrary one."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1536148411, "post_id": 52182009, "comment_id": 91318649, "body": "@molbdnilo Well, he asked &quot;I wonder if I am right: there is no way to declare a pointer to a particular method only.&quot; The answer is yes, there is: a const pointer."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536148690, "post_id": 52182009, "comment_id": 91318827, "body": "@PeterA.Schneider Read the next sentence, too. OP asks for a <i>type</i> that can only accept one particular function. That is, a type <code>T</code> such that <code>const T x = &amp;Car::openDoor;</code> is fine, but <code>const T x = &amp;Car::closeDoor;</code> is a type error."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536141253, "post_id": 52182193, "comment_id": 91314293, "body": "inheriting from an interface is not really an alternative to a member function pointer. Inheritance is invasive, member function pointers are not"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536141309, "post_id": 52182193, "comment_id": 91314327, "body": "Yes but he wrote: <code>I wondering if I&#39;m right: there isn&#39;t a way to declare pointer to particular method only.</code> and this is a best solution for it. Note I&#39;m taking a correction for newbie, who often do not know how to ask a good question or describe problem well."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1536141489, "post_id": 52182193, "comment_id": 91314431, "body": "ok, I think I got it, you are saying that you can have a pointer to an instance that has only one specifc method."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1536145356, "post_id": 52182193, "comment_id": 91316756, "body": "Of course, <code>static_cast&lt;Car*&gt;(windowOpener)-&gt;openDoor()</code> will still open the door. The third solution (<code>std::function</code>) is more robust in that respect, but you need to show how that&#39;s initialized (bind/lambda)"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1536146019, "post_id": 52182193, "comment_id": 91317151, "body": "@MSalters but this won&#39;t be a OOP anymore. And you have to be sure that <code>windowOpener</code> is pointing to a <code>Car</code> (it doesn&#39;t have to)."}, {"owner": {"reputation": 557, "user_id": 2490611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0851f1c138a55b39588e02f9c33ea84?s=128&d=identicon&r=PG", "display_name": "Sonny D", "link": "https://stackoverflow.com/users/2490611/sonny-d"}, "edited": false, "score": 0, "creation_date": 1536146995, "post_id": 52182193, "comment_id": 91317716, "body": "Okay, I understand your solution. If it wouldn&#39;t be just wondering but \t necessity for real implementation your answer will work. Thank you for answer."}], "tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1536141277, "last_edit_date": 1536141277, "creation_date": 1536141159, "answer_id": 52182193, "question_id": 52182009, "link": "https://stackoverflow.com/questions/52182009/is-there-a-way-to-declare-a-pointer-to-a-particular-method-only/52182193#52182193", "title": "Is there a way to declare a pointer to a particular method only?", "body": "<p>This kind of pointers <code>void (Car::*action)(int)</code> are rarely used.\nNowadays there are three preferred ways to approach this:</p>\n\n<ul>\n<li>template parameter (STL algorithms for example)</li>\n<li>interface (pure abstract class)</li>\n<li><code>std::function&lt;void()&gt;</code> and or lambdas</li>\n</ul>\n\n<p>Apparently you need second solution:</p>\n\n<pre><code>class IWindowOpenable {\npublic:\n    virtual ~IWindowOpenable() {}\n\n    virtual void openWindow(int nr) = 0;\n};\n\nclass Car : public IWindowOpenable\n{\npublic:\n    Car();\n    ~Car();\n\n    void startEngie();\n    void openDoor(int nr);\n    void closeDoor(int nr); \n    void openWindow(int nr);\n    void closeWindow(int nr);\n    void turnOnAirConditioner(int vloume);\n};\n\nCar car;\nIWindowOpenable *windowOpener = &amp;Car;\n</code></pre>\n\n<p>Note that anything what is implementing interface <code>IWindowOpenable</code> can operate only on method with name <code>openWindow</code>.\nThis pointer can point to any typo of object which is implementing this interface.</p>\n"}, {"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1536145561, "post_id": 52182800, "comment_id": 91316865, "body": "You could bind an <code>open_door_tag{ }</code>, although the bind result won&#39;t be a member function pointer anymore."}, {"owner": {"reputation": 557, "user_id": 2490611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0851f1c138a55b39588e02f9c33ea84?s=128&d=identicon&r=PG", "display_name": "Sonny D", "link": "https://stackoverflow.com/users/2490611/sonny-d"}, "edited": false, "score": 1, "creation_date": 1536146586, "post_id": 52182800, "comment_id": 91317465, "body": "I satisfied with your answer. To sum up: being very precisely you can&#39;t create this kind of &#39;pointer type&#39; (type word is key), becouse to &#39;pointer to function&#39; you can assign functions with matched signatures. However you can simulate this kind of behavior. By difference signatures as you showed. Or created const pointer <code>void(QSpinBox::* const action)(int)</code> which will force you to initialize on declaration, hence will points to particular function."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1536151225, "post_id": 52182800, "comment_id": 91320433, "body": "@Jarod42, nice observation. Thanks."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 557, "user_id": 2490611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0851f1c138a55b39588e02f9c33ea84?s=128&d=identicon&r=PG", "display_name": "Sonny D", "link": "https://stackoverflow.com/users/2490611/sonny-d"}, "edited": false, "score": 0, "creation_date": 1536151375, "post_id": 52182800, "comment_id": 91320520, "body": "@SonnyD, I think that <code>const</code>ness of a pointer addresses a different issue: you still can assign something meaningless to it upon its construction."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 1, "last_activity_date": 1536151284, "last_edit_date": 1536151284, "creation_date": 1536142938, "answer_id": 52182800, "question_id": 52182009, "link": "https://stackoverflow.com/questions/52182009/is-there-a-way-to-declare-a-pointer-to-a-particular-method-only/52182800#52182800", "title": "Is there a way to declare a pointer to a particular method only?", "body": "<p>In comments you said you're asking a purely academic question, so let me give a purely academic answer. You can't have a pointer to only one method, because all these methods have the same type. What you can do is to make them have different types:</p>\n\n<pre><code>struct Car\n{\n    struct open_door_tag { };\n    struct close_door_tag { };\n\n    void open_left_door(int nr, open_door_tag = {});\n    void open_right_door(int nr, open_door_tag = {});\n    void close_door(int nr, close_door_tag = {});\n};\n</code></pre>\n\n<p>Now if you have a pointer</p>\n\n<pre><code>void (Car::*open_that_door_ptr)(int, Car::open_door_tag);\n</code></pre>\n\n<p>you have some restrictions for assignment:</p>\n\n<pre><code>open_that_door_ptr = &amp;Car::open_left_door;   // OK\nopen_that_door_ptr = &amp;Car::open_right_door;  // OK\n//open_that_door_ptr = &amp;Car::close_door;     // Won't compile\n</code></pre>\n\n<p>Unfortunately (or not), you can't call a method through this pointer without providing a tag:</p>\n\n<pre><code>Car car;\n(car.*open_that_door_ptr)(2, Car::open_door_tag{});\n// or (thanks, @Jarod42)\n(car.*open_that_door_ptr)(2, {});\n// (car.*open_that_door_ptr)(2);     // Won't compile\n</code></pre>\n\n<p><strong>Note.</strong> After I posted this answer I saw a comment by @Jarod42, who suggested to do essentially the same thing.</p>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536147955, "post_id": 52183587, "comment_id": 91318324, "body": "Re &quot;You can&#39;t define a type that is just &quot;one specific value of this other type&quot;: That appears patently wrong to me -- that&#39;s what <code>const</code> types are for. The level of indirection via the <code>CarOperation</code> template is therefore unneeded, isn&#39;t it? What&#39;s the advantage over directly using const member function pointers (as in my example ;-) )?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536148386, "post_id": 52183587, "comment_id": 91318631, "body": "@PeterA.Schneider Yes, it&#39;s pretty much as pointless as the question, of academic interest only. The advantage over you answer is that this one attempts to solve OP&#39;s problem of creating a <i>type</i> that can hold only one specific, predetermined value, while yours solves the problem of storing an arbitrary but immutable value. (Which is not what OP is asking for.)"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1536149495, "post_id": 52183587, "comment_id": 91319369, "body": "I see your point now -- even though <code>CarOperation</code> works with any of the functions it&#39;s determined at compile time and a property of the instantiated type. One consequence is that different <code>CarOperation</code>s  are not assignable or initializable unless they point to the same function anyway. Interesting."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536153349, "post_id": 52183587, "comment_id": 91321836, "body": "Although I gave this +1, the statement &#39;You can&#39;t define a type that is just &quot;one specific value of this other type&quot;&#39; is somewhat misleading, given that&#39;s exactly what you then do. (It&#39;s also the same thing that <code>std::integral_constant</code> does)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1536153966, "post_id": 52183587, "comment_id": 91322306, "body": "@Caleth I see this as a typed wrapper around that value, not as the value itself. That is, it contains the value, but it isn&#39;t the value. I updated the wording a bit in an attempt to make it clearer."}, {"owner": {"reputation": 557, "user_id": 2490611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0851f1c138a55b39588e02f9c33ea84?s=128&d=identicon&r=PG", "display_name": "Sonny D", "link": "https://stackoverflow.com/users/2490611/sonny-d"}, "edited": false, "score": 0, "creation_date": 1536215328, "post_id": 52183587, "comment_id": 91344716, "body": "@molbdnilo Now when I have more time. I changed answer, yours seem to me more accurately. You give me exactly what I wanted: <code>type</code> for one particular method."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 3, "last_activity_date": 1536153924, "last_edit_date": 1536153924, "creation_date": 1536145474, "answer_id": 52183587, "question_id": 52182009, "link": "https://stackoverflow.com/questions/52182009/is-there-a-way-to-declare-a-pointer-to-a-particular-method-only/52183587#52183587", "title": "Is there a way to declare a pointer to a particular method only?", "body": "<p>You can't define a type that <em>is</em> just \"one specific value of this other type\", for instance a type whose only existing value is exactly <code>&amp;Car::closeDoor</code>.</p>\n\n<p>One thing you <em>can</em> do is reach for the Swiss army knife of programming - introduce a level of indirection - and define a type that <em>represents</em> one specific value by wrapping it inside something else.</p>\n\n<pre><code>// Simplified Car\nclass Car\n{\npublic:\n    void openDoor(int i) { std::cout &lt;&lt; \"open door\\n\"; }\n    void closeWindow(int i) { std:cout &lt;&lt; \"close window\\n\"; }\n};\n\nusing Fun = void (Car::*)(int);\n\n// A template for an immutable structure, so it \n// can hold only one specific value; the template argument.\ntemplate&lt;Fun fun&gt;\nstruct CarOperation\n{\n    const Fun f = fun;\n};\n\n// Now we can make one type for each operation\nusing OpenDoor = CarOperation&lt;&amp;Car::openDoor&gt;;\nusing CloseWindow = CarOperation&lt;&amp;Car::closeWindow&gt;;\n\nint main()\n{\n    Car c;\n    OpenDoor d;\n    (c.*d.f)(1);\n    CloseWindow e;\n    (c.*e.f)(2);\n}\n</code></pre>\n\n<p>The syntax is slightly unfortunate, because apparently the <code>.*</code> operator doesn't do any implicit conversion of its right operand.  </p>\n\n<p>Of course, this is just a very roundabout and obfuscated way of simply calling the function indicated by the type.</p>\n\n<p>It would be more useful with a type that can hold a predetermined subset of the functions (like, say, <code>DoorOperation</code> or <code>Opener</code> types).<br>\nYou can probably build that using clever template programming, but I'm not a clever template programmer.</p>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1536148081, "last_edit_date": 1536148081, "creation_date": 1536147572, "answer_id": 52184263, "question_id": 52182009, "link": "https://stackoverflow.com/questions/52182009/is-there-a-way-to-declare-a-pointer-to-a-particular-method-only/52184263#52184263", "title": "Is there a way to declare a pointer to a particular method only?", "body": "<p>Marek's correct advice to consider using more C++-idiomatic alternatives notwithstanding, your wish is reasonable and can be granted with a simple <code>const</code>.</p>\n\n<p>The reason one might want to do that is the same as with all other const definitions (which all could principally be replaced by the right side of their definition): One wants to have a symbolic name so that the meaning of the specific value is understandable in the context of its use, and one wants to have a single point of maintenance in case one wants to change the <code>const</code> value. That's why everybody frowns at integer literals in code. </p>\n\n<p>These exact reasons apply to the definition of <code>const int</code>s and <code>void (Car::*const action)(int)</code>s alike.</p>\n\n<p>So if, to give a contrived example, you want a function which is called every time the car is started, as a non-mutable property of that specific car, you could declare an <code>atStart</code> constant member function pointer as a member (I introduced a typedef as well). The pointer must be initialized in the car's constructor, as all const members must.</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nstruct Car\n{\n        typedef void (Car::* const CarfuncT)(void);\n        Car(CarfuncT atStartArg)\n            : atStart(atStartArg) \n        {}\n        void startEngine() { cout &lt;&lt; \"Start Engine\\n\"; (this-&gt;*atStart)(); };\n        void turnOnAC() { cout &lt;&lt; \"AC on\\n\"; }\n        void turnOnHeat() { cout &lt;&lt; \"Heat on\\n\"; }\n        void turnOnRadio() { cout &lt;&lt; \"Radio on\\n\"; }\n        void (Car::* const atStart)();\n};\n</code></pre>\n\n<p>User code could look like this:</p>\n\n<pre><code>int main()\n{\n  cout &lt;&lt; \"I'll create a configured car. In which state do you live?\\n\";\n\n  string state;\n  cin &gt;&gt; state;\n  Car *car = new Car(state == \"Texas\" ? &amp;Car::turnOnAC : &amp;Car::turnOnRadio);\n\n  car-&gt;startEngine();\n\n  delete car;\n}\n</code></pre>\n"}], "owner": {"reputation": 557, "user_id": 2490611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0851f1c138a55b39588e02f9c33ea84?s=128&d=identicon&r=PG", "display_name": "Sonny D", "link": "https://stackoverflow.com/users/2490611/sonny-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 52183587, "answer_count": 4, "score": 2, "last_activity_date": 1538306456, "creation_date": 1536140689, "last_edit_date": 1538306456, "question_id": 52182009, "link": "https://stackoverflow.com/questions/52182009/is-there-a-way-to-declare-a-pointer-to-a-particular-method-only", "title": "Is there a way to declare a pointer to a particular method only?", "body": "<p>I have a class:</p>\n\n<pre><code>class Car\n{\n    public:\n        Car();\n        ~Car();\n        // nr indicates which particular door.\n        void startEngie();\n        void openDoor(int nr);\n        void closeDoor(int nr); \n        void openWindow(int nr);\n        void closeWindow(int nr);\n        void turnOnAirConditioner(int vloume);\n}\n</code></pre>\n\n<p>Now by <code>void (Car::*action)(int)</code> I declare a pointer named <code>action</code> to <code>Car</code> method. The problem is that many methods can be assigned to it: <code>&amp;Car::openDoor</code>, <code>&amp;Car::closeDoor</code>, <code>&amp;Car::openWindow</code>, <code>&amp;Car::closeWindow</code>, <code>&amp;Car::turnOnAirConditioner</code>, but not <code>&amp;Car::startEngie</code>.</p>\n\n<p>I wonder if I am right: there is no way to declare a pointer to a particular method only. In other words: <code>pointer type</code>, which accept only a particular named function, can't be declared.</p>\n"}, {"tags": ["c++", "regex", "c++11", "boost", "boost-regex"], "answers": [{"comments": [{"owner": {"reputation": 969, "user_id": 2928544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yeaGD.jpg?s=128&g=1", "display_name": "raidensan", "link": "https://stackoverflow.com/users/2928544/raidensan"}, "edited": false, "score": 0, "creation_date": 1536142804, "post_id": 52182598, "comment_id": 91315228, "body": "Thanks for your answer. I tried both <code>&quot;\\\\.&#47;some_\\\\d+_file\\\\.txt&quot;</code> and <code>&quot;\\\\.*some_\\\\d+_file\\\\.txt&quot;</code> as my pattern. Unfortunately none of them worked. Still get 0 match. I am gonna try <code>regex_search</code>."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "reply_to_user": {"reputation": 969, "user_id": 2928544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yeaGD.jpg?s=128&g=1", "display_name": "raidensan", "link": "https://stackoverflow.com/users/2928544/raidensan"}, "edited": false, "score": 1, "creation_date": 1536148217, "post_id": 52182598, "comment_id": 91318518, "body": "Yes, as mentioned by @user338371 you also have enclosing quotes in your filenames which must be taken into consideration when looking for a full match."}], "tags": [], "owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "is_accepted": false, "score": 2, "last_activity_date": 1536142390, "creation_date": 1536142390, "answer_id": 52182598, "question_id": 52181884, "link": "https://stackoverflow.com/questions/52181884/unable-to-find-matches-using-boost-regex/52182598#52182598", "title": "Unable to find matches using Boost RegEx", "body": "<p>Because <code>regex_match</code> considers only a FULL match. That means, you need to include <code>./</code> in your pattern. Also you escaped the last dot incorrectly. Your pattern should be:</p>\n\n<pre><code>boost::regex pattern(\"\\\\./some_\\\\d+_file\\\\.txt\");\n</code></pre>\n\n<p>(or you can use <code>.*</code> as the beginning of the filepath, just not to hardcode <code>./</code>)</p>\n\n<p>Alternatively, you can use <code>regex_search</code> which returns TRUE if part of the string matches the expression.</p>\n"}, {"comments": [{"owner": {"reputation": 969, "user_id": 2928544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yeaGD.jpg?s=128&g=1", "display_name": "raidensan", "link": "https://stackoverflow.com/users/2928544/raidensan"}, "edited": false, "score": 0, "creation_date": 1536143274, "post_id": 52182768, "comment_id": 91315534, "body": "This solved my issue, thank you. The only difference with @Ptaq66&#39;s answer is <code>ss &lt;&lt; entry.path().string();</code> line."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 4, "creation_date": 1536148354, "post_id": 52182768, "comment_id": 91318615, "body": "There&#39;s zero reason to bother with the stream in the first place. Also, take the regex out of the loop. Lastly, no need for the iterator range (yes, that&#39;s <a href=\"https://en.cppreference.com/w/cpp/filesystem/directory_iterator/begin\" rel=\"nofollow noreferrer\">surprising</a>) Much simplified demo:  <a href=\"http://coliru.stacked-crooked.com/a/ca553af0515f16f3\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/ca553af0515f16f3</a>"}], "tags": [], "owner": {"reputation": 139, "user_id": 7098275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b321655ea8ff4fe039d206d0e90097d?s=128&d=identicon&r=PG&f=1", "display_name": "user338371", "link": "https://stackoverflow.com/users/7098275/user338371"}, "is_accepted": true, "score": 2, "last_activity_date": 1536142848, "creation_date": 1536142848, "answer_id": 52182768, "question_id": 52181884, "link": "https://stackoverflow.com/questions/52181884/unable-to-find-matches-using-boost-regex/52182768#52182768", "title": "Unable to find matches using Boost RegEx", "body": "<pre><code>boost::filesystem::path p(\".\");\nif (is_directory(p)) {\n\n    for (auto&amp; entry : boost::make_iterator_range(boost::filesystem::directory_iterator(p), {})) {\n        std::stringstream ss;\n        ss &lt;&lt; entry.path().string(); //2\n        std::string filename = ss.str();\n        std::cout &lt;&lt; filename &lt;&lt; std::endl;\n        boost::regex pattern(\".*some_\\\\d+_file\\\\.txt\"); //1\n        if (boost::regex_match(filename, pattern)) {\n            std::cout &lt;&lt; \"matched\" &lt;&lt; filename &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n\n<p>1.<code>regex_match</code> only consider a full match</p>\n\n<p>2.<code>operator&lt;&lt;(std::basic_ostream&lt;Char, Traits&gt;&amp; os, const path&amp; p)</code> will use <code>boost::io::quoted()</code> and add quotes to handle spaces in paths</p>\n"}], "owner": {"reputation": 969, "user_id": 2928544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yeaGD.jpg?s=128&g=1", "display_name": "raidensan", "link": "https://stackoverflow.com/users/2928544/raidensan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "accepted_answer_id": 52182768, "answer_count": 2, "score": 0, "last_activity_date": 1536142848, "creation_date": 1536140282, "last_edit_date": 1536140567, "question_id": 52181884, "link": "https://stackoverflow.com/questions/52181884/unable-to-find-matches-using-boost-regex", "title": "Unable to find matches using Boost RegEx", "body": "<p>I am using <em>boost 1.67.0 regex</em> to find matching filenames in current folder using following snippet</p>\n\n<pre><code>boost::filesystem::path p(\".\");\nif(is_directory(p)) {\n\n    for(auto&amp; entry : boost::make_iterator_range(boost::filesystem::directory_iterator(p), {})){\n        std::stringstream ss;\n        ss &lt;&lt; entry;\n        std::string filename = ss.str();\n        std::cout &lt;&lt; filename &lt;&lt; std::endl;\n        boost::regex pattern(\"some_\\\\d+_file\\.txt\");\n\n        if(boost::regex_match(filename, pattern)){\n            std::cout &lt;&lt; \"matched\" &lt;&lt; filename &lt;&lt; std::endl;\n        }            \n    }   \n}\n</code></pre>\n\n<p>Contents of current directory, produced by <code>std::cout &lt;&lt; filename &lt;&lt; std::endl;</code> line, are:</p>\n\n<pre><code>\"./myApp.out\"\n\"./some_0_file.txt\"\n\"./some_1_file.txt\"\n\"./other_file.txt\"\n\"./some_other_file.txt\"\n\"./some_2_file.txt\"\n</code></pre>\n\n<p>To confirm that my matching expression is correct I consulted <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html\" rel=\"nofollow noreferrer\">Perl Regular Expression Syntax</a>. Also confirmed it using <a href=\"https://regex101.com\" rel=\"nofollow noreferrer\">RegEx101.com</a>, output correctly shows 3 matches as follows:</p>\n\n<pre><code>some_0_file.txt\nsome_1_file.txt\nsome_2.file.txt\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<p>Is there anything wrong with my snippet or RegEx? Why <code>boost::regex_match</code> produce 0 match?</p>\n\n<p>What have I missed?</p>\n"}]