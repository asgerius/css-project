[{"tags": ["c++", "cmake", "spdlog"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1539243639, "post_id": 52750271, "comment_id": 92432783, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15449949/cmake-can-not-find-include-files\">CMake can not find include files</a>"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 9378561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f347e5b2e8527c2f5e417803a4a350c3?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Silvestri", "link": "https://stackoverflow.com/users/9378561/nick-silvestri"}, "edited": false, "score": 0, "creation_date": 1539283160, "post_id": 52754005, "comment_id": 92456520, "body": "It was a matter of including the current directory in the search path. It seems obvious because the current directory is the one that contains <code>spdlog&#47;</code> so then obviously the <code>spdlog&#47;&lt;whatever&gt;.h</code> can be resolved. Thanks."}], "tags": [], "owner": {"reputation": 504, "user_id": 4927117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bPhHv6SJSWg/AAAAAAAAAAI/AAAAAAAAAA4/cL7oVZzvbno/photo.jpg?sz=128", "display_name": "Wei Guo", "link": "https://stackoverflow.com/users/4927117/wei-guo"}, "is_accepted": true, "score": 1, "last_activity_date": 1539240863, "creation_date": 1539240863, "answer_id": 52754005, "question_id": 52750271, "link": "https://stackoverflow.com/questions/52750271/installing-spdlog-by-copying-contents-of-include-directory/52754005#52754005", "title": "Installing spdlog by copying contents of include directory", "body": "<p>You need to add the project root directory into the cmake include_directories, like this:</p>\n\n<pre><code>include_directories(\n    /absolute/path/\n)\n</code></pre>\n\n<p>Or in the project root directory, edit CMakeLists.txt and add this:</p>\n\n<pre><code>include_directories(\n    .\n)\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 9378561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f347e5b2e8527c2f5e417803a4a350c3?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Silvestri", "link": "https://stackoverflow.com/users/9378561/nick-silvestri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 52754005, "answer_count": 1, "score": 0, "last_activity_date": 1539240863, "creation_date": 1539215536, "last_edit_date": 1539223757, "question_id": 52750271, "link": "https://stackoverflow.com/questions/52750271/installing-spdlog-by-copying-contents-of-include-directory", "title": "Installing spdlog by copying contents of include directory", "body": "<p>I'm trying to use spdlog as a logging library, but I do not want to use my package manager (apt) to install it. I have copied the spdlog directory under include to the root of my project directory, but when I try to compile I get include errors because the <code>#include</code> directives in the spdlog headers are all absolute (relative to the project root), instead of relative, gcc cannot find the files.</p>\n\n<pre><code>0:10: fatal error: spdlog/common.h: No such file or directory\n #include \"spdlog/common.h\"\n</code></pre>\n\n<p>Short of changing all the includes in the spdlog library to relative, how can I use spdlog in my project? I'm also using CMake to compile my project; I have a <code>build</code> directory in my project root and from within it I call <code>cmake ..</code> and then <code>make</code> to compile; is there something I need to add to my CMakeLists.txt file to include spdlog?</p>\n"}, {"tags": ["c++", "templates", "language-lawyer", "auto", "incomplete-type"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1539215546, "post_id": 52750143, "comment_id": 92424774, "body": "Is this simplified version the same issue? <a href=\"https://godbolt.org/z/9V4fx7\" rel=\"nofollow noreferrer\">godbolt.org/z/9V4fx7</a>  Note: gcc compiles; clang report an error."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1539215912, "post_id": 52750143, "comment_id": 92424861, "body": "@RichardCritten: Not sure, your function is template, whereas mine is a friend function of class template."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1539216436, "post_id": 52750143, "comment_id": 92424971, "body": "@RichardCritten, also, Jarod42 code works with gcc and clang."}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539216025, "post_id": 52750273, "comment_id": 92424887, "body": "<code>f</code> is not a function template here(friend function of class template) though, but I suppose it is the same."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539216199, "post_id": 52750273, "comment_id": 92424921, "body": "@Jarod42 Yeah, that&#39;s probably a wording issue."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539216350, "post_id": 52750273, "comment_id": 92424958, "body": "Does this mean that without <code>auto</code> (C++98) it is not possible to make it work?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539216723, "post_id": 52750273, "comment_id": 92425038, "body": "@alfC Defining a non-member friend inline? Nope."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539258774, "post_id": 52750273, "comment_id": 92441851, "body": "@Jarod42 <a href=\"https://github.com/cplusplus/draft/pull/2350\" rel=\"nofollow noreferrer\">github.com/cplusplus/draft/pull/2350</a>, fixed editorially"}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1616013591, "post_id": 52750273, "comment_id": 117874017, "body": "With the years I found compilers (nvcc, intel) for which auto friend will choke SFINAE (the function is not detected). That is one problem of auto friends. I suppose it is not standard. I think this happens when the compiler cannot deduce auto in the &quot;first pass&quot;."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 8, "last_activity_date": 1539262173, "last_edit_date": 1539262173, "creation_date": 1539215539, "answer_id": 52750273, "question_id": 52750143, "link": "https://stackoverflow.com/questions/52750143/incomplete-class-usage-with-auto-in-template-class/52750273#52750273", "title": "incomplete class usage with auto in template class", "body": "<p><a href=\"http://eel.is/c++draft/dcl.fct.def#general-2.sentence-3\" rel=\"nofollow noreferrer\">[dcl.fct.def.general]/2</a>:</p>\n\n<blockquote>\n  <p>The type of a parameter or the return type for a function definition <strong>shall not be an incomplete or abstract (possibly cv-qualified) class type</strong> in the context of the function definition unless the function is deleted ([dcl.fct.def.delete]).</p>\n</blockquote>\n\n<p>But <a href=\"http://eel.is/c++draft/dcl.spec.auto#10\" rel=\"nofollow noreferrer\">[dcl.spec.auto]/10</a>:</p>\n\n<blockquote>\n  <p>Return type deduction for a function template with a placeholder in its declared type occurs when the definition is instantiated even if the function body contains a <code>return</code> statement with a non-type-dependent operand. </p>\n</blockquote>\n\n<p>So with <code>B</code>, it's ill-formed by the first rule. But with <code>auto</code>, deduction doesn't take place until the function is instantiated... by which point the type is complete, so it's fine.</p>\n\n<p>Note that the first rule only applies to the definition, which is why <code>do_f()</code> is okay. You can have declarations which return incomplete types.</p>\n\n<hr />\n\n<p>The above wording technically doesn't apply to this case. We don't have a function template. But the intent is for it to apply to any kind of templated thing. There's a <a href=\"https://github.com/cplusplus/draft/pull/2350\" rel=\"nofollow noreferrer\">PR</a> to editorially fix this from:</p>\n\n<blockquote>\n  <p>Return type deduction for a <strong>function template</strong> with a placeholder [...]</p>\n</blockquote>\n\n<p>To:</p>\n\n<blockquote>\n  <p>Return type deduction for a <strong>templated entity that is a function or function template</strong> with a placeholder in its</p>\n</blockquote>\n\n<p>Which does apply here.</p>\n"}], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 1, "accepted_answer_id": 52750273, "answer_count": 1, "score": 10, "last_activity_date": 1539262173, "creation_date": 1539214443, "question_id": 52750143, "link": "https://stackoverflow.com/questions/52750143/incomplete-class-usage-with-auto-in-template-class", "title": "incomplete class usage with auto in template class", "body": "<p>Is the following code well formed ?</p>\n\n<pre><code>class B;\n\ntemplate&lt;class T&gt;\nclass A\n{\n    B do_f() const;\n    friend auto f(A const&amp; a) {return a.do_f();} // #1\n};\n\nclass B{};\n\ntemplate &lt;class T&gt;\nB A&lt;T&gt;::do_f() const { return B{};}\n\nint main()\n{\n    A&lt;double&gt; a;\n    f(a);\n}\n</code></pre>\n\n<p>If I change <code>auto</code> in #1 by <code>B</code>, I got incomplete type error message.</p>\n\n<p>Compile with <code>auto</code> for gcc/clang <a href=\"http://coliru.stacked-crooked.com/a/478d447cfe83bbf1\" rel=\"noreferrer\">Demo</a></p>\n\n<p>Fail with <code>B</code> <a href=\"http://coliru.stacked-crooked.com/a/680a5b68f0721352\" rel=\"noreferrer\">Demo</a></p>\n"}, {"tags": ["c++", "templates", "c++14", "overloading"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1539212471, "post_id": 52749850, "comment_id": 92424132, "body": "Look at common mistake of <a href=\"https://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\"><code>std::enable_if</code></a> usage."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1539215862, "post_id": 52749874, "comment_id": 92424851, "body": "I would opt for more explicit tag names, which would allow for additional conditions to be added later on if needed: <code>struct IsArithmeticTag {}; struct IsClassTag {}; void f_helper(..., IsArithmeticTag) { ... } void f_helper(..., IsClassTag) { ... } void f(...) { f_helper(..., typename std::conditional&lt;std::is_arithmetic&lt;P&gt;::value, IsArithmeticTag, IsClassTag&gt;::type{}); }</code>  <a href=\"https://ideone.com/51SOyi\" rel=\"nofollow noreferrer\">Live Demo</a>"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 3, "last_activity_date": 1539212200, "creation_date": 1539212200, "answer_id": 52749874, "question_id": 52749850, "link": "https://stackoverflow.com/questions/52749850/overloading-function-with-multiple-template-definitions-not-possible/52749874#52749874", "title": "Overloading function with multiple template definitions not possible?", "body": "<p>Use tag dispatch, like this or similar:</p>\n\n<pre><code>void f_helper(std::vector&lt;P&gt;* a, std::true_type) {\n    /* implementation for arithmetic type P */\n}\n\nvoid f_helper(std::vector&lt;P&gt;* a, std::false_type) {\n    /* implementation for class type P */\n}\n\nvoid f(std::vector&lt;P&gt;* a) {\n    return f_helper(a, std::is_arithmetic&lt;P&gt;{});\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1539216030, "last_edit_date": 1539216030, "creation_date": 1539214711, "answer_id": 52750176, "question_id": 52749850, "link": "https://stackoverflow.com/questions/52749850/overloading-function-with-multiple-template-definitions-not-possible/52750176#52750176", "title": "Overloading function with multiple template definitions not possible?", "body": "<p>The <a href=\"https://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\"><code>std::enable_if</code></a> documentation on cppreference.com says:</p>\n\n<blockquote>\n  <p>A common mistake is to declare two function templates that differ only in their default template arguments. This is illegal because <strong>default template arguments are not part of function template's signature</strong>, and declaring two different function templates with the same signature is illegal.</p>\n</blockquote>\n\n<p>The examples on that same page show a similar situation as yours, and solve it by changing the template on one of the overloads, while maintaining the same signature for the functions themselves:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// #4, enabled via a template parameter\ntemplate&lt;class T,\n         typename std::enable_if&lt;\n             !std::is_trivially_destructible&lt;T&gt;{} &amp;&amp;\n             (std::is_class&lt;T&gt;{} || std::is_union&lt;T&gt;{}),\n            int&gt;::type = 0&gt;\nvoid destroy(T* t)\n{\n    std::cout &lt;&lt; \"destroying non-trivially destructible T\\n\";\n    t-&gt;~T();\n}\n\n// #5, enabled via a template parameter\ntemplate&lt;class T,\n    typename = std::enable_if_t&lt;std::is_array&lt;T&gt;::value&gt; &gt;\nvoid destroy(T* t) // note, function signature is unmodified\n{\n    for(std::size_t i = 0; i &lt; std::extent&lt;T&gt;::value; ++i) {\n        destroy((*t)[i]);\n    }\n}\n/*\ntemplate&lt;class T,\n    typename = std::enable_if_t&lt;std::is_void&lt;T&gt;::value&gt; &gt;\nvoid destroy(T* t){} // error: has the same signature with #5\n*/\n</code></pre>\n\n<p>So, you can do something similar in your code:</p>\n\n<pre><code>template&lt;typename P, std::enable_if_t&lt;std::is_arithmetic&lt;P&gt;::value, int&gt; = 0&gt;\nvoid f(std::vector&lt;P&gt;* a)\n{\n    // body for arithmetic P\n}\n\ntemplate&lt;typename P, typename = std::enable_if_t&lt;std::is_class&lt;P&gt;::value&gt;&gt;\nvoid f(std::vector&lt;P&gt;* a)\n{\n    // body for class P\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/tykuCK\" rel=\"nofollow noreferrer\">Live Demo</a></p>\n"}], "owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 52750176, "answer_count": 2, "score": 1, "last_activity_date": 1539216030, "creation_date": 1539212018, "question_id": 52749850, "link": "https://stackoverflow.com/questions/52749850/overloading-function-with-multiple-template-definitions-not-possible", "title": "Overloading function with multiple template definitions not possible?", "body": "<p>I tried this:</p>\n\n<pre><code>template&lt;typename P, typename = std::enable_if_t&lt;std::is_arithmetic&lt;P&gt;::value&gt;&gt;\nvoid f(std::vector&lt;P&gt;* a) {\n    // body for arithmetic P\n}\n\ntemplate&lt;typename P, typename = std::enable_if_t&lt;std::is_class&lt;P&gt;::value&gt;&gt;\nvoid f(std::vector&lt;P&gt;* a) {\n    // body for class P\n}\n</code></pre>\n\n<p>I thought it would overload <code>f</code> as the conditions are mutually exclusive, but found that it doesn't compile: \"function template has already been defined\".</p>\n\n<p>What to do instead, if I want the function body of <code>f(std::vector&lt;P&gt;*)</code> to depend on whether <code>P</code> is arithmetic?</p>\n"}, {"tags": ["c++", "c++11", "templates", "friend-function", "function-templates"], "answers": [{"comments": [{"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539213797, "post_id": 52749999, "comment_id": 92424441, "body": "... and if not, then it tries to deduce what goes in inside the <code>&lt;&gt;</code>?"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539215875, "post_id": 52749999, "comment_id": 92424855, "body": "@alfC If <code>f</code> has all default template arguments or the template parameters are deduced through template argument deduction, then yes it deduces what goes inside <code>&lt;&gt;</code> from the parameter list of the friend declaration."}], "tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": false, "score": 4, "last_activity_date": 1539214315, "last_edit_date": 1539214315, "creation_date": 1539213187, "answer_id": 52749999, "question_id": 52749794, "link": "https://stackoverflow.com/questions/52749794/what-is-the-meaning-of-angle-bracket-in-the-declaration-of-a-function-as-a-frien/52749999#52749999", "title": "What is the meaning of angle bracket in the declaration of a function as a friend?", "body": "<p>It is the same as <code>friend double f&lt;T&gt;(A&lt;T&gt; const&amp;)</code>. You would normally use the empty template arguments to disambiguate between a function non-template <code>f</code> and a function template <code>f</code>. If you did not have <code>&lt;&gt;</code> the compiler would've created an entirely separate non-template function <code>f</code> and the other <code>f&lt;T&gt;</code> would not be able to access private members.</p>\n\n<pre><code>template&lt;class T&gt; class A;\ntemplate&lt;class T&gt; double f(A&lt;T&gt; const&amp; a);\ntemplate&lt;class T&gt;\nclass A {\n  double p_;\n  friend double f(A&lt;T&gt; const&amp; a); // notice omission of &lt;&gt;, declared as non-template\n};\n\ntemplate&lt;class T&gt;\ndouble f(A&lt;T&gt; const&amp; a) {\n  return a.p_;\n}\n\nint main() {\n  f&lt;&gt;( A&lt;int&gt;{} ); // 'double A&lt;int&gt;::p_' is private within this context\n}\n</code></pre>\n\n<blockquote>\n  <p>Is is [sic] the case that more generally: </p>\n\n<pre><code>template&lt;class T1, class T2, ...&gt;\nclass A{\n    double p_;\n    friend double f&lt;&gt;(A const&amp; a); // same as double f&lt;T1, T2, ...&gt;?\n};\n</code></pre>\n</blockquote>\n\n<p>If, for instance, <code>f</code> is declared outside the class as <code>template&lt;class...Ts&gt;f(A&lt;Ts...&gt;);</code> then yes, they are equivalent.</p>\n"}, {"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 4, "last_activity_date": 1539218070, "last_edit_date": 1539218070, "creation_date": 1539217129, "answer_id": 52750412, "question_id": 52749794, "link": "https://stackoverflow.com/questions/52749794/what-is-the-meaning-of-angle-bracket-in-the-declaration-of-a-function-as-a-frien/52750412#52750412", "title": "What is the meaning of angle bracket in the declaration of a function as a friend?", "body": "<p>In most cases when the name of a template is used, the compiler needs to determine what the template arguments are, which determines the exact specialization of a template it represents.</p>\n\n<p>It sounds like you're familiar with how this is done for class templates (ignoring template parameter packs for simplicity):</p>\n\n<ol>\n<li><p>Each argument within the <code>&lt;&gt;</code> is one of the template arguments, in order from the beginning.</p></li>\n<li><p>If the template has more template parameters than there are arguments within the <code>&lt;&gt;</code>, default template arguments are used for the remaining positions (and those default template arguments must exist).</p></li>\n</ol>\n\n<p>But for function templates, there's a third possibility, of automatically deducing template arguments.  You might be familiar with the idea of deducing template arguments from a call to a function template in a form like <code>func(a1, a2)</code>.  But deduction is also possible in a form like <code>func&lt;x1, x2&gt;(a1, a2)</code>, and can mix and match with the other sources of template arguments (again ignoring template parameter packs):</p>\n\n<ol>\n<li><p>Each argument within the <code>&lt;&gt;</code> is one of the template arguments, in order from the beginning.  These are substituted for the corresponding template parameters everywhere in the function type before moving on to the next step.</p></li>\n<li><p>Any remaining template parameters can be deduced (from the types of argument expressions in a call, or from the declared parameter types when matching declarations in cases like this <code>friend</code> usage).</p></li>\n<li><p>For any remaining template parameters not explicitly specified and not deduced, a default template argument can be used.  (C++11 and later only - C++03 did not allow function templates to have default template arguments at all.)</p></li>\n</ol>\n\n<p>So in the case of a function call, it's valid to use <code>func&lt;&gt;(a1, a2)</code>, which means all the template arguments are to be either deduced from the types of <code>a1</code> and <code>a2</code> or else taken from a default template argument.  This is mostly the same as just <code>func(a1, a2)</code>, except that for <code>func(a1, a2)</code>, overload resolution might select a non-template function which is also named <code>func</code>; but using <code>func&lt;&gt;(a1, a2)</code>, only templates are eligible for consideration.</p>\n\n<p>Similarly, a template argument list can be needed in a friend declaration to make sure the compiler knows it names a specialization of a function template, and not a plain non-template function.  Again, often an empty list <code>&lt;&gt;</code> will do, assuming all the template arguments can be deduced from the function parameter types.  Note the differences here:</p>\n\n<pre><code>template &lt;class T&gt; class A;\n\ntemplate &lt;class X&gt; void f1(A&lt;X&gt;);\ntemplate &lt;class X&gt; void f2(A&lt;X&gt;);\ntemplate &lt;class X&gt; void f3(A&lt;X&gt;);\ntemplate &lt;class X&gt; void f4(A&lt;X&gt;);\n\ntemplate &lt;class T&gt;\nclass A {\n    // For each class type A&lt;T&gt;, declares just the one specialization f1&lt;T&gt;\n    // to be a friend.  So f1&lt;int&gt;(A&lt;int&gt;) is a friend of A&lt;int&gt;, but is not\n    // a friend of A&lt;double&gt;.\n    friend void f1&lt;T&gt;(A&lt;T&gt;);\n\n    // Exactly the same (but for f2&lt;T&gt;).\n    // A is the \"injected class name\" typedef for A&lt;T&gt;.\n    // The argument for f2's X is deduced to be X=T.\n    friend void f2&lt;&gt;(A);\n\n    // Declares ALL specializations of f3 to be friends of all specializations of A.\n    template &lt;class U&gt;\n    friend void f3(A&lt;U&gt;);\n\n    // Declares a non-template function.  Each class type A&lt;T&gt; declares\n    // a different function unrelated to the template f4 above or to\n    // the f4 declared by other A&lt;U&gt; types.  You could define the\n    // individual overloaded functions void f4(A&lt;int&gt;), void f4(A&lt;double&gt;),\n    // etc., but only one at a time, and only if you know all the\n    // possible types to be used!\n    friend void f4(A);\n};\n</code></pre>\n\n<blockquote>\n  <p>Is it the case that more generally:</p>\n\n<pre><code>template&lt;class T1, class T2, ...&gt;\nclass A{\n    double p_;\n    friend double f&lt;&gt;(A const&amp; a); // same as double f&lt;T1, T2, ...&gt;?\n};\n</code></pre>\n  \n  <p>?</p>\n</blockquote>\n\n<p>Possibly. Though it's not just a matter of taking the template arguments directly from the enclosing class template specialization being instantiated. Template argument deduction can get fancier. For example, if we have</p>\n\n<pre><code>template &lt;class T1, class T2&gt; class A;\n\ntemplate &lt;class X&gt;\ndouble f(A&lt;X, X&gt; const&amp; a);   // #1\ntemplate &lt;class X&gt;\ndouble f(A&lt;X, X*&gt; const&amp; a);  // #2\ntemplate &lt;class X, class Y&gt;\ndouble f(A&lt;X, Y&gt; const&amp; a);   // #3\n\ntemplate &lt;class T1, class T2&gt;\nclass A {\n    friend double f&lt;&gt;(A const&amp;);\n};\n</code></pre>\n\n<p>then which template declaration matches will actually be different for different specializations of <code>A</code>!  The function <code>double f&lt;int&gt;(A&lt;int, int&gt; const&amp;)</code> from template #1 is a friend of <code>A&lt;int, int&gt;</code>, the function <code>double f&lt;int&gt;(A&lt;int, int*&gt; const&amp;)</code> from template #2 is a friend of <code>A&lt;int, int*&gt;</code>, and the function <code>double f&lt;int*, int&gt;(A&lt;int*, int&gt; const&amp;)</code> from template #3 is a friend of <code>A&lt;int*, int&gt;</code>.  No other template specializations are friends of those three specializations of <code>A</code>.</p>\n"}], "owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1539218070, "creation_date": 1539211676, "last_edit_date": 1539213727, "question_id": 52749794, "link": "https://stackoverflow.com/questions/52749794/what-is-the-meaning-of-angle-bracket-in-the-declaration-of-a-function-as-a-frien", "title": "What is the meaning of angle bracket in the declaration of a function as a friend?", "body": "<p>I have a hard time understanding the notation <code>&lt;&gt;</code> in the declaration of a function as a friend. (This is originated by needing to define the body of a function that was an injected friend into an external free function.)</p>\n\n<pre><code>template&lt;class T&gt; class A;\n\ntemplate&lt;class T&gt; double f(A&lt;T&gt; const&amp; a);\n\ntemplate&lt;class T&gt;\nclass A{\n    double p_;\n    friend double f&lt;&gt;(A&lt;T&gt; const&amp; a); // same as friend double f&lt;&gt;(A const&amp; a);\n};\n</code></pre>\n\n<p><strong>Is this exactly equivalent to <code>friend double f&lt;T&gt;(A&lt;T&gt; const&amp; a);</code>?\nIf so, what is the purpose of this notation <code>&lt;&gt;</code>? After all <code>f</code> doesn't have default template parameters.</strong></p>\n\n<p>Is it the case that more generally:</p>\n\n<pre><code>template&lt;class T1, class T2, ...&gt;\nclass A{\n    double p_;\n    friend double f&lt;&gt;(A const&amp; a); // same as double f&lt;T1, T2, ...&gt;?\n};\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 1, "creation_date": 1539213714, "post_id": 52749796, "comment_id": 92424431, "body": "I thought (maybe I&#39;m mistaken) that default implementations of ctors are <code>noexcept</code> if possible, which should be the case for <code>M</code> and thus also for <code>X</code> here. So why is the dtor still potentially invoked, if no exception can be thrown?"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 3, "last_activity_date": 1539211693, "last_edit_date": 1592644375, "creation_date": 1539211693, "answer_id": 52749796, "question_id": 52749756, "link": "https://stackoverflow.com/questions/52749756/why-class-constructor-generates-destructors-for-its-members/52749796#52749796", "title": "Why class constructor generates destructors for its members?", "body": "<p>The constructor of your <code>X</code> <em>potentially invokes</em> destructors of its member subobjects for obvious reason: if an exception occurs during construction, everything that has been successfully constructed has to be destructed.</p>\n<blockquote>\n<p><strong>10.9.2 Initializing bases and members</strong></p>\n<p><strong>12</strong> In a non-delegating constructor, the destructor for each potentially constructed subobject of class type is potentially invoked (15.4). [ Note: This provision ensures that destructors can be called for fully-constructed subobjects in case an exception is thrown (18.2). \u2014end note ]</p>\n</blockquote>\n<p><a href=\"http://eel.is/c++draft/class.base.init#12\" rel=\"nofollow noreferrer\">http://eel.is/c++draft/class.base.init#12</a></p>\n"}], "owner": {"reputation": 315, "user_id": 2551229, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a86c4d4cd323ba022a82fb6f3d562069?s=128&d=identicon&r=PG", "display_name": "user2551229", "link": "https://stackoverflow.com/users/2551229/user2551229"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1539212072, "answer_count": 1, "score": 1, "last_activity_date": 1539211693, "creation_date": 1539211320, "question_id": 52749756, "link": "https://stackoverflow.com/questions/52749756/why-class-constructor-generates-destructors-for-its-members", "closed_reason": "Duplicate", "title": "Why class constructor generates destructors for its members?", "body": "<h2>Let's start with the warm-up.</h2>\n\n<p>I created a class template whose destructor just cannot be instantiated without compiler activating <code>static_assert</code>:</p>\n\n<p><em>File: M.hpp</em></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T&gt;\nstruct M\n{\n    M(){}\n    ~M()\n    {\n        static_assert(sizeof(T) == 0, \"no type can pass this\");\n    }\n};\n</code></pre>\n\n<p>Next I used this class in two different ways: allocate it on heap and allocate it on stack:</p>\n\n<p><em>File main.cpp</em></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"M.hpp\"\n\nint main()\n{\n    M&lt;int&gt; *pmi = new M&lt;int&gt;(); // does compile\n    M&lt;int&gt; mi;                  // doen't compile\n}\n</code></pre>\n\n<p>Allocating it on a heap <code>M&lt;int&gt; *pmi = new M&lt;int&gt;();</code> works. It is so as we only use constructor and don't need destructor. The rules for class template implicit instantiation <a href=\"https://en.cppreference.com/w/cpp/language/class_template#Implicit_instantiation\" rel=\"nofollow noreferrer\">say</a>: </p>\n\n<blockquote>\n  <p>... unless the member is used in the program, it is not instantiated ...</p>\n</blockquote>\n\n<p>Allocating it on stack <code>M&lt;int&gt; mi;</code> doesn't work as compiler definitely need to instantiate the destructor.</p>\n\n<p>So far so good, clear rules.</p>\n\n<h2>Let's get to the point.</h2>\n\n<p>I wrote another class which uses <code>M</code> as a member:</p>\n\n<p><em>File X.cpp</em></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"M.hpp\"\n\nstruct X\n{\n    X() = default;\n    ~X() = delete;\n\nprivate:\n    M&lt;int&gt; m_;\n};\n</code></pre>\n\n<p>I deleted the destructor intentionally because I don't want it to interfere anyhow with my experiment. \nConstructor is defaulted which in my understanding should only generate constructor of <code>M&lt;int&gt;</code>, its only member, and call it.\nTo my surprise this is not the case. <code>X()</code> also tries to generate the destructor of <code>M&lt;int&gt;</code>:</p>\n\n<p><em>File main.cpp</em></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"X.hpp\"\n\nint main()\n{\n  X* px = new X();\n}\n</code></pre>\n\n<p>and this is what I get from a compiler:</p>\n\n<pre><code>$ g++ -std=c++17 main.cpp\nIn file included from X.hpp:1,\n                 from main.cpp:1:\nM.hpp: In instantiation of \u2018M&lt;T&gt;::~M() [with T = int]\u2019:\nX.hpp:5:3:   required from here\nM.hpp:7:29: error: static assertion failed: no type can pass this\n     static_assert(sizeof(T) == 0, \"no type can pass this\");\n</code></pre>\n\n<p><strong>The question is</strong>: why during the instantiation of the default constructor a compiler tries to instantiate a destructor for a member class template if it is not needed? If it is indeed needed could you point me at the documentation where it is stated? </p>\n"}, {"tags": ["c++", "opengl", "glsl", "shader", "fragment-shader"], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1539272089, "post_id": 52752476, "comment_id": 92450770, "body": "This is it! Thank you very much @Rabbid76."}, {"owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1539275467, "post_id": 52752476, "comment_id": 92452529, "body": "It works for a simple example like painting on top of last frames, but when I try to run a wave simulation it doesn&#180;t work."}, {"owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1539275823, "post_id": 52752476, "comment_id": 92452695, "body": "I thought it may had to do with the size of the texture but it doesn&#180;t work with RGB32F either! @Rabbid76"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1539283797, "post_id": 52752476, "comment_id": 92456809, "body": "@FelipeGutierrez Oh, probably your texture needs an alpha channel <code>GL_RGBA</code> respectively <code>GL_RGBA32F</code> instead of <code>GL_RGB</code>"}, {"owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1539283802, "post_id": 52752476, "comment_id": 92456812, "body": "The same fragment shaders that are on the shadertoy link on the question do not work (I have successfully ported them to compile on desktop), but I am getting no previous states. It does work for a simple example in which I create a circle, read from the same shader and add the values to the fragColor. @Rabbid76"}, {"owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "edited": false, "score": 0, "creation_date": 1539283930, "post_id": 52752476, "comment_id": 92456874, "body": "mmmm that sounds about it let me check and I&#39;ll tell you in a bit"}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 2, "last_activity_date": 1539233680, "last_edit_date": 1592644375, "creation_date": 1539233680, "answer_id": 52752476, "question_id": 52749733, "link": "https://stackoverflow.com/questions/52749733/opengl-implementing-multipass/52752476#52752476", "title": "OpenGL Implementing MultiPass", "body": "<blockquote>\n<p>But I am not able to render the buffer to itself as a texture, I understand that it outputs undefined behaviour and that I should be using a technique as Ping-Pong.</p>\n<p>Can somebody point me in the right direction?</p>\n</blockquote>\n<p>You have to create 2 framebuffer objects, as you did it with the one in your question: <code>frameBufferOne</code> and <code>frameBufferTwo</code>.<br />\nEach fo this 2 framebuffer objects has to have a texture object attached: <code>textureColourBufferOne</code> and <code>textureColourBufferTwo</code>.</p>\n<p>In the main loop of your program you have to know if the number of the frame is even or odd.<br />\nIf the number is even then you have to render to <code>textureColourBufferOne</code> and the input to the render pass is <code>textureColourBufferTwo</code>.<br />\nIt the number is odd then you have to render to <code>textureColourBufferTwo</code> and the input to the render pass is <code>textureColourBufferOne</code>.<br />\nThe result of the rendering is always stored int the texture which belongs to the framebuffer of the current frame:</p>\n<pre><code>bool even = true;\nwhile( !glfwWindowShouldClose( window ) )\n{\n    .....\n\n    glBindFramebuffer( GL_FRAMEBUFFER, even ? frameBufferOne : frameBufferTwo );\n\n    glClearColor( 0.2f, 0.3f, 0.1f, 1.0f );\n    glClear( GL_COLOR_BUFFER_BIT );\n\n    .....\n\n    glBindVertexArray( VAO );\n    glBindTexture( GL_TEXTURE_2D, even ? textureColourBufferTwo : textureColourBufferOne );\n    glDrawElements( GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0 );\n    glBindVertexArray( 0 );\n\n    .....\n\n    glBindFramebuffer( GL_FRAMEBUFFER, 0 );\n    glClearColor( 1.0f, 1.0f, 1.0f, 1.0f );\n    glClear( GL_COLOR_BUFFER_BIT );\n\n    .....\n\n    glBindVertexArray(VAO);\n    glBindTexture( GL_TEXTURE_2D, even ? textureColourBufferOne : textureColourBufferTwo );\n    glDrawElements( GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0 );\n\n    glfwSwapBuffers( window );\n    glfwPollEvents();\n\n    even = !even;\n\n    .....\n}\n</code></pre>\n"}], "owner": {"reputation": 519, "user_id": 9549835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Felipe Gutierrez", "link": "https://stackoverflow.com/users/9549835/felipe-gutierrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 52752476, "answer_count": 1, "score": 3, "last_activity_date": 1606712570, "creation_date": 1539211185, "last_edit_date": 1606712570, "question_id": 52749733, "link": "https://stackoverflow.com/questions/52749733/opengl-implementing-multipass", "title": "OpenGL Implementing MultiPass", "body": "<p>I am having trouble porting some code I have successfully implemented in <a href=\"https://www.shadertoy.com/view/XdyfWK\" rel=\"nofollow noreferrer\">Shadertoy</a> to desktop OpenGL, the problem is that I need to create a FrameBufferObject FBO so that I can do offscreen computations that will be later passed on to the main glsl fragment shader, the thing is that this buffer needs to reference itself as a texture to get the previous values for it to be able to run a simulation.</p>\n\n<p>I have successfully created the FBO:</p>\n\n<pre><code>// Framebuffer configuration.\nunsigned int frameBufferOne;\nglGenFramebuffers(1, &amp;frameBufferOne);\nglBindFramebuffer(GL_FRAMEBUFFER, frameBufferOne);\n\n// Create a colour attachment texture.\nunsigned int textureColourBufferOne;\nglGenTextures(1, &amp;textureColourBufferOne);\nglBindTexture(GL_TEXTURE_2D, textureColourBufferOne);\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, WIDTH, HEIGHT, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\nglFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, textureColourBufferOne, 0);\n\nif (glCheckFramebufferStatus(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE)\n    std::cout &lt;&lt; \"ERROR::FRAMEBUFFER:: Framebuffer is not complete!\" &lt;&lt; std::endl;\nglBindFramebuffer(GL_FRAMEBUFFER, 0);\n</code></pre>\n\n<p>And managed to call it inside my Render Loop so that I can render to the FBO and later on pass those values to the Default Framebuffer:</p>\n\n<pre><code>// Render Loop.\nwhile( !glfwWindowShouldClose( window ) )\n{\n\n    // Input.\n    processInput( window );\n\n    // Render.\n\n    // Bind to frameBuffer and draw scene as normally would to colour texture.\n    glBindFramebuffer( GL_FRAMEBUFFER, frameBufferOne );\n\n    glClearColor( 0.2f, 0.3f, 0.1f, 1.0f );\n    glClear( GL_COLOR_BUFFER_BIT );\n\n    bufferShader.use();\n    float currentFrame = glfwGetTime();\n    //Set the iTimeDelta uniform.\n    float deltaTime = currentFrame - lastFrame;\n    lastFrame = currentFrame;\n    bufferShader.setFloat( \"iTimeDelta\", deltaTime );\n    // Set the iTime uniform.\n    float timeValue = currentFrame;\n    bufferShader.setFloat( \"iTime\", timeValue );\n    // Set the iResolution uniform.\n    bufferShader.setVec2( \"iResolution\", WIDTH, HEIGHT );\n    // Input iMouse.\n    double xPos, yPos;\n    glfwGetCursorPos( window, &amp;xPos, &amp;yPos );\n    yPos = HEIGHT - yPos;\n    bufferShader.setVec2( \"iMouse\", xPos, yPos );\n\n    glBindVertexArray( VAO );\n    glBindTexture( GL_TEXTURE_2D, textureColourBufferOne );\n    glDrawElements( GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0 );\n    glBindVertexArray( 0 );\n\n    glBindFramebuffer( GL_FRAMEBUFFER, 0 );\n    glDisable( GL_DEPTH_TEST );\n\n    glClearColor( 1.0f, 1.0f, 1.0f, 1.0f );\n    glClear( GL_COLOR_BUFFER_BIT );\n\n    ourShader.use();\n    ourShader.setVec2( \"iResolution\", WIDTH, HEIGHT );\n    // Set the iTime uniform.\n    ourShader.setFloat( \"iTime\", timeValue );\n    glBindVertexArray(VAO);\n    glBindTexture( GL_TEXTURE_2D, textureColourBufferOne );\n    glDrawElements( GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0 );\n\n    glfwSwapBuffers( window );\n    glfwPollEvents();\n\n    frameCount++;\n    finalTime = time( NULL );\n    if( finalTime - initialTime &gt; 0 )\n    {\n\n        std::cout &lt;&lt; \"FPS : \" &lt;&lt; frameCount / (finalTime - initialTime) &lt;&lt; std::endl;\n        frameCount = 0;\n        initialTime = finalTime;\n\n    }\n</code></pre>\n\n<p>But I am not able to render the buffer to itself as a texture, I understand that it outputs undefined behaviour and that I should be using a technique as Ping-Pong.</p>\n\n<p>Can somebody point me in the right direction? </p>\n"}, {"tags": ["c++", "encoding", "int"], "comments": [{"owner": {"reputation": 1477, "user_id": 5899776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/64b8e28377778d1b8ad57198ba46c319?s=128&d=identicon&r=PG&f=1", "display_name": "van dench", "link": "https://stackoverflow.com/users/5899776/van-dench"}, "edited": false, "score": 0, "creation_date": 1539211384, "post_id": 52749701, "comment_id": 92423846, "body": "An int128 is likely already a struct containing 2 int 64\u2019s."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1539211420, "post_id": 52749701, "comment_id": 92423852, "body": "Where is your 128 bit integer type coming from? A compiler extension, library, what?"}, {"owner": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1539211612, "post_id": 52749701, "comment_id": 92423896, "body": "@Shawn Not exactly sure, I thought <code>__uint128_t</code> and <code>__uint64_t</code> were somewhat standard. I&#39;ll try to find out. (I&#39;m a C++ noob forgive me)"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 1, "creation_date": 1539211687, "post_id": 52749701, "comment_id": 92423916, "body": "@JamesWierzba: They quite non-standard... the standard is <a href=\"https://en.cppreference.com/w/cpp/header/cstdint\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 2, "creation_date": 1539211915, "post_id": 52749701, "comment_id": 92423980, "body": "Ask yourself this: How would you encode/decode a 64-bit <code>unsigned int</code> from/to two 32-bit <code>unsigned int</code>s?  How about a 32-bit <code>unsigned int</code> from/to two 16-bit <code>unsigned int</code>s?  How about encoding/decoding any of these types from/to a sequence of 8-bit <code>unsigned int</code>s?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539213612, "post_id": 52749701, "comment_id": 92424408, "body": "Any identifier with a <code>__</code> anywhere in it is a non-standard implementation detail (<a href=\"https://stackoverflow.com/questions/4421706/what-are-the-basic-rules-and-idioms-for-operator-overloading\">or someone made a big mistake in their naming scheme</a>). You need to use this stuff with a degree of caution because how it&#39;s implemented can change whenever the compiler implementors feel like it. Some implementation details will be documented and guaranteed to be stable by the implementors, but the rest exist in  a grey area and shouldn&#39;t be used without grave need."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1539212392, "post_id": 52749787, "comment_id": 92424106, "body": "Alternatively: <code>dest1 = src; dest2 = src &#47; (__uint128_t{UINT64_MAX} + 1);</code> and <code>return src1 + src2 * (__uint128_t{UINT64_MAX} + 1);</code> respectively."}, {"owner": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "edited": false, "score": 0, "creation_date": 1541011047, "post_id": 52749787, "comment_id": 93076953, "body": "Hey einpoklum, why do we need masks for encode step? Can&#39;t we just do <code>dest1 = src</code> and <code>dest2 = src &gt;&gt; 64;</code> instead of <code>dest1 = src &amp; bottom_mask;</code> and <code>dest2 = (src &amp; top_mask) &gt;&gt; 64;</code>"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "edited": false, "score": 0, "creation_date": 1541012514, "post_id": 52749787, "comment_id": 93077536, "body": "@JamesWierzba: Yes, we could, I was just emphasizing what bits go where."}, {"owner": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "edited": false, "score": 0, "creation_date": 1541012716, "post_id": 52749787, "comment_id": 93077616, "body": "I see. Also, is this safe? The behavior of assigning a larger integer to a smaller integer is dependent on the compiler, no? We are assuming here that the assignment is taking the lower order 64 bits, is this <b>always</b> the case?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "edited": false, "score": 0, "creation_date": 1541012839, "post_id": 52749787, "comment_id": 93077681, "body": "@JamesWierzba: The behavior of assigning a larger unsigned integer to a smaller unsigned integer <i>is</i> well defined, to my knowledge; see <a href=\"https://stackoverflow.com/a/27889221/1593077\">this answer</a> here on the site."}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": true, "score": 2, "last_activity_date": 1539212000, "last_edit_date": 1539212000, "creation_date": 1539211630, "answer_id": 52749787, "question_id": 52749701, "link": "https://stackoverflow.com/questions/52749701/represent-128-bit-integer-as-two-64-bit-integers-in-c/52749787#52749787", "title": "Represent 128 bit integer as two 64 bit integers in C++", "body": "<p>Umm, why not just do:</p>\n\n<pre><code>void encode(__uint128_t src, __uint64_t &amp;dest1, __uint64_t &amp;dest2)\n{\n    constexpr const __uint128_t bottom_mask = (__uint128_t{1} &lt;&lt; 64) - 1;\n    constexpr const __uint128_t top_mask = ~bottom_mask;\n    dest1 = src &amp; bottom_mask;\n    dest2 = (src &amp; top_mask) &gt;&gt; 64;\n}\n\nvoid decode(__uint64_t src1, __uint64_t src2, __uint128_t &amp;dest)\n{\n    dest = (__uint128_t{src2} &lt;&lt; 64) | src1;\n}\n</code></pre>\n\n<p>?</p>\n\n<p>Of course, this might be kind of futile, since <code>__uint128_t</code> may already be just 2 64-bit values. Also, prefer returning a value rather than using lvalue-references:</p>\n\n<pre><code>std::pair&lt;__uint64_t,__uint64_t&gt; encode(__uint128_t src)\n{\n    constexpr const __uint128_t bottom_mask = (__uint128_t{1} &lt;&lt; 64) - 1;\n    constexpr const __uint128_t top_mask = ~bottom_mask;\n    return { src &amp; bottom_mask, (src &amp; top_mask) &gt;&gt; 64 };\n}\n\n__uint128_t decode(__uint64_t src1, __uint64_t src2)\n{\n    return (__uint128_t{src2} &lt;&lt; 64) | src1;\n}\n</code></pre>\n"}], "owner": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 52749787, "answer_count": 1, "score": -1, "last_activity_date": 1539212000, "creation_date": 1539210964, "last_edit_date": 1539211662, "question_id": 52749701, "link": "https://stackoverflow.com/questions/52749701/represent-128-bit-integer-as-two-64-bit-integers-in-c", "title": "Represent 128 bit integer as two 64 bit integers in C++", "body": "<p>I have a situation in my application where the application is using a 128 bit integer (specifically, a <code>__uint128_t</code>), and at some point the application needs to encode this 128 bit integer as two 64 bit integers (<code>__uint64_t</code>).</p>\n\n<p>(Just assume for the sake of this question that it must encode them like that -- this question is not about alternative ways to encode it)</p>\n\n<p>How can I do this? I must be able to encode and decode.</p>\n\n<pre><code>void encode(__uint128_t src, __uint64_t &amp;dest1, __uint64_t &amp;dest2)\n{\n    // ...\n}\n\nvoid decode(__uint64_t src1, __uint64_t src2, __uint128_t &amp;dest)\n{\n    // ...\n}\n</code></pre>\n\n<p><strong>Example usage:</strong></p>\n\n<pre><code>__uint128_t bigIntBefore = 999999999999999999;\n__uint64_t smallInt1;\n__uint64_t smallInt2;\nencode(bigIntBefore, smallInt1, smallInt2);\n\n// ... later\n\n__uint128_t bigIntAfter;\ndecode(smallInt1, smallInt2, bigIntAfter);\n// bigIntAfter should have a value of '999999999999999999'\n</code></pre>\n"}, {"tags": ["c++", "switch-statement"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10463269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbc702b3bbba7f300ca60c042f69c78?s=128&d=identicon&r=PG&f=1", "display_name": "T.243", "link": "https://stackoverflow.com/users/10463269/t-243"}, "edited": false, "score": 0, "creation_date": 1539213047, "post_id": 52749944, "comment_id": 92424276, "body": "What doest that function cin.ignore(INT_MAX, &#39;\\n&#39;) do actually? and how is it different from from cin.ignore()?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 35, "user_id": 10463269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbc702b3bbba7f300ca60c042f69c78?s=128&d=identicon&r=PG&f=1", "display_name": "T.243", "link": "https://stackoverflow.com/users/10463269/t-243"}, "edited": false, "score": 1, "creation_date": 1539214210, "post_id": 52749944, "comment_id": 92424519, "body": "@T.243 <code>cin.ignore()</code> discards one character. <code>cin.ignore(INT_MAX, &#39;\\n&#39;)</code> discards every character until it finds a line ending or it&#39;s discarded (probably) a few billion characters. Technically this should be <code>cin.ignore(numeric_limits&lt;streamsize&gt;::max(), &#39;\\n&#39;)</code> because there could be a difference between the maximum length of a stream and <code>INT_MAX</code>, but if you&#39;re throwing away this many characters you have much bigger problems to worry about."}], "tags": [], "owner": {"reputation": 64, "user_id": 10417028, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dD0kjb8H6n8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUXWH5lGqtRA5MHFI9NToNRJXWgYA/mo/photo.jpg?sz=128", "display_name": "Soft Vanilla", "link": "https://stackoverflow.com/users/10417028/soft-vanilla"}, "is_accepted": true, "score": 0, "last_activity_date": 1539212793, "creation_date": 1539212793, "answer_id": 52749944, "question_id": 52749685, "link": "https://stackoverflow.com/questions/52749685/switch-statement-reading-every-input-in-c/52749944#52749944", "title": "Switch statement reading every input in c++", "body": "<p>change <code>cin.ignore()</code> to <code>cin.ignore(INT_MAX, '\\n')</code></p>\n"}], "owner": {"reputation": 35, "user_id": 10463269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbc702b3bbba7f300ca60c042f69c78?s=128&d=identicon&r=PG&f=1", "display_name": "T.243", "link": "https://stackoverflow.com/users/10463269/t-243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52749944, "answer_count": 1, "score": 0, "last_activity_date": 1539218478, "creation_date": 1539210868, "last_edit_date": 1539218478, "question_id": 52749685, "link": "https://stackoverflow.com/questions/52749685/switch-statement-reading-every-input-in-c", "title": "Switch statement reading every input in c++", "body": "<p>I have this switch statement that is used to allow the user to select an option. It quits when the user enters 9. But the problem is that when I enter something like \"ah2\" it will read 'a' then print the error message, next 'h' and the error message and then the 2. The program is supposed to stop when the user enters such input and should ask to enter a different input.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>void menu()\n{\n\n    int choice = 0;\n\n    cout&lt;&lt;\"\\nWelcome to the program menu.\"&lt;&lt;endl;\n    cout&lt;&lt;\"Choose the operation you would like to execute.\"&lt;&lt;endl;\n    cout&lt;&lt;\"1. Create \"&lt;&lt;endl;\n    cout&lt;&lt;\"2. Look items \"&lt;&lt;endl;\n    cout&lt;&lt;\"3. See \"&lt;&lt;endl;\n    cout&lt;&lt;\"4. Get \"&lt;&lt;endl;\n    cout&lt;&lt;\"5. See the value \"&lt;&lt;endl;\n    cout&lt;&lt;\"6. Insert an item\"&lt;&lt;endl;\n    cout&lt;&lt;\"7. Delete an item\"&lt;&lt;endl;\n    cout&lt;&lt;\"8. Destroy \"&lt;&lt;endl;\n    cout&lt;&lt;\"9. Press -1 to exit the program\"&lt;&lt;endl;\n\n    cout&lt;&lt;\"Enter your choice: \"&lt;&lt;endl;\n    cin&gt;&gt;choice;\n\n   while(choice != 9)\n    {\n        switch (choice)\n        {\ncase 1:\n            cout&lt;&lt;\"You choose one\"&lt;&lt;endl;\n            break;\n        case 2:\n            cout&lt;&lt;\"You choose two\"&lt;&lt;endl;\n            break;\n        case 3:\n            cout&lt;&lt;\"You choose three\"&lt;&lt;endl;\n            break;\n        case 4:\n            cout&lt;&lt;\"You choose four\"&lt;&lt;endl;\n            break;\n        case 5:\n            cout&lt;&lt;\"You choose five\"&lt;&lt;endl;\n            break;\n        case 6:\n            cout&lt;&lt;\"You choose six\"&lt;&lt;endl;\n            break;\n        case 7:\n            cout&lt;&lt;\"You choose seven\"&lt;&lt;endl;\n            break;\n        case 8:\n            cout&lt;&lt;\"You choose height\"&lt;&lt;endl;\n            break;\n        case 9:\n            cout&lt;&lt;\"You choose nine\"&lt;&lt;endl;\n            break;\n        default:\n            cout&lt;&lt;\"You have not entered a number proposed. Retry. \"&lt;&lt;endl;\n            choice = 0;\n            break;\n        }\n        cin.clear();\n        cin.ignore();\n        cout&lt;&lt;\"Enter your choice : \"&lt;&lt;endl;\n        cin&gt;&gt;choice;\n    }\n    cout&lt;&lt;\"\\nYou have entered the exist option end the program\"&lt;&lt;endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17", "constexpr", "if-constexpr"], "comments": [{"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 3, "creation_date": 1539210543, "post_id": 52749572, "comment_id": 92423594, "body": "I don&#39;t see something better. I would run with what you have."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1539210702, "post_id": 52749572, "comment_id": 92423636, "body": "Tag dispatch might be useful here: <code>get(int_tag)</code>, <code>get(string_tag)</code> and then <code>val = get(tag{})</code>. <code>std::false_type</code> and <code>std::true_type</code> can be used as tags."}, {"owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1539210961, "post_id": 52749572, "comment_id": 92423740, "body": "@bolov I fear you are right, but maybe somebody has something clever waiting to share with us :)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1539211254, "post_id": 52749572, "comment_id": 92423813, "body": "<code>std::variant</code> and <code>std::visit</code> are <code>constexpr</code>, but not sure it is better..."}], "answers": [{"comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1539261257, "post_id": 52749669, "comment_id": 92443387, "body": "+1. But you can simplify a little using only a specialization; something as <code>template &lt;bool&gt; struct value_chooser { static constexpr auto value = &quot;47&quot;; }; template &lt;&gt; struct value_chooser&lt;false&gt; { static constexpr auto value = 47; };</code>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1539264852, "post_id": 52749669, "comment_id": 92445718, "body": "@max66 yes I know, but I found this way more consistent and explicit - so more readable."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1539265616, "post_id": 52749669, "comment_id": 92446275, "body": "@max66 I think your way would be better with enum, when you specify a default case and override some."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1539276428, "post_id": 52749669, "comment_id": 92453026, "body": "Also with integer values; is preferable, form the readability point, when there is a significant default behavior and some specializations (IMHO, obviously)."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 1, "last_activity_date": 1539210788, "creation_date": 1539210788, "answer_id": 52749669, "question_id": 52749572, "link": "https://stackoverflow.com/questions/52749572/ternary-operator-and-if-constexpr/52749669#52749669", "title": "Ternary operator and if constexpr", "body": "<p>this should work:</p>\n\n<pre><code>template &lt;bool&gt;\nstruct value_chooser;\n\ntemplate&lt;&gt;\nstruct value_chooser&lt;true&gt;\n{\n    static constexpr auto value = \"47\";\n};\n\ntemplate&lt;&gt;\nstruct value_chooser&lt;false&gt;\n{\n    static constexpr auto value = 47;\n};\n\nint main()\n{\n    auto value1 = value_chooser&lt;true&gt;::value;\n    auto value2 = value_chooser&lt;false&gt;::value;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/g23MV4\" rel=\"nofollow noreferrer\">live example</a></p>\n"}, {"tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 3, "last_activity_date": 1539210985, "creation_date": 1539210985, "answer_id": 52749705, "question_id": 52749572, "link": "https://stackoverflow.com/questions/52749572/ternary-operator-and-if-constexpr/52749705#52749705", "title": "Ternary operator and if constexpr", "body": "<p>Another option is to use tag dispatch:</p>\n\n<pre><code>constexpr int get(std::false_type) {\n    return 47;\n}\n\nconstexpr std::string_view get(std::true_type) {\n    return \"47\";\n}\n\nint main() {\n    constexpr auto val = get(std::bool_constant&lt;use_str&gt;{});\n    std::cout &lt;&lt; val &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "edited": false, "score": 0, "creation_date": 1539213939, "post_id": 52749844, "comment_id": 92424471, "body": "I tried to oneline it with std::get, but variant is not constexpr friendly, and anyways std::get&lt;!use_str&gt; looks horrible :)"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1539211944, "creation_date": 1539211944, "answer_id": 52749844, "question_id": 52749572, "link": "https://stackoverflow.com/questions/52749572/ternary-operator-and-if-constexpr/52749844#52749844", "title": "Ternary operator and if constexpr", "body": "<p>Not sure it is better, but with <code>std::variant</code>:</p>\n\n<pre><code>int main()\n{\n    using my_variant = std::variant&lt;int, std::string_view&gt;;\n    constexpr auto val =  use_str ? my_variant{get_string()} : my_variant{get_int()};\n    std::visit([](const auto&amp; v) {std::cout &lt;&lt; v &lt;&lt; std::endl;}, val);\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/27aa201608a6cc5a\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1539276315, "last_edit_date": 1539276315, "creation_date": 1539260918, "answer_id": 52760102, "question_id": 52749572, "link": "https://stackoverflow.com/questions/52749572/ternary-operator-and-if-constexpr/52760102#52760102", "title": "Ternary operator and if constexpr", "body": "<blockquote>\n  <p>I have workaround in the code below but it is quite verbose. Is there a better way?</p>\n</blockquote>\n\n<p>Working with C++17, you can use <code>if constexpr</code> and it seems to me a good solution.</p>\n\n<p>If you really want something different, I propose a way based on full specialization of template function (a mix between Evg's and Slava's solutions)</p>\n\n<p>I mean something as</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\ntemplate &lt;bool&gt;\nconstexpr auto get_value ()\n { return 47; }\n\ntemplate &lt;&gt;\nconstexpr auto get_value&lt;true&gt; ()\n { return std::string_view{\"47\"}; }\n\nint main()\n {\n    constexpr auto use_str = false;\n    constexpr auto val     = get_value&lt;use_str&gt;();\n\n    std::cout &lt;&lt; val &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>As pointed by Slava, a template function with a default version and an explicit specialization for one case, can be less readable.</p>\n\n<p>So, if you prefer a variant a little more verbose but more readable, you can write two explicit specializations for <code>get_value()</code> as follows</p>\n\n<pre><code>template &lt;bool&gt;\nconstexpr auto get_value ();\n\ntemplate &lt;&gt;\nconstexpr auto get_value&lt;false&gt; ()\n { return 47; }\n\ntemplate &lt;&gt;\nconstexpr auto get_value&lt;true&gt; ()\n { return std::string_view{\"47\"}; }\n</code></pre>\n"}], "owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1539276315, "creation_date": 1539210192, "last_edit_date": 1539261432, "question_id": 52749572, "link": "https://stackoverflow.com/questions/52749572/ternary-operator-and-if-constexpr", "title": "Ternary operator and if constexpr", "body": "<p>I have situations where sometimes based on some <code>bool</code> I want to call 2 <code>constexpr</code> functions that return different types and assign it to <code>auto</code> constant. </p>\n\n<p>Unfortunately ternary operator needs types to be \"similar\". </p>\n\n<p>I have workaround in the code below but it is quite verbose. Is there a better way?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nconstexpr int get_int(){\n    return 47;\n}\n\nconstexpr std::string_view get_string(){\n    return \"47\";\n}\n\nconstexpr bool use_str = false;\n\nconstexpr auto get_dispatch(){\n    if constexpr(use_str){\n        return get_string();\n    } else{\n        return get_int();\n    }\n\n}\nint main()\n{\n    // what I want : constexpr auto val =  use_str ? get_string():get_int();\n    // what works:\n    constexpr auto val = get_dispatch();\n    std::cout &lt;&lt; val &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "data-sharing"], "answers": [{"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 1, "last_activity_date": 1539236816, "creation_date": 1539236816, "answer_id": 52753046, "question_id": 52749551, "link": "https://stackoverflow.com/questions/52749551/c-qt-using-constant-pointer-to-private-member-as-read-only-data-sharing/52753046#52753046", "title": "C++/QT: Using constant pointer to private member as read-only data-sharing", "body": "<blockquote>\n  <p>So, my question is: If I want to share all this data from one class to another without letting the receiver alter the data (read-only access), is there a better common practice to do this, rather than using constant pointers to the data?</p>\n</blockquote>\n\n<p>Sharing via const-pointers is fine, although sharing a const-reference (i.e. <code>const std::vector&lt;Player&gt; &amp;</code>) might be very slightly preferable, if only because any code receiving a const-reference can be 100% assured that any reference it receives isn't NULL, since NULL references aren't allowed by the language (whereas NULL pointers are allowed).</p>\n\n<p>One other thing to consider is object-lifetime issues -- i.e. if you pass a <code>const std::vector&lt;Player&gt;*</code> to your <code>MainWindow</code> class, and the <code>MainWindow</code> class keeps a copy of that pointer-value (i.e. copies the passed-in pointer to a local member-variable), and then the vector is destructed, the <code>MainWindow</code> will be left holding a dangling pointer that will invoke undefined behavior (i.e. probably crash, or worse, silently corrupt your program's memory space in some very-hard-to-debug fashion) if/when it ever tries to dereference the pointer.  If you want to avoid any possibility of that particular fiasco, you can pass the data via a smart-pointer instead (i.e. either a <a href=\"https://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">shared_ptr</a>, or if you prefer to use the Qt-specific APIs, a <a href=\"https://stackoverflow.com/questions/22304118/what-is-the-difference-between-qpointer-qsharedpointer-and-qweakpointer-classes\">QSharedPointer or QPointer</a> object)</p>\n"}], "owner": {"reputation": 15, "user_id": 7133967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TOhhs.jpg?s=128&g=1", "display_name": "Jesperten", "link": "https://stackoverflow.com/users/7133967/jesperten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 52753046, "answer_count": 1, "score": 0, "last_activity_date": 1539236816, "creation_date": 1539210042, "last_edit_date": 1539211979, "question_id": 52749551, "link": "https://stackoverflow.com/questions/52749551/c-qt-using-constant-pointer-to-private-member-as-read-only-data-sharing", "title": "C++/QT: Using constant pointer to private member as read-only data-sharing", "body": "<p>I am writing a program in QT, which currently has a <code>GameEngine</code> class and a <code>MainWindow</code> class.</p>\n\n<p>GameEngine.h:</p>\n\n<pre><code>#include \"Player.h\"\n\nclass GameEngine : public QObject\n{\n    Q_OBJECT\n\npublic:\n    void test();\n\nsignals:\n    void newPlayerDataReady(const std::vector&lt;Player&gt;* playerList);\n\nprivate:\n    std::vector&lt;Player&gt; mPlayers; // List of player objects\n}\n</code></pre>\n\n<p>GameEngine.cpp</p>\n\n<pre><code>#include \"GameEngine.h\"\n\n// Omitting constructor and destructor for simplicity of the example\n\nvoid GameEngine::test() {\n    emit newPlayerDataReady(&amp;mPlayers);\n}\n</code></pre>\n\n<p>The <code>GameEngine</code> is storing a lot of data in the array of Player instances (Player is a rather complex class itself with a lot of different members), which has to be stored there for centralizing the logic of the program (long-story short).</p>\n\n<p>The <code>MainWindow</code> is a GUI class, which is supposed to visualize the data, when the signal <code>newPlayerDataReady</code> is emitted and represent a lot of the data on a graph, a list etc. This is done by connecting the signal to a dedicated slot in the <code>MainWindow</code> class. The connection is created in Main.cpp, which owns the instance of both classes.</p>\n\n<p>So, my question is:\n<i>If I want to share all this data from one class to another without letting the receiver alter the data (read-only access), is there a better common practice to do this, rather than using constant pointers to the data?</i></p>\n\n<p>It is not that I don't like this solution. I just want to be absolutely sure that I doing it right from the beginning instead of having to rework a lot later in the process.</p>\n\n<p>I know that one alternative could be done exchange the data as copies of the private member, but I don't think it would be a smooth solution, as the amount of data will increase to a point, where it might affect the speed of the program.</p>\n"}, {"tags": ["c++", "macos"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1539209806, "post_id": 52749478, "comment_id": 92423408, "body": "Should be <code>-std=c++17</code>"}, {"owner": {"reputation": 47, "user_id": 9683742, "user_type": "registered", "profile_image": "https://graph.facebook.com/197529311036656/picture?type=large", "display_name": "DevonFrm4200", "link": "https://stackoverflow.com/users/9683742/devonfrm4200"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539213355, "post_id": 52749478, "comment_id": 92424347, "body": "@user4581301  this error still persist   <code>error: call to unavailable function &#39;any_cast&#39;: introduced in       macOS 10.14</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539213968, "post_id": 52749478, "comment_id": 92424473, "body": "Huh. I don&#39;t think I can help you with this. <code>std::any_cast</code> should be supported in GCC8.2. See if you can compile the example code at <a href=\"https://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/utility/any</a> . If that works you may have an error somewhere around your use of <code>any_cast</code> that&#39;s confusing the compiler. You may need to create an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and ask another question based on the MCVE to let the language lawyers figure it out."}], "answers": [{"tags": [], "owner": {"reputation": 484, "user_id": 5066497, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee3feec2dfd128f643a70b306bd7a85?s=128&d=identicon&r=PG&f=1", "display_name": "9301293", "link": "https://stackoverflow.com/users/5066497/9301293"}, "is_accepted": true, "score": 0, "last_activity_date": 1539214456, "creation_date": 1539214456, "answer_id": 52750145, "question_id": 52749478, "link": "https://stackoverflow.com/questions/52749478/c-is-there-a-flag-for-c17-osx-10-13-6/52750145#52750145", "title": "c++ is there a flag for c++17 osx 10.13.6", "body": "<p>Google is your friend, so is Wikipedia. </p>\n\n<p>From the <a href=\"https://www.gnu.org/software/gcc/projects/cxx-status.html#cxx17\" rel=\"nofollow noreferrer\">GCC website</a>, we can see that there is experimental/support for C++17 standard, through the <code>-std=c++17</code> flag. </p>\n\n<p>From <a href=\"https://en.cppreference.com/w/cpp/compiler_support#C.2B.2B17_features\" rel=\"nofollow noreferrer\">this awesome wiki article</a>, there is a cross reference list for functionality and features. It indicates that <code>std::any</code> is supported in version <code>GCC &gt;= 7</code>, but only on Clang (which may be what you are using on accident) version <code>Clang &gt;= 4</code>. </p>\n\n<p>Post the command you are running for some extra help, and make sure you have the corresponding header, included in your file(s). </p>\n"}], "owner": {"reputation": 47, "user_id": 9683742, "user_type": "registered", "profile_image": "https://graph.facebook.com/197529311036656/picture?type=large", "display_name": "DevonFrm4200", "link": "https://stackoverflow.com/users/9683742/devonfrm4200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 52750145, "answer_count": 1, "score": -5, "last_activity_date": 1539214456, "creation_date": 1539209597, "question_id": 52749478, "link": "https://stackoverflow.com/questions/52749478/c-is-there-a-flag-for-c17-osx-10-13-6", "title": "c++ is there a flag for c++17 osx 10.13.6", "body": "<p>I used brew to update to 8.2 gcc but I keep getting this\n<strong>error:</strong></p>\n\n<pre><code>error: no member named 'any' in namespace 'std' \n</code></pre>\n"}, {"tags": ["c++", "c++17", "template-argument-deduction"], "comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1539209453, "post_id": 52749413, "comment_id": 92423302, "body": "Those statements should all be well-formed. It&#39;s a gcc bug."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1539210092, "post_id": 52749413, "comment_id": 92423482, "body": "<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81486\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=81486</a>"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539210386, "post_id": 52749413, "comment_id": 92423557, "body": "@Barry Does this bug really come from the class template argument deduction feature? I figured it didn&#39;t since there was no deduction actually happening."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1539210633, "post_id": 52749413, "comment_id": 92423621, "body": "@0x499602D2 Yeah, CTAD is what lets you write <code>X x;</code> instead of having to write <code>X&lt;&gt; x;</code>"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539210783, "post_id": 52749413, "comment_id": 92423668, "body": "@Barry Great. I&#39;ll update the answer."}], "answers": [{"tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": true, "score": 3, "last_activity_date": 1539210790, "last_edit_date": 1539210790, "creation_date": 1539209807, "answer_id": 52749514, "question_id": 52749413, "link": "https://stackoverflow.com/questions/52749413/default-template-argument-deduction-for-copy-initialization/52749514#52749514", "title": "Default template argument deduction for copy initialization", "body": "<p>It's a bug in GCC.</p>\n\n<p>Notice that if you replace the parenthesis with curly braces the code compiles:</p>\n\n<pre><code>auto x2 = X{}; // now compiles in clang and gcc\nX&lt;&gt; x3 = X{}; // now compiles in clang and gcc\n</code></pre>\n\n<p><strike>This is not class template argument deduction as there are no template arguments being deduced.</strike> Class template argument deduction should permit the elision of the template braces. The use of <code>()</code> or <code>{}</code> in this case should have no bearing on whether they are deduced.</p>\n"}], "owner": {"reputation": 3118, "user_id": 1253415, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87096d37b6aed093f1b142c6a9bfae91?s=128&d=identicon&r=PG", "display_name": "jcai", "link": "https://stackoverflow.com/users/1253415/jcai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52749514, "answer_count": 1, "score": 0, "last_activity_date": 1539210790, "creation_date": 1539209168, "last_edit_date": 1539210218, "question_id": 52749413, "link": "https://stackoverflow.com/questions/52749413/default-template-argument-deduction-for-copy-initialization", "title": "Default template argument deduction for copy initialization", "body": "<p>C++17 has <a href=\"https://en.cppreference.com/w/cpp/language/class_template_argument_deduction\" rel=\"nofollow noreferrer\">class template argument deduction</a>. However, I was wondering whether it applies to statements like <code>auto x = X()</code> where <code>X</code> is a class template. Consider this code:</p>\n\n<pre><code>template &lt;typename T = void&gt;\nstruct X {};\n\nint main() {       // all with -std=c++17\n    X&lt;&gt; x0;        // compiles in both clang and gcc\n    X x1;          // compiles in both clang and gcc\n    auto x2 = X(); // compiles in clang but not gcc\n    X&lt;&gt; x3 = X();  // compiles in clang but not gcc\n}\n</code></pre>\n\n<p>Here is the <a href=\"https://godbolt.org/z/dkf3V4\" rel=\"nofollow noreferrer\">godbolt link</a>. So which compiler is right, and is this program valid C++17?</p>\n"}, {"tags": ["c++", "sorting", "cout"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539208735, "post_id": 52749322, "comment_id": 92423082, "body": "You need to sort the array in the opposite direct if you want <code>a[0]</code> to be the largest element."}, {"owner": {"reputation": 881, "user_id": 10291435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa925201987d21a2dd54f7609930773b?s=128&d=identicon&r=PG&f=1", "display_name": "Mee", "link": "https://stackoverflow.com/users/10291435/mee"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539208906, "post_id": 52749322, "comment_id": 92423141, "body": "the problem that i think it is not sorting either ascending or descending; it gets the index of a itself without sorting it."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 3, "creation_date": 1539208935, "post_id": 52749322, "comment_id": 92423149, "body": "Look into <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">array decaying</a>.  Your <code>sizeof(a)</code> is providing you the size of a <b>pointer</b>, which is not what you want in that context."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1539208951, "post_id": 52749322, "comment_id": 92423155, "body": "What if the array contains duplicates?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1539208958, "post_id": 52749322, "comment_id": 92423162, "body": "after fixing your own you should take a look at <a href=\"https://en.cppreference.com/w/cpp/algorithm/nth_element\" rel=\"nofollow noreferrer\">std::nth_element</a>"}, {"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1567890414, "post_id": 52749322, "comment_id": 102103140, "body": "Hello. If any answer here helped you, would you please consider marking one of them as accepted? It signals that the question was answered, and rewards the author of the question and the author of the answer with some reputation points. You can read more about this at <a href=\"https://meta.stackexchange.com/q/5234/347897\">https://meta.stackexchange.com/q/5234/347897</a>."}], "answers": [{"comments": [{"owner": {"reputation": 881, "user_id": 10291435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa925201987d21a2dd54f7609930773b?s=128&d=identicon&r=PG&f=1", "display_name": "Mee", "link": "https://stackoverflow.com/users/10291435/mee"}, "edited": false, "score": 0, "creation_date": 1539209323, "post_id": 52749408, "comment_id": 92423269, "body": "omg thank you so much this worked! but what if i want to calculate the length of an array without putting it as a parameter in the function, is there a way?!"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 881, "user_id": 10291435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa925201987d21a2dd54f7609930773b?s=128&d=identicon&r=PG&f=1", "display_name": "Mee", "link": "https://stackoverflow.com/users/10291435/mee"}, "edited": false, "score": 0, "creation_date": 1539209505, "post_id": 52749408, "comment_id": 92423317, "body": "@Mee, you can use a function template with the size as the non-type parameter. See <a href=\"https://stackoverflow.com/questions/437150/can-someone-explain-this-template-code-that-gives-me-the-size-of-an-array\">this SO post</a> that uses a non-type template parameter to get the size of an array. You can use a similar method for implementing <code>largest</code>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1539209140, "creation_date": 1539209140, "answer_id": 52749408, "question_id": 52749322, "link": "https://stackoverflow.com/questions/52749322/getting-the-nth-largest-number/52749408#52749408", "title": "getting the nth largest number", "body": "<p>The problem lies in the use of <code>sizeof(a)/sizeof(*a)</code> to get the number of elements of the array. <code>sizeof(a)</code> is the size of a pointer.</p>\n\n<p>You need to pass the size of the array to the function.</p>\n\n<pre><code>int largest(int a[], int size, int k){\n\n   for (int i=0;i&lt;size;i++){\n      for (int j=i+1;j&lt;size;j++){\n\n      ...\n      }\n   }\n}\n</code></pre>\n\n<p>and call it with</p>\n\n<pre><code>int m = largest(a, 6, 4);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1539209675, "last_edit_date": 1539209675, "creation_date": 1539209330, "answer_id": 52749439, "question_id": 52749322, "link": "https://stackoverflow.com/questions/52749322/getting-the-nth-largest-number/52749439#52749439", "title": "getting the nth largest number", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\nint main()\n{\n   int a[]={3,2,1,0,5,10};\n   std::sort(a, a+6, greater&lt;int&gt;() );  // Sort an array of 6 elements in greatest-first order.\n   cout&lt;&lt;a[3]&lt;&lt;endl;                    // Show the 4th element from the front.\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "is_accepted": false, "score": 2, "last_activity_date": 1539209491, "creation_date": 1539209491, "answer_id": 52749463, "question_id": 52749322, "link": "https://stackoverflow.com/questions/52749322/getting-the-nth-largest-number/52749463#52749463", "title": "getting the nth largest number", "body": "<p>There are three problems with your code.</p>\n\n<p>First, when you pass the array as an argument to your function, it decays into a pointer. So the function can never know the size of the array without additional information. It is <code>main()</code>'s job to find the size of the array and pass that information along to <code>largest()</code>.</p>\n\n<p>Second, you have an off-by-one error in your code, because you are attempting to iterate from <code>0</code> to the number of elements in the array.</p>\n\n<p>The following will work:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint largest(int a[],int k, int n){\n   for (int i = 0; i &lt; n; i++){\n      for (int j = i + 1; j &lt; n; j++){\n         if (a[j] &gt; a[i]){\n            int temp = a[i];\n            a[i] = a[j];\n            a[j] = temp;\n         }\n      }\n   }\n   return a[k-1];\n}\n\nint main()\n{\n   int a[] = {3, 2, 1, 0, 5, 10};\n   int k = 4;\n   int m = largest(a, k, sizeof a/ sizeof *a);\n   cout &lt;&lt; m &lt;&lt; endl;\n}\n</code></pre>\n\n<p>At last but not least, you have nasty side effects in your function. If you have a function that is supposed to find the largest element of the array, it shouldn't modify the entire array in order to do so.</p>\n\n<p>You can make a copy of the original array and sort it. Or you can implement a k-element sort algorithm. Either way you shouldn't change user data just to find some statistic from it.</p>\n"}, {"comments": [{"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 1, "creation_date": 1539211921, "post_id": 52749752, "comment_id": 92423982, "body": "<code>std::partial_sort</code> still does more work than needed, might as well use <a href=\"https://en.cppreference.com/w/cpp/algorithm/nth_element\" rel=\"nofollow noreferrer\"><code>std::nth_element</code></a>"}, {"owner": {"reputation": 848, "user_id": 8195987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9550984d8633cb6f1b538445082dd400?s=128&d=identicon&r=PG&f=1", "display_name": "Angelicos Phosphoros", "link": "https://stackoverflow.com/users/8195987/angelicos-phosphoros"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1539212724, "post_id": 52749752, "comment_id": 92424181, "body": "You are right, yes. I written some algorithm, that works same way as nth_element."}], "tags": [], "owner": {"reputation": 848, "user_id": 8195987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9550984d8633cb6f1b538445082dd400?s=128&d=identicon&r=PG&f=1", "display_name": "Angelicos Phosphoros", "link": "https://stackoverflow.com/users/8195987/angelicos-phosphoros"}, "is_accepted": false, "score": 0, "last_activity_date": 1539212837, "last_edit_date": 1539212837, "creation_date": 1539211293, "answer_id": 52749752, "question_id": 52749322, "link": "https://stackoverflow.com/questions/52749322/getting-the-nth-largest-number/52749752#52749752", "title": "getting the nth largest number", "body": "<p><strong>UPD:</strong> There are STL algorithm to use: std::nth_element.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nint main(){\n    int arr[] = {54, 897, 87, 4, 6,987};\n    size_t length = 6, k = 3;\n    std::cout&lt;&lt;std::nth_element(arr, arr + k, arr + length, std::greater&lt;int&gt;());\n}\n</code></pre>\n\n<p>Also, if you want to implement it by yourselt you can do such thing based on quick sort:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\ntemplate&lt;class T&gt;\nT largest_k(T* a, size_t left, size_t right, size_t k) {\n  if(left&gt;=right)\n    return a[k-1];\n\n  size_t i = left, j = right;   \n\n  T middle = a[ i + (j-i) / 2 ];    \n\n  do {\n    while ( a[i] &gt; middle ) i++;\n    while ( a[j] &lt; middle ) j--;\n\n    if (i &lt;= j) {\n      std::swap(a[i], a[j]);\n      i++; j--;\n    }\n  } while ( i&lt;=j );\n\n  // We need to go deeper only for needed part of a\n  if ( k&lt;=j+1 )\n    return largest_k(a, left, j, k);\n  if ( k&gt;= i ) \n    return largest_k(a, i, right, k);\n}\n\nint main()\n{\n  int arr[] = {54, 897, 87, 4, 6,987};\n  size_t length = 6, k = 3;\n  std::cout&lt;&lt;largest_k&lt;int&gt;(arr, 0, length-1, k);\n}\n</code></pre>\n"}], "owner": {"reputation": 881, "user_id": 10291435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa925201987d21a2dd54f7609930773b?s=128&d=identicon&r=PG&f=1", "display_name": "Mee", "link": "https://stackoverflow.com/users/10291435/mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1539212837, "creation_date": 1539208595, "last_edit_date": 1539208854, "question_id": 52749322, "link": "https://stackoverflow.com/questions/52749322/getting-the-nth-largest-number", "title": "getting the nth largest number", "body": "<p>I am trying to get the nth largest number of an array, I tried to sort the array then access the nth number by indexing; I have written this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint largest(int a[],int k){\n\n   for (int i=0;i&lt;=(sizeof(a)/sizeof(*a));i++){\n      for (int j=i+1;j&lt;=(sizeof(a)/sizeof(*a));j++){\n\n         if(a[j]&gt;a[i]){\n            int temp=a[i];\n            a[i]=a[j];\n            a[j]=temp;\n         }\n      }\n   }\n   return a[k-1];\n}\n\nint main()\n{\n   int a[]={3,2,1,0,5,10};\n   int m=largest(a,4);\n   cout&lt;&lt;m&lt;&lt;endl;\n\n   return 0;\n}\n</code></pre>\n\n<p>and when I print out <code>m</code> it appears to be 5 while it is expected to be 2, when I tried to replace <code>int m=largest(a,4);</code> with <code>m=largest(a,1);</code> it printed 2 so it appears that he prints the index of the array a but without sorting it, any idea?</p>\n"}, {"tags": ["c++", "winapi"], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1539209759, "post_id": 52749434, "comment_id": 92423399, "body": "The exact definition of <code>MAKEWPARAM()</code> is <code>#define MAKEWPARAM(l, h)      ((WPARAM)(DWORD)MAKELONG(l, h))</code> where <code>MAKELONG()</code> is defined as <code>#define MAKELONG(a, b)      ((LONG)(((WORD)(((DWORD_PTR)(a)) &amp; 0xffff)) | ((DWORD)((WORD)(((DWORD_PTR)(b))</code>.  See the definitions in <code>winuser.h</code> and <code>windef.h</code>, respectively."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1539209933, "post_id": 52749434, "comment_id": 92423436, "body": "@RemyLebeau, and <code>DWORD_PTR</code> is a <code>typedef</code> for <code>ULONG_PTR</code>, which is in turn a <code>typedef</code> for <code>unsigned long</code> or <code>unsigned __int64</code> for Win32/64."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": true, "score": 4, "last_activity_date": 1539209606, "last_edit_date": 1539209606, "creation_date": 1539209289, "answer_id": 52749434, "question_id": 52749298, "link": "https://stackoverflow.com/questions/52749298/using-boolean-values-instead-of-bool-values-with-makeword-makewparam/52749434#52749434", "title": "Using boolean values instead of BOOL values with MAKEWORD / MAKEWPARAM", "body": "<p><code>MAKEWPARAM(a, b)</code> uses C-casts under the hood, something like</p>\n\n<pre><code>(unsigned long)(a)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>(unsigned __int64)(a)\n</code></pre>\n\n<p>Casting <code>bool</code> to <code>unsigned long</code> or <code>unsigned __int64</code> is perfectly valid, and the C++ Standard (4.7/4, [conv.integral]) guarantees that casting <code>false</code> and <code>true</code> will produce <code>0</code> and <code>1</code>:</p>\n\n<blockquote>\n  <p>If the source type is <code>bool</code>, the value <code>false</code> is converted to zero and\n  the value <code>true</code> is converted to one.</p>\n</blockquote>\n\n<p><code>FALSE</code> and <code>TRUE</code> are <code>#define</code>s for <code>0</code> and <code>1</code>. So, your simplification is valid and is equivalent to the original code.</p>\n"}], "owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52749434, "answer_count": 1, "score": 0, "last_activity_date": 1539209606, "creation_date": 1539208422, "last_edit_date": 1539208613, "question_id": 52749298, "link": "https://stackoverflow.com/questions/52749298/using-boolean-values-instead-of-bool-values-with-makeword-makewparam", "title": "Using boolean values instead of BOOL values with MAKEWORD / MAKEWPARAM", "body": "<pre><code>// Rebuild the \"Assign Flags\"\nm_dwStudentAssignFlags = MAKEWPARAM(\n    MAKEWORD(bIncluded[INDEX(StudentAssign::kItem1)] ? TRUE : FALSE, bIncluded[INDEX(StudentAssign::kItem2)] ? TRUE : FALSE),\n    MAKEWORD(bIncluded[INDEX(StudentAssign::kItem3)] ? TRUE : FALSE, bIncluded[INDEX(StudentAssign::kItem4)] ? TRUE : FALSE));\n</code></pre>\n\n<p><code>bIncluded</code> is a fixed array of 4 elements of type <code>boolean</code>.</p>\n\n<p>The above code works but I wanted to know if there is any specific reason why I can't simplify the code down to:</p>\n\n<pre><code>// Rebuild the \"Assign Flags\"\nm_dwStudentAssignFlags = MAKEWPARAM(\n    MAKEWORD(bIncluded[INDEX(StudentAssign::kItem1)], bIncluded[INDEX(StudentAssign::kItem2)]),\n    MAKEWORD(bIncluded[INDEX(StudentAssign::kItem3)], bIncluded[INDEX(StudentAssign::kItem4)]));\n</code></pre>\n"}, {"tags": ["c++", "linux", "eclipse", "or-tools"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1539208379, "post_id": 52749280, "comment_id": 92422958, "body": "What do you mean by &quot;not able to use&quot;? Are you getting unresolved reference errors?"}, {"owner": {"reputation": 53, "user_id": 9170447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf3e4cbe0344ee72bc7953447657ab92?s=128&d=identicon&r=PG&f=1", "display_name": "InternetUser", "link": "https://stackoverflow.com/users/9170447/internetuser"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1539209224, "post_id": 52749280, "comment_id": 92423241, "body": "I have unresolved inclusion issues."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1539210109, "post_id": 52749280, "comment_id": 92423485, "body": "Oh, you&#39;ll need to set the include path too. The library and its header file(s) are different things."}, {"owner": {"reputation": 53, "user_id": 9170447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf3e4cbe0344ee72bc7953447657ab92?s=128&d=identicon&r=PG&f=1", "display_name": "InternetUser", "link": "https://stackoverflow.com/users/9170447/internetuser"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1539211015, "post_id": 52749280, "comment_id": 92423757, "body": "I have not found any &quot;include&quot; folder in my or-tools directory so in the &quot;includes&quot; option of the project I have given the path of the folder containing files that I want to include. But I am still having the same problem."}, {"owner": {"reputation": 3572, "user_id": 5710233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5LmFgRhfZNQ/AAAAAAAAAAI/AAAAAAAAABk/Etcd11tdJGc/photo.jpg?sz=128", "display_name": "Mizux", "link": "https://stackoverflow.com/users/5710233/mizux"}, "edited": false, "score": 0, "creation_date": 1539934556, "post_id": 52749280, "comment_id": 92688356, "body": "You should open an issue on the issue tracker, please specify which version, how you build it, your platform (linux?), what did you means by install ?"}], "owner": {"reputation": 53, "user_id": 9170447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf3e4cbe0344ee72bc7953447657ab92?s=128&d=identicon&r=PG&f=1", "display_name": "InternetUser", "link": "https://stackoverflow.com/users/9170447/internetuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539208280, "creation_date": 1539208280, "question_id": 52749280, "link": "https://stackoverflow.com/questions/52749280/google-or-tools-c-eclipse", "title": "Google Or-Tools C++ Eclipse", "body": "<p>I am trying to use Or-tools C++ on Linux. I have installed them and generated a make-file successfully.\nFrom the command window, I ran the example successfully. Now I want to use it with Eclipse CDT. \nI have  created a new project and done as follows:</p>\n\n<ul>\n<li>Properties-> C/C++ General -> Paths and Symbols ->Libraries ->Add</li>\n</ul>\n\n<p>and then has given the path of my '<strong>or-tools</strong>''<strong>lib</strong>' folder.\nI am still not able to use or-tools in my project. Any suggestion is much appreciated.</p>\n"}, {"tags": ["c++", "class"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1539208507, "post_id": 52749279, "comment_id": 92422998, "body": "Please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1539208898, "post_id": 52749279, "comment_id": 92423139, "body": "@RSahu sorry I ask question with mobile apps, but I just edited, need help"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 3, "creation_date": 1539209039, "post_id": 52749279, "comment_id": 92423183, "body": "You need to create a<code>Fraction.h</code> file and include that from main.cpp and fraction.cpp. The problem is you defined all of your functions in the class declaration so the .cpp file will not have anything."}, {"owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539209568, "post_id": 52749279, "comment_id": 92423348, "body": "@drescherjm whooaaa genius man, that works thanks so much, just renamed Fraction.cpp to Fraction.h and add <code>#include &quot;Fraction.h&quot;</code> strangely it works smoothly. But how can I make it so it just Fraction.cpp for more consistency?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539209648, "post_id": 52749279, "comment_id": 92423373, "body": "No. You don&#39;t want to do that. You want to create a <code>Fraction.cpp</code> file. And move some of your class members from your class declaration to your <code>Fraction.cpp</code> file. I would say that <code>normalize()</code> probably should be moved."}, {"owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539209873, "post_id": 52749279, "comment_id": 92423424, "body": "@drescherjm well that sounds more complicated than just making it <code>Fraction.h</code>. Well I think I&#39;ll just stick to <code>Fraction.h</code>. Thanks so much mann... worked perfectly"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539209966, "post_id": 52749279, "comment_id": 92423448, "body": "I will post an example."}, {"owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539210059, "post_id": 52749279, "comment_id": 92423471, "body": "@drescherjm whoaa... sure thanks, can you do it in formal answer?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539210212, "post_id": 52749279, "comment_id": 92423508, "body": "It&#39;ll probably be infiormal. It&#39;s hard to get people to use the proper &quot;thee&quot;s and &quot;thou&quot;s these days. And people end sentences with prepositions, the barbarians."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539210410, "post_id": 52749575, "comment_id": 92423563, "body": "Upped, but recommend adding a few words on, or a link to, the selection criteria explaining which functions should be included in or removed from the class definition."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1539210509, "post_id": 52749575, "comment_id": 92423588, "body": "And <a href=\"https://stackoverflow.com/questions/333889/why-have-header-files-and-cpp-files\">maybe a note on what a header file is and why we split them all up</a>."}, {"owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "edited": false, "score": 0, "creation_date": 1539210543, "post_id": 52749575, "comment_id": 92423595, "body": "It sure works thankss, but what does <code>#ifndef</code> and <code>#define</code> do? Sorry to bother you, this is new to me..."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539210636, "post_id": 52749575, "comment_id": 92423623, "body": "#ifndef is used here for an include guard."}, {"owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539210833, "post_id": 52749575, "comment_id": 92423683, "body": "@user4581301 whoa thanks to link it , just just know that header specifically means for class declaration, I thought I use it to make a bunch of functions"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539211484, "post_id": 52749575, "comment_id": 92423872, "body": "One thing I don&#39;t like with this code is you don&#39;t have a constructor."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "edited": false, "score": 0, "creation_date": 1539213054, "post_id": 52749575, "comment_id": 92424278, "body": "@user312781 it&#39;s a bit deeper than just class goes in the header. Read the second answer at that link because it covers what&#39;s up in much greater detail. Think of it as the interface, the &quot;What can I do with this code?&quot;,  goes in the header. The <i>What</i> goes into the header and the <i>How</i> goes into the cpp. Generally an interface doesn&#39;t change much. The code that implements the interface, that&#39;s changing all the time as people figure out how to make it better."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1539213065, "post_id": 52749575, "comment_id": 92424282, "body": "When you bundle the interface with the implementation, any change to the implementation ripples through the entire system even though nothing the rest of the system cares about changed."}], "tags": [], "owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "is_accepted": true, "score": 2, "last_activity_date": 1539211613, "last_edit_date": 1539211613, "creation_date": 1539210215, "answer_id": 52749575, "question_id": 52749279, "link": "https://stackoverflow.com/questions/52749279/how-to-declare-class-in-different-files-in-c/52749575#52749575", "title": "How to declare class in different files in c++?", "body": "<p>I would create a <code>Fraction.h</code> file containing your class </p>\n\n<pre><code>#ifndef FRACTION_H\n#define FRACTION_H\n\nclass Fraction {\nprivate:\n  int num, den;\npublic:\n  void set(int n, int d) {\n    num = n;\n    den = d;\n    normalize();\n  }\n  int get_num() {\n    return num;\n  }\n  int get_den() {\n    return den;\n  }\nprivate:\n   void normalize();\n   int gcf(int a, int b);\n   int lcm(int a, int b);\n};\n\n#endif //ndef FRACTION_H   \n</code></pre>\n\n<p>Then <code>Fraction.cpp</code> containing</p>\n\n<pre><code>#include \"Fraction.h\"\nvoid Fraction::normalize() {\n  if (den == 0 || num == 0) {\n    num = 0;\n    den = 1;\n  }\n  if (den &lt; 0) {\n    num *= -1;\n    den *= -1;\n  }\n  int n = gcf(num, den);\n  num = num / n;\n  den = den / n;\n}\n\nint Fraction::gcf(int a, int b) {\n  if (b == 0)\n    return abs(a);\n  else\n    return gcf(b, a%b);\n}\n\nint Fraction::lcm(int a, int b) {\n  int n = gcf(a, b);\n  return a / n * b;\n}\n</code></pre>\n\n<p>Then in <code>main.cpp</code> make sure you add </p>\n\n<pre><code>#include \"Fraction.h\"\n</code></pre>\n\n<p>to your includes</p>\n\n<p>The main reason I moved the larger functions from the class declaration to the <code>Fraction.cpp</code> was to keep the interface clean. However there are several other reasons to consider what member functions to implement in the header versus the translation unit. </p>\n\n<p>The following question discusses that in more detail: <a href=\"https://stackoverflow.com/questions/333889/why-have-header-files-and-cpp-files\">Why have header files and .cpp files?</a></p>\n\n<p>In the comments there was a question on the purpose of the <code>#ifndef FRACTION_H</code> these are include guards. A good discussion on what these are used for are here: <a href=\"https://stackoverflow.com/questions/1653958/why-are-ifndef-and-define-used-in-c-header-files\">Why are #ifndef and #define used in C++ header files?</a></p>\n"}], "owner": {"reputation": 41, "user_id": 10441250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b5430b17f32e19655b6e2131bca5d5?s=128&d=identicon&r=PG&f=1", "display_name": "user312781", "link": "https://stackoverflow.com/users/10441250/user312781"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 52749575, "answer_count": 1, "score": -1, "last_activity_date": 1539211613, "creation_date": 1539208275, "last_edit_date": 1539209296, "question_id": 52749279, "link": "https://stackoverflow.com/questions/52749279/how-to-declare-class-in-different-files-in-c", "title": "How to declare class in different files in c++?", "body": "<p>I just learned that I can define function function in separate files than main.cpp as long as I declared the function in main.cpp and compile it using <code>g++ main.cpp message.cpp</code>.</p>\n\n<p>But what if I want to define a class in separate files than main.cpp? It doesn't seems to work and I don't know what to declare in main.cpp while defining that class in separate files. Thanks.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>Here is main.cpp code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint main() {\n  int a, b;\n  string str;\n  Fraction fract;\n  while (true) {\n    cout &lt;&lt; \"Enter numerator: \";\n    cin &gt;&gt; a;\n    cout &lt;&lt; \"Enter denumerator: \";\n    cin &gt;&gt; b;\n    fract.set(a, b);\n    cout &lt;&lt; \"Numerator is \" &lt;&lt; fract.get_num()\n     &lt;&lt; endl;\n    cout &lt;&lt; \"Denumerator is \" &lt;&lt; fract.get_den()\n     &lt;&lt; endl;\n    cout &lt;&lt; \"Do it again? (y or n) \";\n    cin &gt;&gt; str;\n    if (!(str[0] == 'y'))\n      break;\n  }\n  return 0;\n}\n</code></pre>\n\n<p>And here is Fraction.cpp</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n\nclass Fraction {\nprivate:\n  int num, den;\npublic:\n  void set(int n, int d) {\n    num = n;\n    den = d;\n    normalize();\n  }\n  int get_num() {\n    return num;\n  }\n  int get_den() {\n    return den;\n  }\nprivate:\n  void normalize() {\n    if (den == 0 || num == 0) {\n      num = 0;\n      den = 1;\n    }\n    if (den &lt; 0) {\n      num *= -1;\n      den *= -1;\n    }\n    int n = gcf(num, den);\n    num = num / n;\n    den = den / n;\n  }\n  int gcf(int a, int b) {\n    if (b == 0)\n      return abs(a);\n    else\n      return gcf(b, a%b);\n  }\n  int lcm(int a, int b) {\n    int n = gcf(a, b);\n    return a / n * b;\n  }\n};\n</code></pre>\n\n<p>But I can't compile it with <code>g++ main.cpp Fraction.cpp</code>.</p>\n\n<hr>\n\n<p>Edit2:</p>\n\n<p>It gives me error:</p>\n\n<pre><code>main.cpp: in function 'int main()':\nmain.cpp:8:3: error: 'Fraction' was not declared in this scope\nmain.cpp:14:15: 'fract' was not declared in this scope\n</code></pre>\n"}, {"tags": ["c++", "c++11", "forward-declaration", "argument-dependent-lookup", "friend-function"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1539210777, "post_id": 52749225, "comment_id": 92423665, "body": "<i>&quot;A const&amp; is a synomyn for A&lt;T&gt; const&amp;&quot;</i>: Look at <a href=\"https://en.cppreference.com/w/cpp/language/injected-class-name\" rel=\"nofollow noreferrer\">injected class name</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539210650, "post_id": 52749538, "comment_id": 92423627, "body": "So, there is no way to make case 3 equivalent to case 2?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 1, "creation_date": 1539210843, "post_id": 52749538, "comment_id": 92423689, "body": "No, but there are methods to stay in case 2."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539211143, "post_id": 52749538, "comment_id": 92423788, "body": "Then I don&#39;t understand what you are proposing. Can you please rewrite case 2 following your advice so I can see an example?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539211609, "post_id": 52749538, "comment_id": 92423894, "body": "@alfC: Added example to stay with <i>inlined</i> defined friend function."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539211836, "post_id": 52749538, "comment_id": 92423964, "body": "Ah, excellent. So it seems to be good to make the friend functions &quot;self contained&quot; and at worst delegate to a member function. I didn&#39;t say it in the question but I have an extra problem the class that will be defined later is the return type of the friend. I am sure that I cannot return a class that is not defined from the defintion of the friend function (<code>class B</code> instead of <code>double</code> here)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 1, "creation_date": 1539212306, "post_id": 52749538, "comment_id": 92424087, "body": "I tried <code>B do_f() const; friend B f(A const&amp; a){return a.do_f();}</code> and indeed got issues about incomplete type <code>B</code>, but <code>B do_f() const; friend auto f(A const&amp; a){return a.do_f();}</code> succeed with both gcc/clang."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539212835, "post_id": 52749538, "comment_id": 92424210, "body": "that&#39;s right for me as well, it works with <code>auto f(...)</code> but not with <code>B f(...)</code>! I don&#39;t know why it works but it does. (good luck with C++98 then). i added this case to your answer if you don&#39;t mind."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539212838, "post_id": 52749538, "comment_id": 92424213, "body": "Note sure it is valid though."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539212999, "post_id": 52749538, "comment_id": 92424260, "body": "I am not sure either. Intuition tells me it shouldn&#39;t work. Perhaps it works because the <code>auto</code> is deduced much later when the template is instantiated. If it is not valid, I am back to square 1 (square 0 in C++) for the use case I had in mind."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1539213859, "post_id": 52749538, "comment_id": 92424453, "body": "It is ironic that it is easier to define a member function out-of-line than a friend function."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 1, "creation_date": 1539216140, "post_id": 52749538, "comment_id": 92424907, "body": "Asked <a href=\"https://stackoverflow.com/questions/52750143/incomplete-class-usage-with-auto-in-template-class\">incomplete-class-usage-with-auto-in-template-class</a> to know validity of <code>auto</code>."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1616013495, "post_id": 52749538, "comment_id": 117873985, "body": "with the years I found compilers (<code>nvcc</code>, <code>intel</code>) for which <code>auto</code> friend will choke SFINAE (the function is not detected). That is one problem of auto friends. I think this happens when the compiler cannot deduce auto in the &quot;first pass&quot;."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 3, "last_activity_date": 1539213088, "last_edit_date": 1539213088, "creation_date": 1539209973, "answer_id": 52749538, "question_id": 52749225, "link": "https://stackoverflow.com/questions/52749225/what-is-the-right-way-to-define-a-friend-function-outside-a-template-class/52749538#52749538", "title": "What is the right way to define a friend function outside a template class?", "body": "<p>Friend functions have special visibility rule (special case for ADL), so defining function outside the class is different than inside anyway.</p>\n\n<p>Moreover, in case 2, the function is <strong>not</strong> template. even if you have one for every template. So to implement it outside of the class, \nyou would have to implement each <code>friend double f(A&lt;T&gt; const&amp; a);</code> for every <code>T</code>.</p>\n\n<p>The advice is the most close workaround:</p>\n\n<ul>\n<li>Your function (only the specialization) is friend.</li>\n<li><p>but your function is template (so deduction should occurs:<br>\nwith <code>friend double f(A&lt;T&gt; const&amp; a, T);</code> (case 2), <code>f(A&lt;float&gt;{}, 42);</code> would succeed<br>\nwhereas <code>friend double f&lt;&gt;(A&lt;T&gt; const&amp; a, T);</code> would not<br>\n(<code>T</code> would be <code>float</code> for <code>A&lt;float&gt;</code> and <code>int</code> for <code>42</code>))</p></li>\n<li><p>your function is declared outside, so its visibility is <em>\"different\"</em>.</p></li>\n</ul>\n\n<blockquote>\n  <p>Now suppose that I need to implement <code>f</code> in terms of a class that needs to be defined later. I such case I tried doing this:</p>\n</blockquote>\n\n<p>Other work around is to declare a private method which will do the job, that allow you to have friend definition inside the class.\nThat private method can then be defined later:</p>\n\n<pre><code>template&lt;class T&gt;\nclass A{\n    double p_;\n\n    double do_f() const;\n    friend double f(A const&amp; a){return a.do_f();}\n};\n\n// Thing needed by A&lt;T&gt;::do_f\n\ntemplate&lt;class T&gt;\ndouble A&lt;T&gt;::do_f() const\n{\n    // ...\n}\n</code></pre>\n\n<hr>\n\n<p>If the return type is an incomplete type you have to do a trick with <code>auto</code> return (this works in g++11 and clang++11).</p>\n\n<pre><code>template&lt;class T&gt; class A;\nclass B;\n\ntemplate&lt;class T&gt;\nclass A{\n    B do_f() const;\n    friend auto f(A const&amp; a){return a.do_f();} // not friend B f(...\n};\n\nclass B{};\n\ntemplate&lt;class T&gt; B A&lt;T&gt;::do_f() const{return B{};}\n\nint main(){A&lt;double&gt; a; f(a);}\n</code></pre>\n"}], "owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 52749538, "answer_count": 1, "score": 2, "last_activity_date": 1539213088, "creation_date": 1539207988, "question_id": 52749225, "link": "https://stackoverflow.com/questions/52749225/what-is-the-right-way-to-define-a-friend-function-outside-a-template-class", "title": "What is the right way to define a friend function outside a template class?", "body": "<p>If I have a normal class I can \"inject\" a non-free friend function inside the class. (That among other things can be only be found by ADL).</p>\n\n<p><strong>case 1:</strong></p>\n\n<pre><code>class A{\n  double p_;\n  friend double f(A const&amp; a){return a.p_;}\n};\n</code></pre>\n\n<p>If instead this is a template class I can do:</p>\n\n<p><strong>case 2:</strong></p>\n\n<pre><code>template&lt;class T&gt;\nclass A{\n  double p_;\n  friend double f(A const&amp; a){return a.p_;} // apparently A const&amp; is a synomyn for A&lt;T&gt; const&amp;\n};\n</code></pre>\n\n<p>Now suppose that I need to implement <code>f</code> in terms of a class that needs to be defined later. I such case I tried doing this:</p>\n\n<p><strong>case 3:</strong></p>\n\n<pre><code>template&lt;class T&gt;\nclass A{\n    double p_;\n    friend double f(A const&amp; a);\n};\n...\n</code></pre>\n\n<p>This already gives a warning: \"warning: friend declaration \u2018double f(const A&amp;)\u2019 declares a non-template function [-Wnon-template-friend]\".</p>\n\n<p>Following the advice from the compiler I can do this:</p>\n\n<pre><code>template&lt;class T&gt; class A;\n\ntemplate&lt;class T&gt; double f(A&lt;T&gt; const&amp; a);\n\ntemplate&lt;class T&gt;\nclass A{\n    double p_;\n    friend double f&lt;&gt;(A const&amp; a);\n};\n\ntemplate&lt;class T&gt; double f(A&lt;T&gt; const&amp; a){return a.p_;}\n</code></pre>\n\n<p>Which requires so much more code and I am not even sure it is 100% equivalent to case 2 abov which is what I want, because now I have a truly free function that happens to be a friend instead of an injected friend.</p>\n\n<p><strong>Can case 3 be modified to be 100% equivalent to case 2 and still have a definition of <code>f</code> outside the class? In other words can one inject a friend function that is defined out of the class?</strong></p>\n\n<hr>\n\n<p>I tried this also, which gives a compiler error:</p>\n\n<pre><code>template&lt;class T&gt;\nclass A{\n    double p_;\n    friend double f(A&lt;T&gt; const&amp; a);\n};\n\ntemplate&lt;class T&gt; double A&lt;T&gt;::f(A&lt;T&gt; const&amp; a){return a.p_;}\n</code></pre>\n\n<p>This answer finds the same solution but doesn't answer the question about case 3 being equivalent to case 2. <a href=\"https://stackoverflow.com/questions/43696019/what-is-the-right-way-to-write-friend-function-declarations-in-template-class\">What is the right way to write friend function declarations in template class?</a></p>\n"}, {"tags": ["c++", "function", "class", "member"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1539207888, "post_id": 52749193, "comment_id": 92422799, "body": "Hello.  What is the question you&#39;re asking?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1539207904, "post_id": 52749193, "comment_id": 92422808, "body": "I would replace <code>char BOOKTITLE[20];</code> with a std::string."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1539208042, "post_id": 52749193, "comment_id": 92422852, "body": "BTW, common coding convention is to use ALL CAPS for constants, such a <code>MAX_BOOK_TITLE_LENGTH</code>."}, {"owner": {"reputation": 3, "user_id": 3340643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6881eacc7ac896cdf5b3ed2239195d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3340643", "link": "https://stackoverflow.com/users/3340643/user3340643"}, "edited": false, "score": 0, "creation_date": 1539208302, "post_id": 52749193, "comment_id": 92422937, "body": "Dear Thomas,  I am asking how I should mend this code to incorporate following requirement  Write another class Writer that contains that contains the attributes of WriterName, Address and NumberofBooks written by him. It contains array of book objects as iys member. The length of array should be 5 to store the data of five books. It should also contain a member function to input and display its attributes."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1539208726, "post_id": 52749193, "comment_id": 92423076, "body": "What is an <code>iys</code> member?  Haven&#39;t come across the term <code>iys</code>."}, {"owner": {"reputation": 2771, "user_id": 5963279, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10207102799463401/picture?type=large", "display_name": "Thomas Cook", "link": "https://stackoverflow.com/users/5963279/thomas-cook"}, "edited": false, "score": 2, "creation_date": 1539208805, "post_id": 52749193, "comment_id": 92423111, "body": "You have been asked to write some code that models a book -&gt; author relationship. An author has a name, an address and collection of books they have published. A book has an id, a name and a price.   An author therefore has a 1 to many relationship with a book. in other words, one author can have written many books.   Before you search for code to solve your problem, you need to understand how to model the problem. Once you know how to model the problem, you won&#39;t need to copy/pase code, it&#39;s simply transcribing the mental model to words."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1539208858, "post_id": 52749193, "comment_id": 92423126, "body": "You may want to change <code>BOOKTITLE</code> to use <code>std::string</code>.  Character arrays can overflow.  Also with character arrays, you should be using the <code>str*()</code> family of functions, such as <code>strcmp</code> and <code>strlen</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1539209766, "post_id": 52749193, "comment_id": 92423401, "body": "Lastly, the <code>main</code> function has a return type of <code>int</code>, so it can return a status to the Operating System.  Search the internet for &quot;C++ EXIT_SUCCESS&quot; or &quot;C++ EXIT_FAILURE&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3340643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6881eacc7ac896cdf5b3ed2239195d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3340643", "link": "https://stackoverflow.com/users/3340643/user3340643"}, "edited": false, "score": 0, "creation_date": 1539208507, "post_id": 52749283, "comment_id": 92422999, "body": "you mean I just incorporate the above code shared by you in the end of my code?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 3, "user_id": 3340643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6881eacc7ac896cdf5b3ed2239195d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3340643", "link": "https://stackoverflow.com/users/3340643/user3340643"}, "edited": false, "score": 0, "creation_date": 1539208657, "post_id": 52749283, "comment_id": 92423054, "body": "You can use it however you want.  You could place the <code>Writer</code> class into a separate header file and method implementations into a separate source file.  You could also place everything into one <code>main</code> file.  There are many possibilities."}, {"owner": {"reputation": 2771, "user_id": 5963279, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10207102799463401/picture?type=large", "display_name": "Thomas Cook", "link": "https://stackoverflow.com/users/5963279/thomas-cook"}, "reply_to_user": {"reputation": 3, "user_id": 3340643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6881eacc7ac896cdf5b3ed2239195d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3340643", "link": "https://stackoverflow.com/users/3340643/user3340643"}, "edited": false, "score": 1, "creation_date": 1539209116, "post_id": 52749283, "comment_id": 92423204, "body": "@user3340643 - I implore you not to simply copy and paste code, you will not learn anywhere near as efficiently that way and may even completely stunt your growth as a programmer. This is a fairly trivial problem that you should be able to solve by breaking the problem down into chunks, doing some rudimentary research/learning and then coding a solution - this will give you a jump pad to the rest of OOP and generally thinking like a programmer. Just my 2 cents though"}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": true, "score": 0, "last_activity_date": 1539208309, "creation_date": 1539208309, "answer_id": 52749283, "question_id": 52749193, "link": "https://stackoverflow.com/questions/52749193/define-book-class-with-member-function-and-store-value/52749283#52749283", "title": "define book class with member function and store value", "body": "<p>To <em>contain</em> an instance of an object you declare a member of that type in your class:  </p>\n\n<pre><code>class Writer\n{\n  const size_t MAX_BOOKS_WRITTEN = 5U;\n  Book         books_written[MAX_BOOKS_WRITTEN];\n};\n</code></pre>\n\n<p>In the above class, \"that contains that contains\" an array of books written.  </p>\n"}], "owner": {"reputation": 3, "user_id": 3340643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6881eacc7ac896cdf5b3ed2239195d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3340643", "link": "https://stackoverflow.com/users/3340643/user3340643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 52749283, "answer_count": 1, "score": -2, "last_activity_date": 1539208309, "creation_date": 1539207718, "last_edit_date": 1539208070, "question_id": 52749193, "link": "https://stackoverflow.com/questions/52749193/define-book-class-with-member-function-and-store-value", "title": "define book class with member function and store value", "body": "<p>Can someone please help me with the below requirement</p>\n\n<p>Class book that  that contains attributes BookId, BookName, and Price. It also contain member function to input and show its attributes.</p>\n\n<p>Write another class Writer that contains that contains the attributes of WriterName, Address and NumberofBooks written by him. It contains array of book objects as iys member. The length of array should be 5 to store the data of five books.\nIt should also contain a member function to input and display its attributes.</p>\n\n<p><a href=\"http://www.cppforschool.com/assignment/class-object-sol/class-book.html\" rel=\"nofollow noreferrer\">I found a solution on google with below code</a> but it appears it is useful for my half requirement.</p>\n\n<pre><code>#include&lt;iostream.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\nclass BOOK\n{\n    int BOOKNO;\n    char BOOKTITLE[20];\n    float PRICE;\n    void TOTAL_COST(int N)\n    {\n        float tcost;\n        tcost=PRICE*N;\n        cout&lt;&lt;tcost;\n    }\npublic:\n    void INPUT()\n    {\n        cout&lt;&lt;\"Enter Book Number \";\n        cin&gt;&gt;BOOKNO;\n        cout&lt;&lt;\"Enter Book Title \";\n        gets(BOOKTITLE);\n        cout&lt;&lt;\"Enter price per copy \";\n        cin&gt;&gt;PRICE;\n    }\n\n    void PURCHASE()\n    {\n        int n;\n        cout&lt;&lt;\"Enter number of copies to purchase \";\n        cin&gt;&gt;n;\n        cout&lt;&lt;\"Total cost is \";\n        TOTAL_COST(n);\n    }\n};\n\nvoid main()\n{\n    BOOK obj;\n        obj.INPUT();\n        obj.PURCHASE();\n        getch();\n    }\n</code></pre>\n"}, {"tags": ["c++", "tostring"], "comments": [{"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 1, "creation_date": 1539207975, "post_id": 52749161, "comment_id": 92422828, "body": "Do you know you&#39;re trying to call <code>std::to_string</code> on two member variables that are already <code>std::string</code>?"}, {"owner": {"reputation": 301, "user_id": 9097408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7771eb5cebb76bb74221dd112c131df?s=128&d=identicon&r=PG&f=1", "display_name": "rbb791", "link": "https://stackoverflow.com/users/9097408/rbb791"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1539208464, "post_id": 52749161, "comment_id": 92422985, "body": "Good call. Thanks for pointing that out."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539207892, "post_id": 52749188, "comment_id": 92422802, "body": "namespace should be class name.  All class members are scoped to the class name."}, {"owner": {"reputation": 301, "user_id": 9097408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7771eb5cebb76bb74221dd112c131df?s=128&d=identicon&r=PG&f=1", "display_name": "rbb791", "link": "https://stackoverflow.com/users/9097408/rbb791"}, "edited": false, "score": 0, "creation_date": 1539208196, "post_id": 52749188, "comment_id": 92422900, "body": "Thank you. So you have to do this for every function, even though you are defining it within the class itself?"}, {"owner": {"reputation": 420, "user_id": 3738870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/190425893cffeaa9db58f472ef15b111?s=128&d=identicon&r=PG&f=1", "display_name": "user3738870", "link": "https://stackoverflow.com/users/3738870/user3738870"}, "edited": false, "score": 0, "creation_date": 1539208257, "post_id": 52749188, "comment_id": 92422922, "body": "No, if you define it inline (that is, in the .h file) you don&#39;t need to do this. It is needed only in the .cpp file"}], "tags": [], "owner": {"reputation": 420, "user_id": 3738870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/190425893cffeaa9db58f472ef15b111?s=128&d=identicon&r=PG&f=1", "display_name": "user3738870", "link": "https://stackoverflow.com/users/3738870/user3738870"}, "is_accepted": true, "score": 3, "last_activity_date": 1539208200, "last_edit_date": 1539208200, "creation_date": 1539207692, "answer_id": 52749188, "question_id": 52749161, "link": "https://stackoverflow.com/questions/52749161/use-of-undeclared-identifier-for-private-variables-within-a-class-c/52749188#52749188", "title": "use of undeclared identifier for private variables within a class (C++)", "body": "<p>You need to specify the namespace (which is your <code>Auto_Part</code> class) in the definition of <code>to_string</code> in your .cpp file. So your code should be </p>\n\n<pre><code>std::string Auto_Part::to_string(){\n    return std::to_string(type) + \", \" + std::to_string(name) + \", \" + std::to_string(part_number) + \", \" + std::to_string(price);\n}\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 9097408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7771eb5cebb76bb74221dd112c131df?s=128&d=identicon&r=PG&f=1", "display_name": "rbb791", "link": "https://stackoverflow.com/users/9097408/rbb791"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "closed_date": 1539269252, "accepted_answer_id": 52749188, "answer_count": 1, "score": 0, "last_activity_date": 1539208200, "creation_date": 1539207580, "question_id": 52749161, "link": "https://stackoverflow.com/questions/52749161/use-of-undeclared-identifier-for-private-variables-within-a-class-c", "closed_reason": "Not suitable for this site", "title": "use of undeclared identifier for private variables within a class (C++)", "body": "<p>I'm trying to use the <code>std::to_string()</code> function on private variables within the class, but I'm getting an \"undeclared variables\" error.</p>\n\n<p>Here is the header file with the function declarations:</p>\n\n<pre><code>class Auto_Part\n{\npublic:\n    Auto_Part();\n    Auto_Part(std::string t, std::string n, int pn, double p): type(t), name(n), part_number(pn), price(p) {};\n    std::string get_type() const;\n    std::string get_name() const;\n    int get_part_number() const;\n    double get_price() const;\n    void set_type(std::string);\n    void set_name(std::string);\n    void set_part_number(int);\n    void set_price(double);\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const Auto_Part&amp;);\n    bool operator&lt;(const Auto_Part&amp;) const;\n    std::string to_string();\n\nprivate:\n    std::string type;\n    std::string name;\n    int part_number;\n    double price;\n};\n</code></pre>\n\n<p>And here is the function in question in my .cpp file: </p>\n\n<pre><code>std::string to_string(){\n    return std::to_string(type) + \", \" + std::to_string(name) + \", \" + std::to_string(part_number) + \", \" + std::to_string(price);\n}\n</code></pre>\n\n<p>My IDE is highlighting type, name, part_number and price in my to_string() function with the above mentioned error. <strong>Why would it not recognize the variables if they are declared in the class?</strong></p>\n"}, {"tags": ["c++", "operator-overloading", "overloading"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539207767, "post_id": 52749154, "comment_id": 92422768, "body": "Make a reference member in <code>A</code> that refers to the sub object member?"}, {"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539207897, "post_id": 52749154, "comment_id": 92422806, "body": "struct b does not stay the same. It can be another struct, that is declared in A, and having different number of data members with different types. I will update it to make it more concrete. (Example Updated)"}, {"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539208736, "post_id": 52749154, "comment_id": 92423084, "body": "Having the ability to overload <code>.</code> operator would just be perfect."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1539209017, "post_id": 52749154, "comment_id": 92423177, "body": "Is it okay if the solution adds to the size of <code>A</code> and using the members this way is not exactly as efficient as direct member access?"}, {"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1539209306, "post_id": 52749154, "comment_id": 92423263, "body": "@aschepler struct size or efficiency is not a concern. Simplicity in syntax is what I need at this point."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1539212537, "post_id": 52749154, "comment_id": 92424144, "body": "Hmm, this is trickier than I thought. A reference member won&#39;t play nice with <code>const</code>. A proxy member (besides doing strange things in some template and <code>auto</code> cases) would itself run into trouble allowing a second dot operator like <code>object_2.k.c_str()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "edited": false, "score": 0, "creation_date": 1539211805, "post_id": 52749636, "comment_id": 92423952, "body": "better would be the <code>.</code> syntax."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "reply_to_user": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "edited": false, "score": 0, "creation_date": 1539212294, "post_id": 52749636, "comment_id": 92424085, "body": "@nmd_07 Well, as you said by yourself, this is impossible. May I ask why <code>-&gt;</code> isn&#39;t working for you? Are you using <code>A</code> as a pointer?"}, {"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "edited": false, "score": 0, "creation_date": 1539287706, "post_id": 52749636, "comment_id": 92458674, "body": "It would be more convenient to use <code>.</code> operator."}], "tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": false, "score": 1, "last_activity_date": 1539210603, "creation_date": 1539210603, "answer_id": 52749636, "question_id": 52749154, "link": "https://stackoverflow.com/questions/52749154/accessing-data-members-of-a-data-memberitself-is-object-as-if-they-were-class/52749636#52749636", "title": "Accessing data members of a data member(itself is object) as if they were class members", "body": "<p>You cannot overload <code>.</code>, that is correct. You can, however, overload <code>-&gt;</code>, if that is also an option for you? </p>\n\n<p><code>operator-&gt;</code> must return a type that itself supports <code>operator-&gt;</code>, e.g. a raw pointer suits this:</p>\n\n<pre><code>template &lt;bool T&gt; struct A\n{\n    struct B\n    {\n        int x; \n        double y; \n    }; \n    struct C\n    { \n        char c; \n        std::string k;\n    };\n    using type = std::conditional&lt;T, B, C&gt;::type;\n    type b;\n\n    type* operator-&gt;() { return &amp;b; }\n};\n</code></pre>\n\n<p>You can use it like so:</p>\n\n<pre><code>int main()\n{ \n    A&lt;true&gt; object_1; \n    A&lt;false&gt; object_2; \n    cout &lt;&lt; object_1-&gt;x; \n    cout &lt;&lt; object_2-&gt;k;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "is_accepted": false, "score": 0, "last_activity_date": 1539557344, "creation_date": 1539557344, "answer_id": 52807745, "question_id": 52749154, "link": "https://stackoverflow.com/questions/52749154/accessing-data-members-of-a-data-memberitself-is-object-as-if-they-were-class/52807745#52807745", "title": "Accessing data members of a data member(itself is object) as if they were class members", "body": "<p>Seems that it is easier than I thought : </p>\n\n<pre><code>struct B{\n    int x; \n    double y;\n}\nstruct C{\n   char c;\n   std::string k;\n}\ntemplate &lt;bool T&gt;\nstruct A : public std::conditional &lt;T, B, C&gt;::type{\n\n}\n</code></pre>\n"}], "owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539557344, "creation_date": 1539207541, "last_edit_date": 1539209362, "question_id": 52749154, "link": "https://stackoverflow.com/questions/52749154/accessing-data-members-of-a-data-memberitself-is-object-as-if-they-were-class", "title": "Accessing data members of a data member(itself is object) as if they were class members", "body": "<p>Given the scenerio,</p>\n\n<pre><code>template &lt;bool T&gt;\nstruct A{\n    struct B{\n       int x; \n       double y;\n    }\n    struct C{\n       char c;\n       std::string k;\n    }\n using type = std::conditional&lt;T, B, C&gt;::type;\n type b;\n}\n</code></pre>\n\n<p>I would like to access to data members such as:</p>\n\n<pre><code>int main(){\n    A&lt;true&gt; object_1;\n    A&lt;false&gt; object_2;\n    cout &lt;&lt; object_1.x;\n    cout &lt;&lt; object_2.k;\n}\n</code></pre>\n\n<p>This would be possible if <code>.</code>(dot) operator could be overloaded. However, this is not possible(at least now). Is there a workaround to make the example work?</p>\n"}, {"tags": ["java", "c++", "encryption", "openssl"], "answers": [{"tags": [], "owner": {"reputation": 14334, "user_id": 1380680, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TRgwX.png?s=128&g=1", "display_name": "Reinier Torenbeek", "link": "https://stackoverflow.com/users/1380680/reinier-torenbeek"}, "is_accepted": true, "score": 1, "last_activity_date": 1539240386, "last_edit_date": 1539240386, "creation_date": 1539239388, "answer_id": 52753632, "question_id": 52749038, "link": "https://stackoverflow.com/questions/52749038/verify-signature-in-openssl-c-which-is-signed-by-java-dsa/52753632#52753632", "title": "Verify signature in openssl c++, which is signed by JAVA DSA?", "body": "<p>The DSA signature generated by the java code is encoded as ASN.1. Assuming that you have stored it in a file called <code>sig</code>, you can verify that using the <code>openssl asn1parse</code> command, like this:</p>\n\n<pre><code>$ openssl asn1parse -inform der -in sig -i\n    0:d=0  hl=2 l=  44 cons: SEQUENCE          \n    2:d=1  hl=2 l=  20 prim:  INTEGER           :64C91D32CC10D7B67A7994BE680FA2BB07C431E2\n   24:d=1  hl=2 l=  20 prim:  INTEGER           :712F1C768CFFA704DA1BEFA5A36517CB4776E6FF\n</code></pre>\n\n<p>In order to load that kind of formatted signature into the OpenSSL <code>DSA_SIG</code> structure, you have to leverage the function <a href=\"https://www.openssl.org/docs/manmaster/man3/d2i_X509.html\" rel=\"nofollow noreferrer\"><code>d2i_DSA_SIG()</code></a>. Reusing the names of your variables:</p>\n\n<pre><code>const unsigned char *ptr = sign_buffer;\nDSA_SIG *dsasig = d2i_DSA_SIG(NULL, &amp;ptr, sign_length);\n</code></pre>\n\n<p>The value of <code>ptr</code> will be modified to point beyond the bytes that were read, as explained in the documentation.</p>\n\n<p>Indeed you will have to hash your data bytes before verifying, using the same hashing algorithm as used when signing. It seems that <code>\"DSA</code>\" is synonym for <code>\"SHA1withDSA</code>\". I have verified that with a test, but I would recommend to be as explicit as possible in your code and use the full name in stead of some unclear alias. Example code of how to calculate digests with OpenSSL can be found on the <a href=\"https://wiki.openssl.org/index.php/EVP_Message_Digests\" rel=\"nofollow noreferrer\">wiki entry EVP Message Digests</a>.</p>\n\n<p>Then you are finally ready to do the verification</p>\n\n<pre><code>verify_result = DSA_do_verify(mdvalue, mdlen, dsasig, dsapubkey);\n</code></pre>\n\n<p>The return code <code>1</code> stands for successful verification, <code>0</code> stands for failed verification, <code>-1</code> is some other error.</p>\n\n<p>It is recommended to use the <a href=\"https://wiki.openssl.org/index.php/EVP_Signing_and_Verifying\" rel=\"nofollow noreferrer\"><code>EVP</code>-level APIs</a> as opposed to the <a href=\"https://www.openssl.org/docs/man1.0.2/crypto/DSA_do_verify.html\" rel=\"nofollow noreferrer\">lower level <code>DSA</code>-APIs</a>, but <code>DSA_do_verify()</code> seemed closer to where you had gotten already and it works as well.</p>\n"}], "owner": {"reputation": 43, "user_id": 2963345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed341666252df123e1b2fdccdac5eac?s=128&d=identicon&r=PG&f=1", "display_name": "user2963345", "link": "https://stackoverflow.com/users/2963345/user2963345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 52753632, "answer_count": 1, "score": 2, "last_activity_date": 1539240386, "creation_date": 1539206868, "question_id": 52749038, "link": "https://stackoverflow.com/questions/52749038/verify-signature-in-openssl-c-which-is-signed-by-java-dsa", "title": "Verify signature in openssl c++, which is signed by JAVA DSA?", "body": "<p>I have a requirement to verify a signature in c++ which is generated by JAVA signature API.\nI have the same set of public and private keys. <strong>I have also verified that the signing and verification works in c++</strong>. But I'm having trouble verifying the signature generated by JAVA.\nI have looked through the documentations and tried different things, but I still can't seem to figure it out. I'm pasting equivalent c++ code with the original JAVA code used for verification.</p>\n\n<p>Original JAVA code:</p>\n\n<pre><code>public static boolean verify(byte[] data, byte[] _signature, byte[] _publicKey) throws GeneralSecurityException {\n        Signature signatureInstance = Signature.getInstance(\"DSA\", \"SUN\");\n        signatureInstance.initVerify(getPublicKey(_publicKey));\n        signatureInstance.update(data);\n        return signatureInstance.verify(_signature);\n    }\n</code></pre>\n\n<p>c++ code:</p>\n\n<pre><code>//sign_buffer contains the binary signature.\n\n    int ret = DSA_verify(NID_dsa, data, sizeof(data), sign_buffer,\n                          sign_length, pubkey);\nif (ret != 1) {\n            cerr &lt;&lt; \"verify failed\" &lt;&lt; endl;\n            exit(-1);\n        }\n</code></pre>\n\n<p>I have 3 questions:</p>\n\n<ul>\n<li>Is this the right way to verify the signature?</li>\n<li>Do I need to hash the data before verifying it? If yes then, how does JAVA does it before signing?</li>\n</ul>\n"}, {"tags": ["c++", "algorithm", "loops", "stl", "cpp-core-guidelines"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539207054, "post_id": 52749020, "comment_id": 92422525, "body": "You can adapt the iterator to increase by more than one when you increment them: <a href=\"https://stackoverflow.com/questions/5685983/skipping-iterator\">stackoverflow.com/questions/5685983/skipping-iterator</a>"}, {"owner": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539207196, "post_id": 52749020, "comment_id": 92422576, "body": "@NathanOliver I thought of that but going boost, or specializing an iterator, IMO, both classify as more verbose than the one liner loop. If this pattern were pervasive, then the adapt/3rd party solution would be more compelling. I&#39;m looking at this case in a vacuum though."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539207235, "post_id": 52749020, "comment_id": 92422597, "body": "No worries.  I just wanted to present the option in case you weren&#39;t aware."}, {"owner": {"reputation": 18087, "user_id": 261217, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6a20a7f940e6ba33cde991a80d5b6a43?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/261217/mikhail"}, "edited": false, "score": 1, "creation_date": 1540230568, "post_id": 52749020, "comment_id": 92779189, "body": "Bit operations, hex conversions... looks like a good case for old-good raw loop pal to me."}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "edited": false, "score": 1, "creation_date": 1539213698, "post_id": 52749362, "comment_id": 92424423, "body": "I feel this is akin to turning left three times just to avoid going right. This still has the vulnerabilities associated with loops, subscripting by a constant predicated upon a size(the chunk view), with an abilty to change one without modifying the other. Somewhat pedantically, its also more text. Lastly, despite range adapters implementing deferred execution, which is great from a minimize-copies/intermediates standpoint, it is hard to believe that this range adapter chain will be close to the perf of the raw loop(based on impression not implementation knowledge)."}, {"owner": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "edited": false, "score": 0, "creation_date": 1539213805, "post_id": 52749362, "comment_id": 92424444, "body": "On the other hand, this answer increases my confidence that the answer to my original question is simply &quot;no, the specific case is too specific to be handled by any stl algorithm, which are optimized for the general case, consuming a sequence consecutively."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "edited": false, "score": 1, "creation_date": 1539215693, "post_id": 52749362, "comment_id": 92424814, "body": "<i>&quot; Somewhat pedantically, its also more text.&quot;</i>. Yes, as I added lot of spacing, but there is less character/symbol than original :-) (and I fully qualified name) (I honestly find range version easier to read). Then I would have wanted a version <code>chunk&lt;2&gt;</code> which would allow check for <code>r[0]</code>/<code>r[1]</code> (with <code>get&lt;0&gt;(r)</code>). For performance, compile time should be worse I think, but for runtime, I expect it to be similar (maybe range makes code more difficult to optimize)."}, {"owner": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "edited": false, "score": 0, "creation_date": 1539242386, "post_id": 52749362, "comment_id": 92432132, "body": "I see your point about symbol count. However, the <code>for</code> loop aligns with a pervasive familiarity; each expression of the three required is well known and conveys a well established evaluation order:  <code>for(scoped init only once; pre loop bool_stop; post_loop actions) </code>. the blessing and the curse of the construct is user control over all three stages independently. I believe that contingency is responsible for the &#39;raw-loop-elimination&#39; paradigm. Solutions that don&#39;t require a user loop, but allow for the same degree of user error, do not align with that sentiment."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "edited": false, "score": 0, "creation_date": 1539248108, "post_id": 52749362, "comment_id": 92435225, "body": "@schulmaster All the sequential algorithms <i>should</i> only advance the iterators. You then write iterator adaptors to do things like this. The ranges proposal just makes it nicer to <i>output</i> a sequence (so it can be the input of the next step)."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 4, "last_activity_date": 1539208812, "creation_date": 1539208812, "answer_id": 52749362, "question_id": 52749020, "link": "https://stackoverflow.com/questions/52749020/c-attempt-to-eliminate-raw-loop-with-equivalent-stl-algorithm/52749362#52749362", "title": "C++: attempt to eliminate raw loop with equivalent STL algorithm", "body": "<p>With <a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">range-v3</a>, it would be</p>\n\n<pre><code>std::vector&lt;std::byte&gt;\nUnifyHexNibbles(const std::string&amp; hexStr)\n{\n    if (hexStr.size() % 2)\n        throw std::invalid_argument(\"size indivisible by 2.\");\n\n\n    return hexStr\n        | ranges::view::chunk(2)\n        | ranges::view::transform([](const auto&amp; r)\n           {\n              return std::byte(CharToHexByte(r[0]) &lt;&lt; 4 | CharToHexByte(r[1]));\n           });\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/f59bb95b93c0a940\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "is_accepted": true, "score": 0, "last_activity_date": 1539326331, "creation_date": 1539326331, "answer_id": 52773676, "question_id": 52749020, "link": "https://stackoverflow.com/questions/52749020/c-attempt-to-eliminate-raw-loop-with-equivalent-stl-algorithm/52773676#52773676", "title": "C++: attempt to eliminate raw loop with equivalent STL algorithm", "body": "<p>There is no <code>&lt;algorithm&gt;</code> that allows for transformation via non-consecutive input consumption, using non-specialized iterators. Aside from specializing an iterator, there are third-party, and (hopefully) soon to be standard alternatives/enhancements to present core STL, such as ranges(<a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">ranges repository</a>). See User <strong>@Jarod42</strong>'s answer for a working example with ranges. </p>\n"}], "owner": {"reputation": 363, "user_id": 7576532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSGdx.jpg?s=128&g=1", "display_name": "schulmaster", "link": "https://stackoverflow.com/users/7576532/schulmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 52773676, "answer_count": 2, "score": 3, "last_activity_date": 1539326331, "creation_date": 1539206748, "last_edit_date": 1539243893, "question_id": 52749020, "link": "https://stackoverflow.com/questions/52749020/c-attempt-to-eliminate-raw-loop-with-equivalent-stl-algorithm", "title": "C++: attempt to eliminate raw loop with equivalent STL algorithm", "body": "<p>I'm trying to modernize some C++ code, adhering to core guidelines and post ++11 advice. The specific guideline I'm addressing here is to use <code>&lt;algorithm&gt;</code> facilities in lieu of raw loops applying static operations across a sequence with the aim of producing a new sequence.</p>\n\n<p>This first example is illustrates success(as I define it in this context). Two input vectors of <code>std::byte</code> come in , and one comes out, representing the pairwise bitwise XORing of each input vector, leaving the input vectors unmodified. The function in the spirit of this question is <code>std::transform.</code></p>\n\n<pre><code>vector&lt;byte&gt; XORSmash(const vector&lt;byte&gt;&amp; first, const vector&lt;byte&gt;&amp; second)\n{\n    if (first.size() != second.size())\n        throw std::invalid_argument(\"XORSMASH: input vectors were not of equal length\\n\");\n\n    vector&lt;byte&gt; convolution; convolution.reserve(first.size());\n\n    transform(first.cbegin(), first.cend(), second.cbegin(), back_inserter(convolution),\n        [](const byte byte1, const byte byte2) {return byte1 ^ byte2;} );\n\n    return convolution;\n}\n</code></pre>\n\n<p>However, there's another function for which I'm having trouble devising a non loop solution that isn't handedly worse than the loop one. This function takes in a <code>string</code> of HexChars(each char of which ultimately conveys 4 bits of value), and generates a <code>vector&lt;byte&gt;</code>, each element of which contains the contents of two HexChars, one in the high 4 bits, one in the low. What the <code>CharToHexByte</code> function does exactly isnt pertinent(I'll include if it becomes necessary), just that it takes a compliant hex character ,and returns an <code>std::byte</code>, with the hex character's numeric value, ie 0-15, loading only 4 bits.\nThe issue is the input string has pairs of hex chars(each a nibble of value), each of which unify into a single hex byte. I cannot use <code>std::transform</code>, to my knowledge, since the input iterators would have to jump by 2 (<code>2 * sizeof(char)//aka container_const_iterator += 2 in this case</code>) each iteration, to extract the next <strong>pair</strong> of chars in the input string. </p>\n\n<p>TLDR: Is there an <em>algorithm</em>ic way to implement the following function w/o the exposed <code>for</code> loop, that isn't handedly more expensive/verbose than the solution below?</p>\n\n<pre><code>vector&lt;byte&gt; UnifyHexNibbles(const string&amp; hexStr)\n{\n    if (hexStr.size() % 2)\n        throw std::invalid_argument(\"UnfyHxNbl: Input String Indivisible by 8bits. Pad if applicable.\\n\");\n\n    vector&lt;byte&gt; hexBytes; hexBytes.reserve(hexStr.size() &gt;&gt; 1);\n    //can I be eliminated elegantly?\n    for (size_t left(0), right(1); right &lt; hexStr.size(); left += 2, right += 2)\n        hexBytes.push_back( CharToHexByte(hexStr[left]) &lt;&lt; 4 | CharToHexByte(hexStr[right]) );\n\n    return hexBytes;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++14", "sfinae", "typetraits", "enable-if"], "comments": [{"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539210303, "post_id": 52749004, "comment_id": 92423539, "body": "@Barry I see your edit but that extra condition was to avoid non-answering suggestions such as <code>template&lt;typename U&gt;class Bar{ using T=Foo&lt;U&gt;; }</code>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539210710, "post_id": 52749004, "comment_id": 92423638, "body": "Why would anyone suggest that? That doesn&#39;t seem helpful to the question."}, {"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539213033, "post_id": 52749004, "comment_id": 92424273, "body": "@Barry With your rep, people wouldn&#39;t second-guess what you actually wanted to ask, but I&#39;ve learned to build distortion-resisting mechanisms into my questions."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539213207, "post_id": 52749004, "comment_id": 92424317, "body": "You&#39;re more than welcome to roll back the edit if you think it counters the intent of the question - but I&#39;d like to understand what kind of &quot;non-answering suggestion&quot; you&#39;re trying to avoid getting."}, {"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539251710, "post_id": 52749004, "comment_id": 92437531, "body": "@Barry It doesn&#39;t counter the intent of the question -- in fact this is exactly how the question was originally drafted."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1539206884, "creation_date": 1539206884, "answer_id": 52749043, "question_id": 52749004, "link": "https://stackoverflow.com/questions/52749004/type-trait-test-if-template-parameter-is-some-instantiation-of-another-template/52749043#52749043", "title": "Type trait test if template parameter is some instantiation of another template", "body": "<p>You can create a traits for that:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct is_foo : std::false_type {};\n\ntemplate &lt;typename T&gt;\nstruct is_foo&lt;Foo&lt;T&gt;&gt; : std::true_type {};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 4, "last_activity_date": 1539207196, "creation_date": 1539207196, "answer_id": 52749092, "question_id": 52749004, "link": "https://stackoverflow.com/questions/52749004/type-trait-test-if-template-parameter-is-some-instantiation-of-another-template/52749092#52749092", "title": "Type trait test if template parameter is some instantiation of another template", "body": "<p>You can write a general trait to match for any specialization:</p>\n\n<pre><code>template &lt;typename T, template &lt;typename...&gt; class Z&gt;\nstruct is_specialization_of : std::false_type { };\n\ntemplate &lt;typename... Args, template &lt;typename....&gt; class Z&gt;\nstruct is_specialization_of&lt;Z&lt;Args...&gt;, Z&gt; : std::true_type { };\n</code></pre>\n\n<p>Which in your specific case would be:</p>\n\n<pre><code>is_specialization_of&lt;T, Foo&gt;::value // &lt;== T is some kind of Foo\n</code></pre>\n"}], "owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 52749092, "answer_count": 2, "score": 0, "last_activity_date": 1539209094, "creation_date": 1539206665, "last_edit_date": 1539209094, "question_id": 52749004, "link": "https://stackoverflow.com/questions/52749004/type-trait-test-if-template-parameter-is-some-instantiation-of-another-template", "title": "Type trait test if template parameter is some instantiation of another template", "body": "<p>Suppose in the following code the intention is to allow <code>T</code> in <code>Bar&lt;T&gt;</code> to be a <code>Foo&lt;U&gt;</code> for any <code>U</code>.</p>\n\n<pre><code>template&lt;typename U&gt;\nclass Foo { };\n\ntemplate&lt;typename T, typename = std::enable_if_t&lt; /*T is Foo&lt;U&gt; for any U*/&gt;&gt;\nclass Bar {\n    // ...\n};\n</code></pre>\n\n<p>Is there something I replace <code>/*T is Foo&lt;U&gt; for any U*/</code> with?</p>\n"}, {"tags": ["c++", "gcc"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1539206667, "post_id": 52748961, "comment_id": 92422397, "body": "clang-tidy has a <b>PERFORMANCE-UNNECESSARY-VALUE-PARAM</b> check that does just that : <a href=\"https://clang.llvm.org/extra/clang-tidy/checks/performance-unnecessary-value-param.html\" rel=\"nofollow noreferrer\">clang.llvm.org/extra/clang-tidy/checks/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539206676, "post_id": 52748961, "comment_id": 92422399, "body": "I don&#39;t know of any warning but you could make the copy constructor private/deleted so they can&#39;t make copies of it to find all the places they do."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539206828, "post_id": 52748961, "comment_id": 92422445, "body": "Also: in modern C++, it&#39;s not that simple, passing a std::string by value is often preferable to passing it by reference if the function will make a copy of it (since that delegates the choice to copy-vs-move to the callsite)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539210108, "post_id": 52748961, "comment_id": 92423484, "body": "@Frank that would generally be true for <i>any</i> class type that supports move semantics, not just strings"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1539216605, "post_id": 52748961, "comment_id": 92425013, "body": "@RemyLebeau yes, of course, I was just using <code>std::string</code> as an example, I should have been clearer on that."}], "owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1539206483, "creation_date": 1539206483, "question_id": 52748961, "link": "https://stackoverflow.com/questions/52748961/generate-compiler-warning-if-parameter-is-passed-by-value", "title": "Generate compiler warning if parameter is passed by value", "body": "<p>I'm optimizing a large and complex C++ application for performance. One mistake programmers repeatedly make is to pass a large object by value when passing it by reference would be enough. Do you know of a tool or a gcc compiler option that warns me whenever a non-primitive parameter type is passed by value to a function?</p>\n\n<p>Regards</p>\n"}, {"tags": ["c++", "visual-studio", "pointers", "vector", "stdvector"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1539206274, "post_id": 52748912, "comment_id": 92422265, "body": "Explain this <code>*(new Obj)</code> to your <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck</a>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539206405, "post_id": 52748912, "comment_id": 92422311, "body": "@NeilButterworth I&#39;ve changed the dupe target as the OP has the needed constructors.  What they are seeing is the vector growing and copying internally."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539206536, "post_id": 52748912, "comment_id": 92422351, "body": "OP: Do note that <code>objects.push_back(*(new Obj));</code> is really never what you want to do.  This is going to cause you a memory leak because you don&#39;t <code>delete</code> all the objects when you are done.  You can just use <code>objects.push_back(Obj{});</code> instead."}], "owner": {"reputation": 123, "user_id": 9861229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d53d779825cfcbcbfc5a2534552bdf14?s=128&d=identicon&r=PG&f=1", "display_name": "Werek", "link": "https://stackoverflow.com/users/9861229/werek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1539206307, "answer_count": 0, "score": 0, "last_activity_date": 1539206363, "creation_date": 1539206198, "question_id": 52748912, "link": "https://stackoverflow.com/questions/52748912/adding-objects-to-a-vector-results-in-a-weird-constructor-copy-deconstructor-com", "closed_reason": "Duplicate", "title": "Adding objects to a vector results in a weird constructor/copy/deconstructor combination", "body": "<p>With following source files:</p>\n\n<p>Obj.h</p>\n\n<pre><code>class Obj\n{\npublic:\n    Obj();\n    Obj(const Obj &amp;other);\n    ~Obj();\n};\n</code></pre>\n\n<p>Obj.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Obj.h\"\n\nusing namespace std;\n\nObj::Obj(){ cout &lt;&lt; \"create \"; }\n\nObj::Obj(const Obj &amp;other){ cout &lt;&lt; \"copy \"; }\n\nObj::~Obj(){ cout &lt;&lt; \"delete \"; }\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;vector&gt;\n#include \"Obj.h\"\n\nusing namespace std;\n\nvector&lt;Obj&gt; objects;\n\nint main(int argc, char** argv)\n{\n    for (int i = 0; i &lt; 4; i++)\n        objects.push_back(*(new Obj));\n    //system(\"pause\");\n}\n</code></pre>\n\n<p>The program outputs:\n    create copy create copy copy delete create copy copy copy delete delete create copy copy copy copy delete delete delete</p>\n\n<p>Why can't it be just 'create, create, create, create'? </p>\n\n<p>I'm out of ideas how to fix that problem and it doesn't help that I've just started learning pointers and the c++ itself. Any help appreciated!</p>\n\n<p>I'm using Visual Studio 2017 with whatever compiler there's by default.</p>\n"}, {"tags": ["c++", "file", "newline", "fstream"], "comments": [{"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 3, "creation_date": 1539206264, "post_id": 52748885, "comment_id": 92422260, "body": "Why do you need to &quot;work around&quot; it? The newline character is an actual character and it takes up one byte like any other character. It&#39;s value is 0x0A in ascii. You might also see carriage returns, which are also a byte, before the newline, depending who wrote the file and what OS you are reading it from. Your code should expect this. What are you expecting and how does it interfere with what you are trying to do?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1539206614, "post_id": 52748885, "comment_id": 92422379, "body": "This may be a question about <i>writing text</i> vs <i>writing binary</i> data, but it&#39;s impossible to know, since no problem has been described here."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1539207419, "post_id": 52748885, "comment_id": 92422663, "body": "Why don&#39;t you look at the bytes that were written to the file? Open the file in a hex viewer and have a look."}, {"owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "edited": false, "score": 0, "creation_date": 1539261057, "post_id": 52748885, "comment_id": 92443239, "body": "What functions are you using to write the file?"}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1539261132, "post_id": 52748885, "comment_id": 92443293, "body": "@rustyx  I have used a hex viewer, it was very interesting but i did not find anything strange; every character was in its position.  However i did discover one thing. When i fstream::get at the &#39;newline&#39; (\\r\\n) position, it increments the result of fstream::tellg only by one. This might be why all other characters are offset when using fstream::tellg. But i hope this hypothesis is wrong."}], "answers": [{"comments": [{"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1539206560, "post_id": 52748915, "comment_id": 92422358, "body": "Opening a file in binary mode does not make bytes disappear. It is also quite a different thing then reading text. Your answer makes it sound like ios::binary magically undoes carriage return line feeds on microsoft operating systems, which is not the case or its use. Better the OP actually understand what carriage return and newline characters are in text mode, and that they take up actual bytes, as well as differences in character encodings and how fstream handles them by default."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 2, "creation_date": 1539206771, "post_id": 52748915, "comment_id": 92422432, "body": "If somebody cares about how a new-line shows up in the file, rather than about being able to write a text file with lines the way text files are expected to be formatted on that platform, then pretty much by definition he&#39;s dealing with a binary file, and opening in binary format is the (only) correct way to deal with it."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1539207037, "post_id": 52748915, "comment_id": 92422521, "body": "Your comment is ambiguous. Who is &quot;somebody&quot; and what do they &quot;care&quot; about, and who decided what is &quot;expected&quot;, and what is this &quot;definition?&quot; It is quite irresponsible to go and tell the OP to use binary mode with no explanation of binary mode vs text mode. I don&#39;t even see anything in the OP&#39;s post about writing at all. I think you must be making a number of bad assumptions about what the OP is trying to do, and you are surely skipping over several paragraphs of explanation of text vs binary modes, what character encoding is, and how fstream encodes things by default."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1539207270, "post_id": 52748915, "comment_id": 92422607, "body": "If I was new to C++,  I&#39;d read your answer to mean, &quot;The ios::binary flag deletes newline characters in my fstream&quot;, which is absolutely incorrect."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 1, "creation_date": 1539207569, "post_id": 52748915, "comment_id": 92422709, "body": "@ChristopherPisz: How could: &quot;when you write a new-line to a (text) file, it gets translated from \\n to \\r\\n. To stop that from happening, you normally want to specify std::ios::binary mode when you open the file.&quot; possibly be read as meaning anything will be deleted from a file? If you don&#39;t see anything in the OPs question about writing at all, you must not have read it at all. How would the &quot;insert&quot; in: &quot;I then insert a &#39;new line&#39; ...&quot; mean anything other than writing?"}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539246264, "post_id": 52748915, "comment_id": 92434118, "body": "i understand that &#39;newline&#39; also use memory  but inserting other characters do not offset every other character +1 why do i see this when inserting &#39;newline&#39;"}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539262049, "post_id": 52748915, "comment_id": 92443911, "body": "@JerryCoffin Thank you for taking your time. I know what binary mode is. What i do not understand is this offsetting of all the fstream::tellg results after \\r\\n has ben used.  I have discovered that when i fstream::get at \\r\\n, witch would be fstream::get at the last position of the row, fstream::tellg only reports that as being one byte position. Another fstream::get then gets the first viewable character of the row."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 1, "creation_date": 1539266447, "post_id": 52748915, "comment_id": 92446872, "body": "@kevinkangaji: Yes, when you read a \\r\\n in the file, it gets converted and read as only a \\n in what you read. fstream::tellg just tells you how many bytes you are from the beginning of the file, which may not be the same as the number of times you read from the file to get to that point."}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539271962, "post_id": 52748915, "comment_id": 92450696, "body": "@JerryCoffin: looking at the illustration you provided; &quot;e&quot; is definitely offset. It is the 6th inserted yet 7th by bit. &quot;a&quot; to &quot;b&quot; is unchanged in the illustration because they appear before this \\n conversion. But i see this for every character from the first character to the last character, no mater where the \\n is inserted."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539272141, "post_id": 52748915, "comment_id": 92450810, "body": "@kevinkangaji: In that case, I think we&#39;re going to need to see code showing what you&#39;re seeing--it doesn&#39;t fit with anything I&#39;ve ever seen nor anything I&#39;d expect to see."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539325232, "post_id": 52748915, "comment_id": 92468669, "body": "@kevinkangaji: You&#39;re using a combination of <code>seekg</code> (which moves the &quot;get&quot; pointer--i.e., the reading position) and <code>tellp</code> (which tells you the &quot;put&quot; pointer--the writing position). You&#39;re looking at two numbers that aren&#39;t related at all."}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539351659, "post_id": 52748915, "comment_id": 92482944, "body": "@JerryCoffin: In my experience, moving &quot;put&quot; also moves &quot;get&quot;. But i digress, it is not appropriate of me to show code that do not represent my question, i apologize. I have edited the code so that it is adequate. The same result can, however, be observed."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539360727, "post_id": 52748915, "comment_id": 92488039, "body": "@kevinkangaji: I&#39;ve edited the answer to include a version of your code, mildly modified to show that the claimed effect doesn&#39;t happen."}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539363778, "post_id": 52748915, "comment_id": 92489496, "body": "@JerryCoffin: I ran the code on 2 different machines and got the same result that i did before. After &quot;A&quot;, tellg returns 2 in the second pass. This seems to have to do with setup. This is not good."}, {"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539367542, "post_id": 52748915, "comment_id": 92491130, "body": "@JerryCoffin: I solved the problem by installing and using Microsoft visual studio to run the code instead of Code::Blocks, which i have been using up until this point."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1539468973, "post_id": 52748915, "comment_id": 92515375, "body": "In text mode <code>tellg</code> doesn&#39;t necessarily represent a file offset (its only requirement is that it can be used to restore that position with <code>seekg</code>)"}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 2, "last_activity_date": 1539360441, "last_edit_date": 1539360441, "creation_date": 1539206214, "answer_id": 52748915, "question_id": 52748885, "link": "https://stackoverflow.com/questions/52748885/why-does-new-line-offset-the-all-the-characters-byte-position-in-a-txt-file/52748915#52748915", "title": "Why does &#39;new line&#39; offset the all the characters byte position in a .txt file +1?", "body": "<p>My guess is you're writing code on a Microsoft OS.</p>\n\n<p>In text files, Microsoft OSes (and associated software) expect the end of a line to be marked with a <code>\\r\\n</code> sequence, so when you write a new-line to a (text) file, it gets translated from <code>\\n</code> to <code>\\r\\n</code>. So, even though you only inserted one character into the stream, that resulted in two characters being written to the external file.</p>\n\n<p>If you're concerned with ensuring that the content of the external file exactly match what you inserted into the stream, that may indicate that you want what the C++ standard library would consider a binary file, which you'd get by specifying <code>std::ios::binary</code> when you open the file.</p>\n\n<p>Now, it is true that when you deal with a text file, <code>tellg</code> doesn't produce a very meaningful number. What we have is something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4YjPV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4YjPV.png\" alt=\"enter image description here\"></a></p>\n\n<p>The upper side is the data as you see it. The lower side is the data as it's stored in the file. When you call tellg, it's telling you the position along the lower side-that is, the position relative to the start of the file. But, depending on how many \\r\\n pairs there are before that in the file, that may result in a different number of characters in the upper row, which is what you'll see when you read the data from the file.</p>\n\n<p>What this means it that the result from tellg can only be used in a few fairly specific ways--mostly, when you get a number from tellg, you can give that number back to seekg, and start reading from the same place.</p>\n\n<p>As far as your code goes, I guess I don't see what I understand your question to be saying. I rewrote the code a bit to show the results together:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nstd::string show(char x) {\n    if (x &gt; 32)\n        return std::string(1, x);\n    else switch (x) {\n    case '\\r': return \"&lt;\\\\r&gt;\";\n    case '\\n': return \"&lt;\\\\n&gt;\";\n    case '\\t': return \"&lt;\\\\t&gt;\";\n    default: return \"&lt;BAD&gt;\";\n    }\n}\n\nvoid display_txt_file(fstream&amp; file)\n{\n    file.seekg(0, ios_base::beg);\n    char x;\n    cout &lt;&lt; \"tellg: \" &lt;&lt; file.tellg() &lt;&lt; \"| \";\n    while (file.get(x))\n    {\n        cout &lt;&lt; \"'\" &lt;&lt; show(x) &lt;&lt; \"' tellg: \" &lt;&lt; file.tellg() &lt;&lt; \"| \";\n    }\n    file.clear();\n    file.seekg(0, ios_base::end);\n    std::cout &lt;&lt; \"\\n\";\n//    cout &lt;&lt; \"\\n&gt; \" &lt;&lt; file.tellg() &lt;&lt; \"\\n\" &lt;&lt; endl;\n}\n\nint main(int argc, char* argv[])\n{\n    ofstream new_file;\n    new_file.open(\"test.txt\");\n    new_file.close();\n\n    fstream file(\"test.txt\", ios::in | ios::out);\n    if (!file.is_open())\n    {\n        cout &lt;&lt; \"error file not opened\" &lt;&lt; endl;\n        return 0;\n    }\n\n    file &lt;&lt; \"ABCD\";\n    display_txt_file(file);\n\n    file.seekp(0);\n\n    file &lt;&lt; \"ABCD\\nE\";\n    display_txt_file(file);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I run this on Windows, I get the following output:</p>\n\n<pre><code>tellg: 0| 'A' tellg: 1| 'B' tellg: 2| 'C' tellg: 3| 'D' tellg: 4|\ntellg: 0| 'A' tellg: 1| 'B' tellg: 2| 'C' tellg: 3| 'D' tellg: 4| '&lt;\\n&gt;' tellg: 6| 'E' tellg: 7|\n</code></pre>\n\n<p>So, everything up to the new-line matches, exactly as we'd expect. Then the new-line gets expanded to two characters, followed by the <code>E</code>. But, after we read the 'A', <code>tellg</code> has returned <code>1</code>, not <code>2</code>, as was claimed in the question.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "edited": false, "score": 0, "creation_date": 1539262145, "post_id": 52749297, "comment_id": 92443950, "body": "Thank you very informative. but still do not understand; if i insert: &quot;abc&quot; , into a .txt file; after reading &quot;a&quot; tellg will give: 1, after &quot;b&quot; 2 and after &quot;c&quot; 3. but if i insert: &quot;abc\\n&quot; or &quot;abc&quot; &lt;&lt; endl; after reading &quot;a&quot; tellg will give 2, after &quot;b&quot; 3 and after &quot;c&quot; 4, lastly 5 after the new line"}], "tags": [], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "is_accepted": false, "score": -1, "last_activity_date": 1539216145, "last_edit_date": 1539216145, "creation_date": 1539208410, "answer_id": 52749297, "question_id": 52748885, "link": "https://stackoverflow.com/questions/52748885/why-does-new-line-offset-the-all-the-characters-byte-position-in-a-txt-file/52749297#52749297", "title": "Why does &#39;new line&#39; offset the all the characters byte position in a .txt file +1?", "body": "<p>It is hard to tell what or why you'd be working around anything without an explanation of your expectations and a full code listing.</p>\n\n<p>However, it is important that you understand character encoding when reading and writing to a file.</p>\n\n<p>The newline character takes up a byte. It's value is 0x0A if we are using the ASCII character set. There are other character encodings aside from ASCII. There is also UTF-8 or UTF-16 encodings, for example. Every character encoding might have a different byte, or multibyte, representation for a readable text character, as well as the unreadable text characters, such as the newline.</p>\n\n<p>On Windows, there is a convention to use carriage return followed by line feed, instead of just a line feed. Those two byes would look like 0x0D, 0x0A, in ASCII. On *nix systems there is no such convention.</p>\n\n<p>Therefore, when you are counting bytes in your fstream, you will need to account for the newline character taking up a byte, or two bytes if you are expecting '\\r\\n', That is , if you are using ASCII encoding.</p>\n\n<p>As far as I know, fstream assumes it's content is ASCII. This might have changed with C++17. I think there were plans to support various character encodings in streams. Those on the cutting edge might be able to comment.</p>\n\n<p>Your operating system has a default character encoding set somewhere in its configuration. I know older Windows machines used Windows-1252. I am not sure what Windows 10 uses. I think most *nix systems use UTF-8. At any rate, you will want to consult your operating system's configuration.</p>\n\n<p>C++ streams are going to want to transform from one to the other when you read and write to file. The transformation of text to it's byte representation are a big part of what streams are trying to do for you.</p>\n\n<p>If you don't want the byte representation that the stream is going to provide, then you can feel free to write bytes yourself, however you wish, in binary mode. However, be mindful of how that effects other readers of the file and what encoding they are expecting.</p>\n\n<p>So, keep in mind who created the file, what it looks like as text, what it's binary representation is, in file, and in memory, and code for it appropriately.</p>\n\n<p>Lucky for us, some encodings also contain the entire ASCII character set, and simply expand on it. UTF-8 is one such encoding that does this. </p>\n\n<p>You can refer to <a href=\"https://stackoverflow.com/questions/3821784/whats-the-difference-between-n-and-r-n\">What&#39;s the difference between \\n and \\r\\n?</a> for a discussion on that topic.</p>\n\n<p>You can also refer to <a href=\"https://stackoverflow.com/questions/229924/difference-between-files-written-in-binary-and-text-mode\">Difference between files written in binary and text mode</a></p>\n\n<p>\"Standard C++ IOStreams and Locales: Advanced Programmer's Guide and Reference\nBook by Angelika Langer and Klaus Kreft\" is a good book if you want to really get to know your streams inside and out.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1539469040, "post_id": 52797636, "comment_id": 92515392, "body": "This proably means you have a bug in your program that happens to work as you expect for now in MSVC"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1539508935, "post_id": 52797636, "comment_id": 92521293, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, a small application demonstrating the difference."}], "tags": [], "owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "is_accepted": true, "score": 0, "last_activity_date": 1539467138, "last_edit_date": 1592644375, "creation_date": 1539467138, "answer_id": 52797636, "question_id": 52748885, "link": "https://stackoverflow.com/questions/52748885/why-does-new-line-offset-the-all-the-characters-byte-position-in-a-txt-file/52797636#52797636", "title": "Why does &#39;new line&#39; offset the all the characters byte position in a .txt file +1?", "body": "<h2>Update</h2>\n<ul>\n<li><strong>Conclusion:</strong> There was a <strong>problem with my IDE</strong> setup! I have been using <strong>Code::Blocks</strong>. I tried building the program in <strong>Microsoft Visual\nStudio IDE</strong> and it ran with <strong>no trace of the problem</strong>. This does\nnot mean that Code::Blocks is broken. It might have been an issue in\nmy Code::Blocks settings. I have no recollection of changing\nanything. Even if that was the case; I, in my humble opinion, do not\nthink it is right that you can change this sort of thing by accident.\nI am disappointed in Code::Blocks.</li>\n<li><em>my</em> <strong>Solution: Change IDE</strong></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 10462100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VeeaW77q9MM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXZVaS_6Umu-eKFJn7cNIWwHGAS9g/mo/photo.jpg?sz=128", "display_name": "kevin kangaji", "link": "https://stackoverflow.com/users/10462100/kevin-kangaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 52797636, "answer_count": 3, "score": 1, "last_activity_date": 1539467138, "creation_date": 1539206073, "last_edit_date": 1539466691, "question_id": 52748885, "link": "https://stackoverflow.com/questions/52748885/why-does-new-line-offset-the-all-the-characters-byte-position-in-a-txt-file", "title": "Why does &#39;new line&#39; offset the all the characters byte position in a .txt file +1?", "body": "<p>When I use <code>fstream::tellg</code>, after reading in the first character with <code>fstream::get (char)</code> the result is: 1</p>\n\n<p>I then insert a 'new line' after the first character </p>\n\n<p>I <code>fstream::seekg</code> to the beginning: 0</p>\n\n<p>When I use <code>fstream::tellg</code>, after reading in the first character this time \nthe result is: 2  </p>\n\n<p>If I insert: <code>\"abc\"</code>, into a .txt file:</p>\n\n<ul>\n<li>after reading \"a\" <code>tellg</code> will give: 1</li>\n<li>after \"b\" 2 </li>\n<li>and after \"c\" 3.</li>\n</ul>\n\n<p>But if I insert: <code>\"abc\\n\"</code> or <code>\"abc\" &lt;&lt; endl;</code>:</p>\n\n<ul>\n<li>after reading \"a\" <code>tellg</code> will give 2</li>\n<li>after \"b\" 3</li>\n<li>after \"c\" 4</li>\n<li>lastly 5 after the new line. </li>\n</ul>\n\n<p>What is the reason for this? </p>\n\n<p>I understand that 'newline' is characters too. What I do not understand is the offsetting of the <code>tellg</code> result after reading a character. With each use of  'newline' this offset is incremented by one.</p>\n\n<h2>Update</h2>\n\n<ul>\n<li><strong>Conclusion:</strong>\nThere was a problem with my IDE setup! <strong>I have been using Code::Blocks</strong>. I tried <strong>building the program in Microsoft Visual Studio IDE</strong> and <strong>it ran with no trace of the problem</strong>. This does not mean that Code::Blocks is broken. It might have been an issue in my Code::Blocks settings. I have no recollection of changing anything. Even if that was the case; I, in my humble opinion, do not think it is right that you can change this sort of thing by accident. I am disappointed in Code::Blocks.                       </li>\n<li><strong>mySolution:</strong> Change IDE</li>\n</ul>\n"}, {"tags": ["c++", "gcc", "compiler-flags", "dialect"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539205859, "post_id": 52748816, "comment_id": 92422120, "body": "It seems to me It&#39;s just future-proofing so that if a feature is deemed incomplete and in need of an update in future versions of the standard, a distinction can be made between pre and post update."}], "answers": [{"tags": [], "owner": {"reputation": 4580, "user_id": 218774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejff2.png?s=128&g=1", "display_name": "J. Calleja", "link": "https://stackoverflow.com/users/218774/j-calleja"}, "is_accepted": true, "score": 3, "last_activity_date": 1539206468, "creation_date": 1539206468, "answer_id": 52748958, "question_id": 52748816, "link": "https://stackoverflow.com/questions/52748816/how-to-use-c-feature-test-macros/52748958#52748958", "title": "How to use C++ &quot;feature test macros&quot;?", "body": "<p>Based on <a href=\"https://en.cppreference.com/w/cpp/feature_test\" rel=\"nofollow noreferrer\">cppreference.com</a>, it says:</p>\n\n<blockquote>\n  <p>The following macros expand to a numeric value corresponding to the\n  year and month when the feature has been included in the working\n  draft.</p>\n  \n  <p>When a feature changes significantly, the macro will be updated\n  accordingly.</p>\n</blockquote>\n\n<p>So, you can check if the feature exists checking if the macro is defined. Or you can check for the feature version based on the macro value.</p>\n"}], "owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1132, "favorite_count": 0, "accepted_answer_id": 52748958, "answer_count": 1, "score": 3, "last_activity_date": 1539206468, "creation_date": 1539205692, "question_id": 52748816, "link": "https://stackoverflow.com/questions/52748816/how-to-use-c-feature-test-macros", "title": "How to use C++ &quot;feature test macros&quot;?", "body": "<p>To test for a feature, cppreference mentions these feature test macros:\n<a href=\"https://en.cppreference.com/w/User:D41D8CD98F/feature_testing_macros\" rel=\"nofollow noreferrer\">link</a>.</p>\n\n<p>If the feature is present in the compiler, the macro is defined. But I don't understand why, if defined, they are defined to something like <code>201606</code>, which I believe is <strong>a version of C++, not of the compiler</strong>.</p>\n\n<p>For example, I am using a very recent version of GCC with <code>-std=c++17</code> for the feature <code>__cpp_lib_hardware_interference_size</code>. The macro is undefined, which I take to mean GCC doesn't have the feature, despite trying 8.2.1 with the c++17 (and c++2a) switch. In this case, what is the significance of the documented value:</p>\n\n<p><code>__cpp_lib_hardware_interference_size   201703</code></p>\n\n<p>(inside the cppreference link)?</p>\n"}, {"tags": ["c++", "oop", "pointers", "inheritance", "relationship"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10486370, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-04_ug_YOtos/AAAAAAAAAAI/AAAAAAAAAH8/UsL20l4PpHI/photo.jpg?sz=128", "display_name": "Mr.Robot Makeup", "link": "https://stackoverflow.com/users/10486370/mr-robot-makeup"}, "edited": false, "score": 0, "creation_date": 1539205232, "post_id": 52748681, "comment_id": 92421891, "body": "Can you suggest a detailed code which should sufficient my request?"}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1539205088, "creation_date": 1539205088, "answer_id": 52748681, "question_id": 52748572, "link": "https://stackoverflow.com/questions/52748572/relationship-between-pointer-and-inheritance-c-oop/52748681#52748681", "title": "Relationship between pointer and inheritance c++ oop", "body": "<p>The two really have very little to do with each other, the one point of intersection is that in order to take advantage of polymorphic behavior (virtual members) you have to use either pointers or references. If you assign a derived instance to an actual base instance (as opposed to assigning the address of the derived to a base pointer or initializing a base reference with a derived instance) then any derived functionality will simply be lost (the usual term calls that object slicing).</p>\n\n<p>And note in your example there isn't much point to a virtual void make_sound(char const *), much more common would be to use the virtual void make_sound() form and the derived type knows what kind of sound to produce.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10486370, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-04_ug_YOtos/AAAAAAAAAAI/AAAAAAAAAH8/UsL20l4PpHI/photo.jpg?sz=128", "display_name": "Mr.Robot Makeup", "link": "https://stackoverflow.com/users/10486370/mr-robot-makeup"}, "edited": false, "score": 0, "creation_date": 1539206225, "post_id": 52748772, "comment_id": 92422246, "body": "Can someone please share a proper solution with complete code?"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 19, "user_id": 10486370, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-04_ug_YOtos/AAAAAAAAAAI/AAAAAAAAAH8/UsL20l4PpHI/photo.jpg?sz=128", "display_name": "Mr.Robot Makeup", "link": "https://stackoverflow.com/users/10486370/mr-robot-makeup"}, "edited": false, "score": 0, "creation_date": 1539207366, "post_id": 52748772, "comment_id": 92422646, "body": "Solution of what problem? You posted ill-formed program and I listed 3 ways to fix it."}, {"owner": {"reputation": 19, "user_id": 10486370, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-04_ug_YOtos/AAAAAAAAAAI/AAAAAAAAAH8/UsL20l4PpHI/photo.jpg?sz=128", "display_name": "Mr.Robot Makeup", "link": "https://stackoverflow.com/users/10486370/mr-robot-makeup"}, "edited": false, "score": 0, "creation_date": 1539207950, "post_id": 52748772, "comment_id": 92422821, "body": "can you tell me if is it good?      virtual void MakeSound()  };  int main() {      Animal* a = new Dog();      Dog* d = new Dog();     a-&gt;MakeSound(&quot;bark&quot;);      d-&gt;MakeNoise(&quot;bark&quot;); // Does not compile     return 0;  }"}, {"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1539216021, "post_id": 52748772, "comment_id": 92424885, "body": "if you really want, you can call <code>d-&gt;Animal::MakeSound(&quot;bark&quot;)</code>, but I don&#39;t think it&#39;s recommended practice"}], "tags": [], "owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "is_accepted": false, "score": 1, "last_activity_date": 1539205476, "creation_date": 1539205476, "answer_id": 52748772, "question_id": 52748572, "link": "https://stackoverflow.com/questions/52748572/relationship-between-pointer-and-inheritance-c-oop/52748772#52748772", "title": "Relationship between pointer and inheritance c++ oop", "body": "<p>You hide base class <code>MakeSound</code> with override of other <code>MakeSound</code> so it does not participate in overload resolution. Either override both or neither in <code>Dog</code> or rename one of those as <code>MakeNoise</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 10486370, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-04_ug_YOtos/AAAAAAAAAAI/AAAAAAAAAH8/UsL20l4PpHI/photo.jpg?sz=128", "display_name": "Mr.Robot Makeup", "link": "https://stackoverflow.com/users/10486370/mr-robot-makeup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539205476, "creation_date": 1539204518, "last_edit_date": 1539205055, "question_id": 52748572, "link": "https://stackoverflow.com/questions/52748572/relationship-between-pointer-and-inheritance-c-oop", "title": "Relationship between pointer and inheritance c++ oop", "body": "<p>Can any one please express a short code of c++ which should show the relationship between pointer and inheritance.</p>\n\n<p>I believe the below code refers to my problem</p>\n\n<pre><code>class Animal { \n  public:   \n    virtual void MakeSound(const char* pNoise) { ... }   \n    virtual void MakeSound() { ... } \n};\n\nclass Dog : public Animal { \n  public:   \n    virtual void MakeSound() {... }\n};\n\nint main() {   \n  Animal* a = new Dog();   \n  Dog* d = new Dog();  \n  a-&gt;MakeSound(\"bark\");   \n  d-&gt;MakeSound(\"bark\"); // Does not compile  \n  return 0; \n}\n</code></pre>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1539204648, "post_id": 52748533, "comment_id": 92421633, "body": "Prefer to pass non-POD types by reference, or const reference if they won&#39;t be modified.  This prevents the compiler from making a copy of the <code>std::string</code> and passing to your function."}, {"owner": {"reputation": 634, "user_id": 6162065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V5BKK.jpg?s=128&g=1", "display_name": "Cabrra", "link": "https://stackoverflow.com/users/6162065/cabrra"}, "edited": false, "score": 0, "creation_date": 1539205984, "post_id": 52748533, "comment_id": 92422163, "body": "The error you are getting is that the vector is out of range. You should review your code, then read more about why is this happening and finally ask questions here showing your work. Use the following as a hint: what happens when you don&#39;t initialize the vector?"}, {"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539206036, "post_id": 52748533, "comment_id": 92422183, "body": "Thanks for the tip Thomas, I used to use it on C I can&#39;t forget to use it on C++."}, {"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "reply_to_user": {"reputation": 634, "user_id": 6162065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V5BKK.jpg?s=128&g=1", "display_name": "Cabrra", "link": "https://stackoverflow.com/users/6162065/cabrra"}, "edited": false, "score": 0, "creation_date": 1539206879, "post_id": 52748533, "comment_id": 92422468, "body": "@Cabrra Thanks. I am used to C where I need to do everything so having all of this amazing functions all at my disposal is awesome. And there is so much more different ways to do the same thing in C++ that I lose myself trying to find what I want"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1539219883, "post_id": 52748533, "comment_id": 92425693, "body": "Your out of range is probably caused by 2 push_backs outside of the loop as <code>i</code> will be last index + 1 after the loop"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539205451, "post_id": 52748574, "comment_id": 92421970, "body": "Thank you for your help !  Now it works, but I wanted to do an array (v_campo) where I will put all the camps, and then for each camp I wanted to do an array of values. Is that possible ? I can&#39;t seem to find the answer"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539206820, "post_id": 52748574, "comment_id": 92422442, "body": "you are using vector instead of array, vector is much better. Why do you want to change to array?"}, {"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539207030, "post_id": 52748574, "comment_id": 92422519, "body": "Sorry, I wanted to say vector(i am used to say array bad habit) but it\u2019s possible what I ask pm100 ?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539209674, "post_id": 52748574, "comment_id": 92423384, "body": "you should have a map of campo to list value (std::map&lt;string,list&lt;string&gt;&gt;)"}, {"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539210745, "post_id": 52748574, "comment_id": 92423657, "body": "Thanks a lot for your help !"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1539204532, "creation_date": 1539204532, "answer_id": 52748574, "question_id": 52748533, "link": "https://stackoverflow.com/questions/52748533/having-problems-putting-strings-in-a-vector-of-strings/52748574#52748574", "title": "Having problems putting strings in a vector of strings?", "body": "<p>surprised this even compiles</p>\n\n<p>you mean</p>\n\n<pre><code> v_campo.push_back(_campo);\n v_valor.push_back(_valor);\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>this is wrong too</p>\n\n<pre><code>(v_campo[i].c_str() == _campo)\n</code></pre>\n\n<p>you mean</p>\n\n<pre><code>(v_campo[i] == _campo)\n</code></pre>\n\n<p>Make sure you do not ignore compiler warnings, they are there to help you </p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539205070, "post_id": 52748580, "comment_id": 92421819, "body": "So in order for me to search if there is already a _camp in vector, should I use an iterator ?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539208377, "post_id": 52748580, "comment_id": 92422956, "body": "Yes, because <code>std::find</code> returns an iterator. :-)"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539208484, "post_id": 52748580, "comment_id": 92422990, "body": "If you want to loop through the vector, you don&#39;t need an iterator; an index will work.  For example:  <code>for (size_t i = 0; i &lt; v_campo.size(); ++i) { if (v_campo[i] == &quot;Mario&quot;) break; }</code>."}, {"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539208610, "post_id": 52748580, "comment_id": 92423035, "body": "Thanks Thomas, will try it out !"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1539219211, "post_id": 52748580, "comment_id": 92425571, "body": "What do you mean by <code>std::string</code> not having <code>push_back</code> method? <a href=\"https://ideone.com/Rt9mNe\" rel=\"nofollow noreferrer\">ideone.com/Rt9mNe</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1539219309, "post_id": 52748580, "comment_id": 92425593, "body": "@KillzoneKid:  There isn&#39;t a method for <code>push_back(char *)</code>."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1539219477, "post_id": 52748580, "comment_id": 92425614, "body": "There isn\u2019t, but why is it relevant? They are pushing dereferenced pointer which is a <code>char</code>"}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1539204575, "creation_date": 1539204575, "answer_id": 52748580, "question_id": 52748533, "link": "https://stackoverflow.com/questions/52748533/having-problems-putting-strings-in-a-vector-of-strings/52748580#52748580", "title": "Having problems putting strings in a vector of strings?", "body": "<p>Since <code>_valor</code> is a <code>std::string</code> type, there is no need to create a <code>std::string</code> from the <code>c_str()</code> method.  </p>\n\n<p>Try this:</p>\n\n<pre><code>v_campo.push_back(_campo);\nv_valor.push_back(_valor);\n</code></pre>\n\n<p>Another issue is that <code>v_campo[i]</code> is a <code>std::string</code> type and <code>std::string</code> doesn't have a <code>push_back</code> method for strings.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539208558, "post_id": 52749209, "comment_id": 92423016, "body": "Thank you Pavlo, I ll take a look at all this points. I was searching a bit and I think I ll use a map to solve my problem. Thanks once again !"}, {"owner": {"reputation": 38, "user_id": 10248878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99ce7807bb8730759b0953817b1d6b0?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo Hrybok", "link": "https://stackoverflow.com/users/10248878/pavlo-hrybok"}, "reply_to_user": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539209784, "post_id": 52749209, "comment_id": 92423404, "body": "@diogofalkendiogofalken Sure thing, you could also look at the ways of adding items to map. std::map::insert vs mapname[keyname]"}, {"owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "edited": false, "score": 0, "creation_date": 1539210841, "post_id": 52749209, "comment_id": 92423685, "body": "I will thanks for your help, that will save my project that I have to do until Friday !"}], "tags": [], "owner": {"reputation": 38, "user_id": 10248878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99ce7807bb8730759b0953817b1d6b0?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo Hrybok", "link": "https://stackoverflow.com/users/10248878/pavlo-hrybok"}, "is_accepted": false, "score": 0, "last_activity_date": 1539208156, "last_edit_date": 1539208156, "creation_date": 1539207849, "answer_id": 52749209, "question_id": 52748533, "link": "https://stackoverflow.com/questions/52748533/having-problems-putting-strings-in-a-vector-of-strings/52749209#52749209", "title": "Having problems putting strings in a vector of strings?", "body": "<p>So, based on your approach to the problem and further questions I guess you need to create some sort of database for camps and their features of some sort which you want to link with respective camps.<br>\nYou could start with the following approach:</p>\n\n<ul>\n<li><p>Look for more optimized data structure to hold your data, since you want to get something like this { \"Camp1\" : feature_array1, \"Camp2\" : feature_array2 } (Few hints: key-value pairs and very quick inserting and finding items)</p></li>\n<li><p>Try to call constructors on non-POD types, it can prevent some bugs or could help you compile the program.  </p></li>\n<li><p>Look into const reference arguments, it could be helpful.  </p></li>\n<li><p><code>std::string</code> isn't equal to C-style char* strings, since it doesn't have \\0 in the end, so your equality test is useless.  </p></li>\n<li><p>Check out pros and cons of <code>using namespace std</code></p></li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 9165822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNnBojYQnXo/AAAAAAAAAAI/AAAAAAAAAF4/Jdv9h0CInag/photo.jpg?sz=128", "display_name": "diogofalken", "link": "https://stackoverflow.com/users/9165822/diogofalken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1539208156, "creation_date": 1539204348, "question_id": 52748533, "link": "https://stackoverflow.com/questions/52748533/having-problems-putting-strings-in-a-vector-of-strings", "title": "Having problems putting strings in a vector of strings?", "body": "<p>Good night, \nI have two strings as parameters(campo e valor) and I want to put them in two separate vector, but is giving me strange errors and I cannot find why, I am new to C++ so it's probably a newbie mistake.</p>\n\n<p>My class:</p>\n\n<pre><code>/* Includes */\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nclass Geral {\nprivate:\nvector&lt;string&gt; v_campo;\nvector&lt;string&gt; v_valor;\npublic:\n Geral();\n ~Geral();\n void TomaCampoValor(string campo, string valor);\n void Mostrar();\n string GetValorCampo(string campo);\n bool ExisteCampo(string campo);\n};   \n</code></pre>\n\n<p>This is my cpp:</p>\n\n<pre><code> void Geral::TomaCampoValor(string _campo, string _valor) {\n    int i = 0;\n\n    // Searching if there is already the same _campo\n    for (i = 0; i &lt; v_campo.size(); i++) {\n        if (v_campo[i].c_str() == _campo) {\n            v_valor[i].push_back(*_valor.c_str());`\n            return;\n        }\n    }\n\n     // If doesn't find it\n     v_campo[i].push_back(*_campo.c_str());\n     v_valor[i].push_back(*_valor.c_str());\n    }\n</code></pre>\n\n<p>This is the error that is giving me\n<a href=\"https://i.stack.imgur.com/o6or4.png\" rel=\"nofollow noreferrer\">Error that is giving me:</a></p>\n\n<p>Thanks in advance, if I didn't make my self clear pleasy ask.</p>\n"}, {"tags": ["c++", "shared-ptr"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539204424, "post_id": 52748521, "comment_id": 92421546, "body": "&quot;(and its weak_ptr brother)&quot; forget about <code>weak_ptr</code>. There are <code>std::unique_ptr&lt;&gt;</code> and <code>shared_ptr&lt;&gt;</code>."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539204449, "post_id": 52748521, "comment_id": 92421560, "body": "&quot;But then, one of our guys said it was too heavy and expensive. So now we just have raw pointers hanging out,&quot; *roflmao x 2*"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1539204869, "post_id": 52748521, "comment_id": 92421737, "body": "&quot;But then, one of our guys said it was too heavy and expensive.&quot; Compared to what. A crashing program is even more expensive. Make it work using std::shared_ptr profile and only after profiling decide it is to heavy and optimize. A working program is worth a lot more and easier to reason about than a broken one that does not work."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539204965, "post_id": 52748521, "comment_id": 92421775, "body": "i have huge amount of size and speed critical code that uses shared_ptr, tell your guy that he is incorrect . unique_ptr has not overhead at all, shard _ptr has a wee bit"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539205149, "post_id": 52748521, "comment_id": 92421856, "body": "notice that all your code does is create a wraper around a pointer (just like shared_ptr does), but without its correctness, documentation and features"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1539205187, "post_id": 52748521, "comment_id": 92421874, "body": "I doubt what you have written is faster than a shared pointer. All your pointers are going through a central repository (requiring a lock). This all threads when using any pointer must compete for the lock."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539206377, "post_id": 52748521, "comment_id": 92422305, "body": "Step 1: Make it work. Step 2: See if it meets the performance requirements. If yes, done. Else proceed. Step 3 profile it to determine locations of slowdowns. Step 4: modify code to reduce or eliminate largest reducible slowdown. Step 5: Goto step 1."}, {"owner": {"reputation": 31, "user_id": 2245990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a119a02edb6e6dba74330318b51987?s=128&d=identicon&r=PG", "display_name": "ntourte", "link": "https://stackoverflow.com/users/2245990/ntourte"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539207738, "post_id": 52748521, "comment_id": 92422760, "body": "@Swordfish <code>unique_ptr</code> is <code>shared_ptr</code>s best friend, I would say. Those are cool too. @Martin York fair enough about the speed, I was more worried about the memory overhead (although I do have a set of every pointer in the system)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2245990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a119a02edb6e6dba74330318b51987?s=128&d=identicon&r=PG", "display_name": "ntourte", "link": "https://stackoverflow.com/users/2245990/ntourte"}, "edited": false, "score": 0, "creation_date": 1539207286, "post_id": 52748930, "comment_id": 92422613, "body": "&quot;just looking at the pointer value invokes undefined behavior&quot;, I don&#39;t really see in your references where it says that. I suppose I could cast it to <code>(intptr_t)</code> though... it&#39;s just an optimization to see if it&#39;s unset before calling the second condition."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 31, "user_id": 2245990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a119a02edb6e6dba74330318b51987?s=128&d=identicon&r=PG", "display_name": "ntourte", "link": "https://stackoverflow.com/users/2245990/ntourte"}, "edited": false, "score": 0, "creation_date": 1539207320, "post_id": 52748930, "comment_id": 92422627, "body": "@ntourte &quot;<i>The effect of using an invalid pointer value [...] is undefined</i>&quot;"}, {"owner": {"reputation": 31, "user_id": 2245990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a119a02edb6e6dba74330318b51987?s=128&d=identicon&r=PG", "display_name": "ntourte", "link": "https://stackoverflow.com/users/2245990/ntourte"}, "edited": false, "score": 0, "creation_date": 1539207424, "post_id": 52748930, "comment_id": 92422667, "body": "is checking it using it? Obviously <code>_ptr-&gt;doThing()</code> will crash, but <code>if(_ptr != nullptr)</code> shouldn&#39;t, I would hope"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 31, "user_id": 2245990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a119a02edb6e6dba74330318b51987?s=128&d=identicon&r=PG", "display_name": "ntourte", "link": "https://stackoverflow.com/users/2245990/ntourte"}, "edited": false, "score": 0, "creation_date": 1539207581, "post_id": 52748930, "comment_id": 92422713, "body": "@ntourte It says &quot;using&quot;, not &quot;dereferencing&quot;. The situation is the same in C, by the way: <code>free(ptr)</code> makes the value of <code>ptr</code> indeterminate, and using an indeterminate value in an expression can cause undefined behavior."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 0, "last_activity_date": 1539206336, "creation_date": 1539206336, "answer_id": 52748930, "question_id": 52748521, "link": "https://stackoverflow.com/questions/52748521/best-practices-for-pointer-validation/52748930#52748930", "title": "Best practices for pointer validation?", "body": "<p>Apart from everything else, your code has undefined behavior here:</p>\n\n<pre><code>delete test;\ntestHolder-&gt;doSomething();\n// ends up here:\n        if (_ptr &amp;&amp; GoodPtr&lt;T&gt;::isGoodPtr(_ptr)) {\n//          ^^^^\n</code></pre>\n\n<p>The problem is that <code>_ptr</code> is a copy of <code>test</code>, and deleting <code>test</code> invalidates the pointer value.</p>\n\n<p>In C++98 <code>[expr.delete]</code> says:</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>The <em>cast-expression</em> in a <em>delete-expression</em> shall be evaluated exactly once. If the <em>delete-expression</em> calls the implementation deallocation function (3.7.3.2), and if the operand of the delete expression is not the null pointer constant, the deallocation function will deallocate the storage referenced by the pointer <strong>thus rendering the pointer invalid</strong>. [<em>Note:</em> the value of a pointer that refers to deallocated storage is indeterminate. ]</li>\n  </ol>\n</blockquote>\n\n<p>Or in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf\" rel=\"nofollow noreferrer\">this C++11 draft</a>, <code>[basic.stc.dynamic.deallocation]</code>:</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>If the argument given to a deallocation function in the standard library is a pointer that is not the null pointer value (4.10), the deallocation function shall deallocate the storage referenced by the pointer, <strong>rendering invalid all pointers referring to any part of the <em>deallocated storage</em></strong>. The effect of using an invalid pointer value (including passing it to a deallocation function) is undefined.</li>\n  </ol>\n</blockquote>\n\n<p>(All emphasis mine.)</p>\n\n<p>After <code>delete test</code>, just looking at the pointer value invokes undefined behavior.</p>\n"}], "owner": {"reputation": 31, "user_id": 2245990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a119a02edb6e6dba74330318b51987?s=128&d=identicon&r=PG", "display_name": "ntourte", "link": "https://stackoverflow.com/users/2245990/ntourte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539206336, "creation_date": 1539204307, "question_id": 52748521, "link": "https://stackoverflow.com/questions/52748521/best-practices-for-pointer-validation", "title": "Best practices for pointer validation?", "body": "<p>So, when I discovered the <code>shared_ptr</code> class (and its <code>weak_ptr</code> brother), I loved it. But then, one of our guys said it was too heavy and expensive. So now we just have raw pointers hanging out, and a fairly heavy multithreaded pipeline. Because bugs, we have a number of crashes that can't be null-guarded, because the pointers aren't actually null (but they are garbage). I've thought of the following constructs:</p>\n\n<pre><code>template&lt;class T&gt;\nclass GoodPtr {\npublic:\n    GoodPtr() {\n        std::lock_guard&lt;std::mutex&gt; lock(mux);\n        goodPtrs.emplace((T*)this);\n    }\n\n    virtual ~GoodPtr() {\n        std::lock_guard&lt;std::mutex&gt; lock(mux);\n        goodPtrs.erase((T*)this);\n    }\n\n    static bool isGoodPtr(T* ptr) {\n        // would love to use shared_mutex, but apparently it's not in c++11, so...\n        std::lock_guard&lt;std::mutex&gt; lock(mux);\n        return goodPtrs.find((T*)ptr) != goodPtrs.end();\n    }\n\nprivate:\n    static std::unordered_set&lt;T*&gt; goodPtrs;\n    static std::mutex mux;\n};\n\ntemplate&lt;class T&gt; std::unordered_set&lt;T*&gt; GoodPtr&lt;T&gt;::goodPtrs;\ntemplate&lt;class T&gt; std::mutex GoodPtr&lt;T&gt;::mux;\n\ntemplate &lt;class T&gt;\nclass GoodPtrHolder {\npublic:\n    GoodPtrHolder(){}\n    GoodPtrHolder(T* ptr) : _ptr(ptr) {}\n    void setPtr(T* ptr) {\n        _ptr = ptr;\n    }\n\n    T* operator-&gt;() {\n        if (_ptr &amp;&amp; GoodPtr&lt;T&gt;::isGoodPtr(_ptr)) {\n            return _ptr;\n        } else {\n            static T dummy;\n            return &amp;dummy;\n        }\n    }\n\nprivate:\n    T* _ptr = nullptr;\n};\n</code></pre>\n\n<p>Given the following example:</p>\n\n<pre><code>class testo : public GoodPtr&lt;testo&gt; {\npublic:\n    testo() {}\n    virtual ~testo(){}\n    void doSomething() {\n        printf(\"sup %d\\n\", x);\n    }\n    void setX(int val) { x = val; }\n\nprivate:\n    int x;\n};\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>auto *test = new testo;\nGoodPtrHolder&lt;testo&gt; testHolder(test);\ntestHolder-&gt;setX(5);\ntestHolder-&gt;doSomething();\ndelete test;\ntestHolder-&gt;doSomething();\n</code></pre>\n\n<p>Is this better or worse than <code>shared_ptr</code>, considering I have to keep a static table of pointers? Is there a better approach to the problem?</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1539204313, "creation_date": 1539204313, "answer_id": 52748524, "question_id": 52748420, "link": "https://stackoverflow.com/questions/52748420/i-fail-to-use-c-pointer-to-point-to-the-stdvector-that-is-returned-by-a-clas/52748524#52748524", "title": "I fail to use C++ pointer to point to the std::vector that is returned by a class method", "body": "<p>The issue is that <code>AClass::GetVector()</code> returns a copy of the vector <code>vec1</code>, not the actual vector <code>vec1</code> declared in your <code>AClass</code> class.</p>\n\n<p>So this line:</p>\n\n<p><code>std::vector&lt;double&gt;* ptr3 = &amp;(obj.GetVector());</code></p>\n\n<p>assigns the address of a temporary copy, which leads to undefined behavior if you use <code>ptr3</code> after that line, since the copy is now gone.</p>\n\n<hr>\n\n<p>One solution is to return a reference to the vector, and not a copy:</p>\n\n<pre><code>std::vector&lt;double&gt;&amp; GetVector() {\n    return vec1;\n  }\n</code></pre>\n\n<p>The gist of this is that if you want to work with the original vector, return a reference to that vector, not a copy.</p>\n"}, {"tags": [], "owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "is_accepted": false, "score": 1, "last_activity_date": 1539204437, "creation_date": 1539204437, "answer_id": 52748558, "question_id": 52748420, "link": "https://stackoverflow.com/questions/52748420/i-fail-to-use-c-pointer-to-point-to-the-stdvector-that-is-returned-by-a-clas/52748558#52748558", "title": "I fail to use C++ pointer to point to the std::vector that is returned by a class method", "body": "<pre><code>std::vector&lt;double&gt; GetVector() {\n  return vec1;\n}\n</code></pre>\n\n<p>What's actually happening in the snippet above is that you are returning a <strong>copy</strong> of the vector.</p>\n\n<p>Then you try to do this:</p>\n\n<pre><code>std::vector&lt;double&gt;* ptr3 = &amp;(obj.GetVector());\n</code></pre>\n\n<p>Let's try to see what is happening here.</p>\n\n<p>First, you get a copy of the vector:</p>\n\n<pre><code>obj.GetVector()\n</code></pre>\n\n<p>then, you get the address <strong>of the copy</strong>:</p>\n\n<pre><code>&amp;(obj.GetVector())\n</code></pre>\n\n<p>This address is then assigned to <code>ptr3</code>. The expression then ends, and the copy was never stored anywhere (remember, you just stored its address, instead of the object itself). Since it is a temporary, it is destroyed at the end of the expression.</p>\n\n<p>Finally, you try to use the address you just got:</p>\n\n<pre><code>ptr3-&gt;at(0)\n</code></pre>\n\n<p>But since the object is destroyed, the address now points to garbage. This is why you're getting an error.</p>\n"}, {"tags": [], "owner": {"reputation": 846, "user_id": 8360627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497434168304/picture?type=large", "display_name": "John Ilacqua", "link": "https://stackoverflow.com/users/8360627/john-ilacqua"}, "is_accepted": false, "score": 1, "last_activity_date": 1539204468, "creation_date": 1539204468, "answer_id": 52748562, "question_id": 52748420, "link": "https://stackoverflow.com/questions/52748420/i-fail-to-use-c-pointer-to-point-to-the-stdvector-that-is-returned-by-a-clas/52748562#52748562", "title": "I fail to use C++ pointer to point to the std::vector that is returned by a class method", "body": "<p><code>AClass::GetVector()</code> returns a copy of the vector, so <code>std::vector&lt;double&gt;* ptr3 = &amp;(obj.GetVector());</code> calls that function, which creates a copy as a temporary, then takes the address of that temporary and stores it in <code>ptr3</code>, after which the temporary is destroyed. So you have a dangling pointer - a pointer to an object that no longer exists.</p>\n\n<p>Returning the pointer directly works because the pointer is directly to the data member, which still exists; and storing the copied vector into a local and then getting a pointer to it also works because, again, you're getting a pointer to an object with a lifetime at least as long as the pointer.</p>\n"}], "owner": {"reputation": 95, "user_id": 7942220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa4b6665694546278fbe7890ab23e1aa?s=128&d=identicon&r=PG&f=1", "display_name": "EKP", "link": "https://stackoverflow.com/users/7942220/ekp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52748524, "answer_count": 3, "score": 0, "last_activity_date": 1539204468, "creation_date": 1539203831, "question_id": 52748420, "link": "https://stackoverflow.com/questions/52748420/i-fail-to-use-c-pointer-to-point-to-the-stdvector-that-is-returned-by-a-clas", "title": "I fail to use C++ pointer to point to the std::vector that is returned by a class method", "body": "<p>I tried to access the private vector member. I am curious why it did not work when I make the pointer point to the return vector (last case)</p>\n\n<pre><code>  std::vector&lt;double&gt;* ptr3 = &amp;(obj.GetVector());\n  std::cout &lt;&lt; ptr3-&gt;at(0) &lt;&lt; '\\n'; //does not work\n</code></pre>\n\n<p>However, when I point to the newly created vector, it worked.</p>\n\n<pre><code>  std::vector&lt;double&gt; vec3(obj.GetVector());\n  std::cout &lt;&lt; vec3[3] &lt;&lt; '\\n'; //work. get 1.4\n\n  std::vector&lt;double&gt;* ptr1 = &amp;vec3;\n  std::cout &lt;&lt; ptr1-&gt;at(0) &lt;&lt; '\\n'; //work. get 1.1\n</code></pre>\n\n<p>The difference is just about skipping one line (assigned it to a vector first)</p>\n\n<p>When the method directly return the pointer and I assigned it to another pointer, it also worked.</p>\n\n<pre><code>  std::vector&lt;double&gt;* ptr2 = obj.GetVector2();\n  std::cout &lt;&lt; ptr2-&gt;at(1) &lt;&lt; '\\n'; //work. get 1.2\n</code></pre>\n\n<p>Could you please teach/explain me on this behavior? Thank you.</p>\n\n<p>The code of the cases discussed above is shown below.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nclass AClass {\n public:\n  AClass(): vec1({1.1,1.2,1.3,1.4}) {}\n  std::vector&lt;double&gt; GetVector() {\n    return vec1;\n  }\n  std::vector&lt;double&gt;* GetVector2() {\n    return &amp;vec1;\n  }\n private:\n  std::vector&lt;double&gt; vec1;\n};\n\nint main() {\n  AClass obj;\n  std::vector&lt;double&gt; vec2;\n  vec2 = obj.GetVector();\n  std::cout &lt;&lt; vec2[2] &lt;&lt; '\\n'; //work. get 1.3\n\n  std::vector&lt;double&gt; vec3(obj.GetVector());\n  std::cout &lt;&lt; vec3[3] &lt;&lt; '\\n'; //work. get 1.4\n\n  std::vector&lt;double&gt;* ptr1 = &amp;vec3;\n  std::cout &lt;&lt; ptr1-&gt;at(0) &lt;&lt; '\\n'; //work. get 1.1\n\n  std::vector&lt;double&gt;* ptr2 = obj.GetVector2();\n  std::cout &lt;&lt; ptr2-&gt;at(1) &lt;&lt; '\\n'; //work. get 1.2\n\n  std::vector&lt;double&gt;* ptr3 = &amp;(obj.GetVector());\n  std::cout &lt;&lt; ptr3-&gt;at(0) &lt;&lt; '\\n'; //does not work\n    //get\n    //\"Unhandled exception at 0x760FC54F in access_vector.exe\"\n    //\"exception: std::out_of_range at memory location 0x0033FA90\n\n  std::system(\"pause\");\n}\n</code></pre>\n"}, {"tags": ["c++", "constants"], "comments": [{"owner": {"reputation": 336, "user_id": 6778374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MmyzbBx3RYU/AAAAAAAAAAI/AAAAAAAAAEM/nlNqLKNWXoI/photo.jpg?sz=128", "display_name": "NeatNit", "link": "https://stackoverflow.com/users/6778374/neatnit"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539203878, "post_id": 52748398, "comment_id": 92421325, "body": "@Fran&#231;oisAndrieux yes, it is."}], "answers": [{"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 7, "creation_date": 1539204130, "post_id": 52748472, "comment_id": 92421415, "body": "&quot;the use of <code>const</code> in the argument type is pointless.&quot; I strongly disagree. The use of <code>const</code> in an argument type for a function <i>declaration</i> is pointless, but in a <i>definition</i>, it has almost as much point as marking a variable <code>const</code>"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1539204145, "post_id": 52748472, "comment_id": 92421420, "body": "The use of the <code>const</code> argument type is as pointless (or not) as declaring <code>str1</code> and <code>str2</code> to be <code>const</code> (given that we have a function definition.)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539204274, "post_id": 52748472, "comment_id": 92421488, "body": "<code>const int</code> isn&#39;t pointless. It&#39;s a way of telling the compiler &quot;I promise I will not change this value&quot; and from there all sorts of optimizations are possible."}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539204331, "post_id": 52748472, "comment_id": 92421514, "body": "@tadman: It isn&#39;t pointless, but optimizations do not happen because of <code>const</code>."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1539205553, "post_id": 52748472, "comment_id": 92422005, "body": "const on a function argument can also help avoid implementation errors. for example, say you have something like: bool MyFunction(uint16_t const count, ObjType const ** instances); marking count const will prevent you from accidentally changing it in the function body. I agree it doesn&#39;t matter to the caller and most of the time you aren&#39;t going to screw up something like that but it also hurts nothing to have in place."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1539208273, "post_id": 52748472, "comment_id": 92422927, "body": "@SoronelHaetir, The comments from everybody was an educational experience for me. It&#39;s good to hear different perspectives on a coding style."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1539204618, "last_edit_date": 1539204618, "creation_date": 1539204048, "answer_id": 52748472, "question_id": 52748398, "link": "https://stackoverflow.com/questions/52748398/returning-a-const-variable-can-it-cause-problems/52748472#52748472", "title": "Returning a const variable - can it cause problems?", "body": "<blockquote>\n  <p>The return value is either <code>str1</code> or <code>str2</code>, which are both <code>const</code>. Can this cause problems for the caller?</p>\n</blockquote>\n\n<p>No, it won't. The returned object is a copy of one of those.</p>\n\n<p>As an aside, the use of <code>const</code> in the argument type is pointless in most use cases. Whether you modify the value of the argument in the function or not does not impact the calling function. Unless you have a strong reason to justify use of <code>const</code>, I recommend using the simpler form without the <code>const</code>.</p>\n\n<pre><code>std::string MyFunction(int test) const { ... }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539204441, "post_id": 52748509, "comment_id": 92421554, "body": "@Fran&#231;oisAndrieux OP seemed concerned about creating a <code>const</code> object and then returning it as non-<code>const</code>. What I meant to tell him/her is that, as long as he/she wrote <code>std::string</code> as the return type, there was nothing the function could do regarding that in its implementation."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1539204701, "post_id": 52748509, "comment_id": 92421659, "body": "@Deduplicator OP&#39;s concern seemed to me to be that they think they may be allowing the user to modify a <code>const std::string</code>, as if the return type was <code>std::string &amp;</code> where the compiler is allowing an implicit <code>const</code> cast. It&#39;s a common concern for users coming from languages like Java."}, {"owner": {"reputation": 336, "user_id": 6778374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MmyzbBx3RYU/AAAAAAAAAAI/AAAAAAAAAEM/nlNqLKNWXoI/photo.jpg?sz=128", "display_name": "NeatNit", "link": "https://stackoverflow.com/users/6778374/neatnit"}, "edited": false, "score": 1, "creation_date": 1539204781, "post_id": 52748509, "comment_id": 92421690, "body": "@Acorn yes, you understood me correctly, and your answer did help me, but the explicit &quot;No, it won&#39;t&quot; in the other answer wins. Thanks!"}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539204911, "post_id": 52748509, "comment_id": 92421752, "body": "@Fran&#231;oisAndrieux I think OP&#39;s concern was about the common misconception that the &quot;constness&quot; of the object is somehow &quot;carried over&quot; to the caller because it was created as <code>const</code>, possibly because he/she thinks that the object returned is not a copy. Therefore, in that frame of thought, one could be concerned that you are introducing undefined behavior (think about it the same way as clearing the constness of a <code>const</code> object with <code>const_cast</code>)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1539205030, "post_id": 52748509, "comment_id": 92421799, "body": "@Acorn Ah, got it. Hadn&#39;t concidered it like that."}], "tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 3, "last_activity_date": 1539204228, "creation_date": 1539204228, "answer_id": 52748509, "question_id": 52748398, "link": "https://stackoverflow.com/questions/52748398/returning-a-const-variable-can-it-cause-problems/52748509#52748509", "title": "Returning a const variable - can it cause problems?", "body": "<p>The type you are returning is <code>std::string</code>, not <code>const std::string</code>. The caller shouldn't care what the type of the local variables is (the caller may not even have access to the definition/body/implementation of the function!).</p>\n\n<p>In general, the types of local variables in the body of a function cannot change the return type of the function itself (<code>auto</code> and lambdas excluded).</p>\n"}], "owner": {"reputation": 336, "user_id": 6778374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MmyzbBx3RYU/AAAAAAAAAAI/AAAAAAAAAEM/nlNqLKNWXoI/photo.jpg?sz=128", "display_name": "NeatNit", "link": "https://stackoverflow.com/users/6778374/neatnit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 52748472, "answer_count": 2, "score": 1, "last_activity_date": 1539204618, "creation_date": 1539203696, "question_id": 52748398, "link": "https://stackoverflow.com/questions/52748398/returning-a-const-variable-can-it-cause-problems", "title": "Returning a const variable - can it cause problems?", "body": "<p>I'm new to C++, haven't found an answer to this because the search results are always about the function signature and not this.</p>\n\n<p>Basically, if I have a function:</p>\n\n<pre><code>std::string MyFunction(const int test) const\n{\n    const std::string str1 = \"Hello\";\n    const std::string str2 = \"World\";\n    return test &gt; 7 ? str1 : str2;\n}\n</code></pre>\n\n<p>The return value is either <code>str1</code> or <code>str2</code>, which are both <code>const</code>. Can this cause problems for the caller?</p>\n"}, {"tags": ["c++", "std-pair", "copy-elision", "rvo", "nrvo"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539201385, "post_id": 52747770, "comment_id": 92420200, "body": "Why do you care so much about using <code>std::make_pair()</code> if what you want is default-constructed objects?"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1539201486, "post_id": 52747770, "comment_id": 92420252, "body": "There is no standard <code>&lt;pair&gt;</code> header file"}, {"owner": {"reputation": 743, "user_id": 4716122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5ce3810c49a63dd60c3ecd8337e650e5?s=128&d=identicon&r=PG&f=1", "display_name": "CD86", "link": "https://stackoverflow.com/users/4716122/cd86"}, "edited": false, "score": 0, "creation_date": 1539202485, "post_id": 52747770, "comment_id": 92420707, "body": "for reasons of consistency with regard to std::make_optional etc."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1539203379, "post_id": 52747770, "comment_id": 92421121, "body": "If you value consistency, then relying on the optimizer getting rid of that overhead 99.9% of the time is generally enough. If you do care about that .1%, then compromises on consistency are ok for that purpose."}], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1539206390, "post_id": 52748759, "comment_id": 92422307, "body": "Not that <code>std::make_pair</code> is all that relevant if you have C++17."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1539206608, "post_id": 52748759, "comment_id": 92422377, "body": "@Deduplicator deduction guides, right? i am still learning c++11 ;)"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1539208506, "post_id": 52748759, "comment_id": 92422997, "body": "Yes, though they only fill in holes in the new template-class deduction."}, {"owner": {"reputation": 743, "user_id": 4716122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5ce3810c49a63dd60c3ecd8337e650e5?s=128&d=identicon&r=PG&f=1", "display_name": "CD86", "link": "https://stackoverflow.com/users/4716122/cd86"}, "edited": false, "score": 0, "creation_date": 1539244104, "post_id": 52748759, "comment_id": 92433019, "body": "so what you are saying is, that cuz of class template argument deduction in C++17 std::make_pair has been rendered obsolete?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 743, "user_id": 4716122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5ce3810c49a63dd60c3ecd8337e650e5?s=128&d=identicon&r=PG&f=1", "display_name": "CD86", "link": "https://stackoverflow.com/users/4716122/cd86"}, "edited": false, "score": 0, "creation_date": 1539257090, "post_id": 52748759, "comment_id": 92440792, "body": "@CarstenD I am saying that <code>std::make_pair</code> is obsolete in your case (already before C++17). With C++17 also for the cases where one would need it before you dont need it anymore"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 3, "last_activity_date": 1539206069, "last_edit_date": 1539206069, "creation_date": 1539205441, "answer_id": 52748759, "question_id": 52747770, "link": "https://stackoverflow.com/questions/52747770/return-value-optimization-with-stdpair/52748759#52748759", "title": "Return value optimization with std::pair", "body": "<p>I think the premise of your question is wrong.</p>\n\n<blockquote>\n  <p>Is this really the only possible alternative if I want to use make_pair?</p>\n</blockquote>\n\n<p>Why would you use <code>std::make_pair</code> here?</p>\n\n<pre><code>auto w = std::make_pair&lt;Widget,Widget&gt;({},{}); // Awkward syntax and move construction\n</code></pre>\n\n<p>This really is awkward syntax. Let me explain why I think so...</p>\n\n<p>From <a href=\"https://en.cppreference.com/w/cpp/utility/pair/make_pair\" rel=\"nofollow noreferrer\">cppreference</a> on <code>std::make_pair</code> (emphasize mine): </p>\n\n<blockquote>\n  <p>Creates a std::pair object, <strong>deducing the target type from the types of arguments</strong>. </p>\n</blockquote>\n\n<p>The only purpose of <code>std::make_pair</code> is to deduce the types of its arguments, as for example in </p>\n\n<pre><code>std::pair&lt;int,int&gt; x;                         \nx = std::pair&lt;int,int&gt;(3,3);     // not nice      \nx = std::make_pair(3,3);         // ok\n</code></pre>\n\n<p>When default constructing a pair and you know its type, you never had to repeat the template parameters   </p>\n\n<pre><code>std::pair&lt;int,int&gt; a = std::pair&lt;int,int&gt;();  // awkward \n</code></pre>\n\n<p>Neither when you want non-default construction (just dont use <code>auto</code> when its only effect is that you have to spell the type elsewhere in the same line of code)</p>\n\n<pre><code>std::pair&lt;int,int&gt; a{5,4}; // no move/copy\n</code></pre>\n\n<p><strong>Bottomline:</strong></p>\n\n<p>The alternative is to simply not use <code>std::make_pair</code> when you don't need it.</p>\n"}], "owner": {"reputation": 743, "user_id": 4716122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5ce3810c49a63dd60c3ecd8337e650e5?s=128&d=identicon&r=PG&f=1", "display_name": "CD86", "link": "https://stackoverflow.com/users/4716122/cd86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551988801, "creation_date": 1539201057, "last_edit_date": 1551988801, "question_id": 52747770, "link": "https://stackoverflow.com/questions/52747770/return-value-optimization-with-stdpair", "title": "Return value optimization with std::pair", "body": "<p>I am currently quite puzzled with C++17`s guaranteed RVO and its implications. I understand that for NRVO to kick in, I need to make sure that </p>\n\n<ol>\n<li><p>to return one and the same instance of an object through all possible return path of the function and </p></li>\n<li><p>to initialize an associated object with the function call on the call side</p></li>\n</ol>\n\n<p>Consider a most simple decorated class Widget and I want to allocate a pair of Widgets without copies and then return it</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;utility&gt;\n\nstruct Widget {\n  Widget() { std::cerr &lt;&lt; \"Default ctor\" &lt;&lt; std::endl; }\n  explicit Widget(int i) { std::cerr &lt;&lt; \"custom ctor\" &lt;&lt; std::endl; }\n  Widget(Widget const &amp;) { std::cerr &lt;&lt; \"copy ctor\" &lt;&lt; std::endl; }\n  Widget(Widget &amp;&amp;) { std::cerr &lt;&lt; \"move ctor\" &lt;&lt; std::endl; }\n  Widget &amp;operator=(Widget const &amp;) { std::cerr &lt;&lt; \"copy assign\" &lt;&lt; std::endl; }\n  Widget &amp;operator=(Widget &amp;&amp;) { std::cerr &lt;&lt; \"move assign\" &lt;&lt; std::endl; }\n  int i_;\n};\n\nauto foo(){\n  std::pair&lt;Widget,Widget&gt; w;  // default construction\n  auto &amp;[w1,w2] = w;\n  // do something with w1 and w2\n  return w;\n}\n\nint main(){\n  auto f = foo();\n}\n</code></pre>\n\n<p>No copy is made but now I tried to use make_pair</p>\n\n<pre><code>auto foo(){\n  auto w = std::make_pair&lt;Widget,Widget&gt;({},{}); // Awkward syntax and move construction\n  auto &amp;[w1,w2] = w;\n  // do something with w1 and w2\n  return w;\n}\n</code></pre>\n\n<p>Is this really the only possible alternative if I want to use make_pair? Any why is there move construction involved as compared to the first function?</p>\n"}, {"tags": ["c++", "stack"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1539200529, "post_id": 52747653, "comment_id": 92419819, "body": "Why have you not posted Stack.h?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1539200593, "post_id": 52747653, "comment_id": 92419855, "body": "@Mat You beat me by seconds."}, {"owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "edited": false, "score": 0, "creation_date": 1539200757, "post_id": 52747653, "comment_id": 92419923, "body": "@NeilButterworth That would probably be a good idea. Just put it in. Thanks"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1539200892, "post_id": 52747653, "comment_id": 92419977, "body": "Well, what should happen if you push onto a full stack?"}, {"owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1539200976, "post_id": 52747653, "comment_id": 92420023, "body": "@alterigel It adds another element onto the stack whenever it pushes, right?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539200977, "post_id": 52747653, "comment_id": 92420024, "body": "@JohnSmith Stop tagging your code with these tags that make a &quot;run&quot; thingy show up when your code (single .h, .cpp-file) can&#39;t run anyway."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1539201067, "post_id": 52747653, "comment_id": 92420066, "body": "@JohnSmith but your array is only of size 10. What should happen if you push more than 10 elements into the array?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 1, "creation_date": 1539201134, "post_id": 52747653, "comment_id": 92420098, "body": "@alterigel maybe throw a <code>stackoverflow()</code>-exception? *duck &#39;n run*"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1539201400, "post_id": 52747653, "comment_id": 92420207, "body": "At the point of the crash, look at <code>top</code> and <code>ary</code>. Are they valid? People have noticed that your <code>case &#39;P&#39;</code> doesn&#39;t check <code>isFull</code> and your <code>case &#39;K&#39;</code> doesn&#39;t check <code>isEmpty</code> - in both cases you have buffer overflow/underflow."}, {"owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1539202319, "post_id": 52747653, "comment_id": 92420637, "body": "@RaymondChen Okay, so I added <code>while (!s.isFull())</code> to before you input the value and <code>while (!s.isEmpty()) to before the </code>y = s.peek();` and after it calls the K case, it just stops. I can&#39;t type anything else in. The exception is gone, though"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1539202547, "post_id": 52747653, "comment_id": 92420741, "body": "@JohnSmith -- You do know that a simple two line program totally messes up?  <code>{Stack s; s.peek();}</code>.  Before you put menus around broken classes, test your class by pushing, popping, peeking, hard-coded values."}, {"owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "edited": false, "score": 0, "creation_date": 1539204582, "post_id": 52747653, "comment_id": 92421603, "body": "Got it figured out, guys. Thanks so much!"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1539208986, "post_id": 52747653, "comment_id": 92423168, "body": "Why did you choose a <code>while</code> loop? Do you want to keep repeating the <code>push</code> until the stack is full? That&#39;s not normally how people use a stack."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "edited": false, "score": 0, "creation_date": 1539204825, "post_id": 52748515, "comment_id": 92421711, "body": "Yeah, I figured that out just before you answered. Thank you, though"}], "tags": [], "owner": {"reputation": 16, "user_id": 7207073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311624f147465d3b8a8b2734b90cdd6d?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas Michalak", "link": "https://stackoverflow.com/users/7207073/tomas-michalak"}, "is_accepted": true, "score": 0, "last_activity_date": 1539204269, "creation_date": 1539204269, "answer_id": 52748515, "question_id": 52747653, "link": "https://stackoverflow.com/questions/52747653/write-access-violation-exception/52748515#52748515", "title": "Write access violation exception", "body": "<p>Since the only place where you can change the value of 'c' which is used in the switch case statement is before the \"do while loop\", you end up in in the loop stuck with the selection you made. In case you chose 'P' all values you type later on are the ones you want to push to the stack (because you are stuck with c = 'P') Move the cin >> c line inside the 'do' part before the 'switch' statement. This will make the program behave more like you planned it. </p>\n"}], "owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 52748515, "answer_count": 1, "score": -1, "last_activity_date": 1539204269, "creation_date": 1539200398, "last_edit_date": 1539200789, "question_id": 52747653, "link": "https://stackoverflow.com/questions/52747653/write-access-violation-exception", "title": "Write access violation exception", "body": "<p>I'm making this program where you have to use a switch statement in a main to modify a stack, and I'm having a little problem with the push statement. After I input the value to put on the stack, the program pauses and shows this error:\n<code>Exception thrown: write access violation.\n**this** was 0x1AD0112. occurred</code>\nThe error points to my cpp file for the methods under push().</p>\n\n<pre><code>#include \"Stack.h\"\n\nvoid Stack::push(int val) {\n    top = top + 1;\n    ary[top] = val;          //this is where the exception is thrown.\n    //ary[top++] = val;\n}\n\nint Stack::pop() {\n    top = top - 1;\n    return ary[top + 1];\n    //return ary[top--];\n}\n\n    int Stack::peek() const {\n        return ary[top];\n    }\n\n    bool Stack::isFull() const {\n        if (top == SIZE - 1)\n            return true;\n        else\n            return false;\n        //return top == SIZE - 1;\n    }\n\n    bool Stack::isEmpty() const {\n        if (top == -1)\n            return true;\n        else\n            return false;\n        //return top == -1;\n    }\n\n    Stack::Stack() {\n        top = -1;\n    }\n</code></pre>\n\n<p>And then I call the method in the main to put the value at the top of the stack.</p>\n\n<pre><code>#include \"Stack.h\"\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    Stack s;\n    int x;\n    int y;\n    char c;\n\n    cin &gt;&gt; c;\n\n    do {\n\n        switch (c) {\n        case 'P':           //push statement\n            cin &gt;&gt; x;\n            s.push(x);\n            break;\n\n        //case 'O':\n            //y = s.pop();\n            //cout &lt;&lt; y &lt;&lt; endl;\n            //break;\n\n        case 'K':\n            y = s.peek();\n            cout &lt;&lt; y &lt;&lt; endl;\n            break;\n\n        case 'Q':\n            return 0;\n            break;\n\n        }\n\n    } while (c != 'Q');\n    return 0;\n}\n</code></pre>\n\n<p>Here is the header file as well</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#ifndef STACK_H\n#define STACK_H\n\nclass Stack {\n    private:\n        int top;\n        static const int SIZE = 10;\n        int ary[SIZE];\n\n    public:\n        int pop();\n        void push(int);\n        int peek() const;\n        bool isEmpty() const;\n        bool isFull() const;\n        Stack();\n\n};\n\n#endif\n</code></pre>\n\n<p>The error occurs after putting in the first push value. Any help is appreciated! Thanks</p>\n"}, {"tags": ["c++", "struct", "graph", "set", "undirected-graph"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1539199505, "post_id": 52747379, "comment_id": 92419387, "body": "Are you aware that std::set doesn&#39;t use operator==?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539199756, "post_id": 52747379, "comment_id": 92419500, "body": "Also, std::set&lt;T*&gt; will create a set of unique adresses, not unique values."}, {"owner": {"reputation": 23, "user_id": 7633447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7866e9ed2ce2b4f5c5090bdaf20414?s=128&d=identicon&r=PG&f=1", "display_name": "Sar", "link": "https://stackoverflow.com/users/7633447/sar"}, "edited": false, "score": 0, "creation_date": 1539200099, "post_id": 52747379, "comment_id": 92419650, "body": "@NeilButterworth No I wasn&#39;t, now I am. So operators &lt;&gt; only?"}, {"owner": {"reputation": 23, "user_id": 7633447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7866e9ed2ce2b4f5c5090bdaf20414?s=128&d=identicon&r=PG&f=1", "display_name": "Sar", "link": "https://stackoverflow.com/users/7633447/sar"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539200303, "post_id": 52747379, "comment_id": 92419733, "body": "@Frank yes, I want a set &quot;of pointers to Edge structs&quot;. And I would like the &quot;tell the set&quot; that even if I have 2 edge structs with different addresses, it should look at the node numbers that each end of an edge points to and if they are the same regardless of direction, treat edges as equivalent."}, {"owner": {"reputation": 1611, "user_id": 2557235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/02veH.jpg?s=128&g=1", "display_name": "nathanesau", "link": "https://stackoverflow.com/users/2557235/nathanesau"}, "edited": false, "score": 0, "creation_date": 1539200393, "post_id": 52747379, "comment_id": 92419771, "body": "Note: you should define <code>Node::operator&lt;(const Node &amp;n)</code> which you are trying to use in <code>Edge::operator&lt;(const Edge &amp;e)</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539202178, "post_id": 52747379, "comment_id": 92420565, "body": "@Sar <code>set</code> operates on <a href=\"https://en.wikipedia.org/wiki/Weak_ordering#Strict_weak_orderings\" rel=\"nofollow noreferrer\">Strict Weak Ordering</a>."}], "answers": [{"tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": true, "score": 1, "last_activity_date": 1539201490, "last_edit_date": 1539201490, "creation_date": 1539200232, "answer_id": 52747607, "question_id": 52747379, "link": "https://stackoverflow.com/questions/52747379/use-a-set-of-structs-and-avoid-duplicate-structs-in-a-set/52747607#52747607", "title": "Use a set of structs and avoid duplicate structs in a set", "body": "<p><code>std::set&lt;T*&gt;</code> will create a set of memory locations, not a set of T values.</p>\n\n<p>If you want to compare the pointed objects, you need to provide a custom comparator:</p>\n\n<pre><code>struct Ptr_compare {\n  template&lt;typename T&gt;\n  constexpr bool operator()( const T* lhs, const T* rhs ) const {\n    return *lhs &lt; *rhs;\n  }\n};\n\n// This is a struct for graph\nstruct Graph {\n    set&lt;Node*, Ptr_compare&gt; Nodes;\n    set&lt;Edge*, Ptr_compare&gt; Edges;\n    map&lt;int, Node*&gt; nodeMap;\n};\n</code></pre>\n\n<p>However:</p>\n\n<p>Be aware that the code I wrote answers your question, but is still not correct for your use-case, it's only ok to use this for <strong>non-owning pointers</strong>, which is most definitely not your case.</p>\n\n<p>This is not a problem with my solution per-se, but a fundamental issue in what you are trying to accomplish. Something needs to call <code>delete</code> on the dedupped objects.</p>\n"}], "owner": {"reputation": 23, "user_id": 7633447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7866e9ed2ce2b4f5c5090bdaf20414?s=128&d=identicon&r=PG&f=1", "display_name": "Sar", "link": "https://stackoverflow.com/users/7633447/sar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 52747607, "answer_count": 1, "score": 0, "last_activity_date": 1539201490, "creation_date": 1539199242, "last_edit_date": 1539199813, "question_id": 52747379, "link": "https://stackoverflow.com/questions/52747379/use-a-set-of-structs-and-avoid-duplicate-structs-in-a-set", "title": "Use a set of structs and avoid duplicate structs in a set", "body": "<p>I am trying to represent a non-directional graph. I created three structs as shown below. I added operator == and operator &lt; to the Edge struct hoping the set would use it to compare elements.</p>\n\n<pre><code>struct  Node;   /* Forward references to these two types */\nstruct Edge;     /* that the compiler can recognize them */\n\n/* Type: Node\n * This type represents an individual node and consists of the data of the \n *  node and the set of edges from this node */\nstruct Node{\n    int nodeNum;\n    string data;\n    set&lt;Edge*&gt; edges;\n};\n\n\n/* Type: Edge\n * This type represents an individual edge and consists of pointers to the \n * endpoints */\nstruct Edge{\n    Node *end1;\n    Node *end2;\n\n    // This says that edge from node 1 to node 2 and edge from node 2 to node 1 are considered the same\n    bool operator==(const Edge &amp;e) const{\n        return ( (this-&gt;end1-&gt;nodeNum == e.end1-&gt;nodeNum &amp;&amp; this-&gt;end2-&gt;nodeNum == e.end2-&gt;nodeNum) ||\n                 (this-&gt;end1-&gt;nodeNum == e.end2-&gt;nodeNum &amp;&amp; this-&gt;end2-&gt;nodeNum == e.end1-&gt;nodeNum));\n    }\n\n    // This function is used by set to order elements of edges.\n    bool operator&lt;(const Edge *e) const{\n        return (this-&gt;end1 &lt; e-&gt;end1 &amp;&amp; this-&gt;end2 &lt; e-&gt;end2);\n    }\n};\n\n\n// This is a struct for graph\nstruct Graph{\n    set&lt;Node*&gt; Nodes;\n    set&lt;Edge*&gt; Edges;\n    map&lt;int, Node*&gt; nodeMap;\n};\n</code></pre>\n\n<p>Question: If say, I have an edge from node 1 to 2 and an edge from 2 to 1, my struct declaration says they should be considered equivalent. Yet when I insert those two edges in a set, it inserts both of them as two separate elements (i.e. set does not understand that edge 1-2 and 2-1 are equal). What do I do so that the set took care of duplicates (i.e. only keeps one of these edges). See e.g. below:</p>\n\n<pre><code> int main(){\n    // Let's make 2 nodes, node 1 and node 2\n    Node* n1 = new Node;\n    Node* n2 = new Node;\n    n1-&gt;nodeNum=1;\n    n2-&gt;nodeNum=2;\n\n    // Let's make 2 edges 1-2 and 2-1\n    Edge* e1 = new Edge;\n    Edge* e2 = new Edge;\n    e1-&gt;end1=n1; e1-&gt;end2=n2;\n    e2-&gt;end1=n2; e2-&gt;end2=n1;\n\n    // Now let's make a graph and put the edges in its internal set\n    Graph g;\n    g.Edges.insert(e1);  \n    g.Edges.insert(e2);  // the set takes in both e1 and e2. If I print all elements in g.Edges, it will print both 1-2 and 2-1\n    // How do I tell the set to treat e1 and e2 as equal edges so it took care of duplicates?\n\n    return 0;\n   }\n</code></pre>\n"}, {"tags": ["c++", "qt"], "answers": [{"comments": [{"owner": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539267224, "post_id": 52756601, "comment_id": 92447486, "body": "I literally copied and pasted your code from the protected: section, and on my machine at least, I don&#39;t even see the &quot;showEvent&quot; fired, much less the keyPress/KeyRelease events. Maybe it has something to do with running on a mac? I&#39;ll see if I can try on windows later today just to see if it makes a difference."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539267658, "post_id": 52756601, "comment_id": 92447845, "body": "@ibrewster Oops. I couldn&#39;t test on a Mac nor I&#39;ve any experience. (I was afraid something like this...) May be, the <a href=\"http://doc.qt.io/qt-5/eventsandfilters.html#event-filters\" rel=\"nofollow noreferrer\">event filter</a> could fix this which I have not yet tested. I may have a look at it this evening (soon on my side) - you may try as well."}, {"owner": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539267831, "post_id": 52756601, "comment_id": 92447977, "body": "Yep. Never used an event filter, and I wouldn&#39;t have thought the platform would be the issue, but maybe it is. I&#39;ll take a look into eventFilters - haven&#39;t used them before, so should be fun! :)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539268844, "post_id": 52756601, "comment_id": 92448688, "body": "@ibrewster Out of curiosity: Is there even a Ctrl key on Mac?"}, {"owner": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539273802, "post_id": 52756601, "comment_id": 92451787, "body": "Yeah, there is. It doesn&#39;t get as much use as on windows - keyboard shortcuts generally use the &quot;command&quot; key (same key as the &quot;windows&quot; key on windows) - but it&#39;s there. It&#39;s often used as a secondary command key, as well as for some direct commands, such as the default for switching &quot;spaces&quot; (virtual desktops)."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539275786, "post_id": 52756601, "comment_id": 92452678, "body": "@ibrewster answer updated for event filters. (Haven&#39;t used them before, too.) ;-)"}, {"owner": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539275916, "post_id": 52756601, "comment_id": 92452742, "body": "It&#39;s looking more and more like this might be a mac thing then. I just updated my question with my attempt at using event filters. Short answer: didn&#39;t work for me."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539276434, "post_id": 52756601, "comment_id": 92453028, "body": "@ibrewster <i>I don&#39;t even see the &quot;showEvent&quot; fired</i> This let me even more suspect, that the menus are used on Mac in a more system specific way i.e. by-passing the common Qt code/events."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 0, "creation_date": 1539276687, "post_id": 52756601, "comment_id": 92453160, "body": "@ibrewster Sorry, if I repeated any of your observations. It seems that the page wasn&#39;t updating correctly in the past minutes. Just saw your comments after I was done..."}, {"owner": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "edited": false, "score": 1, "creation_date": 1539279402, "post_id": 52756601, "comment_id": 92454627, "body": "Hmmm...this might be something (<a href=\"http://doc.qt.io/qt-5/osx-issues.html#limitations\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/osx-issues.html#limitations</a>): &quot;QMenu objects used in the native menu bar are not able to handle Qt events via the normal event handlers. Install a delegate on the menu itself to be notified of these changes&quot;. Guess I need to figure out how to do that :)"}], "tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": false, "score": 2, "last_activity_date": 1539276198, "last_edit_date": 1539276198, "creation_date": 1539249881, "answer_id": 52756601, "question_id": 52747343, "link": "https://stackoverflow.com/questions/52747343/capture-keypressevent-on-qmenubar-qmenu/52756601#52756601", "title": "Capture keyPressEvent on QMenuBar/QMenu?", "body": "<p>I made an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> for OP's issue.</p>\n\n<p>I believe I cannot reproduce the issue of OP. May be, OP had other expectations than me. Of course, the menu bar will not receive key events as long as it's not activated. (I ignore the subject of short-cuts for now.)</p>\n\n<p>In my tests, I always first clicked into menu bar to activate menu and then received key events. I tested this with menu bar as well as with sub-menu.</p>\n\n<p>I observed that as soon as a sub-menu is opened, even both (menu bar <em>and</em> menu) received the (same) key event. (This seems reasonable considering that <kbd>&larr;</kbd> and <kbd>&rarr;</kbd> effect on menu bar but <kbd>&uarr;</kbd> and <kbd>&darr;</kbd> on active menu instead.)</p>\n\n<p>This is my sample code <code>testQMenuKeyEvent.cc</code>:</p>\n\n<pre><code>#include &lt;QtWidgets&gt;\n\nclass FileMenu: public QMenu {\n  private:\n    QAction qCmdNew, qCmdOpen, qCmdQuit;\n    bool alt;\n\n  public:\n    FileMenu(): QMenu(),\n      qCmdNew(QString::fromUtf8(\"New\")),\n      qCmdOpen(QString::fromUtf8(\"Open\")),\n      qCmdQuit(QString::fromUtf8(\"Quit\")),\n      alt(false)\n    {\n      addAction(&amp;qCmdNew);\n      addAction(&amp;qCmdOpen);\n      addAction(&amp;qCmdQuit);\n      // install signal handlers\n      connect(&amp;qCmdNew, &amp;QAction::triggered,\n        [&amp;]() {\n          qDebug() &lt;&lt; (alt ? \"Reset\" : \"New\") &lt;&lt; \"triggered\";\n        });\n      connect(&amp;qCmdOpen, &amp;QAction::triggered,\n        [&amp;]() {\n          qDebug() &lt;&lt; (alt ? \"Save\" : \"Open\") &lt;&lt; \"triggered\";\n        });\n\n    }\n  protected:\n    virtual void showEvent(QShowEvent *pQEvent) override\n    {\n      qDebug() &lt;&lt; \"FileMenu::showEvent\";\n      update();\n      QMenu::showEvent(pQEvent);\n    }\n\n    virtual void keyPressEvent(QKeyEvent *pQEvent) override\n    {\n      qDebug() &lt;&lt; \"FileMenu::keyPressEvent\";\n      update(pQEvent-&gt;modifiers());\n      QMenu::keyPressEvent(pQEvent);\n    }\n    virtual void keyReleaseEvent(QKeyEvent *pQEvent) override\n    {\n      qDebug() &lt;&lt; \"FileMenu::keyReleaseEvent\";\n      update(pQEvent-&gt;modifiers());\n      QMenu::keyReleaseEvent(pQEvent);\n    }\n\n  private:\n    void update()\n    {\n      update(\n        (QApplication::keyboardModifiers()\n          &amp; Qt::ControlModifier)\n        != 0);\n    }\n    void update(bool alt)\n    {\n      qDebug() &lt;&lt; \"alt:\" &lt;&lt; alt;\n      if (!alt != !this-&gt;alt) {\n        qCmdNew.setText(QString::fromUtf8(alt ? \"Reset\" : \"New\"));\n        qCmdOpen.setText(QString::fromUtf8(alt ? \"Save\" : \"Open\"));\n      }\n      this-&gt;alt = alt;\n    }\n};\n\nint main(int argc, char **argv)\n{\n  qDebug() &lt;&lt; \"Qt Version:\" &lt;&lt; QT_VERSION_STR;\n  QApplication app(argc, argv);\n  QMainWindow qWin;\n  QMenuBar qMenuMain;\n  QAction qCmdFile(QString::fromUtf8(\"File\"));\n  FileMenu qMenuFile;\n  qCmdFile.setMenu(&amp;qMenuFile);\n  qMenuMain.addAction(&amp;qCmdFile);\n  QAction qCmdEdit(QString::fromUtf8(\"Edit\"));\n  qMenuMain.addAction(&amp;qCmdEdit);\n  QAction qCmdHelp(QString::fromUtf8(\"Help\"));\n  qMenuMain.addAction(&amp;qCmdHelp);\n  qWin.setMenuBar(&amp;qMenuMain);\n  qWin.show();\n  return app.exec();\n}\n</code></pre>\n\n<p>The Qt project <code>testQMenuKeyEvent.pro</code> I used to build:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>SOURCES = testQMenuKeyEvent.cc\n\nQT = widgets\n</code></pre>\n\n<p>Compiled and tested in <a href=\"http://www.cygwin.org\" rel=\"nofollow noreferrer\">cygwin64</a> on Windows 10:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ qmake-qt5 testQMenuKeyEvent.pro\n\n$ make &amp;&amp; ./testQMenuKeyEvent\nQt Version: 5.9.4\nFileMenu::showEvent\nalt: false\nNew triggered\nFileMenu::showEvent\nalt: false\nFileMenu::keyPressEvent\nalt: true\nReset triggered\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aJp5N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aJp5N.png\" alt=\"Snapshot of testQMenuKeyEvent in cygwin/X11\"></a> <a href=\"https://i.stack.imgur.com/hFVWE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hFVWE.png\" alt=\"Snapshot of testQMenuKeyEvent in cygwin/X11 (Ctrl key pressed)\"></a></p>\n\n<p>Afterwards, I built again in VS2013 with Qt bound to win32 API:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2nrT4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2nrT4.png\" alt=\"Snapshot of testQMenuKeyEvent in Windows 10\"></a> <a href=\"https://i.stack.imgur.com/ekkN7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ekkN7.png\" alt=\"Snapshot of testQMenuKeyEvent in Windows 10 (Ctrl key pressed)\"></a></p>\n\n<p>Despite of the slightly different look, it behaved identical.</p>\n\n<p><strong>Notes:</strong></p>\n\n<ol>\n<li><p>When I tested the code initially, I noticed that key navigation was broken. Hence, I find it worth to be mentioned that <code>override</code>-ing should call the overridden methods of base class to ensure the original behavior as well.</p></li>\n<li><p>The <kbd>Ctrl</kbd> key which I used for switching the menu items may be pressed before the menu is activated. To consider this, I overloaded <code>showEvent()</code> as well.</p></li>\n<li><p>For triggered action, the <kbd>Ctrl</kbd> is checked again to the latest possible moment. This is done using lambdas as signal handlers for the <code>QAction</code>s. Moving it to the handler function itself would ensure that this becomes effective for other occurrences of theses actions as well. (I mean, these actions could be \"re-used\" in a toolbar.)</p></li>\n<li><p>When <code>QApplication::keyboardModifiers()</code> is called inside <code>keyPressEvent()</code> or <code>keyReleaseEvent()</code> it returned wrong values but using the <code>QKeyEvent::modifiers()</code> instead worked fine. This let me think, that update of global states is done after processing these events.</p></li>\n<li><p>It becomes a bit more complicated if the shown behavior shall be achieved for the menu bar itself. In this case, <code>keyPressEvent()</code> doesn't help much. (It's not called as long as menu bar is not active (focused)). In this case, an <a href=\"http://doc.qt.io/qt-5/eventsandfilters.html#event-filters\" rel=\"nofollow noreferrer\">event filter</a> can be used to catch any key press and update the menu bar actions in case.</p></li>\n</ol>\n\n<hr>\n\n<p>OP mentioned that the above solution didn't work on his MacBook.</p>\n\n<p>I looked into Qt. doc. of <a href=\"http://doc.qt.io/qt-5/qmenu.html#details\" rel=\"nofollow noreferrer\"><code>QMenu</code></a>. All I found was:</p>\n\n<blockquote>\n  <p>QMenu on macOS with Qt Build Against Cocoa</p>\n  \n  <p>QMenu can be inserted only once in a menu/menubar. Subsequent insertions will have no effect or will result in a disabled menu item.</p>\n</blockquote>\n\n<p>This doesn't seem to be related directly. Though, it gave me the feeling that things might be a bit different on Mac...</p>\n\n<p>So, I followed the idea with the <a href=\"http://doc.qt.io/qt-5/eventsandfilters.html#event-filters\" rel=\"nofollow noreferrer\">event filter</a> and changed the sample code respectively:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;vector&gt;\n\n#include &lt;QtWidgets&gt;\n\nclass CtrlNotifier: public QObject {\n  private:\n    bool ctrl;\n  public:\n    // to be notified\n    std::vector&lt;std::function&lt;void(bool)&gt; &gt; sigNotify;\n  public:\n    CtrlNotifier():\n      ctrl(\n        (QApplication::keyboardModifiers() &amp; Qt::ControlModifier)\n        != 0)\n    { }\n    bool isCtrl() const { return ctrl; }\n  protected:\n    virtual bool eventFilter(QObject *pQObj, QEvent *pQEvent) override\n    {\n      if (pQEvent-&gt;type() == QEvent::KeyPress\n        || pQEvent-&gt;type() == QEvent::KeyRelease) {\n        const bool ctrl\n          = (dynamic_cast&lt;QKeyEvent*&gt;(pQEvent)-&gt;modifiers()\n            &amp; Qt::ControlModifier)\n          != 0;\n        if (!this-&gt;ctrl != !ctrl) {\n          qDebug() &lt;&lt; \"CtrlNotifier::eventFilter: Ctrl:\" &lt;&lt; ctrl;\n          for (std::function&lt;void(bool)&gt; &amp;func : sigNotify) {\n            if (func) func(ctrl);\n          }\n          this-&gt;ctrl = ctrl;\n        }\n      }\n      // standard event processing\n      return QObject::eventFilter(pQObj, pQEvent);\n    }\n};\n\nint main(int argc, char **argv)\n{\n  qDebug() &lt;&lt; \"Qt Version:\" &lt;&lt; QT_VERSION_STR;\n  QApplication app(argc, argv);\n  QMainWindow qWin;\n  QMenuBar qMenuMain;\n  QAction qCmdFile(QString::fromUtf8(\"File\"));\n  QMenu qMenuFile;\n  QAction qCmdNew(QString::fromUtf8(\"New\"));\n  qMenuFile.addAction(&amp;qCmdNew);\n  QAction qCmdOpen(QString::fromUtf8(\"Open\"));\n  qMenuFile.addAction(&amp;qCmdOpen);\n  QAction qCmdQuit(QString::fromUtf8(\"Quit\"));\n  qMenuFile.addAction(&amp;qCmdQuit);\n  qCmdFile.setMenu(&amp;qMenuFile);\n  qMenuMain.addAction(&amp;qCmdFile);\n  QAction qCmdEdit(QString::fromUtf8(\"Edit\"));\n  qMenuMain.addAction(&amp;qCmdEdit);\n  QAction qCmdHelp(QString::fromUtf8(\"Help\"));\n  qMenuMain.addAction(&amp;qCmdHelp);\n  qWin.setMenuBar(&amp;qMenuMain);\n  qWin.show();\n  // install event filter\n  CtrlNotifier ctrlNotifier;\n  app.installEventFilter(&amp;ctrlNotifier);\n  // install signal handlers\n  ctrlNotifier.sigNotify.push_back(\n    [&amp;](bool ctrl) {\n      qCmdNew.setText(QString::fromUtf8(ctrl ? \"Reset\" : \"New\"));\n      qCmdOpen.setText(QString::fromUtf8(ctrl ? \"Save\" : \"Open\"));\n    });\n  // install signal handlers\n  QObject::connect(&amp;qCmdNew, &amp;QAction::triggered,\n    [&amp;]() {\n    qDebug() &lt;&lt; (ctrlNotifier.isCtrl() ? \"Reset\" : \"New\") &lt;&lt; \"triggered\";\n  });\n  QObject::connect(&amp;qCmdOpen, &amp;QAction::triggered,\n    [&amp;]() {\n    qDebug() &lt;&lt; (ctrlNotifier.isCtrl() ? \"Save\" : \"Open\") &lt;&lt; \"triggered\";\n  });\n  // runtime-loop\n  return app.exec();\n}\n</code></pre>\n\n<p>I tested again on Windows 10 (Qt bound to win32) and cygwin (Qt bound to X11).\nIt worked in both cases.</p>\n\n<p><strong>Note:</strong></p>\n\n<ol>\n<li><p>When <code>QApplication::keyboardModifiers()</code> is called inside <code>CtrlNotifier::eventFilter()</code> it returned wrong values again but using the <code>QKeyEvent::modifiers()</code> instead worked fine.</p></li>\n<li><p>I tried accidentally to filter events of main window first. This worked as long as I activated the menu. For my luck, I realized the note in the doc. (last paragraph in <a href=\"http://doc.qt.io/qt-5/eventsandfilters.html#event-filters\" rel=\"nofollow noreferrer\">Event Filters</a> chapter):</p>\n\n<blockquote>\n  <p>It is also possible to filter all events for the entire application, by installing an event filter on the QApplication or QCoreApplication object. Such global event filters are called before the object-specific filters. This is very powerful, but it also slows down event delivery of every single event in the entire application; the other techniques discussed should generally be used instead.</p>\n</blockquote>\n\n<p>Thus, installing it on the <code>app</code> instead brought the intended behavior.</p></li>\n<li><p>I apologize for the non-Qt-ish signal in <code>CtrlNotifier</code>. I'm using distinct build scripts for VS2013 (CMake) and cygwin (qmake-qt5). This makes correct MOC handling a bit trickier as usual. Hence, I try to prevent its necessity when possible. (I don't say it's impossible to integrate MOC for both cases. &ndash; I once managed it successfully.) </p></li>\n</ol>\n"}], "owner": {"reputation": 2952, "user_id": 272118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/c5kMw.jpg?s=128&g=1", "display_name": "ibrewster", "link": "https://stackoverflow.com/users/272118/ibrewster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1539280997, "creation_date": 1539199119, "last_edit_date": 1539280997, "question_id": 52747343, "link": "https://stackoverflow.com/questions/52747343/capture-keypressevent-on-qmenubar-qmenu", "title": "Capture keyPressEvent on QMenuBar/QMenu?", "body": "<p>I want to modify a QAction if the user holds down a specific key. You can see similar behavior on the Mac, for example, if you pull down the Apple menu and press/release the option key - \"About This Mac\" changes to \"System Information...\", among other things. This is the behavior I want to emulate in my application.</p>\n\n<p>To that end, I tried overriding the keyPressEvent on both the QMenuBar and the QMenu containing the QAction. However, my debugging indicated that neither of these keyPressEvent functions were called when pressing any key with the relevant QMenu displayed. </p>\n\n<p>I'm sort of wondering if this is perhaps due to the event being handled at a lower level in order to provide \"type ahead\" type functionality in the menu? I did notice that different menu entries are selected when typing various keys, which I believe to be normal behavior.</p>\n\n<p>How can I respond to a keyPress type event in a QMenuBar or QMenu?</p>\n\n<p>EDIT: this is what I tried:</p>\n\n<pre><code>class MainMenu: public QMenuBar\n{\n    Q_OBJECT\nprotected:\n    void keyPressEvent(QKeyEvent *event) override\n    {qDebug(\"Got Key Press Event in Menu Bar: %i\",event-&gt;key());}\n}\n\nclass FileMenu: public QMenu\n{\n    Q_OBJECT\nprotected:\n    void keyPressEvent(QKeyEvent *event) override\n    {qDebug(\"Got Key Press Event in Menu: %i\",event-&gt;key());}\n}\n</code></pre>\n\n<p>I then instantiated the menu bar as normal, populated a FileMenu object with a number of QActions, and added it to the menu bar. This all worked, but the qDebug lines are never printed, and manually debugging the app shows the event is never called.</p>\n\n<p>EDIT 2: For more information, I am using Qt 5.9.6, on MacOS X 10.14.0.</p>\n\n<p>EDIT 3: As a further test, I tried installing an eventFilter, using the code from <a href=\"http://doc.qt.io/qt-5/qobject.html#installEventFilter\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qobject.html#installEventFilter</a> to install the KeyPressEater object as an event filter on two objects: one, my menu bar object, and two the QApplication object, as per the documentation at <a href=\"http://doc.qt.io/qt-5/eventsandfilters.html#event-filters\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/eventsandfilters.html#event-filters</a>:</p>\n\n<blockquote>\n  <p>It is also possible to filter all events for the entire application, by installing an event filter on the QApplication or QCoreApplication object.</p>\n</blockquote>\n\n<p>What I saw with that approach is that the KeyPressEater eventFilter DID get called for keyPresses - but ONLY if the menu was not activated. As soon as I activate a menu (any menu, including the apple menu), the eventFilter function stops getting called.</p>\n\n<p>The impression I'm getting here is that the system takes over the menu handling, thereby preventing <em>any</em> events from getting through to the application. Of course, that's just based on observed behavior.</p>\n\n<p>EDIT 4: Some more digging turned up this: (doc.qt.io/qt-5/osx-issues.html#limitations): </p>\n\n<blockquote>\n  <p>\"QMenu objects used in the native menu bar are not able to handle Qt events via the normal event handlers. Install a delegate on the menu itself to be notified of these changes</p>\n</blockquote>\n\n<p>So I guess the \"answer\" is that I need to \"install a delegate on the menu itself\" that \"notifies me of these changes\". Can someone help with that?</p>\n"}, {"tags": ["c++", "macos", "debugging", "gdb", "macos-high-sierra"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1539283443, "post_id": 52747174, "comment_id": 92456635, "body": "Will try to reproduce, but don&#39;t have a Mac. What version of clang are you using?"}, {"owner": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1539297744, "post_id": 52747174, "comment_id": 92462304, "body": "@Mark Plotnick: Apple LLVM version 10.0.0 (clang-1000.10.44.2) Target: x86_64-apple-darwin17.7.0 Thread model: posix"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "edited": false, "score": 0, "creation_date": 1539265644, "post_id": 52751730, "comment_id": 92446296, "body": "Thanks for the answer. I never thought there would still be optimisations even when the build type is debug. I thought it might be because the assigned string is not used but I edited my post above to show gdb stops on other unused assigned variables. Is this issue specific to some standard header types like strings then? Otherwise, is there any way to remove all these optimisations completely so that it stops on string assignments?"}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "edited": false, "score": 0, "creation_date": 1539267490, "post_id": 52751730, "comment_id": 92447716, "body": "@O.Oyibo Your first step should be to confirm or disprove my guess. <code>make clean &amp;&amp; make</code> and <i>observe</i> the command that is used to compile <code>main.cpp</code>. Does it have <code>-O2</code> or similar optimization flags, or does it not?"}, {"owner": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "edited": false, "score": 0, "creation_date": 1539297641, "post_id": 52751730, "comment_id": 92462281, "body": "I ran make clean &amp;&amp; make VERBOSE=1 to see the compilation commands and I see no optimisation flags. I only see the -g flag. I had already tried this before posting the initial question so I was wondering if even without any optimisation flags present does it still do some optimisations? From what you&#39;re saying It would seem it does but I have no idea why."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "edited": false, "score": 0, "creation_date": 1539298462, "post_id": 52751730, "comment_id": 92462449, "body": "@O.Oyibo Without optimization flags, there should be no optimizations, so my guess is probably wrong."}, {"owner": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "edited": false, "score": 0, "creation_date": 1539676933, "post_id": 52751730, "comment_id": 92577703, "body": "If you don&#39;t mind me asking do you get the same issue? I just want to check whether it&#39;s something wrong with my configuration/gdb setup."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1539228500, "creation_date": 1539228500, "answer_id": 52751730, "question_id": 52747174, "link": "https://stackoverflow.com/questions/52747174/gdb-breakpoints-are-inaccurrate-on-mac/52751730#52751730", "title": "GDB Breakpoints are inaccurrate on Mac", "body": "<blockquote>\n  <p>gdb sometimes skips the breakpoint or breaks on the wrong line</p>\n</blockquote>\n\n<p>In general, this happens when the code is built with optimizations.</p>\n\n<p>I know you've selected <code>CMAKE_BUILD_TYPE Debug</code>, but perhaps that is still doing an optimized build for some reason?</p>\n"}], "owner": {"reputation": 1, "user_id": 10483709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c37a5b1f411cb5ff9b444f6878c60da?s=128&d=identicon&r=PG&f=1", "display_name": "O.Oyibo", "link": "https://stackoverflow.com/users/10483709/o-oyibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539265104, "creation_date": 1539198384, "last_edit_date": 1539265104, "question_id": 52747174, "link": "https://stackoverflow.com/questions/52747174/gdb-breakpoints-are-inaccurrate-on-mac", "title": "GDB Breakpoints are inaccurrate on Mac", "body": "<p>I have been using gdb on Mac recently but sometimes the breakpoints are wrong such that if I assign a breakpoint and run gdb sometimes skips the breakpoint or breaks on the wrong line. Can anyone help me out? I've tried to find the simplest case of the issue below.:</p>\n\n<pre><code>Project\n|\n+-- CMakeLists.txt\n|    \n+-- include\n|    |  \n|    +-- A.hpp\n|\n+-- src \n     |  \n     +-- main.cpp\n</code></pre>\n\n<p>A.hpp</p>\n\n<pre><code>#pragma once\n\nclass A { \npublic: \n   A(const char* t){};\n}; \n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>1 #include&lt;string&gt;\n2 #include\"A.hpp\"\n3 int main(){ \n4   std::string s = \"\";\n5   A a = \"\";\n6   return 0;\n7 }\n</code></pre>\n\n<p>CMakeLists.txt</p>\n\n<pre><code>1 cmake_minimum_required (VERSION 3.0)\n2\n3\n4 file(GLOB SOURCES \"src/*.cpp\")\n5 set(CMAKE_BUILD_TYPE Debug)\n6 \n7 add_executable(main ${SOURCES})\n8\n9 target_include_directories(main PUBLIC include)\n</code></pre>\n\n<p>If I try to set a breakpoint in main.cpp line 4 where the string is assigned and run main in gdb, it stops on line 5.\nI think that this happens when standard headers like  are used. If I change line 4 to a simple assignment like int i = 0;, the breakpoint stops on line 4 as expected.</p>\n\n<p>I Have:</p>\n\n<p>Mac Version High Sierra 10.13.6</p>\n\n<p>CMakeVersion: 3.12.0</p>\n\n<p>GDB version: 8.0.1 (installed via homebrew) </p>\n\n<p>Thanks for any help in advance.</p>\n"}, {"tags": ["c++", "recursion", "boolean"], "comments": [{"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 8, "creation_date": 1539197076, "post_id": 52746800, "comment_id": 92418255, "body": "<code>is_perfect_prime</code> just calls itself recursively, ignoring the return value. So I&#39;m surprised your program works at all."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539197158, "post_id": 52746800, "comment_id": 92418294, "body": "loop should be <code>for (int i = 3; i * i &lt;= n; i += 2) {</code> instead. And 1 is considered a prime, no?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539197163, "post_id": 52746800, "comment_id": 92418296, "body": "Unrelated: Look into using a prime sieving algorithm and memoization to speed up <code>is_prime</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1539197235, "post_id": 52746800, "comment_id": 92418334, "body": "@slava no. Prime excludes 1."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1539197288, "post_id": 52746800, "comment_id": 92418358, "body": "The text &quot;extreme cases&quot; is a bit deceiving. It fails on many ordinary values, like 35 or 91."}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 1, "creation_date": 1539197409, "post_id": 52746800, "comment_id": 92418418, "body": "Also, <code>13</code> is not a perfect prime, but your logic in <code>is_perfect_prime</code> would let it through because <code>1+3 &lt; 10</code>. Are you really claiming that your code works correctly on all numbers less than 20328307?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539197418, "post_id": 52746800, "comment_id": 92418423, "body": "@Fran&#231;oisAndrieux loop will end with false value when i becomes big enough"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1539197432, "post_id": 52746800, "comment_id": 92418434, "body": "When you have known failure cases, you have a perfect opportunity to break out the debugging software that came with your development environment and step through the code to see where the program does something you don&#39;t expect. The unexpected is quite often a bug, and when it isn&#39;t, it&#39;s a misunderstanding of how the algorithm is supposed to work. Either needs fixing."}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 1, "creation_date": 1539197487, "post_id": 52746800, "comment_id": 92418460, "body": "I&#39;m voting to close this question as off-topic because this code is rubbish from start to finish."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539197597, "post_id": 52746800, "comment_id": 92418512, "body": "@Fran&#231;oisAndrieux I do not follow why there would be UB here?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1539197602, "post_id": 52746800, "comment_id": 92418514, "body": "I&#39;m not joining in on that close reason because sometimes the right answer to a question is  &quot;You can&#39;t beat this code into behaving the way you want it to in any reasonable amount of time. Junk it and start over.&quot; It&#39;s an unsatisfying answer, but it is an answer."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539197751, "post_id": 52746800, "comment_id": 92418580, "body": "@Slava I misunderstood the loop."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1539197780, "post_id": 52746800, "comment_id": 92418592, "body": "Consider testing <code>is_prime</code> and <code>sum_of_digits</code> separately. Make sure they are both working correctly with a wide variety of inputs before trying to use them together."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1539198823, "post_id": 52746800, "comment_id": 92419074, "body": "It also fails for 15, you know."}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 1561663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5702679472b548e01cd2d6738c42d82?s=128&d=identicon&r=PG", "display_name": "joelw", "link": "https://stackoverflow.com/users/1561663/joelw"}, "edited": false, "score": 0, "creation_date": 1539201159, "post_id": 52747112, "comment_id": 92420110, "body": "The proposed solution is incorrect. For an input of 13, this will return true. The if statement should be changed to <code>if (n&gt;= 10) return is_perfect_prime(sum);</code>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 365, "user_id": 1561663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5702679472b548e01cd2d6738c42d82?s=128&d=identicon&r=PG", "display_name": "joelw", "link": "https://stackoverflow.com/users/1561663/joelw"}, "edited": false, "score": 0, "creation_date": 1539210027, "post_id": 52747112, "comment_id": 92423464, "body": "@joelw I see that it should be n instead of sum. But your condition is not correct either. Fixed, thanks"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 1, "last_activity_date": 1539210263, "last_edit_date": 1539210263, "creation_date": 1539198118, "answer_id": 52747112, "question_id": 52746800, "link": "https://stackoverflow.com/questions/52746800/check-if-number-is-perfect-prime-recursively-c/52747112#52747112", "title": "Check if number is perfect prime recursively c++", "body": "<p>First of all your for loop is incorrect, it should be instead:</p>\n\n<pre><code> for (int i = 3; i * i &lt;= n; i += 2) {\n     if (n % i == 0) return false;\n }\n</code></pre>\n\n<p>otherwise you return true almost on every non even number. Second you ignore result of recursive call, possible solution is:</p>\n\n<pre><code>bool is_perfect_prime(int n) {\n    if ( n &gt;= 10 and not is_perfect_prime(sum_of_digits(n)) )\n        return false;\n    return is_prime(n); //cas base\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 10015567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Im5jP.png?s=128&g=1", "display_name": "&#193;lvaro", "link": "https://stackoverflow.com/users/10015567/%c3%81lvaro"}, "is_accepted": false, "score": 1, "last_activity_date": 1539198416, "creation_date": 1539198416, "answer_id": 52747184, "question_id": 52746800, "link": "https://stackoverflow.com/questions/52746800/check-if-number-is-perfect-prime-recursively-c/52747184#52747184", "title": "Check if number is perfect prime recursively c++", "body": "<p>Finally I've got it to work. The problem was in the is_prime() for loop and in the recursive case of is_perfect_prime(). This is what I've come up  with:</p>\n\n<pre><code>bool is_prime(int n) {\n    if (n == 0 or n == 1) return false;\n    if (n == 2) return true;\n    if (n % 2 == 0) return false;\n    for (int i = 3; i * i &lt;= n; i += 2) {\n        if (n % i == 0) return false;\n    }\n    return true;\n}\n\nint sum_of_digits(int n) {\n    int sum = 0;\n    while (n &gt; 0) {\n        sum += n % 10;\n        n /= 10;\n    }\n    return sum;\n}\n\nbool is_perfect_prime(int n) {\n    if (n &lt; 10) return is_prime(n);\n    if (! is_prime(n)) return false;\n    return is_perfect_prime(sum_of_digits(n));\n}\n</code></pre>\n\n<p>Thanks for your answers.</p>\n"}], "owner": {"reputation": 143, "user_id": 10015567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Im5jP.png?s=128&g=1", "display_name": "&#193;lvaro", "link": "https://stackoverflow.com/users/10015567/%c3%81lvaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 52747112, "answer_count": 2, "score": -2, "last_activity_date": 1539210263, "creation_date": 1539196873, "last_edit_date": 1539197053, "question_id": 52746800, "link": "https://stackoverflow.com/questions/52746800/check-if-number-is-perfect-prime-recursively-c", "title": "Check if number is perfect prime recursively c++", "body": "<p>I've been assigned to write a program that checks if a number is perfect prime or not (the sum of its digits is prime, the sum of the sum of its digits is prime...). I've stumbled upon two extreme cases that break my program:</p>\n\n<pre><code>INPUT: 20328307  OUTPUT: true (expected false)\nINPUT: 587899597 OUTPUT: true (expected false)\n</code></pre>\n\n<p>The code: </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\nbool is_prime(int n) {\n    if (n == 0 or n == 1) return false;\n    if (n == 2) return true;\n    if (n % 2 == 0) return false;\n    for (int i = 3; i * i == n; i += 2) {\n        if (n % i == 0) return false;\n    }\n    return true;\n}\n\nint sum_of_digits(int n) {\n    int sum = 0;\n    while (n &gt; 0) {\n        sum += n % 10;\n        n /= 10;\n    }\n    return sum;\n}\n\nbool is_perfect_prime(int n) {\n    if (sum_of_digits(n) &gt;= 10) is_perfect_prime(sum_of_digits(n)); //cas recursiu\n    return is_prime(n); //cas base\n\n}\n\nint main() {\n    int n;\n    while (cin &gt;&gt; n) cout &lt;&lt; (is_perfect_prime(n) ? \"true\" : \"false\") &lt;&lt; endl;\n}\n</code></pre>\n\n<p>I can't see where this script fails for these two values, and why it doesn't fail for smaller numbers.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1539195858, "post_id": 52746560, "comment_id": 92417696, "body": "That&#39;s a <a href=\"https://en.cppreference.com/w/cpp/language/template_parameters#Template_template_parameter\" rel=\"nofollow noreferrer\">template template parameter</a>. It requires a template instead of a type as argument."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539196103, "post_id": 52746560, "comment_id": 92417808, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 That question has nothing to do with template template parameters. It&#39;s one of the cases for <code>typename</code> that isn&#39;t mentioned in the answers."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539196189, "post_id": 52746560, "comment_id": 92417847, "body": "@Fran&#231;oisAndrieux Okeh sorry, I was to fast here. Sounded so at a 1st glance."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539196437, "post_id": 52746560, "comment_id": 92417961, "body": "@newandlost What&#39;s the problem you actually want to solve doing this? It sounds somehow weird, and I have doubts if there are better designs to achieve what you&#39;re actually want to do. XY problem?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539196575, "post_id": 52746560, "comment_id": 92418028, "body": "do you need to know the type of the container? Why not just have the type of the iterator as template parameter?"}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539263025, "post_id": 52746560, "comment_id": 92444527, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 I have a class, that has e.g. int A, int B, and a stl container like vector&lt;int&gt; C_to_Z as member variable. In the end I want to create a custom iterator, that goes A,B and  then uses the iterator of the vector to go C to Z."}], "answers": [{"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1539196700, "post_id": 52746721, "comment_id": 92418088, "body": "Since C++17 <code>template &lt;typename&gt; class</code> can actually match <code>std::vector</code> (because the second template parameter has a default value)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1539196748, "post_id": 52746721, "comment_id": 92418104, "body": "@HolyBlackCat that&#39;s something I am not aware of! Do you have a link (or a name of the feature I can search for)?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1539197126, "post_id": 52746721, "comment_id": 92418277, "body": "Here&#39;s a revelant <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#150\" rel=\"nofollow noreferrer\">defect report</a>. And <a href=\"https://en.cppreference.com/w/cpp/language/template_parameters\" rel=\"nofollow noreferrer\">this page</a> has an example demonstrating this change (Ctrl+F <code>CWG 150</code>)."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539197672, "post_id": 52746721, "comment_id": 92418548, "body": "only the <code>...</code> in <code>&lt;class...&gt;</code> are for a pack the others are just &quot;<code>etc...</code>&quot; right?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539197821, "post_id": 52746721, "comment_id": 92418607, "body": "@user463035818 Yup."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539198045, "post_id": 52746721, "comment_id": 92418702, "body": "well actually there was a hidden &quot;can you please make it more clear&quot; in my comment ;). I tried to make it less ambiguous. Hope i didnt put anything wrong, just roll back if you dont like it"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1539198237, "post_id": 52746721, "comment_id": 92418782, "body": "@HolyBlackCat much appreciated!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539198398, "post_id": 52746721, "comment_id": 92418858, "body": "was sure if the correct &quot;old&quot; syntax was <code>&lt;template &lt;class&gt; typename T&gt;</code> or <code>&lt;template &lt;class&gt; class T&gt;</code>. Imho this whole issue about class vs typename is a bit ridiculous, would be interesting to know what was the original rationale"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539198596, "post_id": 52746721, "comment_id": 92418947, "body": "@user463035818 that&#39;s why I put <code>...</code> - to make it cut both ways - but I realize it could be too confusing. I think, it&#39;s better this way. And yes, I&#39;d be curious to know the rationale too. I&#39;d ask a question, but I am afraid it would be downvoted to minus infinity."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539200333, "post_id": 52746721, "comment_id": 92419743, "body": "I was going to write a question, but then I found <a href=\"https://stackoverflow.com/a/213135/4117728\">this</a> which has half of the answer. For the other half my guess is that template template parameters came after the comitee decided to use <code>typename</code> rather than <code>class</code> for clarity (and keep allowing <code>class</code> for backward compatibility for normal tempalte parameters) and saw no obvious reason to allow <code>class</code> also there"}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1539692902, "post_id": 52746721, "comment_id": 92587009, "body": "My compiler only accepts <code>template &lt;template &lt;class&gt; class T&gt; struct Foo {};</code> For <code>template &lt;template &lt;class&gt; typename T&gt; struct Foo {}</code>; it says &quot;invalid use of template-name&quot;"}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1539692978, "post_id": 52746721, "comment_id": 92587052, "body": "And what is the correct syntax for initializing <code>ClassHoldingAnIteratorToAStandardContainer</code> ? I got a little bit confused."}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1539693553, "post_id": 52746721, "comment_id": 92587414, "body": "<code>ClassHoldingAnIteratorToAStandardContainer&lt;int,vector&lt;int,st&zwnj;&#8203;d::allocator&lt;int&gt;&gt;&gt; holding_iterator_to_vec;</code> dos not work..."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1539198284, "last_edit_date": 1539198284, "creation_date": 1539196535, "answer_id": 52746721, "question_id": 52746560, "link": "https://stackoverflow.com/questions/52746560/template-class-with-iterator-to-a-stl-container/52746721#52746721", "title": "Template class with iterator to a STL container", "body": "<p><code>template &lt;typename&gt; class</code> is the same as <code>template &lt;class&gt; class</code>. Originally, when templates were introduced, they allowed two equivalent forms:</p>\n\n<pre><code>template&lt;class T&gt; struct Foo {};\n// or\ntemplate&lt;typename T&gt; struct Foo {};\n</code></pre>\n\n<p>Do not ask me why! However, the same was not true for template template parameters:</p>\n\n<pre><code>template &lt;template &lt;class&gt; typename T&gt; struct Foo {};\n</code></pre>\n\n<p>was the only allowed syntax. Apparently, people were unhappy about it, so the syntax was relaxed.</p>\n\n<p>As for your second question, <code>std::vector</code> takes <strong>at least</strong> two template arguments, data type and allocator. This is why a single argument template doesn't cut it before C++17. After C++17, it would work.</p>\n\n<p>To make it universal, use</p>\n\n<pre><code>template&lt;template &lt;class...&gt; class Container&gt; struct Foo{};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1539695585, "post_id": 52747980, "comment_id": 92588634, "body": "Thanks, that sounds good. My usecase is the following: I hvae a Container that could in principle be e.g. a std::vector. But always when an element is insterted a want that this new element is registerd also somewhere else. So I created a custom ElementContainer, with a insert function that inserts a element into the vector and additionally executes the function. But I still want to be able to iterate over ElementContainer as I could do over std::vector. That is why the ElementContainer needs an iterator that basically wraps the iterator of vector."}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1539695737, "post_id": 52747980, "comment_id": 92588744, "body": "How could I incorporate <code>Element *  operator-&gt;() const;</code> in your solution?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1539710000, "post_id": 52747980, "comment_id": 92597326, "body": "@newandlost I updated the example to include an <code>operator*()const</code> , <code>operator-&gt;()const</code> is similar"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 0, "last_activity_date": 1539709935, "last_edit_date": 1539709935, "creation_date": 1539201906, "answer_id": 52747980, "question_id": 52746560, "link": "https://stackoverflow.com/questions/52746560/template-class-with-iterator-to-a-stl-container/52747980#52747980", "title": "Template class with iterator to a STL container", "body": "<p>Unless you really need to know the type of the container, I would strongly recommend to keep your <code>ClassHoldingAnIteratorToAStandardContainer</code> independent of the concrete container type. If you just need the iterator, this is simpler and sufficient:</p>\n\n<pre><code>template&lt;typename iterator&gt;\nstruct iterator_wrapper {\n    iterator iter;    \n};\n</code></pre>\n\n<p>Thats the minimum you need to have an iterator as member :). </p>\n\n<p>I dont really know what you want to use the iterator for, so just for the sake of an example lets add methods that actually use the iterator....</p>\n\n<pre><code>#include &lt;iterator&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename iterator&gt;\nstruct iterator_wrapper {\n    using value_type = typename std::iterator_traits&lt;iterator&gt;::value_type;\n    iterator iter;    \n    bool operator!=(const iterator&amp; other) { return iter != other;}\n    iterator_wrapper&amp; operator++(){ \n        ++iter;\n        return *this;\n    }\n    const value_type&amp; operator*() { return *iter; }\n};\n\ntemplate &lt;typename iterator&gt;\niterator_wrapper&lt;iterator&gt; wrap_iterator(iterator it) { \n    return {it}; \n}\n\nint main() {\n    std::vector&lt;int&gt; vec{1,2,3};\n    auto it = wrap_iterator(vec.begin());    \n    for (;it != vec.end();++it) std::cout &lt;&lt; *it;       \n</code></pre>\n\n<p>}</p>\n\n<p>Also there is a problem in your code. </p>\n\n<pre><code>typename StdLibContainer&lt;Element*&gt;::iterator\n</code></pre>\n\n<p>is for containers of pointers while in main you have <code>int</code>s. If you want to infer the iterator type from the container type then you can do it for example like this: </p>\n\n<pre><code>template &lt;typename container, \n          typename iterator = typename container::iterator&gt;\niterator_wrapper&lt;iterator&gt; wrap_begin(container&amp; c) { \n    return {c.begin()}; \n}\n</code></pre>\n\n<p>which makes creating an <code>iterator_wrapper</code> as simple as</p>\n\n<pre><code>auto x = wrap_begin(vec);\n</code></pre>\n\n<p>Note that this answer applies to C++11, in newer standards there are deduction guides that make such <code>make_x</code> methods more or less superfluous afaik.</p>\n"}], "owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539709935, "creation_date": 1539195811, "question_id": 52746560, "link": "https://stackoverflow.com/questions/52746560/template-class-with-iterator-to-a-stl-container", "title": "Template class with iterator to a STL container", "body": "<p>I want to create a template class which has an iterator of a STL container as  a member. That is how far I got:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\ntemplate&lt;typename Element, template &lt;class&gt; class StdLibContainer&gt;\nstruct ClassHoldingAnIteratorToAStandardContainer\n{\n    ClassHoldingAnIteratorToAStandardContainer(){}\n    typename StdLibContainer&lt;Element*&gt;::iterator std_lib_iterator;\n};\n\n\nint main()\n{\n    vector&lt;int&gt; vec{1,2,3};\n    ClassHoldingAnIteratorToAStandardContainer&lt;int,vector&lt;int&gt;&gt; holding_iterator_to_vec;\n    //DOES NOT WORK, compiler says: expected a class template, got \u2018std::vector&lt;int&gt;\u2019\n    return 0;\n}\n</code></pre>\n\n<ol>\n<li><p>Could you explain the syntax <code>template &lt;typename&gt; class StdLibContainer</code>?\nI found it somewhere on stackoverflow. BUt I don't understand it. </p></li>\n<li><p>How can I create an instance of <code>ClassHoldingAnIteratorToAStandardContainer</code> ? All my attempts failed so far. The compiler always gives the error message: `expected a class template, got \u2018std::vector\u2019</p></li>\n</ol>\n\n<p>In the above example i want to assign <code>holding_iterator_to_vec</code> <code>vec.begin()</code>.</p>\n"}, {"tags": ["c++", "linux", "heap-memory", "profiler", "massif"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1539196365, "post_id": 52746370, "comment_id": 92417927, "body": "You can use VS memory profiler and create heap state snapshots after hitting a breakpoint."}, {"owner": {"reputation": 317, "user_id": 1015013, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9e6b3bcfe07fcf9aefe629a96ede83ff?s=128&d=identicon&r=PG", "display_name": "nndhawan", "link": "https://stackoverflow.com/users/1015013/nndhawan"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1539203587, "post_id": 52746370, "comment_id": 92421201, "body": "sorry need linux solution but your response prompted a google search from which may yield a solution to see tracking the heap as the program is running, come see my answer..thanks for the prod"}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 1015013, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9e6b3bcfe07fcf9aefe629a96ede83ff?s=128&d=identicon&r=PG", "display_name": "nndhawan", "link": "https://stackoverflow.com/users/1015013/nndhawan"}, "is_accepted": false, "score": 0, "last_activity_date": 1539203730, "creation_date": 1539203730, "answer_id": 52748404, "question_id": 52746370, "link": "https://stackoverflow.com/questions/52746370/how-to-see-valgrind-massif-output-or-other-heap-profiler-as-program-executes/52748404#52748404", "title": "How to see Valgrind Massif output (or other heap profiler) as program executes?", "body": "<p>Apparently there is a tool in Linux that can give real time data, I haven't tried it out but found it after additional google searching. Its called heaptrack and apparently it can track the heap while the program is running: </p>\n\n<p><a href=\"http://milianw.de/blog/heaptrack-a-heap-memory-profiler-for-linux\" rel=\"nofollow noreferrer\">http://milianw.de/blog/heaptrack-a-heap-memory-profiler-for-linux</a></p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 5977475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce53fe4914de940397571e3542ff0c1a?s=128&d=identicon&r=PG", "display_name": "Woochan Lee", "link": "https://stackoverflow.com/users/5977475/woochan-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1577355854, "creation_date": 1577355854, "answer_id": 59487033, "question_id": 52746370, "link": "https://stackoverflow.com/questions/52746370/how-to-see-valgrind-massif-output-or-other-heap-profiler-as-program-executes/59487033#59487033", "title": "How to see Valgrind Massif output (or other heap profiler) as program executes?", "body": "<p>Write sleep(0.5) in the code where you want to see the memory heap usage.\nthen execute application with heaptrack ./app \nand then open the result file with heaptrack_gui app.heaptrack.gz</p>\n\n<p>go to consumed tap and check the memory usage by time line.</p>\n"}], "owner": {"reputation": 317, "user_id": 1015013, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9e6b3bcfe07fcf9aefe629a96ede83ff?s=128&d=identicon&r=PG", "display_name": "nndhawan", "link": "https://stackoverflow.com/users/1015013/nndhawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1577355854, "creation_date": 1539195021, "last_edit_date": 1539203372, "question_id": 52746370, "link": "https://stackoverflow.com/questions/52746370/how-to-see-valgrind-massif-output-or-other-heap-profiler-as-program-executes", "title": "How to see Valgrind Massif output (or other heap profiler) as program executes?", "body": "<p>When using Valgrind Massif in LINUX, I tried to see the massif.out.pid file in real time but it produces this file after Massif finished executing. I want to place breakpoints in the code to watch the effect certain instructions have on the heap as there are only a few points of interest. I know I could rewrite some of the code to manage this but this means influencing the subject code in a way that won't be the final result as well that their is numerous programs I want to do this on. Is there a way to watch points in the code while watching the profiler profile the heap at the same time, so I can distinguish between points of execution?</p>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 1, "creation_date": 1539238171, "post_id": 52746328, "comment_id": 92430125, "body": "<code>qmlRegisterType</code> registers an Item which could be created in QML, no further action is required. What is <code>REGISTER_QT_META_TYPE</code> here? <code>const</code> is a C++ keyword and make no sense in QML. To communicate with QML you have <code>Q_INVOKABLE</code> macro and <code>Q_PROPERTY</code>. Use one of them to access data. You can specify <code>CONSTANT</code> attribute for <code>Q_PROPERTY</code> to make it constant."}, {"owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1539258967, "post_id": 52746328, "comment_id": 92441986, "body": "Thanks. Looks like <code>REGISTER_QT_META_TYPE</code> is a macro from a former colleague for <code>qRegisterMetaType&lt;T&gt;(#T)</code>. I\u2019ll reassess and edit the post to reflect a saner question. Thanks."}], "owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539263001, "creation_date": 1539194874, "last_edit_date": 1539263001, "question_id": 52746328, "link": "https://stackoverflow.com/questions/52746328/giving-qml-a-const-pointer-to-a-const-object-rather-than-a-non-const-object", "title": "Giving QML a const pointer to a const object rather than a non-const object?", "body": "<p>I have a project using QML in which QML has has an object of type <code>Foo</code>. I want to change it so that QML has an object of type <code>const Foo</code>. How do I do this? I have QML calling a C++ function that was working and took a <code>Foo*</code>. I changed it to take a <code>const Foo*</code> (as it logically should), but I get a runtime error on the QML line that calls it, saying \"<code>Error: Unknown method parameter type: const Foo*</code>\".</p>\n\n<p>I tried changing</p>\n\n<pre><code>qmlRegisterType&lt;Foo&gt;(\"FooLib\", 1, 0, \"Foo\");\n</code></pre>\n\n<p>to</p>\n\n<pre><code>qmlRegisterType&lt;const Foo&gt;(\"FooLib\", 1, 0, \"Foo\");\n</code></pre>\n\n<p>but to no avail. I then tried doing</p>\n\n<pre><code>qmlRegisterUncreatableType&lt;Foo&gt;(\"FooLib\", 1, 0, \"Foo\", \"Can't create one\");\n</code></pre>\n\n<p>and replacing my QML <code>FooLib.Foo {}</code> with a call to a factory method I created that returns a <code>Foo*</code>. Same runtime error.</p>\n\n<p>I tried making my factory return a <code>const Foo*</code>. That made progress. That makes it not crash. However, I get a runtime error in QML like \"<code>TypeError: Cannot read property 'bar' of undefined</code>\" where it's trying to access a <code>Q_PROPERTY</code> of <code>Foo</code>. The property only has a <code>READ</code> and that member function is <code>const</code>. The error about <code>undefined</code> makes me think maybe QML doesn't know that a <code>const Foo</code> is the same as a <code>Foo</code> when it comes to <code>const</code> <code>Q_PROPERTY</code>s, or that it's getting <code>Foo*</code>s from other functions and doesn't know that those can be converted to <code>const Foo*</code>s.</p>\n\n<p>Is that right? Is QML unable to automatically convert <code>Foo*</code> to <code>const Foo*</code>? How am I supposed to write const-correct code? </p>\n"}, {"tags": ["c++", "metaprogramming", "c++17", "boost-mpl"], "answers": [{"comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1539198976, "post_id": 52746744, "comment_id": 92419129, "body": "Indeed, that&#39;s probably what I need, thanks a lot, didn&#39;t see this new library."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 3, "last_activity_date": 1539196597, "creation_date": 1539196597, "answer_id": 52746744, "question_id": 52746159, "link": "https://stackoverflow.com/questions/52746159/replacing-boost-mpl-containers-with-c17-features/52746744#52746744", "title": "Replacing Boost MPL containers with C++17 features", "body": "<p>Probably the easiest transition would be to swap Boost.MPL for <a href=\"https://www.boost.org/doc/libs/develop/libs/mp11/doc/html/mp11.html\" rel=\"nofollow noreferrer\">Boost.MP11</a>:</p>\n\n<pre><code>using Types = mp_list&lt;...&gt;;\n\n\ntemplate &lt;typename L&gt;\nvoid process() {\n    if constexpr (!mp_empty&lt;L&gt;) {\n        process&lt;mp_pop_front&lt;L&gt;&gt;();   \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 52746744, "answer_count": 1, "score": 0, "last_activity_date": 1539196602, "creation_date": 1539194119, "last_edit_date": 1539196602, "question_id": 52746159, "link": "https://stackoverflow.com/questions/52746159/replacing-boost-mpl-containers-with-c17-features", "title": "Replacing Boost MPL containers with C++17 features", "body": "<p>I have some old code based on MPL containers, using <code>enable_if</code> to to activate some dispatch like this:</p>\n\n<pre><code>typedef boost::mpl::vector&lt;std::int16_t, std::int32_t, int64_t, float, double, std::complex&lt;float&gt;, std::complex&lt;double&gt; &gt; Types;\n\ntemplate &lt;typename Vector&gt;\ntypename boost::enable_if&lt;typename boost::mpl::empty&lt;Vector&gt;::type, void&gt;::type void process(/*args*/)\n{\n}\n\ntemplate &lt;typename Vector&gt;\ntypename boost::disable_if&lt;typename boost::mpl::empty&lt;Vector&gt;::type, void&gt;::type void process(/*args*/)\n{\n    process&lt;typename boost::mpl::pop_front&lt;Vector&gt;::type&gt;();\n}\n\nvoid outside()\n{\n    process&lt;Types&gt;();\n}\n</code></pre>\n\n<p>So with C++17, I can use constexpr, but I still that list of types that I have to pass in <code>outside</code>. Is there a proper way of declaring the container type so that I can use variadic templates?</p>\n"}, {"tags": ["c++", "operator-overloading", "std"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1539194138, "post_id": 52746137, "comment_id": 92416921, "body": "It depends on what you want <code>operator&lt;&lt;</code> to mean for <code>Ter</code>. In this case, it sure looks like it wants to be an <code>std::ostream</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539194175, "post_id": 52746137, "comment_id": 92416938, "body": "Typically, when you overload an operator, you should do what it&#39;s built in counterpart does.  In C++ <code>&gt;&gt;</code> and <code>&lt;&lt;</code> is either bitwise operation or streaming.  If you want to concatenate something then <code>+</code> and <code>+=</code> are used."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539194235, "post_id": 52746137, "comment_id": 92416968, "body": "Why should one use anything else than the interface?"}, {"owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "edited": false, "score": 0, "creation_date": 1539194497, "post_id": 52746137, "comment_id": 92417062, "body": "Thank you NathanOlivier, this is right. I understand for the concatenation operators, however, concatenation is a WAY of solving the problem, and not the solution we are searching for. We are actually looking to know why nobody replace multiple calls of a method with a stream operator that would call it in a single manner"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539194597, "post_id": 52746137, "comment_id": 92417104, "body": "@NathanOliver Reopened. But well the main principles of operator overloading are at least related."}, {"owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539194668, "post_id": 52746137, "comment_id": 92417143, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Indeed they are, but the example of &quot;operator&lt;&lt;&quot; is still written with an ostream as left operand. I dare you to find somewhere on the internet where an exemple of overload of operator&lt;&lt; exists with a left operand of T type that is not ostream&amp;"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539194772, "post_id": 52746137, "comment_id": 92417202, "body": "@stalker2106 Concatenation might be better expressed using an overload of <code>operator+()</code>, though <code>std::string</code> concatenation might be easily achieved as a combination of  overloading <code>operator&lt;&lt;()</code> and using <code>std::ostringstream</code>."}, {"owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539194997, "post_id": 52746137, "comment_id": 92417308, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6  I don&#39;t want to concatenate, but call write two times internally with the strings i supplied in the stream operation. Am I right ?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 4, "creation_date": 1539195022, "post_id": 52746137, "comment_id": 92417321, "body": "@stalker2106: &quot;<i>I dare you to find somewhere on the internet where an exemple of overload of operator&lt;&lt; exists with a left operand of T type that is not ostream&amp;</i>&quot; <a href=\"http://boost-spirit.com/home/\" rel=\"nofollow noreferrer\">Boost.Spirit</a>. Also <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/serialization/doc/index.html\" rel=\"nofollow noreferrer\">Boost.Serialization</a>; archives <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/serialization/doc/rationale.html#archives\" rel=\"nofollow noreferrer\">are not streams</a>. Also Boost&#39;s dynamic bitset type."}, {"owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1539195324, "post_id": 52746137, "comment_id": 92417460, "body": "@Nicol Bolas On every link you supplied, when i am looking for &quot;&lt;&lt;&quot; in my browser search, nothing shows! Where can I find an example of an overload on these pages ?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1539195399, "post_id": 52746137, "comment_id": 92417494, "body": "It&#39;s difficult to read this as a clear, specific question.  <i>&quot;Why do people always...&quot;</i>  They don&#39;t always.  <i>&quot;There is nowhere to find...&quot;</i>  There is.  <i>&quot;Does that mean  my example is a rare case...&quot;</i>  No, it doesn&#39;t mean that."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1539195409, "post_id": 52746137, "comment_id": 92417496, "body": "@stalker2106: I didn&#39;t link you to code; I linked you to <i>libraries</i>. Feel free to find the code within those libraries yourself."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1539195822, "post_id": 52746137, "comment_id": 92417682, "body": "Can you clarify what kind of answer you&#39;re looking for?  The new question in your title is answered in the question itself.  <i>You</i> provide an example.  Are you looking for links to popular libraries?  Or are you asking if your code is wrong?"}, {"owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1539196306, "post_id": 52746137, "comment_id": 92417909, "body": "@Drew Dormann I am actually CTRL+F-ing Boost sources as suggested by Nicol Bolas an I managed to find examples which is nice and partially answers my question telling me this is &#39;valid&#39;. I also edited the question to be more precise."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539196757, "post_id": 52746137, "comment_id": 92418108, "body": "your question is rather vague. If you have working code and you are not sure if it is a good way to write it you may have more luck on <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "edited": false, "score": 0, "creation_date": 1539197310, "post_id": 52746847, "comment_id": 92418370, "body": "This is a good answer thank you. Yeah well, I&#39;m just intrigued why (for example in the link i supplied) all the operators are overloaded for a T or X type, and operator&lt;&lt; is always with an ostream. and i find your answer very relevant because you show a use case, and with + operator anybody understands x + y, but people wont for a &lt;&lt; b. thank you."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "edited": false, "score": 0, "creation_date": 1539198288, "post_id": 52746847, "comment_id": 92418803, "body": "@stalker Thats because typically you do care about the right hand side and do want to supply an overload for <code>std::ostream</code>s <code>operator&lt;&lt;</code>"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": true, "score": 1, "last_activity_date": 1539197038, "creation_date": 1539197038, "answer_id": 52746847, "question_id": 52746137, "link": "https://stackoverflow.com/questions/52746137/does-my-overload-of-operator-stream-insertion-with-a-left-operand-not-being/52746847#52746847", "title": "Does my overload of operator&lt;&lt; (stream insertion) with a left operand not being an ostream is valid", "body": "<blockquote>\n  <p>I am legitimately intrigued why both the topic you linked, and\n  <a href=\"https://arne-mertz.de/2015/01/operator-overloading-common-practice/\" rel=\"nofollow noreferrer\">https://arne-mertz.de/2015/01/operator-overloading-common-practice/</a> or\n  many others never talk about a left operand from another type than\n  ostream.</p>\n</blockquote>\n\n<p>Because it does not really matter. What works for <code>std::ostream</code> works similar for other types. Sorry, but its a bit like getting an example of overloading <code>operator+</code> for a type <code>Foo</code> and then complaining that you never get an example of how to overload it for a <code>Bar</code>. If you want your type to offer a <code>operator&lt;&lt;</code> then yes, you implemented it in way that works.</p>\n\n<p>Your code seems to be correct. Whether it does what you want, only you can decide. </p>\n"}], "owner": {"reputation": 118, "user_id": 3005141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UQ9Tq.png?s=128&g=1", "display_name": "stalker2106", "link": "https://stackoverflow.com/users/3005141/stalker2106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1539204249, "accepted_answer_id": 52746847, "answer_count": 1, "score": -6, "last_activity_date": 1539197038, "creation_date": 1539194031, "last_edit_date": 1539196243, "question_id": 52746137, "link": "https://stackoverflow.com/questions/52746137/does-my-overload-of-operator-stream-insertion-with-a-left-operand-not-being", "closed_reason": "Needs details or clarity", "title": "Does my overload of operator&lt;&lt; (stream insertion) with a left operand not being an ostream is valid", "body": "<p>Consider the context, where i want to write to another file descriptor than stdout. Here, My \"write\" method prints to stdout, but only for understanding.</p>\n\n<p>THIS IS THE MAIN PROBLEM I AM TRYING TO SOLVE:</p>\n\n<p>I have a write(char*) method, i want to convert to c++ style stream through operator&lt;&lt;, to be able to write in C++, obfuscating multiple explicit calls of write, allowing to write in a single line of code without having to concatenate or any other solution.</p>\n\n<p>PERIOD.</p>\n\n<p>Though, on internet, there is nowhere to find an example that overloads operator&lt;&lt; with anything else than ostream on left operand. does that mean, my following example (which compiles! i tested it on a codepen-like website) is a rare case of working overload without ostream, or did i misconcepted the whole thing and \"Ter\" should be an ostream by inheritance ?</p>\n\n<p>EDIT: How can this be a duplicate ? I am legitimately intrigued why both the topic you linked, and <a href=\"https://arne-mertz.de/2015/01/operator-overloading-common-practice/\" rel=\"nofollow noreferrer\">https://arne-mertz.de/2015/01/operator-overloading-common-practice/</a> or many others never talk about a left operand from another type than ostream.</p>\n\n<p>EDIT2: I am having trouble to be precise on my question. Is the following code a good practice, if not, what should i do to solve the problem i braced with capital letters. Thank you for your answers</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Ter {\n    void write(const std::string &amp;str) { std::cout &lt;&lt; str; }; //Here we should do something else in our context\n    friend Ter &amp;operator&lt;&lt;(Ter &amp;a, std::string &amp;b);\n};\n\n\nTer &amp;operator&lt;&lt;(Ter &amp;a, const std::string &amp;b)\n{\n   a.write(b);\n   return (a);\n}\n\n\nint main()\n{\n    Ter toto;\n    toto &lt;&lt; \"b\" &lt;&lt; \"c\";\n}\n</code></pre>\n"}, {"tags": ["c++", "seal"], "answers": [{"tags": [], "owner": {"reputation": 786, "user_id": 10212923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b200f1a25648a58376cc7d3bd1c926b?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Laine", "link": "https://stackoverflow.com/users/10212923/kim-laine"}, "is_accepted": true, "score": 1, "last_activity_date": 1539838684, "creation_date": 1539838684, "answer_id": 52867264, "question_id": 52746042, "link": "https://stackoverflow.com/questions/52746042/reading-the-remaining-noise-budget-of-ciphertexts-without-the-secret-key/52867264#52867264", "title": "Reading the remaining noise budget of Ciphertexts without the Secret Key", "body": "<p>The <code>Simulation</code> class is meant to estimate the noise budget consumption in various operations so that those operations don't actually have to be executed on real data. Moreover, it uses heuristic upper bounds estimate for the noise consumption, i.e. most likely it overestimates the noise consumption and this effect becomes more pronounced when the computation is more complicated, sometimes resulting in huge overestimates of the noise consumption. Of course, the idea is that the computation is guaranteed to work if it works according to the simulator. A typical use of <code>Simulation</code> would be through the <code>ChooserPoly</code> (and related) classes; this is demonstrated in one of the examples in <code>SEALExamples/main.cpp</code> for SEAL versions &lt; 3.0.</p>\n\n<p>It is impossible to know or estimate the noise in a ciphertext without knowing how that ciphertext was produced. So if I give you a ciphertext without telling you anything else (except encryption parameter), then you should not be able to know anything about the noise budget unless you know the secret key. I agree that in some cases it could be important for someone to know right away if a ciphertext is still valid for further computations, but it's not possible without some external mechanism.</p>\n"}], "owner": {"reputation": 488, "user_id": 4418333, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5b73935bb834bf63d997ad6c3e1d6207?s=128&d=identicon&r=PG&f=1", "display_name": "TalG", "link": "https://stackoverflow.com/users/4418333/talg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 52867264, "answer_count": 1, "score": 0, "last_activity_date": 1539838684, "creation_date": 1539193694, "last_edit_date": 1539194098, "question_id": 52746042, "link": "https://stackoverflow.com/questions/52746042/reading-the-remaining-noise-budget-of-ciphertexts-without-the-secret-key", "title": "Reading the remaining noise budget of Ciphertexts without the Secret Key", "body": "<p>I use SEAL 2.3.1 and this is my parameter setting:</p>\n\n<pre><code>seal::EncryptionParameters parms;\nparms.set_poly_modulus(\"1x^2048 + 1\"); // n = 2048\nparms.set_coeff_modulus(coeff_modulus_128(2048)); // q = 54-bit prime\nparms.set_plain_modulus(1 &lt;&lt; 8); // t = 256\n\nseal::SEALContext context(parms);\n</code></pre>\n\n<p>And some <code>Ciphertext encrypted1;</code> holding the number 5. The manual say that one can use the seal::Simulator class for reading the noise budget without the secret key. The only thing that I've found was this in the <code>simulator.h</code> file.</p>\n\n<pre><code>/**\nCreates a simulation of a ciphertext encrypted with the specified encryption \nparameters and given invariant noise budget. The given noise budget must be \nat least zero, and at most the significant bit count of the coefficient \nmodulus minus two.\n\n@param[in] parms The encryption parameters\n@param[in] noise_budget The invariant noise budget of the created ciphertext\n@param[in] ciphertext_size The size of the created ciphertext\n@throws std::invalid_argument if ciphertext_size is less than 2\n@throws std::invalid_argument if noise_budget is not in the valid range\n*/\nSimulation(const EncryptionParameters &amp;parms, int ciphertext_size, \n            int noise_budget);\n</code></pre>\n\n<p>I can set it with some other <code>Ciphertext encrypted2</code>:</p>\n\n<pre><code>seal::Simulation(parms, encrypted2.size(), (context.total_coeff_modulus().significant_bit_count() - log2(context.poly_modulus().coeff_count() - 1) - log2(context.plain_modulus().value()));\n</code></pre>\n\n<p>But using this will only create a simulated Ciphertext without any real connection to the actual <code>encrypted1</code> Ciphertext noise budget. </p>\n\n<p>Is there a way to approximate the noise budget of <code>encrypted1</code> without the secret key? This situations is important when I or someone else does some computation on externally stored Ciphertexts, e.g. in a cloud database and needs to check the noise budget server side without revealing the secret key.</p>\n"}, {"tags": ["c++", "c++14", "language-lawyer", "variadic-templates", "template-argument-deduction"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1539193502, "post_id": 52745964, "comment_id": 92416649, "body": "For the record, it&#39;s not a compiler &quot;crash&quot;. That would imply the compiler ran into an internal error, not one in your code."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 3, "creation_date": 1539193612, "post_id": 52745964, "comment_id": 92416701, "body": "Actually <a href=\"https://wandbox.org/permlink/4L6IKjuaE2JPv1l3\" rel=\"nofollow noreferrer\">clang indeed crashes</a>..."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1539195065, "post_id": 52745964, "comment_id": 92417343, "body": "After trying to make simplified example <code>template &lt;int... I, typename... T&gt; void foo() {}  int main() { foo&lt;0, int&gt;(); }</code> work in VS it produced surprisingly understandable message: <code>error C3547: template parameter &#39;T&#39; cannot be used because it follows a template parameter pack and cannot be deduced from the function parameters of &#39;foo&#39;</code>"}, {"owner": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1539195330, "post_id": 52745964, "comment_id": 92417462, "body": "@VTT you are trying to do something other, there is not deduction in your code. The code you have posted is invalid without any doubt."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1539195706, "post_id": 52745964, "comment_id": 92417637, "body": "I think the problem is essentially the same: <code>T...</code> can not be deduced properly. Compiler can not figure out <code>I...</code> size just from first argument and then figure out which of the remaining arguments are for <code>decltype(I)\u2026</code> and which are for <code>T...</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "edited": false, "score": 0, "creation_date": 1539196591, "post_id": 52746547, "comment_id": 92418037, "body": "Well, I am not sure that <code>std::index_sequence&lt;I...&gt;</code> needs to be deduced, the <code>I...</code> pack is known at the first substitution phase. Anyway, thanks for the reply, I will consider writing a Defect Report. (However, I do not have an idea how the process is initiated)."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "edited": false, "score": 1, "creation_date": 1539197008, "post_id": 52746547, "comment_id": 92418227, "body": "@NikitaKniazev I don&#39;t understand your comment. Of course <code>I...</code> needs to be deduced. I don&#39;t get it. Also, I&#39;m not sure this would be appropriate for a DR---I think you need to write a full proposal. Write up some suggested wording changes and send them to std-proposals@isocpp.org"}, {"owner": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "edited": false, "score": 0, "creation_date": 1539197289, "post_id": 52746547, "comment_id": 92418359, "body": "I have updated the question with the example where there is a substitution on deducible type. They are both should be valid or invalid, but the latter one is a known thing."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "edited": false, "score": 0, "creation_date": 1539197444, "post_id": 52746547, "comment_id": 92418439, "body": "@NikitaKniazev I think your second example is different because it&#39;s possible to deduce <code>U...</code> before <code>T</code> has been substituted."}, {"owner": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "edited": false, "score": 0, "creation_date": 1539197661, "post_id": 52746547, "comment_id": 92418538, "body": "The example shows that either &quot;deduction then substitution then deduction&quot; can happen or something other is happening here."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "edited": false, "score": 0, "creation_date": 1539197805, "post_id": 52746547, "comment_id": 92418601, "body": "@NikitaKniazev I disagree. <code>T</code> and <code>U...</code> are both deduced, then they are both substituted."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1539198177, "post_id": 52746547, "comment_id": 92418759, "body": "I agree with Brian here - in the original case you have two parameter packs, in the new case you have one. Those situations are not the same. Just work out on paper what you have to do for both cases."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1539450409, "post_id": 52746547, "comment_id": 92510766, "body": "&quot;<i>an argument could be made that the standard should be changed to make it well-formed.</i>&quot; Could you elaborate on how this argument might look, in terms of what could be changed and whether there are enough use cases to justify it, or were you just speculating that someone else like the OP might wish to make it?"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1539658280, "post_id": 52746547, "comment_id": 92571247, "body": "@underscore_d I think the current behaviour is unintuitive, and if I had some time, I might be able to come up with some wording to say that deduction and substitution should alternate until there are no more deduced contexts left. But before writing a proposal I think we&#39;d want to consider whether this would fix any cases other than the one in this question."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 4, "last_activity_date": 1539195747, "creation_date": 1539195747, "answer_id": 52746547, "question_id": 52745964, "link": "https://stackoverflow.com/questions/52745964/variadic-template-type-deduction-crashes-compilers-if-there-is-a-substitution-on/52746547#52746547", "title": "Variadic template type deduction crashes compilers if there is a substitution on deducible type", "body": "<p>I think your code is ill-formed by the standard, but an argument could be made that the standard should be changed to make it well-formed.</p>\n\n<p>The template argument deduction process is described in the standard as follows:</p>\n\n<ol>\n<li>Explicitly specified template arguments are substituted into the function template declaration (<a href=\"http://eel.is/c++draft/temp.deduct\" rel=\"noreferrer\">[temp.deduct]</a>/2-5).</li>\n<li>Remaining template parameters that appear in deduced contexts in the parameter-type-list are deduced (<a href=\"http://eel.is/c++draft/temp.deduct.call\" rel=\"noreferrer\">[temp.deduct.call]</a>).</li>\n<li>The deduced template arguments, together with template parameters that have default template arguments, are substituted into the function declaration <a href=\"http://eel.is/c++draft/temp.deduct.call#10\" rel=\"noreferrer\">[temp.deduct.call]/10</a>. This is the end of the deduction process, and is followed by overload resolution.</li>\n</ol>\n\n<p>Thus, the procedure is <em>substitution-deduction-substitution</em>; there is no subsequent deduction after the substitution of <em>deduced</em> arguments. Further support for this view is provided by <a href=\"http://eel.is/c++draft/temp.deduct#6\" rel=\"noreferrer\">[temp.deduct]/6</a>:</p>\n\n<blockquote>\n  <p>At certain points in the template argument deduction process it is necessary to take a function type that makes use of template parameters and replace those template parameters with the corresponding template arguments. This is done at the beginning of template argument deduction when any explicitly specified template arguments are substituted into the function type, and again at the end of template argument deduction when any template arguments that were deduced or obtained from default arguments are substituted.</p>\n</blockquote>\n\n<p>Your example is ill-formed because it requires deduction then substitution then deduction: <code>T...</code> cannot be deduced unless <code>I...</code> is first <em>both deduced and substituted</em>.</p>\n"}], "owner": {"reputation": 3425, "user_id": 3621421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995874e8bbb9cf8df99e63de231709cc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kniazev", "link": "https://stackoverflow.com/users/3621421/nikita-kniazev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1539200391, "creation_date": 1539193296, "last_edit_date": 1539200391, "question_id": 52745964, "link": "https://stackoverflow.com/questions/52745964/variadic-template-type-deduction-crashes-compilers-if-there-is-a-substitution-on", "title": "Variadic template type deduction crashes compilers if there is a substitution on deducible type", "body": "<p>I think I hit a template type deduction bug in all the compilers, but before reporting it I want to be sure I did not miss something.</p>\n\n<p>Consider an example:</p>\n\n<pre><code>#include &lt;utility&gt;\n\ntemplate &lt;std::size_t... I, typename... T&gt;\nvoid foo(std::index_sequence&lt;I...&gt;, decltype(I)..., T...) {}\n\nint main()\n{\n    foo(std::make_index_sequence&lt;3&gt;{}, 1, 2, 3, 4, 5);\n}\n</code></pre>\n\n<p><sup><em><code>decltype(I)</code> is used here to make MWE shorter.</em></sup></p>\n\n<ul>\n<li>GCC: <code>error: too few arguments to function</code></li>\n<li>Clang crashes with <code>error: no matching function for call to 'foo'</code></li>\n<li>MSVC crashes with <code>error C3543: 'unknown-type': does not contain a parameter pack</code></li>\n</ul>\n\n<p>I don't understand why it fails to deduct <code>T</code>, especially because it works if I replace parameter pack with varargs (except MSVC, it has ICE again).</p>\n\n<pre><code>template &lt;std::size_t... I&gt;\nvoid foo(std::index_sequence&lt;I...&gt;, decltype(I)..., ...) {}\n</code></pre>\n\n<p>There are many other ways to make what I want, but this is the shortest way and I do not see any reasons it should fail.</p>\n\n<p><strong>Update</strong>: The know valid example with substitution on deducible is:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct type_identity\n{ using type = T; };\n\ntemplate &lt;typename T, typename... U&gt;\nvoid foo(T, typename type_identity&lt;T&gt;::type, U...) {}\n\nint main()\n{\n    foo(1, 2, 3, 4, 5);\n}\n</code></pre>\n\n<p><strong>Update #2</strong> The modified version of the original example does not crash Clang, but a note on the error is strange <code>note: candidate template ignored: deduced conflicting types for parameter 'T' (&lt;int, int, int&gt; vs. &lt;&gt;)</code></p>\n\n<pre><code>#include &lt;utility&gt;\n\ntemplate &lt;typename T&gt;\nstruct type_identity\n{ using type = T; };\n\ntemplate &lt;typename...&gt;\nstruct type_pack {};\n\ntemplate &lt;typename... T, typename... U&gt;\nvoid foo(type_pack&lt;T...&gt;, typename type_identity&lt;T&gt;::type..., U...) {}\n\nint main()\n{\n    foo(type_pack&lt;int, int, int&gt;{}, 1, 2, 3, 4, 5);\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "qt"], "comments": [{"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "edited": false, "score": 1, "creation_date": 1539257393, "post_id": 52745862, "comment_id": 92440978, "body": "Glad to hear that your problem was solved. Consider adding that solution as a self-answer to your question."}, {"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "edited": false, "score": 0, "creation_date": 1539257966, "post_id": 52745862, "comment_id": 92441303, "body": "You should check the return value of <a href=\"http://doc.qt.io/qt-5/qprocess.html#waitForFinished\" rel=\"nofollow noreferrer\"><code>QProcess::waitForFinished()</code></a>. It seems like you&#39;re using an online installer, right? For the admin rights issue, you can install your app using admin rights. That would be in the configuration file of the installer. You might want to take a look at this: <a href=\"https://github.com/Skycoder42/QtAutoUpdater\" rel=\"nofollow noreferrer\">github.com/Skycoder42/QtAutoUpdater</a>."}], "answers": [{"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1539673724, "creation_date": 1539673724, "answer_id": 52829759, "question_id": 52745862, "link": "https://stackoverflow.com/questions/52745862/qprocess-cannot-start-maintenancetool-from-exe-without-administrative-privileges/52829759#52829759", "title": "QProcess cannot start maintenancetool from exe without administrative privileges", "body": "<p><em>(Posted the solution on behalf of the question author)</em>.</p>\n\n<p>It seems that Qt's maintenancetool.exe should not ask for admin privileges at all, that is a bug reported for 3.0.2 (the version I use), and it is fixed in 3.0.4.</p>\n"}], "owner": {"reputation": 19, "user_id": 753093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f71c0a3cdc214dfaecd52be7b477c0e?s=128&d=identicon&r=PG", "display_name": "Abraham Mart&#237;n Exp&#243;sito", "link": "https://stackoverflow.com/users/753093/abraham-mart%c3%adn-exp%c3%b3sito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1539673792, "creation_date": 1539192887, "last_edit_date": 1539673792, "question_id": 52745862, "link": "https://stackoverflow.com/questions/52745862/qprocess-cannot-start-maintenancetool-from-exe-without-administrative-privileges", "title": "QProcess cannot start maintenancetool from exe without administrative privileges", "body": "<p>I call QtIFW's maintenancetool.exe from my app.exe to check for updates like this:</p>\n\n<pre><code>QString command = QString( \"\\\"C:/Program Files/My Application/maintenancetool.exe\\\" --checkupdates\" );\nQProcess process;\nprocess.start( command );\nprocess.waitForFinished();\n\nif ( process.error() != QProcess::UnknownError )\n{\n    return;\n}\n\nQByteArray data = process.readAllStandardOutput();\n</code></pre>\n\n<p>If I run my application, it shows the administration privileges dialog when it does the <code>maintenancetool.exe --checkupdates</code> call, as any other applications that needs privileges, and I say yes to accept. Then, my application hangs for a while, and finally process.error() returns a <code>QProcess::Timedout</code> error.</p>\n\n<p>If I run my application with administration privileges all goes fine.</p>\n\n<p>Is there a way to run an exe that requires administration privileges from within another exe that doesn't, using <code>QProcess::start</code>? Of course, I am trying to avoid the users to have the administration privileges dialog opened everytime they run myapp.exe (only when it looks for updates).</p>\n\n<p>I cannot use <code>QProcess::startDeattached</code> since I have to retrieve the output.</p>\n\n<p>NOTE: all works fine too if myapp.exe and maintenancetool.exe are not installed in Program Files, but in any other regular folder (e.g. C:/myfolder).</p>\n\n<h2>Edit</h2>\n\n<p>I found out that the problem is that when myapp.exe calls maintenancetool.exe and administrative privileges are requested, maintenancetool.exe takes too long to finish (33 seconds).</p>\n\n<p>The funny part is that the default wait time is 30 seconds</p>\n\n<pre><code>bool waitForFinished(int msecs = 30000);\n</code></pre>\n\n<p>So, if I call it this way, it works, but I have to wait 33 seconds!</p>\n\n<pre><code>process.waitForFinished( 60000 );\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "simd"], "answers": [{"tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": true, "score": 2, "last_activity_date": 1539197452, "last_edit_date": 1539197452, "creation_date": 1539197135, "answer_id": 52746875, "question_id": 52745772, "link": "https://stackoverflow.com/questions/52745772/compiling-library-with-sse2-and-avx2/52746875#52746875", "title": "Compiling library with SSE2 and AVX2", "body": "<p>If you build with <code>/arch:AVX</code> or <code>/arch:AVX2</code>, the <em>primary</em> impact is that all SSE code generated by the compiler will use the <a href=\"https://en.wikipedia.org/wiki/VEX_prefix\" rel=\"nofollow noreferrer\">VEX prefix</a> encoding which allows for more efficient scheduling of registers. If you run such code on a system without AVX or AVX2 support, it will in fact fault with an illegal instruction.</p>\n\n<p>In other words, your use of <code>_mm_set1_epi32</code> is an SSE2 instruction, but because you built with <code>/arch:AVX2</code> it emitted those instructions using the VEX prefix. The <code>/arch</code> switch impacts explicit intrinsics, compiler-generated floating-point math, the autovectorizer, etc.</p>\n\n<p>If you want to support both 'stock' SSE/SSE2, AVX, and AVX2 platforms with optimized codepaths using the automatic generation supported by the <code>/arch</code> switch, you need three different binaries (EXEs or DLLs).</p>\n\n<blockquote>\n  <p>See <a href=\"https://blogs.msdn.microsoft.com/chuckw/2012/09/11/directxmath-avx/\" rel=\"nofollow noreferrer\">this blog post</a> as well as <a href=\"https://blogs.msdn.microsoft.com/chuckw/2015/06/03/directxmath-avx2/\" rel=\"nofollow noreferrer\">this one</a></p>\n</blockquote>\n\n<p>Note the main difference between <code>/arch:AVX</code> and <code>/arch:AVX2</code> is that the compiler will sometimes emit FMA3 instructions where the scheduler thinks it would be faster than a multiply then an add.</p>\n"}], "owner": {"reputation": 415, "user_id": 1302439, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/LU0uz.jpg?s=128&g=1", "display_name": "Krazer", "link": "https://stackoverflow.com/users/1302439/krazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 52746875, "answer_count": 1, "score": 0, "last_activity_date": 1539197452, "creation_date": 1539192537, "last_edit_date": 1539193148, "question_id": 52745772, "link": "https://stackoverflow.com/questions/52745772/compiling-library-with-sse2-and-avx2", "title": "Compiling library with SSE2 and AVX2", "body": "<p>Using VS2015 and compiling a library that has both SSE2 instructions and AVX2 instructions (that are only used if detected in the CPU), if I compile the library with <code>/arch:AVX2</code> but only call the SSE2 instructions I get \"illegal instruction\" (on <code>_mm_set1_epi32</code> first SSE2 instruction called). However, if I compile the lib with <code>/arch:SSE2</code> it works fine when calling the SSE2 instructions. </p>\n\n<p>Are the arch settings mutually exclusive? If not how should this be fixed? I have attempted both as a shared lib and static lib with the same issue.</p>\n\n<p>this is the lib: <a href=\"https://github.com/Auburns/FastNoiseSIMD\" rel=\"nofollow noreferrer\">https://github.com/Auburns/FastNoiseSIMD</a> and there is an issue about it <a href=\"https://github.com/Auburns/FastNoiseSIMD/issues/20\" rel=\"nofollow noreferrer\">https://github.com/Auburns/FastNoiseSIMD/issues/20</a>, although I don't think the related it directly to AVX2 being on and calling SSE2 instructions. </p>\n"}, {"tags": ["c++", "templates", "compile-time-constant"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 6, "creation_date": 1539192205, "post_id": 52745638, "comment_id": 92416028, "body": "Template arguments can never depend on runtime information."}, {"owner": {"reputation": 17, "user_id": 9552734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5abaf6e29d95d83d762db8986ff94c0?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Bondar", "link": "https://stackoverflow.com/users/9552734/artur-bondar"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539192340, "post_id": 52745638, "comment_id": 92416104, "body": "@Fran&#231;oisAndrieux, yeah, I know it. I just don&#39;t like decision like example attached"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539192381, "post_id": 52745638, "comment_id": 92416127, "body": "Talking bout &quot;attached&quot; examples. Its text. Copy it into your question as TEXT!"}, {"owner": {"reputation": 17, "user_id": 9552734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5abaf6e29d95d83d762db8986ff94c0?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Bondar", "link": "https://stackoverflow.com/users/9552734/artur-bondar"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539192584, "post_id": 52745638, "comment_id": 92416242, "body": "@Swordfish, done"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539192659, "post_id": 52745638, "comment_id": 92416283, "body": "You have to do something similar to what you have done."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 1, "creation_date": 1539193255, "post_id": 52745638, "comment_id": 92416539, "body": "This looks like an XY problem. What are you really trying to do? There&#39;s no general answer to how to make code efficient. I bet the performance penalty from branching exceeds that of just using <code>bitset&lt;32&gt;</code> for all <code>int</code>s."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 2, "last_activity_date": 1539195930, "last_edit_date": 1539195930, "creation_date": 1539195570, "answer_id": 52746504, "question_id": 52745638, "link": "https://stackoverflow.com/questions/52745638/template-requires-compile-time-const-value/52746504#52746504", "title": "Template requires compile-time const value", "body": "<pre><code>#include &lt;cstdint&gt;\n#include &lt;string&gt;\n#include &lt;bitset&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nstd::string DecToBin(std::uint64_t num)\n{\n    std::bitset&lt;64&gt; bits( num );\n    int num_bits{ 8 };\n\n    for (uint64_t test{ 0xff };\n         ~test &amp;&amp; test &lt; num;\n         test = (test &lt;&lt; 8) | test, num_bits += 8);     \n\n    return bits.to_string().substr(64 - num_bits);\n}\n\nint main()\n{\n    for (std::uint64_t i{1}; i != 0; i &lt;&lt;= 1)\n        std::cout &lt;&lt; std::setw(64) &lt;&lt; DecToBin(i) &lt;&lt; '\\n';\n}\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre><code>                                                        00000001\n                                                        00000010\n                                                        00000100\n                                                        00001000\n                                                        00010000\n                                                        00100000\n                                                        01000000\n                                                        10000000\n                                                0000000100000000\n                                                0000001000000000\n                                                0000010000000000\n                                                0000100000000000\n                                                0001000000000000\n                                                0010000000000000\n                                                0100000000000000\n                                                1000000000000000\n                                        000000010000000000000000\n                                        000000100000000000000000\n                                        000001000000000000000000\n                                        000010000000000000000000\n                                        000100000000000000000000\n                                        001000000000000000000000\n                                        010000000000000000000000\n                                        100000000000000000000000\n                                00000001000000000000000000000000\n                                00000010000000000000000000000000\n                                00000100000000000000000000000000\n                                00001000000000000000000000000000\n                                00010000000000000000000000000000\n                                00100000000000000000000000000000\n                                01000000000000000000000000000000\n                                10000000000000000000000000000000\n                        0000000100000000000000000000000000000000\n                        0000001000000000000000000000000000000000\n                        0000010000000000000000000000000000000000\n                        0000100000000000000000000000000000000000\n                        0001000000000000000000000000000000000000\n                        0010000000000000000000000000000000000000\n                        0100000000000000000000000000000000000000\n                        1000000000000000000000000000000000000000\n                000000010000000000000000000000000000000000000000\n                000000100000000000000000000000000000000000000000\n                000001000000000000000000000000000000000000000000\n                000010000000000000000000000000000000000000000000\n                000100000000000000000000000000000000000000000000\n                001000000000000000000000000000000000000000000000\n                010000000000000000000000000000000000000000000000\n                100000000000000000000000000000000000000000000000\n        00000001000000000000000000000000000000000000000000000000\n        00000010000000000000000000000000000000000000000000000000\n        00000100000000000000000000000000000000000000000000000000\n        00001000000000000000000000000000000000000000000000000000\n        00010000000000000000000000000000000000000000000000000000\n        00100000000000000000000000000000000000000000000000000000\n        01000000000000000000000000000000000000000000000000000000\n        10000000000000000000000000000000000000000000000000000000\n0000000100000000000000000000000000000000000000000000000000000000\n0000001000000000000000000000000000000000000000000000000000000000\n0000010000000000000000000000000000000000000000000000000000000000\n0000100000000000000000000000000000000000000000000000000000000000\n0001000000000000000000000000000000000000000000000000000000000000\n0010000000000000000000000000000000000000000000000000000000000000\n0100000000000000000000000000000000000000000000000000000000000000\n1000000000000000000000000000000000000000000000000000000000000000\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9552734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5abaf6e29d95d83d762db8986ff94c0?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Bondar", "link": "https://stackoverflow.com/users/9552734/artur-bondar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539195930, "creation_date": 1539191979, "last_edit_date": 1539192567, "question_id": 52745638, "link": "https://stackoverflow.com/questions/52745638/template-requires-compile-time-const-value", "title": "Template requires compile-time const value", "body": "<p>folks. I have a situation like, template argument depends in running time. \nMy function: </p>\n\n<pre><code>string DecToBin(int num)\n{\n    bitset&lt;(num &lt; 256 ? 8 : 32)&gt; bits(num);\n    return bits.to_string();\n}\n</code></pre>\n\n<p>So, it cannot be compile for sure. What a solution can be except example below? \nThanks</p>\n\n<pre><code>string DecToBin(int num)\n{\n    if(num &lt; pow(2, 8))\n    {\n        bitset&lt;8&gt; bits(num);\n        return bits.to_string();\n    } else if(num &lt; pow(2, 16))\n    {\n        bitset&lt;16&gt; bits(num);\n        return bits.to_string();\n    } else if(num &lt; pow(2, 32))\n    {\n        bitset&lt;32&gt; bits(num);\n        return bits.to_string();\n    } else\n    {\n        bitset&lt;64&gt; bits(num);\n        return bits.to_string();\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "gcc", "vector", "initialization", "clang"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1539191977, "post_id": 52745578, "comment_id": 92415906, "body": "<code>std::vector&lt;char&gt; delimiters = { &quot;,&quot;, &quot;;&quot; };  </code> - wrong kind of quotes."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539192144, "post_id": 52745578, "comment_id": 92416000, "body": "Both are right. It&#39;s undefined behaviour."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 14, "last_activity_date": 1539193305, "last_edit_date": 1539193305, "creation_date": 1539192097, "answer_id": 52745673, "question_id": 52745578, "link": "https://stackoverflow.com/questions/52745578/different-behavior-between-gcc-and-clang-in-such-code/52745673#52745673", "title": "different behavior between gcc and clang in such code", "body": "<p>Both compilers are correct because your code has undefined behavior.</p>\n\n<p>You have fallen into a trap.  <code>{ \",\", \";\" }</code> is translated as a <code>std::vector{const char*, const char*}</code>.  Since you have pointer this is valid syntactically (as it calls vector's iterator constructor), but you are using the address of two unrelated string literals which is not valid as the iterators have to point to the same container.</p>\n\n<p>What you really need to get this to work is to use character literals, not string literals in the initializer list like</p>\n\n<pre><code>std::vector&lt;char&gt; delimiters = { ',', ';' }; \n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7341168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3d7fbf32df57e2dc9fdd546cb1122e?s=128&d=identicon&r=PG&f=1", "display_name": "Point wind", "link": "https://stackoverflow.com/users/7341168/point-wind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 52745673, "answer_count": 1, "score": 6, "last_activity_date": 1539207442, "creation_date": 1539191749, "last_edit_date": 1539207442, "question_id": 52745578, "link": "https://stackoverflow.com/questions/52745578/different-behavior-between-gcc-and-clang-in-such-code", "title": "different behavior between gcc and clang in such code", "body": "<pre><code>int main() \n{\n    std::vector&lt;char&gt; delimiters = { \",\", \";\" };  \n    std::cout &lt;&lt; delimiters[0];\n}\n</code></pre>\n\n<p>I get different answer between gcc and clang</p>\n\n<p>clang7.0.0 print out ,</p>\n\n<p>gcc8.2.0 gives the error</p>\n\n<blockquote>\n  <p>terminate called after throwing an instance of 'std::length_error'\n    what():  cannot create std::vector larger than max_size()</p>\n  \n  <p>Aborted</p>\n</blockquote>\n\n<p>Which compiler is right?</p>\n"}, {"tags": ["c++", "operator-overloading", "return-type"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539191250, "post_id": 52745432, "comment_id": 92415532, "body": "<code>int operator+(Nodo a,Nodo b)</code> is possible."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1539191252, "post_id": 52745432, "comment_id": 92415533, "body": "&quot; I suppose that the return type have to be one of the arguments?&quot; - no, it doesn&#39;t."}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 0, "creation_date": 1539191777, "post_id": 52745432, "comment_id": 92415811, "body": "In what way did it not work? Any specific error messages? Behavior that you didn&#39;t expect? Did it open a portal to eldritch abominations beyond space and time?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539192458, "post_id": 52745432, "comment_id": 92416170, "body": "<a href=\"https://ideone.com/kc7pxt\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 11, "user_id": 9700107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FurioShow", "link": "https://stackoverflow.com/users/9700107/furioshow"}, "edited": false, "score": 1, "creation_date": 1539192738, "post_id": 52745432, "comment_id": 92416323, "body": "Edit the question"}, {"owner": {"reputation": 11, "user_id": 9700107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FurioShow", "link": "https://stackoverflow.com/users/9700107/furioshow"}, "edited": false, "score": 0, "creation_date": 1539634351, "post_id": 52745432, "comment_id": 92565293, "body": "So, what is the problem in my code? If there aren&#39;t limitations in the return type..."}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1539235053, "creation_date": 1539235053, "answer_id": 52752694, "question_id": 52745432, "link": "https://stackoverflow.com/questions/52745432/return-type-overloading-operators/52752694#52752694", "title": "Return type Overloading Operators", "body": "<p>There are rules for operator overloading regarding the <strong>type</strong> and <strong>number</strong> of arguments they can take.<br>\nFor example:  </p>\n\n<ol>\n<li><p>Binary operators (such as <code>+</code>) declared as member functions take one\nargument; if declared as global functions, they take two arguments.</p></li>\n<li><p>Overloaded operators cannot have default arguments.</p></li>\n<li><p>The first argument for member-function overloaded operators is always\nof the class type of the object for which the operator is invoked\n(the class in which the operator is declared, or a class derived from\nthat class). No conversions are supplied for the first argument.</p></li>\n</ol>\n\n<p>But there are NO rules concerning the return type. So, you can return any type from an overloaded operator.</p>\n"}], "owner": {"reputation": 11, "user_id": 9700107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FurioShow", "link": "https://stackoverflow.com/users/9700107/furioshow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1539235053, "creation_date": 1539191161, "last_edit_date": 1539192723, "question_id": 52745432, "link": "https://stackoverflow.com/questions/52745432/return-type-overloading-operators", "title": "Return type Overloading Operators", "body": "<p>I have a questions, probably trivial...\nThere are restrictions on the return type with the overloading of operators?\nI tried to overload operator +, in arguments I had two objects of class Nodo, and i wanted to return the sum of the attributes(with a get method), that were int.\nSo i write an external function <code>int operator+(Nodo a,Nodo b)</code> and this didn't work...So i tried with <code>int operator+(int tot,Nod a)</code> and this worked.\nI suppose that the return type have to be one of the arguments?</p>\n\n<pre><code>class Nodo\n{\n    private:\n        Nodo *Next;\n        Employee *Emp;\n\n    public:\n        Nodo(){}\n        Nodo(Nodo *a,Employee *b):Next(a),Emp(b){}\n        virtual ~Nodo(){}\n        void SetNext(Nodo *a){Next=a;};\n        Nodo* GetNext(){return Next;}\n        void SetEmployee(Employee *emp){Emp=emp;}\n        Employee* GetEmployee(){return Emp;}\n};\n\nclass Employee\n{\n    private:\n        string name;\n        int salary;\n\n    public:\n        Employee(string name,int salary):name(name),salary(salary){}\n        virtual ~Employee() {}\n        string GetName(){return name;}\n        int GetSalary(){return salary;}\n        virtual void PrintInfo(){cout&lt;&lt;\"Nome \"&lt;&lt;name&lt;&lt;\" Salario \"&lt;&lt;salary&lt;&lt;endl;}\n};\n</code></pre>\n\n<p>I tried with</p>\n\n<pre><code>int operator+(Nodo a,Nodo b)\n{\n  int totale;\n  totale=a.GetEmployee()-&gt;GetSalary()+b.GetEmployee()-&gt;GetSalary();\n  return totale;\n}\n</code></pre>\n\n<p>The result is the crash.</p>\n\n<p>While this work.</p>\n\n<pre><code>int operator+(int tot,Nodo a)\n{\n  int totale;\n  totale=tot+a.GetEmployee()-&gt;GetSalary();\n  return totale;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "qt", "opencv"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1539192003, "post_id": 52745343, "comment_id": 92415923, "body": "What is the path of the .py file?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1539192234, "post_id": 52745343, "comment_id": 92416046, "body": "When you point as the &quot;.&quot; you are indicating that the .py is next to the executable, in the case of Qt Creator the executable is in the build folder, so I recommend using the complete path or copying the .py file to the build folder."}, {"owner": {"reputation": 39, "user_id": 10485388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QcLmHEEd6N8/AAAAAAAAAAI/AAAAAAAABhw/x9RrrMnVcpg/photo.jpg?sz=128", "display_name": "Joakim Nyman", "link": "https://stackoverflow.com/users/10485388/joakim-nyman"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1539193897, "post_id": 52745343, "comment_id": 92416827, "body": "it is in the build folder. Note that in all cases the python script runs. But when using Qt it prints &quot;Importing cv2&quot; and crashes on the Import cv2 line."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1539193945, "post_id": 52745343, "comment_id": 92416846, "body": "okay, if so, then it seems weird, I&#39;ve tried it and it works correctly"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1539193996, "post_id": 52745343, "comment_id": 92416861, "body": "use the debugger to know in which line the program is broken"}, {"owner": {"reputation": 39, "user_id": 10485388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QcLmHEEd6N8/AAAAAAAAAAI/AAAAAAAABhw/x9RrrMnVcpg/photo.jpg?sz=128", "display_name": "Joakim Nyman", "link": "https://stackoverflow.com/users/10485388/joakim-nyman"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1539196044, "post_id": 52745343, "comment_id": 92417775, "body": "Thanks for trying it out! Debug in Qt stops at an assembly instruction &quot;lock incl&quot; during the PyImport_Import call. I have not been able to get any better information from debugging. Do you have a suggestions how to do it better?"}, {"owner": {"reputation": 39, "user_id": 10485388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QcLmHEEd6N8/AAAAAAAAAAI/AAAAAAAABhw/x9RrrMnVcpg/photo.jpg?sz=128", "display_name": "Joakim Nyman", "link": "https://stackoverflow.com/users/10485388/joakim-nyman"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1539198790, "post_id": 52745343, "comment_id": 92419056, "body": "@eyllanesc, I updated the question with what versions I&#39;m using. Can you share yours?"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 10485388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QcLmHEEd6N8/AAAAAAAAAAI/AAAAAAAABhw/x9RrrMnVcpg/photo.jpg?sz=128", "display_name": "Joakim Nyman", "link": "https://stackoverflow.com/users/10485388/joakim-nyman"}, "is_accepted": true, "score": 0, "last_activity_date": 1551277197, "creation_date": 1551277197, "answer_id": 54907544, "question_id": 52745343, "link": "https://stackoverflow.com/questions/52745343/importing-opencv-in-python-script-called-from-qt-crashes/54907544#54907544", "title": "importing opencv in python script called from Qt crashes", "body": "<p>The problem was that opencv uses Qt as well so a collision occurred.\nThe solution was to install opencv without Qt support:</p>\n\n<pre><code>pip install opencv-contrib-python-headless\n</code></pre>\n\n<p><a href=\"https://pypi.org/project/opencv-contrib-python-headless/\" rel=\"nofollow noreferrer\">https://pypi.org/project/opencv-contrib-python-headless/</a></p>\n"}], "owner": {"reputation": 39, "user_id": 10485388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QcLmHEEd6N8/AAAAAAAAAAI/AAAAAAAABhw/x9RrrMnVcpg/photo.jpg?sz=128", "display_name": "Joakim Nyman", "link": "https://stackoverflow.com/users/10485388/joakim-nyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 54907544, "answer_count": 1, "score": 0, "last_activity_date": 1551277197, "creation_date": 1539190866, "last_edit_date": 1539198601, "question_id": 52745343, "link": "https://stackoverflow.com/questions/52745343/importing-opencv-in-python-script-called-from-qt-crashes", "title": "importing opencv in python script called from Qt crashes", "body": "<p>I'm embedding Python in Qt C++. When I import cv2 in the Python script it crashes with segmentation fault. Running the script in Python works. Running from C++ without Qt works.</p>\n\n<p>Python scrip: works</p>\n\n<pre><code>print(\"Importing cv2\")\nimport cv2\nprint(\"cv2 imported\")\n</code></pre>\n\n<p>C++: works</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;string&gt;\n\nint main(int argc, char *argv[])\n{\n    std::string module_name(\"PythonModule\");\n\n    Py_Initialize();\n\n    PyObject* sysPath = PySys_GetObject((char*)\"path\");\n    PyObject* pModuleDirPath = PyUnicode_FromString(\".\");\n    PyList_Append(sysPath, pModuleDirPath);\n    Py_DECREF(pModuleDirPath);\n\n    PyObject* pModuleName = PyUnicode_FromString(module_name.c_str());\n    PyObject* pModule = PyImport_Import(pModuleName);\n\n    Py_DECREF(pModuleName);\n    Py_DECREF(pModule);\n\n    Py_Finalize();\n\n    return 0;\n}\n</code></pre>\n\n<p>Qt: segmentation fault after printing \"Importing cv2\"</p>\n\n<pre><code>MainWindow::MainWindow(QWidget *parent) :\u2029        \n    QMainWindow(parent),\u2029    \n    ui(new Ui::MainWindow)\u2029    \n{\u2029        \n    ui-&gt;setupUi(this);   \u2029    \u2029     \n\n    std::string module_name(\"PythonModule\");\u2029    \u2029        \n    Py_Initialize();\u2029    \u2029        \n\n    PyObject* sysPath = PySys_GetObject((char*)\"path\");\u2029        \n    PyObject* pModuleDirPath = PyUnicode_FromString(\".\");\u2029    \n\n    PyList_Append(sysPath, pModuleDirPath);\u2029        \n    Py_DECREF(pModuleDirPath);\u2029    \u2029        \n\n    PyObject* pModuleName = PyUnicode_FromString(module_name.c_str());\u2029       \n    PyObject* pModule = PyImport_Import(pModuleName);\u2029    \u2029     \n\n    Py_DECREF(pModuleName);\u2029        \n    Py_DECREF(pModule);\u2029    \u2029        \n\n    Py_Finalize();\u2029    \n}\n</code></pre>\n\n<p>.pro file:</p>\n\n<pre><code>LIBS += -L /usr/local/lib/python3.5m -lpython3.5m\u2029    \u2029    \nINCLUDEPATH += /usr/include/python3.5m\n</code></pre>\n\n<p>Versions:<br>\nUbuntu 16.04<br>\nPython 3.5<br>\nopencv-python 3.4.2.17<br>\nQt Creator 4.7.0 Based on Qt 5.11.1 </p>\n\n<p>Do anyone recognize this problem?</p>\n"}, {"tags": ["c++", "makefile", "build"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1539190986, "post_id": 52745325, "comment_id": 92415395, "body": "Probably a case to do some <code>VPATH</code> trickery."}], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 1537990, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f8383141523d10d4af79c217a3fa21a?s=128&d=identicon&r=PG&f=1", "display_name": "Manfredo", "link": "https://stackoverflow.com/users/1537990/manfredo"}, "edited": false, "score": 0, "creation_date": 1539246229, "post_id": 52751437, "comment_id": 92434099, "body": "The first solution is not practical because All subdirectories contain sources that need be compiled. But adding all the folders in VPATH seems to do the trick. I still wonder if this is the standard way of doing things because in the end the Makefile I get looks a bit &quot;dirty&quot;"}, {"owner": {"reputation": 8780, "user_id": 318716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Jwj3.png?s=128&g=1", "display_name": "Joseph Quinsey", "link": "https://stackoverflow.com/users/318716/joseph-quinsey"}, "reply_to_user": {"reputation": 1310, "user_id": 1537990, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f8383141523d10d4af79c217a3fa21a?s=128&d=identicon&r=PG&f=1", "display_name": "Manfredo", "link": "https://stackoverflow.com/users/1537990/manfredo"}, "edited": false, "score": 0, "creation_date": 1539350063, "post_id": 52751437, "comment_id": 92482062, "body": "@Manfredo: I have cleaned up my answer a bit, to make it less kludgey."}], "tags": [], "owner": {"reputation": 8780, "user_id": 318716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Jwj3.png?s=128&g=1", "display_name": "Joseph Quinsey", "link": "https://stackoverflow.com/users/318716/joseph-quinsey"}, "is_accepted": true, "score": 1, "last_activity_date": 1539350154, "last_edit_date": 1539350154, "creation_date": 1539226268, "answer_id": 52751437, "question_id": 52745325, "link": "https://stackoverflow.com/questions/52745325/makefile-no-rule-to-make-target-how-to-set-the-correct-rules/52751437#52751437", "title": "Makefile: no rule to make target: how to set the correct rules?", "body": "<p>The problem is with the <em>nested</em> source directory <code>century</code>. If you add to the makefile:</p>\n\n<pre><code>info:\n    @echo \" Info...\"\n    @echo \" SOURCES = $(SOURCES)\"\n    @echo \" OBJECTS = $(OBJECTS)\"\n</code></pre>\n\n<p>then <code>make info</code> gives:</p>\n\n<pre><code>  Info...\n  SOURCES = src/century/century_carbon.cpp src/some_files.cpp\n  OBJECTS = build/century_carbon.o build/some_files.o\n</code></pre>\n\n<p>This check shows that your construction of these macros is ok. And it also shows, as you report, that <code>make</code> will then tell us:</p>\n\n<pre><code>make: *** No rule to make target 'build/century_carbon.o', needed by 'bin/formind'.  Stop.\n</code></pre>\n\n<p>If you add an additional rule, with the directory <code>century</code> specified:</p>\n\n<pre><code>$(BUILDDIR)/%.o: $(SRCDIR)/century/%.cpp\n    @mkdir -p $(BUILDDIR)\n    $(CC) $(CFLAGS) $(INC) -c -o $@ $&lt;\n</code></pre>\n\n<p>then your build will proceed.</p>\n\n<hr>\n\n<p>An alternative solution is to use <code>VPATH</code>. Add the line:</p>\n\n<pre><code>VPATH = src:src/century\n</code></pre>\n\n<p>and also remove <code>$(SRCDIR)/</code> from your rule, which now becomes:</p>\n\n<pre><code>$(BUILDDIR)/%.o: %.cpp\n    @mkdir -p $(BUILDDIR)\n    $(CC) $(CFLAGS) $(INC) -c -o $@ $&lt;\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong> The above answer could be improved in two ways:</p>\n\n<ul>\n<li><p>Use <code>vpath</code> rather than <code>VPATH</code>, for more precise control of the searches.</p></li>\n<li><p>Automatically generate the argument for <code>vpath</code> / <code>VPATH</code>.</p></li>\n</ul>\n\n<p>This is suprisingly simple: just replace my hard-coded <code>VPATH</code> line with:</p>\n\n<pre><code>vpath %.cpp $(sort $(dir $(SOURCES)))\n</code></pre>\n"}], "owner": {"reputation": 1310, "user_id": 1537990, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f8383141523d10d4af79c217a3fa21a?s=128&d=identicon&r=PG&f=1", "display_name": "Manfredo", "link": "https://stackoverflow.com/users/1537990/manfredo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5860, "favorite_count": 0, "accepted_answer_id": 52751437, "answer_count": 1, "score": 2, "last_activity_date": 1539350154, "creation_date": 1539190802, "last_edit_date": 1539246012, "question_id": 52745325, "link": "https://stackoverflow.com/questions/52745325/makefile-no-rule-to-make-target-how-to-set-the-correct-rules", "title": "Makefile: no rule to make target: how to set the correct rules?", "body": "<p>I have a project that I am trying to create a Makefile for. The folder structure looks like this:</p>\n\n<pre><code>|-- bin\n|-- build\n|-- Makefile\n|-- src\n|   |-- some_files.cpp\n|   |-- some_files.h\n|   |-- ForestFactory\n|   |-- MMParSet\n|   |-- century\n|       |-- century_carbon.cpp\n|       |-- century_carbon.h\n|   `-- grass\n`-- src_multithread\n    |-- __history\n</code></pre>\n\n<p>and I have tried to use <a href=\"https://hiltmon.com/blog/2015/08/01/simple-c-plus-plus-from-makefiles-to-xcode-builds/\" rel=\"nofollow noreferrer\">this reference</a> to create a Makefile.\nThe Makefile I have is </p>\n\n<pre><code>CC := g++\n\nSRCDIR := src\nBUILDDIR := build\nTARGETDIR := bin\nINSTALLBINDIR := /usr/local/bin\nTARGET := bin/formind\n\n# CPP files\nSOURCES := $(shell find $(SRCDIR) -type f -name *.cpp)\n# remove the src path and add the build path and the .o extension\nOBJECTS := $(addprefix $(BUILDDIR)/,$(patsubst %.cpp,%.o,$(notdir $(SOURCES))))\n\nCFLAGS := -std=c++11 -stdlib=libc++\n\nINC := -I/usr/local/include -I $(SRCDIR) -I $(SRCDIR)/century -I $(SRCDIR)/grass -I $(SRCDIR)/MMParSet -I $(SRCDIR)/ForestFactory\n\n$(TARGET): $(OBJECTS)\n    @mkdir -p $(TARGETDIR)\n    @echo \" Linking...\"\n    @echo \" $(CC) $^ -o $(TARGET)\"\n    $(CC) $^ -o $(TARGET)\n\n$(BUILDDIR)/%.o: $(SRCDIR)/%.cpp\n    @mkdir -p $(BUILDDIR)\n    @echo \" $(CC) $(CFLAGS) $(INC) -c -o $@ $&lt;\"\n    $(CC) $(CFLAGS) $(INC) -c -o $@ $&lt;\n\nclean:\n    @echo \" Cleaning...\";\n    @echo \" $(RM) -r $(BUILDDIR) $(TARGET)\"\n    $(RM) -r $(BUILDDIR) $(TARGET)\n\n\n.PHONY: clean\n</code></pre>\n\n<p>When I try to <code>make</code> I get the following error message:</p>\n\n<pre><code>make: *** No rule to make target `build/century_carbon.o', needed by `bin/formind'.  Stop.\n</code></pre>\n\n<p>The source files come from a nested set of subdirectories inside src. My understanding was that the <code>OBJECTS</code> variable should contain the complete paths of the final object files, so that I have something like</p>\n\n<pre><code>$SOURCES = src/century/century_carbon.cpp ... src/for_branching.cpp ... src/grass/grass_log.cpp ...\n\n$OBJECTS = build/century_carbon.o ... build/for_branching.o ... build/grass_log.o ...\n</code></pre>\n\n<p>Is there something wrong in the way I wrote the compilation rules?</p>\n"}, {"tags": ["c++", "sorting"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1539189838, "post_id": 52745026, "comment_id": 92414775, "body": "With a rep of 375, you should know at this point that &quot;pastebin&quot; links shouldn&#39;t be used."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539190065, "post_id": 52745026, "comment_id": 92414916, "body": "+ input to reprouce this &quot;heap-buffer-overflow&quot; is missing."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1539190539, "post_id": 52745026, "comment_id": 92415170, "body": "Why so much of convoluted code instead of <code>return std::to_string(a) &lt; std::to_string(b);</code> ? And passing <code>int</code> by const reference just to make a local copy on the first line..."}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1539191069, "post_id": 52745026, "comment_id": 92415431, "body": "this might also prove to be useful. <a href=\"https://stackoverflow.com/questions/18291620/why-will-stdsort-crash-if-the-comparison-function-is-not-as-operator\" title=\"why will stdsort crash if the comparison function is not as operator\">stackoverflow.com/questions/18291620/&hellip;</a>"}, {"owner": {"reputation": 807, "user_id": 5769874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7752d47c7c3c1145f8c9197934099c?s=128&d=identicon&r=PG&f=1", "display_name": "mouserat", "link": "https://stackoverflow.com/users/5769874/mouserat"}, "edited": false, "score": 0, "creation_date": 1591034419, "post_id": 52745026, "comment_id": 109898121, "body": "from my prior experience the likely issue in a &#39;comparator heap overflow&#39; error is almost always a mistake in the comparator code. incorrect or missed conditions in the comparator results in the comparator being called repeatedly in effort to sort the array, which never completes, thus resulting in a memory leak."}], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 981403, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PrBma.png?s=128&g=1", "display_name": "Mazeryt", "link": "https://stackoverflow.com/users/981403/mazeryt"}, "edited": false, "score": 0, "creation_date": 1539192900, "post_id": 52745280, "comment_id": 92416394, "body": "thanks for the help that was something that I wasn&#39;t aware of!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 667, "user_id": 981403, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PrBma.png?s=128&g=1", "display_name": "Mazeryt", "link": "https://stackoverflow.com/users/981403/mazeryt"}, "edited": false, "score": 0, "creation_date": 1539193793, "post_id": 52745280, "comment_id": 92416784, "body": "@Mazeryt To confirm the answer given, if you run the code you had at the pastebin link in Visual Studio, you get an assertion error that the comparison function is invalid.  The test that NathanOliver mentions about flipping the values and doing the test a second time is exactly what Visual C++ debug runtime does to verify you do not have a bogus comparison function."}, {"owner": {"reputation": 667, "user_id": 981403, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PrBma.png?s=128&g=1", "display_name": "Mazeryt", "link": "https://stackoverflow.com/users/981403/mazeryt"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539194151, "post_id": 52745280, "comment_id": 92416925, "body": "@PaulMcKenzie does this feature has some name? I am not running inside VS but only using clang, so curious if clang can catch this as well?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 667, "user_id": 981403, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PrBma.png?s=128&g=1", "display_name": "Mazeryt", "link": "https://stackoverflow.com/users/981403/mazeryt"}, "edited": false, "score": 0, "creation_date": 1539194275, "post_id": 52745280, "comment_id": 92416986, "body": "@Mazeryt It is part of MSVC&#39;s debug version of their standard library implementation.  They&#39;ve added a lot of &quot;utilities&quot; like this to help coders find problems faster in debug builds.  I&#39;m not sure if gcc or clang do that."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 10, "last_activity_date": 1539190632, "creation_date": 1539190632, "answer_id": 52745280, "question_id": 52745026, "link": "https://stackoverflow.com/questions/52745026/heap-overflow-inside-custom-sort-function/52745280#52745280", "title": "Heap overflow inside custom sort function", "body": "<p>Your issue is you violate the <a href=\"https://en.cppreference.com/w/cpp/named_req/Compare\" rel=\"noreferrer\">compare requirement</a> that the comparison function passed to <code>std::sort</code> is required to follow.</p>\n\n<p>The compare requirement requires that If <code>comp(a,b)==true</code> then <code>comp(b,a)==false</code> but your comparison function does not do this. for example if <code>a = 0</code> and <code>b = 0</code> then <code>comp(a, b)</code> brings you to the</p>\n\n<pre><code>if (da.size() &gt; db.size())\n    return false;\nelse\n    return true;\n</code></pre>\n\n<p>part of you comparison function.  Since the sizes are equal it returns <code>true</code>.  when we flip it and evaluate <code>comp(b, a)</code> we get to the same block and will return <code>true</code> again.</p>\n\n<p>You need to return <code>false</code> when <code>a == b</code> and you don't do that.</p>\n"}], "owner": {"reputation": 667, "user_id": 981403, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PrBma.png?s=128&g=1", "display_name": "Mazeryt", "link": "https://stackoverflow.com/users/981403/mazeryt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 52745280, "answer_count": 1, "score": -1, "last_activity_date": 1539190632, "creation_date": 1539189538, "last_edit_date": 1539190581, "question_id": 52745026, "link": "https://stackoverflow.com/questions/52745026/heap-overflow-inside-custom-sort-function", "title": "Heap overflow inside custom sort function", "body": "<p>Hi I struggled with simple program that is doing lex sorting on the array of the integers</p>\n\n<p>(full program here: <a href=\"https://pastebin.com/UMqEP62n\" rel=\"nofollow noreferrer\">https://pastebin.com/UMqEP62n</a> )</p>\n\n<p>Running sort on the big enough vector of ints causes random numbers appear in the array and then depends on the data causing segfault.</p>\n\n<pre><code>sort(nums.begin(), nums.end(), lex_compare);\n</code></pre>\n\n<p>Function to compare:</p>\n\n<pre><code>bool lex_compare(const int &amp;a, const int &amp;b) {\n    int ap = a, bp = b;\n    vector&lt;int&gt; da, db;\n\n    if (ap == 0) da.insert(da.begin(), ap%10);\n    while (ap &gt; 0) {\n        da.insert(da.begin(), ap%10);\n        ap /= 10;\n    }\n    if (bp == 0) db.insert(db.begin(), bp%10);\n    while (bp &gt; 0) {\n        db.insert(db.begin(), bp%10);\n        bp /= 10;\n    }\n    size_t size;\n    if (da.size() &lt; db.size()) {\n        size = da.size();\n    } else {\n        size = db.size();\n    }\n\n    for (size_t i = 0; i &lt; size; ++i)\n        if (da[i] &gt; db[i])\n            return true;\n        else if (da[i] &lt; db[i])\n            return false;\n        else\n            continue;\n\n    if (da.size() &gt; db.size())\n        return false;\n    else\n        return true;\n}\n</code></pre>\n\n<p>Basically when array is too long memory corruption shows up as there is heap buffer overflow. When compiled with address Sanitizer it show that:</p>\n\n<pre><code>==4097==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6140000001d0 at pc 0x00010aa396fe bp 0x7ffee51c5c50 sp 0x7ffee51c5c48\nREAD of size 4 at 0x6140000001d0 thread T0\n#0 0x10aa396fd in lex_compare(int const&amp;, int const&amp;) main.cpp:8  \n</code></pre>\n\n<p>Which is essentially first line of lex_compare function:</p>\n\n<pre><code>int ap = a, bp = b;\n</code></pre>\n\n<p>I cannot figure out kind of error here which causing this behavior? Is it due to size of compare function? or do I have some obvious memory read error? I work with clang 4.2.1 but other platforms are also causing same behavior so I presume is something fundamental wrong with sort function.</p>\n"}, {"tags": ["c++", "windows", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 1247, "user_id": 4261207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade48fa65f7be6624ce1c3de3c76283c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Long", "link": "https://stackoverflow.com/users/4261207/chris-long"}, "edited": false, "score": 0, "creation_date": 1539189932, "post_id": 52744908, "comment_id": 92414832, "body": "Downvoters - please leave a comment to help me improve the question."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1539238939, "post_id": 52744908, "comment_id": 92430428, "body": "Such questions cry for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1247, "user_id": 4261207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade48fa65f7be6624ce1c3de3c76283c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Long", "link": "https://stackoverflow.com/users/4261207/chris-long"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1539248255, "post_id": 52744908, "comment_id": 92435336, "body": "@zett42 - Please read the question carefully. There is only one sentence that is actually a question: &#39;Is it possible/likely that some messages in this situation would be lost, even though PostMessage returned success?&#39;. I wasn&#39;t asking for help in diagnosing my specific code, I was asking a general question about the timing of when a message queue becomes fully open for business. Remy helped with a concise answer to that question."}], "answers": [{"comments": [{"owner": {"reputation": 1247, "user_id": 4261207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade48fa65f7be6624ce1c3de3c76283c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Long", "link": "https://stackoverflow.com/users/4261207/chris-long"}, "edited": false, "score": 0, "creation_date": 1539196535, "post_id": 52746605, "comment_id": 92418008, "body": "Thanks for responding, Remy. I didn&#39;t post any code because it&#39;s complex multithreaded stuff and it would be too much to show all of it. I mainly wanted the &#39;No. Something else is going on&#39; response, so thanks for that, I&#39;ll keep looking. I&#39;ll update the question with some more details."}, {"owner": {"reputation": 1247, "user_id": 4261207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade48fa65f7be6624ce1c3de3c76283c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Long", "link": "https://stackoverflow.com/users/4261207/chris-long"}, "edited": false, "score": 1, "creation_date": 1539199206, "post_id": 52746605, "comment_id": 92419233, "body": "Remy, thanks again... you prompted me to check some assumptions and I found that some of the PostMessage calls were indeed using an HWND variable before it was properly initialised. It has a value of 0 before initialisation which is valid for PostMessage, hence why the call succeeded."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1539196304, "last_edit_date": 1539196304, "creation_date": 1539195999, "answer_id": 52746605, "question_id": 52744908, "link": "https://stackoverflow.com/questions/52744908/postmessage-messages-not-received/52746605#52746605", "title": "PostMessage: Messages not received", "body": "<blockquote>\n  <p>I've already found numerous explanations of how this could happen if I'd done something funky in my message pump, due to the presence of a modal message pump in certain circumstances, but I'm not doing anything funky.</p>\n</blockquote>\n\n<p>Modal loops don't throw away window messages, unless they are coded wrong and don't pass unknown messages to <code>TranslateMessage()</code>/<code>DispatchMessage()</code> like they should. </p>\n\n<blockquote>\n  <p>I think (but would like confirmed) that my problem is due to calling PostMessage too early in the UI thread's lifetime.</p>\n</blockquote>\n\n<p>If that were the case, <code>PostMessage()</code> would simply fail, but you have already ruled that out.  As soon as a thread calls any <code>user32.dll</code> function, the message queue is created and can begin receiving messages, even if the queue is not polled right away.</p>\n\n<blockquote>\n  <p>Is it possible/likely that some messages in this situation would be lost, even though PostMessage returned success?</p>\n</blockquote>\n\n<p>No. Something else is going on. Either your message loop is filtering messages incorrectly, or a malformed modal loop is discarding messages, or you are simply posting to the wrong <code>HWND</code>. Hard to say as you did not show any of your code.</p>\n\n<blockquote>\n  <p>In testing, I've determined that adding a small delay (Sleep(50)) in the worker thread before it calls PostMessage is enough to prevent any message loss.</p>\n</blockquote>\n\n<p>What is your main thread normally doing during those 50ms? Sounds like something in your UI code is receiving and discarding your posted messages during that time.</p>\n\n<p>On the other hand, how do the threads know which <code>HWND</code> to post to? Is your <code>WM_CREATE</code> handler passing its <code>hwnd</code> parameter to the threads, or are the threads relying on the <code>HWND</code> returned by <code>CreateWindowEx()</code>? In the latter case, <code>PostMessage()</code> should fail if called before <code>CreateWindowEx()</code> exits. Unless your receiving <code>HWND</code> variable is initially uninitialized and contains a random non-null value that <code>PostMessage()</code> interprets as a valid <code>HWND</code> elsewhere on the system.</p>\n"}], "owner": {"reputation": 1247, "user_id": 4261207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade48fa65f7be6624ce1c3de3c76283c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Long", "link": "https://stackoverflow.com/users/4261207/chris-long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "accepted_answer_id": 52746605, "answer_count": 1, "score": -2, "last_activity_date": 1539197481, "creation_date": 1539189107, "last_edit_date": 1539197481, "question_id": 52744908, "link": "https://stackoverflow.com/questions/52744908/postmessage-messages-not-received", "title": "PostMessage: Messages not received", "body": "<p>I'm looking for some feedback on an issue that I can workaround, but want to understand better. I have some multithreaded code where a worker thread uses the Win32 API PostMessage function to post a message to the main UI thread in order to update a TreeView. Some of the posted messages sometimes fail to ever appear via the UI thread's message pump, despite my logging showing that the PostMessage returned successfully.</p>\n\n<p>I've already found numerous explanations of how this could happen if I'd done something funky in my message pump, due to the presence of a modal message pump in certain circumstances, but I'm not doing anything funky.</p>\n\n<p>I think (but would like confirmed) that my problem is due to calling PostMessage too early in the UI thread's lifetime. My WinMain calls CreateWindowEx to create its main window, and the WM_CREATE handler for that window indirectly launches the background threads that will, fairly quickly, call PostMessage using the main windows's HWND, possibly even before the WM_CREATE handler finishes, very likely before WinMain's message pump is started.</p>\n\n<p>Is it possible/likely that some messages in this situation would be lost, even though PostMessage returned success? In testing, I've determined that adding a small delay (Sleep(50)) in the worker thread before it calls PostMessage is enough to prevent any message loss. However, I'm not convinced that this is solving the underlying problem so would like to know if I need to keep digging.</p>\n\n<p>EDIT:</p>\n\n<p>There's only one message loop in all my code and it's not doing anything unusual beyond calling the usual TranslateAccelerator etc:</p>\n\n<pre><code> // Enter the message loop\n while (GetMessage (&amp;msg, NULL, 0, 0)) {\n   if (!TranslateMDISysAccel(hwndClient, &amp;msg) &amp;&amp; !TranslateAccelerator (hwndFrame, hAccel, &amp;msg)) {\n     TranslateMessage (&amp;msg) ;\n     DispatchMessage (&amp;msg) ;\n   }\n }\n</code></pre>\n"}, {"tags": ["c++", "struct", "mismatch"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1539189086, "post_id": 52744874, "comment_id": 92414297, "body": "Regardless of how they are laid out you violate the one definition rule.  You can only have one definition of an object."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539189502, "post_id": 52744874, "comment_id": 92414559, "body": "This is what <code>friend</code> is for, or even better, proper object-oriented design to avoid this issue."}, {"owner": {"reputation": 573, "user_id": 8168483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c739c33f9cbd40c31fed10707f1a8e88?s=128&d=identicon&r=PG&f=1", "display_name": "kerrytazi", "link": "https://stackoverflow.com/users/8168483/kerrytazi"}, "edited": false, "score": 0, "creation_date": 1539189919, "post_id": 52744874, "comment_id": 92414825, "body": "Yes, it will generate the same code"}], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "edited": false, "score": 0, "creation_date": 1587534592, "post_id": 52745420, "comment_id": 108545191, "body": "I don&#39;t understand the rationale for this. What could possibly be achieved through this flexibility?"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "edited": false, "score": 1, "creation_date": 1587559110, "post_id": 52745420, "comment_id": 108557410, "body": "@Martin: it&#39;s a mystery to me as well; my only idea about that was that maybe some early implementation stored the members with different access control in separate lists, and then outputted them in a fixed order (e.g. first all public, then all protected, then all private), or that they were even outputted in the &quot;underlying&quot; C structure in separate sub-structures for some reason, but all these hypotheses seem far fetched."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "edited": false, "score": 0, "creation_date": 1587559254, "post_id": 52745420, "comment_id": 108557490, "body": "Another possibility that comes to mind is that possibly they thought that, given that with access specifiers the class ceases to be C-style and thus subject to older APIs, compilers could exploit that opportunity to reorder members and reduce padding, but even this doesn&#39;t seem plausible."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "edited": false, "score": 0, "creation_date": 1587560090, "post_id": 52745420, "comment_id": 108557984, "body": "Here there may be an explanation: <a href=\"https://stackoverflow.com/q/41407540/214671\">stackoverflow.com/q/41407540/214671</a>, something akin to my first thought (some existing implementation changed layout depending on the access specifiers)."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 4, "last_activity_date": 1539191117, "creation_date": 1539191117, "answer_id": 52745420, "question_id": 52744874, "link": "https://stackoverflow.com/questions/52744874/do-public-private-protected-change-the-arrangement-of-a-struct-in-memory/52745420#52745420", "title": "Do public/private/protected change the arrangement of a struct in memory?", "body": "<p>The standard makes no such guarantee. You have layout guarantees only for standard-layout classes:</p>\n\n<blockquote>\n  <p>A standard-layout class is a class that:</p>\n  \n  <ul>\n  <li>has no non-static data members of type non-standard-layout class (or array of such types) or reference,</li>\n  <li>has no virtual functions (10.3) and no virtual base classes (10.1),</li>\n  <li>has the same access control (Clause 11) for all non-static data members,</li>\n  <li>has no non-standard-layout base classes,</li>\n  <li>either has no non-static data members in the most derived class and at most one base class with\n  non-static data members, or has no base classes with non-static data members, and</li>\n  <li>has no base classes of the same type as the first non-static data member.</li>\n  </ul>\n</blockquote>\n\n<p>(C++14, [class] \u00b67)</p>\n\n<p>If a class is standard-layout, its layout is well defined (and two standard layout classes that have a layout-compatible initial sequence may read each other's layout-compatible members through a <code>union</code>).</p>\n\n<p>However, here it is not the case, as you have different access specifiers throughout the class. In particular, it's explicitly stated that</p>\n\n<blockquote>\n  <p>The order of allocation of non-static data members with different access control is unspecified</p>\n</blockquote>\n\n<p>(C++14, [class.mem] \u00b613)</p>\n\n<hr>\n\n<p><em>That being said</em>, I never worked with any real world compiler that ever exploited this flexibility offered by the standard - every compiler I know uses the access specifiers for compile-time checks, but ignores them completely as far as members layout is concerned. </p>\n"}], "owner": {"reputation": 1532, "user_id": 8076767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BA8bJ.png?s=128&g=1", "display_name": "NetherGranite", "link": "https://stackoverflow.com/users/8076767/nethergranite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 52745420, "answer_count": 1, "score": 1, "last_activity_date": 1539191129, "creation_date": 1539188944, "last_edit_date": 1539189545, "question_id": 52744874, "link": "https://stackoverflow.com/questions/52744874/do-public-private-protected-change-the-arrangement-of-a-struct-in-memory", "title": "Do public/private/protected change the arrangement of a struct in memory?", "body": "<p><strong>Edit:</strong> I just realized a much simpler way to ask this question:</p>\n\n<blockquote>\n  <p>Given the following two structs:</p>\n\n<pre><code>class Thing {public: int a; public: int b; public: int c;}\n\nclass Thing {public: int a, private: int b; public: int c;}\n</code></pre>\n  \n  <p>Are the members <code>a</code>, <code>b</code>, and <code>c</code> guaranteed to be in the same order in memory for both of these definitions?</p>\n</blockquote>\n\n<hr>\n\n<h2>Old Question</h2>\n\n<p>Let's say we have this C++ code in <code>fileA.cpp</code>:</p>\n\n<pre><code>class Thing\n{\npublic:\n    int a;\n    double num;\n\n    Thing()\n    {\n        b = 10;\n    }\n\n    float getB()\n    {\n        return b;\n    }\n\nprivate:\n    float b;\n    Thing * other;\n}\n\nvoid doSomething(Thing thing);\n\nint main()\n{\n    Thing thing;\n    doSomething(thing);\n    std::cout &lt;&lt; thing.b;\n}\n</code></pre>\n\n<p>And let's say we have this code in <code>fileB.cpp</code>:</p>\n\n<pre><code>class Thing\n{\npublic:\n    int a;\n    double num;\n\n    Thing()\n    {\n        b = 10;\n    }\n\n    float getB()\n    {\n        return b;\n    }\n\n    float b;\n\nprivate:\n    Thing * other;\n}\n\nvoid doSomething(Thing thing)\n{\n    thing.b = 30;\n}\n</code></pre>\n\n<p>Assuming the compiler wouldn't complain, would this code work as expected? That being, is the arrangement of a struct's data independent of whether or not certain components are public, private, or protected?</p>\n\n<p><strong>Edit:</strong> To make it more obvious, the only difference between the two definitions of <code>Thing</code> is the fact that <code>float b;</code> is private in <code>fileA.cpp</code> but public in <code>fileB.cpp</code>.</p>\n"}, {"tags": ["c++", "windows", "qt"], "answers": [{"tags": [], "owner": {"reputation": 6147, "user_id": 3767076, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/64707b213de57fb785081ba23aaea2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/3767076/felix"}, "is_accepted": true, "score": 0, "last_activity_date": 1539214022, "creation_date": 1539214022, "answer_id": 52750091, "question_id": 52744867, "link": "https://stackoverflow.com/questions/52744867/is-there-a-way-to-distinguish-whether-a-qt-widget-got-focus-from-mouse-clicking/52750091#52750091", "title": "Is there a way to distinguish, whether a Qt widget got focus from mouse clicking or from table key pressing?", "body": "<p>Yes, there is. Override <a href=\"https://doc.qt.io/qt-5/qwidget.html#focusInEvent\" rel=\"nofollow noreferrer\"><code>QWidget::focusInEvent</code></a> and use the <a href=\"https://doc.qt.io/qt-5/qfocusevent.html#reason\" rel=\"nofollow noreferrer\"><code>QFocusEvent::reason</code></a> method of the focus event to get the reason!</p>\n\n<p>Simple sample:</p>\n\n<pre><code>void MyWidget::focusInEvent(QFocusEvent *event) {\n    qDebug() &lt;&lt; event-&gt;reason();\n    QWidget::focusInEvent(event);\n}\n</code></pre>\n\n<p><strong>Note:</strong> In case you want to get this information from an already existing widget, you can always install an event filter instead. See <a href=\"https://doc.qt.io/qt-5/qobject.html#installEventFilter\" rel=\"nofollow noreferrer\">https://doc.qt.io/qt-5/qobject.html#installEventFilter</a> for an example on how do do that.</p>\n"}], "owner": {"reputation": 3, "user_id": 10485338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KKpS7bbYFhE/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUOMKROmDI7gd6YmqciSM8tXm-6Xw/mo/photo.jpg?sz=128", "display_name": "Stanley Hofstader", "link": "https://stackoverflow.com/users/10485338/stanley-hofstader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52750091, "answer_count": 1, "score": 0, "last_activity_date": 1539214022, "creation_date": 1539188907, "question_id": 52744867, "link": "https://stackoverflow.com/questions/52744867/is-there-a-way-to-distinguish-whether-a-qt-widget-got-focus-from-mouse-clicking", "title": "Is there a way to distinguish, whether a Qt widget got focus from mouse clicking or from table key pressing?", "body": "<p>I'm  using  Qt5  on  windows. \nIs there a way to distinguish whether a Qt widget got focus from mouse clicking or from table key pressing?</p>\n"}, {"tags": ["c++", "stl", "shared-ptr"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 3, "creation_date": 1539189059, "post_id": 52744844, "comment_id": 92414278, "body": "Both options will probably compile to the same assembly."}, {"owner": {"reputation": 4677, "user_id": 2043465, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/649021e96b1032f4de635a8fdb4654b2?s=128&d=identicon&r=PG", "display_name": "Yossarian", "link": "https://stackoverflow.com/users/2043465/yossarian"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1539190078, "post_id": 52744844, "comment_id": 92414919, "body": "I had a quick look on godbolt: <a href=\"https://godbolt.org/z/4J-O4_\" rel=\"nofollow noreferrer\">godbolt.org/z/4J-O4_</a> there are some differences, but I can&#39;t tell if they are significant"}, {"owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 1, "creation_date": 1539191214, "post_id": 52744844, "comment_id": 92415507, "body": "I think that would be helpful, <a href=\"https://stackoverflow.com/questions/14816409/moving-an-object-into-a-map\" title=\"moving an object into a map\">stackoverflow.com/questions/14816409/&hellip;</a>"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1539236804, "post_id": 52744844, "comment_id": 92429609, "body": "emplace does in-place insertion and avoids an unnecessary copy of object"}, {"owner": {"reputation": 4677, "user_id": 2043465, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/649021e96b1032f4de635a8fdb4654b2?s=128&d=identicon&r=PG", "display_name": "Yossarian", "link": "https://stackoverflow.com/users/2043465/yossarian"}, "reply_to_user": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 1, "creation_date": 1539253150, "post_id": 52744844, "comment_id": 92438445, "body": "@Hiroki Yes, I think that is the same, thanks! <code>bar()</code> gives me an r-value reference, which will be forwarded to <code>pair</code>&#39;s ctor, which in turn will call the move-ctor for <code>shared_ptr</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "is_accepted": true, "score": 4, "last_activity_date": 1539345608, "last_edit_date": 1539345608, "creation_date": 1539283998, "answer_id": 52767076, "question_id": 52744844, "link": "https://stackoverflow.com/questions/52744844/is-it-correct-to-use-stdmapemplace-with-a-function-returning-a-shared-ptr/52767076#52767076", "title": "Is it correct to use std::map::emplace with a function returning a shared_ptr?", "body": "<p>I think it is correct.</p>\n\n<hr>\n\n<h2>RVO</h2>\n\n<p><strong>I think that RVO should work fine as long as it is implemented in your compiler</strong>, because <code>bar()</code> returns temporal object and the compiler knows what object is to be returned from <code>bar()</code>.\nAlso, in C++17 and over, RVO is guarnteed in such a case.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7596183/is-rvo-return-value-optimization-applicable-for-all-objects\">Is RVO (Return Value Optimization) applicable for all objects?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/12953127/what-are-copy-elision-and-return-value-optimization\">What are copy elision and return value optimization?</a></p>\n\n<hr>\n\n<h2>emplace vs. insert (<a href=\"https://wandbox.org/permlink/zMA1pWOqLc160pPU\" rel=\"nofollow noreferrer\">DEMO</a>)</h2>\n\n<p><strong>std::map::emplace</strong></p>\n\n<p>In </p>\n\n<pre><code>my_map.emplace(\"key\", bar());\n</code></pre>\n\n<p>, RVO replaces <code>bar()</code> with <code>std::make_shared&lt;Foo&gt;()</code> and <code>std::shared_ptr&lt;Foo&gt;</code> is created.\nThen it is forwarded and <strong>move-ctor</strong> of <code>std::shared_ptr&lt;Foo&gt;</code> is called <strong>just once</strong> at in-place construction of new element of <code>my_map</code>.</p>\n\n<p><strong>std::map::insert with std::make_pair</strong></p>\n\n<p>In </p>\n\n<pre><code>my_map.insert(make_pair(\"key\", bar()));\n</code></pre>\n\n<p>, RVO again replaces <code>bar()</code> with <code>std::make_shared&lt;Foo&gt;()</code>.</p>\n\n<p>Next, from 20.3.2 of <a href=\"https://stackoverflow.com/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents\">N3337</a>, C++11 with minor errors corrected, the class template of <code>std::pair</code> is</p>\n\n<blockquote>\n<pre><code>namespace std{\n  template&lt;class T1, class T2&gt;\n  struct pair\n  {\n    typedef T1 first_type;\n    typedef T2 second_type;\n    T1 first;\n    T2 second;\n    ...\n    template&lt;class U, class V&gt; pair(U&amp;&amp; x, V&amp;&amp; y);\n    ...\n  }\n}\n</code></pre>\n</blockquote>\n\n<p>where template ctor is </p>\n\n<blockquote>\n<pre><code>template&lt;class U, class V&gt; pair(U&amp;&amp; x, V&amp;&amp; y);\n</code></pre>\n  \n  <p><em>Effects</em>: The constructor initializes <code>first</code> with <code>std::forward&lt;U&gt;(x)</code> and <code>second</code> with <code>std::forward&lt;V&gt;(y)</code>. </p>\n</blockquote>\n\n<p>In addition, from 20.3.3</p>\n\n<blockquote>\n<pre><code>template&lt;class T1, class T2&gt;\npair&lt;V1, V2&gt; make_pair(T1&amp;&amp; x, T2&amp;&amp; y);\n</code></pre>\n  \n  <p><em>Returns</em>: <code>pair&lt;V1, V2&gt;(std::forward&lt;T1&gt;(x), std::forward&lt;T2&gt;(y))</code>;...</p>\n</blockquote>\n\n<p>Thus typical implementation of <code>std::make_pair</code> for this definition is considered like this:</p>\n\n<pre><code>namespace std{\n  template&lt;class T1, class T2&gt;\n  inline pair&lt;typename decay&lt;T1&gt;::type, typename decay&lt;T2&gt;::type&gt;\n  make_pair(T1&amp;&amp; x, T2&amp;&amp; y)\n  {\n    return pair&lt;typename decay&lt;T1&gt;::type,\n                typename decay&lt;T2&gt;::type&gt;\n                (std::forward&lt;T1&gt;(x), std::forward&lt;T2&gt;(y));\n  }\n}\n</code></pre>\n\n<p>and RVO will again work for <code>std::make_pair</code>.\nIn fact, the number of move-ctor call is incremented by just one if we compile <a href=\"https://wandbox.org/permlink/zMA1pWOqLc160pPU\" rel=\"nofollow noreferrer\">DEMO</a> with C++14 and a compiler option \"-fno-elide-constructors\" which desables g++'s RVO.</p>\n\n<p>Therefore in <code>std::make_pair(\"key\", bar())</code>, I expect the following senario:</p>\n\n<ul>\n<li>1) RVO replaces <code>bar()</code> with <code>std::make_shared&lt;Foo&gt;()</code>, </li>\n<li>2) RVO also replaces <code>std::make_pair</code> with <code>std::pair::pair</code>,</li>\n<li>3) <code>std::shared_prtr&lt;Foo&gt;</code> is created and then it is forwarded to <code>std::pair::pair</code>,</li>\n<li>4) <code>std::shared_prtr&lt;Foo&gt;</code> is created as an element <code>second</code> by <strong>move-ctor</strong>.</li>\n</ul>\n\n<p>Finally, <code>std::map::insert</code> is also overloaded for r-values:</p>\n\n<pre><code>// since C++11\ntemplate&lt; class P &gt;\nstd::pair&lt;iterator,bool&gt; insert( P&amp;&amp; value );\n</code></pre>\n\n<p>Here again </p>\n\n<ul>\n<li>5) <strong>move-ctor</strong> of <code>std::shared_prtr&lt;Foo&gt;</code> is called.</li>\n</ul>\n\n<p>In summary, I expect</p>\n\n<pre><code>my_map.insert(make_pair(\"key\", bar()));\n</code></pre>\n\n<p>calls move-ctor of <code>std::shared_ptr&lt;Foo&gt;</code> <strong>twice</strong>.</p>\n\n<p><strong>My answer</strong></p>\n\n<p>Since in both cases no copies of the <code>std::shared_ptr&lt;Foo&gt;</code> are done at all and almost same number of move-ctors are called, their performance would be almost same.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14816409/moving-an-object-into-a-map\">Moving an object into a map</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/17172080/insert-vs-emplace-vs-operator-in-c-map\">insert vs emplace vs operator[] in c++ map</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/39176770/is-c11-operator-equivalent-to-emplace-on-map-insertion\">Is c++11 operator[] equivalent to emplace on map insertion?</a></p>\n\n<hr>\n\n<h2>Note 1,  universal reference</h2>\n\n<p>In C++11 and over, both left and right argument of <code>std::make_pair</code> are what Scott Meyers calls <a href=\"https://isocpp.org/blog/2012/11/universal-references-in-c11-scott-meyers\" rel=\"nofollow noreferrer\">universal reference</a>, that is, they can accept both l-value and r-value:</p>\n\n<pre><code>// until C++11\ntemplate&lt; class T1, class T2 &gt;\nstd::pair&lt;T1,T2&gt; make_pair( T1 t, T2 u );\n\n// since C++11\ntemplate&lt; class T1, class T2 &gt;\nstd::pair&lt;V1,V2&gt; make_pair( T1&amp;&amp; t, T2&amp;&amp; u );\n</code></pre>\n\n<p>Thus if we pass l-value to <code>std::make_pair</code>, then copy-ctor of <code>std::shared_ptr&lt;Foo&gt;</code> is called as a result of the universal reference.</p>\n\n<hr>\n\n<h2>Note 2,  std::map::try_emplace</h2>\n\n<p><code>std::map::emplace</code> always constructs new element of <code>my_map</code> even if the key already exists.\nIf the key already exists, these new instances are destroyed.\nBut since C++17, we get</p>\n\n<pre><code>template &lt;class... Args&gt;\npair&lt;iterator, bool&gt; try_emplace(key_type&amp;&amp; k, Args&amp;&amp;... args);\n</code></pre>\n\n<p>This function does not construct <code>args</code> if the key <code>k</code> already exists in the container.\nAlthough we already know there isn't a duplicate key in the present problem, if we don't know whether there is a duplicate key or not, this <code>std::map::try_emplace</code> would be preferred.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/46046828/is-there-any-reason-to-use-stdmapemplace-instead-of-try-emplace-in-c1z\">Is there any reason to use std::map::emplace() instead of try_emplace() in C++1z?</a></p>\n"}], "owner": {"reputation": 4677, "user_id": 2043465, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/649021e96b1032f4de635a8fdb4654b2?s=128&d=identicon&r=PG", "display_name": "Yossarian", "link": "https://stackoverflow.com/users/2043465/yossarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 1, "accepted_answer_id": 52767076, "answer_count": 1, "score": 2, "last_activity_date": 1539352351, "creation_date": 1539188840, "last_edit_date": 1539352351, "question_id": 52744844, "link": "https://stackoverflow.com/questions/52744844/is-it-correct-to-use-stdmapemplace-with-a-function-returning-a-shared-ptr", "title": "Is it correct to use std::map::emplace with a function returning a shared_ptr?", "body": "<p>If I have some function that returns a <code>std::shared_ptr&lt;T&gt;</code>, how should I insert the result of that function call in a <code>std::map&lt;U, std::shared_ptr&lt;T&gt;&gt;</code>: with <code>insert</code> and <code>make_pair</code> or just <code>emplace</code>?</p>\n\n<p>Let's say I already know there isn't a duplicate key, and that I'm single threaded.</p>\n\n<pre><code>std::shared_ptr&lt;Foo&gt; bar() {\n   return std::make_shared&lt;Foo&gt;();\n}\n\nstd::map&lt;std::string, std::shared_ptr&lt;Foo&gt;&gt; my_map;\n\n// Which makes more sense?\nmy_map.emplace(\"key\", bar());\n// or\nmy_map.insert(make_pair(\"key\", bar()));\n</code></pre>\n\n<p>Does RVO work with <code>std::map::emplace</code>?</p>\n"}, {"tags": ["python", "c++"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1539189532, "post_id": 52744977, "comment_id": 92414572, "body": "It seems very slow. What if I have large objects like images. The parse wouldnt know where to start and end, and would have to parse the object one character at a time"}, {"owner": {"reputation": 3452, "user_id": 2194193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WHD9t.gif?s=128&g=1", "display_name": "Resurrection", "link": "https://stackoverflow.com/users/2194193/resurrection"}, "reply_to_user": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1539190050, "post_id": 52744977, "comment_id": 92414903, "body": "@raaj You should reconsider your design. Passing images in binary form in memory makes no sense. However if you insist and the image is <b>standard_layout</b> data structure you can just pass it&#39;s address to Python and it should work there. But first make sure that you understand what I mean by all that. It is not a trivial matter."}, {"owner": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1539190222, "post_id": 52744977, "comment_id": 92415004, "body": "hold on, is it possible to pass the image pointer address to python?"}, {"owner": {"reputation": 3452, "user_id": 2194193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WHD9t.gif?s=128&g=1", "display_name": "Resurrection", "link": "https://stackoverflow.com/users/2194193/resurrection"}, "reply_to_user": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1539190414, "post_id": 52744977, "comment_id": 92415102, "body": "Yes, if the C++ object you point to is standard_layoyt, declared volatile (if you want to change it in Python) and the Python equivalent expects the same layout."}, {"owner": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1539190463, "post_id": 52744977, "comment_id": 92415133, "body": "where do i even start, what if I have a C++ class with a cv::Mat opencv object, and maybe a bunch of float*"}], "tags": [], "owner": {"reputation": 3452, "user_id": 2194193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WHD9t.gif?s=128&g=1", "display_name": "Resurrection", "link": "https://stackoverflow.com/users/2194193/resurrection"}, "is_accepted": false, "score": 0, "last_activity_date": 1539189383, "creation_date": 1539189383, "answer_id": 52744977, "question_id": 52744801, "link": "https://stackoverflow.com/questions/52744801/python-to-c-data-structure-api/52744977#52744977", "title": "Python to C++ Data structure API", "body": "<p>I would personally recommend serializing your data into JSON in C++ using e.g. <a href=\"http://rapidjson.org/md_doc_tutorial.html\" rel=\"nofollow noreferrer\">rapidjson</a> or <a href=\"http://doc.qt.io/qt-5/json.html\" rel=\"nofollow noreferrer\">Qt</a> and then to transfer the resulting string to Python using the <a href=\"https://docs.python.org/3/c-api/intro.html\" rel=\"nofollow noreferrer\">C API bindings for Python</a> and deserializing it into Python Dictionary there. One-way or two-way transfer should be easy enough.</p>\n\n<p>Note about the C API bindings however. I have used it in the past and it was not pleasant experience in any way or form. Eventually you will make it work and do what you want but it will cost you some nerves.</p>\n\n<p>Lastly do not worry about performance. Since you are using Python (an interpreted language) you are apparently not doing anything performance critical anyway so cost of the JSON (de)serialization can be ignored here.</p>\n\n<p>Good luck because you are going to need it with the Python's C API bindings.</p>\n"}], "owner": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539189383, "creation_date": 1539188652, "question_id": 52744801, "link": "https://stackoverflow.com/questions/52744801/python-to-c-data-structure-api", "title": "Python to C++ Data structure API", "body": "<p>Is there an easy way to pass a complete data structure from C++ to Python and vice-versa easily with multiple data types?</p>\n\n<p>I have a complex class with pointer objects of floats, longs etc. I could convert this into a json string and parse it both ways, but this would be really slow.</p>\n\n<p>However, if we had a special format, that has takes this data, but also stores meta data of the start/end of the json string, it would parse much faster. Is there anything like this?</p>\n"}, {"tags": ["c++", "windows", "dll"], "comments": [{"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "edited": false, "score": 1, "creation_date": 1539189046, "post_id": 52744619, "comment_id": 92414272, "body": "Are you using visual Studio? <a href=\"https://software.intel.com/en-us/articles/visual-studio-debugger-cannot-find-or-open-the-pdb-file\" rel=\"nofollow noreferrer\">software.intel.com/en-us/articles/&hellip;</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539189489, "post_id": 52744619, "comment_id": 92414551, "body": "None of those can&#39;t find pdb file are errors. It just means you don&#39;t have the symbols installed so you can&#39;t debug inside of these dlls (usually that is not needed unless you think you found a bug in the third party dll)."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1539190685, "post_id": 52744619, "comment_id": 92415246, "body": "Looking at the output I do see a problem it looks like you are mixing debug and release in the same application. An application should not require <code>&#39;C:\\Windows\\SysWOW64\\vcruntime140d.dll&#39;</code> and  <code>&#39;C:\\Windows\\SysWOW64\\vcruntime140.dll&#39;</code> at the same time. Note that it&#39;s important to use debug libraries with debug applications and release libraries with release applications. Mixing the two will create Undefined Behavior."}], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 8212390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IIgFbouePYo/AAAAAAAAAAI/AAAAAAAAAE4/8YeCc361Ncw/photo.jpg?sz=128", "display_name": "xX randomryze Xx", "link": "https://stackoverflow.com/users/8212390/xx-randomryze-xx"}, "is_accepted": false, "score": 0, "last_activity_date": 1539410088, "creation_date": 1539410088, "answer_id": 52789971, "question_id": 52744619, "link": "https://stackoverflow.com/questions/52744619/dynamic-linking-in-c/52789971#52789971", "title": "Dynamic Linking in C++", "body": "<p>I think its something to do with your linking in the properties..\nDid you set the configuration to the active Debug and add the library dependecies\n\"sfml-graphics-d.lib\" , \"sfml-system-d. lib\", \"sfml-window-d.lib\" and the dll files with the \"-d\" at the end of the name of the dll file.\nMention the dll files are in the game folder where you should add them</p>\n"}, {"tags": [], "owner": {"reputation": 1035, "user_id": 10504230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wfkm8.jpg?s=128&g=1", "display_name": "Arush Agarampur", "link": "https://stackoverflow.com/users/10504230/arush-agarampur"}, "is_accepted": false, "score": 0, "last_activity_date": 1539550392, "creation_date": 1539550392, "answer_id": 52807001, "question_id": 52744619, "link": "https://stackoverflow.com/questions/52744619/dynamic-linking-in-c/52807001#52807001", "title": "Dynamic Linking in C++", "body": "<p>None of those \"Cannot find or open the PDB\" are errors. They are just saying that the program debug databases for those specified modules have not been found. I don't recommend downloading all of them, so I think that you are fine. If you DO want to download them, use VS's settings and enable download all the symbol files from microsoft symbol servers.</p>\n"}], "owner": {"reputation": 1, "user_id": 10485182, "user_type": "registered", "profile_image": "https://graph.facebook.com/2242191745843964/picture?type=large", "display_name": "Faberdash", "link": "https://stackoverflow.com/users/10485182/faberdash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1539550392, "creation_date": 1539188005, "last_edit_date": 1539188927, "question_id": 52744619, "link": "https://stackoverflow.com/questions/52744619/dynamic-linking-in-c", "title": "Dynamic Linking in C++", "body": "<p>I am currently working on a 2D game as an assignment for one of my courses, I am using SFML (an openGL library) on Visual Studio community 2017. I am debugging for Win32 systems. I linked my header files, all the required libraries and sat the preprocessor to SFML_STATIC. I tried building this example program I got of sfml-dev.org :</p>\n\n<pre><code>#include &lt;SFML/Graphics.hpp&gt;\n\nint main()\n{\n    sf::RenderWindow window(sf::VideoMode(200, 200), \"SFML works!\");\n    sf::CircleShape shape(100.f);\n    shape.setFillColor(sf::Color::Green);\n\n    while (window.isOpen())\n    {\n        sf::Event event;\n        while (window.pollEvent(event))\n        {\n            if (event.type == sf::Event::Closed)\n                window.close();\n        }\n\n        window.clear();\n        window.draw(shape);\n        window.display();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>and I keep getting these errors:</p>\n\n<pre><code>'FinalSpace.exe' (Win32): Loaded 'C:\\Users\\Mo'men\\Desktop\\GUC\\Semester 5\\Graphics\\Assignment 1\\FinalSpace\\Debug\\FinalSpace.exe'. Symbols loaded.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\ntdll.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\kernel32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\KernelBase.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\sfml-window-2.dll'. Module was built without symbols.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\gdi32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\gdi32full.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\msvcp_win.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\ucrtbase.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\user32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\msvcp140d.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\win32u.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\advapi32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\vcruntime140d.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\msvcrt.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\sechost.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\opengl32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\rpcrt4.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\sspicli.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\cryptbase.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\sfml-system-2.dll'. Module was built without symbols.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\bcryptprimitives.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\winmm.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\ucrtbased.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\glu32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\msvcp140.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\vcruntime140.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\winmmbase.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\winmmbase.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Unloaded 'C:\\Windows\\SysWOW64\\winmmbase.dll'\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\cfgmgr32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\imm32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\uxtheme.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\combase.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\msctf.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\oleaut32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\System32\\DriverStore\\FileRepository\\nvhm.inf_amd64_ebea877f10dfbbc7\\nvinit.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\version.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\ig75icd32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Unloaded 'C:\\Windows\\SysWOW64\\ig75icd32.dll'\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\ig75icd32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\shell32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\SHCore.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\windows.storage.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\igdusc32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\shlwapi.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\kernel.appcore.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\profapi.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\powrprof.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\fltLib.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\wtsapi32.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\dwmapi.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Unloaded 'C:\\Windows\\SysWOW64\\version.dll'\n'FinalSpace.exe' (Win32): Unloaded 'C:\\Windows\\System32\\DriverStore\\FileRepository\\nvhm.inf_amd64_ebea877f10dfbbc7\\nvinit.dll'\nThe thread 0x2dac has exited with code 0 (0x0).\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\version.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Unloaded 'C:\\Windows\\SysWOW64\\version.dll'\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\dinput8.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\InputHost.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Unloaded 'C:\\Windows\\SysWOW64\\InputHost.dll'\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\InputHost.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\WinTypes.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\CoreMessaging.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\CoreUIComponents.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\ntmarta.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\hid.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\setupapi.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\devobj.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\wintrust.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\msasn1.dll'. Cannot find or open the PDB file.\n'FinalSpace.exe' (Win32): Loaded 'C:\\Windows\\SysWOW64\\crypt32.dll'. Cannot find or open the PDB file.\nException thrown at 0x7687DDC2 in FinalSpace.exe: Microsoft C++ exception: std::length_error at memory location 0x008FF510.\nUnhandled exception at 0x7687DDC2 in FinalSpace.exe: Microsoft C++ exception: std::length_error at memory location 0x008FF510.\n</code></pre>\n\n<p>What am I doing wrong and How can I fix this?</p>\n"}, {"tags": ["c++", "c++11", "language-lawyer"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1539187706, "post_id": 52744506, "comment_id": 92413522, "body": "A directory isn&#39;t a file."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1539187785, "post_id": 52744506, "comment_id": 92413560, "body": "What do you expect it to do?"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 1, "creation_date": 1539187824, "post_id": 52744506, "comment_id": 92413580, "body": "A directory IS a file on Unix. See <a href=\"https://unix.stackexchange.com/questions/197439/how-is-a-directory-a-special-type-of-file\" title=\"how is a directory a special type of file\">unix.stackexchange.com/questions/197439/&hellip;</a>"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1539187861, "post_id": 52744506, "comment_id": 92413604, "body": "What I expect it to do is to return an ifstream that is good() if the directory exists. Editing q. ."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539187905, "post_id": 52744506, "comment_id": 92413633, "body": "Use <a href=\"https://en.cppreference.com/w/cpp/filesystem\" rel=\"nofollow noreferrer\"><code>&lt;filesystem&gt;</code></a> instead?"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539187949, "post_id": 52744506, "comment_id": 92413656, "body": "@NathanOliver There&#39;s a reason I specified C++ 11\u2026"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539188017, "post_id": 52744506, "comment_id": 92413696, "body": "Sorry, I didn&#39;t see the tag in the title.  I&#39;ve edited it to remove the tag from the title and instead tag the Q with <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b11\">c++11</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1539188176, "post_id": 52744506, "comment_id": 92413778, "body": "&quot;A directory IS a file on Unix.&quot; - but not on other OSs - so this must be at best system-dependent."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1539188180, "post_id": 52744506, "comment_id": 92413779, "body": "Saying that a directory is a file in Unix is somewhat misleading as they don&#39;t support all the same operations, and in any case not relevant here because your question is about portable C++ and not Unix."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1539188328, "post_id": 52744506, "comment_id": 92413864, "body": "@interjay let me be more specific. The C++ 11 standard refers to fopen.   <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.htm&zwnj;&#8203;l</a> gives something that looks like a spec. for fopen, but I think it&#39;s POSIX-specific.  Do you know where I can find a specification for fopen?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1539188329, "post_id": 52744506, "comment_id": 92413865, "body": "Even in unix, you are only supposed to open directories using specific options, which don&#39;t map easily onto FILE* or std::stream. So easy answer is no."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1539188410, "post_id": 52744506, "comment_id": 92413909, "body": "@GemTaylor note <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.htm&zwnj;&#8203;l</a> clearly allows use of fopen on directories. E.g. see error EISDIR which prevents opening of dirs with write access."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1539188513, "post_id": 52744506, "comment_id": 92413971, "body": "The portable reference for <code>fopen</code> is the C standard, which doesn&#39;t say it can open directories. What you linked to is the POSIX version which has some extensions."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1539188570, "post_id": 52744506, "comment_id": 92414004, "body": "The C++ standard doesn&#39;t mention directories or Unix at all. If you want your program to work on Unixes, you need something that guarantees you behaviour on Unixes. The C++ standard isn&#39;t such a document. In practice you are likely to get a <code>good()</code> stream if you specify <code>std::ios_base::in</code> as the open mode. You are not likely to get any good <code>read</code>s from it though."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1539188572, "post_id": 52744506, "comment_id": 92414007, "body": "Also, The opening line clearly says file, and there are no instances of dir except for parent directory and direction. Try again."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1539188667, "post_id": 52744506, "comment_id": 92414059, "body": "@GemTaylor Try searching for &quot;The named file is a directory and mode requires write access.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 2, "creation_date": 1539190511, "post_id": 52744903, "comment_id": 92415161, "body": "The Committee is looking to correct this at some point. There is a technical specification to address it. Programming Languages \u2014 C++ \u2014 File System Technical Specification <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4100.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4100.pdf</a> but it looks like it did not make it into C++17."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1539192385, "post_id": 52744903, "comment_id": 92416130, "body": "@RichardChambers interesting. That states unambiguously that a dir is a file."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1539197701, "post_id": 52744903, "comment_id": 92418560, "body": "@Mohan it might be better to think of it as the <code>filesystem</code> technical spec says that the <code>filesystem</code> function presents a directory as a file. Who knows what the underlying operating system OS is doing and what hoops the Standard Library jumps through under the hood in order to present an interface to that specification."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "is_accepted": true, "score": 2, "last_activity_date": 1539189075, "creation_date": 1539189075, "answer_id": 52744903, "question_id": 52744506, "link": "https://stackoverflow.com/questions/52744506/is-the-behaviour-of-ifstreamifstream-on-directories-well-defined/52744903#52744903", "title": "Is the behaviour of ifstream::ifstream on directories well-defined?", "body": "<p>The standard does not seem to have a mention of the concept of a \"directory\" anywhere in its prose. There is a mention of the EISDIR errno and a general intention to mirror posix, but only \"may use to report low-level conditions\". I would say system-dependent and not portable.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1539189751, "creation_date": 1539189751, "answer_id": 52745078, "question_id": 52744506, "link": "https://stackoverflow.com/questions/52744506/is-the-behaviour-of-ifstreamifstream-on-directories-well-defined/52745078#52745078", "title": "Is the behaviour of ifstream::ifstream on directories well-defined?", "body": "<blockquote>\n  <p>According to what I can find, I should get a valid <code>ifstream</code> (one that is <code>good()</code> if and only if the directory exists.</p>\n</blockquote>\n\n<p>That result is not guaranteed by the standard. I wouldn't use it as a mechanism to check whether a directory exists.</p>\n\n<p>When you are limited to using C++11, your best option is use to platform dependent API calls surrounded by appropriate preprocessor macros.</p>\n\n<pre><code>#if  defined(_WINDOWS)\n// Use Windows specific APIs\n#elif defined(_Linux)\n// Use Linux specific APIs\n#elif defined(_MacOS) ???\n// Use MacOS specific APIs\n#endif\n</code></pre>\n\n<p>More info:</p>\n\n<p>For Windows: <a href=\"https://stackoverflow.com/questions/6218325/how-do-you-check-if-a-directory-exists-on-windows-in-c\">How do you check if a directory exists on Windows in C?</a><br>\nFor Linux: <a href=\"https://stackoverflow.com/questions/3828192/checking-if-a-directory-exists-in-unix-system-call\">Checking if a directory exists in Unix (system call)</a></p>\n"}], "owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52744903, "answer_count": 2, "score": 0, "last_activity_date": 1539189751, "creation_date": 1539187642, "last_edit_date": 1539187971, "question_id": 52744506, "link": "https://stackoverflow.com/questions/52744506/is-the-behaviour-of-ifstreamifstream-on-directories-well-defined", "title": "Is the behaviour of ifstream::ifstream on directories well-defined?", "body": "<p><em>According to the C++11 standard</em>, is the behaviour of  </p>\n\n<pre><code>ifstream in(\".\");\n</code></pre>\n\n<p>specified, or is it system-dependent?</p>\n\n<p>For context, I'm trying to avoid using <code>boost::filesystem</code> and similar libraries because they cause unrelated portability problems.</p>\n\n<p>Edit: According to what I can find, I should get a valid ifstream (one that is 'good()' if and only if the directory exists. This potentially gives a more portable way of testing whether a directory exists than using <code>boost::filesystem</code> because the latter requires you to link against more libraries.</p>\n"}, {"tags": ["c++", "c++11", "cmake"], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 0, "last_activity_date": 1539186894, "creation_date": 1539186894, "answer_id": 52744287, "question_id": 52744225, "link": "https://stackoverflow.com/questions/52744225/cmake-library-linking-using-two-different-compiler-versions/52744287#52744287", "title": "CMake Library Linking using two different compiler versions", "body": "<p>The main issue with this is that the c++11 version has a different abi. If you want to compile c++11 with the old abi, add the macro <code>_GLIBCXX_USE_CXX11_ABI=0</code>.</p>\n\n<p>Then the undefined references should be solved. </p>\n"}], "owner": {"reputation": 21, "user_id": 6018168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f582836a6a5b414929f4a9f50034e7?s=128&d=identicon&r=PG&f=1", "display_name": "Rebrado", "link": "https://stackoverflow.com/users/6018168/rebrado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539190519, "creation_date": 1539186724, "last_edit_date": 1539190519, "question_id": 52744225, "link": "https://stackoverflow.com/questions/52744225/cmake-library-linking-using-two-different-compiler-versions", "title": "CMake Library Linking using two different compiler versions", "body": "<p>I am facing some issues when trying to compile a shared library using CMake on Ubuntu (16.04) and linking it to an executable compiled with CMake on CentOS (6.8).</p>\n\n<p>The first CMakeLists.txt to create the library looks like this:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.0)\n\nproject(MyLibrary)\n\nfile(GLOB ${SOURCES} SOURCES \"src/*.cpp\")\ninclude_directories(${PROJECT_SRC_DIR}/include)\nset(CMAKE_CXX_FLAGS \"-std=c++11\")\n\nadd_library(${PROJECT_NAME} SHARED ${SOURCES})\n</code></pre>\n\n<p>which will create libMyLibrary.so</p>\n\n<p>The second CMakeLists.txt is:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.0)\n\nproject(MyApp)\n\nset(MY_LIB_DIR ${CMAKE_CURRENT_SOURCE_DIR}/../build)\ninclude_directories(${MY_LIB_DIR}/include)\nset(CMAKE_CXX_FLAGS \"-std=c++98\")\n\nadd_executable(${PROJECT_NAME} \"main.cpp\")\ntarget_link_libraries(${PROJECT_NAME} ${CMAKE_CURRENT_SOURCE_DIR}/../build/libMyLibrary.so)\n</code></pre>\n\n<p>Note that the library was built in <code>build</code> directory, while the final executable <code>MyApp</code> is built in a different folder. On Ubuntu this combination works, while generating the library on Ubuntu and compiling only the second part on CentOS throws <code>undefined reference</code> for every function defined in C++11 and not defined in the C++98 standard. In fact, this was initially the reason why I did this: to build the library (containing C++11) with a more recent version of g++, and link it to the executable on CentOS, where an older version, not supporting the standard, is available (I have no root access on CentOS). </p>\n\n<p>I would like to know if what I am trying to do is even possible, and, if yes, what am I missing.</p>\n\n<p><strong>EDIT</strong> After the answer of Matthieu Brucher, I added the flag <code>-D_GLIBCXX_USE_CXX11_ABI=0</code> to the first CMakeLists.txt file, in addition to the <code>-std=c++11</code> flag. This removed <code>undefined reference</code> errors, but stil keeps the following:</p>\n\n<pre><code>undefined reference to `std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::basic_string(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt;&amp;&amp;)@GLIBCXX_3.4.14'\nundefined reference to `std::basic_ios&lt;char, std::char_traits&lt;char&gt;&gt;::operator bool() const@GLIBCXX_3.4.21'\nundefined reference to `std::random_device::_M_getval()@GLIBCXX_3.4.18'\nundefined reference to `std::random_device::_M_fini()@GLIBCXX_3.4.18'\nundefined reference to `std::random_device::_M_init(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)@GLIBCXX_3.4.18'\n</code></pre>\n"}, {"tags": ["c++", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539186930, "post_id": 52744067, "comment_id": 92413060, "body": "Do you want a C++ or C solution? Don&#39;t double-tag like this, each language has their own approach."}, {"owner": {"reputation": 19, "user_id": 7190812, "user_type": "registered", "profile_image": "https://graph.facebook.com/1573461296003562/picture?type=large", "display_name": "Welly Winata", "link": "https://stackoverflow.com/users/7190812/welly-winata"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539187079, "post_id": 52744067, "comment_id": 92413141, "body": "any language will do !"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539187166, "post_id": 52744067, "comment_id": 92413198, "body": "Please don&#39;t do that, it&#39;s really frustrating. If you want C++, that&#39;s fine. If you <i>need</i> C, that&#39;s alright too. Pick one, it helps focus efforts on finding a solution. C++ necessarily includes C, it&#39;s implicit, but double-tagging implies something else."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539187300, "post_id": 52744067, "comment_id": 92413284, "body": "For example: <code>int **temp = new int*[height];</code> is C++, but also probably a bad plan as <code>std::vector</code> or <code>std::array</code> is what you&#39;d normally use here. If this had to be C, <code>new</code> is out of the question. The <code>[C]</code> tag is for people looking to answer C questions, not C++ ones, so keep that in mind."}, {"owner": {"reputation": 19, "user_id": 7190812, "user_type": "registered", "profile_image": "https://graph.facebook.com/1573461296003562/picture?type=large", "display_name": "Welly Winata", "link": "https://stackoverflow.com/users/7190812/welly-winata"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539187531, "post_id": 52744067, "comment_id": 92413412, "body": "okay mate thanks for the input , i will keep that in mind the next time i post something"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539187743, "post_id": 52744067, "comment_id": 92413539, "body": "What&#39;s worth considering here is making a more minimal example to test. For example, a 3x3 or 5x5 pixel image could basically be unit tested, the input and output form should be fairly fixed. This is a highly subjective test making it harder to get to the core of the problem. One approach to help crack this nut is to break up your code into a more pipeline-driven form, either using <a href=\"https://en.wikipedia.org/wiki/Software_design_pattern\" rel=\"nofollow noreferrer\">design patterns</a> or even carving it up into more mission-focused functions. Right now this either works or doesn&#39;t, you can&#39;t test part of it."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1539188651, "post_id": 52744067, "comment_id": 92414047, "body": "Why are you using your own temporary image array? You have OpenCV, just create another image (you can use int instead of char for the pixels) and use that. It would also give you easier ways to clear, scale etc. than manually writing 2D loops each time."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1539188706, "post_id": 52744067, "comment_id": 92414083, "body": "If you use <code>new</code>, you need to use <code>delete</code> as well. You are currently leaking memory."}], "answers": [{"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 0, "last_activity_date": 1539188469, "creation_date": 1539188469, "answer_id": 52744754, "question_id": 52744067, "link": "https://stackoverflow.com/questions/52744067/laplacian-sharpening-result-is-kinda-greyish-c/52744754#52744754", "title": "Laplacian Sharpening result is kinda greyish C++", "body": "<p>The problem is that you are clamping and rescaling the image. Look at the bottom left border of the moon: There are very bright pixels next to very dark pixels, and then some gray pixels right besides the bright ones. Your sharpening filter will really spike on that bright border and increase the maximum. Similarly, the black pixels will be reduced even further.</p>\n\n<p>You then determine minimum and maximum and rescale the entire image. This necessarily means the entire image will lose contrast when displayed in the previous gray scale, because your filter outputted pixel values above 255 and below 0.</p>\n\n<p>Looks closely at the border of the moon in the output image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/c5oZN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c5oZN.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is a black halo (the new 0) and a bright, sharp edge (the new 255). <em>(The browser image scaling made it less crisp in this screenshot, look at your original output).</em> Everything else was squashed by the rescaling, so what was previous black (0) is now dark gray.</p>\n"}, {"tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": true, "score": 0, "last_activity_date": 1539189149, "creation_date": 1539189149, "answer_id": 52744920, "question_id": 52744067, "link": "https://stackoverflow.com/questions/52744067/laplacian-sharpening-result-is-kinda-greyish-c/52744920#52744920", "title": "Laplacian Sharpening result is kinda greyish C++", "body": "<p>The greyness is because, <a href=\"https://stackoverflow.com/a/52744754/7328782\">as Max suggested in his answer</a>, you are scaling to the 0-255 range, not clamping (as your comments in the code suggest).</p>\n\n<p>However, that is not all of the issues in your code. The output of the Laplace operator contains negative values. You nicely store these in an <code>int</code>. But then you scale and copy over to a <code>char</code>. Don't do that!</p>\n\n<p>You need to add the result of the Laplace unchanged to your image. This way, some pixels in your image will become darker, and some lighter. This is what causes the edges to appear sharper.</p>\n\n<p>Simply skip some of the loops in your code, and keep one that does <code>temp = img - temp</code>. That result you can freely scale or clamp to the output range and cast to <code>char</code>.</p>\n\n<p>To clamp, simply set any pixel values below 0 to 0, and any above 255 to 255. Don't compute min/max and scale as you do, because there you reduce contrast and create the greyish wash over your image.</p>\n\n<p>Your recent question is quite similar (though the problem in the code was different), read <a href=\"https://stackoverflow.com/a/52679798/7328782\">my answer there</a> again, it suggests a way to further simplify your code so that <code>img-Laplace</code> becomes a single convolution.</p>\n"}], "owner": {"reputation": 19, "user_id": 7190812, "user_type": "registered", "profile_image": "https://graph.facebook.com/1573461296003562/picture?type=large", "display_name": "Welly Winata", "link": "https://stackoverflow.com/users/7190812/welly-winata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 52744920, "answer_count": 2, "score": 0, "last_activity_date": 1539189149, "creation_date": 1539186222, "last_edit_date": 1539187334, "question_id": 52744067, "link": "https://stackoverflow.com/questions/52744067/laplacian-sharpening-result-is-kinda-greyish-c", "title": "Laplacian Sharpening result is kinda greyish C++", "body": "<p>I am trying to implement laplacian filter for sharpening an image.\nbut the result is kinda grey , I don't know what went wrong with my code.</p>\n\n<p>Here's my work so far</p>\n\n<pre><code>     img = imread(\"moon.png\", 0);\n     Mat convoSharp() {\n\n    //creating new image\n    Mat res = img.clone();\n    for (int y = 0; y &lt; res.rows; y++) {\n        for (int x = 0; x &lt; res.cols; x++) {\n            res.at&lt;uchar&gt;(y, x) = 0.0;\n        }\n    }\n\n    //variable declaration\n    //change -5 to -4 for original result.\n    int filter[3][3] = { {0,1,0},{1,-4,1},{0,1,0} };\n    //int filter[3][3] = { {-1,-2,-1},{0,0,0},{1,2,1} };\n    int height = img.rows;\n    int width = img.cols;\n    int **temp = new int*[height];\n    for (int i = 0; i &lt; height; i++) {\n        temp[i] = new int[width];\n    }\n    for (int i = 0; i &lt; height; i++) {\n        for (int j = 0; j &lt; width; j++) {\n            temp[i][j] = 0;\n        }\n    }\n    int filterHeight = 3;\n    int filterWidth = 3;\n    int newImageHeight = height - filterHeight + 1;\n    int newImageWidth = width - filterWidth + 1;\n    int i, j, h, w;\n\n    //convolution\n    for (i = 0; i &lt; newImageHeight; i++) {\n        for (j = 0; j &lt; newImageWidth; j++) {\n            for (h = i; h &lt; i + filterHeight; h++) {\n                for (w = j; w &lt; j + filterWidth; w++) {\n                    temp[i][j] += filter[h - i][w - j] * (int)img.at&lt;uchar&gt;(h, w);\n                }\n            }\n        }\n    }\n\n    //find max and min\n    int max = 0;\n    int min = 100;\n    for (int i = 0; i &lt; height; i++) {\n        for (int j = 0; j &lt; width; j++) {\n            if (temp[i][j] &gt; max) {\n                max = temp[i][j];\n            }\n            if (temp[i][j] &lt; min) {\n                min = temp[i][j];\n            }\n        }\n    }\n\n    //clamp 0 - 255\n    for (int i = 0; i &lt; height; i++) {\n        for (int j = 0; j &lt; width; j++) {\n            res.at&lt;uchar&gt;(i, j) = 0 + (temp[i][j] - min)*(255 - 0) / (max - min);\n        }\n    }\n\n    //empty the temp array\n    for (int i = 0; i &lt; height; i++) {\n        for (int j = 0; j &lt; width; j++) {\n            temp[i][j] = 0;\n        }\n    }\n\n    //img - res and store it in temp array\n    for (int y = 0; y &lt; res.rows; y++) {\n        for (int x = 0; x &lt; res.cols; x++) {\n            //int a = (int)img.at&lt;uchar&gt;(y, x) - (int)res.at&lt;uchar&gt;(y, x);\n            //cout &lt;&lt; a &lt;&lt; endl;\n            temp[y][x] = (int)img.at&lt;uchar&gt;(y, x) - (int)res.at&lt;uchar&gt;(y, x);\n\n        }\n    }\n\n    //find the new max and min\n    max = 0;\n    min = 100;\n    for (int i = 0; i &lt; height; i++) {\n        for (int j = 0; j &lt; width; j++) {\n            if (temp[i][j] &gt; max) {\n                max = temp[i][j];\n            }\n            if (temp[i][j] &lt; min) {\n                min = temp[i][j];\n            }\n        }\n    }\n\n    //clamp it back to 0-255\n    for (int i = 0; i &lt; height; i++) {\n        for (int j = 0; j &lt; width; j++) {\n            res.at&lt;uchar&gt;(i, j) = 0 + (temp[i][j] - min)*(255 - 0) / (max - min);\n            temp[i][j] = (int)res.at&lt;uchar&gt;(i, j);\n        }\n    }\n\n\n\n    return res;\n}\n</code></pre>\n\n<p>And here's the result</p>\n\n<p><a href=\"https://i.stack.imgur.com/QtARv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QtARv.png\" alt=\"Result\"></a></p>\n\n<p>as you can see in my code above , i already normalize the pixel value to 0-255. i still don't know what went wrong here. Can anyone here explain why is that ?</p>\n"}, {"tags": ["c++", "xcode", "cmake"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544213931, "post_id": 52743881, "comment_id": 94210438, "body": "This is odd, I never had issues on this. Almost each time I change a CMakeLists.txt in my project, I get a &quot;Canceled&quot; state. Sometimes, it even gets to &quot;Failed&quot;, and then I use the GUI to generate the project and it rebuilds the project as I expect."}, {"owner": {"reputation": 5913, "user_id": 1244932, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d2c608e688b798896e8b516855fc1ab1?s=128&d=identicon&r=PG", "display_name": "user1244932", "link": "https://stackoverflow.com/users/1244932/user1244932"}, "edited": false, "score": 0, "creation_date": 1544304200, "post_id": 52743881, "comment_id": 94230597, "body": "May this issue is related <a href=\"https://gitlab.kitware.com/cmake/cmake/issues/14297\" rel=\"nofollow noreferrer\">gitlab.kitware.com/cmake/cmake/issues/14297</a> ? What version of cmake do you use?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 5913, "user_id": 1244932, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d2c608e688b798896e8b516855fc1ab1?s=128&d=identicon&r=PG", "display_name": "user1244932", "link": "https://stackoverflow.com/users/1244932/user1244932"}, "edited": false, "score": 0, "creation_date": 1544451752, "post_id": 52743881, "comment_id": 94269694, "body": "@user1244932 interesting, but this is not that. First of all my other CMake projects are working fine in any scenario and this project doesn&#39;t work even if I select &quot;ALL_BUILD&quot;."}, {"owner": {"reputation": 14813, "user_id": 1887976, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/O57On.png?s=128&g=1", "display_name": "Antwane", "link": "https://stackoverflow.com/users/1887976/antwane"}, "edited": false, "score": 0, "creation_date": 1544710008, "post_id": 52743881, "comment_id": 94378914, "body": "@MarekR can you provide your CMake and XCode versions?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 14813, "user_id": 1887976, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/O57On.png?s=128&g=1", "display_name": "Antwane", "link": "https://stackoverflow.com/users/1887976/antwane"}, "edited": false, "score": 0, "creation_date": 1544711309, "post_id": 52743881, "comment_id": 94379737, "body": "@Antwane: question updated."}], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 729, "favorite_count": 0, "answer_count": 0, "score": 10, "last_activity_date": 1576243326, "creation_date": 1539185702, "last_edit_date": 1576243326, "question_id": 52743881, "link": "https://stackoverflow.com/questions/52743881/cmake-zero-check-fails-to-detect-updates-in-cmakelists-txt-files-for-xcode-gener", "title": "CMake Zero Check fails to detect updates in CMakeLists.txt files for Xcode generator", "body": "<h2>Background</h2>\n\n<p>I have big project which builds runs on windows perfectly.\nWhen some changes are applied in <code>CMakeLists.txt</code> and project is build, Visual Studio project is properly updated.</p>\n\n<p>Xcode version: 10.0 (10A255) or 10.1 (10B61) (tested on different machines).</p>\n\n<p>CMake version: 3.12.2 or 3.13.1</p>\n\n<h2>Problem</h2>\n\n<p>Problem appears when same project is build on Mac OS for Xcode.\nAfter configuring CMake:</p>\n\n<pre><code>cmake .. -G Xcode\n</code></pre>\n\n<p>Generated project works fine, everything builds properly and test are passing.</p>\n\n<p>Now when <code>CMakeLists.txt</code> files are modified (when developing project or when fetching new changes from repository) and <code>ZERO_CHECK</code> or <code>BUILD_ALL</code> are selected, build doesn't lead to Xcode project update.\nInvoking <code>cmake .</code> doesn't detect changes too.</p>\n\n<h2>Workaround</h2>\n\n<p>The best workaround I've found is deleting <del>everything</del> two files: <code>cmake_install.cmake</code> and <code>CMakeCache.txt</code>. Then rerun command which generates project <code>cmake .. -G Xcode</code>.<br>\nIn this scenario whole detection is redone from scratch, but at least build doesn't start from zero (unchanged files are not recompiled).</p>\n\n<p>This is painful, since lots of manual stuff must be done, and project have to be recreated and this consumes time.</p>\n\n<h2>Hints</h2>\n\n<p>In some previous project I had similar problem, but it was happening only if maven was detecting updates for dependencies, so it happened quite rarely. When it happened I just called <code>touch CMakeLists.txt</code> and build again and this workaround was fine. This solution doesn't applies since every build has this issue.</p>\n\n<p>I was suspecting that protobuf generation procedure has something with it, but when I've disabled it problem still persists.</p>\n\n<p>I've tried to provide complete minimal example, by creating simple project file, but I was not able to reproduce the issue. For all other projects it just works, so system configuration is not the issue.</p>\n\n<h2>Questions</h2>\n\n<p>How can I debug project generation process when running <code>cmake</code> to find source of this problem?</p>\n\n<p>Is this a known problem?</p>\n\n<p>Is there a better workaround which will not lead <del>to full rebuild</del> regenerating project file (which also involves detecting system capabilities)?</p>\n"}, {"tags": ["c++", "pointers", "vector", "memcpy"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 4, "creation_date": 1539185331, "post_id": 52743693, "comment_id": 92412108, "body": "replace <code>&amp;nv</code> with <code>nv.data()</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1539187840, "post_id": 52743693, "comment_id": 92413592, "body": "Re: &quot;Copying the vector to a void pointer&quot; -- no, No, NO. The code copies the data to an array of bytes that&#39;s pointed to by a void pointer. Keep that distinction firmly in mind: a pointer <b>points at</b> something, and mostly you care about what it points at."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6313524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26114182100407b8842098f798437955?s=128&d=identicon&r=PG&f=1", "display_name": "shreyas-badiger", "link": "https://stackoverflow.com/users/6313524/shreyas-badiger"}, "edited": false, "score": 0, "creation_date": 1539198505, "post_id": 52743909, "comment_id": 92418908, "body": "In that case, how can I write an object to a buffer? I tried static arrays, they work well. But in my case the problem is that I don&#39;t have the array size known in prior."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1539185756, "creation_date": 1539185756, "answer_id": 52743909, "question_id": 52743693, "link": "https://stackoverflow.com/questions/52743693/memcpy-from-a-vector-to-void-pointer-vice-versa-not-working/52743909#52743909", "title": "memcpy from a vector to void pointer (vice-versa) not working", "body": "<p><code>std::vector</code> object is not an array object. The vector manages a dynamically allocated array. Just like your <code>ptr</code> isn't an array, but simply points to one.</p>\n\n<p>Just like you musn't pass <code>&amp;ptr</code> to <code>malloc</code> (as that would cause the data to be written over the pointer, not the pointed array), so too you musn't pass <code>&amp;nv</code> (as that would cause the data to be read from vector which manages the array, rather than from the array which is being managed). Vector has a member function <code>data</code> which returns a pointer to the internal array.</p>\n"}], "owner": {"reputation": 13, "user_id": 6313524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26114182100407b8842098f798437955?s=128&d=identicon&r=PG&f=1", "display_name": "shreyas-badiger", "link": "https://stackoverflow.com/users/6313524/shreyas-badiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539212680, "creation_date": 1539185128, "last_edit_date": 1539212680, "question_id": 52743693, "link": "https://stackoverflow.com/questions/52743693/memcpy-from-a-vector-to-void-pointer-vice-versa-not-working", "title": "memcpy from a vector to void pointer (vice-versa) not working", "body": "<p>This is struct node with 2 variables.</p>\n\n<pre><code>typedef struct{\n    int a;\n    int b;\n}node;\n</code></pre>\n\n<p>Inserting the values into vector of the node type.</p>\n\n<pre><code>    vector &lt;node&gt; nv;\n    node n;\n\n    n.a = 10;\n    n.b = 20;\n    nv.push_back(n);\n\n    n.a = 100;\n    n.b = 200;\n    nv.push_back(n);\n</code></pre>\n\n<p>Copying the vector to a void pointer.</p>\n\n<pre><code>    void *ptr = malloc(4096);\n    memcpy((char*)ptr,&amp;nv,sizeof(node)*2);\n</code></pre>\n\n<p>Reading the values from the void pointer</p>\n\n<pre><code>    node *temp;\n\n    temp = (node*)malloc(sizeof(node));\n\n    int offset = 0;\n    i = 0;\n    while(i&lt;n){\n        memcpy((node*)temp,(char*)ptr + offset, sizeof(node));\n        cout&lt;&lt;\"a - \"&lt;&lt;temp-&gt;a&lt;&lt;\" b -\"&lt;&lt;temp-&gt;b&lt;&lt;endl;\n        offset += sizeof(node);\n        i++;\n    }\n</code></pre>\n\n<p>I am printing the values of a and b. But they are incorrect and contains random numbers. I am sure that I am hitting the wrong memory location. But not sure where.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 8, "creation_date": 1539184407, "post_id": 52743410, "comment_id": 92411522, "body": "That seems like a pretty poor rule if you ask me. One red flag is that it has exceptions like for <code>swap</code> and copy constructors. Edit : Every time the Google Style Guide comes up I learn something new about it which leads me to lose a little bit more respect for it. Maybe it works well for them but I would not recommend it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 14, "creation_date": 1539184440, "post_id": 52743410, "comment_id": 92411547, "body": "The google C++ guidelines are widely regarded as A Bad Thing."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539184446, "post_id": 52743410, "comment_id": 92411551, "body": "Seconded.  It is the standard convention to pass the stream object by non-const reference."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539184466, "post_id": 52743410, "comment_id": 92411564, "body": "I highly doubt that google wants you to pass the <code>ostream</code> as pointer. Passing a non-const <code>&amp;</code> <b>is</b> the right thing to do because it is a case where passing without const is needed (not by convention but for correctness)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 4, "creation_date": 1539184529, "post_id": 52743410, "comment_id": 92411593, "body": "The stream parameter must be a non-const reference, or it won&#39;t work."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1539184557, "post_id": 52743410, "comment_id": 92411610, "body": "consider that the google guidelines are made for the google code base which probably has millions loc of legacy including worst habits and they have to try their best to keep it managable, if you write your own code then their rules can be completely off"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1539184632, "post_id": 52743410, "comment_id": 92411664, "body": "Flagging this as Opinion Based.  I think the question can be summed up as what does the SO community think of the Google guidelines."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539184726, "post_id": 52743410, "comment_id": 92411714, "body": "anyhow, if you read the google guidelines carefully, they also write &quot;In C++, the function can alternatively declare a reference parameter: int foo(int &amp;val).&quot; so they arent really suggesting you to stay away from using references"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1539184826, "post_id": 52743410, "comment_id": 92411777, "body": "No the Google style guide is wrong here; the code wouldn&#39;t work with a <code>const</code> reference."}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 1, "creation_date": 1539184996, "post_id": 52743410, "comment_id": 92411886, "body": "<code>passing the reference without const is not allowed except for the case that it is needed by convention such as swap()</code> - that is the answer in my opinion. In your case it is needed by convention I&#39;d say."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1539185202, "post_id": 52743410, "comment_id": 92412038, "body": "The problem with many/most style guides is that they aren&#39;t clear about when they&#39;re telling you to do something because it is more correct, and when it&#39;s because they assume other engineers will respond better when they read your code."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1539185268, "post_id": 52743410, "comment_id": 92412083, "body": "This rule actually goes against goal #2 of that guide: &quot;Optimize for the reader, not the writer&quot;. With passing pointers around it is not clear whether we transfer ownership or not, whether parameter can be null or not."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1539186238, "post_id": 52743410, "comment_id": 92412652, "body": "Looks like the people who wrote the google convention don&#39;t understand const correctness."}, {"owner": {"reputation": 151, "user_id": 6377800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271682db2e705ef2a29a0736265559a8?s=128&d=identicon&r=PG", "display_name": "John Cramerus", "link": "https://stackoverflow.com/users/6377800/john-cramerus"}, "edited": false, "score": 0, "creation_date": 1539211984, "post_id": 52743410, "comment_id": 92423999, "body": "I&#39;ve seen this rule in other places, the rational is that it is clear from the call whether or not a parameter is being mutated, rather than a reader of code needing to examine the function signature to see whether or not something being passed is non-const. I think it&#39;s kind of supposed to cater to people who don&#39;t use modern IDEs or similar features.."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 7, "last_activity_date": 1539184805, "creation_date": 1539184805, "answer_id": 52743597, "question_id": 52743410, "link": "https://stackoverflow.com/questions/52743410/overload-operator-in-google-c-style/52743597#52743597", "title": "overload operator&lt;&lt; in google c++ style", "body": "<blockquote>\n  <p>It says that passing the reference without const is not allowed except for the case that it is needed by convention</p>\n</blockquote>\n\n<p>Well, the stream is conventionally passed as a non-const reference into the stream insertion and extraction operators, so it would appear that the rule has allowed an exception for you. As such, defining the suggested overload should be conforming to the rule despite accepting a non-const reference argument.</p>\n\n<p><sup>That said, I'm not an authority on what Google would consider as convention. If you work for Google, you should know whom to ask; If you don't then you don't need to get stressed over their style.</sup></p>\n"}], "owner": {"reputation": 95, "user_id": 7942220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa4b6665694546278fbe7890ab23e1aa?s=128&d=identicon&r=PG&f=1", "display_name": "EKP", "link": "https://stackoverflow.com/users/7942220/ekp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 52743597, "answer_count": 1, "score": 8, "last_activity_date": 1539184805, "creation_date": 1539184230, "last_edit_date": 1539184521, "question_id": 52743410, "link": "https://stackoverflow.com/questions/52743410/overload-operator-in-google-c-style", "title": "overload operator&lt;&lt; in google c++ style", "body": "<p>I try to overload operator&lt;&lt; for my class so that it print member when I do\n    std::cout &lt;&lt; obj;</p>\n\n<p>I see that the way to do this is</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const T&amp; obj)\n{\n  // write obj to stream\n\n  return os;\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/4421706/what-are-the-basic-rules-and-idioms-for-operator-overloading\">What are the basic rules and idioms for operator overloading?</a></p>\n\n<p>However, I try to make my code conforms to Google C++ style guide\n<a href=\"https://google.github.io/styleguide/cppguide.html#Reference_Arguments\" rel=\"noreferrer\">https://google.github.io/styleguide/cppguide.html#Reference_Arguments</a></p>\n\n<p>It says that passing the reference without const is not allowed except for the case that it is needed by convention such as swap(). Is this overloading operator&lt;&lt; in the same category as swap()? or there is a way to do something like</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream* os, const T&amp; obj)\n                                     ^\n</code></pre>\n\n<p>? or something that does not take non-const reference as the input.</p>\n\n<p>If so, please teach me how to do that. Thank you.</p>\n"}, {"tags": ["c++", "linux", "ubuntu", "gcc"], "comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 1, "creation_date": 1539186867, "post_id": 52743262, "comment_id": 92413025, "body": "What&#39;s the faulting instructions? What does <code>lscpu</code> say? What flags are shown in <code>&#47;proc&#47;cpuinfo</code>?"}, {"owner": {"reputation": 41, "user_id": 7722209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9f7998748cbe6f0039ef87f65a9b06f?s=128&d=identicon&r=PG&f=1", "display_name": "shrram", "link": "https://stackoverflow.com/users/7722209/shrram"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1539208635, "post_id": 52743262, "comment_id": 92423046, "body": "@Florian Weimer  I have added Valgrind output to my  question since it was too long to add here. Can you please let me know if you are looking for anything else for faulting instructions ?  I am adding other result to the question as well since they are long"}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 9851332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f8b597adb68176ef681930c559f1c8?s=128&d=identicon&r=PG&f=1", "display_name": "xdimy", "link": "https://stackoverflow.com/users/9851332/xdimy"}, "edited": false, "score": 0, "creation_date": 1570348341, "post_id": 58252191, "comment_id": 102879885, "body": "simply restarting does not show this issue. I think I need to do the shutdown and launch of the VPC, in this case the virtual environment could change the host"}], "tags": [], "owner": {"reputation": 46, "user_id": 9851332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f8b597adb68176ef681930c559f1c8?s=128&d=identicon&r=PG&f=1", "display_name": "xdimy", "link": "https://stackoverflow.com/users/9851332/xdimy"}, "is_accepted": false, "score": -1, "last_activity_date": 1570312697, "last_edit_date": 1570312697, "creation_date": 1570308182, "answer_id": 58252191, "question_id": 52743262, "link": "https://stackoverflow.com/questions/52743262/illegal-instruction-core-dumped-helib/58252191#58252191", "title": "illegal instruction (core dumped ) HElib", "body": "<p>I got into a similar error with illegal instruction in __gmpn_addmul_1 (this is GMP library).\nIt was on cloud virtual pc.\nA program using GMP worked all right but after restarting the VPC once I received this error. I believe the VPC processor architecture was changed for the new reboot.\nI solved the problem by rebuilding the libgmp from the configure stage (when the proc arch is detected)  </p>\n"}], "owner": {"reputation": 41, "user_id": 7722209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9f7998748cbe6f0039ef87f65a9b06f?s=128&d=identicon&r=PG&f=1", "display_name": "shrram", "link": "https://stackoverflow.com/users/7722209/shrram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570312697, "creation_date": 1539183845, "last_edit_date": 1539209397, "question_id": 52743262, "link": "https://stackoverflow.com/questions/52743262/illegal-instruction-core-dumped-helib", "title": "illegal instruction (core dumped ) HElib", "body": "<p>I am new to HElib and I am currently testing homomorphic decryption function for AES. As a part of testing I am manually entering test values for AES key , plain text and the corresponding cipher text. I am then passing the cipher text to homomorphic decryption function to get homomorphic encryption of the plain text. This test code seemed to work fine until last morning where it errored out saying Illegal instruction ( core dumped ) when calling homomorphic decryption function. Failing to find the root cause in the test code, I tried to run Test_AES program given in the github repo and it failed to run as well. In the past when I had this issue once shutting down the VM and restarting it helped. I have tried to debug my test code but to no success. Any help in debugging this would be greatly appreciated.</p>\n\n<pre><code>Pasting the code here :\n\n    uint8_t key[]={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16};\n    uint8_t input[]={51,51,48,48,48,48,48,48,48,48,48,48,48,48,48,48};\n\n    uint8_t cipher[]= {201,133,214,86,19,4,199,214,206,13,152,237,236,11,241,25,108,192,10,102,210,173,131,255,215,110,154,43,202,216,154,1};\n\n\n    //manually adding the test values \n    Vec&lt;uint8_t&gt; aesCtxt(INIT_SIZE, nBlocks16);\n    Vec&lt;uint8_t&gt; ptxt(INIT_SIZE, nBlocks16);\n    for (long i=0;i&lt;ptxt.length();i++)\n    ptxt.put(i,input[i]);\n\n    Vec&lt;uint8_t&gt; aesKey(INIT_SIZE, 16); // AES-128\n    for (long i=0;i&lt;aesKey.length();i++)\n    aesKey.put(i,key[i]);\n\n    Vec&lt;uint8_t&gt; tmpBytes(INIT_SIZE, nBlocks*16);\n    for (long i=0;i&lt;tmpBytes.length();i++)\n    tmpBytes.put(i,cipher[i]);\n\n    cerr &lt;&lt; \" cipher = \"; printState(tmpBytes);\n\n    cout&lt;&lt; \"going to encrypt AES key\";\n\n    vector&lt; Ctxt &gt; encryptedAESkey;\n\n    hAES.encryptAESkey(encryptedAESkey, aesKey, publicKey);\n\n    //going to homomorphically decrypt to get Homomorphic encryption of (ptxt)\n    Vec encodedBytes;\n    encode4AES(encodedBytes, tmpBytes, hAES.getEA()); // encode as HE plaintext\n\n    vector&lt; Ctxt &gt; doublyEncrypted_AES_x;\n    ---------&gt;fails here and shows Illegal instruction (core dumped ).&lt; --------------\n\n    // Allocate space for the output ciphertexts, initialized to zero\n\n    doublyEncrypted_AES_x.resize(encodedBytes.length(), Ctxt(ZeroCtxtLike,encryptedAESkey[0]));\n\n    cout&lt;&lt;\"Dummy encrypt\";\n\n    for (long i=0; i&lt;(long)doublyEncrypted_AES_x.size(); i++) // encode ptxt as HE ctxt\n\n    doublyEncrypted_AES_x[i].DummyEncrypt(encodedBytes[i]);\n\n    hAES.homAESdec(doublyEncrypted_AES_x, encryptedAESkey); // do the real work\n</code></pre>\n\n<p>Thanks in advance !    </p>\n\n<hr>\n\n<p>EDIT :\nAdding Valgrind output : </p>\n\n<pre><code>==2653== Memcheck, a memory error detector\n==2653== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==2653== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==2653== Command: ./Test_AES_x\n==2653== \n*** Test_AES: c=3, L=42, B=23, boot=0, packed=1, m=771 (=[771]), gens=[5], ords=[-32]\ncomputing key-independent tables...done in 1.08 seconds\n  27 primes (21 ctxt/6 special), total bitsize=855.929, security level: -107.015\n  32 slots (2 blocks) per ctxt\ncomputing key-dependent tables...done in 10.368 seconds\ncomputing AES tables...ptxt length32AES key  added  input = [c9 85 d6 56 13  4 c7 d6 ce  d 98 ed ec  b f1 19 6c c0  a 66 d2 ad 83 ff d7 6e 9a 2b ca d8 9a  1 ]going to encrypt AES keyentered funcHE encodedd as plaintextcalling func \nvex amd64-&gt;IR: unhandled instruction bytes: 0xF3 0x4C 0xF 0x38 0xF6 0x57 0x28 0x66\nvex amd64-&gt;IR:   REX=1 REX.W=1 REX.R=1 REX.X=0 REX.B=0\nvex amd64-&gt;IR:   VEX=0 VEX.L=0 VEX.nVVVV=0x0 ESC=0F38\nvex amd64-&gt;IR:   PFX.66=0 PFX.F2=0 PFX.F3=1\n==2653== valgrind: Unrecognised instruction at address 0x4e5e0f2.\n==2653==    at 0x4E5E0F2: __gmpn_addmul_1 (in /usr/local/lib/libgmp.so.10.3.2)\n==2653==    by 0x54F5D2: _ntl_gaorsmul_1(_ntl_gbigint_body*, long, long, _ntl_gbigint_body**) (lip.cpp:8200)\n==2653==    by 0x42F7E3: MulAddTo (ZZ.h:507)\n==2653==    by 0x42F7E3: operator() (DoubleCRT.cpp:730)\n==2653==    by 0x42F7E3: relaxed_exec_index&lt;DoubleCRT::toPoly(NTL::ZZX&amp;, const IndexSet&amp;, bool) const::__lambda5&gt; (BasicThreadPool.h:521)\n==2653==    by 0x42F7E3: DoubleCRT::toPoly(NTL::ZZX&amp;, IndexSet const&amp;, bool) const (DoubleCRT.cpp:741)\n==2653==    by 0x431BC9: toPoly (DoubleCRT.cpp:759)\n==2653==    by 0x431BC9: DoubleCRT::addPrimes(IndexSet const&amp;) (DoubleCRT.cpp:322)\n==2653==    by 0x4332D0: DoubleCRT::breakIntoDigits(std::vector&lt;DoubleCRT, std::allocator&lt;DoubleCRT&gt; &gt;&amp;, long) const (DoubleCRT.cpp:301)\n==2653==    by 0x446C05: Ctxt::keySwitchPart(CtxtPart const&amp;, KeySwitch const&amp;) (Ctxt.cpp:467)\n==2653==    by 0x446F89: Ctxt::reLinearize(long) (Ctxt.cpp:416)\n==2653==    by 0x44829D: Ctxt::smartAutomorph(long) (Ctxt.cpp:1008)\n==2653==    by 0x451DB7: EncryptedArrayDerived&lt;PA_GF2&gt;::rotate1D(Ctxt&amp;, long, long, bool) const (EncryptedArray.cpp:97)\n==2653==    by 0x41111D: decRowShift(Ctxt&amp;, std::vector&lt;DoubleCRT, std::allocator&lt;DoubleCRT&gt; &gt; const&amp;, EncryptedArrayDerived&lt;PA_GF2&gt; const&amp;) (homAES.cpp:713)\n==2653==    by 0x4132E9: HomAES::homAESdec(std::vector&lt;Ctxt, std::allocator&lt;Ctxt&gt; &gt;&amp;, std::vector&lt;Ctxt, std::allocator&lt;Ctxt&gt; &gt; const&amp;) const (homAES.cpp:316)\n==2653==    by 0x406567: main (Test_AES.cpp:248)\n==2653== Your program just tried to execute an instruction that Valgrind\n==2653== did not recognise.  There are two possible reasons for this.\n==2653== 1. Your program has a bug and erroneously jumped to a non-code\n==2653==    location.  If you are running Memcheck and you just saw a\n==2653==    warning about a bad jump, it's probably your program's fault.\n==2653== 2. The instruction is legitimate but Valgrind doesn't handle it,\n==2653==    i.e. it's Valgrind's fault.  If you think this is the case or\n==2653==    you are not sure, please let us know and we'll try to fix it.\n==2653== Either way, Valgrind will now raise a SIGILL signal which will\n==2653== probably kill your program.\n==2653== \n==2653== Process terminating with default action of signal 4 (SIGILL)\n==2653==  Illegal opcode at address 0x4E5E0F2\n==2653==    at 0x4E5E0F2: __gmpn_addmul_1 (in /usr/local/lib/libgmp.so.10.3.2)\n==2653==    by 0x54F5D2: _ntl_gaorsmul_1(_ntl_gbigint_body*, long, long, _ntl_gbigint_body**) (lip.cpp:8200)\n==2653==    by 0x42F7E3: MulAddTo (ZZ.h:507)\n==2653==    by 0x42F7E3: operator() (DoubleCRT.cpp:730)\n==2653==    by 0x42F7E3: relaxed_exec_index&lt;DoubleCRT::toPoly(NTL::ZZX&amp;, const IndexSet&amp;, bool) const::__lambda5&gt; (BasicThreadPool.h:521)\n==2653==    by 0x42F7E3: DoubleCRT::toPoly(NTL::ZZX&amp;, IndexSet const&amp;, bool) const (DoubleCRT.cpp:741)\n==2653==    by 0x431BC9: toPoly (DoubleCRT.cpp:759)\n==2653==    by 0x431BC9: DoubleCRT::addPrimes(IndexSet const&amp;) (DoubleCRT.cpp:322)\n==2653==    by 0x4332D0: DoubleCRT::breakIntoDigits(std::vector&lt;DoubleCRT, std::allocator&lt;DoubleCRT&gt; &gt;&amp;, long) const (DoubleCRT.cpp:301)\n==2653==    by 0x446C05: Ctxt::keySwitchPart(CtxtPart const&amp;, KeySwitch const&amp;) (Ctxt.cpp:467)\n==2653==    by 0x446F89: Ctxt::reLinearize(long) (Ctxt.cpp:416)\n==2653==    by 0x44829D: Ctxt::smartAutomorph(long) (Ctxt.cpp:1008)\n==2653==    by 0x451DB7: EncryptedArrayDerived&lt;PA_GF2&gt;::rotate1D(Ctxt&amp;, long, long, bool) const (EncryptedArray.cpp:97)\n==2653==    by 0x41111D: decRowShift(Ctxt&amp;, std::vector&lt;DoubleCRT, std::allocator&lt;DoubleCRT&gt; &gt; const&amp;, EncryptedArrayDerived&lt;PA_GF2&gt; const&amp;) (homAES.cpp:713)\n==2653==    by 0x4132E9: HomAES::homAESdec(std::vector&lt;Ctxt, std::allocator&lt;Ctxt&gt; &gt;&amp;, std::vector&lt;Ctxt, std::allocator&lt;Ctxt&gt; &gt; const&amp;) const (homAES.cpp:316)\n==2653==    by 0x406567: main (Test_AES.cpp:248)\nDummy encryptHE dummy encrypt ==2653== \n==2653== HEAP SUMMARY:\n==2653==     in use at exit: 26,478,071 bytes in 16,450 blocks\n==2653==   total heap usage: 183,015 allocs, 166,565 frees, 110,651,486 bytes allocated\n==2653== \n==2653== LEAK SUMMARY:\n==2653==    definitely lost: 0 bytes in 0 blocks\n==2653==    indirectly lost: 0 bytes in 0 blocks\n==2653==      possibly lost: 24,531,862 bytes in 9,564 blocks\n==2653==    still reachable: 1,946,209 bytes in 6,886 blocks\n==2653==         suppressed: 0 bytes in 0 blocks\n==2653== Rerun with --leak-check=full to see details of leaked memory\n==2653== \n==2653== For counts of detected and suppressed errors, rerun with: -v\n==2653== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\nIllegal instruction (core dumped)\n</code></pre>\n\n<p>lscpu :</p>\n\n<pre><code>Architecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                2\nOn-line CPU(s) list:   0,1\nThread(s) per core:    1\nCore(s) per socket:    2\nSocket(s):             1\nNUMA node(s):          1\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 63\nStepping:              2\nCPU MHz:               2394.420\nBogoMIPS:              4788.84\nHypervisor vendor:     Microsoft\nVirtualization type:   full\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              256K\nL3 cache:              30720K\nNUMA node0 CPU(s):     0,1\n</code></pre>\n\n<p>/proc/cpuinfo</p>\n\n<p>processor 0:</p>\n\n<pre><code>flags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm invpcid_single kaiser fsgsbase bmi1 avx2 smep bmi2 erms invpcid xsaveopt\n</code></pre>\n\n<p>processor 1 :</p>\n\n<pre><code> flags      : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm invpcid_single kaiser fsgsbase bmi1 avx2 smep bmi2 erms invpcid xsaveopt`\n</code></pre>\n"}, {"tags": ["c++", "vector", "data-structures"], "comments": [{"owner": {"reputation": 28036, "user_id": 4826457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXT0U.jpg?s=128&g=1", "display_name": "Suraj Rao", "link": "https://stackoverflow.com/users/4826457/suraj-rao"}, "edited": false, "score": 3, "creation_date": 1539183913, "post_id": 52743254, "comment_id": 92411158, "body": "Please dont add garbage to your post just to get through the editor conditions.. Explain the issue."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1539186995, "post_id": 52743254, "comment_id": 92413088, "body": "Maybe your class hierarchy is backwards? Perhaps if you make the base class the one that&#39;s capable of writing, and derive a class from it that isn&#39;t."}, {"owner": {"reputation": 1, "user_id": 9215124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f56c4981a2291aab2ca77ba7a0bf214?s=128&d=identicon&r=PG", "display_name": "user9215124", "link": "https://stackoverflow.com/users/9215124/user9215124"}, "edited": false, "score": 0, "creation_date": 1539189973, "post_id": 52743254, "comment_id": 92414861, "body": "Thank you all guys!!!!!!!"}], "answers": [{"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 1, "last_activity_date": 1539196808, "last_edit_date": 1539196808, "creation_date": 1539187208, "answer_id": 52744386, "question_id": 52743254, "link": "https://stackoverflow.com/questions/52743254/derived-class-cannot-access-base-classs-protected-member-variable-without-base/52744386#52744386", "title": "Derived class cannot access base class&#39;s protected member variable without base class&#39;s qualifier", "body": "<p>This is just a result of C++'s template name-lookup rules. You could also use <code>this-&gt;</code> instead of the base class qualifier. Basically, in order to make a name lookup depend on a template argument, you have to use that template argument (even if indirectly through a <code>typedef</code> or <code>using</code>) as part of the name. And note that MSVC still does not enforce this by default, you have to use the <code>/permissive-</code> flag to get this behavior with MSVC.</p>\n"}], "owner": {"reputation": 1, "user_id": 9215124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f56c4981a2291aab2ca77ba7a0bf214?s=128&d=identicon&r=PG", "display_name": "user9215124", "link": "https://stackoverflow.com/users/9215124/user9215124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1539196808, "creation_date": 1539183831, "last_edit_date": 1539183870, "question_id": 52743254, "link": "https://stackoverflow.com/questions/52743254/derived-class-cannot-access-base-classs-protected-member-variable-without-base", "title": "Derived class cannot access base class&#39;s protected member variable without base class&#39;s qualifier", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;utility&gt;\n\ntemplate &lt;typename Object&gt;\nclass Vector {\nclass const_iterator {\npublic:\n    const Object&amp; operator * () const       { return retrieve(); }\n\n    const_iterator&amp; operator ++ () {\n        ++current;\n        return *this;\n    }\n\n    const_iterator operator ++ (int) {\n        auto old { *this};\n        ++( *this);\n        return old;\n    }\n\n    bool operator == (const const_iterator&amp; rhs) const      { return current == rhs.current; }\n    bool operator != (const const_iterator&amp; rhs) const      { return !( *this == rhs); }\n\nprotected:\n    Object* current;\n    const Vector&lt;Object&gt;* theVect;\n\n    Object&amp; retrieve() const {\n        assertIsValid();\n        return *current;\n    }\n\n    const_iterator(const Vector&lt;Object&gt;&amp; vect, Object* p)\n        : theVect { &amp;vect}, current {p}         { }\n\n    void assertIsValid() const {\n        if (theVect == nullptr || current == nullptr) {\n            // throw IteratorOutOfBoundsException();\n        }\n    }\n\n    friend class Vector&lt;Object&gt;;\n};\n\nclass iterator : public const_iterator {\npublic:\n    const Object&amp; operator * () const       { return const_iterator::operator * (); }\n    Object&amp; operator * ()       { return const_cast&lt;Object&amp; &gt; (std::as_const( *this).operator * () ); }\n\n    iterator&amp; operator ++ () {\n</code></pre>\n\n<p>Why current here cannot be accessed without \"const_iterator::\"? <br>\nBut \"++const_iterator::current\" is OK. <br>\nWhat's going on here? Could anyone help me out? Thank you very much!!! </p>\n\n<pre><code>        ++current;\n        return *this;\n    }\n\n    iterator operator ++ (int) {\n        auto old { *this};\n        ++ ( *this);\n        return old;\n    }\n\nprotected:\n    iterator(const Vector&lt;Object&gt;&amp; vect, Object* p) \n      : const_iterator(vect, p)       { }\n\n    friend class Vector&lt;Object&gt;;\n};\n};\n</code></pre>\n"}, {"tags": ["c++", "dictionary"], "answers": [{"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1539184072, "post_id": 52743185, "comment_id": 92411269, "body": "I&#39;d consider it worth a mention that creating the iterators is linear in the size of the map. It&#39;s probably premature optimization to therefore advance from <code>it</code> by half the map size to get <code>end</code> instead (or going backwards from the end - although that would be more symmetric), but ymmv."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7295926"}, "edited": false, "score": 0, "creation_date": 1539184139, "post_id": 52743185, "comment_id": 92411323, "body": "Thanks, that&#39;s a neat idea, using the iterators. I suppose defining more iterators is the most efficient approach for working on subsets of a map? Meaning instead of creating multiple maps? The map itself is created using a pointer to a list."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539184359, "post_id": 52743185, "comment_id": 92411487, "body": "@fitzy_blarb As long as you aren&#39;t mutating the map (adding or removing elements) then I would just work on slices instead of copying it into a new map.  copying is expensive and if could be avoided it should be."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 3, "last_activity_date": 1539187726, "last_edit_date": 1539187726, "creation_date": 1539183642, "answer_id": 52743185, "question_id": 52743104, "link": "https://stackoverflow.com/questions/52743104/how-to-access-a-range-interval-of-keys-in-an-ordered-map-in-c/52743185#52743185", "title": "How to access a range/interval of keys in an ordered map in C++?", "body": "<p>Just get iterators to the beginning and end of the range you want to inspect like</p>\n\n<pre><code>auto it = std::next(map.begin(), map.size() / 4);\nauto end = std::next(map.begin(), map.size() * 3 / 4);\n</code></pre>\n\n<p>and then you can iterate that range like</p>\n\n<pre><code>for (; it != end; ++it)\n{\n    // do stuff here\n}\n</code></pre>\n\n<p>You don't even need the end iterator if you want to you a counter.  This saves you the cost of advancing the end iterator through the map which could make a difference, especially on larger maps.  That would look like</p>\n\n<pre><code>auto it = std::next(map.begin(), map.size() / 4);\nauto end = map.size() / 2;\nfor (size_t counter = 0; counter &lt; end; ++it, ++counter)\n{\n    // do stuff here\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 0, "last_activity_date": 1539183864, "creation_date": 1539183864, "answer_id": 52743277, "question_id": 52743104, "link": "https://stackoverflow.com/questions/52743104/how-to-access-a-range-interval-of-keys-in-an-ordered-map-in-c/52743277#52743277", "title": "How to access a range/interval of keys in an ordered map in C++?", "body": "<p>You cannot efficiently get this information from a <code>std::map</code> iterator, because they are not random access (but only bidirectional). In other words, given a <code>std::map</code> iterator, you can find out how many entries are before and after it only by decrementing/incrementing it until you are at the start/end. If you do this for every entry (e.g. in some <code>&lt;algorithm&gt;</code> function), that's risking a performance bottleneck - which may be acceptable in your situation, but you should be aware of it.</p>\n\n<p>If you can do what NathanOliver suggests, that's great, but there are situations where it might not be that easy (e.g. non-contiguous ranges).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7295926"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 52743185, "answer_count": 2, "score": 1, "last_activity_date": 1539187726, "creation_date": 1539183380, "last_edit_date": 1539183797, "question_id": 52743104, "link": "https://stackoverflow.com/questions/52743104/how-to-access-a-range-interval-of-keys-in-an-ordered-map-in-c", "title": "How to access a range/interval of keys in an ordered map in C++?", "body": "<p>I am trying to write an if-condition where I want to execute code depending on which elements of a map are accessed, e.g. for a map with 100 elements only for elements 26 to 74. But I do not want to address specific keys but rather a certain fraction of the map. Should I do this with the <code>[]</code> operator? I tried </p>\n\n<pre><code>if(map.size()/4 &lt; iterator &lt; map.size()*3/4){}\n</code></pre>\n\n<p>but this does not work. </p>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "edited": false, "score": 0, "creation_date": 1539183676, "post_id": 52743021, "comment_id": 92410977, "body": "I can&#39;t answer your question appropriately but just want to mention, that cmake might be a good alternative instead of writing Makefiles manually."}, {"owner": {"reputation": 795, "user_id": 10010538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae98bb47d1be523619caaba61416d37?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/10010538/eric"}, "reply_to_user": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "edited": false, "score": 0, "creation_date": 1539184221, "post_id": 52743021, "comment_id": 92411379, "body": "Im am using Visual Studio Code for my project so i was looking for a way to compile it from withing the build task ( Currently looks like this : &quot;-f.vscode/Makefile&quot; ). From my understanding, cmake is able to produce makefiles.  So that would mean i have to generate a new one with cmake every time i add new files to my project which would be kind of the same sort of issue im trying to get out of my makefile. Or am i missing something there?"}, {"owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "edited": false, "score": 0, "creation_date": 1539184620, "post_id": 52743021, "comment_id": 92411656, "body": "You can specify in cmake also globs using wildcards, so that is not a big problem."}], "answers": [{"comments": [{"owner": {"reputation": 795, "user_id": 10010538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae98bb47d1be523619caaba61416d37?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/10010538/eric"}, "edited": false, "score": 0, "creation_date": 1539331170, "post_id": 52743386, "comment_id": 92471625, "body": "when i use SOURCEFILES = $(wildcard $(SRC)*.cpp) i get the following errors:  Error .vscode/Makefile 25:  No match found for wildcard &#39;<i>.cpp)&#39; Error .vscode/Makefile 27:  No match found for wildcard &#39;</i>.o)&#39;"}], "tags": [], "owner": {"reputation": 38, "user_id": 10248878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99ce7807bb8730759b0953817b1d6b0?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo Hrybok", "link": "https://stackoverflow.com/users/10248878/pavlo-hrybok"}, "is_accepted": false, "score": 1, "last_activity_date": 1539184177, "creation_date": 1539184177, "answer_id": 52743386, "question_id": 52743021, "link": "https://stackoverflow.com/questions/52743021/makefile-dynamic-source-file-names-and-object-directory/52743386#52743386", "title": "Makefile: dynamic source file names and object directory", "body": "<p>I'm kinda suprised that wildcard doesn't work for you, any error codes you could share?<br>\nUsually I write my SRCS and OBJS variables like this:</p>\n\n<pre><code>SRCS = $(wildcard src/*.cpp) \\\n       $(wildcard test/*.cpp)\nOBJS = $(patsubst %.cpp,$(BINDIR)/%.o,$(SRCS))\n</code></pre>\n\n<p>And to build your object files into another directory you could write something like this: </p>\n\n<pre><code>$(BINDIR)/%.o: %.cpp\n    $(CXX) $(CXXFLAGS) $(INCLUDES) -c $&lt; -o $@\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "is_accepted": true, "score": 0, "last_activity_date": 1539184322, "creation_date": 1539184322, "answer_id": 52743442, "question_id": 52743021, "link": "https://stackoverflow.com/questions/52743021/makefile-dynamic-source-file-names-and-object-directory/52743442#52743442", "title": "Makefile: dynamic source file names and object directory", "body": "<ol>\n<li><p><code>wildcard</code> should work:</p>\n\n<pre><code>SOURCEFILES = $(wildcard $(SRC)/*.cpp)\n</code></pre></li>\n<li><p>But if you plan to have your source files in various subdirectories of <code>Src/Source/</code>, it will not work that well. Use the <code>find</code> utility instead, thanks to the <code>shell</code> make function. And yes, you can store all your object files in a separate directory:</p>\n\n<pre><code>CC  = g++ -g\nSRC = Src/Source/\nOBJ = Obj/\nBIN = Bin/\nINC = -I Lib/SFML/include/ -I Src/Header/\nLIB = -L Lib/SFML/lib/ -lsfml-graphics-d -lsfml-window-d -lsfml-system-d\nEXE = $(BIN)Test.exe\n\nSOURCEFILES = $(shell find $(SRC) -type f -name *.cpp)\nOBJECTFILES = $(patsubst $(SRC)%.cpp,$(OBJ)%.o,$(SOURCEFILES))\n\nall: $(SOURCEFILES) $(EXE)\n\n$(EXE): $(OBJECTFILE)\n    $(CC) -o $@ $^ $(LIB)\n\n$(OBJ)%.o: $(SRC)%.cpp\n    mkdir -p $(dir $@)\n    $(CC) -c $&lt; $(INC) -o $@\n</code></pre></li>\n</ol>\n\n<p>Note that I also modified your <code>EXE</code> definition such that the corresponding rule is a real files-to-file make rule and uses the <code>$@</code> and <code>$^</code> automatic variables.</p>\n"}], "owner": {"reputation": 795, "user_id": 10010538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae98bb47d1be523619caaba61416d37?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/10010538/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 52743442, "answer_count": 2, "score": 0, "last_activity_date": 1539184322, "creation_date": 1539183101, "question_id": 52743021, "link": "https://stackoverflow.com/questions/52743021/makefile-dynamic-source-file-names-and-object-directory", "title": "Makefile: dynamic source file names and object directory", "body": "<p>Im currently trying to improve the makefile im using to build my c++ project using the sfml-framework. The folder structure of my project currently looks like this:</p>\n\n<ul>\n<li>Src/Header for Header Files</li>\n<li>Src/Source for .cpp Files</li>\n<li>Bin/ for the .exe</li>\n<li>Lib/ for the sfml library</li>\n</ul>\n\n<p>My current makefile:</p>\n\n<pre><code>CC  = g++ -g    \n\nSRC = Src/Source/  \n\nBIN = Bin/    \n\nINC = -I Lib/SFML/include/ -I Src/Header/    \n\nLIB = -L Lib/SFML/lib/ -lsfml-graphics-d -lsfml-window-d -lsfml-system-d\n\nEXE = Test     \n\nSOURCEFILES = $(SRC)Main.cpp $(SRC)Menu.cpp $(SRC)Button.cpp\n\nOBJ = $(SOURCEFILES:.cpp=.o)\n\nall: $(SOURCEFILES) $(EXE)\n\n$(EXE) : $(OBJ)\n    $(CC) -o $(BIN)$(EXE).exe $(OBJ) $(LIB)\n\n.cpp.o:\n    $(CC) -c $&lt; $(INC) -o $@\n</code></pre>\n\n<p>This makefile works fine, however there are a few things i would like to improve but could not get to work.</p>\n\n<ol>\n<li><p>It's currently nessecary to add all cpp files manually to the list of source files. Since the project is most likely going to grow fast in terms of file count and i kind of want to split the source files into different subdirectories this is going to be a mess very soon. I tried to get all cpp files in a directory with $(wildcard Src/Source/*.cpp) instead of listing them individually but it failed to even execute the makefile. What am i missing there?</p></li>\n<li><p>With my current makefile all .o files are placed at the same location as the .cpp file which is also something i dont really want. Is there a way to output all .o files in a extra \\obj\\ directory and link it into the .exe from there?</p></li>\n</ol>\n\n<p>Also since this is the first time im writing a makefile if there are some general improvements to my approach any advice is appreciated aswell.</p>\n"}, {"tags": ["c++", "c++11", "memory-alignment"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1539184199, "post_id": 52742899, "comment_id": 92411372, "body": "<i>However, in a larger program with a very similar class structure, and also using alignas to 128 bytes, the fields end up coming out as not aligned as specified.</i> - you need to post an example that demonstrates the behaviour you observe."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1539184743, "post_id": 52742899, "comment_id": 92411721, "body": "set align to members proper way, if it need. but always need set members with lager align to the front. you need move <code>a, b</code> to the begin of class. in your current implementation <code>sizeof (Foo) == 3*128</code>, if move a,b to the begin - will be <code>2*128</code>. adding dummy fields not proper way, it can not change default align at all"}], "owner": {"reputation": 712, "user_id": 4438651, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/19c65aec0e9e4476777f960719df3473?s=128&d=identicon&r=PG&f=1", "display_name": "Kulluk007", "link": "https://stackoverflow.com/users/4438651/kulluk007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1539191429, "creation_date": 1539182714, "last_edit_date": 1539191429, "question_id": 52742899, "link": "https://stackoverflow.com/questions/52742899/aligning-class-members-in-c11", "title": "Aligning Class Members in C++11", "body": "<p>I'm trying to align class members to specific alignments (e.g., 128) in C++11 to avoid false sharing between threads. My approach is to use <code>alignas</code> but I'm getting mixed results. In this simple program, I'm getting the results I desire:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;atomic&gt;\n\nstruct Foo {\n\n    char foo[128];\n\n    void* x1;\n    uint32_t x2;\n    uint32_t x3; // here an \"entry\" is only the\n\n    alignas(128) std::atomic&lt;unsigned int&gt; a;\n    alignas(16) std::atomic&lt;unsigned int&gt; b;\n\n};\n\n\nint main(int argc, char const *argv[])\n{\n\n    Foo x, y;\n\n    printf(\"alignof(Foo x) = %zu\\n\", alignof(x));\n    printf(\"alignof(Foo x.a) = %zu\\tmod 128 = %d\\n\", alignof(x.a), reinterpret_cast&lt;uintptr_t&gt;(&amp;(x.a)) % 128);\n    printf(\"alignof(Foo x.b) = %zu\\tmod 16 = %d\\n\", alignof(x.b), reinterpret_cast&lt;uintptr_t&gt;(&amp;(x.b)) % 16);\n\n    /* code */\n    return 0;\n}\n</code></pre>\n\n<p>However, in a larger program with a very similar class structure, and also using <code>alignas</code> to 128 bytes. When I print out the <code>alignof</code> of the fields, I get what I expect and what I specified in the <code>alignas</code> attribute. However, when I mod address of the relevant fields, I don't get the same value as the <code>alignas</code> argument (128) -- I get 32. <strong>I'm expecting <code>alignas</code> to put the variable in memory at the beginning of a memory address that divides evenly by 128; is this expectation valid?</strong> </p>\n\n<p>Note that in the program below, I get the expected results when compiling with clang 6.0.1. I can't post that larger program because it's very large and can't be shared. I also haven't been able to come up with a test program that replicates the particular issue yet but I continue to try.</p>\n\n<p><strong>Questions:</strong></p>\n\n<ul>\n<li>Is my approach to align specific members within a class the recommended one for C++11?</li>\n<li>If not, what is the proper way? Is adding dummy fields such as <code>char _pad[120]</code> the way?</li>\n<li>Should I also be aligning the overall class itself? Right now I'm not explicitly doing so.</li>\n</ul>\n"}, {"tags": ["c++", "labview", "interprocess"], "comments": [{"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 0, "creation_date": 1539183677, "post_id": 52742884, "comment_id": 92410978, "body": "It could be done...but why?  Put your function in a header file and #include &quot;function.h&quot; it in your &quot;other&quot; program...but why?  Why I ask...why?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10375131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lWODfMjHnOY/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-_pY_vZBZvzznnlswPdrikj7uGA/mo/photo.jpg?sz=128", "display_name": "Marcel Rudolf", "link": "https://stackoverflow.com/users/10375131/marcel-rudolf"}, "edited": false, "score": 0, "creation_date": 1539188134, "post_id": 52743194, "comment_id": 92413758, "body": "thank you for your answer. so I will try to make use of shared memory."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1539183671, "last_edit_date": 1592644375, "creation_date": 1539183671, "answer_id": 52743194, "question_id": 52742884, "link": "https://stackoverflow.com/questions/52742884/calling-a-function-in-a-running-c-program-with-another-program/52743194#52743194", "title": "calling a function in a running c++ program with another program", "body": "<blockquote>\n<p>calling a function in a running c++ program with another program</p>\n<p>Is this possible?</p>\n</blockquote>\n<p>Not directly, no.</p>\n<p>It is possible to communicate between processes, and inform the running process, that it should call its own function. Also, abstraction layers have been designed, which allow abstracting away the implementation details and program as if the function is executed locally. For example: CORBA.</p>\n<p>Standard C++ has neither a high level IPC (inter process communication) abstraction API, nor even a low level IPC API - although networking is proposed for an upcoming standard.</p>\n<blockquote>\n<p>What would be a fast way to do this?</p>\n</blockquote>\n<p>If your processes run on the same system, then shared memory is a relatively fast IPC mechanism if your system supports it.</p>\n"}], "owner": {"reputation": 43, "user_id": 10375131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lWODfMjHnOY/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-_pY_vZBZvzznnlswPdrikj7uGA/mo/photo.jpg?sz=128", "display_name": "Marcel Rudolf", "link": "https://stackoverflow.com/users/10375131/marcel-rudolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "accepted_answer_id": 52743194, "answer_count": 1, "score": 1, "last_activity_date": 1539183671, "creation_date": 1539182666, "question_id": 52742884, "link": "https://stackoverflow.com/questions/52742884/calling-a-function-in-a-running-c-program-with-another-program", "title": "calling a function in a running c++ program with another program", "body": "<p>I wonder if it is possible to start a function in a running c++ program, from outside the program. For example I have a Labview program, and I would like this program to call a function in the c++ program. Is this possible? What would be a fast way to do this? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539182683, "post_id": 52742833, "comment_id": 92410375, "body": "Can you copy and paste the exact error messages into your post?  You can copy from the output tab"}, {"owner": {"reputation": 203, "user_id": 7582537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ed009f37560df708eb5b87a6a17557?s=128&d=identicon&r=PG&f=1", "display_name": "uMdRupert", "link": "https://stackoverflow.com/users/7582537/umdrupert"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539182861, "post_id": 52742833, "comment_id": 92410490, "body": "@NathanOliver Oops yeah, edited."}], "owner": {"reputation": 203, "user_id": 7582537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ed009f37560df708eb5b87a6a17557?s=128&d=identicon&r=PG&f=1", "display_name": "uMdRupert", "link": "https://stackoverflow.com/users/7582537/umdrupert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1539182979, "answer_count": 0, "score": 2, "last_activity_date": 1539182835, "creation_date": 1539182546, "last_edit_date": 1539182835, "question_id": 52742833, "link": "https://stackoverflow.com/questions/52742833/compiler-error-c2371-redefinition-of-basic-types-for-unknown-reason", "closed_reason": "Duplicate", "title": "Compiler Error C2371 &quot;redefinition of basic types&quot; for unknown reason", "body": "<p>I'm using visual studio community 2017. I have researched this issue and double checked that I am declare my value, and that I am not redefining, I have checked header guards. I cannot figure out what is going wrong. Here is the code:</p>\n\n<pre><code>#include &lt;vector&gt;\n\nclass FindLargestInt\n{\n    FindLargestInt(std::vector&lt;int&gt; &amp;myVec)\n    {\n        int n = myVec[0];\n        for (int i = 0; i &lt; myVec.size(); i++)\n        {\n            if (myVec[i] &gt; n)\n                n = myVec[i];\n        }\n        printf(\"%d\", n);\n    }\n\n\n};\n\nint main()\n{\n    std::vector&lt;int&gt; myVector{ 0, 3, 6, 8, 5 };\n\n    FindLargestInt(myVector);\n\n    system(\"PAUSE\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Thanks anyone for your help.</p>\n\n<pre><code>Error   C2371   'myVector': redefinition; different basic types (line 29)\n\nError   C2512   'FindLargestInt': no appropriate default constructor available (line 29)    \n</code></pre>\n"}, {"tags": ["c++", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1539182595, "post_id": 52742665, "comment_id": 92410311, "body": "Hello, VBA runs in Excel. You can&#39;t (practically) run an Excel on a webserver. So no, no practical way to run a VBA code on a website. You will have to rewrite the comparison logic in another programming language, C#, java, whatever floats your boat. Use an SDK to manipulate Excel files (for example Office Open XML SDK)."}, {"owner": {"reputation": 1, "user_id": 10484785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d47c7fbb28fa4a76018f5eb072e47d9?s=128&d=identicon&r=PG&f=1", "display_name": "kinder1212", "link": "https://stackoverflow.com/users/10484785/kinder1212"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539291953, "post_id": 52742665, "comment_id": 92460522, "body": "@vacip if that possible direct put my template excel file on website then direct browser another compare file for comparing? or just only the way is rewrite the code in other language?thanks."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539364556, "post_id": 52742665, "comment_id": 92489812, "body": "Hello, it is quite hard to understand what you are trying to say... No, there is no way to run VBA for Office outside Office (ok this is not literally true, but in your case it is true). So yes, the only way is to rewrite the code and rethink the logic."}], "owner": {"reputation": 1, "user_id": 10484785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d47c7fbb28fa4a76018f5eb072e47d9?s=128&d=identicon&r=PG&f=1", "display_name": "kinder1212", "link": "https://stackoverflow.com/users/10484785/kinder1212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539182048, "creation_date": 1539182048, "last_edit_date": 1592644375, "question_id": 52742665, "link": "https://stackoverflow.com/questions/52742665/how-to-compare-2-excel-file-online", "title": "How to compare 2 excel file online", "body": "<p>currently i have one Excel template  that content a lots of the VBA code for compare 2 excel file,but did have any idea to pull it into website for using online?</p>\n<p>For example the excel template are providing browse 2 excel file and after browse 2 excel into website and it will compare and provide a after compare file for download or maybe showing summary in website.</p>\n<h1>is that possible pull the VBA code into website for online compare?</h1>\n<p>Thanks and regards,</p>\n<p>kind1212</p>\n"}, {"tags": ["c++", "c++11", "type-conversion", "operators"], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1539182509, "creation_date": 1539182509, "answer_id": 52742817, "question_id": 52742580, "link": "https://stackoverflow.com/questions/52742580/why-the-following-code-with-non-const-conversion-function-is-not-ambiguous/52742817#52742817", "title": "Why the following code with non-const conversion function is not ambiguous?", "body": "<blockquote>\n  <p>The const qualifier should not affect the conversion function return value, so why the call is no longer ambiguous?</p>\n</blockquote>\n\n<p>It does not affect the result, but it affects overload resolution for choosing the best viable method. It's similar to the case of these made up functions</p>\n\n<pre><code>To make(From const&amp;);\nTo make(From&amp;);\n</code></pre>\n\n<p>Which overload is the better match in <code>make(f)</code>? It's the second one, because the parameter type, being non-const, better matches the argument (<code>f</code>), which is non-const itself.</p>\n"}, {"comments": [{"owner": {"reputation": 665, "user_id": 1332171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2fb562d62f2c81a5ffba5e07338c6f5?s=128&d=identicon&r=PG&f=1", "display_name": "yggdrasil", "link": "https://stackoverflow.com/users/1332171/yggdrasil"}, "edited": false, "score": 0, "creation_date": 1539188288, "post_id": 52742872, "comment_id": 92413847, "body": "Thanks for mentioning the implicit parameter, that made it clear! Maybe you meant this as a pointer not a reference. (But the answer holds true anyway, &amp;f which is int* gets implicitly passed, in the non-cost version this is also an int* and being an exact match wins over the constructor)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 665, "user_id": 1332171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2fb562d62f2c81a5ffba5e07338c6f5?s=128&d=identicon&r=PG&f=1", "display_name": "yggdrasil", "link": "https://stackoverflow.com/users/1332171/yggdrasil"}, "edited": false, "score": 0, "creation_date": 1539188829, "post_id": 52742872, "comment_id": 92414150, "body": "@A.S. <code>this</code> keyword is a pointer, but the implicit argument is a reference."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 665, "user_id": 1332171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2fb562d62f2c81a5ffba5e07338c6f5?s=128&d=identicon&r=PG&f=1", "display_name": "yggdrasil", "link": "https://stackoverflow.com/users/1332171/yggdrasil"}, "edited": false, "score": 0, "creation_date": 1539188961, "post_id": 52742872, "comment_id": 92414224, "body": "@A.S. also, if you do things like <code>std::invoke</code>, it&#39;s a reference there as well. Unless I&#39;m missing something, the only reason why <code>this</code> is a pointer is because member functions were introduced to the language before references."}, {"owner": {"reputation": 665, "user_id": 1332171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2fb562d62f2c81a5ffba5e07338c6f5?s=128&d=identicon&r=PG&f=1", "display_name": "yggdrasil", "link": "https://stackoverflow.com/users/1332171/yggdrasil"}, "edited": false, "score": 0, "creation_date": 1539189286, "post_id": 52742872, "comment_id": 92414418, "body": "The standard indeed states it is has reference type with the same cv qualifiers as the method. Thanks, I didn\u2019t know about this."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 1, "last_activity_date": 1539184272, "last_edit_date": 1539184272, "creation_date": 1539182650, "answer_id": 52742872, "question_id": 52742580, "link": "https://stackoverflow.com/questions/52742580/why-the-following-code-with-non-const-conversion-function-is-not-ambiguous/52742872#52742872", "title": "Why the following code with non-const conversion function is not ambiguous?", "body": "<blockquote>\n  <p>The const qualifier should not affect the conversion function return value</p>\n</blockquote>\n\n<p>It doesn't affect that indeed, but that's also not relevant.</p>\n\n<p>What it does affect is the argument - which is the implicit reference to <code>this</code>. The implicit argument is a const lvalue for const member functions and non-const for non-const member functions. The arguments are what affect the overload resolution. </p>\n\n<p>In the original code, both the constructor and the conversion operator arguments are exactly the same, so a conversion sequence from any type to either argument is equally preferable, and therefore ambiguous.</p>\n\n<p>Without the const, your non-const lvalue  expression <code>f</code> doesn't need any conversions, while the constructor does require a conversion into const lvalue. As such, the operator is preferred by the overload resolution. If you had written <code>const From f;</code>, then the constructor whose argument is const would have been chosen instead as in that case, the non-const conversion operator wouldn't even be valid candidate.</p>\n"}], "owner": {"reputation": 665, "user_id": 1332171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2fb562d62f2c81a5ffba5e07338c6f5?s=128&d=identicon&r=PG&f=1", "display_name": "yggdrasil", "link": "https://stackoverflow.com/users/1332171/yggdrasil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 52742872, "answer_count": 2, "score": 3, "last_activity_date": 1539191901, "creation_date": 1539181799, "last_edit_date": 1539191901, "question_id": 52742580, "link": "https://stackoverflow.com/questions/52742580/why-the-following-code-with-non-const-conversion-function-is-not-ambiguous", "title": "Why the following code with non-const conversion function is not ambiguous?", "body": "<p>Consider the following code (taken from <a href=\"https://en.cppreference.com/w/cpp/language/cast_operator\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/cast_operator</a>)</p>\n\n<pre><code>struct To {\n    To() = default;\n    To(const struct From&amp;) {} // converting constructor\n};\n\nstruct From {\n    operator To() const {return To();} // conversion function\n};\n\nint main()\n{\n    From f;\n\n    To t2 = f; // copy-initialization: ambiguous\n// (note, if conversion function is from a non-const type, e.g.\n//  From::operator To();, it will be selected instead of the ctor in this case)\n}\n</code></pre>\n\n<p>As the comments say, the following line is indeed ambiguous because there are two candidates (The conversion function and the converting constructor are equally applicable)</p>\n\n<pre><code>To t2 = f; //compile error\n</code></pre>\n\n<p>However, as the note says if I remove the <code>const</code> from the <code>conversion</code> function resulting in the following code:</p>\n\n<pre><code>struct From {\n    operator To() {return To();} // conversion function\n};\n</code></pre>\n\n<p>The call compiles fine.<br>\nThe <code>const</code> qualifier should not affect the <code>conversion</code> function return value, so why the call is no longer ambiguous? </p>\n"}, {"tags": ["c++", "constructor", "move-semantics"], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 8455470, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/01e8b42b903732a5fcf2ba3fc7bd28dc?s=128&d=identicon&r=PG&f=1", "display_name": "sangmin park", "link": "https://stackoverflow.com/users/8455470/sangmin-park"}, "edited": false, "score": 0, "creation_date": 1539183194, "post_id": 52742461, "comment_id": 92410676, "body": "Thanks for the explanation. Can you explain to me why Foo(2) returns an integer? I understand that it is an anonymous object but in its constructor body there is no return statement."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 457, "user_id": 8455470, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/01e8b42b903732a5fcf2ba3fc7bd28dc?s=128&d=identicon&r=PG&f=1", "display_name": "sangmin park", "link": "https://stackoverflow.com/users/8455470/sangmin-park"}, "edited": false, "score": 0, "creation_date": 1539186250, "post_id": 52742461, "comment_id": 92412664, "body": "@sangminpark Foo(2) does not return anything, only the constructed Foo object. Foo(2) constructs Foo with <code>int&amp;&amp;</code>, and the outer copy/move constructor is elided. You can write Foo(Foo(Foo(Foo(2)))) and the only constructor you get is Foo(2). All othet copy/move constructors are getting elided. I&#39;m not a language lawyer, and I&#39;m uncertain whether this is mandated by c++17 for this case, but compilers do it anyway. It&#39;s easy to check if compilers think that copy elision is mandated here, by simply deleting the copy and move constructors and watch the error."}, {"owner": {"reputation": 1575, "user_id": 3056501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215f27224256fccc7e3083d0d248cac6?s=128&d=identicon&r=PG&f=1", "display_name": "divinas", "link": "https://stackoverflow.com/users/3056501/divinas"}, "edited": false, "score": 0, "creation_date": 1539186880, "post_id": 52742461, "comment_id": 92413033, "body": "I don&#39;t have the standard at hand to check, but I&#39;m pretty sure that even if a copy would be elided, if the copy ctor is declared as deleted, the code would fail to compile with a &#39;reference to deleted function&#39; diagnostic."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 1575, "user_id": 3056501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215f27224256fccc7e3083d0d248cac6?s=128&d=identicon&r=PG&f=1", "display_name": "divinas", "link": "https://stackoverflow.com/users/3056501/divinas"}, "edited": false, "score": 1, "creation_date": 1539191907, "post_id": 52742461, "comment_id": 92415867, "body": "@divinas as I&#39;ve suspected, newer clang and gcc guarantee this copy elision in C++17 mode (despite deleted copy ctor), but not in c++14 mode. Not sure what the standard says"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 1, "creation_date": 1539202610, "post_id": 52742461, "comment_id": 92420769, "body": "According to cppreference, in C++17 these copy/move constructors are guaranteed to be elided, and should not be required to exist. Adding this to the answer"}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 2, "last_activity_date": 1539197786, "last_edit_date": 1539197786, "creation_date": 1539181449, "answer_id": 52742461, "question_id": 52742349, "link": "https://stackoverflow.com/questions/52742349/move-constructors-and-rvalue-references/52742461#52742461", "title": "Move constructors and rvalue references", "body": "<p>In  <code>Foo(2)</code>, the integer is an rvalue and an rvalue reference constructor from <code>int&amp;&amp;</code> is needed.</p>\n\n<p>In case of</p>\n\n<pre><code> Foo f = num; // custom constructor \n</code></pre>\n\n<p>The rvalue constructor is not called, because named values are never treated as rvalue. You must call <code>std::move(num)</code> to make it work.</p>\n\n<p>The standard defines it this way to avoid confusing cases when named values are moved unexpectedly, and later used. You must be explicit about the move, even if the variable is an rvalue reference.</p>\n\n<h1>edit</h1>\n\n<p>According to <a href=\"https://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">cppreference</a> a c++17 compiler must elide the copy/move constructor of (i.e. it must not call or require the existence of a copy/move constructor in this case, and that's why you see only the constructor from <code>int&amp;&amp;</code>):</p>\n\n<pre><code>Foo f4(Foo(2));\n</code></pre>\n\n<p>Here is a quote from cppreference (which is not as good as the standard, but close enough):</p>\n\n<blockquote>\n  <p>the language rules ensure that no copy/move operation takes place,\n  even conceptually:</p>\n  \n  <ul>\n  <li><p>In the initialization of a variable, when the initializer expression\n  is a\u00a0prvalue\u00a0of the same class type (ignoring\u00a0cv-qualification) as the\n  variable type:</p>\n  \n  <p>T x = T(T(T())); // only one call to default constructor of T, to initialize x</p></li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 457, "user_id": 8455470, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/01e8b42b903732a5fcf2ba3fc7bd28dc?s=128&d=identicon&r=PG&f=1", "display_name": "sangmin park", "link": "https://stackoverflow.com/users/8455470/sangmin-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539197786, "creation_date": 1539181077, "last_edit_date": 1539181407, "question_id": 52742349, "link": "https://stackoverflow.com/questions/52742349/move-constructors-and-rvalue-references", "title": "Move constructors and rvalue references", "body": "<pre><code>class Foo {\n    int m_num;\npublic:\n    Foo() {}\n\n    Foo(int&amp; n) {m_num = n;}\n\n    Foo(int&amp;&amp; n) {m_num = n;}\n\n    Foo(const Foo&amp; src) {m_num = src.m_num;}\n\n    Foo(Foo&amp;&amp; src) {m_num = src.m_num;}\n\n    Foo&amp; operator =(const Foo&amp; src) {\n        m_num = src.m_num;\n        return *this;\n    }\n\n    Foo&amp; operator =(Foo&amp;&amp; src) {// move\n        m_num = src.m_num;\n        return *this;\n    }\n\n    int&amp; operator =(const int&amp; src) {return m_num = src;}\n\n    int&amp; operator =(int&amp;&amp; src) {return m_num = src;}\n};\n</code></pre>\n\n<p>Why is it that when I call <code>Foo f4(Foo(2));</code> it calls the <code>Foo(int&amp;&amp; n)</code> constructor instead of <code>Foo(Foo&amp;&amp; src)</code> constructor?\nAlso why doesn't passing num which is an rvalue reference call move constructors?\nFor example, <code>Foo f = num</code> does not call the move constructor.</p>\n\n<pre><code>int main() {\n    int&amp;&amp; num = 5;\n    /*int num{ 5 };*/ // initializer-list\n    Foo f = num; // custom constructor\n    f = num; // assignment operator\n    Foo f2 = 6; // custom move constructor\n    f2 = 10; // custom move assignment\n    f2 = f; // assignment operator\n    Foo f3(f); // custom constructor\n    // f3(f2); // ERROR\n    f3 = (f2); // assignment operator\n\n    Foo f4(Foo(2));\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "pragma"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1539182172, "post_id": 52742215, "comment_id": 92410045, "body": "Could you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1539182243, "post_id": 52742215, "comment_id": 92410092, "body": "If the warning refers to a template then the warning also needs to be disabled in any code that causes the template to be instantiated.  Comment out the pop to see if that makes a difference.  Do beware that this is a pretty gross diagnostic."}, {"owner": {"reputation": 1414, "user_id": 2079612, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/KNjaa.jpg?s=128&g=1", "display_name": "buttonsrtoys", "link": "https://stackoverflow.com/users/2079612/buttonsrtoys"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1539263187, "post_id": 52742215, "comment_id": 92444621, "body": "@HansPassant. Thanks for the thoughts. Removing pop didn&#39;t help but led to some testing and turns out my original code block works as long as I&#39;m not including headers that include more headers from the problematic SDK? Not sure why that would be, but some overdue code cleanup should fix the problem."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1539263869, "post_id": 52742215, "comment_id": 92445097, "body": "You are not sharing nearly enough info.  My crystal ball says that this started to go downhill when looking for a linker error when you first tried this.  Caused by a static library that was not rebuilt in VS2017.  There is no workaround for that, you really do have to get it rebuilt."}, {"owner": {"reputation": 1414, "user_id": 2079612, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/KNjaa.jpg?s=128&g=1", "display_name": "buttonsrtoys", "link": "https://stackoverflow.com/users/2079612/buttonsrtoys"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1539347236, "post_id": 52742215, "comment_id": 92480571, "body": "Sorry @HansPassant, I thought it was obvious. Yes, the library was not built in VS2017 (most current build is VS2015). I get these errors during compile (no linking attempted), so nothing to do with a linker error. Regardless, I&#39;m working with the SDK distributor to get a VS2017 build."}], "owner": {"reputation": 1414, "user_id": 2079612, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/KNjaa.jpg?s=128&g=1", "display_name": "buttonsrtoys", "link": "https://stackoverflow.com/users/2079612/buttonsrtoys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539181965, "creation_date": 1539180680, "last_edit_date": 1539181965, "question_id": 52742215, "link": "https://stackoverflow.com/questions/52742215/pragma-warningdisable4251-not-working-for-3rd-party-sdk", "title": "#pragma warning(disable:4251) not working for 3rd party sdk", "body": "<p>My project compiles without warnings in VS2013 but updating it to VS2017 generates several <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-warnings/compiler-warning-level-1-c4251?view=vs-2017\" rel=\"nofollow noreferrer\">C4251</a> warnings that say a class needs to have dll-interface to be used by clients. The warnings are coming from the headers of a 3rd party DLL. (The DLL uses STL classes in its interface.) I added the usual pragmas around the include headers to quiet the warnings:</p>\n\n<pre><code>#pragma warning(push)\n#pragma warning(disable:4251)\n// 3rd party headers here\n#pragma warning(pop)\n</code></pre>\n\n<p>But that didn't quiet a single warning. Is there an alternate approach?</p>\n"}, {"tags": ["c++", "multithreading", "stdthread"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1539180823, "post_id": 52742209, "comment_id": 92409180, "body": "&quot;<i>The fact that I use <code>threads.push_back()</code> means that I run the copy-constructor <code>std::thread::thread(const thread&amp;)</code>.</i>&quot; Such constructor is <a href=\"https://en.cppreference.com/w/cpp/thread/thread/thread\" rel=\"nofollow noreferrer\"><code>delete</code>d</a>, so it&#39;s impossible for you to run it."}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 3, "creation_date": 1539180916, "post_id": 52742209, "comment_id": 92409240, "body": "Why not use <code>emplace_back</code>? It sounds like what you&#39;re after. <a href=\"https://en.cppreference.com/w/cpp/container/list/emplace_back\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/list/emplace_back</a>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1539180986, "post_id": 52742209, "comment_id": 92409282, "body": "&quot;Should I use std::move&quot; no, temporary is already an rvalue, you need to use <code>std::move</code> to cast named variable."}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1539181064, "post_id": 52742209, "comment_id": 92409342, "body": "So <code>emplace_back</code> will function as the constructor of the list template, and will thus make sure that the object is constructed directly on the list?"}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539181208, "post_id": 52742209, "comment_id": 92409427, "body": "@Slava you&#39;re saying that even if the copy constructor was not &quot;deleted&quot;, it would not be called anyway, as the &quot;temporary&quot; thread is an rvalue?"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1539181283, "post_id": 52742209, "comment_id": 92409466, "body": "Yep, with <code>emplace_back</code> the object gets constructed at the location provided by the list. Just as if you had called placement new at that address."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1539181308, "post_id": 52742209, "comment_id": 92409485, "body": "@SomethingSomething <code>std::thread(my_function, i)</code> is an rvalue. <code>std::vector::push_back</code> has an overload for rvalues which uses move semantics and makes no copies."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539181328, "post_id": 52742209, "comment_id": 92409494, "body": "&quot;it would not be called anyway&quot;, not quite that. It would prefer move ctor or assignment operator if such one exists."}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1539181494, "post_id": 52742209, "comment_id": 92409618, "body": "I am learning here new things today. Just to be sure - the fact that the thread constructor is not assigned to any variable, defines it as an rvalue? Which means it is going to be accepted by a method that gets <code>std::thread&amp;&amp;</code> and be constructed only when that function is called?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539181692, "post_id": 52742209, "comment_id": 92409745, "body": "&quot;the fact that the thread constructor is not assigned to any variable&quot; you should use proper terminology. You do not assign constructor to something, you create an instance of <code>std::thread</code> class, what type that instance has depends on expression."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1539181701, "post_id": 52742209, "comment_id": 92409751, "body": "@SomethingSomething - Almost. It&#39;s constructed at the call site so that the reference could bind to it. Then, inside the list node, another thread is constructed by <i>moving</i> the contents of the one at the call site. The move is safe. There is only ever a single handle that owns the thread. And I must second Slava, you should get a refresher book on C++11 to catch up on terminology."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1539181814, "post_id": 52742209, "comment_id": 92409814, "body": "@StoryTeller or that move could be eliminated by optimizer and it would be constructed in place. But it does not matter in this case - result will be the same."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539181880, "post_id": 52742209, "comment_id": 92409855, "body": "@Slava - Only if the move constructor has no observable behavior and the push back is inlined. Otherwise the core language itself requires two instances."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1539182031, "post_id": 52742209, "comment_id": 92409956, "body": "@StoryTeller <code>push_back()</code> is a template, so it can be inlined easily. For side effect, I think compiler allowed to omit copy ctor even if there are side effects. It is not the same for move ctor?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539182169, "post_id": 52742209, "comment_id": 92410043, "body": "@Slava - <code>push_back</code> is a black box. Depending on the machinery it invokes it can either be inlined easily or not. Ans since I cannot predict it reliably I would not wish to lead someone astray by pretending I can. And if you think about guaranteed copy elision, it doesn&#39;t hold when passing by function arguments by reference. The reference must bind to something. It&#39;s not even entirely reliable when passing by value."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539182540, "post_id": 52742209, "comment_id": 92410281, "body": "&quot; if you think about guaranteed copy elision&quot; no I do not, even before guaranteed copy elision compiler was allowed to omit copy ctor even if it has side effects. And I am not saying if it will elimininate for sure or not, I just said it is possible that move ctor would be eliminated here."}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1539182765, "post_id": 52742209, "comment_id": 92410423, "body": "Does the fact that my threads are &quot;moved&quot; to the list, which means they are going to be copied to the heap, means that I will need to manually iterate on the list and delete each of them?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539182896, "post_id": 52742209, "comment_id": 92410507, "body": "@Slava - &quot;Side-effects&quot; is not what I meant by observable behavior. I mean what the C++ standard means, and it doesn&#39;t allow eliminating it, period."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1539182914, "post_id": 52742209, "comment_id": 92410523, "body": "@SomethingSomething - No."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1539184968, "post_id": 52742209, "comment_id": 92411875, "body": "@StoryTeller looks like you are wrong <a href=\"https://stackoverflow.com/questions/13099603/c11-move-constructor-not-called-default-constructor-preferred\" title=\"c11 move constructor not called default constructor preferred\">stackoverflow.com/questions/13099603/&hellip;</a>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1539185112, "post_id": 52742209, "comment_id": 92411970, "body": "@Slava - Looks like you just didn&#39;t read any of the answers. Nothing there applies to the case of forwarding function arguments."}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1539246609, "post_id": 52742209, "comment_id": 92434311, "body": "If the two constructors are implemented - both copy constructor and move constructor (unlike in std::thread, where the copy constructor is deleted), which one will be called if the passed item is &quot;temporary&quot;, like in the example?"}], "answers": [{"comments": [{"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 1, "creation_date": 1539180901, "post_id": 52742269, "comment_id": 92409230, "body": "Does it mean that the code is safe? Just as if I assigned the thread directly to the placeholder in the list?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1539180990, "post_id": 52742269, "comment_id": 92409286, "body": "@SomethingSomething - Yes, as far as the thread creation itself goes it&#39;s safe. The standard library deletes the copy constructor so that unsafe creation won&#39;t even compile. And the move constructor does the sane thing. It aims to be correct by construction."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1539181215, "last_edit_date": 1539181215, "creation_date": 1539180845, "answer_id": 52742269, "question_id": 52742209, "link": "https://stackoverflow.com/questions/52742209/pushing-stdthread-by-value-into-a-list/52742269#52742269", "title": "Pushing std::thread by value into a list", "body": "<blockquote>\n  <p>The fact that I use threads.push_back() means that I run the copy-constructor </p>\n</blockquote>\n\n<p>No, it does not. Since C++11 <code>push_back</code> is overloaded to accept an rvalue reference to the list's value type.</p>\n\n<p>You cannot run <code>std::thread</code>'s copy constructor, since it's declared as deleted. The above mentioned overload of <code>push_back</code> was added for this exact purpose of supporting move only types, like a thread handle.</p>\n\n<p>If you want to initialize the thread directly into the container without a move, then <code>emplace_back</code> can do that. But you need to pass the parameters for the <code>std::thread</code> constructor in, not a thread that is initialized from them:</p>\n\n<pre><code>threads.emplace_back(my_function, i);\n</code></pre>\n"}], "owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 52742269, "answer_count": 1, "score": 0, "last_activity_date": 1539181215, "creation_date": 1539180664, "last_edit_date": 1539180966, "question_id": 52742209, "link": "https://stackoverflow.com/questions/52742209/pushing-stdthread-by-value-into-a-list", "title": "Pushing std::thread by value into a list", "body": "<p>My code looks like the following:</p>\n\n<pre><code>#include &lt;list&gt;\n#include &lt;thread&gt;\n\nvoid my_function(int val) {\n    // Empty function\n}\n\nint main() {\n    std::list&lt;std::thread&gt; threads;\n    for (int i = 0 ; i &lt; 10 ; i++) {\n        threads.push_back(std::thread(my_function, i));\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The fact that I use <code>threads.push_back()</code> means that I run the copy-constructor <code>std::thread::thread(const thread&amp;)</code>. </p>\n\n<ul>\n<li><p>Is it safe? </p></li>\n<li><p>Should I use <code>std::move</code> ?</p></li>\n</ul>\n\n<p>Please suppose that I don't know in advance how many threads I am going to need, so replacing the list by an array or by an <code>std::vector</code>, is not an option for me (<code>std::vector</code> would be an option only if I knew the number of threads in advance, as I cannot afford the vector's <code>realloc</code> operations).</p>\n"}, {"tags": ["c++", "c++11", "templates", "template-argument-deduction"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1539180893, "post_id": 52742133, "comment_id": 92409223, "body": "You might create function traits as <code>argument_of</code>, but you are limited: you no longer accept generic lambda and generic functor, or functor with overloads."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539181174, "post_id": 52742133, "comment_id": 92409405, "body": "All commands in your system must have the same known signatute. If you think you need to support arbitrary signatures, you haven&#39;t thought your design through."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1539181186, "post_id": 52742133, "comment_id": 92409415, "body": "How are you going to write code that calls <code>func</code>?"}, {"owner": {"reputation": 372, "user_id": 7294796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8dbc344b61f1b38dc4766127cdd1a16e?s=128&d=identicon&r=PG&f=1", "display_name": "HenrikS", "link": "https://stackoverflow.com/users/7294796/henriks"}, "edited": false, "score": 0, "creation_date": 1539181358, "post_id": 52742133, "comment_id": 92409517, "body": "It&#39;s a command processor. I parse a string with whitespace seperated arguments which are casted accordingly to fit the functions signature."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539181372, "post_id": 52742133, "comment_id": 92409530, "body": "I would suggest <code>template&lt;typename... args, typename t_func&gt; void add_command(const std::string&amp; name, t_func func)</code> and then you just have to specify the argument types as template parameters when you call the function."}, {"owner": {"reputation": 372, "user_id": 7294796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8dbc344b61f1b38dc4766127cdd1a16e?s=128&d=identicon&r=PG&f=1", "display_name": "HenrikS", "link": "https://stackoverflow.com/users/7294796/henriks"}, "edited": false, "score": 0, "creation_date": 1539181417, "post_id": 52742133, "comment_id": 92409556, "body": "That&#39;s exactly what I&#39;m doing right now. I thought there&#39;s a more convenient way though"}, {"owner": {"reputation": 372, "user_id": 7294796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8dbc344b61f1b38dc4766127cdd1a16e?s=128&d=identicon&r=PG&f=1", "display_name": "HenrikS", "link": "https://stackoverflow.com/users/7294796/henriks"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539181639, "post_id": 52742133, "comment_id": 92409705, "body": "@n.m. Not exactly. I created a wrapper function which casts strings to the desired arguments. But for that I need to know which arguments I need to cast to."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539182427, "post_id": 52742133, "comment_id": 92410207, "body": "&quot;created a wrapper function which casts strings to the desired arguments&quot; It isn&#39;t quite clear what you have, what is working, and what isn&#39;t. Please show relevant information in the question itself."}, {"owner": {"reputation": 372, "user_id": 7294796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8dbc344b61f1b38dc4766127cdd1a16e?s=128&d=identicon&r=PG&f=1", "display_name": "HenrikS", "link": "https://stackoverflow.com/users/7294796/henriks"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539182535, "post_id": 52742133, "comment_id": 92410278, "body": "@n.m. The only problem is std::function&lt;void(t_args...)&gt;. If I replace it with void(*)(t_args...) everything works fine. The problem is I&#39;d like to support capturing lambdas. I don&#39;t see how explaining completely unrelated code would help making the question more understandable."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539183020, "post_id": 52742133, "comment_id": 92410588, "body": "You are making yourself less clear with each new comment. Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 372, "user_id": 7294796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8dbc344b61f1b38dc4766127cdd1a16e?s=128&d=identicon&r=PG&f=1", "display_name": "HenrikS", "link": "https://stackoverflow.com/users/7294796/henriks"}, "edited": false, "score": 0, "creation_date": 1539183155, "post_id": 52742133, "comment_id": 92410654, "body": "Read the last sentence of my question again and forget what I might wanna do with the callback. It&#39;s completely unrelated."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539183810, "post_id": 52742133, "comment_id": 92411079, "body": "It looks like you are trying to use <code>std::function&lt;void(t_args...)</code> in a place that needs something else entirely, but it&#39;s hard to tell what it is exactly without knowing what you are trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1539181735, "post_id": 52742511, "comment_id": 92409768, "body": "Nice use of deduction guides.  As you said it isn&#39;t perfect but it will work for a number of cases. +1"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1539182581, "post_id": 52742511, "comment_id": 92410304, "body": "And there are also the C-ellipsis cases (ala <code>printf</code>) for the traits  to double the boilerplate :-/"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539183721, "post_id": 52742511, "comment_id": 92411012, "body": "@Jarod42 Rewrote to be multiplicative"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 6, "last_activity_date": 1539184079, "last_edit_date": 1539184079, "creation_date": 1539181578, "answer_id": 52742511, "question_id": 52742133, "link": "https://stackoverflow.com/questions/52742133/pass-variadic-stdfunction/52742511#52742511", "title": "Pass variadic std::function", "body": "<p><code>std::function</code> is a type erasure template.  Type deduction is the opposite (almost the inverse) of type erasure.</p>\n\n<p>Type deducing a type erasure template is code smell.  And it rarely works.</p>\n\n<p>In <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> there is a deduction guide, so you can do:</p>\n\n<pre><code>template&lt;typename... t_args&gt;\nvoid add_command(const std::string&amp; name, const std::function&lt;void(t_args...)&gt;&amp; args)        \nvoid add_command(const std::string&amp; name, t_func const&amp; func) {\n  std::function f = func;\n  add_command(name, f);\n}\n</code></pre>\n\n<p>it is imperfect, but a perfect solution isn't possible.</p>\n\n<p>The deduction guides <a href=\"https://en.cppreference.com/w/cpp/utility/functional/function/deduction_guides\" rel=\"nofollow noreferrer\">look like</a>:</p>\n\n<pre><code>template&lt;class R, class... ArgTypes&gt;\nfunction(R(*)(ArgTypes...)) -&gt; function&lt;R(ArgTypes...)&gt;;\ntemplate&lt;class F&gt;\nfunction(F) -&gt; function&lt;/*see below*/&gt;;\n</code></pre>\n\n<p>where it extracts the signature of the <code>function</code> via examining <code>&amp;F::operator()</code>.  This can fail with overloads or templates.  And naturally this doesn't work with function names that are overloaded.</p>\n\n<p>You can replicate this in <a href=\"/questions/tagged/c%2b%2b11\" class=\"post-tag\" title=\"show questions tagged &#39;c++11&#39;\" rel=\"tag\">c++11</a> with a function traits class:</p>\n\n<pre><code>template&lt;class X&gt;\nstruct function_traits:function_traits&lt;decltype(&amp;X::operator())&gt; {};\n#define MEM_FUN_HELPER2(...) \\\n  template&lt;class R, class T, class...Args&gt; \\\n  struct function_traits&lt;R(T::*)(Args...) __VA_ARGS__&gt;:function_traits&lt;R(Args...)&gt;{}; \\\n  template&lt;class R, class T, class...Args&gt; \\\n  struct function_traits&lt;R(T::*)(Args..., ...) __VA_ARGS__&gt;:function_traits&lt;R(Args..., ...)&gt;{}; \\\n  template&lt;class R, class T, class...Args&gt; \\\n  struct function_traits&lt;R(T::*)(Args...) __VA_ARGS__ noexcept&gt;:function_traits&lt;R(Args...) noexcept&gt;{}; \\\n  template&lt;class R, class T, class...Args&gt; \\\n  struct function_traits&lt;R(T::*)(Args..., ...) __VA_ARGS__  noexcept&gt;:function_traits&lt;R(Args..., ...) noexcept&gt;{}\n#define MEM_FUN_HELPER1(...) \\\n  MEM_FUN_HELPER2(__VA_ARGS__); \\\n  MEM_FUN_HELPER2(__VA_ARGS__ &amp;); \\\n  MEM_FUN_HELPER2(__VA_ARGS__ &amp;&amp;)\n#define MEM_FUN_HELPER0(...) \\\n  MEM_FUN_HELPER1(__VA_ARGS__); \\\n  MEM_FUN_HELPER1(const __VA_ARGS__)\n#define MEM_FUN_HELPER() \\\n  MEM_FUN_HELPER0(); \\\n  MEM_FUN_HELPER0(volatile)\n\nMEM_FUN_HELPER();\n\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(*)(Args...)&gt;:function_traits&lt;R(Args...)&gt;{};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(*)(Args..., ...)&gt;:function_traits&lt;R(Args..., ...)&gt;{};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(*)(Args...) noexcept&gt;:function_traits&lt;R(Args...) noexcept&gt;{};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(*)(Args..., ...) noexcept&gt;:function_traits&lt;R(Args..., ...) noexcept&gt;{};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(Args...) noexcept&gt; : function_traits&lt;R(Args...)&gt; {\n  enum {is_noexcept=true};\n};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(Args..., ...) noexcept&gt; : function_traits&lt;R(Args..., ...)&gt; {\n  enum {is_noexcept=true};\n};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(Args...)&gt; {\n  template&lt;template&lt;class...&gt;class Z&gt;\n  using transcribe=Z&lt;R(Args...)&gt;;\n  using std_function = transcribe&lt;std::function&gt;;\n  using result_type = R;\n  using arg_tuple = std::tuple&lt;Args...&gt;;\n  enum{is_noexcept=false};\n};\ntemplate&lt;class R, class...Args&gt;\nstruct function_traits&lt;R(Args..., ...)&gt; {\n  template&lt;template&lt;class...&gt;class Z&gt;\n  using transcribe=Z&lt;R(Args..., ...)&gt;;\n  using std_function = transcribe&lt;std::function&gt;;\n  using result_type = R;\n  // doesn't really work, but what ya gonna do:\n  using arg_tuple = std::tuple&lt;Args...&gt;;\n  enum{is_noexcept=false};\n};\n</code></pre>\n\n<p>which is pretty crazy; <code>MEM_FUN_HELPER();</code> expands into 48 template specializations.  3 ref qualifiers (<code>&amp;</code>, <code>&amp;&amp;</code> and nothing), then 4 other things (<code>const</code>, <code>volatile</code>, <code>noexcept</code> and <code>...</code> C-style varargs) that have to be handled \"manually\".</p>\n\n<p>In any case, once you have that, you can do:</p>\n\n<pre><code>template&lt;typename... t_args&gt;\nvoid add_command(const std::string&amp; name, const std::function&lt;void(t_args...)&gt;&amp; args)        \ntemplate&lt;class t_func&gt;\nvoid add_command(const std::string&amp; name, t_func const&amp; func) {\n  typename function_traits&lt;t_func&gt;::std_function f = func;\n  add_command(name, f);\n}\n</code></pre>\n\n<p>in <a href=\"/questions/tagged/c%2b%2b11\" class=\"post-tag\" title=\"show questions tagged &#39;c++11&#39;\" rel=\"tag\">c++11</a>.  This (roughly and imperfectly) does the same as the <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> deduction guides.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/48f289adfb9411a0\" rel=\"nofollow noreferrer\">Live example</a>.</p>\n"}], "owner": {"reputation": 372, "user_id": 7294796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8dbc344b61f1b38dc4766127cdd1a16e?s=128&d=identicon&r=PG&f=1", "display_name": "HenrikS", "link": "https://stackoverflow.com/users/7294796/henriks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1539184079, "creation_date": 1539180452, "question_id": 52742133, "link": "https://stackoverflow.com/questions/52742133/pass-variadic-stdfunction", "title": "Pass variadic std::function", "body": "<p>I have a function that accepts a callback. It should work with function ptrs, lambdas (stateless &amp; with state), etc. I could just do the following:</p>\n\n<pre><code>template&lt;typename t_func&gt;\nvoid add_command(const std::string&amp; name, t_func func)\n</code></pre>\n\n<p>The problem is I need to work with the argument types of func. So I did this:</p>\n\n<pre><code>template&lt;typename... t_args&gt;\nvoid add_command(const std::string&amp; name, const std::function&lt;void(t_args...)&gt;&amp; args)\n</code></pre>\n\n<p>This creates the following error: <code>no matching function for call to</code>...</p>\n\n<p><code>note: template argument deduction/substitution failed</code></p>\n\n<p>Is there any way to pass a generic function type while still having access to it's arguments? I know of <code>std::result_of</code>, is there a similar <code>std::arguments_of</code>?</p>\n"}, {"tags": ["c++", "tensorflow", "cmake"], "comments": [{"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1539182424, "post_id": 52742111, "comment_id": 92410205, "body": "IIRC, <code>string_view</code> is a C++17 feature.  Make sure you are running <code>Visual Studio 2015 Update 3</code> or possibly even the latest version of VS2017."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1539254222, "post_id": 52742111, "comment_id": 92439070, "body": "@JamesPoag <a href=\"https://en.cppreference.com/w/cpp/string/basic_string_view\" rel=\"nofollow noreferrer\"><code>std::string_view</code></a> is a C++17 feature, but what the compiler is complaining about is that it cannot find the headers, and the link the library, for <a href=\"https://abseil.io/\" rel=\"nofollow noreferrer\">Abseil</a> (which polyfills the feature for previous standards)."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1539254600, "post_id": 52742111, "comment_id": 92439286, "body": "The TensorFlow team is dropping support for CMake building. According to the release notes, this was officially done in <a href=\"https://github.com/tensorflow/tensorflow/releases/tag/v1.11.0\" rel=\"nofollow noreferrer\">v1.11.0</a>, but it was first announced in <a href=\"https://github.com/tensorflow/tensorflow/releases/tag/v1.10.0\" rel=\"nofollow noreferrer\">v1.10.0</a>, I am not sure if just as a warning or because they actually started there... I do not know how to solve your issue, but I have been able to build a TF dll (actually a custom wrapper dll including TF) with Bazel on Windows, in case you want to consider that path."}, {"owner": {"reputation": 31, "user_id": 9634525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oS81OjIUa5o/AAAAAAAAAAI/AAAAAAAAAAc/Q9UwfnTNGxE/photo.jpg?sz=128", "display_name": "Nagamani Nagaraj", "link": "https://stackoverflow.com/users/9634525/nagamani-nagaraj"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1539267592, "post_id": 52742111, "comment_id": 92447788, "body": "Thanks @jdehesa Do you have the steps to create TF dll with Bazel on windows?"}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1539268500, "post_id": 52742111, "comment_id": 92448454, "body": "@NagamaniNagaraj More or less... I created a simplified wrapper because I&#39;m not sure how to collect all the headers for a hypotetical <code>tensorflow.dll</code> (and anyway it would be too many and my wrapper has two). Mostly you follow the setup from <a href=\"https://www.tensorflow.org/install/source_windows\" rel=\"nofollow noreferrer\">Build from source on Windows</a>, but instead of building <code>&#47;&#47;tensorflow&#47;tools&#47;pip_package:build_pip_package</code> I added my own target that depends on <code>&#47;&#47;tensorflow&#47;core:tensorflow</code> marked with <a href=\"https://docs.bazel.build/versions/master/be/c-cpp.html#cc_binary.linkshared\" rel=\"nofollow noreferrer\"><code>linkshared</code></a>."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1539268560, "post_id": 52742111, "comment_id": 92448498, "body": "@NagamaniNagaraj Oh and I pass <code>--config monolithic</code> to <code>bazel build</code>, not sure if that is still necessary or if it is the default option but just in case."}, {"owner": {"reputation": 31, "user_id": 9634525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oS81OjIUa5o/AAAAAAAAAAI/AAAAAAAAAAc/Q9UwfnTNGxE/photo.jpg?sz=128", "display_name": "Nagamani Nagaraj", "link": "https://stackoverflow.com/users/9634525/nagamani-nagaraj"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1539340963, "post_id": 52742111, "comment_id": 92477118, "body": "Thanks for your help @jdehesa I am not familiar with bazel so I couldn&#39;t generate .dll. I tried with many things and messed up."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1539862454, "post_id": 52742111, "comment_id": 92659571, "body": "@NagamaniNagaraj You may be interested to know, there is a C TensorFlow lib for integration, see <a href=\"https://www.tensorflow.org/install/lang_c\" rel=\"nofollow noreferrer\">Install TensorFlow for C</a>. Although it&#39;s not officially announced for Windows, you can find builds in <a href=\"https://storage.googleapis.com/tensorflow\" rel=\"nofollow noreferrer\">storage.googleapis.com/tensorflow</a>, e.g. for v1.11.0 CPU there is <a href=\"https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-windows-x86_64-1.11.0.zip\" rel=\"nofollow noreferrer\">storage.googleapis.com/tensorflow/libtensorflow/&hellip;</a> . Docs are in the header and some of the API seems still not stable but it should be usable. Also there is no <code>.lib</code>? But you can google how to generate it from the DLL..."}, {"owner": {"reputation": 31, "user_id": 9634525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oS81OjIUa5o/AAAAAAAAAAI/AAAAAAAAAAc/Q9UwfnTNGxE/photo.jpg?sz=128", "display_name": "Nagamani Nagaraj", "link": "https://stackoverflow.com/users/9634525/nagamani-nagaraj"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1540560925, "post_id": 52742111, "comment_id": 92923290, "body": "@jdehesa Thanks for your help. As you said, there were not much APIs. I need to have a tensorflow.lib / .dll  which should enable me to create sessions and run the sessions. To be more specific, <a href=\"https://medium.com/jim-fleming/loading-a-tensorflow-graph-with-the-c-api-4caaff88463f\" rel=\"nofollow noreferrer\">medium.com/jim-fleming/&hellip;</a> I need to run the c++ program by linking tensorflow.lib/.dll in this link"}], "answers": [{"tags": [], "owner": {"reputation": 1140, "user_id": 7959545, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Spa51.png?s=128&g=1", "display_name": "Sohaib Anwaar", "link": "https://stackoverflow.com/users/7959545/sohaib-anwaar"}, "is_accepted": false, "score": 1, "last_activity_date": 1550067513, "creation_date": 1550067513, "answer_id": 54672363, "question_id": 52742111, "link": "https://stackoverflow.com/questions/52742111/error-building-tensorflow-c-shared-library-on-windows/54672363#54672363", "title": "Error building tensorflow C++ shared library on windows", "body": "<p>lnk2019 error occurs when your directly you are using in your source code are not linked properly. Please add additional dependencies to your project.</p>\n\n<ul>\n<li>Going to project properties</li>\n<li>select C/C++ option</li>\n<li>Add aditional dependencies</li>\n<li>Go to Linker Option Below C/C++</li>\n<li>Add additional Dependencies here.</li>\n</ul>\n\n<p>It might be help full for you from getting out to LNK2019 problem</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/799kze2z(v=vs.140)\" rel=\"nofollow noreferrer\">view this to understand LNK2019 error.</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11360825, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7mPo3X3m5e4/AAAAAAAAAAI/AAAAAAAAAFM/VVYYHFAlEYk/photo.jpg?sz=128", "display_name": "Yu Bao", "link": "https://stackoverflow.com/users/11360825/yu-bao"}, "is_accepted": false, "score": 0, "last_activity_date": 1555289095, "creation_date": 1555289095, "answer_id": 55681340, "question_id": 52742111, "link": "https://stackoverflow.com/questions/52742111/error-building-tensorflow-c-shared-library-on-windows/55681340#55681340", "title": "Error building tensorflow C++ shared library on windows", "body": "<p>I met same issue, I think tensorflow new version doesn't support CMake, but we can solve the issues.\n1. Seems the absl version in project folder is out dated, so I cloned the latest version of abseil-cpp from: <a href=\"https://github.com/abseil/abseil-cpp\" rel=\"nofollow noreferrer\">https://github.com/abseil/abseil-cpp</a>\n2. Use cmake to build the abseil-cpp, it will be fast.\n3. Add lib path to tensorflow dependency, the needed one will be D:\\git\\abseil-cpp\\abseil-cpp\\build\\absl\\base\\Release\\absl_absl_throw_delegate.lib\n4. If you meet other linking error, you can find the function name in absl sources and find the library contain it.\nHope this can help you and people who may met this issue in future.</p>\n"}], "owner": {"reputation": 31, "user_id": 9634525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oS81OjIUa5o/AAAAAAAAAAI/AAAAAAAAAAc/Q9UwfnTNGxE/photo.jpg?sz=128", "display_name": "Nagamani Nagaraj", "link": "https://stackoverflow.com/users/9634525/nagamani-nagaraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2204, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1555289095, "creation_date": 1539180367, "question_id": 52742111, "link": "https://stackoverflow.com/questions/52742111/error-building-tensorflow-c-shared-library-on-windows", "title": "Error building tensorflow C++ shared library on windows", "body": "<p>I am trying to build tensorflow as a standalone project and have been following this tutorial</p>\n\n<p><a href=\"http://www.stefanseibert.com/2017/10/tensorflow-as-dll-into-your-windows-c-project-with-gpu-support-and-cmake-v1-3/\" rel=\"nofollow noreferrer\">http://www.stefanseibert.com/2017/10/tensorflow-as-dll-into-your-windows-c-project-with-gpu-support-and-cmake-v1-3/</a></p>\n\n<p>but alternatively with cpu support</p>\n\n<p>My environment setup versions</p>\n\n<p><strong>protobuf</strong>            3.6.1<br>\n<strong>tensorflow</strong>          1.10.0<br>\n<strong>tf.GIT_VERSION</strong> = b'v1.10.0-rc1-19-g656e7a2b34'</p>\n\n<p>Here are the steps I used to generate the shared lib</p>\n\n<ol>\n<li><p>Acquired source code from <a href=\"https://github.com/tensorflow/tensorflow.git\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow.git</a></p></li>\n<li><p>Have installed the dependencies since I do not use the python bindings, there is no need for SWIG, so I installed Git (version 2.15.1.windows.2) and cmake 3.11.1</p></li>\n<li><p>I used the 64bit tools from Visual Studio 2015 since VS2015 is necessary to build the DLL. I should be able to open the \u201cVS2015 x64 Native Tools Command Prompt\u201d. This is needed so VS uses the 64 bit toolset.</p></li>\n<li><p>Navigated in the commandline to the \u201ctensorflow/contrib/cmake\u201d subfolder of the source code and create a directory with \u201cmkdir build\u201d. Afterwards navigate to the fresh build folder with \u201ccd build\u201d.</p></li>\n<li><p>Create a build solution: cmake .. -A x64 -DCMAKE_BUILD_TYPE=RelWithDebInfo   -Dtensorflow_BUILD_CC_EXAMPLE=OFF -Dtensorflow_ENABLE_GRPC_SUPPORT=OFF -Dtensorflow_BUILD_CC_TESTS=OFF -Dtensorflow_BUILD_PYTHON_TESTS=OFF -Dtensorflow_ENABLE_GPU=OFF  -Dtensorflow_WIN_CPU_SIMD_OPTIONS=/arch:AVX -Dtensorflow_BUILD_SHARED_LIB=ON</p></li>\n<li><p>Everything went fine till this. To build the tensorflow.dll, I issued the following command: MSBuild /p:Configuration=RelWithDebInfo tensorflow.vcxproj</p></li>\n<li><p>This throws an error: <strong>D:\\work\\tensorflow\\tensorflow/core/lib/core/stringpiece.h(34): fatal error C1083: Cannot open include file: 'absl/strings/string_view.h': No such file or directory (\ncompiling source file D:\\work\\tensorflow\\tensorflow\\core\\lib\\core\\coding.cc) [D:\\work\\tensorflow\\tensorflow\\contrib\\cmake\\build\\tf_core_lib.vcxproj]</strong>.</p></li>\n<li><p>I fixed the above error with this: <a href=\"https://github.com/tensorflow/tensorflow/issues/22007#issuecomment-424553600\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/issues/22007#issuecomment-424553600</a>.</p></li>\n<li><p>Doing the above I ended up with this error: <strong>path.obj : error LNK2019: unresolved external symbol \"void __cdecl absl::base_internal::ThrowStdOutOfRange(char const *)\" (?ThrowStdOutOfRange@base_internal@absl@@YA\nXPEBD@Z) referenced in function \"class std::basic_string,class std::allocator > __cdecl tensorflow::io::internal::JoinPathIm</strong></p></li>\n</ol>\n\n<p>I am not able to proceed further. Any workaround for this? Thanks!</p>\n"}, {"tags": ["c++", "r", "matrix", "linear-algebra", "rcpp"], "comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 5, "creation_date": 1539179392, "post_id": 52741610, "comment_id": 92408286, "body": "All these approaches will end up in the <i>same</i> LAPACK / BLAS library.  Upgrade that -- the R Installation and Administration manual has sections for each OS -- and you should see consistent improvements (eg multicore parallelism &quot;for free&quot;).  The remainder will just be checks for <code>NA</code> and alike which you could optimise away (and are generally recommended not to -- correctness first)."}, {"owner": {"reputation": 1633, "user_id": 2737503, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ICIVd.jpg?s=128&g=1", "display_name": "Jonno Bourne", "link": "https://stackoverflow.com/users/2737503/jonno-bourne"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1539190722, "post_id": 52741610, "comment_id": 92415262, "body": "Thank you. This means that I am pretty much stuck with my speed only modest improvements from upgrading the BLAS library? I think I don&#39;t understand when it is appropriate to use c++ instead of R code... you may be seeing other questions from me in this vein over the next few weeks! :s"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 3, "creation_date": 1539191615, "post_id": 52741610, "comment_id": 92415736, "body": "Indeed -- for a good number of operations R is efficient as you can be (modulo error checking on input arguments etc), and this is one of them.  The difference between LAPACK / BLAS implementations is worth looking into though."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1539600780, "post_id": 52741610, "comment_id": 92547496, "body": "Interesting results. Why did you choose MKL over OpenBLAS?"}, {"owner": {"reputation": 1633, "user_id": 2737503, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ICIVd.jpg?s=128&g=1", "display_name": "Jonno Bourne", "link": "https://stackoverflow.com/users/2737503/jonno-bourne"}, "edited": false, "score": 0, "creation_date": 1539618488, "post_id": 52741610, "comment_id": 92557956, "body": "I have intel processors, from reading around it looked like the MKL BLAS is always better for intel chips in comparison to the OpenBlas. But to be honest I also don&#39;t really know what I&#39;m doing. I think it is pretty interesting that the speed is reduced for small matrices, that doesn&#39;t seem to be a problem with your version."}], "answers": [{"comments": [{"owner": {"reputation": 1633, "user_id": 2737503, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ICIVd.jpg?s=128&g=1", "display_name": "Jonno Bourne", "link": "https://stackoverflow.com/users/2737503/jonno-bourne"}, "edited": false, "score": 0, "creation_date": 1539361682, "post_id": 52756225, "comment_id": 92488506, "body": "Great answer thank you, Array fire is such an easy way to push things to the gpu. Can you explain the difference between Cxxfunction and cppfunction?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 1633, "user_id": 2737503, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ICIVd.jpg?s=128&g=1", "display_name": "Jonno Bourne", "link": "https://stackoverflow.com/users/2737503/jonno-bourne"}, "edited": false, "score": 1, "creation_date": 1539363457, "post_id": 52756225, "comment_id": 92489352, "body": "@JonnoBourne <code>cxxfunction</code> comes from the <code>inline</code> package, while the newer <code>cppFunction</code> is provided by <code>Rcpp</code>, i.e. it&#39;s the &quot;official&quot; way for this. I also prefer writing a complete C++ function, i.e. no need to specify the signature in some argument. See the Rcpp attributes vignette for more details."}], "tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": true, "score": 2, "last_activity_date": 1539248679, "creation_date": 1539248679, "answer_id": 52756225, "question_id": 52741610, "link": "https://stackoverflow.com/questions/52741610/matrix-inversion-and-transpose-r-vs-c/52756225#52756225", "title": "Matrix inversion and transpose R vs c++", "body": "<p>I have tried your code on a dual core laptop running Debian Linux and R 3.5.1 linked to OpenBLAS. In addition, I have also used <a href=\"https://www.daqana.org/rcpparrayfire/\" rel=\"nofollow noreferrer\">RcppArrayFire</a> to do these calculations using the GPU (nothing fancy, just in-build graphics). Here the benchmark results:</p>\n\n<pre><code>Unit: microseconds\n    expr        min         lq        mean     median         uq        max neval  cld\n     R10     55.488     90.142    117.9538    133.617    138.009    161.604    10 a   \n    R100    698.883    711.488   1409.8286    773.352    901.339   5647.804    10 a   \n   R1000 198612.971 213531.557 225713.6705 214993.916 226526.513 306675.313    10    d\n   Cpp10     16.157     31.478     38.3473     40.529     51.122     52.351    10 a   \n  Cpp100    519.527    544.728    573.0099    570.956    610.985    613.400    10 a   \n Cpp1000 174121.655 184865.003 196224.3825 193142.715 207066.037 223900.830    10   c \n    AF10    700.805    790.203   1469.4980   1347.639   1410.717   3824.905    10 a   \n   AF100   1376.737   1562.675   1818.8094   1898.797   1949.364   2222.889    10 a   \n  AF1000 106398.431 109130.482 118817.6704 118612.679 123193.649 139474.579    10  b  \n</code></pre>\n\n<p>At the smallest size (R10 and Cpp10), your machine is faster than mine. But already at R100 and Cpp100 but in particular at R1000 and Cpp1000 I get faster execution. As Dirk noted in the comments, you should look into optimized / parallel BLAS implementations. On Debian Linux (and derived ones like Ubuntu) this is as easy as</p>\n\n<pre><code>  sudo apt-get install libopenblas-base\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/50857568/large-performance-differences-between-os-for-matrix-computation/51154448#51154448\">here</a>. Now for the results using the GPU: This is quite typical. For the smaller matrices, it is worse than both base R and Armadillo. Using the GPU introduces quite a bit of overhead when the data is moved between main memory and GPU memory. But for the largest size the parallel execution on the GPU outweighs this overhead and the performance gain is quite nice.</p>\n\n<p>Here my code for reference. I have taken the liberty to update <code>inline::cxxfunction</code> to <code>Rcpp::cppFunction</code>: </p>\n\n<pre><code>#Create the basic R implementation of the equation\nflowCalc &lt;- function(A,C){\n  B &lt;- t(A) %*% C %*% A\n  Imp &lt;- solve(B)\n  PTDF &lt;- C %*% A %*% Imp\n  Out &lt;- list(Imp = Imp, PTDF= PTDF)\n  return(Out)\n\n}\n\n# Create Armadillo function\nRcpp::cppFunction(depends = \"RcppArmadillo\", code = '\nRcpp::List flowCalcCpp(const arma::mat &amp;Am, const arma::mat &amp;Cm) {\n   arma::mat B = inv(trans(Am) * Cm * Am);\n   arma::mat PTDF = Cm * Am * B;\n   return Rcpp::List::create( Rcpp::Named(\"Imp\") = B ,\n                           Rcpp::Named(\"PTDF\") = PTDF );\n}')\n\n# Create ArrayFire function\nRcpp::cppFunction(depends = \"RcppArrayFire\", code = '\nRcpp::List flowCalcAF(const RcppArrayFire::typed_array&lt;f32&gt; &amp;A, \n                      const RcppArrayFire::typed_array&lt;f32&gt; &amp;C) {\n  af::array B = af::inverse(af::matmul(af::matmulTN(A, C), A));\n  af::array PTDF = af::matmul(af::matmul(C, A), B);\n  return Rcpp::List::create( Rcpp::Named(\"Imp\") = B ,\n                             Rcpp::Named(\"PTDF\") = PTDF );\n}')\n\n\n\nlibrary(igraph)\n#Create a function to generate dummy data\nMakeData &lt;- function(n, edgep){#make an erdos renyi graph of size x\n  g &lt;- erdos.renyi.game(n, edgep)\n  #convert to adjacency matrix\n  Adjmat &lt;- as_adjacency_matrix(g, sparse = F)\n  #create random graph and mask the elements with not edge\n  Cmat &lt;- matrix(rnorm(n*n), ncol = n)*Adjmat\n  ##Output a list of the two matrices\n  list(A = Adjmat, C = Cmat)\n}\n\n#generate dummy data\nset.seed(133)\nData10 &lt;- MakeData(10, 1/1)\nData100 &lt;- MakeData(100, 1/10)\nData1000 &lt;- MakeData(1000, 1/100)\n\n#Compare results\nmicrobenchmark::microbenchmark(\n  R10 = flowCalc(Data10$A, Data10$C),\n  R100 = flowCalc(Data100$A, Data100$C),\n  R1000 = flowCalc(Data1000$A, Data1000$C),\n  Cpp10 = flowCalcCpp(Data10$A, Data10$C),\n  Cpp100 = flowCalcCpp(Data100$A, Data100$C),\n  Cpp1000 = flowCalcCpp(Data1000$A, Data1000$C),\n  AF10 = flowCalcAF(Data10$A, Data10$C),\n  AF100 = flowCalcAF(Data100$A, Data100$C),\n  AF1000 = flowCalcAF(Data1000$A, Data1000$C),\n  times = 10)\n</code></pre>\n"}], "owner": {"reputation": 1633, "user_id": 2737503, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ICIVd.jpg?s=128&g=1", "display_name": "Jonno Bourne", "link": "https://stackoverflow.com/users/2737503/jonno-bourne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 2, "accepted_answer_id": 52756225, "answer_count": 1, "score": 3, "last_activity_date": 1539361628, "creation_date": 1539178846, "last_edit_date": 1592644375, "question_id": 52741610, "link": "https://stackoverflow.com/questions/52741610/matrix-inversion-and-transpose-r-vs-c", "title": "Matrix inversion and transpose R vs c++", "body": "<p>I have calculating power flow across a network. However, I have found that for larger networks the calculation is slow. I tried to implement the algorithm using RcppArmadillo. The Rcpp function is several times faster for small networks/matrices but becomes just as slow for larger ones. The speed of the operation is affecting the usefulness of functions further on. Am I writing the functions badly or is this just the options I have?</p>\n<p>The R code below gives and example of the executions times for a matrix of 10, 100, 1000.</p>\n<pre><code>library(igraph); library(RcppArmadillo)\n\n#Create the basic R implementation of the equation\nflowCalc &lt;- function(A,C){\n\n  B &lt;- t(A) %*% C %*% A\n  Imp &lt;- solve(B)\n  PTDF &lt;- C %*% A %*% Imp\n  Out &lt;- list(Imp = Imp, PTDF= PTDF)\n  return(Out)\n   \n}\n\n#Create the c++ implementation\ntxt &lt;- 'arma::mat Am = Rcpp::as&lt; arma::mat &gt;(A);\n   arma::mat Cm = Rcpp::as&lt; arma::mat &gt;(C);\n   arma::mat B = inv(trans(Am) * Cm * Am);\n   arma::mat PTDF = Cm * Am * B;\n   return Rcpp::List::create( Rcpp::Named(&quot;Imp&quot;) = B ,\n                           Rcpp::Named(&quot;PTDF&quot;) = PTDF ) ; '\n\nflowCalcCpp &lt;- cxxfunction(signature(A=&quot;numeric&quot;,\n    C=&quot;numeric&quot;),\n    body=txt,\n    plugin=&quot;RcppArmadillo&quot;)\n\n\n#Create a function to generate dummy data\nMakeData &lt;- function(n, edgep){#make an erdos renyi graph of size x\n    g &lt;- erdos.renyi.game(n, edgep)\n    #convert to adjacency matrix\n    Adjmat &lt;- as_adjacency_matrix(g, sparse = F)\n    #create random graph and mask the elements with not edge\n    Cmat &lt;- matrix(rnorm(n*n), ncol = n)*Adjmat\n    ##Output a list of the two matrices\n    list(A = Adjmat, C = Cmat)\n}\n\n#generate dummy data\nset.seed(133)\nData10 &lt;- MakeData(10, 1/1)\nData100 &lt;- MakeData(100, 1/10)\nData1000 &lt;- MakeData(1000, 1/100)\n\n#Compare results\nBenchData &lt;- microbenchmark(\n               R10 = flowCalc(Data10$A, Data10$C),\n               R100 = flowCalc(Data100$A, Data100$C),\n               R1000 = flowCalc(Data1000$A, Data1000$C),\n               Cpp10 = flowCalcCpp(Data10$A, Data10$C),\n               Cpp100 = flowCalcCpp(Data100$A, Data100$C),\n               Cpp1000 = flowCalcCpp(Data1000$A, Data1000$C))\n</code></pre>\n<p>The speed results are shown below.\n<a href=\"https://i.stack.imgur.com/ixqFY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ixqFY.jpg\" alt=\"enter image description here\" /></a></p>\n<h1>EDIT:</h1>\n<p>After reading Ralf's answer and Dirk's comments I used\n<a href=\"https://cran.r-project.org/web/packages/gcbd/vignettes/gcbd.pdf\" rel=\"nofollow noreferrer\">https://cran.r-project.org/web/packages/gcbd/vignettes/gcbd.pdf</a> to get a better overview of the differences in BLAS implementations</p>\n<p>I then used Dirk's guide to installing the microsoft BLAS  implementation\n<a href=\"https://github.com/eddelbuettel/mkl4deb\" rel=\"nofollow noreferrer\">https://github.com/eddelbuettel/mkl4deb</a>\n(clearly, I now live in the Eddelverse)</p>\n<p>Once I had done that I installed ArrayFire and RcppArrayFire as Ralf suggested. I then ran the code and got the following results</p>\n<pre><code>Unit: microseconds\n    expr        min          lq        mean      median          uq         max neval\n     R10     37.348     83.2770    389.6690    143.9530    181.8625   25022.315   100\n    R100    464.148    587.9130   1187.3686    680.8650    849.0220   32602.678   100\n   R1000 143065.901 160290.2290 185946.5887 191150.2335 201894.5840  464179.919   100\n   Cpp10     11.946     30.6120    194.8566     55.6825     74.0535   13732.984   100\n  Cpp100    357.880    452.7815    987.8059    496.9520    554.5410   39359.877   100\n Cpp1000 102949.722 124813.9535 136898.4688 132852.9335 142645.6450  214611.656   100\n    AF10    713.543    833.6270   1135.0745    966.5920   1057.4175    8177.957   100\n   AF100   2809.498   3152.5785   3662.5323   3313.0315   3569.7785   12581.535   100\n  AF1000  77905.179  81429.2990 127087.2049  82579.6365  87249.0825 3834280.133   100\n</code></pre>\n<p>The speed is reduced for the smaller matrices, twice as fast for the matrices in the order of 100, but almost 10 times faster for the larger matrices, which is consistant with Ralf's results. The difference with using C++ also grew.</p>\n<p>On my data the BLAS upgrade it is worth using the C++ version but possibly not the Arrayfire version, as my matrices aren't big enough.</p>\n"}, {"tags": ["c++", "copy-constructor", "copy-assignment", "rule-of-three"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1539179178, "post_id": 52741605, "comment_id": 92408157, "body": "If you used <code>std::array&lt;char, LENGTH&gt;</code> instead of <code>char [LENGTH]</code> and <code>std::vector&lt;double&gt;</code> instead of <code>double*</code> all the compiler generated members would behavior correctly."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1539180686, "post_id": 52741605, "comment_id": 92409099, "body": "This is not the standard way of doing it. Normally the assignment operator uses the copy constructor in an idiom called &quot;Copy and Swap&quot; (look it up). As a result of doing it this way you have a serious bug that is causing UB (<code>delete[] oQueue</code> is potentially called on an un-initialized variable. Thus you are randomly deleting some part of memory (not a good idea)."}, {"owner": {"reputation": 91, "user_id": 5165297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a9091c92940bfba35309a272cc23176?s=128&d=identicon&r=PG&f=1", "display_name": "Daniyal Yasin", "link": "https://stackoverflow.com/users/5165297/daniyal-yasin"}, "edited": false, "score": 0, "creation_date": 1539180765, "post_id": 52741605, "comment_id": 92409145, "body": "Yes I have found out about that bug. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 7, "last_activity_date": 1539179360, "last_edit_date": 1539179360, "creation_date": 1539178968, "answer_id": 52741650, "question_id": 52741605, "link": "https://stackoverflow.com/questions/52741605/recursive-call-in-copy-constructor/52741650#52741650", "title": "recursive call in copy constructor", "body": "<p>In your copy constructor you use</p>\n\n<pre><code>*this = other; //(1)\n</code></pre>\n\n<p>which calls</p>\n\n<pre><code>tDataStruct&amp; operator=(tDataStruct other)  //(2)\n</code></pre>\n\n<p>as <code>other</code> is passed by value it needs to make a copy.  That then calls <code>1</code>, which call <code>2</code> which then calls <code>1</code> which then calls <code>2</code> and a round and a round you'll go until the program crashes/terminates.</p>\n\n<p>You need to take <code>other</code> by reference so you don't actually make a copy like</p>\n\n<pre><code>tDataStruct&amp; operator=(const tDataStruct&amp; other) \n</code></pre>\n\n<hr>\n\n<p>All that said you are doing this backwards.  You should use the <a href=\"https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom\">copy and swap idiom</a> and implement your <code>operator =</code> by using your copy constructor.</p>\n"}, {"tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 0, "last_activity_date": 1539179578, "last_edit_date": 1539179578, "creation_date": 1539179222, "answer_id": 52741738, "question_id": 52741605, "link": "https://stackoverflow.com/questions/52741605/recursive-call-in-copy-constructor/52741738#52741738", "title": "recursive call in copy constructor", "body": "<p>Your copy constructor calls assignment:</p>\n\n<pre><code>tDataStruct(const tDataStruct&amp; other) // copy constructor\n{\n    // NOTE: this redundant check is always true. \n    // Please remove the if.\n    if (this != &amp;other) \n    {\n        *this = other;\n    }\n }\n</code></pre>\n\n<p>Then, since assignment operator gets the object by value (and not by reference), a copy constructor is called in order to copy the parameter:</p>\n\n<pre><code>tDataStruct&amp; operator=(tDataStruct other) // copy assignment\n{\n</code></pre>\n\n<p>This is how you got mutual recursion.</p>\n\n<p>Try passing by reference instead:</p>\n\n<pre><code>tDataStruct&amp; operator=(const tDataStruct &amp;other) // copy assignment\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5165297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a9091c92940bfba35309a272cc23176?s=128&d=identicon&r=PG&f=1", "display_name": "Daniyal Yasin", "link": "https://stackoverflow.com/users/5165297/daniyal-yasin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 52741650, "answer_count": 2, "score": 0, "last_activity_date": 1539179578, "creation_date": 1539178829, "last_edit_date": 1539179207, "question_id": 52741605, "link": "https://stackoverflow.com/questions/52741605/recursive-call-in-copy-constructor", "title": "recursive call in copy constructor", "body": "<p>I implemented a class following the rule of three, and I am getting a crash. Upon debugging I have came to the conclusion that the copy constructor is calling itself repeatedly instead of calling the equality operator. Why is this so? Shouldn't it call the equality operator?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;deque&gt;\n#include &lt;cstdlib&gt;\n#define LENGTH 128\n\ntypedef struct tDataStruct\n{\n\nchar strA[LENGTH];\n\nchar strB[LENGTH];\nint nNumberOfSignals;\ndouble* oQueue;\n\ntDataStruct()\n{\n    nNumberOfSignals = 0;\n    //oQueue = NULL;\n    memset(strA, 0, LENGTH);\n    memset(strB, 0, LENGTH);\n}\n\n~tDataStruct()\n{\n    if (NULL != oQueue)\n    {\n        delete[] oQueue;\n        oQueue = NULL;\n    }\n}\n\ntDataStruct(const tDataStruct&amp; other) // copy constructor\n{\n    if (this != &amp;other)\n    {\n        *this = other;\n    }\n\n}\ntDataStruct&amp; operator=(tDataStruct other) // copy assignment\n{\n    if (this == &amp;other)\n    {\n        return *this;\n    }\n    strncpy_s(strA, other.strA, LENGTH);\n    strncpy_s(strB, other.strB, LENGTH);\n    nNumberOfSignals = other.nNumberOfSignals;\n    if (NULL != oQueue)\n    {\n        delete[] oQueue;\n        oQueue = NULL;\n    }\n    if (other.nNumberOfSignals &gt; 0)\n    {\n        //memcpy(oQueue, other.oQueue, nNumberOfSignals);\n    }\n    return *this;\n}\n} tDataStruct;\n\n\nint main()\n{\n    tDataStruct tData;\n\n    std::deque&lt;tDataStruct&gt; fifo;\n\n    fifo.push_back(tData);\n}\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 2, "creation_date": 1539177489, "post_id": 52741157, "comment_id": 92407073, "body": "errors spell it out. No need to pass <code>size_t M, size_t N</code> as arguments  to the function. They shadow the template parameters. Without them you can call your function like <code>instanBoolArr&lt;1, 2&gt;()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1539177860, "post_id": 52741212, "comment_id": 92407296, "body": "You might want to show how they would call it, just to make it more complete."}, {"owner": {"reputation": 1021, "user_id": 5574794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XwUaJ.jpg?s=128&g=1", "display_name": "Bowen Peng", "link": "https://stackoverflow.com/users/5574794/bowen-peng"}, "edited": false, "score": 0, "creation_date": 1539178245, "post_id": 52741212, "comment_id": 92407543, "body": "I get it. But if I have to pass M, N as the function parameter which is same with the template parameter, which is the question I have to face it now, I do not how to get it right, if I want to pass the function parameter as same as the template parameter."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 1021, "user_id": 5574794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XwUaJ.jpg?s=128&g=1", "display_name": "Bowen Peng", "link": "https://stackoverflow.com/users/5574794/bowen-peng"}, "edited": false, "score": 1, "creation_date": 1539179225, "post_id": 52741212, "comment_id": 92408188, "body": "@FreAkPoint: I have no idea what you mean and what you&#39;re trying to do. Can you elaborate?"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 2, "last_activity_date": 1539177533, "creation_date": 1539177533, "answer_id": 52741212, "question_id": 52741157, "link": "https://stackoverflow.com/questions/52741157/how-to-instantiate-an-array-whose-length-uses-template-parameter-in-a-template-f/52741212#52741212", "title": "how to instantiate an array whose length uses template parameter in a template function", "body": "<p>The compiler errors are pretty clear. Your function parameters are shadowing your template parameters.</p>\n\n<p>Change your function to:</p>\n\n<pre><code>template&lt;size_t M, size_t N&gt;\nvoid instanBoolArr()\n{\n    bool a[M];\n    bool b[N];\n}\n</code></pre>\n"}], "owner": {"reputation": 1021, "user_id": 5574794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XwUaJ.jpg?s=128&g=1", "display_name": "Bowen Peng", "link": "https://stackoverflow.com/users/5574794/bowen-peng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539177533, "creation_date": 1539177354, "question_id": 52741157, "link": "https://stackoverflow.com/questions/52741157/how-to-instantiate-an-array-whose-length-uses-template-parameter-in-a-template-f", "title": "how to instantiate an array whose length uses template parameter in a template function", "body": "<p>I want to instantiate an array length like this way:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\ntemplate&lt;size_t M, size_t N&gt;\nvoid instanBoolArr(size_t M, size_t N)\n{\n    bool a[M];\n    bool b[N];\n\n}\n\nint main(void)\n{\n    size_t M = 1;\n    size_t N = 1;\n    instanBoolArr(M, N);\n    return 0;\n}\n</code></pre>\n\n<p>But the clang compiler told me the error messages :</p>\n\n<blockquote>\n  <p>prog.cc:6:27: error: declaration of 'M' shadows template parameter\n  void instanBoolArr(size_t <strong>M</strong>, size_t N)</p>\n  \n  <p>prog.cc:5:17: note: template parameter is declared here\n  template</p>\n  \n  <p>prog.cc:6:37: error: declaration of 'N' shadows template parameter\n  void instanBoolArr(size_t M, size_t <strong>N</strong>)</p>\n  \n  <p>prog.cc:5:27: note: template parameter is declared here\n  template</p>\n  \n  <p>prog.cc:9:10: warning: unused variable 'b' [-Wunused-variable]\n      bool b[N];</p>\n  \n  <p>prog.cc:8:10: warning: unused variable 'a' [-Wunused-variable]\n      bool a[M];</p>\n  \n  <p>prog.cc:17:5: error: no matching function for call to 'instanBoolArr'\n      instanBoolArr(M, N);</p>\n  \n  <p>prog.cc:6:6: note: candidate template ignored: couldn't infer template\n  argument 'M' void instanBoolArr(size_t M, size_t N)</p>\n</blockquote>\n\n<p>The version of clang compiler is 7.0.</p>\n\n<p>I want to implement it in this way, but I su*k at C++ template and I didn't find the useful answer for me in the net. </p>\n\n<p>So, if not mind, PLZ someone points my faults and helps me through it.</p>\n\n<p>Sincerely.</p>\n"}, {"tags": ["c++", "arrays", "duplicates"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1539177398, "post_id": 52741140, "comment_id": 92407017, "body": "<code>arr</code> only has room for 6 elements, but you set <code>arraySize = 10</code>. You can change to <code>int arr[10] = { 1, 2, 2, 5, 6, 1 };</code>"}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1539177419, "post_id": 52741140, "comment_id": 92407028, "body": "Would there be a possibility to use <code>std::vector</code> or <code>std::array</code>?"}, {"owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1539177663, "post_id": 52741140, "comment_id": 92407187, "body": "Thanks @JohnnyMopp I have corrected this. Although I have the same problem with console showing no output. Micha, my lecturer does not want us to use vectors, as we have not covered them yet"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1539177674, "post_id": 52741140, "comment_id": 92407194, "body": "Also, <code>arr[k] = arr[k + 1];</code> will read past the end of the array when <code>k = arraySize - 1</code>."}, {"owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1539178301, "post_id": 52741140, "comment_id": 92407573, "body": "Thank you @JohnnyMopp. I have updated my code with your corrections."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1539178782, "post_id": 52741140, "comment_id": 92407891, "body": "In your <code>for</code> loops you need to use <code>posUsed</code> and not <code>arraySize</code>."}, {"owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "edited": false, "score": 0, "creation_date": 1539179035, "post_id": 52741140, "comment_id": 92408067, "body": "I changed the 3 to posUsed. My console output is now: 2 6 0 0 0 0 0 0 0 0. While it should be 1 2 5 6 0 0 0 0 0 0"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1539180019, "post_id": 52741140, "comment_id": 92408682, "body": "You&#39;ve modified the code since you originally posted the question. Most importantly, you modified the 2nd <code>for</code> loop. So now you end up incrementing <code>j</code> twice."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1539181095, "post_id": 52741140, "comment_id": 92409357, "body": "Do you need to preserve the relative order of elements in your array? For example: Input: {6, 1, 2, 2, 5, 1}, Output: the same as before, or {6, 1, 2, 5}?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539181880, "post_id": 52741140, "comment_id": 92409853, "body": "Using algorithms -- <code>auto ptr = std::unique(arr, arr + arraySize); std::fill(ptr, arr + arraySize, 0);</code>  Any reason why this cannot be accepted as an answer?  Can you use the algorithm functions (which <b>can</b> work with regular arrays)?"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539182465, "post_id": 52741140, "comment_id": 92410233, "body": "@PaulMcKenzie Your code obviously cannot be accepted while it&#39;s in a comment. BTW I haven&#39;t used <code>std::unique</code> recently, but from what I know about standard library, it only implements algorithms which are efficient. So it will only delete adjacent duplicates."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1539182820, "post_id": 52741140, "comment_id": 92410466, "body": "Yes @anatolyg <code>std::unique</code> will not work in this example unless you use <code>std::sort</code> beforehand. But again - this is a solution only if order of the elements doesn&#39;t matter (still waiting for OP to confirm/deny)."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539182902, "post_id": 52741140, "comment_id": 92410509, "body": "Yes, <code>std::sort</code> will also work with arrays.  So solution is 3 lines instead of 2 (if algorithms can be used) (sort, unique, fill)."}], "answers": [{"comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1539180513, "post_id": 52742063, "comment_id": 92408990, "body": "OP states in comments: <i>my lecturer does not want us to use vectors</i>"}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1539180861, "post_id": 52742063, "comment_id": 92409201, "body": "OP cannot use standard library algorithms for that assignment. Also, in your solution the result array will be sorted, which might not be desired. Also, you do not need to use <code>for_each</code> to construct a set from vector."}, {"owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1539181132, "post_id": 52742063, "comment_id": 92409375, "body": "@Ptaq666 good point. I replaced <code>for_each</code>. This enhanced the const correctness."}, {"owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1539181338, "post_id": 52742063, "comment_id": 92409505, "body": "@JohnnyMopp I have not read this comment before posting my answer. Nevertheless, teaching C++ without proper container is ihmo not the right way to do it. There is no point in still using pointers and sizes if a <code>std::vector</code> can be used. C++ should be taught as shown in <code>A Tour of C++</code> by Stroustrup."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1539181799, "post_id": 52742063, "comment_id": 92409805, "body": "Where did the OP state that the algorithm functions couldn&#39;t be used?  I see that they cannot use <code>vector</code>, but <code>vector</code> is not an algorithm function."}, {"owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539181880, "post_id": 52742063, "comment_id": 92409854, "body": "@PaulMcKenzie he stated that in the comments to the question."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539181961, "post_id": 52742063, "comment_id": 92409905, "body": "@schorsch312 -- Where in the comments is it stated that algorithm <i>functions</i> cannot be used?  Again <code>vector</code> is not an algorithm function.  STL consists of containers (which the OP says couldn&#39;t be used) and functions (which the OP has yet to say anything about)."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1539182518, "post_id": 52742063, "comment_id": 92410264, "body": "@schorsch312 ok.  I commented in the main thread that the algorithm functions can be used on regular arrays, so there is no need to resort to vector.  But waiting for the OP to acknowledge whether that would be an acceptable answer."}], "tags": [], "owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "is_accepted": false, "score": 3, "last_activity_date": 1605508345, "last_edit_date": 1605508345, "creation_date": 1539180193, "answer_id": 52742063, "question_id": 52741140, "link": "https://stackoverflow.com/questions/52741140/delete-duplicates-from-array-c/52742063#52742063", "title": "Delete duplicates from array C++", "body": "<p>I would let the std containers to what you like to do.</p>\n<ul>\n<li>Sort the vector</li>\n<li>Use <code>erase</code> and <code>unique</code> to delete duplicates.</li>\n</ul>\n<p>Here is the code</p>\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nvoid print(const std::vector&lt;int&gt; &amp;arr){\n    for (const auto &amp; i : arr){\n        std::cout &lt;&lt; i &lt;&lt;&quot; &quot;;\n    }\n    std::cout &lt;&lt;&quot;\\n&quot;;\n}\n\nint main() {\n    std::vector&lt;int&gt; arr{1, 2, 2, 5, 6, 1};    \n    print(arr);\n\n    std::sort( arr.begin(), arr.end() );\n    arr.erase( std::unique( arr.begin(), arr.end() ), arr.end() );\n\n    print(arr);\n}\n</code></pre>\n<p>Ps. Using <code>int *arr, int arraySize</code> is not very C++ like. Please always try to use a proper container (which almost always will be <code>std::vector</code>).</p>\n<p>EDIT:\nI changed my answer a bit, because I found this speed comparison (and actuallty the whole question answered).\n<a href=\"https://stackoverflow.com/questions/1041620/whats-the-most-efficient-way-to-erase-duplicates-and-sort-a-vector\">What&#39;s the most efficient way to erase duplicates and sort a vector?</a></p>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 2, "last_activity_date": 1539182288, "last_edit_date": 1539182288, "creation_date": 1539181685, "answer_id": 52742550, "question_id": 52741140, "link": "https://stackoverflow.com/questions/52741140/delete-duplicates-from-array-c/52742550#52742550", "title": "Delete duplicates from array C++", "body": "<p>It might be easier to imagine the algorithm having separate input and output arrays. Then, in pseudo-code:</p>\n\n<pre><code>for i = 0 to input_array_size-1\n    Is input[i] equal to input[j] for any j between 0 and i-1?\n    Yes - do nothing\n    No - copy input[i] to output\n</code></pre>\n\n<p>To implement this with shared input and output, you need to have two array sizes, <code>input_array_size</code> and <code>output_array_size</code>. Then, the pseudo-code becomes</p>\n\n<pre><code>output_array_size = 0\nfor i = 0 to input_array_size-1\n    Is array[i] equal to array[j] for any j between 0 and output_array_size-1?\n    Yes - do nothing\n    No:\n        copy array[i] to array[output_array_size]\n        Increase output_array_size\n</code></pre>\n\n<p>Note: it writes output where the input once was, so the check for duplicates should look at all elements that were output. For example, if your array is <code>1, 2, 1, 3, 5, 6, 3</code>, then for the last <code>3</code> the accumulated output is <code>1, 2, 3, 5, 6</code>, and the code should compare all these with the current element.</p>\n\n<hr>\n\n<p>To simplify debugging, where it says \"do nothing\", you can set current element to -1. This way, if you print your array during execution (for debugging), it will be clearer which elements were removed.</p>\n"}, {"tags": [], "owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 2, "last_activity_date": 1539183325, "creation_date": 1539183325, "answer_id": 52743084, "question_id": 52741140, "link": "https://stackoverflow.com/questions/52741140/delete-duplicates-from-array-c/52743084#52743084", "title": "Delete duplicates from array C++", "body": "<p>Given your assignment constraints (more C-like, than idiomatic C++), you can rewrite your function like this, to make it work:</p>\n\n<pre><code>void deleteRepeats(int *arr, int arraySize, int&amp; posUsed)\n{\n    for (int i = 0; i &lt; posUsed; ++i)\n    {\n        int duplicates = 0;\n        int j = i + 1;\n        // find the first duplicate, if exists\n        for ( ; j &lt; posUsed; ++j)\n        {\n            if ( arr[i] == arr[j] ) {\n                ++duplicates;\n                break;\n            }\n        }\n        // overwrite the duplicated values moving the rest of the elements...\n        for (int k = j + 1; k &lt; posUsed; ++k)\n        {\n            if (arr[i] != arr[k])\n            {\n                arr[j] = arr[k];\n                ++j;\n            }\n            // ...but skip other duplicates\n            else\n            {\n                ++duplicates;    \n            }\n        }\n        posUsed -= duplicates;\n    }\n    // clean up (could be limited to the duplicates only)\n    for (int i = posUsed; i &lt; arraySize; ++i)\n        arr[i] = 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9578905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ahmed Eid", "link": "https://stackoverflow.com/users/9578905/ahmed-eid"}, "is_accepted": false, "score": 0, "last_activity_date": 1590952210, "last_edit_date": 1590952210, "creation_date": 1590951886, "answer_id": 62121167, "question_id": 52741140, "link": "https://stackoverflow.com/questions/52741140/delete-duplicates-from-array-c/62121167#62121167", "title": "Delete duplicates from array C++", "body": "<p>using two pointers <br>\nand if the array sorted</p>\n\n<pre><code>    int removeDuplicates(vector&lt;int&gt;&amp; nums) {\n        if(nums.size() == 0) return 0;\n        int i = 0;\n\n        for(int j = 1; j &lt; nums.size(); j++)\n            if(nums[j] != nums[i])  nums[++i] = nums[j];\n\n        // return new array length\n        return i + 1;\n    }\n</code></pre>\n\n<pre><code>//input: [1, 1, 2, 1] (arr1)\n//output: 2 (returned length)\n// print unique element\nfor(int i = 0; i &lt; output; i++) cout &lt;&lt; arr1[i] &lt;&lt; '\\n';\n// [1, 2]\n</code></pre>\n\n<pre><code>time complexity: O(N/2) -&gt; O(N)\nspace complexity: O(1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 13703720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52367991276128cf4eaa2295ce721a37?s=128&d=identicon&r=PG&f=1", "display_name": "cryptor", "link": "https://stackoverflow.com/users/13703720/cryptor"}, "is_accepted": false, "score": 1, "last_activity_date": 1605534523, "creation_date": 1605534523, "answer_id": 64859237, "question_id": 52741140, "link": "https://stackoverflow.com/questions/52741140/delete-duplicates-from-array-c/64859237#64859237", "title": "Delete duplicates from array C++", "body": "<p>there are only two changes made as you can see</p>\n<p>1: you were traversing the whole array as you have declared a <code>posUsed=6</code> variable which is because there are only 6 elements so in in loops you need to traverse in array upto <code>posUsed</code> index like <code>i&lt;posUsed</code> <code>j&lt;posUsed</code> <code>k&lt;posUsed</code></p>\n<p>2: the second changes is in j loop <code>j=i+1</code> because you don't need to compare the element of any index with element of the same index you have to compare it with elements after that index. if you compare it with same element it will be same and the program will delete that same element which results in ERROR.</p>\n<p>onw more thing is that we don't traverse after <code>posUsed</code> index because after that the array is already empty/zero or null whatever you call it</p>\n<p>and if you want to display just the non duplicated elements and not the zero's at the end of the array just add <code>if(arr[i]==0) return;</code> in the <code>printArray</code> function loop before <code>cout</code> statement</p>\n<pre><code>void deleteRepeats(int *arr, int arraySize, int&amp; posUsed)\n{\n{\n    for (int i = 0; i &lt; posUsed; i++)\n    {\n        for (int j = i+1; j &lt; posUsed; j++)\n        {\n            if (arr[i] == arr[j])\n            {\n                for (int k = j; k &lt; posUsed; k++)\n                {\n                    arr[k] = arr[k + 1];\n                    \n                }\n            }\n        \n        }\n    }\n}\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4738, "favorite_count": 0, "accepted_answer_id": 52743084, "answer_count": 5, "score": 2, "last_activity_date": 1605534523, "creation_date": 1539177318, "last_edit_date": 1539178629, "question_id": 52741140, "link": "https://stackoverflow.com/questions/52741140/delete-duplicates-from-array-c", "title": "Delete duplicates from array C++", "body": "<p>I am trying to create a simple program which calls on 2 functions. The first function takes a partially filled array, loops through it and deletes any duplicate values. When a value is deleted from the array, the remaining numbers are moved backwards to fill the gap i.e. when the function is finished, all null values of the array will be together at the end. </p>\n\n<p>The second function prints the updated array. </p>\n\n<p>My current code is below. At present when I run my code, the console shows: \n2 6 0 -858993460 -858993460 -858993460 -858993460 -858993460 -858993460 -858993460. It should be showing: 1 2 5 6 if it worked correctly.</p>\n\n<p>Also, I am not sure how to move the remaining elements of the array backwards so that the null values will be together at the end.</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\nusing namespace std;\nvoid deleteRepeats(int *arr, int arraySize, int&amp; posUsed);\nvoid printArray(int *arr, int arraySize);\n\nint main()\n{\nint arr[10] = { 1, 2, 2, 5, 6, 1};\nint posUsed = 6;\nint arraySize = 10;\n\n\ndeleteRepeats(arr, arraySize, posUsed);\nprintArray(arr, arraySize);\n\nreturn 0;\n}\n\nvoid deleteRepeats(int *arr, int arraySize, int&amp; posUsed)\n{\n{\n    for (int i = 0; i &lt; arraySize; i++)\n    {\n        for (int j = i; j &lt; arraySize; j++)\n        {\n            if (arr[i] == arr[j])\n            {\n                for (int k = j; k &lt; arraySize; k++)\n                {\n                    arr[k] = arr[k + 1];\n\n                }\n                posUsed--;\n\n            }\n            else\n                j++;\n        }\n    }\n}\n}\n\nvoid printArray(int *arr, int arraySize)\n{\nfor (int i = 0; i &lt; arraySize; i++)\n{\n    cout &lt;&lt; arr[i] &lt;&lt; \"  \";\n}\n}\n</code></pre>\n"}, {"tags": ["c++", "loops", "for-loop", "math", "recurrence"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539177372, "post_id": 52741114, "comment_id": 92406998, "body": "Welcome to stackoverflow.com. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please read <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1539177382, "post_id": 52741114, "comment_id": 92407004, "body": "What is your question exactly? Also, you redefine <code>double Yn</code> on every loop iteration using itself (i.e. you create new Yn for each loop iteration, you don&#39;t recomnpute it based on previous values). Seems like it should be declared outside the loop first."}, {"owner": {"reputation": 35, "user_id": 9894604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c571f2987b9374940035b427248d47?s=128&d=identicon&r=PG&f=1", "display_name": "user83869", "link": "https://stackoverflow.com/users/9894604/user83869"}, "edited": false, "score": 0, "creation_date": 1539177697, "post_id": 52741114, "comment_id": 92407208, "body": "Edited the question with the table and equation"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539178147, "post_id": 52741114, "comment_id": 92407485, "body": "please check my edit and roll back if it is not ok. I dont know how to write subscripts , but imho not its less wrong/confusing than before"}, {"owner": {"reputation": 35, "user_id": 9894604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c571f2987b9374940035b427248d47?s=128&d=identicon&r=PG&f=1", "display_name": "user83869", "link": "https://stackoverflow.com/users/9894604/user83869"}, "edited": false, "score": 0, "creation_date": 1539178647, "post_id": 52741114, "comment_id": 92407801, "body": "But the table still don&#39;t match."}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539182103, "post_id": 52741354, "comment_id": 92409999, "body": "<code>double Y[N];</code> might also make sense. with a notation near of given equation."}, {"owner": {"reputation": 35, "user_id": 9894604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c571f2987b9374940035b427248d47?s=128&d=identicon&r=PG&f=1", "display_name": "user83869", "link": "https://stackoverflow.com/users/9894604/user83869"}, "edited": false, "score": 0, "creation_date": 1539190294, "post_id": 52741354, "comment_id": 92415042, "body": "<code>Y_prev2 = Y_prev1;     Y_prev1 = Y;</code> Can yo tell me what is this for ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539190430, "post_id": 52741354, "comment_id": 92415111, "body": "To calculate each number in the sequence, you need the prior two numbers.  After each iteration of the loop, you need to update what the last two numbers were.  Those two statements do that."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 35, "user_id": 9894604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c571f2987b9374940035b427248d47?s=128&d=identicon&r=PG&f=1", "display_name": "user83869", "link": "https://stackoverflow.com/users/9894604/user83869"}, "edited": false, "score": 0, "creation_date": 1539191849, "post_id": 52741354, "comment_id": 92415840, "body": "@user83869 So at the end of each iteration, <code>Y</code> becomes <code>Y_prev1</code>, and <code>Y_prev1</code> becomes <code>Y_prev2</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1539180159, "last_edit_date": 1539180159, "creation_date": 1539178073, "answer_id": 52741354, "question_id": 52741114, "link": "https://stackoverflow.com/questions/52741114/my-question-is-about-recurrence-of-numbers-and-sequences-in-c-and-how-to-print/52741354#52741354", "title": "My question is about recurrence of numbers and sequences in C++ and how to print them?", "body": "<p>You wrote down the sequence wrong.</p>\n\n<p>You have:</p>\n\n<blockquote>\n  <p>Yn = 1/2*(Yn - 1) + 1/3*(Yn - 2)</p>\n</blockquote>\n\n<p>But it should be:</p>\n\n<blockquote>\n  <p>Y<sub>n</sub> = 1/2*(Y<sub>n-1</sub>) + 1/3*(Y<sub>n-2</sub>)</p>\n</blockquote>\n\n<p>So you need to keep track of the previous two numbers in the sequence to calculate the next one:</p>\n\n<pre><code>int i=1;\nconst int N = 5;\ndouble Y_prev1 = 0.4;\ndouble Y_prev2 = 0.5;\nstd::cout &lt;&lt; i++ &lt;&lt; \" \" &lt;&lt; \"= \"&lt;&lt; \" \" &lt;&lt; Y_prev2 &lt;&lt; std::endl;\nstd::cout &lt;&lt; i++ &lt;&lt; \" \" &lt;&lt; \"= \"&lt;&lt; \" \" &lt;&lt; Y_prev1 &lt;&lt; std::endl;\nfor (; i &lt;= N; i++){\n    double Y = (1.0 / 2) * (Y_prev1) +  (1.0 / 3) * (Y_prev2);\n    std::cout &lt;&lt; i &lt;&lt; \" \" &lt;&lt; \"= \"&lt;&lt; \" \" &lt;&lt; Y;\n    std::cout &lt;&lt; std::endl;\n    Y_prev2 = Y_prev1;\n    Y_prev1 = Y;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 =  0.5\n2 =  0.4\n3 =  0.366667\n4 =  0.316667\n5 =  0.280556\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9894604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c571f2987b9374940035b427248d47?s=128&d=identicon&r=PG&f=1", "display_name": "user83869", "link": "https://stackoverflow.com/users/9894604/user83869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539180159, "creation_date": 1539177228, "last_edit_date": 1539178410, "question_id": 52741114, "link": "https://stackoverflow.com/questions/52741114/my-question-is-about-recurrence-of-numbers-and-sequences-in-c-and-how-to-print", "title": "My question is about recurrence of numbers and sequences in C++ and how to print them?", "body": "<pre><code>#include &lt;iostream&gt; \n#include &lt;cmath&gt;\n\nusing namespace std;\n\nint main()\n{\n    int i;\n    const int N = 5;\n    for (i = 1; i &lt;= N; i++){\n        double Yn = (1.0 / 2) * (Yn - 1) +  (1.0 / 3) * (Yn - 2);\n        std::cout &lt;&lt; i &lt;&lt; \" \" &lt;&lt; \"= \"&lt;&lt; \" \" &lt;&lt; Yn;\n    std::cout &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I have an equation and a table of sequences. </p>\n\n<p><strong>Equation</strong></p>\n\n<pre><code>Y[n] = 1/2*(Y[n-1]) + 1/3*(Y[n-2])\n\nY[1] = 0.5, Y[2] = 0.4 \n</code></pre>\n\n<p>The table shown below should be printed by using for loops.  </p>\n\n<pre><code>N -- Yn  \n1 -- 0.5  \n2 -- 0.4  \n3 -- 0.366667  \n4 -- 0.316667  \n5 -- 0.280556  \n</code></pre>\n\n<p>All I have to do is to print the above table .</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1539177084, "post_id": 52741039, "comment_id": 92406809, "body": "What is the point of <code>unsigned char* bytes = &amp;(readRequestArray);</code>? If you want to access the underlying array of a <code>std::vector</code> use the <code>.data()</code> method"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1539177130, "post_id": 52741039, "comment_id": 92406830, "body": "Do note that C++ is hard and trying to learn everything you have been asking about would best be served by getting a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book or two</a>"}], "answers": [{"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 1, "last_activity_date": 1539177621, "creation_date": 1539177621, "answer_id": 52741237, "question_id": 52741039, "link": "https://stackoverflow.com/questions/52741039/how-to-convert-float-to-vectorunsigned-char-in-c/52741237#52741237", "title": "How to convert float to vector&lt;unsigned char&gt; in C++?", "body": "<p>Just copy it back to float:</p>\n\n<pre><code>float value;\nstd::copy( readRequestArray.begin(), readRequestArray.end(), reinterpret_cast&lt;const unsigned char*&gt;( &amp;value ) );\n</code></pre>\n\n<p>Usually this is done by implementing functions that unmarshall from <code>std::vector&lt;byte&gt;</code> to various types for example:</p>\n\n<pre><code> template&lt;typename T&gt;\n T read( std::vector&lt;byte&gt;::iterator &amp;it )\n {\n     auto prev = it;\n     it += sizeof(T);\n     T value;\n     std::copy( prev, it, reinterpret_cast&lt;byte *&gt;( &amp;value ) );\n     return value;\n }\n</code></pre>\n\n<p>then use:</p>\n\n<pre><code> std::vector&lt;byte&gt; data;\n auto it = data.begin();\n auto floatValue = read&lt;float&gt;( it );\n auto intValue   = read&lt;int&gt;( it );\n</code></pre>\n\n<p>but you need to be careful and use it only for POD types (maybe add <code>std::enable_if</code> to enforce it). Also you need to make sure that vector have enough data or pass a second iterator to the function to validate that there is enough data.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1539177963, "last_edit_date": 1539177963, "creation_date": 1539177635, "answer_id": 52741243, "question_id": 52741039, "link": "https://stackoverflow.com/questions/52741039/how-to-convert-float-to-vectorunsigned-char-in-c/52741243#52741243", "title": "How to convert float to vector&lt;unsigned char&gt; in C++?", "body": "<p>To convert a <code>float</code> to and from a <code>std::vector&lt;unsigned char&gt;</code> you can use the following</p>\n\n<pre><code>auto to_vector(float f)\n{\n    // get vector of the right size\n    std::vector&lt;unsigned char&gt; data(sizeof(f));\n    // copy the bytes\n    std::memcpy(data.data(), &amp;f, sizeof(f));\n    return data;\n}\n\nauto from_vector(const std::vector&lt;unsigned char&gt;&amp; data)\n{\n    float f;\n    // make sure the vector is the right size\n    if (data.size() != sizeof(f))\n        throw std::runtime_error{\"Size of data in vector and float do not match\"};\n    // copy the bytes into the float\n    std::memcpy(&amp;f, data.data(), sizeof(f));\n    return f;\n}\n\nint main()\n{\n    float foo = 3.14;\n    auto data = to_vector(foo);\n    auto ret = from_vector(data);\n    std::cout &lt;&lt; ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1024, "favorite_count": 0, "accepted_answer_id": 52741243, "answer_count": 2, "score": 0, "last_activity_date": 1539177963, "creation_date": 1539176955, "question_id": 52741039, "link": "https://stackoverflow.com/questions/52741039/how-to-convert-float-to-vectorunsigned-char-in-c", "title": "How to convert float to vector&lt;unsigned char&gt; in C++?", "body": "<p>I read <a href=\"https://stackoverflow.com/questions/11022099/convert-float-vector-to-byte-vector-and-back\">Convert float vector to byte vector and back</a> but it didn't help me to solve my issue.\nI want to convert <code>std::vector&lt;unsigned char&gt;</code> back to a <code>float</code>. The line on <code>unsigned char* bytes = &amp;(readRequestArray);</code> is not working and the lines above I am only printing bytes. How do I convert back to a float?</p>\n\n<pre><code>class HCSR04: public ISensor {\npublic:\n    HCSR04();\n    HCSR04(int trigger, int echo);\n    ~HCSR04();\n    float distanceCentimeters();\n    std::vector&lt;unsigned char&gt; readRequest();\n}\n\nstd::vector&lt;unsigned char&gt; HCSR04::readRequest() {\n    float preCent = distanceCentimeters();\n    const unsigned char* bytes = reinterpret_cast&lt;const unsigned char*&gt;(&amp;preCent);\n    std::vector&lt;unsigned char&gt; buffer(bytes, bytes + sizeof(float));\n    for (int j = 0; j &lt; buffer.size(); j++) {\n        std::cout &lt;&lt; buffer[j];\n    }\n    std::cout &lt;&lt; std::endl;\n    return buffer;\n}\n\nint main(void) {\n    std::vector&lt;unsigned char&gt; readRequestArray = sensorUltrasonic-&gt;readRequest();\n        for (int j = 0; j &lt; readRequestArray.size(); j++) {\n            std::cout &lt;&lt; readRequestArray[j];\n        }\n        std::cout &lt;&lt; std::endl;\n\n        unsigned char* bytes = &amp;(readRequestArray);\n        for (int i = 0; i &lt; 3; i++)\n            std::cout &lt;&lt; (float) bytes[i] &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "encryption", "arduino", "cryptography", "aes"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1539177288, "post_id": 52740945, "comment_id": 92406939, "body": "I&#39;m not familiar with this library specifically, but try setting the key again before you decrypt. In AES, encrypt and decrypt both modify the key data as they go."}, {"owner": {"reputation": 75, "user_id": 3371137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbb7e80ee9c7c683884d2be8e83d124?s=128&d=identicon&r=PG&f=1", "display_name": "user3371137", "link": "https://stackoverflow.com/users/3371137/user3371137"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1539183927, "post_id": 52740945, "comment_id": 92411166, "body": "@500 - Internal Server Error Okay I tried implementing your suggestion the problem still persists. Basically currently right now the encryption and decryption will be successful with the current array of .plaintext but if I change it to other values the serial port displays &quot;Failed&quot; for both encryption and decryption"}], "owner": {"reputation": 75, "user_id": 3371137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbb7e80ee9c7c683884d2be8e83d124?s=128&d=identicon&r=PG&f=1", "display_name": "user3371137", "link": "https://stackoverflow.com/users/3371137/user3371137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 908, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539178534, "creation_date": 1539176674, "last_edit_date": 1539178534, "question_id": 52740945, "link": "https://stackoverflow.com/questions/52740945/aes128-encryption-on-arduino", "title": "AES128 encryption on Arduino", "body": "<p>I am trying to use an arduino to encrypt data as AES128 and then decrypt it. I am also experimenting with AES192 and AES256 but first I'd like to get it to work with AES128. I am using the Cyptography Library and I am struggling to figure out what is happening here. In the code below one may observe that a testVector has a name to identify it, a unique key, plain text, and cipher text. When I tried modifying the \".plaintext\" in the array it causes the encryption and thus decryption to fail. My goal is to encrypt \"My Message\" and then decrypt it afterwords.</p>\n\n<p>Please see my code below:</p>\n\n<pre><code>#include &lt;Crypto.h&gt;\n#include &lt;AES.h&gt;\n#include &lt;string.h&gt;\n\nstruct TestVector\n{ \n    const char *name;\n    byte key[32];\n    byte plaintext[16];\n    byte ciphertext[16];\n};\n\n// Define the ECB test vectors from the FIPS specification.\nstatic TestVector const testVectorAES128 = {\n    .name        = \"AES-128-ECB\",\n    .key         = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,\n                    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F},\n    .plaintext   = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,\n                    0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF},\n    .ciphertext  = {0x69, 0xC4, 0xE0, 0xD8, 0x6A, 0x7B, 0x04, 0x30,\n                    0xD8, 0xCD, 0xB7, 0x80, 0x70, 0xB4, 0xC5, 0x5A}\n};\nstatic TestVector const testVectorAES192 = {\n    .name        = \"AES-192-ECB\",\n    .key         = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,\n                    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,\n                    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17},\n    .plaintext   = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,\n                    0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF},\n    .ciphertext  = {0xDD, 0xA9, 0x7C, 0xA4, 0x86, 0x4C, 0xDF, 0xE0,\n                    0x6E, 0xAF, 0x70, 0xA0, 0xEC, 0x0D, 0x71, 0x91}\n};\nstatic TestVector const testVectorAES256 = {\n    .name        = \"AES-256-ECB\",\n    .key         = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,\n                    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,\n                    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,\n                    0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F},\n    .plaintext   = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,\n                    0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF},\n    .ciphertext  = {0x8E, 0xA2, 0xB7, 0xCA, 0x51, 0x67, 0x45, 0xBF,\n                    0xEA, 0xFC, 0x49, 0x90, 0x4B, 0x49, 0x60, 0x89}\n};\n\nAES128 aes128;\nAES192 aes192;\nAES256 aes256;\n\nbyte buffer[16];\n\nvoid testCipher(BlockCipher *cipher, const struct TestVector *test)\n{\n    crypto_feed_watchdog();\n    Serial.print(test-&gt;name);\n    Serial.print(\" Encryption ... \");\n    cipher-&gt;setKey(test-&gt;key, cipher-&gt;keySize());\n    cipher-&gt;encryptBlock(buffer, test-&gt;plaintext);\n    if (memcmp(buffer, test-&gt;ciphertext, 16) == 0){\n        Serial.println(\"Passed\");\n        String myString = String((char*)buffer);\n        Serial.println(myString);\n    }\n    else\n        Serial.println(\"Failed\");\n\n    Serial.print(test-&gt;name);\n    Serial.print(\" Decryption ... \");\n    cipher-&gt;decryptBlock(buffer, test-&gt;ciphertext);\n    if (memcmp(buffer, test-&gt;plaintext, 16) == 0){\n        Serial.println(\"Passed\");\n        String myString2 = String((char*)buffer);\n        Serial.println(myString2);\n    }\n    else\n        Serial.println(\"Failed\");\n}\n\nvoid perfCipher(BlockCipher *cipher, const struct TestVector *test)\n{\n    unsigned long start;\n    unsigned long elapsed;\n    int count;\n\n    crypto_feed_watchdog();\n\n    Serial.print(test-&gt;name);\n    Serial.print(\" Set Key ... \");\n    start = micros();\n    for (count = 0; count &lt; 10000; ++count) {\n        cipher-&gt;setKey(test-&gt;key, cipher-&gt;keySize());\n    }\n    elapsed = micros() - start;\n    Serial.print(elapsed / 10000.0);\n    Serial.print(\"us per operation, \");\n    Serial.print((10000.0 * 1000000.0) / elapsed);\n    Serial.println(\" per second\");\n\n    Serial.print(test-&gt;name);\n    Serial.print(\" Encrypt ... \");\n    start = micros();\n    for (count = 0; count &lt; 5000; ++count) {\n        cipher-&gt;encryptBlock(buffer, buffer);\n    }\n    elapsed = micros() - start;\n    Serial.print(elapsed / (5000.0 * 16.0));\n    Serial.print(\"us per byte, \");\n    Serial.print((16.0 * 5000.0 * 1000000.0) / elapsed);\n    Serial.println(\" bytes per second\");\n\n    Serial.print(test-&gt;name);\n    Serial.print(\" Decrypt ... \");\n    start = micros();\n    for (count = 0; count &lt; 5000; ++count) {\n        cipher-&gt;decryptBlock(buffer, buffer);\n    }\n    elapsed = micros() - start;\n    Serial.print(elapsed / (5000.0 * 16.0));\n    Serial.print(\"us per byte, \");\n    Serial.print((16.0 * 5000.0 * 1000000.0) / elapsed);\n    Serial.println(\" bytes per second\");\n\n    Serial.println();\n}\n\nvoid setup()\n{\n    Serial.begin(9600);\n\n    Serial.println();\n\n    Serial.println(\"State Sizes:\");\n    Serial.print(\"AES128 ... \");\n    Serial.println(sizeof(AES128));\n    Serial.print(\"AES192 ... \");\n    Serial.println(sizeof(AES192));\n    Serial.print(\"AES256 ... \");\n    Serial.println(sizeof(AES256));\n    Serial.println();\n\n    Serial.println(\"Test Vectors:\");\n    testCipher(&amp;aes128, &amp;testVectorAES128);\n    testCipher(&amp;aes192, &amp;testVectorAES192);\n    testCipher(&amp;aes256, &amp;testVectorAES256);\n\n    Serial.println();\n\n    Serial.println(\"Performance Tests:\");\n    perfCipher(&amp;aes128, &amp;testVectorAES128);\n    perfCipher(&amp;aes192, &amp;testVectorAES192);\n    perfCipher(&amp;aes256, &amp;testVectorAES256);\n}\n\nvoid loop()\n{\n}\n</code></pre>\n\n<p>Here is some information on the library:</p>\n\n<p><a href=\"https://rweather.github.io/arduinolibs/classBlockCipher.html#ac3ba2450222aa1ea804ae4881ab6440c\" rel=\"nofollow noreferrer\">https://rweather.github.io/arduinolibs/classBlockCipher.html#ac3ba2450222aa1ea804ae4881ab6440c</a></p>\n"}, {"tags": ["c++", "windows", "winapi", "visual-c++", "iocp"], "comments": [{"owner": {"reputation": 63, "user_id": 7998492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJYAT_-epTM/AAAAAAAAAAI/AAAAAAAABEA/Br2y9gOtFaQ/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/7998492/praveen"}, "edited": false, "score": 0, "creation_date": 1539176758, "post_id": 52740938, "comment_id": 92406595, "body": "Just to add, there are 2 or 3 getter methods in this class."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1539177146, "post_id": 52740938, "comment_id": 92406843, "body": "at first <code>GetQueuedCompletionStatus</code> dont understand what is <i>class</i>, <i>struct</i> etc. it return exactly pointer value passed by <code>PostQueuedCompletionStatus</code> direct or via file handle completion key. at second for what you use <code>GetQueuedCompletionStatus</code> at all instead <code>BindIoCompletionCallback</code> to <code>m_hDir</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1539177553, "post_id": 52740938, "comment_id": 92407112, "body": "<code>(ULONG_PTR)&amp;l_poShareInfo</code> - this is your error. must be <code>(ULONG_PTR)l_poShareInfo</code>. as result you got <code>&amp;l_poShareInfo</code> - address of local variable which hold pointer to your data. but you need address intself (<code>l_poShareInfo</code>)"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1539177593, "post_id": 52740938, "comment_id": 92407141, "body": "It can be anything you want, it is just a pointer.  The only requirement is that it is still valid by the time the I/O completes.  So never pass a pointer to a local variable, you meant to use l_poShareInfo, not &amp;l_poShareInfo."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 2, "creation_date": 1539198513, "post_id": 52740938, "comment_id": 92418911, "body": "It&#39;s not actually even a pointer, it&#39;s just a value that is guaranteed to be the same size as a normal data pointer."}, {"owner": {"reputation": 63, "user_id": 7998492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJYAT_-epTM/AAAAAAAAAAI/AAAAAAAABEA/Br2y9gOtFaQ/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/7998492/praveen"}, "edited": false, "score": 0, "creation_date": 1539229496, "post_id": 52740938, "comment_id": 92427698, "body": "Thank you very much, It was silly of me not to pass the local variable. Issue resolved."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1539270843, "post_id": 52740938, "comment_id": 92450036, "body": "can advice also instead create iocp yourself and working thread pool which will be listen on it - much simply call <code>BindIoCompletionCallback</code> on <code>m_hDir</code> as result your callback with be called when io complete. and use reference count on <code>ShareInfo</code>"}], "owner": {"reputation": 63, "user_id": 7998492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJYAT_-epTM/AAAAAAAAAAI/AAAAAAAABEA/Br2y9gOtFaQ/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/7998492/praveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539176653, "creation_date": 1539176653, "question_id": 52740938, "link": "https://stackoverflow.com/questions/52740938/do-windows-io-completion-ports-work-with-classes-as-completion-keys", "title": "Do Windows IO Completion Ports work with classes as completion keys?", "body": "<p><strong>TLDR</strong> - <code>GetQueuedCompletionStatus</code> does not return if I provide a class object as the completion key, it returns only if structure object is passed instead.</p>\n\n<hr>\n\n<p>I created a IOCP in main thread using <code>CreateIoCompletionPort</code> </p>\n\n<pre><code>ShareInfo* l_poShareInfo = new ShareInfo(hDir, p_sSharePath, p_oChangeHandler, dwChangesToMonitor, true);\n\nm_hCompPort = CreateIoCompletionPort(hDir, m_hCompPort, (ULONG_PTR)&amp;l_poShareInfo, 0);\n</code></pre>\n\n<p>and then I wait for data in a worker thread using <code>GetQueuedCompletionStatus</code></p>\n\n<pre><code>ShareInfo* l_ShareInfo;\nGetQueuedCompletionStatus((HANDLE)l_pThis-&gt;m_hCompPort, &amp;nBytes, (PULONG_PTR)&amp;l_ShareInfo, &amp;lpOverlapped, INFINITE);\n</code></pre>\n\n<p><code>ShareInfo</code> is a class as follows, whose object I am using as a completion key.</p>\n\n<pre><code>class ShareInfo\n{\npublic:\n    ShareInfo();\n    ShareInfo(HANDLE p_hDir, const std::wstring &amp; p_sSharePath, FileChangeHandlerBase * p_poChangeHandler, DWORD p_dwChangeFilter, bool p_bWatchSubDir);\n    ~ShareInfo();\n\n\n    OVERLAPPED  m_Overlapped;\n    HANDLE      m_hDir;\n    TCHAR       m_sSharePath[MAX_PATH];\n    CHAR        m_Buffer[4096];\n    DWORD       m_dwBufLength;\n    DWORD       m_dwChangeFilter;\n    FileChangeHandlerBase* m_poChangeHandler;\n\n    BOOL        m_bWatchSubDir;\n};\n</code></pre>\n\n<p>However, <code>GetQueuedCompletionStatus</code> doesn't return. If I provide a structure object instead of a class object, it works as expected. So I had to transform my class as follows and use an object of <code>ShareInfo::ShareInfoData</code> as completion key.</p>\n\n<pre><code>class ShareInfo\n{\npublic:\n    .\n    .\n    typedef struct \n    {\n        OVERLAPPED  m_Overlapped;\n        HANDLE      m_hDir;\n        TCHAR       m_sSharePath[MAX_PATH];\n        CHAR        m_Buffer[4096];\n        DWORD       m_dwBufLength;\n        DWORD       m_dwChangeFilter;\n        FileChangeHandlerBase* m_poChangeHandler;\n\n    }ShareInfoData;\n\n    ShareInfoData   m_shareInfoData;\n    BOOL            m_bWatchSubDir;\n};\n</code></pre>\n\n<p>I suspect Completion keys cannot to be classes, but I don't find anything mentioned in the official docs. Am I missing something fundamental here?</p>\n"}, {"tags": ["c++", "printf", "overloading"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1539177037, "post_id": 52740935, "comment_id": 92406779, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/8626441/how-to-give-a-class-as-valid-parameter-for-printf-where-it-returns-as-a-string\" title=\"how to give a class as valid parameter for printf where it returns as a string\">stackoverflow.com/questions/8626441/&hellip;</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1539183543, "post_id": 52740935, "comment_id": 92410887, "body": "Passing an <code>example</code> object as-is directly to <code>printf()</code> is <b>undefined behavior</b>. You need to pass its <code>x</code> member explicitly instead: <code>example a(5); printf(&quot;the value is: %d&quot;, a.x);</code> &quot;<i>I just want to try to use printf</i>&quot; - there is really no good reason to do that in C++. &quot;<i>I also tried making it do <code>std::cout&lt;&lt;object.x;</code> When I did that, it automatically added a newline at the front of the int</i>&quot; - no, it doesn&#39;t. A newline is printed only if you print an actual <code>\\n</code> character or use <code>std::endl</code>. <code>operator&lt;&lt;</code> for an <code>int</code> value does neither of those."}], "owner": {"user_type": "does_not_exist", "display_name": "user10444020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539176644, "creation_date": 1539176644, "question_id": 52740935, "link": "https://stackoverflow.com/questions/52740935/how-to-properly-overload-printf-to-print-a-value-from-a-class-c", "title": "How to properly overload printf to print a value from a class c++", "body": "<p>Is there a way to use printf to print a value of a class?</p>\n\n<pre><code>class example\n{\npublic:\n    int x;\n    example(int in) : x(in) {}\n}\n\nvoid printf(example object)\n{\n    printf(object.x);\n}\n</code></pre>\n\n<p>Is there a way to do that correctly?\nWhen I do that, I get a segmentation fault, \nBut when I use \"example&amp; object\", it says</p>\n\n<blockquote>\n  <p>error: cannot bind non-const lvalue reference of type 'object&amp;' to an\n  rvalue of 'object'</p>\n</blockquote>\n\n<p>And when I put \"const example&amp; object\", it says</p>\n\n<blockquote>\n  <p>Passing 'const example' as 'this' argument discards qualifiers</p>\n</blockquote>\n\n<p>note:\nI already did the std::cout (operator overloading &lt;&lt;) and it works, but I just want to try to use printf</p>\n\n<p>I also tried making it do </p>\n\n<pre><code>std::cout&lt;&lt;object.x;\n</code></pre>\n\n<p>When I did that, it automatically added a newline at the front of the int (like this):</p>\n\n<pre><code>example a(5);\nprintf(\"the value is: %i\", a) ;\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>the value is:\n5\n</code></pre>\n"}, {"tags": ["c++", "makefile", "shared-libraries", "tesseract"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1539176250, "post_id": 52740453, "comment_id": 92406249, "body": "It&#39;s unlikely that anyone can give you an explanation for an error message from lines that you didn&#39;t even bother to include in your question. Furthermore, it&#39;s fairly likely that an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is required, and not just the lines of code in question, in order to determine the compilation error. Finally, tesseract is on github, with active contributors and forums, where you are far more likely to find someone knowledgeable on that software, who will be able to point you in the right direction."}, {"owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1539177259, "post_id": 52740453, "comment_id": 92406915, "body": "Thank you for the suggestion, I will post it on github. I also added more lines of the error. Further errors are re-occurring or dependent on the error in the first lines I really thing. However, I dont know for sure. I am thankful for any help."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1539177756, "post_id": 52740453, "comment_id": 92407246, "body": "Do you have any instance of <code>using namespace std;</code> in your code."}, {"owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1539178045, "post_id": 52740453, "comment_id": 92407416, "body": "Yes, I have. many of those. There is a conflict of <code>std</code> and tesseract, which causes the issue shown in the second block comment. I resolved it by commenting out a couple of lines in <code>tesscallback.h</code>. When doing this, the error in the first block comment occurs, which I cannot solve."}, {"owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1539178279, "post_id": 52740453, "comment_id": 92407557, "body": "I edited my question, it shows more of the error, when I do comment out the lines as suggested in <a href=\"https://stackoverflow.com/questions/23740431/tesseract-remove-reference-ambiguous-symbol-in-project-on-visual-studio-2012\">here</a>. When using CMake, everything works fine."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1539178322, "post_id": 52740453, "comment_id": 92407592, "body": "Don&#39;t dump it on GitHub, provide a MCVE here in the question!"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1539178662, "post_id": 52740453, "comment_id": 92407813, "body": "Congratulations! You&#39;ve just discovered <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">why <code>using namespace std;</code> is bad practice</a>. You will do yourself a favor if you completely forget that it&#39;s a part of C++. Get rid of all &quot;using namespace std;&quot; in your code, and this problem goes away. That&#39;s your answer here. Learn the habit of fully adding the &quot;std::&quot; qualifier when referencing any class or template from the standard C++ library. It&#39;s not hard to learn to do that, it quickly becomes 2nd nature, and there is no other option."}, {"owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "edited": false, "score": 0, "creation_date": 1539183379, "post_id": 52740453, "comment_id": 92410797, "body": "Wow. I just erased <code>using namespace std;</code> from my &gt;20000 lines project and it works so far."}], "owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1539178362, "creation_date": 1539175021, "last_edit_date": 1539178362, "question_id": 52740453, "link": "https://stackoverflow.com/questions/52740453/linux-c-shared-libary-create-shared-library-using-tesseract", "title": "Linux, C++, shared libary: Create shared library using Tesseract", "body": "<p>I have want to build a shared object/shared library to be used by an executable later on. </p>\n\n<p>I have a directory with my own <code>*.cpp</code> as well as the corresponding <code>*.h</code> files. \nAll the files are located in the same directory as my <code>makefile</code> (<code>-I.</code>):</p>\n\n<pre><code>#makefile to create shared library w/o executable from own headers and tesseract\n\nCC = g++\n\nINCL = -I. -I/usr/include/tesseract/ -I/usr/include/leptonica/\n\nCFLAGS= -Wall -g -c -fPIC\n\nLDFLAGS = -shared\n\n\nLIBS = libtesseract.a liblept.a\n\nRM = rm -f\n\nTARGET_LIB = libTargetLib.so\n\nSRCS = *.cpp\nOBJS = $(SRCS:.cpp=.o)\n\n.PHONY: all\nall: ${TARGET_LIB}\n\n$(TARGET_LIB): $(OBJS)\n        $(CC) $(LDFLAGS) $(INCL) -Wl,-rpath=/usr/lib/x86_64-linux-gnu/ -o $(TARGET_LIB) $^ -L/usr/lib/x86_64-linux-gnu/ -llept -ltesseract\n\n$(OBJS): $(SRCS)\n        $(CC) $(CFLAGS) $(SRCS)\n</code></pre>\n\n<p>The library files to be linked, <code>libtesseract.a</code> and <code>liblept.a</code> are in the location <code>/usr/lib/x86_64-linux-gnu</code>, I doublechecked. </p>\n\n<p>I am aware of this problem: <a href=\"https://stackoverflow.com/questions/23740431/tesseract-remove-reference-ambiguous-symbol-in-project-on-visual-studio-2012\">ambiguous symbol File: tesscallback.h</a> so I also commented out the correspondent lines. </p>\n\n<p>When I run <code>make</code>, I get this error (tons of lines more): </p>\n\n<blockquote>\n  <p>In file included from /usr/include/tesseract/baseapi.h:34:0,\n                   from file1.h:16,\n                   from file1.cpp:4: /usr/include/tesseract/tesscallback.h:296:12: error: expected\n  nested-name-specifier before \u2018remove_reference\u2019    typename\n  remove_reference::type p1_;\n              ^~~~~~~~~~~~~~~~ /usr/include/tesseract/tesscallback.h:296:12: error: expected \u2018;\u2019 at\n  end of member declaration\n  /usr/include/tesseract/tesscallback.h:296:28: error: expected\n  unqualified-id before \u2018&lt;\u2019 token    typename remove_reference::type\n  p1_;\n                              ^ /usr/include/tesseract/tesscallback.h: In constructor \u2018_ConstTessMemberResultCallback_1_0::_ConstTessMemberResultCallback_1_0(const T*,\n  _ConstTessMemberResultCallback_1_0::MemberSignature, P1)\u2019: /usr/include/tesseract/tesscallback.h:301:29: error: class\n  \u2018_ConstTessMemberResultCallback_1_0\u2019 does not have any\n  field named \u2018p1_\u2019\n         member_(member),      p1_(p1) { }\n                               ^~~ /usr/include/tesseract/tesscallback.h: In member function \u2018virtual R\n  _ConstTessMemberResultCallback_1_0::Run()\u2019: /usr/include/tesseract/tesscallback.h:305:38: error: \u2018p1_\u2019 was not\n  declared in this scope\n         R result = (object_->*member_)(p1_);\n                                        ^~~ /usr/include/tesseract/tesscallback.h:308:38: error: \u2018p1_\u2019 was not\n  declared in this scope\n         R result = (object_-><em>member_)(p1_);\n                                        ^~~ /usr/include/tesseract/tesscallback.h: At global scope:\n  /usr/include/tesseract/tesscallback.h:326:12: error: expected\n  nested-name-specifier before \u2018remove_reference\u2019    typename\n  remove_reference::type p1_;\n              ^~~~~~~~~~~~~~~~ /usr/include/tesseract/tesscallback.h:326:12: error: expected \u2018;\u2019 at\n  end of member declaration\n  /usr/include/tesseract/tesscallback.h:326:28: error: expected\n  unqualified-id before \u2018&lt;\u2019 token    typename remove_reference::type\n  p1_;\n                              ^ /usr/include/tesseract/tesscallback.h: In constructor \u2018_ConstTessMemberResultCallback_1_0::_ConstTessMemberResultCallback_1_0(const T</em>,\n  _ConstTessMemberResultCallback_1_0::MemberSignature, P1)\u2019: /usr/include/tesseract/tesscallback.h:331:29: error: class\n  \u2018_ConstTessMemberResultCallback_1_0\u2019 does not have\n  any field named \u2018p1_\u2019\n         member_(member),      p1_(p1) { }\n                               ^~~ /usr/include/tesseract/tesscallback.h: In member function \u2018virtual\n  void _ConstTessMemberResultCallback_1_0::Run()\u2019:\n  /usr/include/tesseract/tesscallback.h:335:27: error: \u2018p1_\u2019 was not\n  declared in this scope\n         (object_->*member_)(p1_);\n                             ^~~ /usr/include/tesseract/tesscallback.h:337:27: error: \u2018p1_\u2019 was not\n  declared in this scope\n         (object_->*member_)(p1_);</p>\n</blockquote>\n\n<p>When I do not comment it out (i. e., lines still there), I get: </p>\n\n<blockquote>\n  <p>In file included from /usr/include/tesseract/baseapi.h:34:0,\n                   from process_houghlines.h:18,\n                   from process_houghlines.cpp:3: /usr/include/tesseract/tesscallback.h:278:29: error:\n  \u2018remove_reference\u2019 is not a class template  template\n  struct remove_reference { typedef T type; };\n                               ^~~~~~~~~~~~~~~~ /usr/include/tesseract/tesscallback.h:278:29: error: redefinition of\n  \u2018struct remove_reference\u2019\n  /usr/include/tesseract/tesscallback.h:277:29: note: previous\n  definition of \u2018struct remove_reference\u2019  template\n  struct remove_reference { typedef T type; };\n                               ^~~~~~~~~~~~~~~~ /usr/include/tesseract/tesscallback.h:296:12: error: expected\n  nested-name-specifier before \u2018remove_reference\u2019    typename\n  remove_reference::type p1_;\n              ^~~~~~~~~~~~~~~~ /usr/include/tesseract/tesscallback.h:296:12: error: expected \u2018;\u2019 at\n  end of member declaration\n  /usr/include/tesseract/tesscallback.h:296:28: error: expected\n  unqualified-id before \u2018&lt;\u2019 token    typename remove_reference::type\n  p1_;\n                              ^ /usr/include/tesseract/tesscallback.h: In constructor \u2018_ConstTessMemberResultCallback_1_0::_ConstTessMemberResultCallback_1_0(const T*,\n  _ConstTessMemberResultCallback_1_0::MemberSignature, P1)\u2019: /usr/include/tesseract/tesscallback.h:301:29: error: class\n  \u2018_ConstTessMemberResultCallback_1_0\u2019 does not have any\n  field named \u2018p1 \u2019\n         member_(member),      p1_(p1) { }\n                               ^~~ /usr/include/tesseract/tesscallback.h: In member function \u2018virtual R\n  _ConstTessMemberResultCallback_1_0::Run()\u2019: /usr/include/tesseract/tesscallback.h:305:38: error: \u2018p1_\u2019 was not\n  declared in this scope\n         R result = (object_->*member_)(p1_);\n                                        ^~~ /usr/include/tesseract/tesscallback.h:308:38: error: \u2018p1_\u2019 was not\n  declared in this scope\n         R result = (object_-><em>member_)(p1_);\n                                        ^~~ /usr/include/tesseract/tesscallback.h: At global scope:\n  /usr/include/tesseract/tesscallback.h:326:12: error: expected\n  nested-name-specifier before \u2018remove_reference\u2019    typename\n  remove_reference::type p1_;\n              ^~~~~~~~~~~~~~~~ /usr/include/tesseract/tesscallback.h:326:12: error: expected \u2018;\u2019 at\n  end of member declaration\n  /usr/include/tesseract/tesscallback.h:326:28: error: expected\n  unqualified-id before \u2018&lt;\u2019 token    typename remove_reference::type\n  p1_;\n                              ^ /usr/include/tesseract/tesscallback.h: In constructor \u2018_ConstTessMemberResultCallback_1_0::_ConstTessMemberResultCallback_1_0(const T</em>,\n  _ConstTessMemberResultCallback_1_0::MemberSignature, P1)\u2019: /usr/include/tesseract/tesscallback.h:331:29: error: class\n  \u2018_ConstTessMemberResultCallback_1_0\u2019 does not have\n  any field named  ... (reoccurring error)</p>\n</blockquote>\n\n<p>The files <code>file1.h</code> and <code>file1.cpp</code>: </p>\n\n<pre><code>...\n#include &lt;tesseract/baseapi.h&gt;\n#include &lt;leptonica/allheaders.h&gt; \n...\n</code></pre>\n\n<p>and </p>\n\n<pre><code>...\n#include \"file1.h\"\n...\n</code></pre>\n\n<p>The files <code>file2.h</code> and <code>file2.cpp</code>: </p>\n\n<pre><code>...\n#include &lt;tesseract/baseapi.h&gt;\n#include &lt;leptonica/allheaders.h&gt; \n...\n</code></pre>\n\n<p>and </p>\n\n<pre><code>...\n#include \"file2.h\"\n...\n</code></pre>\n\n<p>I dont even understand, why the errors differ, since the headers are to the extend of using Tesseract just equal and one time the error occurs in one, than in the other file. </p>\n\n<p>Thank you so much for any help.</p>\n"}, {"tags": ["c++", "visual-studio-code", "include"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10163345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UJbZj.jpg?s=128&g=1", "display_name": "Abood", "link": "https://stackoverflow.com/users/10163345/abood"}, "edited": false, "score": 0, "creation_date": 1539175778, "post_id": 52740637, "comment_id": 92405915, "body": "I\u2019m working on Visual Studio Code, not visual studio, sorry if that wasn\u2019t clear."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 11, "user_id": 10163345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UJbZj.jpg?s=128&g=1", "display_name": "Abood", "link": "https://stackoverflow.com/users/10163345/abood"}, "edited": false, "score": 0, "creation_date": 1539175946, "post_id": 52740637, "comment_id": 92406038, "body": "@Abood: I realised that when I had written my answer, and then double-checked. VS Code also has Intellisense, for the same purpose. The notion of &quot;cleaning&quot; a build is even broader; it comes from the original UNIX <code>make</code>."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1539175586, "creation_date": 1539175586, "answer_id": 52740637, "question_id": 52740429, "link": "https://stackoverflow.com/questions/52740429/vs-code-include-path/52740637#52740637", "title": "VS code Include path", "body": "<p>Visual Studio has a \"Clean\" option on projects. This is rarely needed, but it throws away intermediate information from previous compilations. If that information is somehow outdated, you can get strange errors. </p>\n\n<p>More specifically, what you're seeing is part of Intellisense. That's the Visual Studio component which live-compiles your code as you type, not to produce an executable but to show expected compilation errors when you do compile it to an executable. It's also the component which handles the \"go to definition\" feature.</p>\n"}], "owner": {"reputation": 11, "user_id": 10163345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UJbZj.jpg?s=128&g=1", "display_name": "Abood", "link": "https://stackoverflow.com/users/10163345/abood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 708, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539175586, "creation_date": 1539174948, "last_edit_date": 1539175463, "question_id": 52740429, "link": "https://stackoverflow.com/questions/52740429/vs-code-include-path", "title": "VS code Include path", "body": "<p>I was working on a small project on VS code, and it was all fine. Then I closed the program and opened it again later, all of the sudden my whole file is flooded with red error line, however, it compiles fine.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RXFmo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RXFmo.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vmgBt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vmgBt.png\" alt=\"enter image description here\"></a></p>\n\n<p>For some reason, if I reversed the order of the include files, the red lines goes away, and it looks okay, but I tried to go to any function declaration or definition (the std functions) eg. <code>std::rand</code>, it says that there is no declaration of definition.</p>\n\n<p>It drives me crazy and I spend the last 3 hours trying to decrypt why in the hell is it doing that, but with no luck.</p>\n"}, {"tags": ["c++", "caffe", "xtensor"], "answers": [{"tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1539192970, "creation_date": 1539192970, "answer_id": 52745886, "question_id": 52740327, "link": "https://stackoverflow.com/questions/52740327/how-to-fill-xtensor-array-with-data-using-a-pointer/52745886#52745886", "title": "how to fill xtensor array with data using a pointer", "body": "<p>You can do that, but you need the size of your data....</p>\n\n<p>Try as said below.</p>\n\n<pre><code>float* data = output-&gt;mutable_cpu_data();\n\n//CONVERT YOUR DATA TO FLOAT VECTOR\n//I assume the size of your array could be 4.\n//Replace 4 with intended size of array.\nstd::vector&lt;float&gt; fData(data, data+4); \n\n//INITIALIZE XARRAY\nxt::xarray&lt;float&gt; a(fData);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384, "user_id": 7241714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc487b1610c84cc8a383e9faa99ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "johan mabille", "link": "https://stackoverflow.com/users/7241714/johan-mabille"}, "is_accepted": false, "score": 2, "last_activity_date": 1539763042, "creation_date": 1539763042, "answer_id": 52849926, "question_id": 52740327, "link": "https://stackoverflow.com/questions/52740327/how-to-fill-xtensor-array-with-data-using-a-pointer/52849926#52849926", "title": "how to fill xtensor array with data using a pointer", "body": "<p>You can use the xt::adapt function from xadapt.hpp, but you need to provide a shape:</p>\n\n<pre><code>float* data = output-&gt;mutable_cpu_data();\nsize_t size = size_of_data;\n// For a 1D tensor for instance\nxt::static_shape&lt;std::size_t, 1&gt; sh = { size_of_data};\n// Parameters of adapt are:\n// - the 1D buffer to adapt\n// - the size of the buffer\n// - the ownership flag (should the adaptor destroy your buffer upon deletion, here\n//   probably not)\n// - the shape\nauto a = xt::adapt(data, size_of_data, false sh);\n</code></pre>\n\n<p>The advantage compared to the solution provided by Naidu is that you don't copy the data buffer, it is adapted \"in place\".</p>\n"}], "owner": {"reputation": 2259, "user_id": 1446689, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WZmEf.jpg?s=128&g=1", "display_name": "moki", "link": "https://stackoverflow.com/users/1446689/moki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1539763042, "creation_date": 1539174591, "question_id": 52740327, "link": "https://stackoverflow.com/questions/52740327/how-to-fill-xtensor-array-with-data-using-a-pointer", "title": "how to fill xtensor array with data using a pointer", "body": "<p>I am trying to create a <code>xtensor</code> array from a blob data in <code>caffe</code> library. A pointer to data is returned using the function <code>mutable_cpu_data()</code> in <code>caffe</code> for example by <code>float* data = output-&gt;mutable_cpu_data();</code>. Is this possible with <code>xtensor</code>? If yes, could you please provide an example. I've found examples which use OpenCV <code>Mat</code> but <code>xtensor</code> is a lot like <code>numpy</code> which makes the operating on the matrix like data much easier.</p>\n"}, {"tags": ["c++", "protobuf-c"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "edited": false, "score": 0, "creation_date": 1539175038, "post_id": 52740415, "comment_id": 92405439, "body": "If i do this I get the following error: error: no match for &#39;operator=&#39; (operand types are &#39;gen_ProposedSegment&#39; and &#39;gen_ProposedSegment*&#39;)"}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1539175244, "post_id": 52740415, "comment_id": 92405558, "body": "So, you&#39;d also need to type the input vector as <code>std::vector&lt;gen_ProposedSegment&gt;</code> (if possible) or iterate manually."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "edited": false, "score": 0, "creation_date": 1539175380, "post_id": 52740415, "comment_id": 92405633, "body": "When I iterate should I use mutable_proposedsegments(int index)?"}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "reply_to_user": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "edited": false, "score": 0, "creation_date": 1539175810, "post_id": 52740415, "comment_id": 92405945, "body": "For iterative version I think you&#39;d need to use <code>add_proposedsegments()</code>. I&#39;m not sure if <code>mutable_proposedsegments(int index)</code> would actually add the item if the index is &gt;= actual size."}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "edited": false, "score": 0, "creation_date": 1539176390, "post_id": 52740415, "comment_id": 92406357, "body": "thanks you so much axalis! U were really helpful. Thank you so much"}, {"owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "edited": false, "score": 0, "creation_date": 1539176438, "post_id": 52740415, "comment_id": 92406385, "body": "sheesh both are correct answers. you and florian, confused now"}, {"owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "edited": false, "score": 0, "creation_date": 1539176820, "post_id": 52740415, "comment_id": 92406642, "body": "What is confusing to you? If you change the type of the vector to <code>std::vector&lt;gen_ProposedSegment&gt;</code>, then you copy objects lot more. But that doesn&#39;t make the code wrong or bad. It might be ok in your environment. Even though I think less copies are better and you should stick with a vector containing pointers ;-)."}], "tags": [], "owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "is_accepted": false, "score": 3, "last_activity_date": 1539175504, "last_edit_date": 1539175504, "creation_date": 1539174918, "answer_id": 52740415, "question_id": 52740297, "link": "https://stackoverflow.com/questions/52740297/how-to-add-vector-to-repeated-field-protobuf-c/52740415#52740415", "title": "How to add vector to repeated field protobuf c++", "body": "<p>The <code>mutable_proposedsegments()</code> method returns a pointer, so you might be missing <code>*</code> at the beginning - try with:</p>\n\n<pre><code>Journey::Journey(std::vector&lt;gen_ProposedSegment *&gt; proposedSegment) {\n    *this-&gt;mutable_proposedsegments() = {proposedSegment.begin(), proposedSegment.end()};\n}\n</code></pre>\n\n<p>In addition, for this to work you'd need to have the input typed as <code>std::vector&lt;gen_ProposedSegment&gt;</code> instead (and better use a const ref), i.e.:</p>\n\n<pre><code>Journey::Journey(const std::vector&lt;gen_ProposedSegment&gt;&amp; proposedSegment) {\n    *this-&gt;mutable_proposedsegments() = {proposedSegment.begin(), proposedSegment.end()};\n}\n</code></pre>\n\n<p>Alternatively, you'd need to insert the items in a for loop (see <code>std::for_each</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "is_accepted": true, "score": 1, "last_activity_date": 1539175921, "creation_date": 1539175921, "answer_id": 52740735, "question_id": 52740297, "link": "https://stackoverflow.com/questions/52740297/how-to-add-vector-to-repeated-field-protobuf-c/52740735#52740735", "title": "How to add vector to repeated field protobuf c++", "body": "<p>You have to iterate of the given vector and add the objects to your protobuf message manually. You can not use a memcpy operation for that.</p>\n\n<p>Following code is written out of my mind without testing ... but should point you in the correct direction. btw: I assume <code>Journey</code> inherits from <code>gen_Journey</code> in this case. Otherwise you have to adjust the \"this->\" statement accordingly.</p>\n\n<pre><code>Journey::Journey(const std::vector&lt;gen_ProposedSegment *&gt; &amp;proposedSegment) {\n    auto copy = [&amp;](const gen_ProposedSegment *) {\n        auto temp_seg = this-&gt;add_proposedsegments();\n        temp_seg-&gt;CopyFrom(*gen_ProposedSegment);\n    };\n    std::for_each(proposedSegment.cbegin(), proposedSegment.cend(), copy);\n}\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 10219752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c0ca2b3af780817516d42a4da7f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "gringo", "link": "https://stackoverflow.com/users/10219752/gringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7576, "favorite_count": 0, "accepted_answer_id": 52740735, "answer_count": 2, "score": 2, "last_activity_date": 1539175921, "creation_date": 1539174490, "question_id": 52740297, "link": "https://stackoverflow.com/questions/52740297/how-to-add-vector-to-repeated-field-protobuf-c", "title": "How to add vector to repeated field protobuf c++", "body": "<p>I have the following protobuf message :</p>\n\n<pre><code>message gen_Journey {\n  repeated gen_ProposedSegment proposedSegments = 1;\n}\n</code></pre>\n\n<p>the generated cpp is the following</p>\n\n<pre><code>// repeated .gen_ProposedSegment proposedSegments = 1;\nint gen_Journey::proposedsegments_size() const {\n  return proposedsegments_.size();\n}\nvoid gen_Journey::clear_proposedsegments() {\n  proposedsegments_.Clear();\n}\nconst ::gen_ProposedSegment&amp; gen_Journey::proposedsegments(int index) const {\n  // @@protoc_insertion_point(field_get:gen_Journey.proposedSegments)\n  return proposedsegments_.Get(index);\n}\n::gen_ProposedSegment* gen_Journey::mutable_proposedsegments(int index) {\n  // @@protoc_insertion_point(field_mutable:gen_Journey.proposedSegments)\n  return proposedsegments_.Mutable(index);\n}\n::gen_ProposedSegment* gen_Journey::add_proposedsegments() {\n  // @@protoc_insertion_point(field_add:gen_Journey.proposedSegments)\n  return proposedsegments_.Add();\n}\n::google::protobuf::RepeatedPtrField&lt; ::gen_ProposedSegment &gt;*\ngen_Journey::mutable_proposedsegments() {\n  // @@protoc_insertion_point(field_mutable_list:gen_Journey.proposedSegments)\n  return &amp;proposedsegments_;\n}\nconst ::google::protobuf::RepeatedPtrField&lt; ::gen_ProposedSegment &gt;&amp;\ngen_Journey::proposedsegments() const {\n  // @@protoc_insertion_point(field_list:gen_Journey.proposedSegments)\n  return proposedsegments_;\n}\n</code></pre>\n\n<hr>\n\n<p>I created the following vector : </p>\n\n<pre><code>std::vector&lt;gen_ProposedSegment *&gt; proposedSegment\n</code></pre>\n\n<hr>\n\n<p>based on <a href=\"https://stackoverflow.com/questions/15499641/copy-a-stdvector-to-a-repeated-field-from-protobuf-with-memcpy\">Copy a std::vector to a repeated field from protobuf with memcpy</a>  I did the following :</p>\n\n<pre><code>Journey::Journey(std::vector&lt;gen_ProposedSegment *&gt; proposedSegment) {\n    this-&gt;mutable_proposedsegments() = {proposedSegment.begin(), proposedSegment.end()};\n}\n</code></pre>\n\n<p>the problem is that i am getting the following error:</p>\n\n<pre><code>/home/compilation/UnixPackagesFareShopping/src/DOM/src/journey.cpp:10:35: error: lvalue required as left operand of assignment\n</code></pre>\n\n<hr>\n\n<p>What am I doing wrong? </p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1539173829, "post_id": 52740023, "comment_id": 92404649, "body": "Can you spot the difference between <code>sumit()</code> and <code>cout &lt;&lt; sumit()</code>?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1539173834, "post_id": 52740023, "comment_id": 92404656, "body": "Why would you expect something to appear on screen if you don&#39;t use <code>std::cout</code> at all in <code>sumit</code>? It&#39;s like writing <code>1+1;</code> on a separate line and expecting <code>2</code> to appear on screen. It&#39;s not how C++ works."}], "answers": [{"tags": [], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "is_accepted": true, "score": 3, "last_activity_date": 1539174366, "last_edit_date": 1539174366, "creation_date": 1539173904, "answer_id": 52740101, "question_id": 52740023, "link": "https://stackoverflow.com/questions/52740023/null-output-in-using-class-methods/52740101#52740101", "title": "Null output in using class methods", "body": "<p>Of course you get no output , because this method isn't trying to print anything . It simply returns a number.</p>\n\n<p>Either do this in main :</p>\n\n<pre><code>cout &lt;&lt; o1.sumit() &lt;&lt; endl;\ncout &lt;&lt; o2.sumit() &lt;&lt; endl;\n</code></pre>\n\n<p>Which will directly print the value returned from this method.</p>\n\n<p>Or add the same logic of <code>displayIt</code> to <code>sumit</code> .</p>\n\n<p><strong>BTW</strong> - This question is irrelevant to C++ Template . The same behaviour would have happened in a regular class .</p>\n"}], "owner": {"reputation": 75, "user_id": 9784019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymQ7j.jpg?s=128&g=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/9784019/jawad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52740101, "answer_count": 1, "score": 2, "last_activity_date": 1539367684, "creation_date": 1539173677, "last_edit_date": 1539367684, "question_id": 52740023, "link": "https://stackoverflow.com/questions/52740023/null-output-in-using-class-methods", "title": "Null output in using class methods", "body": "<p>In following code I get no output from directly calling sumit() function, but when I call it through the other function displayIt() (which calls sumit() ), it displays the output. How can I fix it? And please also explain what is happening?</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;string&gt;\nusing namespace std;\n\n\ntemplate &lt;typename C&gt;\n\nclass ABC\n{\n\nprivate:\n  C num1, num2;\n\npublic:\n  ABC(C a, C b)\n  {\n      num1 = a;\n      num2 = b;\n  }\n\nvoid displayIt()\n  {\n      cout &lt;&lt; \"A+B:\" &lt;&lt; sumit() &lt;&lt; endl;\n  }\n\nC sumit() { return num1 + num2; }\n\n};\n\nint main()\n{\nABC&lt;int&gt; o1(2, 3);\nABC&lt;string&gt; o2(\"ABC\", \"XYZ\");\n\n//It doesn't display aything...\ncout &lt;&lt; \"Call-1: \" &lt;&lt; endl;\no1.sumit();\no2.sumit();\n\n//It displays the output...\ncout &lt;&lt; \"Call-2: \" &lt;&lt; endl;\no1.displayIt();\no2.displayIt();\n\nsystem(\"pause\");\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "g++", "nios"], "comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1539174057, "post_id": 52739978, "comment_id": 92404821, "body": "How was your GCC built? Please add the output of <code>gcc -v</code> to your question."}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1539178480, "post_id": 52739978, "comment_id": 92407689, "body": "You need niosii-gcc cross-compiler (included in Nios II EDS or self-built)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10473446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c19ebecfeac78ddcb95dc8ef02f027?s=128&d=identicon&r=PG&f=1", "display_name": "Struan Murray", "link": "https://stackoverflow.com/users/10473446/struan-murray"}, "edited": false, "score": 0, "creation_date": 1539192309, "post_id": 52744368, "comment_id": 92416082, "body": "Thanks for that, the aim is to use it as a cross-compiler so I&#39;ll work my way through the relevant documentation."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": true, "score": 0, "last_activity_date": 1539187159, "creation_date": 1539187159, "answer_id": 52744368, "question_id": 52739978, "link": "https://stackoverflow.com/questions/52739978/gcc-g-compilation-into-nios-2-assembly/52744368#52744368", "title": "Gcc/G++ compilation into NIOS 2 Assembly", "body": "<p>Your compiler only includes support for the x86 targets (x86-64, i386 and its variantsm and the x32 x86-64 subset).  The <code>multilib</code> and <code>multiarch</code> bits refer to something else, not multiple targets.</p>\n\n<p>I don't think there are pre-built cross-compilers targeting NIOS or NIOS 2 as part of Ubuntu (not even universe), so you probably have to build a cross-toolchain yourself, starting with a cross-binutils.</p>\n"}], "owner": {"reputation": 23, "user_id": 10473446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c19ebecfeac78ddcb95dc8ef02f027?s=128&d=identicon&r=PG&f=1", "display_name": "Struan Murray", "link": "https://stackoverflow.com/users/10473446/struan-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 52744368, "answer_count": 1, "score": 2, "last_activity_date": 1539187159, "creation_date": 1539173498, "last_edit_date": 1539176365, "question_id": 52739978, "link": "https://stackoverflow.com/questions/52739978/gcc-g-compilation-into-nios-2-assembly", "title": "Gcc/G++ compilation into NIOS 2 Assembly", "body": "<p>I am trying to have gcc/g++ convert C or C++ code into assembly using the -S and -march commands but I am unable to find an exact answer as to whether it supports NIOS 2. --target shows a list of architectures but no obvious NIOS 2. THe GNU compiler website DOES contain a list of NIOS 2 commands. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Nios-II-Options.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Nios-II-Options.html</a>\nDoes anyone know the -march architecture required for the compiler or whether support was dropped in a previous version? Currently using gcc 7.3</p>\n\n<p>-v Dump 13:58</p>\n\n<pre><code>Using built-in specs.\nCOLLECT_GCC=gcc\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 7.3.0-27ubuntu1~18.04' --with-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 7.3.0 (Ubuntu 7.3.0-27ubuntu1~18.04) \nCOLLECT_GCC_OPTIONS='-o' 'test' '-S' '-O3' '-march=nios2' '-v'\n /usr/lib/gcc/x86_64-linux-gnu/7/cc1plus -quiet -v -imultiarch x86_64-linux-gnu -D_GNU_SOURCE loop.cpp -quiet -dumpbase loop.cpp -march=nios2 -auxbase-strip test -O3 -version -o test -fstack-protector-strong -Wformat -Wformat-security\nGNU C++14 (Ubuntu 7.3.0-27ubuntu1~18.04) version 7.3.0 (x86_64-linux-gnu)\n    compiled by GNU C version 7.3.0, GMP version 6.1.2, MPFR version 4.0.1, MPC version 1.1.0, isl version isl-0.19-GMP\n\nGGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072\nignoring duplicate directory \"/usr/include/x86_64-linux-gnu/c++/7\"\nignoring nonexistent directory \"/usr/local/include/x86_64-linux-gnu\"\nignoring nonexistent directory \"/usr/lib/gcc/x86_64-linux-gnu/7/../../../../x86_64-linux-gnu/include\"\n#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n /usr/include/c++/7\n /usr/include/x86_64-linux-gnu/c++/7\n /usr/include/c++/7/backward\n /usr/lib/gcc/x86_64-linux-gnu/7/include\n /usr/local/include\n /usr/lib/gcc/x86_64-linux-gnu/7/include-fixed\n /usr/include/x86_64-linux-gnu\n /usr/include\nEnd of search list.\ncc1plus: error: bad value (\u2018nios2\u2019) for \u2018-march=\u2019 switch\ncc1plus: note: valid arguments to \u2018-march=\u2019 switch are: nocona core2 nehalem corei7 westmere sandybridge corei7-avx ivybridge core-avx-i haswell core-avx2 broadwell skylake skylake-avx512 bonnell atom silvermont slm knl x86-64 eden-x2 nano nano-1000 nano-2000 nano-3000 nano-x2 eden-x4 nano-x4 k8 k8-sse3 opteron opteron-sse3 athlon64 athlon64-sse3 athlon-fx amdfam10 barcelona bdver1 bdver2 bdver3 bdver4 znver1 btver1 btver2\nGNU C++14 (Ubuntu 7.3.0-27ubuntu1~18.04) version 7.3.0 (x86_64-linux-gnu)\n    compiled by GNU C version 7.3.0, GMP version 6.1.2, MPFR version 4.0.1, MPC version 1.1.0, isl version isl-0.19-GMP\n\nGGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1539173178, "post_id": 52739850, "comment_id": 92404211, "body": "Short answer: use <code>new</code> rather than <code>malloc</code>. (<code>memcpy</code> may not work - study <i>trivial copyability</i>.)"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1539173181, "post_id": 52739850, "comment_id": 92404216, "body": "What is <code>Item</code>? Does it need to be constructed? The <code>malloc</code> function only allocates memory, but it does not call constructors!"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1539173184, "post_id": 52739850, "comment_id": 92404217, "body": "if <code>Item</code> is not POD type, you cannot use <code>memcpy</code> with it. And don&#39;t use <code>malloc</code> in C++ unless absolutely necessary. Use <code>new</code> or even better smart pointers."}, {"owner": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 3, "creation_date": 1539173193, "post_id": 52739850, "comment_id": 92404223, "body": "Why are you passing the <i>address</i> of each pointer to memcpy? Do you not want the pointers themselves?"}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 2, "creation_date": 1539173227, "post_id": 52739850, "comment_id": 92404248, "body": "Would it be possible for you to use <code>std::vector&lt;Item&gt;</code>?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539173244, "post_id": 52739850, "comment_id": 92404262, "body": "That <code>memcpy</code> call also looks suspect, perhaps you should just use assignment <code>=</code> (and possibly overload the copy-assignment operator <code>operator=</code>)?"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 3, "creation_date": 1539173262, "post_id": 52739850, "comment_id": 92404280, "body": "Your <code>memcpy</code> shouldn&#39;t be taking the address of those pointers. It should just pass the pointers in themselves. i.e <code>memcpy(newItem, item, sizeof(Item))</code>. Though memcpy isn&#39;t a very C++ thing to use."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1539173271, "post_id": 52739850, "comment_id": 92404288, "body": "Probably thrashing memory somewhere as well..."}, {"owner": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "reply_to_user": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 0, "creation_date": 1539173417, "post_id": 52739850, "comment_id": 92404386, "body": "@mathematician1975 I had it without before but my IDE told me to add that."}, {"owner": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539173456, "post_id": 52739850, "comment_id": 92404407, "body": "@Someprogrammerdude Nothing actually happens in the constructor, but I&#39;ll do that."}, {"owner": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1539173619, "post_id": 52739850, "comment_id": 92404519, "body": "I did what @Bathsheba said, and replaced the malloc with a <code>new</code> statement instead.  @Someprogrammerdude @Yksisarvinen And I don&#39;t understand, <code>memcpy</code> works fine with it, why can&#39;t I use it?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1539174927, "post_id": 52739850, "comment_id": 92405370, "body": "@stepper no, a very important thing happens in the constructor: the <code>Item</code> starts existing. The <i>implementation</i> of that can be zero, or thousands, of machine instructions."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1539174938, "post_id": 52739850, "comment_id": 92405376, "body": "If <code>Item</code> is not a standard-layout type, using <code>memcpy()</code> to copy one gives undefined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "edited": false, "score": 1, "creation_date": 1539173984, "post_id": 52740062, "comment_id": 92404768, "body": "Is there a reason why I shouldn&#39;t be using <code>memcpy</code>? Without using malloc, it works as expected. Is it because memcpy is a C feature?"}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "reply_to_user": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "edited": false, "score": 2, "creation_date": 1539174242, "post_id": 52740062, "comment_id": 92404934, "body": "<code>memcpy</code> only copies raw bytes from one place to another and has no knowledge of the underlying type of the data. For one, this means that errors like the one that you&#39;re experiencing don&#39;t get caught. It also doesn&#39;t follow the  c++ rules regarding calling of constructors and destructors. So for example if <code>Item</code> had a <code>unique_ptr</code> inside it, then the destructor for that area of memory could be deleted twice, which, best case, will make your program crash immediately."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "edited": false, "score": 2, "creation_date": 1539174343, "post_id": 52740062, "comment_id": 92404988, "body": "@stepper For example, if your item has a <code>std::string</code> field, there will be a problem: <code>std::string</code> manages some memory and will delete that memory eventually. If you <code>memcpy</code> a <code>std::string</code>, you now have two strings managing <i>the same</i> memory, and one will probably delete it while the other still needs it. What you want is a <i>copy</i>, and <code>std::string</code> knows how to make a copy of itself. But it involves more work than a single <code>memcpy</code>."}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "edited": false, "score": 0, "creation_date": 1539174400, "post_id": 52740062, "comment_id": 92405027, "body": "<code>malloc</code> should also not be used in C++ code since it isn&#39;t type safe and doesn&#39;t call any constructors for your types. All it does is give you a pile of uninitialized memory. Any C++ code should use new/delete instead."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1539174740, "post_id": 52740062, "comment_id": 92405233, "body": "@PaulBelanger Most C++ code shouldn&#39;t be calling <code>new</code> either."}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "edited": false, "score": 0, "creation_date": 1539174962, "post_id": 52740062, "comment_id": 92405391, "body": "True, but it&#39;s still infinitely better than using malloc."}], "tags": [], "owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "is_accepted": true, "score": 3, "last_activity_date": 1539173779, "creation_date": 1539173779, "answer_id": 52740062, "question_id": 52739850, "link": "https://stackoverflow.com/questions/52739850/why-is-my-value-incorrect-unless-i-use-cout/52740062#52740062", "title": "Why is my value incorrect unless I use cout?", "body": "<pre><code>memcpy(&amp;newItem, &amp;item, sizeof(Item));\n</code></pre>\n\n<p>What you're saying here is to copy from the address of <code>item</code>, aka a pointer to a pointer to an <code>Item</code>, to the address of <code>newItem</code>, aka another pointer to a pointer to an <code>Item</code>. </p>\n\n<p>Since both of these are stack variables, and I'm guessing that <code>sizeof(Item) != sizeof(Item**)</code>, you're invoking undefined behaviour here. </p>\n\n<p>The reason the StackSize variable is only working when printing it is pure luck on your part; the compiler is most likeley just moving some variables around on the stack to try to optimize stack/register use, and moving the variable out of the area to be overwritten in the process. </p>\n\n<p>Since you're using C++, you shouldn't be using <code>memcpy</code> in the first place. Write a copy constructor and an <code>operator=</code> instead to copy <code>Item</code> values. </p>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 1958687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad7a42a759d5d58b0ac3ab1844fe846?s=128&d=identicon&r=PG", "display_name": "bartekordek", "link": "https://stackoverflow.com/users/1958687/bartekordek"}, "is_accepted": false, "score": 0, "last_activity_date": 1539176715, "last_edit_date": 1539176715, "creation_date": 1539174904, "answer_id": 52740409, "question_id": 52739850, "link": "https://stackoverflow.com/questions/52739850/why-is-my-value-incorrect-unless-i-use-cout/52740409#52740409", "title": "Why is my value incorrect unless I use cout?", "body": "<p>Memcpy should get an address of destination and source.\nYou are passing \"address to address\".\nChange:</p>\n\n<p><code>memcpy(&amp;newItem, &amp;item, sizeof(Item));</code></p>\n\n<p>to</p>\n\n<p><code>memcpy(newItem, item, sizeof(Item));</code></p>\n\n<p>Also, as stated by @Bathsheba and @Some-programmer-dude and @yksisarvinen, you shouldn't use malloc. Consider creating a copy constructor and/or assignment operator.</p>\n"}], "owner": {"reputation": 1107, "user_id": 2291141, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f879fd0a9226ac17c17b07c2d427eb8b?s=128&d=identicon&r=PG&f=1", "display_name": "stepper", "link": "https://stackoverflow.com/users/2291141/stepper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52740062, "answer_count": 2, "score": 0, "last_activity_date": 1539176715, "creation_date": 1539173037, "question_id": 52739850, "link": "https://stackoverflow.com/questions/52739850/why-is-my-value-incorrect-unless-i-use-cout", "title": "Why is my value incorrect unless I use cout?", "body": "<p>I'm making a C++ assignment for school and I've run into a peculiar problem. It's most likely memory corruption or whatever but as I am really mediocre at C++ I don't know how to solve it.</p>\n\n<pre><code>void Inventory::addItem(Item *item, const int stackCount) {\n    //find the item\n    Item *fi = findItem(item-&gt;id);\n\n    if(fi == nullptr)\n    {\n        Item *newItem = (Item *)malloc(sizeof(Item));\n        //std::cout &lt;&lt; stackCount &lt;&lt; std::endl;\n        memcpy(&amp;newItem, &amp;item, sizeof(Item));\n        newItem-&gt;stack = stackCount;\n        current.push_back(newItem);\n    }\n}\n</code></pre>\n\n<p>I've got this piece of code, where it copies the Item's properties to another item. This works fine, and it carries everything over. Except something weird goes on with the <code>stackCount</code> variable. </p>\n\n<p>There's a commented <code>cout</code>, and with it commented out the stackCount value is wrong. It will be at around 32k or so.</p>\n\n<p>If it's not commented out, the value will be correct! Which is 1! (I am testing this in another function)</p>\n\n<p>When placed behind the <code>memcpy</code> statement, the value is always wrong. Which of course leads me to believe that it's indeed memory corruption.</p>\n\n<p>So I'm really quite confused. What exactly is c++ doing here?</p>\n"}, {"tags": ["c++", "qt", "3d", "qt3d"], "owner": {"reputation": 62, "user_id": 5417288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HkfRS.png?s=128&g=1", "display_name": "Saif_Qaher94", "link": "https://stackoverflow.com/users/5417288/saif-qaher94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554604905, "creation_date": 1539172576, "last_edit_date": 1554604905, "question_id": 52739700, "link": "https://stackoverflow.com/questions/52739700/why-does-qsceneloader-freeze-the-scene-and-how-i-can-run-it-on-a-thread", "title": "Why does QSceneLoader freeze the scene, and how I can run it on a thread?", "body": "<p>Currently I am trying to import a scene in my Qt3D application.\nThe problem is, when creating an instance from QSceneLoader and setting the source's QUrl then adding it to an Entity, it freezes the application until it finishes the importing.</p>\n\n<p>I tried to put it in thread like:</p>\n\n<pre><code>void start()\n{\n    qDebug() &lt;&lt; \"Thread\";\n\n    QAspectEngine* pAs = new QAspectEngine();\n    pAs-&gt;registerAspect(new QRenderAspect());\n\n    QRenderSettings *renderSettings = new QRenderSettings();\n    renderSettings-&gt;setActiveFrameGraph(new Qt3DExtras::QForwardRenderer());\n\n   // Root entity\n   Qt3DCore::QEntity *sceneRoot2 = new Qt3DCore::QEntity();\n   sceneRoot2-&gt;addComponent(renderSettings);\n\n   pAs-&gt;setRootEntity(QSharedPointer&lt;QEntity&gt;(sceneRoot2));\n\n   Qt3DRender::QSceneLoader *sceneLoader = new Qt3DRender::QSceneLoader();\n   SceneWalker sceneWalker(sceneLoader);\n   QObject::connect(sceneLoader, &amp;Qt3DRender::QSceneLoader::statusChanged, &amp;sceneWalker, &amp;SceneWalker::onStatusChanged);\n\n   sceneLoader-&gt;setSource(QUrl::fromLocalFile(\"C:/Users/USER/Downloads/TreeTest.obj\"));\n   sceneRoot2-&gt;addComponent(sceneLoader);\n}\n</code></pre>\n\n<p>This function will run when the QThread emits the started signal, but then I got this: <code>QObject::setParent: Cannot set parent, new parent is in a different thread.</code></p>\n\n<p>So I do not know how to import a scene in Qt3D without freezing the app, can any one help?</p>\n"}, {"tags": ["c++", "unique-ptr"], "comments": [{"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 1, "creation_date": 1539172057, "post_id": 52739477, "comment_id": 92403541, "body": "You can&#39;t return <code>std::unique_ptr</code> by value, because it is unique and your <code>getBuffValue</code> returns its copy. Return either a reference to it, or a reference to the managed object, <code>*_buff</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1539172132, "post_id": 52739477, "comment_id": 92403591, "body": "&quot; // How to implement it&quot; this isnt your first question on how to &quot;convert&quot; a float to a char array and you are quite persistent in assuming that there is some obvious unique way to do that. There is not, you need to say what that conversion should be"}, {"owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1539172351, "post_id": 52739477, "comment_id": 92403719, "body": "@Evg - no. This also does not compile"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1539172422, "post_id": 52739477, "comment_id": 92403768, "body": "<code>std::unique_ptr</code>, as the name suggest, can have only one owner at any given time. If you want to pass the ownership to someone else, you need to give up your ownership (you cannot keep that pointer in <code>SkinnyBuffer</code> then)."}, {"owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "edited": false, "score": 0, "creation_date": 1539174848, "post_id": 52739477, "comment_id": 92405306, "body": "I have an implementation which uses <code>std::vector&lt;unsigned char&gt; </code> and other which uses <code>unsigned char*</code>. THe vector impl is 10 times slower than the plain char array. So I was going with the plain char array. However, when I use a methods to return the char array <code>unsigned char * readRequest()</code> in a child class I get UB (only the method that converts float to char array). so one advised me to use unique_ptr <a href=\"https://stackoverflow.com/questions/52723208/how-to-return-the-real-value-unsigned-char-array-in-my-case-and-not-a-pointer\" title=\"how to return the real value unsigned char array in my case and not a pointer\">stackoverflow.com/questions/52723208/&hellip;</a>"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1539175829, "post_id": 52739477, "comment_id": 92405956, "body": "What did you do to make a vector so much slower than a C array? You can instantiate a vector, with it&#39;s proper contents, in one go."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1539177307, "post_id": 52739477, "comment_id": 92406951, "body": "Probably, you make a lot of unnecessary copies of it. It can&#39;t be that slow."}], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 0, "last_activity_date": 1539172825, "creation_date": 1539172825, "answer_id": 52739781, "question_id": 52739477, "link": "https://stackoverflow.com/questions/52739477/how-to-return-copy-values-of-an-unique-ptrunsigned-char/52739781#52739781", "title": "How to return/copy values of an unique_ptr&lt;unsigned char[]&gt;?", "body": "<p>You cannot do it this way. You have to copy the content of the string in a new array that is pointed by the unique pointer and then return the unique pointer.</p>\n\n<p>The other option is to return a string in your two inherited classes. </p>\n"}, {"comments": [{"owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "edited": false, "score": 0, "creation_date": 1539175471, "post_id": 52740484, "comment_id": 92405688, "body": "I am trying to use vector and see if I get any UB on the child classes or when I read the value in other classes."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "edited": false, "score": 1, "creation_date": 1539175605, "post_id": 52740484, "comment_id": 92405789, "body": "@FelipeOliveiraGutierrez, if you get any UB and seg. fault, it is not because of <code>std::vector</code> itself. Make sure you don&#39;t access memory that has been freed."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": true, "score": 3, "last_activity_date": 1539175425, "last_edit_date": 1539175425, "creation_date": 1539175117, "answer_id": 52740484, "question_id": 52739477, "link": "https://stackoverflow.com/questions/52739477/how-to-return-copy-values-of-an-unique-ptrunsigned-char/52740484#52740484", "title": "How to return/copy values of an unique_ptr&lt;unsigned char[]&gt;?", "body": "<p><code>std::unique_ptr</code> is a non-copyable object. If you need a read-only access to it, you have two (main) options:</p>\n\n<ol>\n<li><p>Return a reference to <code>unique_ptr</code> itself:</p>\n\n<pre><code>const std::unique_ptr&lt;unsigned char[]&gt;&amp; getBuffValue() const\n{\n    return _buff;\n}\n</code></pre></li>\n<li><p>Return a const pointer to the managed array:</p>\n\n<pre><code>const unsigned char* getBuffValue() const\n{\n    return _buff.get();\n}\n</code></pre></li>\n</ol>\n\n<p>To assign a string to the buffer, you can do:</p>\n\n<pre><code>void setBuffValue(const std::string&amp; str)\n{\n    _buff = std::make_unique&lt;unsigned char []&gt;(str.length() + 1);\n    std::copy_n(str.c_str(), str.length() + 1, _buff.get());\n}\n</code></pre>\n\n<p>Note that you have to copy the terminating null character to your buffer. Otherwise it will be almost useless for the outside world because its length will not be known to the user.</p>\n\n<p>But do you really need <code>std::unique_ptr&lt;unsigned char[]&gt;</code>? <code>std::vector</code> seems to be more appropriate here.</p>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1539175682, "creation_date": 1539175682, "answer_id": 52740666, "question_id": 52739477, "link": "https://stackoverflow.com/questions/52739477/how-to-return-copy-values-of-an-unique-ptrunsigned-char/52740666#52740666", "title": "How to return/copy values of an unique_ptr&lt;unsigned char[]&gt;?", "body": "<p>Return a <em>view</em> of the data in <code>buff_</code>, don't try to copy it.</p>\n\n<pre><code>const unsigned char * SkinnyBuffer::getBuffValue() const {\n    return _buff.get();\n}\n</code></pre>\n\n<p>You can use that value until the <code>SkinnyBuffer</code> is destroyed or modified.</p>\n"}], "owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 0, "accepted_answer_id": 52740484, "answer_count": 3, "score": 0, "last_activity_date": 1539175682, "creation_date": 1539171778, "last_edit_date": 1539172969, "question_id": 52739477, "link": "https://stackoverflow.com/questions/52739477/how-to-return-copy-values-of-an-unique-ptrunsigned-char", "title": "How to return/copy values of an unique_ptr&lt;unsigned char[]&gt;?", "body": "<p>I have a simple class with one attribute <code>std::unique_ptr&lt;unsigned char[]&gt;</code> in C++. I want to have a function that converts string to <code>std::unique_ptr&lt;unsigned char[]&gt;</code>, other to convert float to <code>std::unique_ptr&lt;unsigned char[]&gt;</code>, and a third to return the attribute <code>std::unique_ptr&lt;unsigned char[]&gt;</code>. My header is compiling but the source CPP is not. Even the return attribute is not compiling.</p>\n\n<pre><code>#include &lt;memory&gt;\nclass SkinnyBuffer {\nprivate:\n    std::unique_ptr&lt;unsigned char[]&gt; _buff;\npublic:\n    ~SkinnyBuffer();\n    SkinnyBuffer();\n    void setBuffValue(float f);\n    void setBuffValue(std::string str);\n    std::unique_ptr&lt;unsigned char[]&gt;* getBuffValue();\n};\n\n#include \"utils/SkinnyBuffer.h\"\nSkinnyBuffer::~SkinnyBuffer() { }\nSkinnyBuffer::SkinnyBuffer() { }\nvoid SkinnyBuffer::setBuffValue(float f) {\n    // How to implement it\n    _buff = f;\n}\nvoid SkinnyBuffer::setBuffValue(std::string str) {\n    _buff = std::unique_ptr&lt;unsigned char[]&gt;(str.data(), str.data() + str.length());\n}\nstd::unique_ptr&lt;unsigned char[]&gt;* SkinnyBuffer::getBuffValue() {\n    return &amp;_buff;\n}\n</code></pre>\n"}, {"tags": ["c++", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1539171242, "post_id": 52739242, "comment_id": 92403062, "body": "&quot;Where should I free this without getting memory leaks and have the right output?&quot; Dont. use <code>std::string</code>."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1539171261, "post_id": 52739242, "comment_id": 92403067, "body": "There are so many things wrong with your code. Why don&#39;t you use <code>std::string</code>?"}, {"owner": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "edited": false, "score": 0, "creation_date": 1539171408, "post_id": 52739242, "comment_id": 92403147, "body": "The problem is, i am not allowed to change the parameters data types that why i must works with it"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1539172997, "post_id": 52739242, "comment_id": 92404105, "body": "Do you actually need to copy anything? In the example you\u2019ve shown, there\u2019s no need for this; simply store a pointer to the literal internally. Don\u2019t copy it, don\u2019t allocate any memory and don\u2019t free it."}, {"owner": {"reputation": 12896, "user_id": 104774, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gQmt5.jpg?s=128&g=1", "display_name": "stefaanv", "link": "https://stackoverflow.com/users/104774/stefaanv"}, "edited": false, "score": 0, "creation_date": 1539173167, "post_id": 52739242, "comment_id": 92404204, "body": "Since this seems to be an exercise on dynamic memory in a class, be sure to check the rule of three/five/zero (<a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/rule_of_three</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "edited": false, "score": 0, "creation_date": 1539171663, "post_id": 52739394, "comment_id": 92403298, "body": "thanks for your help! but i cant use char* test in main. It is restricted so i must  innitialiaze the member variable with the ctor"}, {"owner": {"reputation": 1694, "user_id": 1538258, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e2c17f9d54320c341a0d7b0b39bff036?s=128&d=identicon&r=PG", "display_name": "Praneeth Peiris", "link": "https://stackoverflow.com/users/1538258/praneeth-peiris"}, "reply_to_user": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "edited": false, "score": 0, "creation_date": 1539171749, "post_id": 52739394, "comment_id": 92403356, "body": "In that way, you can do it in the destructor, right?"}, {"owner": {"reputation": 1694, "user_id": 1538258, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e2c17f9d54320c341a0d7b0b39bff036?s=128&d=identicon&r=PG", "display_name": "Praneeth Peiris", "link": "https://stackoverflow.com/users/1538258/praneeth-peiris"}, "reply_to_user": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "edited": false, "score": 0, "creation_date": 1539171982, "post_id": 52739394, "comment_id": 92403483, "body": "@Joha: BTW, your question is not clear, and that&#39;s why many people (including me) got it wrong. Please mention your intention and the restrictions in the question itself."}, {"owner": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "edited": false, "score": 0, "creation_date": 1539172203, "post_id": 52739394, "comment_id": 92403631, "body": "Ahh yeah thats is what I am searching!! Thank You!"}, {"owner": {"reputation": 1694, "user_id": 1538258, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e2c17f9d54320c341a0d7b0b39bff036?s=128&d=identicon&r=PG", "display_name": "Praneeth Peiris", "link": "https://stackoverflow.com/users/1538258/praneeth-peiris"}, "reply_to_user": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "edited": false, "score": 0, "creation_date": 1539172271, "post_id": 52739394, "comment_id": 92403674, "body": "@Joha: Great! Don&#39;t forget to (upvote and) accept the answer so others won&#39;t get mislead."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 3, "creation_date": 1539172933, "post_id": 52739394, "comment_id": 92404071, "body": "You must not call <code>free</code> on a pointer allocated with <code>new[]</code>, this is undefined behaviour."}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1539174110, "post_id": 52739394, "comment_id": 92404863, "body": "^^^ don&#39;t use <code>free</code>, use <code>delete[]</code>. And don&#39;t forget to add or disable the copy constructor and assignment operator."}, {"owner": {"reputation": 1694, "user_id": 1538258, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e2c17f9d54320c341a0d7b0b39bff036?s=128&d=identicon&r=PG", "display_name": "Praneeth Peiris", "link": "https://stackoverflow.com/users/1538258/praneeth-peiris"}, "edited": false, "score": 0, "creation_date": 1539176095, "post_id": 52739394, "comment_id": 92406147, "body": "Sorry, I was just following the OPs path. Updated the answer."}], "tags": [], "owner": {"reputation": 1694, "user_id": 1538258, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e2c17f9d54320c341a0d7b0b39bff036?s=128&d=identicon&r=PG", "display_name": "Praneeth Peiris", "link": "https://stackoverflow.com/users/1538258/praneeth-peiris"}, "is_accepted": true, "score": -1, "last_activity_date": 1539176060, "last_edit_date": 1539176060, "creation_date": 1539171508, "answer_id": 52739394, "question_id": 52739242, "link": "https://stackoverflow.com/questions/52739242/copy-char-to-another-char-using-dynamic-allocation/52739394#52739394", "title": "copy char* to another char** using dynamic allocation", "body": "<p>Regardless of the issues in your implementation, the simple answer to your question would be to free it at the destructor. </p>\n\n<p>If you don't want to expose the <code>name_</code> variable, you can <code>free</code> it inside the destructor of the <code>Hardware</code> class.</p>\n\n<pre><code>Hardware::~Hardware()\n{\n    delete[] name_;\n}\n</code></pre>\n\n<p>If you <code>free</code> is inside the function itself, you're deleting the heap allocation, even though you're passing different variables, because they're pointing to the same memory location.</p>\n\n<p>But, as others suggested, the best way to work with strings is to use <code>std::string</code>.</p>\n"}], "owner": {"reputation": 47, "user_id": 9919407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d77f261c39724e868b45e9c5128420?s=128&d=identicon&r=PG&f=1", "display_name": "Joha", "link": "https://stackoverflow.com/users/9919407/joha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 52739394, "answer_count": 1, "score": 1, "last_activity_date": 1539176060, "creation_date": 1539171001, "question_id": 52739242, "link": "https://stackoverflow.com/questions/52739242/copy-char-to-another-char-using-dynamic-allocation", "title": "copy char* to another char** using dynamic allocation", "body": "<p>I am still new in this topic but can someone explain me how can I copy one char* to another char** as parameter without getting memory leaks?</p>\n\n<pre><code>void Hardware::copyString(char** dest, const char* source)\n{\n  size_t length = strlen(source);\n  auto string = new char[length+1];\n  strncpy(string, source, length);\n  string[length] = '\\0';\n  *dest = string;\n  //need to be freed\n  free(string); //if i free here the data would getting lost\n}\n</code></pre>\n\n<p>and a ctor:</p>\n\n<pre><code>Hardware::Hardware(const char* name, int cost)\n{\n copyString(&amp;name_, name);\n cost_ = cost;\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>Hardware hard(\"CPU\", 250)\n</code></pre>\n\n<p>Where should I free this without getting memory leaks and have the right output?</p>\n"}, {"tags": ["c++", "boost", "shared-memory"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539170810, "post_id": 52739160, "comment_id": 92402805, "body": "Please take some time to re-read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">re-take the SO tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">re-read about how to ask good questions</a>. Lastly don&#39;t forget how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "edited": false, "score": 0, "creation_date": 1539173859, "post_id": 52739160, "comment_id": 92404672, "body": "It should not matter that the map is in shared memory, at least not for the access itself. But maybe you need a semaphore or a mutex to prevent multiple, parallel access."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1539184834, "post_id": 52739160, "comment_id": 92411781, "body": "Using floats for equality comparison is almost always a bad idea. <a href=\"https://stackoverflow.com/questions/6684573/floating-point-keys-in-stdmap\" title=\"floating point keys in stdmap\">stackoverflow.com/questions/6684573/&hellip;</a>"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "edited": false, "score": 0, "creation_date": 1539188542, "post_id": 52739160, "comment_id": 92413988, "body": "@Rene why should it not matter? I agree that given the absence of code, we can only speak conceptually. And conceptually it doesn&#39;t matter. But technically, it does matter in a lot of details."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1539188663, "post_id": 52739160, "comment_id": 92414055, "body": "People tend to forget that while allocators are a nice abstraction, shared memory allocators are necessarily stateful, and stateful allocators require lots of library support and hand-holder by the programmer."}, {"owner": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1539235940, "post_id": 52739160, "comment_id": 92429272, "body": "@sehe That&#39;s why I wrote &quot;at least not for the access itself&quot;. E.g. the <code>map&lt;&gt;</code> has an <code>insert()</code> method, and it&#39;s the same for the <code>std::map</code> or for the <code>boost::interprocess::map&lt;&gt;</code> (if that&#39;s the correct namespace, I&#39;m not sure). But the internal implementations of course differ."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "edited": false, "score": 0, "creation_date": 1539236644, "post_id": 52739160, "comment_id": 92429540, "body": "@Rene The point is that usage is different because you have to deal with the allocator and converting  the values"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5511913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e63dd8c9f87422d895a69ee5a7c91c0?s=128&d=identicon&r=PG&f=1", "display_name": "p.k", "link": "https://stackoverflow.com/users/5511913/p-k"}, "edited": false, "score": 0, "creation_date": 1539183353, "post_id": 52740648, "comment_id": 92410774, "body": "I have initialized and allocated map object using managed shared memory in one process. I need to add some more elements into it in another process.need to expand the map or vector."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1539187782, "post_id": 52740648, "comment_id": 92413557, "body": "@Max this is highly simplistic. None of this translates to shared memory containers, without advanced mechanisms (scoped allocators) and even then it skirts the edges of the construction argument forwarding mechanisms. I&#39;ll post an answer just to show."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1539188464, "post_id": 52740648, "comment_id": 92413943, "body": "<a href=\"https://stackoverflow.com/a/52744714/85371\">Posted</a>. If you&#39;re up for a challenge, you could try to write just the <code>doesn&#39;t exist</code> branch in a natural fashion (say <code>_map.emplace(f, {s});</code> as you&#39;d usually be able to write). Of course, my solution cheats on that by using the default-constructing <code>operator[]</code>."}], "tags": [], "owner": {"reputation": 588, "user_id": 9759769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/103f6c140cd1a7b04c8b8d4c04a54370?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/9759769/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1539175612, "creation_date": 1539175612, "answer_id": 52740648, "question_id": 52739160, "link": "https://stackoverflow.com/questions/52739160/vector-of-string-shared-memory-map/52740648#52740648", "title": "Vector of string shared memory map", "body": "<p>Do you mean something like this:</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n        std::map&lt;float, std::vector&lt;std::string&gt;&gt; m;\n\n        m[.5f].emplace_back(\"First\");\n        m[.5f].emplace_back(\"Second\");\n        m[.0f].emplace_back(\"Hello\");\n        m[.0f].emplace_back(\"World\");\n\n        for(const auto&amp; [key, value] : m)\n        {\n                std::cout &lt;&lt; \"Key: \" &lt;&lt; key &lt;&lt; '\\n';\n                for(const auto&amp; str : value)\n                        std::cout &lt;&lt; '\\t' &lt;&lt; str &lt;&lt; '\\n';\n        }\n        std::cout.flush();\n        return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1539188354, "creation_date": 1539188354, "answer_id": 52744714, "question_id": 52739160, "link": "https://stackoverflow.com/questions/52739160/vector-of-string-shared-memory-map/52744714#52744714", "title": "Vector of string shared memory map", "body": "<p>Doing this in shared memory is pretty hard, actually.</p>\n\n<p>If you get all the allocators right, and add the locking, you'd usually get very  clunky code that is hard to read due to all the allocator passing around.</p>\n\n<p>You can, however, employ Boost's scoped allocator adaptor which will do a lot (lot) of magic that makes life better.</p>\n\n<p>I think the following code sample just about nails the sweet spot. </p>\n\n<blockquote>\n  <p><strong>Warning</strong>: This builds on years of experience trying to beat this into submission. If you fall just outside of the boundary of \"magic\" (mostly the in-place construction support due to <code>uses_allocator&lt;&gt;</code> and <code>scoped_allocator_adaptor</code>) you will find it breaks up and you'll be writing a lot of manual constructor/conversion calls to make it work.</p>\n</blockquote>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/7f280560be830cf6\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#define DEMO\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;mutex&gt;\n#include &lt;boost/interprocess/containers/map.hpp&gt;\n#include &lt;boost/interprocess/containers/string.hpp&gt;\n#include &lt;boost/interprocess/containers/vector.hpp&gt;\n#include &lt;boost/interprocess/sync/interprocess_mutex.hpp&gt;\n#include &lt;boost/interprocess/managed_shared_memory.hpp&gt;\n#include &lt;boost/interprocess/managed_mapped_file.hpp&gt; // For Coliru (doesn't support shared memory)\n#include &lt;boost/interprocess/allocators/allocator.hpp&gt;\n#include &lt;boost/container/scoped_allocator.hpp&gt;\n\nnamespace bip = boost::interprocess;\nnamespace bc = boost::container;\n\nnamespace Shared {\n    using Segment = bip::managed_mapped_file; // Coliru doesn't support bip::managed_shared_memory\n\n    template &lt;typename T&gt; using Alloc = bc::scoped_allocator_adaptor&lt;bip::allocator&lt;T, Segment::segment_manager&gt; &gt;;\n    template &lt;typename V&gt;\n        using Vector = bip::vector&lt;V, Alloc&lt;V&gt; &gt;;\n    template &lt;typename K, typename V, typename Cmp = std::less&lt;K&gt; &gt;\n        using Map = bip::map&lt;K, V, Cmp, Alloc&lt;std::pair&lt;K const, V&gt; &gt; &gt;;\n\n    using String = bip::basic_string&lt;char, std::char_traits&lt;char&gt;, Alloc&lt;char&gt; &gt;;\n\n    using Mutex = bip::interprocess_mutex;\n}\n\nnamespace Lib {\n    using namespace Shared;\n    struct Data {\n        using Map = Shared::Map&lt;float, Shared::Vector&lt;Shared::String&gt; &gt;;\n\n        mutable Mutex _mx;\n        Map _map;\n\n        template &lt;typename Alloc&gt; Data(Alloc alloc = {}) : _map(alloc) {}\n\n        bool append(float f, std::string s) {\n            std::lock_guard&lt;Mutex&gt; lk(_mx); // lock\n\n            auto it = _map.find(f);\n            bool const exists = it != _map.end();\n\n#ifndef DEMO\n            if (exists) {\n                it-&gt;second.emplace_back(s);\n            }\n#else\n            // you didn't specify this, but lets insert new keys here, if\n            // only for the demo\n            _map[f].emplace_back(s);\n#endif\n            return exists;\n        }\n\n        size_t size() const {\n            std::lock_guard&lt;Mutex&gt; lk(_mx); // lock\n            return _map.size();\n        }\n\n        friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, Data const&amp; data) {\n            std::lock_guard&lt;Mutex&gt; lk(data._mx); // lock\n\n            for (auto&amp; [f,v] : data._map) {\n                os &lt;&lt; f &lt;&lt; \" -&gt;\";\n                for (auto&amp; ss : v) {\n                    os &lt;&lt; \" \" &lt;&lt; std::quoted(std::string(ss));\n                }\n                os &lt;&lt; \"\\n\";\n            }\n\n            return os;\n        }\n    };\n}\n\nstruct Program {\n    Shared::Segment msm { bip::open_or_create, \"data.bin\", 10*1024 };\n    Lib::Data&amp; _data = *msm.find_or_construct&lt;Lib::Data&gt;(\"data\")(msm.get_segment_manager());\n\n    void report() const {\n        std::cout &lt;&lt; \"Map contains \" &lt;&lt; _data.size() &lt;&lt; \" entries\\n\" &lt;&lt; _data;\n    }\n};\n\nstruct Client : Program {\n    void run(float f) {\n        _data.append(f, \"one\");\n        _data.append(f, \"two\");\n    }\n};\n\nint main() {\n    {\n        Program server;\n        server.report();\n\n        Client().run(.5f);\n        Client().run(.6f);\n    }\n\n    // report again\n    Program().report();\n}\n</code></pre>\n\n<p>First run would print:</p>\n\n<pre><code>Map contains 0 entries\nMap contains 2 entries\n0.5 -&gt; \"one\" \"two\"\n0.6 -&gt; \"one\" \"two\"\n</code></pre>\n\n<p>A second run:</p>\n\n<pre><code>Map contains 2 entries\n0.5 -&gt; \"one\" \"two\"\n0.6 -&gt; \"one\" \"two\"\nMap contains 2 entries\n0.5 -&gt; \"one\" \"two\" \"one\" \"two\"\n0.6 -&gt; \"one\" \"two\" \"one\" \"two\"\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5511913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e63dd8c9f87422d895a69ee5a7c91c0?s=128&d=identicon&r=PG&f=1", "display_name": "p.k", "link": "https://stackoverflow.com/users/5511913/p-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1539188354, "creation_date": 1539170704, "last_edit_date": 1539170756, "question_id": 52739160, "link": "https://stackoverflow.com/questions/52739160/vector-of-string-shared-memory-map", "title": "Vector of string shared memory map", "body": "<p>How to append string to a vector contained inside map? Structure is map(float,vector(string)) where the map is in shared memory.my question is if key==desired key then append string to the vector of strings? </p>\n"}, {"tags": ["c++", "c++17", "unordered-map", "erase"], "answers": [{"comments": [{"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1539181428, "post_id": 52739207, "comment_id": 92409561, "body": "<i>the handle itself has member functions</i>  Yes, I settled on using <code>node_type::value()</code> but I got confused by the doc. I <i>am</i> holding pointers to <code>value_type</code>s from the map, which supposedly I should not dereference while the node is detached. Now, such a pointer from when node was still attached, is either equal to <code>&amp;nodeHandle.value()</code>, or it&#39;s not... if you see my point."}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1539181642, "post_id": 52739207, "comment_id": 92409710, "body": "to cut the story short - I need to clear some pointers to <code>map::value_type</code> from other data structures when a map element is removed. I think it&#39;s safe to do so by <code>extract</code>-ing that node, and looking for <code>&amp;nodeHandle.value()</code> in those structures."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1539185537, "post_id": 52739207, "comment_id": 92412216, "body": "@haelix Oh, ouch, well that should work as long as &quot;usable&quot; means what I think it means"}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1539193722, "post_id": 52739207, "comment_id": 92416753, "body": "You mean, you&#39;re not convinced <code>extract</code> will not alter the memory location of <code>value()</code> (despite the purpose of the method being, to move/splice non-copyable non-movable objects between containers) -- hmm"}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 2, "creation_date": 1539212401, "post_id": 52739207, "comment_id": 92424109, "body": "@haelix There&#39;s some hanky-panky going on under the hood to turn a <code>pair&lt;const Key, Value&gt;</code> into a <code>pair&lt;Key, Value&gt;</code> (with no moving or copying).  It is up to the implementation to make sure it works, but that magic isn&#39;t guaranteed to be portable.  The language lawyers get rather excitable when type-punning comes up.  There&#39;s compiler optimizations to worry about, cache invalidations to worry about, and I can&#39;t remember what all else.  As long as you&#39;re comparing pointers, and not dereferencing your cached pointers, I think you&#39;re well within bounds."}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1539212970, "post_id": 52739207, "comment_id": 92424254, "body": "Ok that&#39;s very helpful."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1539250637, "post_id": 52739207, "comment_id": 92436843, "body": "Yep, that. The actual location is very unlikely to change (why would it change back?) but there are complexities involved that come from C++ not being a baremetal programming language but instead an abstraction with a complex type system and blah blah blah. One could argue that this in itself is a huge abstraction leak, but that&#39;s what happens when would-be language features are implemented in &quot;userspace&quot; by a library. At least we get the feature I guess."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 6, "last_activity_date": 1539170894, "creation_date": 1539170894, "answer_id": 52739207, "question_id": 52739158, "link": "https://stackoverflow.com/questions/52739158/stdunordered-mapextract-references-pointers-invalidation/52739207#52739207", "title": "std::unordered_map::extract references/pointers invalidation", "body": "<p>Yes, that is what the text says.</p>\n\n<p>At first glance that seems like a fairly arbitrary limitation, though I'm sure there's some good, if arcane, reason for it.</p>\n\n<p>That being said, the handle itself has member functions <code>value()</code>/<code>key()</code>/<code>mapped()</code> that may be of value (!) to you.</p>\n\n<blockquote>\n  <p>Node handle is a move-only type that owns and provides access to the element (the value_type) stored in the node, and provides non-const access to the key part of the element (the key_type) and the mapped part of the element (the mapped_type). <em>(<a href=\"https://en.cppreference.com/w/cpp/container/node_handle\" rel=\"noreferrer\">ref</a>)</em></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1539181794, "post_id": 52742172, "comment_id": 92409802, "body": "That&#39;s good insight, thanks... Does you remark apply if holding pointers to directly <code>value_type</code>? (not the <code>pair&lt;&gt;</code>)."}], "tags": [], "owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "is_accepted": false, "score": 4, "last_activity_date": 1539180849, "last_edit_date": 1539180849, "creation_date": 1539180546, "answer_id": 52742172, "question_id": 52739158, "link": "https://stackoverflow.com/questions/52739158/stdunordered-mapextract-references-pointers-invalidation/52742172#52742172", "title": "std::unordered_map::extract references/pointers invalidation", "body": "<p>You can think that <code>extract</code> (and corresponding <code>insert</code>) \"magically\" changes the type of the affected map element: when the element is owned by the map, it has type <code>std::pair&lt;const key_type, mapped_type&gt;</code>, but when the element is owned by the node handle, it has type <code>std::pair&lt;key_type, mapped_type&gt;</code> (so you can change the value of the key).</p>\n\n<p>Thus, if you acquire a reference/pointer to an element when the element is owned by the map, then you can't use that reference/pointer after the element is extracted and before it is re-inserted, or you will violate the strict aliasing rule.</p>\n\n<p>However, it is totally fine to use a reference/pointer acquired after the extraction.</p>\n"}], "owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 52739207, "answer_count": 2, "score": 9, "last_activity_date": 1539184500, "creation_date": 1539170695, "last_edit_date": 1539184500, "question_id": 52739158, "link": "https://stackoverflow.com/questions/52739158/stdunordered-mapextract-references-pointers-invalidation", "title": "std::unordered_map::extract references/pointers invalidation", "body": "<p>For the new C++17 <code>std::unordered_map::extract</code> function the documentation says:</p>\n\n<blockquote>\n  <p>Extracting a node invalidates only the iterators to the extracted\n  element, and preserves the relative order of the elements that are not\n  erased. Pointers and references to the extracted element remain valid,\n  but cannot be used while element is owned by a node handle: they\n  become usable if the element is inserted into a container.</p>\n</blockquote>\n\n<p>Naturally, <code>extract</code> invalidates iterator of the extracted (which is a thing of the container, from which the element was removed). But the documentation is funky about references and pointers - it says these remain valid but <strong>cannot be used</strong> until re-inserted into (possibly another) container - case in which they will have retained their values (?).</p>\n\n<p><strong>Question:</strong> My use case is to examine an element after extracting, i.e. do an erase-examine-discardForGood operation with only one hash lookup. The <code>extract</code> function seemed perfectly suited for this however documentation suggests I can't use <code>node_type</code> to examine the element. Is my understanding correct?</p>\n"}]