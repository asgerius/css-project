[{"tags": ["c++", "matlab", "matlab-class"], "answers": [{"tags": [], "owner": {"reputation": 1026, "user_id": 4656601, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5H54K.jpg?s=128&g=1", "display_name": "James Tursa", "link": "https://stackoverflow.com/users/4656601/james-tursa"}, "is_accepted": false, "score": 1, "last_activity_date": 1548906123, "creation_date": 1548906123, "answer_id": 54452952, "question_id": 54451410, "link": "https://stackoverflow.com/questions/54451410/read-custom-class-in-c-application-from-mat-file/54452952#54452952", "title": "Read custom class in C application from MAT-file", "body": "<p>classdef variables are opaque objects in MATLAB, and the details of how properties are stored in them is not published. You have to use official API functions to get at them (and mxGetProperty makes a deep copy btw). So you are stuck. My advice is to extract the properties you are interested in from the object and then save those to the mat file.</p>\n"}], "owner": {"reputation": 13, "user_id": 9748460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110f8740a836220c029913df60a361d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tritium", "link": "https://stackoverflow.com/users/9748460/tritium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559062286, "creation_date": 1548892693, "last_edit_date": 1559062286, "question_id": 54451410, "link": "https://stackoverflow.com/questions/54451410/read-custom-class-in-c-application-from-mat-file", "title": "Read custom class in C application from MAT-file", "body": "<p>I want to access the properties of a custom MATLAB class in a MAT-file in a C++ standalone application. The custom class is a class created in MATLAB with  something like this:</p>\n\n<pre><code>classdef customClass\n    properties\n        myProp\n    end\n\n    methods\n        function obj = customClass(arg1,arg2)\n           obj.myProp = arg1 + arg2\n        end\n    end\nend\n\n</code></pre>\n\n<p>An instance of this class is now saved to a MAT-file and should be accessed by a standalone C application.</p>\n\n<p>Apparently, MATLAB offers a <a href=\"https://mathworks.com/help/matlab/matlab-c-api-to-read-mat-file-data.html\" rel=\"nofollow noreferrer\">library</a> for reading MAT-files in C applications. \nThis works fine for the \"normal\" types and the API seems to offer the function <a href=\"https://de.mathworks.com/help/matlab/apiref/mxgetproperty.html\" rel=\"nofollow noreferrer\"><code>mxGetProperty</code></a> for accessing custom objects. However, if I try to run a minimal example using this function, it fails with an empty assertion in <code>management.cpp:671</code>. The minimal example is:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"mat.h\"\n\nint main()\n{\n    MATFile* file = matOpen(\"test.mat\", \"r\");\n    if (file == nullptr)\n        std::cout &lt;&lt; \"unable to open .mat\" &lt;&lt; std::endl;\n\n    mxArray* customClass = matGetVariable(file, \"c\");\n    if (customClass == nullptr)\n        std::cout &lt;&lt; \"unable to open tcm\" &lt;&lt; std::endl;\n\n    mxArray* prop = mxGetProperty(customClass, 0, \"myProp\");\n\n    if (prop == nullptr)\n        std::cout &lt;&lt; \"unable to access myProp\";\n}\n</code></pre>\n\n<p>A closer look to the documentation reveals the limitation:\n<code>mxGetProperty</code> is not supported for standalone applications, such as applications built with the MATLAB engine API.</p>\n\n<p>Is there any other possibility to access a <code>customClass</code> in a MAT-file from a standalone C++ application?</p>\n"}, {"tags": ["c++", "c++11", "lambda", "unordered-map", "c++-standard-library"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1548892618, "post_id": 54451381, "comment_id": 95711140, "body": "lambda takes iterators from the hash map, not maps. You want to compare two pairs of values, not maps."}, {"owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1548892792, "post_id": 54451381, "comment_id": 95711184, "body": "works now. Thanks for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": false, "score": 4, "last_activity_date": 1548892778, "creation_date": 1548892778, "answer_id": 54451424, "question_id": 54451381, "link": "https://stackoverflow.com/questions/54451381/using-lambda-function-to-find-a-minimum-value-in-a-stdunordered-map/54451424#54451424", "title": "Using lambda function to find a minimum value in a std::unordered_map", "body": "<p>Your lambda should be binary predicate which takes two pairs of <code>std::pair&lt;const int, double&gt;</code>.</p>\n\n<p>Change the lambda to as follows:</p>\n\n<pre><code>std::pair&lt;int, double&gt; min = *std::min_element(\n    my_map.begin(), my_map.end(),\n    [](const auto &amp;a, const auto &amp;b) { return a.second &lt; b.second; });\n</code></pre>\n\n<p>or more explicitly:</p>\n\n<pre><code>std::pair&lt;int, double&gt; min = *std::min_element(\n    my_map.begin(), my_map.end(),\n    [](const std::pair&lt;const int, double&gt; &amp;a, const std::pair&lt;const int, double&gt; &amp;b) { return a.second &lt; b.second; });\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 2, "last_activity_date": 1548892854, "creation_date": 1548892854, "answer_id": 54451436, "question_id": 54451381, "link": "https://stackoverflow.com/questions/54451381/using-lambda-function-to-find-a-minimum-value-in-a-stdunordered-map/54451436#54451436", "title": "Using lambda function to find a minimum value in a std::unordered_map", "body": "<p>You are trying to use lambda that accepts maps themselves, not elements of it:</p>\n\n<pre><code>[](std::unordered_map&lt;int, double&gt; a, std::unordered_map&lt;int, double&gt; b)\n</code></pre>\n\n<p>so it's either (verbose):</p>\n\n<pre><code>[](std::unordered_map&lt;int, double&gt;::value_type a, std::unordered_map&lt;int, double&gt;::value_type b)\n</code></pre>\n\n<p>or simpler:</p>\n\n<pre><code>[](std::pair&lt;int, double&gt; a, std::pair&lt;int, double&gt; b)\n</code></pre>\n\n<p>or if you have c++14 or later:</p>\n\n<pre><code>[](auto a, auto b)\n</code></pre>\n\n<p>you may also consider to pass elements by const reference not to copy them for every iteration.</p>\n"}], "owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1706, "favorite_count": 0, "accepted_answer_id": 54451436, "answer_count": 2, "score": 1, "last_activity_date": 1565514017, "creation_date": 1548892521, "last_edit_date": 1565514017, "question_id": 54451381, "link": "https://stackoverflow.com/questions/54451381/using-lambda-function-to-find-a-minimum-value-in-a-stdunordered-map", "title": "Using lambda function to find a minimum value in a std::unordered_map", "body": "<p>I am trying to find the element with the minimum value in the map. For example, if my map has</p>\n\n<pre><code> { (1, 12.3),(2, 6.51), (3, 1.24)}\n</code></pre>\n\n<p>I would like to find the element <code>(3, 1.24)</code>.</p>\n\n<hr>\n\n<p>I wrote the following code, which tries to write a comparator in the lambda format</p>\n\n<pre><code>std::pair&lt;int, double&gt; min = *std::min_element(\n    my_map.begin(), my_map.end(),\n    [](std::unordered_map&lt;int, double&gt; a, std::unordered_map&lt;int, double&gt; b) { return a.second &lt; b.second; });\n</code></pre>\n\n<p>But I got the following errors:</p>\n\n<pre><code>error: no matching function for call to object of type '(lambda at my_code.cpp:118:9)'\n            if (__comp(*__i, *__first))\n                ^~~~~~\nmy_code.cpp:116:40: note: in instantiation of function template specialization 'std::__1::min_element&lt;std::__1::__hash_map_iterator&lt;std::__1::__hash_iterator&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;int, double&gt;, void *&gt; *&gt; &gt;, (lambda at my_code.cpp:118:9)&gt;' requested here\n    std::pair&lt;int, double&gt; min = *std::min_element(\n                                       ^\nmy_code.cpp:118:9: note: candidate function not viable: no known conversion from 'std::__1::__hash_map_iterator&lt;std::__1::__hash_iterator&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;int, double&gt;, void *&gt; *&gt; &gt;::value_type' (aka 'pair&lt;const int, double&gt;') to 'std::unordered_map&lt;int, double&gt;' for 1st argument\n        [](std::unordered_map&lt;int, double&gt; a, std::unordered_map&lt;int, double&gt; b) { return a.second &lt; b.second; });\n        ^\nmy_code.cpp:118:9: note: conversion candidate of type 'void (*)(std::unordered_map&lt;int, double&gt;, std::unordered_map&lt;int, double&gt;)'\n3 errors generated.\n</code></pre>\n\n<p>Any idea what I did wrong and what's the proper way to fix this? Thanks!</p>\n"}, {"tags": ["c++", "multithreading", "pipe", "file-descriptor", "android-looper"], "comments": [{"owner": {"reputation": 443, "user_id": 5735630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a01dacc93f117afa749969161fc3a43?s=128&d=identicon&r=PG&f=1", "display_name": "IGarFieldI", "link": "https://stackoverflow.com/users/5735630/igarfieldi"}, "edited": false, "score": 0, "creation_date": 1548893923, "post_id": 54451198, "comment_id": 95711475, "body": "Iirc file descriptors can be marked non-blocking, which would have write fail with EAGAIN in case of a full FIFO. This can be achieved with int flags = fcntl(fd, F_GETFL, 0); fcntl(fd, F_SETFL, flags | O_NONBLOCK);"}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "reply_to_user": {"reputation": 443, "user_id": 5735630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a01dacc93f117afa749969161fc3a43?s=128&d=identicon&r=PG&f=1", "display_name": "IGarFieldI", "link": "https://stackoverflow.com/users/5735630/igarfieldi"}, "edited": false, "score": 0, "creation_date": 1548928637, "post_id": 54451198, "comment_id": 95723728, "body": "@IGarFieldI Thanks, but consider that this could result in posted tasks never being run if the queue is full. This is ok for some applications, but not for making thread handlers, where you want the guarantee that the task will be run eventually. I imagine that the solution will make use of non-blocking writes in some way though."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1548935378, "post_id": 54451198, "comment_id": 95727734, "body": "<i>then the worker thread will be blocked, waiting to write to the pipe. But the pipe&#39;s FIFO is full, and the worker thread is not reading anything from it, so the entire system is in deadlock.</i>  I&#39;d say that&#39;s a bad design, not a flaw with pipes.  Design your system so a worker thread doesn&#39;t write to it&#39;s own job queue, for example."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 1, "creation_date": 1548943281, "post_id": 54451198, "comment_id": 95732535, "body": "I would avoid to use a pipe to communicate between threads: you are involving OS feature not needed for inter-thread communication. for example a <code>std::queue</code> and a <code>std::mutex</code> would serve the same purpose, with more flexibility and less hassle"}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1548955318, "post_id": 54451198, "comment_id": 95739889, "body": "@AndrewHenle That&#39;s roughly what I&#39;m getting at. Not saying pipes are at fault, but I need a way of not writing to the worker&#39;s own job queue without that filling up just the same."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "reply_to_user": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1548955422, "post_id": 54451198, "comment_id": 95739941, "body": "@Sigismondo Even a <code>std::queue</code> can fill up uncontrollably. Besides, the thing with making a file descriptor in my case is that they work with Android&#39;s Looper system."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 1, "creation_date": 1548975204, "post_id": 54451198, "comment_id": 95748656, "body": "I think that you cannot design your system without considering that the producer can produce data faster than the consumer. Pipes will block because of OS constraints, std::queue because of system limits eventually. when using messaging it&#39;s said that queues should be always empty: the consumer must be faster than the producer. If the opposite is happening (ie: an arbitrary limit has been surpassed) you are facing an error condition and you must handle it. If you don&#39;t do it, problems will happens. No architecture can guarantee to pile messages uncontrollably."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1549013548, "post_id": 54451198, "comment_id": 95760246, "body": "with arbitrary limit I mean: &quot;Even a std::queue can fill up uncontrollably&quot;. You will just check the queue::size() in your post(), before calling queue::push(), against a limit that you have chosen to set as your queue limit. If the queue is full (ie, its size has reached your imposed limit) your post() will fail. I mean... avoid to fill all the RAM and the swap of your system!"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1549016219, "post_id": 54451198, "comment_id": 95761641, "body": "@Sigismondo <i>the producer can produce data faster than the consumer</i> That&#39;s not a problem with the queuing mechanism as long as a producer isn&#39;t also a consumer nor a consumer a producer. In that case, as long as the consumer(s) are able to make progress, the system won&#39;t stop working. It may get really backed up, but it will still move forward.  And since no queue can be infinite, the question here is really one of how <i>long</i> it takes to deadlock.."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1549016437, "post_id": 54451198, "comment_id": 95761742, "body": "@CJxD <i>I need a way of not writing to the worker&#39;s own job queue without that filling up just the same.</i>  Without redesigning the system to <i>not</i> do that, if every job is equal and order doesn&#39;t matter, then simply short-circuit the queuing at that point and just loop through the jobs in the worker.  It&#39;s a bit of a kludge, but it avoids the deadlock problem. You can just view it as a self-expanding job."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1549017213, "post_id": 54451198, "comment_id": 95762182, "body": "@AndrewHenle the problem is that <i>tasks</i> the OP is using are multiplexed over threads in a pool. So one thread can run both producers and consumers. In such design <i>tasks</i> must never block, or it can happen that all the threads of the pool can run blocking/producer tasks and the whole system deadlock. This is the situation he is facing. That&#39;s why I think that post() needs to fail if the queue is full: this will let the producer <i>task</i> to exit, the consumer <i>tasks</i> to be scheduled and than the producer <i>task</i> retry when rescheduled, and hopefully find room in the queue."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1549017614, "post_id": 54451198, "comment_id": 95762414, "body": "I&#39;m assuming that consumers are scheduled in same thread pool. Are the consumers in the same thread pool? If not it shouldn&#39;t deadlock at all, and this could be another solution thought."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1549017652, "post_id": 54451198, "comment_id": 95762441, "body": "Thanks for all the helpful comments everyone. I&#39;m starting to get a clearer picture of what needs to happen. My thoughts are now thus, and will assume a single consumer thread: calls to post() are blocking unless the thread posting is the consumer thread. If so, then the task gets pushed to a separate overflow queue. Once the consumer thread finishes its current task, it goes back to the overflow queue, and fulfils all of those before reading from the pipe again. As long as the tasks are not infinitely recursive, like the example I gave, this should be fine, no?"}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1549017720, "post_id": 54451198, "comment_id": 95762483, "body": "^ the above can extend to multiple consumer threads by having an overflow queue per consumer, I think."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1549018892, "post_id": 54451198, "comment_id": 95763127, "body": "I think that if the overflow queue can fill up, and the corresponding post() can block and cannot fail, you will be facing the same problem. This <i>will</i> happen if producers are faster than consumers. Aren&#39;t there &quot;end-consumers&quot;? consumers which never call post(). If you dedicate to them one/some threads your problem should be over."}, {"owner": {"reputation": 10938, "user_id": 155082, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f1316ecb725006d020998e6b8a0740c?s=128&d=identicon&r=PG", "display_name": "Lothar", "link": "https://stackoverflow.com/users/155082/lothar"}, "edited": false, "score": 0, "creation_date": 1615895849, "post_id": 54451198, "comment_id": 117828288, "body": "The second main reason for GrandCentral Dispatch is that it allows the system to start more threads when the tasks stall on long running IO blocks. It&#39;s a better design to use task but still a bad design that the process has to determine the number of threads in the pool. Thats what GCD is now doing, in the non open source part it seems that the kernel is signaling if new threads need to start. The kernel is the only instance who knows about the system load. Thats also why no port of GCD with good performance currently exist."}], "answers": [{"comments": [{"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1548955585, "post_id": 54459714, "comment_id": 95740021, "body": "Thanks for this answer. Does it have any specific advantage over using <code>::write</code> with <code>O_NONBLOCK</code>? Also, the real issue lies in <i>how</i> to handle this error condition. If it just put the function in another queue, then that queue will fill up just the same."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "reply_to_user": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1548974855, "post_id": 54459714, "comment_id": 95748538, "body": "using select is the old-fashioned way. select was born before threads for example. It just works very fine. O_NONBLOCK is really more modern and doesn&#39;t suffer of the drawback that write afterward MAY block if it&#39;s going to write a large block."}], "tags": [], "owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "is_accepted": false, "score": 1, "last_activity_date": 1548936754, "last_edit_date": 1548936754, "creation_date": 1548934523, "answer_id": 54459714, "question_id": 54451198, "link": "https://stackoverflow.com/questions/54451198/creating-a-dispatch-queue-thread-handler-in-c-with-pipes-fifos-overfilling/54459714#54459714", "title": "Creating a dispatch queue / thread handler in C++ with pipes: FIFOs overfilling", "body": "<p>You can use the old good <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">select</a> to determine whether the file descriptors are ready to be used for writing:</p>\n\n<blockquote>\n  <p>The file descriptors in writefds will be watched to see if\n  space is available for write (though a large write may still block).</p>\n</blockquote>\n\n<p>Since you are writing a pointer, your <code>write()</code> cannot be classified as large at all.</p>\n\n<p>Clearly you must be ready to handle the fact that a post may fail, and then be ready to retry it later... otherwise you will be facing indefinitely growing pipes, until you system will break again. </p>\n\n<p>More or less (not tested):</p>\n\n<pre><code>bool post(const std::function&lt;void(void)&gt;&amp; task) {\n    bool post_res = false;\n\n    // Copy the function onto the heap\n    auto* taskPtr = new std::function&lt;void(void)&gt;(task);\n\n    fd_set wfds;\n    struct timeval tv;\n    int retval;\n\n    FD_ZERO(&amp;wfds);\n    FD_SET(taskWrite, &amp;wfds);\n\n    // Don't wait at all\n    tv.tv_sec = 0;\n    tv.tv_usec = 0;\n\n    retval = select(1, NULL, &amp;wfds, NULL, &amp;tv);\n    // select() returns 0 when no FD's are ready\n    if (retval == -1) {\n      // handle error condition\n    } else if (retval &gt; 0) {\n      // Write the pointer to the pipe. This write will succeed\n      ::write(taskWrite, &amp;taskPtr, sizeof(taskPtr));\n      post_res = true;\n    }\n    return post_res;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1548955657, "post_id": 54459731, "comment_id": 95740056, "body": "It&#39;s clear to see that just increasing the size won&#39;t work for the test case - at some point, it will fail, it&#39;s just a matter of when. The multiple worker threads is more interesting though."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1548956369, "post_id": 54459731, "comment_id": 95740478, "body": "@CJxD Yes and no and it depends."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1548935025, "last_edit_date": 1548935025, "creation_date": 1548934584, "answer_id": 54459731, "question_id": 54451198, "link": "https://stackoverflow.com/questions/54451198/creating-a-dispatch-queue-thread-handler-in-c-with-pipes-fifos-overfilling/54459731#54459731", "title": "Creating a dispatch queue / thread handler in C++ with pipes: FIFOs overfilling", "body": "<p>Make the pipe write file descriptor non-blocking, so that <code>write</code> fails with <code>EAGAIN</code> when the pipe is full.</p>\n\n<hr>\n\n<p>One improvement is to increase the pipe buffer size.</p>\n\n<p>Another is to use a UNIX socket/socketpair and increase the socket buffer size.</p>\n\n<p>Yet another solution is to use a UNIX datagram socket which many worker threads can read from, but only one gets the next datagram. In other words, you can use a datagram socket as a thread dispatcher.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1549453915, "post_id": 54518873, "comment_id": 95905769, "body": "A more performant solution would be to use a mutex and a condition variable. This way you would minimize system calls and eliminate copying data between user-space and kernel. Also, you should just use a blocking write and remove the rest of the code in your <code>write</code> function because it effectively tries to do a blocking write with more code."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1549476604, "post_id": 54518873, "comment_id": 95919246, "body": "@MaximEgorushkin Could you please explain where would the mutex + condition go? As for the blocking write, this is true except for the flag on the write function that enables or disables blocking."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1549476756, "post_id": 54518873, "comment_id": 95919292, "body": "That would be a totally different question not deserving to be treated by a comment."}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1549476923, "post_id": 54518873, "comment_id": 95919377, "body": "@MaximEgorushkin Could you write it in an answer?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1549477112, "post_id": 54518873, "comment_id": 95919447, "body": "When I have some time."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1549589948, "post_id": 54518873, "comment_id": 95966682, "body": "You need a multiple-producer-multiple-consumer queue, like <a href=\"https://software.intel.com/en-us/node/506201\" rel=\"nofollow noreferrer\">software.intel.com/en-us/node/506201</a>."}], "tags": [], "owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "is_accepted": true, "score": 2, "last_activity_date": 1549476971, "last_edit_date": 1549476971, "creation_date": 1549292469, "answer_id": 54518873, "question_id": 54451198, "link": "https://stackoverflow.com/questions/54451198/creating-a-dispatch-queue-thread-handler-in-c-with-pipes-fifos-overfilling/54518873#54518873", "title": "Creating a dispatch queue / thread handler in C++ with pipes: FIFOs overfilling", "body": "<p>Thanks to all the comments and other answers in this post, I now have a working solution to this problem.</p>\n\n<p>The trick I've employed is to prioritise worker threads by checking which thread is calling <code>post()</code>. Here is the rough algorithm:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>pipe \u2190 NON-BLOCKING-PIPE()\noverflow \u2190 \u00d8\nPOST(task)\n    success \u2190 WRITE(task, pipe)\n    IF NOT success THEN\n        IF THREAD-IS-WORKER() THEN\n            overflow \u2190 overflow \u222a {task}\n        ELSE\n            WAIT(pipe)\n            POST(task)\n</code></pre>\n\n<p>Then on the worker thread:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>LOOP FOREVER\n    task \u2190 READ(pipe)\n    RUN(task)\n\n    FOR EACH overtask \u2208 overflow\n        RUN(overtask)\n\n    overflow \u2190 \u00d8\n</code></pre>\n\n<p>The wait is performed with <a href=\"https://linux.die.net/man/2/pselect\" rel=\"nofollow noreferrer\">pselect(2)</a>, adapted from the answer by @Sigismondo.</p>\n\n<p>Here's the algorithm implemented in my original code example that will work for a single worker thread (although I haven't tested it after copy-paste). It can be extended to work for a thread pool by having a separate overflow queue for each thread.</p>\n\n<pre><code>int taskRead, taskWrite;\n\n// These variables are only allowed to be modified by the worker thread\nstd::__thread_id workerId;\nstd::queue&lt;std::function&lt;void(void)&gt;&gt; overflow;\nbool overflowInUse;\n\nvoid setup() {\n    int taskPipe[2];\n    ::pipe(taskPipe);\n    taskRead = taskPipe[0];\n    taskWrite = taskPipe[1];\n\n    // Make the pipe non-blocking to check pipe overflows manually\n    ::fcntl(taskWrite, F_SETFL, ::fcntl(taskWrite, F_GETFL, 0) | O_NONBLOCK);\n\n    // Save the ID of this worker thread to compare later\n    workerId = std::this_thread::get_id();\n    overflowInUse = false;\n\n    function_that_polls_file_descriptor(taskRead, []() {\n        // Read the callback data\n        std::function&lt;void(void)&gt;* taskPtr;\n        ::read(taskRead, &amp;taskPtr, sizeof(taskPtr));\n\n        // Run the task\n        (*taskPtr)();\n        delete taskPtr;\n\n        // Run any tasks that were posted to the overflow\n        while (!overflow.empty()) {\n            taskPtr = overflow.front();\n            overflow.pop();\n\n            (*taskPtr)();\n            delete taskPtr;\n        }\n\n        // Release the overflow mechanism if applicable\n        overflowInUse = false;\n    });\n}\n\nbool write(std::function&lt;void(void)&gt;* taskPtr, bool blocking = true) {\n    ssize_t rc = ::write(taskWrite, &amp;taskPtr, sizeof(taskPtr));\n\n    // Failure handling\n    if (rc &lt; 0) {\n        // If blocking is allowed, wait for pipe to become available\n        int err = errno;\n        if ((errno == EAGAIN || errno == EWOULDBLOCK) &amp;&amp; blocking) {\n            fd_set fds;\n            FD_ZERO(&amp;fds);\n            FD_SET(taskWrite, &amp;fds);\n\n            ::pselect(1, nullptr, &amp;fds, nullptr, nullptr, nullptr);\n\n            // Try again\n            return write(tdata);\n        }\n\n        // Otherwise return false\n        return false;\n    }\n\n    return true;\n}\n\nvoid post(const std::function&lt;void(void)&gt;&amp; task) {\n    auto* taskPtr = new std::function&lt;void(void)&gt;(task);\n\n    if (std::this_thread::get_id() == workerId) {\n        // The worker thread gets 1st-class treatment.\n        // It won't be blocked if the pipe is full, instead\n        // using an overflow queue until the overflow has been cleared.\n        if (!overflowInUse) {\n            bool success = write(taskPtr, false);\n            if (!success) {\n                overflow.push(taskPtr);\n                overflowInUse = true;\n            }\n        } else {\n            overflow.push(taskPtr);\n        }\n    } else {\n        write(taskPtr);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10938, "user_id": 155082, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f1316ecb725006d020998e6b8a0740c?s=128&d=identicon&r=PG", "display_name": "Lothar", "link": "https://stackoverflow.com/users/155082/lothar"}, "is_accepted": false, "score": 0, "last_activity_date": 1615895938, "creation_date": 1615895938, "answer_id": 66654803, "question_id": 54451198, "link": "https://stackoverflow.com/questions/54451198/creating-a-dispatch-queue-thread-handler-in-c-with-pipes-fifos-overfilling/66654803#66654803", "title": "Creating a dispatch queue / thread handler in C++ with pipes: FIFOs overfilling", "body": "<p>If you only look at Android/Linux using a pipe is not start of the art but using a event file descriptor together with epoll is the way to go.</p>\n"}], "owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1706, "favorite_count": 1, "accepted_answer_id": 54518873, "answer_count": 4, "score": 2, "last_activity_date": 1615895938, "creation_date": 1548891319, "last_edit_date": 1548928974, "question_id": 54451198, "link": "https://stackoverflow.com/questions/54451198/creating-a-dispatch-queue-thread-handler-in-c-with-pipes-fifos-overfilling", "title": "Creating a dispatch queue / thread handler in C++ with pipes: FIFOs overfilling", "body": "<p>Threads are resource-heavy to create and use, so often a pool of threads will be reused for asynchronous tasks. A task is packaged up, and then \"posted\" to a broker that will enqueue the task on the next available thread.</p>\n\n<p>This is the idea behind dispatch queues (i.e. Apple's Grand Central Dispatch), and thread handlers (Android's Looper mechanism).</p>\n\n<p>Right now, I'm trying to roll my own. In fact, I'm plugging a gap in Android whereby there is an API for posting tasks in Java, but not in the native NDK. However, I'm keeping this question platform independent where I can.</p>\n\n<p>Pipes are the ideal choice for my scenario. I can easily poll the file descriptor of the read-end of a <a href=\"http://man7.org/linux/man-pages/man2/pipe.2.html\" rel=\"nofollow noreferrer\">pipe(2)</a> on my worker thread, and enqueue tasks from any other thread by writing to the write-end. Here's what that looks like:</p>\n\n<pre><code>int taskRead, taskWrite;\n\nvoid setup() {\n    // Create the pipe\n    int taskPipe[2];\n    ::pipe(taskPipe);\n    taskRead = taskPipe[0];\n    taskWrite = taskPipe[1];\n\n    // Set up a routine that is called when task_r reports new data\n    function_that_polls_file_descriptor(taskRead, []() {\n        // Read the callback data\n        std::function&lt;void(void)&gt;* taskPtr;\n        ::read(taskRead, &amp;taskPtr, sizeof(taskPtr));\n\n        // Run the task - this is unsafe! See below.\n        (*taskPtr)();\n\n        // Clean up\n        delete taskPtr;\n    });\n}\n\nvoid post(const std::function&lt;void(void)&gt;&amp; task) {\n    // Copy the function onto the heap\n    auto* taskPtr = new std::function&lt;void(void)&gt;(task);\n\n    // Write the pointer to the pipe - this may block if the FIFO is full!\n    ::write(taskWrite, &amp;taskPtr, sizeof(taskPtr));\n}\n</code></pre>\n\n<p>This code puts a <code>std::function</code> on the heap, and passes the pointer to the pipe. The <code>function_that_polls_file_descriptor</code> then calls the provided expression to read the pipe and execute the function. Note that there are no safety checks in this example.</p>\n\n<p>This works great 99% of the time, but there is one major drawback. Pipes have a limited size, and if the pipe is filled, then calls to <code>post()</code> will hang. This in itself is not unsafe, until a call to <code>post()</code> is made <em>within</em> a task.</p>\n\n<pre><code>auto evil = []() {\n    // Post a new task back onto the queue\n    post({});\n    // Not enough new tasks, let's make more!\n    for (int i = 0; i &lt; 3; i++) {\n        post({});\n    }\n\n    // Now for each time this task is posted, 4 more tasks will be added to the queue.\n});\n\npost(evil);\npost(evil);\n...\n</code></pre>\n\n<p>If this happens, then the worker thread will be blocked, waiting to write to the pipe. But the pipe's FIFO is full, and the worker thread is not reading anything from it, so the entire system is in deadlock.</p>\n\n<p>What can be done to ensure that calls to <code>post()</code> eminating from the worker thread <em>always</em> succeed, allowing the worker to continue processing the queue in the event it is full?</p>\n"}, {"tags": ["c++", "performance", "csv", "export-to-csv", "cfile"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1548891849, "post_id": 54451188, "comment_id": 95710954, "body": "<i>That means that for 327,680 input data integers, there are 2*327,680 = 655,360 file.write() calls.</i> -- Create a string consisting of all of that data and write the string once.  Memory is faster than disk (even though disk caching may be involved)."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1548892059, "post_id": 54451188, "comment_id": 95711018, "body": "<i>Also, I don&#39;t know what line 8 and line 9 are doing</i> -- What do you think those lines are doing?  What research have you done to figure out what those lines do?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1548892685, "post_id": 54451188, "comment_id": 95711156, "body": "<i>How could I improve the efficiency of my code?</i> Write less data. Consider creating a binary format because raw binary data is often much smaller than when represented in text. Plus you don&#39;t have to convert text &lt;-&gt; number all the time. Note byte order is a concern with binary data as is the variance in the size of integer data types. It is often quicker to read compressed data into memory, decompress it, and then use it than to read uncompressed raw data."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1548892781, "post_id": 54451188, "comment_id": 95711181, "body": "In short, since <code>CFile</code> seems to be unbuffered IO, write bigger chunks at a time (basically implement some sort of buffering). It doesn&#39;t need to be whole file at a time, but even writing chunks of say 16 values should net some visible improvement. Or one write per line... you get the idea. | You&#39;re using C++, so even though you have to write to <code>CFile</code>, nothing stops you from using c++ streams for the buffering..."}, {"owner": {"reputation": 5790, "user_id": 3258851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fUPld.jpg?s=128&g=1", "display_name": "Marc.2377", "link": "https://stackoverflow.com/users/3258851/marc-2377"}, "edited": false, "score": 0, "creation_date": 1548895672, "post_id": 54451188, "comment_id": 95711932, "body": "Hi, nice first question. Welcome."}, {"owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548895895, "post_id": 54451188, "comment_id": 95712000, "body": "@user4581301 Raw binary data is <i>sometimes</i> smaller. Good note on the compression!"}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "edited": false, "score": 0, "creation_date": 1548955533, "post_id": 54451188, "comment_id": 95739992, "body": "Do you all think I could increase the buffer and add data along with commas? Ex. &quot;345,3456,76,23,54,56&quot; and they write this whole thing to the file and then flush the buffer for next line? Is it possible?"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "edited": false, "score": 0, "creation_date": 1548955582, "post_id": 54451334, "comment_id": 95740019, "body": "I tired implementing your solution however, I just get 00000... on the first column for 512 rows. Here is the code implemented. \t\tchar buf[80]; \t\tchar buf1[1024];  \t\tUINT sz = mHeight * mWidth; \t\t \t\tstd::string line = &quot;&quot;; \t \t\twhile (int i &lt; sz) {  \t\t\tline += sprintf_s(buf, sizeof(buf), &quot;%d&quot;, pSrc[i]) + &#39;,&#39;; \t\t\ti++; \t\t\tif (i % mWidth == 0) \t\t\t{ \t\t\t\tconst char * charLine = line.c_str(); \t\t\t\tstrcpy(buf1, charLine); \t\t\t\tfile.Write(buf1, strlen(charLine)); \t\t\t\tfile.Write(&quot;\\r\\n&quot;, 2); \t\t\t\tstrcpy(buf1, &quot;&quot;); \t\t\t\tline = &quot;&quot;; \t\t\t} \t\t}"}], "tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1548957106, "last_edit_date": 1548957106, "creation_date": 1548892185, "answer_id": 54451334, "question_id": 54451188, "link": "https://stackoverflow.com/questions/54451188/how-to-make-c-code-faster-creating-csv-file-from-camera-data-using-cfile/54451334#54451334", "title": "How to make C++ code faster: Creating .csv file from camera data using CFile", "body": "<p>how about trying this\n use a string of a whole line size</p>\n\n<p>then at every iteration add your data to the buf and a comma(by concatenating the whole line to the buf) &amp; when you get to </p>\n\n<pre><code> if (i % mWidth == 0)\n</code></pre>\n\n<p>write the whole line to the CFile and clear you buf using </p>\n\n<p>something like this</p>\n\n<pre><code>UINT sz = mHeight * mWidth; std::string line = \"\";\nwhile (int i &lt; sz) { line += std::to_string(pSrc[i])) + ','; i++;\nif (i % mWidth == 0) { \nfile.Write(line.c_str(), line.size()); \nfile.Write(\"\\r\\n\", 2); \nline = \"\"; } }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "is_accepted": true, "score": 1, "last_activity_date": 1550683865, "creation_date": 1550683865, "answer_id": 54792185, "question_id": 54451188, "link": "https://stackoverflow.com/questions/54451188/how-to-make-c-code-faster-creating-csv-file-from-camera-data-using-cfile/54792185#54792185", "title": "How to make C++ code faster: Creating .csv file from camera data using CFile", "body": "<p>Just Figured it out! Below is the implementation that seemed to get the job done. </p>\n\n<pre><code>int sz = mHeight * mWidth;\n\nstd::string uniqueCSV = \"Frame \" + to_string(miCurrentCSVImage + 1) + \".csv\";\nstd::string file = capFile + \"/\" + uniqueCSV;\nstd::ofstream out;\nout.open(file);\n\nstd::string data = \"\";\n\nint i = 0;\nwhile (i &lt; sz) {\n    data += to_string(pSrc[i]);\n    i++;\n    if (i &lt; sz)\n        data += \",\";\n    if (i % mWidth == 0)\n        data += \"\\n\";\n}\n\nout &lt;&lt; data;\nout.close();\nmiCurrentCSVImage++;\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 54792185, "answer_count": 2, "score": 3, "last_activity_date": 1550683865, "creation_date": 1548891287, "last_edit_date": 1548895412, "question_id": 54451188, "link": "https://stackoverflow.com/questions/54451188/how-to-make-c-code-faster-creating-csv-file-from-camera-data-using-cfile", "title": "How to make C++ code faster: Creating .csv file from camera data using CFile", "body": "<p>A high level overview is that 'CFile file's 'file.write()' method gets called for every individual integer data value (line 9) along with line 12, where I write a comma to file.</p>\n\n<p>That means that for 327,680 input data integers, there are 2*327,680 = 655,360 file.write() calls. The code is very slow because of this and as a result, the code takes 3 seconds to create one csv file. How could I improve the efficiency of my code?</p>\n\n<p>Note: I cannot change any declarations of the code. I must use CFile. Also, pSrc is of type uint_16_t and is containing the data that I want to store in the .csv file. The data ranges from 0 - 3000 integer values.</p>\n\n<pre><code>1           CFile file;\n2           int mWidth = 512;\n3           int mHeight = 640;\n4           UINT i = 0;\n5           char buf[80];\n6           UINT sz = mHeight * mWidth; //sz = 327,680\n7           while (i &lt; sz) {\n8                  sprintf_s(buf, sizeof(buf), \"%d\", pSrc[i]); \n9                  file.Write(buf, strlen(buf));\n10                 i++;\n11                 if (i &lt; sz)  \n12                        file.Write(\",\", 1);\n13                 if (i % mWidth == 0) \n14                        file.Write(\"\\r\\n\", 2);\n15  }\n</code></pre>\n\n<p>All values are outputted in the 640x512 .csv file containing integers representing degrees Celcius.</p>\n"}, {"tags": ["c++", "file", "double", "ifstream"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1548889290, "post_id": 54450861, "comment_id": 95710300, "body": "<a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\"><code>while(file.eof() == false)</code></a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548889346, "post_id": 54450861, "comment_id": 95710321, "body": "<a href=\"https://stackoverflow.com/a/7868998/4581301\">Option 2 of this answer should give you some inspiration.</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1548890910, "post_id": 54450861, "comment_id": 95710726, "body": "Getting back to this, do you need those numbers for anything later? If not you don&#39;t have to store them. You can sum them up as you read them and toss the sum into a vector (assuming you need those sums later and can&#39;t simply print them out immediately and then forget them)."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1548891382, "post_id": 54450861, "comment_id": 95710840, "body": "You can <code>#include &lt;numeric&gt;</code> and use <code>double sum = accumulate (nbres.begin(), nbres.end(), 0)</code> to compute the sum of each row rather conveniently after filling <code>nbres</code> from each row."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1548910184, "creation_date": 1548910184, "answer_id": 54453478, "question_id": 54450861, "link": "https://stackoverflow.com/questions/54450861/read-rows-of-numbers-from-txt-file-in-c/54453478#54453478", "title": "Read rows of numbers from txt file in C++", "body": "<p>If I understand your questions, and if you are still stuck, the overview of the process would simply be filling a <code>vector</code> with the top <code>n</code> sums (default: 3) computed from each line of values within a file. You want the value in descending order.</p>\n\n<p>Whenever you need to get an unknown number of values from a line within a file (regardless whether the values are delimited by commas, or spaces, etc..), your approach should be to read an entire line of data into a <code>string</code>, creating a <code>stringsteam</code> from the line, and then looping inputting values from the <code>stringstream</code> until <code>EOF</code> is encountered on the <code>stringstream</code>.</p>\n\n<p>Why a <code>stringstream</code> and not just read values directly from the file? (Answer: line-control). Since <code>cin</code> discards leading whitespace, and <code>'\\n'</code> (the newline) is whitespace, there is no way to determine when you reach the end of a line reading directly from the file. By reading the line first and then creating a <code>stringstream</code>, you can simply read until you reach the end of the <code>stringstream</code> you have created -- and you have input all the values in a single line.</p>\n\n<p>The only <code>vector</code> you need to maintain throughout your code is the vector of sums in decreasing order. When reading each of the values from the <code>stringstream</code> you create, you can simply use a temporary vector for purposed of storing each of the values in a given line and then call <code>accumulate</code> on the temporary vector to provide the sum.</p>\n\n<p>The challenge is maintaining the top X number of sums in your final results vector to output at the end of the program. The approach there is actually fairly straight-forward. If the sum is the first sum, just use <code>push_back()</code> to store it. For all subsequent sums, use an iterator to traverse the vector comparing what is already stored against the current sum until the sum is greater than the element of the vector and then call the <code>.insert()</code> method to insert the current sum in your results vector before the element referenced by the iterator.</p>\n\n<p>When you are done, simply output the results vector using an auto-ranged <code>for</code> loop.</p>\n\n<p>There are many different ways to approach it, but sticking to what is above, you could do something like the following. The code is commented to help walk you through it:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;numeric&gt;  /* for accumulate */\n\nint main (int argc, char **argv) {\n\n    if (argc &lt; 2) {     /* validate at least filename given */\n        std::cerr &lt;&lt; \"error: insufficient arguments\\n\"\n                \"usage: \" &lt;&lt; argv[0] &lt;&lt; \" filename (nresults: 3)\\n\";\n        return 1;\n    }\n\n    std::string filename = argv[1],     /* string for filename */\n                line;                   /* string to hold line */\n    std::vector&lt;int&gt; results;           /* vector of results */\n    std::ifstream f;                    /* input file stream */\n    size_t nresults = 3, n = 0;         /* num of results, countner */\n\n    if (argc &gt;= 3)  /* if addition arg given, set nresults */\n        nresults = std::stoi(argv[2]);\n\n    f.open (filename);      /* open filename */\n    if (! f.is_open()) {    /* validate file open for reading */\n        perror ((\"error file open failed \" + filename).c_str());\n        return 1;\n    }\n\n    while (std::getline (f, line)) {    /* read each row of values */\n        int val, sum;                   /* current value, line sum */\n        std::vector&lt;int&gt; v;             /* vector to hold values */\n        std::stringstream s (line);     /* create stringstream from line */\n        while ((s &gt;&gt; val))              /* read each value */\n            v.push_back (val);          /* add it to vector v */\n        sum = accumulate (v.begin(), v.end(), 0);   /* sum values in v */\n        if (results.empty())            /* if empty */\n            results.push_back (sum);    /* just add */\n        else    /* otherwise insert in decreasing order */\n            for (auto it = results.begin(); it != results.end(); it++)\n                if (sum &gt; *it) {\n                    results.insert (it, sum);\n                    break;\n                }\n        if (results.size() &gt; nresults)  /* trim excess elements */\n            results.pop_back();\n        n++;                            /* increment line count */\n    }\n    /* output results */\n    std::cout &lt;&lt; nresults &lt;&lt; \" greatest sums from \" &lt;&lt; n &lt;&lt; \" lines in \" &lt;&lt; \n                filename &lt;&lt; '\\n';\n    for (auto&amp; p : results)\n        std::cout &lt;&lt; \" \" &lt;&lt; p;\n    std::cout &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the code expects the filename as the 1st argument, and then takes an optional argument of the number of top sums to report -- using a default of <code>3</code>)</p>\n\n<p><strong>Example Input File</strong></p>\n\n<p>The following input was simply produced by writing 50 lines containing 5 random values between <code>0 - 999</code>:</p>\n\n<pre><code>$ cat dat/50x5.txt\n 106 114 604 482 340\n 815 510 690 228 291\n 250 341 774 224 545\n 174 546 537 278 71\n 706 139 767 320 948\n 328 683 410 401 123\n 140 507 238 744 990\n 810 559 732 732 20\n 24 982 361 30 439\n 139 204 217 676 714\n 288 615 853 287 935\n 801 847 851 211 249\n 206 583 756 676 328\n 978 486 119 711 219\n 139 967 433 733 997\n 872 104 433 89 12\n 147 609 627 0 897\n 795 34 744 878 477\n 225 84 61 982 761\n 621 960 479 740 903\n 930 112 870 364 77\n 99 468 181 532 790\n 193 911 399 53 912\n 296 80 178 273 958\n 887 498 274 180 712\n 267 801 905 747 774\n 40 677 118 911 273\n 195 242 974 376 775\n 764 801 686 163 854\n 830 692 166 240 197\n 124 128 927 399 540\n 640 898 342 777 645\n 348 817 555 466 960\n 60 661 203 34 269\n 978 798 302 896 194\n 389 959 886 555 199\n 83 680 559 10 311\n 100 882 209 442 659\n 87 22 709 874 488\n 669 934 381 104 969\n 650 314 999 952 211\n 193 341 170 79 129\n 601 394 809 161 637\n 352 261 519 793 935\n 411 112 957 352 986\n 677 21 153 58 358\n 122 708 672 353 892\n 883 547 466 285 858\n 595 887 253 636 48\n 122 220 541 641 245\n</code></pre>\n\n<p>If you want to validate the sums, you can use a short <code>awk</code> script<sup><strong>[1]</strong></sup>.</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/vector_n_greatest dat/50x5.txt\n3 greatest sums from 50 lines in dat/50x5.txt\n 3703 3494 3302\n\n$ ./bin/vector_n_greatest dat/50x5.txt 4\n4 greatest sums from 50 lines in dat/50x5.txt\n 3703 3494 3302 3269\n\n$ ./bin/vector_n_greatest dat/50x5.txt 10\n10 greatest sums from 50 lines in dat/50x5.txt\n 3703 3494 3302 3269 3268 3168 3146 3126 3057 3039\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n\n<p><strong>footnotes:</strong></p>\n\n<p><strong>(1.)</strong> to output the sorted line sums for verification, you can use a short <code>awk</code> script and <code>sort</code>, e.g.</p>\n\n<pre><code>awk '{\n    sum = 0\n    for (i=1; i&lt;=NF; i++)\n        sum += $i\n    printf \"%-20s (%4d)\\n\", $0, sum\n}' file | sort -r -b -k6.2\n</code></pre>\n\n<p>The <code>awk</code> output would for the example file would show:</p>\n\n<pre><code>$ awk '{\n&gt;     sum = 0\n&gt;     for (i=1; i&lt;=NF; i++)\n&gt;         sum += $i\n&gt;     printf \"%-20s (%4d)\\n\", $0, sum\n&gt; }' dat/50x5.txt | sort -r -b -k6.2\n 621 960 479 740 903 (3703)\n 267 801 905 747 774 (3494)\n 640 898 342 777 645 (3302)\n 139 967 433 733 997 (3269)\n 764 801 686 163 854 (3268)\n 978 798 302 896 194 (3168)\n 348 817 555 466 960 (3146)\n 650 314 999 952 211 (3126)\n 669 934 381 104 969 (3057)\n 883 547 466 285 858 (3039)\n 389 959 886 555 199 (2988)\n ...\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9613455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DTHkXeLEnqY/AAAAAAAAAAI/AAAAAAAAJLg/AK7Kz7Kmd44/photo.jpg?sz=128", "display_name": "damnitmat", "link": "https://stackoverflow.com/users/9613455/damnitmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2356, "favorite_count": 0, "accepted_answer_id": 54453478, "answer_count": 1, "score": 1, "last_activity_date": 1548910184, "creation_date": 1548889210, "question_id": 54450861, "link": "https://stackoverflow.com/questions/54450861/read-rows-of-numbers-from-txt-file-in-c", "title": "Read rows of numbers from txt file in C++", "body": "<p>Good morning guys,</p>\n\n<p>I have an assignment for school and I hoped you could help me on this one.\nThe goal of the program is very simple. Calculate the sum of the numbers\non each line of the file, and display on the screen the N highest distinct results in decreasing rorder, with N the number of occurrences for each result, N being supplied as a parameter by the user (default value = 3).\nSo as the title says i'm working in C++, and my program has to read rows of numbers (double) from a txt file provided. I already know the concept ot ifsream types, and managed to open the file. I know that I can use the >> operator to read from the file, but the number of doubles per row is not fixed, so i can't make a simple loop. Here is how it looks so far on my side :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nint main(){\n\n    int nbresult=3;\n    string filename;\n    double tmp;\n\n    cin &gt;&gt; filename;\n    cin &gt;&gt; nbresult;\n\n    ifstream file;\n    file.open(filename.c_str());\n\n    if(file.is_open())\n    {\n        cout &lt;&lt; \"Opening file: \" &lt;&lt; filename &lt;&lt; endl;\n\n        while(file.eof() == false)\n        {\n            vector&lt;double&gt; nbres;\n            file &gt;&gt; tmp;\n            nbres.push_back(tmp);\n        }\n\n        fichier.close();\n    }\n    else \n    {\n        cout &lt;&lt; \"Erreur \u00e0 l'ouverture !\" &lt;&lt; endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>So my idea was putting the numbers in a vector and summing up, but I've realized that I would need to create an instance of vector for each row. Plus, my reading method wouldn't allow me to create multiple vectors because it reads without acknowledging the fact that the numbers are in different rows.</p>\n\n<p>Can you guy guide me to an efficient solution ? I'm really starting to loose it lol.</p>\n\n<p>Thanks in advance !\nmatt</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 560, "user_id": 10850601, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3R2h7RDJ9yU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYNkQa9HPTd778Jo28o4mlsEFPJpw/mo/photo.jpg?sz=128", "display_name": "Ed Grimm", "link": "https://stackoverflow.com/users/10850601/ed-grimm"}, "edited": false, "score": 0, "creation_date": 1548888337, "post_id": 54450673, "comment_id": 95710016, "body": "You should copy-paste the exact compilation instruction you do and the exact error you get, because it could be different for other people with different compilers or who use different compiler options."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1548888394, "post_id": 54450673, "comment_id": 95710039, "body": "Mark those four <code>int</code> variables as <code>const int</code>."}, {"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1548888753, "post_id": 54450673, "comment_id": 95710148, "body": "@PeteBecker solved it, thanks"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548888787, "post_id": 54450673, "comment_id": 95710163, "body": "<code>I understand that the size of an array on the heap must be known during compile time</code> This array is on the stack."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548889122, "post_id": 54450673, "comment_id": 95710253, "body": "@tkausl \u2014 and it\u2019s arrays on the <b>stack</b> that have to have their size known at compile time."}, {"owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "edited": false, "score": 1, "creation_date": 1548910168, "post_id": 54450673, "comment_id": 95715214, "body": "If you are using c++11, you should opt for <code>constexpr</code>"}, {"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "reply_to_user": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "edited": false, "score": 0, "creation_date": 1548931195, "post_id": 54450673, "comment_id": 95725253, "body": "To those saying its on the stack, of course you&#39;re right. My mistake. @TheoWalton I will look into it, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "edited": false, "score": 0, "creation_date": 1548931318, "post_id": 54450761, "comment_id": 95725332, "body": "Although this answer is extremely helpful and I will do what you suggested, it is not the answer to my question so I can&#39;t accept it, but take my upvote."}], "tags": [], "owner": {"reputation": 1229, "user_id": 9226753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28247b27eef49240c767833514e2ab50?s=128&d=identicon&r=PG&f=1", "display_name": "kanstar", "link": "https://stackoverflow.com/users/9226753/kanstar"}, "is_accepted": false, "score": 5, "last_activity_date": 1548888668, "creation_date": 1548888668, "answer_id": 54450761, "question_id": 54450673, "link": "https://stackoverflow.com/questions/54450673/variable-sized-object-may-not-be-initialized-error-despite-initialization/54450761#54450761", "title": "Variable-sized object may not be initialized Error despite initialization", "body": "<p>Just use <code>std::vector</code> instead.</p>\n\n<pre><code>#include &lt;vector&gt;\n\nint main(){\n    int sample_rate = 50;\n\n    int t_max = 60*5 ;\n\n    int dimensions = 3;\n    int num_samples = sample_rate * t_max;\n\n    std::vector&lt;std::vector&lt;double&gt;&gt; data(dimensions, std::vector&lt;double&gt;(num_samples));\n    // access data like this\n    data[0][0];\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 3, "last_activity_date": 1548912619, "creation_date": 1548912619, "answer_id": 54453892, "question_id": 54450673, "link": "https://stackoverflow.com/questions/54450673/variable-sized-object-may-not-be-initialized-error-despite-initialization/54453892#54453892", "title": "Variable-sized object may not be initialized Error despite initialization", "body": "<p>The bound (size) of an array when it is specified has to be a constant-expression as per <a href=\"https://timsong-cpp.github.io/cppwp/n4659/dcl.array#1\" rel=\"nofollow noreferrer\">[dcl.array]/1</a>.<br>\nThe bounds you have specified are not constant expressions. To convert them into such, you either have to prepend <code>const</code> or <code>constexpr</code> (C++11 onward) before the declaration of those four integers like this:</p>\n\n<pre><code>const int sample_rate = 50;\n</code></pre>\n\n<p>Or  </p>\n\n<pre><code>constexpr int sample_rate = 50;\n</code></pre>\n"}], "owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 54453892, "answer_count": 2, "score": 4, "last_activity_date": 1548912619, "creation_date": 1548888156, "question_id": 54450673, "link": "https://stackoverflow.com/questions/54450673/variable-sized-object-may-not-be-initialized-error-despite-initialization", "title": "Variable-sized object may not be initialized Error despite initialization", "body": "<pre><code>int main(){\n    int sample_rate = 50;\n\n    int t_max = 60*5 ;\n\n    int dimensions = 3;\n    int num_samples = sample_rate * t_max;\n\n    double data[dimensions][num_samples] = { { } }; //Error here\n    return 0;\n}\n</code></pre>\n\n<p>I understand that the size of an array on the heap must be known during compile time which it is here (3 x 15000). Why am I still getting the error? </p>\n"}, {"tags": ["c++", "list", "sorting", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 0, "creation_date": 1548887550, "post_id": 54450543, "comment_id": 95709759, "body": "side note : srand(time(NULL)); this initialization  should be at the beginning of your program not inside some loop"}, {"owner": {"reputation": 196, "user_id": 10976662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02f395a79e4df14aaa6c9582eff1d63?s=128&d=identicon&r=PG&f=1", "display_name": "KWierzbicki", "link": "https://stackoverflow.com/users/10976662/kwierzbicki"}, "edited": false, "score": 0, "creation_date": 1548887775, "post_id": 54450543, "comment_id": 95709838, "body": "Side note: this line <code>while (n&lt;2);</code> is an infinite loop if the condition is met"}, {"owner": {"reputation": 5, "user_id": 9621778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf62ba7ce0059b6729065ee93449eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Matt17BR", "link": "https://stackoverflow.com/users/9621778/matt17br"}, "reply_to_user": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 0, "creation_date": 1548887783, "post_id": 54450543, "comment_id": 95709841, "body": "@Spinkoo ah yes, I forgot to mention that unless I put srand(time(NULL)); in a loop the program crashes, that incldues putting srand right after int main() {, which makes me think my code has a few others underlying problems I might not be seeing"}, {"owner": {"reputation": 5, "user_id": 9621778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf62ba7ce0059b6729065ee93449eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Matt17BR", "link": "https://stackoverflow.com/users/9621778/matt17br"}, "reply_to_user": {"reputation": 196, "user_id": 10976662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02f395a79e4df14aaa6c9582eff1d63?s=128&d=identicon&r=PG&f=1", "display_name": "KWierzbicki", "link": "https://stackoverflow.com/users/10976662/kwierzbicki"}, "edited": false, "score": 0, "creation_date": 1548887856, "post_id": 54450543, "comment_id": 95709864, "body": "@KWierzbicki it&#39;s part of the do while that checks whether the user has inserted more than or equal to 2 elements in the list, or am I missing something?"}, {"owner": {"reputation": 196, "user_id": 10976662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02f395a79e4df14aaa6c9582eff1d63?s=128&d=identicon&r=PG&f=1", "display_name": "KWierzbicki", "link": "https://stackoverflow.com/users/10976662/kwierzbicki"}, "edited": false, "score": 0, "creation_date": 1548887939, "post_id": 54450543, "comment_id": 95709888, "body": "@Matt17BR Oh, yes you&#39;re totally right, the formating misled me"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1548889011, "post_id": 54450543, "comment_id": 95710227, "body": "The best way to navigate a linked list assignment is to draw a lot of pictures to help you visualize the problem. Once you have pictures that make sense to use as a baseline, execute your code on paper instruction by instruction to attempt to draw the same list. If you can&#39;t, you found a bug and since you have a picture of what you should have drawn, you probably stopped yourself as soon as you started drawing the wrong thing and know where the bug is and what you need to do instead. Victory is likely yours at that point."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1548889213, "post_id": 54450543, "comment_id": 95710276, "body": "If not, drop your program into the debugger that should have come with your development environment. If you don&#39;t have a debugger, claw your way up into the 1980s and get a development environment with a debugger. With the debugger you can control the execution of your program, advancing instruction by instruction if you have to. When the program does something unexpected, you just found a bug. Inspect the variables involved to see why it happened. Backtrack if you have to to find out why any variables were wrong."}, {"owner": {"reputation": 5, "user_id": 9621778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf62ba7ce0059b6729065ee93449eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Matt17BR", "link": "https://stackoverflow.com/users/9621778/matt17br"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548892171, "post_id": 54450543, "comment_id": 95711043, "body": "@user4581301 that&#39;s a couple of great tips, I&#39;ve actually tried drawing similar programs with pen and paper before but I find I just lose focus at some point. Guess I should just try harder if I get stuck again :)"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9621778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf62ba7ce0059b6729065ee93449eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Matt17BR", "link": "https://stackoverflow.com/users/9621778/matt17br"}, "edited": false, "score": 0, "creation_date": 1548892035, "post_id": 54451142, "comment_id": 95711009, "body": "Can&#39;t thank you enough, that truly helps me understand what I wasn&#39;t doing correctly!"}], "tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": true, "score": 0, "last_activity_date": 1548890959, "creation_date": 1548890959, "answer_id": 54451142, "question_id": 54450543, "link": "https://stackoverflow.com/questions/54450543/inserting-a-new-node-in-a-singly-linked-list-while-maintaining-the-sorting/54451142#54451142", "title": "Inserting a new node in a singly-linked list while maintaining the sorting", "body": "<p>i've commented the parts i changed :) </p>\n\n<pre><code>int main() {\n    int n; // as mentioned in top srand initialized at the begining \n    srand(time(NULL));\n\n    do {\n        cout &lt;&lt; \"Insert the amount of elements in your list: \";\n        cin &gt;&gt; n;\n        if (n &lt; 2) {\n            cout &lt;&lt; \"The list needs to contain at least 2 nodes.\" &lt;&lt; endl;\n        }\n    } while (n &lt; 2);\n    for (int i = 0;i &lt; n;i++) {\n        sortedinsert();\n    }\n    printlist();\n}\n\nvoid sortedinsert() {\n    int gen = rand() % 101;\n    nodenew = new node;\n    nodenew-&gt;num = gen;\n    nodenew-&gt;next = NULL;\n    // split the top part\n    if (top == NULL) {\n\n        top = nodenew;\n        return;\n    }\n    if( top-&gt;num &gt;= gen) {\n        nodenew-&gt;next = top;\n        top = nodenew;\n        return;\n    }\n\n    else if (top-&gt;next != NULL and top-&gt;next-&gt;num &gt;= gen) {\n        node *temp = top-&gt;next;\n        nodenew-&gt;next = temp;\n        top-&gt;next = nodenew;\n        return;\n    }\n    else {\n        // left was uninitialized so if it doesn't go into the loop you are going to call left-&gt;next  Undefined behavior\n       //right-&gt;next-&gt;num&lt;=gen you don't test this until you test right-&gt;next is not null otherwise Undefined behavior as well\n        node *left=top;\n        node *right = top-&gt;next;\n\n        while (right != NULL and right-&gt;num &lt;= gen) {\n            left = right;\n            right = right-&gt;next;\n        }       \n\n\n            left-&gt;next = nodenew;\n            nodenew-&gt;next = right;\n\n\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10974796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77a9ddb3013d6e5da67bfd8e44a2d364?s=128&d=identicon&r=PG&f=1", "display_name": "D.Badreddine", "link": "https://stackoverflow.com/users/10974796/d-badreddine"}, "is_accepted": false, "score": 0, "last_activity_date": 1548891690, "creation_date": 1548891690, "answer_id": 54451259, "question_id": 54450543, "link": "https://stackoverflow.com/questions/54450543/inserting-a-new-node-in-a-singly-linked-list-while-maintaining-the-sorting/54451259#54451259", "title": "Inserting a new node in a singly-linked list while maintaining the sorting", "body": "<p>In fact srand(time(NULL)) you must declare it before for loop because like that it gives the same number .\nAnd you have a problem when inserting a newnode .</p>\n\n<p>And here i have corrected your code and it works well :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\nusing namespace std;\n\nstruct node {\n    int num;\n    node *next;\n};\nnode *top = NULL, *nodenew;\n\nvoid sortedinsert();\nvoid printlist();\n\nint main() {\n    int n;\n\n    do {\n        cout &lt;&lt; \"Insert the amount of elements in your list: \";\n        cin &gt;&gt; n;\n        if (n&lt;2) {\n            cout &lt;&lt; \"The list needs to contain at least 2 nodes.\" &lt;&lt; endl;\n        }\n    } while (n&lt;2);\n\n    srand(time(NULL));\n    for (int i = 0; i&lt;n; i++) {\n\n\n        sortedinsert();\n    }\n    printlist();\n\n    system(\"pause\");\n}\n\nvoid sortedinsert() {\n\n\n    int gen = rand() % 101;\n    cout &lt;&lt; gen &lt;&lt; endl;\n    nodenew = new node;\n    nodenew-&gt;num = gen;\n    nodenew-&gt;next = NULL;\n    if (top == NULL || top-&gt;num &gt;= gen) {\n        nodenew-&gt;next = top;\n        top = nodenew;\n\n    }\n    else\n    {\n        node *A = top;\n        node *B = top-&gt;next;\n        while (B != NULL)\n        {\n            if (B-&gt;num &gt; gen)\n            {\n                nodenew-&gt;next = B;\n                A-&gt;next = nodenew;\n                return;\n            }\n            else\n            {\n\n                A = B;\n                B = B-&gt;next;\n            }\n        }\n        A-&gt;next = nodenew;\n        nodenew-&gt;next = NULL;\n        return;\n    }\n}\nvoid printlist() {\n    cout &lt;&lt; \"The sorted list is shown below: \" &lt;&lt; endl;\n    nodenew = top;\n\n    for (nodenew = top; nodenew != NULL; nodenew = nodenew-&gt;next) {\n        cout &lt;&lt; nodenew-&gt;num &lt;&lt; endl;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 736, "user_id": 10553472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OVn8a.jpg?s=128&g=1", "display_name": "Derek C.", "link": "https://stackoverflow.com/users/10553472/derek-c"}, "edited": false, "score": 0, "creation_date": 1588032897, "post_id": 61467774, "comment_id": 108738969, "body": "The question being asked is written in C++, it would be reasonable to assume (as there is no indication otherwise) that this needs to be done in C++. Answering in Python is not helpful in this situation."}], "tags": [], "owner": {"reputation": 7, "user_id": 12653698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1a77f1a7ed75286c86adf72932b7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Arya A.", "link": "https://stackoverflow.com/users/12653698/arya-a"}, "is_accepted": false, "score": -1, "last_activity_date": 1588018808, "creation_date": 1588018808, "answer_id": 61467774, "question_id": 54450543, "link": "https://stackoverflow.com/questions/54450543/inserting-a-new-node-in-a-singly-linked-list-while-maintaining-the-sorting/61467774#61467774", "title": "Inserting a new node in a singly-linked list while maintaining the sorting", "body": "<p>You can use the Python code as shown below . The benefits you will have with Python is :</p>\n\n<p>--> It is now used in many industries , and will help you when you explore the regions of Data Science and Machine Learning.</p>\n\n<p>--> It is as easy as implementing pseudocode .</p>\n\n<p>I have shown you the python method for inserting a node into a sorted Doubly linked list , try to get Dry-Run the code and obtain the logic , then use the same to derive code for Singly Linked list .</p>\n\n<pre><code>def sortedInsert(head, data):\nnode = DoublyLinkedListNode(data)\nstatus = 0\nif not data&gt;head.data:\n    node.prev=head.prev\n    head.prev=node\n    node.next=head\n    head=node\nelse:\n    dup = head\n    while(data&gt;dup.data):\n        if not dup.next:\n            status = 1\n            break\n        else:\n            dup = dup.next\n    if status:\n        node.prev = dup\n        node.next = dup.next\n        dup.next = node\n    else:\n        node.prev = dup.prev\n        dup.prev.next = node\n        node.next = dup\n        dup.prev = node\nreturn head\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9621778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf62ba7ce0059b6729065ee93449eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Matt17BR", "link": "https://stackoverflow.com/users/9621778/matt17br"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54451142, "answer_count": 3, "score": 0, "last_activity_date": 1588018808, "creation_date": 1548887401, "last_edit_date": 1548888218, "question_id": 54450543, "link": "https://stackoverflow.com/questions/54450543/inserting-a-new-node-in-a-singly-linked-list-while-maintaining-the-sorting", "title": "Inserting a new node in a singly-linked list while maintaining the sorting", "body": "<p>I'm very much a noob and I'm struggling to correctly implement the insertion of a new node in a singly-linked list. I've tried some of the more easy-to-understand solutions from both here and other sites and the problem is definitely in my brain, but I just can't manage to get this right.</p>\n\n<p>So what I have is this linked list made up of n nodes (where n is given as an input by the user) where I'm trying to insert randomised numbers from 0 to 100 in increasing order and I'm then printing the content of the list. </p>\n\n<p>I think my code is not quite right at all though because the output I get is just the same number over and over, but besides that if I change the code to allow the user to input the numbers instead of generating them randomly, the program crashes if I input two different numbers (it works ok if I input the same number over and over). EDIT: Furthermore, unless srand(time(NULL)); is written inside a loop, the program will compile but crash once I input the amount of elements in my list. </p>\n\n<p>I really can't understand what I'm doing wrong though.</p>\n\n<p>The code looks like this:</p>\n\n<pre><code>/*The program inserts n elements generated randomly in a linked list sorted increasingly, and prints the result.*/\n\n#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\nusing namespace std;\n\nstruct node {\n    int num;\n    node *next;\n};\nnode *top=NULL,*nodenew;\n\nvoid sortedinsert();\nvoid printlist();\n\nint main() {\n    int n;\n    do {\n        cout&lt;&lt;\"Insert the amount of elements in your list: \";\n        cin&gt;&gt;n;\n        if (n&lt;2) {\n            cout&lt;&lt;\"The list needs to contain at least 2 nodes.\"&lt;&lt;endl;\n        }\n    }\n    while (n&lt;2);\n    for (int i=0;i&lt;n;i++) {\n        srand(time(NULL));\n        sortedinsert();\n    }\n    printlist();\n}\n\nvoid sortedinsert() {\n    int gen=rand()%101;\n    nodenew=new node;\n    nodenew-&gt;num=gen;\n    nodenew-&gt;next=NULL;\n    if (top==NULL or top-&gt;num&gt;=gen) {\n        nodenew-&gt;next=top;\n        top=nodenew;\n        return;\n    }\n    else if (top-&gt;next!=NULL and top-&gt;next-&gt;num&gt;=gen){\n        node *temp=top-&gt;next;\n        nodenew-&gt;next=temp;\n        top-&gt;next=nodenew;\n        return;\n    }\n    else {\n        node *left;\n        node *right=top;\n        while (right!=NULL and right-&gt;next-&gt;num&lt;=gen) {\n            left=right;\n            right=right-&gt;next;\n        }\n        left-&gt;next=nodenew;\n        nodenew-&gt;next=right;\n    }\n}\nvoid printlist() {\n    cout&lt;&lt;\"The sorted list is shown below: \"&lt;&lt;endl;\n    for (nodenew=top;nodenew!=NULL;nodenew=nodenew-&gt;next) {\n        cout&lt;&lt;nodenew-&gt;num&lt;&lt;endl;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 196, "user_id": 10976662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02f395a79e4df14aaa6c9582eff1d63?s=128&d=identicon&r=PG&f=1", "display_name": "KWierzbicki", "link": "https://stackoverflow.com/users/10976662/kwierzbicki"}, "edited": false, "score": 2, "creation_date": 1548887135, "post_id": 54450452, "comment_id": 95709586, "body": "Floating point numbers like these of type <code>double</code> are not infinitely precise due to how they are stored in memory, thats why you may get eg. 0.149999998 instead of 0.15."}, {"owner": {"reputation": 1, "user_id": 10992888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-daMftvKgzyg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMhXbJmh97OGYmzLz84vK3gNqzCdw/mo/photo.jpg?sz=128", "display_name": "Matt S", "link": "https://stackoverflow.com/users/10992888/matt-s"}, "reply_to_user": {"reputation": 196, "user_id": 10976662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02f395a79e4df14aaa6c9582eff1d63?s=128&d=identicon&r=PG&f=1", "display_name": "KWierzbicki", "link": "https://stackoverflow.com/users/10976662/kwierzbicki"}, "edited": false, "score": 0, "creation_date": 1548888024, "post_id": 54450452, "comment_id": 95709908, "body": "that makes a lot of sense as they are not binary relatable as I am finding out."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1548892157, "post_id": 54450452, "comment_id": 95711040, "body": "Another option is to use binary coded decimal (BCD) numbers, which can represent fixed-point numbers in decimal exactly.  But for many platforms, they are not the popular choice.  At the risk of being mistaken... Standard C++ does not come with BCD support, but there are third party BCD libraries for C and C++ available."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10992888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-daMftvKgzyg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMhXbJmh97OGYmzLz84vK3gNqzCdw/mo/photo.jpg?sz=128", "display_name": "Matt S", "link": "https://stackoverflow.com/users/10992888/matt-s"}, "edited": false, "score": 0, "creation_date": 1548887771, "post_id": 54450556, "comment_id": 95709836, "body": "that fixed it!  Thank you!"}], "tags": [], "owner": {"reputation": 196, "user_id": 10976662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02f395a79e4df14aaa6c9582eff1d63?s=128&d=identicon&r=PG&f=1", "display_name": "KWierzbicki", "link": "https://stackoverflow.com/users/10976662/kwierzbicki"}, "is_accepted": false, "score": 1, "last_activity_date": 1548887449, "creation_date": 1548887449, "answer_id": 54450556, "question_id": 54450452, "link": "https://stackoverflow.com/questions/54450452/rounding-issue-with-typecastint/54450556#54450556", "title": "rounding issue with typecast&lt;int&gt;", "body": "<p>The easiest way to get rid of this issue would be to use <code>std::round</code> before casting to int:</p>\n\n<pre><code>static_cast&lt;int&gt;(std::round(TIP_PERCENTAGE * 100.0))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10992888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-daMftvKgzyg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMhXbJmh97OGYmzLz84vK3gNqzCdw/mo/photo.jpg?sz=128", "display_name": "Matt S", "link": "https://stackoverflow.com/users/10992888/matt-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548887449, "creation_date": 1548886946, "question_id": 54450452, "link": "https://stackoverflow.com/questions/54450452/rounding-issue-with-typecastint", "title": "rounding issue with typecast&lt;int&gt;", "body": "<p>I am having an issue with a typecast conversion when calculating the tip amount. </p>\n\n<pre><code>const double TIP_PERCENTAGE = .15;\n\ncout &lt;&lt; static_cast&lt;int&gt;(TIP_PERCENTAGE * 100.00);\n\nreturn 0;\n</code></pre>\n\n<p>I  am getting 14 instead of .15 x 100 = 15 and then converted into an int of 15. I can tell that it is truncating the answer, but I'm not sure why or how it's getting a value less than 15 such as 14.999 etc.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 7, "creation_date": 1548885564, "post_id": 54450153, "comment_id": 95709066, "body": "Is there some reason you can&#39;t use <code>std::string</code>?"}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1548885739, "post_id": 54450153, "comment_id": 95709131, "body": "I&#39;m using <code>mkstemp</code>, which expects you to pass it a char array (which it mutates). As far as I understand, code like <code>mkstemp(tmpfile.c_str())</code> is not allowed because manipulating a <code>std::string</code> through its <code>.c_str()</code> pointer produces UB."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1548885920, "post_id": 54450153, "comment_id": 95709196, "body": "As long as the <code>tmpfile</code> arrays are function-local, you should be able to replace <code>char tmpfile[] = STR_LITERAL;</code> with <code>char tmpfile[sizeof kTmpfile]; memcpy(tmpfile,kTmpfile,sizeof kTmpfile);</code> with no loss of efficiency."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 1, "creation_date": 1548886000, "post_id": 54450153, "comment_id": 95709214, "body": "@KerrickStaley then I&#39;d write a nice wrapper for <code>mkstemp</code> that makes things more c++-esque. Something like <code>std::string my_mkstemp(std::string)</code> and then you can do all the ugliness of <code>strcpy</code>&#39;ing into a char array and stuff in one place and reuse it everywhere."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548886039, "post_id": 54450153, "comment_id": 95709229, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 This question is different from <a href=\"https://stackoverflow.com/questions/17182588/why-cant-i-assign-an-array-variable-directly-to-another-array-variable-with-the\" title=\"why cant i assign an array variable directly to another array variable with the\">stackoverflow.com/questions/17182588/&hellip;</a> because the arrays here are constant. So there may be some solution here (e.g. using constexpr) that wouldn&#39;t be applicable to the other question."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548886096, "post_id": 54450153, "comment_id": 95709256, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 is can you please re-open the question?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548886520, "post_id": 54450153, "comment_id": 95709378, "body": "@KerrickStaley Reopened. Still not a very good and well researched question though. Just use <code>std:string</code> maybe along with <code>std::string::data()</code> / <code>std::string::c_str()</code>."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548887191, "post_id": 54450153, "comment_id": 95709610, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 I wasn&#39;t aware that std::string::data was an option. In C++14 and earlier, .data() returns a const pointer, and you&#39;re not allowed to modify the backing array through it. But in C++17 this is now allowed, which I didn&#39;t know. Mind writing up this answer and I&#39;ll accept it? If not, I can also write it up."}, {"owner": {"reputation": 7041, "user_id": 314290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ffde821f0f9670e601b19f1731a6849?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/314290/mikhail"}, "edited": false, "score": 1, "creation_date": 1548887280, "post_id": 54450153, "comment_id": 95709654, "body": "I&#39;m voting to close this question as off-topic because this question shows a lack of understand of the C++ language that is unlikely to be of general interest."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548887759, "post_id": 54450153, "comment_id": 95709831, "body": "@KerrickStaley At least <code>std::string::c_str()</code> was an option with the first c++ standard introduced."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548888126, "post_id": 54450153, "comment_id": 95709937, "body": "@KerrickStaley There are some gotchas with that approach. It will still work well as a null-terminated string (which is what you need), but the reported <code>length</code> and <code>size</code> can differ from the length of the null-terminated string. In the olden days where there was only <code>const</code> bugger access, you could generally use <code>&amp;str[0]</code> to get non-<code>const</code> access. Same caveats as before."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548888137, "post_id": 54450153, "comment_id": 95709945, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 I need a <code>char*</code> (mutable, not <code>const</code>). Sorry, I should have made that clearer when asking the question. In C++17 <code>std::string::data()</code> will give you a <code>char*</code>, in earlier versions it returns a <code>const char*</code>. <code>std::string::c_str()</code> always returns a <code>const char*</code> I believe."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1548888238, "post_id": 54450153, "comment_id": 95709989, "body": "@PSkocik if you want to type up that answer as an option for C++14 and earlier, I&#39;ll upvote it"}], "answers": [{"tags": [], "owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1548889886, "last_edit_date": 1548889886, "creation_date": 1548889151, "answer_id": 54450845, "question_id": 54450153, "link": "https://stackoverflow.com/questions/54450153/initializing-char-array-from-constant/54450845#54450845", "title": "Initializing char array from constant", "body": "<p>You could use <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a> and some <em>template magic</em> to determine the array size;</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;algorithm&gt;\n\nconstexpr char kTmpfile[] = \"/tmp/tmpXXXXXX\";\n\ntemplate&lt;typename T, size_t N&gt;\nconstexpr size_t array_size(T(&amp;)[N])\n{\n    return N;\n}\n\nvoid func1() {\n  std::array&lt;char, array_size(kTmpfile)&gt; var;\n  std::copy(std::begin(kTmpfile), std::end(kTmpfile), var.begin());\n\n  mkstemp(var.data());\n  //...\n}\n</code></pre>\n\n<p>To get to the data inside a <code>std::array</code> the function <a href=\"https://en.cppreference.com/w/cpp/container/array/data\" rel=\"nofollow noreferrer\"><code>data()</code></a> can be called.</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1548890129, "post_id": 54450848, "comment_id": 95710530, "body": "Why would the first approach be C++17 only? Looks like C++11 to me."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1548890153, "post_id": 54450848, "comment_id": 95710535, "body": "Because <code>.data</code> returns a const pointer in C++14 and earlier. Updated the answer to clarify."}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 2, "creation_date": 1548890533, "post_id": 54450848, "comment_id": 95710635, "body": "<code>&amp;data[0]</code> works an alternative to <code>.data()</code>. Thus the whole thing can be made compatible with C++03: do that and use <code>const char*</code> instead of <code>constexpr auto</code>."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1548891423, "post_id": 54450848, "comment_id": 95710854, "body": "I don&#39;t think <code>&amp;data[0]</code> is guaranteed to work in C++03 or earlier, although in practice it will on pretty much any existing compiler. See <a href=\"https://stackoverflow.com/questions/1986966/does-s0-point-to-contiguous-characters-in-a-stdstring\" title=\"does s0 point to contiguous characters in a stdstring\">stackoverflow.com/questions/1986966/&hellip;</a>"}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1548891544, "post_id": 54450848, "comment_id": 95710888, "body": "But I think you might be right, approach 1 can be modified by doing <code>&amp;tmpfile[0]</code> in order to make it compatible with C++11 and later."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548891934, "post_id": 54450848, "comment_id": 95710979, "body": "As I said in a now-dead question, I&#39;ve never worked on a platform where <code>&amp;stringvar[0]</code> didn&#39;t &quot;work&quot;. I&#39;m sure they exist. Never used one. &quot;work&quot; is quoted because there are a few caveats."}], "tags": [], "owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "is_accepted": false, "score": 4, "last_activity_date": 1548891757, "last_edit_date": 1548891757, "creation_date": 1548889154, "answer_id": 54450848, "question_id": 54450153, "link": "https://stackoverflow.com/questions/54450153/initializing-char-array-from-constant/54450848#54450848", "title": "Initializing char array from constant", "body": "<p>Here are three approaches. Credit goes to @\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, @PSkocik, and @Asu for suggesting these, I just typed them up.</p>\n\n<p><strong>Approach 1a</strong></p>\n\n<pre><code>constexpr auto kTmpfile = \"/tmp/tmpXXXXXX\";\n\nvoid func1() {\n  std::string tmpfile = kTmpfile;\n  mkstemp(tmpfile.data());\n  ...\n}\n</code></pre>\n\n<p>Advantages:</p>\n\n<ul>\n<li>less code / more readable</li>\n</ul>\n\n<p>Disadvantages:</p>\n\n<ul>\n<li>C++17 only, because <code>std::string::data</code> returns a <code>const char*</code> in C++14 and earlier (of course, you can use a <code>const_cast</code> in C++14, but that's also bad)</li>\n<li>may be slower, since char array may be allocated on the heap instead of stack</li>\n</ul>\n\n<p><strong>Approach 1b</strong></p>\n\n<pre><code>constexpr auto kTmpfile = \"/tmp/tmpXXXXXX\";\n\nvoid func1() {\n  std::string tmpfile = kTmpfile;\n  mkstemp(&amp;tmpfile[0]);\n  ...\n}\n</code></pre>\n\n<p>Advantages:</p>\n\n<ul>\n<li>less code / more readable</li>\n<li>C++11 and later (see <a href=\"https://stackoverflow.com/questions/1986966/does-s0-point-to-contiguous-characters-in-a-stdstring\">Does &quot;&amp;s[0]&quot; point to contiguous characters in a std::string?</a>)</li>\n</ul>\n\n<p>Disadvantages:</p>\n\n<ul>\n<li>may be slower, since char array may be allocated on the heap instead of stack</li>\n</ul>\n\n<p><strong>Approach 2</strong></p>\n\n<pre><code>constexpr char kTmpfile[] = \"/tmp/tmpXXXXXX\";\n\nvoid func1() {\n  char tmpfile[sizeof(kTmpfile)];\n  memcpy(tmpfile, kTmpfile, sizeof(kTmpfile));\n  mkstemp(tmpfile);\n  ...\n}\n</code></pre>\n\n<p>Advantages:</p>\n\n<ul>\n<li>only uses stack, no heap</li>\n<li>compatible with C++14 and earlier</li>\n</ul>\n\n<p>Disadvantages:</p>\n\n<ul>\n<li>more verbose / less readable</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 2, "creation_date": 1548889270, "post_id": 54450858, "comment_id": 95710293, "body": "Awesome, thanks for digging into the assembly output and checking that it&#39;s the same!"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1548889178, "creation_date": 1548889178, "answer_id": 54450858, "question_id": 54450153, "link": "https://stackoverflow.com/questions/54450153/initializing-char-array-from-constant/54450858#54450858", "title": "Initializing char array from constant", "body": "<p>As long as the char arrays are local, you can replace</p>\n\n<pre><code>char tmpfile[] = STR_LITERAL; \n</code></pre>\n\n<p>with </p>\n\n<pre><code>char tmpfile[sizeof kTmpfile]; memcpy(tmpfile,kTmpfile,sizeof tmpfile); \n</code></pre>\n\n<p>with theoretically no loss of efficiency.</p>\n\n<p>Clang, for example, <a href=\"https://gcc.godbolt.org/z/JvKYkD\" rel=\"nofollow noreferrer\">compiles both func1 and func2</a> in the snippet below into the same instructions on x86_64:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint func1() {\n  char tmpfile[] = \"/tmp/tmpXXXXXX\";\n  mkstemp(tmpfile);\n}\n\n#include &lt;string.h&gt;\nconst char kTmpfile[] = \"/tmp/tmpXXXXXX\";\nint func2() {\n  char tmpfile[sizeof kTmpfile]; \n  memcpy(&amp;tmpfile,kTmpfile,sizeof tmpfile);\n\n  mkstemp(tmpfile);\n}\n</code></pre>\n\n<p>Assembly output:</p>\n\n<pre><code>func1(): # @func1()\n  subq $24, %rsp\n  movabsq $24866934413088880, %rax # imm = 0x58585858585870\n  movq %rax, 15(%rsp)\n  movabsq $8101259051807896623, %rax # imm = 0x706D742F706D742F\n  movq %rax, 8(%rsp)\n  leaq 8(%rsp), %rdi\n  callq mkstemp\nfunc2(): # @func2()\n  subq $24, %rsp\n  movabsq $24866934413088880, %rax # imm = 0x58585858585870\n  movq %rax, 15(%rsp)\n  movabsq $8101259051807896623, %rax # imm = 0x706D742F706D742F\n  movq %rax, 8(%rsp)\n  leaq 8(%rsp), %rdi\n  callq mkstemp\n</code></pre>\n\n<p>This solution for refactoring the duplicate initialization string without using macros also works in plain C. </p>\n\n<p>Using <code>std::string</code>, while it would generally use the heap, which is quite a bit more expensive than the stack, shouldn't hurt here much either as you can expect the file creation to take at least a microsecond and thereby dominate over the heap allocation and string copy.</p>\n"}, {"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1548891483, "last_edit_date": 1548891483, "creation_date": 1548890929, "answer_id": 54451136, "question_id": 54450153, "link": "https://stackoverflow.com/questions/54450153/initializing-char-array-from-constant/54451136#54451136", "title": "Initializing char array from constant", "body": "<p>One more way, C++11 (or C++03 if you write a constructor):</p>\n\n<pre><code>struct KTmpfile { char value[...] = \"/tmp/tmpXXXXXX\"; };\n\nvoid func1() {\n    KTmpfile tmpfile;\n    mkstemp(tmpfile.value);\n    ...\n}\n</code></pre>\n\n<p>Stack only, smallest code possible in the <code>func*</code> users.</p>\n\n<p>Note that you have to specify the size of <code>value</code>, of course (or repeat the literal to find out the size).</p>\n\n<hr>\n\n<p>In my view, this is the best way to do it, because what you really want is a type that you want to get several instances of -- you know its size and its initial value, so create a proper type for it.</p>\n\n<p>And, at this point, since you have a type, you are one step into calling <code>mkstemp</code> from the type itself, maybe even in the constructor, and then simply say:</p>\n\n<pre><code>void func1() {\n    KTmpfile tmpfile;\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1548891757, "creation_date": 1548885367, "last_edit_date": 1548888409, "question_id": 54450153, "link": "https://stackoverflow.com/questions/54450153/initializing-char-array-from-constant", "title": "Initializing char array from constant", "body": "<p>I'm starting with this code:</p>\n\n<pre><code>void func1() {\n  char tmpfile[] = \"/tmp/tmpXXXXXX\";\n  mkstemp(tmpfile);  // Note: mkstemp modifies the char array, cannot be const\n  ...\n}\n\nvoid func2() {\n  char tmpfile[] = \"/tmp/tmpXXXXXX\";\n  mkstemp(tmpfile);  // Note: mkstemp modifies the char array, cannot be const\n  ...\n}\n</code></pre>\n\n<p>I'd like to refactor this to pull out the shared <code>\"/tmp/tmpXXXXXX\"</code> constant. Here is an attempt:</p>\n\n<pre><code>constexpr char kTmpfile[] = \"/tmp/tmpXXXXXX\";\n\nvoid func1() {\n  char tmpfile[] = kTmpfile;\n  mkstemp(tmpfile);  // Note: mkstemp modifies the char array, cannot be const\n  ...\n}\n\nvoid func2() {\n  char tmpfile[] = kTmpfile;\n  mkstemp(tmpfile);  // Note: mkstemp modifies the char array, cannot be const\n  ...\n}\n</code></pre>\n\n<p>However, this doesn't compile. Changing <code>tmpfile[]</code> to <code>tmpfile[sizeof(kTmpfile)]</code> also doesn't work.</p>\n\n<p>The below <em>does</em> work, but it uses a macro which is discouraged by my company's style guide (which is based on the <a href=\"https://google.github.io/styleguide/cppguide.html#Preprocessor_Macros\" rel=\"nofollow noreferrer\">Google Style Guide</a>).</p>\n\n<pre><code>#define TMPFILE \"/tmp/tmpXXXXXX\"\n\nvoid func1() {\n  char tmpfile[] = TMPFILE;\n  mkstemp(tmpfile);  // Note: mkstemp modifies the char array, cannot be const\n  ...\n}\n\nvoid func2() {\n  char tmpfile[] = TMPFILE;\n  mkstemp(tmpfile);  // Note: mkstemp modifies the char array, cannot be const\n  ...\n}\n</code></pre>\n\n<p>Is there any way to write this \"nicely\"? Without having to use a macro or hardcode the size? Or is the macro the best option for readability and maintainability?</p>\n"}, {"tags": ["c++", "winapi", "createprocess", "highdpi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 3, "creation_date": 1548890128, "post_id": 54449681, "comment_id": 95710529, "body": "Your question isn&#39;t clear. DPI awareness is not inherited from the launching process. The apps your process launch will have their DPI awareness set to whatever those apps want. It&#39;s not something you should care about or try to change."}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1549607369, "post_id": 54449681, "comment_id": 95970575, "body": "Hi htonus, does the issue solved <a href=\"https://stackoverflow.com/questions/54581535/resolved-how-to-detect-real-screen-resolution-or-scaling-of-the-secondary-moni\">here</a>: detect the resolution of the secondary monitor in the app?"}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "edited": false, "score": 0, "creation_date": 1548884348, "post_id": 54449833, "comment_id": 95708633, "body": "CreateRemoteThread will not work, because SetProcessDpiAwarenessContext should be called before the very first window of the target process created. The problem I have is that when my app sends SetWindowPos for the process with proper dimentions (scaled) and the process is DPIawared then it manages to update dimentions by WM_DPICHANGED message."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548887556, "post_id": 54449833, "comment_id": 95709763, "body": "<code>SetProcessDpiAwarenessContext()</code> operates on the calling process only, it cannot be used to set dpi awareness for another process."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "edited": false, "score": 0, "creation_date": 1548887622, "post_id": 54449833, "comment_id": 95709791, "body": "@htonus why are you manipulating another process&#39; windows to begin with? What are you trying to accomplish exactly?"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548887782, "post_id": 54449833, "comment_id": 95709839, "body": "@RemyLebeau who said that this function can operate on a different process?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1548895882, "post_id": 54449833, "comment_id": 95711996, "body": "@Michael it can&#39;t, that&#39;s the point. But the OP&#39;s question implies that he wants to change the DPI setting of another process."}, {"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548923923, "post_id": 54449833, "comment_id": 95720900, "body": "@RemyLebeau I need to have two windows from different apps be snapped to each other, and when I move one window the second should follow it"}], "tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": false, "score": -1, "last_activity_date": 1548883830, "creation_date": 1548883830, "answer_id": 54449833, "question_id": 54449681, "link": "https://stackoverflow.com/questions/54449681/how-can-i-createprocess-with-dpi-awareness-set-to-dpi-awareness-context-unaware/54449833#54449833", "title": "How can I CreateProcess with DPI awareness set to DPI_AWARENESS_CONTEXT_UNAWARE", "body": "<p>If the app does not already have a manifest, you can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setprocessdpiawarenesscontext\" rel=\"nofollow noreferrer\">SetProcessDpiAwarenessContext</a> to set the awareness. Also check <a href=\"https://msdn.microsoft.com/el-gr/C9488338-D863-45DF-B5CB-7ED9B869A5E2?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>You cannot set the awareness on an existing app unless if injecting a remote thread with <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createremotethread\" rel=\"nofollow noreferrer\">CreateRemoteThread</a>, in which case you may cause incompatibilities when forcing something that the app is not aware of.</p>\n"}], "owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1548917294, "creation_date": 1548883087, "last_edit_date": 1548917294, "question_id": 54449681, "link": "https://stackoverflow.com/questions/54449681/how-can-i-createprocess-with-dpi-awareness-set-to-dpi-awareness-context-unaware", "title": "How can I CreateProcess with DPI awareness set to DPI_AWARENESS_CONTEXT_UNAWARE", "body": "<p>I have C++ application which opens other apps with <code>CreateProcessA</code> on Windows 10. These apps could have different settings for DPI Awareness. </p>\n\n<p>So the question is - can I create processes with DPI Awareness set to <code>DPI_AWARENESS_CONTEXT_UNAWARE</code>?</p>\n\n<p>If not - then perhaps I can set <code>DPI_AWARENESS_CONTEXT_UNAWARE</code> for the already created process?</p>\n\n<p><strong>UPD:</strong>\nMy application spawns the app and then changes one's position. And if it appears to be another monitor with different DPI then scaled values are supplied. </p>\n\n<p>If the app is DPI awared then after the move completed the dimensions changed according WM_DPICHANGED message values. Spawned apps could have different DPI Aware modes. So idea was to set them one mode and control position and dimensions of all of them with same logic.</p>\n"}, {"tags": ["c++", "root-framework"], "comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1548884189, "post_id": 54449678, "comment_id": 95708575, "body": "What language are you writing in? Please tag appropriately. The tag &quot;root&quot; is for *nix administrator issues."}, {"owner": {"reputation": 3, "user_id": 8941013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/707cc8f917ca509ca019ace18cedd7a8?s=128&d=identicon&r=PG&f=1", "display_name": "girardcarillo", "link": "https://stackoverflow.com/users/8941013/girardcarillo"}, "reply_to_user": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1548919031, "post_id": 54449678, "comment_id": 95718528, "body": "Ok thank you, I am writting in C++, in the Root framework"}, {"owner": {"reputation": 2363, "user_id": 4588453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/51da95e02741a304f3620d3b9697eda9?s=128&d=identicon&r=PG&f=1", "display_name": "pseyfert", "link": "https://stackoverflow.com/users/4588453/pseyfert"}, "edited": false, "score": 1, "creation_date": 1548923403, "post_id": 54449678, "comment_id": 95720629, "body": "unrelated to your problem, but I&#39;d shorten to <code>TFile::Open(Form(&quot;file_%d.root&quot;,i));</code> to shorten all that juggeling with std::string, c-string, stringstream. <a href=\"https://root.cern.ch/doc/master/TString_8cxx.html#a3b5b568376e617c4b5d6a91c7a2b675a\" rel=\"nofollow noreferrer\">From doc</a>"}, {"owner": {"reputation": 3, "user_id": 8941013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/707cc8f917ca509ca019ace18cedd7a8?s=128&d=identicon&r=PG&f=1", "display_name": "girardcarillo", "link": "https://stackoverflow.com/users/8941013/girardcarillo"}, "edited": false, "score": 0, "creation_date": 1552382013, "post_id": 54449678, "comment_id": 96977106, "body": "Thank you for the advice !"}], "answers": [{"tags": [], "owner": {"reputation": 2363, "user_id": 4588453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/51da95e02741a304f3620d3b9697eda9?s=128&d=identicon&r=PG&f=1", "display_name": "pseyfert", "link": "https://stackoverflow.com/users/4588453/pseyfert"}, "is_accepted": true, "score": 0, "last_activity_date": 1548924188, "last_edit_date": 1548924188, "creation_date": 1548923858, "answer_id": 54456389, "question_id": 54449678, "link": "https://stackoverflow.com/questions/54449678/root-failed-filling-branch-memory-resident-tree/54456389#54456389", "title": "Root - failed filling branch : memory-resident tree", "body": "<p>The error message you're seeing is from a <code>TTree</code> that you're writing to. As far as I understand your code, the <code>TFile *file_adress</code> and <code>TTree *tree_adress</code> are opened for reading and you write to <code>TTree *TPulses</code>. I don't see the default setting for <code>TFile::Open</code> (if it's <code>READ</code> for read-only or <code>update</code> for manipulating contents) but from your output I claim <code>TPulses</code> does not get created in the last file you open, but rather in RAM and you run out of that (<a href=\"https://root.cern.ch/doc/master/classTTree.html#a8d4212a53f96f9c3bcbd384892d3bd81\" rel=\"nofollow noreferrer\">see docs</a>). A common pattern would be to create an output file before creating <code>TPulses</code>:</p>\n\n<pre><code>TFile* outputfile = TFile::Open(\"output.root\", \"recreate\");\nTTree* TPulses = TTree::MergeTrees(list);\n// ...\nTPulses-&gt;Write();\noutputfile-&gt;Close();\ndelete outputfile;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8941013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/707cc8f917ca509ca019ace18cedd7a8?s=128&d=identicon&r=PG&f=1", "display_name": "girardcarillo", "link": "https://stackoverflow.com/users/8941013/girardcarillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 54456389, "answer_count": 1, "score": 0, "last_activity_date": 1557817450, "creation_date": 1548883061, "last_edit_date": 1548885880, "question_id": 54449678, "link": "https://stackoverflow.com/questions/54449678/root-failed-filling-branch-memory-resident-tree", "title": "Root - failed filling branch : memory-resident tree", "body": "<p>I am trying to merge trees doing :</p>\n\n<pre><code>string filename_;\nTList *list = new TList;\n\n///Loop on all .root output files\nfor (int i = 1; i &lt; 13; ++i) {\n  string filename_ = \"file_\";\n  string file_extension = \".root\";\n  stringstream ss;\n  ss &lt;&lt; i;\n  string str = ss.str();\n  filename_ = filename_+str+file_extension;\n  const char* c_filename = filename_.c_str();\n  TFile *file_adress = TFile::Open(c_filename);\n  TTree *tree_adress = (TTree*)file_adress-&gt;Get(\"pulses\");\n  list-&gt;Add(tree_adress);\n}\n\n// Output tree:\nTTree *TPulses = TTree::MergeTrees(list);\n</code></pre>\n\n<p>But I am getting this error, which is quietly explicite :</p>\n\n<pre><code>Error in &lt;TTree::Fill&gt;: Failed filling branch:pulses.pulse_time, nbytes=-1, entry=115710\n This error is symptomatic of a Tree created as a memory-resident Tree\n Instead of doing:\n    TTree *T = new TTree(...)\n    TFile *f = new TFile(...)\n you should do:\n    TFile *f = new TFile(...)\n    TTree *T = new TTree(...)\n</code></pre>\n\n<p>But I am creating the TFile before the TTree in the for loop, so I don't understand.\nDoes someone have an idea ?</p>\n"}, {"tags": ["c++", "c++11", "unique-ptr"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1548880583, "post_id": 54449070, "comment_id": 95706970, "body": "Move assigning an instance of <code>unique_ptr</code> to another  will replace the previous one which requires the previously held value be destroyed properly (if it&#39;s present). Anything else would leak."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1548881429, "last_edit_date": 1548881429, "creation_date": 1548881100, "answer_id": 54449246, "question_id": 54449070, "link": "https://stackoverflow.com/questions/54449070/are-multiple-assignments-to-unique-ptr-valid/54449246#54449246", "title": "Are multiple assignments to unique_ptr valid?", "body": "<p>Yes, it is perfectly valid.</p>\n\n<p>When you assign a new object to a <code>unique_ptr</code>, it destroys its current object and takes ownership of the new object. This is expected and documented behavior.</p>\n\n<p>As you can see in your logging, this is exactly what is actually happening:</p>\n\n<pre><code>Construcor   (first call to make_unique) \n             (first assignment, nothing to log here) \nfoo\nConstrucor   (second call to make_unique)\nDestrucor    (second assignment, first object destroyed)\nfoo\nDestrucor    (main exits, second object destroyed) \n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 8024280, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nQZKP.jpg?s=128&g=1", "display_name": "wair92", "link": "https://stackoverflow.com/users/8024280/wair92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 54449246, "answer_count": 1, "score": -3, "last_activity_date": 1548881866, "creation_date": 1548880345, "last_edit_date": 1548881866, "question_id": 54449070, "link": "https://stackoverflow.com/questions/54449070/are-multiple-assignments-to-unique-ptr-valid", "title": "Are multiple assignments to unique_ptr valid?", "body": "<p>Are multiple assignments to <code>unique_ptr&lt;T&gt;</code> valid? Based on output, it is, but is <code>T</code>'s destructor guaranteed to be called when <code>make_unique()</code> is used and the return value is assigned to a <code>unique_ptr</code> that is already holding existing memory?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;memory&gt;\n\nclass A{\npublic:\n    A(){ std::cout &lt;&lt; \"Construcor\" &lt;&lt; std::endl; }\n    ~A(){ std::cout &lt;&lt; \"Destrucor\" &lt;&lt; std::endl; }\n    void foo(){ std::cout &lt;&lt; \"foo\" &lt;&lt; std::endl; }\n};\n\nint main()\n{\n    std::unique_ptr&lt;A&gt; pointer;\n    for(auto i = 0; i &lt; 2; ++i){\n        pointer = std::make_unique&lt;A&gt;();\n        pointer-&gt;foo();\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Construcor\nfoo\nConstrucor\nDestrucor // Destructor is called because first instance of A is out of scope?\nfoo\nDestrucor\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1548880470, "post_id": 54449068, "comment_id": 95706918, "body": "I stole the C tag. C has no <code>new</code> operator and doesn&#39;t require casting the <code>void</code> pointers returned by <code>malloc</code>."}, {"owner": {"reputation": 3980, "user_id": 8769985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72402fe064285d9e3e85fd3ca5900e5a?s=128&d=identicon&r=PG&f=1", "display_name": "francesco", "link": "https://stackoverflow.com/users/8769985/francesco"}, "edited": false, "score": 0, "creation_date": 1548881571, "post_id": 54449068, "comment_id": 95707451, "body": "Use <a href=\"https://www.boost.org/doc/libs/1_69_0/libs/serialization/doc/index.html\" rel=\"nofollow noreferrer\">boost::serialization</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548884701, "post_id": 54449068, "comment_id": 95708765, "body": "@user4581301 ironically we call them c-style casts ;)"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548881001, "post_id": 54449141, "comment_id": 95707164, "body": "Also worth noting that the code is serializing the a mostly-uninitialized <code>B</code> that was created within the <code>send</code> function, not the <code>b</code> created and initialized in <code>main</code>"}, {"owner": {"reputation": 570, "user_id": 285369, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/094555df02e906206fd0d30f86371e89?s=128&d=identicon&r=PG", "display_name": "Franziee", "link": "https://stackoverflow.com/users/285369/franziee"}, "edited": false, "score": 0, "creation_date": 1548881006, "post_id": 54449141, "comment_id": 95707169, "body": "that was my previous attempt, in turn at the send()  I don&#39;t get the 3 by the (int)*ptr"}, {"owner": {"reputation": 570, "user_id": 285369, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/094555df02e906206fd0d30f86371e89?s=128&d=identicon&r=PG", "display_name": "Franziee", "link": "https://stackoverflow.com/users/285369/franziee"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548881228, "post_id": 54449141, "comment_id": 95707287, "body": "@user4581301 this is a demo without any sense. I just want to highlight the problem"}, {"owner": {"reputation": 570, "user_id": 285369, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/094555df02e906206fd0d30f86371e89?s=128&d=identicon&r=PG", "display_name": "Franziee", "link": "https://stackoverflow.com/users/285369/franziee"}, "edited": false, "score": 0, "creation_date": 1548920942, "post_id": 54449141, "comment_id": 95719361, "body": "thanks @dbush, +sizeof(B) helped. In turn memcpy(b, ptr, sizeof(b)) can&#39;t be good, because b contains pointers to the 3 A&#39;s therefore b-&gt;a must be allocated first, isn&#39;t?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 570, "user_id": 285369, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/094555df02e906206fd0d30f86371e89?s=128&d=identicon&r=PG", "display_name": "Franziee", "link": "https://stackoverflow.com/users/285369/franziee"}, "edited": false, "score": 1, "creation_date": 1548936992, "post_id": 54449141, "comment_id": 95728702, "body": "@Franziee  It&#39;s not a problem.  You perform the <code>memcpy</code> first, which copies each of the members including the old pointer valid, then you overwrite the old pointer value with a newly allocated buffer to hold an array of <code>A *</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1548881299, "last_edit_date": 1548881299, "creation_date": 1548880673, "answer_id": 54449141, "question_id": 54449068, "link": "https://stackoverflow.com/questions/54449068/custom-serialization/54449141#54449141", "title": "Custom serialization", "body": "<p>You're not copying what you think you're copying:</p>\n\n<pre><code>memcpy(ptr, (unsigned char*)&amp;b, sizeof(B));\nfor (int i = 0; i &lt; b-&gt;na; i++)\n    memcpy(ptr+i*sizeof(A), (unsigned char*)&amp;b-&gt;a[i], sizeof(A));\n</code></pre>\n\n<p><code>b</code> is already a pointer to <code>B</code>, so when you take its address you now have a <code>B **</code>.  The same happens with <code>&amp;b-&gt;a[i]</code> which evaluated to a <code>A **</code>.  You also overwrite the instance of <code>B</code> with the first instance of <code>A</code>.  </p>\n\n<p>You already have pointers to the data you want to copy, so pass those directly to <code>memcpy</code>, and add <code>sizeof(b)</code> to <code>ptr</code> when adding the instances of <code>A</code>.</p>\n\n<pre><code>memcpy(ptr, b, sizeof(B));\nfor (int i = 0; i &lt; b-&gt;na; i++)\n    memcpy(ptr+sizeof(B)+i*sizeof(A), b-&gt;a[i], sizeof(A));\n</code></pre>\n\n<p>Then in your <code>send</code> function, you're not deserializing the instance of <code>B</code>.  You need to do that as well.</p>\n\n<pre><code>B* b = new B();\nmemcpy(b, ptr, sizeof(b);\n</code></pre>\n"}], "owner": {"reputation": 570, "user_id": 285369, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/094555df02e906206fd0d30f86371e89?s=128&d=identicon&r=PG", "display_name": "Franziee", "link": "https://stackoverflow.com/users/285369/franziee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 54449141, "answer_count": 1, "score": 3, "last_activity_date": 1548881299, "creation_date": 1548880330, "last_edit_date": 1548880393, "question_id": 54449068, "link": "https://stackoverflow.com/questions/54449068/custom-serialization", "title": "Custom serialization", "body": "<p>I have a container class B and it has certain number of items of A. I want to serialize it for sending either over wire or save it to disk. </p>\n\n<pre><code>class A {\npublic:\n    bool b;\n    long c;\n};\n\nstruct B {\npublic:\n    int na;\n    bool bb;\n    A** a;\n};\nvoid send(unsigned char* ptr, int sizeb) {\n    int i = sizeof(B);\n    B* b = new B();\n    b-&gt;a = (A**)malloc((int)*ptr * sizeof(A*));\n    while (i &lt; sizeb) {\n        memcpy(b-&gt;a[i], ptr + i, sizeof(A));\n        i += sizeof(A);\n    }\n}\n</code></pre>\n\n<p>The first member of B is the number of contained A items. In this case it's three.</p>\n\n<pre><code>int main()\n{\n    B* b = new B();\n    b-&gt;na = 3;\n    b-&gt;bb = true;\n    b-&gt;a = (A**)malloc(b-&gt;na *sizeof(A*));\n    for (int i = 0; i &lt; b-&gt;na; i++) {\n        b-&gt;a[i] = new A();\n        b-&gt;a[i]-&gt;b = true;\n        b-&gt;a[i]-&gt;c = (i+1) * 100;\n    }\n    int sizeb = sizeof(B) + b-&gt;na * sizeof(A);\n    unsigned char* ptr = (unsigned char*)malloc(sizeb);\n    memcpy(ptr, (unsigned char*)&amp;b, sizeof(B));\n    for (int i = 0; i &lt; b-&gt;na; i++)\n        memcpy(ptr+i*sizeof(A), (unsigned char*)&amp;b-&gt;a[i], sizeof(A));\n    send(ptr, sizeb);\n    return 0;\n}\n</code></pre>\n\n<p>First I allocate enough contigous space for storing B and the three A's. In the send method I don't get back the <em>na</em> value. What's wrong? </p>\n"}, {"tags": ["c++", "templates", "c++03", "c++98"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548879897, "post_id": 54448956, "comment_id": 95706666, "body": "So you have to do this in C++98/03?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1548879933, "post_id": 54448956, "comment_id": 95706678, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/parameter_pack\" rel=\"nofollow noreferrer\">Parameter packs</a> were designed and added in c++11 for this purpose. This is very easy to do in c++11 or later. The hack for earlier c++ versions generally has you choose an arbitrary maximum number of arguments and implement a type/overload for each number of arguments. Type deduction though has always worked in c++ (as far as I know)."}, {"owner": {"reputation": 307, "user_id": 1340086, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/05d733b5d7d7ed78a9e0ff37d9f92cd2?s=128&d=identicon&r=PG", "display_name": "Oracular", "link": "https://stackoverflow.com/users/1340086/oracular"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548880149, "post_id": 54448956, "comment_id": 95706776, "body": "@NathanOliver unfortunately I&#39;m constrained to C++98/03 for now. But I would love to know how to do this regardless, even in more do this in more recent versions of C++!"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1548880261, "post_id": 54448956, "comment_id": 95706820, "body": "Any modern C++ book will have plenty of reading material to go through. This is one of the most complicated aspects of modern C++, and cannot be fully explained in a brief comment or an answer on stackoverflow.com. Stackoverflow.com is not really set up as a tutorial site where someone goes to learn something new about C++, or any other language. Probably the only thing that can be done here is a template that takes a callable object, and one argument. All the functions (callable objects) take a single class ref as a parameter with their real parameters as the class members."}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 1340086, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/05d733b5d7d7ed78a9e0ff37d9f92cd2?s=128&d=identicon&r=PG", "display_name": "Oracular", "link": "https://stackoverflow.com/users/1340086/oracular"}, "edited": false, "score": 0, "creation_date": 1548887585, "post_id": 54449603, "comment_id": 95709773, "body": "Very complete answer! Shame to see how easy it is in recent versions...one can only dream. Thanks!"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 5, "last_activity_date": 1548884036, "last_edit_date": 1548884036, "creation_date": 1548882719, "answer_id": 54449603, "question_id": 54448956, "link": "https://stackoverflow.com/questions/54448956/functor-that-automatically-deduces-return-and-parameter-types/54449603#54449603", "title": "Functor that automatically deduces return and parameter types", "body": "<p>In modern C++ (C++17) the function would look something like</p>\n\n<pre><code>template &lt;typename Mutex, typename Func, typename... Args&gt;\ndecltype(auto) doMutexProtected(Mutex&amp; mutex, Func&amp;&amp; func, Args&amp;&amp;... args)\n{\n    std::unique_lock lg(mutex);\n    return std::forward&lt;Func&gt;(func)(std::forward&lt;Args&gt;(args)...);\n}\n</code></pre>\n\n<p>This locks the mutex in a RAII type so all exit path release the mutex and then perfectly forwards the function and it arguments returning the exact type <code>func</code> returns.</p>\n\n<p>Now, since you can't use modern C++ we have to try and implement as much of what the above does as we can and there are a couple way you could approach the problem. Implementing <code>std::unique_lock</code> is pretty trivial.  Depending on what features you want it can be as simple as</p>\n\n<pre><code>template &lt;typename Mutex&gt;\nclass my_unique_lock\n{\npublic:\n    unique_lock(Mutex&amp; mutex) : mutex(mutex) { mutex.lock(); }\n    ~unique_lock() { mutex.unlock(); }\nprivate:\n    Mutex&amp; mutex;\n    unique_lock(unique_lock const&amp;); // make it non copyable\n};\n</code></pre>\n\n<p>So that cover 25% of the problem :).  Unfortunately that was the easiest part.  Since C++98/03 doesn't have <code>decltype(auto)</code>, or even <code>decltype</code> or <code>auto</code>, we need to come up with a different way to get the return type.  We could make it <code>void</code> and use an output parameter, which would mean you don't need to specify anything when you call the function but this means you cant get a reference to what is returned.  At the cost of having to specify the return type you want you could have the function like</p>\n\n<pre><code>template &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func func, Arg1 arg1)\n{\n    my_unique_lock&lt;Mutex&gt; lg(mutex);\n    return func(arg1);\n}\n</code></pre>\n\n<p>and you would call it like</p>\n\n<pre><code>T foo = doMutexProtected&lt;T&gt;(mutex, func, arg);\nT&amp; bar = doMutexProtected&lt;T&amp;&gt;(mutex, func, arg);\n</code></pre>\n\n<p>Since C++98/03 doesn't have variadic templates you are left with having to add a bunch of overloads to this for different amount of arguments and you'll have to decide at which point enough arguments is enough, i.e:</p>\n\n<pre><code>template &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func func, Arg1 arg1) {...}\n\ntemplate &lt;typename Ret, typename Mutex, typename Func, typename Arg1, typename Arg2&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func func, Arg1 arg1, Arg2 arg2) {...}\n\ntemplate &lt;typename Ret, typename Mutex, typename Func, typename Arg1, typename Arg2, typename Arg3&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func func, Arg1 arg1, Arg2 arg2, Arg3 arg3) {...}\n...\n</code></pre>\n\n<p>and then you have to deal with references.  The modern version perfectly forwarded everything (nothing is copied unless that is what is required by <code>Func</code>).  We can't do that in C++98/03 so we have to add all of the reference permutations there are so we don't make unnecessary copies like the first version does.  That means</p>\n\n<pre><code>template &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func func, Arg1 arg1)\n</code></pre>\n\n<p>actually needs to be</p>\n\n<pre><code>template &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func&amp; func, Arg1&amp; arg1) {...}\n\ntemplate &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func const&amp; func, Arg1&amp; arg1)  {...}\n\ntemplate &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func&amp; func, Arg1 const&amp; arg1)  {...}\n\ntemplate &lt;typename Ret, typename Mutex, typename Func, typename Arg1&gt;\nRet doMutexProtected(Mutex&amp; mutex, Func conts&amp; func, Arg1 const&amp; arg1)  {...}\n</code></pre>\n\n<p>and this is going to balloon as you add more parameters.</p>\n\n<p>If you don't want to do all of this yourself, I believe <a href=\"https://www.boost.org/\" rel=\"nofollow noreferrer\">Boost</a> has done at least some of this work for C++03 and you can use their utilities.</p>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 1340086, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/05d733b5d7d7ed78a9e0ff37d9f92cd2?s=128&d=identicon&r=PG", "display_name": "Oracular", "link": "https://stackoverflow.com/users/1340086/oracular"}, "edited": false, "score": 0, "creation_date": 1548887687, "post_id": 54449711, "comment_id": 95709811, "body": "+1 for suggesting RAII, it&#39;s a good point given how I phrased things. It was not necessarily intended specifically for resource acquisition/release though, but more for anything that follows the pattern of &quot;do something constant, then do something unique, then do something else constant&quot;. However, depending on the code you are writing, your point may still exist!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 307, "user_id": 1340086, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/05d733b5d7d7ed78a9e0ff37d9f92cd2?s=128&d=identicon&r=PG", "display_name": "Oracular", "link": "https://stackoverflow.com/users/1340086/oracular"}, "edited": false, "score": 0, "creation_date": 1548929938, "post_id": 54449711, "comment_id": 95724519, "body": "@Oracular i had the feeling that your are overcomplicating the matter for the given example. As I understood the question your example isnt really the best for what you want to write, so I decided to concentrate on the example first and then I realized that there is already an exhaustive answer before I could get to the core of your question"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 307, "user_id": 1340086, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/05d733b5d7d7ed78a9e0ff37d9f92cd2?s=128&d=identicon&r=PG", "display_name": "Oracular", "link": "https://stackoverflow.com/users/1340086/oracular"}, "edited": false, "score": 1, "creation_date": 1548930221, "post_id": 54449711, "comment_id": 95724671, "body": "@Oracular btw RAII is more general than one might think. A &quot;resource&quot; can be anything. Eg you can write a class that does &quot;something constant&quot; in its constructor and then &quot;something else constant&quot; in its destructor, now you simply have to create an instance of this class at the beginning of the scope where you &quot;do something unique&quot;"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1548883207, "creation_date": 1548883207, "answer_id": 54449711, "question_id": 54448956, "link": "https://stackoverflow.com/questions/54448956/functor-that-automatically-deduces-return-and-parameter-types/54449711#54449711", "title": "Functor that automatically deduces return and parameter types", "body": "<p>Let me take your example literally:</p>\n\n<blockquote>\n  <p>For instance, the following:</p>\n\n<pre><code>myMutex.acquire();\nint a = foo(arg1, arg2, arg3);\nmyMutex.release();\nreturn a;\n</code></pre>\n</blockquote>\n\n<p>You should not be writing code like that in the first place. Why? It is not exception safe. What if <code>foo</code> throws an excpetion? You will miss to release the mutex and eventually your program will wait forever for a mutex that never gets released. </p>\n\n<p>The way to avoid that is to use <a href=\"https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization\" rel=\"nofollow noreferrer\">RAII</a>, aka: \"destructors are your friend\". If you cannot use C++17 which has <code>std::scoped_lock</code> you can easily write your own scoped lock and you can even use a template to do that:</p>\n\n<pre><code>template &lt;typename mutex_t&gt;\nstruct my_scoped_lock {\n     mutex_t&amp; m;\n     scoped_lock(mutex_t&amp; m) : m(m) {m.acquire();}\n     ~scoped_lock() { m.release(); }\n};\n</code></pre>\n\n<p>Now you cannot forget to release the mutex:</p>\n\n<pre><code>int foo( /*...*/ ) {\n    my_scoped_lock&lt;mutex_t&gt; lock(myMutex);\n    int a = foo(arg1,arg2,arg3);\n    return a;\n}     \n</code></pre>\n\n<p>If you want to know how to write a function you are actually asking for I refer you to the other answer, I would just suggest you to reconsider if it is really worth the effort. </p>\n\n<blockquote>\n  <p>Or some similar mechanism. The challenge is with how to do this for\n  arbitrary types of a and arbitrary types and numbers of arguments.</p>\n</blockquote>\n\n<p>Maybe this \"other mechanism\" is simply writing a function as I indicated above. </p>\n\n<p>PS: I was going to extend this answer, but in the meantime there is already an answer more complete than I could provide, so I'll just leave it fwiw.</p>\n"}, {"tags": [], "owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "is_accepted": false, "score": 0, "last_activity_date": 1548887067, "creation_date": 1548887067, "answer_id": 54450471, "question_id": 54448956, "link": "https://stackoverflow.com/questions/54448956/functor-that-automatically-deduces-return-and-parameter-types/54450471#54450471", "title": "Functor that automatically deduces return and parameter types", "body": "<p>Once you have a <code>scoped_lock</code> as suggested by other anwers, you do not need a functor anymore. You can write your example like this:</p>\n\n<pre><code>return scoped_lock&lt;Mutex&gt;(myMutex),\n          foo(arg1, arg2, arg3);\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 1340086, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/05d733b5d7d7ed78a9e0ff37d9f92cd2?s=128&d=identicon&r=PG", "display_name": "Oracular", "link": "https://stackoverflow.com/users/1340086/oracular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1548887067, "creation_date": 1548879782, "last_edit_date": 1548880185, "question_id": 54448956, "link": "https://stackoverflow.com/questions/54448956/functor-that-automatically-deduces-return-and-parameter-types", "title": "Functor that automatically deduces return and parameter types", "body": "<p>Say you have a common workflow that is often repeated, but with some variation:</p>\n\n<ul>\n<li>lock a mutex</li>\n<li>perform some actions</li>\n<li>unlock the mutex</li>\n</ul>\n\n<p>I'm trying to achieve a mechanism that can automatically do this for arbitrary actions (in C++98). For instance, the following:</p>\n\n<pre><code>myMutex.acquire();\nint a = foo(arg1, arg2, arg3);\nmyMutex.release();\nreturn a;\n</code></pre>\n\n<p>Might become:</p>\n\n<pre><code>return doMutexProtected(myMutex, foo, arg1, arg2, arg3);\n</code></pre>\n\n<p>Or some similar mechanism. The challenge is with how to do this for arbitrary types of <code>a</code> and arbitrary types and numbers of arguments.</p>\n\n<p>I have a sense that there should be a way to do this with templates, but am not sure how to accomplish it. You can do something similar with functors, but you must tell functors their parameter types ahead of time - I'm hoping for a way to have them detected automatically from the original function being called. That way, if (when) the function's parameter list changes, you do not have to update anything but the parameter list you are calling with.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["c++", "windows", "stl", "shared-libraries"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 1, "creation_date": 1548879102, "post_id": 54448758, "comment_id": 95706324, "body": "C++ has no standard abi, this is not supposed to work if you change compiler (or whatsoeven)"}, {"owner": {"reputation": 4090, "user_id": 1223253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RsJjQ.jpg?s=128&g=1", "display_name": "TorbenJ", "link": "https://stackoverflow.com/users/1223253/torbenj"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1548879259, "post_id": 54448758, "comment_id": 95706399, "body": "@OznOg I know that"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548879297, "post_id": 54448758, "comment_id": 95706416, "body": "@TorbenJ Then it seems evident that the answer depends on your platform. You should mention for which platform you are asking in the question by tagging it. Edit : Since you mention DLL, I&#39;ve added the <code>windows</code> tag for you."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1548879309, "post_id": 54448758, "comment_id": 95706419, "body": "then why &quot;I want to assume that the DLL is built using a completely different compiler than the application.&quot;"}, {"owner": {"reputation": 4090, "user_id": 1223253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RsJjQ.jpg?s=128&g=1", "display_name": "TorbenJ", "link": "https://stackoverflow.com/users/1223253/torbenj"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548879427, "post_id": 54448758, "comment_id": 95706475, "body": "@Fran&#231;oisAndrieux thanks. yes I only mean different compilers on the same platform not some sort of cross platform compilation"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548879476, "post_id": 54448758, "comment_id": 95706495, "body": "Possibly <a href=\"https://stackoverflow.com/questions/13625388/is-it-bad-practice-to-allocate-memory-in-a-dll-and-give-a-pointer-to-it-to-a-cli\">related question</a>."}, {"owner": {"reputation": 4090, "user_id": 1223253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RsJjQ.jpg?s=128&g=1", "display_name": "TorbenJ", "link": "https://stackoverflow.com/users/1223253/torbenj"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1548879608, "post_id": 54448758, "comment_id": 95706545, "body": "@OznOg because there isn&#39;t just one compiler on e.g. Windows. Could be the case that I use MSVC to compile the shared library and another developer uses e.g. clang."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1548879912, "post_id": 54448758, "comment_id": 95706671, "body": "well not sure I understand, but as far as the memory layout of things is not guarantied by any standard, objects inside the dll may not be matching anything the application would expect to call, thus may crash. Moreover, allocation may not happen in the same way (maybe the dll uses a custom memory allocator) thus passing things around should not work as well (or at least, one should not expect it to work)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1548882426, "post_id": 54448758, "comment_id": 95707805, "body": "If you don&#39;t compile/link all object files and libraries for your application with the <i>exact same</i> compiler/linker then all bets are off - ABI compatibility wise. The language/standard gives you <i>no</i> guarantees."}, {"owner": {"reputation": 4090, "user_id": 1223253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RsJjQ.jpg?s=128&g=1", "display_name": "TorbenJ", "link": "https://stackoverflow.com/users/1223253/torbenj"}, "edited": false, "score": 0, "creation_date": 1548883169, "post_id": 54448758, "comment_id": 95708148, "body": "Well yes I know that the ABI isn&#39;t standardized in C++ and this may cause problems if one doesn&#39;t use the exact same compiler, let&#39;s tick that of the list. But the ABI part only really matters in 2.) I guess and the other two points depend more on the API."}], "answers": [{"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 0, "last_activity_date": 1548888462, "creation_date": 1548888462, "answer_id": 54450730, "question_id": 54448758, "link": "https://stackoverflow.com/questions/54448758/point-of-code-execution-in-c-and-shared-libraries/54450730#54450730", "title": "Point of code execution in C++ and shared libraries", "body": "<blockquote>\n  <p>1.) What happens if the external application calls foo->SetBar(\"Hello\")?\n  Would SetBar be executed inside the DLL and thus the memory allocation of m_Bar be safe or would the memory allocation happen inside the external application and thus lead to issues?</p>\n</blockquote>\n\n<p>There are many problems, not just concerning memory allocations or mixing up C runtime libraries.</p>\n\n<p>For starters, <code>Foo</code> may not even be the same size, <code>std::string</code> definition may be a completely different one, etc. etc. etc.</p>\n\n<blockquote>\n  <p>2.) What happens if the external application copies the instance pointed to by the returned pointer?\n  Judging by the many posts out there warning against passing std::string over DLL boundaries I assume that caused by potential different ABIs a default copy could cause problems. Is that correct?</p>\n</blockquote>\n\n<p>No need to copy to get into trouble: since you don't know anything about the memory it points to, even <em>using</em> the <code>Foo</code> you were given will break everything.</p>\n\n<blockquote>\n  <p>3.) Would it be safe to define custom copy constructors and assignment operators that construct m_Bar by calling .c_str() on the passed instance so that those methods only rely on the API of std::string and not on the ABI?</p>\n</blockquote>\n\n<p>Your general idea of trying to go to the lowest level is good. However, trying to play with <code>m_Bar</code> isn't.</p>\n\n<p>Instead, provide a plain C interface and optionally provide wrapper classes in a header. And even then, be careful about allocating/deallocating/using system resources if you are linking with different C runtime libraries (in Windows).</p>\n"}], "owner": {"reputation": 4090, "user_id": 1223253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RsJjQ.jpg?s=128&g=1", "display_name": "TorbenJ", "link": "https://stackoverflow.com/users/1223253/torbenj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548888462, "creation_date": 1548878891, "last_edit_date": 1548879327, "question_id": 54448758, "link": "https://stackoverflow.com/questions/54448758/point-of-code-execution-in-c-and-shared-libraries", "title": "Point of code execution in C++ and shared libraries", "body": "<p>A colleague and I were having an interesting discussion about memory allocation when working with shared libraries and \"where\" code is actually executed.</p>\n\n<p><strong>Hint:</strong> I'm explicitly looking for answers in general terms. I know that the following points would work when using the exact same compiler and settings when building the shared library and application. I want to assume that the DLL is built using a completely different compiler than the application.</p>\n\n<p>Given the following <code>struct Foo</code>:  </p>\n\n<pre><code>struct Foo\n{\n    int m_FooBar = 1;\n\n    const char* GetBar()\n    {\n        return m_Bar.c_str();\n    }\n\n    void SetBar(const char* value)\n    {\n        m_Bar = value;\n    }\n\nprivate:\n    std::string m_Bar;\n};\n</code></pre>\n\n<p>Assuming the shared library exposes a function <code>Foo* GetFoo()</code> and an external application calls it:<br>\n1.) What happens if the external application calls <code>foo-&gt;SetBar(\"Hello\")</code>?<br>\nWould <code>SetBar</code> be executed inside the DLL and thus the memory allocation of <code>m_Bar</code> be safe or would the memory allocation happen inside the external application and thus lead to issues?<br>\n2.) What happens if the external application copies the instance pointed to by the returned pointer?<br>\nJudging by the many posts out there warning against passing <code>std::string</code> over DLL boundaries I assume that caused by potential different ABIs a default copy could cause problems. Is that correct?<br>\n3.) Would it be safe to define custom copy constructors and assignment operators that construct <code>m_Bar</code> by calling <code>.c_str()</code> on the passed instance so that those methods only rely on the API of <code>std::string</code> and not on the ABI?  </p>\n\n<p>Hope some C++ gurus can answer some of these questions and shed some light on this topic.</p>\n"}, {"tags": ["c++", "while-loop", "do-while"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1548878695, "post_id": 54448697, "comment_id": 95706142, "body": "What is the <code>1 ||</code> for?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1548878730, "post_id": 54448697, "comment_id": 95706162, "body": "<code>while (1 || [anything])</code> is the same as <code>while(1)</code>. The second operand is never even evaluated."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548878771, "post_id": 54448697, "comment_id": 95706179, "body": "It seems you never read user input into <code>user_input</code> so it never changes. It is always an empty string."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548878777, "post_id": 54448697, "comment_id": 95706183, "body": "<code>while (1 || user_input != &quot;q&quot;);</code> That condition will ever evaluate to <code>true</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548880118, "post_id": 54448697, "comment_id": 95706766, "body": "<code>cin &gt;&gt; price;</code> should fail if you provide <code>q</code>. You can use this to your advantage by ending the loop when <code>!cin</code>."}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 1, "last_activity_date": 1548884377, "last_edit_date": 1548884377, "creation_date": 1548884026, "answer_id": 54449881, "question_id": 54448697, "link": "https://stackoverflow.com/questions/54448697/how-to-exit-do-while-loop-when-user-input-is-q-in-c/54449881#54449881", "title": "How to exit do-while loop when user input is &quot;q&quot; in C++", "body": "<p>The idea is: read a <code>char</code> (not a number); see if it is equal to <code>q</code>. If yes, quit. If not, <code>putback</code> the <code>char</code> and then read a number.</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    char user_input; // note: changed it from string to char\n    double price;\n    while (true) // infinite loop; exit conditions are inside the loop\n    {\n        cin &gt;&gt; ws &gt;&gt; user_input; // note: it's important to discard whitespace\n\n        if (user_input == 'q') // note: changed from \" to '\n            break;\n\n        // Note: for putback to succeed, it must be only 1 byte, cannot be a string\n        cin.putback(user_input);\n\n        if (!(cin &gt;&gt; price))\n            break; // note: exit on error\n\n        // Your code here\n        ...\n\n    }\n}\n</code></pre>\n\n<p>This idea will not work if you want the user to type <code>exit</code> or something else longer than 1 byte. If you need such a long exit command, you must use a traditional parsing mechanism (read a line of input; compare it with <code>exit</code> command; if not equal, <a href=\"https://stackoverflow.com/q/5290089/509868\">convert the string to a number</a>).</p>\n"}], "owner": {"reputation": 9, "user_id": 10981674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab55a711ac7c7a13074805ef659ed355?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10981674/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 0, "accepted_answer_id": 54449881, "answer_count": 1, "score": -3, "last_activity_date": 1548884377, "creation_date": 1548878655, "last_edit_date": 1548883781, "question_id": 54448697, "link": "https://stackoverflow.com/questions/54448697/how-to-exit-do-while-loop-when-user-input-is-q-in-c", "title": "How to exit do-while loop when user input is &quot;q&quot; in C++", "body": "<p>I want to exit the loop if the user presses \"q\" but when I press q, it goes into an infinite loop. What is wrong with my if statement? Why does it not recognize when the user presses \"q\"?</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\nstring user_input;\ndouble price;\ndo\n{\n    cin &gt;&gt; price;\n    int multiple = price * 100;\n    if (user_input == \"q\")\n    {\n        break;\n    }\n    else if (multiple % 5 == 0)\n    {\n        cout &lt;&lt; \"This is a multiple of 0.05\" &lt;&lt; endl;\n        return 1;\n    }\n    else\n    {\n        cout &lt;&lt; \"No multiple\" &lt;&lt; endl;\n    }\n} while (1 || user_input != \"q\");\nsystem(\"pause\");\n} \n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1548877677, "post_id": 54448408, "comment_id": 95705749, "body": "Can you elaborate on why no loops? Just curious, because it sounds a little arbitrary."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1548877808, "post_id": 54448408, "comment_id": 95705808, "body": "<code>memcpy</code> uses a loop."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548877985, "post_id": 54448408, "comment_id": 95705856, "body": "Seems you are assuming <code>int</code> is 16 bits which is very rare, much less guaranteed."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2087181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba97e3909c3ae8850489d5fd2dbca6c?s=128&d=identicon&r=PG&f=1", "display_name": "JaberRouhi", "link": "https://stackoverflow.com/users/2087181/jaberrouhi"}, "edited": false, "score": 0, "creation_date": 1548878609, "post_id": 54448527, "comment_id": 95706104, "body": "is there any solution if the arrangement was : uchar a={HighByte_val1 LowByte_val1 HighByte_val2 LowByte_val2 ...};    ????"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 15, "user_id": 2087181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba97e3909c3ae8850489d5fd2dbca6c?s=128&d=identicon&r=PG&f=1", "display_name": "JaberRouhi", "link": "https://stackoverflow.com/users/2087181/jaberrouhi"}, "edited": false, "score": 0, "creation_date": 1548878622, "post_id": 54448527, "comment_id": 95706112, "body": "@user2087181 Yay! I&#39;m glad."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1548878679, "post_id": 54448527, "comment_id": 95706136, "body": "@OznOg Please explain. What do you mean by &quot;little endian arch&quot;? Can I read about it somewhere?"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1548878840, "post_id": 54448527, "comment_id": 95706214, "body": "see <a href=\"https://stackoverflow.com/questions/12825632/when-endianess-does-matter-cast-operations\" title=\"when endianess does matter cast operations\">stackoverflow.com/questions/12825632/&hellip;</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": true, "score": 0, "last_activity_date": 1548880211, "last_edit_date": 1548880211, "creation_date": 1548878019, "answer_id": 54448527, "question_id": 54448408, "link": "https://stackoverflow.com/questions/54448408/how-to-convert-char-array-of-low-and-high-bytes-to-int-array-of-them-without-u/54448527#54448527", "title": "how to convert char array of low and high bytes to int array of them , without using loop?", "body": "<p>You could use:</p>\n\n<pre><code>char c[size];\nint *i = (int*)c;\n</code></pre>\n\n<p>This would allow you to access the same data as both an int and a char.</p>\n\n<p>Keep in mind though (as I'm sure you already are) that ints and chars are not the same size. The int array will be much \"shorter\".</p>\n\n<p><strong>EDIT:</strong> Someone has pointed out that this only works with little endian architecture. If you need a big endian solution, I will point you to <a href=\"https://www.ibm.com/developerworks/aix/library/au-endianc/index.html\" rel=\"nofollow noreferrer\">this tutorial</a>. If you don't know what either of those are, I point you to <a href=\"https://stackoverflow.com/questions/12825632/when-endianess-does-matter-cast-operations\">this question</a> and the above tutorial.</p>\n"}], "owner": {"reputation": 15, "user_id": 2087181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba97e3909c3ae8850489d5fd2dbca6c?s=128&d=identicon&r=PG&f=1", "display_name": "JaberRouhi", "link": "https://stackoverflow.com/users/2087181/jaberrouhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 54448527, "answer_count": 1, "score": 0, "last_activity_date": 1548880211, "creation_date": 1548877632, "question_id": 54448408, "link": "https://stackoverflow.com/questions/54448408/how-to-convert-char-array-of-low-and-high-bytes-to-int-array-of-them-without-u", "title": "how to convert char array of low and high bytes to int array of them , without using loop?", "body": "<p>I have an uchar array with this arrangement :</p>\n\n<p><code>uchar a={LowByte_val1 HighByte_val1 LowByte_val2 HighByte_val2 ...};</code></p>\n\n<p>how to i can convert this array to (without loop)</p>\n\n<p><code>uint b= [val1 val2 ...];</code></p>\n\n<p>where</p>\n\n<pre><code>val1 = LowByte_val1+(HighByte_val1&lt;&lt;8);\n</code></pre>\n\n<p>I use this solution.</p>\n\n<pre><code>typedef union {\n           struct { \n                    uchar lsb; \n                    uchar msb; \n                  }byteModel;\n         unsigned int data; \n   }XXX;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>uchar a[24]={0,0,0,1,0,2,0,3, 1,0,1,1,1,2,1,3, 2,0,1,1,2,2,2,3}; \nXXX *input = new XXX[12];\n</code></pre>\n\n<p>and then :</p>\n\n<pre><code>memcpy(input,a,24);\n</code></pre>\n\n<p>but not worked :(.</p>\n"}, {"tags": ["c++", "opengl", "graphics", "3d", "shader"], "comments": [{"owner": {"reputation": 125, "user_id": 6205530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156786367460023/picture?type=large", "display_name": "Fernando Andreas Sahmkow Beico", "link": "https://stackoverflow.com/users/6205530/fernando-andreas-sahmkow-beico"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1548878338, "post_id": 54448334, "comment_id": 95705999, "body": "must be the same location. I cannot duplicate it as I&#39;m emulating a GPU."}, {"owner": {"reputation": 125, "user_id": 6205530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156786367460023/picture?type=large", "display_name": "Fernando Andreas Sahmkow Beico", "link": "https://stackoverflow.com/users/6205530/fernando-andreas-sahmkow-beico"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1548882880, "post_id": 54448334, "comment_id": 95708022, "body": "done, ty for the observation."}], "owner": {"reputation": 125, "user_id": 6205530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156786367460023/picture?type=large", "display_name": "Fernando Andreas Sahmkow Beico", "link": "https://stackoverflow.com/users/6205530/fernando-andreas-sahmkow-beico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1548881245, "creation_date": 1548877340, "last_edit_date": 1548881245, "question_id": 54448334, "link": "https://stackoverflow.com/questions/54448334/doing-perspective-correction-per-component-in-a-fragment-shader", "title": "Doing perspective correction per component in a fragment shader", "body": "<p>I'm currently trying to emulate an NVIDIA GPU but I have some problems with setting input variables from a shader. I require something like this in glsl:</p>\n\n<pre><code>layout(location = 0) in noperspective vec4 value1;\nlayout(location = 0) in smooth vec4 value1_alias;\n</code></pre>\n\n<p>Sadly that code is illegal in openGL. Interpolation aliasing is not permitted. In general, I want certain components of the vector to be \"perspective corrected\" and others to be obtained linearly. it's vital that this is done in the correct order for each component. I also must use the exact same attribute slot (location), I'm emulating a GPU thus each attribute is set by it and I cannot duplicate values.</p>\n\n<p>What I tried doing was to take all values as noperspective and do the perspective correction inside the shader. My approach was simply multiply the value by <code>(1 / glFragCoord.w)</code>. Sadly this does not seem to work. I'm not sure if the theory I'm following is flawed or the <code>glFragCoord.w</code> value I'm recieving from my fragment shader is incorrect. (I do set <code>glPosition</code> with w as 1.0)</p>\n\n<p>With all this in mind? What approach could I take to do the perspective correction on independent values?</p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548877610, "post_id": 54448277, "comment_id": 95705716, "body": "Might need to know a little bit more.  Usually you upload the texture with glTexImage2D.  Would it not be more appropriate to read the value there before you upload it to the GPU?  If this is a rendered texture then yes, you&#39;ll have to read back the texture contents using glGetTexImage.  What part of that do you need help with?"}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548877717, "post_id": 54448277, "comment_id": 95705766, "body": "You can also consider glReadPixels if your texture is attached to an FBO."}, {"owner": {"reputation": 77, "user_id": 8200210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d24045f21dd5ed5cd4c85621e3093e3?s=128&d=identicon&r=PG", "display_name": "MadCreativity", "link": "https://stackoverflow.com/users/8200210/madcreativity"}, "reply_to_user": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548878920, "post_id": 54448277, "comment_id": 95706253, "body": "@Wyck I&#39;ve edited my question a little bit for context. Let me know if you need any other information."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548879244, "post_id": 54448277, "comment_id": 95706394, "body": "You have <code>unsigned char *image</code>.  That&#39;s a pointer to the image data.  All the bytes of your pixels are right there.  Do you just need to know how to access the memory to get the RGB for a particular x,y pixel given the raw storage?"}, {"owner": {"reputation": 77, "user_id": 8200210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d24045f21dd5ed5cd4c85621e3093e3?s=128&d=identicon&r=PG", "display_name": "MadCreativity", "link": "https://stackoverflow.com/users/8200210/madcreativity"}, "reply_to_user": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548879847, "post_id": 54448277, "comment_id": 95706642, "body": "@Wyck I didn&#39;t even realize the <code>unsigned char* image</code> pointed to the image data, but anything else would be stupid, now that I think about it. Anyway, yeah, I want the RGB values (or, alternatively, a single hex value) for an [x, y] pixel from said image. Do you know how I might do that?"}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548880466, "post_id": 54448277, "comment_id": 95706916, "body": "Looks like you have <code>GL_UNSINGED_BYTE</code> with <code>GL_RGBA</code>.  So the address of a pixel is <code>unsigned char* pixel = image + row * width * 4 + column * 4</code> Then the 4 bytes there <code>pixel[channel]</code> ... are in RGBA channel index order. Do you know how to do that?"}, {"owner": {"reputation": 77, "user_id": 8200210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d24045f21dd5ed5cd4c85621e3093e3?s=128&d=identicon&r=PG", "display_name": "MadCreativity", "link": "https://stackoverflow.com/users/8200210/madcreativity"}, "reply_to_user": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548880843, "post_id": 54448277, "comment_id": 95707079, "body": "@Wyck I&#39;m afraid not. The address math makes sense, but I don&#39;t know how to actually use it in context."}, {"owner": {"reputation": 131, "user_id": 8434591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xKXn6.jpg?s=128&g=1", "display_name": "Fox42", "link": "https://stackoverflow.com/users/8434591/fox42"}, "edited": false, "score": 0, "creation_date": 1608508647, "post_id": 54448277, "comment_id": 115598662, "body": "I have the same problem, but, when I attach my texture to an FBO, I always got black screen. Does anyone have similar problem?"}], "answers": [{"comments": [{"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1548881151, "post_id": 54449223, "comment_id": 95707253, "body": "...and obviously in real-world code I would either write this into a getPixel function or do something more optimal based on what else might need to be done with the image."}, {"owner": {"reputation": 77, "user_id": 8200210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d24045f21dd5ed5cd4c85621e3093e3?s=128&d=identicon&r=PG", "display_name": "MadCreativity", "link": "https://stackoverflow.com/users/8200210/madcreativity"}, "edited": false, "score": 0, "creation_date": 1548881572, "post_id": 54449223, "comment_id": 95707454, "body": "I can barely believe I couldn&#39;t figure this out myself. It&#39;s super simple. Anyway, thank you so much. This is exactly what I was looking for. I was clearly making it way too complicated for myself. Thanks again for the help."}], "tags": [], "owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "is_accepted": true, "score": 3, "last_activity_date": 1548880982, "creation_date": 1548880982, "answer_id": 54449223, "question_id": 54448277, "link": "https://stackoverflow.com/questions/54448277/get-colour-of-specific-pixel-in-an-opengl-texture/54449223#54449223", "title": "Get colour of specific pixel in an OpenGL texture?", "body": "<p>Assuming you are interested in a pixel at coordinates column <code>x</code> and row <code>y</code>, then:</p>\n\n<pre><code>unsigned char* image = SOIL_load_image(filename, widthVar, heightVar, NULL, SOIL_LOAD_RGBA);\nint width = *widthVar;\n\nunsigned char* pixel = image + y * width * 4 + x * 4;\n\nunsigned char red = pixel[0];\nunsigned char green = pixel[1];\nunsigned char blue = pixel[2];\nunsigned char alpha = pixel[3];\n</code></pre>\n\n<p>Error checking of the SOIL_load_image function is left for to you to add.  I would fully expect it to return nullptr if the filename didn't exist, for example.</p>\n"}], "owner": {"reputation": 77, "user_id": 8200210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d24045f21dd5ed5cd4c85621e3093e3?s=128&d=identicon&r=PG", "display_name": "MadCreativity", "link": "https://stackoverflow.com/users/8200210/madcreativity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 1, "accepted_answer_id": 54449223, "answer_count": 1, "score": 1, "last_activity_date": 1548880982, "creation_date": 1548877095, "last_edit_date": 1548878869, "question_id": 54448277, "link": "https://stackoverflow.com/questions/54448277/get-colour-of-specific-pixel-in-an-opengl-texture", "title": "Get colour of specific pixel in an OpenGL texture?", "body": "<p>I'm trying to get the colour of a specific pixel from a specific texture using OpenGL (C++). I've been looking at <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetTexImage.xhtml\" rel=\"nofollow noreferrer\"><code>glGetTexImage()</code></a> since it looks somewhat like what I want, but I can't figure out the context in which I should put it. Am I wrong? It doesn't need to be the fastest option since it's not a frame-by-frame thing; just when the game starts up.</p>\n\n<p>The texture isn't going to be rendered to the screen and is just used as a way to get information. I use the following function to load the texture.</p>\n\n<pre><code>GLuint TextureUtil::loadTexture(const char* filename, int* widthVar, int* heightVar) {\n        unsigned char* image = SOIL_load_image(filename, widthVar, heightVar, NULL, SOIL_LOAD_RGBA);\n\n        GLuint texture;\n        glGenTextures(1, &amp;texture);\n        glBindTexture(GL_TEXTURE_2D, texture);\n\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);\n\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\n\n\n        if (image) {\n            glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, *widthVar, *heightVar, 0, GL_RGBA, GL_UNSIGNED_BYTE, image);\n            glGenerateMipmap(GL_TEXTURE_2D);\n        } else {\n            std::cout &lt;&lt; \"ERROR: TextureUtil.cpp - Texture loading failed.\" &lt;&lt; std::endl;\n        }\n\n        glActiveTexture(0);\n        glBindTexture(GL_TEXTURE_2D, 0);\n        SOIL_free_image_data(image);\n\n        return texture;\n    }\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1548876665, "post_id": 54448147, "comment_id": 95705240, "body": "Which compiler/version(s) have you tried?"}, {"owner": {"reputation": 401, "user_id": 5843327, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xye55.jpg?s=128&g=1", "display_name": "conchoecia", "link": "https://stackoverflow.com/users/5843327/conchoecia"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1548876922, "post_id": 54448147, "comment_id": 95705400, "body": "I&#39;m using g++ 7.8.0 for this project. Trying clang now..."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1548877058, "post_id": 54448147, "comment_id": 95705471, "body": "I think viable way would be to create/override <code>std::pair</code> with object with constructor that accepts <code>int</code> as override and rejects negative ones. Probably it is even possible to raise compilation error on negative constants, but not sure if benefit would worse the effort."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1548877280, "post_id": 54448147, "comment_id": 95705572, "body": "i am not sure if I understand the question. Is it basically why <code>std::pair&lt;uint64_t,uint64_t&gt; x{-1,-2};</code> does not produce an error and how to make it cause an error?"}, {"owner": {"reputation": 401, "user_id": 5843327, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xye55.jpg?s=128&g=1", "display_name": "conchoecia", "link": "https://stackoverflow.com/users/5843327/conchoecia"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548877344, "post_id": 54448147, "comment_id": 95705605, "body": "@user463035818, correct - that is what I am trying to ask."}, {"owner": {"reputation": 1961, "user_id": 7022459, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/646lY.png?s=128&g=1", "display_name": "Apollys supports Monica", "link": "https://stackoverflow.com/users/7022459/apollys-supports-monica"}, "edited": false, "score": 1, "creation_date": 1548877503, "post_id": 54448147, "comment_id": 95705666, "body": "I think the problem here is that the ability to use negative values to initialize unsigned integral types is an intentional feature of the language (used in the standard library I believe).  For example, <code>size_t max_value = -1</code>.  And as for conversions, I don&#39;t see any narrowing conversions - your values got placed into the map correctly."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548878892, "post_id": 54448587, "comment_id": 95706241, "body": "does <code>make_pair</code> really warn about it? Maybe i missed it then I could delete my answer"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1548878993, "post_id": 54448587, "comment_id": 95706284, "body": "ah i missed <code>-Wsign-conversion</code>"}], "tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": true, "score": 4, "last_activity_date": 1548879250, "last_edit_date": 1548879250, "creation_date": 1548878218, "answer_id": 54448587, "question_id": 54448147, "link": "https://stackoverflow.com/questions/54448147/why-is-narrowing-conversion-not-preventing-this-map-insert-of-an-incorrect-typ/54448587#54448587", "title": "Why is narrowing conversion not preventing this map.insert() of an incorrect type from failing?", "body": "<blockquote>\n  <p>Why does <code>std::pair&lt;uint64_t,uint64_t&gt; x{-1,-2}</code> not produce an error?</p>\n</blockquote>\n\n<p>This is caused by a constructor template that participates in overload resolution when both arguments can be used to construct objects of <code>uint64_t</code> (or whatever type you instantiated <code>std::pair</code> with). It is overload (3) in the list of <code>std::pair</code> <a href=\"https://en.cppreference.com/w/cpp/utility/pair/pair\" rel=\"nofollow noreferrer\">constructors</a>, and its template argument deduction leads to a conversion that is taken as <em>intentional</em> (as in <code>auto n = uint64_t{-42};</code> or <code>static_cast&lt;uint64_t&gt;(-42);</code>) - hence no warning. There's not much you can do about it, as the template parameters of a constructor template can't be given explicitly, as <a href=\"https://stackoverflow.com/questions/2786946/c-invoke-explicit-template-constructor\">explained here</a>.</p>\n\n<blockquote>\n  <p>[...] how to make it cause an error?</p>\n</blockquote>\n\n<p>Use <code>std::make_pair</code> and don't rely on template argument deduction:</p>\n\n<pre><code>auto p = std::make_pair&lt;uint64_t, uint64_t&gt;(-42, -42);\n//         Be explicit: ^^^^^^^^  ^^^^^^^^\n</code></pre>\n\n<p>When you compile the above snippet with <code>-Wsign-conversion</code> (important: <code>-Wconversion</code> won't cath it!), it will give you a warning (obviously, add <code>-Werror</code>  to treat it as an error).</p>\n\n<p>The issue with <code>std::map::insert</code> is the same, see overload (2) <a href=\"https://en.cppreference.com/w/cpp/container/map/insert\" rel=\"nofollow noreferrer\">here</a>. This turns any usable given argument into a <code>value_type</code> object, and treats it as any conversion would be the caller's intention. Interestingly, the equivalent member function on a <code>std::set</code> is more restricted. So this is caught:</p>\n\n<pre><code>std::set&lt;uint64_t&gt; s;\n\ns.insert(-42); // complains with -Wsign-conversion\n</code></pre>\n"}], "owner": {"reputation": 401, "user_id": 5843327, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xye55.jpg?s=128&g=1", "display_name": "conchoecia", "link": "https://stackoverflow.com/users/5843327/conchoecia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 54448587, "answer_count": 1, "score": 4, "last_activity_date": 1548883721, "creation_date": 1548876528, "last_edit_date": 1548883721, "question_id": 54448147, "link": "https://stackoverflow.com/questions/54448147/why-is-narrowing-conversion-not-preventing-this-map-insert-of-an-incorrect-typ", "title": "Why is narrowing conversion not preventing this map.insert() of an incorrect type from failing?", "body": "<h2>Background</h2>\n\n<p>When inserting a <code>std::pair&lt;uint64_t, uint64_t&gt;</code> to a C++ <code>std::map&lt;uint64_t, int&gt;</code>, neither the compiler nor the program complains, even if the passed values are not possible for the data type <code>uint64_t</code>. </p>\n\n<p>In other words, the <strong>narrowing conversion</strong> of <code>std::pair&lt;uint64_t, uint64_t&gt;(2, -2)</code> isn't working and is defaulting to the map's type <code>std::map&lt;uint64_t, int&gt;</code></p>\n\n<h2>Code</h2>\n\n<p>When I compile and execute the following code with <code>g++ -Wall -Wconversion -Wextra -pedantic test/test_wrong_insert.cpp &amp;&amp; ./a.out</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;map&gt;\n#include&lt;iostream&gt;\n\nvoid print_map(std::map&lt;uint64_t, int&gt; &amp; m){\n  std::cout &lt;&lt; \"The map is now: {\";\n  for (const auto &amp; n: m){\n    std::cout &lt;&lt; '(' &lt;&lt; n.first &lt;&lt; ',' &lt;&lt; n.second &lt;&lt; \") \";\n  }\n  std::cout &lt;&lt; \"}\\n\";\n}\n\nint main(){\n  std::map&lt;uint64_t, int&gt; m;\n\n  auto ret = m.insert(std::pair&lt;uint64_t, uint64_t&gt;(2,-2));\n  std::cout &lt;&lt; \"Tried to insert std::pair&lt;uint64_t, uint64_t&gt;(2,-2). \";\n  std::cout &lt;&lt; \"Return: \" &lt;&lt; ret.second &lt;&lt; '\\n';\n  print_map(m);\n}\n</code></pre>\n\n<h2>Result</h2>\n\n<p>... this is the output:</p>\n\n<pre><code>Tried to insert std::pair&lt;uint64_t, uint64_t&gt;(2,-2). Return: 1\nThe map is now: {(2,-2) }\n</code></pre>\n\n<h2>Question</h2>\n\n<p>Why does <code>std::pair&lt;uint64_t,uint64_t&gt; x{-1,-2}</code> not produce an error, and how do I make it cause an error?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1548875708, "post_id": 54447954, "comment_id": 95704774, "body": "Why does the manager need to hold on to the texture?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1548875828, "post_id": 54447954, "comment_id": 95704826, "body": "Do you want a <a href=\"https://en.cppreference.com/w/cpp/memory/weak_ptr\" rel=\"nofollow noreferrer\"><code>std::weak_ptr</code></a>?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1548875838, "post_id": 54447954, "comment_id": 95704831, "body": "One approach (assuming you can&#39;t just get rid of the <code>_textures</code> vector entirely) would be to have <code>_textures</code> hold objects of type <code>weak_ptr&lt;Texture&gt;</code> instead of <code>shared_ptr&lt;Texture&gt;</code>.   <a href=\"https://en.cppreference.com/w/cpp/memory/weak_ptr\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/weak_ptr</a>"}, {"owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "edited": false, "score": 0, "creation_date": 1548875986, "post_id": 54447954, "comment_id": 95704909, "body": "Resource manager must know memory usage for all textures. I also want to make a special logic when deleting a texture (asynchronously in another thread)."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1548876181, "post_id": 54447954, "comment_id": 95705015, "body": "So you just want the resource manager to be notified somehow when a texture is deleted elsewhere, but not actually to keep it alive? Which thread should your special logic be executed in?"}, {"owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "edited": false, "score": 0, "creation_date": 1548876355, "post_id": 54447954, "comment_id": 95705088, "body": "How does the resource manager know that the number of references == 0?"}, {"owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1548876642, "post_id": 54447954, "comment_id": 95705224, "body": "@Useless Yes, I want the resource manager to be notified that no one else uses the texture and it can be released. Inside the resource manager there is a thread that removes resources."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548876990, "post_id": 54447954, "comment_id": 95705438, "body": "ResourceManager can use the <code>use_count</code> method to make sure no other owners for the resource and destroy it. <a href=\"https://en.cppreference.com/w/cpp/memory/shared_ptr/use_count\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/shared_ptr/use_count</a>"}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548877309, "post_id": 54447954, "comment_id": 95705589, "body": "So you want to make sure destructor of the resource runs in a specific thread?"}, {"owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548877435, "post_id": 54447954, "comment_id": 95705637, "body": "@balki checking all counters in all textures can take a long time"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548896153, "post_id": 54447954, "comment_id": 95712068, "body": "@balki It shouldn&#39;t matter which thread it happens in, if you use proper synchronisation"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "edited": false, "score": 1, "creation_date": 1548877302, "post_id": 54448048, "comment_id": 95705584, "body": "Does this mean that I need to re-implement the shared_ptr with callback in constructor?"}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "reply_to_user": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "edited": false, "score": 0, "creation_date": 1548878509, "post_id": 54448048, "comment_id": 95706069, "body": "Yes, you would pass the callback in at creation of the smart pointer and then call the callback in the smart pointer&#39;s destructor."}], "tags": [], "owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "is_accepted": false, "score": 2, "last_activity_date": 1548878679, "last_edit_date": 1548878679, "creation_date": 1548876102, "answer_id": 54448048, "question_id": 54447954, "link": "https://stackoverflow.com/questions/54447954/how-to-make-not-owning-pointers-like-shared-ptr/54448048#54448048", "title": "How to make not owning pointers like shared_ptr?", "body": "<p>I think what you're asking for is a <code>shared_ptr</code> that invokes a callback when the count is decremented to 1. Your manager registers for that callback in the <code>CreateTexture()</code> function when it creates the smart pointer and then checks whether to invoke it whenever someone decrements the reference count.</p>\n\n<p>Corner case to watch out for: the count will start as 1, and you don't want to delete it then.</p>\n\n<p>Compare the <a href=\"http://www.cs.technion.ac.il/users/yechiel/c++-faq/ref-count-simple.html\" rel=\"nofollow noreferrer\">C++ FAQ's implementation</a> of an intrusive reference-counted smart pointer as a starting point. The work ahead of you is to add a <code>std::function</code> or other callable to be invoked at the right time.</p>\n\n<p>Implementing smart pointers can be a little tricky, especially when you mix in threading, but for other starting points, you can compare implementations from <a href=\"https://www.boost.org/doc/libs/1_69_0/libs/smart_ptr/doc/html/smart_ptr.html#shared_ptr\" rel=\"nofollow noreferrer\"><code>boost::shared_ptr</code></a>, which became standardized, and <a href=\"https://github.com/snaewe/loki-lib\" rel=\"nofollow noreferrer\">Loki</a>'s <a href=\"https://github.com/snaewe/loki-lib/blob/master/include/loki/SmartPtr.h\" rel=\"nofollow noreferrer\"><code>SharedPtr</code></a>, which is described in the classic <em>Modern C++ Design</em> by Alexandrescu.</p>\n\n<p>An alternative to re-implementing <code>shared_ptr</code> would be to use its custom deleter to invoke the callback, but you'll have to play some games to make that work.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "edited": false, "score": 0, "creation_date": 1548878124, "post_id": 54448196, "comment_id": 95705907, "body": "Thank. It seems to best idea is store a raw pointer, and provide custom deleter"}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1548878628, "post_id": 54448196, "comment_id": 95706118, "body": "If you make it a little intrusive into the class (or wrap the class in a helper), it could hold a reference to itself and not have to lookup the texture -- a trade-off of space for time."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1548896023, "post_id": 54448196, "comment_id": 95712025, "body": "@metal Arguably yes, but I think you&#39;ll find some people questioning such a self-referential design"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "edited": false, "score": 0, "creation_date": 1548896056, "post_id": 54448196, "comment_id": 95712037, "body": "@push\u0440\u043e\u0440 Basically. Though, for the record, I put this into production with <code>weak_ptr</code> and never had a problem"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 2, "last_activity_date": 1548876756, "creation_date": 1548876756, "answer_id": 54448196, "question_id": 54447954, "link": "https://stackoverflow.com/questions/54447954/how-to-make-not-owning-pointers-like-shared-ptr/54448196#54448196", "title": "How to make not owning pointers like shared_ptr?", "body": "<p>What you need is:</p>\n\n<ul>\n<li>A vector of <code>weak_ptr</code> instead of <code>shared_ptr</code></li>\n<li>A <code>shared_ptr</code> whose deleter function (invoked when no more non-weak references are in scope) looks up the object in the vector and removes that entry</li>\n</ul>\n\n<p>A custom deleter may be provided using the <code>shared_ptr</code> constructor. Be sure to actually do the deletion as well, because that behaviour will no longer be automatic.</p>\n\n<p>Also be careful about <a href=\"https://stackoverflow.com/q/38426719/560648\">some confusions with respect to <code>weak_ptr</code> behaviour during deleter invocation</a>; you could always <a href=\"https://stackoverflow.com/a/19066388/560648\">switch to a raw pointer instead</a> which basically has the same effect without any of the burning questions.</p>\n\n<p>Note that this change makes your manager no longer \"own\" the textures, but per your described semantics (<em>\"delete a resource when only the manager owns it\"</em>) it never really did anyway.</p>\n"}], "owner": {"reputation": 59, "user_id": 6133844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c2f7c5d405a55f09801a8c07436f16?s=128&d=identicon&r=PG&f=1", "display_name": "push \u0440\u043e\u0440", "link": "https://stackoverflow.com/users/6133844/push-%d1%80%d0%be%d1%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 54448196, "answer_count": 2, "score": 2, "last_activity_date": 1548878679, "creation_date": 1548875656, "last_edit_date": 1548875704, "question_id": 54447954, "link": "https://stackoverflow.com/questions/54447954/how-to-make-not-owning-pointers-like-shared-ptr", "title": "How to make not owning pointers like shared_ptr?", "body": "<p>In my resource manager, the createTexture method should produce a pointer to the texture. And I want to delete a resource when only the manager owns it. How can I achieve this? If I use shared_ptr, the resource manager will store its shared_ptr pointer to the texture and will not be able to delete it.</p>\n\n<pre><code>class ResourceManager\n{\n    vector&lt;shared_ptr&lt;Texture&gt;&gt; _textres;\n\npublic:\n    shared_ptr&lt;Texture&gt; CreateTexture()\n    {\n        auto tex = shared_ptr&lt;Texture&gt;(new Texture);\n        _textures.push_back(tex);\n        return tex;\n    }\n}\n\nint main\n{\n    ResourceManager rm;\n\n    {\n        auto tex = rm.CreateTexture();\n        // Do something with texture...\n    }\n\n    // Problem here: ResourceManager doesn't remove the texture because he owns it\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 5, "creation_date": 1548874631, "post_id": 54447662, "comment_id": 95704246, "body": "Well, in the first case you don\u2019t initialize it. It can be any value."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1548874655, "post_id": 54447662, "comment_id": 95704261, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13423673/what-is-indeterminate-value\" title=\"what is indeterminate value\">stackoverflow.com/questions/13423673/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548874861, "post_id": 54447662, "comment_id": 95704369, "body": "@dyukha It&#39;s not so much that is can have any value. It&#39;s value is indeterminate. Reading it is UB which goes beyond simply not knowing what the value is."}, {"owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548875231, "post_id": 54447662, "comment_id": 95704549, "body": "@Fran&#231;oisAndrieux, Dereferencing it is UB.  Reading it isn&#39;t."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1548875243, "post_id": 54447662, "comment_id": 95704556, "body": "As far as I can tell in the standard, only &quot;[o]bjects with static or thread storage duration are zero-initialized, see 6.8.3.2.&quot; As this is neither of those, it has an indeterminate value (Section 6.6.4)."}], "answers": [{"comments": [{"owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548875018, "post_id": 54447771, "comment_id": 95704449, "body": "Because that&#39;s a separate topic so I didn&#39;t want to pollute the answer.  But thanks for the link."}, {"owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548875310, "post_id": 54447771, "comment_id": 95704592, "body": "Thanks, made a clarification."}], "tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": false, "score": 1, "last_activity_date": 1548875055, "last_edit_date": 1548875055, "creation_date": 1548874925, "answer_id": 54447771, "question_id": 54447662, "link": "https://stackoverflow.com/questions/54447662/initialize-a-pointer-to-an-object/54447771#54447771", "title": "Initialize a pointer to an object", "body": "<p>In the first case <code>listNode* head_node;</code> the compiler will allocate some memory to hold the pointer.  That memory can contain any value (for example it could be some random value from when that location was used for something else) and, in fact, reading it will result in undefined behavior.</p>\n\n<p>In the second case <code>listNode* head_node = NULL;</code>, the compiler will allocate some memory to hold the pointer and then write <code>NULL</code> to that location so the pointer is guaranteed to be <code>NULL</code>.</p>\n\n<p>One thing to note, you should use <code>nullptr</code> as opposed to <code>NULL</code>.  See <a href=\"https://stackoverflow.com/questions/20509734/null-vs-nullptr-why-was-it-replaced\">this answer</a> for why.</p>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "is_accepted": false, "score": 0, "last_activity_date": 1548876521, "creation_date": 1548876521, "answer_id": 54448145, "question_id": 54447662, "link": "https://stackoverflow.com/questions/54447662/initialize-a-pointer-to-an-object/54448145#54448145", "title": "Initialize a pointer to an object", "body": "<p>In the first case, you are declaring a pointer variable. In the second case, you are declaring a pointer variable and initializing it to <code>NULL</code>. Any variable that is declared but not initialized leads to <em>undefined behaviour</em> when you try to access the variable. This has nothing to do specifically with pointers, pointers are just like any other variable. For example, if you write <code>int a;</code> and then you <code>cout &lt;&lt; a;</code> you will see that <code>a</code> most likely has a random integer value written in it. But if you write <code>int a = 0;</code> and then you <code>cout &lt;&lt; a;</code> you will see that <code>a</code> is always 0 on any compiler on any machine. This is well defined behaviour as opposed to undefined behaviour.</p>\n\n<p>I would discourage the use of raw pointers in your case, as you most likely want always them to be initialized to <code>nullptr</code>, plus your listNode is most likely \"owned\" by the list itself. Try to use <code>std::unique_ptr&lt;listNode&gt;</code> instead: it will both initialize you pointer to <code>nullptr</code> by default and release the allocated memory when the pointer goes out of scope, meaning that if the head of the list will be deleted, all the other nodes in the list will automatically be deleted as well.</p>\n"}], "owner": {"reputation": 21, "user_id": 10635016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Timothy Huang", "link": "https://stackoverflow.com/users/10635016/timothy-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548876521, "creation_date": 1548874538, "last_edit_date": 1548874972, "question_id": 54447662, "link": "https://stackoverflow.com/questions/54447662/initialize-a-pointer-to-an-object", "title": "Initialize a pointer to an object", "body": "<p>Given an object, e.g. listNode.</p>\n\n<p>If I initialize a pointer to an object with:</p>\n\n<pre><code>listNode* head_node;\n</code></pre>\n\n<p>How is this any different from</p>\n\n<pre><code>listNode* head_node = NULL;\n</code></pre>\n"}, {"tags": ["c++", "arrays", "allocation"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548874545, "post_id": 54447649, "comment_id": 95704197, "body": "I&#39;d recommend to use <code>std::array</code> instead."}, {"owner": {"reputation": 168, "user_id": 6035735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e55734341b83b16781e20b13afdaf0?s=128&d=identicon&r=PG&f=1", "display_name": "Rodney Price", "link": "https://stackoverflow.com/users/6035735/rodney-price"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548874569, "post_id": 54447649, "comment_id": 95704211, "body": "It&#39;s not my code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1548874707, "post_id": 54447649, "comment_id": 95704285, "body": "I&#39;ve reopened the Q as it appears the OP knows about array decaying.  They are wondering why the Author did not use it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548874747, "post_id": 54447649, "comment_id": 95704300, "body": "This is one of those sneaky c++ gotchas. In every other case <code>char longstr1[130]</code> would mean an array of 130 <code>char</code>s. But in function parameters it&#39;s actually a <code>char*</code> and the size is never enforced or checked. At best, it&#39;s an indication of the <i>expected</i> array size for others who would use the function."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548875180, "post_id": 54447649, "comment_id": 95704525, "body": "@NathanOliver On rereading I&#39;m not sure about that. They do suggest <code>char*</code> as an alternative, but given that they&#39;re asking what <code>char[130]</code> here <i>does</i> (and that they ask in the title whether the obvious interpretation is possible) I think a broad answer is called for. Dupe probably not directly useful, agreed."}], "answers": [{"tags": [], "owner": {"reputation": 7821, "user_id": 954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed8998ef7c610932db0159960df1a24?s=128&d=identicon&r=PG", "display_name": "Ted Percival", "link": "https://stackoverflow.com/users/954/ted-percival"}, "is_accepted": false, "score": 1, "last_activity_date": 1548874580, "creation_date": 1548874580, "answer_id": 54447679, "question_id": 54447649, "link": "https://stackoverflow.com/questions/54447649/can-you-declare-a-fixed-length-array-in-a-function-declaration/54447679#54447679", "title": "Can you declare a fixed-length array in a function declaration?", "body": "<p>It's the same thing; the declaration decays to <code>char *longstr1</code>, but it's more informative to someone reading the API that it expects a buffer of exactly 130 characters.</p>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1548874766, "post_id": 54447704, "comment_id": 95704308, "body": "Or one could pass by reference which would force passing an array of the stated size."}, {"owner": {"reputation": 168, "user_id": 6035735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e55734341b83b16781e20b13afdaf0?s=128&d=identicon&r=PG&f=1", "display_name": "Rodney Price", "link": "https://stackoverflow.com/users/6035735/rodney-price"}, "edited": false, "score": 0, "creation_date": 1548875106, "post_id": 54447704, "comment_id": 95704494, "body": "Thanks.  This makes sense.  The author isn&#39;t a software engineer at all.  I know why the string length should be 130 characters: the input string is always 130 characters because of the two line element format (see celestrak.com if you want to know more)."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1548874782, "last_edit_date": 1548874782, "creation_date": 1548874656, "answer_id": 54447704, "question_id": 54447649, "link": "https://stackoverflow.com/questions/54447649/can-you-declare-a-fixed-length-array-in-a-function-declaration/54447704#54447704", "title": "Can you declare a fixed-length array in a function declaration?", "body": "<p>This is kind of misleading code. Those parameters <em>literally</em> do mean <code>char *longstr1</code> (ugh). There is no bounds checking, nothing. You can pass a pointer to an array of any length. Seems you know this already.</p>\n\n<p>Now, one might argue that this approach is self-documenting, but I'd say it's documenting a lie. If the pointer \"should\" have a specific bound then this ought to be documented with comments above the function's declaration, rather than suggesting to readers that it'll be enforced by type. It's possible that the <em>author</em> thought that!</p>\n\n<p>Ultimately, to really find out why it's been written that way, you should track down the author and ask them. Anything else is guesswork.</p>\n"}], "owner": {"reputation": 168, "user_id": 6035735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e55734341b83b16781e20b13afdaf0?s=128&d=identicon&r=PG&f=1", "display_name": "Rodney Price", "link": "https://stackoverflow.com/users/6035735/rodney-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1548874782, "creation_date": 1548874506, "question_id": 54447649, "link": "https://stackoverflow.com/questions/54447649/can-you-declare-a-fixed-length-array-in-a-function-declaration", "title": "Can you declare a fixed-length array in a function declaration?", "body": "<p>I'm reading some C++ code (SGP4, a satellite propagation code) and I found the following function declaration:</p>\n\n<pre><code>void twoline2rv(char longstr1[130], char longstr2[130], char typerun,\n            char typeinput, char opsmode, gravconsttype whichconst,\n            double &amp;startmfe, double &amp;stopmfe, double &amp;deltamin,\n            elsetrec &amp;satrec);\n</code></pre>\n\n<p>I'm wondering what it means to say <code>char longstr1[130]</code> in a function argument.  Why does the compiler need to know that the array is 130 bytes long?  And why not say <code>char *longstr1</code>?</p>\n"}, {"tags": ["c++", "windows", "scrollbar"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1548874616, "post_id": 54447620, "comment_id": 95704236, "body": "You don&#39;t scroll line-by-line. You scroll in blocks. No user is going to scroll line by line through 4GB+ of information."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1548876735, "post_id": 54447620, "comment_id": 95705286, "body": "Do you really have more than 4000 million <i>lines</i> in your listbox or whatever?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548876811, "post_id": 54447620, "comment_id": 95705338, "body": "I&#39;d say that the limitation is inflicted by the height of the scrollbar in pixels. So typical scroll is limited as ~1000 positions. Scrollbar is simply not the right kind of control when you want to navigate over large amount of data. You may consider implementing multi-level scrollbar for example"}, {"owner": {"reputation": 445, "user_id": 4582609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ1XW.jpg?s=128&g=1", "display_name": "Jovibor", "link": "https://stackoverflow.com/users/4582609/jovibor"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1548896640, "post_id": 54447620, "comment_id": 95712199, "body": "@KenWhite It&#39;s now scrolling in blocks, of course. Unfortunately it&#39;s not the remedy, or block size should be very big. In case of big data (dozens of GB) 32bit is not enough."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1548896940, "post_id": 54447620, "comment_id": 95712279, "body": "As I said, no user in their right mind is going to want to scroll through 4GB of data. You&#39;re also butting up against reasonable memory limits (if you&#39;ve not surpassed them already)."}, {"owner": {"reputation": 445, "user_id": 4582609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ1XW.jpg?s=128&g=1", "display_name": "Jovibor", "link": "https://stackoverflow.com/users/4582609/jovibor"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1548897292, "post_id": 54447620, "comment_id": 95712367, "body": "@KenWhite I, for sure, don&#39;t understand your logic. There is a clear limit of standard scrollbar of 32bit. But you insisting on user&#39;s willings. How these facts do correspond is beyond me."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1548897521, "post_id": 54447620, "comment_id": 95712421, "body": "I understand the limit very well. My point is that no user with any sort of brain is going to want to scroll through multiple gigs of data. You&#39;re solving a problem that shouldn&#39;t exist in the first place. But good luck."}], "owner": {"reputation": 445, "user_id": 4582609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ1XW.jpg?s=128&g=1", "display_name": "Jovibor", "link": "https://stackoverflow.com/users/4582609/jovibor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548897057, "creation_date": 1548874382, "last_edit_date": 1548897057, "question_id": 54447620, "link": "https://stackoverflow.com/questions/54447620/to-get-around-standard-windows-scrollbars-32bit-limitation", "title": "To get around standard Windows scrollbars 32bit limitation", "body": "<p>Im facing a situation where int fields of standard <code>SCROLLINFO</code> struct for <code>GetScrollInfo</code> / <code>SetScrollInfo</code> API is no longer enough. It's a scrolling of a big data, >4GB.</p>\n\n<p>Googling on subject didn't give any feasible answer.\nOne solution, of course, would be to implement my own control with similar functionality, but it's not a trivial task. </p>\n\n<p>So the question is, how to get around this limitation, not reimplementing the wheel?\nMay be someone did something similar already?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 2220, "user_id": 6838526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2AyH9wsYAa4/AAAAAAAAAAI/AAAAAAAAAEc/9bGwvIdJPDM/photo.jpg?sz=128", "display_name": "Joseph Ireland", "link": "https://stackoverflow.com/users/6838526/joseph-ireland"}, "edited": false, "score": 1, "creation_date": 1548877253, "post_id": 54447606, "comment_id": 95705552, "body": "Hard to say for sure without seeing the cmake module file. It&#39;s possible that you just need to clean out your build folder to remove the cached xxx_LIBRARIES and xxx_INCLUDE_DIRS variables."}, {"owner": {"reputation": 1860, "user_id": 15422, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/084f7f0686b0988ba073bb2e3488d55f?s=128&d=identicon&r=PG&f=1", "display_name": "Nuno", "link": "https://stackoverflow.com/users/15422/nuno"}, "reply_to_user": {"reputation": 2220, "user_id": 6838526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2AyH9wsYAa4/AAAAAAAAAAI/AAAAAAAAAEc/9bGwvIdJPDM/photo.jpg?sz=128", "display_name": "Joseph Ireland", "link": "https://stackoverflow.com/users/6838526/joseph-ireland"}, "edited": false, "score": 0, "creation_date": 1548878210, "post_id": 54447606, "comment_id": 95705943, "body": "it seems to strange... don&#39;t understand, and yes i always delete build folder when strange things happen :) Don&#39;t know why they always try to find it in the system folder..."}, {"owner": {"reputation": 1860, "user_id": 15422, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/084f7f0686b0988ba073bb2e3488d55f?s=128&d=identicon&r=PG&f=1", "display_name": "Nuno", "link": "https://stackoverflow.com/users/15422/nuno"}, "reply_to_user": {"reputation": 2220, "user_id": 6838526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2AyH9wsYAa4/AAAAAAAAAAI/AAAAAAAAAEc/9bGwvIdJPDM/photo.jpg?sz=128", "display_name": "Joseph Ireland", "link": "https://stackoverflow.com/users/6838526/joseph-ireland"}, "edited": false, "score": 0, "creation_date": 1548878659, "post_id": 54447606, "comment_id": 95706130, "body": "@JosephIreland is there any way to force cmake to look only to the CMAKE_PREFIX_PATH paths specified in the command line?"}, {"owner": {"reputation": 2220, "user_id": 6838526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2AyH9wsYAa4/AAAAAAAAAAI/AAAAAAAAAEc/9bGwvIdJPDM/photo.jpg?sz=128", "display_name": "Joseph Ireland", "link": "https://stackoverflow.com/users/6838526/joseph-ireland"}, "edited": false, "score": 0, "creation_date": 1548879951, "post_id": 54447606, "comment_id": 95706691, "body": "Not directly. The FindXX.cmake file gets to choose where to look, you&#39;ll have to look in there.  Normally it uses stuff like <a href=\"https://cmake.org/cmake/help/latest/command/find_library.html\" rel=\"nofollow noreferrer\">find_library</a> (make sure you read the docs for your version of cmake as there are differences). The search order would normally mean ${CMAKE_PREFIX_PATH}/lib is checked first, then the system files. You can try to debug by looking at the cache variables with <code>cmake -LA -N</code>, or adding message() stuff in the module."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548923155, "post_id": 54447606, "comment_id": 95720476, "body": "Without looking into <code>FindXXX.cmake</code> script which you use we can only <b>guess</b>, and guessing is not a way how Stack Overflow works. Please, show that script (or just say its name if is a standard CMake module)."}, {"owner": {"reputation": 1860, "user_id": 15422, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/084f7f0686b0988ba073bb2e3488d55f?s=128&d=identicon&r=PG&f=1", "display_name": "Nuno", "link": "https://stackoverflow.com/users/15422/nuno"}, "edited": false, "score": 0, "creation_date": 1548926094, "post_id": 54447606, "comment_id": 95722159, "body": "you are right... the script is FindProtobuf.cmake and it seems to me that is a version problem... newer versions use select_library_configurations and old ones don&#39;t, so my custom path is debug the system is release... and i think that on older versions the first that is used is the release one. On my module path i got the newst version that diferentiates debug from release and if my project is in debug then the right lib is selected... it seems a no issue :( but this is not easy to find and understand no..."}], "owner": {"reputation": 1860, "user_id": 15422, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/084f7f0686b0988ba073bb2e3488d55f?s=128&d=identicon&r=PG&f=1", "display_name": "Nuno", "link": "https://stackoverflow.com/users/15422/nuno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1548929995, "creation_date": 1548874349, "last_edit_date": 1548929995, "question_id": 54447606, "link": "https://stackoverflow.com/questions/54447606/cant-understand-cmake-find-package-behaviour", "title": "can&#39;t understand cmake find_package behaviour", "body": "<p>i'm using cmake find_package to find a package that is installed in two places, one on the system path (/usr/lib) and other on my custom path (/my/custom/path/lib). \nThe one that i want to find is the one on custom path, for that I only desired to do the following:</p>\n\n<pre><code>cmake .. -DCMAKE_PREFIX_PATH=/my/custom/path\n</code></pre>\n\n<p>but what i get with this command is the one installed on the system.</p>\n\n<p>But if I copy the FindMyPackage.cmake script that is on the default cmake module path, to another folder and use it then the library that is found is the one in the custom path (the desired one), like this:</p>\n\n<pre><code>cmake .. -DCMAKE_PREFIX_PATH=/my/custom/path -DCMAKE_MODULE_PATH=/path/to/copy/of/script\n</code></pre>\n\n<p>Can someone explain me why this is happening? and how can I instruct cmake to find only the custom one and not the system one without specifying a custom FindXXX.cmake script?</p>\n\n<p>Note that i want to accomplish this without editing CMakeLists.txt, only with cmake flags, adding NO_* options on find_package() function is not the desired solution, because I want to use the system one or the custom one depending on external state and i don't want to edit cmake scripts for that.</p>\n\n<p>Thanks\nNuno</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>the script is FindProtobuf.cmake and it seems to me that is a version problem... newer versions use select_library_configurations and old ones don't, so my custom path is debug the system is release... and i think that on older versions the first that is used is the release one. On my module path i got the newest version that diferentiates debug from release and if my project is in debug then the right lib is selected... it seems a no issue :( but this is not easy to find or understand no...</p>\n"}, {"tags": ["c++", "kernel", "printf", "freestanding"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548878312, "post_id": 54447499, "comment_id": 95705984, "body": "Specifier <code>%s</code> corresponds to the <b>single argument</b> of type <code>char*</code>. But you call <code>c = va_arg(args, char*);</code> in a <code>do..while</code> <b>loop</b>."}, {"owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548879022, "post_id": 54447499, "comment_id": 95706292, "body": "@Tsyvarev What do you mean? In my printf, if a user (me) wants to display a string, then %s is used. As this is freestanding, I do not have the string type available yet as this is in the standard library? This is why I am trying to loop through the characters array as I can only have <code>char[] and not std::string</code>."}, {"owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548879065, "post_id": 54447499, "comment_id": 95706310, "body": "If I were not to use the loop, this would only fetch a single character, not the who string."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548879693, "post_id": 54447499, "comment_id": 95706576, "body": "You need to loop over <b>characters in the string</b>, pointed by the single <code>char*</code> argument, not to loop over <i>arguments</i> (via <code>va_arg</code>)."}, {"owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548880270, "post_id": 54447499, "comment_id": 95706824, "body": "@Tsyvarev Thanks for the info. I&#39;ve now been able to do it with my strlen function. Didn&#39;t think it would have been possible. Feel free to add it as an answer and I will accept it. This method, I was able to use the for loop."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1548880298, "post_id": 54447499, "comment_id": 95706838, "body": "Yes, the C string is a <code>char*</code> pointer, which can be iterated with <code>c++</code>, extracting every character via <code>*c</code>. End of the string is marked with <code>*c</code> equal to <code>&#39;\\0&#39;</code>. BTW, you already have string <code>msg</code> in your code and correctly iterate it."}, {"owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548880342, "post_id": 54447499, "comment_id": 95706862, "body": "@Tsyvarev Thanks for that, I understand where I went wrong now!"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548880992, "post_id": 54447499, "comment_id": 95707159, "body": "<a href=\"https://stackoverflow.com/a/28581294/3440745\">This answer</a> explains how to extract the argument for <code>%s</code> specifier. While it doesn&#39;t explain how to print extracted argument - <code>puts()</code> needs to be implemented too, - but <code>va_arg</code> is definitely not a part of <code>puts</code> implementation."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548881021, "post_id": 54447499, "comment_id": 95707180, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1735236/how-to-write-my-own-printf-in-c\">How to write my own printf() in C?</a>"}, {"owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548882123, "post_id": 54447499, "comment_id": 95707661, "body": "@Tsyvarev Thanks for the information. Also regarding the posible duplicate, I do not think it is in this case. I was able to make a slightly modified version on my Mac but when copying it over to my own OS, it did not work. I think this may be due to an implicit conversion from char to string? As this is freestanding, it does not have string enabled."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548882589, "post_id": 54447499, "comment_id": 95707893, "body": "In the C language aside from null-terminated string there is no other &quot;string&quot;, and a character is never converted implicitly to a string. It seems you are confusing about <code>puts</code> function used in the referenced answer: this function is NOT the same as <code>putc</code> function you already have. These functions has different meaning: <code>putc</code> prints a single character, <code>puts</code> prints all characters in a string. But you can easily implement <code>puts</code> function via calls to <code>putc</code> in a loop, thus the answer will work for you."}, {"owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548883571, "post_id": 54447499, "comment_id": 95708322, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187607/discussion-between-iprogram-and-tsyvarev\">continue this discussion in chat</a>."}], "owner": {"reputation": 4327, "user_id": 3549629, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aopq.png?s=128&g=1", "display_name": "iProgram", "link": "https://stackoverflow.com/users/3549629/iprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548876990, "creation_date": 1548873990, "last_edit_date": 1548876990, "question_id": 54447499, "link": "https://stackoverflow.com/questions/54447499/custom-freestanding-printf-only-displaying-one-letter-and-random-capital-s", "title": "Custom Freestanding printf only displaying one letter and random capital S", "body": "<p>I am trying to develop my own kernel which I am booting to with GRUB.</p>\n\n<p>In order to display strings with variables, I have started to develop my own <code>printf(char*, ...)</code> function.</p>\n\n<p>Here is the kernel.cpp (thanks to <a href=\"https://www.youtube.com/watch?v=1rnA6wpF0o4&amp;list=PLHh55M_Kq4OApWScZyPl5HhgsTJS9MZ6M&amp;index=1\" rel=\"nofollow noreferrer\">Write Your Own Operating System YouTube tutorial for the main loading part</a> (printf is my code entirely))</p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n\n\n#define VGA_BLACK 0\n#define VGA_BLUE 1\n#define VGA_GREEN 2\n#define VGA_CYAN 3\n#define VGA_RED 4\n#define VGA_MAGENTA 5\n#define VGA_BROWN 6\n#define VGA_GREY 7\n#define VGA_BRIGHT 8\n\n#define VGA_DEFAULT_FG VGA_GREEN\n#define VGA_DEFAULT_BG VGA_BLACK\n\nvolatile char* videoMemory = (volatile char*)0xB8000;\nunsigned int color = ((VGA_DEFAULT_BG&lt;&lt;4) | (VGA_DEFAULT_FG &amp; 0x0F));\n\nvoid putchar(char c){\n  *videoMemory++ = c;\n  *videoMemory++ = color;\n}\n\nvoid printInt(int number){\n  if(number &lt;= 0){\n    putchar('0');\n    return;\n  }\n  int diget = number/10;\n  char c = diget + 48;\n  putchar(c);\n  int newNum = diget%10;\n  printInt(newNum);\n}\n\nint strlen(char* str){\n  int len = 0;\n  for(int i = 0; str[i] != '\\0'; i++){\n    len++;\n  }\n  return len;\n}\n\nvoid printf(char* msg, ...){\n  va_list args;\n  va_start(args, msg);\n  for(int i = 0; i &lt; strlen(msg); i++){\n    if(msg[i] == '%'){\n      i++;\n      if(msg[i] == 'd'){\n        i++;\n        int res = va_arg(args, int);\n        printInt(res);\n      } else if(msg[i] == 's'){\n        i++;\n        char* c;\n        do{\n          c = va_arg(args, char*);\n\n          putchar(*c);\n        } while(c != '\\n');\n      } else {\n        putchar('%');\n      }\n    } else {\n      putchar(msg[i]);\n    }\n  }\n  va_end(args);\n}\n\n\nvoid setColor(char fg, char bg){\n  color = ((bg&lt;&lt;4) | (fg &amp; 0x0F));\n}\n\n\ntypedef void (*constructor)();\nextern \"C\" constructor start_ctors;\nextern \"C\" constructor end_ctors;\nextern \"C\" void callConstructors(){\n  for(constructor* i = &amp;start_ctors; i != &amp;end_ctors; i++){\n    (*i)();\n  }\n}\n\nextern \"C\" void kernelMain(void* multibootStructure, unsigned int magicNumber){\n  setColor(VGA_GREEN+VGA_BRIGHT, VGA_BLACK);\n  printf(\"Booting %s\", \"Test System\");\n  while(true);\n}\n</code></pre>\n\n<p>Result:\n<a href=\"https://i.stack.imgur.com/vKHal.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vKHal.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, it displays the first character and 'S'.</p>\n\n<p>If I were to change the message to \"My Custom Kernel\", this is the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1li7s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1li7s.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see here, it again prints the first letter and then 'S'.</p>\n\n<p>Why is this happening? By my understanding, va_args changes <code>char</code> to <code>int</code>, however this does not explain why it only displays the first letter along with an 'S'.</p>\n\n<p>Why is this happening and how can I fix this?</p>\n\n<p>Edit:\nThis has also been compiled with the flags: <code>-m32 -fno-use-cxa-atexit -nostdlib -fno-builtin -fno-rtti -fno-exceptions -fno-leading-underscore</code></p>\n"}, {"tags": ["c++", "visual-studio-2010", "pointers", "access-violation"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1548873497, "post_id": 54447330, "comment_id": 95703632, "body": "Maybe <code>m_pIDF[i]-&gt;m_numrecs-1</code> is out of bounds for your <code>IDFFields</code> array. Look at your variables when it breaks into the debugger."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1548873828, "post_id": 54447330, "comment_id": 95703836, "body": "Many things could be happening here. <code>this</code> could be invalid. <code>i</code> or <code>m_pIDF[i]-&gt;m_numrecs-1</code> could be out of range. The pointer at <code>m_pIDF[i]</code> could be dangling or uninitialized. Gremlins elsewhere in the program could have smashed the stack. I think we&#39;ll need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to help sort this one out."}, {"owner": {"reputation": 59, "user_id": 10852845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zewDka9NPm4/AAAAAAAAAAI/AAAAAAAAAGU/mVAbRTOUHyM/photo.jpg?sz=128", "display_name": "Dean", "link": "https://stackoverflow.com/users/10852845/dean"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1548873830, "post_id": 54447330, "comment_id": 95703837, "body": "@drescherjm But wouldn&#39;t that give me a different error other than an access violation?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1548874217, "post_id": 54447330, "comment_id": 95704034, "body": "<b><i>But wouldn&#39;t that give me a different error other than an access violation?</i></b> Since <code>c++</code> has no requirement to check bounds not necessarily."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 2, "creation_date": 1548874246, "post_id": 54447330, "comment_id": 95704055, "body": "Are you stopping the timer (and making sure the TimerProc has exited) before pulling the proverbial rug out from underneath it by <code>delete</code>ing the memory?"}, {"owner": {"reputation": 59, "user_id": 10852845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zewDka9NPm4/AAAAAAAAAAI/AAAAAAAAAGU/mVAbRTOUHyM/photo.jpg?sz=128", "display_name": "Dean", "link": "https://stackoverflow.com/users/10852845/dean"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548874573, "post_id": 54447330, "comment_id": 95704215, "body": "@PhilM I am adding on to code that has been written before me so I am not sure whether or not that has happened. The entire file consists of thousands of lines of code that is why I can&#39;t post everything. Where do you suggest I take a look at?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548874645, "post_id": 54447330, "comment_id": 95704258, "body": "Look at the variables after the crash broke into the debugger. That should tell you if @PhilM or my guesses are correct. Is <code>this</code> valid? Can you look at the local variables? Is  <code>m_pIDF[i]-&gt;m_numrecs-1</code> out of bounds?"}, {"owner": {"reputation": 59, "user_id": 10852845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zewDka9NPm4/AAAAAAAAAAI/AAAAAAAAAGU/mVAbRTOUHyM/photo.jpg?sz=128", "display_name": "Dean", "link": "https://stackoverflow.com/users/10852845/dean"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1548875501, "post_id": 54447330, "comment_id": 95704684, "body": "@drescherjm There is no <code>this</code> operator."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 1, "creation_date": 1548876871, "post_id": 54447330, "comment_id": 95705371, "body": "Your code is probably creating the Timer somewhere with <code>SetTimer</code>, and hopefully storing the ID returned. You need to pass that to <code>KillTimer</code> to stop the timer, before you start deleting memory. Then you&#39;ll want some method of making sure <code>OnTimer</code> has exited before the actual <code>delete</code>s."}, {"owner": {"reputation": 59, "user_id": 10852845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zewDka9NPm4/AAAAAAAAAAI/AAAAAAAAAGU/mVAbRTOUHyM/photo.jpg?sz=128", "display_name": "Dean", "link": "https://stackoverflow.com/users/10852845/dean"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548877674, "post_id": 54447330, "comment_id": 95705748, "body": "@PhilM Wow...you&#39;re a genius! Thank you so much this solved my issue! If you want to add your comment as a solution I will mark it!"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1548878869, "post_id": 54447330, "comment_id": 95706234, "body": "<b><i>There is no this operator</i></b> Of course. I mean the <code>this</code> pointer as seen in the debugger. If you look at the <code>Locals</code> tab in <code>Visual Stuido</code> when debugging the <code>this</code> pointer is the first item."}], "answers": [{"tags": [], "owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1548878949, "creation_date": 1548878949, "answer_id": 54448780, "question_id": 54447330, "link": "https://stackoverflow.com/questions/54447330/access-violation-in-call-stack/54448780#54448780", "title": "Access Violation in call stack", "body": "<p>Your <code>OnCancel</code> is de-allocating memory without making sure that <code>OnTimer</code> isn't still accessing that memory.</p>\n\n<p>Make sure to call <code>KillTimer</code> (and ensure that <code>OnTimer</code> has finished) before deleting the variables.</p>\n"}], "owner": {"reputation": 59, "user_id": 10852845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zewDka9NPm4/AAAAAAAAAAI/AAAAAAAAAGU/mVAbRTOUHyM/photo.jpg?sz=128", "display_name": "Dean", "link": "https://stackoverflow.com/users/10852845/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 54448780, "answer_count": 1, "score": -1, "last_activity_date": 1548878949, "creation_date": 1548873323, "question_id": 54447330, "link": "https://stackoverflow.com/questions/54447330/access-violation-in-call-stack", "title": "Access Violation in call stack", "body": "<p>I get this error: First-chance exception at 0x003f31b5 in Cts.exe: 0xC0000005: Access violation reading location 0xe1672514.</p>\n\n<p>When I use the call stack, it spits out to this method. \nI commented which line specifically. </p>\n\n<p>When I click cancel from debugging when the program runs, the violation happens.</p>\n\n<p>At the bottom, I have included my Cancel method as well.</p>\n\n<pre><code>void CInpINS::OnTimer(UINT nIDEvent) \n{\n\n  int i,j, totalbytes;\n  bool bfilefnd = false;\n\n\n  CConvb Convb;\n  CString tmp;\n\n  for (i = 0; i &lt; (int) m_nNumMsgs; i++) {\n      m_pBDF[i]-&gt;m_numrecs = m_pIDF[i]-&gt;m_numrecs;\n\n      for (j = 0; j &lt; MAXBYTECNT; j++) {\n                OutBytes[j] = 0;\n      }\n\n        // set first 5 words \n      OutBytes[1] = m_nSelectedMsgNum[i];\n\n      OutBytes[3] = (int)m_pIDF[i]-&gt;IDFFields[m_pIDF[i]-&gt;m_numrecs-1].ebyte/2+6; // THIS LINE SPECIFICALLY\n\n      CConvb Convb;\n\n      if (i == 0) m_dTimeofTransmission += m_nRate;\n      tmp.Format(\"%20.0f\",m_dTimeofTransmission);\n\n      Convb.CONV_Timetag_to_Bytes(tmp, OutBytes[4], OutBytes[5],\n                              OutBytes[6], OutBytes[7],\n                              OutBytes[8], OutBytes[9],\n                              OutBytes[10], OutBytes[11]);\n\n        // start at 11 because byte 0 and 1 are input or output msg, then bytes 2 and 3 are word count\n        // bytes 4 through 11 are gps time\n        for (j = 0; j &lt; m_pBDF[i]-&gt;m_numrecs; j++) {\n            if ((j == 0)||(j == 1))  \n            {\n                Convb.ConvFld(tmp,\n                    m_pIDF[i]-&gt;IDFFields[j].bbyte+9,\n                    m_pIDF[i]-&gt;IDFFields[j].ebyte+9,\n                    m_pIDF[i]-&gt;IDFFields[j].bbit,\n                    m_pIDF[i]-&gt;IDFFields[j].ebit,\n                    m_pIDF[i]-&gt;IDFFields[j].dtype,\n                    m_pIDF[i]-&gt;IDFFields[j].Desc,OutBytes);\n\n            }\n            else\n            {\n                Convb.ConvFld(m_pBDF[i]-&gt;BDFFields[j],\n                    m_pIDF[i]-&gt;IDFFields[j].bbyte+9,\n                    m_pIDF[i]-&gt;IDFFields[j].ebyte+9,\n                    m_pIDF[i]-&gt;IDFFields[j].bbit,\n                    m_pIDF[i]-&gt;IDFFields[j].ebit,\n                    m_pIDF[i]-&gt;IDFFields[j].dtype,\n                    m_pIDF[i]-&gt;IDFFields[j].Desc,OutBytes);\n\n            }\n        }\n\n        totalbytes = OutBytes[3];\n        m_pDoc-&gt;sendmsg(totalbytes, false, OutBytes);\n        tmp.Format(\"Sent Message\");\n        AddToListBox(tmp);\n        UpdateData(false);\n        m_nNumSent +=1;\n\n}\n\n}\n</code></pre>\n\n<p>Here is the cancel method:</p>\n\n<pre><code>void CInpINS::OnCancel() \n    {\nif (m_bSetIDF) \n{\n    for (int i = 0; i &lt; (int) m_nNumMsgs; i++) {\n        delete m_pIDF[i];\n        delete m_pIDFCustm[i];\n        delete m_pBDF[i];   \n    }\n    m_bSetIDF = false;\n}\n\nAfxGetMainWnd()-&gt;PostMessage(WM_GOODBYEINPINS, IDOK);\n\nCDialog::OnCancel();\n\n}\n</code></pre>\n\n<p>This is coded in C++ Visual Studio 2010. I think there may be some NULL pointers or something but I am not sure. Any help would be appreciated. Thank you.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 12, "creation_date": 1548873068, "post_id": 54447208, "comment_id": 95703426, "body": "They are different languages with a different set of features. C++ allows this, C does not."}, {"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 2, "creation_date": 1548873084, "post_id": 54447208, "comment_id": 95703433, "body": "This is a feature added to C++14"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1548873308, "post_id": 54447208, "comment_id": 95703545, "body": "&quot;was there really a rule added to C++ to make this compile?&quot; c++ is not just c with some rules added. If you see it like this, you wont have much fun with c++ (and I guess neither with c). They are different languages. C++ comes from C, but both lanuages have diverged since then"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1548873534, "post_id": 54447208, "comment_id": 95703657, "body": "For C, <code>#define X(a,b,c) a ## b ## c</code>, then use <code>unsigned x = X(10,000,007);</code>  But just do this for fun, not for real code that you&#39;d want anyone else to see."}], "answers": [{"comments": [{"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 2, "creation_date": 1548873452, "post_id": 54447311, "comment_id": 95703611, "body": "&quot;Yet&quot; sounds quite optimistic. Has there been any proposal to add this to C?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1548873514, "post_id": 54447311, "comment_id": 95703640, "body": "@Ruslan: Lol not that I&#39;m aware of, but I&#39;m not denying the possibility!"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1548874184, "post_id": 54447311, "comment_id": 95704017, "body": "i am surprised you have answered this question. C &amp; C++ are distinct languages with their own syntax and semantics. So I will extend this question: what about D, C#, ADA &amp; Prolog?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548874400, "post_id": 54447311, "comment_id": 95704123, "body": "@P__J__: That&#39;s an interesting criticism to levy, since C++ considers itself a superset of a subset of the C language, and it&#39;s oftentimes difficult for newcomers to the languages to distinguish the differences."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1548874486, "post_id": 54447311, "comment_id": 95704166, "body": "It is common misunderstanding - it is not superset or subset. There are completely different even if sometimes one may see some similarities."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548874495, "post_id": 54447311, "comment_id": 95704168, "body": "@P__J__ one cannot point out often enough that c and c++ are two different languages, but once this misconception is out of the way there is no point in denying that they have some common history. Imho the question is perfeclty valid and deserves an answer"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548874525, "post_id": 54447311, "comment_id": 95704188, "body": "@P__J__: You cannot ignore the fact that the C++ standard explicitly points at the C standard in places to describe the behavior of some operations."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548874613, "post_id": 54447311, "comment_id": 95704234, "body": "Even if they have some common points it does not change that they are different languages. C# is very similar as well."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1548874799, "post_id": 54447311, "comment_id": 95704331, "body": "@P__J__: It says it right there in the C++ standard: &quot;C++ is a general purpose programming language based on the C programming language as described in ISO/IEC 9899:2011 Programming languages \u2014 C (hereinafter referred to as the C standard). In addition to the facilities provided by C, C++ provides additional data types, classes, templates, exceptions, namespaces, operator overloading, function name overloading, references, free store management operators, and additional library facilities.&quot; So yes, it is a superset of a specific version of C (although in practice this is not always true)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548874992, "post_id": 54447311, "comment_id": 95704446, "body": "one could remove any reference to C from the question and from the answer it they still would be substantially the same... maybe this debate is rather pointless... ;)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548875182, "post_id": 54447311, "comment_id": 95704528, "body": "<i>During the development of the .NET Framework, the class libraries were originally written using a managed code compiler system called Simple Managed C (SMC).[18][19] In January 1999, Anders Hejlsberg formed a team to build a new language at the time called Cool, which stood for &quot;C-like Object Oriented Language&quot;</i>  So using this logic C# i superset of C"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548875374, "post_id": 54447311, "comment_id": 95704620, "body": "And what aboud <i>D</i> which is &quot;modified  C++&quot;"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548875400, "post_id": 54447311, "comment_id": 95704632, "body": "@P__J__: This will be last comment on the matter, because I&#39;m not sure if you&#39;re trolling or not. I do not agree that the quotes you have provided indicate that C# is intended to be a superset of C, rather that it was written using some variation of C."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1548879828, "post_id": 54447311, "comment_id": 95706634, "body": "@P__J__ \u2022 Neither C# nor D have a relationship to C++ or C, like C++ does to C.  C++/CLI has that kind of relationship to C++.  C++/CX has that kind of relationship to C++.  Most languages are only inspired or influenced by one or a few languages that came before them, rather than having their specification tethered to another language."}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 7, "last_activity_date": 1548873259, "creation_date": 1548873259, "answer_id": 54447311, "question_id": 54447208, "link": "https://stackoverflow.com/questions/54447208/why-can-i-separate-digits-with-an-apostrophe-in-c-but-not-c/54447311#54447311", "title": "Why can I separate digits with an apostrophe in C++ but not C?", "body": "<p>In C++14, integer literals were updated to allow an optional <code>'</code> separator.</p>\n\n<p>Refer to [lex.icon]</p>\n\n<blockquote>\n  <p><em>decimal-literal</em>:<br/>\n    &nbsp;&nbsp;&nbsp;<em>nonzero-digit</em><br/>\n    &nbsp;&nbsp;&nbsp;<em>decimal-literal <code>\u2019</code><sub>opt</sub> digit</em><br/></p>\n</blockquote>\n\n<p>So the code snippet you've shown will not compile in any C++ standard below C++14, and the C language does not yet have this rule.</p>\n"}], "owner": {"reputation": 115, "user_id": 5091713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69967b07792b79b1a28a911a843e652c?s=128&d=identicon&r=PG&f=1", "display_name": "toweleeele", "link": "https://stackoverflow.com/users/5091713/toweleeele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "closed_date": 1548882029, "answer_count": 1, "score": -1, "last_activity_date": 1549049897, "creation_date": 1548872899, "last_edit_date": 1549049897, "question_id": 54447208, "link": "https://stackoverflow.com/questions/54447208/why-can-i-separate-digits-with-an-apostrophe-in-c-but-not-c", "closed_reason": "Needs details or clarity", "title": "Why can I separate digits with an apostrophe in C++ but not C?", "body": "<p>I saw this vector declaration in a code sample</p>\n\n<pre><code>std::vector&lt;double&gt; v(10'000'007, 0.5);\n</code></pre>\n\n<p>which produces a vector of size 10000007, so it must be cast as a size_type. I can also assign it to a variable of type <code>size_t</code> which isn't surprising. This same declaration does not compile in C, however, I get an error</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main()\n{\nunsigned x = 10'000'007;\nprintf(\"x: %d\\n\", x);\n}\n\nwarning: multi-character character constant [-Wmultichar] unsigned x = 10'000'007;\nerror: expected \u2018,\u2019 or \u2018;\u2019 before '\\x303030'\n</code></pre>\n\n<p>This style makes it easier to read the declaration, but was there really a rule added to C++ to make this compile?</p>\n"}, {"tags": ["c++", "c++14", "wrapper", "variadic-templates", "template-argument-deduction"], "comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1548876150, "post_id": 54447141, "comment_id": 95704999, "body": "if you use <code>auto</code>, as function return type, without trailing return type, you&#39;re using C++14, not C++11"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8807750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cdb23e39396616028193a21bdb15ebf?s=128&d=identicon&r=PG&f=1", "display_name": "Samuraiburger", "link": "https://stackoverflow.com/users/8807750/samuraiburger"}, "edited": false, "score": 0, "creation_date": 1548928192, "post_id": 54447770, "comment_id": 95723426, "body": "Thanks a lot, both approaches work like a charm!  I think I got the std::result_of code, but could you perhaps clarify why two separate parameter sets are needed in your first solution?  The two sets are equal, which I can kind of prove too by changing the type in the wrapped function call to As1. So my guess is that the template can only be correctly filled in if the set of the member function pointers&#39; parameter types and the set of parameter types I provide afterwards are distinct sets. Just because they happen to be equal, this does not allow a general reuse. Is this correct?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 13, "user_id": 8807750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cdb23e39396616028193a21bdb15ebf?s=128&d=identicon&r=PG&f=1", "display_name": "Samuraiburger", "link": "https://stackoverflow.com/users/8807750/samuraiburger"}, "edited": false, "score": 0, "creation_date": 1549046800, "post_id": 54447770, "comment_id": 95777780, "body": "@Samuraiburger - answer improved; hope this helps."}, {"owner": {"reputation": 13, "user_id": 8807750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cdb23e39396616028193a21bdb15ebf?s=128&d=identicon&r=PG&f=1", "display_name": "Samuraiburger", "link": "https://stackoverflow.com/users/8807750/samuraiburger"}, "edited": false, "score": 0, "creation_date": 1549273162, "post_id": 54447770, "comment_id": 95829755, "body": "Thanks! Very good explanation, it made the penny drop. And it is a nice and elegant solution.   This works nicely when the compiler deduces the types, but I am still getting some grief when I need to provide the template parameter explicitly for disambiguation of overloaded member functions. I can easily get it to compile, but it does lead to linker errors I can&#39;t quite figure out. I&#39;ll experiment some more and open a new thread for that and cross reference the current one if I can&#39;t make anymore progress. Thanks again mate"}, {"owner": {"reputation": 13, "user_id": 8807750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cdb23e39396616028193a21bdb15ebf?s=128&d=identicon&r=PG&f=1", "display_name": "Samuraiburger", "link": "https://stackoverflow.com/users/8807750/samuraiburger"}, "edited": false, "score": 0, "creation_date": 1549293300, "post_id": 54447770, "comment_id": 95841029, "body": "&lt;but I am still getting some grief when I need to provide the template parameter explicitly for disambiguation of overloaded member functions&gt;  Turned out not be a templates fault. Seems related to a problem when linking as a shared library. So, original template problem wholly solved."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 1, "last_activity_date": 1549046780, "last_edit_date": 1549046780, "creation_date": 1548874921, "answer_id": 54447770, "question_id": 54447141, "link": "https://stackoverflow.com/questions/54447141/trouble-deducing-return-type-for-wrapper-of-member-functions/54447770#54447770", "title": "Trouble deducing return type for wrapper of member functions", "body": "<p>You don't need <code>std::result_of</code>; you can simply write</p>\n\n<pre><code>  template &lt;typename R, typename ... As1, typename ... As2&gt;\n  R wrapper (R(MemberWithDecl::*fn)(As1...), As2 ... args)\n   { return (*this.*fn)(std::forward&lt;As2&gt;(args)...); } \n</code></pre>\n\n<p>If you really want to use <code>std::result_of</code>, you have to add a <code>MemberWithDecl</code> pointer (the type of <code>this</code>) as first argument.</p>\n\n<pre><code>  template &lt;typename Fn, typename ... Args&gt;\n  typename std::result_of&lt;Fn&amp;(MemberWithDecl*, Args... )&gt;::type\n        wrapper (Fn f, Args ... args)\n   {\n     typename std::result_of&lt;Fn&amp;(MemberWithDecl*, Args... )&gt;::type ret\n        = (*this.*f)(std::forward&lt;Args&gt;(args)...);\n\n     return ret;\n   } \n</code></pre>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>The OP ask</p>\n\n<blockquote>\n  <p>but could you perhaps clarify why two separate parameter sets are needed in your first solution?</p>\n</blockquote>\n\n<p>Two separate parameter sets aren't strictly required but this gives more flexibility.</p>\n\n<p>Suppose you have a single set</p>\n\n<pre><code>  template &lt;typename R, typename ... As&gt;\n  R wrapper (R(MemberWithDecl::*fn)(As...), As ... args)\n   { return (*this.*fn)(std::forward&lt;As&gt;(args)...); } \n</code></pre>\n\n<p>and given </p>\n\n<pre><code> long foo (long a, long b) { return a + b; }\n</code></pre>\n\n<p>suppose you call</p>\n\n<pre><code> wrapFunc(foo, 1, 2) \n</code></pre>\n\n<p>Now the compiler has to deduce <code>As...</code> from <code>foo()</code> and from <code>1, 2</code>.</p>\n\n<p>From <code>foo()</code>, the compiler deduce <code>As...</code> as <code>long, long</code>.</p>\n\n<p>From <code>1, 2</code>, the compiler deduce <code>As...</code> as <code>int, int</code>.</p>\n\n<p>So: compilation error because the compiler has a deduction conflict.</p>\n\n<p>With a double set of types (<code>As1...</code> and <code>As2...</code>), the compiler deduce <code>As1...</code> as <code>long, long</code> and <code>As2...</code> as <code>int, int</code>. There isn't conflict so no compilation error.</p>\n\n<p>And there isn't also problem calling <code>foo()</code> with <code>int</code> values because the <code>int</code>s are converted to <code>long</code>s.</p>\n"}], "owner": {"reputation": 13, "user_id": 8807750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cdb23e39396616028193a21bdb15ebf?s=128&d=identicon&r=PG&f=1", "display_name": "Samuraiburger", "link": "https://stackoverflow.com/users/8807750/samuraiburger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 54447770, "answer_count": 1, "score": 1, "last_activity_date": 1549046780, "creation_date": 1548872656, "last_edit_date": 1548876378, "question_id": 54447141, "link": "https://stackoverflow.com/questions/54447141/trouble-deducing-return-type-for-wrapper-of-member-functions", "title": "Trouble deducing return type for wrapper of member functions", "body": "<p>I have a collection of methods with varying signatures which all need the same prefix and postfix code, so I'd like to wrap each of them up neatly.\nI'm trying to formulate a C++14 variadic template for a generic wrapper to my member functions, and I hit trouble when deducing the return type. <code>auto</code> works, but I need the return type explicitly to provide a valid return value even if I catch an exception inside the wrapper when executing the wrappee.</p>\n\n<p>So far I managed to deduce the return type for a plain wrapper function using <code>std::result_of</code> and I got correct behaviour for non static member functions using auto. I tried for two days now to make the <code>std::result_of</code> approach work for member functions, also tried a lot of variations of <code>decltype()</code> and <code>std::declval()</code>, but with no luck so far. I am running out of ideas on how to deduce the return type.</p>\n\n<p>This is my working example</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint foo(int a, int b) { return a + b; }\nint bar(char a, char b, char c) { return a + b * c; }\n\n\ntemplate&lt;typename Fn, typename... Args&gt;\ntypename std::result_of&lt;Fn&amp;(Args... )&gt;::type \nwrapFunc(Fn f, Args... args) {\n  //Do some prefix ops\n  typename std::result_of&lt;Fn&amp;(Args... )&gt;::type ret = f(std::forward&lt;Args&gt;(args)...);\n  //Do some suffix ops\n  return ret;\n}\n\nclass MemberWithAuto {\n  private:\n  public:\n    MemberWithAuto() {};\n    int foo(int i, int j) { return i + j;}\n\n    template&lt;typename Fn, typename... Args&gt;\n    auto wrapper(Fn f, Args... args) {\n      //Do some prefix ops\n      auto ret = (*this.*f)(std::forward&lt;Args&gt;(args)...);\n      //Do some suffix ops\n      return ret;\n    } \n};\n\n\n\nint main() {\n\n  std::cout &lt;&lt; \"FuncWrapper for foo with 1 + 2 returns \"         &lt;&lt; wrapFunc&lt;decltype(foo)&gt;(foo, 1, 2)      &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"FuncWrapper for bar with 'a' + 'b' * 1  returns \"  &lt;&lt; wrapFunc&lt;decltype(bar)&gt;(bar, 'a','b', 1)  &lt;&lt; std::endl;\n\n  MemberWithAuto meau = MemberWithAuto();\n  std::cout &lt;&lt; \"MemberFunction with Auto with 6 + 1 returns  \"  &lt;&lt; meau.wrapper(&amp;MemberWithAuto::foo, 6, 1)  &lt;&lt; std::endl;\n\n  return 0;\n}\n</code></pre>\n\n<p>Both of these work well, but the wrapper method using auto doesn't get me the return type for later use. \nI tried lots of variations with <code>std::result_of</code> and <code>decltype()</code> with the following code, but I can't get it to compile correctly</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint foo(int a, int b) { return a + b; }\nint bar(char a, char b, char c) { return a + b * c; }\n\nclass MemberWithDecl {\n  private:\n  public:\n    MemberWithDecl() {};\n    int foo(int i, int j) { return i + j;}\n\n    template&lt;typename Fn, typename... Args&gt;\n    typename std::result_of&lt;Fn&amp;(Args... )&gt;::type wrapper(Fn f, Args... args) {\n      //Do some prefix ops\n      typename std::result_of&lt;Fn&amp;(Args... )&gt;::type ret = (*this.*f)(std::forward&lt;Args&gt;(args)...);\n      //Do some suffix ops\n      return ret;\n    } \n};\n\n\n\nint main() {\n  MemberWithDecl medcl = MemberWithDecl();\n  std::cout &lt;&lt; \"MemberFunction with declaration also works \"  &lt;&lt; medcl.wrapper(&amp;MemberWithDecl::foo, 6, 1)  &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p>I was expecting to find a solution where the signature of <code>Fn</code> with <code>Args...</code> is correctly recognized, because <code>auto</code> also successfully deduces the types. My type declaration does not seems to find a matching template though, no matter the variations I tried, I get</p>\n\n<pre><code>error: no matching function for call to \u2018MemberWithDecl::wrapper(int (MemberWithDecl::*)(int, int), int, int)\u2019\n</code></pre>\n\n<p>If I leave the wrapper's return type to be auto and just try my declaration for the variable <code>ret</code> within, I get </p>\n\n<pre><code>error: no type named \u2018type\u2019 in \u2018class std::result_of&lt;int (MemberWithDecl::*&amp;(int, int))(int, int)&gt;\u2019\n       typename std::result_of&lt;Fn&amp;(Args... )&gt;::type ret = (*this.*f)(std::forward&lt;Args&gt;(args)...);\n</code></pre>\n\n<p>After reading the standard, I think this means that result_of does not regard <code>Fn&amp;(Args... )</code> to be well-formed, but I don't know how the correct form should look like.</p>\n\n<p>Any help would be much appreciated</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 5, "creation_date": 1548872658, "post_id": 54447120, "comment_id": 95703215, "body": "What about using a loop with a <code>bool</code> variable indicating the input was expected? Also you should use <code>break</code> after each handled case."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1548872705, "post_id": 54447120, "comment_id": 95703227, "body": "The occasional <code>break</code> might be nice :("}, {"owner": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 0, "creation_date": 1548874230, "post_id": 54447120, "comment_id": 95704038, "body": "alternative to a loop, you can use a <code>goto</code> statement"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 3, "creation_date": 1548874504, "post_id": 54447120, "comment_id": 95704173, "body": "@khuderm you could, but that is rarely recommended if a loop can handle the job. <code>goto</code>s have a lot of gotchas for the unwary, and even if the <code>goto</code> is used correctly you often wind up dealing with all of the questions and admonishments using one brings."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548873928, "post_id": 54447270, "comment_id": 95703900, "body": "Inverting the logic of your <code>bool</code> variable could reduce the logic to be handled in the <code>default</code> case solely."}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548876284, "post_id": 54447270, "comment_id": 95705060, "body": "I presented it this way so that there are less logic inversions to deal with for a beginner."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1548876357, "post_id": 54447270, "comment_id": 95705090, "body": "Better teach beginners the right way from the beginning ;-) . To make the logic clear, you could consider to name the <code>bool</code> variable differently."}], "tags": [], "owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "is_accepted": true, "score": 2, "last_activity_date": 1549489196, "last_edit_date": 1549489196, "creation_date": 1548873104, "answer_id": 54447270, "question_id": 54447120, "link": "https://stackoverflow.com/questions/54447120/can-default-in-switch-case-return-to-cin/54447270#54447270", "title": "Can default in switch case return to cin?", "body": "<p>Two things here: </p>\n\n<p>First, you don't have <code>break</code> statements at the end of your cases, so the program will \"fall through\" to the next case. This means that entering \"+\" will print all four operations as well as the default case. Fix this by adding <code>break</code> statements. </p>\n\n<p>Second, you can loop using one of the looping control statements in C++. I'd recommend a <code>while</code> loop in this case along with an exit flag. </p>\n\n<p>So your code would end up looking like this:  </p>\n\n<pre><code>bool keep_looping = true;\nwhile(keep_looping)\n{\n    cin&gt;&gt;op;\n    switch(op)\n    {\n        case '+' :\n            cout&lt;&lt;\"Odbravte sobiranje\"&lt;&lt;endl;\n            cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a+b&lt;&lt;endl;\n            keep_looping = false; // &lt;-- this will prevent the while loop from looping\n            break; // &lt;-- break statements prevent fallthrough to the next ccase\n        case '-' :\n            cout&lt;&lt;\"Odbravte odzemanje\"&lt;&lt;endl;\n            cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a-b&lt;&lt;endl;\n            keep_looping = false;\n            break;\n        case '*' :\n            cout&lt;&lt;\"Odbravte mnozenje\"&lt;&lt;endl;\n            cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a*b&lt;&lt;endl;\n            keep_looping = false;\n            break;\n        case '/' :\n            cout&lt;&lt;\"Odbravte delenje\"&lt;&lt;endl;\n            cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a/b&lt;&lt;endl;\n            keep_looping = false;\n            break;\n        default:\n            cout&lt;&lt;\"Vnesovte netocen podatok\"&lt;&lt;endl;\n            cout&lt;&lt;\"Obidete se povtorno\"&lt;&lt;endl;\n            break;\n    }\n}\n\ncout &lt;&lt; \"Done the while loop\" &lt;&lt; endl;\n</code></pre>\n\n<p>The <code>while</code> loop will keep looping until its condition becomes false. In this case, we set the <code>keep_looping</code> variable to false when a valid operation is entered.  </p>\n"}], "owner": {"reputation": 11, "user_id": 10992044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uWv9rwAlHdo/AAAAAAAAAAI/AAAAAAAAAzA/gKEih-dj6Zc/photo.jpg?sz=128", "display_name": "\u0417\u041b\u0410\u0422\u0415\u041d", "link": "https://stackoverflow.com/users/10992044/%d0%97%d0%9b%d0%90%d0%a2%d0%95%d0%9d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54447270, "answer_count": 1, "score": -2, "last_activity_date": 1549489196, "creation_date": 1548872572, "last_edit_date": 1548872786, "question_id": 54447120, "link": "https://stackoverflow.com/questions/54447120/can-default-in-switch-case-return-to-cin", "title": "Can default in switch case return to cin?", "body": "<p>Under default can I make the code return to the \"cin>>op;\" in the first line?</p>\n\n<p>Note: The text under cout is in my language it isnt anything important I can't bother changing it..</p>\n\n<pre><code> cin&gt;&gt;op;\nswitch(op)\n{\ncase '+' :\n    cout&lt;&lt;\"Odbravte sobiranje\"&lt;&lt;endl;\n    cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a+b&lt;&lt;endl;\ncase '-' :\n    cout&lt;&lt;\"Odbravte odzemanje\"&lt;&lt;endl;\n    cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a-b&lt;&lt;endl;\ncase '*' :\n    cout&lt;&lt;\"Odbravte mnozenje\"&lt;&lt;endl;\n    cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a*b&lt;&lt;endl;\ncase '/' :\n    cout&lt;&lt;\"Odbravte delenje\"&lt;&lt;endl;\n    cout&lt;&lt;\"Rezultatot je\"&lt;&lt;a/b&lt;&lt;endl;\ndefault:\n    cout&lt;&lt;\"Vnesovte netocen podatok\"&lt;&lt;endl;\n    cout&lt;&lt;\"Obidete se povtorno\"&lt;&lt;endl;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "c", "swig"], "comments": [{"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1548999739, "post_id": 54446816, "comment_id": 95754578, "body": "Start with the simplest working C code to call a function in the library.  Any header files you #include to make it work should be in the <code>%{ %}</code> section so the wrapper includes them, too.  Then add one declaration from the header of a function you want to call after the <code>%{ %}</code> section and see if you can build a wrapper with SWIG and call that function from Python.  Share the .i file and your build steps if you have trouble."}, {"owner": {"reputation": 25, "user_id": 3624203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6452cb79d429d818ac995d9450feb42?s=128&d=identicon&r=PG&f=1", "display_name": "tuco94", "link": "https://stackoverflow.com/users/3624203/tuco94"}, "reply_to_user": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1549059858, "post_id": 54446816, "comment_id": 95782406, "body": "It worked.  I included the <code>#includes</code> from lib.cpp on lib.i."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3624203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6452cb79d429d818ac995d9450feb42?s=128&d=identicon&r=PG&f=1", "display_name": "tuco94", "link": "https://stackoverflow.com/users/3624203/tuco94"}, "edited": false, "score": 0, "creation_date": 1548948727, "post_id": 54453626, "comment_id": 95736048, "body": "Thanks for your reply. I now get an error, I updated my original question and included it at the bottom."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "reply_to_user": {"reputation": 25, "user_id": 3624203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6452cb79d429d818ac995d9450feb42?s=128&d=identicon&r=PG&f=1", "display_name": "tuco94", "link": "https://stackoverflow.com/users/3624203/tuco94"}, "edited": false, "score": 0, "creation_date": 1548958548, "post_id": 54453626, "comment_id": 95741648, "body": "@tuco94 Your error is because you didn&#39;t link the Python extension that was generated against the actual implementation of your functions."}, {"owner": {"reputation": 25, "user_id": 3624203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6452cb79d429d818ac995d9450feb42?s=128&d=identicon&r=PG&f=1", "display_name": "tuco94", "link": "https://stackoverflow.com/users/3624203/tuco94"}, "edited": false, "score": 0, "creation_date": 1548962824, "post_id": 54453626, "comment_id": 95743664, "body": "Didn&#39;t I? I linked lib.o(where the function is) and lib_wrap.o against _libmusly.so. Isn&#39;t that it? (The last line in the second code snippet in my question)"}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": true, "score": 1, "last_activity_date": 1548911084, "creation_date": 1548911084, "answer_id": 54453626, "question_id": 54446816, "link": "https://stackoverflow.com/questions/54446816/swig-python-c-c-the-resulting-module-is-empty-no-errors/54453626#54453626", "title": "SWIG Python C/C++. The resulting module is empty, no errors", "body": "<p>In the <code>.i</code> file, code between <code>%{</code> and <code>%}</code> is directly included in the wrapper with no modification.  Code at the module level is parsed by SWIG and wrapper functions are created.  For example:</p>\n\n<pre><code>%module test\n\n%{\nint func(int a, int b) { return a + b; }  // declares a function that will appear in test_wrap.c\n%}\n\nint func(int a, int b);  // SWIG creates a wrapper function in test_wrap.c \n</code></pre>\n\n<p>You can also do <code>%inline %{ %}</code> which both declares and creates wrappers:</p>\n\n<pre><code>%module test\n\n%inline %{\nint func(int a, int b) { return a + b; }\n%}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3624203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6452cb79d429d818ac995d9450feb42?s=128&d=identicon&r=PG&f=1", "display_name": "tuco94", "link": "https://stackoverflow.com/users/3624203/tuco94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 54453626, "answer_count": 1, "score": 0, "last_activity_date": 1549059973, "creation_date": 1548871284, "last_edit_date": 1592644375, "question_id": 54446816, "link": "https://stackoverflow.com/questions/54446816/swig-python-c-c-the-resulting-module-is-empty-no-errors", "title": "SWIG Python C/C++. The resulting module is empty, no errors", "body": "<h1>For anyone in the future</h1>\n<p>The solution is in the comments of the question and the reply.</p>\n<hr />\n<p>I'm trying to create a python interface for the <a href=\"https://github.com/dominikschnitzer/musly\" rel=\"nofollow noreferrer\">musly</a> software (C/C++), more specifically for the libmusly, with swig. I'm using a building directory that is the /libmusly directory from the linked repo with the /include directory from the same repo inside it.</p>\n<p>I'm using the following swig interface named lib.i, since the methods I want to access are in the lib.cpp file. I will say in advance that the section at the end makes me thing the problem is in this file.</p>\n<pre><code>/* lib.i */ \n%module libmusly \n%{ \ntypedef struct {\n    void* method;\n    char* method_name;\n    void* decoder;\n    char* decoder_name; } musly_jukebox;\n\ntypedef float musly_track;\n\ntypedef int musly_trackid;\n\nconst char* musly_version();\n\nvoid musly_debug(\n        int level);\n\nconst char* musly_jukebox_listmethods();\n\nconst char* musly_jukebox_listdecoders();\n\nconst char* musly_jukebox_aboutmethod(\n        musly_jukebox* jukebox);\n\nmusly_jukebox* musly_jukebox_poweron(\n        const char* method,\n        const char* decoder);   int musly_jukebox_similarity(\n        musly_jukebox* jukebox,\n        musly_track* seed_track,\n        musly_trackid seed_trackid,\n        musly_track** tracks,\n        musly_trackid* trackids,\n        int num_tracks,\n        float* similarities);\n\nmusly_track* musly_track_alloc(\n        musly_jukebox* jukebox);\n\nvoid musly_track_free(\n        musly_track* track);\n\nint musly_track_size(\n        musly_jukebox* jukebox);\n\nint musly_track_analyze_audiofile(\n        musly_jukebox* jukebox,\n        const char* audiofile,\n        float excerpt_length,\n        float excerpt_start,\n        musly_track* track);    \n%}\n</code></pre>\n<p>I'm using the following file to build and link it:</p>\n<pre><code>#!/bin/bash\n\necho &quot;Generating swig wrapper file.&quot; \nswig3.0 -c++ -python lib.i\n\necho &quot;Compiling.&quot; \nc++ -fPIC -c -lstdc++ -DNDEBUG -Dlibmusly_EXPORTS\n-DHAVE_AVUTIL_CHANNEL_LAYOUT -DMUSLY_VERSION=\\&quot;0.2\\&quot; -I./ -I./include/ -I./libresample/ -I./decoders/ -I./kissfft/ -I./methods/ -I/usr/include/python3.5m/ -I/usr/include/eigen3/ -I/usr/include/x86_64-linux-gnu lib_wrap.cxx kissfft/kiss_fft.c kissfft/kiss_fftr.c methods/mandelellis.cpp methods/timbre.cpp decoders/libav.cpp resampler.cpp plugins.cpp method.cpp decoder.cpp windowfunction.cpp powerspectrum.cpp melspectrum.cpp discretecosinetransform.cpp mfcc.cpp gaussianstatistics.cpp mutualproximity.cpp lib.cpp\n\nc++ -fPIC -c -lstdc++ -DNDEBUG -Dlibmusly_EXPORTS\n-DHAVE_AVUTIL_CHANNEL_LAYOUT -DMUSLY_VERSION=\\&quot;0.2\\&quot; -I./ -I./include/ -I./libresample/ -I./decoders/ -I./kissfft/ -I./methods/ -I/usr/include/python3.5m/ -I/usr/include/eigen3/ -I/usr/include/x86_64-linux-gnu libresample/filterkit.c libresample/resamplesubs.c libresample/resample.c \n\necho &quot;Linking.&quot; \ncc  -fPIC   -shared -Wl,-soname,libmusly_resample.so\n-o libmusly_resample.so libresample/filterkit.o libresample/resamplesubs.o libresample/resample.o \n\nc++ -fPIC  -shared -Wl,-soname,_libmusly.so -o _libmusly.so kiss_fft.o kiss_fftr.o mandelellis.o timbre.o libav.o resampler.o plugins.o method.o decoder.o windowfunction.o powerspectrum.o melspectrum.o discretecosinetransform.o mfcc.o gaussianstatistics.o mutualproximity.o libmusly_resample.so lib.o lib_wrap.o -lavcodec\n-lavformat -lavutil -lpython3.5m\n</code></pre>\n<p>The mentioned in the title I can import the resulting module into the python interpreter I linked against, 3.5m, with no errors. But the module simply has no methods besides the standard ones, that being and end with an &quot;_&quot; (underscore), and a few swig related methods that also begin and end with an underscore.</p>\n<p>I did try importing libmusly and _libmusly, the former always contains the later anyways. The methods within them are different but the same problem exists, none of my methods are there.</p>\n<p>The files in the directory after compilation are:</p>\n<pre><code>./:\nbuild.sh\ndecoder.cpp\ndecoder.h\ndecoder.o\ndecoders\ndiscretecosinetransform.cpp\ndiscretecosinetransform.h\ndiscretecosinetransform.o\nfiles.txt\nfilterkit.o\ngaussian.h\ngaussianstatistics.cpp\ngaussianstatistics.h\ngaussianstatistics.o\nidpool.h\ninclude\nkissfft\nkiss_fft.o\nkiss_fftr.o\nlibav.o\nlib.cpp\nlib.i\nlibmusly.py\nlibmusly_resample.so\n_libmusly.so\nlib.o\nlibresample\nlib_wrap.cxx\nlib_wrap.o\nmandelellis.o\nmelspectrum.cpp\nmelspectrum.h\nmelspectrum.o\nmethod.cpp\nmethod.h\nmethod.o\nmethods\nmfcc.cpp\nmfcc.h\nmfcc.o\nmutualproximity.cpp\nmutualproximity.h\nmutualproximity.o\nplugins.cpp\nplugins.h\nplugins.o\npowerspectrum.cpp\npowerspectrum.h\npowerspectrum.o\nresample.o\nresampler.cpp\nresampler.h\nresampler.o\nresamplesubs.o\ntimbre.o\nwindowfunction.cpp\nwindowfunction.h\nwindowfunction.o\n\n./decoders:\nlibav.cpp\nlibav.h\n\n./include:\nCMakeLists.txt\nminilog.h\nminilog.h.gch\nmusly\n\n./include/musly:\nmusly.h\nmusly.h.gch\nmusly_types.h\n\n./kissfft:\nCHANGELOG\nCOPYING\nkiss_fft.c\n_kiss_fft_guts.h\nkiss_fft.h\nkiss_fftr.c\nkiss_fftr.h\nREADME\nREADME.simd\nTIPS\n\n./libresample:\nCMakeLists.txt\nfilterkit.c\nfilterkit.h\nfilterkit.o\nlibresample.h\nLICENSE.txt\nREADME.txt\nresample.c\nresample_defs.h\nresample.o\nresamplesubs.c\nresamplesubs.o\n\n./methods:\nmandelellis.cpp\nmandelellis.h\ntimbre.cpp\ntimbre.h\n</code></pre>\n<p>The contents of libmusly.py are:</p>\n<pre><code># This file was automatically generated by SWIG (http://www.swig.org).\n# Version 3.0.10\n#\n# Do not make changes to this file unless you know what you are doing--modify\n# the SWIG interface file instead.\n\n\n\n\n\nfrom sys import version_info as _swig_python_version_info\nif _swig_python_version_info &gt;= (2, 7, 0):\n    def swig_import_helper():\n        import importlib\n        pkg = __name__.rpartition('.')[0]\n        mname = '.'.join((pkg, '_libmusly')).lstrip('.')\n        try:\n            return importlib.import_module(mname)\n        except ImportError:\n            return importlib.import_module('_libmusly')\n    _libmusly = swig_import_helper()\n    del swig_import_helper\nelif _swig_python_version_info &gt;= (2, 6, 0):\n    def swig_import_helper():\n        from os.path import dirname\n        import imp\n        fp = None\n        try:\n            fp, pathname, description = imp.find_module('_libmusly', [dirname(__file__)])\n        except ImportError:\n            import _libmusly\n            return _libmusly\n        if fp is not None:\n            try:\n                _mod = imp.load_module('_libmusly', fp, pathname, description)\n            finally:\n                fp.close()\n            return _mod\n    _libmusly = swig_import_helper()\n    del swig_import_helper\nelse:\n    import _libmusly\ndel _swig_python_version_info\ntry:\n    _swig_property = property\nexcept NameError:\n    pass  # Python &lt; 2.2 doesn't have 'property'.\n\ntry:\n    import builtins as __builtin__\nexcept ImportError:\n    import __builtin__\n\ndef _swig_setattr_nondynamic(self, class_type, name, value, static=1):\n    if (name == &quot;thisown&quot;):\n        return self.this.own(value)\n    if (name == &quot;this&quot;):\n        if type(value).__name__ == 'SwigPyObject':\n            self.__dict__[name] = value\n            return\n    method = class_type.__swig_setmethods__.get(name, None)\n    if method:\n        return method(self, value)\n    if (not static):\n        if _newclass:\n            object.__setattr__(self, name, value)\n        else:\n            self.__dict__[name] = value\n    else:\n        raise AttributeError(&quot;You cannot add attributes to %s&quot; % self)\n\n\ndef _swig_setattr(self, class_type, name, value):\n    return _swig_setattr_nondynamic(self, class_type, name, value, 0)\n\n\ndef _swig_getattr(self, class_type, name):\n    if (name == &quot;thisown&quot;):\n        return self.this.own()\n    method = class_type.__swig_getmethods__.get(name, None)\n    if method:\n        return method(self)\n    raise AttributeError(&quot;'%s' object has no attribute '%s'&quot; % (class_type.__name__, name))\n\n\ndef _swig_repr(self):\n    try:\n        strthis = &quot;proxy of &quot; + self.this.__repr__()\n    except __builtin__.Exception:\n        strthis = &quot;&quot;\n    return &quot;&lt;%s.%s; %s &gt;&quot; % (self.__class__.__module__, self.__class__.__name__, strthis,)\n\ntry:\n    _object = object\n    _newclass = 1\nexcept __builtin__.Exception:\n    class _object:\n        pass\n    _newclass = 0\n\n# This file is compatible with both classic and new-style classes.\n</code></pre>\n<p>I'm using Debian 9 on an Intel i3 from ~2013, everything was installed from the repos. Swig is version 3 and c++ 6.3.0. The swig docs recommend c++ for compiling c++ but I did try other compilers and got the same result.</p>\n<hr />\n<p>When I try to add the following code to the end of /libmusly/CMakeLists.txt and compiling I get two files &quot;libmusly.py&quot; and &quot;_libmusly.so&quot;, the former I have to rename to &quot;_libmusly.py&quot; only to get the same problem. But the resulting _libmusly.so is much bigger than the one I get through the other method, 14,6MB vs 3,5MB.</p>\n<pre><code>FIND_PACKAGE(SWIG REQUIRED) INCLUDE(${SWIG_USE_FILE})\n\nFIND_PACKAGE(PythonLibs) INCLUDE_DIRECTORIES(${LIBMUSLY_INCLUDE}    ${EIGEN3_INCLUDE_DIR}   ${LIBAV_INCLUDE_DIRS}   ${CMAKE_CURRENT_SOURCE_DIR}     ${PYTHON_INCLUDE_PATH})\n\nINCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})\n\nSET(CMAKE_SWIG_FLAGS &quot;&quot;)\n\nSET_SOURCE_FILES_PROPERTIES(lib.i PROPERTIES CPLUSPLUS ON) SET_SOURCE_FILES_PROPERTIES(lib.i PROPERTIES SWIG_FLAGS &quot;-includeall&quot;) SWIG_ADD_MODULE(libmusly python lib.i\n    kissfft/kiss_fft.c\n    kissfft/kiss_fftr.c\n    methods/mandelellis.cpp\n    methods/timbre.cpp\n    decoders/libav.cpp\n    resampler.cpp\n    plugins.cpp\n    method.cpp\n    decoder.cpp\n    windowfunction.cpp\n    powerspectrum.cpp\n    melspectrum.cpp\n    discretecosinetransform.cpp\n    mfcc.cpp\n    gaussianstatistics.cpp\n    mutualproximity.cpp\n    lib.cpp) SWIG_LINK_LIBRARIES(libmusly\n    ${LIBMUSLY_LIBS}\n    ${LIBAV_LIBRARIES}\n    ${LIBMUSLY_EXTERNAL}\n    ${PYTHON_LIBRARIES})\n</code></pre>\n<hr />\n<h1>Update after Mark's reply</h1>\n<p>I can't import the resulting module anymore after using <code>%inline</code> before the <code>%{ %}</code> block. The interpreter complains about an undefined symbol even though it is defined in the .i and .cpp files. I think it might be a linking error but I don't know what. The error:</p>\n<pre><code>Traceback (most recent call last):\n  File &quot;/home/tuco/Desenvolvimento/libmusly_swig/libmusly.py&quot;, line 18, in swig_import_helper\n    return importlib.import_module(mname)\n  File &quot;/usr/lib/python3.5/importlib/__init__.py&quot;, line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 986, in _gcd_import\n  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 969, in _find_and_load\n  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 958, in _find_and_load_unlocked\n  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 666, in _load_unlocked\n  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 577, in module_from_spec\n  File &quot;&lt;frozen importlib._bootstrap_external&gt;&quot;, line 914, in create_module\n  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 222, in _call_with_frames_removed\nImportError: /home/tuco/Desenvolvimento/libmusly_swig/_libmusly.so: undefined symbol: _Z26musly_jukebox_listdecodersv\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;\n  File &quot;/home/tuco/Desenvolvimento/libmusly_swig/libmusly.py&quot;, line 21, in &lt;module&gt;\n    _libmusly = swig_import_helper()\n  File &quot;/home/tuco/Desenvolvimento/libmusly_swig/libmusly.py&quot;, line 20, in swig_import_helper\n    return importlib.import_module('_libmusly')\n  File &quot;/usr/lib/python3.5/importlib/__init__.py&quot;, line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\nImportError: /home/tuco/Desenvolvimento/libmusly_swig/_libmusly.so: undefined symbol: _Z26musly_jukebox_listdecodersv\n</code></pre>\n<p>New libmusly.py</p>\n<pre><code># This file was automatically generated by SWIG (http://www.swig.org).\n# Version 3.0.10\n#\n# Do not make changes to this file unless you know what you are doing--modify\n# the SWIG interface file instead.\n\n\n\n\n\nfrom sys import version_info as _swig_python_version_info\nif _swig_python_version_info &gt;= (2, 7, 0):\n    def swig_import_helper():\n        import importlib\n        pkg = __name__.rpartition('.')[0]\n        mname = '.'.join((pkg, '_libmusly')).lstrip('.')\n        try:\n            return importlib.import_module(mname)\n        except ImportError:\n            return importlib.import_module('_libmusly')\n    _libmusly = swig_import_helper()\n    del swig_import_helper\nelif _swig_python_version_info &gt;= (2, 6, 0):\n    def swig_import_helper():\n        from os.path import dirname\n        import imp\n        fp = None\n        try:\n            fp, pathname, description = imp.find_module('_libmusly', [dirname(__file__)])\n        except ImportError:\n            import _libmusly\n            return _libmusly\n        if fp is not None:\n            try:\n                _mod = imp.load_module('_libmusly', fp, pathname, description)\n            finally:\n                fp.close()\n            return _mod\n    _libmusly = swig_import_helper()\n    del swig_import_helper\nelse:\n    import _libmusly\ndel _swig_python_version_info\ntry:\n    _swig_property = property\nexcept NameError:\n    pass  # Python &lt; 2.2 doesn't have 'property'.\n\ntry:\n    import builtins as __builtin__\nexcept ImportError:\n    import __builtin__\n\ndef _swig_setattr_nondynamic(self, class_type, name, value, static=1):\n    if (name == &quot;thisown&quot;):\n        return self.this.own(value)\n    if (name == &quot;this&quot;):\n        if type(value).__name__ == 'SwigPyObject':\n            self.__dict__[name] = value\n            return\n    method = class_type.__swig_setmethods__.get(name, None)\n    if method:\n        return method(self, value)\n    if (not static):\n        if _newclass:\n            object.__setattr__(self, name, value)\n        else:\n            self.__dict__[name] = value\n    else:\n        raise AttributeError(&quot;You cannot add attributes to %s&quot; % self)\n\n\ndef _swig_setattr(self, class_type, name, value):\n    return _swig_setattr_nondynamic(self, class_type, name, value, 0)\n\n\ndef _swig_getattr(self, class_type, name):\n    if (name == &quot;thisown&quot;):\n        return self.this.own()\n    method = class_type.__swig_getmethods__.get(name, None)\n    if method:\n        return method(self)\n    raise AttributeError(&quot;'%s' object has no attribute '%s'&quot; % (class_type.__name__, name))\n\n\ndef _swig_repr(self):\n    try:\n        strthis = &quot;proxy of &quot; + self.this.__repr__()\n    except __builtin__.Exception:\n        strthis = &quot;&quot;\n    return &quot;&lt;%s.%s; %s &gt;&quot; % (self.__class__.__module__, self.__class__.__name__, strthis,)\n\ntry:\n    _object = object\n    _newclass = 1\nexcept __builtin__.Exception:\n    class _object:\n        pass\n    _newclass = 0\n\nclass musly_jukebox(_object):\n    __swig_setmethods__ = {}\n    __setattr__ = lambda self, name, value: _swig_setattr(self, musly_jukebox, name, value)\n    __swig_getmethods__ = {}\n    __getattr__ = lambda self, name: _swig_getattr(self, musly_jukebox, name)\n    __repr__ = _swig_repr\n    __swig_setmethods__[&quot;method&quot;] = _libmusly.musly_jukebox_method_set\n    __swig_getmethods__[&quot;method&quot;] = _libmusly.musly_jukebox_method_get\n    if _newclass:\n        method = _swig_property(_libmusly.musly_jukebox_method_get, _libmusly.musly_jukebox_method_set)\n    __swig_setmethods__[&quot;method_name&quot;] = _libmusly.musly_jukebox_method_name_set\n    __swig_getmethods__[&quot;method_name&quot;] = _libmusly.musly_jukebox_method_name_get\n    if _newclass:\n        method_name = _swig_property(_libmusly.musly_jukebox_method_name_get, _libmusly.musly_jukebox_method_name_set)\n    __swig_setmethods__[&quot;decoder&quot;] = _libmusly.musly_jukebox_decoder_set\n    __swig_getmethods__[&quot;decoder&quot;] = _libmusly.musly_jukebox_decoder_get\n    if _newclass:\n        decoder = _swig_property(_libmusly.musly_jukebox_decoder_get, _libmusly.musly_jukebox_decoder_set)\n    __swig_setmethods__[&quot;decoder_name&quot;] = _libmusly.musly_jukebox_decoder_name_set\n    __swig_getmethods__[&quot;decoder_name&quot;] = _libmusly.musly_jukebox_decoder_name_get\n    if _newclass:\n        decoder_name = _swig_property(_libmusly.musly_jukebox_decoder_name_get, _libmusly.musly_jukebox_decoder_name_set)\n\n    def __init__(self):\n        this = _libmusly.new_musly_jukebox()\n        try:\n            self.this.append(this)\n        except __builtin__.Exception:\n            self.this = this\n    __swig_destroy__ = _libmusly.delete_musly_jukebox\n    __del__ = lambda self: None\nmusly_jukebox_swigregister = _libmusly.musly_jukebox_swigregister\nmusly_jukebox_swigregister(musly_jukebox)\n\n\ndef musly_version():\n    return _libmusly.musly_version()\nmusly_version = _libmusly.musly_version\n\ndef musly_debug(level):\n    return _libmusly.musly_debug(level)\nmusly_debug = _libmusly.musly_debug\n\ndef musly_jukebox_listmethods():\n    return _libmusly.musly_jukebox_listmethods()\nmusly_jukebox_listmethods = _libmusly.musly_jukebox_listmethods\n\n#def musly_jukebox_listdecoders():\n#    return _libmusly.musly_jukebox_listdecoders()\n#musly_jukebox_listdecoders = _libmusly.musly_jukebox_listdecoders\n\ndef musly_jukebox_aboutmethod(jukebox):\n    return _libmusly.musly_jukebox_aboutmethod(jukebox)\nmusly_jukebox_aboutmethod = _libmusly.musly_jukebox_aboutmethod\n\ndef musly_jukebox_poweron(method, decoder):\n    return _libmusly.musly_jukebox_poweron(method, decoder)\nmusly_jukebox_poweron = _libmusly.musly_jukebox_poweron\n\ndef musly_jukebox_similarity(jukebox, seed_track, seed_trackid, tracks, trackids, num_tracks, similarities):\n    return _libmusly.musly_jukebox_similarity(jukebox, seed_track, seed_trackid, tracks, trackids, num_tracks, similarities)\nmusly_jukebox_similarity = _libmusly.musly_jukebox_similarity\n\ndef musly_track_alloc(jukebox):\n    return _libmusly.musly_track_alloc(jukebox)\nmusly_track_alloc = _libmusly.musly_track_alloc\n\ndef musly_track_free(track):\n    return _libmusly.musly_track_free(track)\nmusly_track_free = _libmusly.musly_track_free\n\ndef musly_track_size(jukebox):\n    return _libmusly.musly_track_size(jukebox)\nmusly_track_size = _libmusly.musly_track_size\n\ndef musly_track_analyze_audiofile(jukebox, audiofile, excerpt_length, excerpt_start, track):\n    return _libmusly.musly_track_analyze_audiofile(jukebox, audiofile, excerpt_length, excerpt_start, track)\nmusly_track_analyze_audiofile = _libmusly.musly_track_analyze_audiofile\n# This file is compatible with both classic and new-style classes.\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1548871007, "post_id": 54446715, "comment_id": 95702432, "body": "Who told you that arrays can change their size? What you should be using is a vector not an array."}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1548871021, "post_id": 54446715, "comment_id": 95702440, "body": "C++ != C, pointers != vectors. Pick a language and learn the idiomatic way of using it."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1548871023, "post_id": 54446715, "comment_id": 95702442, "body": "c or c++? Pick a language first please."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1548871024, "post_id": 54446715, "comment_id": 95702444, "body": "An array without size is no valid C code. Please pick your language properly. C is not C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1548871165, "post_id": 54446715, "comment_id": 95702499, "body": "@Gerhardh It&#39;s not valid C++ either. I think it did used to be valid C. Anyway, use of <code>cin &gt;&gt; value;</code> is definitely not C."}, {"owner": {"reputation": 19, "user_id": 9436018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb62fdcd10fc1f5f36c13815a3904e61?s=128&d=identicon&r=PG", "display_name": "lookster123", "link": "https://stackoverflow.com/users/9436018/lookster123"}, "edited": false, "score": 0, "creation_date": 1548871475, "post_id": 54446715, "comment_id": 95702663, "body": "Can I allocate memory dynamically while the user is inputting values in array ? Let&#39;s say allocate 5 ints and if the number of values &gt; this memory to allocate five more ? Thanks!"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1548871564, "post_id": 54446715, "comment_id": 95702711, "body": "@lookster123 That&#39;s exactly what <code>std::vector</code> does.."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1548871605, "post_id": 54446715, "comment_id": 95702737, "body": "@lookster123 Yes you can, if you did that you&#39;d be writing code similar to what std::vector does for you."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1548872117, "post_id": 54446715, "comment_id": 95702973, "body": "Prefer to use something like <code>while(cin &gt;&gt; value &amp;&amp; value != -1)</code>. It ensures that <code>cin &gt;&gt; value</code> produced a valid result before trying to use it. Also remember that when C++ streams fail, they stay failed until you address the problem by <code>clear</code>ing the error flags and removing the condition that caused the failure."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1548871283, "post_id": 54446790, "comment_id": 95702554, "body": "Always a good idea to try to compile your code before you post an answer - this has several errors."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1548872281, "post_id": 54446790, "comment_id": 95703055, "body": "Still has problems. What happens if <code>std::cin &gt;&gt; value;</code>  fails?"}, {"owner": {"reputation": 19, "user_id": 9436018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb62fdcd10fc1f5f36c13815a3904e61?s=128&d=identicon&r=PG", "display_name": "lookster123", "link": "https://stackoverflow.com/users/9436018/lookster123"}, "edited": false, "score": 0, "creation_date": 1548872661, "post_id": 54446790, "comment_id": 95703217, "body": "@NeilButterworth can you please explain what do you mean by <code>std::cin &gt;&gt; value;</code> failing ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 19, "user_id": 9436018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb62fdcd10fc1f5f36c13815a3904e61?s=128&d=identicon&r=PG", "display_name": "lookster123", "link": "https://stackoverflow.com/users/9436018/lookster123"}, "edited": false, "score": 0, "creation_date": 1548873735, "post_id": 54446790, "comment_id": 95703787, "body": "@lookster <code>std::cin &gt;&gt; value;</code> will fail if you try to read something like &quot;foobar&quot; - the code will then enter an infinite loop. Your code must test every single input operation to see if it worked, and if it didn&#39;t, handle the problem somehow."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 19, "user_id": 9436018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb62fdcd10fc1f5f36c13815a3904e61?s=128&d=identicon&r=PG", "display_name": "lookster123", "link": "https://stackoverflow.com/users/9436018/lookster123"}, "edited": false, "score": 0, "creation_date": 1548924865, "post_id": 54446790, "comment_id": 95721403, "body": "@lookster123 user4581301 in the comments above has the best way to write this loop"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 1, "last_activity_date": 1548871347, "last_edit_date": 1548871347, "creation_date": 1548871179, "answer_id": 54446790, "question_id": 54446715, "link": "https://stackoverflow.com/questions/54446715/how-can-i-initialize-an-array-declared-in-main-in-another-function/54446790#54446790", "title": "How can I initialize an array declared in main in another function", "body": "<p>Do this with a vector, unlike an array a vector can change it's size</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nvoid inputDataInVector(std::vector&lt;int&gt;&amp; v)\n{\n    int value = 0;\n    while (value != -1)\n    {\n         std::cin &gt;&gt; value;\n         v.push_back(value); // this changes the size of the vector\n    }\n}\n\nint main(void)\n{\n    std::vector&lt;int&gt; v;\n\n    inputDataInVector(v);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9436018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb62fdcd10fc1f5f36c13815a3904e61?s=128&d=identicon&r=PG", "display_name": "lookster123", "link": "https://stackoverflow.com/users/9436018/lookster123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 54446790, "answer_count": 1, "score": -2, "last_activity_date": 1548871347, "creation_date": 1548870934, "last_edit_date": 1548871029, "question_id": 54446715, "link": "https://stackoverflow.com/questions/54446715/how-can-i-initialize-an-array-declared-in-main-in-another-function", "title": "How can I initialize an array declared in main in another function", "body": "<p>I want to declare a vector in main dynamically because I don't know how much elements will contain, the elements are inserted from keyboard by an user. The array must be initialized (assign values) in another functions ex: inputDataInVector .</p>\n\n<p>I've tried creating a pointer in main and I pass it to the other function.</p>\n\n<pre><code>void inputDataInVector (int v[])\n{\n    int i = 0; value = 0;\n    while(value != -1)\n    {\n         cin &gt;&gt; value;\n         v[i] = value;\n         i++;\n    }\n}\n\nint main(void)\n{\n    int v[] = {0};\n    int *p = v;\n\n    inputDataInVector(p);\n\n    return 0;\n}\n</code></pre>\n\n<p>Expected result: Add elements in array as the user writes the numbers <br>\nActual result: Array v remains at length 1, keeping only first value introduced</p>\n"}, {"tags": ["python", "c++", "boost", "boost-python"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10652944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08464a07a695821661a2558f5f36e5ce?s=128&d=identicon&r=PG&f=1", "display_name": "endtoendianess", "link": "https://stackoverflow.com/users/10652944/endtoendianess"}, "edited": false, "score": 0, "creation_date": 1550487556, "post_id": 54461930, "comment_id": 96273353, "body": "Thank you very much for your reply. In the end I figured it out myself, and I chose my solution as it more directly implements what I wanted. But I&#39;m really grateful that you took the time to help and reply to my post, it is much appreciated."}], "tags": [], "owner": {"reputation": 7948, "user_id": 4899330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857a19fa016a8fc6c0a3250f03f108a9?s=128&d=identicon&r=PG&f=1", "display_name": "doqtor", "link": "https://stackoverflow.com/users/4899330/doqtor"}, "is_accepted": false, "score": 2, "last_activity_date": 1548942129, "creation_date": 1548942129, "answer_id": 54461930, "question_id": 54446714, "link": "https://stackoverflow.com/questions/54446714/using-boostpython-how-to-return-vector-of-structs-as-list-of-dicts-to-python/54461930#54461930", "title": "Using boost::python, how to return vector of structs as list of dicts to Python?", "body": "<p>Below, how to expose your <code>C++</code> code to <code>Python</code>. <code>MyType</code> needs 'equal to' comparison operator overloaded and also <code>MyType</code> itself needs to be exposed to <code>Python</code>.</p>\n\n<pre><code>#include &lt;boost/python.hpp&gt;\n#include &lt;boost/python/suite/indexing/vector_indexing_suite.hpp&gt;\nusing namespace boost::python;\n\nstruct MyType { \n    int x, y;  \n    bool operator==(const MyType&amp; data) const {\n        return this-&gt;x == data.x &amp;&amp; this-&gt;y == data.y;\n    }   \n};\nstruct A { \n    std::vector&lt;MyType&gt; get_data() const { return {{1,2},{3,4}};};\n};\n\nBOOST_PYTHON_MODULE(pyA) {\n    class_&lt;MyType&gt;(\"MyType\")\n        .def_readwrite(\"x\", &amp;MyType::x)\n        .def_readwrite(\"y\", &amp;MyType::y);\n    class_&lt;std::vector&lt;MyType&gt;&gt;(\"MyList\")\n        .def(vector_indexing_suite&lt;std::vector&lt;MyType&gt;&gt;());\n    class_&lt;A&gt;(\"A\").def(\"get_data\", &amp;A::get_data);\n}\n</code></pre>\n\n<p>Below slightly modified <code>Python</code> script. <code>get_data()</code> return type is of a list so it needs to be accessed as such. If you want it to be a dict then convert it to dict in <code>Python</code>.</p>\n\n<pre><code>import pyA \n\na = pyA.A()\nret = a.get_data();\nfor r in ret:\n    print('x=%d; y=%d;' % (r.x, r.y))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 10652944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08464a07a695821661a2558f5f36e5ce?s=128&d=identicon&r=PG&f=1", "display_name": "endtoendianess", "link": "https://stackoverflow.com/users/10652944/endtoendianess"}, "is_accepted": true, "score": 1, "last_activity_date": 1550487467, "creation_date": 1550487467, "answer_id": 54745713, "question_id": 54446714, "link": "https://stackoverflow.com/questions/54446714/using-boostpython-how-to-return-vector-of-structs-as-list-of-dicts-to-python/54745713#54745713", "title": "Using boost::python, how to return vector of structs as list of dicts to Python?", "body": "<p>In the end I adopted a solution like the following, which I post here in case it is useful to somebody else in the future. This can be improved by adding boost's \"readonly\" qualifier, but I haven't done so yet. </p>\n\n<pre><code>#include &lt;boost/python.hpp&gt;\nusing namespace boost::python;\n\nstruct Point { \n    int x, y;\n};\n\nusing Points = std::vector&lt;Point&gt;;\n\nstruct Converter\n{\n    static PyObject* convert(const Points&amp; v)\n    {\n        boost::python::list ret;\n        for (const auto&amp; c : v) {\n            boost::python::dict *r = new boost::python::dict();\n            (*r)[\"x\"] = c.x;\n            (*r)[\"y\"] = c.y;\n            ret.append(boost::python::object(*r));\n         }\n        return boost::python::incref(ret.ptr());\n    }\n};\n\nBOOST_PYTHON_MODULE(mymodule)\n{\n    boost::python::to_python_converter&lt;Points, Converter&gt;();\n\n    class_&lt;MyClass, boost::noncopyable&gt;(\"MyClass\")\n        .def(\"get_data\", &amp;MyClass::get_data);\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10652944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08464a07a695821661a2558f5f36e5ce?s=128&d=identicon&r=PG&f=1", "display_name": "endtoendianess", "link": "https://stackoverflow.com/users/10652944/endtoendianess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 54745713, "answer_count": 2, "score": 0, "last_activity_date": 1550487467, "creation_date": 1548870933, "question_id": 54446714, "link": "https://stackoverflow.com/questions/54446714/using-boostpython-how-to-return-vector-of-structs-as-list-of-dicts-to-python", "title": "Using boost::python, how to return vector of structs as list of dicts to Python?", "body": "<p>I have the following C++ code:</p>\n\n<pre><code>    struct MyType { int x, y; };\n    struct A { \n        std::vector&lt;MyType&gt; get_data();\n    };\n</code></pre>\n\n<p>which I want to interface to Python using Boost Python so that it can be used in the following way:</p>\n\n<pre><code>    a = A()\n    ret = a.get_data();\n    for r in ret:\n        print('x=%d; y=%d;' % (r['x'], r['y']))\n</code></pre>\n\n<p>What I have now is a rather naive:</p>\n\n<pre><code>    BOOST_PYTHON_MODULE(pyA) { \n        class_&lt;A&gt;(\"A\").def(\"get_data\", &amp;A::get_data);\n    }\n</code></pre>\n\n<p>which gives me, as expected, the following error</p>\n\n<pre><code>     TypeError: No to_python (by-value) converter found for C++ type\n</code></pre>\n\n<p>when I try to call the <code>get_data()</code> function from the Python code. </p>\n\n<p>I have seen posts on here (such as <a href=\"https://stackoverflow.com/questions/6157409/stdvector-to-boostpythonlist?rq=1\">std::vector to boost::python::list</a>) which describe how to use <code>vector_indexing_suite</code> to convert a <code>std::vector&lt;T&gt;</code> to a <code>list</code> for some types <code>T</code> (e.g. floats, strings), but I'm not sure how to extend this to deal with my struct -> dict conversion as well. Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "std", "c++17"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1548870592, "post_id": 54446406, "comment_id": 95702220, "body": "Looks like you hit another gray area"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548870867, "post_id": 54446406, "comment_id": 95702376, "body": "I cannot find any such guarantee in the current draft. Is it really there as claimed?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548871532, "post_id": 54446406, "comment_id": 95702695, "body": "@n.m. Seems to be <a href=\"http://eel.is/c++draft/associative.reqmts#4\" rel=\"nofollow noreferrer\"><code>[associative.reqmts]&#47;4</code></a>? Plus the semantics for <code>emplace</code> described in table 69 below it"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1548871636, "post_id": 54446406, "comment_id": 95702754, "body": "Because you never know when an implementation is going to randomly shuffle the elements from an initialiser list before iterating through them in a constructor..."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1548871671, "post_id": 54446406, "comment_id": 95702774, "body": "@Galik Well, if it&#39;s not guaranteed, then that&#39;s precisely so."}], "answers": [{"comments": [{"owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 1, "creation_date": 1548871158, "post_id": 54446691, "comment_id": 95702494, "body": "The pedantic side of me wants to say that <code>inserts elements from the range [i, j)</code> only specifies the bounds of the range, not the order in which it has to be iterated."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1548871482, "post_id": 54446691, "comment_id": 95702667, "body": "@Ics Very pedantically yeah, the order is unspecified. That appears to apply to pretty much all operations that insert from a range of iterators into any container. It would be pretty infuriating if for example <code>vector.insert(first, last)</code> didn&#39;t insert in order."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548871643, "post_id": 54446691, "comment_id": 95702756, "body": "I would expect <code>[i,j)</code> to be defined to include an order property somewhere in the text, or, more likely, in a normative reference to some obscure mathsy standard"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1548871762, "post_id": 54446691, "comment_id": 95702813, "body": "@LightnessRacesinOrbit at least, the iterator category is only requried to be input iterator, which doens&#39;t provide any way of iterating non-linearly. But I haven&#39;t found an explicit rule saying that it couldn&#39;t do silly things with forward or more able iterators."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548872106, "post_id": 54446691, "comment_id": 95702967, "body": "Found it in ISO 80000-2:2009 section 6, which <a href=\"http://eel.is/c++draft/intro.refs#1.10\" rel=\"nofollow noreferrer\">C++ refers to normatively</a>, and it is <i>not</i> defined as an n-tuple but as a set, so order isn&#39;t technically well-defined. Dafuq"}, {"owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1548873999, "post_id": 54446691, "comment_id": 95703932, "body": "Yeah, even with forward iterators you could do even indices first, then odd. Doubtful anyone <i>would</i> though"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1548872367, "last_edit_date": 1548872367, "creation_date": 1548870871, "answer_id": 54446691, "question_id": 54446406, "link": "https://stackoverflow.com/questions/54446406/does-multimap-guarantee-that-insertion-order-matches-the-order-of-elements-given/54446691#54446691", "title": "Does multimap guarantee that insertion order matches the order of elements given in its initializer?", "body": "<p><a href=\"http://eel.is/c++draft/associative.reqmts#8\" rel=\"nofollow noreferrer\">[associative.reqmts]</a>:</p>\n\n<blockquote>\n  <p>... i and j satisfy\n  input iterator requirements and refer to elements implicitly convertible to value_type, [i, j) denotes a\n  valid range ... il designates an object of type <code>initializer_list&lt;value_type&gt;</code> ...</p>\n\n<pre><code>Expression    Assertion/note\n              pre-/post-condition\n\nX(i,j,c)      Effects: Constructs an empty container\n              and inserts elements from the range [i, j)\n              into it; uses c as a comparison object.\n\nX(i,j)        Effects: Same as above, but\n              uses Compare() as a\n              comparison object.\n\nX(il)         same as X(il.begin(), il.end())\n</code></pre>\n</blockquote>\n\n<p>So, the effects being the same, ordering guarantees are same when constructing from an initialiser list, as they are when inserting a range of iterators.</p>\n\n<p>Being input iterators, the range cannot <em>in general</em> be iterated out of order. </p>\n"}], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 1, "accepted_answer_id": 54446691, "answer_count": 1, "score": 4, "last_activity_date": 1548872367, "creation_date": 1548869843, "question_id": 54446406, "link": "https://stackoverflow.com/questions/54446406/does-multimap-guarantee-that-insertion-order-matches-the-order-of-elements-given", "title": "Does multimap guarantee that insertion order matches the order of elements given in its initializer?", "body": "<p>If I do this:</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::multimap&lt;char, int&gt; m;\n\n    m.emplace('a', 100);\n    m.emplace('b', 200);\n    m.emplace('b', 201);\n    m.emplace('c', 300);\n\n    for (const auto&amp; p : m)\n        std::cout &lt;&lt; p.first &lt;&lt; '\\t' &lt;&lt; p.second &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>&hellip; then, <a href=\"https://stackoverflow.com/a/13337612/560648\">since C++11</a>, I'm guaranteed that the element with value <code>200</code> will precede the element with value <code>201</code>.</p>\n\n<p>But what if I do this?</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::multimap&lt;char, int&gt; m{\n       {'a', 100},\n       {'b', 200},\n       {'b', 201},\n       {'c', 300}\n    };\n\n    for (const auto&amp; p : m)\n        std::cout &lt;&lt; p.first &lt;&lt; '\\t' &lt;&lt; p.second &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Are we guaranteed that \"insertion order\" matches the order of elements in the initialiser?</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/468b3cc1aa6dabdd\" rel=\"nofollow noreferrer\">A quick test</a> gives encouraging results, but doesn't really prove anything.</p>\n\n<p>I'm writing C++17.</p>\n\n<p><em>(I could switch to <code>std::map</code> with a compound key, but I have thousands of these things managed by a common interface, and only a few contain duplicate keys so I'm hesitant to introduce that complexity overall.)</em></p>\n"}, {"tags": ["c#", "c++", "flatbuffers"], "answers": [{"tags": [], "owner": {"reputation": 4578, "user_id": 17419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU9iE.jpg?s=128&g=1", "display_name": "Aardappel", "link": "https://stackoverflow.com/users/17419/aardappel"}, "is_accepted": true, "score": 1, "last_activity_date": 1548870863, "creation_date": 1548870863, "answer_id": 54446687, "question_id": 54446371, "link": "https://stackoverflow.com/questions/54446371/systemaccessoutofbound-exception-while-trying-to-access-lengthoftable-from-fla/54446687#54446687", "title": "SystemAccessOutOfbound Exception while trying to access &quot;LengthofTable&quot; from flatbuffer&#39;s binary file", "body": "<p>I see 2 problems in your code:</p>\n\n<ul>\n<li>It's missing a <code>ListOfAttendee.clear()</code>, your nested loops are causing this list to grow bigger on each iteration.</li>\n<li>You are writing pointer data to a file, not what the pointer is pointing to (remove the <code>&amp;</code>).</li>\n</ul>\n"}], "owner": {"reputation": 218, "user_id": 7708168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6447b9e99a8b51f4dbc5a35a951b2d02?s=128&d=identicon&r=PG&f=1", "display_name": "BlueDragon96", "link": "https://stackoverflow.com/users/7708168/bluedragon96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54446687, "answer_count": 1, "score": 0, "last_activity_date": 1548870863, "creation_date": 1548869721, "question_id": 54446371, "link": "https://stackoverflow.com/questions/54446371/systemaccessoutofbound-exception-while-trying-to-access-lengthoftable-from-fla", "title": "SystemAccessOutOfbound Exception while trying to access &quot;LengthofTable&quot; from flatbuffer&#39;s binary file", "body": "<p>I'm storing my data according to following schema. </p>\n\n<pre><code>namespace iCalendarParser;\n\ntable EventParsed {\n\nUID:string;\nOrganizer:string;\nSummary:string;\nDescription:string;\nAttendee:[string];\nCategories:string;\nDtEnd:string;\nDtStart:string;\nDtStamp:string;\nAttendeeCounter:short;\n\n}\n\ntable TableofEvents{\n\n  events:[EventParsed];\n\n}\n\nroot_type TableofEvents;\n</code></pre>\n\n<p>I'm storing data like this in my c++ application.</p>\n\n<pre><code>   std::vector&lt;flatbuffers::Offset&lt;flatbuffers::String&gt;&gt; ListOfAttendee;\n   std::vector&lt;flatbuffers::Offset&lt;iCalendarParser::EventParsed&gt;&gt; ListofEvents;\n\n\n\n    for (auto EventList : ListofAllEvents)\n    {\n\nauto Organizer = builder.CreateString(EventList-&gt;Organizer);\nauto UID = builder.CreateString(EventList-&gt;UID);\nauto DtStart = builder.CreateString(EventList-&gt;DtStart);\nauto DtEnd = builder.CreateString(EventList-&gt;DtEnd);\nauto DtStamp = builder.CreateString(EventList-&gt;DtStamp);\nauto Summary = builder.CreateString(EventList-&gt;Summary);\nauto Description = builder.CreateString(EventList-&gt;Description);\nauto Categories = builder.CreateString(EventList-&gt;Categories);\n\nfor (int i = 0; i &lt; EventList-&gt;AttendeeCounter; i++)\n{\n    ListOfAttendee.push_back(builder.CreateString(EventList-&gt;Attendee[i]));\n\n}\n\n\nauto VectorListofAttendee = builder.CreateVector(ListOfAttendee);\n\nauto CreatEventInFlatBuffer = CreateEventParsed(builder, UID, Organizer, Summary, Description, VectorListofAttendee, Categories, DtEnd, DtStart, DtStamp, EventList-&gt;AttendeeCounter);\n\nListofEvents.push_back(CreatEventInFlatBuffer);\n\n }\n\n auto CreatVectorOfEventInFlatbuffer = builder.CreateVector(ListofEvents);\n auto InsertEventInFlatBufferList = CreateTableofEvents(builder, \n CreatVectorOfEventInFlatbuffer);\n builder.Finish(InsertEventInFlatBufferList);\n\n uint8_t *buf = builder.GetBufferPointer();\n int size = builder.GetSize();\n\n std::ofstream ofile(\"icalBin.bin\", std::ios::binary);\n ofile.write((char *)&amp;buf, size);\n ofile.close();\n</code></pre>\n\n<p>From my C# application I'm trying to access the deserialize the data. </p>\n\n<pre><code>byte[] ReadbytesfromFile = File.ReadAllBytes(\"icalBin.bin\");\nvar buffer = new ByteBuffer(ReadbytesfromFile);\nvar tableofEvents = TableofEvents.GetRootAsTableofEvents(buffer); \nint len = tableofEvents.EventsLength;\n</code></pre>\n\n<p>I can not figure out what is wrong. Can anyone tell me how can I access nested tables according to schema and deserialize into C#.</p>\n\n<p>General idea:</p>\n\n<p>1.Get listofevents.</p>\n\n<p>2.Access individual events struct. (The result I'm trying to get)</p>\n"}, {"tags": ["c++", "variant", "c++-concepts"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1548869669, "post_id": 54446194, "comment_id": 95701771, "body": "AIUI, concepts are a completely compile-time thing.  You really need some kind of introspection to do that at run-time, and that&#39;s not part of Standard C++."}, {"owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1548869874, "post_id": 54446194, "comment_id": 95701858, "body": "@TobySpeight concepts as a language feature are a compile time thing, but even at runtime types exist(and types satisfy concepts or not)."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548869968, "post_id": 54446194, "comment_id": 95701899, "body": "Do you actually want to use concepts here?"}, {"owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548872589, "post_id": 54446194, "comment_id": 95703174, "body": "@MaxLanghof if they help with readability... from what I see your answer is nice already, but if concepts make it better, then that is even better."}], "answers": [{"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 3, "last_activity_date": 1548872181, "last_edit_date": 1548872181, "creation_date": 1548870904, "answer_id": 54446701, "question_id": 54446194, "link": "https://stackoverflow.com/questions/54446194/asking-at-runtime-if-alternative-in-variant-satisfies-a-certain-concept/54446701#54446701", "title": "Asking at runtime if alternative in variant satisfies a certain concept", "body": "<p>You can simplify the visitor a lot by using <code>if constexpr</code>:</p>\n\n<pre><code>struct visitor{\n  template&lt;typename T&gt;\n  void operator()(T&amp; t) {\n    if constexpr (has_reduce_thrust&lt;T&gt;::value) {\n      t.reduce_thrust(perc);\n      reduced_thrust = true;\n    }\n    else {\n      reduced_thrust = false;\n    }\n  }\n\n  int perc = 0;\n  bool reduced_thrust = false;  \n};\n</code></pre>\n\n<p>You could then abstract further by accepting any predicate and two functions for either branch of the <code>if constexpr</code>:</p>\n\n<pre><code>template &lt;template &lt;class, class... /*SFINAE friendly*/&gt; class TypePred,\n          class MatchedFunc, class UnmatchedFunc&gt;\nclass predicated_visitor {\n public:\n  predicated_visitor(MatchedFunc matchedFunc, UnmatchedFunc unmatchedFunc)\n      : _matchedFunc(matchedFunc), _unmatchedFunc(unmatchedFunc) {}\n\n  template &lt;typename T&gt;\n  void operator()(T&amp; t) {\n    if constexpr (TypePred&lt;T&gt;::value)\n      _matchedFunc(t);\n    else\n      _unmatchedFunc(t);\n  }\n\n private:\n  MatchedFunc _matchedFunc;\n  UnmatchedFunc _unmatchedFunc;\n};\n\ntemplate &lt;template &lt;class, class... /*SFINAE friendly*/&gt; class TypePred,\n          class F1, class F2&gt;\nauto makePredicatedVisitor(F1 f1, F2 f2) {\n  return predicated_visitor&lt;TypePred, F1, F2&gt;(f1, f2);\n}\n</code></pre>\n\n<p>The resulting code is quite nice I feel:</p>\n\n<pre><code>void reduce_speed(std::variant&lt;simple_engine1, simple_engine2, complex_engine1,\n                               complex_engine2&gt;* var_engine) {\n  int perc = 47;\n  bool reducedThrust = false;\n\n  auto reduceableThrustAction = [perc, &amp;reducedThrust](auto&amp; t) {\n    t.reduce_thrust(perc);\n    reducedThrust = true;\n  };\n  auto alternativeAction = [](auto&amp; t) {\n  };  // Could explicitly set reduceThrust to false for clarity.\n\n  auto thrust_visitor = makePredicatedVisitor&lt;has_reduce_thrust&gt;(\n      reduceableThrustAction, alternativeAction);\n\n  std::visit(thrust_visitor, *var_engine);\n\n  if (reducedThrust) {\n    std::cout &lt;&lt; \"reduced thrust\\n\";\n  } else {\n    std::cout &lt;&lt; \"activating reverse engines\\n\";\n  }\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/-_I8gn\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>This example compiles to essentially the same assembly code as yours but can be reused in any way you like. </p>\n\n<p><sup>I apologize for the inconsistent capitalization...</sup></p>\n"}], "owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548872181, "creation_date": 1548869135, "question_id": 54446194, "link": "https://stackoverflow.com/questions/54446194/asking-at-runtime-if-alternative-in-variant-satisfies-a-certain-concept", "title": "Asking at runtime if alternative in variant satisfies a certain concept", "body": "<p>I have the following <a href=\"https://wandbox.org/permlink/NqjC7rmhphed32d4\" rel=\"nofollow noreferrer\">code</a> where I try to detect what concept(member functions in this case) alternative in variant holds. \nIt is verbose and relatively ugly.\nIs there a nicer way to do this?\nNote that I do not want to use inheritance, and I do not want to use static polymorphism(let's assume what engine is used is not known at compile time).</p>\n\n<p>In simple terms I am looking for runtime mix of <code>if constexpr</code>(that only checks concepts at compile time) and <code>std::holds_alternative</code> (that can only check for if specific type is in <code>variant</code>, not if any of the types satisfying the concept is in <code>variant</code>).</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;variant&gt;\n\n\nstruct simple_engine1{\n\n};\nstruct simple_engine2{\n\n};\nstruct complex_engine1{\n    void reduce_thrust(int perc){\n        std::cout&lt;&lt;\"reducing thrust \" &lt;&lt; perc &lt;&lt; \"% \" &lt;&lt; std::endl;\n    }\n};\nstruct complex_engine2{\n    void reduce_thrust(int perc){\n        std::cout&lt;&lt;\"reducing thrust \" &lt;&lt; perc &lt;&lt; \"% \" &lt;&lt; std::endl;\n    }\n};\ntemplate&lt; class, class = std::void_t&lt;&gt; &gt;\nstruct has_reduce_thrust : std::false_type { };\ntemplate&lt; class T &gt;\nstruct has_reduce_thrust&lt;T,\n           std::void_t&lt;decltype( std::declval&lt;T&gt;().reduce_thrust(42) )&gt;\n       &gt; : std::true_type { };\nstatic_assert(!has_reduce_thrust&lt;simple_engine1&gt;::value);\nstatic_assert(!has_reduce_thrust&lt;simple_engine1&gt;::value);\nstatic_assert(has_reduce_thrust&lt;complex_engine1&gt;::value);\n\nstruct visitor{\n  template&lt;typename T&gt;\n  void operator()(T&amp; t){\n      dispatch(t, has_reduce_thrust&lt;T&gt;{});\n\n  }\n  template&lt;typename T&gt;\n  void dispatch(T&amp; t, std::true_type /*has_reduce_thrust*/){\n      t.reduce_thrust(perc);\n      reduced_thrust=true;\n  }\n  template&lt;typename T&gt;\n  void dispatch(T&amp; , std::false_type){\n      reduced_thrust=false;\n  }\n  int perc = 0;\n  bool reduced_thrust = false;  \n};\n// tries to reduce speed by reducing thrust if engine supports it, if not\n// it fires reverse engines(more expensive wrt fuel usage)\nvoid reduce_speed(std::variant&lt;simple_engine1, simple_engine2, complex_engine1, complex_engine2&gt;* var_engine){\n    visitor v;\n    v.perc = 47;\n    std::visit(v, *var_engine);\n    if (v.reduced_thrust) {\n        std::cout &lt;&lt; \"reduced thrust\\n\"; \n    } else {\n        std::cout &lt;&lt; \"activating reverse engines\\n\";\n    }\n}\nint main() {\n    std::variant&lt;simple_engine1, simple_engine2, complex_engine1, complex_engine2&gt; var_engine{simple_engine1{}};\n    reduce_speed(&amp;var_engine);\n    var_engine = complex_engine2{};\n    reduce_speed(&amp;var_engine);\n    var_engine = simple_engine2{};\n    reduce_speed(&amp;var_engine);\n    var_engine = complex_engine2{};\n    reduce_speed(&amp;var_engine);\n} \n</code></pre>\n"}, {"tags": ["c++", "eclipse-cdt"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1548869254, "post_id": 54446166, "comment_id": 95701559, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6717163/how-to-access-private-data-members-outside-the-class-without-making-friends\">How to access private data members outside the class without making &quot;friend&quot;s?</a>"}, {"owner": {"reputation": 59, "user_id": 5907759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ad22ca5cdb3ccb2f9b1633e7ef8038?s=128&d=identicon&r=PG&f=1", "display_name": "Yassin Mohamadi", "link": "https://stackoverflow.com/users/5907759/yassin-mohamadi"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1548869883, "post_id": 54446166, "comment_id": 95701863, "body": "no i didn&#39;t find an answer there ! so it&#39;s not the same question. Me i focus on using CDT"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 5907759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ad22ca5cdb3ccb2f9b1633e7ef8038?s=128&d=identicon&r=PG&f=1", "display_name": "Yassin Mohamadi", "link": "https://stackoverflow.com/users/5907759/yassin-mohamadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1548871094, "creation_date": 1548871094, "answer_id": 54446768, "question_id": 54446166, "link": "https://stackoverflow.com/questions/54446166/what-is-the-node-element-to-get-the-definition-of-attribute-from-header-file-usi/54446768#54446768", "title": "what is the node element to get the definition of attribute from header file using CDT?", "body": "<p>we need to test that :\nthe parent of this node is of type CPPASTDeclarator and the third parent is a class (mean of type ICPPASTCompositeTypeSpecifier) like that we ensure that this declaration is an attribute declaration for a class</p>\n\n<p>for example name:IASTName </p>\n\n<p>if ((name.getParent() instanceof CPPASTDeclarator) &amp;&amp; (name.getParent().getParent().getParent() instanceof ICPPASTCompositeTypeSpecifier))</p>\n"}], "owner": {"reputation": 59, "user_id": 5907759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ad22ca5cdb3ccb2f9b1633e7ef8038?s=128&d=identicon&r=PG&f=1", "display_name": "Yassin Mohamadi", "link": "https://stackoverflow.com/users/5907759/yassin-mohamadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548871094, "creation_date": 1548869033, "last_edit_date": 1548869118, "question_id": 54446166, "link": "https://stackoverflow.com/questions/54446166/what-is-the-node-element-to-get-the-definition-of-attribute-from-header-file-usi", "title": "what is the node element to get the definition of attribute from header file using CDT?", "body": "<p>I have a .h file refer to a class file (.cpp), I am using CDT to modify code but i didn't find element node that refer to attribute of class for example :</p>\n\n<pre><code>#ifndef DEF_PERSONNAGE\n#define DEF_PERSONNAGE\n\nclass simple \n{\n    public:\n\n    void recevoirDegats(int nbDegats);\n\n    private:\n\n    int m_vie;\n};\n\n#endif\n</code></pre>\n\n<p>I get the function declarator by testing if the node is instance of IASTFunctionDeclarator but to get the field int m_vie; i use what ?</p>\n"}, {"tags": ["c++", "arduino", "nfc", "arduino-esp8266", "ndef"], "comments": [{"owner": {"reputation": 36212, "user_id": 2425802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RKefk.png?s=128&g=1", "display_name": "Michael Roland", "link": "https://stackoverflow.com/users/2425802/michael-roland"}, "edited": false, "score": 0, "creation_date": 1548925830, "post_id": 54446038, "comment_id": 95722000, "body": "What record type do you use? I.e what&#39;s the value that you obtain from <code>record.getType(...)</code>? Does <code>Serial.println(data);</code> print anything when you call it from within the <code>request()</code> function? What&#39;s the value of <code>payloadLength</code> and what data string value is printed &quot;correctly&quot;? Is <code>payloadLength</code> a few bytes longer than the actual string?"}, {"owner": {"reputation": 95, "user_id": 7068584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe42b623af2fa7f04cedd4bcea2c2f?s=128&d=identicon&r=PG&f=1", "display_name": "lasse", "link": "https://stackoverflow.com/users/7068584/lasse"}, "reply_to_user": {"reputation": 36212, "user_id": 2425802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RKefk.png?s=128&g=1", "display_name": "Michael Roland", "link": "https://stackoverflow.com/users/2425802/michael-roland"}, "edited": false, "score": 0, "creation_date": 1548932144, "post_id": 54446038, "comment_id": 95725827, "body": "Hey @MichaelRoland! Printing record gives me the letter &#39;U&#39; Interestingly when I call Serial.println(data) in the request function it prints something different from when i call it after the char assignment loop. Example: if the tag is written with the contents &quot;abc&quot; and &quot;def&quot;, Serial.print, prints &quot;abc&quot; and &quot;def&quot; to the console when called in loop. When it&#39;s called in the request function it prints &quot;f&quot; twice. I just figgured this even differs whenever I add or remove other Serial prints in the request function. WIth that tag, payloadLength is 4 for each record."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7068584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe42b623af2fa7f04cedd4bcea2c2f?s=128&d=identicon&r=PG&f=1", "display_name": "lasse", "link": "https://stackoverflow.com/users/7068584/lasse"}, "edited": false, "score": 0, "creation_date": 1550356509, "post_id": 54721831, "comment_id": 96240272, "body": "Thanks for the elaborate answer! I unfortunately will take a wile until I can try it but I&#39;m still a lot looking forward to having this properly fixed and will confirm the moment I got to it. Thanks also for editing the question. I just learned edits are the more useful way to add clarification."}, {"owner": {"reputation": 2017, "user_id": 98279, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/05b5fe02a86274c37a974a8902150712?s=128&d=identicon&r=PG", "display_name": "Christian Beer", "link": "https://stackoverflow.com/users/98279/christian-beer"}, "edited": false, "score": 1, "creation_date": 1597501625, "post_id": 54721831, "comment_id": 112156401, "body": "Beware: this doesn&#39;t work, as the for loop uses <code>i</code> instead of <code>j</code> as index. You need to change it to <code>j</code> in the lower for loop."}, {"owner": {"reputation": 36212, "user_id": 2425802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RKefk.png?s=128&g=1", "display_name": "Michael Roland", "link": "https://stackoverflow.com/users/2425802/michael-roland"}, "reply_to_user": {"reputation": 2017, "user_id": 98279, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/05b5fe02a86274c37a974a8902150712?s=128&d=identicon&r=PG", "display_name": "Christian Beer", "link": "https://stackoverflow.com/users/98279/christian-beer"}, "edited": false, "score": 0, "creation_date": 1597586973, "post_id": 54721831, "comment_id": 112175435, "body": "@christianbeer thanks for finding. Fixed it. Feel free to suggest such edits directly on a post."}], "tags": [], "owner": {"reputation": 36212, "user_id": 2425802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RKefk.png?s=128&g=1", "display_name": "Michael Roland", "link": "https://stackoverflow.com/users/2425802/michael-roland"}, "is_accepted": false, "score": 1, "last_activity_date": 1597586890, "last_edit_date": 1597586890, "creation_date": 1550310785, "answer_id": 54721831, "question_id": 54446038, "link": "https://stackoverflow.com/questions/54446038/convert-ndef-record-payload-to-string-for-ethernetclient-print/54721831#54721831", "title": "Convert NDEF record payload to string for EthernetClient print()", "body": "<p>Based on the information that you provided in your comment, the tag contains a URI record (that, in turn, contains your data). The problem in your code is that you directly use the full payload of the URI record as a string. However, a URI record contains more that just a string. Particularly, the first byte of the payload is the prefix byte (typically a non-printable character). So it seems that <code>Serial.println()</code> (or rather your serial receiver) simply skips that character. <code>client.print()</code> will include that character into the HTTP request and will consequently create an invalid HTTP request (that looks as if the remaining bytes were omitted).</p>\n<p>Therefore, you will have to follow the URI Record Type Definition to decode the payload into a proper URI before using it:</p>\n<pre><code>NdefMessage message = tag.getNdefMessage();\nfor (int i = 0; i &lt; message.getRecordCount(); ++i) {\n    NdefRecord record = message.getRecord(i);\n    if (record.getType() == &quot;U&quot;) {\n        String uri = &quot;&quot;;\n        int payloadLength = record.getPayloadLength();\n        if (payloadLength &gt; 0) {\n            byte payload[payloadLength];\n            record.getPayload(payload);\n            \n            switch (payload[0]) {\n                case 0x000: break;\n                case 0x001: uri += &quot;http://www.&quot;; break;\n                case 0x002: uri += &quot;https://www.&quot;; break;\n                case 0x003: uri += &quot;http://&quot;; break;\n                case 0x004: uri += &quot;https://&quot;; break;\n                case 0x005: uri += &quot;tel:&quot;; break;\n                case 0x006: uri += &quot;mailto:&quot;; break;\n                case 0x007: uri += &quot;ftp://anonymous:anonymous@&quot;; break;\n                case 0x008: uri += &quot;ftp://ftp.&quot;; break;\n                case 0x009: uri += &quot;ftps://&quot;; break;\n                case 0x00A: uri += &quot;sftp://&quot;; break;\n                case 0x00B: uri += &quot;smb://&quot;; break;\n                case 0x00C: uri += &quot;nfs://&quot;; break;\n                case 0x00D: uri += &quot;ftp://&quot;; break;\n                case 0x00E: uri += &quot;dav://&quot;; break;\n                case 0x00F: uri += &quot;news:&quot;; break;\n                case 0x010: uri += &quot;telnet://&quot;; break;\n                case 0x011: uri += &quot;imap:&quot;; break;\n                case 0x012: uri += &quot;rtsp://&quot;; break;\n                case 0x013: uri += &quot;urn:&quot;; break;\n                case 0x014: uri += &quot;pop:&quot;; break;\n                case 0x015: uri += &quot;sip:&quot;; break;\n                case 0x016: uri += &quot;sips:&quot;; break;\n                case 0x017: uri += &quot;tftp:&quot;; break;\n                case 0x018: uri += &quot;btspp://&quot;; break;\n                case 0x019: uri += &quot;btl2cap://&quot;; break;\n                case 0x01A: uri += &quot;btgoep://&quot;; break;\n                case 0x01B: uri += &quot;tcpobex://&quot;; break;\n                case 0x01C: uri += &quot;irdaobex://&quot;; break;\n                case 0x01D: uri += &quot;file://&quot;; break;\n                case 0x01E: uri += &quot;urn:epc:id:&quot;; break;\n                case 0x01F: uri += &quot;urn:epc:tag:&quot;; break;\n                case 0x020: uri += &quot;urn:epc:pat:&quot;; break;\n                case 0x021: uri += &quot;urn:epc:raw:&quot;; break;\n                case 0x022: uri += &quot;urn:epc:&quot;; break;\n                case 0x023: uri += &quot;urn:nfc:&quot;; break;\n                default: break;\n            }\n            for (int j = 1; j &lt; payloadLength; ++j) {\n                uri += (char)payload[j]; // NOTE: this is wrong since the string is UTF-8 encoded (but we translate it byte-by-byte)\n            }\n        }\n        Serial.println(uri);\n        request(uri);\n    }\n}\n</code></pre>\n<p>Be aware that there a still a few issues with the solution above:</p>\n<ul>\n<li>The string part of the URI (bytes starting at offset 1) is actually UTF-8 encoded. However, we treat it as if it was (more or less) ASCII encoded here. I haven't found any simple library to properly transform byte arrays into a UTF-8 encoded string representation on Arduino though.</li>\n<li>If your resulting URI contains characters that have special meaning in URLs (such as &quot;/&quot;, &quot;:&quot;, &quot;&amp;&quot;, etc.), you would need to urlencode (see e.g. <a href=\"https://stackoverflow.com/a/22053443/2425802\">here</a>) them before appending the string to the GET request. Otherwise, the resulting URI of the GET request may not be what you expected.</li>\n<li><code>String</code> is certainly not the best choice in terms of memory efficiency.</li>\n</ul>\n"}], "owner": {"reputation": 95, "user_id": 7068584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe42b623af2fa7f04cedd4bcea2c2f?s=128&d=identicon&r=PG&f=1", "display_name": "lasse", "link": "https://stackoverflow.com/users/7068584/lasse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1597586890, "creation_date": 1548868543, "last_edit_date": 1550311211, "question_id": 54446038, "link": "https://stackoverflow.com/questions/54446038/convert-ndef-record-payload-to-string-for-ethernetclient-print", "title": "Convert NDEF record payload to string for EthernetClient print()", "body": "<p>I try to make a HTTP GET request with data read from an NDEF formatted MIFARE NFC tag. I fail to convert the byte array data from the tag into a format that works with the Ethernet client <code>print()</code> function.</p>\n\n<p>Hardware setup is an Arduino Uno with a seeedstudio NFC Shield and an Arduino ethernet shield. I make use of the ethernet, the PN532, and the NfcAdapter library.</p>\n\n<p>I tried several types of conversion using <code>char *</code> and <code>char[]</code> instead of the String object with no success.</p>\n\n<p>To pinpoint the problem I picked a case where <code>Serial.print()</code> gives the expected result but <code>client.print()</code> does not.</p>\n\n<p>Code is based on the <a href=\"https://github.com/don/NDEF/blob/master/examples/ReadTagExtended/ReadTagExtended.ino\" rel=\"nofollow noreferrer\">PN532 NDEF library example 'ReadTagExtended'</a>.</p>\n\n<pre><code>void loop(void)\n{\n    if (nfc.tagPresent()) // Do an NFC scan to see if an NFC tag is present\n    {\n        NfcTag tag = nfc.read(); // read the NFC tag\n        if (tag.hasNdefMessage())\n        {\n            NdefMessage message = tag.getNdefMessage();\n            for (int i = 0; i &lt; message.getRecordCount(); i++)\n            {\n                NdefRecord record = message.getRecord(i);\n                int payloadLength = record.getPayloadLength();\n                byte payload[payloadLength];\n                record.getPayload(payload);\n                String tag_content = \"\";\n                for(int i = 0; i&lt;payloadLength; i++) {\n                    tag_content += (char)payload[i];\n                }\n                Serial.println(tag_content); // prints the correct string\n                request(tag_content);\n            }\n        }\n    }\n}\n\nvoid request(String data) {\n    EthernetClient client;\n\n    // if you get a connection, report back via serial:\n    if (client.connect(remote, 8080)) {\n        client.print(\"GET /subaddress\");\n        client.print(\"?data=\");\n        client.print(data); // unfortunately empty\n        client.println();\n        client.println();\n\n        while (client.connected()) {\n        if (client.available()) {\n            char c = client.read();\n            Serial.print(c);\n        }\n    }\n    client.stop();\n    Serial.println(\" OK\");\n    delay(100);\n    } else {\n        Serial.println(\"ERR\");\n        delay(100);\n    }\n}\n</code></pre>\n\n<p>With the above setup, I get the expected output using <code>Serial.println()</code>. Yet, in the (successfull) request, <code>data</code> is empty.</p>\n\n<hr>\n\n<p><strong>From the comments (summarized):</strong></p>\n\n<p>Printing the record type (<code>record.getType()</code>) gives the letter 'U'. <code>payloadLength</code> is 4 for a tag containing the string \"def\".</p>\n"}, {"tags": ["c++", "regex", "c++11", "pattern-matching", "regex-group"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1548868901, "post_id": 54446021, "comment_id": 95701374, "body": "<a href=\"https://en.cppreference.com/w/cpp/regex/regex_search\" rel=\"nofollow noreferrer\">std::regex_search</a> instead of <a href=\"https://en.cppreference.com/w/cpp/regex/regex_match\" rel=\"nofollow noreferrer\">std::regex_match</a>."}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1548869369, "post_id": 54446021, "comment_id": 95701621, "body": "Now it returns only the first group, and no matter how many pairs I have in text, <code>matches.size()</code> is 3."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548870574, "post_id": 54446021, "comment_id": 95702212, "body": "Use <code>sregex_token_iterator</code>, I added the second link."}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548870966, "post_id": 54446021, "comment_id": 95702413, "body": "@WiktorStribi\u017cew I&#39;m still getting only the first group of results: <a href=\"https://wandbox.org/permlink/tsKVcCEK7ROSJCBO\" rel=\"nofollow noreferrer\">wandbox.org/permlink/tsKVcCEK7ROSJCBO</a>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548872306, "post_id": 54446021, "comment_id": 95703066, "body": "Try <code>const std::regex rx{ R&quot;(\\w+(?=[^{}=]*}))&quot; };</code>"}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "edited": false, "score": 0, "creation_date": 1548872551, "post_id": 54446021, "comment_id": 95703158, "body": "With that the application crashes..."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548873497, "post_id": 54446021, "comment_id": 95703631, "body": "Well, <a href=\"https://ideone.com/fzh120\" rel=\"nofollow noreferrer\">ideone.com/fzh120</a> does not. However, C++ regex implementations differ, and it may crash due to various reasons."}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "edited": false, "score": 0, "creation_date": 1548873855, "post_id": 54446021, "comment_id": 95703855, "body": "Fair. But I not only need the <code>data</code>s, I also need to separate them into groups, so that I know which data belongs to which group (and to save the connections among them). So what I need is more like my regexp. How should I modify mine to get that result?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548874287, "post_id": 54446021, "comment_id": 95704071, "body": "It is not possible with 1 regex pass. You need to get your groups first, something like with <code>\\{[^{}]*(?:\\{[^{}]*\\}[^{}]*)*\\}</code> (<a href=\"https://regex101.com/r/ZfAsTk/1\" rel=\"nofollow noreferrer\">demo</a>), and then use that other regex to get each separate value from the matches."}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "edited": false, "score": 0, "creation_date": 1548874748, "post_id": 54446021, "comment_id": 95704301, "body": "Yeah that&#39;s what I need actually. I found a shorter one: <code>std::regex rx{ R&quot;(\\{\\s*(\\S+)\\})&quot; }</code>. By the way, here I&#39;m not capturing <code>{</code> and <code>}</code> , why do the results have them?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548875337, "post_id": 54446021, "comment_id": 95704603, "body": "<code>\\S</code> matches both <code>{</code> and <code>}</code>."}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "edited": false, "score": 0, "creation_date": 1548875570, "post_id": 54446021, "comment_id": 95704724, "body": "I see. How can I capture only what&#39;s inside the curly braces? (not super important, I just wanna know)"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1548878475, "post_id": 54446021, "comment_id": 95706055, "body": "It is as easy as <code>\\{([^{}]*)\\}</code> - if there is no balanced nested braces. If you need recursion, you can only use something like I showed above: 1 or 2 levels deep are feasible, but it it become unwieldly with more depth levels."}, {"owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "edited": false, "score": 0, "creation_date": 1548917410, "post_id": 54446021, "comment_id": 95717785, "body": "That only captures the <code>data</code> parts, but not second part of the pair"}], "owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "closed_date": 1548868978, "answer_count": 0, "score": 0, "last_activity_date": 1548870525, "creation_date": 1548868489, "question_id": 54446021, "link": "https://stackoverflow.com/questions/54446021/regex-to-match-the-same-pattern-many-times", "closed_reason": "Duplicate", "title": "Regex to match the same pattern many times", "body": "<p>I have such text, which contains a list pair, and every pair contains a list of some data and the connection of that data to some other data:</p>\n\n<blockquote>\n  <p>{data={data1,data2},connection=data3}, {{data4},data5}, {{data6},data7}, ...</p>\n</blockquote>\n\n<p>I need to extract the data entry from each pair, i.e. I need <code>data1</code>, <code>data2</code>, <code>data3</code> etc.\nThis is the regexp I came up with:</p>\n\n<pre><code>(\\{(?:\\S*=)?\\{\\S+\\})(?:,(?:\\S*=)?\\}\\S+)?\n</code></pre>\n\n<p><a href=\"http://regex101.com\" rel=\"nofollow noreferrer\">regex101.com</a> matches the pattern to the text and separates the string into these groups:</p>\n\n<p><code>{data={data1,data2},connection=data3}</code>, <code>{{data4},data5}</code>, <code>{{data6},data7}</code> (for each of which I'll need to run another regexp). However, my C++ doesn't doesn't match the string:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;regex&gt;\n\nint main()\n{\n    std::string text{ \"{data={data1,data2},connection=data3}, {{data4},data5}, {{data6},data7}\" };\n\n    const std::regex rx{ R\"data((\\{\\S*\\{\\S+\\})(?:,(\\S*=)?\\}\\S+)?)data\" };\n    std::smatch matches;\n    if (std::regex_match(text, matches, rx))\n    {\n        std::cout &lt;&lt; matches.size() &lt;&lt; std::endl;\n    }\n\n    system(\"pause\");\n}\n</code></pre>\n\n<p>How should I do this in C++?</p>\n"}, {"tags": ["c++", "qt", "qt-creator", "qcombobox", "qlineedit"], "owner": {"reputation": 87, "user_id": 7481952, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f30cc05a464bf342defbeab273f47009?s=128&d=identicon&r=PG&f=1", "display_name": "Pramod", "link": "https://stackoverflow.com/users/7481952/pramod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1548871536, "creation_date": 1548868094, "last_edit_date": 1548871536, "question_id": 54445910, "link": "https://stackoverflow.com/questions/54445910/how-to-remove-inline-completion-for-qcompleter", "title": "How to remove inline completion for QCompleter?", "body": "<p>I'm trying to create a subclass for <code>QCombobox</code> and <code>QCompleter</code> to achieve the following:</p>\n\n<p>I want to make editable combobox which pops-up completion list when user starts typing.</p>\n\n<p>Ex: Completion List - <code>QStringList&lt;&lt;\"manual\"&lt;&lt;\"anual\"</code>\nWhen I type <code>'anu'</code>, I want both <code>\"manual\"</code> and <code>\"anual\"</code> to appear in the completion drop-down list, because they both contain <code>\"anu\"</code>.\nBut instead I'm getting only <code>**anu**al</code> with <code>al</code> as inline completion so in the completion list I got only <code>\"anual\"</code>.\nWhen I remove the inline suggestion with backspace then I'm getting full list as expected.</p>\n\n<p>Why is the default inline completion appearing?</p>\n\n<p><strong>linecompleter.h</strong></p>\n\n<pre><code>#ifndef LINECOMPLETER_H\n#define LINECOMPLETER_H\n\n#include &lt;QtGui&gt;\n#include &lt;QtWidgets&gt;\n\nclass QKeyEvent;\nclass LineCompleter : public QCompleter\n{\n    Q_OBJECT\n\npublic:\n    inline LineCompleter(const QStringList&amp; words, QObject * parent) :\n            QCompleter(parent), m_list(words), m_model()\n    {\n        setModel(&amp;m_model);\n    }\n\n    inline void update(QString word)\n    {\n        // Do any filtering you like.\n        // Here we just include all items that contain word.\n        QStringList filtered = m_list.filter(word, caseSensitivity());\n        m_model.setStringList(filtered);\n        m_word = word;\n        complete();\n    }\n\n    inline QString word()\n    {\n        return m_word;\n    }\n\nprivate:\n    QStringList m_list;\n    QStringListModel m_model;\n    QString m_word;\n};\n\nclass PageLineEdit : public QComboBox\n{\n    Q_OBJECT\n\npublic:\n    PageLineEdit(QWidget *parent = 0);\n    ~PageLineEdit();\n\n    void setCompleter(LineCompleter *c);\n    LineCompleter *completer() const;\n\nprotected:\n    void keyPressEvent(QKeyEvent *e);\n\nprivate slots:\n    void insertCompletion(const QString &amp;completion);\n\nprivate:\n    LineCompleter *c;\n};\n\n#endif // LINECOMPLETER_H\n</code></pre>\n\n<p><strong>linecompleter.cpp</strong></p>\n\n<pre><code>#include \"linecompleter.h\"\n\nPageLineEdit::PageLineEdit(QWidget *parent)\n    : QComboBox(parent), c(0)\n{\n}\n\nPageLineEdit::~PageLineEdit()\n{\n}\n\nvoid PageLineEdit::setCompleter(LineCompleter *completer)\n{\n    if (c)\n            QObject::disconnect(c, 0, this, 0);\n\n        c = completer;\n\n        if (!c)\n            return;\n\n        c-&gt;setWidget(this);\n        c-&gt;setCompletionMode(QCompleter::PopupCompletion);\n        c-&gt;setCaseSensitivity(Qt::CaseInsensitive);\n        QObject::connect(c, SIGNAL(activated(QString)),\n                         this, SLOT(insertCompletion(QString)));\n}\n\nLineCompleter *PageLineEdit::completer() const\n{\n    return c;\n}\n\nvoid PageLineEdit::insertCompletion(const QString&amp; completion)\n{\n    lineEdit()-&gt;setText(completion);\n    lineEdit()-&gt;selectAll();\n}\n\n\nvoid PageLineEdit::keyPressEvent(QKeyEvent *e)\n{\n    if (c &amp;&amp; c-&gt;popup()-&gt;isVisible())\n    {\n        // The following keys are forwarded by the completer to the widget\n        switch (e-&gt;key())\n        {\n        case Qt::Key_Enter:\n        case Qt::Key_Return:\n        case Qt::Key_Escape:\n        case Qt::Key_Tab:\n        case Qt::Key_Backtab:\n            e-&gt;ignore();\n            return; // Let the completer do default behavior\n        default:\n                   break;\n        }\n    }\n\n    bool isShortcut = (e-&gt;modifiers() &amp; Qt::ControlModifier) &amp;&amp; e-&gt;key() == Qt::Key_E;\n    if (!isShortcut)\n        QComboBox::keyPressEvent(e); // Don't send the shortcut (CTRL-E) to the text edit.\n\n    if (!c)\n        return;\n\n    bool ctrlOrShift = e-&gt;modifiers() &amp; (Qt::ControlModifier | Qt::ShiftModifier);\n    if (!isShortcut &amp;&amp; !ctrlOrShift &amp;&amp; e-&gt;modifiers() != Qt::NoModifier)\n    {\n        c-&gt;popup()-&gt;hide();\n        return;\n    }\n\n    c-&gt;update(lineEdit()-&gt;text());\n    c-&gt;popup()-&gt;setCurrentIndex(c-&gt;completionModel()-&gt;index(0, 0));\n\n}\n</code></pre>\n\n<p>I implemented this using <a href=\"https://www.qtcentre.org/threads/23518-How-to-change-completion-rule-of-QCompleter\" rel=\"nofollow noreferrer\">this Qt centre thread</a></p>\n\n<p>I'm using Qt 4.8 which doesn't have <code>setFilterMode()</code> for <code>QCompleter</code>.</p>\n\n<p>How can I subclass the <code>QCombobox</code> properly to achieve this required feature?</p>\n"}, {"tags": ["c++", "c++11", "gcc", "visual-c++", "language-lawyer"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1548869047, "post_id": 54445795, "comment_id": 95701450, "body": "Use conditional compilation."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1548869174, "post_id": 54445795, "comment_id": 95701508, "body": "@jxh that wouldn&#39;t answer the &quot;<i>who is right?</i>&quot; question I believe"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1548869267, "post_id": 54445795, "comment_id": 95701568, "body": "@rustyx: Need language lawyer tag then."}], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 0, "creation_date": 1548868307, "post_id": 54445928, "comment_id": 95701072, "body": "Unfortunately my project needs to support MSVC 2015."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 1, "creation_date": 1548868490, "post_id": 54445928, "comment_id": 95701178, "body": "Code built with VS 2015 can link with code built with VS 2017 as they are binary compatible, although you need to use the latest version of the CRT in VS 2017 to ensure everything links up. Otherwise you&#39;ll just need to modify your code."}, {"owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 0, "creation_date": 1548869246, "post_id": 54445928, "comment_id": 95701552, "body": "So this basically confirms that it is the MSVC 2015 implementation to be the incorrect one I guess..."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1548869519, "post_id": 54445928, "comment_id": 95701698, "body": "<a href=\"https://tio.run/##fZFNT8MwDIbv@RWWkCagYuOclVy4MAnBju0xas2IlKZR6kpUE7@95GuBw4QvcV7beZ8knbUPnZbmtK67HWxf4ENpZIxwsFoSQk2LRSMHhEawidzcEbzPhA7ODHw08AVPcP7es7i9MteKWMmzB2PKbIgWljx/UWLHBkaLTtLoqur2LhV9T7AJmIe3139Br2Moo5VBKFK8R90Izkt/NK9bsYmOvw0XnfO/XCzdo6qWROiQZmfgnj7V5GET6/PxmFlvlOn03HsqNfrnQDkI5qEIBqlMOS2ZernYhhzkPnvlZKKe826cCeoa5HYJS9TQ9Dr/RuZ59Czr@gM\" rel=\"nofollow noreferrer\">CLang</a> also accepts it, so that makes MSVC 2015 the odd man out."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1548869952, "post_id": 54445928, "comment_id": 95701890, "body": "<a href=\"https://tio.run/##fZHBSsQwEIbveYoBYVHL7nrO1ly87ILoHttjSEcNpNOSTsGy@Ow1SWMRXJxLJv/M5P@SmL7fGqfpfZ73e9gd4c06FIKx7Z1mhJKnHkm3CJUSA/vRMLyOjB4uAkJU8AmPcPk6iLS9MlerVMmzJ6J1NkYNU57/UVLHBroevebOF8Xt3VIMPdEmYp5env8FvY5hyVlCWKV0j7JSUibPslabZPRXl/I3jljwi2JawDzy6Anu@cMOgXFBfDqfM@KNJePGJsDYLrwC6laJwMLQakvraYtpkFfbmIM@ZK@cDNxIabqRoSxB76a4JA2pcfkTMs9DYJnnbw\" rel=\"nofollow noreferrer\">CLang</a> also complains about the missing <code>template</code> keyword before <code>Inner</code>."}, {"owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1548870319, "post_id": 54445928, "comment_id": 95702061, "body": "@jxh yes, CLang, apparently from version 5.0 on, wants both the <code>template</code> and the <code>typename</code> keywords. I am curious about which compiler is getting this thing right between the three."}], "tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": false, "score": 2, "last_activity_date": 1548868162, "creation_date": 1548868162, "answer_id": 54445928, "question_id": 54445795, "link": "https://stackoverflow.com/questions/54445795/could-not-make-this-code-cross-compile-between-msvc-2015-and-gcc-7-3/54445928#54445928", "title": "Could not make this code cross compile between MSVC 2015 and GCC 7.3", "body": "<p>VS 2017 (<a href=\"https://blogs.msdn.microsoft.com/chuckw/2018/11/15/vs-2017-15-9-update/\" rel=\"nofollow noreferrer\">15.9 update</a>) builds this code just fine. Upgrade to the latest version which is more C++11/C++14 compliant than VS 2015 Update 3.</p>\n\n<pre><code>cl /permissive- /W4 /EHsc t.cpp\n</code></pre>\n\n<blockquote>\n  <p>Check out the <a href=\"https://visualstudio.microsoft.com/vs/community/\" rel=\"nofollow noreferrer\">Community Edition</a> to see if the license meets your requirements.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1548891066, "post_id": 54450314, "comment_id": 95710773, "body": "Paraphrasing @rustyx, that doesn&#39;t answer the &quot;<i>who is right?</i>&quot; question I believe ;-)"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1548905595, "post_id": 54450314, "comment_id": 95714080, "body": "@jxh I agree. But there are two questions in one here, and I answered the first: making it cross compile between the two compilers. Maybe a new question should be asked"}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": true, "score": 4, "last_activity_date": 1548886086, "creation_date": 1548886086, "answer_id": 54450314, "question_id": 54445795, "link": "https://stackoverflow.com/questions/54445795/could-not-make-this-code-cross-compile-between-msvc-2015-and-gcc-7-3/54450314#54450314", "title": "Could not make this code cross compile between MSVC 2015 and GCC 7.3", "body": "<p>This seems to work for all compilers I have tested:</p>\n\n<pre><code>template &lt;typename X&gt;\ntemplate &lt;typename Y&gt;\ninline auto Outer&lt;X&gt;::Inner&lt;Y&gt;::operator++() \n    -&gt; Inner&lt;Y&gt; &amp;\n{\n    ++y;\n    return *this;\n}\n</code></pre>\n"}], "owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 54450314, "answer_count": 2, "score": 8, "last_activity_date": 1548886086, "creation_date": 1548867751, "last_edit_date": 1548876837, "question_id": 54445795, "link": "https://stackoverflow.com/questions/54445795/could-not-make-this-code-cross-compile-between-msvc-2015-and-gcc-7-3", "title": "Could not make this code cross compile between MSVC 2015 and GCC 7.3", "body": "<p>While I was writing code for my project I found a very weird situation in which my <strong>C++11</strong> code could not be cross compiled between <strong>GCC 7.3</strong> and <strong>MSVC 2015</strong>. The case is basically this one:</p>\n\n<pre><code>// .H file\n\ntemplate &lt;typename X&gt;\nstruct Outer {\n    X x = {};\n\n    template &lt;typename Y&gt;\n    struct Inner {\n        Y y = {};\n        Inner&amp; operator++();\n    };\n};\n\n// .INL file\n\ntemplate &lt;typename X&gt;\ntemplate &lt;typename Y&gt;\ninline Outer&lt;X&gt;::Inner&lt;Y&gt;&amp;\n    Outer&lt;X&gt;::Inner&lt;Y&gt;::operator++()\n{\n    ++y;\n    return *this;\n}\n\n// .CPP file\n\n#include &lt;iostream&gt;\n\nint main()\n{\n    Outer&lt;int&gt;::Inner&lt;int&gt; a;\n    ++a;\n    std::cout &lt;&lt; a.y &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>GCC will not complain about the above code. But MSVC will, and the error would be:</p>\n\n<pre><code>warning C4346: 'Inner': dependent name is not a type note: prefix with\n'typename' to indicate a type error C2061: syntax error: identifier\n'Inner' error C2143: syntax error: missing ';' before '{' error C2447:\n'{': missing function header (old-style formal list?)\n</code></pre>\n\n<p>As suggested by the MSVC compiler itself, writing the <code>typename</code> keyword on the return type will fix the issue:</p>\n\n<pre><code>template &lt;typename X&gt;\ntemplate &lt;typename Y&gt;\ninline typename Outer&lt;X&gt;::Inner&lt;Y&gt;&amp;\nOuter&lt;X&gt;::Inner&lt;Y&gt;::operator++()\n{\n    ++y;\n    return *this;\n} \n</code></pre>\n\n<p>But now, quite surprisingly, GCC will not compiler anymore, and its error is:</p>\n\n<pre><code>error: non-template 'Inner' used as template\n     inline typename Outer&lt;X&gt;::Inner&lt;Y&gt;&amp;\n                               ^~~~~ note: use 'Outer&lt;X&gt;::template Inner' to indicate that it is a template error: expected\nunqualified-id at end of input\n</code></pre>\n\n<p>Again, as suggested by the compiler itself, I tried to add the keyword <code>template</code> to the return type, and this will fix the issue for GCC:</p>\n\n<pre><code>template &lt;typename X&gt;\ntemplate &lt;typename Y&gt;\ninline typename Outer&lt;X&gt;::template Inner&lt;Y&gt;&amp;\nOuter&lt;X&gt;::Inner&lt;Y&gt;::operator++()\n{\n    ++y;\n    return *this;\n}\n</code></pre>\n\n<p>But this fix will now break once again the MSVC build, and the error from the compiler is:</p>\n\n<pre><code>error C2244: 'Outer&lt;X&gt;::Inner&lt;Y&gt;::operator ++': unable to match\nfunction definition to an existing declaration note: see declaration\nof 'Outer&lt;X&gt;::Inner&lt;Y&gt;::operator ++' note: definition note:\n'Outer&lt;X&gt;::Inner&lt;Y&gt; &amp;Outer&lt;X&gt;::Inner&lt;Y&gt;::operator ++(void)' note:\nexisting declarations note: 'Outer&lt;X&gt;::Inner&lt;Y&gt;\n&amp;Outer&lt;X&gt;::Inner&lt;Y&gt;::operator ++(void)'\n</code></pre>\n\n<p>This time around, I just stopped as the compiler error message is not helpful, as the reported mismatch between definition and declaration does not exist: the signatures given by the compiler itself are perfectly matching.</p>\n\n<p>At this point, not knowing any better solution, I decided to just define the function inside the Inner class scope in the .H file, and that would work for both GCC and MSVC. But some questions still remain: who is right? GCC or MSVC? Or is the C++ standard that in this case is too ambiguous?</p>\n"}, {"tags": ["c++", "sockets", "libuv"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548867775, "post_id": 54445779, "comment_id": 95700786, "body": "That sounds like an <code>AF_LOCAL</code> (also known as <code>AF_UNIX</code>) socket."}], "answers": [{"tags": [], "owner": {"reputation": 7838, "user_id": 383045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72da00bd74a5744f9cb89d1a52a6d447?s=128&d=identicon&r=PG", "display_name": "yzt", "link": "https://stackoverflow.com/users/383045/yzt"}, "is_accepted": true, "score": 1, "last_activity_date": 1548870704, "last_edit_date": 1548870704, "creation_date": 1548870310, "answer_id": 54446516, "question_id": 54445779, "link": "https://stackoverflow.com/questions/54445779/libuv-create-udp-stream-from-existing-socket/54446516#54446516", "title": "LibUV create UDP stream from existing socket", "body": "<p>Those sockets are called \"local domain\" sockets, and not UDP sockets. Fortunately, LibUV does support those (only on UNIX, obviously; although on Windows the same LibUV API use \"Named Pipes\" under the hood.)</p>\n\n<p>Anyways... In short, you have to use the <em>pipe</em> API (i.e. <code>uv_pipe_init</code> and <code>uv_pipe_bind()</code>/<code>uv_pipe_connect</code>,) instead of <code>uv_udp_*</code> functions.</p>\n\n<p>You can find the documentation for LibUV's pipe API <a href=\"https://docs.libuv.org/en/v1.x/pipe.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 939, "user_id": 4987662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce13879abfd99e45f7ab44188ae1a353?s=128&d=identicon&r=PG&f=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/4987662/acorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54446516, "answer_count": 1, "score": 0, "last_activity_date": 1548870704, "creation_date": 1548867696, "last_edit_date": 1548867903, "question_id": 54445779, "link": "https://stackoverflow.com/questions/54445779/libuv-create-udp-stream-from-existing-socket", "title": "LibUV create UDP stream from existing socket", "body": "<p>I know very little about how unix works, so please excuse my ignorance.</p>\n\n<p>I have a path to a socket on my linux box, <code>/data/sock/socket</code>. </p>\n\n<p>I want to send data to that socket with LibUV, but I am unsure how to go about that.</p>\n\n<p>I currently have it set up to create its own socket,</p>\n\n<pre><code>uv_udp_t m_socket;\nuv_udp_send_t m_send_req;\nsockaddr_in m_addr;\n\nuv_udp_init(uv_default_loop(), &amp;m_socket);\nuv_ip4_addr(\"0.0.0.0\", 8008, &amp;m_addr);\n\nchar buff[6] = \"Hello\\0\";\nauto buf = uv_buf_init(buff, 6);\nuv_udp_send(&amp;m_send_req, &amp;m_socket, &amp;buf, 1, (const struct sockaddr*)&amp;m_addr, NULL);\n</code></pre>\n\n<p>How can I use the socket I have on my filesystem, rather than using the one created through code? </p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548866994, "post_id": 54445549, "comment_id": 95700322, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please learn how to create a <a href=\"https://stackoverflow.com/help/mcve\"><b><i>Minimal</i></b>, Complete and Verifiable Example</a>."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1548867005, "post_id": 54445549, "comment_id": 95700328, "body": "Please reformat your code, post the error message and remove using namespace std in a header that doesn&#39;t even need it."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1548867030, "post_id": 54445549, "comment_id": 95700343, "body": "<code>It says I&#39;m doing something wrong with the time that I declared in the main function.</code> <i>What exactly</i> is it saying?"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1548867426, "post_id": 54445549, "comment_id": 95700590, "body": "My repect for being aware of the fact that your code is messy. Now please act on it and improve it. If you find it messy you can bet that the nitpicky people here are not fans of it either and that will not put them in a helpful mood. Some might even get really annoyed by &quot;I know my code is horrible to read. I do not bother fixing it however....&quot;"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1548867496, "post_id": 54445549, "comment_id": 95700631, "body": "There are plenty of free auto-formatters - including the one built into visual studio.  The number of excuses to not use it is limited."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548867660, "post_id": 54445549, "comment_id": 95700728, "body": "Your problem description and the code you shared don&#39;t match. <code>When I tried input time (0,0, &#39; &#39;) It showed more errors.</code> Your code shows the attempt to initialize it, but you&#39;re not sharing the &quot;more errors&quot; you got from the code you posted."}, {"owner": {"reputation": 11, "user_id": 10890523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F8BzOBQ4Zr0/AAAAAAAAAAI/AAAAAAAAALY/Lx245NFKS4g/photo.jpg?sz=128", "display_name": "Sushi", "link": "https://stackoverflow.com/users/10890523/sushi"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1548867839, "post_id": 54445549, "comment_id": 95700822, "body": "@yunnosch Its not that I dont want to bother fixing it but it&#39;s because I&#39;m a beginner and I have limited knowledge how to shorten my coding style. You can see that because I&#39;m using more of the basic loops and basic struct for the program."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1548868219, "post_id": 54445549, "comment_id": 95701016, "body": "Start with deleting ALL empty lines. Then reintroduce a few which really make the code look better. Then use some linebreaks to keep the code readable without horizontal scrolling. Your indentation seems actually quite OK. If you want my individual preferences (not general SO rule): Keep corresponding <code>{}</code> in the same colum. Newline before a <code>{</code>.  Keep  <code>} else</code> together. Then AFTERWARDS bother about mores subtle style issues like loops. Currently the code is ignored before that level..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548883973, "post_id": 54445549, "comment_id": 95708492, "body": "<code>input</code> does not have a constructor defined, so <code>input time(0,0,&#39;&#39;);</code> is not valid syntax for initializing an <code>input</code> variable. Use <code>input time{&#39;\\0&#39;,&#39;\\0&#39;,0,0};</code> or simply <code>input time{};</code> instead. Or leave it uninitialized (and ignore the warning) since <code>take()</code> will overwrite it anyway: <code>input time;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10890523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F8BzOBQ4Zr0/AAAAAAAAAAI/AAAAAAAAALY/Lx245NFKS4g/photo.jpg?sz=128", "display_name": "Sushi", "link": "https://stackoverflow.com/users/10890523/sushi"}, "edited": false, "score": 0, "creation_date": 1548870043, "post_id": 54446110, "comment_id": 95701940, "body": "Thank you so much!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548883787, "post_id": 54446110, "comment_id": 95708408, "body": "This answer doesn&#39;t really address WHY the errors were happening, only how to rewrite the code to avoid them."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 0, "last_activity_date": 1548868797, "creation_date": 1548868797, "answer_id": 54446110, "question_id": 54445549, "link": "https://stackoverflow.com/questions/54445549/how-should-i-initialize-the-time-in-the-main-function/54446110#54446110", "title": "How should I initialize the time in the main function?", "body": "<p>The problem is that you are passing an uninitalised variable to your <code>take</code> function, when really your <code>take</code> function should be <em>returning</em> a time value.</p>\n\n<p>Since the purpose of <code>take</code> is to let the user input a time value it should not have a time value as its parameter. All it needs to do is return the time value that the user entered.</p>\n\n<p>Like this</p>\n\n<pre><code>input take(); // no parameter\ninput convert(input);\nvoid give(input);\n\n...\n\nint main () {\n    char ans = 0;\n    ...\n\n    input time = take(); // no parameter\n\n    ...\n}\n\ninput take () { // no parameter\n\n    input time; // local variable for the users input\n\n    cout &lt;&lt; \"\\nPlease enter 12-hour format or 24-hour format (12-hour = a, 24-hour = p) \";\n\n    cin &gt;&gt; time.ampm;\n\n    ...\n\n    return time; // return the entered time value\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10890523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F8BzOBQ4Zr0/AAAAAAAAAAI/AAAAAAAAALY/Lx245NFKS4g/photo.jpg?sz=128", "display_name": "Sushi", "link": "https://stackoverflow.com/users/10890523/sushi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1548868844, "accepted_answer_id": 54446110, "answer_count": 1, "score": -4, "last_activity_date": 1548883530, "creation_date": 1548866898, "last_edit_date": 1548883530, "question_id": 54445549, "link": "https://stackoverflow.com/questions/54445549/how-should-i-initialize-the-time-in-the-main-function", "closed_reason": "Not suitable for this site", "title": "How should I initialize the time in the main function?", "body": "<p>This program should work in Visual Studio, but it's not working. It says I'm doing something wrong with the <code>time</code> variable that I declared in the <code>main</code> function.</p>\n\n<blockquote>\n  <p>source_file.cpp(59) : warning C4700: uninitialized local variable 'time' used</p>\n</blockquote>\n\n<p>I know I should initialize <code>time</code> but I have no idea how to do that.</p>\n\n<p>When I tried </p>\n\n<pre><code>input time (0,0, ' ')\n</code></pre>\n\n<p>It showed more errors.  </p>\n\n<blockquote>\n  <p>source_file.cpp(43): error C2440: 'initializing': cannot convert from 'initializer list' to 'input'</p>\n  \n  <p>source_file.cpp(43): note: No constructor could take the source type, or constructor overload resolution was ambiguous  </p>\n</blockquote>\n\n<p>Also, my coding style is messy so I'm sorry for that. It's not because I'm lazy but I'm a beginner and I love loops and conditional statements.    </p>\n\n<pre><code>struct input\n{\n    char ampm;\n    char dayNight;\n    int hour;\n    int minute;\n};\n\ninput take ( input );\ninput convert ( input );\nvoid give ( input );\n\nint main ()\n{\n    input time(0,0,'');\n    char ans = 0;\n    int count = 0;\n    int morea = 0, morep = 0;\n\n    do {\n        time = take ( time );\n        time = convert ( time );\n        give ( time );\n        ++count;\n\n        if ( time.ampm == 'a' ) {\n            ++morea;\n        }\n        else if ( time.ampm == 'p' ) {\n            ++morep;\n        }\n\n        cout &lt;&lt; \"Do you want to do it again? (y/n)\";\n        cin &gt;&gt; ans;\n\n    } while ( ans == 'y' || ans == 'Y' );\n\n    if ( ans != 'y' || ans != 'Y' ) {\n        cout &lt;&lt; \"\\n\\nYou did this program \" &lt;&lt; count &lt;&lt; \"times\\n\";\n    }\n\n    if ( morea &gt; morep ) {\n        cout &lt;&lt; \"You converted more AM time\";\n    }\n    else if ( morea &lt; morep ) {\n        cout &lt;&lt; \"You converted more PM time\";\n    }\n    else if ( morea == morep ) {\n        cout &lt;&lt; \"The conversion type was equal\";\n    }\n\n    return 0;\n\n} //int main\n\ninput take ( input time ) {    \n    cout &lt;&lt; \"\\nPlease enter 12-hour format or 24-hour format (12-hour = a, 24-hour = p) \";    \n    cin &gt;&gt; time.ampm;    \n\n    if ( time.ampm == 'a' ) {    \n        cout &lt;&lt; \"Please enter day or night (day = x, night = y) \";    \n        cin &gt;&gt; time.dayNight;    \n    }    \n\n    cout &lt;&lt; \"Please enter the hour   \";    \n    cin &gt;&gt; time.hour;\n\n    cout &lt;&lt; \"Please enter the minute \";    \n    cin &gt;&gt; time.minute;\n\n    return time;    \n}    \n\ninput convert ( input time ) {  \n    if ( time.ampm == 'p' ) { \n        if ( time.hour &gt;= 13 &amp;&amp; time.hour &lt; 24 ) {    \n            time.hour = time.hour - 12;    \n        } \n        else if ( time.hour == 24 || time.hour == 00 ) {    \n            time.hour = 12;    \n        }      \n    } \n    else if ( time.ampm == 'a' ) {\n        if ( time.hour == 12 &amp;&amp; time.dayNight == 'y' ) {    \n            time.hour = 00;    \n        }\n\n        if ( time.hour == 24 &amp;&amp; time.dayNight == 'y' ) {    \n            time.hour = 00;    \n        }\n        else if ( time.hour &gt;= 1 &amp;&amp; time.hour &lt; 12 ) {    \n            time.hour = time.hour + 12;    \n        }\n        else if ( time.hour == 12 &amp;&amp; time.dayNight == 'x' ) {    \n            time.hour = 12;\n        }\n    }\n\n    return time;   \n}    \n\nvoid give ( input time ) {\n    if ( time.ampm == 'a' ) {    \n        cout &lt;&lt; \"The new time in 24-hour format is \" &lt;&lt; time.hour &lt;&lt; \":\" &lt;&lt; time.minute &lt;&lt; endl;    \n    }    \n    else {    \n        cout &lt;&lt; \"The new time in 12-hour format is \" &lt;&lt; time.hour &lt;&lt; \":\" &lt;&lt; time.minute &lt;&lt; endl;\n    }    \n}\n</code></pre>\n"}, {"tags": ["c++", "templates"], "answers": [{"comments": [{"owner": {"reputation": 3788, "user_id": 7112888, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-P-jq3DoZPqI/AAAAAAAAAAI/AAAAAAAAS3Y/jpjvZZxoVQY/photo.jpg?sz=128", "display_name": "zoecarver", "link": "https://stackoverflow.com/users/7112888/zoecarver"}, "edited": false, "score": 0, "creation_date": 1548867241, "post_id": 54445535, "comment_id": 95700477, "body": "I tried that and it works but it is not exactly what I was looking for. If it is not possible to have something like this <code>alloc_arr&lt;int[]&gt;(64)</code> how come there are functions like this in the standard library <code>std::make_unique&lt;int[]&gt;(64)</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 3788, "user_id": 7112888, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-P-jq3DoZPqI/AAAAAAAAAAI/AAAAAAAAS3Y/jpjvZZxoVQY/photo.jpg?sz=128", "display_name": "zoecarver", "link": "https://stackoverflow.com/users/7112888/zoecarver"}, "edited": false, "score": 2, "creation_date": 1548867341, "post_id": 54445535, "comment_id": 95700540, "body": "@zoecarver Because <code>std::make_unique&lt;int[]&gt;(64)</code> basically does <code>return std::unique_ptr(new int[64]);</code>  The value isn&#39;t actually part of the template type."}], "tags": [], "owner": {"reputation": 420, "user_id": 6569689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb150b5f78aeda0371f727993367025?s=128&d=identicon&r=PG&f=1", "display_name": "Lourens Dijkstra", "link": "https://stackoverflow.com/users/6569689/lourens-dijkstra"}, "is_accepted": false, "score": 1, "last_activity_date": 1548866846, "creation_date": 1548866846, "answer_id": 54445535, "question_id": 54445481, "link": "https://stackoverflow.com/questions/54445481/template-array-length-as-argument/54445535#54445535", "title": "Template array length as argument", "body": "<p>You could pass the size as a <code>template parameter</code>:</p>\n\n<pre><code>template &lt;class T, size_t size&gt;\nvoid alloc_arr() { ... }\n</code></pre>\n\n<p>This is the only way. A couple of days ago I found out that passing a <code>constexpr lambda</code> as a regular parameter is considered ill-formed: <a href=\"https://stackoverflow.com/questions/54353463/trying-to-pass-a-constexpr-lambda-and-use-it-to-explicitly-specify-returning-typ\">Trying to pass a constexpr lambda and use it to explicitly specify returning type</a></p>\n\n<p>Also, note that type T should be <code>int</code>; not <code>int[]</code>.</p>\n\n<p>So, calling alloc_arr:</p>\n\n<pre><code>alloc_arr&lt;int, 64&gt;();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3788, "user_id": 7112888, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-P-jq3DoZPqI/AAAAAAAAAAI/AAAAAAAAS3Y/jpjvZZxoVQY/photo.jpg?sz=128", "display_name": "zoecarver", "link": "https://stackoverflow.com/users/7112888/zoecarver"}, "edited": false, "score": 0, "creation_date": 1548867426, "post_id": 54445657, "comment_id": 95700589, "body": "Perfect! This is exactly what I was looking for. Thank you for all the details."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 5, "last_activity_date": 1548867297, "creation_date": 1548867297, "answer_id": 54445657, "question_id": 54445481, "link": "https://stackoverflow.com/questions/54445481/template-array-length-as-argument/54445657#54445657", "title": "Template array length as argument", "body": "<blockquote>\n  <p>Is there some other way to do this which doesn't require the length to be specified in the type ()?</p>\n</blockquote>\n\n<p>In some way, you need to pass it as template parameter</p>\n\n<p>You can pass it explicitly, as suggested by Lourens Dijkstra</p>\n\n<pre><code>template &lt;typename T, std::size_t Dim&gt;\nvoid alloc_arr ()\n {\n   std::allocator&lt;T[Dim]&gt; a;\n   // ...  \n }\n</code></pre>\n\n<p>or, if you can use at least C++11, also you can deduce it from the type of an argument; by example,</p>\n\n<pre><code>template &lt;typename T, std::size_t Dim&gt;\nvoid alloc_arr (std::integral_constant&lt;std::size_t, Dim&gt; const &amp;)\n {\n   std::allocator&lt;T[Dim]&gt; a;\n   // ...  \n }\n</code></pre>\n\n<p>or also</p>\n\n<pre><code>template &lt;typename T, typename U&gt;\nvoid alloc_arr (U const &amp;)\n {\n   std::allocator&lt;T[U::value]&gt; a;\n   // ...  \n }\n</code></pre>\n\n<p>calling <code>alloc_arr</code> with a <code>std::integral_constant&lt;std::size_t, 5u&gt;{}</code>, by example.</p>\n"}], "owner": {"reputation": 3788, "user_id": 7112888, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-P-jq3DoZPqI/AAAAAAAAAAI/AAAAAAAAS3Y/jpjvZZxoVQY/photo.jpg?sz=128", "display_name": "zoecarver", "link": "https://stackoverflow.com/users/7112888/zoecarver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 54445657, "answer_count": 2, "score": 0, "last_activity_date": 1548867297, "creation_date": 1548866688, "question_id": 54445481, "link": "https://stackoverflow.com/questions/54445481/template-array-length-as-argument", "title": "Template array length as argument", "body": "<p>I am trying to learn more about templates in C++. I would like to be able to call a function where I pass it a type and the length as <em>an argument</em>. Is this possible?</p>\n\n<pre><code>template &lt;class T&gt;\nvoid alloc_arr (int l) {\n    std::allocator&lt;T[l]&gt; a;\n}\n\nalloc_arr&lt;int[]&gt;(64);\n</code></pre>\n\n<p>It doesn't work because the instantiated type must be fixed at compile time (<code>T[l]</code> is not fixed). </p>\n\n<p>Is there some other way to do this which doesn't require the length to be specified in the type (<code>&lt;T[64]&gt;</code>)?</p>\n"}, {"tags": ["c++", "vector", "memcpy"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1548866869, "post_id": 54445480, "comment_id": 95700254, "body": "I would double check the documentation, vector has a method called resize"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 2, "creation_date": 1548867053, "post_id": 54445480, "comment_id": 95700357, "body": "<i>it is a slow operation</i> How slow?  Did you measure it?"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1548867076, "post_id": 54445480, "comment_id": 95700374, "body": "Get a better compiler. A good one should be using memcpy already. It should also be able to remove whatever code resize includes to initialize the elements, that is killed by memcpy."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548867174, "post_id": 54445480, "comment_id": 95700431, "body": "It&#39;s not possible to <i>only</i> change the size. Anything that would increase it&#39;s size will also at least initialize the extra elements in some way. Maybe an implementation could skip that part for trivially constructible types but it&#39;s not guaranteed. Complexity is only guarnteed to be at worst linear (excluding reallocation costs)."}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1548867452, "post_id": 54445480, "comment_id": 95700608, "body": "@PaulSanders I tested it. Resize takes 30%-60% more time than my memcpy. Making the whole operation 2-3 times slower."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1548867482, "post_id": 54445480, "comment_id": 95700627, "body": "Compiler already uses <code>memcpy</code> if you do it right... <a href=\"https://godbolt.org/z/7Bp4BF\" rel=\"nofollow noreferrer\">godbolt.org/z/7Bp4BF</a>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548867510, "post_id": 54445480, "comment_id": 95700641, "body": "@Aleksey Re the slowdown: Supply an allocator that doesn&#39;t value-initialize the contents."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 2, "creation_date": 1548867715, "post_id": 54445480, "comment_id": 95700752, "body": "Psychic debugging: <code>my_struct</code> isn&#39;t a trivial type, so any use of <code>memcpy</code> is UB, and the compiler is trying to save OP from themselves."}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548868009, "post_id": 54445480, "comment_id": 95700905, "body": "@BaummitAugen Thank you for the advice. Can you please provide me some reference on this? I am not a programmer myself. Cheers."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548868097, "post_id": 54445480, "comment_id": 95700946, "body": "@Aleksey In the light of your other comments, you can probably scratch that remark, that only makes sense when your type is trivial (which I assumed because otherwise you can&#39;t <code>memcpy</code> is either)."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1548868217, "post_id": 54445480, "comment_id": 95701014, "body": "@Aleksey So was the vector already large enough for the destination string?  Maybe it is &#39;downsizing&#39; which would involve freeing and re-allocation its internal buffer.  Not much you can do in that case, seems."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1548868874, "post_id": 54445480, "comment_id": 95701360, "body": "@PaulSanders a vector is not allowed to reallocate if resize is less than previous size."}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548868907, "post_id": 54445480, "comment_id": 95701379, "body": "So, I had a second look at my struct and I can give up some things to make it trivially copyable. How can I create a proper allocator for it, so that resize does not value-initialize elements?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548869173, "post_id": 54445480, "comment_id": 95701507, "body": "<a href=\"https://stackoverflow.com/a/41049640/3002139\">stackoverflow.com/a/41049640/3002139</a> Something like is also in boost if you are using that."}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548869278, "post_id": 54445480, "comment_id": 95701577, "body": "@BaummitAugen Thank you."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1548869330, "post_id": 54445480, "comment_id": 95701601, "body": "But you should probably just use the range constructor or the range inserter as demonstrated in my link and the answers anyway. Note the lack of <code>memset</code> of similar in the generated assembly on godbolt."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1548870586, "post_id": 54445480, "comment_id": 95702219, "body": "On my Linux 64, with &quot;std::vector&lt;T&gt; vecT;&quot;,  a sizeof(vecT) reports 24 bytes, regardless of size of T, regardless of number of elements in vecT.   When  vecT has 1000 elements,  sizeof(vecT)  reports 24 bytes, while vecT.size() reports 1000 (elements).  Since 24 bytes can not contain 1000 T, you can infer that std::vector must contain pointers and counters, etc, i.e. vecT by itself, regardless of contents, is not trivially copyable."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548866912, "post_id": 54445525, "comment_id": 95700276, "body": "I appreciate the promptness of your reply. However, I specifically mentioned that resize is not tolerable for me in terms of latency."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 1, "creation_date": 1548867028, "post_id": 54445525, "comment_id": 95700342, "body": "@Aleksey It&#39;s still required. Anything that would change the <code>size</code> will (one way or another) initialize the added elements."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1548867087, "post_id": 54445525, "comment_id": 95700380, "body": "&quot;<i>You generally do not need to call reserve(). &quot;</i> This is not true. <code>reserve</code> is useful when you know how many elements you will insert while still using <code>push_back</code>, <code>emplace_back</code> or otherwise adding elements one at a time, notably with <code>std::back_inserter</code>."}, {"owner": {"reputation": 4485, "user_id": 2205033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d36e28c13c9214b2281af2d12916b?s=128&d=identicon&r=PG", "display_name": "Johannes Overmann", "link": "https://stackoverflow.com/users/2205033/johannes-overmann"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548867547, "post_id": 54445525, "comment_id": 95700663, "body": "@Francois: Yes, it can be useful in special situations. However, in your examples it is not necessary to call <code>reserve()</code>beforehand since <code>vector</code> uses exponential growth. So adding elements, one at a time, still has linear complexity."}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548867815, "post_id": 54445525, "comment_id": 95700812, "body": "It is possible that resize looks slow because of the of my constructor. I had to create it in order to emplace my structs into the vector. What are the criteria for a constructor to be called trivial?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548868015, "post_id": 54445525, "comment_id": 95700910, "body": "@Aleksey what are the data members of <code>my_struct</code>? If they are all fundamental types, or arrays thereof, then the generated constructors are trivial"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548868451, "post_id": 54445525, "comment_id": 95701155, "body": "@Aleksey <a href=\"https://stackoverflow.com/questions/4178175/what-are-aggregates-and-pods-and-how-why-are-they-special/\" title=\"what are aggregates and pods and how why are they special\">stackoverflow.com/questions/4178175/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548871549, "post_id": 54445525, "comment_id": 95702706, "body": "@JohannesOvermann Amortized linear complexity, which is not the same thing. Reserving has a big impact if you save even one reallocation. If you reserve enough, <code>push_back</code> goes straight to constant complexity."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548872407, "post_id": 54445525, "comment_id": 95703096, "body": "For relatively simple types the time to realloc and move all the elements will dominate the time for actually emplacing new values and incrementing the size even if it&#39;s amortized constant."}, {"owner": {"reputation": 4485, "user_id": 2205033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d36e28c13c9214b2281af2d12916b?s=128&d=identicon&r=PG", "display_name": "Johannes Overmann", "link": "https://stackoverflow.com/users/2205033/johannes-overmann"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548920427, "post_id": 54445525, "comment_id": 95719106, "body": "@Francois: Nope. <code>resize()</code> usually does not re-allocate and copy at all, on average. Nor does appending a single element. This is the key point. The vector allocates ahead exponentially, so the re-allocations will get rarer and rarer until they are no longer measurable, even when appending single elements."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548945114, "post_id": 54445525, "comment_id": 95733628, "body": "@JohannesOvermann Well first, <code>resize()</code> is different from a series of individual of insertions at the back. From the context I&#39;ll assume that&#39;s what you mean. Second, no reallocation on average is not the same as at most one reallocation. If you reserve, you put a hard cap on the overhead at 1 allocation and <code>N</code> moves (where <code>N</code> is the previous size). If the series of <code>push_back</code> without <code>reserve</code> would have not had any such overhead <code>reserve</code> doesn&#39;t either. There&#39;s no down side (when you know the final size ahead of time) and you clamp the overhead to the minimum possible."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548946177, "post_id": 54445525, "comment_id": 95734302, "body": "@JohannesOvermann The problem may be over relying on <code>O</code> notation. Not all complexities of the same order are created equal. If it helps, you can think of using <code>reserve</code> as passing from an <code>O(N)</code> algorithm to another <code>O(N)</code> algorithm where the cost of each operation is less than or equal to the previous algorithm&#39;s. They might both converge to linear time, but one converges faster than the other."}, {"owner": {"reputation": 4485, "user_id": 2205033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d36e28c13c9214b2281af2d12916b?s=128&d=identicon&r=PG", "display_name": "Johannes Overmann", "link": "https://stackoverflow.com/users/2205033/johannes-overmann"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548976495, "post_id": 54445525, "comment_id": 95749052, "body": "@Francois: When you really know the exact size in advance there is no point in using <code>vector</code>. Then you could rather use <code>std::array</code> and have less overhead and clearer semantics. I stay with it: There is, except for very exotic cases, no use case for <code>reserve()</code>. And yes, you can use <code>reserve()</code> to avoid the first couple of re-allocations. And you can use <code>reserver()</code> to make sure pointers to data do not get corrupted. But I consider both use cases <i>exotic</i>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1549035340, "post_id": 54445525, "comment_id": 95772101, "body": "@JohannesOvermann The size you will need can both be unknown at compile time and known before starting your insertions. It&#39;s not an unusual case. Immediately, data reception comes to mind. It seems you can only imagine scenarios where <code>std::vector</code> receives elements continuously. Furthermore, iterator and pointer preservation is <i>far</i> from an &quot;exotic&quot; case. It seems our past experiences are just too different to agree. Bottom line though, if you can know the total number of insertions you will perform, there is no reason not to <code>reserve</code>, and this is <b>not</b> as rare as you make it seem."}], "tags": [], "owner": {"reputation": 4485, "user_id": 2205033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d36e28c13c9214b2281af2d12916b?s=128&d=identicon&r=PG", "display_name": "Johannes Overmann", "link": "https://stackoverflow.com/users/2205033/johannes-overmann"}, "is_accepted": false, "score": 3, "last_activity_date": 1548921288, "last_edit_date": 1548921288, "creation_date": 1548866819, "answer_id": 54445525, "question_id": 54445480, "link": "https://stackoverflow.com/questions/54445480/how-to-manually-assign-vectors-size/54445525#54445525", "title": "How to manually assign vector&#39;s size?", "body": "<ol>\n<li><p>You <em>must</em> to actually <code>resize()</code> the vector before you copy stuff to it using <code>memcpy()</code>:</p>\n\n<p><code>destination_vector.resize(container_length);</code></p>\n\n<p>But it would be better to avoid the use of <code>memcpy()</code> in the first place and use the mechanisms to copy <code>vector</code> content which is offered by <code>vector</code>, as suggested in the other answers:</p>\n\n<p><code>std::vector&lt;my_struct&gt; destination_vector(original_vector);</code></p>\n\n<p>or if the <code>destination_vector</code> instance already exists:</p>\n\n<p><code>destination_vector.insert(destination_vector.begin(), original_vector.begin(), original_vector.end);</code></p>\n\n<p>or, the fastest if you do not need the original content any more:</p>\n\n<p><code>destination_vector.swap(original_vector);</code></p>\n\n<p>All of these variants will be as fast or even faster than your <code>memcpy()</code>variant. If you experience slowness then see 2.:</p></li>\n<li><p>You probably have a non-trivial default constructor in <code>my_struct</code>. Remove it, or insert a trivial (empty) default constructor to speed things up (to avoid construction of many elements which you never use).</p></li>\n<li><p>If <code>my_struct</code>contains non-POD data members (like <code>std::string</code>) you cannot use <code>memcpy()</code> at all.</p></li>\n</ol>\n\n<p>(Side note: You rarely want to call <code>reserve()</code>. The <code>vector</code> maintains its own internal storage in such a way that is always allocates more than is actually needed, exponentially, to avoid frequent resizes/copying when frequently appending elements.)</p>\n\n<p><code>resize()</code> is not a slow operation. It is as fast as any memory allocation. </p>\n\n<p>Does <code>my_struct</code> have a non-trivial default constructor? Remove it and take care of initialization manually. This might be the reason why you say <code>resize()</code> is slow. It will actually construct your objects. But since you can apparently <code>memcpy()</code> your objects you can probably get away with a trivial (empty) default constructor.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548868499, "post_id": 54445605, "comment_id": 95701182, "body": "Apparently my struct is not trivially copyable. This would explain why there&#39;s such a big difference between memcpy and regular copy. Thank you."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 2, "last_activity_date": 1548867496, "last_edit_date": 1548867496, "creation_date": 1548867138, "answer_id": 54445605, "question_id": 54445480, "link": "https://stackoverflow.com/questions/54445480/how-to-manually-assign-vectors-size/54445605#54445605", "title": "How to manually assign vector&#39;s size?", "body": "<p>Your snippet has undefined behaviour, you can't <code>memcpy</code> into an empty vector, even if you have <code>reserved</code> space. It may also be undefined behaviour to <code>memcpy</code> <em>any</em> <code>my_struct</code> objects, if it isn't a <a href=\"https://en.cppreference.com/w/cpp/named_req/TriviallyCopyable\" rel=\"nofollow noreferrer\">TriviallyCopyable</a> type.</p>\n\n<p>You can construct the vector as a copy of the source directly. <em>Most likely</em> your compiler will emit code identical (or faster) than your original snippet, if <code>my_struct</code> is TriviallyCopyable.</p>\n\n<pre><code>std::vector&lt;my_struct&gt; destination_vector(original_vector.begin(), original_vector.begin() + container_length);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1548867909, "post_id": 54445655, "comment_id": 95700853, "body": "Nitpick: this assumes that <code>container_length == original_vector.size()</code>. I <i>hope</i> it is the case, this is nicer than my variation."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1548868248, "post_id": 54445655, "comment_id": 95701033, "body": "@Caleth good point. This is answer to how to copy a vector / container. If <code>container_length</code> has some special meaning other than <code>original_vector.size()</code>, then this example has different behaviour."}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548868581, "post_id": 54445655, "comment_id": 95701230, "body": "container_length is indeed equal to original_vector.size()"}, {"owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "edited": false, "score": 0, "creation_date": 1548869407, "post_id": 54445655, "comment_id": 95701639, "body": "I have to say that this answer provides the fastest approach out of all suggestions. Still not what I need though. But I appreciate all the help. Apparently, I will need to educate myself further."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1548867720, "last_edit_date": 1548867720, "creation_date": 1548867293, "answer_id": 54445655, "question_id": 54445480, "link": "https://stackoverflow.com/questions/54445480/how-to-manually-assign-vectors-size/54445655#54445655", "title": "How to manually assign vector&#39;s size?", "body": "<blockquote>\n  <p>How to manually assign vector's size?</p>\n</blockquote>\n\n<p>You can't. You can only modify vector's size through the modification functions that add or remove elements such as insert, clear, resize etc.</p>\n\n<blockquote>\n  <p>After the code above I need to tell my destination_vector what size it is. How do I do this?</p>\n</blockquote>\n\n<p>The mentioned code above has undefined behaviour, so it doesn't matter what you do after it.</p>\n\n<p>A simple and efficient way to copy a vector is:</p>\n\n<pre><code>std::vector&lt;my_struct&gt; destination_vector(original_vector);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5296649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604ed93895b3b6ef73b1cc442e2982af?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/5296649/aleksey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54445655, "answer_count": 3, "score": 2, "last_activity_date": 1548921288, "creation_date": 1548866683, "question_id": 54445480, "link": "https://stackoverflow.com/questions/54445480/how-to-manually-assign-vectors-size", "title": "How to manually assign vector&#39;s size?", "body": "<p>In my application there's a part that requires me to make a copy of a container. At the moment I use std::vector (but might consider using something else). The application is very sensitive with regard to the latency. So, I was looking for a way to make a copy of a vector as fast as possible. I found that memcpy does it better than anything else. However, it does not change the internal size of the vector. I.e. vector.size() would still give me 0. </p>\n\n<p>I know what slippery path I am on. I do not mind throwing away safety checks. I do know how many elements are being copied. I do not want to use vector.resize() to change the size of the destination vector (it is a slow operation). </p>\n\n<p>Question:</p>\n\n<pre><code>std::vector&lt;my_struct&gt; destination_vector;\ndestination_vector.reserve(container_length);\nstd::memcpy(destination_vector.data(), original_vector.data(), sizeof(my_struct)*container_length);\n</code></pre>\n\n<p>After the code above I need to tell my destination_vector what size it is. How do I do this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1548866170, "post_id": 54445277, "comment_id": 95699817, "body": "<code>a</code> is a copy of <code>s</code>. <code>rez</code> <i>is</i> <code>s</code>. It&#39;s not clear to me what you aren&#39;t sure about."}], "answers": [{"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 6, "last_activity_date": 1548866459, "creation_date": 1548866459, "answer_id": 54445408, "question_id": 54445277, "link": "https://stackoverflow.com/questions/54445277/what-happens-to-a-parameter-if-it-is-passed-twice-once-by-value-and-once-by-ref/54445408#54445408", "title": "What happens to a parameter if it is passed twice? Once by value and once by reference? Will it be modified or not?", "body": "<p>The fact that <code>a</code> is a copy of <code>s</code> is actually a red herring. Maybe that caused your confusion, but its just a copy. Consider that you could call the function like this</p>\n\n<pre><code>auto temp = s;\neval(temp,nr,s);\n</code></pre>\n\n<p>to get the exact same result. Inside the function <code>rez</code> is a reference to <code>s</code>, hence modifications on it will be reflected on <code>s</code> in <code>main</code>. In other words, <code>rez</code> is an alias for <code>s</code>, while <code>a</code> has no relation whatsoever to <code>s</code>, they just happen to hold the same value.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 9619597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d11fb251364eb7f8106d5d2ad9755f5?s=128&d=identicon&r=PG&f=1", "display_name": "Indetronable", "link": "https://stackoverflow.com/users/9619597/indetronable"}, "is_accepted": false, "score": 1, "last_activity_date": 1548871099, "last_edit_date": 1548871099, "creation_date": 1548866491, "answer_id": 54445423, "question_id": 54445277, "link": "https://stackoverflow.com/questions/54445277/what-happens-to-a-parameter-if-it-is-passed-twice-once-by-value-and-once-by-ref/54445423#54445423", "title": "What happens to a parameter if it is passed twice? Once by value and once by reference? Will it be modified or not?", "body": "<p>IMO, this is what I would expect :</p>\n\n<ol>\n<li>Copy <code>s</code> to a new var <code>l_S</code>.</li>\n<li>Copy <code>nr</code> to a new var <code>l_Nr</code>.</li>\n<li>Copy <code>&amp;s</code> to new var <code>l_Ptr</code>.</li>\n<li>Add <code>l_Nr</code> and <code>l_S</code>.</li>\n<li>Save the result in <code>*l_Ptr</code>.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 10990579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fee335887c26ad351abd611f99cbfd2?s=128&d=identicon&r=PG&f=1", "display_name": "Narice", "link": "https://stackoverflow.com/users/10990579/narice"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548867175, "post_id": 54445485, "comment_id": 95700433, "body": "But reference is closely related to pointer and OP should have a grasp of pointers to fully understand reference and the backstage of it"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1548872632, "post_id": 54445485, "comment_id": 95703197, "body": "tbh I completely disagree, but I understand that your point of view is completly valid ;)"}], "tags": [], "owner": {"reputation": 111, "user_id": 10990579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fee335887c26ad351abd611f99cbfd2?s=128&d=identicon&r=PG&f=1", "display_name": "Narice", "link": "https://stackoverflow.com/users/10990579/narice"}, "is_accepted": false, "score": 3, "last_activity_date": 1548867989, "last_edit_date": 1548867989, "creation_date": 1548866691, "answer_id": 54445485, "question_id": 54445277, "link": "https://stackoverflow.com/questions/54445277/what-happens-to-a-parameter-if-it-is-passed-twice-once-by-value-and-once-by-ref/54445485#54445485", "title": "What happens to a parameter if it is passed twice? Once by value and once by reference? Will it be modified or not?", "body": "<p>This question is related to the behavior of functions parameters and reference/pointers.<br>\nWhen you pass a value to a function, it copies the value you give to a local variable inside the function.<br>\nin your case, when you pass 's', it copies it to 'a' like if you would do it in your main: int a = s (this is what is going on)<br>\nThe same applies to the reference. when you pass 's' to the third parameter, it does this:<br>\nint &amp;rez = s<br>\nWhen you pass it by reference, it is sort of taking the address of the variable instead of the value itself and copying this address to a local variable that is already dereferenced. (pointer stuff)<br>\nSo the value is changed.<br>\nSee the video related to pointers and then reference on 'the Cherno Project' youtube channel for better comprehension of the subject:<br>\n<a href=\"https://www.youtube.com/watch?v=p4sDgQ-jao4\" rel=\"nofollow noreferrer\">Pointers</a><br>\n<a href=\"https://www.youtube.com/watch?v=IzoFn3dfsPA\" rel=\"nofollow noreferrer\">References</a></p>\n"}, {"tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": false, "score": 2, "last_activity_date": 1548867069, "last_edit_date": 1548867069, "creation_date": 1548866763, "answer_id": 54445508, "question_id": 54445277, "link": "https://stackoverflow.com/questions/54445277/what-happens-to-a-parameter-if-it-is-passed-twice-once-by-value-and-once-by-ref/54445508#54445508", "title": "What happens to a parameter if it is passed twice? Once by value and once by reference? Will it be modified or not?", "body": "<p>Short answer: Yes, <code>s</code> will be changed.</p>\n\n<p>Long answer: Let me rewrite your code snippet a little bit to illustrate what is happening with the function parameters during a call:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\nusing namespace std;\nifstream fin(\"BAC.TXT\");\nvoid eval(int a, int b, int &amp;rez)\n{\n    rez = a + b;\n}\nint main()\n{\n    int nr;\n    int s;\n    fin &gt;&gt; s;\n    while(fin &gt;&gt; nr) {\n        int a = s;\n        int b = nr;\n        s = a + b;\n    }\n    cout &lt;&lt; s &lt;&lt; '\\n';\n    return 0;\n}\n</code></pre>\n\n<p>So, basically, <code>a</code> and <code>b</code> are just copies of <code>s</code> and <code>nr</code> respectively. However, <code>res</code> <strong>is</strong> <code>s</code>.</p>\n"}], "owner": {"reputation": 143, "user_id": 10632656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc67bf2c094730760fcef5ca15d429b4?s=128&d=identicon&r=PG&f=1", "display_name": "M.Ionut", "link": "https://stackoverflow.com/users/10632656/m-ionut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1548885013, "creation_date": 1548866020, "last_edit_date": 1548866447, "question_id": 54445277, "link": "https://stackoverflow.com/questions/54445277/what-happens-to-a-parameter-if-it-is-passed-twice-once-by-value-and-once-by-ref", "title": "What happens to a parameter if it is passed twice? Once by value and once by reference? Will it be modified or not?", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\nusing namespace std;\nifstream fin(\"BAC.TXT\");\nvoid eval(int a, int b, int &amp;rez)\n{\n    rez = a + b;\n}\nint main()\n{\n    int nr;\n    int s;\n    fin &gt;&gt; s;\n    while (fin &gt;&gt; nr)\n        eval(s, nr, s);\n    cout &lt;&lt; s &lt;&lt; '\\n';\n    return 0;\n}\n</code></pre>\n\n<p>So I have this code snippet. I am reading numbers from a file and keeping track of their sum using a given function called \u201ceval\u201d. I know it could be considered bad code to pass a parameter twice (in such a given instance) rather than using another variable (not sure, though, if it is bad code or not, in my case). My problem is: will it change the value of variable <code>s</code>? Again, I am passing it once by value and once by reference! I have written the code on my PC and it <em>does</em> change the value of <code>s</code>. Now my question would be: why? If I am asking this in a right way: what happens \u201cin the background\u201d?</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1548865981, "post_id": 54445222, "comment_id": 95699682, "body": "You have + operator btw <code>const char *</code> and <code>int</code>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1548866005, "post_id": 54445222, "comment_id": 95699701, "body": "There&#39;s no <code>string</code> in your example. <code>&quot;Test&quot;</code> is a <code>const char [5]</code>, not a <code>string</code>. The rest is just &quot;pointer arithmetic&quot;. Inherited directly from C."}], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 6, "last_activity_date": 1548865995, "creation_date": 1548865995, "answer_id": 54445263, "question_id": 54445222, "link": "https://stackoverflow.com/questions/54445222/why-does-operator-between-string-and-int-acts-as-substr/54445263#54445263", "title": "Why does + operator between string and int acts as substr", "body": "<p>You are not using <code>string</code>+ <code>int</code>, you are doing <code>const char*</code> + <code>int</code>, that's pointer arithmetics.</p>\n\n<p>That's a pointer to <code>\"Test\"</code>, you increment it by 3, which means the pointer points to the substring <code>\"t\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1548866646, "post_id": 54445412, "comment_id": 95700136, "body": "Or simply ` &quot;Test&quot; &lt;&lt; 3 `?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1548866773, "post_id": 54445412, "comment_id": 95700206, "body": "@JVApen not quite - &quot;solution&quot; I provided would not compile (as expected by OP), your is a fix which is different case."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548873963, "post_id": 54445412, "comment_id": 95703916, "body": "@Slava <code>std::string + int</code> <a href=\"https://www.ideone.com/XEeCZh\" rel=\"nofollow noreferrer\">doesn&#39;t work</a>. You simply cannot append an <code>int</code> to a <code>string</code> as there is no <code>operator+</code> for that purpose."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548876628, "post_id": 54445412, "comment_id": 95705213, "body": "@RemyLebeau did I say otherwise? I even said that in my comment above. OP was expecting compilation error and was surprised that it compiles. I explained how to get compilation error OP wants."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 3, "last_activity_date": 1548866465, "creation_date": 1548866465, "answer_id": 54445412, "question_id": 54445222, "link": "https://stackoverflow.com/questions/54445222/why-does-operator-between-string-and-int-acts-as-substr/54445412#54445412", "title": "Why does + operator between string and int acts as substr", "body": "<p>As already answered you have pointer arithmetic due to using <a href=\"https://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">string literal</a></p>\n\n<p>To see what happens when you use <code>std::string</code> you need to either cast explicitly:</p>\n\n<pre><code>std::cout &lt;&lt; std::string(\"Test\") + 3 &lt;&lt; std::endl;   \n</code></pre>\n\n<p>or if you have C++14 or later to use <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator%22%22s\" rel=\"nofollow noreferrer\">operator \"\"s</a></p>\n\n<pre><code>using namespace std::string_literals;\nstd::cout &lt;&lt; \"Test\"s + 3 &lt;&lt; std::endl;   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1548874804, "creation_date": 1548874804, "answer_id": 54447742, "question_id": 54445222, "link": "https://stackoverflow.com/questions/54445222/why-does-operator-between-string-and-int-acts-as-substr/54447742#54447742", "title": "Why does + operator between string and int acts as substr", "body": "<p><code>operator+</code> has a <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">higher precedence</a> than <code>operator&lt;&lt;</code>, so this statement:</p>\n\n<pre><code>std::cout &lt;&lt; \"Test\" + 3 &lt;&lt; std::endl;\n</code></pre>\n\n<p>Get treated by the compiler as if you had written this instead:</p>\n\n<pre><code>std::cout &lt;&lt; (\"Test\" + 3) &lt;&lt; std::endl;\n</code></pre>\n\n<p><code>\"Test\"</code> is a <a href=\"https://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">string literal</a> of type <code>const char[5]</code>, which will <em>decay</em> into a pointer to the <code>T</code> character. So, adding <code>+3</code> to <code>\"Test\"</code> performs <a href=\"https://en.cppreference.com/w/c/language/operator_arithmetic#Pointer_arithmetic\" rel=\"nofollow noreferrer\">pointer arithmetic</a>, thus a <code>const char*</code> pointer that is pointing at the <code>t</code> character gets passed to <code>operator&lt;&lt;</code>, as if you had written code like this instead:</p>\n\n<pre><code>const char *ptr = \"Test\";\nptr = ptr + 3;\nstd::cout &lt;&lt; ptr &lt;&lt; std::endl;\n</code></pre>\n\n<p>Changing <code>\"Test\"</code> to a <code>std::string</code> won't work by default, either:</p>\n\n<pre><code>std::cout &lt;&lt; std::string(\"Test\") + 3 &lt;&lt; std::endl;\n</code></pre>\n\n<p>Because there is no standard <code>operator+</code> that allows an <code>int</code> to be added to a <code>std::string</code> (you would have to define your custom operator if you want that).</p>\n\n<p>So, to fix this, you have two choices:</p>\n\n<ol>\n<li><p>Convert the <code>int</code> to a <code>std::string</code>:</p>\n\n<pre><code>std::cout &lt;&lt; \"Test\" + std::to_string(3) &lt;&lt; std::endl;\n</code></pre></li>\n<li><p>use <code>operator&lt;&lt;</code> instead of <code>operator+</code>:</p>\n\n<pre><code>std::cout &lt;&lt; \"Test\" &lt;&lt; 3 &lt;&lt; std::endl;\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 48, "user_id": 9994136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ef116801c7b4a302632cf6492a9ea2?s=128&d=identicon&r=PG&f=1", "display_name": "Burnian", "link": "https://stackoverflow.com/users/9994136/burnian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 54445263, "answer_count": 3, "score": 3, "last_activity_date": 1548874804, "creation_date": 1548865882, "last_edit_date": 1548866179, "question_id": 54445222, "link": "https://stackoverflow.com/questions/54445222/why-does-operator-between-string-and-int-acts-as-substr", "title": "Why does + operator between string and int acts as substr", "body": "<p>When trying to concatenate a <code>string</code> with an <code>int</code> (without using the <code>std::to_string</code>, just to see what happens), I saw that there was no compilation error but the actual result is quite strange.</p>\n\n<p>I tried to search on cplusplus.com how the <code>+</code> operator is defined for <code>string</code>, but I couldn't find any definition of this operator between <code>string</code> and <code>int</code>.</p>\n\n<p>The code used to test the concatenation is the following :</p>\n\n<pre><code>std::cout &lt;&lt; \"Test\" + 3 &lt;&lt; std::endl;\n</code></pre>\n\n<p>I was expecting a compilation error, but I simply got a <code>t</code> in the console, which surprised me a bit.</p>\n\n<p>Why does this operator acts this way, and where is it defined?</p>\n\n<p>Thank you for your answers.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 6, "creation_date": 1548866109, "post_id": 54445220, "comment_id": 95699770, "body": "Address <a href=\"https://godbolt.org/z/khOKOi\" rel=\"nofollow noreferrer\">the warning</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1548866314, "post_id": 54445220, "comment_id": 95699917, "body": "<code>area</code> falls out of scope the instant that function returns, so returning a pointer to it is to return an invalid pointer. Turn on <code>-Wall</code> when compiling."}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1548866375, "creation_date": 1548866375, "answer_id": 54445384, "question_id": 54445220, "link": "https://stackoverflow.com/questions/54445220/c-code-block-ok-but-still-get-not-compile/54445384#54445384", "title": "c++ code block ok but still get not compile", "body": "<p>You are returning the address of a local function variable in your function <code>area</code>. When the function returns, its stack space is no longer valid, so attempting to access an address to a local variable from that function is undefined behavior. </p>\n\n<p>I don't see why you need to make <code>area</code> return a pointer to an int. Just return <code>area</code>'s value and have <code>area</code>'s return type just be <code>int</code> instead.</p>\n\n<p>If for some reason you are required to return a pointer to an <code>int</code> (i.e. assignment or deliverable specifications), you have some options:</p>\n\n<ol>\n<li><p>Use heap memory. Allocate <code>area</code> with <code>malloc</code>, and <code>free</code> it in <code>main</code> after you've printed its value.</p></li>\n<li><p>Use <code>static</code> to put <code>area</code> into the process' data section rather than in stack memory, so that it persists beyond its scope and an address-of operation on it will continue to work after the function returns.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10456568"}, "is_accepted": false, "score": 1, "last_activity_date": 1548866834, "creation_date": 1548866834, "answer_id": 54445534, "question_id": 54445220, "link": "https://stackoverflow.com/questions/54445220/c-code-block-ok-but-still-get-not-compile/54445534#54445534", "title": "c++ code block ok but still get not compile", "body": "<p>You can't just return pointer to stack variable, as it's getting invalidated as the function returns. You can use dynamic memory allocation instead:</p>\n\n<pre><code>int* area(int leangth,int width){\n    int * area = malloc(sizeof(int));\n    *area = leangth*width;\n    return area;\n}\n\nint main() {\n    printf(\"area=%i\\n\",*area(5,6));\n}\n</code></pre>\n\n<p>Please note that you create memory leak and it would be better to handle it some way, but in this tiny example it doesn't matter.</p>\n"}], "owner": {"reputation": 997, "user_id": 9357484, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/x0wQp.png?s=128&g=1", "display_name": "Encipher", "link": "https://stackoverflow.com/users/9357484/encipher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548872646, "creation_date": 1548865879, "last_edit_date": 1548872646, "question_id": 54445220, "link": "https://stackoverflow.com/questions/54445220/c-code-block-ok-but-still-get-not-compile", "title": "c++ code block ok but still get not compile", "body": "<pre><code>int* areaofsquare(int len,int width){\n    int value = len*width;\n    return &amp;value;\n}\n\nint main() {\n    printf(\"area=%i\\n\",*areaofsquare(1,2));\n    return 0;\n\n}\n</code></pre>\n\n<p>Why I get memory error from this code? As per my understanding I did not get any error in this code block so why does it not run properly?</p>\n\n<p>Help me out.<br>\nThank you.</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1548865521, "post_id": 54445057, "comment_id": 95699379, "body": "Have you tried libcxx instead? Maybe just a bug in the implementation?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1548865592, "post_id": 54445057, "comment_id": 95699434, "body": "Works with gcc 8.2 and clang 7."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548865815, "post_id": 54445057, "comment_id": 95699562, "body": "Also <a href=\"https://godbolt.org/z/8KQ2p-\" rel=\"nofollow noreferrer\">works</a> in clang 6.0 and <code>-stdlib=libc++</code>, and <a href=\"https://godbolt.org/z/7NZ_2S\" rel=\"nofollow noreferrer\">also</a> with <code>-stdlib=libstdc++</code>. No idea which library versions are used there though."}, {"owner": {"reputation": 726, "user_id": 3660396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c464bc5490b115601e19e48a5d68e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Otto", "link": "https://stackoverflow.com/users/3660396/martijn-otto"}, "edited": false, "score": 0, "creation_date": 1548866165, "post_id": 54445057, "comment_id": 95699810, "body": "Well, interestingly enough, install libc++-dev and compiling with that didn&#39;t help, but it might be a very old version in the repo (3.5.2). It seems it only breaks when enabling c++17 though, in c++14 mode it works. It must be that my version of libstdc++ is not updated yet for the fact that in c++17 noexcept is part of the type system."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548866188, "post_id": 54445057, "comment_id": 95699826, "body": "Well, according to the <code>-v</code> output, the only available library version is 7.3 (regardless of the <code>-stdlib</code> option): <a href=\"https://godbolt.org/z/k3PQjs\" rel=\"nofollow noreferrer\">godbolt.org/z/k3PQjs</a>"}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1548866216, "post_id": 54445057, "comment_id": 95699846, "body": "And also VS2017 (15.9.6) with the latest compiler installed and standard set to latest."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1548866366, "post_id": 54445057, "comment_id": 95699950, "body": "<code>noexcept</code> became part of the function <i>type</i> in C++17, I&#39;m guessing that clang 6 implemented that language change but libstdc++ 6.3 had not yet."}, {"owner": {"reputation": 726, "user_id": 3660396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c464bc5490b115601e19e48a5d68e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Otto", "link": "https://stackoverflow.com/users/3660396/martijn-otto"}, "edited": false, "score": 0, "creation_date": 1548876180, "post_id": 54445057, "comment_id": 95705014, "body": "Well, it works in gcc 6.3, in c++17 mode, perhaps gcc hasn&#39;t updated for c++17 noexcept types and that&#39;s why it works. Either way, it&#39;s a bug, and my money&#39;s on gcc&#39;s c++ libraries."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1548911237, "post_id": 54445057, "comment_id": 95715530, "body": "I think this is a related bug: <a href=\"https://bugs.llvm.org/show_bug.cgi?id=39008\" rel=\"nofollow noreferrer\">Function pointer conversion with noexcept fails</a>"}, {"owner": {"reputation": 726, "user_id": 3660396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c464bc5490b115601e19e48a5d68e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Otto", "link": "https://stackoverflow.com/users/3660396/martijn-otto"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1548924732, "post_id": 54445057, "comment_id": 95721334, "body": "@P.W I think this is not even related, it&#39;s the same bug. It&#39;s why it works in gcc - because they have the same function type for noexcept (which is wrong), while clang does it correctly and then chokes on the broken libstdc++."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1548925031, "post_id": 54445057, "comment_id": 95721489, "body": "@MartijnOtto: There is no discussion on the bug report confirming that it is a bug. Should we wait for such confirmation before answering this question?"}, {"owner": {"reputation": 726, "user_id": 3660396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c464bc5490b115601e19e48a5d68e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Otto", "link": "https://stackoverflow.com/users/3660396/martijn-otto"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1549023080, "post_id": 54445057, "comment_id": 95765338, "body": "@P.W Isn&#39;t what clang does in that bugreport actually the correct way? With noexcept part of the type system those functions have a different signature, so you would <i>expect</i> the assignment to fail. The bug is that gcc allows it."}], "answers": [{"comments": [{"owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 0, "creation_date": 1569526392, "post_id": 55394233, "comment_id": 102635764, "body": "My money is on compiler bug. Had it been the lib, a linker error would&#39;ve jumped out of the box. &#39;static_assert&#39; triggers compile time error which takes place before the linker is invoked."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 0, "creation_date": 1569550351, "post_id": 55394233, "comment_id": 102641508, "body": "@Red.Wave: The library becomes involved upon <code>#include</code>, not just via <code>ld</code>."}, {"owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "reply_to_user": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1570308840, "post_id": 55394233, "comment_id": 102874640, "body": "@DavisHerring r u sure? those names(&quot;libXXX...&quot;) just remind me of &quot;.so&quot; files(dynamic libs). the &quot;#include&quot; directive happens to be a pre-processor thing that takes place at early compile phase; way before link time when those libxxx things show up."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 0, "creation_date": 1570310620, "post_id": 55394233, "comment_id": 102875041, "body": "@Red.Wave: Very.  Do you think that <code>&lt;type_traits&gt;</code> is <b>not</b> part of the library?"}, {"owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "reply_to_user": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1571092515, "post_id": 55394233, "comment_id": 103117593, "body": "@DavisHerring not the binary part. Is &quot;libc++&quot; not the binary part? Compiler switch might mark the corresponding header path too. but does it? If it does, then I shall step back."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 0, "creation_date": 1571094958, "post_id": 55394233, "comment_id": 103118166, "body": "@Red.Wave: <code>libc++</code> is the name for the whole standard library implementation, including the headers as well as (what eventually becomes) <code>libc++.so</code>.  I don\u2019t know what compiler <i>switch</i> you mean."}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 1, "last_activity_date": 1569528310, "last_edit_date": 1569528310, "creation_date": 1553765567, "answer_id": 55394233, "question_id": 54445057, "link": "https://stackoverflow.com/questions/54445057/stdis-member-function-pointer-not-working-for-noexcept-member-functions/55394233#55394233", "title": "std::is_member_function_pointer not working for noexcept member functions", "body": "<p>Your code <a href=\"https://godbolt.org/z/-Hy1VZ\" rel=\"nofollow noreferrer\">compiles on GodBolt</a> - with and without <code>noexcept</code> on the member - with all of MSVC 2017, GCC 5.5, 6.x, 8.x , clang 5, 6, 7.</p>\n\n<p>On my Debian Stretch (well, the corresponding <a href=\"http://devuan.org/\" rel=\"nofollow noreferrer\">Devuan</a> really) - I can reproduce the issue. Interestingly, compilation fails even if I switch to libc++.</p>\n\n<p>So:</p>\n\n<ul>\n<li>This is not a bug in clang-6 in-and-of-itself</li>\n<li>This is not a libstdc++ 6.3.0 bug in-and-of-itself</li>\n<li>It might have something to do with the way things were configured/set up for Debian Stretch. I suggest bringing this up on the #debian channel on irc.freenode.net </li>\n</ul>\n"}], "owner": {"reputation": 726, "user_id": 3660396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c464bc5490b115601e19e48a5d68e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Otto", "link": "https://stackoverflow.com/users/3660396/martijn-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 10, "last_activity_date": 1569528310, "creation_date": 1548865353, "last_edit_date": 1548866175, "question_id": 54445057, "link": "https://stackoverflow.com/questions/54445057/stdis-member-function-pointer-not-working-for-noexcept-member-functions", "title": "std::is_member_function_pointer not working for noexcept member functions", "body": "<p>I am having trouble with <code>std::is_member_function_pointer</code>. As far as I can tell, it's not working when given a <code>noexcept</code> member function. I cannot find anything in the standard declaring that it does not work for <code>noexcept</code> qualified member functions. Example of the problem:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\nclass A {\npublic:\n    void member() noexcept { }\n};\n\nint main()\n{\n    // fails at compile time if A::member is a data member and not a function\n    static_assert(std::is_member_function_pointer&lt;decltype(&amp;A::member)&gt;::value,\n                  \"A::member is not a member function.\"); \n}\n</code></pre>\n\n<p>It gives me the following error:</p>\n\n<blockquote>\n  <p>member.cpp:11:5: error: static_assert failed due to requirement\n        'std::is_member_function_pointer::value' \"A::member is not a member function.\"\n      static_assert(std::is_member_function_pointer::value,\n      ^             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 1 error\n  generated.</p>\n</blockquote>\n\n<p>If I remove the <code>noexcept</code> qualification it compiles as it should.</p>\n\n<p>This has been tested on Debian Stretch, using clang 6.0 and libstdc++ 6.3.0\nAm I missing something here? From what I can read, this <em>should</em> work.</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1548864524, "post_id": 54444751, "comment_id": 95698724, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/936687/how-do-i-declare-a-2d-array-in-c-using-new\">How do I declare a 2d array in C++ using new?</a>. I would recommend either using <code>std::array&lt;std::array&lt;Chunk, 15&gt;, 25&gt;</code> or following your own suggestion of a 15*25 1D array."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1548864751, "post_id": 54444751, "comment_id": 95698874, "body": "You could use <a href=\"https://en.cppreference.com/w/cpp/container/vector/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>, <code>std::vector&lt;std::vector&lt;Chunk&gt;&gt; chunks(15, std::vector&lt;Chunk&gt;(25));</code>"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1548864978, "post_id": 54444751, "comment_id": 95699012, "body": "<code>Chunk[][] chunks;</code> is not legal C++, all but the first dimension must be specified using a compile time constant. Use a vector (1D) or a vector of vectors (2D) anything but a 2D array."}, {"owner": {"reputation": 420, "user_id": 6569689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb150b5f78aeda0371f727993367025?s=128&d=identicon&r=PG&f=1", "display_name": "Lourens Dijkstra", "link": "https://stackoverflow.com/users/6569689/lourens-dijkstra"}, "edited": false, "score": 0, "creation_date": 1548865178, "post_id": 54444751, "comment_id": 95699138, "body": "<code>chunks = new Chunk[a][b]</code> is hard to achieve. The size of an array is constant, and should be defined at compile-time (though, GCC does have an expansion that allows a <code>const int</code> to determine the size). Reading this PNG image, or files in general, cannot occur at compile-time. Therefore, you should use other containers, such as <code>std::vector&lt;T&gt;</code>, where the size does not have to be predetermined."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1548866931, "post_id": 54444751, "comment_id": 95700288, "body": "Neither of those duplicates are correct, the problem calls for a contiguous block of memory with dynamic dimensions."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1548867116, "post_id": 54444751, "comment_id": 95700399, "body": "You can use this technique, basically a single dimension array with a two dimensional accessing scheme: <a href=\"https://stackoverflow.com/questions/52436723/sorting-2-d-array-in-c-using-inbuilt-stdsort-function/52436916#52436916\" title=\"sorting 2 d array in c using inbuilt stdsort function\">stackoverflow.com/questions/52436723/&hellip;</a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1548867213, "post_id": 54444751, "comment_id": 95700461, "body": "Another example of the technique: <a href=\"https://stackoverflow.com/a/53038618/3807729\">stackoverflow.com/a/53038618/3807729</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1548865171, "creation_date": 1548865171, "answer_id": 54444993, "question_id": 54444751, "link": "https://stackoverflow.com/questions/54444751/c-two-dimensional-arrays/54444993#54444993", "title": "C++ Two Dimensional Arrays", "body": "<p>C++ does not support variable-length arrays like C does. Modern, idiomatic C++ also discourages raw arrays over <code>std::vector</code> or <code>std::array</code>, which can also be used in 2D, like so:</p>\n\n<pre><code>std::size_t x = /* get X dimension */\nstd::size_t y = /* get Y dimension */\nstd::vector&lt;std::vector&lt;Chunk&gt;&gt; chunks(x, std::vector&lt;Chunk&gt;(y));\n</code></pre>\n\n<p><code>std::vector</code> also has the advantage of automatic size management and permissibility of a variable-length initializer, unlike <code>std::array</code>, which, to my knowledge, only permits constants during initialization.</p>\n"}], "owner": {"reputation": 1, "user_id": 10991334, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qSWATI46n9M/AAAAAAAAAAI/AAAAAAAAAHM/ma1i4Qcl2qk/photo.jpg?sz=128", "display_name": "Ethan", "link": "https://stackoverflow.com/users/10991334/ethan"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 512, "favorite_count": 0, "closed_date": 1548865243, "answer_count": 1, "score": 0, "last_activity_date": 1548865171, "creation_date": 1548864417, "last_edit_date": 1548864601, "question_id": 54444751, "link": "https://stackoverflow.com/questions/54444751/c-two-dimensional-arrays", "closed_reason": "Duplicate", "title": "C++ Two Dimensional Arrays", "body": "<p>I am trying make make a basic chunk loading system using two dimensional arrays, and PNG images. I was just wondering if it is possible to create a uninitialized array for example; </p>\n\n<pre><code>Chunk[][] chunks;\n</code></pre>\n\n<p>and then initialize it based on the size of the PNG image and use different rgb pixels to stand for different tiles.</p>\n\n<p>Say the immage is 15x25, is it possible to initialize the two dimensional array with a somewhat like this?</p>\n\n<pre><code>chunks = new Chunk[15][25];\n</code></pre>\n\n<p>Or should I go about making a large array and just having the index's that aren't set be a VOID tile I could just simply make.</p>\n\n<p>Thank you everybody for your help!</p>\n"}, {"tags": ["c++", "mfc", "scrollbar", "zooming"], "answers": [{"comments": [{"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549090624, "post_id": 54488799, "comment_id": 95787499, "body": "Thanks for answer, but I have already try to enable ScrollBars using EnableScrollBars and in reading my explanation, you can see that ScrollBars are enabled since they appears when form size are reduced. I have already try to fix (zoom) haight and width on parent window. I will investigate SetScrollInfo() that is a new path for me."}, {"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549090630, "post_id": 54488799, "comment_id": 95787501, "body": "I see that you are a new user. I have a little remark. Your answer mut not be posted as answer but as comment because it is a proposal and not a solution. I have make the same mistake when I began on StackOverflow because I think it is a forum :-)"}, {"owner": {"reputation": 31, "user_id": 1614629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a0360d99e2c4954a2bcad810686f42?s=128&d=identicon&r=PG", "display_name": "Damir Valiulin", "link": "https://stackoverflow.com/users/1614629/damir-valiulin"}, "reply_to_user": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549385274, "post_id": 54488799, "comment_id": 95879690, "body": "Thanks for this advice. I didn&#39;t know there was a profound difference between the two. Also, I was unable to post a comment like this on another thread where I wanted to comment that a different answer (than the accepted one) actually what helped me."}, {"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549388781, "post_id": 54488799, "comment_id": 95881630, "body": "sorry, I have forgotten that new users don&#39;t have the possibility to write comment ! <a href=\"https://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead\" title=\"why do i need 50 reputation to comment what can i do instead\">meta.stackexchange.com/questions/214173/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 1614629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a0360d99e2c4954a2bcad810686f42?s=128&d=identicon&r=PG", "display_name": "Damir Valiulin", "link": "https://stackoverflow.com/users/1614629/damir-valiulin"}, "reply_to_user": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549401145, "post_id": 54488799, "comment_id": 95887285, "body": "Yes, I really disagree with this system, but it&#39;s off topic."}], "tags": [], "owner": {"reputation": 31, "user_id": 1614629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a0360d99e2c4954a2bcad810686f42?s=128&d=identicon&r=PG", "display_name": "Damir Valiulin", "link": "https://stackoverflow.com/users/1614629/damir-valiulin"}, "is_accepted": false, "score": 0, "last_activity_date": 1549067153, "creation_date": 1549067153, "answer_id": 54488799, "question_id": 54444723, "link": "https://stackoverflow.com/questions/54444723/how-to-change-dynamically-cformview-width-or-height-in-mdi-mfc-c-windows-appli/54488799#54488799", "title": "How to change dynamically CFormView WIDTH or HEIGHT in MDI MFC C++ windows application?", "body": "<p>Maybe you manually need to call <code>EnableScrollBars</code> for each scroll bar after determining whether it is needed.</p>\n\n<p>You would probably need to call <code>SetScrollInfo</code> then to setup total size.</p>\n\n<p>Both calls need to be done on the parent window of the <code>CFormView</code> which should be <code>CChildFrame</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549882179, "post_id": 54604076, "comment_id": 96049983, "body": "I have tried to implement your solution but when I overload OnCreate() and put your code, OnCreate() event function is never called. In my case, the CDialog is linked to a document and is created using OnInitialUpdate()."}, {"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549882286, "post_id": 54604076, "comment_id": 96050061, "body": "For information, I have added last added code in my source in my Question so that code is correctly formatted."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549898389, "post_id": 54604076, "comment_id": 96059569, "body": "I said <code>Create</code>, not <code>OnCreate</code>. Overriding <code>Create</code> may depend on MFC version. Which version of Visual Studio are you using? If it&#39;s a newer version I can post the code."}, {"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549906065, "post_id": 54604076, "comment_id": 96064083, "body": "I&#39;m using Visual Studio 2017."}, {"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1549956002, "post_id": 54604076, "comment_id": 96080589, "body": "Thanks for your help. This is very good job because even on MSDN I don&#39;t find any help on this question. Just for information, I have changed your answer to reflect my experiment because OnCreate declaration is absolutely necessary."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 0, "creation_date": 1550003505, "post_id": 54604076, "comment_id": 96107860, "body": "If <code>OnCreate</code> is required, then it must be declared and defined. You must have made a mistake when adding/removing different functions, or maybe you change the message map. Try removing <code>OnCreate</code> declaration again. Or you can leave it as is, it doesn&#39;t do anything."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 1, "last_activity_date": 1549964567, "last_edit_date": 1549964567, "creation_date": 1549696377, "answer_id": 54604076, "question_id": 54444723, "link": "https://stackoverflow.com/questions/54444723/how-to-change-dynamically-cformview-width-or-height-in-mdi-mfc-c-windows-appli/54604076#54604076", "title": "How to change dynamically CFormView WIDTH or HEIGHT in MDI MFC C++ windows application?", "body": "<p>Call <code>SetScrollSizes</code> to show the scrollbars at specific sizes:</p>\n\n<pre><code>CRect rect;\nGetClientRect(rect);\n\n//this multiplication is to make sure the scrollbar is visible\n//remove it in actual code.\nrect.right *= 2;\nrect.bottom *= 2;\n\nSetScrollSizes(MM_TEXT, rect.Size());\n</code></pre>\n\n<p>But this is not the right method in general. </p>\n\n<p>Option 1: </p>\n\n<p>You can just go to resource editor, select the dialog, select dialog's properties, and change the dialog's default font size. Increase the font size to 9 or higher, this will automatically make the dialog and its controls bigger, as well as using larger font.</p>\n\n<p>Option 2: </p>\n\n<p>In dialog's properties, you will also see a section called \"Dynamic Layout\". This lets you zoom the controls on resize, or move them up/down and left/right.</p>\n\n<p>Option 3:</p>\n\n<p>Change the font in dialog template during run time. To do so, you must override <code>CFormView::Create</code>, which in turn calls <code>CreateDlg</code>. These function names have to be declared exactly as below.</p>\n\n<p>Note that the font in dialog template can be changed only once, before the dialog is load.</p>\n\n<p>Example for Visual Studio 2017 (this code may not be compatible with older MFC versions)</p>\n\n<pre><code>BOOL XFormView::CreateDlg(LPCTSTR lpszTemplateName, CWnd* pParentWnd)\n{\n    CDialogTemplate dlt;\n    if(dlt.Load(lpszTemplateName)))\n    {\n        // set your own font\n        dlt.SetFont(L\"Arial\", 20);\n\n        HINSTANCE hInst = AfxFindResourceHandle(lpszTemplateName, RT_DIALOG);\n\n        LPCDLGTEMPLATE dlgtemplate = (LPCDLGTEMPLATE)GlobalLock(dlt.m_hTemplate);\n\n        // create a modeless dialog\n        BOOL bSuccess = CreateDlgIndirect(dlgtemplate, pParentWnd, hInst);\n\n        GlobalUnlock(dlt.m_hTemplate);\n        return bSuccess;\n    }\n\n    return CFormView::CreateDlg(lpszTemplateName, pParentWnd);\n}\n\nBOOL XFormView::Create\n    ( LPCTSTR lpszClassName\n    , LPCTSTR lpszWindowName\n    , DWORD dwRequestedStyle\n    , const RECT&amp; rect\n    , CWnd* pParentWnd\n    , UINT nID\n    , CCreateContext* pContext\n    );\n{\n    ASSERT(pParentWnd != NULL);\n    ASSERT(m_lpszTemplateName != NULL);\n\n    m_pCreateContext = pContext;    // save state for later OnCreate\n\n    // call PreCreateWindow to get prefered extended style\n    CREATESTRUCT cs; \n    memset(&amp;cs, 0, sizeof(CREATESTRUCT));\n    if(dwRequestedStyle == 0)\n        dwRequestedStyle = AFX_WS_DEFAULT_VIEW;\n    cs.style = dwRequestedStyle;\n    if(!PreCreateWindow(cs))\n        return FALSE;\n\n    // create a modeless dialog\n    if(!CreateDlg(m_lpszTemplateName, pParentWnd))\n        return FALSE;\n\n    m_pCreateContext = NULL;\n\n    ModifyStyle(WS_BORDER | WS_CAPTION, cs.style &amp; (WS_BORDER | WS_CAPTION));\n    ModifyStyleEx(WS_EX_CLIENTEDGE, cs.dwExStyle &amp; WS_EX_CLIENTEDGE);\n\n    SetDlgCtrlID(nID);\n\n    CRect rectTemplate;\n    GetWindowRect(rectTemplate);\n    SetScrollSizes(MM_TEXT, rectTemplate.Size());\n\n    // initialize controls etc\n    if(!ExecuteDlgInit(m_lpszTemplateName))\n        return FALSE;\n\n    // force the size requested\n    SetWindowPos(NULL, rect.left, rect.top,\n        rect.right - rect.left, rect.bottom - rect.top,\n        SWP_NOZORDER | SWP_NOACTIVATE);\n\n    // make visible if requested\n    if(dwRequestedStyle &amp; WS_VISIBLE)\n        ShowWindow(SW_NORMAL);\n\n    return TRUE;\n}\n</code></pre>\n\n<p>and class definition in XFormView.h MUST contains following lines</p>\n\n<pre><code>protected:\n\n    BOOL Create\n        ( LPCTSTR lpszClassName\n        , LPCTSTR lpszWindowName\n        , DWORD dwRequestedStyle\n        , const RECT&amp; rect\n        , CWnd* pParentWnd\n        , UINT nID\n        , CCreateContext* pContext\n        );\n\n    BOOL CreateDlg(LPCTSTR lpszTemplateName, CWnd* pParentWnd);\n\n    afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);\n</code></pre>\n\n<p>The <code>OnCreate</code> declaration is absolutely necessary.</p>\n\n<p>Without this declaration, nothing happens !!!</p>\n\n<p><code>OnCreate</code> is only declared in include file but is not defined in CPP file.</p>\n"}], "owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 987, "favorite_count": 0, "accepted_answer_id": 54604076, "answer_count": 2, "score": 2, "last_activity_date": 1550298123, "creation_date": 1548864307, "last_edit_date": 1550298123, "question_id": 54444723, "link": "https://stackoverflow.com/questions/54444723/how-to-change-dynamically-cformview-width-or-height-in-mdi-mfc-c-windows-appli", "title": "How to change dynamically CFormView WIDTH or HEIGHT in MDI MFC C++ windows application?", "body": "<p>In 1997, I have used C++ to create an MDI MFC program.</p>\n\n<p>I have created a Class named XFormFiew that extends MFC CFormView class.</p>\n\n<p>In <code>OnInitialUpdate()</code> event method, I have written some codes to modify automatically the zooming of the view.</p>\n\n<p>In the past, the majority of screen resolution are 800x600, but now the resolution is higher. In zooming automatically in <code>XFormView</code>, I avoid to made some modifications in all my views.</p>\n\n<p>The zooming code modify Left and Bottom but also Width and Height of each <code>CWnd</code> contained in active <code>CFormView</code></p>\n\n<p>The code is the following</p>\n\n<pre><code>void XFormView::OnInitialUpdate()\n    {\n    CFormView::OnInitialUpdate();\n\n    pLogFont = new LOGFONT;\n    CFont* pDialogFont = GetFont();\n    pDialogFont-&gt;GetObject(sizeof(LOGFONT),pLogFont);\n    pLogFont-&gt;lfHeight = MulDiv(pLogFont-&gt;lfHeight, Config.GetDstH(), Config.GetSrcH());\n    pLogFont-&gt;lfWeight = FW_NORMAL;\n\n    pFont = new CFont;\n    pFont-&gt;CreateFontIndirect(pLogFont);\n    SetFont(pFont);\n\n    CWnd* pWnd;\n    pWnd = GetWindow(GW_CHILD);\n    while (pWnd != NULL)\n        {\n        ZoomWnd(pWnd);\n        pWnd = pWnd-&gt;GetWindow(GW_HWNDNEXT);\n        }\n\n    // TRY to modify WIDTH and HEIGTH of CFormView    \n    ZoomWnd(this);\n    }        \n\nvoid XFormView::ZoomWnd(CWnd* pWnd)\n    {\n    CRect rect;\n    pWnd-&gt;GetWindowRect(&amp;rect);\n    ScreenToClient(&amp;rect);\n    rect.left   = (int)((long)rect.left   * Config.GetDstH() / Config.GetSrcH());\n    rect.top    = (int)((long)rect.top    * Config.GetDstV() / Config.GetSrcV());\n    rect.right  = (int)((long)rect.right  * Config.GetDstH() / Config.GetSrcH());\n    rect.bottom = (int)((long)rect.bottom * Config.GetDstV() / Config.GetSrcV());\n\n    pWnd-&gt;MoveWindow(&amp;rect);\n    pWnd-&gt;SetFont(pFont);\n    }\n</code></pre>\n\n<p>The code work well but for some views, the vertical and horizontal scrollbar are missing.</p>\n\n<p>The Window is always loaded MAXIMIZED. If I unmaximize Window, the scrollbars are always missing.</p>\n\n<p>If I reduce WIDTH or HEIGHT the scrollbar is displayed WHEN width or height reaches what has been defined in RC Resource file.</p>\n\n<p>Example:  </p>\n\n<pre><code>IDD_OVFORM DIALOGEX 0, 0, 370, 297\n</code></pre>\n\n<p>where 370 is the width of Form and 297 is height.</p>\n\n<p>If I reduce Child Window width, nothing happens until width is reduced to 370. At this moment an horizontal scrollbar is automatically displayed.</p>\n\n<p>My problem is how to change dynamically (not in RC file) the width and height of IDD_OVFORM to correspond to zoom level so that horizontal and vertical scrollbar are displayed correctly ?</p>\n\n<p>I have already try to change these properties in OnInitialUpdate() method but nothing is working.</p>\n\n<p>If I change Width and Height in RC Resource FILE, the zoom work correctly for a specific zoom level (but not for all zoom level).</p>\n\n<p>On Internet, I find a some solutions about removing Scrollbars but not about zooming and Scrollbars missing using MDI MFC Form.</p>\n\n<p>Is there somebody that has already found a solution to this problem ?</p>\n\n<p><strong>2019-02-12: thanks to Barmak Shemirani for his solution (OPTION 3) that works perfectly.</strong></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 6, "creation_date": 1548863889, "post_id": 54444536, "comment_id": 95698348, "body": "Believe us, this has nothing to do with C. Don&#39;t re-add the tag, please."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548864206, "post_id": 54444635, "comment_id": 95698528, "body": "@James Note that if you wanted to compare <code>first</code> then <code>second</code> you could just compare the pairs directly with <code>a &gt; b;</code>. <code>std::tie</code> pretty much makes a new <code>pair</code> (really a <code>tuple&lt;long long, long long&gt;</code> which behaves similarly) but in this case flips <code>first</code> and <code>second</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548864326, "post_id": 54444635, "comment_id": 95698602, "body": "I&#39;m not sure I understood exactly the question, but it seems like the members of <code>a</code> should be tied together while the members of <code>b</code> should be tied together. <code>std::tie(a.second, a.first)</code> etc."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548864379, "post_id": 54444635, "comment_id": 95698639, "body": "@Fran&#231;oisAndrieux: As I understand, OP wants descending second and then increasing first."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548864439, "post_id": 54444635, "comment_id": 95698669, "body": "I&#39;m not 100% sure this produces a strict ordering. Maybe reversing <code>.first</code>&#39;s sign instead would work while tieing the members of a pair together."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1548864814, "post_id": 54444635, "comment_id": 95698913, "body": "I like the second approach, the first however doesn&#39;t look intuitive to me."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1548864922, "post_id": 54444635, "comment_id": 95698983, "body": "@JVApen: I agree, but not all type can use unary <code>-</code>."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548865546, "post_id": 54444635, "comment_id": 95699400, "body": "@Fran&#231;oisAndrieux If you convert it to the equivalent <code>if (cmp(x, y) != 0) return cmp(x, y);</code> chain it becomes clear that it is indeed a strict ordering just like the original one, just with the priority and direction of ordering of the members mixed up."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548865551, "post_id": 54444635, "comment_id": 95699405, "body": "@Fran&#231;oisAndrieux: irreflexivity, and asymmetry seems trivial. remain transitivity: <code>x &lt; y</code> and <code>y &lt; z</code> -&gt; <code>x &lt; z</code>, so with <code>{y.s, x.f} &lt; {x.s, y.f}</code> and <code>{z.s, y.f} &lt; {y.s, z.f}</code>, do we have {z.s, x.f} &lt; {x.s, z.f} ? We have <code>z.s &lt;= y.s &lt;= x.s</code> (<code>&lt;=</code> as above comparaison will use second value on tie). if <code>z.s &lt; x.s</code>, job done, else <code>x.s == z.s == y.s</code>, so <code>x.f &lt; y.f &lt; z.f</code>, good too."}, {"owner": {"reputation": 3, "user_id": 10991261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42d421cb0a72378bf9cde1cb7bee2a1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/10991261/james"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548865646, "post_id": 54444635, "comment_id": 95699469, "body": "@Fran&#231;oisAndrieux: the question is: I am trying to sort a vector of pairs by the .second element. My previous algorithm was ok, but we can&#39;t be sure what it does when two .second elements are equal. Whenever this happens I want to sort these elements in ascending order by the .first element"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1548864564, "last_edit_date": 1548864564, "creation_date": 1548864031, "answer_id": 54444635, "question_id": 54444536, "link": "https://stackoverflow.com/questions/54444536/sort-same-elements-of-vector-in-ascending-order/54444635#54444635", "title": "sort same elements of vector in ascending order", "body": "<p><code>std::tie</code> can still be used in that case, just care to order variables correctly.</p>\n\n<pre><code>bool custom_compare(const pair&lt;long long, long long&gt; &amp;a,\n                    const pair&lt;long long, long long&gt; &amp;b)\n{\n    return std::tie(b.second, a.first) &lt; std::tie(a.second, b.first);\n}\n\nstd::sort(vec.begin(), vec.end(), custom_compare);\n</code></pre>\n\n<p>Another option as we use integral is that \"descending order for x\" is \"ascending order for -x\":</p>\n\n<p>so </p>\n\n<pre><code>bool custom_compare(const pair&lt;long long, long long&gt; &amp;a,\n                    const pair&lt;long long, long long&gt; &amp;b)\n{\n    return std::make_tuple(-a.second, a.first) &lt; std::make_tuple(-b.second, b.first);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1548864733, "post_id": 54444753, "comment_id": 95698857, "body": "What an illogical sorting, fixed"}, {"owner": {"reputation": 3, "user_id": 10991261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42d421cb0a72378bf9cde1cb7bee2a1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/10991261/james"}, "edited": false, "score": 0, "creation_date": 1548865258, "post_id": 54444753, "comment_id": 95699198, "body": "Oh that seems good. Is it the best solution as for run time though?"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 3, "user_id": 10991261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42d421cb0a72378bf9cde1cb7bee2a1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/10991261/james"}, "edited": false, "score": 0, "creation_date": 1548865407, "post_id": 54444753, "comment_id": 95699299, "body": "How about you test it and let us know? Without measuring, you won&#39;t know. Though I use this way of coding in production by default."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1548865806, "post_id": 54444753, "comment_id": 95699557, "body": "I suspect similar performance but as always measure to know. Else choose the more readable for you."}], "tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": false, "score": 1, "last_activity_date": 1548864720, "last_edit_date": 1548864720, "creation_date": 1548864426, "answer_id": 54444753, "question_id": 54444536, "link": "https://stackoverflow.com/questions/54444536/sort-same-elements-of-vector-in-ascending-order/54444753#54444753", "title": "sort same elements of vector in ascending order", "body": "<p><code>std::sort</code> requires you to define a less than operator.\nThe trick to put in in code how 2 elements behave to each other.</p>\n\n<pre><code>bool third_parameter(const pair&lt;long long,long long&gt; &amp;a,\n                   const pair&lt;long long,long long&gt; &amp;b)\n{\n    if (a.second != b.second)\n         return a.second &gt; b.second;\n\n    // When second is equal, sort based on first, largest values first\n    return a.first &lt; b.first;\n}\n\nint main (){\n    sort(vec.begin(), vec.end(), third_parameter );\n    return 0;\n}\n</code></pre>\n\n<p>I do recommend renaming the method to something more expressive.</p>\n"}], "owner": {"reputation": 3, "user_id": 10991261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42d421cb0a72378bf9cde1cb7bee2a1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/10991261/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 54444635, "answer_count": 2, "score": 0, "last_activity_date": 1548864720, "creation_date": 1548863695, "last_edit_date": 1548863865, "question_id": 54444536, "link": "https://stackoverflow.com/questions/54444536/sort-same-elements-of-vector-in-ascending-order", "title": "sort same elements of vector in ascending order", "body": "<pre><code>bool third_parameter(const pair&lt;long long,long long&gt; &amp;a,\n                       const pair&lt;long long,long long&gt; &amp;b)\n    {\n        return a.second&gt;b.second;\n    }\n\nint main (){\n        sort(vec.begin(), vec.end(), third_parameter );\n    return 0;\n    }\n</code></pre>\n\n<p>I use this sorting technique up here, but this doesn't guarantee me anything when it comes to same elements of the vector. I am using a vector of pairs which has an increasing number i in .first and an int in .second. I want when it finds two equal .second elements to sort them in ascending order of .first.  </p>\n"}, {"tags": ["c++", "qt", "scrollbar", "chromium", "qtwebengine"], "owner": {"reputation": 11, "user_id": 10991145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d451bcea2505703002dd46d25e13ad?s=128&d=identicon&r=PG&f=1", "display_name": "sirfredrick", "link": "https://stackoverflow.com/users/10991145/sirfredrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549393021, "creation_date": 1548863527, "last_edit_date": 1549393021, "question_id": 54444479, "link": "https://stackoverflow.com/questions/54444479/how-do-i-implement-a-scrollby-function-in-qts-qwebengine", "title": "How do I implement a scrollBy() function in Qt&#39;s QWebEngine?", "body": "<p>I want to have the QWebEngine's scrollBar scroll up and down with a dial. Older versions of Qt had this function with the QWebView.scroll(int). How do I implement this functionality in a QWebEngine?</p>\n\n<p>I started by using the simplebrowser template included with Qt 5.12.</p>\n\n<p>I have already tried running </p>\n\n<pre><code>QWebEngineView()-&gt;page()-&gt;runJavaScript(QString(\"window.scrollTo(%1, %2);\").arg(scrollX).arg(scrollY));\n</code></pre>\n\n<p>Found <a href=\"https://forum.qt.io/topic/60091/scroll-a-qwebengineview/4\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>But that wasn't working. I have also tried setting the focus to the WebPage and  having the code simulate a page down key press. That didn't work either.</p>\n\n<p>Here is the WebView's onDialChanged(int) funtion. It is called when the dial on the browserwindow changes.</p>\n\n<pre><code>int WebView::previousDial = 0;\nint WebView::diff = 0;\n\nvoid WebView::onDialChanged(int value) {\n     int diff = value - this-&gt;previousDial;\n     this-&gt;previousDial = value;\n     std::cout &lt;&lt; diff &lt;&lt; std::endl;\n     if(diff &gt; 0) {\n         this-&gt;setFocus();\n         this-&gt;page()-&gt;runJavaScript(QString(\"window.scrollTo(%1, %2);\").arg(0).arg(500), QWebEngineScript::ApplicationWorld);\n     }\n     else {\n         this-&gt;setFocus();\n         this-&gt;page()-&gt;runJavaScript(QString(\"window.scrollTo(%1, %2);\").arg(0).arg(500), QWebEngineScript::ApplicationWorld);\n         }\n}\n</code></pre>\n\n<p>Right now it is only scrolling by 500 for testing purposes. Once I get it working I will have the scroll distance based on value.</p>\n\n<p>I expect that when the dial changes that the page will scroll down by 500 pixels. When I run the program it doesn't scroll and I get the message <code>DuplicateHandle failed: Access is denied</code></p>\n\n<p>Am I supposed to use a QWebChannel to do this? Or do I use qt.window.scrollBy() instead? </p>\n\n<p>I'm starting to think that this isn't possible yet with Qt. I might just remake my project with electron. </p>\n"}, {"tags": ["c++", "templates", "std-function", "typename"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1548863567, "post_id": 54444425, "comment_id": 95698171, "body": "<code>std::function</code> was introduced in c++11. So this question can&#39;t be about c++98."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1548863630, "post_id": 54444425, "comment_id": 95698205, "body": "<code>typename Consumer::EventHandler EventHandler;</code> define a member variable, not a type."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1548863689, "post_id": 54444425, "comment_id": 95698237, "body": "@NathanOliver I would have removed the tag myself, but OP explicitly added the requirement in an edit after the original post. This is an inconsistency that deserves the be addressed by OP."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1548863816, "post_id": 54444425, "comment_id": 95698304, "body": "@Fran&#231;oisAndrieux: Maybe that we already are in a (not shown) custom namespace, alllowing to be in C++98 ;-)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548863977, "post_id": 54444425, "comment_id": 95698399, "body": "@Fran&#231;oisAndrieux Meh.  This way the Q is more generic and the answers give the OP a C++98 version if they really need it."}], "answers": [{"tags": [], "owner": {"reputation": 916, "user_id": 9603886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4d6a9adb988394b62bbd034407b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Const", "link": "https://stackoverflow.com/users/9603886/const"}, "is_accepted": true, "score": 3, "last_activity_date": 1548863505, "last_edit_date": 1548863505, "creation_date": 1548863419, "answer_id": 54444444, "question_id": 54444425, "link": "https://stackoverflow.com/questions/54444425/typename-keyword-for-stdfunction/54444444#54444444", "title": "typename keyword for std::function", "body": "<p>You need a type alias for dependent <code>Consumer::EventHandler</code>.</p>\n\n<p>This should work:</p>\n\n<pre><code>using EventHandler =  typename Consumer::EventHandler;\n</code></pre>\n\n<p>for lower compiler versions(before C++11)</p>\n\n<pre><code>typedef  typename Consumer::EventHandler EventHandler;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1548863578, "creation_date": 1548863578, "answer_id": 54444499, "question_id": 54444425, "link": "https://stackoverflow.com/questions/54444425/typename-keyword-for-stdfunction/54444499#54444499", "title": "typename keyword for std::function", "body": "<p>The <code>typename</code> keyword isn't used to import or define new type-aliases. What you're doing is really defining a <em>member variable</em> named <code>EventHandler</code>.</p>\n\n<p>You need to use <code>typdef</code> again to define a type-alias:</p>\n\n<pre><code>typedef typename Consumer::EventHandler EventHandler;\n</code></pre>\n\n<p>Or with modern C++ using <code>using</code>:</p>\n\n<pre><code>using EventHandler = typename Consumer::EventHandler;\n</code></pre>\n"}], "owner": {"reputation": 553, "user_id": 6051375, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/31f52f5bd3e837bdc3d29d71ffa582f1?s=128&d=identicon&r=PG&f=1", "display_name": "BK C.", "link": "https://stackoverflow.com/users/6051375/bk-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 54444444, "answer_count": 2, "score": 1, "last_activity_date": 1548863662, "creation_date": 1548863346, "last_edit_date": 1548863662, "question_id": 54444425, "link": "https://stackoverflow.com/questions/54444425/typename-keyword-for-stdfunction", "title": "typename keyword for std::function", "body": "<p>I have a class</p>\n\n<pre><code>class Consumer\n{\npublic:\n    typedef std::function&lt;void()&gt; EventHandler;\n    ...\n};\n</code></pre>\n\n<p>which I would like to use in this as template</p>\n\n<pre><code>template&lt;class Consumer&gt;\nclass ConsumerGroup\n{\npublic:\n    typename Consumer::EventHandler EventHandler;\n    ConsumerGroup(EventHandler handler);\n};\n</code></pre>\n\n<p>But above one results compilation error saying EventHandler is not a type.\nHow should I use typename keyword in this case?</p>\n"}, {"tags": ["c++", "c++11", "c++14"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1548863323, "post_id": 54444414, "comment_id": 95698038, "body": "Drop the second <code>##</code>. <code>foo(</code> is not a valid token. Anyway, what is this &quot;runtime overhead&quot; of which you speak? Compared to what alternative? This doesn&#39;t make any sense."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 5, "creation_date": 1548863416, "post_id": 54444414, "comment_id": 95698074, "body": "A macro performs direct token substitution before compiling.  Why do you think using a macro avoids runtime overhead?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1548863499, "post_id": 54444414, "comment_id": 95698132, "body": "<i>&quot;I would like to use macro expansion in order to avoid runtime overhead.&quot;</i> Which overhead do you want to avoid ? BTW, IMO, <code>a.has_foo();</code> seems clearer than <code>CALL(a, foo);</code>"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1548863843, "post_id": 54444414, "comment_id": 95698327, "body": "What are you trying to do? Looks like you are trying to reinvent <code>std::invoke</code>"}], "answers": [{"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1548864305, "post_id": 54444460, "comment_id": 95698591, "body": "Incidentally, a <i>better</i> expansion would be <code>CALL(object, method) ((object).has_##method())</code>.  This a) allows the macro to be used in an <code>if</code>/<code>for</code>/etc; b) copes with things like <code>CALL(*ptr_to_a, foo)</code>"}], "tags": [], "owner": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "is_accepted": true, "score": 3, "last_activity_date": 1548863458, "creation_date": 1548863458, "answer_id": 54444460, "question_id": 54444414, "link": "https://stackoverflow.com/questions/54444414/call-methods-through-macro-expansion/54444460#54444460", "title": "Call methods through macro expansion", "body": "<p>try with </p>\n\n<pre><code>#define CALL(object, method) do { object.has_##method(); } while(0)\n</code></pre>\n"}], "owner": {"reputation": 522, "user_id": 7810036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6512fa2b14b58946d77c37dc1c300d16?s=128&d=identicon&r=PG&f=1", "display_name": "Surcle", "link": "https://stackoverflow.com/users/7810036/surcle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 54444460, "answer_count": 1, "score": 0, "last_activity_date": 1548863458, "creation_date": 1548863293, "last_edit_date": 1548863351, "question_id": 54444414, "link": "https://stackoverflow.com/questions/54444414/call-methods-through-macro-expansion", "title": "Call methods through macro expansion", "body": "<p>I have this code:</p>\n\n<pre><code>class A {\npublic:\n  bool has_foo() { return true; }\n};\n\nint main() {\n  A a;\n\n  CALL(a, foo);\n}\n</code></pre>\n\n<p>I'd like to call the method <code>has_foo</code> through macro expansion:</p>\n\n<pre><code>#define CALL(object, method) do { object.has_ ## method ## (); } while(0)\n</code></pre>\n\n<p>The code above compiles on MSVC, but fails with GCC.</p>\n\n<p>I would like to use macro expansion in order to avoid runtime overhead.</p>\n"}, {"tags": ["c++", "windows", "multithreading", "c++11", "dll"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548863477, "post_id": 54444387, "comment_id": 95698119, "body": "Local static <code>Foo foo;</code> makes this code flawed. You have no control over object lifetime and rely on dynamic lazy initialization and dynamic uninitialization. You should write a dedicated init / uninit methods that must be called prior to using any of the library&#39;s function for the first time / after using any of the library functions for the last time. Another problem is that you have potentially throwing &quot;C&quot; function."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1548863860, "post_id": 54444387, "comment_id": 95698336, "body": "@VTT Local static gets initialized upon first usage of such object, which is to defer the initialization until we, absolutely, need it (even if it wasn&#39;t local <code>static</code>, but global one, one would run into issues of starting a thread, when DLL didn&#39;t, yet, initialize). And, it&#39;s global so once initialized, it would run until the application is closed. Having separate uninitialization routine, <i>might</i> be possible, but I need to investigate the feasibility of it, in the actual code. What I try to learn, with this question, is why the worker threads get killed, before objects are destructed.."}], "answers": [{"tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 1, "last_activity_date": 1548865072, "creation_date": 1548865072, "answer_id": 54444958, "question_id": 54444387, "link": "https://stackoverflow.com/questions/54444387/worker-threads-running-in-a-dll-gets-killed-on-application-shutdown-before-on/54444958#54444958", "title": "Worker threads, running in a DLL gets killed, on application shutdown, before one can gracefully shutdown them", "body": "<p>When <code>WinMain</code> returns, the runtime calls <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-exitprocess\" rel=\"nofollow noreferrer\"><code>ExitProcess</code></a>. The first thing that does is \"1. All of the threads in the process, except the calling thread, terminate their execution without receiving a <code>DLL_THREAD_DETACH</code> notification.\"</p>\n"}], "owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 54444958, "answer_count": 1, "score": -1, "last_activity_date": 1548865072, "creation_date": 1548863219, "question_id": 54444387, "link": "https://stackoverflow.com/questions/54444387/worker-threads-running-in-a-dll-gets-killed-on-application-shutdown-before-on", "title": "Worker threads, running in a DLL gets killed, on application shutdown, before one can gracefully shutdown them", "body": "<p>I, for some reason, need to have a global object in a .dll, which manages a <code>std::thread</code>. It is implemented in a following way:</p>\n\n<pre><code>#include \"Header.h\"\n#include &lt;thread&gt;\n#include &lt;condition_variable&gt;\n#include &lt;mutex&gt;\n\nclass Foo\n    {\npublic:\n    Foo () : m_closeThread (false)\n        {\n        m_thread = std::thread (&amp;Foo::ThreadProc, this);\n        }\n\n    ~Foo ()\n        {\n            {\n            std::unique_lock&lt;std::mutex&gt; lock (m_mutex);\n            m_closeThread = true;\n            }\n\n        m_cv.notify_one ();\n        m_thread.join ();\n        }\n\nprivate:\n    void ThreadProc ()\n        {\n        while (true)\n            {\n            std::unique_lock&lt;std::mutex&gt; lock (m_mutex);\n            m_cv.wait (lock, [this] () { return m_closeThread; });\n            if (m_closeThread)\n                break;\n            }\n        }\n\nprivate:\n    bool m_closeThread;\n    std::thread m_thread;\n    std::condition_variable m_cv;\n    std::mutex m_mutex;\n    };\n\nFoo&amp; GetFoo ()\n    {\n    static Foo foo;\n    return foo;\n    }\n\nextern \"C\" void Function ()\n    {\n    auto&amp; foo = GetFoo ();\n    }\n</code></pre>\n\n<p>However, when, the application is closed, <strong>before</strong> the <code>~Foo</code> is executed, all worker threads, of the .dll, get killed, or as the output window of MSVS2015 says:</p>\n\n<blockquote>\n  <p>The thread 0x1040 has exited with code 0 (0x0).</p>\n</blockquote>\n\n<p>And, due to this fact (<a href=\"https://stackoverflow.com/questions/37107778/why-is-stdcondition-variablenotify-one-blocking\">Source0</a>, <a href=\"https://www.reddit.com/r/cpp_questions/comments/8ld5nw/stdcondition_variablenotify_one_blocking_on/\" rel=\"nofollow noreferrer\">Source1</a>), the application blocks on <code>m_cv.notify_one ();</code> call, if one uses Windows 7 (doesn't block on Windows 8 and above).</p>\n\n<p>The fact, that it blocks on one particular version of Windows, while not on others, makes me think, that some sort of UB is to blame (such as DLL unload ordering related issue, since such issue is not reproducible if such object is not in a .dll), but I fail to think of solution, that allows me to gracefully shutdown the thread, while having the object global (since, one would need to do major application restructuring, to make it not global).</p>\n\n<p>So, can one shutdown the thread gracefully, before it is killed by the Windows platform?</p>\n\n<p><strong>Side note 0:</strong></p>\n\n<p>For the sake of example completeness,</p>\n\n<p><strong>this is the DLLMain:</strong></p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nBOOL APIENTRY DllMain (HMODULE, DWORD, LPVOID) { return TRUE; }\n</code></pre>\n\n<p><strong>This is the Header of the .dll:</strong></p>\n\n<pre><code>#pragma once\nextern \"C\" void Function ();\n</code></pre>\n\n<p><strong>This is the Console application, that uses said .dll:</strong></p>\n\n<pre><code>#include \"..\\Test\\Header.h\"\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n\nint main ()\n    {\n    Function ();\n    using namespace std::chrono_literals;\n    std::this_thread::sleep_for (2s);\n    }\n</code></pre>\n\n<p><strong>Side note 1:</strong></p>\n\n<p>I am, currently limited to using, at most, C++11 (or, whatever functionality is present in MSVS 2015).</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1548863272, "post_id": 54444346, "comment_id": 95698006, "body": "Note that you didn&#39;t respect the parenthesis in <code>(a+b)</code> from the original equation. And I don&#39;t see the exponent in the original equation that is implied by the <code>pow</code> in your code, but that may be a formatting issue."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548864411, "post_id": 54444346, "comment_id": 95698651, "body": "Please take more care when copy-pasting the equation from your homework. Clearly you intended <code>sin&#179;(C)</code>, so please ensure that the question reflects that."}, {"owner": {"reputation": 21, "user_id": 10989378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bSYY7HwMCeI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPKZP0A1ERb_1NjGLnNw_wDVLorlQ/mo/photo.jpg?sz=128", "display_name": "marshblocker", "link": "https://stackoverflow.com/users/10989378/marshblocker"}, "edited": false, "score": 0, "creation_date": 1548867517, "post_id": 54444346, "comment_id": 95700645, "body": "I&#39;m really sorry. I&#39;ll take note of that in the future. Thank you for the reply!"}], "answers": [{"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1548864322, "post_id": 54444415, "comment_id": 95698600, "body": "Also note that \u03c0 is not <code>3.1416</code>. See <a href=\"https://stackoverflow.com/questions/1727881/how-to-use-the-pi-constant-in-c\">here</a> for what you can do instead."}, {"owner": {"reputation": 21, "user_id": 10989378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bSYY7HwMCeI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPKZP0A1ERb_1NjGLnNw_wDVLorlQ/mo/photo.jpg?sz=128", "display_name": "marshblocker", "link": "https://stackoverflow.com/users/10989378/marshblocker"}, "edited": false, "score": 0, "creation_date": 1548867555, "post_id": 54444415, "comment_id": 95700671, "body": "Oh wow, I guess you&#39;re right. I&#39;m really sorry, such foolish mistake. Thanks you!"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 5, "last_activity_date": 1548863302, "creation_date": 1548863302, "answer_id": 54444415, "question_id": 54444346, "link": "https://stackoverflow.com/questions/54444346/converting-a-mathematical-equation-into-a-c-code/54444415#54444415", "title": "Converting a mathematical equation into a C++ code", "body": "<pre><code>(10*3.1416/a+b)\n</code></pre>\n\n<p>is not the same as 10\u03c0/(a+b), you meant </p>\n\n<pre><code>(10*3.1416/(a+b))\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10989378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bSYY7HwMCeI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPKZP0A1ERb_1NjGLnNw_wDVLorlQ/mo/photo.jpg?sz=128", "display_name": "marshblocker", "link": "https://stackoverflow.com/users/10989378/marshblocker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "accepted_answer_id": 54444415, "answer_count": 1, "score": -2, "last_activity_date": 1548864250, "creation_date": 1548863081, "last_edit_date": 1548864250, "question_id": 54444346, "link": "https://stackoverflow.com/questions/54444346/converting-a-mathematical-equation-into-a-c-code", "title": "Converting a mathematical equation into a C++ code", "body": "<p>I have a homework in C++ Intro. and one of it said to convert the following mathematical equation into a C++ code: </p>\n\n<pre><code>x = 10\u03c0/(a+b) sin3C+ 3(ln a)(tan C)\n</code></pre>\n\n<p>where a,b, and C are user-input and C is in degrees.</p>\n\n<p>I've tried it myself and had end up with this:</p>\n\n<pre><code>float x,y,z,a,b,C;\n\ncout&lt;&lt; \"Input the a-value: \";\ncin&gt;&gt; a;\n\ncout&lt;&lt; \"\\nInput the b-value: \";\ncin&gt;&gt; b;\n\ncout&lt;&lt; \"\\nInput the C-value: \";\ncin&gt;&gt; C;\nC = C*3.1416/180;\n\nx = (10*3.1416/a+b)*pow(sin(C),3)+3*log(a)*tan(C);\ncout&lt;&lt; \"\\n The value of x is \" &lt;&lt; x;\n</code></pre>\n\n<p>I've tried a=5,b=10, and C=15 and the result of x is 1.57606.\nI've tried it in a scientific calculator and x became 1.33005.\nWhat could be the problem in my code? Thank you!</p>\n\n<p><em>I'm sorry if there's anything wrong with my post structure because it's my first time to post here and English is not my native language</em></p>\n"}, {"tags": ["c++", "templates", "type-deduction"], "comments": [{"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1548863869, "post_id": 54444112, "comment_id": 95698341, "body": "The answer covers all the details. If you need better visibility of the types, you can use the helpers here: <a href=\"https://godbolt.org/z/AqTA0e\" rel=\"nofollow noreferrer\">godbolt.org/z/AqTA0e</a>"}, {"owner": {"reputation": 916, "user_id": 9603886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4d6a9adb988394b62bbd034407b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Const", "link": "https://stackoverflow.com/users/9603886/const"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548864152, "post_id": 54444112, "comment_id": 95698499, "body": "@balki Thats nice: your code demonstrates the view of the machine. Could you post it in the answer section? At least I can give you thumbs up."}], "answers": [{"comments": [{"owner": {"reputation": 916, "user_id": 9603886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4d6a9adb988394b62bbd034407b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Const", "link": "https://stackoverflow.com/users/9603886/const"}, "edited": false, "score": 0, "creation_date": 1548862695, "post_id": 54444185, "comment_id": 95697675, "body": "then what happens in the case of <a href=\"https://coliru.stacked-crooked.com/a/1dad21b056f50412\" rel=\"nofollow noreferrer\">applying <code>std::decay_t</code></a>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 6, "creation_date": 1548862807, "post_id": 54444185, "comment_id": 95697745, "body": "@JoeyMallone Don&#39;t use plain arrays and you never have to worry about this. <code>std::array</code> and <code>std::string</code>/<code>std::string_view</code> should suffice."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548862909, "post_id": 54444185, "comment_id": 95697803, "body": "@MaxLanghof, yes, thank you. I learn something new, everyday here."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 916, "user_id": 9603886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4d6a9adb988394b62bbd034407b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Const", "link": "https://stackoverflow.com/users/9603886/const"}, "edited": false, "score": 1, "creation_date": 1548862938, "post_id": 54444185, "comment_id": 95697818, "body": "@Const Moved my comment to the answer."}, {"owner": {"reputation": 916, "user_id": 9603886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4d6a9adb988394b62bbd034407b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Const", "link": "https://stackoverflow.com/users/9603886/const"}, "edited": false, "score": 0, "creation_date": 1548863006, "post_id": 54444185, "comment_id": 95697856, "body": "@Fran&#231;oisAndrieux Yeah, that&#39;s true, I was keep thinking that <code>std::decay</code> makes it <code>const char*</code> but the ones I used not. This clarifies me the doubt. Thanks."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 7, "last_activity_date": 1548862967, "last_edit_date": 1548862967, "creation_date": 1548862565, "answer_id": 54444185, "question_id": 54444112, "link": "https://stackoverflow.com/questions/54444112/why-does-we-have-a-type-mismatch/54444185#54444185", "title": "Why does we have a type mismatch?", "body": "<p>You are passing <code>const char[7]</code> not <code>const char *</code>. Arrays and pointers are not the same things. They are often confused because arrays easily decay to pointers to their first element. When taken by reference, arrays don't need to decay to pointers. Only in the first case does your array need to decay to a pointer.</p>\n\n<p>The following tests produces <code>true</code> for each case : </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;typename T&gt; void passByValue(T by_value)\n{\n    std::cout &lt;&lt; std::is_same_v&lt;char const*, decltype(by_value)&gt; &lt;&lt; std::endl; \n}\n\ntemplate&lt;typename T&gt; void passByReferance(T &amp;by_ref)\n{\n    std::cout &lt;&lt; std::is_same_v&lt;char const[7], std::remove_reference_t&lt;decltype(by_ref)&gt;&gt; &lt;&lt; std::endl;\n}\n\ntemplate&lt;typename T&gt; void passByConstRef(const T &amp;const_ref)\n{\n    std::cout &lt;&lt; std::is_same_v&lt;char [7], std::remove_const_t&lt;std::remove_reference_t&lt;decltype(const_ref)&gt;&gt;&gt; &lt;&lt; std::endl;\n}\n\nint main()\n{\n    std::cout &lt;&lt; std::boolalpha;\n    passByValue(\"string\");    \n    passByReferance(\"string\");\n    passByConstRef(\"string\"); \n    return 0;\n}\n</code></pre>\n\n<p>Edit : As for <a href=\"https://en.cppreference.com/w/cpp/types/decay\" rel=\"nofollow noreferrer\"><code>std::decay</code></a>, it explicitly causes array types to decay to pointers :</p>\n\n<blockquote>\n  <p>If <code>T</code> names the type \"array of <code>U</code>\" or \"reference to array of <code>U</code>\", the member typedef type is <code>U*</code>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "is_accepted": false, "score": 2, "last_activity_date": 1548866553, "creation_date": 1548866553, "answer_id": 54445443, "question_id": 54444112, "link": "https://stackoverflow.com/questions/54444112/why-does-we-have-a-type-mismatch/54445443#54445443", "title": "Why does we have a type mismatch?", "body": "<p>Some helpers to get better view of the types. CE: <a href=\"https://godbolt.org/z/6EFmIR\" rel=\"nofollow noreferrer\">https://godbolt.org/z/6EFmIR</a></p>\n\n<pre><code>#include &lt;type_traits&gt;\n\ntemplate&lt;class T&gt;\nstruct Tis { Tis(); };\n\ntemplate&lt;bool b&gt;\nstruct Truth{ Truth(); };\n\ntemplate&lt;typename T&gt; void passByValue(T by_value)\n{\n    Tis&lt;T&gt;{}; //call    Tis&lt;char const*&gt;::Tis()\n    Truth&lt;\n        std::is_same_v&lt;char const*, decltype(by_value)&gt;\n    &gt;{}; // call    Truth&lt;true&gt;::Truth()\n}\n\ntemplate&lt;typename T&gt; void passByReferance(T &amp;by_ref)\n{\n    Tis&lt;T&gt;{}; // call    Tis&lt;char const [7]&gt;::Tis()\n    Tis&lt;decltype(by_ref)&gt;{}; // call    Tis&lt;char const (&amp;) [7]&gt;::Tis()\n    Truth&lt;\n        std::is_same_v&lt;char const*, std::remove_reference_t&lt;decltype(by_ref)&gt;&gt; \n    &gt;{}; // call    Truth&lt;false&gt;::Truth()\n    Tis&lt;\n        std::remove_reference_t&lt;decltype(by_ref)&gt;\n    &gt;{}; // call    Tis&lt;char const [7]&gt;::Tis()\n}\n\ntemplate&lt;typename T&gt; void passByConstRef(const T &amp;const_ref)\n{\n    Tis&lt;T&gt;{}; // call    Tis&lt;char [7]&gt;::Tis()\n    Truth&lt;\n        std::is_same_v&lt;char const*, std::remove_const_t&lt;std::remove_reference_t&lt;decltype(const_ref)&gt;&gt;&gt; \n    &gt;{}; // call    Truth&lt;false&gt;::Truth()\n    Tis&lt;\n        std::remove_const_t&lt;std::remove_reference_t&lt;decltype(const_ref)&gt;&gt;\n    &gt;{}; // call    Tis&lt;char [7]&gt;::Tis()\n}\n\nvoid foo1(){\n    passByValue(\"string\");\n}\nvoid foo2() {\n    passByReferance(\"string\");\n}\nvoid foo3() {\n    passByConstRef(\"string\");\n}\n</code></pre>\n"}], "owner": {"reputation": 916, "user_id": 9603886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4d6a9adb988394b62bbd034407b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Const", "link": "https://stackoverflow.com/users/9603886/const"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 1, "accepted_answer_id": 54444185, "answer_count": 2, "score": 4, "last_activity_date": 1548866553, "creation_date": 1548862361, "question_id": 54444112, "link": "https://stackoverflow.com/questions/54444112/why-does-we-have-a-type-mismatch", "title": "Why does we have a type mismatch?", "body": "<p>I have written a program to see, how <strong>string literals</strong> been deduced in template functions.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;typename T&gt; void passByValue(T by_value)\n{\n    std::cout &lt;&lt; std::is_same_v&lt;char const*, decltype(by_value)&gt; &lt;&lt; std::endl; // okay\n}\n\ntemplate&lt;typename T&gt; void passByReferance(T &amp;by_ref)\n{\n    std::cout &lt;&lt; std::is_same_v&lt;char const*, std::remove_reference_t&lt;decltype(by_ref)&gt;&gt; &lt;&lt; std::endl;\n}\n\ntemplate&lt;typename T&gt; void passByConstRef(const T &amp;const_ref)\n{\n    std::cout &lt;&lt; std::is_same_v&lt;char const*, std::remove_const_t&lt;std::remove_reference_t&lt;decltype(const_ref)&gt;&gt;&gt; &lt;&lt; std::endl;\n}\n\nint main()\n{\n    std::cout &lt;&lt; std::boolalpha;\n    passByValue(\"string\");    // true: good\n    passByReferance(\"string\");// false ??\n    passByConstRef(\"string\"); // false ??\n    return 0;\n}\n</code></pre>\n\n<p>It turns out that, only for the <strong>passByValue</strong> the string literals deduced to <code>const char*</code> type. </p>\n\n<p>In other two cases(<strong>passByReferance</strong> and <strong>passByConstRef</strong>), if we apply to the deduced arguments, <code>std::remove_reference_t</code> and <code>std::remove_const_t</code>, what I we suppose to get is <code>const char*</code>, is that correct?</p>\n\n<p>I get a type match when I do complete decay using <code>std::decay_t</code>, why is that?</p>\n"}, {"tags": ["c++", "shared-libraries", "libretro"], "answers": [{"comments": [{"owner": {"reputation": 4071, "user_id": 1705337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vzyhp.png?s=128&g=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/1705337/morgoth"}, "edited": false, "score": 0, "creation_date": 1548865941, "post_id": 54444254, "comment_id": 95699650, "body": "This gives me an empty string."}, {"owner": {"reputation": 13028, "user_id": 1401351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993d07ca1cd59dd11d96a896e7c804d0?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1401351/peter"}, "reply_to_user": {"reputation": 4071, "user_id": 1705337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vzyhp.png?s=128&g=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/1705337/morgoth"}, "edited": false, "score": 0, "creation_date": 1548869508, "post_id": 54444254, "comment_id": 95701692, "body": "Sorry.  <code>dladdr()</code> returns 0 on error, and nonzero on success.   Grr.  Editing the code sample to reverse the error check."}], "tags": [], "owner": {"reputation": 13028, "user_id": 1401351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993d07ca1cd59dd11d96a896e7c804d0?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1401351/peter"}, "is_accepted": false, "score": 2, "last_activity_date": 1548869530, "last_edit_date": 1548869530, "creation_date": 1548862768, "answer_id": 54444254, "question_id": 54444064, "link": "https://stackoverflow.com/questions/54444064/get-filepath-of-library/54444254#54444254", "title": "Get filepath of library", "body": "<p>On Linux, use the Glibc extension <code>dladdr()</code>.</p>\n\n<pre><code>#include &lt;dlfcn.h&gt;\n\nstd::string get_library_path() {\n    Dl_info dl_info;\n    if(0 != dladdr((void*)get_library_path, &amp;dl_info))\n        return std::string(dl_info.dli_fname);\n    else\n        return std::string();\n}\n</code></pre>\n\n<p>On Windows, the equivalent is <code>GetModuleFileName()</code></p>\n"}], "owner": {"reputation": 4071, "user_id": 1705337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vzyhp.png?s=128&g=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/1705337/morgoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548869530, "creation_date": 1548862221, "question_id": 54444064, "link": "https://stackoverflow.com/questions/54444064/get-filepath-of-library", "title": "Get filepath of library", "body": "<p>I am building a library for the Libretro framework, and I want to get the path of my library so that I can open a file in the same directory as my <code>library.so</code> file.</p>\n\n<p>I followed the instructions at <a href=\"https://stackoverflow.com/questions/5525668/how-to-implement-readlink-to-find-the-path\">How to implement readlink to find the path</a>, but that just gives me the path of the executable that is calling my library.</p>\n"}, {"tags": ["c++", "windows", "visual-studio", "deployment"], "answers": [{"tags": [], "owner": {"reputation": 1569, "user_id": 1694593, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ec320e3d57fdbde4b7ecc8194b2a2d1?s=128&d=identicon&r=PG", "display_name": "Wander3r", "link": "https://stackoverflow.com/users/1694593/wander3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1548999056, "creation_date": 1548999056, "answer_id": 54473403, "question_id": 54443887, "link": "https://stackoverflow.com/questions/54443887/distributing-raw-msvcp-dll-or-installing-vc-redist-exe/54473403#54473403", "title": "Distributing raw msvcp.dll or installing vc_redist.exe", "body": "<p>There is no thumb rule or \"right approach\" for this scenario, rather pros and cons of choosing one over other. In my opinion, this depends on how the product/file is being deployed. </p>\n\n<ul>\n<li>If the file is not getting installed (extracted from a zip or runs before the installer), then placing the necessary redist in the same file is good enough. May be statically linking is better (?)</li>\n<li>If everything is getting installed via an installer, then installing the redistributables is cleaner way of doing this. There are already <a href=\"https://docs.microsoft.com/en-us/cpp/ide/redistributing-visual-cpp-files?view=vs-2017\" rel=\"nofollow noreferrer\">merge modules</a>  available to integrate with installer or even standalone executables</li>\n</ul>\n\n<p>Won't recommend placing the necessary files in the folders where installer could be run as it's easier to maintain/update the redist files with each newer version ( of compilers and product)</p>\n"}], "owner": {"reputation": 307, "user_id": 8558321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9725e631abbcee1b0a794d5233a8c15b?s=128&d=identicon&r=PG&f=1", "display_name": "Rajju", "link": "https://stackoverflow.com/users/8558321/rajju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 54473403, "answer_count": 1, "score": 0, "last_activity_date": 1548999056, "creation_date": 1548861660, "question_id": 54443887, "link": "https://stackoverflow.com/questions/54443887/distributing-raw-msvcp-dll-or-installing-vc-redist-exe", "title": "Distributing raw msvcp.dll or installing vc_redist.exe", "body": "<p>Deploying an app compiled with MSVC, should I include msvcp140.dll and vcruntime140.dll copy-pasted from VC folder with other .dll's, or distribiute vc_redist.exe installer, installing environment on each user computer?</p>\n\n<p>What is the 'right' approach, and why?</p>\n"}, {"tags": ["c++", "linux", "sockets"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1548861621, "post_id": 54443823, "comment_id": 95696942, "body": "The other end is probably using <code>recvfrom</code> which gives the address/port pair of the sender, and uses that for the reply."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1548875202, "post_id": 54443823, "comment_id": 95704537, "body": "&quot;<i>Is it in fact a bind with a random available port number that is as permanent as if I had called bind</i>&quot; - that is exactly what happens"}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 2748602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05f39f57bb773af68e0b44c44dab98d2?s=128&d=identicon&r=PG", "display_name": "schr&#246;dinbug", "link": "https://stackoverflow.com/users/2748602/schr%c3%b6dinbug"}, "edited": false, "score": 0, "creation_date": 1548875573, "post_id": 54444528, "comment_id": 95704727, "body": "&quot;When an ephemeral port is allocated&quot;... is it allocated via a call to <code>bind</code>?"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1548863660, "creation_date": 1548863660, "answer_id": 54444528, "question_id": 54443823, "link": "https://stackoverflow.com/questions/54443823/udp-socket-sendto-implicit-bind/54444528#54444528", "title": "udp socket sendto implicit bind", "body": "<blockquote>\n  <p>... there is kind of an implicit bind when the sendto function is called. How does it work? Is it in fact a bind with a random available port number that is as permanent as if I had called bind or something else?</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man7/ip.7.html\" rel=\"nofollow noreferrer\"><code>man ip(7)</code></a>:</p>\n\n<pre><code>   ip_local_port_range (since Linux 2.2)\n          This file contains two integers that define the default local\n          port range allocated to sockets that are not explicitly bound\n          to a port number\u2014that is, the range used for ephemeral ports.\n          An ephemeral port is allocated to a socket in the following\n          circumstances:\n\n          *  the port number in a socket address is specified as 0 when calling bind(2);\n\n          *  listen(2) is called on a stream socket that was not previously bound;\n\n          *  connect(2) was called on a socket that was not previously bound;\n\n          *  sendto(2) is called on a datagram socket that was not previously bound.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25103, "user_id": 3199595, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TwK8q.png?s=128&g=1", "display_name": "Malt", "link": "https://stackoverflow.com/users/3199595/malt"}, "is_accepted": true, "score": 1, "last_activity_date": 1548870981, "creation_date": 1548870981, "answer_id": 54446726, "question_id": 54443823, "link": "https://stackoverflow.com/questions/54443823/udp-socket-sendto-implicit-bind/54446726#54446726", "title": "udp socket sendto implicit bind", "body": "<p>There <em>is</em> an implicit bind if the socket is unbound since all packets have to carry both a source port. So the API assumes that if you didn't care enough about the port to bind your socket beforehand, then it can just bind the socket to a random port. And while unfortunately I don't know the implementation details of <code>sendto</code>, I can offer some official documentation.</p>\n\n<p>For Linux, from the <a href=\"http://man7.org/linux/man-pages/man7/udp.7.html\" rel=\"nofollow noreferrer\">udp man page</a>:</p>\n\n<blockquote>\n  <p>When a UDP socket is created, its local and remote addresses are\n  unspecified.  Datagrams can be sent immediately using sendto(2) or\n  sendmsg(2) with a valid destination address  as  an  argument.   When \n  connect(2)  is called  on  the  socket,  the default destination\n  address is set and datagrams can now be sent using send(2) or write(2)\n  without specifying a destination address.  It is still possible to\n  send to other destinations by passing an address to sendto(2) or\n  sendmsg(2).  <strong>In order to receive packets, the socket can be bound to a\n  local address first by using bind(2). *Otherwise, the socket layer\n  will automatically assign a free local port out of the range defined\n  by /proc/sys/net/ipv4/ip_local_port_range and bind the socket to\n  INADDR_ANY</strong>.</p>\n</blockquote>\n\n<p>For Windows, a snippet from the documentation for <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winsock/nf-winsock-sendto\" rel=\"nofollow noreferrer\">Winsock 2's sendto</a>:</p>\n\n<blockquote>\n  <p><strong>If the socket is unbound, unique values are assigned to the local\n  association by the system, and the socket is then marked as bound</strong>. If\n  the socket is connected, the getsockname function can be used to\n  determine the local IP address and port associated with the socket.</p>\n</blockquote>\n"}], "owner": {"reputation": 440, "user_id": 2748602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05f39f57bb773af68e0b44c44dab98d2?s=128&d=identicon&r=PG", "display_name": "schr&#246;dinbug", "link": "https://stackoverflow.com/users/2748602/schr%c3%b6dinbug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "accepted_answer_id": 54446726, "answer_count": 2, "score": 0, "last_activity_date": 1548870981, "creation_date": 1548861427, "question_id": 54443823, "link": "https://stackoverflow.com/questions/54443823/udp-socket-sendto-implicit-bind", "title": "udp socket sendto implicit bind", "body": "<p>I'm looking at the udp client example here:\n<a href=\"http://www.linuxhowtos.org/data/6/client_udp.c\" rel=\"nofollow noreferrer\">http://www.linuxhowtos.org/data/6/client_udp.c</a></p>\n\n<p>snippet:</p>\n\n<pre><code>/* UDP client in the internet domain */\n   struct sockaddr_in server, from;\n   //...snipped\n\n   sock= socket(AF_INET, SOCK_DGRAM, 0);\n   if (sock &lt; 0) error(\"socket\");\n\n   server.sin_family = AF_INET;\n   hp = gethostbyname(argv[1]);\n   if (hp==0) error(\"Unknown host\");\n\n   bcopy((char *)hp-&gt;h_addr, \n        (char *)&amp;server.sin_addr,\n         hp-&gt;h_length);\n   server.sin_port = htons(atoi(argv[2]));\n   length=sizeof(struct sockaddr_in);\n\n   //... snipped       \n\n   n=sendto(sock,buffer,\n            strlen(buffer),0,(const struct sockaddr *)&amp;server,length);\n   if (n &lt; 0) error(\"Sendto\");\n   n = recvfrom(sock,buffer,256,0,(struct sockaddr *)&amp;from, &amp;length);\n   if (n &lt; 0) error(\"recvfrom\");\n   //... snipped    \n</code></pre>\n\n<p>I'm trying to understand how it knows where to receive the message from. I know when <code>sendto</code> is called an available port is chosen and that is embedded in the udp message and the server application can read that and reply to it.  How does the client code know to receive a message on that port?</p>\n\n<p>This answer: <a href=\"https://stackoverflow.com/a/48245273/2748602\">https://stackoverflow.com/a/48245273/2748602</a> indicates there is kind of an implicit bind when the <code>sendto</code> function is called. How does it work?  Is it in fact a bind with a random available port number that is as permanent as if I had called <code>bind</code> or something else? It seems there's some aspect of permanence.  Just interested in a little more detail.</p>\n"}, {"tags": ["c++", "operators"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1548861473, "post_id": 54443677, "comment_id": 95696828, "body": "User-defined literals are a way of creating new literal types. Just as it&#39;s not possible to make up your own operators, you can&#39;t have a literal with two values."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1548862352, "post_id": 54443677, "comment_id": 95697445, "body": "I would avoid to overload operators for foreign class only. future std might add legally <code>operator +</code> for array leading to possible break of ODR."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548862670, "post_id": 54443677, "comment_id": 95697651, "body": "Not sure - what do you need the <i>current</i> <code>operator*</code> for, in other words: which math would use the component-wise product? Wouldn&#39;t it be more meaningful to let <code>operator*</code> calculate the dot product (what your new operator would do) and just drop the component-wise one?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548862847, "post_id": 54443677, "comment_id": 95697771, "body": "The literal operator is intended for totally different things..."}, {"owner": {"reputation": 971, "user_id": 7446528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3lQ4SVDDX48/AAAAAAAAAAI/AAAAAAAAAJ8/PB1ezXi8oio/photo.jpg?sz=128", "display_name": "Hadi Farah", "link": "https://stackoverflow.com/users/7446528/hadi-farah"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548862920, "post_id": 54443677, "comment_id": 95697809, "body": "@Aconcagua I need it for scaling, I am doing this for finite element purposes which involves a lot of local to global mapping and vice versa. I can just define <code>Scaling = Coordinates { a, b, c}</code> and scale all my vertices by doing Scaling * vertex, since my vertices would also be <code>Coordinates</code>. As for the literal operator I didn&#39;t know about it, until I read about 20 mins ago. I am trying to explore my options. I tried to go around it by overloading <code>++</code> to sum all the inner values but that only returns int and I cannot change it. If that worked I can do something like <code>(C1*C2)++</code>"}, {"owner": {"reputation": 971, "user_id": 7446528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3lQ4SVDDX48/AAAAAAAAAAI/AAAAAAAAAJ8/PB1ezXi8oio/photo.jpg?sz=128", "display_name": "Hadi Farah", "link": "https://stackoverflow.com/users/7446528/hadi-farah"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548863221, "post_id": 54443677, "comment_id": 95697976, "body": "@Aconcagua nevermind it does work. I now do <code>(C1*C2)++</code> get get my intended purpose. This is fine because I never need to increment coordinates by 1. over x,y,z. or any value for that matter"}], "answers": [{"comments": [{"owner": {"reputation": 971, "user_id": 7446528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3lQ4SVDDX48/AAAAAAAAAAI/AAAAAAAAAJ8/PB1ezXi8oio/photo.jpg?sz=128", "display_name": "Hadi Farah", "link": "https://stackoverflow.com/users/7446528/hadi-farah"}, "edited": false, "score": 0, "creation_date": 1548861892, "post_id": 54443816, "comment_id": 95697120, "body": "I see, thank you. I was just asking  because of my lack of experience and hoping somebody can give me a clear answer."}], "tags": [], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "is_accepted": true, "score": 3, "last_activity_date": 1548862114, "last_edit_date": 1548862114, "creation_date": 1548861419, "answer_id": 54443816, "question_id": 54443677, "link": "https://stackoverflow.com/questions/54443677/create-a-literal-operator-function-that-takes-2-input-parameters/54443816#54443816", "title": "Create a literal operator function that takes 2 input parameters", "body": "<p>You can only overload 38 existing operators for your type. Which are listed here: <a href=\"https://en.cppreference.com/w/cpp/language/operators\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/operators</a></p>\n\n<blockquote>\n  <p><code>op</code>  -   any of the following 38 <sup>(until C++20)</sup> 39 <sup>(since C++20)</sup>\n  operators:<br>\n  <code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>%</code> <code>^</code> <code>&amp;</code> <code>|</code> <code>~</code> <code>!</code> <code>=</code> <code>&lt;</code> <code>&gt;</code> <code>+=</code> <code>-=</code> <code>*=</code> <code>/=</code> <code>%=</code> <code>^=</code> <code>&amp;=</code> <code>|=</code> <code>&lt;&lt;</code> <code>&gt;&gt;</code> <code>&gt;&gt;=</code> <code>&lt;&lt;=</code> <code>==</code> <code>!=</code> <code>&lt;=</code> <code>&gt;=</code> <code>&lt;=&gt;</code><sup>(since C++20)</sup> <code>&amp;&amp;</code> <code>||</code> <code>++</code> <code>--</code> <code>,</code> <code>-&gt;*</code> <code>-&gt;</code> <code>(</code> <code>)</code> <code>[</code> <code>]</code></p>\n</blockquote>\n\n<p>literal operators work on single argument and convert literals (like 42, \"foobar\") to objects. Since you already have objects, you have to use operator overloading. Pick any of the available ones.</p>\n"}, {"tags": [], "owner": {"reputation": 999, "user_id": 7859598, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B2rVv02QIdo/AAAAAAAAAAI/AAAAAAAACew/FUFwHEbNSVo/photo.jpg?sz=128", "display_name": "Rietty", "link": "https://stackoverflow.com/users/7859598/rietty"}, "is_accepted": false, "score": 1, "last_activity_date": 1548861581, "creation_date": 1548861581, "answer_id": 54443871, "question_id": 54443677, "link": "https://stackoverflow.com/questions/54443677/create-a-literal-operator-function-that-takes-2-input-parameters/54443871#54443871", "title": "Create a literal operator function that takes 2 input parameters", "body": "<p>First off you can look at the <a href=\"https://en.cppreference.com/w/cpp/language/operators\" rel=\"nofollow noreferrer\">list of operators</a> to see what exists here to see which can and cannot be overloaded. </p>\n\n<p>On the second point, you can probably try something like <a href=\"https://stackoverflow.com/a/41780190/7859598\">this answer</a> to make a custom operator. Keep in mind this isn't technically a new operator (as you can't make your own in C++) but does involve a bit of template magic to accomplish the same thing.</p>\n"}], "owner": {"reputation": 971, "user_id": 7446528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3lQ4SVDDX48/AAAAAAAAAAI/AAAAAAAAAJ8/PB1ezXi8oio/photo.jpg?sz=128", "display_name": "Hadi Farah", "link": "https://stackoverflow.com/users/7446528/hadi-farah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 54443816, "answer_count": 2, "score": 1, "last_activity_date": 1548862114, "creation_date": 1548860991, "question_id": 54443677, "link": "https://stackoverflow.com/questions/54443677/create-a-literal-operator-function-that-takes-2-input-parameters", "title": "Create a literal operator function that takes 2 input parameters", "body": "<p>I have a defined type <code>Coordinates</code> like so:</p>\n\n<pre><code>#include &lt;array&gt;\nusing Coordinates = std::array&lt;double, 3&gt;;\n</code></pre>\n\n<p>For which I call the following operator overload functions:</p>\n\n<pre><code>Coordinates operator+(const Coordinates&amp; lhs, const Coordinates&amp; rhs);\nCoordinates operator*(const Coordinates&amp; lhs, const Coordinates&amp; rhs);\n</code></pre>\n\n<p>both overloads work, so that if I have 2 <code>Coordinates</code> variables :</p>\n\n<p><code>C1 = { 1., 2., 3.}</code> and \n<code>C2 = { 1., 2., 3. }</code></p>\n\n<p><code>C1+C2</code> returns <code>{ 2., 4., 6.}</code></p>\n\n<p><code>C1*C2</code> returns <code>{ 1., 4., 9.}</code></p>\n\n<p>Now I want to define a <code>*+</code> operator such that:</p>\n\n<p><code>C1*+C2</code> returns <code>1. + 4. + 9.</code> or <code>14.</code></p>\n\n<p>I tried the following implementation:</p>\n\n<pre><code>Coordinates operator*+(const Coordinates&amp; lhs, const Coordinates&amp; rhs)\n{\n    return lhs[0] * rhs[0] + lhs[1] * rhs[1] + lhs[2] * rhs[2];\n}\n</code></pre>\n\n<p>however, <code>*+</code> is not a pre-defined operator. Then I tried this format:</p>\n\n<pre><code>Coordinates operator \"\" *+(const Coordinates&amp; lhs, const Coordinates&amp; rhs)\n{\n    return lhs[0] * rhs[0] + lhs[1] * rhs[1] + lhs[2] * rhs[2];\n}\n</code></pre>\n\n<p>but I get this : <code>invalid literal operator name</code>. Understandable how about this:</p>\n\n<pre><code>double operator \"\" _d_(const Coordinates&amp; lhs, const Coordinates&amp; rhs)\n{\n    return lhs[0] * rhs[0] + lhs[1] * rhs[1] + lhs[2] * rhs[2];\n} \n</code></pre>\n\n<p><code>_d_</code> stands for dot as in dot product, but now I get this error <code>too many parameters for this literal</code>. Is it possible to define an operator for the dot product or do I have to write a <code>dot()</code> function?</p>\n"}, {"tags": ["c++", "multidimensional-array"], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 5977575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60dce2092d74e1bb099a8dc62a2c08ae?s=128&d=identicon&r=PG&f=1", "display_name": "StephanH", "link": "https://stackoverflow.com/users/5977575/stephanh"}, "is_accepted": false, "score": 1, "last_activity_date": 1548863073, "last_edit_date": 1548863073, "creation_date": 1548861643, "answer_id": 54443883, "question_id": 54443657, "link": "https://stackoverflow.com/questions/54443657/is-there-a-way-to-concatenate-three-two-dimensional-vectors-along-the-column-in/54443883#54443883", "title": "Is there a way to concatenate three two-dimensional vectors along the Column in C++ like the way in python:np.concatenate([x,y,z], axis=1)?", "body": "<p>You can use newmat11 to achieve a phyton like behavior described: <a href=\"http://www.robertnz.net/nm11.htm\" rel=\"nofollow noreferrer\">http://www.robertnz.net/nm11.htm</a></p>\n\n<pre><code>std::vector&lt;int &gt; dest{ 1,2,3,4,5 }; \nstd::vector&lt;int &gt; src{ 6,7,8,9,10 };\nstd::vector&lt;int&gt; third{ 11,12,13,14,15 };\nMatrix x(5, 3);\nx.column(1) &lt;&lt; dest.data();\nx.column(2) &lt;&lt; src.data();\nx.column(3) &lt;&lt; third.data();\nMatrix sub = x.submatrix(1, 5, 1, 2);\n\nstd::cout &lt;&lt; sub &lt;&lt; std::endl;\n</code></pre>\n\n<p>Produces the following output</p>\n\n<pre><code>1.0   6.0\n2.0   7.0\n3.0   8.0\n4.0   9.0\n5.0  10.0\n</code></pre>\n\n<p>A Matrix stores its values consecutive, so you can get your single vector like this:</p>\n\n<pre><code>std::vector&lt;double&gt; merge(sub.Store(), sub.Store() + sub.size());\nfor (auto&amp; digit : merge) std::cout &lt;&lt; digit &lt;&lt; \"\\t\";\n</code></pre>\n\n<p>Which produce the following output:\n1 6 2 7 3 8 4 9 5 10</p>\n\n<p>The \"hardest\" thing to do is:</p>\n\n<ol>\n<li>Download all required .h and .cpp files from the homepage</li>\n<li>Create a new project consisting of the newmat11 files</li>\n<li>Build to .lib</li>\n<li>Add reference, include directory and .lib path to your main project</li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 10990981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5401f59644111f4c19ec61f2286ce7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Surendra", "link": "https://stackoverflow.com/users/10990981/surendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549289286, "creation_date": 1548860928, "last_edit_date": 1549289286, "question_id": 54443657, "link": "https://stackoverflow.com/questions/54443657/is-there-a-way-to-concatenate-three-two-dimensional-vectors-along-the-column-in", "title": "Is there a way to concatenate three two-dimensional vectors along the Column in C++ like the way in python:np.concatenate([x,y,z], axis=1)?", "body": "<p>I am trying concatenate two-dimensional vector in C++ like the python:</p>\n\n<pre><code>np.concatenate([x,y,z], axis=1)\n</code></pre>\n\n<p>I tried the below code but it concatenates along the row.</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; dest{{1,2,3,4,5}};\nstd::vector&lt;std::vector&lt;int&gt;&gt; src{{6,7,8,9,10}};\n\ndest.insert(\n  dest.end(),\n  src.begin(),\n  src.end()\n);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10\n</code></pre>\n\n<p>But I am expecting it be like the below:</p>\n\n<pre><code>1 6\n2 7\n3 8\n4 9\n5 10\n</code></pre>\n\n<p>Is there a workaround to do the concatenation along the column as above python <code>np.concatenate</code> function?\nI am trying to visualize the data so I need to transpose all the vectors and concatenate along the column.</p>\n"}, {"tags": ["c++", "c++17", "stdtuple"], "comments": [{"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1548860753, "post_id": 54443510, "comment_id": 95696324, "body": "<code>The variable arg1 is already the enum</code> Not clear. Why is it the problem?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1548861191, "post_id": 54443510, "comment_id": 95696614, "body": "@balki - enumeration identifiers are members of the scope the <code>enum</code> is in (not <code>enum class</code>). So that can cause clashes unless one introduces some sort of scoping."}, {"owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "edited": false, "score": 0, "creation_date": 1548863651, "post_id": 54443510, "comment_id": 95698219, "body": "balki: The above names are only examples. In the real project there are several variables which has nearly the same name."}], "answers": [{"tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": false, "score": 1, "last_activity_date": 1548860810, "creation_date": 1548860810, "answer_id": 54443620, "question_id": 54443510, "link": "https://stackoverflow.com/questions/54443510/stdget0-and-enum-index/54443620#54443620", "title": "std::get&lt;0&gt;(...) and enum index", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/utility/tuple/get\" rel=\"nofollow noreferrer\"><code>std::get</code></a>'s index template parameter is of type <code>std::size_t</code>. A scoped enumeration is not implicitly convertible to its underlying type. So if you insist on using one, you must cast it.</p>\n\n<pre><code>auto arg1 = std::get&lt;static_cast&lt;int&gt;(tpl::arg1)&gt;(key);\n</code></pre>\n\n<p>If you want to avoid mentioning the underlying type in the cast</p>\n\n<pre><code>auto arg1 = std::get&lt;static_cast&lt;std::underlying_type_t&lt;tpl&gt;&gt;(tpl::arg1)&gt;(key);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "edited": false, "score": 0, "creation_date": 1548862250, "post_id": 54443628, "comment_id": 95697382, "body": "Thank you for the solution."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1548861235, "last_edit_date": 1548861235, "creation_date": 1548860832, "answer_id": 54443628, "question_id": 54443510, "link": "https://stackoverflow.com/questions/54443510/stdget0-and-enum-index/54443628#54443628", "title": "std::get&lt;0&gt;(...) and enum index", "body": "<p>A scoped enumeration (<code>enum class</code>) doesn't have an implicit conversion to integers of any sort. Since <code>std::get</code> expects a template parameter of an integral type, such a conversion must happen.</p>\n\n<p>But it cannot, therefore no overload matches the supplied template argument.</p>\n\n<p>You can use a \"scoped enum\" hack one resorted to prior to C++11:</p>\n\n<pre><code>struct tpl {\n  enum : int {\n    arg1 = 0, arg2 = 1, arg3 = 2\n  };\n};\n</code></pre>\n\n<p>This makes the identifiers scoped, but retains the implicit conversions. C++11 scoped enums were introduced because usually the implicit conversion is not a desired feature, but in this case I daresay it is.</p>\n"}, {"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548861329, "post_id": 54443671, "comment_id": 95696723, "body": "mmm... so <code>using namespace tpl;</code> allows for a shorthand when its possible. I like it, so have an uppy."}, {"owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548861466, "post_id": 54443671, "comment_id": 95696821, "body": "@StoryTeller Thx! Kind of a poor man&#39;s version of <a href=\"https://atomgalaxy.github.io/using-enum/using-enum.html\" rel=\"nofollow noreferrer\">P1099</a> :)"}, {"owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "edited": false, "score": 0, "creation_date": 1548861838, "post_id": 54443671, "comment_id": 95697082, "body": "Yes, you are wright, I could switch to struct but tuples has some things in it. In the life-cycle of the project it can be that I switch. Thx for the soultion with namespace!"}], "tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": false, "score": 2, "last_activity_date": 1548860976, "creation_date": 1548860976, "answer_id": 54443671, "question_id": 54443510, "link": "https://stackoverflow.com/questions/54443510/stdget0-and-enum-index/54443671#54443671", "title": "std::get&lt;0&gt;(...) and enum index", "body": "<p>The issue is that scoped enums aren't implicitly converted to their underlying type. You can manually do that by</p>\n\n<pre><code>std::get&lt;static_cast&lt;std::underlying_type_t&lt;tpl&gt;&gt;(tpl::arg1)&gt;(key);\n</code></pre>\n\n<p>but as your attempt is to increase the readability, this doesn't qualify as a good solution. Instead, consider this option:</p>\n\n<pre><code>namespace tpl {\n   enum { arg1 = 0, arg2 = 1, arg3 = 2 };\n}\n\nstd::get&lt;tpl::arg1&gt;(key);\n</code></pre>\n\n<p>It doesn't come with the same type safety implication as the strongly type enum, but it allows for the syntactic call you had in mind.</p>\n\n<p>As a side note, once you are concerned about the readability implications of using <code>std::tuple</code> objects, you might want to switch to a trivial <code>struct</code> instead.</p>\n"}], "owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 54443628, "answer_count": 3, "score": 2, "last_activity_date": 1548861235, "creation_date": 1548860409, "last_edit_date": 1548860685, "question_id": 54443510, "link": "https://stackoverflow.com/questions/54443510/stdget0-and-enum-index", "title": "std::get&lt;0&gt;(...) and enum index", "body": "<p>To make the code more readable I did the following with <code>tuple</code>: </p>\n\n<pre><code>std::tuple&lt;uint32_t, uint32_t, uint32_t&gt; key;\n\nenum  tpl {\n    arg1 = 0, arg2 = 1, arg3 = 2\n};\n</code></pre>\n\n<p>Now I can write:</p>\n\n<pre><code> auto _arg1 = std::get&lt;tpl::arg1&gt;(key);\n</code></pre>\n\n<p>I come to a problem now. If I write:</p>\n\n<pre><code>auto arg1 = std::get&lt;tpl::arg1&gt;(key);\n</code></pre>\n\n<p>The variable <code>arg1</code> is already the enum. Therefore I want to switch to:</p>\n\n<pre><code>enum class tpl: int {\n    arg1 = 0, arg2 = 1, arg3 = 2\n};\n</code></pre>\n\n<p>But something is wrong here. The compiler says:</p>\n\n<blockquote>\n  <p>error C2672: 'std::get': no matching overloaded function found</p>\n</blockquote>\n\n<p>What type is this index in <code>std::get</code> and can this be named at the definition of the enum class?</p>\n\n<p>I tried </p>\n\n<pre><code>const constexpr\nconst int \n....\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1548860404, "post_id": 54443461, "comment_id": 95696093, "body": "Might have something to do with the fact that <code>std::string</code> <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/replace\" rel=\"nofollow noreferrer\">has no overload</a> of <code>replace</code> that accepts two characters. Unless of course you aren&#39;t using <code>std::string</code>, in which case you need to provide one hella better <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 919, "user_id": 2832208, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001534915386/picture?type=large", "display_name": "Miko\u0142aj Mularczyk", "link": "https://stackoverflow.com/users/2832208/miko%c5%82aj-mularczyk"}, "edited": false, "score": 1, "creation_date": 1548860434, "post_id": 54443461, "comment_id": 95696116, "body": "<a href=\"http://www.cplusplus.com/reference/string/string/replace/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/string/string/replace</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1548861330, "post_id": 54443461, "comment_id": 95696726, "body": "This one has tripped me up more than once, as it doesn&#39;t do the same thing as <a href=\"https://en.cppreference.com/w/cpp/algorithm/replace\" rel=\"nofollow noreferrer\"><code>std::replace</code></a> at all. (One thing I&#39;ve learned is to always be cautious around <code>std::string</code> and assume that my assumptions are probably wrong.)"}], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1548860594, "creation_date": 1548860594, "answer_id": 54443565, "question_id": 54443461, "link": "https://stackoverflow.com/questions/54443461/replacing-with-in-c/54443565#54443565", "title": "Replacing &#39;(&#39; with &#39;-&#39; in C++", "body": "<p>If you look at e.g. <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/replace\" rel=\"nofollow noreferrer\">this <code>std::string::replace</code> reference</a> you will see that there's no overload that takes the arguments you pass. Something the compiler really should warn you about.</p>\n\n<p>The closes one is number 6:</p>\n\n<pre><code>basic_string&amp; replace( const_iterator first, const_iterator last,\n                       size_type count2, CharT ch );\n</code></pre>\n\n<p>which replaces the range with <code>count2</code> copies of <code>ch</code>.</p>\n\n<p>That is, you replace your string with <code>'('</code> number of dashes. With <a href=\"https://en.cppreference.com/w/cpp/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> that <code>'('</code> will be converted to the integer <code>40</code> (it's this conversion the compiler should have warned you about).</p>\n\n<p>One solution is to repeatedly <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/find\" rel=\"nofollow noreferrer\"><code>find</code></a> the character you want to replace, and replace only that single character.</p>\n\n<p>A much simpler solution is to use the <a href=\"https://en.cppreference.com/w/cpp/algorithm\" rel=\"nofollow noreferrer\">standard algorithm</a> function <a href=\"https://en.cppreference.com/w/cpp/algorithm/replace\" rel=\"nofollow noreferrer\"><code>std::replace</code></a>:</p>\n\n<pre><code>std::replace(begin(versionString), end(versionString), '(', '-');\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3718370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e8fad5c266e0915ac2a75f429244c2e?s=128&d=identicon&r=PG&f=1", "display_name": "exigez", "link": "https://stackoverflow.com/users/3718370/exigez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1548860912, "accepted_answer_id": 54443565, "answer_count": 1, "score": -2, "last_activity_date": 1548860594, "creation_date": 1548860274, "question_id": 54443461, "link": "https://stackoverflow.com/questions/54443461/replacing-with-in-c", "closed_reason": "Duplicate", "title": "Replacing &#39;(&#39; with &#39;-&#39; in C++", "body": "<p>I've tried:</p>\n\n<pre><code>versionString = versionString.replace(versionString.begin(), versionString.end(), '(' , '-' );\n</code></pre>\n\n<p>The result is: \"--------------\". Basically replacing all the characters. What is that?</p>\n\n<p>versionString is a basic string.</p>\n"}, {"tags": ["c++", "qt", "qgraphicsview", "qgraphicsscene", "qgraphicsitem"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 1, "creation_date": 1548860706, "post_id": 54443445, "comment_id": 95696296, "body": "I&#39;m not entirely sure I know what you mean but... you could try setting the <a href=\"http://doc.qt.io/qt-5/qgraphicsview.html#alignment-prop\" rel=\"nofollow noreferrer\">alignment property</a> of the <code>QGraphicsView</code>."}, {"owner": {"reputation": 629, "user_id": 8124507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f4c546e2ba73af5048a059d424cbd4c?s=128&d=identicon&r=PG&f=1", "display_name": "bluedragon", "link": "https://stackoverflow.com/users/8124507/bluedragon"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1548860907, "post_id": 54443445, "comment_id": 95696439, "body": "thanks... that worked"}], "owner": {"reputation": 629, "user_id": 8124507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f4c546e2ba73af5048a059d424cbd4c?s=128&d=identicon&r=PG&f=1", "display_name": "bluedragon", "link": "https://stackoverflow.com/users/8124507/bluedragon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548860217, "creation_date": 1548860217, "question_id": 54443445, "link": "https://stackoverflow.com/questions/54443445/qgraphicsview-show-items-from-edges", "title": "QGraphicsView show items from edges", "body": "<p>I am not able to draw from the edges using <code>QGraphicsView</code>  </p>\n\n<p>I am using following code</p>\n\n<pre><code>#include &lt;QApplication&gt;\n\n#include &lt;QGraphicsScene&gt;\n#include &lt;QGraphicsView&gt;\n\nint main(int argc, char *argv[]) {\n  QApplication a(argc, argv);\n  QMainWindow win;\n\n  QGraphicsScene scene;\n  scene.addRect(0, 0, 1000, 20, {}, Qt::red);\n\n  QGraphicsView view;\n  view.setScene(&amp;scene);\n\n  win.setCentralWidget(&amp;view);\n\n  win.show();\n\n  return a.exec();\n}\n</code></pre>\n\n<p>above draws rectangle in the center but i want rectangle and all other QGraphicsItems to draw from <code>win</code> 's edges, following regular window's gui coordinate system</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1548860346, "post_id": 54443395, "comment_id": 95696049, "body": "You were lucky (or unlucky). You should&#39;ve gotten a seg-fault."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1548860357, "post_id": 54443395, "comment_id": 95696062, "body": "By the time your array is defined (<code>int tom[rows][coloumns];</code>), the values of <code>rows</code> and <code>coloumns</code> aren&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "edited": false, "score": 0, "creation_date": 1548860904, "post_id": 54443505, "comment_id": 95696435, "body": "Thanks for the answer.  **Your Words: **<i>You can&#39;t dynamically create an array like this. This shouldn&#39;t even compile. And even if it did, you are creating the array before letting the user input the dimension.</i> made my program. I just put the array <code>tom[rows][coloumns]</code> after the <code>cin &gt;&gt; coloumns;</code> and now it is working fine."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "edited": false, "score": 0, "creation_date": 1548861189, "post_id": 54443505, "comment_id": 95696612, "body": "@AbdulRaheem what compiler are you using? this shouldn&#39;t really work unless there are some hidden _alloca() sort of hings going on."}, {"owner": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "edited": false, "score": 0, "creation_date": 1548861309, "post_id": 54443505, "comment_id": 95696706, "body": "Actually I&#39;m at school level and I&#39;m using dev cpp."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "edited": false, "score": 0, "creation_date": 1548861443, "post_id": 54443505, "comment_id": 95696803, "body": "@AbdulRaheem i am saying it, because normally this doesn&#39;t work. <code>tom</code> wants to be a fixed-size array, allocated on the stack. you can&#39;t dynamically allocate an array on the stack. <code>E0028\texpression must have a constant value</code> - you will have to make a dynamically allocated array - on the heap. this can be done with <code>int** tom</code> or with (the modern alternative) <code>std::vector&lt;std::vector&gt;&gt;</code>. Your code might work for now, but once you run it else-where it will fail. It&#39;s just not a good practise to be stuck with These dependencies. When you want to improve, it&#39;s best to stick with good practises."}, {"owner": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "edited": false, "score": 0, "creation_date": 1548861972, "post_id": 54443505, "comment_id": 95697179, "body": "Okay sir. I&#39;ll be carefull next time. \u263a"}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 1, "creation_date": 1548862076, "post_id": 54443505, "comment_id": 95697242, "body": "@StackDanny, <i>This shouldn&#39;t even compile.</i> --&gt; eh! surprise surprise. &quot;variable length arrays&quot; (VLAs) are not part of standard C++, yes that is true. They were in C99, however. I know, I know this question is marked C++. Both <code>gcc</code> and <code>clang</code> compilers have implemented compiler-extensions, that allow VLAs. I don&#39;t know what <code>dev-cpp</code> uses as a compiler under the hood, but probably it is <code>mingw a.k.a. gcc</code>."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1548862150, "post_id": 54443505, "comment_id": 95697297, "body": "@JoeyMallone yes I heard of that and I have used dev-cpp before but I never thought that it would allow something like that! thanks for the Information."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 1, "creation_date": 1548862201, "post_id": 54443505, "comment_id": 95697348, "body": "@StackDanny, I knew gcc had that extension. I didn&#39;t know that clang also has that extension. It was surprising for me also, when it compiled on my system with both compilers."}], "tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": false, "score": 2, "last_activity_date": 1560286241, "last_edit_date": 1560286241, "creation_date": 1548860380, "answer_id": 54443505, "question_id": 54443395, "link": "https://stackoverflow.com/questions/54443395/i-want-to-display-all-entries-of-2d-array-in-c/54443505#54443505", "title": "I want to display all entries of 2D array in c++", "body": "<p>You can't dynamically create an array like this. This shouldn't even compile. And even if it did, you are creating the array <em>before</em> letting the user input the dimension. For the proper Approach use <a href=\"https://www.google.de/search?q=std%3A%3Avector&amp;ie=&amp;oe=\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    int rows, columns;\n    std::cout &lt;&lt; \"Size of array rows: \";\n    std::cin &gt;&gt; rows;\n    std::cout &lt;&lt; \"Size of array columns: \";\n    std::cin &gt;&gt; columns;\n    std::vector&lt;std::vector&lt;int&gt;&gt; tom(rows, std::vector&lt;int&gt;(columns));\n\n    for (int count1 = 0; count1 &lt; rows; count1++)\n    {\n        for (int count2 = 0; count2 &lt; columns; count2++)\n        {\n            std::cout &lt;&lt; \"Enter entry of row \" &lt;&lt; count1 &lt;&lt; \" and column \" &lt;&lt; count2 &lt;&lt; \": \";\n            std::cin &gt;&gt; tom[count1][count2];\n        }\n    }\n    for (int i = 0; i &lt; rows; i++)\n    {\n        for (int j = 0; j &lt; columns; j++)\n        {\n            std::cout &lt;&lt; tom[i][j] &lt;&lt; std::endl;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Size of array rows: 2\nSize of array columns: 3\nEnter entry of row 0 and column 0: 1\nEnter entry of row 0 and column 1: 2\nEnter entry of row 0 and column 2: 3\nEnter entry of row 1 and column 0: 12\nEnter entry of row 1 and column 1: 13\nEnter entry of row 1 and column 2: 14\n1\n2\n3\n12\n13\n14\n</code></pre>\n\n<hr>\n\n<p>please don't use <code>using namespace std;</code> - read <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">here</a> why.</p>\n"}, {"comments": [{"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1548862031, "post_id": 54443646, "comment_id": 95697215, "body": "please just don&#39;t forget to <code>delete[]</code> the data afterwards."}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": false, "score": 0, "last_activity_date": 1560286182, "last_edit_date": 1560286182, "creation_date": 1548860908, "answer_id": 54443646, "question_id": 54443395, "link": "https://stackoverflow.com/questions/54443395/i-want-to-display-all-entries-of-2d-array-in-c/54443646#54443646", "title": "I want to display all entries of 2D array in c++", "body": "<p>You cannot declare an array like this:</p>\n\n<pre><code>    int tom[rows][columns];\n</code></pre>\n\n<p>since values of rows and columns are not known yet.</p>\n\n<p>Instead you should initialize this array dynamically after asking for values.\nHere is your code fixed:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    int rows, columns;\n    int **tom;\n    cout &lt;&lt; \"Size of array rows: \";\n    cin &gt;&gt; rows;\n    cout &lt;&lt; \"Size of array columns: \";\n    cin &gt;&gt; columns;\n\n    tom = new int*[rows];\n    for (int i = 0; i &lt; rows; i++) {\n      tom[i] = new int[columns];\n    }\n\n    for(int count1 = 0; count1 &lt; rows; count1++)\n    {\n        for(int count2 = 0; count2 &lt; columns; count2++)\n        {\n            cout &lt;&lt; \"Enter entry of row \" &lt;&lt; count1 &lt;&lt; \" and column \" &lt;&lt; count2 &lt;&lt; \": \";\n            cin &gt;&gt; tom[count1][count2];\n        }\n    }\n\n    for(int i = 0; i &lt; rows; i++)\n    {\n        for(int j = 0; j &lt; columns; j++)\n        {\n            cout &lt;&lt; tom[i][j] &lt;&lt; endl;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "edited": false, "score": 0, "creation_date": 1548861393, "post_id": 54443689, "comment_id": 95696761, "body": "but i used <code>cin</code> to get the number of rows and columns."}], "tags": [], "owner": {"reputation": 540, "user_id": 7865762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fP5Ub.png?s=128&g=1", "display_name": "heunetik", "link": "https://stackoverflow.com/users/7865762/heunetik"}, "is_accepted": false, "score": 1, "last_activity_date": 1548861049, "creation_date": 1548861049, "answer_id": 54443689, "question_id": 54443395, "link": "https://stackoverflow.com/questions/54443395/i-want-to-display-all-entries-of-2d-array-in-c/54443689#54443689", "title": "I want to display all entries of 2D array in c++", "body": "<p>You initialized <code>tom</code> before actually getting the number of rows/columns.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    int rows, columns;\n    std::cout &lt;&lt; \"Rows: \";\n    std::cin &gt;&gt; rows;\n    std::cout &lt;&lt; \"Columns: \";\n    std::cin &gt;&gt; columns;\n    int arr[rows][columns];\n\n    for(int i = 0; i &lt; rows; i++)\n    {\n        for(int j = 0; j &lt; columns; j++)\n        {\n            std::cout &lt;&lt; \"Enter the value for [\" &lt;&lt; i &lt;&lt; \"][\" &lt;&lt; j &lt;&lt; \"] : \";\n            std::cin &gt;&gt; arr[i][j];\n        }\n    }\n\n    for(int i = 0; i &lt; rows; i++)\n    {\n        for(int j = 0; j &lt; columns; j++)\n        {\n            std::cout &lt;&lt; arr[i][j] &lt;&lt; \" \";\n        }\n        std::cout &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10990928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BJShWCRmTJM/AAAAAAAAAAI/AAAAAAAAAQw/IlXSgBSsYS0/photo.jpg?sz=128", "display_name": "Abdul Raheem", "link": "https://stackoverflow.com/users/10990928/abdul-raheem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1560286241, "creation_date": 1548860076, "last_edit_date": 1560286212, "question_id": 54443395, "link": "https://stackoverflow.com/questions/54443395/i-want-to-display-all-entries-of-2d-array-in-c", "title": "I want to display all entries of 2D array in c++", "body": "<p>I want to create a program that take size of rows and columns of 2D array from user, and then take all entries of array from user. And Finally display all the entries from array[0][0] to array[size][size].</p>\n\n<p>My code is:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n    int rows, columns;\n    int tom[rows][columns];\n    cout &lt;&lt; \"Size of array rows: \";\n    cin &gt;&gt; rows;\n    cout &lt;&lt; \"Size of array columns: \";\n    cin &gt;&gt; columns;\n\n    for(int count1 = 0; count1 &lt; rows; count1++)\n    {\n        for(int count2 = 0; count2 &lt; columns; count2++)\n        {\n            cout &lt;&lt; \"Enter entry of row \" &lt;&lt; count1 &lt;&lt; \" and column \" &lt;&lt; count2 &lt;&lt; \": \";\n            cin &gt;&gt; tom[count1][count2];\n        }\n    }\n    for(int i = 0; i &lt; rows; i++)\n    {\n        for(int j = 0; j &lt; columns; j++)\n        {\n            cout &lt;&lt; tom[i][j] &lt;&lt; endl;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output is: </p>\n\n<pre><code>Size of array rows: 2\nSize of array columns: 3\nEnter entry of row 0 and column 0: 1\nEnter entry of row 0 and column 1: 2\nEnter entry of row 0 and column 2: 3\nEnter entry of row 1 and column 0: 12\nEnter entry of row 1 and column 1: 13\nEnter entry of row 1 and column 2: 14\n12\n13\n14\n12\n13\n14\n</code></pre>\n\n<p>It should give output:</p>\n\n<pre><code>1\n2\n3\n12\n13\n14\n</code></pre>\n\n<p>What is the problem?\nPlease help.</p>\n"}, {"tags": ["c++", "perf"], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "edited": false, "score": 0, "creation_date": 1548878822, "post_id": 54445333, "comment_id": 95706203, "body": "According to the manual, I have to set parameters of a perf_event_attr structure, then open a file descriptor with perf_event_open, then keep reading from it via read. Say that my aim is to get the call stack of a hung process, which event types should I subscribe to and how would I parse the data from read?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "edited": false, "score": 0, "creation_date": 1548882694, "post_id": 54445333, "comment_id": 95707936, "body": "You can read or you can <code>mmap</code>. For getting call stacks you set something like        <code>attr.sample_type = PERF_SAMPLE_IP | PERF_SAMPLE_TID | PERF_SAMPLE_TIME | PERF_SAMPLE_CPU | PERF_SAMPLE_CALLCHAIN</code>. You can use, for example, <code>PERF_TYPE_HARDWARE</code> // <code>PERF_COUNT_HW_CPU_CYCLES</code>."}, {"owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "edited": false, "score": 0, "creation_date": 1548891466, "post_id": 54445333, "comment_id": 95710870, "body": "And how many events will PERF_COUNT_HW_CPU_CYCLES generate? Every time the CPU does something? Would it be cheaper to sample process scheduling events?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "edited": false, "score": 1, "creation_date": 1548923261, "post_id": 54445333, "comment_id": 95720540, "body": "The recording rate is decided by setting either <code>attr.sample_period</code>   or <code>attr.sample_freq</code> and <code>attr.freq</code> accordingly. The man page has all the details."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "edited": false, "score": 0, "creation_date": 1548923321, "post_id": 54445333, "comment_id": 95720576, "body": "Note: This is quite a complex endeavor and I&#39;m not able to put a full tutorial in the answer, but I&#39;m happy to answer further specific questions."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 1, "last_activity_date": 1548866216, "creation_date": 1548866216, "answer_id": 54445333, "question_id": 54443345, "link": "https://stackoverflow.com/questions/54443345/how-does-perf-sample-kernel-stacks/54445333#54445333", "title": "How does perf sample kernel stacks?", "body": "<p><code>perf</code> consists of two parts. The userspace tools, and the <code>perf_event_open</code> syscall.</p>\n\n<p>Generally, the stack sampling is done by the kernel through the syscall. You can write an application with also uses <a href=\"http://man7.org/linux/man-pages/man2/perf_event_open.2.html\" rel=\"nofollow noreferrer\"><code>perf_event_open</code></a> - by default kernel samples are included (<code>exclude_kernel==0</code>).</p>\n"}], "owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54445333, "answer_count": 1, "score": 0, "last_activity_date": 1548866216, "creation_date": 1548859935, "question_id": 54443345, "link": "https://stackoverflow.com/questions/54443345/how-does-perf-sample-kernel-stacks", "title": "How does perf sample kernel stacks?", "body": "<p>As far as I know perf is able to sample a full callstack for every process/thread even if it currently is inside the kernel. Since perf is running in userspace I assume, I want to know how it gets access to the kernel part of the stack of a different process/thread.</p>\n\n<p>The purpose is to write an application that can sample callstacks of other processes/threads even if they currently are in kernel.</p>\n\n<p>Regards</p>\n"}, {"tags": ["c++", "qt", "qt5"], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 4861450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bc3b882d7bd23c0a8a4d47a2c3916b?s=128&d=identicon&r=PG&f=1", "display_name": "Hoehli", "link": "https://stackoverflow.com/users/4861450/hoehli"}, "edited": false, "score": 0, "creation_date": 1549009811, "post_id": 54444667, "comment_id": 95758342, "body": "Thanks for this hint, under normal circumstances this would be the solution. Sadly I have to fill the QTableWidget in a QThread, and it is not possible to set a Widget to a cell inside a thred wich is not part of the gui :("}], "tags": [], "owner": {"reputation": 1638, "user_id": 1037293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycPs2.jpg?s=128&g=1", "display_name": "Andrii", "link": "https://stackoverflow.com/users/1037293/andrii"}, "is_accepted": false, "score": 1, "last_activity_date": 1548864147, "creation_date": 1548864147, "answer_id": 54444667, "question_id": 54443311, "link": "https://stackoverflow.com/questions/54443311/displaying-different-colored-string-in-one-qtablewidget-cell/54444667#54444667", "title": "Displaying different colored string in one QTableWidget cell", "body": "<p>You may use <a href=\"http://doc.qt.io/qt-5/qtablewidget.html#setCellWidget\" rel=\"nofollow noreferrer\">QTableWidget::setCellWidget</a> method to set <a href=\"http://doc.qt.io/qt-5/qtextedit.html\" rel=\"nofollow noreferrer\">QTextEdit</a> as a cell widget wich supports <code>html</code> formatting. </p>\n"}], "owner": {"reputation": 114, "user_id": 4861450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bc3b882d7bd23c0a8a4d47a2c3916b?s=128&d=identicon&r=PG&f=1", "display_name": "Hoehli", "link": "https://stackoverflow.com/users/4861450/hoehli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548864147, "creation_date": 1548859829, "question_id": 54443311, "link": "https://stackoverflow.com/questions/54443311/displaying-different-colored-string-in-one-qtablewidget-cell", "title": "Displaying different colored string in one QTableWidget cell", "body": "<p>i have a QTableWidget with a specific cell structure. In one cell I want to display a String, ore more specific two strings in different colors. excample: </p>\n\n<p>cell beginning {string in red , string in green, string in blue} cell end</p>\n\n<p>Is there a easier way of archiving this, than subclassing a QItemDeelegate item?\nIf not, my idea was to subclass a delegate, creating inside the delegate a QTextBrowser, wich can handle HTML. Then I can pass the String with the associated color to the Item and display them?</p>\n\n<p>What do you think, is there an easier way? </p>\n\n<p>Best</p>\n"}, {"tags": ["c++", "hash", "botan"], "answers": [{"tags": [], "owner": {"reputation": 3267, "user_id": 10992173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e89f4e8e1572a941554283f29a908620?s=128&d=identicon&r=PG&f=1", "display_name": "f9c69e9781fa194211448473495534", "link": "https://stackoverflow.com/users/10992173/f9c69e9781fa194211448473495534"}, "is_accepted": false, "score": 1, "last_activity_date": 1549136327, "creation_date": 1549136327, "answer_id": 54496816, "question_id": 54443281, "link": "https://stackoverflow.com/questions/54443281/crash-when-generating-blake2b-hash/54496816#54496816", "title": "Crash when generating blake2b hash", "body": "<p>The issue likely is the capitalization of the name. I'm using Botan 2.9.0 and \"Blake2b\" works, whereas \"BLAKE2b\" crashes. The master branch of Botan also accepts \"BLAKE2b\", but this was only added <a href=\"https://github.com/randombit/botan/commit/9cc1d65a35d150ec780dbc6c780dd0dec5fe328c\" rel=\"nofollow noreferrer\">recently</a>. The default output length is set to 512 bits, you can adapt it by passing e.g. \"Blake2b(256)\" or by calling the Blake2b constructor directly (as in the linked commit).</p>\n\n<p>Small working example (main.cpp):</p>\n\n<pre><code>\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n\n#include \"botan/hash.h\"\n#include \"botan/hex.h\"\n\nstd::string hex_hash(const std::string&amp; in, const std::string&amp; HASH) {\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(HASH));\n    return Botan::hex_encode(hash-&gt;process(in));\n}\n\nint main(int argc, char** argv) {\n    std::cout &lt;&lt; \"Blake2b \" &lt;&lt; hex_hash(\"abc\", \"Blake2b\") &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Blake2b(256) \" &lt;&lt; hex_hash(\"abc\", \"Blake2b(256)\") &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<pre><code>$ g++ `pkgconf --cflags --libs botan-2` main.cpp &amp;&amp; ./a.out \nBlake2b BA80A53F981C4D0D6A2797B69F12F6E94C212F14685AC4B74B12BB6FDBFFA2D17D87C5392AAB792DC252D5DE4533CC9518D38AA8DBF1925AB92386EDD4009923\nBlake2b(256) BDDD813C634239723171EF3FEE98579B94964E3BB1CB3E427262C8C068D52319\n</code></pre>\n\n<p>If this does not work for you, also ensure your Botan is compiled with Blake2b support, e.g.</p>\n\n<pre><code>$ grep BLAKE /usr/include/botan-2/botan/build.h \n#define BOTAN_HAS_BLAKE2B 20130131\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10990829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11942182ddfc477d87d4f12b6ffe6b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/10990829/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549136327, "creation_date": 1548859757, "last_edit_date": 1592644375, "question_id": 54443281, "link": "https://stackoverflow.com/questions/54443281/crash-when-generating-blake2b-hash", "title": "Crash when generating blake2b hash", "body": "<p>I'm trying to write a hash function with Botan as my back end that is:</p>\n<pre><code>std::string hex_hash(std::string &amp;in, const std::string &amp;HASH)\n{\nstd::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(HASH));\n\nreturn Botan::hex_encode(hash-&gt;process(in));\n}\n</code></pre>\n<p><code>HASH</code> is a <code>std::string</code> that is the name of the hash requested. i.e. <code>&quot;SHA-512&quot;</code> for SHA512 and <code>&quot;BLAKE2b&quot;</code> for BLAKE2b</p>\n<p>Any other hash supported by botan gets processed and outputted, but BLAKE2b doesn't and throws an exception:</p>\n<pre><code>Exception thrown at 0x00007FF661382C5A in test.exe: 0xC0000005: Access violation reading location 0x0000000000000000.\n</code></pre>\n<p>And then crashes.</p>\n<p>I did notice in the manual for botan (<a href=\"https://botan.randombit.net/manual/hash.html\" rel=\"nofollow noreferrer\">https://botan.randombit.net/manual/hash.html</a>) that</p>\n<blockquote>\n<p>BLAKE2b</p>\n<p>Available if BOTAN_HAS_BLAKE2B is defined.</p>\n<p>A recently designed hash function. Very fast on 64-bit processors. Can output a hash of any length between 1 and 64 bytes, <strong>this is specified by passing a value to the constructor with the desired length.</strong></p>\n</blockquote>\n<p>Is it possible that there is no default set? How would I set it? Is it possible I have the wrong name?</p>\n"}, {"tags": ["c++", "visual-studio", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 289239, "user_id": 704848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9be2c2958e208c8d9b629ac43c9c42?s=128&d=identicon&r=PG", "display_name": "EdChum", "link": "https://stackoverflow.com/users/704848/edchum"}, "edited": false, "score": 2, "creation_date": 1548859855, "post_id": 54443279, "comment_id": 95695688, "body": "you need to escape the backslashes: <code>&quot;C:\\\\Users\\\\deep\\\\Documents\\\\Visual Studio       2017\\\\Backup Files\\\\de2\\\\image.png&quot;</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1548860136, "post_id": 54443279, "comment_id": 95695891, "body": "Or use forward slashes."}], "owner": {"reputation": 25, "user_id": 10114862, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B1EkQNlfdOE/AAAAAAAAAAI/AAAAAAAAAOA/GJRmPZc9RQI/photo.jpg?sz=128", "display_name": "Deep tank", "link": "https://stackoverflow.com/users/10114862/deep-tank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549952539, "creation_date": 1548859748, "last_edit_date": 1548873738, "question_id": 54443279, "link": "https://stackoverflow.com/questions/54443279/difficulty-reading-an-image", "title": "Difficulty reading an image", "body": "<p>I'm taking a image from my pc and trying to get the edges of the picture using canny method.\nHowever, it is always showing the message that the image is not read though my path correctly.\nI'm using visual studio for the same.</p>\n\n<pre><code> #include&lt;opencv2/opencv.hpp&gt;\n #include&lt;iostream&gt;\n #include&lt;conio.h&gt;\n using namespace cv;\n using namespace std;\n int main()\n {\ncv::Mat imgOriginal;        \ncv::Mat imgGrayscale;       \ncv::Mat imgBlurred;         \ncv::Mat imgCanny;          \n\n imgOriginal = cv::imread(\"C:\\Users\\deep\\Documents\\Visual Studio \n     2017\\Backup Files\\de2\\image.png\",IMREAD_ANYCOLOR | IMREAD_ANYDEPTH);          \n      // open image\n\n if (imgOriginal.empty()) {                                          \n       std::cout &lt;&lt; \"error: image not read from file\\n\\n\";     \n    _getch();                               \n    return(0);                              \n}\n\ncv::cvtColor(imgOriginal, imgGrayscale, CV_BGR2GRAY);     \n\ncv::GaussianBlur(imgGrayscale,imgBlurred,cv::Size(5, 5),                \n    1.5);                             \n\ncv::Canny(imgBlurred,         \n    imgCanny,             \n    82,                         \n    164);                       \n\n\ncv::namedWindow(\"imgOriginal\", CV_WINDOW_AUTOSIZE);  \ncv::namedWindow(\"imgCanny\", CV_WINDOW_AUTOSIZE);     \ncv::imshow(\"imgOriginal\", imgOriginal);     \ncv::imshow(\"imgCanny\", imgCanny);\n\ncv::waitKey(0);                \n\nreturn(0);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "qt-creator", "implicit-conversion"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1548859464, "post_id": 54442950, "comment_id": 95695402, "body": "Notice that your original little tweaks to the code actually masked the error. That&#39;s what presenting a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> <i>from the start</i> avoids."}, {"owner": {"reputation": 3433, "user_id": 720934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z1OSE.jpg?s=128&g=1", "display_name": "hoodaticus", "link": "https://stackoverflow.com/users/720934/hoodaticus"}, "edited": false, "score": 0, "creation_date": 1548859630, "post_id": 54442950, "comment_id": 95695512, "body": "Hi Justina.  You can make the strategic decision to ignore these warnings in projects where it doesn&#39;t matter.  If your string will always be below 2GB then you should be fine to just ignore it.  The correct way to handle this is to use an explicit conversion, for instance you could do (unsigned int)start instead.  Then there&#39;s no implicit conversion."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 6, "last_activity_date": 1548859249, "creation_date": 1548859249, "answer_id": 54443114, "question_id": 54442950, "link": "https://stackoverflow.com/questions/54442950/how-to-fix-c-warning-of-implicit-conversion/54443114#54443114", "title": "How to fix C++ warning of implicit conversion?", "body": "<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"noreferrer\">This warning is triggered by the <code>-Wsign-conversion</code> switch</a>, detecting that you're taking a signed variable and converting it to an unsigned variable, in a way that may change the value.</p>\n\n<p>It doesn't do it for positive literals, where the conversion obviously doesn't change the value, because that would be pointless and really annoying. You'll get it for a negative literal like <code>-5</code>.</p>\n\n<p><em>(Technically, this is the literal <code>5</code> with the unary negation operator applied, not a \"negative literal\"!).</em></p>\n\n<p>For named variables it can't really predict what the value would be, so errs on the side of caution.</p>\n\n<p><strong>You should make your variable <code>start</code> have type <code>size_t</code>.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 7, "last_activity_date": 1548860085, "creation_date": 1548860085, "answer_id": 54443397, "question_id": 54442950, "link": "https://stackoverflow.com/questions/54442950/how-to-fix-c-warning-of-implicit-conversion/54443397#54443397", "title": "How to fix C++ warning of implicit conversion?", "body": "<p>You can:</p>\n\n<p>Either 1. make the conversion explicit:</p>\n\n<pre><code>str.substr(static_cast&lt;std::string::size_type&gt;(start), 3)\n</code></pre>\n\n<p>Or 2. not make a conversion in the first place:</p>\n\n<pre><code>std::string::size_type start;\n</code></pre>\n\n<p>Or 3. ask compiler to not warn about it:</p>\n\n<pre><code>g++ compilation arguments -Wno-sign-conversion\n</code></pre>\n\n<p>I recommend option 2.</p>\n"}], "owner": {"reputation": 179, "user_id": 10990812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8TEkPXbIl-I/AAAAAAAAAAI/AAAAAAAACA0/8EqDkyQvoNs/photo.jpg?sz=128", "display_name": "Tina", "link": "https://stackoverflow.com/users/10990812/tina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3396, "favorite_count": 0, "accepted_answer_id": 54443114, "answer_count": 2, "score": 4, "last_activity_date": 1548860085, "creation_date": 1548858776, "last_edit_date": 1548859025, "question_id": 54442950, "link": "https://stackoverflow.com/questions/54442950/how-to-fix-c-warning-of-implicit-conversion", "title": "How to fix C++ warning of implicit conversion?", "body": "<p>I am just getting started in C++.</p>\n\n<p>I am trying to get the first three characters of the string 'str', and compare it to a known string, say, 'knownString'.</p>\n\n<p>To do that, I wrote this line of code:</p>\n\n<blockquote>\n  <p>if (str.substr(start, 3) == knownString)</p>\n</blockquote>\n\n<p>where 'start' is an integer I declared before.\nBut I keep getting this warning message: </p>\n\n<blockquote>\n  <p><strong>warning: implicit conversion changes signedness: 'int' to</strong>\n  <strong>'std::__cxx11::basic_string,**\n  **std::allocator >::size_type' (aka 'unsigned int')</strong></p>\n</blockquote>\n\n<p>Does anyone knows what I can add or I missed in this statement to fix this?</p>\n"}, {"tags": ["c++", "winapi", "readprocessmemory"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1548859236, "post_id": 54442856, "comment_id": 95695258, "body": "Do some debugging. Is the issue in the code that reads from the other process, or the code that saves the text to a file. Once you know the answer to that, keep debugging to narrow it down further. SO is not meant to be a substitute for debugging."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1548859742, "post_id": 54442856, "comment_id": 95695598, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2380307/why-does-my-stdwofstream-write-ansi\">Why does my std::wofstream write ansi?</a>"}, {"owner": {"reputation": 33, "user_id": 8373545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0mlh0.jpg?s=128&g=1", "display_name": "Shiroe", "link": "https://stackoverflow.com/users/8373545/shiroe"}, "edited": false, "score": 0, "creation_date": 1548859855, "post_id": 54442856, "comment_id": 95695687, "body": "I did, and i reached limit of my knowledge on this. That&#39;s why i posted a question."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1548860444, "post_id": 54442856, "comment_id": 95696122, "body": "What you need to do is learn to use the debugger. Getting us to tell you the answer won&#39;t help you next time you are stuck. Are you going to ask a question every time you get stuck, or are you going to learn to use a debugger? Using a debugger you can convince yourself that the string is being read correctly from the other process, or not. If not then the error lies in that code. Or, if it is read correctly, the error lies in the code that outputs to the file. So, you tell me, which is it?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1548861176, "post_id": 54442856, "comment_id": 95696605, "body": "<code>std::wstring out</code> can&#39;t be used like that. <code>(LPVOID)&amp;out</code> is wrong usage. <code>sizeof(out)</code> is always 4 or 8.  Use instead <code>wchar_t buf[1000]; ReadProcessMemory(hProc, (LPCVOID)addr, buf, sizeof(buf), NULL);</code> (I am not sure if there are other errors) - Use <code>OutputDebugStringW(buf)</code> to view the result."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1548880369, "post_id": 54446440, "comment_id": 95706873, "body": "@DavidHeffernan only if you preallocate its memory buffer beforehand. I updated my answer to show that"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1548882789, "post_id": 54446440, "comment_id": 95707984, "body": "Obviously you need to allocate a buffer before writing to it."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1548885063, "last_edit_date": 1548885063, "creation_date": 1548870005, "answer_id": 54446440, "question_id": 54442856, "link": "https://stackoverflow.com/questions/54442856/how-to-read-unicode-string-from-process-in-windows/54446440#54446440", "title": "How to read Unicode string from process in Windows?", "body": "<p>You can't read directly into the <code>wstring</code> the way you are doing. That will overwrite it's internal data members and corrupt surrounding memory, which would be very bad.</p>\n\n<p>You are allocating a local buffer, but you are not using it for anything.  Use it, eg:</p>\n\n<pre><code>bool ReadWideString(HANDLE hProc, std::uintptr_t addr, std::wstring&amp; out) {\n    std::array&lt;wchar_t, maxStringLength&gt; outStr;\n    SIZE_T numRead = 0;\n    if (!ReadProcessMemory(hProc, reinterpret_cast&lt;LPVOID&gt;(addr), &amp;outStr, sizeof(outStr), &amp;numRead))\n        return false;\n    out.assign(outStr.data(), numRead / sizeof(wchar_t));\n    return true;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>std::wstring name;\nif (ReadWideString(OpenedProcessHandle, address, name)) {\n    std::ofstream test(\"test.txt\", std::ios::binary);\n    wchar_t bom = 0xFEFF;\n    test.write(reinterpret_cast&lt;char*&gt;(&amp;bom), sizeof(bom));\n    test.write(reinterpret_cast&lt;const char*&gt;(name.c_str()), name.size() * sizeof(wchar_t));\n}\n</code></pre>\n\n<p>Alternatively, get rid of the local buffer and preallocate the <code>wstring</code>'s memory buffer instead, then you can read directly into it, eg:</p>\n\n<pre><code>bool ReadWideString(HANDLE hProc, std::uintptr_t addr, std::wstring&amp; out) {\n    out.resize(maxStringLength);\n    SIZE_T numRead = 0;\n    if (!ReadProcessMemory(hProc, reinterpret_cast&lt;LPVOID&gt;(addr), &amp;out[0], maxStringLength * sizeof(wchar_t), &amp;numRead)) {\n        out.clear();\n        return false;\n    }\n    out.resize(numRead / sizeof(wchar_t));\n    return true;\n}\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>bool ReadWideString(HANDLE hProc, std::uintptr_t addr, std::wstring&amp; out) {\n    std::wstring outStr;\n    outStr.resize(maxStringLength);\n    SIZE_T numRead = 0;\n    if (!ReadProcessMemory(hProc, reinterpret_cast&lt;LPVOID&gt;(addr), &amp;outStr[0], maxStringLength * sizeof(wchar_t), &amp;numRead))\n        return false;\n    outStr.resize(numRead / sizeof(wchar_t));\n    out = std::move(outStr);\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8373545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0mlh0.jpg?s=128&g=1", "display_name": "Shiroe", "link": "https://stackoverflow.com/users/8373545/shiroe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 54446440, "answer_count": 1, "score": -1, "last_activity_date": 1548885063, "creation_date": 1548858504, "last_edit_date": 1548869324, "question_id": 54442856, "link": "https://stackoverflow.com/questions/54442856/how-to-read-unicode-string-from-process-in-windows", "title": "How to read Unicode string from process in Windows?", "body": "<p>I'm trying to read a Unicode string from another process's memory with this code:</p>\n\n<p>Function:</p>\n\n<pre><code>bool ReadWideString(const HANDLE&amp; hProc, const std::uintptr_t&amp; addr, std::wstring&amp; out) {\n    std::array&lt;wchar_t, maxStringLength&gt; outStr;\n    auto readMemRes = ReadProcessMemory(hProc, (LPCVOID)addr,(LPVOID)&amp;out, sizeof(out), NULL);\n    if (!readMemRes)\n        return false;\n    else {\n        out = std::wstring(outStr.data());\n    }\n    return true;\n}\n</code></pre>\n\n<p>Call:</p>\n\n<pre><code>std::wstring name;\nbool res = ReadWideString(OpenedProcessHandle, address, name);\nstd::wofstream test(\"test.txt\");\ntest &lt;&lt; name;\ntest.close();\n</code></pre>\n\n<p>This is working well with English letters, but when I try to read Cyrillic, it outputs nothing. I tried with <code>std::string</code>, but all I get is just a random junk like <code>\"EC9\"</code> instead of <code>\"\u0414\u0435\u0431\u0438\u043b\"</code>.</p>\n\n<p>I'm using Visual Studio 17 and the C++17 standard.</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 897, "user_id": 334690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zSlND.jpg?s=128&g=1", "display_name": "Celal Erg&#252;n", "link": "https://stackoverflow.com/users/334690/celal-erg%c3%bcn"}, "edited": false, "score": 0, "creation_date": 1548857877, "post_id": 54442523, "comment_id": 95694350, "body": "You might want to take a look at emplace_back: <a href=\"https://en.cppreference.com/w/cpp/container/vector/emplace_back\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector/emplace_back</a>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 897, "user_id": 334690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zSlND.jpg?s=128&g=1", "display_name": "Celal Erg&#252;n", "link": "https://stackoverflow.com/users/334690/celal-erg%c3%bcn"}, "edited": false, "score": 1, "creation_date": 1548858183, "post_id": 54442523, "comment_id": 95694543, "body": "@CelalErg&#252;n Since the object construction happens inside of a function, I don&#39;t think using <code>emplace_back</code> would change anything. It would the same effect as <code>push_back</code>."}], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 1, "creation_date": 1548858201, "post_id": 54442581, "comment_id": 95694559, "body": "Makes total sense: it is an rvalue. However if I were to store the <code>BigObject</code> instance in a temporary variable, that would make it an lvalue and I would need to transform the temporary variable to an rvalue with <code>std::move</code> before pushing. Right ?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 2, "creation_date": 1548858451, "post_id": 54442581, "comment_id": 95694717, "body": "@BrunoGrieder If you mean <code>BigObject b = genBigObject(); v.push_back(std::move(b));</code> then yes - <code>b</code> is an lvalue there (note, it&#39;s <code>b</code>, specifically the name, that&#39;s the lvalue) so <code>move(b)</code> does have an effect"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 10, "last_activity_date": 1548857662, "creation_date": 1548857662, "answer_id": 54442581, "question_id": 54442523, "link": "https://stackoverflow.com/questions/54442523/should-i-rely-on-copy-elision-or-on-move-semantics/54442581#54442581", "title": "Should I rely on copy elision or on move semantics?", "body": "<p>The purpose of <code>std::move()</code> is to take an <em>lvalue</em> and treat it as an <em>rvalue</em> to make it clear for other functions down the road that they can cannibalize the object's internals if they so wish.</p>\n\n<p><code>genBigObject()</code> is already an rvalue. You do not need to <code>move()</code> it to make it one - <code>move()</code> simply doesn't provide you anything of value there. So just don't do it. You don't even need to get into the question of what actually happens downstream - <code>move()</code> is a signal for code and for readers that you're doing something potentially unsafe, but in this case... you're not.</p>\n\n<p>For this <em>specific</em> case, you're calling the rvalue reference overload of <code>push_back()</code> anyway - which triggers a temporary materialization of the temporary object. Whether that temporary materialization happens because of specifically the call to <code>push_back()</code> or the slightly-earlier call to <code>move()</code> doesn't make a difference. </p>\n"}, {"comments": [{"owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 0, "creation_date": 1548860872, "post_id": 54443056, "comment_id": 95696414, "body": "Interesting! I do not particularly &quot;want&quot; elision... unless I can have a performance gain. Thank you for your example, starting from there, i will run a few benchmarks."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 0, "creation_date": 1548861486, "post_id": 54443056, "comment_id": 95696835, "body": "@BrunoGrieder So, if your big object is a  handle to a large amount of resources on the heap, move is usually near-free.  If your big object is like <code>struct BigObject { std::array&lt; 1 bajillion, char &gt; }</code> then you <i>need</i> elision for efficiency."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1548859101, "creation_date": 1548859101, "answer_id": 54443056, "question_id": 54442523, "link": "https://stackoverflow.com/questions/54442523/should-i-rely-on-copy-elision-or-on-move-semantics/54443056#54443056", "title": "Should I rely on copy elision or on move semantics?", "body": "<p>Elision will not happen there, see @Barry's answer for details.</p>\n\n<p>In short, <code>push_back</code> does not support elision; it takes an rvalue reference or a const lvalue reference.</p>\n\n<p>You have an actual rvalue; calling <code>std::move</code> casts that rvalue into an rvalue reference, which is a pointless action.  It is like <code>int x = 7; static_cast&lt;int&amp;&gt;(x);</code> -- almost a noop, and sometimes a pessimization.</p>\n\n<p>Addressing your core concern, that you want elision, we can do something.</p>\n\n<p>You can elide the construction of <code>BigObject</code> with a bit of work:</p>\n\n<pre><code>template&lt;class F&gt;\nstruct emplacer {\n  F f;\n  operator std::result_of_t&lt;F&amp;&amp;()&gt;()&amp;&amp;{ return std::forward&lt;F&gt;(f)(); }\n  operator std::result_of_t&lt;F&amp;()&gt;()&amp;{ return f(); }\n};\ntemplate&lt;class T&gt;\nemplacer(T&amp;&amp;)-&gt;emplacer&lt;T&amp;&amp;&gt;;\n</code></pre>\n\n<p>now you can do this:</p>\n\n<pre><code>v.emplace_back( emplacer{ &amp;getBigObject });\n</code></pre>\n\n<p>and the <code>BigObject</code> will be directly emplaced into the vector buffer (barring overly greedy <code>BigObject</code> constructors).</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/3d9f329949761522\" rel=\"nofollow noreferrer\">Live example</a> (notice the complete lack of output; we generated 100 BigObject in a vector and zero where moved).</p>\n"}], "owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 54442581, "answer_count": 2, "score": 2, "last_activity_date": 1548860911, "creation_date": 1548857474, "last_edit_date": 1548860911, "question_id": 54442523, "link": "https://stackoverflow.com/questions/54442523/should-i-rely-on-copy-elision-or-on-move-semantics", "title": "Should I rely on copy elision or on move semantics?", "body": "<p>Given a vector</p>\n\n<pre><code>std::vector&lt;BigObject&gt; v;\n</code></pre>\n\n<p>and a factory function</p>\n\n<pre><code>BigObject genBigObject();\n</code></pre>\n\n<p>I want to avoid copying <code>BigObject</code> instances.</p>\n\n<p>Which one is faster ?</p>\n\n<pre><code>v.push_back(genBigObject());\n</code></pre>\n\n<p>or</p>\n\n<pre><code>v.push_back(std::move(genBigObject()));\n</code></pre>\n\n<p>Can I rely on the fact that copy elision will <em>allways</em> happen ? (I could remove the copy constructor on <code>BigObject</code>, but, well...)</p>\n"}, {"tags": ["c++", "c++03", "function-templates"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548857822, "post_id": 54442495, "comment_id": 95694318, "body": "I think you misunderstood the question you linked. Your use case in a conforming C++ implementation should not be ambiguous. You declare a member function template in <code>D</code> with the exact same signature as in <code>C</code>. The linked question uses two member function template with <b>different signatures</b>."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548858181, "post_id": 54442495, "comment_id": 95694542, "body": "Can you also please specify the exact MSVC version you are using? The earliest one I used (<a href=\"https://godbolt.org/z/fFWZpW\" rel=\"nofollow noreferrer\">godbolt.org/z/fFWZpW</a>) accepts you code just fine."}, {"owner": {"reputation": 2241, "user_id": 404734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4c30170453a44d900f8e03dd40461059?s=128&d=identicon&r=PG", "display_name": "Kaiserludi", "link": "https://stackoverflow.com/users/404734/kaiserludi"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548859531, "post_id": 54442495, "comment_id": 95695448, "body": "@StoryTeller: The oldest VC version that the code base still supports is VC11 (Visual Studio 2012), so this is what is used for development, although builds for VC12 (VS 2013), VC14 (VS 2015) and VC15 (VS 2017) are also provided with each release. However to check if this might be an issue that is only existing in older versions I have also tested this code with VC15 and that version still gives me the same error. Interestingly the link to godbolt that you provided states that it would use VC19, when VC16 (from VS2019, which was released last month) is the newest major version of VC."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548859795, "post_id": 54442495, "comment_id": 95695643, "body": "The godbolt option I chose was grouped under MSVC 2015 in the combo box. Any way, this is the oldest version I found, and I don&#39;t use VC++ in day to day operation. Ultimately, it&#39;s not a language problem. Clang and G++ both accept it as C++03, and I made a point to again use old versions in C++03 mode. (<a href=\"https://godbolt.org/z/gH19pN\" rel=\"nofollow noreferrer\">godbolt.org/z/gH19pN</a>)."}, {"owner": {"reputation": 2241, "user_id": 404734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4c30170453a44d900f8e03dd40461059?s=128&d=identicon&r=PG", "display_name": "Kaiserludi", "link": "https://stackoverflow.com/users/404734/kaiserludi"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548870715, "post_id": 54442495, "comment_id": 95702290, "body": "@StoryTeller: Apparently I was wrong in my previous comment. VC11 and VC12 fail to compile the original repro case, but VC14 and VC15 compile it just fine. However they fail to compile a modified CRTP version of that repro case that is closer to our real-world case, and in which <code>C</code> is a class template and <code>D</code> inherits from <code>C&lt;D&gt;</code>. GCC and clang successfully build the CRTP version. <a href=\"https://godbolt.org/z/vkLHvz\" rel=\"nofollow noreferrer\">godbolt.org/z/vkLHvz</a>"}], "owner": {"reputation": 2241, "user_id": 404734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4c30170453a44d900f8e03dd40461059?s=128&d=identicon&r=PG", "display_name": "Kaiserludi", "link": "https://stackoverflow.com/users/404734/kaiserludi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563371203, "creation_date": 1548857378, "last_edit_date": 1563371203, "question_id": 54442495, "link": "https://stackoverflow.com/questions/54442495/using-declaration-for-overloaded-inherited-function-template-leads-to-ambiguous", "title": "using-declaration for overloaded inherited function template leads to &quot;ambiguous call to overloaded function&quot;", "body": "<p>I have a base class template <code>C</code> that implements multiple overloads of a function <code>c()</code>, of which one is a function template, and a sub class <code>D</code> that inherits from C and re-implements the function template.\n<code>D::c()</code> causes all overloads of <code>C::c()</code> to be hidden in <code>D</code>. As I want the overloads that are not re-implemented by <code>D</code> to not be hidden, <code>D</code> makes them available via <code>using C&lt;D&gt;::c</code>;</p>\n\n<p>This works fine if all overloads of <code>c()</code> are non templated functions: The base implementations are available to users of D for overloads that <code>D</code> does not re-implement, but for overloads that <code>D</code> re-implements, the implementation from <code>C</code> becomes unavailable to users of D and the implementation from <code>D</code> is used instead.</p>\n\n<p>However if the re-implemented function is a function template, then the same approach leads to a compiler error in MSVC.</p>\n\n<pre><code>\"ambiguous call to overloaded function\ncould be 'void D::c&lt;int&gt;(FT)\nor       'void C::c&lt;int&gt;(FT)'\"\n</code></pre>\n\n<p>Apparently with templates the <code>C</code> implementation stays available to <code>D</code> users and conflicts with the re-implementation in <code>D</code>.</p>\n\n<pre><code>template&lt;typename T&gt;\nclass C\n{\npublic:\n    void c(void){}\n    template&lt;typename FT&gt; void c(FT param){}\n};\n\nclass D : public C&lt;D&gt;\n{\npublic:\n    using C&lt;D&gt;::c;\n    template&lt;typename FT&gt; void c(FT param){}\n};\n\nint main()\n{\n    D d;\n    d.c&lt;int&gt;(1);\n}\n</code></pre>\n\n<p>clang and G++ both compile this code just fine, while MSVC 11, 12, 14 and 15 all fail to compile it.\nA simplified version of the code in which <code>C</code> is not a template, but an ordinary class, still fails to compile in MSVC 11 and 12, but compiles fine in MSVC 14 and 15.</p>\n\n<p>With the usual approach not working is there any better approach in C++03 for re-implementing an inherited overloaded function template than to abstain from using <code>using C&lt;D&gt;::c</code> and instead adding re-implementations for all overloads, of which some do nothing more than only calling their base implementation?</p>\n\n<p>Note:\nI can't use C++11 or any newer standards.</p>\n"}, {"tags": ["c++", "boost", "icu"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1548857992, "post_id": 54442457, "comment_id": 95694422, "body": "Do you really need to use boost locale? Or you simply need to transcode some symbols. You can use IBM ICU (the library boost locale based on) or iconv or MS Mlang (if your program is widows only)."}, {"owner": {"reputation": 3990, "user_id": 6095394, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e512acda63343ac20eedd20c3964911?s=128&d=identicon&r=PG&f=1", "display_name": "pschill", "link": "https://stackoverflow.com/users/6095394/pschill"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1548858313, "post_id": 54442457, "comment_id": 95694636, "body": "I dont need to use boost locale, but it would be very convenient, because I already depend on other boost libraries. I dont want to introduce another library if boost locale already solves the problem."}], "owner": {"reputation": 3990, "user_id": 6095394, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e512acda63343ac20eedd20c3964911?s=128&d=identicon&r=PG&f=1", "display_name": "pschill", "link": "https://stackoverflow.com/users/6095394/pschill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548929341, "creation_date": 1548857262, "last_edit_date": 1548858389, "question_id": 54442457, "link": "https://stackoverflow.com/questions/54442457/convert-from-code-page-437-to-unicode-with-boost", "title": "Convert from code page 437 to unicode with boost", "body": "<p>How can I use <code>boost::locale::conv::to_utf</code> in order to convert a CP437 string into unicode?</p>\n\n<p>I have a <code>std::string</code> which contains the CP437 encoded string \"\u00e4\u00f6\u00fc\". The corresponding UTF16 encoding is 0x00e4, 0x00f6, 0x00fc. I tried both</p>\n\n<pre><code>std::wstring str_utf = boost::locale::conv::to_utf&lt;wchar_t&gt;(str_437, \"CP437\");\n</code></pre>\n\n<p>and</p>\n\n<pre><code>boost::locale::generator gen;\nstd::locale loc = gen.generate(\"CP437\");\nstd::wstring str_utf = boost::locale::conv::to_utf&lt;wchar_t&gt;(str_437, loc);\n</code></pre>\n\n<p>to convert the string into a unicode string, but it didnt work: The first method returned the wrong <code>wchar_t</code> values 0x0004, 0x0014, 0x0001 and the second method failed with <code>abort() has been called</code>.</p>\n\n<p>I also tried variations of the \"CP437\" string, for example, \".CP437\", \"cp437\", \".cp437\", etc, but none of them worked.</p>\n\n<p>I first thought that maybe my string is not encoded in CP437 at all, but then I converted the string using the ICU library and it successfully yielded the correct UTF16 values 0x00e4, 0x00f6, 0x00fc.</p>\n\n<p>Why does boost fail while ICU succeeds for the same string? Do I need to use different code page identifiers for boost?</p>\n"}, {"tags": ["java", "c++", "type-conversion", "jna"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 3, "creation_date": 1548856879, "post_id": 54442269, "comment_id": 95693699, "body": "Java doesn&#39;t have explicit unsigned types."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1548856974, "post_id": 54442269, "comment_id": 95693745, "body": "<code>java.lang.Byte</code> has a few methods for treating bytes as unsigned values though."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1548856992, "post_id": 54442269, "comment_id": 95693762, "body": "Does it even matter?  <code>0xFF</code>is either <code>-1</code> or <code>255</code> but it is still <code>0xFF</code>.  You don&#39;t lose any information, it&#39;s just displayed differently."}, {"owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "edited": false, "score": 0, "creation_date": 1548857248, "post_id": 54442269, "comment_id": 95693967, "body": "The only real difference you have to account for is when dealing with bit manipulation.  In C/C++ I believe shifts on unsigned/signed types will automatically use either a signed or unsigned shift depending on the type (though I can&#39;t find a source right now to cite), where in Java you&#39;ll have to explicitly use &lt;&lt; or &gt;&gt; for signed shifting and &lt;&lt;&lt; or  &gt;&gt;&gt; for unsigned shifting."}], "answers": [{"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 11, "last_activity_date": 1548857291, "creation_date": 1548857291, "answer_id": 54442465, "question_id": 54442269, "link": "https://stackoverflow.com/questions/54442269/how-can-i-declare-an-uint8-t-array-in-java/54442465#54442465", "title": "How can I declare an uint8_t array in Java", "body": "<p>Java doesn't have unsigned types. But it's not a big problem, since signed overflow in Java is defined as two's complement, you can just pass the <code>byte</code> to where JNA expects <code>uint8_t</code>. It's only a bit inconvenient to work with:</p>\n\n<pre><code>byte[] input = { 0x30, 0x41, (byte)0x80, (byte)0x8A...};\n</code></pre>\n\n<p>To read <code>uint8_t</code> back you'd do <code>(x &amp; 0xFF)</code> to strip the sign extension and work with the result as an <code>int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": false, "score": 1, "last_activity_date": 1548857645, "creation_date": 1548857645, "answer_id": 54442570, "question_id": 54442269, "link": "https://stackoverflow.com/questions/54442269/how-can-i-declare-an-uint8-t-array-in-java/54442570#54442570", "title": "How can I declare an uint8_t array in Java", "body": "<p>The value stored in a byte is a determinate one regardless how you interpret it, signed or unsigned that matters.</p>\n\n<p>You can verify this easily with this code:</p>\n\n<pre><code>byte test = (byte)255;\nSystem.out.println(test &amp; 0xFF);\n</code></pre>\n\n<p>which outputs <code>255</code>.</p>\n\n<p>This means that once you created your <code>byte[]</code> with the values you need (and casting each value to byte allows you to set unsigned values). Then you are fine, on your JNI side you'll use:</p>\n\n<pre><code>jbyte* data = GetByteArrayElements(...)\n</code></pre>\n\n<p>and you'll be able to use it as an unsigned array of bytes by directly casting it if needed <code>(uint8_t*)data</code>.</p>\n"}], "owner": {"reputation": 95, "user_id": 10506010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18734ff215514021c18658cc262c437d?s=128&d=identicon&r=PG&f=1", "display_name": "conryyy", "link": "https://stackoverflow.com/users/10506010/conryyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1638, "favorite_count": 0, "accepted_answer_id": 54442465, "answer_count": 2, "score": 5, "last_activity_date": 1548879408, "creation_date": 1548856666, "last_edit_date": 1548879408, "question_id": 54442269, "link": "https://stackoverflow.com/questions/54442269/how-can-i-declare-an-uint8-t-array-in-java", "title": "How can I declare an uint8_t array in Java", "body": "<p>I have a C++ Function in my DLL that needs an uint8_t array as an input Parameter, so the array looks something like that:</p>\n\n<pre><code>uint8_t input[input_length] = { 0x30, 0x41, 0x80, 0x8A...}; \n</code></pre>\n\n<p>I want to use this function in Java with JNA, which means I have to creat an uint8_t array in Java. My first approach was to create an byte array like:</p>\n\n<pre><code>byte[] input = { 0x30, 0x41, 0x80, 0x8A...}; \n</code></pre>\n\n<p>But then I realized that an uint8_t Variable in C++ has a range from 0..255, but a byte Variable in Java has an range from -128..127, and as you can see this array contains Values that are over 127 (like 0x8A), which means my Java declaration here is not valid. So my question is what type in Java is equivalent to uint8_t?</p>\n"}, {"tags": ["c++", "regex", "nested", "regex-group", "nested-groups"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858163, "post_id": 54442639, "comment_id": 95694532, "body": "ah thanks I was experimenting with those meanwhile but still couldn&#39;t get it right. Lemme update with my original link as a comment. Thank you very much! <a href=\"https://regex101.com/r/weGhVz/3\" rel=\"nofollow noreferrer\">regex101.com/r/weGhVz/3</a>"}, {"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858382, "post_id": 54442639, "comment_id": 95694678, "body": "Hum note that strings like &quot;ab(ab)ab)&quot; will not be matched tho. <a href=\"https://regex101.com/r/weGhVz/4\" rel=\"nofollow noreferrer\">regex101.com/r/weGhVz/4</a>"}, {"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858425, "post_id": 54442639, "comment_id": 95694699, "body": "but strings like &quot;(ab(ab)abba&quot; will. I have to think whether I can fix that."}, {"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858578, "post_id": 54442639, "comment_id": 95694806, "body": "Interestingly &quot;ab(ab))&quot; will work hum. <a href=\"https://regex101.com/r/weGhVz/5/\" rel=\"nofollow noreferrer\">regex101.com/r/weGhVz/5</a>"}, {"owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "reply_to_user": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858658, "post_id": 54442639, "comment_id": 95694861, "body": "I was going to add that I assume you have matching parenthesis. C++ regex as far as I know doesn&#39;t support negative lookbehind."}, {"owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "reply_to_user": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858683, "post_id": 54442639, "comment_id": 95694882, "body": "I&#39;ll try to come up with a better generalization of this"}, {"owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "reply_to_user": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 1, "creation_date": 1548858844, "post_id": 54442639, "comment_id": 95695000, "body": "You are using + instead of * in the negative lookbehind. That is why you match (ab))"}, {"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548858886, "post_id": 54442639, "comment_id": 95695033, "body": "Ach no way? Indeed it doesn&#39;t support it. Deplorable. I&#39;ve also found other things that are said to be wrong according to the C++ regex engine but works with other engine, not only in terms of functionalities but also in terms of interpretation. For instance in the regex &quot;ab{blabla}ab&quot;, the {} will be interpreted as a range expression whereas other engines understand this must be escaped. It makes sense to rant but it seems other engines are more lax on this case."}, {"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548859019, "post_id": 54442639, "comment_id": 95695121, "body": "The context behind would be to ideally avoid parsing non-matching parenthesis nested patterns."}, {"owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "reply_to_user": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548859175, "post_id": 54442639, "comment_id": 95695225, "body": "Exactly a quick dirty solution is to just avoid strings with non-matching parenthesis. You could even solve the whole problem that way. Count parenthesis, +1 for opening -1 for closing"}, {"owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548860092, "post_id": 54442639, "comment_id": 95695863, "body": "Hum not sure this would work. The string &quot;ab)ab(ab&quot; would be incorrectly matching right?"}, {"owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "reply_to_user": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548861415, "post_id": 54442639, "comment_id": 95696780, "body": "Which one? counting or the regex? For counting you should check to never go into negative values"}, {"owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "reply_to_user": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "edited": false, "score": 0, "creation_date": 1548922784, "post_id": 54442639, "comment_id": 95720255, "body": "Just a small update, apparently boost regex has lookbehind. It is based on Perl"}], "tags": [], "owner": {"reputation": 910, "user_id": 3332581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fa1d0b48d4ec4d535c0e7a48882c2eb3?s=128&d=identicon&r=PG", "display_name": "Ashkan", "link": "https://stackoverflow.com/users/3332581/ashkan"}, "is_accepted": true, "score": 1, "last_activity_date": 1548857822, "creation_date": 1548857822, "answer_id": 54442639, "question_id": 54442259, "link": "https://stackoverflow.com/questions/54442259/how-to-match-un-nested-groups-between-parenthesis-only/54442639#54442639", "title": "How to match un-nested groups between parenthesis only?", "body": "<p>You could use regex negative lookahead feature to make sure there is no parentesis after the first closing.</p>\n\n<pre><code>\\((\\w*)\\)(?!\\w*\\))\n</code></pre>\n\n<p>This produces the output you want. Group one gives the sequence inside the parenthesis </p>\n"}], "owner": {"reputation": 183, "user_id": 966964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd389e0b1ff26edb5ada492434f5593d?s=128&d=identicon&r=PG", "display_name": "tbop", "link": "https://stackoverflow.com/users/966964/tbop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 54442639, "answer_count": 1, "score": 0, "last_activity_date": 1548857822, "creation_date": 1548856650, "last_edit_date": 1548857536, "question_id": 54442259, "link": "https://stackoverflow.com/questions/54442259/how-to-match-un-nested-groups-between-parenthesis-only", "title": "How to match un-nested groups between parenthesis only?", "body": "<p>I am trying to match chains of characters that are within single opening and closing parenthesis.</p>\n\n<p>In the following examples only the first two lines should return ab.<br/>The other ones shouldn't match anything</p>\n\n<pre><code>ab(ab)ac =&gt; ab\n(ab)ndn =&gt; ab\nab(ab(ac)an) =&gt; void\nab((ab)ab)ab =&gt; void\nab(ab(abb))ab =&gt; void\nab(ab(ab(ab))ab) =&gt; void\n</code></pre>\n\n<p>This is as far as I could go atm I do not know why the third line is still matched. <a href=\"https://regex101.com/r/weGhVz/2\" rel=\"nofollow noreferrer\">https://regex101.com/r/weGhVz/2</a></p>\n"}, {"tags": ["c#", "c++", "arrays", "translate", "crc16"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1548856625, "post_id": 54442068, "comment_id": 95693535, "body": "You say &quot;I need to use the function in C++ as follows ... but in C# it gives me&quot;.  Is the problem how to convert the <i>call</i> to the function?  Can you show us a minimal example of the call?"}, {"owner": {"reputation": 11092, "user_id": 982149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LdDoZ.png?s=128&g=1", "display_name": "Fildor", "link": "https://stackoverflow.com/users/982149/fildor"}, "edited": false, "score": 1, "creation_date": 1548856643, "post_id": 54442068, "comment_id": 95693549, "body": "Does it have to be unsafe? If not: Do not &quot;translate&quot;. Write down what it does, then implement it the &quot;C# way&quot;. Translations like this hardly ever lead to reasonable code (from my experience)."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1548856680, "post_id": 54442068, "comment_id": 95693576, "body": "You might find the easiest solution is add an additional <code>ushort offset</code> argument to the C#, and start the CRC at that offset from the start of the array."}, {"owner": {"reputation": 11, "user_id": 10310181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bEDxR-FXbXM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOlBSpgbVWGj3aIRD7oBIRxO8QLNQ/mo/photo.jpg?sz=128", "display_name": "Denis ", "link": "https://stackoverflow.com/users/10310181/denis"}, "edited": false, "score": 0, "creation_date": 1548858135, "post_id": 54442068, "comment_id": 95694515, "body": "I added the C# function call which gives the error. This only happens when using Array[3]. Adding Array will work."}], "answers": [{"tags": [], "owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "is_accepted": false, "score": 1, "last_activity_date": 1548935367, "last_edit_date": 1548935367, "creation_date": 1548862094, "answer_id": 54444023, "question_id": 54442068, "link": "https://stackoverflow.com/questions/54442068/c-and-operaor-for-pointing-to-array/54444023#54444023", "title": "C# * and &amp; operaor for pointing to array", "body": "<p>First of all in C# it's enough to pass only array to a method without its length since <code>Array</code> class contains <code>Length</code> property in it. So you can rewrite you method to following (<code>unsafe</code> is not required since you are not working with pointer in C# code)</p>\n\n<pre><code>public static ushort ComputeChecksum(byte[] buffer)\n{\n    ushort index;\n    ushort crc = 0;\n    for (int i = 0; i &lt; buffer.Length; ++i) //using Length property\n    {\n        index = (ushort)((low ^ buffer[i]) &amp; 0x00FF);\n        crc = (ushort)((high * 256) ^ table[index]);\n    }\n\n    return crc;\n}\n</code></pre>\n\n<p>And there are few solutions for you problem. First one is using <code>Linq</code>. You can call your method like this</p>\n\n<pre><code>ushort crc = ComputeChecksum(arr.Skip(3).ToArray());\n</code></pre>\n\n<p>To use <code>Skip</code> method you need to add <code>using System.Linq;</code>.</p>\n\n<p>Second solution is using <code>Span</code>. It requires Visual Studio 2017 (or 2015 with updated compiler), at least .NET framework 4.5 and adding <code>System.Memory</code> package using Nuget package manager.</p>\n\n<pre><code>var span = new Span&lt;byte&gt;(arr, 3, arr.Length - 3);\nushort crc = ComputeChecksum(span.ToArray());\n</code></pre>\n\n<p>And the most straight forward solution is adding <code>offset</code> and <code>length</code> paratemers to your method</p>\n\n<pre><code>public static ushort ComputeChecksum(byte[] buffer, int length, int offset)\n{\n    ushort index;\n    ushort crc = 0;\n    for (int i = offset; i &lt; length; ++i)\n    {\n        index = (ushort)((low ^ buffer[i]) &amp; 0x00FF);\n        crc = (ushort)((high * 256) ^ table[index]);\n    }\n\n    return crc;\n}\n</code></pre>\n\n<p>and usage</p>\n\n<pre><code>int offset = 3;\nushort crc = ComputeChecksum(arr, arr.Length - offset, offset);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10310181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bEDxR-FXbXM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOlBSpgbVWGj3aIRD7oBIRxO8QLNQ/mo/photo.jpg?sz=128", "display_name": "Denis ", "link": "https://stackoverflow.com/users/10310181/denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548935367, "creation_date": 1548856122, "last_edit_date": 1548857949, "question_id": 54442068, "link": "https://stackoverflow.com/questions/54442068/c-and-operaor-for-pointing-to-array", "title": "C# * and &amp; operaor for pointing to array", "body": "<p>I am translating a C++ CRC function to C# and I am having problems with passing an a pointer to an (unsigned char) byte array in the function argument. In the C++ sample below </p>\n\n<pre><code>unsigned int CRC16_Calculation(unsigned char *buf, unsigned int len){\n  unsigned int ix;\n  unsigned int index;\n  unsigned int crc = 0;\n\n  for(ix=0; ix&lt;len; ix++)\n  {\n    index = (high ^ buf[ix]) &amp; 0x00FF;  \n    crc = (low * 256) ^ Crc16Tbl[index];\n  }\n  return crc;}\n</code></pre>\n\n<p>I was able to translate this function to C#.</p>\n\n<pre><code>    public static unsafe ushort ComputeChecksum(byte[] buffer, ushort len)\n{\n    ushort index;\n    ushort crc = 0;\n    for (int i = 0; i &lt; len; ++i)\n    {\n        index = (ushort)((low ^ buffer[i]) &amp; 0x00FF);\n        crc = (ushort)((high * 256) ^ table[index]);\n    }\n\n    return crc;\n}\n</code></pre>\n\n<p>I need to use the function in C++ as follows:</p>\n\n<pre><code>crc= CRC16_Calculation(&amp;Array[3], sizeof(Array)-3);\n</code></pre>\n\n<p>But in C# in gives me an compiler error. </p>\n\n<pre><code>ushort crc = ComputeChecksum(Array[3], (ushort)(Array.Length-3));\n</code></pre>\n\n<p>Argument 1: cannot convert from 'byte[]*' to 'byte[]'.</p>\n\n<p>The best overloaded method match for 'Program.ComputeChecksum(byte[], ushort)' has some invalid arguments</p>\n\n<p>Is the problem that the C++ function uses a ponter to the unsigned char array and this is not possible with C#, repective only when usinf unsafe? </p>\n"}, {"tags": ["c++", "c", "cmake"], "owner": {"reputation": 14229, "user_id": 574115, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/CtK6N.png?s=128&g=1", "display_name": "Daan Timmer", "link": "https://stackoverflow.com/users/574115/daan-timmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1548856619, "answer_count": 0, "score": 1, "last_activity_date": 1548856059, "creation_date": 1548856059, "question_id": 54442045, "link": "https://stackoverflow.com/questions/54442045/set-c-compiler-and-c-compiler-flags-for-single-target-without-abusing-cmake-cx", "closed_reason": "Duplicate", "title": "set c-compiler and c++-compiler flags for single target without abusing CMAKE_CXX_FLAGS and CMAKE_C_FLAGS", "body": "<p>I've got an (embedded mixed C/C++) project.\nI need to set, the most important one, <code>-fno-rtti</code>. I can't use </p>\n\n<pre><code>target_compile_options(\n    my_target\n\n    PRIVATE\n       -fno-rtti\n)\n</code></pre>\n\n<p>Because this sets -fno-rtti for CXX and C objects. However, watching <a href=\"https://www.youtube.com/watch?v=rLopVhns4Zs\" rel=\"nofollow noreferrer\">Daniel Pfeifer - \"Effective CMake\"</a> he 'recommends' to not use <code>SET(CMAKE_C_FLAGS  \"${CMAKE_C_FLAGS} ${CUSTOM_C_FLAGS}\")</code> and <code>SET(CMAKE_CXX_FLAGS  \"${CMAKE_CXX_FLAGS} ${CUSTOM_CXX_FLAGS}\")</code></p>\n\n<p>But how can I achieve different compiler flags for c++ and c? I can't just use <code>-fno-rtti</code> for C, because it emits warnings, warnings that I can't ignore because of <code>-Werror</code> policy.</p>\n\n<p>I've tried moving the C files to a library or the C++ files to a library but that generates a different (non working) binary.</p>\n"}, {"tags": ["c++", "http", "cgi", "jpeg"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1548856499, "post_id": 54442029, "comment_id": 95693450, "body": "Your first step to fixing this, is to use either <code>stdout</code>, or <code>std::cout</code> to generate the output, but not both. And the second step, after deciding which one you will use, is to correctly implement copying more than one byte at a time, between the file and the standard output. That&#39;s not going to &quot;stream&quot; very well."}, {"owner": {"reputation": 1279, "user_id": 1543263, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/WaOlX.png?s=128&g=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/1543263/fernando"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1548861888, "post_id": 54442029, "comment_id": 95697117, "body": "I&#39;m doing just a test... So I wish the most simple code, before any optimizations."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1548864175, "post_id": 54442029, "comment_id": 95698511, "body": "<code>stdout</code> versus <code>std::cout</code> is not an optimization. Using both, like this, is likely to fail in mysterious ways, since each one has completely independent internal buffers that have absolutely no knowledge, whatsoever, of each other&#39;s existence. Random parts of <code>stdout</code> will be intermixed with random parts of <code>std::cout</code>, in the actual output on file descriptor #1, with hilarious results."}], "answers": [{"tags": [], "owner": {"reputation": 1279, "user_id": 1543263, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/WaOlX.png?s=128&g=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/1543263/fernando"}, "is_accepted": false, "score": 1, "last_activity_date": 1548939722, "creation_date": 1548939722, "answer_id": 54461251, "question_id": 54442029, "link": "https://stackoverflow.com/questions/54442029/how-to-stream-motion-jpeg-using-cgi/54461251#54461251", "title": "How to stream motion jpeg using CGI?", "body": "<p>After a very hard binary debugging, I was able to come up with a simple solution:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    printf(\"Content-Type: multipart/x-mixed-replace; boundary=--jpgboundary\\r\\n\\r\\n\");\n\n    int i = 0;\n    while(true)\n    {\n        char fnameBuffer[1024];\n        sprintf(fnameBuffer, \"/tmp/img_%d.jpg\", (i%2));\n        FILE* fp = fopen(fnameBuffer, \"r\");\n        fseek(fp, 0, SEEK_END);\n        long fileSize = ftell(fp);\n        rewind(fp);\n\n        char* buffer = (char*)malloc(sizeof(char)*fileSize);\n        fread(buffer, 1, fileSize, fp);\n        fclose(fp);\n        free(buffer);\n\n        i++;\n        printf(\"--jpgboundary\");\n        printf(\"Content-type: image/jpeg\\r\\n\");\n        printf(\"Content-length: %ld\\r\\n\\r\\n\", fileSize);\n        fwrite(buffer, 1, fileSize, stdout);\n        printf(\"\\r\\n\\r\\n\\r\\n\");\n\n        usleep(1000);\n    }\n}\n</code></pre>\n\n<p>This actually loads a sequence of images and flush them to the browser.\nI tested the output with Google Chrome, and it is working as expected.</p>\n"}], "owner": {"reputation": 1279, "user_id": 1543263, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/WaOlX.png?s=128&g=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/1543263/fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548939722, "creation_date": 1548856017, "question_id": 54442029, "link": "https://stackoverflow.com/questions/54442029/how-to-stream-motion-jpeg-using-cgi", "title": "How to stream motion jpeg using CGI?", "body": "<p>I'm creating an Web application that need to display a video that I'm grabbing from a high speed camera.\nFor that, I'm trying to create a Motion JPEG CGI application that just outputs these frames as a JPG sequence when the browser access this CGI application.</p>\n\n<p>So my question is: how can I create a simple C++ code that just read a sequence of JPG files and then print it's output in other to be loaded by the browser a JPG sequence?</p>\n\n<p>I have tried the following code, but it is not working...</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdio&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"Cache-Control: no-cache\\n\\n\";\n    std::cout &lt;&lt; \"Cache-Control: private\\n\\n\";\n    std::cout &lt;&lt; \"Pragma: no-cache\\n\\n\";\n    std::cout &lt;&lt; \"Content-type: multipart/x-mixed-replace; boundary=spiderman\\n\\n\";\n\n    int i = 0;\n    while(true)\n    {\n        char buffer[1024];\n        sprintf(buffer, \"/tmp/img_%d.jpg\", (i%2));\n        FILE* fp = fopen(buffer, \"r\");\n        while(!feof(fp))\n        {\n            fread(buffer, 1, 1, fp); \n            fwrite(buffer, 1, 1, stdout);\n        }\n        fclose(fp);\n        i++;\n        std::cout &lt;&lt; \"--spiderman\\n\";\n        std::cout &lt;&lt; \"Content-type: image/jpeg\\n\\n\";\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "performance", "bit-manipulation"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1548855661, "post_id": 54441860, "comment_id": 95692936, "body": "Your mask should really be <code>0b00111111</code> as you don&#39;t want the &quot;sign bit&quot; to be set unless the original values sign bit was set. And note that you&#39;re not really converting anything, you&#39;re just truncating basically."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1548855874, "post_id": 54441860, "comment_id": 95693065, "body": "Before &quot;best and fastest&quot; you need to address <i>correct</i>.  For that, however, you need to explain what is supposed to be done with input values that are outside the range that &quot;int7&quot; can represent."}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548856251, "post_id": 54441860, "comment_id": 95693285, "body": "@JohnBollinger oh i removed the comment that i suppose the user who calls this function he knows he should put data -64 to +63. so no need to go to that safety.."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1548856293, "post_id": 54441860, "comment_id": 95693315, "body": "wat? So just mask with <code>&amp; ~0x80</code> (i.e. <code>&amp; 0x7f</code>) and be done with it=?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548856432, "post_id": 54441860, "comment_id": 95693395, "body": "Alright, @Hasanalattar, does that mean that if the input value is out of range then <i>you don&#39;t care</i> what the output is?"}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1548856737, "post_id": 54441860, "comment_id": 95693613, "body": "@AnttiHaapala i think -63 would be 0b100011 in 7bit signed integer.. and 0b1000110 in 8-bit signed integer."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1548856797, "post_id": 54441860, "comment_id": 95693654, "body": "@Hasanalattar well, then I suggest that you go read about 2&#39;s complement representation in wikipedia."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1548856909, "post_id": 54441860, "comment_id": 95693712, "body": "I don&#39;t really get what your <code>int7_t</code> is. Is it a 7-bit two&#39;s complement signed type? You&#39;re returning a <code>uint8_t</code> so what happens with the high bit? In 2&#39;s complement all values between -64 and 63 will have the same bit representation in any types that are 7-or-more-bit wide. You sign-extend to a wider type by simply adding the sign bit to the left"}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1548857193, "post_id": 54441860, "comment_id": 95693929, "body": "@AnttiHaapala i didnt know that, i meant binary representation... the one i wrote."}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1548857284, "post_id": 54441860, "comment_id": 95693981, "body": "@phuclv the higher bit is reserved for something else. so this function takes a number and shift it to int7_t in a (byte value) .. (common to have byte in uint8_t) .."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1548857604, "post_id": 54441860, "comment_id": 95694173, "body": "&quot;reserved&quot; doesn&#39;t mean anything. The important thing is that you want to clear that bit or leave it as-is. Normally that often mean don&#39;t touch it, in which case you simply have nothing to do, just return the whole int8_t value"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1548857607, "post_id": 54441860, "comment_id": 95694175, "body": "@Hasanalattar oops should be <code>0b100001</code>, and <code>0b11000001</code>"}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1548857823, "post_id": 54441860, "comment_id": 95694320, "body": "@phuclv no, if someone called this function: func_int7_t(-63) it should return [0bX1100001]. my question is not involving the 8th-bit. i will deal with it in the bottom of the function before returning the value."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548860852, "post_id": 54441860, "comment_id": 95696400, "body": "<i>&#39;so it will be done by doing nothing because&#39;</i> - still you accepted an answer that actually does something... There are two of really recommending doing nothing at all (accept phuclv&#39;s, he was to answer first...)."}], "answers": [{"comments": [{"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 3, "creation_date": 1548856065, "post_id": 54442018, "comment_id": 95693172, "body": "That has to be <code>((val &gt;&gt; 1) &amp; 0x40</code>, surely?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548856173, "post_id": 54442018, "comment_id": 95693239, "body": "That&#39;s exactly what I wanted to post, too... Interesting alternative <code>0xc0</code>, it would retain (duplicate) the sign bit in MSB (arithmetic right shift provided, but should be on ARM)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1548856268, "post_id": 54442018, "comment_id": 95693297, "body": "Or <code>((val  &amp; 0x80) &gt;&gt; 1)</code>.  And that avoids the implementation-defined behavior associated with right-shifting a negative number."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1548856425, "post_id": 54442018, "comment_id": 95693390, "body": "@JohnBollinger I first right shift <i>then</i> do the &#39;&amp;&#39; to be independent of the fact it is a signed shift or not, <code>((val &amp; 0x80) &gt;&gt; 1)</code> doesn&#39;t have the same result if signed shift or not on 8 bit arithmetic (but ofc all is done on <i>int</i>)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548856675, "post_id": 54442018, "comment_id": 95693574, "body": "@JohnBollinger Either variant is independent of shift type - only mine (<code>&amp; 0xc0</code>) is not..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548856769, "post_id": 54442018, "comment_id": 95693635, "body": "@bruno Be aware of val being promoted to int before applying <code>&amp;</code> operator, masking out possible sign bit afterwards, so you right-shift a non-negative int then..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548856934, "post_id": 54442018, "comment_id": 95693724, "body": "How does that follow, @bruno?  If you shift a negative number then you get implementation-defined behavior, period.  In principle, that could be anything (though it must be documented and consistent).  In practice, of course, there are only two likely possibilities, but if you mask first then you avoid that issue completely.  Even though yours very likely works, it is not <i>strictly</i> conforming."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548857026, "post_id": 54442018, "comment_id": 95693789, "body": "@JohnBollinger Implementation defined or not does not matter if you mask out all other bits than the single relevant one - which <i>will</i> be shifted, no matter if arithmetic or logical shift."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548857161, "post_id": 54442018, "comment_id": 95693900, "body": "Of course it matters, @Aconcagua.  Although it&#39;s surely not the case for the actual target compiler and environment, an implementation&#39;s definition of the behavior of a right shift of a negative number could be something you don&#39;t expect, such as always producing -1."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548857266, "post_id": 54442018, "comment_id": 95693975, "body": "@JohnBollinger <code>0b11xx</code> (result of ASR) and <code>0b01xx</code> (result of LSR) will both yield the same result after applying ` &amp; 0x0100` - the differing bit (bit 3 in example) is masked away anyway..."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548857325, "post_id": 54442018, "comment_id": 95694005, "body": "@JohnBollinger doing that I let the compiler to be able to use an instruction doing the shift on 8 bits whatever it is signed or not, just that, useless to search for more :-)"}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 2, "creation_date": 1548858630, "post_id": 54442018, "comment_id": 95694843, "body": "This is the slowest method of all! So why has it garnered all the upvotes?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 0, "creation_date": 1548860504, "post_id": 54442018, "comment_id": 95696154, "body": "@TonyK the initial question was to rewrite the given code in an other way with the same behavior, so I did, and <i>after</i> the question was edited"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 6, "last_activity_date": 1548856333, "last_edit_date": 1548856333, "creation_date": 1548855967, "answer_id": 54442018, "question_id": 54441860, "link": "https://stackoverflow.com/questions/54441860/fastest-way-to-convert-int8-to-int7/54442018#54442018", "title": "fastest way to convert int8 to int7", "body": "<p>the faster way is probably :</p>\n\n<pre><code>uint8_t val_7 = (val &amp; 0x3f) | ((val &gt;&gt; 1) &amp; 0x40);\n</code></pre>\n\n<p><code>val &amp; 0x3f</code> get the 6 lower bits (truncate) and <code>((val &gt;&gt; 1) &amp; 0x40)</code> move the bit to sign from the position 8 to 7</p>\n\n<p>The advantage to not use a <em>if</em> is to have a shorter code (even you can use arithmetic <em>if</em>) and to have a code without sequence break</p>\n"}, {"comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1548856966, "post_id": 54442120, "comment_id": 95693742, "body": "So, -127 (0b10000001) will become 1. Wrong."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1548857109, "post_id": 54442120, "comment_id": 95693858, "body": "if the initial value is 0x82 (negative) 0x82 &amp; 0x7f is 0x2 so a positive value, this is not ok"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1548857136, "post_id": 54442120, "comment_id": 95693882, "body": "@bruno: Seconded. Your answer seems to be the most succinct way."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1548857468, "post_id": 54442120, "comment_id": 95694087, "body": "@AndrejsCainikovs, -127 is not a supported argument value.  Arguments must be between -64 and 63, per the function specification."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1548857544, "post_id": 54442120, "comment_id": 95694142, "body": "@bruno, 0x82 also is not a supported argument value."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548857844, "post_id": 54442120, "comment_id": 95694331, "body": "@JohnBollinger <i>val</i> is <code>int8_t</code> so it can value 0x82, what do you mean ?"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548857852, "post_id": 54442120, "comment_id": 95694336, "body": "@JohnBollinger Missed OP statement <i>user who calls this function will use it correctly (-64 to +63)</i>. In this case yes, that&#39;s the most elegant way."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1548857936, "post_id": 54442120, "comment_id": 95694386, "body": "ife we continue the number of remarks and answers will not be able to be counted on int7 bits ^^"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1548857994, "post_id": 54442120, "comment_id": 95694425, "body": "@bruno, the function specifications require the caller to pass a value in the range -64 ... +63.  This was originally unclear in the question, but it has been updated.  The behavior when the argument is outside that range is unspecified, and therefore cannot be wrong, no matter what it is."}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548858243, "post_id": 54442120, "comment_id": 95694593, "body": "@JohnBollinger call the function with (-63) should return [0bX1100001] which is -63 in range of 7-bits signed variable. your soloution masks the sign bit and we lose it."}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "reply_to_user": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 1, "creation_date": 1548858366, "post_id": 54442120, "comment_id": 95694668, "body": "@Hasanalattar: <code>-63</code> is <code>1111111</code>, not <code>1100001</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 0, "creation_date": 1548858474, "post_id": 54442120, "comment_id": 95694741, "body": "^^. Moreover, @Hasanalattar, the sign bit of a 7-bit two&#39;s complement number is bit 6 (zero based), not bit 7.  The whole point of the exercise is to return a result with bit 7 clear, is it not?"}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548859214, "post_id": 54442120, "comment_id": 95695246, "body": "@JohnBollinger, no and actually i started to feel that this is going to be complicated. calling function with value (-63) which is [0b\u202d11000001\u202c] should return [0bX1111111] - again X means i dont care."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1548859793, "post_id": 54442120, "comment_id": 95695642, "body": "@TonyK 1111111 is 63, -63 is 1000001. \\@Hasan alattar no one cares about your code. People read the description which is unclear. There&#39;s no defined mapping in the question"}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1548861049, "post_id": 54442120, "comment_id": 95696524, "body": "@phuclv: You are right that I was wrong. But you were wrong too! 1111111 is -1 in 7-bit 2&#39;s complement, not 63."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1548861107, "post_id": 54442120, "comment_id": 95696558, "body": "@TonyK yeah I was thinking about the int8_t value. Indeed it&#39;s wrong in 7 bit"}], "tags": [], "owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "is_accepted": true, "score": 2, "last_activity_date": 1548858297, "last_edit_date": 1548858297, "creation_date": 1548856220, "answer_id": 54442120, "question_id": 54441860, "link": "https://stackoverflow.com/questions/54441860/fastest-way-to-convert-int8-to-int7/54442120#54442120", "title": "fastest way to convert int8 to int7", "body": "<p>If you are not concerned about what happens to out-of-range values, then</p>\n\n<pre><code>return val &amp; 0x7f;\n</code></pre>\n\n<p>is enough. This correctly handles values in the range <code>-64 &lt;= val &lt;= 63</code>.\nYou haven't said how you want to handle out-of-range values, so I have nothing to say about that.</p>\n\n<p><strong>Updated to add:</strong> The question has been updated so stipulate that the function will never be called with out-of-range values. So this method qualifies unambiguously as \"best and fastest\".</p>\n"}, {"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548859052, "post_id": 54442683, "comment_id": 95695142, "body": "Interesting... From standard&#39;s point of view, the compiler can chose, though, if it wants to fill the bit field from left to right or from right to left (solely the order of the members must remain the same), so at least in theory, this is not fully portable. Specified toolchain, though, starts filling at MSB, so we&#39;re fine... (Actually, I don&#39;t know any other either that does not do so - maybe on some BE platform?)"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548859465, "post_id": 54442683, "comment_id": 95695405, "body": "I use only s.x in code, all compilers I tried (gcc, clang, msvc) optimize usage of that s entirely out."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1548859508, "post_id": 54442683, "comment_id": 95695431, "body": "@Aconcagua, it doesn&#39;t matter how the compiler <i>represents</i> the bitfield&#39;s value.  No operations used in this approach depend on that for producing the wanted result.  I don&#39;t agree that this is <i>best</i>, but it will work fine."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548859748, "post_id": 54442683, "comment_id": 95695599, "body": "@JohnBollinger The output <i>is</i> correct in any case - a compiler chosing to fill the bitfield starting at MSB might need (up to) two additional shifts, though, and the solution might not be the fastest any more... Possibly of theoretical interest only, as mentioned already, I don&#39;t know any such compiler either..."}], "tags": [], "owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "is_accepted": false, "score": 3, "last_activity_date": 1548860300, "last_edit_date": 1548860300, "creation_date": 1548857975, "answer_id": 54442683, "question_id": 54441860, "link": "https://stackoverflow.com/questions/54441860/fastest-way-to-convert-int8-to-int7/54442683#54442683", "title": "fastest way to convert int8 to int7", "body": "<p>Use bitfield to narrow the value and let compiler to choose what sequence of shifts and/or masks is most efficient for that on your platform.</p>\n\n<pre><code>inline uint8_t to7bit(int8_t x) \n{ \n    struct {uint8_t x:7;} s; \n    return s.x = x; \n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 1, "creation_date": 1548858482, "post_id": 54442792, "comment_id": 95694750, "body": "You mean <code>[-64,63]</code>. Or <code>[-64,64)</code>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 0, "creation_date": 1548858614, "post_id": 54442792, "comment_id": 95694828, "body": "@TonyK yes, fixed the typo"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548858639, "post_id": 54442792, "comment_id": 95694849, "body": "And clearing the reserved bit has exactly the right semantics for inputs in the allowed range. We can see that by looking at the reverse transformation: if we have a 7-bit two&#39;s complement representation of a negative number, then sign-extension to 8 bits means adding a leading 1 bit.  That&#39;s value-preserving.  Thus, going back the other way just requires ignoring or removing the extra bit."}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 0, "creation_date": 1548858909, "post_id": 54442792, "comment_id": 95695048, "body": "func_int7_t(-63) it should return [0bX1100001]. my question is not involving the 8th-bit. [X] = doesnt matter if its 0 or 1! and that comment from me is wrong because it should return [0bX1111110] which is (-63) in (7-bit binary representation)"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1548859391, "post_id": 54442792, "comment_id": 95695363, "body": "it it doesn&#39;t matter then why bothering asking this? Just return the value like above. And -63 is <b>not</b> 1111110. Did you see that the last bit is zero which indicates an even number? Try opening calculator and you&#39;ll see -63 = 1000001 immediately"}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 0, "creation_date": 1548860245, "post_id": 54442792, "comment_id": 95695976, "body": "you are right. although i put the first answer i saw as correct answer. thanks."}], "tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 4, "last_activity_date": 1548858604, "last_edit_date": 1548858604, "creation_date": 1548858324, "answer_id": 54442792, "question_id": 54441860, "link": "https://stackoverflow.com/questions/54441860/fastest-way-to-convert-int8-to-int7/54442792#54442792", "title": "fastest way to convert int8 to int7", "body": "<p>To clear the reserved bit, just</p>\n\n<pre><code>return val &amp; 0x7f;\n</code></pre>\n\n<p>To leave the reserved bit exactly like how it was from input, nothing needs to be done</p>\n\n<pre><code>return val;\n</code></pre>\n\n<p>and the low 7 bits will contain the values in [-64, 63]. Because in two's complement down casting is done by a simple truncation. The value remains the same. That's what happens for an assignment like <code>(int8_t)some_int_value</code></p>\n\n<p><strong>There's no such thing as <code>0bX1100001</code></strong>. There's no undefined bit in machine language. That state only exists in hardware, like the high-Z state or undefined state in Verilog or other hardware description languages</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548859131, "post_id": 54442812, "comment_id": 95695188, "body": "I agree that the low-order 7 bits of a valid input are already correct, and that therefore nothing needs to be done to them.  This is in fact the point of the two answers that suggest just masking off the other.  Perhaps, then, doing nothing is indeed best, but that&#39;s not consistent with the example code, which forces the other bit clear."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1548859284, "post_id": 54442812, "comment_id": 95695293, "body": "@JohnBollinger Question now is: Is clearing the bit really a requirement or was that a misunderstanding when the question was asked..."}, {"owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 0, "creation_date": 1548859365, "post_id": 54442812, "comment_id": 95695353, "body": "my soloution in the question is wrong which lead to wrong answers.  no and actually i started to feel that this is going to be complicated. calling function with value (-63) which is [0b\u202d11000001\u202c] should return [0bX1111111] - X means i dont care."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 0, "creation_date": 1548859754, "post_id": 54442812, "comment_id": 95695602, "body": "@Hasanalattar why should it be 1111111? If you use some strange encoding instead of two&#39;s complement then you must include the mapping in the question["}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "edited": false, "score": 2, "creation_date": 1548859761, "post_id": 54442812, "comment_id": 95695612, "body": "@Hasanalattar, in 7-bit two&#39;s complement, <code>0b1111111</code> represents -1, not -63.  -63 would be represented as 0b1000001.  If you mean to convert to a sign/magnitude representation then that&#39;s a whole different kettle of fish."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1548858390, "creation_date": 1548858390, "answer_id": 54442812, "question_id": 54441860, "link": "https://stackoverflow.com/questions/54441860/fastest-way-to-convert-int8-to-int7/54442812#54442812", "title": "fastest way to convert int8 to int7", "body": "<blockquote>\n  <p>the user who calls this function he knows he should put data -64 to +63</p>\n</blockquote>\n\n<p>So not considering any other values, the <em>really</em> fastest thing you can do is <strong>not doing anything at all</strong>!</p>\n\n<p>You have a 7 bit value stored in eight bits. Any value within specified range will have both bit 7 and bit 6 the same value, and when you process the 7-bit value, you just <em>ignore</em> the MSB (of 8-bit value), no matter if set or not, e. g.:</p>\n\n<pre><code>for(unsigned int bit = 0x40; bit; bit &gt;&gt;= 1)\n//                NOT: 0x80!\n    std::cout &lt;&lt; (value &amp; bit);\n</code></pre>\n\n<p>The other way round is more critical: whenever you receive these seven bits via some communication channel, then you need to do manual sign extension for eight (or more) bits to be able to correctly use that value.</p>\n"}], "owner": {"reputation": 335, "user_id": 4410536, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3KcpjUeSFF4/AAAAAAAAAAI/AAAAAAAAACQ/8hERVilrhmk/photo.jpg?sz=128", "display_name": "Hasan alattar", "link": "https://stackoverflow.com/users/4410536/hasan-alattar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 54442120, "answer_count": 5, "score": -3, "last_activity_date": 1548899010, "creation_date": 1548855410, "last_edit_date": 1548899010, "question_id": 54441860, "link": "https://stackoverflow.com/questions/54441860/fastest-way-to-convert-int8-to-int7", "title": "fastest way to convert int8 to int7", "body": "<p>I've a function that takes <code>int8_t val</code> and converts it to <code>int7_t</code>.</p>\n\n<pre><code>//Bit [7] reserved\n//Bits [6:0] = signed -64 to +63 offset value\n// user who calls this function will use it correctly (-64 to +63)\nuint8_t func_int7_t(int8_t val){\n    uint8_t val_6 = val &amp; 0b01111111;\n    if (val &amp; 0x80)\n        val_6 |= 0x40;\n    //...\n    //do stuff...\n    return val_6;\n}\n</code></pre>\n\n<p>What is the <strong>best and fastest</strong> way to manipulate the int8 to int7? Did I do it efficient and fast? or there is better way?</p>\n\n<p>The target is ARM Cortex M0+ if that matters</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>After reading different answers I can say the question was asked wrong? (or my code in the question is what gave wrong assumptions to others) I had the intension to make an int8 to int7 </p>\n\n<p>So it will be done by doing nothing because</p>\n\n<p>8bit:</p>\n\n<pre><code> 63 = 0011 1111\n 62 = 0011 1110\n  0 = 0000 0000\n -1 = 1111 1111\n -2 = 1111 1110\n-63 = 1100 0001\n-64 = 1100 0000\n</code></pre>\n\n<p>7bit:</p>\n\n<pre><code> 63 = 011 1111\n 62 = 011 1110\n  0 = 000 0000\n -1 = 111 1111\n -2 = 111 1110\n-63 = 100 0001\n-64 = 100 0000\n</code></pre>\n"}, {"tags": ["python", "c++", "cpython", "python-c-api", "python-embedding"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5043068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf757fcee7cb7d7debb13d6afe80c8b3?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas M", "link": "https://stackoverflow.com/users/5043068/srinivas-m"}, "edited": false, "score": 0, "creation_date": 1548907615, "post_id": 54452275, "comment_id": 95714534, "body": "Thanks Davis, how to interrupt the thread (which is not main thread) which is executing PyRun_FileExFlags"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 55, "user_id": 5043068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf757fcee7cb7d7debb13d6afe80c8b3?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas M", "link": "https://stackoverflow.com/users/5043068/srinivas-m"}, "edited": false, "score": 0, "creation_date": 1548907840, "post_id": 54452275, "comment_id": 95714590, "body": "@srinivasM: I don\u2019t think Python knows more than what thread called <code>Py_Initialize</code>\u2014can you arrange for it to be the same one?"}, {"owner": {"reputation": 55, "user_id": 5043068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf757fcee7cb7d7debb13d6afe80c8b3?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas M", "link": "https://stackoverflow.com/users/5043068/srinivas-m"}, "edited": false, "score": 0, "creation_date": 1549280725, "post_id": 54452275, "comment_id": 95833602, "body": "Thanks @Davis: it worked for main thread. Can you suggest if there is a way to stop other threads?"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 55, "user_id": 5043068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf757fcee7cb7d7debb13d6afe80c8b3?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas M", "link": "https://stackoverflow.com/users/5043068/srinivas-m"}, "edited": false, "score": 0, "creation_date": 1549289454, "post_id": 54452275, "comment_id": 95838631, "body": "@srinivasM: There is <a href=\"https://docs.python.org/3/c-api/init.html?highlight=pythreadstate_setasyncexc#c.PyThreadState_SetAsyncExc\" rel=\"nofollow noreferrer\">PyThreadState_SetAsyncExc</a>, but I don\u2019t know how to get its <code>id</code> argument."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": true, "score": 1, "last_activity_date": 1548900021, "creation_date": 1548900021, "answer_id": 54452275, "question_id": 54441587, "link": "https://stackoverflow.com/questions/54441587/how-to-interrupt-python-interpreter-embedded-in-c-application/54452275#54452275", "title": "How to interrupt python interpreter embedded in C++ application", "body": "<p><code>PyEval_SetTrace</code> affects the <strong>current thread</strong> only.</p>\n\n<p>You want <a href=\"https://docs.python.org/3/c-api/exceptions.html?highlight=pyerr_setinterrupt#c.PyErr_SetInterrupt\" rel=\"nofollow noreferrer\"><code>PyErr_SetInterrupt</code></a>.  It interrupts (what Python considers to be) the <strong>main thread</strong>, regardless of the calling thread (which need not bother with the GIL).</p>\n"}], "owner": {"reputation": 55, "user_id": 5043068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf757fcee7cb7d7debb13d6afe80c8b3?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas M", "link": "https://stackoverflow.com/users/5043068/srinivas-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 1, "accepted_answer_id": 54452275, "answer_count": 1, "score": 4, "last_activity_date": 1548900021, "creation_date": 1548854469, "last_edit_date": 1548855667, "question_id": 54441587, "link": "https://stackoverflow.com/questions/54441587/how-to-interrupt-python-interpreter-embedded-in-c-application", "title": "How to interrupt python interpreter embedded in C++ application", "body": "<p>We have a C++ QT application, we embedded python in it. \nWe provided two interfaces to the user\n      1. Execute file\n      2. Stop execution.\nWe execute a python file in a non GUI thread, using PyRun_FileExFlags.\nWe would like to interrupt python file execution (assume python file has an infinite loop, it never completes execution).\nHow to interrupt?</p>\n\n<p>We tried following\n1. In main thread set trace using PyEval_SetTrace\n2. (if user click on Stop execution) In the trace call back function we set error \"PyErr_SetString\"</p>\n\n<p>1:setting trace function</p>\n\n<pre><code>PyGILState_STATE state;\nstate = PyGILState_Ensure();                \nPyEval_SetTrace(TraceHook, NULL);\nPyGILState_Release(state);\n</code></pre>\n\n<p>2:trace function </p>\n\n<pre><code>int TraceHook(PyObject *obj, PyFrameObject *frame, int what, PyObject *arg)\n{\nif (b_isInterrupted)\n{\nPyGILState_STATE state;\nstate = PyGILState_Ensure();\nPyErr_SetString(PyExc_KeyboardInterrupt, \"Python Interrupted.\");\nPyGILState_Release(state);\n}\nreturn 0;\n}\n</code></pre>\n\n<p>Python execution is not interrupted.\nI expect python execution to interrupt.</p>\n"}, {"tags": ["c++", "idioms"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1548854099, "post_id": 54441440, "comment_id": 95691948, "body": "why do you think this would be an &quot;absue&quot; of the short circuiting operator? Thats exactly what it is good for..."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1548854191, "post_id": 54441440, "comment_id": 95692010, "body": "Instead of having <code>N</code> different and distinct variables, why not have an array or a vector of <code>N</code> elements? Then it&#39;s easy to loop from start to end and break out of the loop once the function returns true. It would incidentally also make it much easier to add or remove objects as existing code doesn&#39;t need to be changed to reflect the new or removed variables. And of course make your classes less crowded with members."}, {"owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548854254, "post_id": 54441440, "comment_id": 95692053, "body": "@user463035818 I guess because I&#39;m somehow thinking of <code>||</code> as a <i>logical</i> operation, which I&#39;m instead using here directly to control program flow... but you might be right, maybe this is the best way to do this."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548854268, "post_id": 54441440, "comment_id": 95692062, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your question is sprinkled with strange premises which makes it hard to understand what your real problem is"}, {"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "edited": false, "score": 0, "creation_date": 1548854272, "post_id": 54441440, "comment_id": 95692066, "body": "Everybody is trying vectorize and you guys want to go back to loop?"}, {"owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548854452, "post_id": 54441440, "comment_id": 95692176, "body": "@Someprogrammerdude Since the potentiometers themselves are used in different ways at different places, so I prefer to give them explicit names. Of course, I could put them in an array and then use named references to them, but that again feels like  adding unnecessary boilerplate."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548854877, "post_id": 54441440, "comment_id": 95692466, "body": "Well you could use named constants (macros or <code>const</code> or <code>constexpr</code> or even <code>enum</code>) for indexes into the array. Like <code>POT_FOR_THING1</code> or <code>POT_FOR_THING2</code> when you need to get a specific object from the array. Might add some extra boilerplate code in some places, but might also make other parts of the code <i>much</i> easier. Unless the condition you show won&#39;t include <i>all</i> of the elements in the array?"}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "edited": false, "score": 0, "creation_date": 1548855679, "post_id": 54441663, "comment_id": 95692951, "body": "+1, this is exactly the type of alternative I was looking for! I&#39;ll need to check how does this loop compile, though: if the compiler actually creates the array of references (as pointers) on the stack, this might be slower than just calling <code>savePotentiometerState</code> for all pots every time, and it would also take stack space (the system has a total of 96K RAM, so rather small amounts of memory matter here)."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 4, "last_activity_date": 1548854717, "creation_date": 1548854717, "answer_id": 54441663, "question_id": 54441440, "link": "https://stackoverflow.com/questions/54441440/evaluate-expressions-until-one-returns-true/54441663#54441663", "title": "Evaluate expressions until one returns true", "body": "<p>Loop seems the way to go:</p>\n\n<pre><code>for (auto&amp; pot : {std::ref(pot1), std::ref(pot2), /*..,*/ std::ref(potn)}) {\n     if (savePotentiometerState(pot)) {\n         break;\n     }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 1, "creation_date": 1548856614, "post_id": 54441773, "comment_id": 95693529, "body": "Excellent ... Readable, and simple to test.  Starvation (caused by improper use of hardware) can be very difficult to diagnose, or even recognize.  (Been there, Done that)"}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1548855128, "creation_date": 1548855128, "answer_id": 54441773, "question_id": 54441440, "link": "https://stackoverflow.com/questions/54441440/evaluate-expressions-until-one-returns-true/54441773#54441773", "title": "Evaluate expressions until one returns true", "body": "<p>Personally - I'd avoid the algorithm you're using.</p>\n\n<p>I'd save the state for every pot all the time; and track the current and previous values; and then only call a given callback if if the value had changed.</p>\n\n<p>This way, <code>savePotState</code> is always as fast as it needs to be for a given pot; and you'll never get into the state where pot1 to pot(n-1) can block potn from being read.</p>\n"}, {"comments": [{"owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "edited": false, "score": 0, "creation_date": 1548942062, "post_id": 54441930, "comment_id": 95731851, "body": "I think this is it: it should be no slower than writing the conditions by hand, and I can name the helper function to signal exactly what is the <i>intention</i> of the code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "edited": false, "score": 1, "creation_date": 1548942364, "post_id": 54441930, "comment_id": 95732018, "body": "@Timo This very well could be slower.  Since it takes be reference it has to dereference it to get it&#39;s value since the compiler can&#39;t know if something else made a modification.  Your <code>const bool retval = </code> or the if statements are probably the fastest.  Jarods might also have the same speed since the references are local to the scope so the compiler knows they aren&#39;t changed.  You can use <a href=\"http://quick-bench.com/\" rel=\"nofollow noreferrer\">quick bench</a> to test."}, {"owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "edited": false, "score": 0, "creation_date": 1548943310, "post_id": 54441930, "comment_id": 95732554, "body": "Hmm, I&#39;d imagine that since the references are local, and assuming that the helper gets inlined, it should be quite easy for the compiler to eliminate the references... but of course, assumption is the mother of all ******s, so maybe I will write the quick bench test tomorrow (thanks for the link, by the way!)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "edited": false, "score": 0, "creation_date": 1548943385, "post_id": 54441930, "comment_id": 95732612, "body": "@Timo No problem.  If it&#39;s inlined then it shouldn&#39;t be an issue.  I just wanted to point out it could be slower."}, {"owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 0, "creation_date": 1548947693, "post_id": 54441930, "comment_id": 95735317, "body": "I really like this post and I have already tested these solutions on a simple case yesterday, <a href=\"http://quick-bench.com/IfymV9b0disWqIQbcpXfc5aPqAQ\" rel=\"nofollow noreferrer\">DEMO</a>. As NathanOliver suggested, Jarod\u2019s loop approach seems to show best performance. Of course, template functions should be inlined and rather memory friendly."}, {"owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "reply_to_user": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "edited": false, "score": 1, "creation_date": 1549008610, "post_id": 54441930, "comment_id": 95757848, "body": "@Hiroki thanks for writing the test! Indeed, the loop seems even faster than the naive <code>||</code>ing, funny enough! On the other hand, changing the compiler to GCC7.2 makes the naive way fastest, with the fold expression a very close second. In my case, the compiler is actually gcc-arm-none-eabi 7.2, so I&#39;ll need to try the benchmark using that, since the results are so close."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1548856309, "last_edit_date": 1548856309, "creation_date": 1548855646, "answer_id": 54441930, "question_id": 54441440, "link": "https://stackoverflow.com/questions/54441440/evaluate-expressions-until-one-returns-true/54441930#54441930", "title": "Evaluate expressions until one returns true", "body": "<p>Since you can use C++17 you can leverage <a href=\"https://en.cppreference.com/w/cpp/language/fold\" rel=\"nofollow noreferrer\">fold expressions</a> and write a helper function to do the evaluation for you.</p>\n\n<pre><code>template&lt;typename... Args&gt;\nbool returtnPotentiometerState(Args&amp;&amp;... args)\n{\n    return (... || savePotentiometerState(args));\n}\n</code></pre>\n\n<p>and then you would call it like</p>\n\n<pre><code>if (returtnPotentiometerState(pot1, pot2, ..., potn))\n</code></pre>\n\n<p>This means you don't have a loop, and you get short circuiting.</p>\n"}], "owner": {"reputation": 615, "user_id": 3173540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895cb651d7d697d390edf795fe69a11f?s=128&d=identicon&r=PG&f=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/3173540/timo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 54441930, "answer_count": 3, "score": 3, "last_activity_date": 1548856309, "creation_date": 1548853916, "question_id": 54441440, "link": "https://stackoverflow.com/questions/54441440/evaluate-expressions-until-one-returns-true", "title": "Evaluate expressions until one returns true", "body": "<p>I have a <code>savePotentiometerState(...)</code> -function, which returns <code>true</code> if the there were changes to save, and <code>false</code> if nothing was done. Further, I know that on any single pass through my main loop, at most one of the potentiometers may have changed (due to the way they're read out).</p>\n\n<p>This is on a very time-constrained embedded platform, so it's important (or at least matters) that I don't call <code>savePotentiometerState</code> more often than I have to. However, the code I come up with naturally seems silly, something likely to end up at thedailywtf:</p>\n\n<pre><code>if (!savePotentiometerState(pot1))\n  if (!savePotentiometerState(pot2))\n    ...\n      if (!savePotentiometerState(potn));\n</code></pre>\n\n<p>Another way to do this would be to use short-circuit evaluation:</p>\n\n<pre><code>const bool retval = savePotentiometerState(pot1) || savePotentiometerState(pot2) || ... || savePotentiometerState(potn);\n</code></pre>\n\n<p>I suppose I could even drop the assignment here. But this doesn't feel like good style either, since I'm abusing the short circuiting of the <code>||</code> operator.</p>\n\n<p>The various <code>potn</code> objects are member variables of the containing class, so there's no obvious way to write this as a loop.</p>\n\n<p>I feel like I'm missing something obvious here, so my question is: is there an idiomatic/easy to read way to do this, which doesn't sacrifice efficiency? If it matters, I'm using C++17.</p>\n"}, {"tags": ["c++", "pointers", "iteration", "heap-memory"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 5, "creation_date": 1548853525, "post_id": 54441263, "comment_id": 95691595, "body": "really curious: do you have any evidence that your code performs better than simply accessing <code>bar[i].b[2];</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548853644, "post_id": 54441263, "comment_id": 95691672, "body": "btw the title is slightly misleading as you are not iterating over the members of the struct, but you access always the same member while iterating over the elements in the vector"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548853709, "post_id": 54441263, "comment_id": 95691702, "body": "well after reading it again, the title is actually fine (still can be misunderstood)"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548853733, "post_id": 54441263, "comment_id": 95691718, "body": "Why are you doing what you&#39;re doing with that pointer arithmetic? What is the <i>real</i> problem you try to solve with it? Code for array access will still be generated as code for pointer arithmetic (for any array or pointer <code>a</code> and index <code>i</code>, the expressions <code>a[i]</code> is <i>exactly</i> equal to <code>*(a + i)</code>)."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1548853823, "post_id": 54441263, "comment_id": 95691767, "body": "what makes me highly doubt that your code is a real optimization is that you dont use any information that the compiler cannot use also. I would actaully be not too surprised if a compiler emits same output for your code and the same loop written by using the vectors <code>operator[]</code>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548853857, "post_id": 54441263, "comment_id": 95691782, "body": "As for any optimizations, have you measured that what you&#39;re trying to optimize is a bottleneck in the real code? Have you profiled and benchmarked? It&#39;s not a case of premature optimization? Always concentrate on writing good, readable, maintainable and working code first of all. Then if the performance is not up to the requirements (and remember that &quot;good enough&quot; often <i>is</i> good enough), then measure to find your bottlenecks and optimize the worst with plenty of documentation (as optimizations tends to create bad code)."}, {"owner": {"reputation": 179, "user_id": 10990205, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155783679050945/picture?type=large", "display_name": "Bevan Jones", "link": "https://stackoverflow.com/users/10990205/bevan-jones"}, "edited": false, "score": 0, "creation_date": 1548854323, "post_id": 54441263, "comment_id": 95692103, "body": "I have some module that can&#39;t see the struct, but on initialization, pointers are set up to the data. Sorry, the snippet is more asking specifically about the iteration procedure as it would solve my current problem. I can add more detail if required."}, {"owner": {"reputation": 179, "user_id": 10990205, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155783679050945/picture?type=large", "display_name": "Bevan Jones", "link": "https://stackoverflow.com/users/10990205/bevan-jones"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548854352, "post_id": 54441263, "comment_id": 95692125, "body": "@Someprogrammerdude was just talking to someone in the office going to get on that now."}, {"owner": {"reputation": 179, "user_id": 10990205, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155783679050945/picture?type=large", "display_name": "Bevan Jones", "link": "https://stackoverflow.com/users/10990205/bevan-jones"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548938920, "post_id": 54441263, "comment_id": 95729875, "body": "@Someprogrammerdude so I ran tests and it is very definitely pointer chasing and the above code that is the bottleneck."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548853995, "post_id": 54441408, "comment_id": 95691882, "body": "OP does stay within the same array, but the pointer is not to an element in the array (but with some offset). I think you are right, I am just not sure about the details"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1548854078, "post_id": 54441408, "comment_id": 95691931, "body": "@user463035818 Added the explanation."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1548854172, "post_id": 54441408, "comment_id": 95691998, "body": "OP could use pointers to elements in the array for the arithmetics and only then add the offset to reach the member of the struct, but I guess that just shifts the UB"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1548854270, "post_id": 54441408, "comment_id": 95692064, "body": "@user463035818 Well you would have to apply a member pointer to the <code>foo</code> array element you dereferenced and the pointer arithmetic to go to the right inner array index. Which is just a crazy-complicated way of doing <code>bar[i].b[y]</code>."}, {"owner": {"reputation": 179, "user_id": 10990205, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155783679050945/picture?type=large", "display_name": "Bevan Jones", "link": "https://stackoverflow.com/users/10990205/bevan-jones"}, "edited": false, "score": 0, "creation_date": 1548856347, "post_id": 54441408, "comment_id": 95693343, "body": "@MaxLanghof would there be any change to your answer considering my edited snippet, although I understand it will still not be legal."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 179, "user_id": 10990205, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155783679050945/picture?type=large", "display_name": "Bevan Jones", "link": "https://stackoverflow.com/users/10990205/bevan-jones"}, "edited": false, "score": 0, "creation_date": 1548857184, "post_id": 54441408, "comment_id": 95693924, "body": "@BevanJones Correct, it would still not be legal. And there is no way to make &quot;assume that there is an array of enclosing compound objects around a given <code>double*</code> and point into the internals of one of its other elements&quot; legal C++ other than by writing code where the assumption is explicit (i.e. encoded in the types passed). In other words, if you want a function to dig through objects in a <code>vector&lt;foo&gt;</code>, that function must know about that <code>vector&lt;foo&gt;</code>."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 6, "last_activity_date": 1548854688, "last_edit_date": 1548854688, "creation_date": 1548853833, "answer_id": 54441408, "question_id": 54441263, "link": "https://stackoverflow.com/questions/54441263/iterating-through-a-vector-of-stuctss-members-with-pointers-and-offsets/54441408#54441408", "title": "Iterating through a vector of stucts&#39;s members with pointers and offsets", "body": "<p>No, this is not legal C++. Pointer arithmetic is only defined if you stay inside the same array (or one past its end).</p>\n\n<blockquote>\n  <p><a href=\"http://eel.is/c++draft/expr.add#4\" rel=\"noreferrer\">expr.add#4</a></p>\n  \n  <p>When an expression <code>J</code> that has integral type is added to or subtracted from an expression <code>P</code> of pointer type, the result has the type of <code>P</code>.</p>\n  \n  <ul>\n  <li><p>(4.1)\n  If <code>P</code> evaluates to a null pointer value and <code>J</code> evaluates to <code>0</code>, the result is a null pointer value.</p></li>\n  <li><p>(4.2)\n  Otherwise, if <code>P</code> points to element <code>x[i]</code> of an array object <code>x</code> with n elements, the expressions <code>P + J</code> and <code>J + P</code> (where <code>J</code> has the value <code>j</code>) point to the (possibly-hypothetical) element <code>x[i+j]</code> if <code>0\u2264i+j\u2264n</code> and the expression <code>P - J</code> points to the (possibly-hypothetical) element <code>x[i\u2212j]</code> if <code>0\u2264i\u2212j\u2264n</code>.</p></li>\n  <li><p>(4.3)\n  Otherwise, the behavior is undefined.</p></li>\n  </ul>\n</blockquote>\n\n<p>(4.1) does not apply because you're not operating on <code>nullptr</code>s. (4.2) does not apply because you are working with <code>double*</code>, so <code>x</code> in the standard quote must be a <code>double</code> array, i.e. the <code>b</code> member of your struct. Leaving its bounds with pointer arithmetic, according to the remaining (4.3), is undefined behavior.</p>\n\n<p>What you are trying to do here is exactly what a good compiler should (and will) do under the hood anyway:</p>\n\n<pre><code>volatile double output;\n\nvoid bar(std::vector&lt;foo&gt; bar, int innerOffset)\n{\n    for (foo&amp; f : bar)\n        output = f.b[innerOffset];\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/S9qkTf\" rel=\"noreferrer\">https://godbolt.org/z/S9qkTf</a></p>\n\n<p>Notice how the disassembly does the pointer arithmetic you want (because the compiler knows that it works <em>on the target platform</em>). Here is the innermost loop:</p>\n\n<pre><code>.L3:\n    movsd   xmm0, QWORD PTR [rax+24+rsi*8]\n    add     rax, 104\n    movsd   QWORD PTR output[rip], xmm0\n    cmp     rdx, rax\n    jne     .L3\n</code></pre>\n\n<p>104 bytes is exactly how big one <code>foo</code> is. The <code>[rax+24+rsi*8]</code> expression is doing all the additional pointer arithmetic for free.</p>\n"}], "owner": {"reputation": 179, "user_id": 10990205, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155783679050945/picture?type=large", "display_name": "Bevan Jones", "link": "https://stackoverflow.com/users/10990205/bevan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54441408, "answer_count": 1, "score": 3, "last_activity_date": 1548856110, "creation_date": 1548853382, "last_edit_date": 1548856110, "question_id": 54441263, "link": "https://stackoverflow.com/questions/54441263/iterating-through-a-vector-of-stuctss-members-with-pointers-and-offsets", "title": "Iterating through a vector of stucts&#39;s members with pointers and offsets", "body": "<p>I am trying to optimize a piece of code by not pointer chasing, as much as I currently am. I want to create a constant offset to add to a stored pointer to get to the next data entry, see below code. However, the data is sitting side a class or struct, containing different data types.</p>\n\n<p>So I get the correct behavior in the below code snippet, ie the output is 1, 2, 3.  </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\n// knows nothing about foo\nclass Readfoo\n{ \n    private:\n    int offset;\n    double* pdouble;\n\n    public:\n    void SetPoint(double* apdouble, int aoffset)  \n    {\n        offset = aoffset;\n        pdouble = apdouble;\n    };\n\n    const double&amp; printfoo(int aidouble) const\n    {\n       return *(pdouble + offset*aidouble);\n    };\n};\n\n// knows nothing about readFoo\nstruct foo\n{ \n    int a[5];\n    double b[10];\n};\n\nint main() \n{\n    // populate some data (choose b [2] or other random entry.).\n    std::vector&lt;foo&gt; bar(10);\n    bar[0].b[2] = 1;\n    bar[1].b[2] = 2;\n    bar[2].b[2] = 3;\n\n    // access b[2] for each foo using an offset.\n    Readfoo newReadfoo;\n    newReadfoo.SetPoint(&amp;(bar[0].b[2]), sizeof(foo)/sizeof(double));\n    for(int ii = 0; ii &lt; 3; ii++)\n    {        \n        std::cout&lt;&lt;\"\\n\"&lt;&lt;newReadfoo.printfoo(ii);\n    }\n    return 0;\n}\n</code></pre>\n\n\n\n<p>My question is two-fold:</p>\n\n<ol>\n<li>Is this code actually legal, and will it ever produce undefined behavior?</li>\n<li>If it is not legal is there a way to, without storing the actual pointers, iterate through foo accessing b[2], in the above case, with some form of constant offset (Like adding the number of bits between the starting address of each data entry.)?</li>\n</ol>\n"}, {"tags": ["c++", "c++17", "stl-algorithm", "unordered-multimap"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1548853558, "post_id": 54441262, "comment_id": 95691619, "body": "Probably not <code>std::default_random_engine</code>, but <code>std::mt19937</code> instead. Some implementations made <a href=\"https://stackoverflow.com/q/21843172/3002139\">interesting choices</a> on that front..."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1548853657, "post_id": 54441262, "comment_id": 95691677, "body": "Even if that compiled, <code>m</code> is still empty container, i.e. there is nothing between m.begin(), m.end(). <code>10</code> is bucket count in this case. Just use simple for loop and avoid all the trouble."}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1548854049, "post_id": 54441409, "comment_id": 95691916, "body": "It&#39;s not hugely far from where OP was to <code>std::generate_n(std::inserter(m, m.begin()), 10, [](){return std::pair{std::rand(),std::rand()};});</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1548854066, "post_id": 54441409, "comment_id": 95691925, "body": "@Caleth You&#39;re right, but this is not readable or expressive code."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 5, "last_activity_date": 1548854166, "last_edit_date": 1548854166, "creation_date": 1548853833, "answer_id": 54441409, "question_id": 54441262, "link": "https://stackoverflow.com/questions/54441262/random-unordered-multimap-using-stdgenerate/54441409#54441409", "title": "Random unordered_multimap using std::generate", "body": "<p>Your code can't work with a map.</p>\n\n<p>From <a href=\"https://en.cppreference.com/w/cpp/algorithm/generate\" rel=\"nofollow noreferrer\">documentation for <code>std::generate</code></a>:</p>\n\n<blockquote>\n  <p>The type <code>Ret</code> must be such that an object of type <code>ForwardIt</code> can be dereferenced and assigned a value of type <code>Ret</code>. \u200b</p>\n</blockquote>\n\n<p>You can't assign a map item's key. The container \"owns\" the key. You can only assign the mapped value. <a href=\"https://stackoverflow.com/a/45167055/560648\">This method of \"setting each element\" is simply unavailable for associative containers.</a></p>\n\n<p>Furthermore, you constructed an <code>unordered_multimap</code> <a href=\"https://en.cppreference.com/w/cpp/container/unordered_multimap/unordered_multimap\" rel=\"nofollow noreferrer\">with bucket size 10, but no actual elements</a>, so your range is empty anyway (maps aren't vectors!).</p>\n\n<p>You could do this with <code>std::inserter</code>:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iterator&gt;\n#include &lt;unordered_map&gt;\n#include &lt;cstdlib&gt;\n\nint main()\n{\n    std::unordered_multimap&lt;int, int&gt; m;\n    std::generate_n(\n        std::inserter(m, m.begin()),\n        10,\n        [](){ return std::pair{std::rand(), std::rand()}; }\n    );\n}\n</code></pre>\n\n<p>&hellip;but, honestly, just do this in a loop and move on. ;)</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n#include &lt;cstdlib&gt;\n\nint main()\n{\n    std::unordered_multimap&lt;int, int&gt; m;\n    for (size_t i = 0; i &lt; 10; i++)\n        m.emplace(std::rand(), std::rand());\n}\n</code></pre>\n\n<p>Everybody can read this.</p>\n"}, {"comments": [{"owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "edited": false, "score": 1, "creation_date": 1548854235, "post_id": 54441478, "comment_id": 95692038, "body": "<code>std::inserter</code> also compiles here. What&#39;s the difference between these two?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "edited": false, "score": 1, "creation_date": 1548854336, "post_id": 54441478, "comment_id": 95692111, "body": "@Przemys\u0142awCzechowski None, now that the template argument can be deduced. <a href=\"https://en.cppreference.com/w/cpp/iterator/inserter\" rel=\"nofollow noreferrer\">It was convenient before that</a>"}, {"owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "edited": false, "score": 0, "creation_date": 1548854430, "post_id": 54441478, "comment_id": 95692166, "body": "Ok, in <code>std::inserter</code> example, filling a set is done with: <code>std::fill_n(std::inserter(s, s.end()), 5, 2);</code>. So should I use <code>begin</code> or <code>end</code> of the container?"}, {"owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "edited": false, "score": 1, "creation_date": 1548854576, "post_id": 54441478, "comment_id": 95692264, "body": "Yes, it only saves typing. In pre-C++17, the class templates were the ones harder to type, as everyone would use the function template creating the type (e.g. <code>std::back_inserter</code> vs. <code>std::back_insert_iterator</code>). With class template argument deduction, this has changed. I would actually recommend using <code>std::inserter</code>."}], "tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": true, "score": 5, "last_activity_date": 1548855531, "last_edit_date": 1548855531, "creation_date": 1548854073, "answer_id": 54441478, "question_id": 54441262, "link": "https://stackoverflow.com/questions/54441262/random-unordered-multimap-using-stdgenerate/54441478#54441478", "title": "Random unordered_multimap using std::generate", "body": "<p>You can use the <a href=\"https://en.cppreference.com/w/cpp/iterator/insert_iterator\" rel=\"nofollow noreferrer\"><code>std::insert_iterator</code></a> class template to achieve what you're looking for:</p>\n\n<pre><code>auto m = std::unordered_multimap&lt;int, int&gt;{};\n\nstd::generate_n(std::insert_iterator(m, m.begin()),\n     10, [](){ return std::pair{std::rand(),std::rand()}; }); \n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 54441478, "answer_count": 2, "score": 4, "last_activity_date": 1548855531, "creation_date": 1548853372, "last_edit_date": 1548853950, "question_id": 54441262, "link": "https://stackoverflow.com/questions/54441262/random-unordered-multimap-using-stdgenerate", "title": "Random unordered_multimap using std::generate", "body": "<p>I'm trying to generate a random <code>unordered_multimap</code> of size 10 using the following code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;algorithm&gt;\n#include &lt;unordered_map&gt;\n#include &lt;cstdlib&gt;\n\nint main()\n{\n    auto m = std::unordered_multimap&lt;int, int&gt;(10);\n    std::generate(\n        m.begin(),\n        m.end(),\n        [](){return std::pair{std::rand(),std::rand()};}\n    );\n} \n</code></pre>\n\n<p>But it won't compile with an error</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code> In file included from /usr/include/c++/7/algorithm:62:0,\n                 from main.cpp:2:\n/usr/include/c++/7/bits/stl_algo.h: In instantiation of \u2018void std::generate(_FIter, _FIter, _Generator) [with _FIter = std::__detail::_Node_iterator&lt;std::pair&lt;const int, int&gt;, false, false&gt;; _Generator = main()::&lt;lambda()&gt;]\u2019:\n&lt;span class=\"error_line\" onclick=\"ide.gotoLine('main.cpp',11)\"&gt;main.cpp:11:5&lt;/span&gt;:   required from here\n/usr/include/c++/7/bits/stl_algo.h:4438:11: error: use of deleted function \u2018std::pair&lt;_T1, _T2&gt;&amp; std::pair&lt;_T1, _T2&gt;::operator=(typename std::conditional, std::is_copy_assignable&lt;_T2&gt; &gt; &gt;::value, const std::pair&lt;_T1, _T2&gt;&amp;, const std::__nonesuch_no_braces&amp;&gt;::type) [with _T1 = const int; _T2 = int; typename std::conditional, std::is_copy_assignable&lt;_T2&gt; &gt; &gt;::value, const std::pair&lt;_T1, _T2&gt;&amp;, const std::__nonesuch_no_braces&amp;&gt;::type = const std::pair&amp;]\u2019\n  *__first = __gen();\n  ~~~~~~~~~^~~~~~~~~\nIn file included from /usr/include/c++/7/utility:70:0,\n                 from /usr/include/c++/7/unordered_map:38,\n                 from main.cpp:1:\n/usr/include/c++/7/bits/stl_pair.h:378:7: note: declared here\n       operator=(typename conditional&lt;\n       ^~~~~~~~\n</code></pre>\n\n<p><strong>Q</strong>: Is it possible to generate a random <code>unordered_multimap</code> using <code>std::generate</code>? If not, what's the best way to do it?</p>\n\n<p>PS: I know I should be using <code>std::default_random_engine</code> instead of <code>std::rand</code>, and I do in the real code, this is just for demonstrative purposes.</p>\n"}, {"tags": ["c++", "sql-server", "ssms", "c++builder"], "comments": [{"owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 2, "creation_date": 1548853640, "post_id": 54441241, "comment_id": 95691668, "body": "As to why you are apparently getting different execution plans, <a href=\"http://www.sommarskog.se/query-plan-mysteries.html\" rel=\"nofollow noreferrer\">see this</a>."}, {"owner": {"reputation": 241702, "user_id": 61305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eVyZv.jpg?s=128&g=1", "display_name": "Aaron Bertrand", "link": "https://stackoverflow.com/users/61305/aaron-bertrand"}, "edited": false, "score": 0, "creation_date": 1548856073, "post_id": 54441241, "comment_id": 95693178, "body": "Also see <a href=\"https://sqlperformance.com/2014/11/t-sql-queries/multiple-plans-identical-query\" rel=\"nofollow noreferrer\">this post</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3718027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HhdKL.png?s=128&g=1", "display_name": "Mochu33", "link": "https://stackoverflow.com/users/3718027/mochu33"}, "edited": false, "score": 0, "creation_date": 1548953762, "post_id": 54441401, "comment_id": 95739092, "body": "In fact if I execute an update statistics against the tables involved, the execution time return normal (between 100ms and 250ms)"}, {"owner": {"reputation": 2291, "user_id": 2782112, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/680947804/picture?type=large", "display_name": "Matthew Baker", "link": "https://stackoverflow.com/users/2782112/matthew-baker"}, "reply_to_user": {"reputation": 1, "user_id": 3718027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HhdKL.png?s=128&g=1", "display_name": "Mochu33", "link": "https://stackoverflow.com/users/3718027/mochu33"}, "edited": false, "score": 0, "creation_date": 1549035292, "post_id": 54441401, "comment_id": 95772083, "body": "Its all down to minor differences in the ways the calls are made. So long as you&#39;ve got a working solution then thats great.  Accepting this as an answer will help other user identify what has worked for others in the past."}, {"owner": {"reputation": 1, "user_id": 3718027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HhdKL.png?s=128&g=1", "display_name": "Mochu33", "link": "https://stackoverflow.com/users/3718027/mochu33"}, "edited": false, "score": 0, "creation_date": 1551198318, "post_id": 54441401, "comment_id": 96548956, "body": "I had detected where the problem is. It&#39;s a statistics problem. When the store proc is executed the execution plan turned old after a few executions. So I modified my store procedure adding WITH RECOMPILE option. The plan is redefined every execution. It&#39;s a little tough solution but it works."}], "tags": [], "owner": {"reputation": 2291, "user_id": 2782112, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/680947804/picture?type=large", "display_name": "Matthew Baker", "link": "https://stackoverflow.com/users/2782112/matthew-baker"}, "is_accepted": false, "score": 1, "last_activity_date": 1548853821, "creation_date": 1548853821, "answer_id": 54441401, "question_id": 54441241, "link": "https://stackoverflow.com/questions/54441241/problem-executing-stored-procedure-in-my-code/54441401#54441401", "title": "Problem executing stored procedure in my code", "body": "<p>Have seen this several times - it catches a lot of us.  Check the settings against your call for things like ansi nulls on/off, other settings etc.  Changes like that lead to different execution plans.  See \n<a href=\"https://stackoverflow.com/questions/53526087/sql-faster-in-ssms-than-in-application/53536961#53536961\">SQL faster in ssms than in application</a> for details.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3718027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HhdKL.png?s=128&g=1", "display_name": "Mochu33", "link": "https://stackoverflow.com/users/3718027/mochu33"}, "is_accepted": true, "score": 0, "last_activity_date": 1557504674, "last_edit_date": 1557504674, "creation_date": 1551198621, "answer_id": 54890055, "question_id": 54441241, "link": "https://stackoverflow.com/questions/54441241/problem-executing-stored-procedure-in-my-code/54890055#54890055", "title": "Problem executing stored procedure in my code", "body": "<p>The problem was in the execution plan.</p>\n\n<p>When the stored procedure is compiled, a new plan based on actual data is determined. After a few executions the plan get to old because the data change frequently.</p>\n\n<p>So to achieve this problem I used the WITH RECOMPILE options for the stored procedure. I think it's not the best solution but it solves the problem and now I don't have the query timeout anymore.</p>\n\n<p>In this way I try some other solutions to apply the recompile in the best moment but the only solution that works well is with this option.</p>\n"}], "owner": {"reputation": 1, "user_id": 3718027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HhdKL.png?s=128&g=1", "display_name": "Mochu33", "link": "https://stackoverflow.com/users/3718027/mochu33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 54890055, "answer_count": 2, "score": 0, "last_activity_date": 1557504674, "creation_date": 1548853292, "last_edit_date": 1548857669, "question_id": 54441241, "link": "https://stackoverflow.com/questions/54441241/problem-executing-stored-procedure-in-my-code", "title": "Problem executing stored procedure in my code", "body": "<p>I had a stored procedure that returns a set of 8 <code>integer</code> values. At the beginning all seems to be executed in the right way but after some execution when I execute it in my C++ code using <code>TADOQuery</code> the execution time grows up but not in the SSMS in wich the execution time still correct.</p>\n\n<p>In a first step I try to evolve my stored procedure to make it more performance aware. I earned some execution time but the problem still present.</p>\n\n<p>I try also to examine my code searching some absurd lines that may extend execution time. But I use the same code with other stored procedures and they don't show the same effect.</p>\n\n<p>So I use the SQL Profiler to see what the hell is going on. Below you can see the differences between a good execution and a bad one.</p>\n\n<p><strong><br>Good execution</strong></p>\n\n<pre><code> CPU | Reads | Writes | Duration \n 93  | 13657 | 0      | 113\n</code></pre>\n\n<p><strong><br>Bad execution</strong></p>\n\n<pre><code> CPU      | Reads    | Writes | Duration\n 22090    | 31960629 | 0      | 25158\n</code></pre>\n\n<p>As you can see the values of reads and cpu access grows exponentially.</p>\n\n<p>If I execute the same stored procedure in the SSMS query editor, the results are straight forward to the good execution.</p>\n\n<p>I just want that my stored procedure were executed always with more or less the same duration regardless where I execute the query.</p>\n"}, {"tags": ["java", "android", "c++", "ios", "wifi"], "comments": [{"owner": {"reputation": 9541, "user_id": 1568530, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001179991520/picture?type=large", "display_name": "Vladyslav Matviienko", "link": "https://stackoverflow.com/users/1568530/vladyslav-matviienko"}, "edited": false, "score": 1, "creation_date": 1548854291, "post_id": 54441126, "comment_id": 95692081, "body": "I don&#39;t think you can check that without having the other device in the network which are able to report you back"}, {"owner": {"reputation": 183, "user_id": 6681281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/088985880d56731fa98ac975cd79cf78?s=128&d=identicon&r=PG&f=1", "display_name": "JaM", "link": "https://stackoverflow.com/users/6681281/jam"}, "reply_to_user": {"reputation": 9541, "user_id": 1568530, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001179991520/picture?type=large", "display_name": "Vladyslav Matviienko", "link": "https://stackoverflow.com/users/1568530/vladyslav-matviienko"}, "edited": false, "score": 0, "creation_date": 1549442769, "post_id": 54441126, "comment_id": 95899257, "body": "Thank you! Sadly this seems to be correct."}], "owner": {"reputation": 183, "user_id": 6681281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/088985880d56731fa98ac975cd79cf78?s=128&d=identicon&r=PG&f=1", "display_name": "JaM", "link": "https://stackoverflow.com/users/6681281/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548852922, "creation_date": 1548852922, "question_id": 54441126, "link": "https://stackoverflow.com/questions/54441126/is-there-a-way-to-programatically-detect-if-wifi-ap-isolation-is-in-place", "title": "Is there a way to programatically detect if WiFi AP isolation is in place?", "body": "<p>Is there a way to programatically detect if WiFi AP isolation (sometimes called client isolation, too) is in place?</p>\n\n<p>Background: I am maintaining a smartphone app, which uses broadcasts to identify other devices running the same app on the local network. (So that the user can establish a local P2P connection.) I would like to detect if AP isolation is filtering the broadcasts, in order to display helpful \ninformation to the user.</p>\n"}, {"tags": ["c++", "c", "winapi"], "comments": [{"owner": {"reputation": 2055, "user_id": 10733631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z9f47Aj3ez4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j0jfocyr5e1Wd0v4q8aluK_b7B5Q/mo/photo.jpg?sz=128", "display_name": "Dmytro Dadyka", "link": "https://stackoverflow.com/users/10733631/dmytro-dadyka"}, "edited": false, "score": 1, "creation_date": 1548852817, "post_id": 54441021, "comment_id": 95691191, "body": "Improve the question formatting, please."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1548863790, "post_id": 54441021, "comment_id": 95698290, "body": "That doesn&#39;t look like C++ or C - what&#39;s that <code>^</code> doing there?"}], "answers": [{"tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 1, "last_activity_date": 1548857458, "last_edit_date": 1548857458, "creation_date": 1548857096, "answer_id": 54442414, "question_id": 54441021, "link": "https://stackoverflow.com/questions/54441021/mblctr-is-not-recognized-as-an-internal-or-external-command-operable-program/54442414#54442414", "title": "&#39;mblctr&#39; is not recognized as an internal or external command, operable program or batch file.How to fix this?", "body": "<p>mblctr.exe only exists as a 64-bit application on 64-bit Windows. A 32-bit application does not see the same System32 folder as 64-bit applications. You can access the 64-bit System32 folder in 32-bit applications with the virtual sysnative folder.</p>\n\n<pre><code>#include &lt;shellapi.h&gt;\n...\nINT_PTR ret = (INT_PTR) ShellExecute(NULL, NULL, TEXT(\"mblctr.exe\"), 0, 0, SW_SHOW);\nif (ret &lt;= 32)\n{\n    TCHAR buf[MAX_PATH];\n    GetWindowsDirectory(buf, MAX_PATH);\n    lstrcat(buf, TEXT(\"\\\\sysnative\\\\mblctr.exe\")); // Hopefully this fits in MAX_PATH, you might want to check in a real program.\n    ShellExecute(NULL, NULL, buf, 0, 0, SW_SHOW);\n}\n</code></pre>\n\n<p>It works in cmd.exe because you are running the 64-bit version of cmd when you start it manually. If you run the 32-bit bit version of cmd.exe it will fail:</p>\n\n<p><kbd>Win</kbd>+<kbd>R</kbd> \"cmd\"</p>\n\n<pre><code>C:\\Users\\Anders&gt;%windir%\\syswow64\\cmd.exe\nMicrosoft Windows [Version 6.2.9200]\n(c) 2012 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\Anders&gt;mblctr.exe\n'mblctr.exe' is not recognized as an internal or external command,\noperable program or batch file.\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9490152, "user_type": "registered", "profile_image": "https://graph.facebook.com/1483880878401175/picture?type=large", "display_name": "M&#252;sh&#226;n St&#238;f\u0142er", "link": "https://stackoverflow.com/users/9490152/m%c3%bcsh%c3%a2n-st%c3%aef%c5%82er"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 54442414, "answer_count": 1, "score": -2, "last_activity_date": 1548857458, "creation_date": 1548852560, "last_edit_date": 1548854689, "question_id": 54441021, "link": "https://stackoverflow.com/questions/54441021/mblctr-is-not-recognized-as-an-internal-or-external-command-operable-program", "title": "&#39;mblctr&#39; is not recognized as an internal or external command, operable program or batch file.How to fix this?", "body": "<p>I have created a button in vs to open mobility center. when i run the code it shows error 'mblctr' is not recognized,but when run the 'mblctr' in cmd it wroks fine.This is my code someone help me out</p>\n\n<pre><code>private: System::Void button21_Click(System::Object^  sender, System::EventArgs^  e) {\n    //system(\"C:\\\\Windows\\\\System32\\\\mblctr.exe\");\n    system(\"mblctr\");\n }\n</code></pre>\n"}, {"tags": ["c++", "std", "c++17", "stdtuple"], "comments": [{"owner": {"reputation": 2257, "user_id": 1530018, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bcbc00a1cd813900aedb1eebd7113d90?s=128&d=identicon&r=PG&f=1", "display_name": "kreuzerkrieg", "link": "https://stackoverflow.com/users/1530018/kreuzerkrieg"}, "edited": false, "score": 0, "creation_date": 1548852471, "post_id": 54440935, "comment_id": 95690986, "body": "I think this one answers your question <a href=\"https://stackoverflow.com/questions/35563209/how-to-compare-tuples-of-different-length\" title=\"how to compare tuples of different length\">stackoverflow.com/questions/35563209/&hellip;</a>"}, {"owner": {"reputation": 2257, "user_id": 1530018, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bcbc00a1cd813900aedb1eebd7113d90?s=128&d=identicon&r=PG&f=1", "display_name": "kreuzerkrieg", "link": "https://stackoverflow.com/users/1530018/kreuzerkrieg"}, "edited": false, "score": 1, "creation_date": 1548852536, "post_id": 54440935, "comment_id": 95691020, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35563209/how-to-compare-tuples-of-different-length\">How to compare tuples of different length?</a>"}, {"owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "reply_to_user": {"reputation": 2257, "user_id": 1530018, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bcbc00a1cd813900aedb1eebd7113d90?s=128&d=identicon&r=PG&f=1", "display_name": "kreuzerkrieg", "link": "https://stackoverflow.com/users/1530018/kreuzerkrieg"}, "edited": false, "score": 0, "creation_date": 1548852975, "post_id": 54440935, "comment_id": 95691280, "body": "No, my tuples has the same size."}, {"owner": {"reputation": 2257, "user_id": 1530018, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bcbc00a1cd813900aedb1eebd7113d90?s=128&d=identicon&r=PG&f=1", "display_name": "kreuzerkrieg", "link": "https://stackoverflow.com/users/1530018/kreuzerkrieg"}, "edited": false, "score": 0, "creation_date": 1548853749, "post_id": 54440935, "comment_id": 95691733, "body": "just change the <code>tuple_compare</code> and use argument that you would provide instead of using <code>sizeof ...</code> looks like it should work"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1548854385, "post_id": 54440935, "comment_id": 95692144, "body": "<code>std::tie(key)</code>, <code>key</code> is already a tuple..."}], "answers": [{"comments": [{"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1548854663, "post_id": 54441137, "comment_id": 95692333, "body": "You&#39;re correct an I should have said a custom comparison function (not operator)."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1548855052, "post_id": 54441137, "comment_id": 95692575, "body": "I don&#39;t know if I am fond of the compare function. I personally prefer the sub-tuple approach, but your ideea is a valid option that might make sense in certain scenarios. However in the current state your post is barely an answer. You can improve it by showing an implementation of the function."}, {"owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "edited": false, "score": 0, "creation_date": 1548855458, "post_id": 54441137, "comment_id": 95692809, "body": "Simon Doppler: That was you said that I compare a tuple of different size was an example to solve the problem. The reason why I come here was that I want to compare tuples with the same size but ignore args."}], "tags": [], "owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "is_accepted": false, "score": 0, "last_activity_date": 1548854833, "last_edit_date": 1548854833, "creation_date": 1548852956, "answer_id": 54441137, "question_id": 54440935, "link": "https://stackoverflow.com/questions/54440935/compare-two-tuples-but-only-the-first-two-args/54441137#54441137", "title": "Compare two tuples but only the first two args", "body": "<p>In your example, you are comparing a tuple of size 3 (<code>std::tie(k, p, std::ignore)</code>) with a tuple of size 1 (<code>std::tie(key)</code>, which has the type <code>std::tuple&lt;std::tuple&lt;uint16_t, uint16_t, uint32_t&gt;&gt;</code>). You shouldn't call tie on a tuple, because it will create a tuple with a single item in it.</p>\n\n<p>The following code also fail with GCC 8.2.1 because the compiler doesn't know how to handle the <code>std::ignore</code> comparison with an <code>uint32_t</code>. In this case I would write a specialized compare function for this type (<code>std::tuple&lt;std::tuple&lt;uint16_t, uint16_t, uint32_t&gt;&gt;</code>).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;tuple&gt;\n\nint main() {\n    uint16_t k = 0;\n    uint16_t p = 0;\n    std::tuple&lt;uint16_t, uint16_t, uint32_t&gt; key{};\n    if(std::tie(k, p, std::ignore) &lt; key) {\n        // TODO\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1548853740, "last_edit_date": 1592644375, "creation_date": 1548853740, "answer_id": 54441382, "question_id": 54440935, "link": "https://stackoverflow.com/questions/54440935/compare-two-tuples-but-only-the-first-two-args/54441382#54441382", "title": "Compare two tuples but only the first two args", "body": "<blockquote>\n<p>Also what if I want this:</p>\n<p><code>if(std::tie(k, std::ignore, p) == std::tie(key)) { ... }</code></p>\n</blockquote>\n<p>So you want compare sub-tuples with some elements of original tuples? Not necessarily the first two elements?</p>\n<p>What about a function that, given a tuple object an template variadic index list, return the corresponding sub-tuple?</p>\n<pre><code>template &lt;std::size_t ... Is, typename T&gt;\nauto getSubTuple (T const &amp; t)\n { return std::tie(std::get&lt;Is&gt;(t)...); }\n</code></pre>\n<p>So you can write</p>\n<pre><code>   std::tuple&lt;std::uint16_t, std::uint16_t, std::uint32_t&gt; key{0, 1, 2};\n   std::tuple&lt;std::uint16_t, std::uint16_t, std::uint32_t&gt; key2{0, 3, 2};\n    \n   std::cout &lt;&lt; (getSubTuple&lt;0u, 2u&gt;(key) == getSubTuple&lt;0u, 2u&gt;(key2)) &lt;&lt; std::endl;\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 9204005, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faa102a45a6decbf808abff4c38a7a73?s=128&d=identicon&r=PG&f=1", "display_name": "makurisan", "link": "https://stackoverflow.com/users/9204005/makurisan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 54441382, "answer_count": 2, "score": 2, "last_activity_date": 1548854833, "creation_date": 1548852194, "last_edit_date": 1548854545, "question_id": 54440935, "link": "https://stackoverflow.com/questions/54440935/compare-two-tuples-but-only-the-first-two-args", "title": "Compare two tuples but only the first two args", "body": "<p>I have a <code>std::tuple</code> e.g. </p>\n\n<pre><code>std::tuple&lt;uint16_t, uint16_t, uint32_t&gt; key{};\nstd::tuple&lt;uint16_t, uint16_t, uint32_t&gt; key2{};\nconst auto [k, p, r] = key;\n</code></pre>\n\n<p>and I want to compare with a second tuple but only the first two args. Something like that:</p>\n\n<pre><code>if(std::tie(k, p, std::ignore) &lt; std::tie(key)) { ... }\n</code></pre>\n\n<p>If I do it in the this way, I get the following error:</p>\n\n<pre><code>error C2338: cannot compare tuples of different sizes\n</code></pre>\n\n<p>How can I do that?</p>\n\n<p><strong>EDIT1:</strong></p>\n\n<p>Both tuple have the same size. I seen how two compare on EQUAlITY with <code>std::tie()</code> but it would be nicer I could write:</p>\n\n<pre><code>if(std::tie(k, p, std::ignore) == std::tie(key)) { ... }\n</code></pre>\n\n<p><strong>EDIT2:</strong></p>\n\n<p>Also what if I want this:</p>\n\n<pre><code>if(std::tie(k, std::ignore, p) == std::tie(key)) { ... }\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1548852305, "post_id": 54440908, "comment_id": 95690892, "body": "On the right side there&#39;s a list of related questions. Take a look through those, especially the one named <a href=\"https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file?rq=1\">Why can templates only be implemented in the header file?</a>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548852386, "post_id": 54440908, "comment_id": 95690938, "body": "And if you want help with your specific problem, then you need to tell us what the specific problem is. What errors do you get? If you can&#39;t be specific, then we can&#39;t give specific answers. Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 867, "user_id": 10441038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbXo3.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10441038/leon"}, "edited": false, "score": 0, "creation_date": 1548852495, "post_id": 54440908, "comment_id": 95690997, "body": "When I add the generic version, I commented the specialized."}, {"owner": {"reputation": 867, "user_id": 10441038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbXo3.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10441038/leon"}, "edited": false, "score": 0, "creation_date": 1548852541, "post_id": 54440908, "comment_id": 95691023, "body": "path/of/the/ClassC.cpp:16:6: error: \u2018template&lt;class T&gt; class ClassC\u2019 used without template parameters"}], "answers": [{"comments": [{"owner": {"reputation": 867, "user_id": 10441038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbXo3.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10441038/leon"}, "edited": false, "score": 0, "creation_date": 1549192900, "post_id": 54441069, "comment_id": 95808728, "body": "Thank you very much. Sorry for later to reply."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1548852747, "creation_date": 1548852747, "answer_id": 54441069, "question_id": 54440908, "link": "https://stackoverflow.com/questions/54440908/how-to-implement-a-member-function-outside-of-a-template-class-declaration-body/54441069#54441069", "title": "How to implement a member function outside of a template class declaration body?", "body": "<p>You have e.g.</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid ClassC::show() {\n     cout &lt;&lt; \"This is a generic ClassC.\" &lt;&lt; endl;\n};\n</code></pre>\n\n<p>The problem here is that there is no <em>class</em> named <code>ClassC</code>, you only have a <em>template</em> with that name. To get a full class you need <code>ClassC&lt;T&gt;</code>:</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid ClassC&lt;T&gt;::show() {\n     cout &lt;&lt; \"This is a generic ClassC.\" &lt;&lt; endl;\n};\n</code></pre>\n\n<p>Like the error message says, you need to include the template parameters.</p>\n\n<p>And of course don't forget to read <a href=\"https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file\">Why can templates only be implemented in the header file?</a> as that will answer what might be your next question.</p>\n"}, {"comments": [{"owner": {"reputation": 867, "user_id": 10441038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbXo3.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10441038/leon"}, "edited": false, "score": 0, "creation_date": 1548855808, "post_id": 54441522, "comment_id": 95693017, "body": "Thanks a lot! I&#39;m going to use the first solution your mentioned, because I&#39;m worry about that the second one could probably lead to some &quot;symbol redefining&quot; issues, if the &quot;my_file.cpp&quot; need to be included in more than one place. As for the third one, it looks like that the keyword &quot;export&quot; has be marked deprecated in most modern compiler and the latest c++ standard.  If I have comprehended it correctly, the word &quot;Instantiation&quot; in the first solution may be understood as &quot;Specialization&quot;. Am I right? Not for revise, just for understanding."}, {"owner": {"reputation": 420, "user_id": 6569689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb150b5f78aeda0371f727993367025?s=128&d=identicon&r=PG&f=1", "display_name": "Lourens Dijkstra", "link": "https://stackoverflow.com/users/6569689/lourens-dijkstra"}, "reply_to_user": {"reputation": 867, "user_id": 10441038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbXo3.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10441038/leon"}, "edited": false, "score": 0, "creation_date": 1548856319, "post_id": 54441522, "comment_id": 95693331, "body": "The difference is described in this question: <a href=\"https://stackoverflow.com/questions/3914642/difference-between-instantiation-and-specialization-in-c-templates\" title=\"difference between instantiation and specialization in c templates\">stackoverflow.com/questions/3914642/&hellip;</a>"}], "tags": [], "owner": {"reputation": 420, "user_id": 6569689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb150b5f78aeda0371f727993367025?s=128&d=identicon&r=PG&f=1", "display_name": "Lourens Dijkstra", "link": "https://stackoverflow.com/users/6569689/lourens-dijkstra"}, "is_accepted": true, "score": 3, "last_activity_date": 1548854224, "creation_date": 1548854224, "answer_id": 54441522, "question_id": 54440908, "link": "https://stackoverflow.com/questions/54440908/how-to-implement-a-member-function-outside-of-a-template-class-declaration-body/54441522#54441522", "title": "How to implement a member function outside of a template class declaration body?", "body": "<p>There are a couple of ways to fix this problem:</p>\n\n<ul>\n<li>Explicit Instantiation</li>\n<li>The Inclusion Model</li>\n<li>The Seperation Model</li>\n</ul>\n\n<p><strong>Explicit Instantiation</strong> Works similar to your example of template specialization:</p>\n\n<pre><code>template my_class&lt;size_t&gt;::my_class();\n</code></pre>\n\n<p>Explicitly instantiates the constructor of <code>my_class&lt;T&gt;</code> for type size_t.</p>\n\n<p><strong>The Inclusion Model</strong>\nThe code is either written inside the .h file, a very common approach to deal with this problem, or we include the definitions of a template in the header file that declares that template, so:\n<code>#include \"my_file.cpp\"</code>.</p>\n\n<p><strong>The Seperation Model</strong>\nUse the keyword <code>export</code>. However, I have almost never used this, as it performs quite slowly.</p>\n\n<pre><code>export template &lt;typename T&gt;\nstruct C {};\n</code></pre>\n"}], "owner": {"reputation": 867, "user_id": 10441038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbXo3.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10441038/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 1, "closed_date": 1548854261, "accepted_answer_id": 54441522, "answer_count": 2, "score": 1, "last_activity_date": 1548854224, "creation_date": 1548852089, "question_id": 54440908, "link": "https://stackoverflow.com/questions/54440908/how-to-implement-a-member-function-outside-of-a-template-class-declaration-body", "closed_reason": "Duplicate", "title": "How to implement a member function outside of a template class declaration body?", "body": "<p>I have a template class that has a big member function in generic form, so it is not very easy to read it through.\nI decide to move this function outside of the class body, and implement it in a \"<em>.cpp\" file that with same name as the \"</em>.hpp\", but I can't pass the compiling.\nIf I implement it in a specialized form rather than a generic form, it can be compiled/linked, even though it be saved in the \"*.cpp\" file too.</p>\n\n<p>The codes is following:</p>\n\n<p>ClassC.hpp:</p>\n\n<pre><code>#pragma once\ntemplate &lt;typename T&gt;\nclass ClassC {\npublic:\n   ClassC( T* p ) : d( p ) {};\n   void show();\nprivate:\n   T* d;\n};\n</code></pre>\n\n<p>ClassC.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"ClassC.hpp\"\n#include \"ClassD.hpp\"\nusing namespace std;\n\n// this is a specialized version, and can be compiled/linked.\ntemplate &lt;&gt;\nvoid ClassC&lt;ClassD&gt;::show() {\n   cout &lt;&lt; \"This is a specialized ClassC.\" &lt;&lt; endl;\n};\n\n// this is my generic version, and can not be compiled.\ntemplate &lt;typename T&gt;\nvoid ClassC::show() {\n     cout &lt;&lt; \"This is a generic ClassC.\" &lt;&lt; endl;\n};\n/* */\n</code></pre>\n\n<p>ClassD.hpp</p>\n\n<pre><code>#pragma once\n#include \"ClassC.hpp\"\nclass ClassD {\npublic:\n   ClassD(): c( this ) {};\n   void show();\nprivate:\n   ClassC&lt;ClassD&gt; c;\n};\n</code></pre>\n\n<p>ClassD.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"ClassD.hpp\"\nusing namespace std;\nvoid ClassD::show() {\n   c.show();\n   cout &lt;&lt; \"This is ClassD\" &lt;&lt; endl;\n};\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"ClassD.hpp\"\nint main() {\n   ClassD d;\n   d.show();\n   return 0;\n};\n</code></pre>\n"}, {"tags": ["c++", "qt", "graphics", "computational-geometry", "cgal"], "comments": [{"owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1548916053, "post_id": 54440465, "comment_id": 95717222, "body": "Missing #include&lt;CGAL/Polyhedron_3_to_lcc.h&gt; ?"}, {"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "reply_to_user": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1548923414, "post_id": 54440465, "comment_id": 95720637, "body": "@gdamiand thanks a lot it solves the problem  :)"}, {"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "reply_to_user": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1548925629, "post_id": 54440465, "comment_id": 95721867, "body": "@gdamiand Have you any idea about reload the mesh viewer after simplification ? when I run the SimpleLCCViewerQt code after simplification it&#39;s shows error &quot;The inferior stopped because it received a signal from the operating system.&quot;"}, {"owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1548929836, "post_id": 54440465, "comment_id": 95724456, "body": "Have a look at the linear cell complex demo (in the CGAL master branch)."}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "is_accepted": true, "score": 1, "last_activity_date": 1548929894, "creation_date": 1548929894, "answer_id": 54458271, "question_id": 54440465, "link": "https://stackoverflow.com/questions/54440465/cgal-cannot-use-import-from-polyhedron-3/54458271#54458271", "title": "CGAL - cannot use import_from_polyhedron_3", "body": "<p>Missing #include&lt; CGAL/Polyhedron_3_to_lcc.h > (cf doc <a href=\"https://doc.cgal.org/latest/Linear_cell_complex/group__PkgLinearCellComplexConstructions.html#ga9239e988c6d5e674d64438d47b95a548\" rel=\"nofollow noreferrer\">here</a>)</p>\n"}], "owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54458271, "answer_count": 1, "score": 0, "last_activity_date": 1548929894, "creation_date": 1548850604, "last_edit_date": 1548925772, "question_id": 54440465, "link": "https://stackoverflow.com/questions/54440465/cgal-cannot-use-import-from-polyhedron-3", "title": "CGAL - cannot use import_from_polyhedron_3", "body": "<p>I want to simplify a surface read from .off file and view it using CGAL.\nI read the surface as Polyhedron_3 and I want to convert it to Linear_cell_complex_for_combinatorial_map to view it but there is a problem in import_from_polyhedron_3 method </p>\n\n<p><strong>my code:</strong> </p>\n\n<pre><code>    typedef CGAL::Linear_cell_complex_for_combinatorial_map&lt;2,3&gt; LCC_3;\n     typedef LCC_3::Dart_handle Dart_handle;\n\n    typedef CGAL::Exact_predicates_inexact_constructions_kernel  Kernel;\n    typedef CGAL::Polyhedron_3&lt;Kernel&gt;                       Polyhedron;\n     QWidget* viewer ;\n       QString fileName;\n\n     LCC_3 lcc;\n       QMainWindow qWin;\n      CGAL::DefaultColorFunctorLCC fcolor;\n\n      Polyhedron P;\n\nvoid MainWindow::preview()\n{\n\n    QWidget* centralWidget = new QWidget(viewer);\n          centralWidget-&gt;setSizePolicy(QSizePolicy::Maximum,QSizePolicy::Maximum);\n  CGAL::import_from_polyhedron_3&lt;LCC_3, Polyhedron&gt;(lcc, P);\n          setCentralWidget( new CGAL::SimpleLCCViewerQt&lt;LCC_3, CGAL::DefaultColorFunctorLCC&gt;(&amp;qWin ,\n                      lcc,\n                      \"Basic LCC Viewer\",\n                      false,\n                       fcolor ) );\n    show();\n}\n\n    void MainWindow::fileOpen()\n    {\n       fileName = QFileDialog::getOpenFileName(this,tr(\"Select object\"), \".\", tr(\"*.off\"));\n    std::ofstream out(fileName.toLocal8Bit());\n        out&lt;&lt;P;\n     preview();\n}\n\n    void MainWindow ::simplify()\n    {\n\n        bool ok;\n        int n = QInputDialog::getInt(this, \"\", tr(\"Number of vertices in each cell:\"),P.size_of_vertices(),0, P.size_of_vertices(),1, &amp;ok);\n\n        if (ok){\n            int r = P.size_of_vertices() - n;\n            int target_edges = P.size_of_halfedges()/2 - r*3;\n        n=target_edges+1;\n        }\n\n\n        typedef CGAL::Polyhedron_3&lt;Kernel&gt; Surface;\n\n        SaveOFF(\"temp.off\");\n        namespace SMS = CGAL::Surface_mesh_simplification ;\n        Surface surface;\n        std::ifstream is(\"temp.off\") ; is &gt;&gt; surface ;\n\n        // This is a stop predicate (defines when the algorithm terminates).\n        // In this example, the simplification stops when the number of undirected edges\n        // left in the surface drops below the specified number (1000)\n        SMS::Count_stop_predicate&lt;Surface&gt; stop(n);\n\n        // This the actual call to the simplification algorithm.\n        // The surface and stop conditions are mandatory arguments.\n        // The index maps are needed because the vertices and edges\n        // of this surface lack an \"id()\" field.\n\n\n        int r = SMS::edge_collapse\n                  (surface\n                  ,stop\n                   ,CGAL::parameters::vertex_index_map(get(CGAL::vertex_external_index,surface))\n                                     .halfedge_index_map  (get(CGAL::halfedge_external_index  ,surface))\n\n    );\n        std::ofstream os(\"temp.off\"); os &lt;&lt; surface ;\n        OpenOFF(\"temp.off\");\n\n        std::cout &lt;&lt; \"Finished...\" &lt;&lt; r &lt;&lt; \" edges removed.\"&lt;&lt;std::endl;\n        std::cout&lt;&lt;P.size_of_vertices()&lt;&lt;\" Vertices\"&lt;&lt;std::endl;\n        std::cout&lt;&lt;P.size_of_facets()&lt;&lt;\" Facets\"&lt;&lt;std::endl;\n        std::cout&lt;&lt;P.size_of_halfedges()&lt;&lt;\" Halfedges\"&lt;&lt;std::endl;\n      preview();\n\n     }\n</code></pre>\n\n<p>it shows me the following error: \n\u2018import_from_polyhedron_3\u2019 is not a member of \u2018CGAL\u2019\n    CGAL::import_from_polyhedron_3(lcc, P);</p>\n\n<p>another problem it cannot reload the surface in the viewer after simplifying it , it shows the following error :\nit's shows error \"The inferior stopped because it received a signal from the operating system.\"</p>\n\n<p>I need any help please \nthanks </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1548851061, "post_id": 54440374, "comment_id": 95690250, "body": "The cost of the whole thing is O(n^2). This is because the inner loop is O(n) and the outer loop runs n times."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1548851302, "post_id": 54440374, "comment_id": 95690380, "body": "But the number of calls to operator new/delete (which will <i>not</i> dominate the complexity calculations and so is kinda irrelevant) will be O(lg(n)) in the first run of the outer loop and none for subsequent runs."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1548851026, "post_id": 54440582, "comment_id": 95690222, "body": "Upped, much better than my soon-to-be-deleted answer."}], "tags": [], "owner": {"reputation": 49, "user_id": 10220529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd6044cd6af8144a1ac5f0823e5867db?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Lanin", "link": "https://stackoverflow.com/users/10220529/andrew-lanin"}, "is_accepted": false, "score": 4, "last_activity_date": 1548850973, "creation_date": 1548850973, "answer_id": 54440582, "question_id": 54440374, "link": "https://stackoverflow.com/questions/54440374/complexity-for-new-alloc-for-method-vectorpush-back/54440582#54440582", "title": "Complexity for new/alloc for method vector::push_back", "body": "<hr>\n\n<p>vector::push_back is not exactly O(1), but <em>amortized</em> O(1) which is required by C++ standard. See <a href=\"https://stackoverflow.com/questions/200384/constant-amortized-time\">Constant Amortized Time</a></p>\n"}, {"comments": [{"owner": {"reputation": 976, "user_id": 3565017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca9b87bfc80f0428240ea6b8c0b5be?s=128&d=identicon&r=PG&f=1", "display_name": "L.C.", "link": "https://stackoverflow.com/users/3565017/l-c"}, "edited": false, "score": 0, "creation_date": 1548854725, "post_id": 54440769, "comment_id": 95692369, "body": "(...) and not O(N*log2(N)) because it&#39;s the same vector!"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1548859593, "post_id": 54440769, "comment_id": 95695488, "body": "Re: &quot;it doubles the allocated size&quot; -- the key is that it <b>multiplies</b> by some factor. Many implementations these days use 1.5 rather than 2. But that&#39;s a minor detail. +1."}], "tags": [], "owner": {"reputation": 976, "user_id": 3565017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca9b87bfc80f0428240ea6b8c0b5be?s=128&d=identicon&r=PG&f=1", "display_name": "L.C.", "link": "https://stackoverflow.com/users/3565017/l-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1548853136, "last_edit_date": 1548853136, "creation_date": 1548851625, "answer_id": 54440769, "question_id": 54440374, "link": "https://stackoverflow.com/questions/54440374/complexity-for-new-alloc-for-method-vectorpush-back/54440769#54440769", "title": "Complexity for new/alloc for method vector::push_back", "body": "<p>When reallocation happens, it doubles the allocated size of the vector so (for arbitrarily big values of N) in the given example, it will happen constant*log_2(N) times. </p>\n\n<p>Yes, the complexity of the push_back call is amortized O(1) because reallocating does not take more time if the vector is big (better: the time does not depend on the size), but reallocation will still happen constant*log_2(N) times inside the loop (where constant != 0). </p>\n\n<p>Finally, the complexity of reallocation in the k-loop example is O(log2(N)) and (edited) for the main loop, it's O(log2(N^2)) = O(2*log2(N)) = O(log2(N)).</p>\n"}], "owner": {"reputation": 35, "user_id": 7177544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ee04e7b72569aa35471b89e1cdfd48?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmman", "link": "https://stackoverflow.com/users/7177544/hmmman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 54440769, "answer_count": 2, "score": 0, "last_activity_date": 1548853136, "creation_date": 1548850302, "question_id": 54440374, "link": "https://stackoverflow.com/questions/54440374/complexity-for-new-alloc-for-method-vectorpush-back", "title": "Complexity for new/alloc for method vector::push_back", "body": "<p>What is the complexity for alloc(realloc)/new operations for code below, for huge values of N.</p>\n\n<p>As far as I understood push_back allocates memory:<br>\nsize = cst*old_size;<br>\ncst = 2; // for gcc<br>\nSo we have O(1) inside k cycle and ~O(N) inside i cycle.\nIn summary I have O(N), am I right?</p>\n\n<pre><code>std::vector&lt;int&gt; data;  \nfor (int i = 0; i &lt; N; ++i)  \n{  \n    for (int k = 0; k &lt; 2 * N; ++k)  \n        data.push_back(k);  \n    for (int k = 0; k &lt; N; ++k)  \n        data.pop_back();  \n}  \n</code></pre>\n"}, {"tags": ["c++", "c++11", "move-semantics"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1548855361, "post_id": 54440274, "comment_id": 95692754, "body": "Tangential, but I would recommend naming the method <code>extractValues</code>, <code>releaseValues</code> or similar. <code>get</code> does not usually imply that you are &quot;stealing&quot; something from an object."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 2, "last_activity_date": 1548851457, "last_edit_date": 1548851457, "creation_date": 1548850965, "answer_id": 54440572, "question_id": 54440274, "link": "https://stackoverflow.com/questions/54440274/how-to-remove-data-from-class-instance-after-data-being-returned-once/54440572#54440572", "title": "How to remove data from class instance after data being returned once", "body": "<p>Return by value from moved member:</p>\n\n<pre><code>class Storage\n{\npublic:\n    void addValue(int v) {values.push_back(v);}\n    std::vector&lt;int&gt; takeValues() {\n        std::vector&lt;int&gt; res = std::move(values);\n        values.clear();\n        return res;\n    }\nprivate:\n    std::vector&lt;int&gt; values;\n};\n</code></pre>\n\n<p>From <a href=\"https://stackoverflow.com/questions/17730689/is-a-moved-from-vector-always-empty\">is-a-moved-from-vector-always-empty</a>, we cannot just implement <code>return std::move(values);</code> :-/</p>\n"}], "owner": {"reputation": 2462, "user_id": 674548, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1b37edc3e30503536841845e969aac40?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/674548/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54440572, "answer_count": 1, "score": 1, "last_activity_date": 1548851457, "creation_date": 1548850019, "question_id": 54440274, "link": "https://stackoverflow.com/questions/54440274/how-to-remove-data-from-class-instance-after-data-being-returned-once", "title": "How to remove data from class instance after data being returned once", "body": "<p>In my app I need to read some values from some source, keep them for a while in a storage, and then apply. After being applied, values are not needed and can be removed from the storage.</p>\n\n<pre><code>class Storage: public Singleton&lt;...&gt; {\npublic:\n    void addValue(int v) {values.push_back(v);}\n    // ...\nprivate:\n    std::vector&lt;int&gt; values;\n    // ...\n}\n\n// read values from some source and keep them in the storage\nvoid Init() {\n    for (...) {\n        Storage::Instance()-&gt;addValue(...);\n    }\n}\n\n// a few seconds later...\n\n// apply values somehow and get rid of them\nvoid Apply() {\n    auto &amp;&amp;values = Storage::Instance()-&gt;getValues();\n    // ideally, at this point Storage must not contain values array\n    // process values somehow\n    for auto i: values {\n    // ...\n    }\n    // values are not needed any longer\n}\n</code></pre>\n\n<p>My question is how do I implement <code>getValues</code> method? Is it possible to implement it so that it clears <code>values</code> array in <code>Storage</code> after being called (using move semantics or whatsoever)? In other words, there is no need to keep <code>values</code> in <code>Storage</code> after <code>getValues</code> has been called once.</p>\n\n<p>If it is not possible, I will have to implement additional method say <code>Storage::clearValues</code> which I would need to call at the end of <code>Apply()</code> -- this is what I am tryng to avoid.</p>\n"}, {"tags": ["c++", "c", "linker"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1548850332, "post_id": 54440260, "comment_id": 95689807, "body": "1. Because you should use <code>cstdio</code> in C++. 2. No, for 99% stdio.h has <code>extern &quot;C&quot;</code> in this <a href=\"https://github.com/lattera/glibc/blob/master/libio/stdio.h#L29\" rel=\"nofollow noreferrer\">macro</a>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1548850867, "post_id": 54440260, "comment_id": 95690129, "body": "@KamilCuk stdio.h vs cstdio has absolutely nothing to do with this."}, {"owner": {"reputation": 43, "user_id": 10652944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08464a07a695821661a2558f5f36e5ce?s=128&d=identicon&r=PG&f=1", "display_name": "endtoendianess", "link": "https://stackoverflow.com/users/10652944/endtoendianess"}, "edited": false, "score": 0, "creation_date": 1548865138, "post_id": 54440260, "comment_id": 95699118, "body": "Thanks to everybody for your answers. I should&#39;ve looked more carefully; I just grepped stdio.h looking for cplusplus without digging deeper."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1548851033, "last_edit_date": 1548851033, "creation_date": 1548850334, "answer_id": 54440385, "question_id": 54440260, "link": "https://stackoverflow.com/questions/54440260/linking-to-c-libraries-from-c-why-isnt-extern-always-needed/54440385#54440385", "title": "Linking to C libraries from C++: why isn&#39;t extern always needed?", "body": "<blockquote>\n  <p>For instance, stdio.h has no such #ifdef</p>\n</blockquote>\n\n<p>It probably does. Regardless, <code>&lt;stdio.h&gt;</code> is a header provided by the C++ standard library (inherited from the C standard library). It is guaranteed to work without <code>extern \"C\"</code> as are all standard headers.</p>\n\n<p>Note that the usage of <code>&lt;name.h&gt;</code> name of the inherited standard headers in C++ instead of <code>&lt;cname&gt;</code> is deprecated in the current edition of the standard and has been identified as a candidate for removal in future revisions.</p>\n\n<blockquote>\n  <p>why isn't extern always needed?</p>\n</blockquote>\n\n<p>Simply because some headers have been written to support C++ directly, and so do it by themselves.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 4, "last_activity_date": 1548851069, "last_edit_date": 1548851069, "creation_date": 1548850380, "answer_id": 54440398, "question_id": 54440260, "link": "https://stackoverflow.com/questions/54440260/linking-to-c-libraries-from-c-why-isnt-extern-always-needed/54440398#54440398", "title": "Linking to C libraries from C++: why isn&#39;t extern always needed?", "body": "<blockquote>\n  <p>Usually to get a C library working from C++ you have to include it with  <code>extern \"C\" { #include &lt;clibrary.h&gt; }</code>. </p>\n</blockquote>\n\n<p>Only when the library was not designed with C++ compatibility in mind. But this is a hack.</p>\n\n<blockquote>\n  <p>Many libraries will include in their header files code like <code>#ifdef __cplusplus extern \"C\" { ...</code> to make them more user friendly to C++ code (e.g. <code>pthread.h</code>)</p>\n</blockquote>\n\n<p>Yes, a good library will do this.</p>\n\n<p>As a result, you do not need to and should not add another <code>extern \"C\"</code> around the <code>#include</code>.</p>\n\n<p><code>stdio.h</code> is an example of a header that will be doing this properly (see below).</p>\n\n<blockquote>\n  <p>For instance, <code>stdio.h</code> has no such <code>#ifdef</code></p>\n</blockquote>\n\n<p>Sure it does! <a href=\"https://github.com/lattera/glibc/blob/master/libio/stdio.h#L29\" rel=\"nofollow noreferrer\">Follow</a> <a href=\"https://github.com/lattera/glibc/blob/master/bits/libc-header-start.h#L33\" rel=\"nofollow noreferrer\">the</a> <a href=\"https://github.com/lattera/glibc/blob/master/include/features.h#L428\" rel=\"nofollow noreferrer\">money</a> <a href=\"https://github.com/lattera/glibc/blob/master/include/sys/cdefs.h#L3\" rel=\"nofollow noreferrer\">trail</a><a href=\"https://github.com/lattera/glibc/blob/master/misc/sys/cdefs.h#L112\" rel=\"nofollow noreferrer\">&hellip;</a></p>\n\n<blockquote>\n  <p>why isn't extern always needed?</p>\n</blockquote>\n\n<p>So, in conclusion, you only need to do this yourself when the author of the header file didn't do it for you. When the author of the header file did it, you do not need to do it.</p>\n"}], "owner": {"reputation": 43, "user_id": 10652944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08464a07a695821661a2558f5f36e5ce?s=128&d=identicon&r=PG&f=1", "display_name": "endtoendianess", "link": "https://stackoverflow.com/users/10652944/endtoendianess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 54440398, "answer_count": 2, "score": 3, "last_activity_date": 1548851069, "creation_date": 1548849967, "question_id": 54440260, "link": "https://stackoverflow.com/questions/54440260/linking-to-c-libraries-from-c-why-isnt-extern-always-needed", "title": "Linking to C libraries from C++: why isn&#39;t extern always needed?", "body": "<p>Usually to get a C library working from C++ you have to include it with  <code>extern \"C\" { #include &lt;clibrary.h&gt; }</code>. Many libraries will include in their header files code like <code>#ifdef __cplusplus extern \"C\" { ...</code> to make them more user friendly to C++ code (e.g. <code>pthread.h</code>). Sometimes this is not the case. For instance, <code>stdio.h</code> has no such <code>#ifdef</code>, yet I can still compile &amp; link the usual <code>#include &lt;stdio.h&gt; int main() {printf(\"Hello\");}</code> using a C++ compiler without wrapping it in an <code>extern \"C\"</code> statement. Why is this? </p>\n"}, {"tags": ["c++", "covariance"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 5, "creation_date": 1548848950, "post_id": 54439944, "comment_id": 95689006, "body": "Why do you think there are drawbacks? Why do you think it might be bad design? Please be more specific about your problem."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 2, "creation_date": 1548849424, "post_id": 54439944, "comment_id": 95689304, "body": "They don&#39;t work with smart pointers, so such a design cements the code to use raw pointers. There are tricks to overcome this, to some extent though."}, {"owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 2, "creation_date": 1548849475, "post_id": 54439944, "comment_id": 95689328, "body": "You also might want to have a virtual destructor."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1548849515, "post_id": 54439944, "comment_id": 95689343, "body": "The drawback is that the pointer returned needs to be adjusted behind the scenes when virtual function is invoked through a referenced to base <code>AbstractFactory</code>. If (a typical situation) virtual function is only invoked though a reference to base class then returning covariant type may cause a potential overhead compared to situation when pointer is adjusted in the function itself."}, {"owner": {"reputation": 420, "user_id": 6569689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb150b5f78aeda0371f727993367025?s=128&d=identicon&r=PG&f=1", "display_name": "Lourens Dijkstra", "link": "https://stackoverflow.com/users/6569689/lourens-dijkstra"}, "edited": false, "score": 1, "creation_date": 1548849536, "post_id": 54439944, "comment_id": 95689357, "body": "Some people argue that <code>virtual</code> calls are slightly slower, but furthermore, I cannot think of anything. <a href=\"https://stackoverflow.com/questions/449827/virtual-functions-and-performance-c\" title=\"virtual functions and performance c\">stackoverflow.com/questions/449827/&hellip;</a>"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 420, "user_id": 6569689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb150b5f78aeda0371f727993367025?s=128&d=identicon&r=PG&f=1", "display_name": "Lourens Dijkstra", "link": "https://stackoverflow.com/users/6569689/lourens-dijkstra"}, "edited": false, "score": 1, "creation_date": 1548849745, "post_id": 54439944, "comment_id": 95689456, "body": "@LourensDijkstra They are hilariously slow on certain hardware, especially without or with a very small cpu cache."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1548850244, "post_id": 54439944, "comment_id": 95689769, "body": "Drawback of c++ is that it is limited in covariance return type. We might want to do it with smart pointers too. Else it is perfectly valid C++."}, {"owner": {"reputation": 1544, "user_id": 6475652, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8d783a89da27c7d36c0935fc2af7b38e?s=128&d=identicon&r=PG&f=1", "display_name": "Fryz", "link": "https://stackoverflow.com/users/6475652/fryz"}, "reply_to_user": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1548854912, "post_id": 54439944, "comment_id": 95692492, "body": "@Pi : I forgot it as i focused on something else but you are right so i have fixed it in the question"}], "answers": [{"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548851422, "post_id": 54440617, "comment_id": 95690436, "body": "I feel like this is likely the biggest consideration here. Factories in modern C++ return <code>unique_ptr</code>, period."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1548854823, "post_id": 54440617, "comment_id": 95692433, "body": "So, &quot;this design forces you to use raw pointers, which are bad&quot;. Yup, fair enough!"}, {"owner": {"reputation": 1544, "user_id": 6475652, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8d783a89da27c7d36c0935fc2af7b38e?s=128&d=identicon&r=PG&f=1", "display_name": "Fryz", "link": "https://stackoverflow.com/users/6475652/fryz"}, "edited": false, "score": 0, "creation_date": 1548855578, "post_id": 54440617, "comment_id": 95692887, "body": "I am not specific about modern C++ here but it&#39;s interesting to notice that anyway."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 1544, "user_id": 6475652, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8d783a89da27c7d36c0935fc2af7b38e?s=128&d=identicon&r=PG&f=1", "display_name": "Fryz", "link": "https://stackoverflow.com/users/6475652/fryz"}, "edited": false, "score": 0, "creation_date": 1548856283, "post_id": 54440617, "comment_id": 95693306, "body": "@Scab modern C++ is not that new, it is time to learn it instead of the legacy c++98 or earlier. Anyways, even C++98 has <code>boost::shared_ptr</code>, <code>std::auto_ptr</code>, or home-made smart-pointers which are the way to go rather than raw pointers. I have been using smart-pointers since 1997, and they should be used even for legacy C++ (there are some issues without move-semantics, and <code>auto_ptr</code> is kind of broken, so there are cases when they can&#39;t be used)."}, {"owner": {"reputation": 2285, "user_id": 1916711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ebc3c1d0b082618f5db9b06b44c6a2?s=128&d=identicon&r=PG", "display_name": "arayq2", "link": "https://stackoverflow.com/users/1916711/arayq2"}, "edited": false, "score": 0, "creation_date": 1548856770, "post_id": 54440617, "comment_id": 95693636, "body": "Covariance is integral to the type erasure technique, where virtual Concept* Concept::clone() is overridden by Model* Model::clone().  This would seem to be a violation of the Core Guidelines too."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 2285, "user_id": 1916711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ebc3c1d0b082618f5db9b06b44c6a2?s=128&d=identicon&r=PG", "display_name": "arayq2", "link": "https://stackoverflow.com/users/1916711/arayq2"}, "edited": false, "score": 0, "creation_date": 1548857015, "post_id": 54440617, "comment_id": 95693780, "body": "@arayq2 I&#39;m not sure I follow. The type erasure I&#39;ve used and seen returns the base type. Do you have a link to code or document that strengthens your observation?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1548868293, "post_id": 54440617, "comment_id": 95701060, "body": "&quot;Covariance does not work for smart pointers&quot;. This is a language limitation rather than an inherent technique limitation. One can easily implement covariant return types that do work with any kind of handles whatsoever, without relying on the language feature that only works with raw pointers."}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 5, "last_activity_date": 1548881672, "last_edit_date": 1548881672, "creation_date": 1548851097, "answer_id": 54440617, "question_id": 54439944, "link": "https://stackoverflow.com/questions/54439944/what-are-the-drawbacks-of-c-covariance-return-types/54440617#54440617", "title": "What are the drawbacks of C++ covariance return types?", "body": "<p>Covariance does not work for smart pointers, and as such covariance violates:</p>\n\n<p><a href=\"https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Ri-raw\" rel=\"nofollow noreferrer\">Never transfer ownership by a raw pointer (T*) or reference (T&amp;)\n</a> of the C++ Core Guidelines. There are tricks to limit the issue, but still the covariant value is a raw pointer.</p>\n\n<p>An example from the document:</p>\n\n<pre><code>X* compute(args)    // don't\n{\n    X* res = new X{};\n    // ...\n    return res;\n}\n</code></pre>\n\n<p>This is almost the same as what the code in the question is doing:</p>\n\n<pre><code>virtual Derived *create()\n{\n    return new Derived;\n}\n</code></pre>\n\n<p>Unfortunately the following is illegal, both for <code>shared_ptr</code> and for <code>unique_ptr</code>:</p>\n\n<pre><code>struct AbstractFactory\n{\n    virtual std::shared_ptr&lt;Base&gt; create() = 0;\n};\n\nstruct ConcreteFactory : public AbstractFactory\n{\n    /*\n      &lt;source&gt;:16:38: error: invalid covariant return type for 'virtual std::shared_ptr&lt;Derived&gt; ConcreteFactory::create()'\n    */\n    virtual std::shared_ptr&lt;Derived&gt; create()\n    {\n        return std::make_shared&lt;Derived&gt;();\n    }\n};\n</code></pre>\n\n<h1>EDIT</h1>\n\n<p><a href=\"https://stackoverflow.com/a/54446402/4955498\">n.m.'s answer</a> shows a technique that simulates language covariance, with some additional code. It has some potential maintenance costs, so take that into account before deciding which way to go.</p>\n"}, {"comments": [{"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1548880929, "post_id": 54446402, "comment_id": 95707128, "body": "All is well, but then a class hierarchy needs <code>create_impl_derived</code>, <code>create_impl_derived_derived</code>, and so on. What in case of virtual multiple inheritance? What if you reactor and add one level in only one of the parents? Possible, but over engineered, and error prone and with maintenance costs. Maybe language-based covariance with raw pointers has fewer issues. Just maybe."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 1, "creation_date": 1548881042, "post_id": 54446402, "comment_id": 95707192, "body": "@MichaelVeksler Did I promise a free ride?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1548881155, "post_id": 54446402, "comment_id": 95707256, "body": "I agree, you didn&#39;t promise a free ride. I just want my covariance and contravariance in the language, please."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1548881740, "post_id": 54446402, "comment_id": 95707528, "body": "Anyway, I added a reference to your answer at the end of mine."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1548869827, "creation_date": 1548869827, "answer_id": 54446402, "question_id": 54439944, "link": "https://stackoverflow.com/questions/54439944/what-are-the-drawbacks-of-c-covariance-return-types/54446402#54446402", "title": "What are the drawbacks of C++ covariance return types?", "body": "<p>The chief limitation of covariant return types as implemented in C++ is that they only work with raw pointers and references. There are no real reasons <em>not</em> to use them when possible, but the limitation means we <em>cannot</em> always use them when we need them.</p>\n\n<p>It is easy to overcome this limitation while providing identical user experience, without ever relying to the language feature. Here's how.</p>\n\n<p>Let's rewrite our classes using the common and popular <a href=\"https://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Non-Virtual_Interface\" rel=\"nofollow noreferrer\">non-virtual interface</a> idiom.</p>\n\n<pre><code>struct AbstractFactory\n{\n    Base *create() {\n      return create_impl();\n    }\n\n  private:\n    virtual Base* create_impl() = 0;\n};\n\nstruct ConcreteFactory : public AbstractFactory\n{\n    Derived *create() {\n      return create_impl();\n    }\n\n  private:\n    Derived *create_impl() override {\n        return new Derived;\n    }\n};\n</code></pre>\n\n<p>Now here something interesting happens. <code>create</code> is no longer virtual, and therefore can have any return type. It is not constrained by the covariant return types rule. <code>create_impl</code> is still constrained, but it's private, no one is calling it but the class itself, so we can easily manipulate it and remove covariance altogether.</p>\n\n<pre><code>struct ConcreteFactory : public AbstractFactory\n{\n    Derived *create() {\n      return create_impl();\n    }\n\n  private:\n    Base *create_impl() override {\n        return create_impl_derived();\n    }\n\n    virtual Derived *create_impl_derived() {\n        return new Derived;\n    }\n};\n</code></pre>\n\n<p>Now both <code>AbstractFactory</code> and <code>ConcreteFactory</code> has exactly the same interface as before, without a covariant return type in sight. What does it mean for us? It means we can use smart pointers freely.</p>\n\n<pre><code>// replace `sptr` with your favourite kind of smart pointer\n\nstruct AbstractFactory\n{\n    sptr&lt;Base&gt; create() {\n      return create_impl();\n    }\n\n  private:\n    virtual sptr&lt;Base&gt; create_impl() = 0;\n};\n\nstruct ConcreteFactory : public AbstractFactory\n{\n    sptr&lt;Derived&gt; create() {\n      return create_impl();\n    }\n\n  private:\n    sptr&lt;Base&gt; create_impl() override {\n        return create_impl_derived();\n    }\n\n    virtual sptr&lt;Derived&gt; create_impl_derived() {\n        return make_smart&lt;Derived&gt;();\n    }\n};\n</code></pre>\n\n<p>Here we overcame a language limitation and provided an equivalent of covariant return types for our classes without relying on a limited language feature.</p>\n\n<p>Note for the technically inclined.</p>\n\n<pre><code>    sptr&lt;Base&gt; create_impl() override {\n        return create_impl_derived();\n    }\n</code></pre>\n\n<p>This here function implicitly converts (\"upcasts\") a <code>Derived</code> pointer to a <code>Base</code> pointer. If we use covariant return types as provided by the language, such upcast is inserted by the compiler automatically when needed. The language is unfortunately only smart enough to do it for raw pointers. For everything else we have to do it ourselves. Luckily, it's relatively easy, if a bit verbose.</p>\n\n<p>(In this particular case it <em>could</em> be acceptable to just return a <code>Base</code> pointer throughout. I'm not discussing this. I'm assuming we absolutely need something like covariant return types.)</p>\n"}], "owner": {"reputation": 1544, "user_id": 6475652, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8d783a89da27c7d36c0935fc2af7b38e?s=128&d=identicon&r=PG&f=1", "display_name": "Fryz", "link": "https://stackoverflow.com/users/6475652/fryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 54446402, "answer_count": 2, "score": 0, "last_activity_date": 1548881672, "creation_date": 1548848875, "last_edit_date": 1548854811, "question_id": 54439944, "link": "https://stackoverflow.com/questions/54439944/what-are-the-drawbacks-of-c-covariance-return-types", "title": "What are the drawbacks of C++ covariance return types?", "body": "<p>I have recently had to deal with C++ <a href=\"https://en.wikipedia.org/wiki/Covariant_return_type\" rel=\"nofollow noreferrer\">covariance return types</a> such as the following construct :</p>\n\n<pre><code>struct Base\n{\n     virtual ~Base();\n};\nstruct Derived : public Base {};\n\nstruct AbstractFactory\n{\n    virtual Base *create() = 0;\n    virtual ~AbstractFactory();\n};\n\nstruct ConcreteFactory : public AbstractFactory\n{\n    virtual Derived *create()\n    {\n        return new Derived;\n    }\n};\n</code></pre>\n\n<p>It allows the client code to treat the <code>Derived</code> object as a <code>Base</code> type or as a <code>Derived</code> type when needed and especially without the use of <code>dynamic_cast</code> or <code>static_cast</code>.</p>\n\n<p>What are the drawbacks of this approach ? Is it a sign of bad design ?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "qt", "build", "cmake", "dcmtk"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1548850437, "post_id": 54439827, "comment_id": 95689875, "body": "Welcome to Stack Overflow! Here we expect error message to be in the question post itself, not linked. Please. <a href=\"https://stackoverflow.com/posts/54439827/edit\">edit</a> your question and paste error log into it. You may format the log with <code>Ctrl+K</code> or <code>{}</code> button."}], "answers": [{"comments": [{"owner": {"reputation": 1395, "user_id": 3154372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffJOd.jpg?s=128&g=1", "display_name": "J. Riesmeier", "link": "https://stackoverflow.com/users/3154372/j-riesmeier"}, "reply_to_user": {"reputation": 103, "user_id": 7751880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zifcK.jpg?s=128&g=1", "display_name": "Dogrtt", "link": "https://stackoverflow.com/users/7751880/dogrtt"}, "edited": false, "score": 0, "creation_date": 1548938888, "post_id": 54448902, "comment_id": 95729859, "body": "Indeed, it seems that QtDCM switched to DCMTK 3.6.2 (<a href=\"https://github.com/qtdcm/qtdcm/commit/0c365f6\" rel=\"nofollow noreferrer\">github.com/qtdcm/qtdcm/commit/0c365f6</a>) but you are using a newer version of this DICOM toolkit? This is probably the reason for the compiler errors listed in your question above (since the API changed between releases)."}], "tags": [], "owner": {"reputation": 1395, "user_id": 3154372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffJOd.jpg?s=128&g=1", "display_name": "J. Riesmeier", "link": "https://stackoverflow.com/users/3154372/j-riesmeier"}, "is_accepted": true, "score": 0, "last_activity_date": 1548879506, "creation_date": 1548879506, "answer_id": 54448902, "question_id": 54439827, "link": "https://stackoverflow.com/questions/54439827/what-is-the-probable-reason-for-qtdcm-compilation-fail/54448902#54448902", "title": "What is the probable reason for QtDCM compilation fail?", "body": "<p>It seems that the QtDCM project has not been updated since November 2011, so I would suggest that you also download the DCMTK version that was available at that time, i.e. the <a href=\"https://dcmtk.org/download/dcmtk/dcmtk360/\" rel=\"nofollow noreferrer\">3.6.0 release</a>.</p>\n"}], "owner": {"reputation": 103, "user_id": 7751880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zifcK.jpg?s=128&g=1", "display_name": "Dogrtt", "link": "https://stackoverflow.com/users/7751880/dogrtt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 54448902, "answer_count": 1, "score": 0, "last_activity_date": 1548888709, "creation_date": 1548848506, "last_edit_date": 1548888709, "question_id": 54439827, "link": "https://stackoverflow.com/questions/54439827/what-is-the-probable-reason-for-qtdcm-compilation-fail", "title": "What is the probable reason for QtDCM compilation fail?", "body": "<p><code>QtDCM</code> compile fails. I did all as it described in this <a href=\"https://qtdcm.github.io/step2page.html\" rel=\"nofollow noreferrer\" title=\"manual\">manual</a>, <code>DCMTK</code> and <code>ITK</code> was compiled without any trouble, but when I try to compile <code>QtDCM</code>, it fails with errors:</p>\n\n<pre><code>2&gt;QtDcmFindScu.cpp\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmFindScu.cpp(197): error C2259: 'QtDcmFindCallback': cannot instantiate abstract class\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmFindScu.cpp(197): note: due to following members:\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmFindScu.cpp(197): note: 'void DcmFindSCUCallback::callback(T_DIMSE_C_FindRQ *,int &amp;,T_DIMSE_C_FindRSP *,DcmDataset *)': is abstract\n2&gt;D:\\CPP\\dcmtk-3.6.4\\dcmnet\\include\\dcmtk/dcmnet/dfindscu.h(96): note: see declaration of 'DcmFindSCUCallback::callback'\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmFindScu.cpp(198): error C2664: 'OFCondition DcmFindSCU::performQuery(const char *,unsigned int,const char *,const char *,const char *,E_TransferSyntax,T_DIMSE_BlockingMode,int,Uint32,bool,bool,unsigned int,DcmFindSCUExtractMode,int,OFList&lt;OFString&gt; *,DcmFindSCUCallback *,OFList&lt;OFString&gt; *,const char *,const char *)': cannot convert argument 13 from 'bool' to 'DcmFindSCUExtractMode'\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmFindScu.cpp(203): note: Conversion to enumeration type requires an explicit cast (static_cast, C-style cast or function-style cast)\n2&gt;QtDcmMoveScu.cpp\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmMoveScu.cpp(373): error C2039: 'unlock': is not a member of 'GlobalDcmDataDictionary'\n2&gt;D:\\CPP\\dcmtk-3.6.4\\dcmdata\\include\\dcmtk/dcmdata/dcdict.h(216): note: see declaration of 'GlobalDcmDataDictionary'\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmMoveScu.cpp(775): error C2660: 'DU_findSOPClassAndInstanceInDataSet': function does not take 4 arguments\n2&gt;D:\\CPP\\dcmtk-3.6.4\\dcmnet\\include\\dcmtk/dcmnet/diutil.h(110): note: see declaration of 'DU_findSOPClassAndInstanceInDataSet'\n2&gt;D:\\CPP\\qtdcm\\src\\QtDcmMoveScu.cpp(965): error C2660: 'ASC_getAPTitles': function does not take 4 arguments\n2&gt;D:\\CPP\\dcmtk-3.6.4\\dcmnet\\include\\dcmtk/dcmnet/assoc.h(328): note: see declaration of 'ASC_getAPTitles'\n</code></pre>\n\n<p>Is it troubles in library src?\nIs it possible that I did mistake in <code>CMake-GUI</code> when configured it?</p>\n\n<p>I want to compile <code>QtDCM</code> library.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1548848565, "post_id": 54439804, "comment_id": 95688769, "body": "You can use <a href=\"https://en.cppreference.com/w/cpp/language/typeid\" rel=\"nofollow noreferrer\"><code>typeid</code></a> for a similar purpose. Do note the difference between dynamic and static types though. However, please edit your question to add an actual <b>answerable question</b>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1548848755, "post_id": 54439804, "comment_id": 95688877, "body": "It&#39;s not possible to store a type, and what you&#39;re doing might even be bad design. What is the <i>real</i> problem you want to solve by something like this? What are your requirements? Your use-cases? And what prevents you from using factory functions?"}, {"owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548850640, "post_id": 54439804, "comment_id": 95689990, "body": "@Some programmer dude, not necessarily bad design (in general at least). For instance, this could be extremely useful when implementing network data serialization/deserialization for types (classes) that are not known at compile time. Anyway, c++ doesn&#39;t support this."}, {"owner": {"reputation": 21, "user_id": 10989882, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5nDFMUpX94Y/AAAAAAAAAAI/AAAAAAAABew/5j_4QKlWGJs/photo.jpg?sz=128", "display_name": "Jon Snow", "link": "https://stackoverflow.com/users/10989882/jon-snow"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548850955, "post_id": 54439804, "comment_id": 95690180, "body": "@Some programmer dude, this small code will be part of a factory c++ design patern and I think It&#39;s not a good idea implement another factory functions into a well-designed and ready patern deployed."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1548851175, "post_id": 54439804, "comment_id": 95690323, "body": "You should really forget about Python when writing C++. They are different languages with different idioms."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1548853441, "post_id": 54439804, "comment_id": 95691534, "body": "Do these types have any commonality? What are you going to do with the <code>newObject </code> once you have created it?"}, {"owner": {"reputation": 21, "user_id": 10989882, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5nDFMUpX94Y/AAAAAAAAAAI/AAAAAAAABew/5j_4QKlWGJs/photo.jpg?sz=128", "display_name": "Jon Snow", "link": "https://stackoverflow.com/users/10989882/jon-snow"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1548858348, "post_id": 54439804, "comment_id": 95694656, "body": "@caleth newObject is manage by other classes. This is not the question. Finally, all objects will be reachable by a shared_ptr so more actual code could be: std::share_ptr&lt;typesArray[i]&gt; myPtr = std::make_shared&lt;typesArray[i]&gt; (typesArray[i]());"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1548858676, "post_id": 54439804, "comment_id": 95694875, "body": "That still doesn&#39;t answer whether there is commonality between these types. You <b>could</b> have <code>std::shared_ptr&lt;SomeBaseClass&gt; myPtr = factory[i].make_shared();</code> but that requires the all the types you are constructing here inherit from <code>SomeBaseClass</code>. You <b>could</b> have <code>std::any myThing = factory[i].make();</code>, however there then isn&#39;t anything interesting you can do with <code>myThing</code>"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1548859100, "post_id": 54439804, "comment_id": 95695170, "body": "If the list of types is constant, you <b>could</b> have <code>std::variant&lt;Class1, Class2&gt; newObject = factory[i].make();</code>. Which of these options is most appropriate depends on <i>what you do with <code>newObject</code></i>"}], "owner": {"reputation": 21, "user_id": 10989882, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5nDFMUpX94Y/AAAAAAAAAAI/AAAAAAAABew/5j_4QKlWGJs/photo.jpg?sz=128", "display_name": "Jon Snow", "link": "https://stackoverflow.com/users/10989882/jon-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548850282, "creation_date": 1548848450, "question_id": 54439804, "link": "https://stackoverflow.com/questions/54439804/how-to-make-and-class-array-to-define-what-class-use-to-next-instance", "title": "How to make and class array to define what class use to next instance?", "body": "<p>I usually works with python and I keep the mind of this language. So I want to make an array or struct like that:</p>\n\n<pre><code>struct instanceType = {\nstd::string name,\nclass typeOfclass\n};\n</code></pre>\n\n<p>The idea is to run a loop to check from a string list a match with instanceType and get from this the class for instance a new object. e.g.</p>\n\n<pre><code>instanceType type1;\ntype1.name = \"Type1\";\ntype1.class = Class1;\ninstanceType type2;\ntype1.name = \"Type2\";\ntype1.class = Class2;\nint implementTypes = 2;\ninstanceType typesArray[implementTypes] = {type1, type2};\n\n// This is the goal I want\n...\nfor(int i=0; i &lt; implementTypes; ++i) {\n    for(const std::string&amp; objectToCreate; objectsToCreate) {\n        if(typesArray[i].name==objectToCreate) {\n            typesArray[i].class newObject = typesArray[i]() //\"Constructor\"\n        }\n    }\n}\n</code></pre>\n\n<p>It could be crazy but it would be very useful to be able to use something similar.</p>\n"}, {"tags": ["c++", "parsing", "dictionary", "yaml", "yaml-cpp"], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 5454353, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/1649142428694730/picture?type=large", "display_name": "Federico Nardi", "link": "https://stackoverflow.com/users/5454353/federico-nardi"}, "is_accepted": false, "score": 1, "last_activity_date": 1548863856, "creation_date": 1548863856, "answer_id": 54444585, "question_id": 54439800, "link": "https://stackoverflow.com/questions/54439800/how-to-parse-a-file-with-yaml-cpp/54444585#54444585", "title": "How to parse a file with yaml-cpp", "body": "<p>I guess I underestimated the power of the library. It turns out that doing so solves the problem:</p>\n\n<pre><code>  YAML::Node map = YAML::LoadFile(filename);\n  for(YAML::const_iterator it=map.begin(); it!=map.end(); ++it){\n    const std::string &amp;key=it-&gt;first.as&lt;std::string&gt;();\n\n    Eigen::Vector2f pos;\n    YAML::Node attributes = it-&gt;second;\n    YAML::Node position = attributes[\"position\"];\n    for(int i=0; i&lt;2; ++i){\n      pos(i) = position[i].as&lt;float&gt;();\n    }\n\n    ...\n  }\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 5454353, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/1649142428694730/picture?type=large", "display_name": "Federico Nardi", "link": "https://stackoverflow.com/users/5454353/federico-nardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2344, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1597351290, "creation_date": 1548848428, "last_edit_date": 1597351290, "question_id": 54439800, "link": "https://stackoverflow.com/questions/54439800/how-to-parse-a-file-with-yaml-cpp", "title": "How to parse a file with yaml-cpp", "body": "<p>I have a yaml file that looks like this:</p>\n<pre><code>construction_cone_1:\n  model: construction_cone\n  model_type: sdf\n  position: [ 1.2, 3.4, 0.0 ]\n  orientation: [ 0.0, 0.0, 0 ]\n  \nconstruction_cone_2:\n  model: construction_cone\n  model_type: sdf\n  position: [ 3.0, 7.0, 0.0 ]\n  orientation: [ 0.0, 0.0, 0 ]\n \n...\n</code></pre>\n<p>I'm following <a href=\"https://github.com/jbeder/yaml-cpp/wiki/How-To-Parse-A-Document-(Old-API)\" rel=\"nofollow noreferrer\">this</a> tutorial to parse it in my c++ application.</p>\n<p>What I understood so far is that, as it is structured, the file is loaded as a map into a <code>YAML::Node</code>. So, I guess, a good way to read it is:</p>\n<pre><code>YAML::Node map = YAML::LoadFile(file_path);\n  for(YAML::const_iterator it=map.begin(); it!=map.end(); ++it){\n    const std::string &amp;key=it-&gt;first.as&lt;std::string&gt;();\n</code></pre>\n<p>This gives me &quot;construction_cone_1&quot; for the first entry and so on. By following this logic I'm not able to figure out how to read the remainder. In particular, for each entry of the map, I'm interested in reading the object position.</p>\n"}, {"tags": ["c++", "c++17", "linker-errors", "constexpr"], "comments": [{"owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "edited": false, "score": 0, "creation_date": 1548849357, "post_id": 54439741, "comment_id": 95689251, "body": "The question isn&#39;t an exact duplicate, though the answer there answers most of my question. (It doesn&#39;t answer why the commented-out workaround works even with <code>-std=c++14</code>)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1548851759, "post_id": 54439741, "comment_id": 95690616, "body": "The commented workaround creates an <code>int</code> prvalue. The const reference <code>std::min</code> expects thus doesn&#39;t try to bind to <code>kConstant</code> (and odr use it due to it). I edited in another duplicate that addresses it (which also has an answer mentioning a cast)."}, {"owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1548852567, "post_id": 54439741, "comment_id": 95691037, "body": "@StoryTeller Awesome, thank you!"}, {"owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1549189205, "post_id": 54439741, "comment_id": 95807928, "body": "@StoryTeller By the way - isn&#39;t it an issue (in both compilers) that I do not get a warning in <code>-std=c++14</code> due to trying to initialize the non-inline static constexpr member in its declaration, which should have no effect, rather than in its (missing) definition?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1549189466, "post_id": 54439741, "comment_id": 95807982, "body": "The declaration must contain an initializer. So there is no problem. That&#39;s what facilitates using it as a constexpr, so long as it isn&#39;t odr-used."}, {"owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1549194980, "post_id": 54439741, "comment_id": 95809208, "body": "@StoryTeller Of course. Thanks!"}], "owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1548848876, "answer_count": 0, "score": 1, "last_activity_date": 1548851964, "creation_date": 1548848261, "last_edit_date": 1548849590, "question_id": 54439741, "link": "https://stackoverflow.com/questions/54439741/constexpr-data-member-defined-in-h-is-unresolved-in-cpp-only-on-std-c14-and", "closed_reason": "Duplicate", "title": "constexpr data member defined in .h is unresolved in .cpp only on -std=c++14 and below", "body": "<p>The following only links successfully with <code>-std=c++17</code> or above. <code>-std=c++14</code> or below gives an unresolved external error:</p>\n\n<pre><code>In function `C::f()':\nC.cpp:(.text+0x19): undefined reference to `C::kConstant' \n</code></pre>\n\n<p>Why doesn't this work with the c++14 standard and does work with the c++17 standard? (tested with both GCC and Clang)</p>\n\n<p>And why does the commented-out workaround work even on c++14?</p>\n\n<p><strong>C.h</strong></p>\n\n<pre><code>#pragma once\n\nclass C {\npublic:\n    static constexpr int kConstant = 10;\n    int f();\n};\n</code></pre>\n\n<p><strong>C.cpp</strong></p>\n\n<pre><code>#include \"C.h\"\n\n#include &lt;algorithm&gt;\n\nint C::f()\n{\n    // This only works with -std=c++17 or above\n    return std::min (1, kConstant); \n\n    // This works even with -std=c++14\n//    return std::min (1, static_cast&lt;int&gt; (kConstant));\n}\n</code></pre>\n\n<p><strong>Main.cpp</strong></p>\n\n<pre><code>#include \"C.h\"\n\nint main()\n{\n    C c;\n    c.f();\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/BznRbSOkssgQ7qV6\" rel=\"nofollow noreferrer\">Wandbox</a></p>\n\n<p>Update: <a href=\"https://stackoverflow.com/questions/39646958/constexpr-static-member-before-after-c17\">This</a> question isn't an exact duplicate, but has an answer which answers most of my question. It doesn't answer why the workaround works with <code>-std=c++14</code>, though, and the original doesn't. Is it perhaps because in the original the variable is <em>odr-used</em>, and in the workaround it is not?</p>\n"}]