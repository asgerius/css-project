[{"tags": ["c++", "list", "recursion", "stl", "listiterator"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538611361, "post_id": 52637126, "comment_id": 92207408, "body": "You don&#39;t initialize <code>name_rank</code> (and have typo as you just use <code>name</code>)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538611488, "post_id": 52637126, "comment_id": 92207430, "body": "<i>&quot;gets lots of compilation errors&quot;</i>. so provide some."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1538611704, "post_id": 52637126, "comment_id": 92207478, "body": "Just curious, why would you want to convert non-recursive code to recursive?"}, {"owner": {"reputation": 39, "user_id": 9746910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1033393e8b7ce6453960cc5bc44a61ac?s=128&d=identicon&r=PG&f=1", "display_name": "Tawhid K", "link": "https://stackoverflow.com/users/9746910/tawhid-k"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1538613847, "post_id": 52637126, "comment_id": 92207877, "body": "@aschepler Extra credit"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538611654, "post_id": 52637181, "comment_id": 92207464, "body": "Notice that it is mostly what OP does. (bad start, and missing initialization)."}, {"owner": {"reputation": 39, "user_id": 9746910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1033393e8b7ce6453960cc5bc44a61ac?s=128&d=identicon&r=PG&f=1", "display_name": "Tawhid K", "link": "https://stackoverflow.com/users/9746910/tawhid-k"}, "edited": false, "score": 0, "creation_date": 1538615505, "post_id": 52637181, "comment_id": 92208209, "body": "Thank you! I fixed my bad initialization and used your format and it works like a charm."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 2, "last_activity_date": 1538611794, "last_edit_date": 1538611794, "creation_date": 1538611396, "answer_id": 52637181, "question_id": 52637126, "link": "https://stackoverflow.com/questions/52637126/how-do-i-turn-an-iterative-stl-list-for-loop-function-into-a-recursion/52637181#52637181", "title": "How do I turn an iterative STL List for loop function into a recursion?", "body": "<p>Here's a general schema, with short placeholder names.</p>\n\n<p>Given an iteration as follows:</p>\n\n<pre><code>void do_something(const Container&amp; c)\n{\n    // preamble\n    for (auto it = c.begin(); it != c.end(); ++it)\n    {\n        // per-loop action on *it\n    }\n}\n</code></pre>\n\n<p>You can write the following recursion:</p>\n\n<pre><code>void do_aux(Container::const_iterator first, Container::const_iterator last)\n{\n    if (first == last) return;\n\n    // per-loop action on *first\n\n    ++first;\n    return do_aux(first, last);\n}\n\nvoid do_something(const Container&amp; c)\n{\n    // preamble\n    do_aux(c.begin(), c.end());\n}\n</code></pre>\n\n<p>Note that this is nicely tail-recursive, which shows the essential equivalence of iteration and tail-recursion. The auxiliary function <code>do_aux</code> takes the place of the loop, including checking of the loop condition and breaking. Additional state from the preamble that's needed in the loop body can be passed via additional arguments to <code>do_aux</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 9746910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1033393e8b7ce6453960cc5bc44a61ac?s=128&d=identicon&r=PG&f=1", "display_name": "Tawhid K", "link": "https://stackoverflow.com/users/9746910/tawhid-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 1, "accepted_answer_id": 52637181, "answer_count": 1, "score": -2, "last_activity_date": 1538611794, "creation_date": 1538610841, "question_id": 52637126, "link": "https://stackoverflow.com/questions/52637126/how-do-i-turn-an-iterative-stl-list-for-loop-function-into-a-recursion", "title": "How do I turn an iterative STL List for loop function into a recursion?", "body": "<p>So I have a simple for loop inside a class member function which prints the names of students a university wants to offer admission to. StudentPreferenceList and SchoolName are class member variables and ostr is the file where I want to write the output.</p>\n\n<pre><code>void School::printSchoolPreferences(std::ostream &amp;ostr) const{\n\n    std::list&lt;std::string&gt;::const_iterator name;\n    ostr &lt;&lt; SchoolName + \" preference list:\"&lt;&lt; std::endl;\n    int rank = 1;\n\n    for (name = SchoolPreferenceList.begin(); name != \n         SchoolPreferenceList.end(); name++){\n\n         ostr &lt;&lt; \"  \" &lt;&lt; rank &lt;&lt; \". \" &lt;&lt; *name &lt;&lt; std::endl;\n         rank++;\n    }\n\n}\n</code></pre>\n\n<p>I am trying to now convert this function into a recursive function and this is what I have so far. My current attempt below gets lots of compilation errors and I will really appreciate if you can help me figure out how to fix it. Thank you.</p>\n\n<pre><code>void School::func(int rank, std::list&lt;std::string&gt;::const_iterator \n                  name_rank, std::ostream &amp;ostr){\n\n     if (rank &lt; SchoolPreferenceList.size()){\n         ostr &lt;&lt; \"  \" &lt;&lt; rank &lt;&lt; \". \" &lt;&lt; *name_rank &lt;&lt; std::endl;\n         func(rank++, name_rank++, ostr);\n     }\n}\n\nvoid School::printSchoolPreferences(std::ostream &amp;ostr) const{\n\n    std::list&lt;std::string&gt;::const_iterator name;\n    ostr &lt;&lt; SchoolName + \" preference list:\"&lt;&lt; std::endl;\n\n    int rank = 1;\n    func(rank, name_rank, ostr);\n}\n</code></pre>\n\n<p>This is the expected output:</p>\n\n<pre><code> university_of_michigan preference list:\n   1. erin_jones\n   2. john_smith\n   3. joe_miller\n   4. dave_roberts\n</code></pre>\n"}, {"tags": ["c++", "googletest", "conflict", "gmock"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538611102, "post_id": 52637105, "comment_id": 92207354, "body": "Only last matcher wins. so your test would pass only if you call also <code>mock(&quot;..bb..&quot;)</code> 1-5 times."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538611146, "post_id": 52637105, "comment_id": 92207371, "body": "Maybe you want <code>EXPECT_CALL(mock,set(Not(HasSubstr(&quot;bb&quot;)))).Times(Between(1,&zwnj;&#8203;5));</code>."}], "owner": {"reputation": 5623, "user_id": 6164172, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cfe3f1dd56fc9c05a01393d3c618d727?s=128&d=identicon&r=PG&f=1", "display_name": "Troskyvs", "link": "https://stackoverflow.com/users/6164172/troskyvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538610637, "creation_date": 1538610637, "question_id": 52637105, "link": "https://stackoverflow.com/questions/52637105/google-mock-multiple-expect-call-conflict-with-each-other", "title": "google mock multiple EXPECT_CALL conflict with each other?", "body": "<p>I've got this code snippet and it runs well:</p>\n\n<pre><code>class If2{\npublic:\n    virtual void set(const char* s)=0;\n};\nclass Impl2:public If2{\npublic:\n    MOCK_METHOD1(set, void(const char*));\n};\nTEST(t2,case2){\n    Impl2 mock;\n    EXPECT_CALL(mock,set).Times(Between(1,5));\n    mock.set(\"aa\");\n}\n</code></pre>\n\n<p>But when I add 2 EXPECT_CALL for set(), then it doesn't work:</p>\n\n<pre><code>TEST(t2,case2){\n    Impl2 mock;\n    EXPECT_CALL(mock,set).Times(Between(1,5));\n    EXPECT_CALL(mock,set(Not(HasSubstr(\"bb\"))));\n    mock.set(\"aa\");\n}\n</code></pre>\n\n<p>Error message is:</p>\n\n<pre><code>Actual function call count doesn't match EXPECT_CALL(mock, set)...\n        Expected: to be called between 1 and 5 times\n        Actual: never called - unsatisfied and active\n</code></pre>\n\n<p>It's really strange for me, I've called \"set\" once, why multiple EXPECT_CALL doesn't work here?\nThanks.</p>\n"}, {"tags": ["c++", "boost", "cmake", "boost-thread"], "comments": [{"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1538610078, "post_id": 52636944, "comment_id": 92207168, "body": "It looks like you&#39;re compiling your code with a different version of your compiler than you used to build boost.  That&#39;s throwing off boost&#39;s <code>#pragma comment(lib, ...)</code> directives.  You should really build boost with the same version of your compiler you use for your code."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1538612557, "post_id": 52636944, "comment_id": 92207625, "body": "Since 14.0 Boost should be compatible with 14.1 toolchain, you could also disable the <code>#pragma comment(lib)</code> directives with something like <code>target_compile_definitions(test PUBLIC BOOST_ALL_NO_LIB)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 1066891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35219aa43c9639fb92299202e1ccd78?s=128&d=identicon&r=PG", "display_name": "Gombat", "link": "https://stackoverflow.com/users/1066891/gombat"}, "is_accepted": false, "score": 1, "last_activity_date": 1538610359, "creation_date": 1538610359, "answer_id": 52637081, "question_id": 52636944, "link": "https://stackoverflow.com/questions/52636944/using-boostthread-with-cmake-in-ms-visual-studio-2017-results-in-two-compiler/52637081#52637081", "title": "Using boost::thread with CMake in MS Visual Studio 2017 results in two compiler errors", "body": "<p>1) If you use</p>\n\n<pre><code>set(Boost_USE_STATIC_LIBS OFF)\n</code></pre>\n\n<p>and dont give a version number for boost</p>\n\n<pre><code>find_package(Boost COMPONENTS random thread) \n</code></pre>\n\n<p>since you are using 1.68 and not 1.58, right? It should work. I can reproduce your error messages with your settings and it works using the mentioned settings. </p>\n\n<p>2) The boost CMake package file searches for a boost version depending on your selected compiler, I guess the default for vs 2017 is 14.1. See also <a href=\"https://stackoverflow.com/questions/42730478/version-numbers-for-visual-studio-2017-boost-and-cmake/42738533\">here</a>. </p>\n\n<p>To solve this problem, download and install the proper prebuilt binaries. </p>\n"}, {"comments": [{"owner": {"reputation": 10239, "user_id": 273456, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/elCxp.jpg?s=128&g=1", "display_name": "Zordid", "link": "https://stackoverflow.com/users/273456/zordid"}, "edited": false, "score": 0, "creation_date": 1551963367, "post_id": 52637930, "comment_id": 96839222, "body": "for me, the compile error did not go away with this &quot;add_definitions&quot;... :( What else could it be?"}, {"owner": {"reputation": 3055, "user_id": 94526, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/75cd821af1d77539a3fe6e34cb2b45c9?s=128&d=identicon&r=PG", "display_name": "WolfgangP", "link": "https://stackoverflow.com/users/94526/wolfgangp"}, "reply_to_user": {"reputation": 10239, "user_id": 273456, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/elCxp.jpg?s=128&g=1", "display_name": "Zordid", "link": "https://stackoverflow.com/users/273456/zordid"}, "edited": false, "score": 0, "creation_date": 1552059148, "post_id": 52637930, "comment_id": 96880353, "body": "You have to take extra care that your Boost library exaclty matches your Visual Studio version. You should use the prebuild libraries."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1559640653, "post_id": 52637930, "comment_id": 99475576, "body": "@WolfgangP: The error is in a Boost header file. &quot;Prebuilt boost libraries&quot; affect only the .cpp files in Boost, which for prebuilt libraries will have been compiled into .obj and then linked in .lib format."}], "tags": [], "owner": {"reputation": 3055, "user_id": 94526, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/75cd821af1d77539a3fe6e34cb2b45c9?s=128&d=identicon&r=PG", "display_name": "WolfgangP", "link": "https://stackoverflow.com/users/94526/wolfgangp"}, "is_accepted": false, "score": 0, "last_activity_date": 1538618265, "creation_date": 1538618265, "answer_id": 52637930, "question_id": 52636944, "link": "https://stackoverflow.com/questions/52636944/using-boostthread-with-cmake-in-ms-visual-studio-2017-results-in-two-compiler/52637930#52637930", "title": "Using boost::thread with CMake in MS Visual Studio 2017 results in two compiler errors", "body": "<p>Thank you for your hints!</p>\n\n<p>The following steps resolved the problem:</p>\n\n<p>1) I installed boost for MSVC 14.1 (prebuild binaries)</p>\n\n<p>2) I added the following to the CMakeLists.txt:</p>\n\n<pre><code>add_definitions(-DBOOST_ALL_NO_LIB)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 373, "user_id": 1782708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6706fc6e9bf14fc0507d4e2d8f566c80?s=128&d=identicon&r=PG", "display_name": "Mikkel K.", "link": "https://stackoverflow.com/users/1782708/mikkel-k"}, "edited": false, "score": 0, "creation_date": 1546606557, "post_id": 54025978, "comment_id": 94913789, "body": "Had the same issue with 15.9.4 and Boost 1.69.0. Your answer solves it, but I&#39;d still love to see a solution that doesn&#39;t involve changing Boost headers."}, {"owner": {"reputation": 2013, "user_id": 344159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80787ec11793e168ac24d71ded48b3e7?s=128&d=identicon&r=PG", "display_name": "Oliver Zendel", "link": "https://stackoverflow.com/users/344159/oliver-zendel"}, "reply_to_user": {"reputation": 373, "user_id": 1782708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6706fc6e9bf14fc0507d4e2d8f566c80?s=128&d=identicon&r=PG", "display_name": "Mikkel K.", "link": "https://stackoverflow.com/users/1782708/mikkel-k"}, "edited": false, "score": 0, "creation_date": 1547219128, "post_id": 54025978, "comment_id": 95129175, "body": "Me too, I suspect that this must be fixed by MS or this fix has to be pushed to the boost trunk"}, {"owner": {"reputation": 2013, "user_id": 344159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80787ec11793e168ac24d71ded48b3e7?s=128&d=identicon&r=PG", "display_name": "Oliver Zendel", "link": "https://stackoverflow.com/users/344159/oliver-zendel"}, "reply_to_user": {"reputation": 373, "user_id": 1782708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6706fc6e9bf14fc0507d4e2d8f566c80?s=128&d=identicon&r=PG", "display_name": "Mikkel K.", "link": "https://stackoverflow.com/users/1782708/mikkel-k"}, "edited": false, "score": 4, "creation_date": 1557734749, "post_id": 54025978, "comment_id": 98849748, "body": "Addenum: This is now fixed in the current develop branch; v1.70 release still has the  breaking code ( see <a href=\"https://github.com/boostorg/system/commit/bfbc5ec42ff35f4dcbd1547244504d4e6fc7737d\" rel=\"nofollow noreferrer\">github.com/boostorg/system/commit/&hellip;</a> )"}], "tags": [], "owner": {"reputation": 2013, "user_id": 344159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80787ec11793e168ac24d71ded48b3e7?s=128&d=identicon&r=PG", "display_name": "Oliver Zendel", "link": "https://stackoverflow.com/users/344159/oliver-zendel"}, "is_accepted": false, "score": 7, "last_activity_date": 1546531928, "creation_date": 1546531928, "answer_id": 54025978, "question_id": 52636944, "link": "https://stackoverflow.com/questions/52636944/using-boostthread-with-cmake-in-ms-visual-studio-2017-results-in-two-compiler/54025978#54025978", "title": "Using boost::thread with CMake in MS Visual Studio 2017 results in two compiler errors", "body": "<p>I get the same error message in Visual Studio 2017 version 15.9 and Boost 1.69.0; I think that the trouble arises from this VS version introducing some version of __has_cpp_attribute which the boost authors expected only to be present in clang.</p>\n\n<p>I had to change boost\\system\\detail\\config.hpp line 50 \nfrom</p>\n\n<pre><code>#if defined(__has_cpp_attribute)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>#if defined(__clang__) &amp;&amp; defined(__has_cpp_attribute)\n</code></pre>\n\n<p>as the remaining preprocessor define is only relevant to clang anyways.</p>\n\n<p>Changing boost headers is quite messy, but I didn't find a clean solution yet :(.\nI was hoping /Zc had some switch to deactive this new \"feature\" (feature testing macro)</p>\n"}], "owner": {"reputation": 3055, "user_id": 94526, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/75cd821af1d77539a3fe6e34cb2b45c9?s=128&d=identicon&r=PG", "display_name": "WolfgangP", "link": "https://stackoverflow.com/users/94526/wolfgangp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1883, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1546531928, "creation_date": 1538608987, "last_edit_date": 1538609794, "question_id": 52636944, "link": "https://stackoverflow.com/questions/52636944/using-boostthread-with-cmake-in-ms-visual-studio-2017-results-in-two-compiler", "title": "Using boost::thread with CMake in MS Visual Studio 2017 results in two compiler errors", "body": "<p>I want to use boost::thread in my project and I use CMake as a build tool. However, even a very simple setup results in two compiler errors:</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;boost/thread.hpp&gt;\n\nint main() \n{\n    boost::thread t;\n    return 0;\n}\n</code></pre>\n\n<p><strong>CMakeLists.txt</strong></p>\n\n<pre><code>cmake_minimum_required (VERSION 2.6)\nproject (ThreadTest)\n\nset(Boost_USE_STATIC_LIBS OFF) \nset(Boost_USE_MULTITHREADED ON)  \nset(Boost_USE_STATIC_RUNTIME OFF) \nfind_package(Boost 1.58.0 COMPONENTS random thread) \n\nset(SOURCE_DIR src)\nset(SOURCE_FILES\n    ${SOURCE_DIR}/main.cpp\n    )\n\nif(Boost_FOUND)\n    include_directories(${Boost_INCLUDE_DIRS}) \n    add_executable(test ${SOURCE_FILES})\n    target_link_libraries(test ${Boost_LIBRARIES})\nendif()\n</code></pre>\n\n<p>I'm using Boost 1.68.0 which CMake can find and is able to build proper Visual Studio project files. </p>\n\n<p>I tried using boost::random, and it worked. </p>\n\n<p>However, compiling the above program results in two error messages:</p>\n\n<ul>\n<li><strong>E2512</strong>: Argument for a feature-test-macro has to be a simple identifier (pointing out to an error in boost file error_code.hpp)</li>\n<li><strong>LINK1104</strong>: File 'libboost_thread-vc14<strong>1</strong>-mt-x64-1_68.lib' cannot be opened</li>\n</ul>\n\n<p>This is the line in error_code.hpp which throws the error</p>\n\n<p><a href=\"https://i.stack.imgur.com/GNH7D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GNH7D.png\" alt=\"enter image description here\"></a></p>\n\n<p>I looked for the file 'libboost_thread-vc14<strong>1</strong>-mt-x64-1_68.lib' in my boost installation but only found 'boost_1_68_0\\lib64-msvc-14.0\\boost_thread-vc14<strong>0</strong>-mt-gd-x64-1_68.lib'</p>\n\n<p>The linker settings contain the correct files:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pIq8F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pIq8F.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, my two questions:</p>\n\n<ol>\n<li>Why is there a compilation error in error_code.hpp, which is part of the boost::system module and what can I do about it?</li>\n<li>Why does VS want to link the file libboost_thread-vc14<strong>1</strong>-mt-x64-1_68.lib, instead of the correct and available libboost_thread-vc14<strong>0</strong>-mt-x64-1_68.lib?</li>\n</ol>\n"}, {"tags": ["c++", "makefile", "frameworks", "g++", "cross-platform"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1538609574, "post_id": 52636936, "comment_id": 92207071, "body": "To make things as simple as possible, write two different makefiles."}, {"owner": {"reputation": 459, "user_id": 5095372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152956463043461/picture?type=large", "display_name": "Graeme Rock", "link": "https://stackoverflow.com/users/5095372/graeme-rock"}, "edited": false, "score": 0, "creation_date": 1538611523, "post_id": 52636936, "comment_id": 92207435, "body": "I think there is some confusion - those are three parts within the same Makefile. I will edit for clarity."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1538613421, "post_id": 52636936, "comment_id": 92207783, "body": "If the <code>-F</code> option does what I think it does, try changing <code>CFLAGS = -c -F&#47;Library&#47;Frameworks</code> to <code>CFLAGS = -c -F&#47;Library&#47;Frameworks -F&#47;Library&#47;Frameworks&#47;SDL2</code>, and a couple of the <code>#include &lt;SDL2&#47;SDL.h&gt;</code> to <code>#include &lt;SDL.h&gt;</code>, and see if that compiles."}, {"owner": {"reputation": 459, "user_id": 5095372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152956463043461/picture?type=large", "display_name": "Graeme Rock", "link": "https://stackoverflow.com/users/5095372/graeme-rock"}, "edited": false, "score": 0, "creation_date": 1538703082, "post_id": 52636936, "comment_id": 92245068, "body": "Yeah, I tried that, but it didn\u2019t work. Sorry."}, {"owner": {"reputation": 459, "user_id": 5095372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152956463043461/picture?type=large", "display_name": "Graeme Rock", "link": "https://stackoverflow.com/users/5095372/graeme-rock"}, "edited": false, "score": 0, "creation_date": 1538755159, "post_id": 52636936, "comment_id": 92268593, "body": "Also, does the person who gave a -1 for the question have any feedback as to why this is a bad question?"}], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 5095372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152956463043461/picture?type=large", "display_name": "Graeme Rock", "link": "https://stackoverflow.com/users/5095372/graeme-rock"}, "is_accepted": false, "score": 0, "last_activity_date": 1539340656, "creation_date": 1539340656, "answer_id": 52777734, "question_id": 52636936, "link": "https://stackoverflow.com/questions/52636936/modify-makefile-to-simplify-framework-include-path/52777734#52777734", "title": "Modify Makefile to simplify framework #include path", "body": "<p>To use <code>#include &lt;SDL.h&gt;</code> as the Windows counterpart is doing, you need to provide the path to the headers within the framework with the <code>-I</code> command in addition to letting the compiler know it is using a framework with <code>-F</code>.</p>\n\n<p>The two lines in the Makefile will look like this:</p>\n\n<pre><code>CFLAGS = -c -I/Library/Frameworks/SDL2.framework/Headers -F/Library/Frameworks/\nINCLUDE = -I/Library/Frameworks/SDL2.framework/Headers -F/Library/Frameworks/\n</code></pre>\n\n<p>To inlcude a second library, like SDL_image, you would simply do:</p>\n\n<pre><code>CFLAGS = -c -I/Library/Frameworks/SDL2.framework/Headers  -I/Library/Frameworks/SDL2_image.framework/Headers -F/Library/Frameworks/\nINCLUDE = -I/Library/Frameworks/SDL2.framework/Headers -I/Library/Frameworks/SDL2_image.framework/Headers -F/Library/Frameworks/\n</code></pre>\n\n<p>(You're welcome, myself and the community.)</p>\n"}], "owner": {"reputation": 459, "user_id": 5095372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152956463043461/picture?type=large", "display_name": "Graeme Rock", "link": "https://stackoverflow.com/users/5095372/graeme-rock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539340656, "creation_date": 1538608941, "last_edit_date": 1538611600, "question_id": 52636936, "link": "https://stackoverflow.com/questions/52636936/modify-makefile-to-simplify-framework-include-path", "title": "Modify Makefile to simplify framework #include path", "body": "<h3>Question</h3>\n\n<p>Is there a way to modify the <code>INCLUDE</code> path for frameworks in the <code>Makefile</code> to be able to simplify <code>&lt;SDL2/SDL.h&gt;</code> to <code>&lt;SDL.h&gt;</code> as is used for Windows?</p>\n\n<h3>Background</h3>\n\n<p>I am attempting to edit my team's Makefile to provide cross-platform support for Mac's native form of libraries, frameworks, in addition to the existing Windows libraries, so that we can keep the code as simple as possible.</p>\n\n<p>I am aware of <code>#ifdef __APPLE_CC__</code> being used to wrap Mac-specific code, but to wrap every instance of <code>&lt;SDL2/SDL.h&gt;</code> and <code>&lt;SDL.h&gt;</code> separately seems excessive.</p>\n\n<h3>Includes needed for libs in Windows:</h3>\n\n<pre><code>#include &lt;SDL.h&gt;\n#include &lt;SDL_image.h&gt;\n</code></pre>\n\n<h3>Includes needed for frameworks in Mac:</h3>\n\n<pre><code>#include &lt;SDL2/SDL.h&gt;\n#include &lt;SDL2_Image/SDL_image.h&gt;\n</code></pre>\n\n<h3>Makefile (Incomplete)</h3>\n\n<pre><code># Windows part\n\nifeq ($(OS), Windows_NT)\n    DETECTED_OS = $(OS)\n    CC = g++ -std=c++11\n    CFLAGS = -c -IC:/mingwdev/include/SDL2\n    INCLUDE = -IC:/mingwdev/include/SDL2\n    LFLAGS = -LC:/mingwdev/lib -lmingw32 -lSDL2main -lSDL2 -lSDL2_image -o $(OUT)\n    LFLAGScr = -LC:/mingwdev/lib -lmingw32 -lSDL2main -lSDL2 -lSDL2_image\n\n# Mac part\n\nelse ifeq ($(shell uname -s), Darwin)\n    DETECTED_OS := $(shell uname -s)\n    CC = g++ -std=c++11\n    CFLAGS = -c -F/Library/Frameworks        # THIS IS WHAT I WANT TO MODIFY #\n    INCLUDE = -F/Library/Frameworks          # THIS IS WHAT I WANT TO MODIFY #\n    LFLAGS = -framework SDL2 -framework SDL2_image -framework SDL2_ttf -o $(OUT) \n    LFLAGScr = -framework SDL2 -framework SDL2_image -framework SDL2_ttf\n\n\n# Final Part\n\nall: $(OUT)  \n\n$(OUT): $(OBJ)\n    $(CC) $^ $(INCLUDE) $(LFLAGS) \n\nobj/%.o: src/%.cpp $(DEP)\n    $(CC) $&lt; $(CFLAGS) -o $@\n</code></pre>\n"}, {"tags": ["c++", "templates", "lambda"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1538609036, "post_id": 52636922, "comment_id": 92206959, "body": "The template want to get a function pointer <i>value</i> argument, but you are passing it a <i>type</i>."}, {"owner": {"reputation": 601, "user_id": 3633976, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iby7E.png?s=128&g=1", "display_name": "markhc", "link": "https://stackoverflow.com/users/3633976/markhc"}, "edited": false, "score": 2, "creation_date": 1538609120, "post_id": 52636922, "comment_id": 92206978, "body": "You cant use <code>decltype(intCompare)</code> because the template expects a value (and youre giving it a <i>type</i>). And using simply <code>intCompare</code> doesnt work because it&#39;s not a constant expression (another requirement for templates). I suggest you rethink your approach to this. This way will not work."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1538609939, "post_id": 52636922, "comment_id": 92207152, "body": "A function pointer template parameter must be <i>the address of a function with external linkage</i>. Any old function pointer value won&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 0, "last_activity_date": 1538610543, "creation_date": 1538610543, "answer_id": 52637097, "question_id": 52636922, "link": "https://stackoverflow.com/questions/52636922/function-pointer-as-template-argument/52637097#52637097", "title": "function pointer as template argument", "body": "<p>You've got way too many tricks in your code.  You just need:</p>\n\n<pre><code>int intCompare(int a, int b)\n{\n    if (a &lt; b)\n        return -1;\n    if (a == b)\n        return 0;\n    return 1;\n};\n</code></pre>\n\n<p>And then, as others have said:</p>\n\n<pre><code>ConcurrentSortedList&lt;int, intCompare&gt; c;\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/7U2eBdH9yQ2msSJh\" rel=\"nofollow noreferrer\">Live demo</a></p>\n\n<p><code>auto intCompare = [](int a, int b) -&gt; int { ...</code> also works, FWIW.</p>\n"}], "owner": {"reputation": 74, "user_id": 2828618, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0e444c52d16b24bf42bcd49ec8d377ba?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Zeng", "link": "https://stackoverflow.com/users/2828618/alan-zeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 52637097, "answer_count": 1, "score": 0, "last_activity_date": 1538610543, "creation_date": 1538608823, "question_id": 52636922, "link": "https://stackoverflow.com/questions/52636922/function-pointer-as-template-argument", "title": "function pointer as template argument", "body": "<p>I have the following class template in \"concurrent_sorted_list.h\":</p>\n\n<pre><code>template &lt;typename T, int (* Compare)(T,T)&gt;\nclass ConcurrentSortedList{\n ....\n}\n</code></pre>\n\n<p>in my main.cpp:</p>\n\n<pre><code>int (*intCompare)(int, int) = [](int a, int b) -&gt; int {\n  if (a &lt; b)\n    return -1;\n  else if (a == b)\n  return 0;\n  return 1;\n};\n\nConcurrentSortedList&lt;int, decltype(intCompare)&gt; c;\nc.Add(5);\nc.Add(6);\nassert(c.Size() == 2);\n</code></pre>\n\n<p>But I get the following compiler error:\n<code>expected a constant of type \u2018int (*)(T, T)\u2019, got \u2018int (*)(int, int)\u2019</code></p>\n\n<p>if I change <code>decltype(intCompare)</code> to <code>intCompare</code>, then I get the following compiler error:\n<code>the value of \u2018intCompare\u2019 is not usable in a constant expression, \u2018intCompare\u2019 was not declared \u2018constexpr\u2019,  \u2018intCompare\u2019 is not a valid template argument for type \u2018int (*)(int, int)\u2019, it must be the address of a function with external linkage</code></p>\n"}, {"tags": ["c++", "x86", "prefetch"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538609807, "post_id": 52636891, "comment_id": 92207117, "body": "I think gcc is unrolling enough to avoid redundantly prefetching the same cache line multiple times.  Neat.  HW prefetch into L2 at least does work for descending order, but maybe not into L1d.  And BTW, there are ways to SIMD-vectorize this prefix-sum, but the compiler isn&#39;t auto-vectorizing it for you.  <a href=\"https://stackoverflow.com/q/19494114\">parallel prefix (cumulative) sum with SSE</a>.  Reversing the direction of memory access doesn&#39;t change the fundamental problem."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1538609938, "post_id": 52636891, "comment_id": 92207151, "body": "Anyway, no, you&#39;re not prefetching effectively.  The prefetch distance should be quite a few cache lines ahead of where you&#39;re currently accessing.  But the optimal prefetch distance depends on the hardware and maybe even hyperthreading for cache pressure from the other thread."}, {"owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538613177, "post_id": 52636891, "comment_id": 92207735, "body": "@PeterCordes Thanks! I am trying to learn cache blocking as you suggested at <a href=\"https://stackoverflow.com/questions/51933660/xeon-cpu-e5-2603-backward-memory-prefetch\" title=\"xeon cpu e5 2603 backward memory prefetch\">stackoverflow.com/questions/51933660/&hellip;</a>"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538646349, "post_id": 52636891, "comment_id": 92219575, "body": "@PeterCordes <code>UOPS_ISSUED.STALL_CYCLES</code> seems to be very high for this code. I&#39;m not sure why. <code>RESOURCE_STALLS.RS</code> is also a little high due to port contention. The prefetching instruction actually harms performance irrespective of the distance."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1538649545, "post_id": 52636891, "comment_id": 92221372, "body": "@HadiBrais: It bottleneck on the loop-carried <code>addss</code> dep chain, not on front-end throughput, so it&#39;s nor surprising there are huge amounts of stall cycles with no uops issued.  The only ILP is the loop overhead and the stores."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1538672838, "post_id": 52636891, "comment_id": 92235857, "body": "@PeterCordes Yes, but then I&#39;d expect it to run in the worst case at about 32 cycles per iteration, but it&#39;s actually 5 times worse than that on Haswell/Broadwell. And it&#39;s not because of <code>RESOURCE_STALLS.RS</code> alone. IACA even says it should run at 18.4 cycles per iteration. Since most loads actually hit in the L1D, I&#39;d expect IACA to be close, but it&#39;s far off."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1538673109, "post_id": 52636891, "comment_id": 92236011, "body": "@HadiBrais: hmm, aligned_alloc doesn&#39;t zero memory, but in practice an allocation that large should be fresh zeroed pages from the OS.  So we shouldn&#39;t be getting FP assists for subnormals."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1538673565, "post_id": 52636891, "comment_id": 92236226, "body": "@HadiBrais: I tried it with the OP&#39;s code unmodified.  It only takes 63ms, kinda too short for a good benchmark, and it probably spends significant time on page faults.  <code>cycles:u</code> was 120M, <code>cycles</code> was 236M.  page faults was ~24.5k.  IPC=0.69, UOPS_ISSUED.STALL_CYCLES was 174M while UOPS_ISSUED.STALL_CYCLES:u was ~103M.  (With of ~210M <code>uops_issued.any</code>.)  This is on Skylake (4 cycle <code>vaddsd</code> latency), without any care taken to warm up the CPU frequency or whatever, just a quick test.  I compiled with <code>g++ -O3 -march=skylake</code>.  Transparent hugepage defrag = <code>[defer+madvise]</code>"}, {"owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "edited": false, "score": 0, "creation_date": 1538674050, "post_id": 52636891, "comment_id": 92236435, "body": "How do you guys get these numbers? I mean the <code>UOPS_ISSUED.STALL_CYCLES</code> etc. I am thinking about storing two copies of input data. One in forward and another in reversed arrangement. Then this becomes just backward writes instead of backward read/write. Would it help if I do a lot more calculations in the loop?"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538678602, "post_id": 52636891, "comment_id": 92238014, "body": "@PeterCordes On Haswell, cycles:u=105M, UOPS_ISSUED.STALL_CYCLES:u=218M (which doesn&#39;t seem to be counting cycles as it claims to be), RESOURCE_STALLS.RS:u=61M, and IPC=0.52. This means it&#39;s executing at 67.2 cycles per iteration or about 1.86 cycles per instruction in the loop. Although the L1D hit rate is &gt;99%. It appears there is something more than just port contention. I&#39;m surprised that IACA got this so wrong."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1538678655, "post_id": 52636891, "comment_id": 92238021, "body": "@Rzu We use a tool called <code>perf</code> which uses hardware performance counters. Doing more calculations in the loop may help if these calculations use underutilized ports."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538679070, "post_id": 52636891, "comment_id": 92238173, "body": "@PeterCordes The numbers I gave in my previous comment are for the case without the prefetch instruction in the loop. If I add the instruction, then cycles:u=115M, UOPS_ISSUED.STALL_CYCLES:u=229M, RESOURCE_STALLS.RS:u=71M, and IPC=0.5."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1538679126, "post_id": 52636891, "comment_id": 92238192, "body": "@Rzu The mere existence of the prefetch instruction makes your code slower."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538679649, "post_id": 52636891, "comment_id": 92238339, "body": "@Rzu: You almost certainly don&#39;t want 2 copies of the same data using up cache footprint / memory bandwidth."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1538679989, "post_id": 52636891, "comment_id": 92238507, "body": "The L1 IP-based prefetcher can prefetch backwards and it only tracks load instructions. I think since all the loads in the same iteration access a single cache line, the IP-prefetcher tracks only one of them and detects that the stride is one (next line) so tries to prefetch the next few lines. The L2 can prefetch lines in the E coherence state, so the L1 receives them in the appropriate state for the stores as well. So there is really no need to software prefetching."}, {"owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538681488, "post_id": 52636891, "comment_id": 92239197, "body": "@PeterCordes It will be fine in my case. The computer has lots of memory. The program does not change the input data, which is all loaded into memory. I store a forward ordered input for one long forward loop with lots of calculation. I also store a backward ordered data for one long backward loop with lots of calculation. The whole program perform these two loops for many times."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538681695, "post_id": 52636891, "comment_id": 92239277, "body": "The memory footprint itself is unimportant, the important part is the <i>cache</i> footprint.  You want to work on small enough chunks that you get L2 cache hits, or maybe only L3 if you can&#39;t easily work in 128kiB to 256k chunks.  (L2 is 1MiB in Skylake-X, though, so blocking for L2 is easier but also more important there).  You said you were trying to learn about cache blocking."}, {"owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "edited": false, "score": 0, "creation_date": 1538682931, "post_id": 52636891, "comment_id": 92239841, "body": "Thank you again. The loop does not read the input forward and read the input backward at the same time... A loop read forward and next loop read backward. So I guess that will be fine. I worry that the memory won&#39;t get mapped to the cache when I read or write backward. If I can, I want to map a block of memory into the cache. Then write to the mapped memory in a reversed direction. Then fetch the next block (in a backward direction). And repeat. I doubt if the cpu can predict that I want to get the next block when I am done with this block because i deal with the blocks in a reversed order."}, {"owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "edited": false, "score": 0, "creation_date": 1538683363, "post_id": 52636891, "comment_id": 92240051, "body": "I will ask about backward pre-fetching, stride, and multi-threading in another question. Shouldn&#39;t be here."}], "owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1538608605, "creation_date": 1538608605, "question_id": 52636891, "link": "https://stackoverflow.com/questions/52636891/software-prefetch-and-backward-looping", "title": "Software Prefetch and Backward Looping", "body": "<p>Did I used the pre-fetch instruction correctly to reduce memory latency?</p>\n\n<p>Can I do better than this?</p>\n\n<p>When I compile the code with -O3, g++ seems to unroll the inner loop (<a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdlib.h%3E%0A%23include+%3Ciostream%3E%0Aint+main()+%7B%0A++++const+int+N+%3D+25000000%3B%0A++++float*+x+%3D+reinterpret_cast%3Cfloat*%3E(%0A++++++++++++aligned_alloc(16,+4*N)%0A++++)%3B++//+0.1+GB%0A%0A++++x%5BN+-+1%5D+%3D+1.0f%3B%0A%0A++++__builtin_prefetch(%26x%5BN+-+16%5D,+0,+3)%3B%0A++++//+Backward+loop+over+the+i%5Eth+cache+line.%0A++++for+(int+i+%3D+N+-+16%3B+i+%3E%3D+0%3B+i+-%3D+16)+%7B%0A++++++++for+(int+j+%3D+15%3B+j+%3E%3D+1%3B+--j)+%7B%0A++++++++++++x%5Bi+%2B+j+-+1%5D+%2B%3D+x%5Bi+%2B+j%5D%3B%0A++++++++%7D%0A++++++++__builtin_prefetch(%26x%5Bi+-+16%5D,+0,+3)%3B%0A++++++++x%5Bi+-+1%5D+%3D+x%5Bi%5D%3B%0A++++%7D%0A%0A++++std::cout+%3C%3C+x%5B0%5D+%3C%3C+%22%5Cn%22%3B%0A++++free(x)%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g82,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.2+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">code at godbolt.org</a>).</p>\n\n<p>The architecture of the CPU is Broadwell.</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p>Backward loop over an array and read/write elements.</p>\n\n<p>Each calculation depends on the previous calculation.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;iostream&gt;\nint main() {\n    const int N = 25000000;\n    float* x = reinterpret_cast&lt;float*&gt;(\n            aligned_alloc(16, 4*N)\n    );  // 0.1 GB\n\n    x[N - 1] = 1.0f;\n\n    // fetch last cache line of the array\n    __builtin_prefetch(&amp;x[N - 16], 0, 3);\n\n    // Backward loop over the i^th cache line.\n    for (int i = N - 16; i &gt;= 0; i -= 16) {\n        for (int j = 15; j &gt;= 1; --j) {\n            x[i + j - 1] += x[i + j];\n        }\n        __builtin_prefetch(&amp;x[i - 16], 0, 3);\n        x[i - 1] = x[i];\n    }\n\n    std::cout &lt;&lt; x[0] &lt;&lt; \"\\n\";\n    free(x);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "loops", "bitset"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1538609185, "post_id": 52636890, "comment_id": 92206995, "body": "<code>std::vector&lt;uint64_t&gt; bitset;</code> not in C you aren&#39;t. Be cautious and make sure each language is relevant when  you tag extra languages. If you truly don&#39;t care what language is used, tag as  <code>language-agnostic</code>."}, {"owner": {"reputation": 31, "user_id": 10453729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134977f46b46b3222441762a4eb66e6?s=128&d=identicon&r=PG&f=1", "display_name": "CodeForFood", "link": "https://stackoverflow.com/users/10453729/codeforfood"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538609408, "post_id": 52636890, "comment_id": 92207038, "body": "Thanks @user4581301 for your comment. You can replace <code>std::vector&lt;uint64_t&gt; bitset</code> with <code>uint64_t *bitset</code> and it will work in C."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1538703787, "post_id": 52636890, "comment_id": 92245171, "body": "Converting an N-bit signal to M bits where N != M with minimal introduction of noise is actually a huge topic. One big category of research dealing with this problem is Delta-Sigma (also called Sigma-Delta) modulation.  <a href=\"https://en.wikipedia.org/wiki/Delta-sigma_modulation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Delta-sigma_modulation</a>"}, {"owner": {"reputation": 31, "user_id": 10453729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134977f46b46b3222441762a4eb66e6?s=128&d=identicon&r=PG&f=1", "display_name": "CodeForFood", "link": "https://stackoverflow.com/users/10453729/codeforfood"}, "reply_to_user": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1538713805, "post_id": 52636890, "comment_id": 92247166, "body": "This is awesome, thanks @gene for putting a name to this problem! I will be googling this some more now :)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10453729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134977f46b46b3222441762a4eb66e6?s=128&d=identicon&r=PG&f=1", "display_name": "CodeForFood", "link": "https://stackoverflow.com/users/10453729/codeforfood"}, "edited": false, "score": 0, "creation_date": 1538713383, "post_id": 52657025, "comment_id": 92247075, "body": "Thanks @Phil1970 for your comment. The resolution can be anything, 1/2 or even 2/4 and my bit sequences can range anywhere from 1^9 to 1^15.  I wish the resolution was power of 2, it would make things a bit easier :)"}], "tags": [], "owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "is_accepted": false, "score": 0, "last_activity_date": 1538701859, "creation_date": 1538701859, "answer_id": 52657025, "question_id": 52636890, "link": "https://stackoverflow.com/questions/52636890/c-c-bit-array-resolution-transform-algorithms/52657025#52657025", "title": "C/C++ bit array resolution transform algorithms", "body": "<p>Does the resolution always between 1/2 and 1/64? Or even 1/32? Because if you need very long sequence, you might need more loop nesting which might cause some slow down.</p>\n\n<p>Are you sequence always very long (millions of bits) or this is a maximum but usually your sequences are shorter? When doing high to low resolution, can you assume that data is valid or not.</p>\n\n<p>Here are some tricks:</p>\n\n<pre><code>uint64_t one = 1;\nuint64_t n_one_bits = (one &lt;&lt; n) - 1u; // valid for 0 to 63; not sure for 64\n</code></pre>\n\n<p>If your sequence are so long, you might want to check if <code>n</code> is some power of 2 and have more optimized code for those cases.</p>\n\n<p>You might find some other useful tricks here:</p>\n\n<p><a href=\"https://graphics.stanford.edu/~seander/bithacks.html\" rel=\"nofollow noreferrer\">https://graphics.stanford.edu/~seander/bithacks.html</a></p>\n\n<p>So if your resolution is 1/16, you don't need to loop individual 16 bits but you can check all 16 bits at once. Then you can repeat for next group again and again.</p>\n\n<p>If the number is not an a divider of 64, you can shift bits as appropriate each time you would cross the 64 bits boundary. Say, that your resolution is 1/5, then you could process 60 bits, then shift 4 remaining bit and combine with following 60 bits.</p>\n\n<p>If you can assume that data is valid, then you don't even need to shift the original number as you can pick the value of the appropriate bit each time.</p>\n"}], "owner": {"reputation": 31, "user_id": 10453729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134977f46b46b3222441762a4eb66e6?s=128&d=identicon&r=PG&f=1", "display_name": "CodeForFood", "link": "https://stackoverflow.com/users/10453729/codeforfood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538701859, "creation_date": 1538608600, "last_edit_date": 1538685814, "question_id": 52636890, "link": "https://stackoverflow.com/questions/52636890/c-c-bit-array-resolution-transform-algorithms", "title": "C/C++ bit array resolution transform algorithms", "body": "<p>Anyone aware of any algorithms to up/down convert bit arrays? </p>\n\n<p>ie: when the resolution is 1/16:</p>\n\n<p>every 1 bit = 16 bits. (low resolution to high resolution)</p>\n\n<pre><code>1010 -&gt; 1111111111111111000000000000000011111111111111110000000000000000\n</code></pre>\n\n<p>and reverse, 16 bits = 1 bit (high resolution to low resolution)</p>\n\n<pre><code>1111111111111111000000000000000011111111111111110000000000000000 -&gt; 1010\n</code></pre>\n\n<p>Right now I am looping bit by bit which is not efficient. Using a whole 64-bit word would be better but run into issues when the word isn't divisible by resolution equally (some bits may spill over to the next word). </p>\n\n<p>C++:</p>\n\n<pre><code>std::vector&lt;uint64_t&gt; bitset; \n</code></pre>\n\n<p>C:</p>\n\n<pre><code>uint64_t *bitset = calloc(total_bits &gt;&gt; 6, sizeof(uint64_t)); // free() when done\n</code></pre>\n\n<p>which is accessed using:</p>\n\n<pre><code>const uint64_t idx = bit &gt;&gt; 6;\nconst uint64_t pos = bit % 64;\n\nconst bool value = (bitset[idx] &gt;&gt; pos) &amp; 1U;\n</code></pre>\n\n<p>and set/clear:</p>\n\n<pre><code>bitset[idx] |= (1UL &lt;&lt; pos);\nbitset[idx] &amp;= ~(1UL &lt;&lt; pos);\n</code></pre>\n\n<p>and the OR (or AND/XOR/AND/NOT) of two bitsets of same resolution are done using the full 64-bit word:</p>\n\n<pre><code>bitset[idx] |= source.bitset[idx];\n</code></pre>\n\n<p>I am dealing with large enough bitsets (2+ billion bits) that I'm looking for any efficiency in the loops. One way I found to optimize the loop is to check each word using <code>__builtin_popcountll</code>, and skip ahead in the loop: </p>\n\n<pre><code>for (uint64_t bit = 0; bit &lt; total_bits; bit++)\n{ \n   const uint64_t idx = bit &gt;&gt; 6;\n   const uint64_t pos = bit % 64;\n\n   const uint64_t bits = __builtin_popcountll(bitset[idx]);\n\n   if (!bits)\n   {\n      i += 63;\n      continue;\n   }\n   // process\n}\n</code></pre>\n\n<p><strong>I'm looking for algorithms/techniques more than code examples. But if you have code to share, I won't say no. Any academic research papers would be appreciated too.</strong></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "setter"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1538607441, "post_id": 52636758, "comment_id": 92206562, "body": "<code>I&#39;ve heard it&#39;s faster</code> that is likely true for classes but not necessarily for <code>int</code>. Related: <a href=\"https://stackoverflow.com/questions/3009543/passing-integers-as-constant-references-versus-copying\" title=\"passing integers as constant references versus copying\">stackoverflow.com/questions/3009543/&hellip;</a>"}, {"owner": {"reputation": 601, "user_id": 3633976, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iby7E.png?s=128&g=1", "display_name": "markhc", "link": "https://stackoverflow.com/users/3633976/markhc"}, "edited": false, "score": 0, "creation_date": 1538608597, "post_id": 52636758, "comment_id": 92206835, "body": "Quick answer is: It depends. For simple/easy to copy types it doesn&#39;t matter. For complex types where copying is expensive then using references might avoid an extra copy (but on that case you should probably also add an r-value overload)"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 601, "user_id": 3633976, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iby7E.png?s=128&g=1", "display_name": "markhc", "link": "https://stackoverflow.com/users/3633976/markhc"}, "edited": false, "score": 1, "creation_date": 1538608991, "post_id": 52636758, "comment_id": 92206944, "body": "@markhc: In most such cases, I&#39;d actually recommend accepting the arguments by value, then assigning with <code>std::move</code>. If the arguments are rvalues, they&#39;re either constructed directly into the argument space or moved to it, if they&#39;re lvalues, they&#39;re copied before the call. Either way, if the move assignment overload is <code>noexcept</code> (most should be), this means your setter can be <code>noexcept</code> too, because all exception triggering code is performed as part of calling it, not within the function itself. Avoids needing separate overloads, and if moving is cheap, costs little, performance-wise."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1538609304, "post_id": 52636758, "comment_id": 92207016, "body": "More info <a href=\"https://web.archive.org/web/20140113221447/http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/\" rel=\"nofollow noreferrer\">Want Speed? Pass by Value.</a>"}, {"owner": {"reputation": 601, "user_id": 3633976, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iby7E.png?s=128&g=1", "display_name": "markhc", "link": "https://stackoverflow.com/users/3633976/markhc"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1538609445, "post_id": 52636758, "comment_id": 92207051, "body": "@ShadowRanger I agree with you up until the <code>noexcept</code> thing. Doing <code>void setName(std::string name) noexcept</code> while technically valid is kind of... bad (for lack of a better word). While the <code>setName</code> function will not throw, the call might throw and cause confusion for the user when doing something simple such as <code>foo.setName(&quot;John&quot;)</code>. Then we have more questions like &quot;Look i am only calling this single noexcept function and my code is throwing, wtf C++??&quot;"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 601, "user_id": 3633976, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iby7E.png?s=128&g=1", "display_name": "markhc", "link": "https://stackoverflow.com/users/3633976/markhc"}, "edited": false, "score": 0, "creation_date": 1538614148, "post_id": 52636758, "comment_id": 92207925, "body": "@markhc: That&#39;s part of learning C++. Giving the <code>noexcept</code> guarantee allows additional compiler optimizations, and nothing in the code raises an exception, so it&#39;s correct, so omitting it is a needless pessimization. The fact that it&#39;s <code>noexcept</code> actually helps narrow the cause; raising exceptions in <code>noexcept</code> functions triggers specific behaviors (in C++17, it&#39;s an immediate <code>std::terminate</code>), so if an exception actually gets raised, you know it wasn&#39;t caused inside the function."}], "answers": [{"tags": [], "owner": {"reputation": 6434, "user_id": 602340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c813559e4994a45eb8eedca722399fa0?s=128&d=identicon&r=PG", "display_name": "matiu", "link": "https://stackoverflow.com/users/602340/matiu"}, "is_accepted": false, "score": 0, "last_activity_date": 1538611439, "creation_date": 1538611439, "answer_id": 52637185, "question_id": 52636758, "link": "https://stackoverflow.com/questions/52636758/should-the-parameters-of-most-all-setter-functions-in-c-be-written-as-const-re/52637185#52637185", "title": "Should the parameters of most/all setter functions in C++ be written as const references?", "body": "<p>It depends on the parameter type.</p>\n\n<p>If the size of the value is <code>&lt;= sizeof(void*)</code>, like an <code>int</code> or <code>float</code> (and  generally <code>double</code>), it's best to pass it by value, that way it'll likely get put in a register, rather than being looked up in memory.</p>\n\n<p>If it's a large object (like an array or a string), if you plan to copy data out of it, it's best as a <code>const &amp;</code> (const reference). If you will move or consume the input, it's best to receive it as a <code>&amp;&amp;</code> (rvalue reference).</p>\n"}, {"tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": false, "score": 0, "last_activity_date": 1538612920, "last_edit_date": 1538612920, "creation_date": 1538612103, "answer_id": 52637257, "question_id": 52636758, "link": "https://stackoverflow.com/questions/52636758/should-the-parameters-of-most-all-setter-functions-in-c-be-written-as-const-re/52637257#52637257", "title": "Should the parameters of most/all setter functions in C++ be written as const references?", "body": "<p>The two approaches are not equivalent in the case that the copy/move operators of the associated types are non-trivial.</p>\n\n<p>Assuming you don't care about that distinction, (i.e., the effect of the entire function call including any copies/moves is the same in either case), then in general it depends on the mechanical details of the ABI:</p>\n\n<ul>\n<li>Small types can be passed efficiently, usually in a single register. In this case there is no overhead passing by value since the copy is implicit in the ABI.</li>\n<li>Larger types that cannot be passed in registers must be passed by pointer even when \"passed by value\", which means that you incur a copy in the pass-by-value case.</li>\n<li>However, if the function is inlined, this copy may disappear since the compiler can see that that the copy is never accessed.</li>\n<li>Passing by value ensures that the arguments can not <em>alias</em>, which may help optimize the function more efficiently, and this effect can sometimes be very large (extensions such as <code>__restrict</code> can be used to get the same effect for references).</li>\n<li>Inlining can again \"negate\" the advantage above.</li>\n</ul>\n\n<p>So unfortunately there is no simple answer.</p>\n\n<p>Considering only performance, reasonable heuristic might be:</p>\n\n<p>For types that would be passed in registers on your important platforms, prefer pass-by-value. If you don't know which types will be passed by value, then you could assume that only primitive types are passed by value (but this is usually a pessimistic assumption).</p>\n\n<p>For larger types, where a copy is made (as in your example), for C++11 and later may <em>still</em> prefer pass-by-value, since you can <code>std::move</code> the argument in the assignment, which for move-capable types will usually be similarly efficient when the function is called with an rvalue. For non-movable types or when the argument isn't an rvalue, both approaches are similarly efficient.</p>\n\n<p>For larger types, where a copy is not made, I recommend passing by <code>const</code> reference, except perhaps in rare cases where you can't avoid aliasing problems, in which case a copy is called for.</p>\n"}], "owner": {"reputation": 117, "user_id": 3153229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3de1bcb54b2f243444b602a2bb6c5f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta", "link": "https://stackoverflow.com/users/3153229/vegeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538612920, "creation_date": 1538607294, "last_edit_date": 1538608168, "question_id": 52636758, "link": "https://stackoverflow.com/questions/52636758/should-the-parameters-of-most-all-setter-functions-in-c-be-written-as-const-re", "title": "Should the parameters of most/all setter functions in C++ be written as const references?", "body": "<p>Such as </p>\n\n<pre><code>    void SetNumbers(const double&amp; a, const double&amp; b)\n      {\n        m_a = a;\n        m_b = b\n      }\n</code></pre>\n\n<p>instead of just</p>\n\n<pre><code>void SetNumbers(double a, double b) \n  {\n        m_a = a;\n        m_b = b\n  }\n</code></pre>\n\n<p>I've heard it's faster and safer and maybe there's other advantages</p>\n"}, {"tags": ["c++", "if-statement"], "comments": [{"owner": {"reputation": 12572, "user_id": 8534008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2af9937cac66f08b6ee6e4219cc0d?s=128&d=identicon&r=PG&f=1", "display_name": "GBlodgett", "link": "https://stackoverflow.com/users/8534008/gblodgett"}, "edited": false, "score": 0, "creation_date": 1538607366, "post_id": 52636739, "comment_id": 92206548, "body": "What do you mean by &quot;All the if statements are printed&quot;. Could you please give expected output vs current output?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1538607449, "post_id": 52636739, "comment_id": 92206567, "body": "And when you used your debugger to run the program one line at a time, and examine the values of all variables after each statement gets executed, what observations did you make? Do you know how to use your debugger? Have you been told, or are you aware that knowing how to use a debugger is a required skill for every C++ developer? And if you did that already, you would&#39;ve figured out exactly why &quot;all if-else statements printing&quot;, because that&#39;s what you told your computer to do. Every <code>if-else</code> statement in the shown code prints something."}, {"owner": {"reputation": 2429, "user_id": 8946627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5N2d.jpg?s=128&g=1", "display_name": "JBoothUA", "link": "https://stackoverflow.com/users/8946627/jboothua"}, "edited": false, "score": 0, "creation_date": 1538607641, "post_id": 52636739, "comment_id": 92206618, "body": "your logic seems correct, it should only go into one of those if statements based on your input character.  are you sure it&#39;s not hitting one IF and then the other 2 ELSES??"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1538607689, "post_id": 52636739, "comment_id": 92206627, "body": "The else part of the other two statements are getting executed because the condition is false. You need to check the character and the measurements separately."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1538607696, "post_id": 52636739, "comment_id": 92206629, "body": "You can <a href=\"https://stackoverflow.com/posts/52636739/edit\">edit</a> your post to clarify it, as requested in the comments. This will make it possible to answer."}, {"owner": {"reputation": 2226, "user_id": 6214491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/q9IUg.png?s=128&g=1", "display_name": "0xCursor", "link": "https://stackoverflow.com/users/6214491/0xcursor"}, "edited": false, "score": 0, "creation_date": 1538607753, "post_id": 52636739, "comment_id": 92206645, "body": "When you type in <code>R</code>, are the other two <code>if</code> statements printing their <code>else</code> statements, or the true part statements? Cause if the <code>else</code> statements are ran, then that\u2019s normal."}], "answers": [{"tags": [], "owner": {"reputation": 601, "user_id": 3633976, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iby7E.png?s=128&g=1", "display_name": "markhc", "link": "https://stackoverflow.com/users/3633976/markhc"}, "is_accepted": false, "score": 3, "last_activity_date": 1538608312, "last_edit_date": 1538608312, "creation_date": 1538607794, "answer_id": 52636804, "question_id": 52636739, "link": "https://stackoverflow.com/questions/52636739/why-are-all-if-else-statements-printing-no-matter-the-input/52636804#52636804", "title": "Why are all if-else statements printing no matter the input?", "body": "<blockquote>\n  <p>All the if statements are printed</p>\n</blockquote>\n\n<p>That is not what is happening. Only one of the <code>if</code> statements are printed, but the other 2 <code>else</code> statements (from the other 2 <code>if</code>s) are also printed because the <code>if</code> will fail.</p>\n\n<p>I commented your code a bit.</p>\n\n<pre><code>if (frg == 'R' &amp;&amp; precip &lt; 0.835 &amp;&amp; tmp &gt; 38) {\n    // ... your code\n} else {\n    // Execution will reach this block when frg != R || precip &gt; 0.835 || tmp &lt; 38\n    // So if you typed F or G, this else will be executed\n}\n\nif (frg == 'F' &amp;&amp; precip &lt; 0.525 &amp;&amp; tmp &gt; 38) {\n    // ... your code\n} else {\n    // Execution will reach this block when frg != F || precip &gt; 0.525 || tmp &gt; 38\n    // So if you typed R or G, this else will be executed\n}\n\nif (frg == 'G' &amp;&amp; precip &lt; 0.325 &amp;&amp; tmp &gt; 38) {\n    // ... your code\n} else {\n    // Execution will reach this block when frg != G || precip &gt; 0.325 || tmp &lt; 38\n    // So if you typed R or F, this else will be executed\n}\n</code></pre>\n\n<p>As to what you should do to 'fix' this, i can't really suggest anything because I don't know what the desired behavior is.</p>\n\n<p>Hope this clears things up, </p>\n\n<p>Cheers.</p>\n"}, {"tags": [], "owner": {"reputation": 2429, "user_id": 8946627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5N2d.jpg?s=128&g=1", "display_name": "JBoothUA", "link": "https://stackoverflow.com/users/8946627/jboothua"}, "is_accepted": false, "score": 0, "last_activity_date": 1538607807, "creation_date": 1538607807, "answer_id": 52636805, "question_id": 52636739, "link": "https://stackoverflow.com/questions/52636739/why-are-all-if-else-statements-printing-no-matter-the-input/52636805#52636805", "title": "Why are all if-else statements printing no matter the input?", "body": "<p>your logic seems correct, it should only go into one of those if statements based on your input character. are you sure it's not hitting one IF and then the other 2 ELSES??</p>\n\n<p>you can add </p>\n\n<pre><code> return;\n</code></pre>\n\n<p>to the end of your the logic inside of your { } brackets, that would ensure that only one logic { } bracket would execute...</p>\n\n<p>or you would need a nested if/else statement to make sure only 1 { } bracket is executed.</p>\n\n<p>as you have it now you are running 1 if, and then 2 elses based on the character</p>\n"}], "owner": {"reputation": 31, "user_id": 10453791, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vYwpdFkN9T0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXn03VkTnkRkj_IwIKN_WJSaL86TQ/mo/photo.jpg?sz=128", "display_name": "eskay", "link": "https://stackoverflow.com/users/10453791/eskay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1538608312, "creation_date": 1538607199, "question_id": 52636739, "link": "https://stackoverflow.com/questions/52636739/why-are-all-if-else-statements-printing-no-matter-the-input", "title": "Why are all if-else statements printing no matter the input?", "body": "<p>When inputting any letter (F, R, or G) every if statement prints in the compiler.\nIm not sure as to why this is the case but some answers would be nice!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nusing namespace std;\n\nint main()\n{\nint tmp;\nfloat precip;\nchar frg;\n\ncout &lt;&lt; \"Fall 2018 Automated \\\"Bruin\\\" Golf Course Sprinkler System\" &lt;&lt; endl;\ncout &lt;&lt; endl &lt;&lt; \"What is the temperature in degrees(F)? \";\ncin &gt;&gt; tmp;\ncout &lt;&lt; \"How much precipitation today (in inches)? \";\ncin &gt;&gt; precip;\ncout &lt;&lt; \"The Golf Course grass divisions are F-Fairways, R-Rough, G-Greens.\";\ncout &lt;&lt; endl &lt;&lt; \"Which do you choose (FRG)? \";\ncin &gt;&gt; frg;\n\nif (frg == 'R' &amp;&amp; precip &lt; 0.835 &amp;&amp; tmp &gt; 38)\n    {\n        cout &lt;&lt; endl &lt;&lt; \"Given the temperature is \" &lt;&lt; tmp &lt;&lt; \" degrees and \" &lt;&lt; precip &lt;&lt; \" inches of precipitation today.\" &lt;&lt; endl;\n        cout &lt;&lt; \"The Rough on the Golf Course will be watered.\";\n    } else\n        {\n            cout &lt;&lt; endl &lt;&lt; \"Given the temperature is \" &lt;&lt; tmp &lt;&lt; \" degrees and \" &lt;&lt; precip &lt;&lt; \" inches of precipitation today.\" &lt;&lt; endl;\n            cout &lt;&lt; \"The Rough on the Golf Course will NOT be watered.\";\n        }\n\nif (frg == 'F' &amp;&amp; precip &lt; 0.525 &amp;&amp; tmp &gt; 38)\n    {\n        cout &lt;&lt; endl &lt;&lt; \"Given the temperature is \" &lt;&lt; tmp &lt;&lt; \" degrees and \" &lt;&lt; precip &lt;&lt; \" inches of precipitation today.\" &lt;&lt; endl;\n        cout &lt;&lt; \"The Fairways on the Golf Course will be watered.\";\n    } else\n        {\n            cout &lt;&lt; endl &lt;&lt; \"Given the temperature is \" &lt;&lt; tmp &lt;&lt; \" degrees and \" &lt;&lt; precip &lt;&lt; \" inches of precipitation today.\" &lt;&lt; endl;\n            cout &lt;&lt; \"The Fairways on the Golf Course will NOT be watered.\";\n        }\n\nif (frg == 'G' &amp;&amp; precip &lt; 0.325 &amp;&amp; tmp &gt; 38)\n    {\n        cout &lt;&lt; endl &lt;&lt; \"Given the temperature is \" &lt;&lt; tmp &lt;&lt; \" degrees and \" &lt;&lt; precip &lt;&lt; \" inches of precipitation today.\" &lt;&lt; endl;\n        cout &lt;&lt; \"The Greens on the Golf Course will be watered.\";\n    } else\n        {\n            cout &lt;&lt; endl &lt;&lt; \"Given the temperature is \" &lt;&lt; tmp &lt;&lt; \" degrees and \" &lt;&lt; precip &lt;&lt; \" inches of precipitation today.\" &lt;&lt; endl;\n            cout &lt;&lt; \"The Greens on the Golf Course will NOT be watered.\";\n        }\nreturn 0;\n}\n</code></pre>\n\n<p>Even when i input R when asked for the frg variable, all the if statements are printed in the compiler. Please help! </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "macros", "c-preprocessor", "variadic-macros"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1538605794, "post_id": 52636515, "comment_id": 92206184, "body": "Preprocessor-macros is C++ stuff, like everything else inherited and / or adopted from C."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1538605937, "post_id": 52636515, "comment_id": 92206228, "body": "@Deduplicator burry the hatchet."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1538606053, "post_id": 52636515, "comment_id": 92206257, "body": "Macro arguments are arbitrary strings, which needn&#39;t be parsable. So speaking of the type of the argument makes little sense."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1538606099, "post_id": 52636515, "comment_id": 92206269, "body": "@YvesDaoust I know, but I was hoping for some evil sourcery..."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1538607225, "post_id": 52636515, "comment_id": 92206513, "body": "Does the <a href=\"https://stackoverflow.com/q/24793706/1708801\">comma really work in your case?</a>"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1538608249, "post_id": 52636515, "comment_id": 92206759, "body": "@ShafikYaghmour: It&#39;s a list of two arguments, but that can work with <code>__VA_ARGS__</code>"}], "answers": [{"comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1538607330, "post_id": 52636585, "comment_id": 92206534, "body": "Note using <a href=\"https://stackoverflow.com/q/28746744/1708801\">the fact that lambda w/o capture can be converted to function pointer</a>"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1538608094, "post_id": 52636585, "comment_id": 92206721, "body": "Yes, and also the trick that applying unary <code>+</code> to such a lambda forces the conversion, since there is no overloaded <code>operator+</code> matching the lambda type, but the pointer to function is a valid operand of the built-in meaning of unary <code>+</code>."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 5, "last_activity_date": 1538606072, "creation_date": 1538606072, "answer_id": 52636585, "question_id": 52636515, "link": "https://stackoverflow.com/questions/52636515/find-out-the-type-of-va-args-in-a-variadic-macro/52636585#52636585", "title": "Find out the type of __VA_ARGS__ in a variadic macro", "body": "<p>You can use <code>__VA_ARGS__</code> as a lambda parameter, then convert that lambda to a function pointer and extract the parameter type:</p>\n\n<pre><code>template &lt;typename T&gt; struct func_param {};\ntemplate &lt;typename T&gt; struct func_param&lt;void(*)(T)&gt; {using type = T;};\n\n#define FOO(...) \\\n    do \\\n    { \\\n        auto lambda = +[]([[maybe_unused]] __VA_ARGS__) {}; \\\n        using type = func_param&lt;decltype(lambda)&gt;::type; \\\n        /* Do something with `type`. */\\\n    } \\\n    while (0);\n</code></pre>\n"}], "owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 1, "accepted_answer_id": 52636585, "answer_count": 1, "score": 3, "last_activity_date": 1538832864, "creation_date": 1538605445, "last_edit_date": 1538605833, "question_id": 52636515, "link": "https://stackoverflow.com/questions/52636515/find-out-the-type-of-va-args-in-a-variadic-macro", "title": "Find out the type of __VA_ARGS__ in a variadic macro", "body": "<p>Supposedly, I have a variadic macro (e.g., <code>MY_MACRO(...)</code>) and I call it the following way:</p>\n\n<pre><code>MY_MACRO(std::pair&lt;int, int&gt; const &amp;p)\n</code></pre>\n\n<p>Now, <code>__VA_ARGS__</code> in my macro's body would be <code>std::pair&lt;int, int&gt; const &amp;p</code>. </p>\n\n<p>Is there a way to figure out the type of <code>__VA_ARGS__</code>? </p>\n\n<p>Presumably, I would be grateful if something like <code>decltype(std::pair&lt;int, int&gt; const &amp;p)</code> worked and yield <code>std::pair&lt;int, int&gt; const&amp;</code>, so in my variadic macro's body <code>decltype(__VA_ARGS__)</code> would yield <code>std::pair&lt;int, int&gt; const&amp;</code> as well. Unfortunately this doesn't work.</p>\n"}, {"tags": ["c++", "templates", "c++17", "template-argument-deduction"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 3, "creation_date": 1538605010, "post_id": 52636415, "comment_id": 92205959, "body": "The most vexing parse strikes again!"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1538605061, "post_id": 52636415, "comment_id": 92205974, "body": "Once you fix the vexing parse bug, it still doesn&#39;t compile - does MSVC not support CTAD yet?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1538605188, "post_id": 52636415, "comment_id": 92206013, "body": "Following on from @rakete&#39;s observation, this compiles (under gcc): <code>Simple s ( upSimple );</code>, see: <a href=\"https://wandbox.org/permlink/V4bp2fsfk49cYMSd\" rel=\"nofollow noreferrer\">wandbox.org/permlink/V4bp2fsfk49cYMSd</a>"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1538605223, "post_id": 52636415, "comment_id": 92206024, "body": "@Barry The latest MSVC does. <a href=\"https://godbolt.org/z/Z1pXRo\" rel=\"nofollow noreferrer\">godbolt.org/z/Z1pXRo</a>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1538605274, "post_id": 52636415, "comment_id": 92206034, "body": "@Rakete1111 I never know which MSVC to pick from that list, lol. Noted :-)"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 2, "creation_date": 1538605358, "post_id": 52636415, "comment_id": 92206055, "body": "<code>Simple{upSimple}</code> ?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1538605485, "post_id": 52636415, "comment_id": 92206082, "body": "@Barry Don&#39;t forget the &quot;latest&quot; flag! :)"}, {"owner": {"reputation": 163, "user_id": 185297, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b1db737665253ccc089b6b80a155efd4?s=128&d=identicon&r=PG", "display_name": "Armbie", "link": "https://stackoverflow.com/users/185297/armbie"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1538606467, "post_id": 52636415, "comment_id": 92206343, "body": "Ok, yes, your comments lead me to the fix! Replacing Simple( upSimple ) with Simple{ upSimple } <i>and</i> setting the C++ Language Standard to /std:c++17 in the project settings allows this to compile as is! Thanks @Rakete1111 !"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1538611102, "post_id": 52636415, "comment_id": 92207353, "body": "Can someone write up an answer to this instead of a sequence of comments?  :p"}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 4, "last_activity_date": 1538652506, "last_edit_date": 1538652506, "creation_date": 1538618805, "answer_id": 52637994, "question_id": 52636415, "link": "https://stackoverflow.com/questions/52636415/template-argument-deduction-guide-for-unique-ptr-argument-type/52637994#52637994", "title": "Template Argument Deduction guide for unique_ptr argument type?", "body": "<blockquote>\n  <p>Is it possible to write a deduction guide so that an instance of Simple can be declared without template arguments? I've tried but cannot get the correct form to extract the std::unique_ptr element type.</p>\n</blockquote>\n\n<p>The problem is another.</p>\n\n<p>The implicitly generated deduction guides are perfectly able to extract the correct type template parameter for <code>Simple</code>.</p>\n\n<p>As pointed by Rakete1111, this is a sort of \"most vexing parse\" problem.</p>\n\n<p>Writing</p>\n\n<pre><code>Simple( upSimple );\n</code></pre>\n\n<p>your intention was to obtain the initialization of a unnamed temporary object of type <code>Simple</code> (<code>Simple&lt;MyThing&gt;</code>, thanks to new C++17 implicitly generated deduction guides) initialized with the object <code>upSimple</code>.</p>\n\n<p>Unfortunately the compiler (visual-c++, but the same with g++ and clang++) interpret it as the declaration of a new variable (observe that parentheses declaring C++ variables are superfluous but perfectly legal; with <code>int (i);</code> you declare a variable <code>i</code> of type <code>int</code>) of name <code>upSimple</code> and type <code>Simple</code>.</p>\n\n<p>This give an error because</p>\n\n<p>(1) <code>upSimple</code> is defined in the preceding line so we have a redeclaration of <code>upSimple</code></p>\n\n<p>(2) implicitly generated deduction guides are unable, without a constructor argument, to deduce the template argument <code>T</code> for <code>Simple</code>.</p>\n\n<p>To avoid this ambiguity, and obtain the initialization of a <code>Simple&lt;MyThing&gt;</code> object, you can save the value in a variable with</p>\n\n<pre><code>auto s = Simple(upSimple);\n</code></pre>\n\n<p>or also with</p>\n\n<pre><code>Simple s(upSimple);\n</code></pre>\n\n<p>so the compiler can't interpret the line as declaration of variable <code>upSimple</code> anymore.</p>\n\n<p>If you really want an unnamed temporary object, you can use uniform initialization (you can use braces instead of parentheses) </p>\n\n<pre><code>//.....V..........V\nSimple { upSimple };\n</code></pre>\n\n<p>that can't be interpreted as variable declaration.</p>\n\n<p>And, yes: also the imposition of the use of new C++17 standard (through <code>/std:c++17</code> or <code>-std=c++17</code> or whichever is required from specific compiler) can be useful.</p>\n"}], "owner": {"reputation": 163, "user_id": 185297, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b1db737665253ccc089b6b80a155efd4?s=128&d=identicon&r=PG", "display_name": "Armbie", "link": "https://stackoverflow.com/users/185297/armbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 52637994, "answer_count": 1, "score": 3, "last_activity_date": 1538652506, "creation_date": 1538604805, "last_edit_date": 1538619273, "question_id": 52636415, "link": "https://stackoverflow.com/questions/52636415/template-argument-deduction-guide-for-unique-ptr-argument-type", "title": "Template Argument Deduction guide for unique_ptr argument type?", "body": "<p>Is it possible to write a deduction guide so that an instance of <code>Simple</code> can be declared without template arguments? I've tried but cannot get the correct form to extract the <code>std::unique_ptr</code> element type.</p>\n\n<pre><code>//------------------------------------------------------------------------------\ntemplate&lt; class T &gt;\nclass Simple\n{\npublic:\n    Simple( std::unique_ptr&lt; T &gt;&amp; u ) :\n    u_( u )\n    {}\nprivate:\n    std::unique_ptr&lt; T &gt;&amp; u_;\n};\n\nclass MyThing\n{};\n\nint main()\n{\n    std::unique_ptr&lt; MyThing &gt; upSimple;\n    Simple( upSimple ); // error C2955: 'Simple': use of class template requires template argument list\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1538604146, "post_id": 52636306, "comment_id": 92205739, "body": "Why shouldn&#39;t it compile? <code>emplace_back</code> neither moves nor copies any <code>NoCopy</code> objects. By the way, it&#39;s called <i>destructor</i>, not <i>de<b>con</b>structor</i>"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1538604260, "post_id": 52636306, "comment_id": 92205780, "body": "@Fureeish an emplace_back could cause a reallocation which would require either move or copy of the existing elements."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1538604366, "post_id": 52636306, "comment_id": 92205812, "body": "@RichardHodges good point"}], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 5, "last_activity_date": 1538604755, "creation_date": 1538604755, "answer_id": 52636399, "question_id": 52636306, "link": "https://stackoverflow.com/questions/52636306/why-move-constructor-is-generated-when-user-declared-destructor-is-present/52636399#52636399", "title": "Why move constructor is generated when user-declared destructor is present?", "body": "<p>You have a typo in your code.  Where you have:</p>\n\n<pre><code>NoCopy(const NoCopyNoMove&amp;) = delete;\nNoCopy&amp; operator=(const NoCopyNoMove&amp;) = delete;\n</code></pre>\n\n<p>You should instead have:</p>\n\n<pre><code>NoCopy(const NoCopy&amp;) = delete;\nNoCopy&amp; operator=(const NoCopy&amp;) = delete;\n</code></pre>\n\n<p>Make those changes and the code indeed fails to compile:</p>\n\n<p><a href=\"https://wandbox.org/permlink/lVhPkL6ioLTC9k1w\" rel=\"noreferrer\">https://wandbox.org/permlink/lVhPkL6ioLTC9k1w</a></p>\n"}], "owner": {"reputation": 49, "user_id": 3811596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7Cz9.jpg?s=128&g=1", "display_name": "youwei", "link": "https://stackoverflow.com/users/3811596/youwei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1538605092, "answer_count": 1, "score": 0, "last_activity_date": 1538605126, "creation_date": 1538604076, "last_edit_date": 1538605126, "question_id": 52636306, "link": "https://stackoverflow.com/questions/52636306/why-move-constructor-is-generated-when-user-declared-destructor-is-present", "closed_reason": "Not suitable for this site", "title": "Why move constructor is generated when user-declared destructor is present?", "body": "<p>Following <a href=\"https://stackoverflow.com/a/19826645/10453696\">this answer</a> and <a href=\"https://en.cppreference.com/w/cpp/language/move_constructor\" rel=\"nofollow noreferrer\">this move-constructor specification</a>, there should be no implicit move constructor or move assignment operator. </p>\n\n<p>However, the following code still compiles in gcc 7.2.1:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nstruct NoCopyNoMove\n{\n    NoCopyNoMove(const NoCopyNoMove&amp;) = delete;\n    NoCopyNoMove&amp; operator=(const NoCopyNoMove&amp;) = delete;\n    NoCopyNoMove(NoCopyNoMove&amp;&amp;) = delete;\n    NoCopyNoMove&amp; operator=(NoCopyNoMove&amp;&amp;) = delete;\n\n    NoCopyNoMove(int){};\n};\n\nstruct NoCopy\n{\n    NoCopy(const NoCopyNoMove&amp;) = delete;\n    NoCopy&amp; operator=(const NoCopyNoMove&amp;) = delete;\n    // NoCopy(NoCopy&amp;&amp;) = delete;\n    // NoCopy&amp; operator=(NoCopy&amp;&amp;) = delete;\n    ~NoCopy() {\n        std::cout &lt;&lt; \"decontructor\" &lt;&lt; std::endl;\n    }\n    NoCopy(int){};\n};\n\nint main()\n{\n    // vector&lt;NoCopyNoMove&gt; y; // fails!\n    vector&lt;NoCopy&gt; y;\n    y.emplace_back(1);\n    y.emplace_back(2);\n}\n</code></pre>\n"}, {"tags": ["c++", "windows-10", "usb", "low-latency"], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1540495075, "creation_date": 1540495075, "answer_id": 52996587, "question_id": 52636243, "link": "https://stackoverflow.com/questions/52636243/how-to-minimize-latency-with-usb-2/52996587#52996587", "title": "how to minimize latency with usb 2", "body": "<p>No.</p>\n\n<p>Task scheduler resolution in userspace on a PC is in the order of milliseconds, not microseconds, so even just context switching blows your budget out of the water.</p>\n\n<p>There is no way you can guarantee real-time execution in such an operating system, except possibly by writing a kernel driver (though whether that's even true is beyond my expertise).</p>\n\n<p>You really need to be doing something like this in hardware or firmware.</p>\n"}], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540495075, "creation_date": 1538603745, "question_id": 52636243, "link": "https://stackoverflow.com/questions/52636243/how-to-minimize-latency-with-usb-2", "title": "how to minimize latency with usb 2", "body": "<p>I'm writing a simulator for XCP - an automotive protocol - on the PC.</p>\n\n<p>I'm using a USB-to-CAN device and C++.</p>\n\n<p>The issue with implementing this on PC, as opposed to on embedded hardware, is that XCP has very tight timeout message-reply requirements; it can be as low as <code>100us</code>.</p>\n\n<p>The actual code that would be running on the PC is trivial because it would merely return dummy data.</p>\n\n<p><strong>QUESTION</strong></p>\n\n<p>Given my requirement for <code>100us</code> response time, is it even possible to achieve on PC running Windows 10 <strong>consistently</strong>?</p>\n"}, {"tags": ["c++", "list"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1538603180, "post_id": 52636099, "comment_id": 92205430, "body": "Is <code>blockedProcess</code> <code>std::list</code>? If so: <a href=\"https://stackoverflow.com/questions/596162/can-you-remove-elements-from-a-stdlist-while-iterating-through-it\" title=\"can you remove elements from a stdlist while iterating through it\">stackoverflow.com/questions/596162/&hellip;</a>"}, {"owner": {"reputation": 5957, "user_id": 997196, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/E5hdR.png?s=128&g=1", "display_name": "Rivasa", "link": "https://stackoverflow.com/users/997196/rivasa"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1538603325, "post_id": 52636099, "comment_id": 92205479, "body": "@AlgirdasPreid\u017eius Would <code>list.remove()</code> also work? Just doing it once at end."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 5957, "user_id": 997196, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/E5hdR.png?s=128&g=1", "display_name": "Rivasa", "link": "https://stackoverflow.com/users/997196/rivasa"}, "edited": false, "score": 0, "creation_date": 1538603575, "post_id": 52636099, "comment_id": 92205566, "body": "@Rivasa <code>list.remove ()</code> would also need to iterate through the list to remove the elements, effectively needing 2 iterations through the list. While the technique described in the linked question, would require just one iteration through the list, due to the fact that removal from the list, via the iterator, is O(1) operation."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538603856, "post_id": 52636099, "comment_id": 92205654, "body": "You could do use erase-remove thinking, but I agree with Algirdas. The main cost of removing an item from a linked list is finding it. <a href=\"https://www.youtube.com/watch?v=iONsYGTu_UA\" rel=\"nofollow noreferrer\">Since it&#39;s already found...</a>"}, {"owner": {"reputation": 5957, "user_id": 997196, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/E5hdR.png?s=128&g=1", "display_name": "Rivasa", "link": "https://stackoverflow.com/users/997196/rivasa"}, "edited": false, "score": 0, "creation_date": 1538603925, "post_id": 52636099, "comment_id": 92205668, "body": "Right, knew something was escaping me on this point. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 1, "user_id": 9742308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799f056453b9153e154800fe473baaec?s=128&d=identicon&r=PG&f=1", "display_name": "Zac Migues", "link": "https://stackoverflow.com/users/9742308/zac-migues"}, "edited": false, "score": 0, "creation_date": 1538606726, "post_id": 52636217, "comment_id": 92206397, "body": "@ZacMigues Accept?  And which one?"}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 0, "last_activity_date": 1538693960, "last_edit_date": 1538693960, "creation_date": 1538603612, "answer_id": 52636217, "question_id": 52636099, "link": "https://stackoverflow.com/questions/52636099/i-can-get-objects-from-a-list-and-copy-them-but-how-do-i-delete-the-objects-i-c/52636217#52636217", "title": "I can get objects from a list and copy them, but how do I delete the objects I copied?", "body": "<p>Building on the comments, try this (which relies on the fact that <code>std::list::erase</code> conveniently returns an iterator to the next item in the list):</p>\n\n<pre><code>ProcessQueue findEventFlag(int eventnum)\n{\n    ProcessQueue transferProcess;\n    Process process;\n    list&lt;Process&gt;::iterator it = blockedProcess.begin();\n\n    while (it != blockedProcess.end())\n    {\n        process = *it;\n\n        if (process.getEvent() == eventnum)\n        {\n            process.setState(\"READY\");\n            process.setEvent(-1);\n            transferProcess.enqueue(process);\n            it = process.Erase (it);\n        }\n        else\n            it++;\n    }\n\n    return transferProcess;\n}\n</code></pre>\n\n<p>You can also <em>transfer</em> an element from one list to another with <a href=\"http://www.cplusplus.com/reference/list/list/splice/\" rel=\"nofollow noreferrer\"><code>std::list::splice</code></a> which would avoid copying your <code>process</code> object and might therefore be more efficient, something like:</p>\n\n<pre><code>ProcessQueue findEventFlag(int eventnum)\n{\n    ProcessQueue transferProcess;\n    Process process;\n    list&lt;Process&gt;::iterator it = blockedProcess.begin();\n\n    while (it != blockedProcess.end())\n    {\n        process = *it;\n        list&lt;Process&gt;::iterator next = std::next (it);\n\n        if (process.getEvent() == eventnum)\n        {\n            process.setState(\"READY\");\n            process.setEvent(-1);\n            transferProcess.splice(transferProcess.begin (), blockedProcess, it);\n        }\n\n        it = next;\n    }\n\n    return transferProcess;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9742308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799f056453b9153e154800fe473baaec?s=128&d=identicon&r=PG&f=1", "display_name": "Zac Migues", "link": "https://stackoverflow.com/users/9742308/zac-migues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538693960, "creation_date": 1538603011, "question_id": 52636099, "link": "https://stackoverflow.com/questions/52636099/i-can-get-objects-from-a-list-and-copy-them-but-how-do-i-delete-the-objects-i-c", "title": "I can get objects from a list and copy them, but how do I delete the objects I copied?", "body": "<p>I'm trying to find all the processes in the blockedProcess list with the specified event number, copy them into a transferList, and then remove them. Copying and moving the Process objects works fine, but I can't figure out how to remove those Process objects from blockedProcess afterwards.</p>\n\n<pre><code>ProcessQueue findEventFlag(int eventnum)\n{\n    ProcessQueue transferProcess;\n    Process process;\n    list&lt;Process&gt;::iterator it;\n\n\n\n    for (it = blockedProcess.begin(); it != blockedProcess.end(); it++)\n    {\n        process = *it;\n\n        if (process.getEvent() == eventnum)\n        {\n            process.setState(\"READY\");\n            process.setEvent(-1);\n            transferProcess.enqueue(process);\n        }\n\n    }\n\n    return transferProcess;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17", "copy-constructor", "template-specialization", "move-constructor"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1538602779, "post_id": 52635710, "comment_id": 92205286, "body": "Can you provide a concrete example (see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) of the error you&#39;re talking about? It&#39;s unclear to me what the specific problem is. Also &quot;<code>T</code> is copyable, but not movable&quot; isn&#39;t really a realistic case - that should never happen."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1538603112, "post_id": 52635710, "comment_id": 92205409, "body": "/OT: Your <code>bool = &#47;*...*&#47;</code> don&#39;t actually do anything. No SFINAE there."}, {"owner": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1538604290, "post_id": 52635710, "comment_id": 92205790, "body": "@Barry I&#39;m well aware that&#39;s what we prefer here on SO, however the problem is complex, though perhaps I can simplify it. This already is minimal, a complete and fully verifiable example would bloat this question and is in my opinion unnecessary to understand the problem. As unrealistic as that scenario is, it&#39;s still possible, and provided for coverage."}, {"owner": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1538604294, "post_id": 52635710, "comment_id": 92205791, "body": "@Rakete1111 Some of the original conditions were named, and from what I&#39;ve observed that part at least works as intended(providing something to specialize on i.e. EBO in the case of <code>compressed_tuple</code>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1538604615, "post_id": 52635710, "comment_id": 92205865, "body": "@KobyDuck No it&#39;s not. There&#39;s no example demonstrating the problem. Which is why I don&#39;t understand what the problem is. It&#39;s not even clear to me <i>what</i> doesn&#39;t compile, what the compile error is, etc."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538609638, "post_id": 52635710, "comment_id": 92207087, "body": "<code>static_assert(is_copyable_v&lt;T&gt;);  if constexpr (is_copyable_v&lt;T&gt;)</code>. <code>if constexpr</code> seems redundant."}, {"owner": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538610096, "post_id": 52635710, "comment_id": 92207171, "body": "@Jarod42 The static assert results in a compiler error if you try to use it and the type isn&#39;t copyable. Checking if it&#39;s copyable is so it only tries to compile the copy if indeed the type is copyable. It&#39;s similar in purpose to SFINAE, but with an error message at the callsite."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538610551, "post_id": 52635710, "comment_id": 92207254, "body": "<code>if constexpr</code> allows to reduce error message. Sad that it is needed :-/"}], "answers": [{"comments": [{"owner": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "edited": false, "score": 0, "creation_date": 1538610601, "post_id": 52636474, "comment_id": 92207262, "body": "Defaulting the copy and move constructors(without arranging for them to be deleted) seems to work, though I haven&#39;t thoroughly tested it. Not sure why I didn&#39;t think to try that. In any case, thanks."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1539035240, "post_id": 52636474, "comment_id": 92347252, "body": "@Jarod42 It&#39;s named after Eric Fiselier, a libc++ maintainer. I do not know if there&#39;s something I can link to."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "edited": false, "score": 0, "creation_date": 1539035424, "post_id": 52636474, "comment_id": 92347325, "body": "@KobyDuck You need to make special arrangements if you need to do something special (e.g., tuple&#39;s assignment operator needs to assign through reference). If the defaulted implementation is just fine then yes, you can just default them."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1538605192, "creation_date": 1538605192, "answer_id": 52636474, "question_id": 52635710, "link": "https://stackoverflow.com/questions/52635710/reliable-conditional-copy-and-move-constructors-in-template-class-with-specializ/52636474#52636474", "title": "Reliable conditional copy and move constructors in template class with specializations", "body": "<p>Two common approaches are:</p>\n\n<ul>\n<li>Default the special member functions, then arrange for them to become deleted (e.g., by using a special base class for this purpose).</li>\n<li><p>\"Eric's trick\":</p>\n\n<pre><code>Foo&amp; operator=(std::conditional_t&lt;can_copy, Foo, nonesuch&gt; const&amp; rhs) {\n    // implement\n}\n\nFoo&amp; operator=(std::conditional_t&lt;!can_copy, Foo, nonesuch&gt; const&amp;) = delete;\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 1053, "user_id": 3446285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32678149ec688b5c765719d10aad8a75?s=128&d=identicon&r=PG&f=1", "display_name": "Koby Duck", "link": "https://stackoverflow.com/users/3446285/koby-duck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 52636474, "answer_count": 1, "score": -1, "last_activity_date": 1538615059, "creation_date": 1538600814, "last_edit_date": 1538615059, "question_id": 52635710, "link": "https://stackoverflow.com/questions/52635710/reliable-conditional-copy-and-move-constructors-in-template-class-with-specializ", "title": "Reliable conditional copy and move constructors in template class with specializations", "body": "<p>I discovered my <code>compressed_tuple&lt;T1, T2&gt;</code> class doesn't compile when either <code>T1</code> or <code>T2</code> don't have a copy and/or move constructor with the error <strong>\"attempting to reference a deleted function\"</strong>. That error refers to usage of a deleted copy constructor in the copy constructor of <code>compressed_tuple</code>. I understand what the error is, why I get it, and how to fix it. What I don't understand is how to do it without excessive specialization(elaborated on below).</p>\n\n<p><code>compressed_tuple</code> is my name for a pair that uses <a href=\"https://en.cppreference.com/w/cpp/language/ebo\" rel=\"nofollow noreferrer\">EBO</a> via specialization to minimize its size when at least one value is empty and derivable. i.e. <code>std::unique_ptr</code> is typically implemented with this mechanism to prevent empty deleters from affecting its size(otherwise plain <code>std::unique_ptr</code> would be larger than a pointer).</p>\n\n<p><strong>TL:DR</strong> Skip to the bottom, where I ask the actual question. Everything leading up to it is informational context.</p>\n\n<p>Typically I would use specialization and call it a day, similar to this:</p>\n\n<pre><code>template&lt;class T&gt;\nconstexpr bool is_copyable_v = \n    std::is_copy_constructible_v&lt;T&gt; &amp;&amp; std::is_copy_assignable_v&lt;T&gt;;\ntemplate&lt;class T&gt;\nconstexpr bool is_movable_v =\n    std::is_move_constructible_v&lt;T&gt; &amp;&amp; std::is_move_assignable_v&lt;T&gt;;\n\ntemplate&lt;class T&gt;\nclass example_base\n{\npublic:\n    T value;\n\nprotected:\n    example_base() = default;\n    example_base(const example_base&amp;) = default;\n    example_base(example_base&amp;&amp;) = default;\n    ~example_base() = default;\n\n    inline example_base&amp; operator=(const example_base&amp; source)\n        noexcept(std::is_nothrow_copy_assignable_v&lt;T&gt;)\n    {\n        static_assert(is_copyable_v&lt;T&gt;, \"T must be copyable.\");\n\n        if constexpr (is_copyable_v&lt;T&gt;) {\n            value = source.value;\n        }\n        return *this;\n    }\n    inline example_base&amp; operator=(example_base&amp;&amp; source)\n        noexcept(std::is_nothrow_move_assignable_v&lt;T&gt;)\n    {\n        static_assert(is_movable_v&lt;T&gt;, \"T must be movable.\");\n\n        if constexpr (is_movable_v&lt;T&gt;) {\n            value = std::move(source.value);\n        }\n        return *this;\n    }\n};\n\n// T is both copyable and movable.\ntemplate&lt;\n    class T,\n    bool = is_copyable_v &lt;T&gt;,\n    bool = is_movable_v&lt;T&gt;&gt;\nclass example final : example_base&lt;T&gt;\n{\n    using base = example_base&lt;T&gt;;\n\npublic:\n    example() = default;\n    inline example(const example&amp; source)\n        noexcept(std::is_nothrow_copy_constructible_v&lt;T&gt;) :\n        base(source) {}\n    inline example(example&amp;&amp; source)\n        noexcept(std::is_nothrow_move_constructible_v&lt;T&gt;) :\n        base(std::move(source)) {}\n\n    inline example&amp; operator=(const example&amp; source)\n        noexcept(std::is_nothrow_copy_assignable_v&lt;T&gt;)\n    {\n        return static_cast&lt;example&amp;&gt;(base::operator=(source));\n    }\n    inline example&amp; operator=(example&amp;&amp; source)\n        noexcept(std::is_nothrow_move_assignable_v&lt;T&gt;)\n    {\n        return static_cast&lt;example&amp;&gt;(base::operator=(std::move(source)));\n    }\n};\n\n// T is copyable, but not movable.\ntemplate&lt;class T&gt;\nclass example&lt;T, true, false&gt; final : public example_base&lt;T&gt;\n{\n    using base = example_base&lt;T&gt;;\n\npublic:\n    example() = default;\n    inline example(const example&amp; source)\n        noexcept(std::is_nothrow_copy_constructible_v&lt;T&gt;) :\n        base(source) {}\n    example(example&amp;&amp;) = delete;\n\n    inline example&amp; operator=(const example&amp; source)\n        noexcept(std::is_nothrow_copy_assignable_v&lt;T&gt;)\n    {\n        return static_cast&lt;example&amp;&gt;(base::operator=(source));\n    }\n    example&amp; operator=(example&amp;&amp;) = delete;\n};\n\n// T isn't copyable, but is movable.\ntemplate&lt;class T&gt;\nclass example&lt;T, false, true&gt; final : public example_base&lt;T&gt;\n{\n    using base = example_base&lt;T&gt;;\n\npublic:\n    example() = default;\n    inline example(example&amp;&amp; source)\n        noexcept(std::is_nothrow_move_constructible_v&lt;T&gt;) :\n        base(std::move(source)) {}\n    example(const example&amp;) = delete;\n\n    inline example&amp; operator=(example&amp;&amp; source)\n        noexcept(std::is_nothrow_move_assignable_v&lt;T&gt;)\n    {\n        return static_cast&lt;example&amp;&gt;(base::operator=(std::move(source)));\n    }\n    example&amp; operator=(const example&amp;) = delete;\n};\n\n// T is neither copyable nor movable.\ntemplate&lt;class T&gt;\nclass example&lt;T, false, false&gt; final : public example_base&lt;T&gt;\n{\npublic:\n    example() = default;\n    example(const example&amp;) = delete;\n    example(example&amp;&amp;) = delete;\n\n    example&amp; operator=(const example&amp;) = delete;\n    example&amp; operator=(example&amp;&amp;) = delete;\n};\n</code></pre>\n\n<p>Which works fine but blows up exponentially if any other template parameters require further specialization.</p>\n\n<p><code>compressed_tuple</code> is quite large with all of its specializations, so I have omitted most of it:</p>\n\n<pre><code>// T1 is empty and inheritable, but T2 isn't, so derive from T1 and store T2.\n// Handles both &lt;..., true, true&gt; and &lt;..., true, false&gt;.\ntemplate&lt;class T1, class T2, \n    bool = std::is_empty_v&lt;T1&gt; &amp;&amp; !std::is_final_v&lt;T1&gt;,\n    bool = std::is_empty_v&lt;T2&gt; &amp;&amp; !std::is_final_v&lt;T2&gt;&gt;\nclass compressed_tuple final : private T1 \n{\nprivate:\n    using base = T1;\n\n    T2 second;\n\npublic:\n    compressed_tuple(const compressed_tuple&amp; source)\n        noexcept(\n            std::is_nothrow_copy_constructible_v&lt;T1&gt; &amp;&amp;\n            std::is_nothrow_copy_constructible_v&lt;T2&gt;) :\n        base(source),\n        second(source.second) {}\n    /*...*/\n};\n\n// T2 is empty and inheritable, but T1 isn't, so derive from T2 and store T1.\ntemplate&lt;class T1, class T2&gt;\nclass compressed_tuple&lt;T1, T2, false, true&gt; final : private T2 \n{\nprivate:\n    using base = T2;\n\n    T1 first;\n\npublic:\n    compressed_tuple(const compressed_tuple&amp; source)\n        noexcept(\n            std::is_nothrow_copy_constructible_v&lt;T1&gt; &amp;&amp;\n            std::is_nothrow_copy_constructible_v&lt;T2&gt;) :\n        base(source),\n        first(source.first) {}\n    /*...*/\n};\n\n// Neither T1 nor T2 are empty and derivable, so store both.\ntemplate&lt;class T1, class T2&gt;\nclass compressed_tuple&lt;T1, T2, false, false&gt; final\n{\nprivate:\n    T1 first;\n    T2 second;\n\npublic:\n    compressed_tuple(const compressed_tuple&amp; source)\n        noexcept(\n            std::is_nothrow_copy_constructible_v&lt;T1&gt; &amp;&amp;\n            std::is_nothrow_copy_constructible_v&lt;T2&gt;) :\n        first(source.first),\n        second(source.second) {}\n    /*...*/\n};\n</code></pre>\n\n<p>What I'm trying to do could be achieved with the following:</p>\n\n<pre><code>template&lt;\n    class T,\n    bool = is_copyable_v&lt;T&gt;,\n    bool = is_movable_v&lt;T&gt;,\n    bool = std::is_empty_v&lt;T1&gt; &amp;&amp; !std::is_final_v&lt;T1&gt;,\n    bool = std::is_empty_v&lt;T2&gt; &amp;&amp; !std::is_final_v&lt;T2&gt;&gt;\nclass compressed_tuple final { /*...*/ };\n\n// ...specialize on all valid combinations...\n</code></pre>\n\n<p>Though it would require a large number of specializations. What I'm looking for is an alternative if possible.</p>\n\n<p>To my understanding, SFINAE isn't an option for this. C++20 constraints would solve this very problem, but as of the time of this writing, it'll be quite some time before mainstream compilers are C++20 compliant. How can conditional copy and move constructors be implemented in C++17 without specializations or a large number of specializations?</p>\n"}, {"tags": ["c++", "file", "logging", "ofstream"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538601042, "post_id": 52635707, "comment_id": 92204694, "body": "Typo? <code>operator+</code> is not the same as <code>operator=</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538601444, "post_id": 52635707, "comment_id": 92204823, "body": "This is a case where you probably want to use a pointer to the log object. Having two multiple copies of a log object is not very helpful. This may bv a good place for a <code>std::shared_ptr</code>, but if you define the logger in <code>main</code>, you may be able to get away with a raw pointer since the logger&#39;s not going out of scope before <code>main</code> exits and if you still have stuff live when <code>main</code> exits... well, it&#39;s in for a nasty shock. A logger is a great example of cross-cutting behaviour.  You might just want a function that logs and contains a logger instance as a <code>static</code> local variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1538601473, "post_id": 52635707, "comment_id": 92204832, "body": "And if it a typo, operator= should return a reference."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538601480, "post_id": 52635707, "comment_id": 92204836, "body": "Also consider not keeping the log file open between writes to the log file. This allows you to delete and move logfiles much more easily."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538601542, "post_id": 52635707, "comment_id": 92204856, "body": "@NeilButterworth good point. Plus it should keep the promise made by the signature and return a value."}], "owner": {"reputation": 11, "user_id": 9586056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/706c264778c21b92a4e02bc3387cf321?s=128&d=identicon&r=PG", "display_name": "Gamaliel", "link": "https://stackoverflow.com/users/9586056/gamaliel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538600801, "creation_date": 1538600801, "question_id": 52635707, "link": "https://stackoverflow.com/questions/52635707/trouble-writing-to-same-log-file-from-multiple-classes", "title": "Trouble writing to same log file from multiple classes", "body": "<p>lets say I define \nclass A a\nand in main I declare a log object</p>\n\n<p>logClass logObj\nand open the logfile with\nlogObj.openFile(path);</p>\n\n<p>Now I want to write to the log file inside class a.</p>\n\n<p>So I define logObj as a member of a class and write in main</p>\n\n<p>a.logObj = logObj;</p>\n\n<p>In order to do that I need to overload logObjs = operator.  So I do </p>\n\n<pre><code>logClass logClass::operator+(logClass&amp; log)\n{\n    dir = log.dir;\n    logFile = log.logFile;\n}\n</code></pre>\n\n<p>I get an error with logFile = log.logFile.<br>\nlogFile is defined as\nofstream logFile;\nI need logFile in order to write to the same log file as was declared in main.  Apparently copying ofstreams is not allowed.  So how do I write to the same file.  </p>\n"}, {"tags": ["c++", "lambda", "std-function"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1538600854, "post_id": 52635685, "comment_id": 92204619, "body": "What does the type of <code>f1</code> tell you?"}, {"owner": {"reputation": 12459, "user_id": 316082, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a18baaf9417df189af31b53af03adb1c?s=128&d=identicon&r=PG", "display_name": "liv2hak", "link": "https://stackoverflow.com/users/316082/liv2hak"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1538600948, "post_id": 52635685, "comment_id": 92204660, "body": "@Rakete1111 - It tells me that it should be passed 3 parameters. I am passing a function with two bound and one placeholder parameter."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1538609267, "post_id": 52635685, "comment_id": 92207011, "body": "Notice that replacing <code>std::function&lt;int(int,int,int)&gt;</code> by <code>auto</code> would make the code working."}], "answers": [{"comments": [{"owner": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538601791, "post_id": 52635825, "comment_id": 92204930, "body": "I notice that but I don&#39;t know why c++ force to do something: std::function&lt;int(int)&gt; f1 = [f](int a) -&gt; int {cout &lt;&lt; &quot;Multiplication Table (10) :&quot; &lt;&lt; f(a) &lt;&lt; endl; };     You must explicitly mention the return type of lambda."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538601860, "post_id": 52635825, "comment_id": 92204954, "body": "@Amin No you don&#39;t and you never had to AFAIK. What makes you think that?"}, {"owner": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538602039, "post_id": 52635825, "comment_id": 92205017, "body": "I use Clion and writing std::bind, warning me to use lambda instead of that however if use std::bind and try to use it lambda without mention return type, it says return type is function&lt;lambda(int)&gt; and cant cast to function&lt;int(int)&gt; for function except I use auto for variable."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538602272, "post_id": 52635825, "comment_id": 92205104, "body": "@Amin Hmm that&#39;s weird. I can&#39;t tell you what causes this without looking at the code though. Can you maybe link it here? Or maybe tell me/lookup the error message? Or maybe create a new question?"}, {"owner": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538602548, "post_id": 52635825, "comment_id": 92205205, "body": "maybe new question is not good. I give you error: conversion from &#39;main()::&lt;lambda(int)&gt;&#39; to non-scalar type &#39;std::function&lt;int(int)&gt;&#39; requested"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538602599, "post_id": 52635825, "comment_id": 92205223, "body": "@Amin Oh ok. What&#39;s in the lambda body? Is there a <code>return</code>?"}, {"owner": {"reputation": 1045, "user_id": 3739748, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GoUt5.jpg?s=128&g=1", "display_name": "Amin", "link": "https://stackoverflow.com/users/3739748/amin"}, "edited": false, "score": 0, "creation_date": 1538602871, "post_id": 52635825, "comment_id": 92205331, "body": "oh. I forget. thanks it is worked. it is because of c++ that doesn&#39;t force to return when need return type. :)"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538602966, "post_id": 52635825, "comment_id": 92205351, "body": "@PaulSanders Yikes, so true. Thanks! :)"}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 1, "last_activity_date": 1538602956, "last_edit_date": 1538602956, "creation_date": 1538601464, "answer_id": 52635825, "question_id": 52635685, "link": "https://stackoverflow.com/questions/52635685/c-bound-function-passed-to-a-lambda/52635825#52635825", "title": "C++ bound function passed to a lambda", "body": "<blockquote>\n  <p>I am passing a function with two bound and one placeholder parameter.</p>\n</blockquote>\n\n<p>No you're not. Your lambda looks like this:</p>\n\n<pre><code>[f](int a) {\n    cout &lt;&lt; \"Multiplication Table (10) :\" &lt;&lt; f(a) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>That is the callable object that you are passing to <code>std::function</code>. Now, the lambda is callable with only one argument, not three. Notice:</p>\n\n<pre><code>[/*...*/](int a){ /*...*/ }\n//        ^^^^^\n//      one parameter\n</code></pre>\n\n<p>Likewise, <code>f</code> is a callable object with only one parameter. You can't call it with three arguments, because you've bound two parameters to specific values, so, for all intents and purposes, there are no three parameters. Maybe this makes it more clear:</p>\n\n<pre><code>auto add = [](int a, int b) { return a + b; };\nauto addTo5 = [&amp;add](int a) { return add(a, 5); };\n\nadd(1, 2); // ok, lambda takes two parameters\naddTo5(3); // ok, lambda takes one parameter\naddTo5(1, 2); // not ok, lambda doesn't take two parameters\n\nstd::function&lt;int(int, int)&gt; fadd = add; // ok\nstd::function&lt;int(int)&gt; faddTo5 = addTo5; // ok\nstd::function&lt;int(int, int)&gt; faddTo5fail = addTo5; // not ok, same reason\n\n// addTo5 is approximately what std::bind does: It generates an object which has\n// several variables \"fixed\", and so only takes the placeholder arguments that aren't\n// specified.\n</code></pre>\n\n<p>So, the fix is to change <code>f1</code>'s type to reflect what you are actually storing; a callable that takes an <code>int</code> and returns nothing:</p>\n\n<pre><code>std::function&lt;void(int)&gt; f1 = /*...*/;\n//            ^^^^\n//          lambda returns nothing\n</code></pre>\n"}], "owner": {"reputation": 12459, "user_id": 316082, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a18baaf9417df189af31b53af03adb1c?s=128&d=identicon&r=PG", "display_name": "liv2hak", "link": "https://stackoverflow.com/users/316082/liv2hak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 52635825, "answer_count": 1, "score": 0, "last_activity_date": 1538602956, "creation_date": 1538600694, "question_id": 52635685, "link": "https://stackoverflow.com/questions/52635685/c-bound-function-passed-to-a-lambda", "title": "C++ bound function passed to a lambda", "body": "<p>I have the below code where I am trying to print the multiplication table of 10.\nI have bound the function <code>multiply</code> with two parameters <code>5</code> and <code>2</code>. I am passing the bound function to create a lambda. And then I am attempting to pass the lambda to the <code>for_each</code> loop to print the Multiplication Table. I intutively kind of know that I may be pushing it a bit too far. But I don't know the exact reason. Can someone explain.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;thread&gt;\n#include &lt;functional&gt;\n#include &lt;future&gt;\n#include &lt;array&gt;\n#include &lt;unistd.h&gt;\n\nusing namespace std;\nusing namespace std::placeholders;\n\n\nint multiply(int a, int b, int c)\n{\n    return a*b*c;\n}\n\nint main()\n{\n    auto f = std::bind(multiply, 5, 2, _1);\n\n    std::function&lt;int(int,int,int)&gt; f1 = [f](int a){cout &lt;&lt; \"Multiplication Table (10) :\" &lt;&lt; f(a) &lt;&lt; endl; };\n\n    vector&lt;int&gt; vec = {1,2,3,4,5,6,7,8,9,10};\n\n    for_each(vec.begin(), vec.end(), f1);\n\n    return 0;\n}\n</code></pre>\n\n<p>The error that I am getting is shown below.</p>\n\n<pre><code>/home/karthik/Workspace/cpppen/learning/main.cpp: In function \u2018int main()\u2019:\n/home/karthik/Workspace/cpppen/learning/main.cpp:26:107: error: conversion from \u2018main()::&lt;lambda(int)&gt;\u2019 to non-scalar type \u2018std::function&lt;int(int, int, int)&gt;\u2019 requested\n     std::function&lt;int(int,int,int)&gt; f1 = [f](int a){cout &lt;&lt; \"Multiplication Table (10) :\" &lt;&lt; f(a) &lt;&lt; endl;};\n                                                                                                           ^\nIn file included from /usr/include/c++/7/algorithm:62:0,\n                 from /home/karthik/Workspace/cpppen/learning/main.cpp:6:\n/usr/include/c++/7/bits/stl_algo.h: In instantiation of \u2018_Funct std::for_each(_IIter, _IIter, _Funct) [with _IIter = __gnu_cxx::__normal_iterator&lt;int*, std::vector&lt;int&gt; &gt;; _Funct = std::function&lt;int(int, int, int)&gt;]\u2019:\n/home/karthik/Workspace/cpppen/learning/main.cpp:30:40:   required from here\n/usr/include/c++/7/bits/stl_algo.h:3884:5: error: no match for call to \u2018(std::function&lt;int(int, int, int)&gt;) (int&amp;)\u2019\n  __f(*__first);\n  ~~~^~~~~~~~~~\nIn file included from /usr/include/c++/7/functional:58:0,\n                 from /home/karthik/Workspace/cpppen/learning/main.cpp:8:\n/usr/include/c++/7/bits/std_function.h:701:5: note: candidate: _Res std::function&lt;_Res(_ArgTypes ...)&gt;::operator()(_ArgTypes ...) const [with _Res = int; _ArgTypes = {int, int, int}]\n     function&lt;_Res(_ArgTypes...)&gt;::\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n"}, {"tags": ["c++", "swift", "bridging"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 3, "creation_date": 1538600045, "post_id": 52635514, "comment_id": 92204281, "body": "There simply isn&#39;t any equivalent in C. You could provide a set of C wrapper functions around the std::vector methods, but that would be quite tedious and you&#39;ll still likely run into lots of run-time issues. I suggest you look for a vector library that is written in C."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538600507, "post_id": 52635514, "comment_id": 92204454, "body": "<a href=\"https://stackoverflow.com/questions/7691035/c-wrapper-for-c\">C Wrapper for C++</a>. This will eliminate the namespace (so such thing in C). The C-style function will have to take a c-style array as a parameter (along with the length) and copy it into the <code>vector</code> before calling the C++ code."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1538604181, "post_id": 52635514, "comment_id": 92205751, "body": "Does the library you are using have a <code>C</code> version of its <code>API</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": true, "score": 3, "last_activity_date": 1538605873, "creation_date": 1538605873, "answer_id": 52636560, "question_id": 52635514, "link": "https://stackoverflow.com/questions/52635514/wrapping-stdvectordouble-from-c-to-c-for-use-in-swift/52636560#52636560", "title": "wrapping std::vector&lt;double&gt; from C++ to C for use in Swift", "body": "<p>You can write some bridging functions that use <code>C</code> compatible types to call <code>C++</code> functions. This is very untested code just to give you an idea what you could do:</p>\n\n<pre><code>namespace Fft {\n   void transform(std::vector&lt;double&gt; &amp;real, std::vector&lt;double&gt; &amp;imag);\n}\n\nextern \"C\" {\n\nstruct complex_vector\n{\n    void* real;\n    void* imag;\n};\n\ncomplex_vector create_complex_vector(size_t size)\n{\n    complex_vector cv;\n    cv.real = new std::vector&lt;double&gt;(size);\n    cv.imag = new std::vector&lt;double&gt;(size);\n    return cv;\n}\n\nvoid complex_vector_push_back(complex_vector cv, double real, double imag)\n{\n    reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real)-&gt;push_back(real);\n    reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag)-&gt;push_back(imag);\n}\n\nvoid complex_vector_reserve(complex_vector cv, size_t size)\n{\n    reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real)-&gt;reserve(size);\n    reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag)-&gt;reserve(size);\n}\n\nvoid complex_vector_resize(complex_vector cv, size_t size)\n{\n    reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real)-&gt;resize(size);\n    reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag)-&gt;resize(size);\n}\n\nvoid fill_complex_vector(complex_vector cv, double* real, double* imag)\n{\n    auto v_real = reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real)-&gt;data();\n    auto v_imag = reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag)-&gt;data();\n    auto v_size = reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real)-&gt;size();\n\n    std::copy(real, real + v_size, v_real);\n    std::copy(imag, imag + v_size, v_imag);\n}\n\nvoid fft_transform(complex_vector cv)\n{\n    Fft::transform(*reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real), *reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag));\n}\n\ndouble* complex_vector_real_array(complex_vector cv)\n{\n    return reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real)-&gt;data();\n}\n\ndouble* complex_vector_imag_array(complex_vector cv)\n{\n    return reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag)-&gt;data();\n}\n\nsize_t complex_vector_size(complex_vector cv)\n{\n    return reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag)-&gt;size();\n}\n\nvoid destroy_complex_vector(complex_vector cv)\n{\n    delete reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.real);\n    delete reinterpret_cast&lt;std::vector&lt;double&gt;*&gt;(cv.imag);\n}\n\n} // extern \"C\"\n</code></pre>\n\n<p>If you compile that as <code>C++</code> the <code>extern \"C\" {}</code> block will make it so you can call those functions from <code>C</code>.</p>\n\n<p>You could write a <code>C</code> program a bit like this for example:</p>\n\n<pre><code>complex_vector cv = create_complex_vector(1024);\n\n// fill the vector\nfor(int i = 0; i &lt; complex_vector_size(cv); ++i)\n    complex_vector_push_back(cv, 0.2 * i, 0.4 * i);\n\n// call the transform\nfft_transform(cv);\n\ndouble* real = complex_vector_real_array(cv);\ndouble* imag = complex_vector_imag_array(cv);\nsize_t size = complex_vector_size(cv);\n\n// use your transformed data here ...\n\ndestroy_complex_vector(cv);\n</code></pre>\n\n<p><strong>Note:</strong> Completely untested code.</p>\n"}], "owner": {"reputation": 606, "user_id": 3742575, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/H8uMa.png?s=128&g=1", "display_name": "Heinz M.", "link": "https://stackoverflow.com/users/3742575/heinz-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 52636560, "answer_count": 1, "score": 4, "last_activity_date": 1556953296, "creation_date": 1538599886, "last_edit_date": 1556953296, "question_id": 52635514, "link": "https://stackoverflow.com/questions/52635514/wrapping-stdvectordouble-from-c-to-c-for-use-in-swift", "title": "wrapping std::vector&lt;double&gt; from C++ to C for use in Swift", "body": "<p>I want to use a program which is written in C++ in Swift 4. I already read and understood the description how to do the briding and wrapping as described in <a href=\"http://www.swiftprogrammer.info/swift_call_cpp.html\" rel=\"nofollow noreferrer\">http://www.swiftprogrammer.info/swift_call_cpp.html</a>.</p>\n\n<p>However, real life is more complicated and I have no experience in C++. I have the following piece of code in the C++ header file.</p>\n\n<pre><code>namespace Fft {\n   void transform(std::vector&lt;double&gt; &amp;real, std::vector&lt;double&gt; &amp;imag);\n}\n</code></pre>\n\n<p>I have two questions: </p>\n\n<ol>\n<li>How to write the function declaration in C? I have no idea what the equivalent of vector is in C.</li>\n<li>What is the meaning of namespace in C?</li>\n</ol>\n"}, {"tags": ["c++", "vector", "max", "user-defined-types"], "answers": [{"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 3, "last_activity_date": 1538599918, "creation_date": 1538599918, "answer_id": 52635522, "question_id": 52635339, "link": "https://stackoverflow.com/questions/52635339/getting-the-max-element-in-a-vector-of-objects-from-a-custom-class/52635522#52635522", "title": "Getting the max element in a vector of objects from a custom class", "body": "<p>By default the standard library uses <code>operator&lt;</code> to compare objects. So if your class <code>SocialPrefNode&lt;T&gt;</code> has either a function or member defined for <code>operator&lt;</code> then it would work automatically.</p>\n\n<pre><code>//either:\ntemplate&lt;typename T&gt;\nbool operator&lt;(SocialPrefNode&lt;T&gt; const&amp; lhs, SocialPrefNode&lt;T&gt; const&amp; rhs);\n\n// or\ntemplate&lt;typename T&gt;\nclass SocialPrefNode\n{\n    public:\n    bool operator&lt;(SocialPrefNod const&amp; rhs) const;\n};\n</code></pre>\n\n<p>If that is not viable then most standard library functions allow you to specify a comparator function as a last parameter. Looking at <code>max_element</code> this seems to be the case <a href=\"https://en.cppreference.com/w/cpp/algorithm/max_element\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/algorithm/max_element</a></p>\n\n<pre><code>template&lt; class ForwardIt, class Compare &gt;\nForwardIt max_element( ForwardIt first, ForwardIt last, Compare comp );\n</code></pre>\n\n<p>The third parameter here is used to compare elements against each other. You can either pass a function, lamda, or object that can do the comparison.</p>\n\n<pre><code>auto m = std::max_element(std::begin(graph), std::end(graph),\n                          [](auto const&amp; lhs, auto const&amp; rhs) -&gt; bool\n                          {\n                              /* Do comparison */;\n                          });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 1593858, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c0099e8e5222c889539207836a6d395?s=128&d=identicon&r=PG", "display_name": "user1593858", "link": "https://stackoverflow.com/users/1593858/user1593858"}, "is_accepted": true, "score": 3, "last_activity_date": 1538600239, "creation_date": 1538600239, "answer_id": 52635583, "question_id": 52635339, "link": "https://stackoverflow.com/questions/52635339/getting-the-max-element-in-a-vector-of-objects-from-a-custom-class/52635583#52635583", "title": "Getting the max element in a vector of objects from a custom class", "body": "<p>You can use std::max_element with a custom comparison function that compares the two objects however you'd like.  See <a href=\"https://en.cppreference.com/w/cpp/algorithm/max_element\" rel=\"nofollow noreferrer\">overload #3</a>.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;cassert&gt;\n\nclass Node\n{\npublic:\n    Node(const std::vector&lt;int&gt;&amp; prefs) : prefs_(prefs) {}\n\n    size_t numPrefs() const { return prefs_.size();}\n\n    bool operator==(const Node&amp; rhs) const { return prefs_ == rhs.prefs_;}\n\nprivate:\n    std::vector&lt;int&gt; prefs_;\n};\n\n\n\nint main(int argc, char** argv)\n{\n    Node one(std::vector&lt;int&gt;{1});\n    Node two(std::vector&lt;int&gt;{1,2});\n    Node three(std::vector&lt;int&gt;{1,2,3});\n\n    std::vector&lt;Node&gt; nodes{one, two, three};\n\n    auto comparison = [](const Node&amp; a, const Node&amp; b)\n        {\n            return a.numPrefs() &lt; b.numPrefs();\n        };\n\n    auto max = std::max_element(nodes.begin(), nodes.end(), comparison);\n\n    assert(*max == three);\n    //assert(*max == two);  //Will fail\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10286737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f4b1696b3e671375c20719aaab385a?s=128&d=identicon&r=PG", "display_name": "Kaique S.", "link": "https://stackoverflow.com/users/10286737/kaique-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 1, "accepted_answer_id": 52635583, "answer_count": 2, "score": 2, "last_activity_date": 1538600239, "creation_date": 1538599191, "question_id": 52635339, "link": "https://stackoverflow.com/questions/52635339/getting-the-max-element-in-a-vector-of-objects-from-a-custom-class", "title": "Getting the max element in a vector of objects from a custom class", "body": "<p>Consider the following blocks of code:</p>\n\n<pre><code>template&lt;typename Prefs&gt; class SocialPrefNode{\n\npublic:\n\n// Constructors &amp; Destructor\nSocialPrefNode( );\nSocialPrefNode( char self, std::vector&lt;SocialPrefNode*&gt; pref );\nSocialPrefNode( const SocialPrefNode&amp; copy );\n\n~SocialPrefNode( );\n\n// Setters\nvoid set_id( char self );\n\nvoid set_pref( std::vector&lt;SocialPrefNode*&gt; prefs );\nvoid set_pref( SocialPrefNode&amp; prefs );\n\nvoid set_worse( std::vector&lt;SocialPrefNode*&gt; wrs );\nvoid set_worse( SocialPrefNode&amp; wrs );\n\nvoid set_indiff( std::vector&lt;SocialPrefNode*&gt; indiff );\nvoid set_indiff( SocialPrefNode&amp; indiff );\n\n// Getters\nchar get_id( ){ return id; }\n\nstd::vector&lt;SocialPrefNode*&gt; get_preferences( ){ return preferences; }\nstd::vector&lt;SocialPrefNode*&gt; get_worse( ){ return worsethan; }\nstd::vector&lt;SocialPrefNode*&gt; get_indiff( ){ return indifference; }\n\n// Operators\nSocialPrefNode&amp; operator=( const SocialPrefNode&amp; copy );\n\nprivate:\n\nchar id{ };\n\nstd::vector&lt;SocialPrefNode*&gt; preferences{ };\nstd::vector&lt;SocialPrefNode*&gt; worsethan{ };\nstd::vector&lt;SocialPrefNode*&gt; indifference{ };\n};\n</code></pre>\n\n<p>,and</p>\n\n<pre><code>std::vector&lt;SocialPrefNode&lt;char&gt;&gt; graph\n</code></pre>\n\n<p>, where the latter is made by pointing its elements to each other.</p>\n\n<p>How can I get the maximum element, in terms of the size of the <strong>preferences</strong> vector's size, from <strong>graph</strong>?</p>\n\n<p>I.e., I want to select elements from <strong>graph</strong> accordingly to <strong>preferences</strong>' size, in descending order.</p>\n\n<p>I have considered using <code>std::max_element( )</code>, but it does not seem to apply to the aforementioned code, since I am using a vector of objects from a custom class where there are no properties to directly inform the compiler what is to be considered a greater or smaller element in the vector.</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["c++", "overloading", "cout", "ostream"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1538599070, "post_id": 52635287, "comment_id": 92203860, "body": "It sounds like you probably want two subclasses, with a virtual &quot;write()&quot; method specific to each.  See <a href=\"https://www.tomdalling.com/blog/software-design/solid-class-design-the-liskov-substitution-principle/\" rel=\"nofollow noreferrer\">SOLID</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1538599084, "post_id": 52635287, "comment_id": 92203866, "body": "You don&#39;t need an overload, just compare pointers - <code>if ( &amp;out == &amp;cout)</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1538599099, "post_id": 52635287, "comment_id": 92203875, "body": "Do you have to print differently depending on he stream?  That seems counter-intuitive.  If you really have to make it different I would overload the function for a <code>ostream&amp;</code> and <code>ofstream&amp;</code>."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 3, "creation_date": 1538599115, "post_id": 52635287, "comment_id": 92203882, "body": "&quot;I have a function I&#39;m writing that should handle output differently if it gets passed a file stream vs if it gets passed the console out.&quot; Then write two functions. If it should do different things, it should be different functions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1538599453, "post_id": 52635287, "comment_id": 92204034, "body": "People suggesting two functions might like to consider how you are going to dispatch to those functions depending on the run-time value of the stream."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1538605507, "post_id": 52635287, "comment_id": 92206087, "body": "If you don&#39;t want to, or can&#39;t, use separate functions, you <i>could</i> use <code>dynamic_cast</code> to check if the passed <code>ostream</code> is really an <code>ofstream</code> (since <code>ostream</code> has a virtual destructor). However, it is also possible for someone to attach a standard <code>filebuf</code> (or even a user-defined <code>streambuf</code> that happens to use files) to an <code>ostream</code> that is not an <code>ofstream</code>. In which case, the only reliable way to know for sure is to simply require the caller to pass in an input parameter indicating the desired output format."}, {"owner": {"reputation": 11, "user_id": 10420723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zQAxaGqJ_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXmMS2NmcyVeVO7yJ3Fqny2wOtzZw/mo/photo.jpg?sz=128", "display_name": "Cali Springston", "link": "https://stackoverflow.com/users/10420723/cali-springston"}, "edited": false, "score": 0, "creation_date": 1538610363, "post_id": 52635287, "comment_id": 92207215, "body": "The function has to scale some spacing if it&#39;s getting printed to console, where if it&#39;s going to a txt, I don&#39;t care if it text wraps to the next line. The additional bit for if it&#39;s console just will assign the scaling factor to the length of the output."}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1538687862, "last_edit_date": 1538687862, "creation_date": 1538683349, "answer_id": 52654335, "question_id": 52635287, "link": "https://stackoverflow.com/questions/52635287/knowing-which-ostream-is-passed-to-a-function-c/52654335#52654335", "title": "Knowing which ostream is passed to a function c++", "body": "<p>Based on your comments this is an XY problem -- you really have a completely different problem (having special formatting for the output when it is going to a console instead of a file) and think that is best done by identifying the ostream.</p>\n\n<p>The better way is to allocate a custom formatting flag for your use, and then set that flag in cout.  Then your printing routines check the flag:</p>\n\n<pre><code>class CustomFlag {\n    static int flag_id = -1;\npublic:\n    static std::ios_base &amp;set(std::ios_base &amp;s) {\n        if (flag_id &lt; 0) flag_id = s.xalloc();\n        s.iword(flag_id) = 1;\n        return s; }\n    static std::ios_base &amp;clear(std::ios_base &amp;s) {\n        if (flag_id &lt; 0) flag_id = s.xalloc();\n        s.iword(flag_id) = 0;\n        return s; }\n    static int get(std::ios_base &amp;s) {\n        if (flag_id &lt; 0) flag_id = s.xalloc();\n        return s.iword(flag_id); }\n};\n</code></pre>\n\n<p>You do <code>std::cout &lt;&lt; CustomFlag::set;</code> to set it on stdout, and use <code>CustomFlag::get(stream)</code> to check the flag on any ostream.</p>\n\n<p>By doing things this way, you can control the formatting on any ostream -- including doing \"console\" formatting into a file (for testing).  It will also be copied properly between streams if you call <code>copyfmt</code></p>\n"}], "owner": {"reputation": 11, "user_id": 10420723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zQAxaGqJ_Yg/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXmMS2NmcyVeVO7yJ3Fqny2wOtzZw/mo/photo.jpg?sz=128", "display_name": "Cali Springston", "link": "https://stackoverflow.com/users/10420723/cali-springston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "closed_date": 1538684819, "answer_count": 1, "score": 1, "last_activity_date": 1538687862, "creation_date": 1538598930, "question_id": 52635287, "link": "https://stackoverflow.com/questions/52635287/knowing-which-ostream-is-passed-to-a-function-c", "closed_reason": "Duplicate", "title": "Knowing which ostream is passed to a function c++", "body": "<p>I have a function I'm writing that should handle output differently if it gets passed a file stream vs if it gets passed the console out.\nI could write two functions, one to handle cout and one to handle the fstream, and throw them in an if statement to determine which is called, or could add a bool on which version to run, but it'd be simpler to verify the output passed to the function, in my opinion. My first attempt was</p>\n\n<pre><code>    void print(unsigned long long exp, unsigned long long* total, \n    ostream&amp; out, unsigned long long min, unsigned long long max, unsigned \n    long long length)\n    {\n        if (out == cout)\n    ...\n    }\n</code></pre>\n\n<p>Is there a way to overload == to compare these or a function that compares these?</p>\n"}, {"tags": ["c++", "assembly", "x86", "inline-assembly", "integer-division"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1538599098, "post_id": 52635251, "comment_id": 92203874, "body": "Regardless of how it works, this code is most probably outdated when using a modern compiler, as they should generate a better or comparable output just from the naive version."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1538599231, "post_id": 52635251, "comment_id": 92203940, "body": "Pro Tip: Compilers are written by a lot of <i>really</i> smart people.  If you give them obvious code they do a really good job of giving you the best possible machine code.  That means understandable code often turns into performant code."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538599440, "post_id": 52635251, "comment_id": 92204030, "body": "What compiler are you using? VS2017 won&#39;t compile it for various reasons."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1538599474, "post_id": 52635251, "comment_id": 92204042, "body": "FWIW, <a href=\"https://godbolt.org/z/CaTjkM\" rel=\"nofollow noreferrer\">GCC 8.2 is able to boil it down to just <code>imul</code> calls, while Clang still uses <code>idiv</code></a>."}, {"owner": {"reputation": 63, "user_id": 9892778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d6b3ec98a265ab09e4a40024f51572?s=128&d=identicon&r=PG&f=1", "display_name": "John McLane", "link": "https://stackoverflow.com/users/9892778/john-mclane"}, "edited": false, "score": 0, "creation_date": 1538599901, "post_id": 52635251, "comment_id": 92204227, "body": "actually I want to understand how this code works ?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1538600058, "post_id": 52635251, "comment_id": 92204287, "body": "@BartekBanachewicz: That&#39;s because you disabled optimization!  See <a href=\"https://godbolt.org/z/qtQkxc\" rel=\"nofollow noreferrer\">godbolt.org/z/qtQkxc</a> for much better code from clang and gcc <code>-O3</code>.  All modern compilers know how to use a multiplicative inverse for division by a compile-time constant, but gcc is the only one that does so even at <code>-O0</code>, IIRC.   <a href=\"https://stackoverflow.com/q/41183935\">Why does GCC use multiplication by a strange number in implementing integer division?</a>"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1538600231, "post_id": 52635251, "comment_id": 92204345, "body": "@NathanOliver: If only that would be true! Compilers generate good code usually, but almost never the best possible."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538600423, "post_id": 52635251, "comment_id": 92204414, "body": "This code is actually a win for 32-bit (where 64x64 =&gt; 128 multiplication isn&#39;t available so compilers use actual division), but loses badly on 64-bit.  It should really use <code>__builtin_constant_p</code> to only use inline asm if either input is not a compile-time constant after inlining and constant-propagation."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1538600500, "post_id": 52635251, "comment_id": 92204449, "body": "To answer the specific question about what that code does. The non-MSVC code uses extended inline assembly that utilizes the <code>div</code> instruction to compute the remainder portion of the equation.The div instruction places the remainder of 64-bit division of EDX:EAX by a 32-bit register and  places the quotient in EAX and remainder in EDX. This code assumes that the division won&#39;t overflow."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1538600630, "post_id": 52635251, "comment_id": 92204513, "body": "@MichaelPetch: Why not post that as an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538607271, "post_id": 52635741, "comment_id": 92206524, "body": "Excellent answer, I would give it two votes if I could."}, {"owner": {"reputation": 63, "user_id": 9892778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d6b3ec98a265ab09e4a40024f51572?s=128&d=identicon&r=PG&f=1", "display_name": "John McLane", "link": "https://stackoverflow.com/users/9892778/john-mclane"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538632139, "post_id": 52635741, "comment_id": 92212000, "body": "Thanks @PaulSanders for excellent explanation. As I am starting to learn asm can you suggest me some good resource ?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538637412, "post_id": 52635741, "comment_id": 92214519, "body": "It was Peter who answered the question!  You&#39;ll just have to Google around, sorry, I have no specific recommendations."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 63, "user_id": 9892778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d6b3ec98a265ab09e4a40024f51572?s=128&d=identicon&r=PG&f=1", "display_name": "John McLane", "link": "https://stackoverflow.com/users/9892778/john-mclane"}, "edited": false, "score": 0, "creation_date": 1538640985, "post_id": 52635741, "comment_id": 92216374, "body": "@JohnMcLane: <a href=\"https://stackoverflow.com/tags/x86/info\">stackoverflow.com/tags/x86/info</a> has links to guides and manuals."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 5, "last_activity_date": 1538608245, "last_edit_date": 1538608245, "creation_date": 1538601001, "answer_id": 52635741, "question_id": 52635251, "link": "https://stackoverflow.com/questions/52635251/what-is-the-use-of-this-asm-block-using-x86-div-in-c/52635741#52635741", "title": "What is the use of this asm block using x86 DIV in c++?", "body": "<p>This code is actually a speedup for 32-bit (where 64x64 => 128 multiplication isn't available so compilers use actual division, but loses badly on 64-bit where compilers do use a multiplicative inverse to avoid slow hardware division entirely.   <a href=\"https://stackoverflow.com/q/41183935\">Why does GCC use multiplication by a strange number in implementing integer division?</a></p>\n\n<p>Also, it should really use <code>__builtin_constant_p</code> to only use inline asm if either input is not a compile-time constant after inlining and constant-propagation.</p>\n\n<hr>\n\n<p>But anyway, <a href=\"http://felixcloutier.com/x86/DIV.html\" rel=\"nofollow noreferrer\">x86's <code>div</code> instruction</a> does <code>EDX:EAX / (src)</code> => quotient(EAX) and divisor(EDX).  See <a href=\"https://stackoverflow.com/questions/36464879/when-and-why-do-we-sign-extend-and-use-cdq-with-mul-div\">When and why do we sign extend and use cdq with mul/div?</a></p>\n\n<p>The <code>\"a\"</code> and <code>\"d\"</code> constraints ask for the low and high halves of the 64-bit product in EAX and EDX respectively as inputs.</p>\n\n<p>From the <a href=\"https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAKxAEZSAbAQwDtRkBSAJgCFufSAZ1QBXYskwgA5GhaCCAajwtFAW3QKOAZgAiCgJz6AHFwAsprQFYt2vgAYAgsrUiGEZwqaklKhQCMASg5HDgB2ewduLTwAMywYhQB9RIAPIwA2RPTTZOCHBQKFYkwCMRYFdxUAiogGVDYFOrZqpgUAKn9NLksFdSCtCKjMBkFMPMKlGIhkvxE8BgJlRNl5VgJEgAcIJmrudL2kxNn5xZZl%2BtWVTYhAoMcJieLS4nLKgmqoJuBG%2BuAW9s63B6fVs4weAHpwQpkMw2GApIJ/HMFksVgQ1pslIjMAA3JgMTAaPyYGIkTA%2BBjKZTAbxYYgbPJggoiOR4YAsQk/BpfBQpTS6Co8r7/Dp%2BUH3QoswRsjkaFIIfl6CBSmWEj587TYTUKLRcALeFIMRUVFXstW82neVTi/KFJiCVQQJkPCbcLj4HFGoGmWyaSwAYRYHADBDdzpdBRAXS42h0TDdFXQ%2BujsfQCYgqjutojhSjbrTXC4FXlybd8cLxYYpcLxHTIIlBX6EUeJTKvRtQxY%2BBijNCOkZjg8qiYyggu3CzqebdUrgg9D1Hb7Un1DGklikpBY0jsG9Q0n9/H4CmEYgkXS0tA3BG3y/1AGsQFotAA6J9v98f9KMaSmDdbqQ7qQe5SBugggHYpDXgBy6kHAsBIGgqgbPMmBkBQECIchBLECAwAmKQMQnKhYE3DepB%2BMoTDEAAntIl6kIhqiYCoADyLAMLR0GkFgw5sASZH4MUyCLDimBgVxmApJgyAiAQkhSPRzjDGRBDEHgqh0TBsLsIevCMHgfhgZA%2BqoBsiwXNIAC0LFaAolmqLqoGiOIki0Cua5/mRwFpOklnZAowDIMgChGM%2BRYQLghAkOe9AKP6qBIShxAxdUB68PwV43gE96Pi%2BH75W%2BX6rlIv6bl50igeBkFZbBMBQHVEAIQlWGoeQlCYUlKDaaEdgQYRCzEZQfhkRRLBUZx9GMcxBBsRxAmYLxwD8VxgnSSJYlkZJ0myfJikqMpXGqepmkrqwOnpXplKGfAJlmXgFlSNZtn2Y5QjORIdDuVI65lVx3kZH5pjQtpCihM%2BdjgxUkVEMlUSxfFiXYeeepxbpPCZdB2WkA%2BT6vgV%2BXfiVG4aZYEH/oBwGVRBUE7vqcGICgzVJW1GFM9hXVnT1fVEcQJHDVxo3jZpDEJUxrHsZxgE8Wdy1S3gQnreJgFbTJcnC0pxWAUdGkKVpZ0oGj%2BnXcZQF3Q9T1OaerlfT95O7tIPmA8DZ2g%2BDkMRfgMMxd4CMtbDXBPqlaMY7T%2BoIJgTB0pQX2lSTZPlSBQhVTTt7Y7leP4%2B%2BhNaJ5f0VdVmNfVwucU/nKdY6JvP3VuphAA%3D\" rel=\"nofollow noreferrer\">Godbolt compiler explorer</a>:</p>\n\n<pre><code>const int md = 998244353;\nint mul(int a, int b)\n{\n#ifdef __x86_64__ // FIXME: just use the asm if defined(i386) to exclude all others\n    return (int) ((long long) a * b % md);\n#else\n    if(__builtin_constant_p(a) &amp;&amp; __builtin_constant_p(b))\n        return (int) ((long long) a * b % md);\n      // clang's builtin_constant_p is evaled before inlining, derp\n\n    unsigned long long x = (long long) a * b;\n    unsigned xh = (unsigned) (x &gt;&gt; 32), xl = (unsigned) x, d, m;\n    asm(\n            \"divl %4; \\n\\t\"\n            : \"=a\" (d), \"=d\" (m)\n            : \"d\" (xh), \"a\" (xl), \"r\" (md)\n    );\n    return m;\n#endif\n}\n\nint main() {\n    return mul(1,2);\n}\n</code></pre>\n\n<p>compiles as follows with <code>gcc8.2 -O3 -m32</code>:</p>\n\n<pre><code>mul(int, int):\n    mov     eax, DWORD PTR [esp+8]\n    mov     ecx, 998244353\n    imul    DWORD PTR [esp+4]     # one-operand imul does EDX:EAX = EAX * src\n    divl ecx;                     # EDX:EAX / ecx =&gt; EAX and EDX\n\n    mov     eax, edx              # return the remainder\n    ret\n\nmain:\n    mov     eax, 2     # builtin_constant_p used the pure C, allowing constant-propagation\n    ret\n</code></pre>\n\n<p><strong>Notice that <code>div</code> is <em>unsigned</em> division, so this is doesn't match the C.  The C is doing signed multiplication and signed division.</strong>  This should probably use <code>idiv</code>, or cast the inputs to unsigned.  Or maybe they really do want weird results with negative inputs for some strange reason.</p>\n\n<p>So why can't compilers emit this on their own, without inline asm?  Because if the quotient overflows the destination register (al/ax/eax/rax), it faults with a #DE (Divide Exception) instead of silently truncating like all other integer instructions.</p>\n\n<p>A 64-bit / 32-bit => 32-bit division is only safe if you know the divisor is large enough for the possible dividends.  (But even if it is, gcc still doesn't know look for this optimization.  e.g. <code>a * 7ULL / 9</code> can't possibly cause a #DE if done with a single <code>mul</code> and <code>div</code>, if <code>a</code> was a 32-bit type.  But gcc will still emit a call to a libgcc helper function.)</p>\n"}], "owner": {"reputation": 63, "user_id": 9892778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d6b3ec98a265ab09e4a40024f51572?s=128&d=identicon&r=PG&f=1", "display_name": "John McLane", "link": "https://stackoverflow.com/users/9892778/john-mclane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "accepted_answer_id": 52635741, "answer_count": 1, "score": 2, "last_activity_date": 1538608245, "creation_date": 1538598790, "last_edit_date": 1538607046, "question_id": 52635251, "link": "https://stackoverflow.com/questions/52635251/what-is-the-use-of-this-asm-block-using-x86-div-in-c", "title": "What is the use of this asm block using x86 DIV in c++?", "body": "<p>Can someone help me understand benefit of using asm block for <code>unsigned long long</code> multiplication in terms of performance. It is related to competitive programming optimization. I guess it makes multiplication faster, but I can't understand code actually.</p>\n\n<pre><code>const int md = 998244353;\ninline int mul(int a, int b)\n{\n#if !defined(_WIN32) || defined(_WIN64)\n    return (int) ((long long) a * b % md);\n#endif\n    unsigned long long x = (long long) a * b;\n    unsigned xh = (unsigned) (x &gt;&gt; 32), xl = (unsigned) x, d, m;\n    asm(\n            \"divl %4; \\n\\t\"\n            : \"=a\" (d), \"=d\" (m)\n            : \"d\" (xh), \"a\" (xl), \"r\" (md)\n    );\n    return m;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "runtime", "typename"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1538598655, "post_id": 52635161, "comment_id": 92203679, "body": "Template arguments and runtime inputs cannot interact. Templates only exist during compilation and runtime inputs only exist during runtime."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 1, "creation_date": 1538598663, "post_id": 52635161, "comment_id": 92203686, "body": "Sounds like maybe you&#39;re looking for <a href=\"https://en.cppreference.com/w/cpp/utility/variant\" rel=\"nofollow noreferrer\"><code>std::variant</code></a> or <a href=\"https://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\"><code>std::any</code></a>?"}, {"owner": {"reputation": 75, "user_id": 10452416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rs8n9_zEKlA/AAAAAAAAAAI/AAAAAAAAABE/GGe0Ho19dLQ/photo.jpg?sz=128", "display_name": "Esmeralda Quintero", "link": "https://stackoverflow.com/users/10452416/esmeralda-quintero"}, "edited": false, "score": 0, "creation_date": 1538602245, "post_id": 52635161, "comment_id": 92205093, "body": "Thank you so much (n_n)  I finally realized that I wanted to do is not possible due to the architecture and std::variant can&#39;t be used either (u_u). Now I&#39;m using a macro like this &quot;#define runTemplate(func,type) if(type == MyCallType::MCT_FLOAT){ func&lt;float&gt;(); } else{ func&lt;ushort&gt;(); }&quot; and &quot;runTemplate(customProcess,mType)&quot;"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1538605918, "post_id": 52635161, "comment_id": 92206226, "body": "@EsmeraldaQuintero That is not a very good solution. Stay away from preprocessor macros when C++ features can do the same job. In this case, why not simply make <code>runTemplate()</code> be a templated function? <code>template&lt;typename T&gt; void runTemplate(funcType&lt;T&gt; func) { func(); }  ...  runTemplate&lt;float&gt;(customProcess);</code>  Or even abstract away the actual <code>func</code> type and let the compiler deduce it based on what kind of functions the caller actually passes in: <code>template&lt;typename funcType&gt; void runTemplate(funcType func) { func(); } ... runTemplate(customProcess&lt;float&gt;);</code>"}, {"owner": {"reputation": 75, "user_id": 10452416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rs8n9_zEKlA/AAAAAAAAAAI/AAAAAAAAABE/GGe0Ho19dLQ/photo.jpg?sz=128", "display_name": "Esmeralda Quintero", "link": "https://stackoverflow.com/users/10452416/esmeralda-quintero"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1538753912, "post_id": 52635161, "comment_id": 92267910, "body": "@RemyLebeau Thank you, that I wanted to avoid were the functions with the switch case.  Due to I have some template functions and the buffer could change on runtime, I create the wrapper function with the switch case for each template function and that increase my code a lot with repeated code where only the function to call changes. So I already tried to make a template function of a template function but I don&#39;t know if I made it right, because it still needed the function wrappers with the switch case. Again, thank you for taking your time to help me :)"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 10452416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rs8n9_zEKlA/AAAAAAAAAAI/AAAAAAAAABE/GGe0Ho19dLQ/photo.jpg?sz=128", "display_name": "Esmeralda Quintero", "link": "https://stackoverflow.com/users/10452416/esmeralda-quintero"}, "is_accepted": true, "score": 0, "last_activity_date": 1541441109, "creation_date": 1541441109, "answer_id": 53159833, "question_id": 52635161, "link": "https://stackoverflow.com/questions/52635161/can-i-switch-an-templates-parameter-type-during-calling-it-at-runtime-in-c/53159833#53159833", "title": "Can I switch an template&#39;s parameter type during calling it at runtime in C++?", "body": "<p>As Fran\u00e7ois said \"Template arguments and runtime inputs cannot interact\", so change the template's parameters during runtime is not possible, but a good solution could be the use of <code>std::variant</code> or <code>std::any</code> to avoid the switch cases, if you are using <code>C++17</code> (as Miles said).</p>\n\n<p>The implementation that I actually use was the use of macros, due I wanted to reduce the code and I'm using <code>C++11</code></p>\n"}], "owner": {"reputation": 75, "user_id": 10452416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rs8n9_zEKlA/AAAAAAAAAAI/AAAAAAAAABE/GGe0Ho19dLQ/photo.jpg?sz=128", "display_name": "Esmeralda Quintero", "link": "https://stackoverflow.com/users/10452416/esmeralda-quintero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 53159833, "answer_count": 1, "score": 0, "last_activity_date": 1541441109, "creation_date": 1538598384, "question_id": 52635161, "link": "https://stackoverflow.com/questions/52635161/can-i-switch-an-templates-parameter-type-during-calling-it-at-runtime-in-c", "title": "Can I switch an template&#39;s parameter type during calling it at runtime in C++?", "body": "<p>Firstly, I have a class Manager which could manage diferents primitive data types. For that reason, the Manager has template methods. To call them I have multiple methods with a switch case to select with what type the template method will be called.</p>\n\n<p>I have the next code on C++:</p>\n\n<pre><code>enum MyCallType\n{\n   MCT_DOUBLE,\n   MCT_FLOAT,\n   MCT_INT\n}\n\ntemplate&lt;class T&gt;\nclass MyBuffer\n{\npublic:\n   MyBuffer (int size, MyCallType type)\n   : mData (new T[size]),\n   mType (type)\n   {}\n   ~MyBuffer ()\n   {\n   delete mData;\n   }\n   MyCallType getType () { return mType; }\n\n   T* getData(){ return mData; }\nprivate:\n   T *mData;\n   MyCallType mType;\n}\n\n\nclass Manager\n{\npublic:\n   Manager (){}\n   /* a lot of code */\n   void process ()\n   {\n       switch (mType)\n       {\n           case MyCallType::MCT_DOUBLE:\n           customProcess &lt;double&gt;();\n           break;\n\n           case MyCallType::MCT_FLOAT:\n           customProcess &lt;float&gt;();\n           break;\n\n           / *more cases*/\n       }\n   }\n\n   template&lt;typename T&gt;\n   void customProcess ()\n   {\n       MyBuffer&lt;T&gt; *myCast = reinterpret_cast &lt;MyBuffer &lt;T&gt; *&gt;(mBuffer);\n       T *myData = myCast-&gt;getData ();\n       /* a lot of process */\n   }\n\nprivate:\n   void *mBuffer;\n   MyCallType mType;\n}\n</code></pre>\n\n<p>I want to avoid the switch case on \"process ()\" because I have a lot of function on the manager that work in the same way. Can anybody help me? That I want is possible?</p>\n"}, {"tags": ["c++", "windows", "visual-studio-2015"], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "is_accepted": false, "score": 1, "last_activity_date": 1538599846, "creation_date": 1538599846, "answer_id": 52635503, "question_id": 52635149, "link": "https://stackoverflow.com/questions/52635149/vs2015-not-linking-user32-lib/52635503#52635503", "title": "VS2015 not linking user32.lib", "body": "<p>Take the dependency on the lib file at the project level, and then <a href=\"https://docs.microsoft.com/en-us/cpp/ide/vcpp-directories-property-page?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(VS.ToolsOptionsPages.Projects.VCDirectories)%26rd%3Dtrue&amp;view=vs-2015\" rel=\"nofollow noreferrer\">add your paths to your properties page</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 1, "last_activity_date": 1538609358, "creation_date": 1538609358, "answer_id": 52636985, "question_id": 52635149, "link": "https://stackoverflow.com/questions/52635149/vs2015-not-linking-user32-lib/52636985#52636985", "title": "VS2015 not linking user32.lib", "body": "<p>The <code>Windows Kits\\8.1</code> tells you that you have the Windows 8.1 SDK installed. There's a Windows 10 SDK by now, but that probably doesn't really matter to you - user32.lib has been around since forever.</p>\n\n<p>The problem here seems to be that while you have the 8.1 SDK installed, Visual Studio isn't aware of it. IIRC, it's in the VS2015 installer, so you can rerun that and re-select the SDK there. (Or pick another SDK - you're likely going to be restricting the SDK to Win7 anyway)</p>\n"}], "owner": {"reputation": 187, "user_id": 2566111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVh2m.jpg?s=128&g=1", "display_name": "Kevin Dill", "link": "https://stackoverflow.com/users/2566111/kevin-dill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1538609358, "creation_date": 1538598323, "question_id": 52635149, "link": "https://stackoverflow.com/questions/52635149/vs2015-not-linking-user32-lib", "title": "VS2015 not linking user32.lib", "body": "<p>I just inherited maintenance on a 10-year-old project, which includes moving it from VS2005 to VS2015.  I'm most of the way there, but when I link I get this error:</p>\n\n<p>error LNK2019: unresolved external symbol __imp__MessageBoxA@16</p>\n\n<p>A quick search found that that this requires user32.lib.  When I go to properties->linker->Additional Dependencies, I see that library liste under Inherited Values, but it still doesn't link.  When I explicitly add the hardcoded path and filename (C:\\Program Files (x86)\\Windows Kits\\8.1\\Lib\\winv6.3\\um\\x86\\user32.lib) as another dependency, then it does successfully link... which is okay, I guess, but if nothing else it's ugly that I'm relying on that particular install location (you know software developers are going to decide to stick things in odd places)...  Anybody have any guesses as to why visual studio isn't finding the library in the first place, and how to fix it the right way?</p>\n"}, {"tags": ["c++", "libraries", "graphviz", "qmake"], "comments": [{"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1538597662, "post_id": 52634965, "comment_id": 92203246, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9602127/unable-to-use-dot-layout-graphviz-as-a-library\">Unable to use dot layout (graphviz as a library)</a>"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1538597736, "post_id": 52634965, "comment_id": 92203276, "body": "You need to distribute the dynamic libraries with your application, yes. Please see <a href=\"https://stackoverflow.com/questions/9602127/unable-to-use-dot-layout-graphviz-as-a-library\" title=\"unable to use dot layout graphviz as a library\">stackoverflow.com/questions/9602127/&hellip;</a> for a solution to your issue. (you must explicitly load the dot plugin)"}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "reply_to_user": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1538597839, "post_id": 52634965, "comment_id": 92203312, "body": "Thank you cinder biscuits, I just edited my post. When I load the plugin with Chris Devereux s answer, I get a segmentation fault :("}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1538600708, "post_id": 52634965, "comment_id": 92204552, "body": "@froz change <code>ancestry.dot</code> to full-path"}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "edited": false, "score": 0, "creation_date": 1538601652, "post_id": 52634965, "comment_id": 92204888, "body": "I have tried but it does not change anything"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1538605489, "post_id": 52634965, "comment_id": 92206083, "body": "okay, but at least in the code it says &quot;/path/of/ancestry.dot&quot; to not have that doubt because if you put a relative path this should be relative to the executable that is in the build folder and not the project that often generates this type of problems, I also see that you do not do any verification which smells bad"}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "edited": false, "score": 0, "creation_date": 1538645940, "post_id": 52634965, "comment_id": 92219297, "body": "I believe my problem comes from library linking. This example that you can see is just a minimal example. I have checks and correct path for the complete code. I have updated my question"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1538646030, "post_id": 52634965, "comment_id": 92219361, "body": "Your debugger probably has a much better idea than anybody here."}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "edited": false, "score": 0, "creation_date": 1538647084, "post_id": 52634965, "comment_id": 92219996, "body": "Is it possible to use a debugger for a software compiled on another computer? Do you have a tuto?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1538661293, "post_id": 52634965, "comment_id": 92228895, "body": "Yes it is, but you are compiling your own program. Chances that an external library is to blame are slim. Start by looking at the stack trace at the time of the crash."}, {"owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "edited": false, "score": 0, "creation_date": 1538667892, "post_id": 52634965, "comment_id": 92233311, "body": "With gdb I get the fllowing problem: Program received signal SIGSEGV, Segmentation fault. 0x00007ffff77695ee in ?? () from lib/libgvc.so.6"}], "owner": {"reputation": 163, "user_id": 10077673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fff83398af8ae0fec59673b135b31d?s=128&d=identicon&r=PG&f=1", "display_name": "froz", "link": "https://stackoverflow.com/users/10077673/froz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 909, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538645781, "creation_date": 1538597497, "last_edit_date": 1538645781, "question_id": 52634965, "link": "https://stackoverflow.com/questions/52634965/linking-graphviz-libraries-to-c-correctly", "title": "Linking graphviz libraries to C++ correctly", "body": "<p>I am developping a program with QtCreator in which I use graphviz2.38.</p>\n\n<p>I have done a minimale example to explain. Just consider this small code which transform a dot file in svg file:</p>\n\n<pre><code>#include &lt;QCoreApplication&gt;\n#include &lt;graphviz/gvc.h&gt;\n#include &lt;graphviz/gvplugin.h&gt;\n#include &lt;graphviz/cgraph.h&gt;\n#include &lt;graphviz/cdt.h&gt;\n#include&lt;iostream&gt;\nusing namespace std;\n\nvoid saveImageGV(){\n\n    GVC_t *gvc= gvContext();\n    extern gvplugin_library_t gvplugin_dot_layout_LTX_library;\n    gvAddLibrary(gvc, &amp;gvplugin_dot_layout_LTX_library);\n    FILE *fp = fopen((\"ancestry.dot\"), \"r\");\n    Agraph_t *g = agread(fp,0);\n    gvLayout(gvc, g, \"dot\");\n    gvRender(gvc, g, \"svg\", fopen((\"ancestry.svg\"), \"w\"));\n    gvFreeLayout(gvc, g);\n    agclose(g);\n    (gvFreeContext(gvc));\n    return exit(0);\n}\n\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n    saveImageGV();\n    return a.exec();\n}\n</code></pre>\n\n<p>The compilation options are the following:</p>\n\n<pre><code>QT       += core gui\n\ngreaterThan(QT_MAJOR_VERSION, 4): QT += widgets printsupport\n\n\nSOURCES += \\\n        main.cpp\nQMAKE_LFLAGS += \"-Wl,--rpath=lib/ \"\nQMAKE_LFLAGS += \"-Wl,--dynamic-linker=lib/ld-linux-x86-64.so.2\"\n\n# Default rules for deployment.\nqnx: target.path = /tmp/$${TARGET}/bin\nelse: unix:!android: target.path = /opt/$${TARGET}/bin\n!isEmpty(target.path): INSTALLS += target\nINCLUDEPATH += /usr/local/include/graphviz/\n\nunix:!macx: LIBS += -L$$PWD/../../../../usr/lib/ -lcdt\nINCLUDEPATH += $$PWD/../../../../usr/lib\nDEPENDPATH += $$PWD/../../../../usr/lib\n\nunix:!macx: LIBS += -L$$PWD/../../../../usr/lib/ -lcgraph\nINCLUDEPATH += $$PWD/../../../../usr/lib\nDEPENDPATH += $$PWD/../../../../usr/lib\n\nunix:!macx: LIBS += -L$$PWD/../../../../usr/lib/ -lgvc\nINCLUDEPATH += $$PWD/../../../../usr/lib\nDEPENDPATH += $$PWD/../../../../usr/lib\n\nunix:!macx: LIBS += -L$$PWD/../../../usr/lib/graphviz/ -lgvplugin_dot_layout\nINCLUDEPATH += $$PWD/../../../usr/lib/graphviz\nDEPENDPATH += $$PWD/../../../usr/lib/graphviz\n\nunix:!macx: LIBS += -L$$PWD/../../../usr/lib/graphviz/ -lgvplugin_core\nINCLUDEPATH += $$PWD/../../../usr/lib/graphviz\nDEPENDPATH += $$PWD/../../../usr/lib/graphviz\n\nunix:!macx: LIBS += -L$$PWD/../../../../usr/lib/ -lpathplan\nINCLUDEPATH += $$PWD/../../../../usr/lib\nDEPENDPATH += $$PWD/../../../../usr/lib\n\nunix:!macx: LIBS += -L$$PWD/../../../../usr/lib/ -lxdot\nINCLUDEPATH += $$PWD/../../../../usr/lib\nDEPENDPATH += $$PWD/../../../../usr/lib\n</code></pre>\n\n<p>I also provide you an example of graphviz dot code if needed for ancestry.dot:</p>\n\n<pre><code>graph {\n    a -- b;\n    b -- c;\n    a -- c;\n    d -- c;\n    e -- c;\n    e -- a;\n}\n</code></pre>\n\n<p>In my lib folder, I have the following libraries:</p>\n\n<pre><code>ld-linux-x86-64.so.2  libc.so.6              libgvplugin_dot_layout.so.6  libxdot.so.4\nlibcdt.so.5           libgvc.so.6            libgvplugin_gd.so.6\nlibcgraph.so.6        libgvplugin_core.so.6  libpathplan.so.4\n</code></pre>\n\n<p>To load these libraries at execution time, I use the following script:</p>\n\n<pre><code>#!/bin/sh\nappname=`basename $0 | sed s,\\.sh$,,`\n\ndirname=`pwd`\nlib=/lib/\n\nchmod +x $dirname/$appname\n\nLD_LIBRARY_PATH=$LD_LIBRARY_PATH:$dirname$lib\necho $LD_LIBRARY_PATH\n\n./$appname \"$@\"\n</code></pre>\n\n<p>When I execute my code, I get a segmentation fault ... Any idea of what is happening?</p>\n"}, {"tags": ["c++", "cmake", "g++"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1538598244, "post_id": 52634934, "comment_id": 92203493, "body": "How is CMake related with a problem (you use <code>cmake</code> as a tag)? According to the error message, it seems that your library is ABI incompatible with a compiler. Just google for &quot;undefined reference to cxx11&quot;."}, {"owner": {"reputation": 357, "user_id": 10084424, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zj2YyhN3k3k/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p6VpO81p8ICerhPw0j136Dtkzipw/mo/photo.jpg?sz=128", "display_name": "Arjun C", "link": "https://stackoverflow.com/users/10084424/arjun-c"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1538598415, "post_id": 52634934, "comment_id": 92203572, "body": "The library has been installed using cmake. There are various tags that can be set when installing using cmake - Maybe I did not set a flag correctly when installing using cmake? Thanks for the reply though, I&#39;m gonna look for that now."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1538598575, "post_id": 52634934, "comment_id": 92203651, "body": "Firstly check which compiler has been used when build the library. Using <b>the same compiler</b> for build library and executable prevent such incompatibilities in most cases."}], "owner": {"reputation": 357, "user_id": 10084424, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zj2YyhN3k3k/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p6VpO81p8ICerhPw0j136Dtkzipw/mo/photo.jpg?sz=128", "display_name": "Arjun C", "link": "https://stackoverflow.com/users/10084424/arjun-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538597331, "creation_date": 1538597331, "question_id": 52634934, "link": "https://stackoverflow.com/questions/52634934/error-reading-a-trajectory-file-using-chemfiles-library", "title": "Error reading a Trajectory File using Chemfiles library", "body": "<p>I need to write a piece of cpp code that will read a trajectory file (.pdb or .dcd files). I have followed the steps on the homepage of <a href=\"http://chemfiles.org/chemfiles/0.6.0/example.html\" rel=\"nofollow noreferrer\">chemfiles</a> library to read in the file. I am getting an error about undefined symbols for architecture x86_64 (please see a piece of the error log below).</p>\n\n<p>What I want: Able to read the .dcd/.pdb file using the chemfiles library (or any other suitable library to do so) - I need to access the coordinates of the atoms listed in the file.</p>\n\n<p>Code that reproduces the error when compiled using the command below:</p>\n\n<pre><code>#include \"/usr/local/include/chemfiles.hpp\" //path to library on my mac\n\nint main(int argc, char *argv[]) {\n    chemfiles::Trajectory testfile(\"test.dcd\");\n    return 1;\n}\n</code></pre>\n\n<p>Code that compiles successfully in CLI using the command below:</p>\n\n<pre><code>#include \"/usr/local/include/chemfiles.hpp\" //path to library on my mac\n\nint main(int argc, char *argv[]) {\n    // chemfiles::Trajectory testfile(\"test.dcd\");\n    return 1;\n}\n</code></pre>\n\n<p>Command to compile program:</p>\n\n<pre><code>g++-8 -fopenmp trial.cpp -o trial -lchemfiles -L /usr/local/lib\n// I am using openmp because my original code is about parallelisation with openmp\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"chemfiles::Trajectory::Trajectory(std::__cxx11::basic_string&lt;char, \nstd::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, char, \nstd::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, \nstd::allocator&lt;char&gt; &gt; const&amp;)\", referenced from:\n  _main in ccnk7agz.o\n  \"std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt;::find(char, unsigned long) const\", \nreferenced from:\n      file_open_info::parse(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in libchemfiles.a(Trajectory.cpp.o)\n      split_comment(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;&amp;) in \nlibchemfiles.a(LAMMPSData.cpp.o)\n  \"std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt;::rfind(char, unsigned long) const\", \nreferenced from:\n      file_open_info::parse(std::__1::basic_string&lt;char,  \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in libchemfiles.a(Trajectory.cpp.o)\n      chemfiles::SDFFormat::read(chemfiles::Frame&amp;) in \nlibchemfiles.a(SDF.cpp.o)\n  \"std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt;::compare(unsigned long, unsigned long, char \nconst*, unsigned long) const\", referenced from:\n      file_open_info::parse(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in libchemfiles.a(Trajectory.cpp.o)\n      chemfiles::Trajectory::Trajectory(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;, char, \nstd::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt; const&amp;) in libchemfiles.a(Trajectory.cpp.o)\n      chemfiles::FormatFactory::register_format(chemfiles::FormatInfo, \nstd::__1::function&lt;std::__1::unique_ptr&lt;chemfiles::Format, \nstd::__1::default_delete&lt;chemfiles::Format&gt; &gt; \n(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, \nstd::__1::allocator&lt;char&gt; &gt;, chemfiles::File::Mode, \nchemfiles::File::Compression)&gt;) in libchemfiles.a(FormatFactory.cpp.o)\n      chemfiles::Frame::guess_bonds()     in \nlibchemfiles.a(Frame.cpp.o)\n      chemfiles::FormatInfo::FormatInfo(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;) in \nlibchemfiles.a(CSSR.cpp.o)\n      chemfiles::FormatInfo::FormatInfo(std::__1::basic_string&lt;char, \nstd::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;) in \nlibchemfiles.a(MMTF.cpp.o)\n      chemfiles::MOL2Format::read(chemfiles::Frame&amp;) in \nlibchemfiles.a(MOL2.cpp.o)\n      ...\n</code></pre>\n"}, {"tags": ["c++", "templates", "visual-c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1538597209, "post_id": 52634830, "comment_id": 92203037, "body": "Can you post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> here?  There is a lot of unneeded code in your link and it doesn&#39;t include your <code>SomeClass</code>."}, {"owner": {"reputation": 659, "user_id": 5229875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWrD6.png?s=128&g=1", "display_name": "MivVG", "link": "https://stackoverflow.com/users/5229875/mivvg"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538597283, "post_id": 52634830, "comment_id": 92203067, "body": "Yes, sure. Forgot about that."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1538597420, "post_id": 52634830, "comment_id": 92203133, "body": "@MivVG <i>Is this a bug in MSVC?</i> -- Version?  Updates and service packs applied?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538597905, "post_id": 52634830, "comment_id": 92203337, "body": "@MivVG Can you add an example where the code does not work?"}, {"owner": {"reputation": 659, "user_id": 5229875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWrD6.png?s=128&g=1", "display_name": "MivVG", "link": "https://stackoverflow.com/users/5229875/mivvg"}, "edited": false, "score": 0, "creation_date": 1538598201, "post_id": 52634830, "comment_id": 92203468, "body": "I&#39;m trying, but I can&#39;t seem to find anything, which makes it extra weird. I am 100% sure the code worked before adding the math to that typedef"}], "answers": [{"tags": [], "owner": {"reputation": 659, "user_id": 5229875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWrD6.png?s=128&g=1", "display_name": "MivVG", "link": "https://stackoverflow.com/users/5229875/mivvg"}, "is_accepted": true, "score": 0, "last_activity_date": 1538673301, "creation_date": 1538673301, "answer_id": 52652212, "question_id": 52634830, "link": "https://stackoverflow.com/questions/52634830/msvc-fails-to-do-math-dependent-on-template-parameters-is-this-a-bug/52652212#52652212", "title": "MSVC fails to do math dependent on template parameters, is this a bug?", "body": "<p>After some more work, I finally spotted what was wrong. First I managed to replicate the error on gcc <a href=\"https://coliru.stacked-crooked.com/a/094b94b7fb509e1d\" rel=\"nofollow noreferrer\">here</a>. When starting to think more about this, I finally discovered it. In <code>clamped_value</code>, there is a macro:</p>\n\n<pre><code>#define GEN_ARITHMETIC_OP(op) \\\ntemplate&lt;typename Ty, Ty TMin, Ty TMax, typename U, U UMin, U UMax&gt; \\\nfriend constexpr detail::common_clamped_value_t&lt;Ty, TMin, TMax, U, UMin, UMax&gt; \\\noperator op(clamped_value&lt;Ty, TMin, TMax&gt; const&amp; lhs, clamped_value&lt;U, UMin, UMax&gt; const&amp; rhs) \\\n{ \\\n    auto val = detail::common_clamped_value_t&lt;Ty, TMin, TMax, U, UMin, UMax&gt;(lhs.m_value op rhs.m_value); \\\n    val.clamp(); \\\n    return val; \\\n}\n</code></pre>\n\n<p>Now, the problem here is that the first <code>clamped_value</code> is templated, and thus works for all <code>clamped_value</code>'s. So if I instantiate only one <code>clamped_value</code>, everything works. But from the moment I use a new set of template parameters, the macro gets expanded <em>again</em>, and the operator is defined twice. A simple fix was to change the macro definition to only work for the currently instantiated type:</p>\n\n<pre><code>#define GEN_ARITHMETIC_OP(op) \\\ntemplate&lt;typename U, U UMin, U UMax&gt; \\\nfriend constexpr detail::common_clamped_value_t&lt;T, Min, Max, U, UMin, UMax&gt; \\\noperator op(clamped_value const&amp; lhs, clamped_value&lt;U, UMin, UMax&gt; const&amp; rhs) \\\n{ \\\n    auto val = detail::common_clamped_value_t&lt;T, Min, Max, U, UMin, UMax&gt;(lhs.m_value op rhs.m_value); \\\n    val.clamp(); \\\n    return val; \\\n}\n</code></pre>\n"}], "owner": {"reputation": 659, "user_id": 5229875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWrD6.png?s=128&g=1", "display_name": "MivVG", "link": "https://stackoverflow.com/users/5229875/mivvg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52652212, "answer_count": 1, "score": 0, "last_activity_date": 1538673301, "creation_date": 1538596929, "last_edit_date": 1538670908, "question_id": 52634830, "link": "https://stackoverflow.com/questions/52634830/msvc-fails-to-do-math-dependent-on-template-parameters-is-this-a-bug", "title": "MSVC fails to do math dependent on template parameters, is this a bug?", "body": "<p>I couldn't find a very fitting title for this question without making it too long, so that's why it may not be very accurate. I have a class <code>clamped_value</code>, which stores a value and makes sure the value stays within a compile-time known bound. Now I'm using this class like this:</p>\n\n<pre><code>class SomeClass\n{\n    using value_type = int;\n    using percent_type = clamped_value&lt;value_type, 0, 100&gt;;\n};\n</code></pre>\n\n<p>This all works fine, and I proceeded to add a <code>Precision</code> template parameter to <code>SomeClass</code></p>\n\n<pre><code>template&lt;int Precision&gt;\nclass SomeClass\n{\n    using value_type = int;\n    using percent_type = clamped_value&lt;value_type, 0, 100 * (Precision + 1)&gt;;\n};\n</code></pre>\n\n<p>Suddenly the code breaks! Giving lots of errors about functions in <code>clamped_value.hpp</code> already being defined (I am sure the header guards are correct there). I decided to test the code using Gcc (<a href=\"https://coliru.stacked-crooked.com/a/87af127e1d4d2485\" rel=\"nofollow noreferrer\">see coliru example here</a>), and it worked just fine. Compiling with Clang also worked. Is this a bug in MSVC?</p>\n\n<p>MSVC Version is 15.7.2. </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I created a small example to model what I'm doing, and the problem is gone:</p>\n\n<pre><code>template&lt;class T, int N, int M&gt;\nclass clamped_value\n{\npublic:\n#define GEN_F(f) void f() {}\n\n    GEN_F(a)\n    GEN_F(b)\n};\n\ntemplate&lt;int N = 0&gt;\nclass SomeClass\n{\n    using percent_type = clamped_value&lt;int, 0, 100 * N&gt;;\n\npublic:\n    SomeClass()\n    {\n        percent_type p;\n        p.a();\n    }\n};\n\n\n\nint main()\n{\n    SomeClass&lt;&gt; a;\n}\n</code></pre>\n\n<p>Extra coliru link: <a href=\"https://coliru.stacked-crooked.com/a/a2d612a292e72198\" rel=\"nofollow noreferrer\">https://coliru.stacked-crooked.com/a/a2d612a292e72198</a></p>\n\n<p>New update: updating VS to latest version did not fix the issue. Making a better MCVE now.</p>\n"}, {"tags": ["c++", "linux", "codelite"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538599444, "post_id": 52634799, "comment_id": 92204031, "body": "Note how Log.cpp is not being built. The search for answers starts there. I don&#39;t know this tool at all so I can&#39;t help."}], "owner": {"reputation": 303, "user_id": 10453217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0de0e92d957580987f34a4269ff692c?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Le&#227;o", "link": "https://stackoverflow.com/users/10453217/matheus-le%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1538596765, "creation_date": 1538596765, "question_id": 52634799, "link": "https://stackoverflow.com/questions/52634799/codelite-linker-undefined-reference-error", "title": "Codelite linker undefined reference error", "body": "<p>I'm new to codelite and c++. I'm using Linux and the g++ compiler. I've set up a simple project with two source files just to play around with linker errors. The files look like so:</p>\n\n<p>Main.cpp:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid Log(const char*);\n\nstatic int Multiply (int a, int b)\n{\n    Log(\"Multiply\");\n    return a * b;\n}\n\nint main()\n{\n    std::cout &lt;&lt; Multiply(5, 8) &lt;&lt; std::endl;\n    std::cin.get();\n}\n</code></pre>\n\n<p>Log.cpp:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid Log(const char* message)\n{\n    std::cout &lt;&lt; message &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>As you can see, Log.cpp simply specifies a function called in main. Both files are in the same directory, \"src\". So far all my settings are pretty much default, still I get an \"undefined reference to `Log(...\" error when I try to build this project.</p>\n\n<p>Also, if I comment out the declaration of the Log function at the top of main.cpp, I would expect a compilation error since an undeclared function being called. Yet if I try to compile main.cpp I get no errors.</p>\n\n<p><a href=\"https://i.stack.imgur.com/e9LYW.png\" rel=\"nofollow noreferrer\">This is what my workspace looks like</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/l0Qh1.png\" rel=\"nofollow noreferrer\">Project settings</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/VZJVF.png\" rel=\"nofollow noreferrer\">Compiler settings</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/TGXuz.png\" rel=\"nofollow noreferrer\">Linker settings</a></p>\n\n<p>Am I correct to expect the behaviors described above? Is there some setting I have to manually configure?</p>\n"}, {"tags": ["c++", "visual-studio-2010", "64-bit", "atl", "windows-10-iot-enterprise"], "comments": [{"owner": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1538596834, "post_id": 52634678, "comment_id": 92202855, "body": "Perhaps C:\\windows\\system32\\regsvr32.exe is for 32-bit DLL&#39;s only. On my Win7 PC, there is also a regsvr32.exe in C:\\Windows\\SysWOW64."}, {"owner": {"reputation": 78, "user_id": 6655958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff92ffc7a8253ff94889c7800fed749?s=128&d=identicon&r=PG&f=1", "display_name": "TylerE", "link": "https://stackoverflow.com/users/6655958/tylere"}, "reply_to_user": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1538597099, "post_id": 52634678, "comment_id": 92202982, "body": "It is confusing, but I am confident that the regsvr32 in system32 is for 64-bit applications and the one in syswow64 is for 32-bit applications based on other stackoverflow questions I&#39;ve looked at."}, {"owner": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1538598644, "post_id": 52634678, "comment_id": 92203676, "body": "To register a control, regsvr32.exe uses LoadLibrary to load your DLL, calls GetProcAddress to get the address of the DLL&#39;s DllRegisterServer function and then calls it. It is up to the DLL&#39;s implementation of DllRegisterServer to properly register itself. If Dependencies shows that your DLL has the function DllRegisterServer with no other characters, then perhaps your DLL&#39;s implementation of that function is incorrect."}, {"owner": {"reputation": 78, "user_id": 6655958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff92ffc7a8253ff94889c7800fed749?s=128&d=identicon&r=PG&f=1", "display_name": "TylerE", "link": "https://stackoverflow.com/users/6655958/tylere"}, "reply_to_user": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1538598965, "post_id": 52634678, "comment_id": 92203818, "body": "I&#39;ll will look into that, but the exact same code compiled against the Win32 platform in VS 2010 and registered on a 32-bit machine works correctly. Because of that, it makes me think that something is missing on the 64-bit destination machine."}, {"owner": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1538599248, "post_id": 52634678, "comment_id": 92203947, "body": "I use depends.exe to check dependencies. If anything is missing it highlights it. Does Dependencies do the same thing? Are you using a .def file when you build the DLL?"}, {"owner": {"reputation": 78, "user_id": 6655958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff92ffc7a8253ff94889c7800fed749?s=128&d=identicon&r=PG&f=1", "display_name": "TylerE", "link": "https://stackoverflow.com/users/6655958/tylere"}, "reply_to_user": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1538599769, "post_id": 52634678, "comment_id": 92204161, "body": "Thanks for your help, I got it working, see below. Dependencies is a rewrite of depends.exe that works for 64-bit file. See <a href=\"https://github.com/lucasg/Dependencies\" rel=\"nofollow noreferrer\">github.com/lucasg/Dependencies</a> for the program."}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 6655958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff92ffc7a8253ff94889c7800fed749?s=128&d=identicon&r=PG&f=1", "display_name": "TylerE", "link": "https://stackoverflow.com/users/6655958/tylere"}, "is_accepted": true, "score": 2, "last_activity_date": 1538599684, "creation_date": 1538599684, "answer_id": 52635460, "question_id": 52634678, "link": "https://stackoverflow.com/questions/52634678/registering-c-dll-on-64-bit-machine/52635460#52635460", "title": "Registering C++ DLL on 64-bit machine", "body": "<p>I figured it out. I had to uninstall the 64-bit and 32-bit VS 2010 redist . Delete the ATL100.dll out of the C:\\windows\\system32 and syswow64 directories and reboot the computer. After the reboot I reinstalled both redist installers. Then I was able to register the file from an administrative command prompt.</p>\n\n<p>Maybe something we installed installed the ATL100.dll file and when I installed the 64-bit redist it did not overwrite the ATL100.dll. Leaving a outdated version installed.</p>\n"}], "owner": {"reputation": 78, "user_id": 6655958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff92ffc7a8253ff94889c7800fed749?s=128&d=identicon&r=PG&f=1", "display_name": "TylerE", "link": "https://stackoverflow.com/users/6655958/tylere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1446, "favorite_count": 0, "accepted_answer_id": 52635460, "answer_count": 1, "score": 1, "last_activity_date": 1538599684, "creation_date": 1538596214, "last_edit_date": 1538599328, "question_id": 52634678, "link": "https://stackoverflow.com/questions/52634678/registering-c-dll-on-64-bit-machine", "title": "Registering C++ DLL on 64-bit machine", "body": "<p>I have a C++ DLL that I wrote that is failing to register on a 64-bit machine. Note the 32-bit version of the DLL registers on a 32-bit machine. </p>\n\n<p>We build the DLL on a 64-bit Windows 7 computer using Visual Studio 2010 in Release mode and target the x64 platform. I want to install the DLL on a 64-bit Windows 10 computer (destination). The destination computer has the VS 2010 redist installed for 64-bit. When I try to register the program using:</p>\n\n<p>C:\\windows\\system32\\regsvr32.exe </p>\n\n<p>It fails and says that the program \"may not be compatible with this version of Windows that you're running. Check if the module is compatible with an x86 (32-bit) or x64 (64-bit) version of regsvr32.exe\".</p>\n\n<p>I use the program called Dependencies that tries to figure out what dependencies the DLL requires. Dependencies says that my DLL requires ATL100.dll. However, this is installed by the VS 2010 redist and is indeed located in C:\\windows\\system32. The DLL itself does not depend on any third-party programs.</p>\n\n<p>Does anyone have any ideas to what to look for next to get this file registered? </p>\n"}, {"tags": ["c++", "module", "clang"], "comments": [{"owner": {"reputation": 78, "user_id": 5254135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1004cf058fb115648e858d4df7e4e8c?s=128&d=identicon&r=PG&f=1", "display_name": "zMesh", "link": "https://stackoverflow.com/users/5254135/zmesh"}, "edited": false, "score": 0, "creation_date": 1538596864, "post_id": 52634661, "comment_id": 92202868, "body": "This was already <a href=\"https://stackoverflow.com/questions/49683282/how-to-use-standard-library-with-c-modules-eg-import-std-io\">answered</a> a while back"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1538597616, "post_id": 52634661, "comment_id": 92203225, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49683282/how-to-use-standard-library-with-c-modules-eg-import-std-io\">how to use standard library with C++ modules? (eg: `import std.io`)</a>"}, {"owner": {"reputation": 446, "user_id": 10050942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/896d0e87b08f04037bec7a1b3818b932?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Stephens", "link": "https://stackoverflow.com/users/10050942/daniel-stephens"}, "edited": false, "score": 0, "creation_date": 1538601205, "post_id": 52634661, "comment_id": 92204744, "body": "The posts relate to the fact that std.io is not supported. In my case I can&#39;t get it to work with any module. As far as I understand their documentation it means <code>#include &lt;iostream&gt;</code> becomes <code>import iostream;</code> which doesn&#39;t work either"}], "owner": {"reputation": 446, "user_id": 10050942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/896d0e87b08f04037bec7a1b3818b932?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Stephens", "link": "https://stackoverflow.com/users/10050942/daniel-stephens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538596802, "creation_date": 1538596109, "last_edit_date": 1538596802, "question_id": 52634661, "link": "https://stackoverflow.com/questions/52634661/import-keywords-are-not-recognized-by-clang-with-modules", "title": "import keywords are not recognized by clang with modules", "body": "<p>I am trying to bring a simple Hello World example with modules to work. Can anyone help me what I a missing here? Clang doesn't seem to recognize the corresponding import keywords</p>\n\n<pre><code>clang++ -fmodules -std=c++17 -fbuiltin-module-map\n</code></pre>\n\n<p>Any idea is highly appreciated:</p>\n\n<pre><code>#include &lt;iostream&gt;\nimport std;\nint main()\n{\n    std::cout &lt;&lt; \"Hello World\\n\";\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/z/c1ejGC\" rel=\"nofollow noreferrer\">https://gcc.godbolt.org/z/c1ejGC</a></p>\n\n<pre><code>error: unknown type name 'import'\n</code></pre>\n\n<p>To be on the safe side, I tried this on the trunk version of clang</p>\n\n<pre><code>clang version 8.0.0 (trunk 343649)\nTarget: x86_64-unknown-linux-gnu\n</code></pre>\n"}, {"tags": ["c++", "c++11", "lambda"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1538595552, "post_id": 52634490, "comment_id": 92202283, "body": "What do you want to do? I cannot understand what you are trying to accomplish in this code. Why are you using a lambda if the function you are trying to call takes an integer?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1538595609, "post_id": 52634490, "comment_id": 92202316, "body": "<code>A instance = new A();</code> is not valid C++ code"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1538596984, "post_id": 52634490, "comment_id": 92202923, "body": "The error is telling you that the function <code>A::f</code> expects to be passed an <code>int</code>, but you are instead passing it a <i>lambda</i>, which can not be converted to an <code>int</code>."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1538654846, "post_id": 52634490, "comment_id": 92224505, "body": "@UnholySheep who knows, maybe there&#39;s a <code>#define A() A*</code> lurking somewhere..."}], "answers": [{"tags": [], "owner": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "is_accepted": false, "score": 0, "last_activity_date": 1538648646, "creation_date": 1538648646, "answer_id": 52644381, "question_id": 52634490, "link": "https://stackoverflow.com/questions/52634490/parameter-list-type-error-in-lambda-function/52644381#52644381", "title": "parameter list type error in lambda function", "body": "<p>A lambda is really just a compact way of writing a function.</p>\n\n<p>The lambda in question:</p>\n\n<pre><code>[&amp;](int input) -&gt; int\n{\n    int x = 2;\n    return x;\n};\n</code></pre>\n\n<p>is a unnamed function, taking one <code>int</code> parameter (that it does not use)\nand returning <code>int</code>. It also capture its context with reference semantics,\nsomething it also does not make use of.</p>\n\n<p>If you want to use a lambda in conjunction with a function that expects\nan <code>int</code>, you need to <em>call</em> the lambda, maybe like this:</p>\n\n<pre><code>class A\n{\npublic:\n    void f(int a){\n        _a = a;\n    }\nprivate:\n    int _a;\n};\n\nclass B\n{\npublic:\n    B()\n    {\n        A instance; // = new A(); &lt;- not C++\n\n        auto mylambda = \n            [](int input) -&gt; int\n            {\n                int x = 2;\n                return x;\n            };\n\n        instance.f( mylambda(3) );\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10330584, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k62JP2pqZPQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPbD7rWFGLmtWCHYQoUYGiFCTc1vg/mo/photo.jpg?sz=128", "display_name": "Ben", "link": "https://stackoverflow.com/users/10330584/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1538648646, "creation_date": 1538595440, "question_id": 52634490, "link": "https://stackoverflow.com/questions/52634490/parameter-list-type-error-in-lambda-function", "title": "parameter list type error in lambda function", "body": "<p>I'm not very familiar with lambda expressions C++11. I was trying to simply invoke a method from another class taking an integer and constructing a lambda expression but I'm receiving an error about the parameter not being the correct datatype.</p>\n\n<pre><code>class A{\n\n  int _a;\n  void f(int a){\n    _a = a;\n  }\n\n};\n\nclass B{\n\n  B(){\n\n    A instance = new A();\n\n    instance.f(\n    [&amp;](int input)-&gt;int\n    {\n      int x = 2;\n      return x;\n     });\n\n  };\n\n}\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "performance"], "comments": [{"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1538595604, "post_id": 52634460, "comment_id": 92202315, "body": "If the arrays are sorted, why not merge them and skip identical values immediately while merging, instead of filtering them out afterwards?"}, {"owner": {"reputation": 117, "user_id": 3134575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344201b0178b9f5053c13f1d317d04de?s=128&d=identicon&r=PG&f=1", "display_name": "user3134575", "link": "https://stackoverflow.com/users/3134575/user3134575"}, "reply_to_user": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1538595808, "post_id": 52634460, "comment_id": 92202405, "body": "Can we merge them and keep the union sorted? I fail to think about that. Could you please elaborate more? thanks"}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 1, "creation_date": 1538595970, "post_id": 52634460, "comment_id": 92202481, "body": "Use a read index in each array; always take the smallest of the three elements first; skip any duplicates..."}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1538602784, "post_id": 52634460, "comment_id": 92205289, "body": "Additional data structures add some overhead. I&#39;d guess that std::sort is able to take advantage of the fact that the array is already partially sorted. In contrast, inserting into a set in order might lead to an inbalanced tree that needs frequent re-balancing."}], "answers": [{"comments": [{"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 1, "creation_date": 1538596075, "post_id": 52634633, "comment_id": 92202533, "body": "You&#39;re not skipping duplicates."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 2, "creation_date": 1538596167, "post_id": 52634633, "comment_id": 92202563, "body": "It&#39;s not exactly &quot;easy.&quot; Finding the least to merge next among n lists is O(n) unless you use a heap/priority queue."}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "reply_to_user": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 1, "creation_date": 1538596255, "post_id": 52634633, "comment_id": 92202602, "body": "@m69 fixed. So much for an if statement."}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "reply_to_user": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1538596852, "post_id": 52634633, "comment_id": 92202864, "body": "@Gene haven&#39;t dealt with heap/priority queues for years of programming and I&#39;m not dead. consider looking at the updated answer."}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 1, "creation_date": 1538597330, "post_id": 52634633, "comment_id": 92203087, "body": "This is just a special case of the &quot;external&quot; variant of merge sort btw.: <a href=\"https://en.wikipedia.org/wiki/Merge_sort#Use_with_tape_drives\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Merge_sort#Use_with_tape_drives</a>"}, {"owner": {"reputation": 117, "user_id": 3134575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344201b0178b9f5053c13f1d317d04de?s=128&d=identicon&r=PG&f=1", "display_name": "user3134575", "link": "https://stackoverflow.com/users/3134575/user3134575"}, "edited": false, "score": 0, "creation_date": 1538597709, "post_id": 52634633, "comment_id": 92203263, "body": "@AlexG Thanks a lot for your answer. I tested your code and it is faster than my method2. However, it is still twice slower than method1 !!! I cann&#39;t figure out why! Could it be because there is some costy hidden operation in your code?. I&#39;ll double check again if I have done the benchmark right."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538597992, "post_id": 52634633, "comment_id": 92203379, "body": "Why not to use <code>std::merge()</code> ?"}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 2, "creation_date": 1538598200, "post_id": 52634633, "comment_id": 92203467, "body": "The difference might stem from additional allocations as the result vector grows. Perhaps use reserve() to avoid this?"}, {"owner": {"reputation": 117, "user_id": 3134575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344201b0178b9f5053c13f1d317d04de?s=128&d=identicon&r=PG&f=1", "display_name": "user3134575", "link": "https://stackoverflow.com/users/3134575/user3134575"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538598268, "post_id": 52634633, "comment_id": 92203507, "body": "@Slava std::merge() is only for 2 vectors! I don&#39;t know if it can be more performant to merge many vector pairs."}, {"owner": {"reputation": 117, "user_id": 3134575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344201b0178b9f5053c13f1d317d04de?s=128&d=identicon&r=PG&f=1", "display_name": "user3134575", "link": "https://stackoverflow.com/users/3134575/user3134575"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1538598985, "post_id": 52634633, "comment_id": 92203829, "body": "@StefanHaustein if I use reserve() in both cases method1 still seems to be faster twice on my machine!"}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 1, "creation_date": 1538600153, "post_id": 52634633, "comment_id": 92204316, "body": "I&#39;d use larger test vectors. For small sizes, some random overhead might dominate the results."}, {"owner": {"reputation": 117, "user_id": 3134575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344201b0178b9f5053c13f1d317d04de?s=128&d=identicon&r=PG&f=1", "display_name": "user3134575", "link": "https://stackoverflow.com/users/3134575/user3134575"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1538602261, "post_id": 52634633, "comment_id": 92205102, "body": "@StefanHaustein indeed the vector sizes did matter. I noticed that for vector sizes &lt;100 the naive method1 is much faster than this answer. However, for vector size &gt;100 they seem to converge to the same speed."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1538623802, "post_id": 52634633, "comment_id": 92209867, "body": "Your method of finding the iterator with the smallest item is O(k), where <code>k</code> is the number of iterators. Using a priority queue, it will be O(log k). That reduces the complexity of the merge from O(n * k) to O(n * log(k)). When I benchmarked this a few years back, the difference in running time with just 4 lists was almost 50% (i.e. the priority queue version took just a little more than half the time required by the sequential version). With 10 lists, the difference is huge. And with <a href=\"https://en.cppreference.com/w/cpp/container/priority_queue\" rel=\"nofollow noreferrer\">stl::priority_queue</a>, it&#39;s easy to implement."}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1538740787, "post_id": 52634633, "comment_id": 92259994, "body": "@JimMischel thanks for the tip, I updated my answer. Is there any queue variant that &#39;pops&#39; the object by returning it instead of having to copy from top(), then doing pop() ?"}], "tags": [], "owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "is_accepted": true, "score": 3, "last_activity_date": 1538740708, "last_edit_date": 1538740708, "creation_date": 1538596001, "answer_id": 52634633, "question_id": 52634460, "link": "https://stackoverflow.com/questions/52634460/efficient-union-of-n-sorted-arrays-in-c-set-vs-vector/52634633#52634633", "title": "efficient union of n sorted arrays in C++ (set vs vector)?", "body": "<p>Here's how it's done with 2 vectors. You can easily generalize the process to N vectors.</p>\n\n<pre><code>vector&lt;int&gt; v1{ 4, 8, 12, 16 };\nvector&lt;int&gt; v2{ 2, 6, 10, 14 };\n\nvector&lt;int&gt; merged;\nmerged.reserve(v1.size() + v2.size());\n\n// An iterator on each vector\nauto it1 = v1.begin();\nauto it2 = v2.begin();\n\nwhile (it1 != v1.end() &amp;&amp; it2 != v2.end())\n    {\n    // Find the iterator that points to the smallest number.\n    // Grab the value.\n    // Advance the iterator, and repeat.\n\n    if (*it1 &lt; *it2)\n        {\n        if (merged.empty() || merged.back() &lt; *it1)\n            merged.push_back(*it1);\n        ++it1;\n        }\n    else\n        {\n        if (merged.empty() || merged.back() &lt; *it2)\n            merged.push_back(*it2);\n        ++it2;\n        }\n    }\n\nwhile(it1 != v1.end())\n    {\n    merged.push_back(*it1);\n    ++it1;\n    }\n\nwhile (it2 != v2.end())\n    {\n    merged.push_back(*it2);\n    ++it2;\n    }\n\n// if you print out the values in 'merged', it gives the expected result\n[2, 4, 6, 8, 10, 12, 14, 16]\n</code></pre>\n\n<p>...And you can generalize with the following. Note that a helper struct containing both the 'current' iterator and the end iterator would cleaner, but the idea remains the same.</p>\n\n<pre><code>vector&lt;int&gt; v1{ 4, 8, 12, 16 };\nvector&lt;int&gt; v2{ 2, 6, 10, 14 };\nvector&lt;int&gt; v3{ 3, 7, 11, 15 };\nvector&lt;int&gt; v4{ 0, 21};\n\nvector&lt;int&gt; merged;\n// reserve space accordingly...\n\nusing vectorIt = vector&lt;int&gt;::const_iterator;\n\nvector&lt;vectorIt&gt; fwdIterators;\nfwdIterators.push_back(v1.begin());\nfwdIterators.push_back(v2.begin());\nfwdIterators.push_back(v3.begin());\nfwdIterators.push_back(v4.begin());\nvector&lt;vectorIt&gt; endIterators;\nendIterators.push_back(v1.end());\nendIterators.push_back(v2.end());\nendIterators.push_back(v3.end());\nendIterators.push_back(v4.end());\n\nwhile (!fwdIterators.empty())\n    {\n    // Find out which iterator carries the smallest value\n    size_t index = 0;\n    for (size_t i = 1; i &lt; fwdIterators.size(); ++i)\n        {\n        if (*fwdIterators[i] &lt; *fwdIterators[index])\n            index = i;\n        }\n\n    if (merged.empty() || merged.back() &lt; *fwdIterators[index])\n        merged.push_back(*fwdIterators[index]);\n\n    ++fwdIterators[index];\n    if (fwdIterators[index] == endIterators[index])\n        {\n        fwdIterators.erase(fwdIterators.begin() + index);\n        endIterators.erase(endIterators.begin() + index);\n        }\n    }\n\n// again, merged contains the expected result\n[0, 2, 3, 4, 6, 7, 8, 10, 11, 12, 14, 15, 16, 21]\n</code></pre>\n\n<p>...And as some pointed out, using a heap would be even faster</p>\n\n<pre><code>// Helper struct to make it more convenient\nstruct Entry\n{\nvector&lt;int&gt;::const_iterator fwdIt;\nvector&lt;int&gt;::const_iterator endIt;\n\nEntry(vector&lt;int&gt; const&amp; v) : fwdIt(v.begin()), endIt(v.end()) {}\nbool IsAlive() const { return fwdIt != endIt; }\nbool operator&lt; (Entry const&amp; rhs) const { return *fwdIt &gt; *rhs.fwdIt; }\n};\n\n\nint main()\n{\nvector&lt;int&gt; v1{ 4, 8, 12, 16 };\nvector&lt;int&gt; v2{ 2, 6, 10, 14 };\nvector&lt;int&gt; v3{ 3, 7, 11, 15 };\nvector&lt;int&gt; v4{ 0, 21};\n\nvector&lt;int&gt; merged;\nmerged.reserve(v1.size() + v2.size() + v3.size() + v4.size());\n\nstd::priority_queue&lt;Entry&gt; queue;\nqueue.push(Entry(v1));\nqueue.push(Entry(v2));\nqueue.push(Entry(v3));\nqueue.push(Entry(v4));\n\nwhile (!queue.empty())\n    {\n    Entry tmp = queue.top();\n    queue.pop();\n\n    if (merged.empty() || merged.back() &lt; *tmp.fwdIt)\n        merged.push_back(*tmp.fwdIt);\n\n    tmp.fwdIt++;\n\n    if (tmp.IsAlive())\n        queue.push(tmp);\n    }\n</code></pre>\n\n<p>It does seem like a lot of copying of the 'Entry' object though, maybe a pointer to an entry with a proper comparison function would have been better for the <i>std::priority_queue</i>.</p>\n"}, {"tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": false, "score": 3, "last_activity_date": 1538600979, "creation_date": 1538600979, "answer_id": 52635738, "question_id": 52634460, "link": "https://stackoverflow.com/questions/52634460/efficient-union-of-n-sorted-arrays-in-c-set-vs-vector/52635738#52635738", "title": "efficient union of n sorted arrays in C++ (set vs vector)?", "body": "<p>The usual way to merge many queues is to put the queues in a min heap based on the value of their first elements.  The you repeatedly pull an item from the queue on the top of the heap and then push it down to restore the heap property.</p>\n\n<p>This merges a total of N items K queues in O(N log K) time.</p>\n\n<p>Since you are merging <code>vector&lt;int&gt;</code>, your queues could be either <code>tuple&lt;int, vector *&gt;</code> (current position and vector) or <code>tuple&lt;vector::const_iterator, vector::const_iterator&gt;</code> (current position and end)</p>\n"}], "owner": {"reputation": 117, "user_id": 3134575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344201b0178b9f5053c13f1d317d04de?s=128&d=identicon&r=PG&f=1", "display_name": "user3134575", "link": "https://stackoverflow.com/users/3134575/user3134575"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 52634633, "answer_count": 2, "score": 1, "last_activity_date": 1538740708, "creation_date": 1538595328, "question_id": 52634460, "link": "https://stackoverflow.com/questions/52634460/efficient-union-of-n-sorted-arrays-in-c-set-vs-vector", "title": "efficient union of n sorted arrays in C++ (set vs vector)?", "body": "<p>I need to implement an efficient algorithm for finding a sorted union from several sorted arrays. Since my program does a lot of these kinds of operation, I simulated it with C++. My first approach (method1) was to simply create an empty vector and append every element in the other vectors to the empty vector then use std::sort and std::unique to obtain the wanted sorted union of all the elements. However, I thought it might be more efficient to dump all the vector elements into a set (method2) because sets will already make them unique and sorted in one go. To my surprise method1 was 5 times faster than method2! Am I doing something wrong here? shouldn't method2 be faster because it does less computations? Thanks in advance</p>\n\n<p>//// method1 with vectors:</p>\n\n<pre><code>std::vector&lt;long&gt; arr1{5,12,32,33,34,50};\nstd::vector&lt;long&gt; arr2{1,2,3,4,5};\nstd::vector&lt;long&gt; arr3{1,8,9,11};\n\nstd::vector&lt;long&gt; arr;\n\nint main(int argc, const char * argv[]) {\n\ndouble sec;\nclock_t t;\nt=clock();\nfor(long j=0; j&lt;1000000; j++){ // repeating for benchmark\n    arr.clear();\n    for(long i=0; i&lt;arr1.size(); i++){\n        arr.push_back(arr1[i]);\n    }\n    for(long i=0; i&lt;arr2.size(); i++){\n        arr.push_back(arr2[i]);\n    }\n    for(long i=0; i&lt;arr3.size(); i++){\n        arr.push_back(arr3[i]);\n    }\n    std::sort(arr.begin(), arr.end());\n    auto last = std::unique(arr.begin(), arr.end());\n    arr.erase(last, arr.end());\n}\nt=clock() - t;\nsec = (double)t/CLOCKS_PER_SEC;\nstd::cout&lt;&lt;\"seconds = \"&lt;&lt; sec &lt;&lt;\" clicks = \" &lt;&lt; t &lt;&lt; std::endl;\n\nreturn 0;\n}\n</code></pre>\n\n<p>//// method2 with sets:</p>\n\n<pre><code>std::vector&lt;long&gt; arr1{5,12,32,33,34,50};\nstd::vector&lt;long&gt; arr2{1,2,3,4,5};\nstd::vector&lt;long&gt; arr3{1,8,9,11};\n\nstd::set&lt;long&gt; arr;\n\nint main(int argc, const char * argv[]) {\n\ndouble sec;\nclock_t t;\nt=clock();\nfor(long j=0; j&lt;1000000; j++){ //repeating for benchmark\n    arr.clear();\n    arr.insert(arr1.begin(), arr1.end());\n    arr.insert(arr2.begin(), arr2.end());\n    arr.insert(arr3.begin(), arr3.end());\n}\nt=clock() - t;\nsec = (double)t/CLOCKS_PER_SEC;\nstd::cout&lt;&lt;\"seconds = \"&lt;&lt; sec &lt;&lt;\" clicks = \" &lt;&lt; t &lt;&lt; std::endl;\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1538595564, "post_id": 52634449, "comment_id": 92202289, "body": "DDDDD looks like a pattern put by you OS (or libc) to kill the content of buffers that are not initialized or freed. If you are using Linux, you may run valgrind to help you identify the problem"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1538595579, "post_id": 52634449, "comment_id": 92202298, "body": "i suggest you use your debugger to look at the tree you built and verify that all looks good. If you have multiple left or right pointers pointing at the same node then bad things will happen"}, {"owner": {"reputation": 435647, "user_id": 367273, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f1ed2b0c87f602ef30229f5c4b04eff6?s=128&d=identicon&r=PG", "display_name": "NPE", "link": "https://stackoverflow.com/users/367273/npe"}, "edited": false, "score": 0, "creation_date": 1538595601, "post_id": 52634449, "comment_id": 92202311, "body": "Do you ever call <code>deleteNodes</code> other than from the destructor? It keeps dangling pointers around, which isn&#39;t a problem if it&#39;s only called from the dtor but would be a problem otherwise."}, {"owner": {"reputation": 243, "user_id": 10269402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ru7C0.png?s=128&g=1", "display_name": "Paolo Irrera", "link": "https://stackoverflow.com/users/10269402/paolo-irrera"}, "edited": false, "score": 0, "creation_date": 1538597092, "post_id": 52634449, "comment_id": 92202974, "body": "Could you provide an example of the function that is using the Node object?"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1538598800, "post_id": 52634610, "comment_id": 92203752, "body": "This should be a comment, not an answer."}, {"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1538637468, "post_id": 52634610, "comment_id": 92214547, "body": "A general guide to fixing these kind of problems should reach a much wider audience than the OPs specific bug. The OP seems to like it."}], "tags": [], "owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "is_accepted": true, "score": 0, "last_activity_date": 1538595921, "creation_date": 1538595921, "answer_id": 52634610, "question_id": 52634449, "link": "https://stackoverflow.com/questions/52634449/exception-thrown-read-access-violation-node-was-0xdddddddd-occurred/52634610#52634610", "title": "Exception thrown: read access violation. **node** was 0xDDDDDDDD. occurred", "body": "<p>To find the line of code with the problem. Debug the code in visual studio. Tge debugger will stop when it detects the cradh. You can the use debugger to generate a callstack of where your code was when the error occurred.</p>\n\n<p>I suspect in this case, you are accessing a pointer to already deleted memory. The debug heap is being helpful an setting the deleted memory to 0xdd. </p>\n"}, {"tags": [], "owner": {"reputation": 243, "user_id": 10269402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ru7C0.png?s=128&g=1", "display_name": "Paolo Irrera", "link": "https://stackoverflow.com/users/10269402/paolo-irrera"}, "is_accepted": false, "score": 0, "last_activity_date": 1538597535, "creation_date": 1538597535, "answer_id": 52634972, "question_id": 52634449, "link": "https://stackoverflow.com/questions/52634449/exception-thrown-read-access-violation-node-was-0xdddddddd-occurred/52634972#52634972", "title": "Exception thrown: read access violation. **node** was 0xDDDDDDDD. occurred", "body": "<p>Your are trying to do operations on a pointer that has value equal to NULL. You may replace NULL with nullptr.</p>\n\n<p>In any case, I suggest you refactor your implementation by using C++11 smart pointers (unique pointers in the example but may be shared according to your application):</p>\n\n<pre><code>#include &lt;memory&gt;\n\nstruct Node\n{\n    int myNum;\n    std::unique_ptr&lt;&lt;node&gt; pLeftBranch;\n    std::unique_ptr&lt;&lt;node&gt; pRightBranch;\n};\n</code></pre>\n\n<p>Destructor can simply use default implementation (to be used qt declaration in header file):</p>\n\n<pre><code>~Tree() = default; \n</code></pre>\n\n<p>Node *newNode = new Node becomes:</p>\n\n<pre><code>std::unique_ptr&lt;Node&gt; pNewNode = std::make_unique&lt;Node&gt;();\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9278167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919505f4ac723584bd109ebd5d91a424?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9278167/theo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5741, "favorite_count": 1, "accepted_answer_id": 52634610, "answer_count": 2, "score": 0, "last_activity_date": 1538597535, "creation_date": 1538595268, "question_id": 52634449, "link": "https://stackoverflow.com/questions/52634449/exception-thrown-read-access-violation-node-was-0xdddddddd-occurred", "title": "Exception thrown: read access violation. **node** was 0xDDDDDDDD. occurred", "body": "<p>I have to make a binary search tree for an assignment and everything is good until I delete my tree. It could be a really simple mistake on my part, but I'm unsure how to fix it. Every time I run the program while including the code to delete the tree I get \"Exception thrown: read access violation. <strong>node</strong> was 0xDDDDDDDD. occurred.\"</p>\n\n<p>Here's the code for my trees:</p>\n\n<pre><code>Tree::Tree()\n{\n    head = NULL;\n}\n\nTree::~Tree()\n{\n    deleteNodes(head);\n}\n\nstring Tree::checkBalance()\n{\n    int lh;\n    int rh;\n\n    lh = height(head-&gt;leftBranch);\n    rh = height(head-&gt;rightBranch);\n\n    if (abs(lh - rh) &lt;= 1)\n        return \"KEEP\";\n    else\n        return \"REMOVE\";\n}\n\nint Tree::height(Node* node)\n{\n    //If tree empty\n    if (node == NULL)\n        return 0;\n\n    //If not empty, find max height\n    return 1 + max(height(node-&gt;leftBranch), height(node-&gt;rightBranch));\n}\n\nvoid Tree::addNum(int num)\n{\n    Node *newNode = new Node;\n    newNode-&gt;myNum = num;\n    newNode-&gt;leftBranch = NULL;\n    newNode-&gt;rightBranch = NULL;\n\n    if (head == NULL)\n    {\n        head = newNode;\n    }\n    else\n    {\n        Node *cursor = head;\n        bool foundSpot = false;\n\n        while (!foundSpot)\n        {\n            if (num &lt; cursor-&gt;myNum)\n            {\n                if (cursor-&gt;leftBranch != NULL)\n                    cursor = cursor-&gt;leftBranch;\n                else\n                {\n                    cursor-&gt;leftBranch = newNode;\n                    foundSpot = true;\n                }\n            }\n            else\n            {\n                if (cursor-&gt;rightBranch != NULL)\n                    cursor = cursor-&gt;rightBranch;\n                else\n                {\n                    cursor-&gt;rightBranch = newNode;\n                    foundSpot = true;\n                }\n            }\n        }\n    }\n}\n\nvoid Tree::deleteNodes(Node *node)\n{\n    if (node == NULL)\n        return;\n\n    //Deletes subtrees\n    deleteNodes(node-&gt;leftBranch);\n    deleteNodes(node-&gt;rightBranch);\n\n    //Deletes node\n    delete node;\n}\n</code></pre>\n\n<p>Any help on what'a causing this error would be appreciated. The problem code seems to be in deleteNodes(Node *node) when it tries to access deleteNodes(node->leftBranch);</p>\n\n<p>And in case there are any questions on what the node code looks like, here it is:</p>\n\n<pre><code>struct Node\n{\n    int myNum;\n    Node *leftBranch;\n    Node *rightBranch;\n};\n</code></pre>\n"}, {"tags": ["c++", "makefile", "g++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1538595216, "post_id": 52634397, "comment_id": 92202143, "body": "You are compiling a header file <code>common.h </code> - you should be compiling a .cc file. Also, names of libraries should be the last things on the compiler command line."}, {"owner": {"reputation": 343, "user_id": 6286600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87RhR.jpg?s=128&g=1", "display_name": "Taylor Nelms", "link": "https://stackoverflow.com/users/6286600/taylor-nelms"}, "edited": false, "score": 0, "creation_date": 1538595431, "post_id": 52634397, "comment_id": 92202230, "body": "Not to ask for too much guidance, @NeilButterworth, but how would I switch things around from compiling common.h into compiling common.cc?"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1538606698, "post_id": 52634397, "comment_id": 92206391, "body": "@TaylorNelms In the make file: <code>DEPS = common.h</code> This makes it compile <code>test.cc</code> and <code>common.h</code>. Compiling <code>common.h</code> is not useful (there are not definitions in there)."}], "answers": [{"tags": [], "owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "is_accepted": true, "score": 2, "last_activity_date": 1538614673, "creation_date": 1538614673, "answer_id": 52637542, "question_id": 52634397, "link": "https://stackoverflow.com/questions/52634397/g-unresolved-identifier-cannot-find-linker-error/52637542#52637542", "title": "G++ unresolved identifier, cannot find linker error", "body": "<p>First, notice that when you try to build <code>test</code>, the only files you use are <code>test.cc</code> and <code>common.h</code>. The code in <code>test.cc</code> calls the function <code>foo()</code>, but that function is not defined in either of those files; it is defined in <code>common.cc</code>, which was not invited. And if you try to fix that by adding <code>common.cc</code> or <code>common.o</code> to the recipe, you'll run into more trouble, because <code>common.cc</code> contains a definition of <code>main()</code>, and so does <code>test.cc</code>, and there can be only one.</p>\n\n<p>If you want to use <code>foo()</code> with other versions of <code>main()</code>, you should not put a <code>main()</code> in <code>common.cc</code>.</p>\n\n<p>Now for the makefile recipe:</p>\n\n<pre><code>test: test.cc $(DEPS)\n    g++ $(FLAGS) $^ -g -o $@\n</code></pre>\n\n<p>This expands to:</p>\n\n<pre><code>test: test.cc common.h\n    g++ -lpthread test.cc common.h -g -o test\n</code></pre>\n\n<p>Which is incorrect, as @NeilButterworth has pointed out. You could do this:</p>\n\n<pre><code>test: test.cc common.cc\n    g++ test.cc common.cc -lpthread -g -o test\n</code></pre>\n\n<p>which can be written as:</p>\n\n<pre><code>test: test.cc common.cc\n    g++ $^ $(FLAGS) -g -o $@\n</code></pre>\n\n<p>But that can fail to rebuild when <code>common.h</code> is changed, and when it does rebuild it can recompile a source that <em>hasn't</em> changed. A better approach is:</p>\n\n<pre><code>common.o: common.cc $(DEPS)\n    g++ -c $&lt; -g -o $@\n\ntest.o: test.cc $(DEPS)\n    g++ -c $&lt; -g -o $@\n\ncommon: common.o\n    g++ $^ $(FLAGS) -o $@\n\ntest: test.o common.o\n    g++ $^ $(FLAGS) -o $@\n</code></pre>\n\n<p>And further improvement is possible, once you have this much working.</p>\n"}], "owner": {"reputation": 343, "user_id": 6286600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87RhR.jpg?s=128&g=1", "display_name": "Taylor Nelms", "link": "https://stackoverflow.com/users/6286600/taylor-nelms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52637542, "answer_count": 1, "score": 0, "last_activity_date": 1538614673, "creation_date": 1538595001, "last_edit_date": 1592644375, "question_id": 52634397, "link": "https://stackoverflow.com/questions/52634397/g-unresolved-identifier-cannot-find-linker-error", "title": "G++ unresolved identifier, cannot find linker error", "body": "<p>I'm not sure if this is an error in my makefile, header, or source, but it looks like all the relevant pieces of code should link up nicely so I can use functions from one C++ file inside another, but I'm running into a brick wall. Here's a simplified version of what I'm working with:</p>\n<p>common.h:</p>\n<pre><code>//common.h\n#ifndef COMMON_H\n#define COMMON_H\n\nint foo();\n#endif\n</code></pre>\n<p>common.cc:</p>\n<pre><code>//common.cc\n#include &quot;common.h&quot;\n\nint main(){\n    int z = foo();\n    return 0;\n}//main\n\nint foo(){\n    int x = 5;\n    int y = 7;\n    return x + y;\n}//foo\n</code></pre>\n<p>test.cc:</p>\n<pre><code>//test.cc\n\n#include &quot;common.h&quot;\n\nint main(){\n    return foo();\n}\n</code></pre>\n<p>And the makefile (sorry, it's a bit more complex, to better reflect how my overall project is operating):</p>\n<pre><code>TARGETS = common test\nFLAGS = -lpthread\nDEPS = common.h\n\nall: $(TARGETS)\n\ncommon: common.cc $(DEPS)\n    g++ $^ $(FLAGS) -g -o $@\n\ntest: test.cc $(DEPS)\n    g++ $(FLAGS) $^ -g -o $@\n\nclean::\n    rm -fv $(TARGETS) *~\n</code></pre>\n<p>The compiler seems happy compiling common.cc, but runs into an unresolved identifier error on test.cc:</p>\n<blockquote>\n<p>g++ -lpthread test.cc common.h -g -o test</p>\n<p>/tmp/ccMwBGAj.o: In function `main':</p>\n<p>/home/...../test.cc:6: undefined reference to `foo()'</p>\n</blockquote>\n<p>Am I missing something here?</p>\n<p>Thanks!</p>\n"}, {"tags": ["c++", "scope", "reference", "constants", "move"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538595091, "post_id": 52634372, "comment_id": 92202095, "body": "You misunderstand <code>std::move</code> but I&#39;m not sure how exactly. <code>std::move</code> has no effect in any of the examples you&#39;ve shown, except maybe to disable some optimizations. <code>std::move</code> is just a cast from <code>T&amp;</code> to <code>T&amp;&amp;</code>, it converts lvalue references to rvalue references."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538595231, "post_id": 52634372, "comment_id": 92202149, "body": "&quot;when assigning a moved object using std::move()&quot; looks like it is necessary to repeat to some people again and again: <code>std::move()</code> itself does not move anything"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538595555, "post_id": 52634372, "comment_id": 92202285, "body": "@Fran&#231;oisAndrieux it does affect t see my answer"}, {"owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538595676, "post_id": 52634372, "comment_id": 92202346, "body": "I realize it doesn&#39;t have any effect in this particular sample.  I was actually moving an object from a <code>std::list</code> element into a local const reference variable, then deleting the entry from the list, and expected the variable to still be valid."}, {"owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538596240, "post_id": 52634372, "comment_id": 92202594, "body": "I updated the second snippet in my question with what I actually encountered.  Moving an element out of a <code>std::list</code> using <code>std::move()</code>.  Changing <code>auto const&amp; f</code> to <code>auto f</code> fixes it, but at the same time I would have expected the same behavior."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538596322, "post_id": 52634372, "comment_id": 92202629, "body": "@NathanOliver: This is not a duplicate of a version-specific question concerning C++03, because <code>std::move</code> didn&#39;t exist in C++03.  It probably still is a duplicate, just that target doesn&#39;t work."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538596428, "post_id": 52634372, "comment_id": 92202677, "body": "@BenVoigt <code>std::move</code> is doing the exact same thing.  Do we really need a pre and post C++11 dupe for passing the temporary to a function by reference stops the lifetime extension?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538596457, "post_id": 52634372, "comment_id": 92202690, "body": "Related, but also pre-rvalue references: <a href=\"https://stackoverflow.com/q/14735630/103167\">stackoverflow.com/q/14735630/103167</a>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538596476, "post_id": 52634372, "comment_id": 92202698, "body": "@NathanOliver: Yes, because the rule changed dramatically, you need a question about the C++11-and-later rule."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538596616, "post_id": 52634372, "comment_id": 92202753, "body": "Well, we both get a vote.  I for one don&#39;y think it has changed, at least not for this scenario."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538596731, "post_id": 52634372, "comment_id": 92202808, "body": "@BenVoigt Did you note that the answer in the linked to dupe is referencing the C++11 standard when they quote <i>A temporary bound to a reference parameter in a function call (5.2.2) persists until the completion of the full-expression containing the call.</i>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1538597323, "post_id": 52634372, "comment_id": 92203083, "body": "@Tom it is not possible to &quot;move an element into a const reference variable&quot;. A reference variable refers to some other object, it doesn&#39;t contain an object"}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1538595791, "post_id": 52634515, "comment_id": 92202398, "body": "This really doesn&#39;t answer the question.  It just shows a better(?) mcve"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1538595999, "post_id": 52634515, "comment_id": 92202496, "body": "That note is not true 100% of the time. Sometimes, <code>std::move</code> is required to avoid a copy."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1538596228, "post_id": 52634515, "comment_id": 92202590, "body": "@Rakete1111 I did not say it is because of a copy, does not matter if copy or not lifetime prolongation is gone, as temporary is an argument for a function and is not directly assigned to a reference. See my example"}, {"owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538596453, "post_id": 52634515, "comment_id": 92202687, "body": "I know that <code>std::move()</code> doesn&#39;t really do anything in the example.  I updated the second example to what I encountered: moving an element out of a <code>std::list</code> into a local const reference variable, then deleting that element, and then using the local variable (expecting it to still be valid)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538596759, "post_id": 52634515, "comment_id": 92202818, "body": "@Tom I already answered, your temporary is passed to <code>std::move()</code> not to reference, so lifetime prolongation is gone. Your new code has different issue - you have dangling reference, you should not jump from code t code like that. This is 2 different cases."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538596795, "post_id": 52634515, "comment_id": 92202831, "body": "@Tom: Your code does not &quot;move an element out of a <code>std::list</code>&quot;, it refers to it in-place.  The <code>auto f = ...</code> variant does actually move the content."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538596956, "post_id": 52634515, "comment_id": 92202912, "body": "@Slava: What temporary?  We&#39;re talking about this line of code, <code>auto const&amp; f = std::move(l.front());</code> right?  The only instance of the object lives inside a <code>std::list</code> container.  When it is removed from there, all references and pointers to the object become invalid."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538597021, "post_id": 52634515, "comment_id": 92202939, "body": "@BenVoigt there was temporary - result of <code>std::make_shared&lt;&gt;</code> before OP changed his code."}, {"owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538597083, "post_id": 52634515, "comment_id": 92202967, "body": "I changed the code because some answers pointed out that <code>std::move</code> around a function return value is pointless.  Which it is."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538597153, "post_id": 52634515, "comment_id": 92203009, "body": "@Tom &quot;I changed the code because some answers pointed out that std::move around a function return value is pointless.&quot; you got it wrong. Issue is prolongation does not work because of <code>std::move()</code> existance in your original code."}, {"owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538597183, "post_id": 52634515, "comment_id": 92203021, "body": "@Slava, I think I agree with you, that&#39;s certainly how it behaves.  But because syntactically <code>std::move()</code> appears to be like a function call, I expected lifetime to be prolonged.  It makes sense that it doesn&#39;t, after thinking about it."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538597254, "post_id": 52634515, "comment_id": 92203055, "body": "@Tom tha&#39;s why I showed you that with a function call it does not work either, though some purists do not like my example."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538597375, "post_id": 52634515, "comment_id": 92203110, "body": "@Slava: Your example is fine (and I didn&#39;t downvote), but I think the complaint is that it is a restatement of the question."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "edited": false, "score": 0, "creation_date": 1538597415, "post_id": 52634515, "comment_id": 92203131, "body": "@Tom: <code>std::move(x)</code> isn&#39;t just syntactically like a function call, it is a function call."}, {"owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1538597501, "post_id": 52634515, "comment_id": 92203173, "body": "@BenVoigt I realize that now.  I accepted this answer because it illustrates the exact same &quot;problem&quot;.  Thanks for helping me understand this."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": -1, "last_activity_date": 1538597556, "last_edit_date": 1538597556, "creation_date": 1538595530, "answer_id": 52634515, "question_id": 52634372, "link": "https://stackoverflow.com/questions/52634372/c11-move-to-local-const-reference-scope/52634515#52634515", "title": "C++11 move to local const reference: scope", "body": "<p>Let's put aside <code>std::move()</code> and create this function:</p>\n\n<pre><code>struct sometype {};\n\nconst sometype &amp;foobar( const sometype &amp;cref ) { return cref; }\n</code></pre>\n\n<p>and now we use it:</p>\n\n<pre><code>const sometype &amp;ref = foobar( sometype() );\n</code></pre>\n\n<p>What do you think, will lifetime of temporary be prolongated in this case? No it would not. Lifetime is only prolongated when you assign to a reference <strong>directly</strong>. When it goes through a function or through <code>static_cast</code> or <code>std::move</code> that prolongation is gone. So you have exactly the same issue with <code>std::move()</code></p>\n\n<pre><code>struct sometype {\n    sometype() { std::cout &lt;&lt; \"ctype()\" &lt;&lt; std::endl; }\n    ~sometype() { std::cout &lt;&lt; \"~ctype()\" &lt;&lt; std::endl; }\n};\n\nconst sometype &amp;foobar( const sometype &amp;cref ) { return cref; }\n\nint main()\n{\n    const sometype &amp;cref1 = foobar( sometype() );\n    sometype &amp;&amp;cref2 = std::move( sometype() );\n    std::cout &lt;&lt; \"main continues\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>ctype()\n~ctype()\nctype()\n~ctype()\nmain continues     \n</code></pre>\n\n<p><a href=\"https://ideone.com/X7H2U0\" rel=\"nofollow noreferrer\">live example</a></p>\n\n<p>Note: you should not use <code>std::move()</code> on return statement, it does not give you anything.</p>\n\n<p>For your code change. You should remember that <code>std::move()</code> does not move anything. It is done by special assignment operator or constructor (if they provided for a type). So when you write this code:</p>\n\n<pre><code>const type &amp;ref = std::move( something );\n</code></pre>\n\n<p>there is no constructor nor assignment operator involved and so no moving happens. For actual moving to happen you have to assign it to a variable:</p>\n\n<pre><code>type val = std::move( something );\n</code></pre>\n\n<p>now moving would happen if possible or copy otherwise.</p>\n"}], "owner": {"reputation": 483, "user_id": 1403469, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a0014a6b078397b79b6c33656b5040bb?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1403469/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "closed_date": 1538596648, "accepted_answer_id": 52634515, "answer_count": 1, "score": 2, "last_activity_date": 1538597556, "creation_date": 1538594878, "last_edit_date": 1538596935, "question_id": 52634372, "link": "https://stackoverflow.com/questions/52634372/c11-move-to-local-const-reference-scope", "closed_reason": "Duplicate", "title": "C++11 move to local const reference: scope", "body": "<p>For regular local const reference variables, the scope is <a href=\"https://stackoverflow.com/a/2784304/1403469\">prolonged</a>.  Which is why the following code works as expected:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nstruct foo\n{\n        foo()\n        {\n                std::cout &lt;&lt; \"foo() @\" &lt;&lt; (void*)this &lt;&lt; std::endl;\n        }\n        ~foo()\n        {\n                std::cout &lt;&lt; \"~foo() @\" &lt;&lt; (void*)this &lt;&lt; std::endl;\n        }\n};\n\nint main()\n{\n        auto const&amp; f = std::make_shared&lt;foo&gt;();\n        std::cout &lt;&lt; \"f = \" &lt;&lt; f.get() &lt;&lt; std::endl;\n        return 0;\n}\n\n// prints:\n// foo() @0x55f249c58e80\n// f = 0x55f249c58e80\n// ~foo() @0x55f249c58e80\n</code></pre>\n\n<p>It seems though that this does not work as expected when assigning a moved object using <code>std::move()</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;list&gt;\n\nstruct foo\n{\n        foo()\n        {\n                std::cout &lt;&lt; \"foo() @\" &lt;&lt; (void*)this &lt;&lt; std::endl;\n        }\n        ~foo()\n        {\n                std::cout &lt;&lt; \"~foo() @\" &lt;&lt; (void*)this &lt;&lt; std::endl;\n        }\n};\n\nint main()\n{\n        std::list&lt;std::shared_ptr&lt;foo&gt;&gt; l;\n        l.push_back(std::make_shared&lt;foo&gt;());\n        auto const&amp; f = std::move(l.front());\n        l.clear();\n        std::cout &lt;&lt; \"f = \" &lt;&lt; f.get() &lt;&lt; std::endl;\n        return 0;\n}\n\n// prints\n// foo() @0x564edb58fe80\n// ~foo() @0x564edb58fe80\n// f = 0x564edb58fe80\n</code></pre>\n\n<p>Does <code>std::move()</code> indeed change the scope, or am I dealing with a compiler bug?</p>\n\n<p>Changing the variable from <code>auto const&amp; f</code> to just <code>auto f</code> fixes the problem.  If I wrap the move into another function, it also works:</p>\n\n<pre><code>auto const&amp; f = [&amp;]() { return std::move(l.front()); }();\n</code></pre>\n\n<p>It's almost like <code>std::move()</code> does not share the same semantics as a function call, but rather as if it was just a regular variable assignment:</p>\n\n<pre><code>auto const&amp; f = std::move(l.front());\n</code></pre>\n"}, {"tags": ["c++", "string", "class"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1538594551, "post_id": 52634285, "comment_id": 92201837, "body": "Can you provide a complete example? This is missing a lot of code and isn&#39;t valid. Normally you should stick with the <code>std::</code> prefix, don&#39;t include <code>using namespace std</code> as that has the potential to cause conflict."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538594603, "post_id": 52634285, "comment_id": 92201864, "body": "Please <b><a href=\"https://stackoverflow.com/posts/52634285/edit\">edit</a></b> your question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct Example)</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538594741, "post_id": 52634285, "comment_id": 92201934, "body": "Probably an error above that that&#39;s giving the compiler fits. Missing <code>;</code> before a closebrace in previous function? <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> required. Mind you you&#39;ll probably get half done making the MCVE and find the error yourself. That&#39;s what makes the MCVE really cool."}, {"owner": {"reputation": 81, "user_id": 9537137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb34db9e70d774a0392fc7489457190?s=128&d=identicon&r=PG&f=1", "display_name": "PKPython", "link": "https://stackoverflow.com/users/9537137/pkpython"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538594777, "post_id": 52634285, "comment_id": 92201947, "body": "Hi @tadman I unfortunately don&#39;t have much control over this, since this is for my programming class at school."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1538594899, "post_id": 52634285, "comment_id": 92202009, "body": "You have to define the <code>print</code> function. What code comes before the line with the error?"}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538595033, "post_id": 52634285, "comment_id": 92202069, "body": "@tadman I think it&#39;s unreasonable to expect programmers to type &quot;std::&quot; before every library call. It&#39;s even worse coding style to name variables the same as a variable in the standard library (Never name something cout, cin, endl, vector, map, etc.), so <code>using namespace std</code> actually acts like a linter xD. The error &quot;ambiguous reference to XYZ&quot; is very obvious and self explanatory, and it&#39;s easy to just do <code>::cout</code> if you really want to name your own variable <code>cout</code> and overcome the ambiguous reference."}, {"owner": {"reputation": 81, "user_id": 9537137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb34db9e70d774a0392fc7489457190?s=128&d=identicon&r=PG&f=1", "display_name": "PKPython", "link": "https://stackoverflow.com/users/9537137/pkpython"}, "edited": false, "score": 0, "creation_date": 1538595356, "post_id": 52634285, "comment_id": 92202206, "body": "I updated my to show my above code and it was something to do with brackets, now I just get squiggly under my &quot;numOfElements&quot; , &quot;arr&quot; and &quot;arraySize&quot;"}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "edited": false, "score": 1, "creation_date": 1538595363, "post_id": 52634285, "comment_id": 92202208, "body": "What IS important is to <i>never</i> write a top-level <code>using namespace XYZ;</code> in a header file. Then you force <code>using namespace XYZ;</code> upon those who include you, <i>and</i> it&#39;s not clear that this happens. If you want it in a header file, wrap it in brackets so you dont pollute the namespace of those who include your file."}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1538595569, "post_id": 52634285, "comment_id": 92202292, "body": "@Ripi2 Only classes/structs should have to do this, not functions. The error here is something weirder and I think out of scope from the code he posted."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538595661, "post_id": 52634285, "comment_id": 92202339, "body": "Unable to reproduce, but... warning: In <code>DynamicArray(int arraySize)</code>, the <code>arraySize</code> function parameter shadows the <code>arraySize</code> member leading to much fun and debugging later."}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "edited": false, "score": 0, "creation_date": 1538595664, "post_id": 52634285, "comment_id": 92202341, "body": "@PKPython Please work on your code to get an MCVE. Get one contiguous cpp file (and headers if that&#39;s part of the issue) that causes the issue, and keep removing code until the error goes away. Keep all code that is necessary to cause the error, and make sure the code you post is ready to throw into a compiler. This code you posted will not compile."}, {"owner": {"reputation": 81, "user_id": 9537137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb34db9e70d774a0392fc7489457190?s=128&d=identicon&r=PG&f=1", "display_name": "PKPython", "link": "https://stackoverflow.com/users/9537137/pkpython"}, "edited": false, "score": 0, "creation_date": 1538595745, "post_id": 52634285, "comment_id": 92202375, "body": "Sorry guys for wasting your time, it&#39;s really confusing to explain how it needs to be done. We have a &#39;main.cpp&#39; file that is going to include this file into it, so that it can compile. Maybe that&#39;s why it&#39;s confusing"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538595810, "post_id": 52634285, "comment_id": 92202406, "body": "Is <code>print</code> intended to be a  <code>DynamicArray</code> class member? Currently it is not, but it sure looks like it&#39;s trying to use the <code>DynamicArray</code> member variables."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538596016, "post_id": 52634285, "comment_id": 92202506, "body": "<code>numOfElements</code> is never initialized. This will lead to future chaos."}, {"owner": {"reputation": 81, "user_id": 9537137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb34db9e70d774a0392fc7489457190?s=128&d=identicon&r=PG&f=1", "display_name": "PKPython", "link": "https://stackoverflow.com/users/9537137/pkpython"}, "edited": false, "score": 0, "creation_date": 1538596300, "post_id": 52634285, "comment_id": 92202614, "body": "I thought I did in the class DyanmicArray? I put int numOfElements;"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538596339, "post_id": 52634285, "comment_id": 92202639, "body": "Good on you for implementing copy constructor, but to finish off <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">The Rule Of Three</a> you&#39;ll need an assignment operator, a destructor, and make the copy constructor <code>public</code>. Also reconsider <code>private</code> constructors unless you&#39;re also going to have a <code>static</code> factory function."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538596954, "post_id": 52634285, "comment_id": 92202910, "body": "You have <code>int numOfElements;</code> but you use it before assigning a value to it. For example, what is the value of <code>numElements</code> when the program reaches <code>for (int i = 0; i &lt;= a.numOfElements; i++) </code>? There is no way to know. The <code>for</code> loop could loop a billion times. It could loop zero. Also note that C++ arrays are origin zero, and that means <code>int i = 0; i &lt;= a.numOfElements</code> allows a rwange of [0,<code>numElements</code>], not [0,<code>numElements</code>). You&#39;ll be off by one."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538596957, "post_id": 52634285, "comment_id": 92202913, "body": "Suggestion. Once you get the program compiling, don&#39;t add any more code until you have tested and proven all of the code you currently have. If you build more code on a faulty foundation you&#39;ll likely have to fix even more bugs and possibly throw it out."}], "owner": {"reputation": 81, "user_id": 9537137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb34db9e70d774a0392fc7489457190?s=128&d=identicon&r=PG&f=1", "display_name": "PKPython", "link": "https://stackoverflow.com/users/9537137/pkpython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538595311, "creation_date": 1538594512, "last_edit_date": 1538595311, "question_id": 52634285, "link": "https://stackoverflow.com/questions/52634285/definition-not-found-for-print", "title": "Definition not found for print()", "body": "<p>New to C++ and trying to better understand why my code is giving me some red squiggly. </p>\n\n<p>My code is </p>\n\n<pre><code>string print() {\nstring answer = \"\";\nfor(int i = 0; i &lt; numOfElements - 1; i++) {\n    answer += (arr[i] + '0');\n    answer += ',';\n</code></pre>\n\n<p>I am getting the error under print and also my first bracket { </p>\n\n<p>Not sure if I need to post more, but I don't really get the problem I am having. </p>\n\n<pre><code>expected a ';' \nFunction definition for 'print' not found.\n</code></pre>\n\n<p>Error when I highlight the code.</p>\n\n<p>Even when I do put a semi colon I get the same error.</p>\n\n<p>Thanks for the help, and appreciate it.</p>\n\n<pre><code>class DynamicArray {\nprivate:\n    int *arr;\n    int arraySize;\n    int numOfElements;\n\nDynamicArray(int arraySize) {\n    if (arraySize &lt;= 1)\n        arr = new int[1];\n    else\n        arr = new int[arraySize];\n}\n\nDynamicArray(const DynamicArray &amp;a) {\n    arr = new int[a.arraySize];\n    for (int i = 0; i &lt;= a.numOfElements; i++) {\n        arr[i] = a.arr[i];\n    }\n    numOfElements = a.numOfElements;\n    arraySize = a.arraySize;\n}\npublic:\n    int getArraySize() {\n        return arraySize;\n    }\n    int getNumOfElements() {\n        return numOfElements;\n    }\n\n};\nstring print() {\n    string answer = \"\";\n    for (int i = 0; i &lt; numOfElements - 1; i++) {\n        answer += (arr[i] + '0');\n        answer += ',';\n    }\n    answer += (arr[numOfElements - 1] + '0');\n    return answer;\n    }\n</code></pre>\n"}, {"tags": ["c++", "linux", "operating-system", "filesystems"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1538597296, "post_id": 52634249, "comment_id": 92203073, "body": "Did you mean <code>const int64_t capacity = 8458240L;</code>"}, {"owner": {"reputation": 550, "user_id": 3545806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4bd08c73006f268281c9e001da13e12f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirS", "link": "https://stackoverflow.com/users/3545806/vladimirs"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1538597558, "post_id": 52634249, "comment_id": 92203203, "body": "Yes, that is correct, I was simplifying the code from the source"}], "owner": {"reputation": 550, "user_id": 3545806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4bd08c73006f268281c9e001da13e12f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirS", "link": "https://stackoverflow.com/users/3545806/vladimirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538599432, "creation_date": 1538594338, "last_edit_date": 1538599432, "question_id": 52634249, "link": "https://stackoverflow.com/questions/52634249/ftruncate64-incorrect-file-size-on-gpfs-with-success", "title": "ftruncate64 incorrect file size on gpfs with SUCCESS", "body": "<p>I could not reproduce this problem in the application with just trimmed 4 calls bellow, but it is consistent with my single threaded application on gpfs filesystem.</p>\n\n<p>Important sequence of calls is</p>\n\n<pre><code>const int64_t capacity = 8458240;    \nftruncate64(fd, current_size + capacity);\nfstat(fd, &amp;buf);\nmunmap(base, capacity);\nbase = mmap64(nullptr, capacity, PROT_READ|PROT_WRITE, MAP_SHARED, fd, current_size);\n</code></pre>\n\n<p>It works on all file systems available here but gpfs.\nNote: current_size is not rounded to capacity, but it is monotonically increasing.\nSo program and above calls run for a while successfully, until truncation of 5724962816. In this case the file adjusted on gpfs to only 5716836352 (exactly 5716MB). Smaller sizes works well.\nIt is  visible on strace output:</p>\n\n<pre><code>ftruncate(6, 5724962816)                = 0\nfstat(6, {st_mode=S_IFREG|0640, st_size=5716836352, ...}) = 0\n</code></pre>\n\n<p>Have any suggestions to where to look farther?</p>\n\n<p>Thank you in advance.</p>\n\n<p>PS:\nI was able to produce simple problem code:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n auto m_fd = ::open(argv[1], O_RDWR|O_CREAT|O_TRUNC, (S_IRUSR | S_IWUSR) | (S_IRGRP | S_IWGRP));\nlong m_capacity =      8458240L;\nlong size = 60033856276L/8458240L;\nlong increment = 8417280L;\nfor(long i = 1; i&lt;size; i++)\n{\n  if( ::ftruncate64(m_fd,  m_capacity + increment*i) &lt; 0 )\n  {\n    std::cerr&lt;&lt;\"ftruncate failed \"&lt;&lt; errno &lt;&lt; \" \"&lt;&lt;::strerror(errno) &lt;&lt;endl;\n    return 1;\n  }\n\n  int8_t* base = (int8_t*)::mmap(nullptr, m_capacity, PROT_READ | PROT_WRITE, MAP_SHARED, m_fd,  increment*i);\n  if(base == MAP_FAILED)\n  {\n    std::cerr&lt;&lt;\"mmap failed\"&lt;&lt; errno &lt;&lt; \" \"&lt;&lt;::strerror(errno) &lt;&lt;endl;\n    return 1;\n  }\n\n  struct stat buf;\n  ::fstat(m_fd, &amp;buf);\n  if(buf.st_size != m_capacity + increment*i)\n    {\n      std::cerr&lt;&lt; \"size failed \" &lt;&lt; buf.st_size &lt;&lt; \" \"&lt;&lt; (m_capacity + increment*i) &lt;&lt;  \", i \" &lt;&lt; i&lt;&lt;  endl;\n      return 1;\n    }\n\n  for (int64_t i = 0; i &lt; m_capacity; ++i)\n    {\n      volatile int8_t* addr = base + i;\n      int8_t x              = *addr;\n      *addr = x;\n    }\n\n  ::munmap(base, m_capacity);\n}\nreturn 0;\n}\n</code></pre>\n\n<p>If i do return it will core after \"failed 5716836352 5723791360, i 679\"</p>\n\n<p>Update:\nI have created workaround, by basically calling second time ftruncate64 with same values if size mismatch.\nNoticeable, I got second fail that is x2 of first one, so I probably will leave it to IBM.</p>\n\n<p>size failed 5716836352 5723791360, i 679\nsize failed 11433672704 11439124480, i 1358</p>\n"}, {"tags": ["c++", "uwp"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1538594263, "post_id": 52634206, "comment_id": 92201706, "body": "Where is the file located?  MSVS typically uses the location where the source files reside as the working directory for the executable."}, {"owner": {"reputation": 1, "user_id": 10010692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb2a96cb841647422472a935c2fbac63?s=128&d=identicon&r=PG&f=1", "display_name": "soojcho", "link": "https://stackoverflow.com/users/10010692/soojcho"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538600266, "post_id": 52634206, "comment_id": 92204359, "body": "below is the file location and yes this is also where the executable is located. C:\\Program Files (x86)\\libmuse_6.0.3\\windows\\examples\\x64\\Debug\\GettingData\\A&zwnj;&#8203;ppX"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538600385, "post_id": 52634206, "comment_id": 92204397, "body": "You should move the file to wherever the source file is then and try again.  Most likely that is your issue.  That, or you could fully qualify the path like <code>output_file.open(&quot;C:\\\\Program Files (x86)\\\\libmuse_6.0.3\\\\windows\\\\examples\\\\x64\\\\Debug\\\\Getting&zwnj;&#8203;Data\\\\AppX\\\\datafile&zwnj;&#8203;.txt&quot;, std::ios::out);</code>."}, {"owner": {"reputation": 1, "user_id": 10010692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb2a96cb841647422472a935c2fbac63?s=128&d=identicon&r=PG&f=1", "display_name": "soojcho", "link": "https://stackoverflow.com/users/10010692/soojcho"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538602785, "post_id": 52634206, "comment_id": 92205291, "body": "yes that&#39;s where the file is located. the full path doesn&#39;t work either."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538602850, "post_id": 52634206, "comment_id": 92205323, "body": "If the full path does not work then it is probably a permissions issue."}, {"owner": {"reputation": 1, "user_id": 10010692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb2a96cb841647422472a935c2fbac63?s=128&d=identicon&r=PG&f=1", "display_name": "soojcho", "link": "https://stackoverflow.com/users/10010692/soojcho"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538602898, "post_id": 52634206, "comment_id": 92205335, "body": "would you have any recommendations on resolving/troubleshooting permission issue since it doesn&#39;t get caught as an error?"}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 0, "creation_date": 1538607812, "post_id": 52634206, "comment_id": 92206664, "body": "Just a long shot : Did you create your project and /or solution with VS running as Administrator and now you&#39;re testing as normal user ?"}, {"owner": {"reputation": 1, "user_id": 10010692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb2a96cb841647422472a935c2fbac63?s=128&d=identicon&r=PG&f=1", "display_name": "soojcho", "link": "https://stackoverflow.com/users/10010692/soojcho"}, "reply_to_user": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 0, "creation_date": 1538607925, "post_id": 52634206, "comment_id": 92206688, "body": "@engf-010 i think so"}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 0, "creation_date": 1538608555, "post_id": 52634206, "comment_id": 92206823, "body": "If you did ,that could explain it ! Just rename the old solution/project ,make a new solution/project with VS running as normal user and copy your sources, headers ,resources to the newly created directory(directories). Rebuild and test again. But before you do that you&#39;d better test again with VS running as administrator !"}], "answers": [{"tags": [], "owner": {"reputation": 3529, "user_id": 7199329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJtr.png?s=128&g=1", "display_name": "Breeze Liu - MSFT", "link": "https://stackoverflow.com/users/7199329/breeze-liu-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1538631856, "creation_date": 1538631856, "answer_id": 52639782, "question_id": 52634206, "link": "https://stackoverflow.com/questions/52634206/not-opening-file-in-visual-studio-windows/52639782#52639782", "title": "not opening file in visual studio windows", "body": "<p>In UWP app, it can access certain file system locations by default. It can also access additional locations through the <a href=\"https://docs.microsoft.com/en-us/windows/uwp/files/quickstart-using-file-and-folder-pickers\" rel=\"nofollow noreferrer\">file picker</a>, or by declaring <a href=\"https://docs.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations\" rel=\"nofollow noreferrer\">capabilities</a>. You can see the <a href=\"https://docs.microsoft.com/en-us/windows/uwp/files/file-access-permissions\" rel=\"nofollow noreferrer\">File access permissions</a> topic for details.</p>\n\n<p>For your issue, it seems you want to access the file in your app InstalledLocation, as the <a href=\"https://docs.microsoft.com/en-us/windows/uwp/files/file-access-permissions#application-install-directory\" rel=\"nofollow noreferrer\">Application install directory</a> introduction, you can access the file using the following code in C++/WinRT:</p>\n\n<pre><code>Windows::Foundation::IAsyncAction ExampleCoroutineAsync()\n{\n    Windows::Storage::StorageFile file{\n        co_await Windows::Storage::StorageFile::GetFileFromApplicationUriAsync(Windows::Foundation::Uri{L\"ms-appx:///datafile.txt\"})\n    };\n    // Process file\n}\n</code></pre>\n\n<p>Or C++:</p>\n\n<pre><code>auto getFileTask = create_task(StorageFile::GetFileFromApplicationUriAsync(ref new Uri(\"ms-appx:///datafile.txt\")));\ngetFileTask.then([](StorageFile^ file) \n{\n    // Process file\n});\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10010692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb2a96cb841647422472a935c2fbac63?s=128&d=identicon&r=PG&f=1", "display_name": "soojcho", "link": "https://stackoverflow.com/users/10010692/soojcho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538631856, "creation_date": 1538594172, "question_id": 52634206, "link": "https://stackoverflow.com/questions/52634206/not-opening-file-in-visual-studio-windows", "title": "not opening file in visual studio windows", "body": "<p>I am running Windows 10 and using VS2017. The code below is not opening a file...</p>\n\n<pre><code>    std::ofstream output_file;\n    output_file.open(\"datafile.txt\", std::ios::out);\n    if (!output_file.is_open())\n    {\n        std::cout &lt;&lt; \"This is the whole problem\";\n    }\n</code></pre>\n\n<p>Could this be related to permission to writing/reading file and how can I give it the permission.</p>\n"}, {"tags": ["c++", "visual-c++", "webclient"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1538594353, "post_id": 52634143, "comment_id": 92201742, "body": "is that hunk of code supposed to be c++ ?"}, {"owner": {"reputation": 1, "user_id": 10453123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f1mg-EA6vDU/AAAAAAAAAAI/AAAAAAAAPeI/4vv5ltPx-Tc/photo.jpg?sz=128", "display_name": "Jose Javier Jimenez", "link": "https://stackoverflow.com/users/10453123/jose-javier-jimenez"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1538665123, "post_id": 52634143, "comment_id": 92231485, "body": "it is vc++, yes"}, {"owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "edited": false, "score": 0, "creation_date": 1550100293, "post_id": 52634143, "comment_id": 96150846, "body": "Have you got &quot;System&quot; assembly added as a Reference to your project?"}], "owner": {"reputation": 1, "user_id": 10453123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f1mg-EA6vDU/AAAAAAAAAAI/AAAAAAAAPeI/4vv5ltPx-Tc/photo.jpg?sz=128", "display_name": "Jose Javier Jimenez", "link": "https://stackoverflow.com/users/10453123/jose-javier-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538593896, "creation_date": 1538593896, "question_id": 52634143, "link": "https://stackoverflow.com/questions/52634143/how-can-i-resolve-this-compilation-issues-with-webclient-in-vc", "title": "How can I resolve this compilation issues with WebClient in VC++?", "body": "<p>I'm using WebClient to download a file from a web url.\nBut vs is having this errors when compiling:\n'wc' indentifier not declared (C2065)\n'WebClient indentifier not declared (C2065)\nSintaxis error: identifier WebClient (C2061)\nLeft operand of '->DownloadFile' needs class/struct/union/generic</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>WebClient^ wc = gcnew WebClient; \nwc-&gt;DownloadFile(\"http://myweb.pw/file.dll\",\"C:/tempdata/file.dll\");\n</code></pre>\n\n<p>What can I do to use WebClient in VC++ .Net 4.5.2 to download a file from a url? Thank you! </p>\n"}, {"tags": ["android", "c++", "qt", "notifications", "qt5"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1538609336, "post_id": 52634063, "comment_id": 92207023, "body": "what is the meaning of <i>but i am not able to get it working</i>?"}, {"owner": {"reputation": 31, "user_id": 4741863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPgcf.jpg?s=128&g=1", "display_name": "fist ace", "link": "https://stackoverflow.com/users/4741863/fist-ace"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1538634864, "post_id": 52634063, "comment_id": 92213199, "body": "what i meant was that like in my mind i have general idea what has to be done , a java class , a java reciver class and c++ class to call them using JNI but i am not able to fomulate it in code .  This is the problem ( lack of knowledge) . that&#39;s why i am asking if someone can create a simple example for it ."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1538635575, "post_id": 52634063, "comment_id": 92213600, "body": "Have you tried something ?, without any idea of criticizing your question, I recommend trying something, showing where you got stuck and maybe we could give you advice, asking for code many times without showing an attempt does not attract people. That&#39;s why it was my question because I thought you had tried something and something did not work, and I was asking about that something."}, {"owner": {"reputation": 31, "user_id": 4741863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPgcf.jpg?s=128&g=1", "display_name": "fist ace", "link": "https://stackoverflow.com/users/4741863/fist-ace"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1538674122, "post_id": 52634063, "comment_id": 92236467, "body": "Hey i have definitely tried something . here is the repo for that : <a href=\"https://github.com/hackertron/jni.git\" rel=\"nofollow noreferrer\">github.com/hackertron/jni.git</a> ( it&#39;s same code as i provided above). When i run the project ( deploy on my android ) i get no notification nothing. Just plain qt quick application."}], "owner": {"reputation": 31, "user_id": 4741863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPgcf.jpg?s=128&g=1", "display_name": "fist ace", "link": "https://stackoverflow.com/users/4741863/fist-ace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538609277, "creation_date": 1538593519, "last_edit_date": 1538609277, "question_id": 52634063, "link": "https://stackoverflow.com/questions/52634063/unable-to-schedule-local-notification-in-qt-android", "title": "Unable to Schedule local notification in Qt android", "body": "<p>I am trying to create local scheduled notifications with Qt for android app. I was following this answer : <a href=\"https://stackoverflow.com/questions/33901869/unable-to-schedule-notification-with-alarmmanager-on-android-using-qt#\">Unable to schedule notification with AlarmManager on Android (using Qt)</a> but i am not able to get it working . </p>\n\n<p>Below is the code\nnotificationclient.h : </p>\n\n<pre><code>#ifndef NOTIFICATIONCLIENT_H\n#define NOTIFICATIONCLIENT_H\n\n#include &lt;QObject&gt;\n\nclass NotificationClient : public QObject\n{\n\n    explicit NotificationClient(QObject *parent = 0);\n\n    int createNotification(Qstring title, Qstring content);\n\n\n\n};\n\n#endif // NOTIFICATIONCLIENT_H\n</code></pre>\n\n<p>notificationclient.cpp</p>\n\n<pre><code>#include \"notificationclient.h\"\n\n#include &lt;QtAndroidExtras/QAndroidJniObject&gt;\n\nNotificationClient::NotificationClient(QObject *parent)\n    : QObject(parent)\n{\n\n}\n\n\n\nint NotificationClient::createNotification(Qstring title, Qstring content);\n{\n    QAndroidJniObject javaNotification = QAndroidJniObject;\n    QAndroidJniObject::callStaticMethod&lt;void&gt;(\"ScheduledNotifications\",\n                                       \"createNotification\",\n                                       \"(Ljava/lang/String;)V\",\n                                       javaNotification.object&lt;jstring&gt;());\n}\n</code></pre>\n\n<p>ScheduleNotification.java</p>\n\n<pre><code>class ScheduledNotifications {\n    static public int notification_id = 0;\n    static int scheduleNotification(String title, String content, int futureInMilliseconds) {\n        ++notification_id;\n\n        Intent notificationIntent = new Intent(QtNative.activity(),  NotificationPublisher.class);\n        notificationIntent.putExtra(NotificationPublisher.NOTIFICATION_ID, notification_id);\n        notificationIntent.putExtra(NotificationPublisher.NOTIFICATION, createNotification(title,content));\n        PendingIntent pendingIntent = PendingIntent.getBroadcast(QtNative.activity(), 0, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);\n\n        AlarmManager alarmManager = (AlarmManager)QtNative.activity().getSystemService(Context.ALARM_SERVICE);\n        alarmManager.set(AlarmManager.RTC_WAKEUP, /*futureInMilliseconds*/0, pendingIntent);\n\n        Log.d(\"!\" ,\"Scheduled\");\n        return notification_id;\n    }\n\n    static public Notification createNotification(String title, String content) {\n            Notification.Builder builder = new Notification.Builder(QtNative.activity());\n\n\n            builder.setContentTitle(title);\n            builder.setContentText(content);\n            return builder.build();\n    }\n}\n</code></pre>\n\n<p>NotificationPublisher.java</p>\n\n<pre><code>class NotificationPublisher extends BroadcastReceiver {\n\n    public static String NOTIFICATION_ID = \"notification-id\";\n    public static String NOTIFICATION = \"notification\";\n\n    public void onReceive(Context context, Intent intent) {//Called when its time to show the notification ...\n\n        Log.d(\"!\", \"Notified\");\n        NotificationManager notificationManager = (NotificationManager)context.getSystemService(Context.NOTIFICATION_SERVICE);\n\n        Notification notification = intent.getParcelableExtra(NOTIFICATION);\n        int id = intent.getIntExtra(NOTIFICATION_ID, 0);\n        notificationManager.notify(id, notification);\n\n    }\n}\n</code></pre>\n\n<p>I am not really sure how to do it . If someone can provide a proper example with local notification in Qt that would be really helpful</p>\n\n<p>thanks!!</p>\n"}, {"tags": ["c++", "linux", "visual-studio-2017", "arm", "cross-compiling"], "answers": [{"tags": [], "owner": {"reputation": 2305, "user_id": 2056201, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/bba9995d4071b28c1f54bcb8ae03a1f2?s=128&d=identicon&r=PG", "display_name": "Mich", "link": "https://stackoverflow.com/users/2056201/mich"}, "is_accepted": false, "score": 0, "last_activity_date": 1538600086, "creation_date": 1538600086, "answer_id": 52635555, "question_id": 52633986, "link": "https://stackoverflow.com/questions/52633986/how-do-i-build-opencv-with-tesseractocr/52635555#52635555", "title": "How do I build OpenCV with TesseractOCR?", "body": "<p>I got tesseract to build, here is what I added:</p>\n\n<p>To tesseract/CMakeLists.txt on line 105 comment out and add</p>\n\n<pre><code>#if(NOT EXISTS ${PROJECT_SOURCE_DIR}/.cppan)\n#    if (NOT Leptonica_DIR AND NOT MSVC)\n#        find_package(PkgConfig REQUIRED)\n#        pkg_check_modules(Leptonica REQUIRED lept&gt;=${MINIMUM_LEPTONICA_VERSION})\n#        link_directories(${Leptonica_LIBRARY_DIRS})\n#    else()\n#        find_package(Leptonica ${MINIMUM_LEPTONICA_VERSION} REQUIRED CONFIG)\n#    endif()\n#else()\n#    if (STATIC)\n#        set(CPPAN_BUILD_SHARED_LIBS 0)\n#    else()\n#        set(CPPAN_BUILD_SHARED_LIBS 1)\n#    endif()\n#    add_subdirectory(.cppan)\n#endif()    \nset(Leptonica_DIR \"C:/opencv/leptonica/build\")\nfind_package(Leptonica ${MINIMUM_LEPTONICA_VERSION} REQUIRED CONFIG) \nfind_package(OpenCL QUIET)\n</code></pre>\n\n<p>Then some build options need to be changed. Same file, line 260.\nSet all the <code>PROPERTIES COMPILE_FLAGS \"-marm\"</code> otherwise it wont compile</p>\n\n<pre><code>set_source_files_properties(\n    ${CMAKE_CURRENT_SOURCE_DIR}/src/arch/dotproductsse.cpp\n    PROPERTIES COMPILE_FLAGS \"-msse4.1\")\nset_source_files_properties(\n    ${CMAKE_CURRENT_SOURCE_DIR}/src/arch/intsimdmatrixsse.cpp\n    PROPERTIES COMPILE_FLAGS \"-msse4.1\")\nset_source_files_properties(\n    ${CMAKE_CURRENT_SOURCE_DIR}/src/arch/dotproductavx.cpp\n    PROPERTIES COMPILE_FLAGS \"-mavx\")\nset_source_files_properties(\n    ${CMAKE_CURRENT_SOURCE_DIR}/src/arch/intsimdmatrixavx2.cpp\n    PROPERTIES COMPILE_FLAGS \"-mavx2\")\n</code></pre>\n\n<p>Then, copy the <code>endianness.h</code> and <code>config_auto.h</code> from <code>C:\\opencv\\leptonica\\build\\src</code> to <code>C:\\opencv\\leptonica\\src</code> , again otherwise it wont build</p>\n\n<p>Then it will complain about undefined PACKAGE_VERSION in tessdatamanager.cpp, so define it in the CMakeLists or just directly in the source file. </p>\n\n<p>After that it should build, if your directories match. </p>\n\n<p>My directory structure is as follows: </p>\n\n<pre><code>Tesseract git repository located in  C:\\opencv\\tesseract\nTesseract build directory  C:\\opencv\\tesseract\\build\nLeptonica repository located in  C:\\opencv\\leptonica\n\nLeptonica build directory in  C:\\opencv\\leptonica\\build (contains LeptonicaConfig.cmake, \nLeptonica library files, (libleptonica.so, libleptonica.so.1.77.0, libleptonica.so.5.3.0) are in C:\\opencv\\leptonica\\build\\src\n</code></pre>\n"}], "owner": {"reputation": 2305, "user_id": 2056201, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/bba9995d4071b28c1f54bcb8ae03a1f2?s=128&d=identicon&r=PG", "display_name": "Mich", "link": "https://stackoverflow.com/users/2056201/mich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1345, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538600086, "creation_date": 1538593206, "question_id": 52633986, "link": "https://stackoverflow.com/questions/52633986/how-do-i-build-opencv-with-tesseractocr", "title": "How do I build OpenCV with TesseractOCR?", "body": "<p>I'm trying to build OpenCV with the Tesseract OCR module to use on a raspberry pi.</p>\n\n<p>There is very little information online on how to build this, and what is available is very incomplete.</p>\n\n<p>I'm building using Visual Studio 2017 on windows 10 using the VisualGDB plugin for cross compilation.</p>\n\n<p>I can load the OpenCV CMake project and build it without issues. </p>\n\n<p>I downloaded the OpenCV-contrib modules, and pointed the <code>OPENCV_EXTRA_MODULES_PATH</code> to <code>C:/opencv/opencv_contrib-master/modules</code></p>\n\n<p>I can see there is a <code>text</code> module that contains some sources for tesseract-ocr.</p>\n\n<p>There are also entries for <code>Tesseract_INCLUDE_DIR</code> and <code>Tesseract_LIBRARY</code></p>\n\n<p>Does this mean I need to download Tesseract separately? Or can I just use the files that came with OpenCV contrib?</p>\n\n<p>I cloned <code>https://github.com/tesseract-ocr/tesseract</code></p>\n\n<p>But there is no include folder anywhere. There is an src folder that contains headers and source files, but no include folder anywhere.</p>\n\n<p>Do I need to build tesseract first? And when its built, it creates lib and include files?</p>\n\n<p>I tried to build tesseract, but it required leptonica.\nI was able to build leptonica. but I cannot manage to include it in Tesseract cmake. </p>\n\n<p>I added the lines </p>\n\n<pre><code>add_subdirectory(${CMAKE_SOURCE_DIR}/../leptonica)\nadd_subdirectory(${CMAKE_SOURCE_DIR}/../leptonica/build)\nfind_package(Leptonica ${MINIMUM_LEPTONICA_VERSION} REQUIRED CONFIG) \n</code></pre>\n\n<p>But I'm getting errors:</p>\n\n<p><code>add_subdirectory not given a binary directory but the given source     C:\\opencv\\tesseract\\CMakeLists.txt</code></p>\n\n<p><code>Could not find a package configuration file provided by \"Leptonica\"        C:\\opencv\\tesseract\\CMakeLists.txt  124</code>    </p>\n\n<p>Thanks,</p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1538593018, "post_id": 52633910, "comment_id": 92201082, "body": "What do you mean by &#39;have&#39;t created base object&#39;?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538593078, "post_id": 52633910, "comment_id": 92201119, "body": "You&#39;re shadowing the <code>hrs</code> member in the derived class. Did you mean to make it <code>protected</code> instead? To access the base member, you <i>could</i> use <code>thing2.clocks::hrs</code> if it wasn&#39;t private."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1538593154, "post_id": 52633910, "comment_id": 92201163, "body": "<code>childClock</code> has two <code>hrs</code> members. Is that the intent?"}, {"owner": {"reputation": 3, "user_id": 8212489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fe4f66cbb9a3c77e2cb7a13234b382?s=128&d=identicon&r=PG&f=1", "display_name": "user8212489", "link": "https://stackoverflow.com/users/8212489/user8212489"}, "edited": false, "score": 0, "creation_date": 1538599176, "post_id": 52633910, "comment_id": 92203910, "body": "The answer below cleared up my misunderstanding, but SergeyA - I meant that if I ran the program with the first line in main (clocks thing) commented out that the program still ran, but even weirder. Bartek - This was a small part of an assignment and the class was defined for me as well as main(), and I was not to modify them. Alter and Rivasa(below in the answer) cleared up my misunderstanding. Thanks all."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8212489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fe4f66cbb9a3c77e2cb7a13234b382?s=128&d=identicon&r=PG&f=1", "display_name": "user8212489", "link": "https://stackoverflow.com/users/8212489/user8212489"}, "edited": false, "score": 0, "creation_date": 1538598963, "post_id": 52634056, "comment_id": 92203816, "body": "Ahh, much thanks for clearing up my misunderstanding - I mistakenly thought that if the base class declaration was private that the member wouldn&#39;t exist in derived classes at all."}], "tags": [], "owner": {"reputation": 5957, "user_id": 997196, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/E5hdR.png?s=128&g=1", "display_name": "Rivasa", "link": "https://stackoverflow.com/users/997196/rivasa"}, "is_accepted": true, "score": 0, "last_activity_date": 1538593500, "creation_date": 1538593500, "answer_id": 52634056, "question_id": 52633910, "link": "https://stackoverflow.com/questions/52633910/get-my-base-class-to-increment-my-derived-class-objects-integer/52634056#52634056", "title": "Get my base class to increment my derived class objects integer", "body": "<p>Few things.</p>\n\n<ol>\n<li>You don't need a second <code>hrs</code> in the child class, as the base class has already declared this member.</li>\n<li><code>hrs</code> should be protected, so the child class can access/set it, and you can use a getter to access the value instead.</li>\n</ol>\n\n<p>Following these notes, we can edit your code a bit as follows:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass clocks{\npublic:\n    clocks();\n    void increment();\n    int getHrs();\nprotected:\n    int hrs;\n};\n\nclocks::clocks(){\n    hrs = 1;\n}\n\nint clocks::getHrs(){\n  return hrs;\n}\n\nvoid clocks::increment(){\n    hrs++;\n}\n\nclass childClock : public clocks{\n  public:\n  childClock();\n};\n\nchildClock::childClock(){\n  hrs = 2;\n}\n\nint main(){\n    clocks thing;\n    childClock thing2;\n    std::cout &lt;&lt; thing2.getHrs() &lt;&lt;\" \";\n    thing2.increment();\n    std::cout &lt;&lt; thing2.getHrs();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8212489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fe4f66cbb9a3c77e2cb7a13234b382?s=128&d=identicon&r=PG&f=1", "display_name": "user8212489", "link": "https://stackoverflow.com/users/8212489/user8212489"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 52634056, "answer_count": 1, "score": -3, "last_activity_date": 1538593500, "creation_date": 1538592821, "question_id": 52633910, "link": "https://stackoverflow.com/questions/52633910/get-my-base-class-to-increment-my-derived-class-objects-integer", "title": "Get my base class to increment my derived class objects integer", "body": "<p>In the following code, how would I get the function the base class function clocks::increment() to increment the derived class object thing2.hrs without modifying main()? If I add temporary cout statements in increment(), the call \"thing2.increment()\" seems to be incrementing a base class object's member or a random memory spot if I haven't created a base object.  Without modifying the call in main() to pass a variable (and modifying the function), is the only solution to override the function with a new definition in the derived class?</p>\n\n<pre><code>   class clocks\n{\npublic:\n    clocks();\n    void increment();\n\nprivate:\n    int hrs;\n};\nclocks::clocks()\n{\n    hrs = 1;\n}\nvoid clocks::increment()\n{\n    hrs++;\n}\n\n\n\nclass childClock : public clocks\n{\npublic:\n    childClock();\n    int hrs;\n};\nchildClock::childClock()\n{\n    hrs = 2;\n}\n\n\nint main()\n{\n    clocks thing;\n    childClock thing2;\n\n    cout &lt;&lt; thing2.hrs&lt;&lt;\" \";\n    thing2.increment();\n    cout &lt;&lt; thing2.hrs;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1538592925, "post_id": 52633836, "comment_id": 92201042, "body": "It is rare to write code that doesn&#39;t check a single function (except for <code>if(!cap.isOpened())</code>) for an error return value.  Is it the API you&#39;re using (those functions all return <code>void</code>), or are you ignoring the return values?"}, {"owner": {"reputation": 17643, "user_id": 5087436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyXHE.jpg?s=128&g=1", "display_name": "alkasm", "link": "https://stackoverflow.com/users/5087436/alkasm"}, "edited": false, "score": 1, "creation_date": 1538594293, "post_id": 52633836, "comment_id": 92201718, "body": "Please update your code with a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a> (i.e., remove all the code that is unnecessary to reproduce the error)."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1538603027, "post_id": 52633836, "comment_id": 92205376, "body": "Most likely source of problem is not checking whether reading the frame succeeded, and then feeding an empty image to <code>cvtColor</code>... which expects a non-empty input. This kind of mistake appears here at least once per day (usually more -- there&#39;s the same problem just few questions above this one...) :("}, {"owner": {"reputation": 67, "user_id": 9680641, "user_type": "registered", "profile_image": "https://graph.facebook.com/1906307822773119/picture?type=large", "display_name": "Josh Sullivan", "link": "https://stackoverflow.com/users/9680641/josh-sullivan"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1538605815, "post_id": 52633836, "comment_id": 92206193, "body": "@paulMcKenzie I do not believe it to be cause by the API due to the fact we have correctly run this code using two other computers with the exact same setup. We are using the OpenCV 3.4.3 version and the libraries that are included. None of the functions above should return void..."}, {"owner": {"reputation": 67, "user_id": 9680641, "user_type": "registered", "profile_image": "https://graph.facebook.com/1906307822773119/picture?type=large", "display_name": "Josh Sullivan", "link": "https://stackoverflow.com/users/9680641/josh-sullivan"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1538606192, "post_id": 52633836, "comment_id": 92206289, "body": "@DanMa\u0161ek I appreciate your input, however as stated above I have made sure that we are not giving the cvtColor function an empty input. The function is receiving a frame and runs through the for loop 3 times, before failing on it&#39;s forth time due to an &quot;empty&quot; input supposedly. However, I made sure that there was a frame available in the line above the cvtColor function everytime it went through the loop, and each time it said there was. Even on the forth time through. Just trying to figure out why this might be the case that it randomly fails the forth time through."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1538607007, "post_id": 52633836, "comment_id": 92206457, "body": "In that case, could you update the sample code with the check that handles the empty frame scenario? Maybe even print <code>frame</code> and show the output from the iteration where that assert happens? I mean, I could kinda understand a camera (or drivers) being wonky and failing after 3 frames... whereas the <code>frame</code> not being <code>empty</code> just before the call to <code>cvtColor</code>, and the function suddenly seeing it empty, that just doesn&#39;t make much sense (unless there&#39;s something really wrong with that machine)."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1538607217, "post_id": 52633836, "comment_id": 92206511, "body": "What&#39;s the difference between the machine where it fails and those other two where it works? Can you successfully read the camera using some other software?"}, {"owner": {"reputation": 67, "user_id": 9680641, "user_type": "registered", "profile_image": "https://graph.facebook.com/1906307822773119/picture?type=large", "display_name": "Josh Sullivan", "link": "https://stackoverflow.com/users/9680641/josh-sullivan"}, "edited": false, "score": 0, "creation_date": 1538607717, "post_id": 52633836, "comment_id": 92206634, "body": "There is no difference between the machines at all... They all have the exact same linux ubuntu versions and have all the same updates applied and OpenCv version and we are just running the code right now through the terminal. That is the reason I am very confused by this issue. We would just use one of these other computers, however we aren&#39;t able to just swap them out because we do not own them. I will have our print statements uploaded on here by 7:00pm central time"}, {"owner": {"reputation": 849, "user_id": 4469269, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/eeeca66bea8c16ff9db75f54a964c14b?s=128&d=identicon&r=PG&f=1", "display_name": "Debasish Mitra", "link": "https://stackoverflow.com/users/4469269/debasish-mitra"}, "edited": false, "score": 0, "creation_date": 1573900103, "post_id": 52633836, "comment_id": 104045427, "body": "@JoshSullivan Did you manage to find the reason for this error?"}], "owner": {"reputation": 67, "user_id": 9680641, "user_type": "registered", "profile_image": "https://graph.facebook.com/1906307822773119/picture?type=large", "display_name": "Josh Sullivan", "link": "https://stackoverflow.com/users/9680641/josh-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538620397, "creation_date": 1538592518, "last_edit_date": 1538620397, "question_id": 52633836, "link": "https://stackoverflow.com/questions/52633836/c-opencv-215-assertion-error-src-empty-in-function-cvtcolor", "title": "C++ OpenCv (-215: Assertion Error) !_src.empty() in function &#39;cvtColor&#39;", "body": "<p>I came across this error message stated below this morning and have no clue how to fix it.</p>\n\n<pre><code>terminate called after throwing an instance of 'cv::Exception' what():\n    OpenCV(3.4.3) /home/design/opencv/modules/imgproc/src/color.cpp:181 \n    error: (-215:Assertion failed) !_src.empty() in function 'cvtColor'\n</code></pre>\n\n<p>I am using linux ubuntu version 18.04 and programming in C++ using OpenCV libraries. I am trying to integrate a <a href=\"https://realsense.intel.com/\" rel=\"nofollow noreferrer\">Intel RealSense depth camera</a> into my code that I will upload below. The issue from my understanding comes from the line <code>cvtColor(frame, edges, COLOR_BGR2GRAY);</code> It is saying that <code>Frame</code> is empty.</p>\n\n<p>What I have tried to solve this problem:</p>\n\n<ol>\n<li>I have thrown in a couple print outs to the terminal to see if the camera is detected and if the program can open the camera. </li>\n<li>I have made sure that frame is not empty before entering the line of code stated above</li>\n<li>I have tried running this on 2 different machines running the same setup (These both perfectly executed the code)</li>\n<li>I used a couple print statements to see where it fails and found out that it runs through the for loop 3 times correctly, but on the 4th time through it fails everytime.</li>\n<li>I have uninstalled and reinstalled the drivers to the camera and updated its firmware</li>\n<li>I have tried each usb port to connect the camera (as we saw this was an issue with the other computer we attempted this on)</li>\n<li>I have made sure the \"frame\" is receiving a color image and not already grey scale.</li>\n</ol>\n\n<p>At this point I am clueless as to why it works just fine on two other computers and not the third (the one we actually need to use). I don't know what else to try at this point. If anyone has a clue on how to resolve this issue, i would greatly appreciate the input.</p>\n\n<p>My Code:</p>\n\n<pre><code>#include \"opencv2/opencv.hpp\"\n#include \"opencv2/imgcodecs.hpp\"\n#include \"opencv2/highgui.hpp\"\n#include \"opencv2/imgproc.hpp\"\n#include &lt;iostream&gt;\n\nusing namespace cv;\nusing namespace std;\n\nMat dst; //Black background image that we copy the source image ontop of.\nMat img; //source image\nMat cdst; //Standardized hough transformation image with Red lines\nMat cdstP;//Probalistic hough transformation image with Red lines\n\nint main(int, char**)\n{  \n    VideoCapture cap(2); // open the default camera\n    if(!cap.isOpened())  // check if we succeeded\n        return -1;\n\n    Mat edges;\n    namedWindow(\"edges\",2);\n    for(;;)\n    {\n        cap &gt;&gt; frame;\n        if(frame.empty())\n        {\n            printf(\"frame grab unsuccessful\\n\");\n\n        }\n        if(!frame.empty())\n        {\n            printf(\"frame grab successful\\n\");\n\n        }\n        Mat frame;\n        cap &gt;&gt; frame; // get a new frame from camera\n\n        cvtColor(frame, edges, COLOR_BGR2GRAY);//output array gray is copy of frame in a gray gradient scale\n     }\n\n    return 0;\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>frame grab successful\nframe grab successful\nselect timeout\nframe grab unsuccessful\nterminate called after throwing an instance of 'cv::Exception'\n  what():  OpenCV(4.0.0-pre) /home/design/opencv/modules/imgproc/src/color.cpp:181: error: (-215:Assertion failed) !_src.empty() in function 'cvtColor'\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1538592406, "post_id": 52633788, "comment_id": 92200794, "body": "<code>=</code> is <i>assignment</i>, <code>==</code> is <i>comparison</i>. Don&#39;t forget this, it&#39;s <b>important</b>. A little slip like this has created some huge bugs, so always pay careful attention. What sort of date are you using? You need to make this pseudocode actual code before we can answer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538592480, "post_id": 52633788, "comment_id": 92200828, "body": "C++20 gives you <a href=\"https://en.cppreference.com/w/cpp/chrono/year_month_day\" rel=\"nofollow noreferrer\"><code>year_month_day</code></a> which is pretty handy."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1538592574, "post_id": 52633788, "comment_id": 92200869, "body": "And since C++20&#39;s not not ratified yet and compiler support is at best experimental, perhaps <a href=\"https://github.com/HowardHinnant/date\" rel=\"nofollow noreferrer\">Howard Hinnant&#39;s date library</a> may help."}, {"owner": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "edited": false, "score": 0, "creation_date": 1538592930, "post_id": 52633788, "comment_id": 92201043, "body": "FYI, it is a poor approach <b>not</b>  to sleep or wait.  If you spin inside a loop, constantly checking, you&#39;ll tie up a cpu.  As yet another approach, you could use crontab to do something at a particular time, at least on Unix systems."}, {"owner": {"reputation": 13, "user_id": 9461874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sinpe", "link": "https://stackoverflow.com/users/9461874/sinpe"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538593219, "post_id": 52633788, "comment_id": 92201194, "body": "@tadman My apologies, forgot that. I&#39;m using standard dd/mm/yy format.  I don&#39;t know if the code would accept something like  intended_date = &quot;10/03/2018&quot; ; if std::chrono::system_clock::now(). == intended_date"}, {"owner": {"reputation": 13, "user_id": 9461874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sinpe", "link": "https://stackoverflow.com/users/9461874/sinpe"}, "reply_to_user": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "edited": false, "score": 0, "creation_date": 1538593335, "post_id": 52633788, "comment_id": 92201252, "body": "@Leonard I&#39;m aware of the benefits of using sleep or wait, but in this particular circumstance, it doesn&#39;t matter too much. It&#39;s not going to run for very long or even more than once."}, {"owner": {"reputation": 17031, "user_id": 185915, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/207045374ab195353388d9fcc77af9c5?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/185915/chad"}, "edited": false, "score": 0, "creation_date": 1538594135, "post_id": 52633788, "comment_id": 92201636, "body": "<a href=\"https://stackoverflow.com/questions/12835577/how-to-convert-stdchronotime-point-to-calendar-datetime-string-with-fraction\" title=\"how to convert stdchronotime point to calendar datetime string with fraction\">stackoverflow.com/questions/12835577/&hellip;</a> gives you a hint"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538594396, "post_id": 52633788, "comment_id": 92201762, "body": "@Sinpe There&#39;s nothing &quot;standard&quot; about <code>dd&#47;mm&#47;yyyy</code>, as if anything that&#39;s an infuriatingly ambiguous format that conflicts with the equally popular <code>mm&#47;dd&#47;yyyy</code>. <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO-8601 (<code>YYYY-MM-DD</code>)</a> is the only actual standard. In any case you need a date parser, which is probably an external library."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9461874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sinpe", "link": "https://stackoverflow.com/users/9461874/sinpe"}, "edited": false, "score": 0, "creation_date": 1538603909, "post_id": 52636124, "comment_id": 92205664, "body": "Thanks, the std:put_time() was specifically what I was looking for."}], "tags": [], "owner": {"reputation": 243, "user_id": 10269402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ru7C0.png?s=128&g=1", "display_name": "Paolo Irrera", "link": "https://stackoverflow.com/users/10269402/paolo-irrera"}, "is_accepted": true, "score": 0, "last_activity_date": 1538603121, "creation_date": 1538603121, "answer_id": 52636124, "question_id": 52633788, "link": "https://stackoverflow.com/questions/52633788/make-a-program-check-if-current-date-intended-date/52636124#52636124", "title": "Make a program check if current date = intended date", "body": "<p>I think that the standard modules chrono and iomanip offer you what you're looking for:</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;list&gt;\n\nint main()\n{\n    auto currentTime = std::chrono::system_clock::to_time_t(\n        std::chrono::system_clock::now()\n    );\n\n    std::stringstream timeStream;\n    timeStream &lt;&lt; std::put_time(std::localtime(&amp;currentTime), \"%m-%d\");\n\n    const std::list&lt;std::string&gt; birthdays = {\"12-08\", \"10-03\"};\n    for (auto&amp; date : birthdays)\n    {\n        if(timeStream.str() == date)\n        {\n            std::cout &lt;&lt; \"Happy birthday!!\\n\";\n        }\n        else\n        {\n            std::cout &lt;&lt; \"Try another day!!\\n\";\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9461874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sinpe", "link": "https://stackoverflow.com/users/9461874/sinpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 52636124, "answer_count": 1, "score": 0, "last_activity_date": 1538603121, "creation_date": 1538592294, "last_edit_date": 1538593159, "question_id": 52633788, "link": "https://stackoverflow.com/questions/52633788/make-a-program-check-if-current-date-intended-date", "title": "Make a program check if current date = intended date", "body": "<p>Is there a way I can make c++ wait until an intended date for when it should proceed with the rest of the code? </p>\n\n<p>I don't want it to wait using something like wait or sleep, I actually want it to just check using an if statement. Extremely bad pseudocode example:</p>\n\n<pre><code>if current_date == intended_date\n    cout &lt;&lt; \"Happy Birthday\";\nend \n</code></pre>\n\n<p>I want the program to only say Happy Birthday if the condition of it being a birthday is met. I know you can grab current date using std::chrono::system_clock::now(). However, I don't know how to format the intended_date so that it can check it against the current date.</p>\n"}, {"tags": ["c++", "opengl", "depth-buffer", "stencil-buffer"], "comments": [{"owner": {"reputation": 6020, "user_id": 4052193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6062c93ce987aa90ac59d06e758f03b6?s=128&d=identicon&r=PG&f=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/4052193/columbo"}, "edited": false, "score": 3, "creation_date": 1538592208, "post_id": 52633657, "comment_id": 92200686, "body": "Can you solve it by rendering the dots twice? Render them without depth-test or depth-write. Then render them again with depth-write, but disable writing to the framebuffer (see glColorMask). Then render the meshes."}, {"owner": {"reputation": 26112, "user_id": 8526705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buwQ5.jpg?s=128&g=1", "display_name": "Dacre Denny", "link": "https://stackoverflow.com/users/8526705/dacre-denny"}, "edited": false, "score": 1, "creation_date": 1538592248, "post_id": 52633657, "comment_id": 92200715, "body": "Can you include a picture to better explain what your desired result is?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1538600425, "post_id": 52633657, "comment_id": 92204417, "body": "<a href=\"https://stackoverflow.com/questions/4421441/\">stackoverflow.com/questions/4421441</a>?"}, {"owner": {"reputation": 1848, "user_id": 5505741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K0RGKJuJSu4/AAAAAAAAAAI/AAAAAAAAAFw/aodTCStN3gc/photo.jpg?sz=128", "display_name": "Michael Nastenko", "link": "https://stackoverflow.com/users/5505741/michael-nastenko"}, "edited": false, "score": 1, "creation_date": 1538608910, "post_id": 52633657, "comment_id": 92206918, "body": "If I understood you correctly you should draw meshes first, then draw points with depth test enabled and depth write disabled."}], "answers": [{"comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1538671581, "post_id": 52639390, "comment_id": 92235254, "body": "@Rabbid76: Presumably, exactly what the OP wants to have happen: the blue data will take on the depth of the underlying mesh. That is, the &quot;points&quot; aren&#39;t overriding the depth of the mesh."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 1, "creation_date": 1538672534, "post_id": 52639390, "comment_id": 92235710, "body": "@Rabbid76: No, the red point won&#39;t be drawn on top of the <i>mesh</i>. It&#39;s all a question of what should have priority."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 2, "last_activity_date": 1538629708, "creation_date": 1538629708, "answer_id": 52639390, "question_id": 52633657, "link": "https://stackoverflow.com/questions/52633657/mixing-gl-always-with-gl-less-in-opengl/52639390#52639390", "title": "Mixing GL_ALWAYS with GL_LESS in OpenGl", "body": "<p>As Michael Nastenko said in the comments, the effect you want to achieve requires drawing the meshes, then turn <a href=\"https://www.khronos.org/opengl/wiki/Depth_Mask\" rel=\"nofollow noreferrer\">depth <em>writing</em> off</a>, then draw the \"points\" (with the depth <em>test</em> still on). Obviously, you'll have to turn the depth writes back on before drawing the next frame.</p>\n\n<p>By turning off depth writes (with <code>glDepthMask(GL_FALSE)</code>), you ensure that the \"points\" don't write their depth to the depth buffer. So each \"point\" is only being tested against the depth of the scene before you started drawing the \"points\". If two \"points\" overlap, then they will be drawn in render-order.</p>\n"}], "owner": {"reputation": 169, "user_id": 1063241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be5035ac071be350cd62c6772e6d846?s=128&d=identicon&r=PG", "display_name": "Cristi Stoica", "link": "https://stackoverflow.com/users/1063241/cristi-stoica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 52639390, "answer_count": 1, "score": 0, "last_activity_date": 1538629708, "creation_date": 1538591778, "last_edit_date": 1538600136, "question_id": 52633657, "link": "https://stackoverflow.com/questions/52633657/mixing-gl-always-with-gl-less-in-opengl", "title": "Mixing GL_ALWAYS with GL_LESS in OpenGl", "body": "<p>I have:</p>\n\n<ol>\n<li>a set of dots</li>\n<li>a set of meshes</li>\n</ol>\n\n<p>I need</p>\n\n<ol>\n<li>the meshes to be drawn in the correct z order, based on depth. For this I used <code>glDepthFunc(GL_LESS)</code> or <code>glDepthFunc(GL_LEQUAL)</code>, or <code>glEnable(GL_DEPTH_TEST)</code></li>\n<li>the dots to be rendered in the order of drawing, ignoring the depth. For this I used <code>glDepthFunc(GL_ALWAYS)</code>, or <code>glDisable(GL_DEPTH_TEST)</code>. They are drawn using <code>GL_POINTS</code> and <code>glVertex3d</code></li>\n<li>the meshes to be rendered as if the dots are in the correct depth.</li>\n</ol>\n\n<p>Fig. 1 shows the dots, as squared, vs the meshes, when the depth is considered. Fig. 2 shows how it looks when the dots are rendered ignoring the depth (so the red dots appear on top of the blue dots regardless their depth), but the meshes are always behind the dots, regardless the depths. I would like the meshes to be in the same relation with the dots as in Fig. 1, but the dots be in the same relation with each other as in Fig. 2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FfkSy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FfkSy.png\" alt=\"enter image description here\"></a></p>\n\n<p>I realize that I will get into something like a mesh being between two dots, but the dot with greater depth rendered on top of the dot with lower depth, but in this case it would be fine if for the dot which is closer is rendered on top.</p>\n\n<p>Whatever I tried it made the meshes be either behind all dots, or in front of all dots, regardless the depth of each object. What I tried was to draw the dots, and it works as needed, draw the meshes and it works as needed, but when combined, it doesn't work, whether I draw first the dots or the meshes.</p>\n\n<p>Q: Is it possible, and if yes, how can I do this? </p>\n"}, {"tags": ["c++", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1538638700, "post_id": 52633458, "comment_id": 92215182, "body": "From your question it is unclear where in the code write to <code>Lattice</code> happen. It is not even clear where <code>N</code> and <code>M</code> come from and how the swap affects further iterations. &quot;entirely independently&quot; can&#39;t be true if you need this &quot;exchange&quot;. Please try to clarify how <code>Lattice</code> is divided up, where read and write accesses to which parts are happening."}, {"owner": {"reputation": 21, "user_id": 5029223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2733657b220de1895bac20f151bf62d6?s=128&d=identicon&r=PG&f=1", "display_name": "I am tired", "link": "https://stackoverflow.com/users/5029223/i-am-tired"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1538661044, "post_id": 52633458, "comment_id": 92228697, "body": "Lattice reads and writes are occurring wherever &quot;//Monte Carlo interations here&quot; is commented. I&#39;m guessing that my approach with Lattice is not the best but I need to compare values derived from Lattice between simulations. N and M are irrelevant placeholders, the take away is that the Lattice[] that each simulation has access to may be swapped at &#39;random&#39; between simulations. The simulation then continues iterating with its &#39;new&#39; Lattice."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1538662679, "post_id": 52633458, "comment_id": 92229845, "body": "If you swap elements of <code>Lattice</code> &quot;at random&quot;, you are totally out of luck and must protect each and every access to <code>Lattice</code> with a critical section. Try to make the code truly independent. The question as is cannot be answered in a constructive way without clear information about the access patterns."}, {"owner": {"reputation": 21, "user_id": 5029223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2733657b220de1895bac20f151bf62d6?s=128&d=identicon&r=PG&f=1", "display_name": "I am tired", "link": "https://stackoverflow.com/users/5029223/i-am-tired"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1538671669, "post_id": 52633458, "comment_id": 92235301, "body": "Sorry I didn&#39;t clarify. Lattice is a 4D array(Lattice[numruns][LSize][LSize][LSize]). Each simulation is only swapping the last three indices of Lattice. I.e. Simulation 1 only touches Lattice[numruns=1][][][]. The whole Lattice construct can be completely different - I just need a way for each simulation to independently work on its distinct Lattice (Lattice[LSize][LSize][LSize]) and then be able to explicitly compare and swap Lattices between threads."}], "owner": {"reputation": 21, "user_id": 5029223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2733657b220de1895bac20f151bf62d6?s=128&d=identicon&r=PG&f=1", "display_name": "I am tired", "link": "https://stackoverflow.com/users/5029223/i-am-tired"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538591015, "creation_date": 1538591015, "question_id": 52633458, "link": "https://stackoverflow.com/questions/52633458/open-mp-force-periodic-synchronization", "title": "Open MP force periodic synchronization", "body": "<p>I am trying to use Open MP (C++) to parallelize my parallel tempering code for Monte Carlo Simulations on a 3D Ising Lattice. Here N (generally something like 8) independent Monte Carlo simulations are run at differing temperatures. The simulations and all their variables/quantities are completely independent from one another. \nPeriodically one must stop the simulations and attempt to exchange their configurations - this is where the trouble is. Attempting to force the threads to stop (so that swapping can occur properly without quantities being changed at the same time) using a barrier fails and the compiler gives the error: \"work-sharing region may not be closely nested inside of work-sharing, critical, ordered, master or explicit task region.\"</p>\n\n<p>Is there any way around this? How can I restructure my code so that it will compile and run? I have looked through a number of similar threads but in my case loops cannot be separated easily if at all (simulation progress must be retained).</p>\n\n<p>Here is a rough outline of my code (leaving lots out).</p>\n\n<pre><code>#include \"omp.h\"//and other headers\n\n#define LSize 10\n#define TotalRuns 10\n#define MC_WarmUP 10000\n#define MC_Samples 50000\n\nusing namespace std;\nint main()\n{\n     //rng initialized\n     int numruns;\n     int Lattice[TotalRuns][LSize][LSize][LSize];//explicit (for swapping)\n\n     omp_set_num_threads(TotalRuns);\n     #pragma omp parallel for//run simulations entirely independently\n     for (numruns=0;numruns&lt;TotalRuns;numruns++)\n     {\n          int counter,counter2,counter3;\n          double SimEnergy[TotalRuns];\n          double Temp;\n          //file setup (each simulation also prints its results to file)\n          //Lattice[numruns] is initialized to random +1/-1's\n\n          for (counter=70;counter&gt;1;counter++)//i.e for a number of temperatures\n          {\n              Temp = 0.1*(double)counter + 0.1*(double)numruns;//set temperature\n              for (counter2=0;counter2&lt;MC_WarmUP;counter2++)//equilibrate the simulation\n              {\n                   //perform Monte Carlo iterations here\n\n              }\n              for (counter2=0;counter2&lt;(NSamples/SwapSteps);counter2++)//sampling phase\n              {\n                   for (counter3=0;counter3&lt;SwapSteps;counter3++)//take samples ever SwapSteps interations\n                   {\n                        //perform Monte Carlo iterations here\n                        //save simulation quantities periodically\n                   }\n                   SimEnergy[numruns] = E_Calc(Lattice,numruns);//calculates the energy of the lattice for a given simulation\n\n                   #pragma omp barrier//need everything to stop at this point\n                   #pragma omp single//only one thread does this\n                   {\n                        //bunch of stuff here but most importantly\n                        swap(Lattice[N],Lattice[M])//may occur where N,M are between 0 .. TotalRuns and N!=M.\n                   }\n              }\n              //save averaged data to file\n          }\n     }\n     return 0;\n}\n</code></pre>\n\n<p>Code is quite simple and perhaps not the best way to go about things. Question really is how can I freeze or lock threads such that the swap can take place without the Lattice being modified during the swap operations? Any help is appreciated!</p>\n"}, {"tags": ["c++", "opengl", "glm-math"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 2, "creation_date": 1538591572, "post_id": 52633438, "comment_id": 92200340, "body": "Could you please add the VAO setup? glVertexAttribPointer and so on?"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1538593365, "post_id": 52633438, "comment_id": 92201264, "body": "There is no obvious issue in the code."}, {"owner": {"reputation": 1848, "user_id": 5505741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K0RGKJuJSu4/AAAAAAAAAAI/AAAAAAAAAFw/aodTCStN3gc/photo.jpg?sz=128", "display_name": "Michael Nastenko", "link": "https://stackoverflow.com/users/5505741/michael-nastenko"}, "edited": false, "score": 1, "creation_date": 1538609078, "post_id": 52633438, "comment_id": 92206968, "body": "Use RenderDoc to capture your frame. Them you can analyze what actually goes to API and you can try to figure out why it looks like this."}, {"owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "reply_to_user": {"reputation": 1848, "user_id": 5505741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K0RGKJuJSu4/AAAAAAAAAAI/AAAAAAAAAFw/aodTCStN3gc/photo.jpg?sz=128", "display_name": "Michael Nastenko", "link": "https://stackoverflow.com/users/5505741/michael-nastenko"}, "edited": false, "score": 0, "creation_date": 1538609884, "post_id": 52633438, "comment_id": 92207136, "body": "@MichaelNastenko unfortunately I&#39;m working on macOS and it seems that RenderDoc does not work in mac."}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538643331, "post_id": 52633438, "comment_id": 92217688, "body": "Can you also add how you set up the index buffer? Also, I believe the stride calculation is wrong. If the data is compacted, the stride should be the size of each buffer element, if its interleaved, it should be computed after you have added all the parameters to the the buffer. Are you using 1 vbo for all the vertex attributes or each has its own?"}, {"owner": {"reputation": 1848, "user_id": 5505741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K0RGKJuJSu4/AAAAAAAAAAI/AAAAAAAAAFw/aodTCStN3gc/photo.jpg?sz=128", "display_name": "Michael Nastenko", "link": "https://stackoverflow.com/users/5505741/michael-nastenko"}, "edited": false, "score": 1, "creation_date": 1538652714, "post_id": 52633438, "comment_id": 92223220, "body": "@No&#232;Murr Then use Intel GPA"}, {"owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "reply_to_user": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538680820, "post_id": 52633438, "comment_id": 92238873, "body": "@Nadir You are probably right, because if I change the stride with 0 the output changes. But I cannot understand why... the Stride is 28 that is the exact value of <code>7 * sizeof(float)</code>."}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 1, "creation_date": 1538722828, "post_id": 52633438, "comment_id": 92250132, "body": "@No&#232;Murr If you have all your data compated (each attribute like vertex, normals, etc. are on its own vbo or they are in the same vbo but compated, which means, all vertex first, then all normals, etc..), the stride should just be the size of each element. In the case of vertex, for example, the stride should be <code>sizeof(float) * 3</code> (or <code>sizeof(float) * 4</code> if you are sending 4 components). If they are interleaved, the stride will be the same for all, and is computed by adding the size of each elements (<code>sizeof(float) * 3 + sizeof(float) * 3</code> if you have vertices and normals only)."}, {"owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "reply_to_user": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538730887, "post_id": 52633438, "comment_id": 92254471, "body": "@Nadir I have added the class VertexBuffer to the question. I have all vertices in one buffer: [[vertex1][vertex2][vertex...][vertexN]] and each vertex has the layout explained in the question [x, y, z, r, g, b, a] so first coordinates and then the colors. Is the stride of <code>7 * sizeof(float)</code> (28) correct?"}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538732059, "post_id": 52633438, "comment_id": 92255163, "body": "@No&#232;Murr yes, they seem all correct (both stride and offset). Could it be that you are adding the faces in a clock wise order? Try <code>glDisable(GL_CULLFACE)</code> or <code>glFrontFace(GL_CW)</code> to see if your sphere appear?"}, {"owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "reply_to_user": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538735918, "post_id": 52633438, "comment_id": 92257343, "body": "@Nadir same result with <code>glFrontFace(GL_CW)</code> and with <code>glDisable(GL_CULL_FACE)</code> (the macro <code>GL_CULLFACE</code> does not exists in my OpenGL&#39;s headers so I suppose it is equal to <code>GL_CULL_FACE</code>)"}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538814838, "post_id": 52633438, "comment_id": 92283333, "body": "@No&#232;Murr yes, <code>GL_CULLFACE</code> does not exists, it was a typo, sorry. One last resort I can think of, how do you compute the <code>indicesNumber</code> you pass to the draw command?"}, {"owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "reply_to_user": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1538919046, "post_id": 52633438, "comment_id": 92304909, "body": "@Nadir I use the size of std::vector: <code>indicesNumber = static_cast&lt;unsigned int&gt;(indices.size());</code>"}, {"owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "edited": false, "score": 0, "creation_date": 1538988956, "post_id": 52633438, "comment_id": 92323826, "body": "as you can see, I found the solution. Thanks for your help."}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "is_accepted": true, "score": 0, "last_activity_date": 1538988898, "creation_date": 1538988898, "answer_id": 52698648, "question_id": 52633438, "link": "https://stackoverflow.com/questions/52633438/sphere-mesh-in-modern-opengl/52698648#52698648", "title": "Sphere mesh in modern OpenGL", "body": "<p>I found the solution. It was a very stupid error: The constructor of the VertexBuffer class needs the size of the buffer in bytes but when I called it I passed only the size of the std::vector that is the number of elements.</p>\n"}], "owner": {"reputation": 354, "user_id": 7468692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208091754318419/picture?type=large", "display_name": "No&#232; Murr", "link": "https://stackoverflow.com/users/7468692/no%c3%a8-murr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 1, "accepted_answer_id": 52698648, "answer_count": 1, "score": -2, "last_activity_date": 1538988898, "creation_date": 1538590936, "last_edit_date": 1538918933, "question_id": 52633438, "link": "https://stackoverflow.com/questions/52633438/sphere-mesh-in-modern-opengl", "title": "Sphere mesh in modern OpenGL", "body": "<p>I'm trying to create a triangle mesh of a sphere surface and draw it with OpenGL 4.1.</p>\n\n<p>This is the code that I'm currently using obtained from the second answer of that <a href=\"https://stackoverflow.com/questions/7687148/drawing-sphere-in-opengl-without-using-glusphere\">question</a>, The vertex layout is [x, y, z, r, b, g, a] that's why there is 7 float foreach vertex:</p>\n\n<pre><code>std::vector&lt;float&gt; vertices;\nstd::vector&lt;unsigned int&gt; indices;\nconst float dLambda = 2 * glm::pi&lt;float&gt;() / meridianNumber;\nconst float dPhi = glm::pi&lt;float&gt;() / parallelNumber;\nunsigned int lastVertex = 0;\n\n\nfor (int i = 0; i &lt; parallelNumber; ++i) {\n    for (int j = 0; j &lt; meridianNumber; ++j) {\n        std::cout &lt;&lt; \"lot: \" &lt;&lt; glm::degrees(j * dLambda);\n        std::cout &lt;&lt; \"\\tlat: \" &lt;&lt; glm::degrees(i * dPhi);\n        std::cout &lt;&lt; std::endl;\n        float lambda1 = j * dLambda;\n        float phi1 = i * dPhi;\n        float lambda2 = j+1 == parallelNumber   ? 2 * glm::pi&lt;float&gt;()\n                                                : (j+1) * dLambda;\n        float phi2 = i+1 == meridianNumber   ? glm::pi&lt;float&gt;()\n                                             : (i+1) * dPhi;\n\n        // vertex 1\n        vertices.emplace_back(cosf(lambda1) * sinf(phi1) * radius);\n        vertices.emplace_back(cosf(phi1) * radius);\n        vertices.emplace_back(sinf(lambda1) * sinf(phi1) * radius);\n        vertices.emplace_back(0.5f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n\n        // vertex 2\n        vertices.emplace_back(cosf(lambda1) * sinf(phi2) * radius);\n        vertices.emplace_back(cosf(phi2) * radius);\n        vertices.emplace_back(sinf(lambda1) * sinf(phi2) * radius);\n        vertices.emplace_back(0.5f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n\n        // vertex 3\n        vertices.emplace_back(cosf(lambda2) * sinf(phi1) * radius);\n        vertices.emplace_back(cosf(phi1) * radius);\n        vertices.emplace_back(sinf(lambda2) * sinf(phi1) * radius);\n        vertices.emplace_back(0.5f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n\n        // vertex 4\n        vertices.emplace_back(cosf(lambda2) * sinf(phi2) * radius);\n        vertices.emplace_back(cosf(phi2) * radius);\n        vertices.emplace_back(sinf(lambda2) * sinf(phi2) * radius);\n        vertices.emplace_back(0.5f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n        vertices.emplace_back(1.0f);\n\n        indices.emplace_back(lastVertex);\n        indices.emplace_back(lastVertex+1);\n        indices.emplace_back(lastVertex+2);\n\n        indices.emplace_back(lastVertex+1);\n        indices.emplace_back(lastVertex+3);\n        indices.emplace_back(lastVertex+2);\n\n        lastVertex += 4;\n    }\n</code></pre>\n\n<p>But I am doing something wrong because that's what I'm drawing:\n<a href=\"https://i.stack.imgur.com/qPIbY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qPIbY.png\" alt=\"Images of result\"></a></p>\n\n<p>the code that I'm using to draw is:</p>\n\n<pre><code>GLCall(glDrawElements(\n    GL_TRIANGLES,\n    indicesNumber,\n    GL_UNSIGNED_INT,\n    (const void*) 0\n));\n</code></pre>\n\n<p><strong>EDIT 1:</strong>\nThe VAO settings are pretty complicated because I wrote a little layer of abstraction over opengl... \nI have a class called VertexBuffer that creates, keeps alive and destroys an OpenGL array buffer.\nAnother class IndexBuffer is very similar to the previous one that manages the Element array buffer. \nThis two classes are very simple to use they can be constructed, binded, unbinded and destroyed, nothing more.\nThere is a third class that represents a layout of a single vertex in an OpenGL vertex buffer; this class called VertexLayout contains all the data that is necessary to call the glVertexAttribPointer.</p>\n\n<p>hpp:</p>\n\n<pre><code>class VertexLayout {\nprivate:\n    struct Element {\n        unsigned int type;\n        unsigned int count;\n        unsigned char normalized;\n        size_t typeSize;\n\n        Element(\n            unsigned int type, unsigned int count, unsigned char normalized,\n            size_t typeSize\n        );\n    };\n    std::vector&lt;Element&gt; elements;\n    unsigned int stride;\n\npublic:\n\n    VertexLayout();\n\n    template&lt;typename T&gt;\n    VertexLayout &amp;push(unsigned int count, unsigned char normalized = GL_FALSE){\n        std::fputs(\n            \"this function has to be implemented for desired type\",\n            stderr\n        );\n        assert(false);\n        return *this;\n    }\n\n    const std::vector&lt;Element&gt; &amp;getElements() const;\n\n    unsigned int getStride() const;\n\n};\n</code></pre>\n\n<p>cpp:</p>\n\n<pre><code>template&lt;&gt;\nVertexLayout &amp;VertexLayout::push&lt;unsigned int&gt;(\n    unsigned int count, unsigned char normalized\n) {\n    elements.emplace_back(\n        GL_UNSIGNED_INT, count, normalized, sizeof(unsigned int)\n    );\n    stride += count * sizeof(unsigned int);\n    return *this;\n};\n\ntemplate&lt;&gt;\nVertexLayout &amp;VertexLayout::push&lt;unsigned char&gt;(\n    unsigned int count, unsigned char normalized\n) {\n    elements.emplace_back(\n        GL_UNSIGNED_BYTE, count, normalized, sizeof(unsigned char)\n    );\n    stride += count * sizeof(unsigned char);\n    return *this;\n};\n\ntemplate&lt;&gt;\nVertexLayout &amp;VertexLayout::push&lt;float&gt;(unsigned int count, unsigned char normalized){\n    elements.emplace_back(GL_FLOAT, count, normalized, sizeof(float));\n    stride += count * sizeof(float);\n    return *this;\n}\n\nVertexLayout::Element::Element(\n    unsigned int type, unsigned int count,\n    unsigned char normalized, size_t typeSize\n) : type(type), count(count), normalized(normalized), typeSize(typeSize) {}\n\nconst std::vector&lt;VertexLayout::Element&gt; &amp;VertexLayout::getElements()   const {\n    return elements;\n}\n\nunsigned int VertexLayout::getStride() const {\n    return stride;\n}\n\nVertexLayout::VertexLayout() : stride(0) {}\n</code></pre>\n\n<p>So an instance of VertexLayout should be created foreach VertexBuffer object and foreach opengl attribute should be called a <code>push&lt;type&gt;(numberOfElementOfThatType)</code>. </p>\n\n<p>The fourth and last class is the VertexArray class that represents a VAO: this last class keeps trace of all the VertexBuffer and IndexBuffer objects that are connected to the vao and sets the layout calling glVertexAttribPointer when a VertexBuffer is added using the following method:</p>\n\n<pre><code>void VertexArray::addBuffer(\n    const VertexBuffer &amp;buffer, const VertexLayout &amp;layout\n) {\n    GLCall(glBindVertexArray(id));\n    buffer.bind();\n    const auto &amp;elements = layout.getElements();\n    size_t offset = 0;\n    for (unsigned int i = 0; i &lt; elements.size(); ++i) {\n        const auto &amp;element = elements[i];\n        GLCall(glEnableVertexAttribArray(i));\n        GLCall(glVertexAttribPointer(\n            i, element.count, element.type, element.normalized,\n            layout.getStride(), (const void *)offset\n        ));\n        offset += element.count * element.typeSize;\n    }\n    vertexBuffers.emplace_back(buffer);\n}\n</code></pre>\n\n<p>GLCall is a macro that does nothing in release while in debug is clears the OpenGL erros and prints the new errors.</p>\n\n<p><strong>EDIT 2:</strong>\nThis is the class VertexBuffer that represents one VBO:</p>\n\n<p>hpp</p>\n\n<pre><code>class VertexBuffer {\nprivate: // static\n    static std::map&lt;unsigned int, unsigned int&gt; references;\n\nprivate: // member\n    unsigned int rendererID;\n\npublic:\n    VertexBuffer();\n\n    VertexBuffer(\n        const void *data, unsigned long size,\n        unsigned int usage = GL_STATIC_DRAW\n    );\n    VertexBuffer(const VertexBuffer &amp;oth);\n    VertexBuffer &amp;operator=(const VertexBuffer &amp;rhs);\n\n    ~VertexBuffer();\n\n    void bind() const;\n    void unbind() const;\n};\n</code></pre>\n\n<p>cpp: </p>\n\n<pre><code>std::map&lt;unsigned int, unsigned int&gt; VertexBuffer::references;\n\nVertexBuffer::VertexBuffer(\n    const void *data,\n    unsigned long size,\n    unsigned int usage\n) {\n    GLCall(glGenBuffers(1, &amp;rendererID));\n    GLCall(glBindBuffer(GL_ARRAY_BUFFER, rendererID));\n    GLCall(glBufferData(GL_ARRAY_BUFFER, size, data, usage));\n    references.insert_or_assign(rendererID, 1);\n}\n\nVertexBuffer::VertexBuffer(const VertexBuffer &amp;oth) {\n    if (oth.rendererID != 0){\n        auto ref = references.find(oth.rendererID);\n        assert(ref != references.end());\n        ref-&gt;second++;\n    }\n    rendererID = oth.rendererID;\n}\n\nVertexBuffer &amp;VertexBuffer::operator=(const VertexBuffer &amp;rhs) {\n    if (rendererID != 0) {\n        auto refs = references.find(rendererID);\n        assert(refs != references.end());\n\n        if (--refs-&gt;second == 0) {\n            GLCall(glDeleteBuffers(1, &amp;rendererID));\n            references.erase(refs);\n        }\n    }\n    if (rhs.rendererID != 0){\n        auto ref = references.find(rhs.rendererID);\n        assert(ref != references.end());\n        ref-&gt;second++;\n    }\n    rendererID = rhs.rendererID;\n\n    return *this;\n}\n\nVertexBuffer::VertexBuffer() : rendererID(0) {}\n\nVertexBuffer::~VertexBuffer() {\n    if (rendererID != 0) {\n        auto ref = references.find(rendererID);\n        assert(ref != references.end());\n        if (--ref-&gt;second == 0) {\n            GLCall(glDeleteBuffers(1, &amp;rendererID));\n            references.erase(ref);\n        }\n    }\n}\n\nvoid VertexBuffer::bind() const {\n    GLCall(glBindBuffer(GL_ARRAY_BUFFER, rendererID));\n}\n\nvoid VertexBuffer::unbind() const {\n    GLCall(glBindBuffer(GL_ARRAY_BUFFER, 0));\n}\n</code></pre>\n\n<p>In the sphere I have only one big buffer that contains both positions and colors. </p>\n"}, {"tags": ["c++", "enums", "c++17", "constexpr", "stdoptional"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1538592062, "post_id": 52633405, "comment_id": 92200615, "body": "Just so you know, <code>static_assert(false)</code> makes the primary template ill-formed with no diagnostic required. One compiler may accept it silently, another may fire the static assertion immediately."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1538592443, "post_id": 52633405, "comment_id": 92200812, "body": "@StoryTeller Does statically asserting with std::false_type fix that? I tried std::false_type and Igor R&#39;s suggestion for false_t&lt;test_enum&gt; and Visual Studio shows no change."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1538592608, "post_id": 52633405, "comment_id": 92200892, "body": "Oh it&#39;s not an attempt to answer your question. Just wanted to warn against something that may rear its head later. The false constant expression must be dependant. Since <code>std::false_type</code> by itself is also not dependant it shares the same problem."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1538592678, "post_id": 52633405, "comment_id": 92200924, "body": "Cool, I appreciate it."}, {"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 0, "creation_date": 1538593849, "post_id": 52633405, "comment_id": 92201474, "body": "BTW, what is &quot;line 30&quot;?"}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538593962, "post_id": 52633405, "comment_id": 92201534, "body": "Ah, my bad. It&#39;s <code>static_assert(from_int&lt;test_enum&gt;(1));</code> in main()."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1538594027, "post_id": 52633405, "comment_id": 92201568, "body": "Please note that this is fixed in VS v15.9.0-pre.1.0 (cl v19.15.26726)."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1538594112, "post_id": 52633405, "comment_id": 92201625, "body": "@Swordfish Thanks for the heads up! How do you know that?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1538594187, "post_id": 52633405, "comment_id": 92201671, "body": "I compiled your code with it."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538594236, "post_id": 52633405, "comment_id": 92201691, "body": "Legit, thanks for testing it out! If you post that as a separate answer, I&#39;d be happy to mark this as solved."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538592267, "post_id": 52633716, "comment_id": 92200727, "body": "Unfortunately, that (and static_asserting with std::false_type) result in the same error in Visual Studio. Did the original code compile under GCC 7?  EDIT: I see from StoryTeller&#39;s comment that Visual Studio should technically not accept the original template."}, {"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "reply_to_user": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538592586, "post_id": 52633716, "comment_id": 92200883, "body": "@tstevens MSVC is another story... Typically, it has a poor compliance with the standard."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538592793, "post_id": 52633716, "comment_id": 92200981, "body": "Yeah, I believe it. MSDN claims that Visual Studio 2017 is fully compliant with std::optional, so I guess this may be a bug."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538593584, "post_id": 52633716, "comment_id": 92201363, "body": "@tstevens - To be exact, MSVC doesn&#39;t have to reject it. The standard doesn&#39;t require a diagnostic, so it&#39;s not exactly non-conformant on MSVC&#39;s behalf. One can argue it&#39;s a poor QoI, however."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1538593719, "post_id": 52633716, "comment_id": 92201416, "body": "@StoryTeller I wasn&#39;t very clear -- I meant the fact that Visual Studio rejects the call to from_int() in main (even after removing from_int()&#39;s static assert) seems like a bug."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538594187, "post_id": 52633716, "comment_id": 92201670, "body": "@tstevens - Oh, I was referring to your first comment. Apologies for any and all confusion."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1538594589, "post_id": 52633716, "comment_id": 92201854, "body": "@StoryTeller No worries, thanks for looking at this!"}], "tags": [], "owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1538592432, "last_edit_date": 1592644375, "creation_date": 1538591983, "answer_id": 52633716, "question_id": 52633405, "link": "https://stackoverflow.com/questions/52633405/c17-using-stdoptional-to-evaluate-if-enum-contains-value/52633716#52633716", "title": "C++17: using std::optional to evaluate if enum contains value", "body": "<p>It seems that the Standard defines such a code as ill-formed, no diagnostics required. Take a look at the following statements:</p>\n<blockquote>\n<p>[The validity of a template may be checked prior to any instantiation.\n[\u2009Note: Knowing which names are type names allows the syntax of every\ntemplate to be checked in this way. \u2014\u2009end note\u2009] The program is\nill-formed, no diagnostic required, if:</p>\n<p>&lt;...&gt;</p>\n<p>(8.4) a hypothetical\ninstantiation of a template immediately following its definition would\nbe ill-formed due to a construct that does not depend on a template\nparameter...]    <a href=\"http://eel.is/c++draft/temp#res-8\" rel=\"nofollow noreferrer\">1</a></p>\n</blockquote>\n<p>To make it well-formed, do not use <code>static_assert(false)</code>. Instead, use the following trick (compiles with GCC 7 and CLang 7):</p>\n<pre><code>#include &lt;optional&gt;\n\nenum class test_enum : int {\n    VALUE_0 = 0,\n    VALUE_1 = 1\n};\n\ntemplate&lt;typename T&gt; \nconstexpr bool false_t = false;\n\n// Template function to perform check\ntemplate&lt;typename T&gt;\nconstexpr std::optional&lt;T&gt; from_int(int value)\n{\n    static_assert(false_t&lt;T&gt;, &quot;Not implemented for this type; see build output&quot;);\n    return std::optional&lt;T&gt;();\n}\n\n// Specialization for test_enum\ntemplate&lt;&gt;\nconstexpr std::optional&lt;test_enum&gt; from_int&lt;test_enum&gt;(int value)\n{\n    switch (value) {\n        case static_cast&lt;int&gt;(test_enum::VALUE_0) :\n            return test_enum::VALUE_0;\n        case static_cast&lt;int&gt;(test_enum::VALUE_1):\n            return test_enum::VALUE_1;\n        default:\n            return std::optional&lt;test_enum&gt;();\n    }\n}\n\nint main()\n{\n    static_assert(from_int&lt;test_enum&gt;(1));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538594545, "post_id": 52634247, "comment_id": 92201833, "body": "Sweet, thank you. I&#39;ll see if I can suppress the error for now and make a note to remove the workaround after updating."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 0, "last_activity_date": 1538594331, "creation_date": 1538594331, "answer_id": 52634247, "question_id": 52633405, "link": "https://stackoverflow.com/questions/52633405/c17-using-stdoptional-to-evaluate-if-enum-contains-value/52634247#52634247", "title": "C++17: using std::optional to evaluate if enum contains value", "body": "<p>The code in question compiles without warnings or errors using <code>cl</code> v19.15.26726 (Visual Studio version 15.9.0-pre.1.0)</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538603637, "post_id": 52634655, "comment_id": 92205584, "body": "Why is tag dispatching better? To me, specializing from_int() is more readable because it doesn&#39;t require writing from_int_impl(), which is what I was trying to avoid in the first place. I&#39;m using this in a library where I don&#39;t want the library user to have to consider the differences between from_int() and from_int_impl() -- I&#39;d rather them only see from_int()."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538607000, "post_id": 52634655, "comment_id": 92206456, "body": "Because it allows customization to occur in the namespace of the enum.  Because the <code>=delete</code> is legal, while <code>static_assert(false</code> is not.  Because workarounds of <code>static_assert(false</code> are only arguably legal (depending on interpretation of standard requirements that require templates functions to have a valid body for some type). Because <code>_impl</code> is optional; remove it and the code still works.  Because specialization of template functions is athema that introducrs a highly counterintuitive counterpoint to already complex C++ overload rules.  Why do you ask?"}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538676088, "post_id": 52634655, "comment_id": 92237317, "body": "Appreciate the followup. I should have specified in my original question that the test_enum is in namespace A::B, where from_int is in namespace A. I&#39;ve been able to specialize the template just fine in different namespaces. From the end user&#39;s perspective, using tag_t just changes the function call from from_int&lt;test_enum&gt;() to from_int(tag_t&lt;test_enum&gt;). How is that thematically different from specializing the template function directly?"}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538676170, "post_id": 52634655, "comment_id": 92237356, "body": "Also, I&#39;m inclined to keep the static assert because it allows me to provide a simple, customized error message to the user (you&#39;ve seen the usual template compiler errors -- they&#39;re not exactly easy to read if your user isn&#39;t super familiar with C++)."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 1, "creation_date": 1538677399, "post_id": 52634655, "comment_id": 92237945, "body": "@tstevens The user never has to use <code>tag_t</code> unless adding a new overload; user-code just does <code>some_ns::from_int&lt;test_enum&gt;</code>..  Template specialization only works in the namespace where the template was originally declared.  I understand why you want to use <code>static_assert( false, </code> or a hack to do so; I am saying that doing so while justifying your program is well formed requires a lot of faith in a specific reading of the standard that your compiler may disagree with (if not today, eventually).  Ie, your code could break in arbitrary ways in future compiler updates."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538677534, "post_id": 52634655, "comment_id": 92237978, "body": "If your template is in <code>namespace A</code>, specializations must be in <code>namespace A</code>.  If you aren&#39;t in <code>namespace A</code> you might think you are specializing while you are actually overloading, or something else strange.  In any case, it is your code base, good luck."}, {"owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "edited": false, "score": 0, "creation_date": 1538678803, "post_id": 52634655, "comment_id": 92238074, "body": "Ah you&#39;re right, I definitely had to declare the specializations in namespace A. I&#39;ll keep looking template specialization vs overloading -- if I can initially define from_int() in namespace A and overload in namespace B, I&#39;ll definitely switch (and I&#39;d forgotten about the automatic inference of tag_t based on from_int&lt;T&gt;). Thanks again for your comments."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 3, "last_activity_date": 1538596086, "creation_date": 1538596086, "answer_id": 52634655, "question_id": 52633405, "link": "https://stackoverflow.com/questions/52633405/c17-using-stdoptional-to-evaluate-if-enum-contains-value/52634655#52634655", "title": "C++17: using std::optional to evaluate if enum contains value", "body": "<p>It is far better to use tag dispatching than template specialziation in 99/100 cases.</p>\n\n<pre><code>#include &lt;optional&gt;\n\nenum class test_enum : int {\n    VALUE_0 = 0,\n    VALUE_1 = 1\n};\n\ntemplate&lt;class T&gt; struct tag_t {};\n\nnamespace from_int_details {\n  template&lt;class T&gt;\n  std::optional&lt;T&gt; from_int_impl( tag_t&lt;T&gt;, int value ) = delete;\n}\ntemplate&lt;class T&gt;\nstd::optional&lt;T&gt; from_int( int value ) {\n  using namespace from_int_details;\n  return from_int_impl( tag_t&lt;T&gt;{}, value );\n}\n\n// Overload for test_enum, same namespace as test_enum *or* in from_int_details:\nconstexpr std::optional&lt;test_enum&gt; from_int_impl(tag_t&lt;test_enum&gt;, int value)\n{\n    switch (value) {\n        case static_cast&lt;int&gt;(test_enum::VALUE_0) :\n            return test_enum::VALUE_0;\n        case static_cast&lt;int&gt;(test_enum::VALUE_1):\n            return test_enum::VALUE_1;\n        default:\n            return std::optional&lt;test_enum&gt;();\n    }\n}\n\nint main()\n{\n    static_assert(from_int&lt;test_enum&gt;(1));\n}\n</code></pre>\n\n<p>here people extend <code>from_int</code> by writing a <code>constexpr optional&lt;the_enum_type&gt; from_int_impl( tag_t&lt;the_enum_type&gt;, int )</code> either in the namespace of <code>the_enum_type</code> (so it can be found via ADL), or for enums where this isn't possible (like enums in <code>std</code>), in the <code>from_int_details</code> namespace.  Or the namespace of <code>tag_t</code>.</p>\n\n<p>Here is this code compiling in <a href=\"https://godbolt.org/z/w6jnI-\" rel=\"nofollow noreferrer\">MSVC 2017</a>, compiler version 19.10.</p>\n"}], "owner": {"reputation": 63, "user_id": 2741943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221b8699d0f8411f9644b79833e753b9?s=128&d=identicon&r=PG&f=1", "display_name": "tstevens", "link": "https://stackoverflow.com/users/2741943/tstevens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 52634247, "answer_count": 3, "score": 2, "last_activity_date": 1538596086, "creation_date": 1538590779, "last_edit_date": 1538594180, "question_id": 52633405, "link": "https://stackoverflow.com/questions/52633405/c17-using-stdoptional-to-evaluate-if-enum-contains-value", "title": "C++17: using std::optional to evaluate if enum contains value", "body": "<p>I'd like to check at compile-time if various enums contain a given value, so I've written the following:</p>\n\n<pre><code>#include &lt;optional&gt;\n\nenum class test_enum : int {\n    VALUE_0 = 0,\n    VALUE_1 = 1\n};\n\n// Template function to perform check\ntemplate&lt;typename T&gt;\nconstexpr std::optional&lt;T&gt; from_int(int value)\n{\n    static_assert(false, __FUNCTION__ \" not implemented for this type; see build output\");\n    return std::optional&lt;T&gt;();\n}\n\n// Specialization for test_enum\ntemplate&lt;&gt;\nconstexpr std::optional&lt;test_enum&gt; from_int(int value)\n{\n    switch (value) {\n        case static_cast&lt;int&gt;(test_enum::VALUE_0) :\n            return test_enum::VALUE_0;\n        case static_cast&lt;int&gt;(test_enum::VALUE_1):\n            return test_enum::VALUE_1;\n        default:\n            return std::optional&lt;test_enum&gt;();\n    }\n}\n\nint main(int argc, char* argv[])\n{\n    static_assert(from_int&lt;test_enum&gt;(1));\n\n    return 0;\n}\n</code></pre>\n\n<p>Using Visual Studio 2017 (version 15.8.6), the code compiles successfully with no errors in the output. However, the error window shows </p>\n\n<pre><code>E0028: expression must have a constant value\" at line 30. (the first line of main)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>\"std::_Optional_construct_base&lt;test_enum&gt;::_Optional_construct_base(std::in_place_t, _Types &amp;&amp;..._Args) [with _Types=&lt;test_enum&gt;]\" (declared implicitly) is not defined)\".\n</code></pre>\n\n<p>Any hints as to why this is? I can ignore E0028, but I'd prefer not to if possible.</p>\n\n<p><strong>EDIT:</strong> Removing the static_assert from from_int does not change the error.</p>\n"}, {"tags": ["c++", "instance", "mask", "segment"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6657021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b421431446c8a65d25e387b174e2f818?s=128&d=identicon&r=PG&f=1", "display_name": "nicoperillo", "link": "https://stackoverflow.com/users/6657021/nicoperillo"}, "edited": false, "score": 0, "creation_date": 1538654703, "post_id": 52633393, "comment_id": 92224406, "body": "Thank you Jeffrey. I got the Mask-RCNN from GitHub and for now I&#39;m going to create a custom dataset, like <a href=\"https://www.analyticsvidhya.com/blog/2018/07/building-mask-r-cnn-model-detecting-damage-cars-python/\" rel=\"nofollow noreferrer\">here</a>, to see what happens. Later I&#39;ll try to manage the C++ project as you said."}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": true, "score": 3, "last_activity_date": 1538590731, "creation_date": 1538590731, "answer_id": 52633393, "question_id": 52633263, "link": "https://stackoverflow.com/questions/52633263/c-how-to-implement-a-mask-r-cnn/52633393#52633393", "title": "C++ - How to implement a Mask R-CNN?", "body": "<p>For a beginner, doing machine learning in C++ will be a very high bar.</p>\n\n<p>Pretty much all the packages out there use python for the API. Tensorflow allows running the session API in C++, but you need to build the graph in python. And dealing with the build of tensorflow will be a pain.</p>\n\n<p>Get the Mask-RCNN from its github, run it in python, understand it. Check that the license fits your need. Then, assuming your project is in C++, brush up on bindings between C++ and python. Have your C++ make calls to a python layer that imports Mask-RCNN.</p>\n\n<p>Any other approach will offer significant hurdles to a beginner.</p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 9169134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ddb56aad69e63bee90077e8f1a522c?s=128&d=identicon&r=PG&f=1", "display_name": "ASMJunkie", "link": "https://stackoverflow.com/users/9169134/asmjunkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1538593361, "last_edit_date": 1538593361, "creation_date": 1538593044, "answer_id": 52633957, "question_id": 52633263, "link": "https://stackoverflow.com/questions/52633263/c-how-to-implement-a-mask-r-cnn/52633957#52633957", "title": "C++ - How to implement a Mask R-CNN?", "body": "<p>C++ Is great for making ML applications. </p>\n\n<p>Some concepts you'll need to learn are</p>\n\n<ul>\n<li>Matrix Layouts ( Row Major, Column Major)</li>\n<li>Vectors</li>\n<li>Matrix Vector Multiplication</li>\n<li>Matrix Matrix Multiplication</li>\n</ul>\n\n<p>The most important thing is cache locality. Decreasing cache misses ESPECIALLY in matrix multiplication (gemm and gemv) will be the determining factor of your networks speed. Using a naive matrix multiplication (n^3 loads) that is cache friendly is going to provide you with the best results.  </p>\n"}], "owner": {"reputation": 63, "user_id": 6657021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b421431446c8a65d25e387b174e2f818?s=128&d=identicon&r=PG&f=1", "display_name": "nicoperillo", "link": "https://stackoverflow.com/users/6657021/nicoperillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1532, "favorite_count": 0, "accepted_answer_id": 52633393, "answer_count": 2, "score": 0, "last_activity_date": 1582796741, "creation_date": 1538590175, "question_id": 52633263, "link": "https://stackoverflow.com/questions/52633263/c-how-to-implement-a-mask-r-cnn", "title": "C++ - How to implement a Mask R-CNN?", "body": "<p>I need to implement a custom Mask-RCNN in C++ to perform instance segmentation on a custom dataset. Since I'm a beginner, I just know the theory, but I really don't know how to apply it.</p>\n\n<p>Could you give me some guidelines to start my project? Thank you.</p>\n"}, {"tags": ["c++", "cmake", "environment-variables", "lib"], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 10395904, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bfbBNI0Tn_M/AAAAAAAAAAI/AAAAAAAAAAA/diCsnTeOUUU/photo.jpg?sz=128", "display_name": "Dery", "link": "https://stackoverflow.com/users/10395904/dery"}, "is_accepted": true, "score": 0, "last_activity_date": 1581538855, "last_edit_date": 1581538855, "creation_date": 1538627782, "answer_id": 52639090, "question_id": 52633152, "link": "https://stackoverflow.com/questions/52633152/how-to-force-cmake-to-link-a-dynamic-lib/52639090#52639090", "title": "How to force cmake to link a dynamic lib?", "body": "<p>Solved\uff01 I spend some time to learn about cmake. I found the cmakelists.txt to generate libmovesensecamera.so is not correct. I change this line:</p>\n\n<pre><code>link_directories(\"/usr/lib/x86_64-linux-gnu\")\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>link_directories(\"/home/d01/cross/arm-hisiv300-linux/target/lib\")\n</code></pre>\n\n<p>So, this is a bug which cause the environment-variables to fail on that step. I only temporarily solve it. </p>\n"}], "owner": {"reputation": 105, "user_id": 10395904, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bfbBNI0Tn_M/AAAAAAAAAAI/AAAAAAAAAAA/diCsnTeOUUU/photo.jpg?sz=128", "display_name": "Dery", "link": "https://stackoverflow.com/users/10395904/dery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 52639090, "answer_count": 1, "score": 0, "last_activity_date": 1581538855, "creation_date": 1538589758, "question_id": 52633152, "link": "https://stackoverflow.com/questions/52633152/how-to-force-cmake-to-link-a-dynamic-lib", "title": "How to force cmake to link a dynamic lib?", "body": "<p><strong>I am cross-compiling a camera driver. The driver uses cmake to create makefile, I have set the environment variables ,but when the makefile do the linking it still link the default lib, which won't work. Why the ld won't search other directories? I can't find nowhere to set the right path. Below is what i got\uff1a</strong>\n<a href=\"https://i.stack.imgur.com/HxlxG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HxlxG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The cmakelists.txt is like this:</strong></p>\n\n<pre><code>if(WIN32)\n    cmake_minimum_required (VERSION 3.0)\nelse(UNIX)\n    cmake_minimum_required (VERSION 2.8)\nendif(WIN32)\n\n\nproject (MoveSenseCamera)\n\nset_property(GLOBAL PROPERTY USE_FOLDERS ON)\n\nmessage (\"cxx Flags: \" ${CMAKE_CXX_FLAGS})\n\nadd_subdirectory (MoveSenseCamera)\nadd_subdirectory (Samples)\n\nif(WIN32)\n    install(FILES\n        ${CMAKE_CURRENT_SOURCE_DIR}/README.md\n        DESTINATION ${PROJECT_SOURCE_DIR}/Release/MoveSenseSDK-Windows)\nelse(UNIX)\n    install(FILES \n        ${CMAKE_CURRENT_SOURCE_DIR}/.gitignore\n        ${CMAKE_CURRENT_SOURCE_DIR}/CMakeLists.txt\n        ${CMAKE_CURRENT_SOURCE_DIR}/README.md\n        DESTINATION ${PROJECT_SOURCE_DIR}/Release/MoveSenseSDK-Linux)\nendif(WIN32)\n\nmessage(\"Done! \\n\")  \n</code></pre>\n\n<p><strong>My toolChain.cmake is like this:</strong></p>\n\n<pre><code>set(CMAKE_SYSTEM_NAME Linux)\nset(CMAKE_SYSTEM_PROCESSOR arm)\nset(CMAKE_FIND_ROOT_PATH  /home/d01/cross/arm-hisiv300-linux/target)\n\nset(CMAKE_SYSROOT /home/d01/cross/arm-hisiv300-linux/target)\nset(CMAKE_STAGING_PREFIX /home/d01/P_doubleeye/MoveSenseSDK1.2.7/build/bin)\nset(tools /home/d01/cross/arm-hisiv300-linux/bin)\nset(CMAKE_C_COMPILER ${tools}/arm-hisiv300-linux-uclibcgnueabi-gcc)\nset(CMAKE_CXX_COMPILER ${tools}/arm-hisiv300-linux-uclibcgnueabi-g++)\nset(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\nset(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)\n</code></pre>\n\n<p><strong>Generated makefile:</strong></p>\n\n<pre><code># CMAKE generated file: DO NOT EDIT!\n# Generated by \"Unix Makefiles\" Generator, CMake Version 3.10\n\n# Default target executed when no arguments are given to make.\ndefault_target: all\n\n.PHONY : default_target\n\n# Allow only one \"make -f Makefile2\" at a time, but pass parallelism.\n.NOTPARALLEL:\n\n\n#=============================================================================\n# Special targets provided by cmake.\n\n# Disable implicit rules so canonical targets will work.\n.SUFFIXES:\n\n\n# Remove some rules from gmake that .SUFFIXES does not remove.\nSUFFIXES =\n\n.SUFFIXES: .hpux_make_needs_suffix_list\n\n\n# Suppress display of executed commands.\n$(VERBOSE).SILENT:\n\n\n# A target that is always out of date.\ncmake_force:\n\n.PHONY : cmake_force\n\n#=============================================================================\n# Set environment variables for the build.\n\n# The shell in which to execute make rules.\nSHELL = /bin/sh\n\n# The CMake executable.\nCMAKE_COMMAND = /usr/bin/cmake\n\n# The command to remove a file.\nRM = /usr/bin/cmake -E remove -f\n\n# Escaping for special characters.\nEQUALS = =\n\n# The top-level source directory on which CMake was run.\nCMAKE_SOURCE_DIR = \"/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)\"\n\n# The top-level build directory on which CMake was run.\nCMAKE_BINARY_DIR = \"/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build\"\n\n#=============================================================================\n# Targets provided globally by CMake.\n\n# Special rule for the target install/strip\ninstall/strip: preinstall\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Installing the project stripped...\"\n    /usr/bin/cmake -DCMAKE_INSTALL_DO_STRIP=1 -P cmake_install.cmake\n.PHONY : install/strip\n\n# Special rule for the target install/strip\ninstall/strip/fast: preinstall/fast\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Installing the project stripped...\"\n    /usr/bin/cmake -DCMAKE_INSTALL_DO_STRIP=1 -P cmake_install.cmake\n.PHONY : install/strip/fast\n\n# Special rule for the target install\ninstall: preinstall\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Install the project...\"\n    /usr/bin/cmake -P cmake_install.cmake\n.PHONY : install\n\n# Special rule for the target install\ninstall/fast: preinstall/fast\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Install the project...\"\n    /usr/bin/cmake -P cmake_install.cmake\n.PHONY : install/fast\n\n# Special rule for the target install/local\ninstall/local: preinstall\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Installing only the local directory...\"\n    /usr/bin/cmake -DCMAKE_INSTALL_LOCAL_ONLY=1 -P cmake_install.cmake\n.PHONY : install/local\n\n# Special rule for the target install/local\ninstall/local/fast: preinstall/fast\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Installing only the local directory...\"\n    /usr/bin/cmake -DCMAKE_INSTALL_LOCAL_ONLY=1 -P cmake_install.cmake\n.PHONY : install/local/fast\n\n# Special rule for the target list_install_components\nlist_install_components:\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Available install components are: \\\"Unspecified\\\" \\\"dev\\\"\"\n.PHONY : list_install_components\n\n# Special rule for the target list_install_components\nlist_install_components/fast: list_install_components\n\n.PHONY : list_install_components/fast\n\n# Special rule for the target edit_cache\nedit_cache:\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"No interactive CMake dialog available...\"\n    /usr/bin/cmake -E echo No\\ interactive\\ CMake\\ dialog\\ available.\n.PHONY : edit_cache\n\n# Special rule for the target edit_cache\nedit_cache/fast: edit_cache\n\n.PHONY : edit_cache/fast\n\n# Special rule for the target rebuild_cache\nrebuild_cache:\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan \"Running CMake to regenerate build system...\"\n    /usr/bin/cmake -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR)\n.PHONY : rebuild_cache\n\n# Special rule for the target rebuild_cache\nrebuild_cache/fast: rebuild_cache\n\n.PHONY : rebuild_cache/fast\n\n# The main all target\nall: cmake_check_build_system\n    $(CMAKE_COMMAND) -E cmake_progress_start \"/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build/CMakeFiles\" \"/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build/CMakeFiles/progress.marks\"\n    $(MAKE) -f CMakeFiles/Makefile2 all\n    $(CMAKE_COMMAND) -E cmake_progress_start \"/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build/CMakeFiles\" 0\n.PHONY : all\n\n# The main clean target\nclean:\n    $(MAKE) -f CMakeFiles/Makefile2 clean\n.PHONY : clean\n\n# The main clean target\nclean/fast: clean\n\n.PHONY : clean/fast\n\n# Prepare targets for installation.\npreinstall: all\n    $(MAKE) -f CMakeFiles/Makefile2 preinstall\n.PHONY : preinstall\n\n# Prepare targets for installation.\npreinstall/fast:\n    $(MAKE) -f CMakeFiles/Makefile2 preinstall\n.PHONY : preinstall/fast\n\n# clear depends\ndepend:\n    $(CMAKE_COMMAND) -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR) --check-build-system CMakeFiles/Makefile.cmake 1\n.PHONY : depend\n\n#=============================================================================\n# Target rules for targets named MoveSenseCamera\n\n# Build rule for target.\nMoveSenseCamera: cmake_check_build_system\n    $(MAKE) -f CMakeFiles/Makefile2 MoveSenseCamera\n.PHONY : MoveSenseCamera\n\n# fast build rule for target.\nMoveSenseCamera/fast:\n    $(MAKE) -f MoveSenseCamera/CMakeFiles/MoveSenseCamera.dir/build.make MoveSenseCamera/CMakeFiles/MoveSenseCamera.dir/build\n.PHONY : MoveSenseCamera/fast\n\n#=============================================================================\n# Target rules for targets named ImageCapture\n\n# Build rule for target.\nImageCapture: cmake_check_build_system\n    $(MAKE) -f CMakeFiles/Makefile2 ImageCapture\n.PHONY : ImageCapture\n\n# fast build rule for target.\nImageCapture/fast:\n    $(MAKE) -f Samples/CMakeFiles/ImageCapture.dir/build.make Samples/CMakeFiles/ImageCapture.dir/build\n.PHONY : ImageCapture/fast\n\n# Help Target\nhelp:\n    @echo \"The following are some of the valid targets for this Makefile:\"\n    @echo \"... all (the default if no target is provided)\"\n    @echo \"... clean\"\n    @echo \"... depend\"\n    @echo \"... install/strip\"\n    @echo \"... install\"\n    @echo \"... install/local\"\n    @echo \"... list_install_components\"\n    @echo \"... edit_cache\"\n    @echo \"... rebuild_cache\"\n    @echo \"... MoveSenseCamera\"\n    @echo \"... ImageCapture\"\n.PHONY : help\n\n\n\n#=============================================================================\n# Special targets to cleanup operation of make.\n\n# Special rule to run CMake to check the build system integrity.\n# No rule that depends on this can have commands that come from listfiles\n# because they might be regenerated.\ncmake_check_build_system:\n    $(CMAKE_COMMAND) -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR) --check-build-system CMakeFiles/Makefile.cmake 0\n.PHONY : cmake_check_build_system\n</code></pre>\n\n<p><strong>Generated CMakeCache.txt:</strong></p>\n\n<pre><code># This is the CMakeCache file.\n# For build in directory: /home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build\n# It was generated by CMake: /usr/bin/cmake\n# You can edit this file to change values found and used by cmake.\n# If you do not want to change any of the values, simply exit the editor.\n# If you do want to change a value, simply edit, save, and exit the editor.\n# The syntax for the file is as follows:\n# KEY:TYPE=VALUE\n# KEY is the name of a variable in the cache.\n# TYPE is a hint to GUIs for the type of VALUE, DO NOT EDIT TYPE!.\n# VALUE is the current value for the KEY.\n\n########################\n# EXTERNAL cache entries\n########################\n\n//Path to a program.\nCMAKE_AR:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-ar\n\n//Choose the type of build, options are: None(CMAKE_CXX_FLAGS or\n// CMAKE_C_FLAGS used) Debug Release RelWithDebInfo MinSizeRel.\nCMAKE_BUILD_TYPE:STRING=\n\n//Enable/Disable color output during build.\nCMAKE_COLOR_MAKEFILE:BOOL=ON\n\n//A wrapper around 'ar' adding the appropriate '--plugin' option\n// for the GCC compiler\nCMAKE_CXX_COMPILER_AR:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-gcc-ar\n\n//A wrapper around 'ranlib' adding the appropriate '--plugin' option\n// for the GCC compiler\nCMAKE_CXX_COMPILER_RANLIB:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-gcc-ranlib\n\n//Flags used by the compiler during all build types.\nCMAKE_CXX_FLAGS:STRING=\n\n//Flags used by the compiler during debug builds.\nCMAKE_CXX_FLAGS_DEBUG:STRING=-g\n\n//Flags used by the compiler during release builds for minimum\n// size.\nCMAKE_CXX_FLAGS_MINSIZEREL:STRING=-Os -DNDEBUG\n\n//Flags used by the compiler during release builds.\nCMAKE_CXX_FLAGS_RELEASE:STRING=-O3 -DNDEBUG\n\n//Flags used by the compiler during release builds with debug info.\nCMAKE_CXX_FLAGS_RELWITHDEBINFO:STRING=-O2 -g -DNDEBUG\n\n//A wrapper around 'ar' adding the appropriate '--plugin' option\n// for the GCC compiler\nCMAKE_C_COMPILER_AR:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-gcc-ar\n\n//A wrapper around 'ranlib' adding the appropriate '--plugin' option\n// for the GCC compiler\nCMAKE_C_COMPILER_RANLIB:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-gcc-ranlib\n\n//Flags used by the compiler during all build types.\nCMAKE_C_FLAGS:STRING=\n\n//Flags used by the compiler during debug builds.\nCMAKE_C_FLAGS_DEBUG:STRING=-g\n\n//Flags used by the compiler during release builds for minimum\n// size.\nCMAKE_C_FLAGS_MINSIZEREL:STRING=-Os -DNDEBUG\n\n//Flags used by the compiler during release builds.\nCMAKE_C_FLAGS_RELEASE:STRING=-O3 -DNDEBUG\n\n//Flags used by the compiler during release builds with debug info.\nCMAKE_C_FLAGS_RELWITHDEBINFO:STRING=-O2 -g -DNDEBUG\n\n//Flags used by the linker.\nCMAKE_EXE_LINKER_FLAGS:STRING=\n\n//Flags used by the linker during debug builds.\nCMAKE_EXE_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during release minsize builds.\nCMAKE_EXE_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during release builds.\nCMAKE_EXE_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during Release with Debug Info builds.\nCMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//Enable/Disable output of compile commands during generation.\nCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=OFF\n\n//Install path prefix, prepended onto install directories.\nCMAKE_INSTALL_PREFIX:PATH=/usr/local\n\n//Path to a program.\nCMAKE_LINKER:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-ld\n\n//Path to a program.\nCMAKE_MAKE_PROGRAM:FILEPATH=/usr/bin/make\n\n//Flags used by the linker during the creation of modules.\nCMAKE_MODULE_LINKER_FLAGS:STRING=\n\n//Flags used by the linker during debug builds.\nCMAKE_MODULE_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during release minsize builds.\nCMAKE_MODULE_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during release builds.\nCMAKE_MODULE_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during Release with Debug Info builds.\nCMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//Path to a program.\nCMAKE_NM:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-nm\n\n//Path to a program.\nCMAKE_OBJCOPY:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-objcopy\n\n//Path to a program.\nCMAKE_OBJDUMP:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-objdump\n\n//Value Computed by CMake\nCMAKE_PROJECT_NAME:STATIC=MoveSenseCamera\n\n//Path to a program.\nCMAKE_RANLIB:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-ranlib\n\n//Flags used by the linker during the creation of dll's.\nCMAKE_SHARED_LINKER_FLAGS:STRING=\n\n//Flags used by the linker during debug builds.\nCMAKE_SHARED_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during release minsize builds.\nCMAKE_SHARED_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during release builds.\nCMAKE_SHARED_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during Release with Debug Info builds.\nCMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//If set, runtime paths are not added when installing shared libraries,\n// but are added when building.\nCMAKE_SKIP_INSTALL_RPATH:BOOL=NO\n\n//If set, runtime paths are not added when using shared libraries.\nCMAKE_SKIP_RPATH:BOOL=NO\n\n//Flags used by the linker during the creation of static libraries.\nCMAKE_STATIC_LINKER_FLAGS:STRING=\n\n//Flags used by the linker during debug builds.\nCMAKE_STATIC_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during release minsize builds.\nCMAKE_STATIC_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during release builds.\nCMAKE_STATIC_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during Release with Debug Info builds.\nCMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//Path to a program.\nCMAKE_STRIP:FILEPATH=/home/d01/cross/arm-hisiv300-linux/bin/arm-hisiv300-linux-uclibcgnueabi-strip\n\n//The CMake toolchain file\nCMAKE_TOOLCHAIN_FILE:FILEPATH=/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/toolChain.cmake\n\n//If this value is on, makefiles will be generated without the\n// .SILENT directive, and all commands will be echoed to the console\n// during the make.  This is useful for debugging only. With Visual\n// Studio IDE projects all commands are done without /nologo.\nCMAKE_VERBOSE_MAKEFILE:BOOL=FALSE\n\n//Value Computed by CMake\nMoveSenseCamera_BINARY_DIR:STATIC=/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build\n\n//Dependencies for the target\nMoveSenseCamera_LIB_DEPENDS:STATIC=general;udev;\n\n//Value Computed by CMake\nMoveSenseCamera_SOURCE_DIR:STATIC=/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)\n\n\n########################\n# INTERNAL cache entries\n########################\n\n//ADVANCED property for variable: CMAKE_AR\nCMAKE_AR-ADVANCED:INTERNAL=1\n//This is the directory where this CMakeCache.txt was created\nCMAKE_CACHEFILE_DIR:INTERNAL=/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)/build\n//Major version of cmake used to create the current loaded cache\nCMAKE_CACHE_MAJOR_VERSION:INTERNAL=3\n//Minor version of cmake used to create the current loaded cache\nCMAKE_CACHE_MINOR_VERSION:INTERNAL=10\n//Patch version of cmake used to create the current loaded cache\nCMAKE_CACHE_PATCH_VERSION:INTERNAL=2\n//ADVANCED property for variable: CMAKE_COLOR_MAKEFILE\nCMAKE_COLOR_MAKEFILE-ADVANCED:INTERNAL=1\n//Path to CMake executable.\nCMAKE_COMMAND:INTERNAL=/usr/bin/cmake\n//Path to cpack program executable.\nCMAKE_CPACK_COMMAND:INTERNAL=/usr/bin/cpack\n//Path to ctest program executable.\nCMAKE_CTEST_COMMAND:INTERNAL=/usr/bin/ctest\n//ADVANCED property for variable: CMAKE_CXX_COMPILER_AR\nCMAKE_CXX_COMPILER_AR-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_COMPILER_RANLIB\nCMAKE_CXX_COMPILER_RANLIB-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS\nCMAKE_CXX_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_DEBUG\nCMAKE_CXX_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_MINSIZEREL\nCMAKE_CXX_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_RELEASE\nCMAKE_CXX_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_RELWITHDEBINFO\nCMAKE_CXX_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_COMPILER_AR\nCMAKE_C_COMPILER_AR-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_COMPILER_RANLIB\nCMAKE_C_COMPILER_RANLIB-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_FLAGS\nCMAKE_C_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_FLAGS_DEBUG\nCMAKE_C_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_FLAGS_MINSIZEREL\nCMAKE_C_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_FLAGS_RELEASE\nCMAKE_C_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_C_FLAGS_RELWITHDEBINFO\nCMAKE_C_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//Executable file format\nCMAKE_EXECUTABLE_FORMAT:INTERNAL=ELF\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS\nCMAKE_EXE_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_DEBUG\nCMAKE_EXE_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_MINSIZEREL\nCMAKE_EXE_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_RELEASE\nCMAKE_EXE_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXPORT_COMPILE_COMMANDS\nCMAKE_EXPORT_COMPILE_COMMANDS-ADVANCED:INTERNAL=1\n//Name of external makefile project generator.\nCMAKE_EXTRA_GENERATOR:INTERNAL=\n//Name of generator.\nCMAKE_GENERATOR:INTERNAL=Unix Makefiles\n//Name of generator platform.\nCMAKE_GENERATOR_PLATFORM:INTERNAL=\n//Name of generator toolset.\nCMAKE_GENERATOR_TOOLSET:INTERNAL=\n//Source directory with the top level CMakeLists.txt file for this\n// project\nCMAKE_HOME_DIRECTORY:INTERNAL=/home/d01/P_doubleeye/MoveSenseSDK-Linux-CSx-1.2.7-(no opencv)\n//Install .so files without execute permission.\nCMAKE_INSTALL_SO_NO_EXE:INTERNAL=1\n//ADVANCED property for variable: CMAKE_LINKER\nCMAKE_LINKER-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MAKE_PROGRAM\nCMAKE_MAKE_PROGRAM-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS\nCMAKE_MODULE_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_DEBUG\nCMAKE_MODULE_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_MINSIZEREL\nCMAKE_MODULE_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_RELEASE\nCMAKE_MODULE_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_NM\nCMAKE_NM-ADVANCED:INTERNAL=1\n//number of local generators\nCMAKE_NUMBER_OF_MAKEFILES:INTERNAL=3\n//ADVANCED property for variable: CMAKE_OBJCOPY\nCMAKE_OBJCOPY-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_OBJDUMP\nCMAKE_OBJDUMP-ADVANCED:INTERNAL=1\n//Platform information initialized\nCMAKE_PLATFORM_INFO_INITIALIZED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_RANLIB\nCMAKE_RANLIB-ADVANCED:INTERNAL=1\n//Path to CMake installation.\nCMAKE_ROOT:INTERNAL=/usr/share/cmake-3.10\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS\nCMAKE_SHARED_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_DEBUG\nCMAKE_SHARED_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_MINSIZEREL\nCMAKE_SHARED_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_RELEASE\nCMAKE_SHARED_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SKIP_INSTALL_RPATH\nCMAKE_SKIP_INSTALL_RPATH-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SKIP_RPATH\nCMAKE_SKIP_RPATH-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS\nCMAKE_STATIC_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_DEBUG\nCMAKE_STATIC_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_MINSIZEREL\nCMAKE_STATIC_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_RELEASE\nCMAKE_STATIC_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STRIP\nCMAKE_STRIP-ADVANCED:INTERNAL=1\n//uname command\nCMAKE_UNAME:INTERNAL=/bin/uname\n//ADVANCED property for variable: CMAKE_VERBOSE_MAKEFILE\nCMAKE_VERBOSE_MAKEFILE-ADVANCED:INTERNAL=1\n</code></pre>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1538589520, "post_id": 52633050, "comment_id": 92199388, "body": "This looks like quite the abuse of dynamic allocation and looks heavily influenced by Java or C#. In C++, value semantics are strongly encouraged. There isn&#39;t really any need for all of those <code>new</code> and getting rid of them would greatly simplify your code. For example, just <code>course b{a, c.section, c.credits};</code> seems preferable, same with <code>std::vector&lt;course&gt; p2{ std::move(b) };</code>."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1538589672, "post_id": 52633050, "comment_id": 92199468, "body": "I would encourage you to rewrite your code without using any pointers, <code>new</code> or <code>delete</code>, and simply use <code>vector</code> and <code>course</code> by value. It will simplify things greatly. If you need shared ownership, consider using <code>std::shared_ptr</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1538589680, "post_id": 52633050, "comment_id": 92199474, "body": "Vectors almost always have more capacity then they need for performance reasons and it&#39;s certainly not a cause for a run time error. &quot;read access violation&quot; implies an error in how you handle pointers."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1538590620, "post_id": 52633158, "comment_id": 92199927, "body": "And this has nothing at all to do with &quot;unused capacity&quot;; I&#39;m not quite sure where you got that idea!"}, {"owner": {"reputation": 3, "user_id": 10452839, "user_type": "registered", "profile_image": "https://graph.facebook.com/1166935936796400/picture?type=large", "display_name": "William Mo", "link": "https://stackoverflow.com/users/10452839/william-mo"}, "edited": false, "score": 0, "creation_date": 1538593347, "post_id": 52633158, "comment_id": 92201259, "body": "Thanks!  I just found this problem 2 min ago. Now I have to deal with memory leak."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3, "user_id": 10452839, "user_type": "registered", "profile_image": "https://graph.facebook.com/1166935936796400/picture?type=large", "display_name": "William Mo", "link": "https://stackoverflow.com/users/10452839/william-mo"}, "edited": false, "score": 0, "creation_date": 1538652251, "post_id": 52633158, "comment_id": 92222952, "body": "@WilliamMo I encourage you to spend more than two minutes on a problem before resorting to asking us for help!"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1538589772, "creation_date": 1538589772, "answer_id": 52633158, "question_id": 52633050, "link": "https://stackoverflow.com/questions/52633050/c-vector-unused-capacity/52633158#52633158", "title": "C++ vector: unused capacity", "body": "<p>Your code assumes that if <code>DB[id]</code> has <em>any</em> semesters, it has the semester <code>semester</code>:</p>\n\n<pre><code>if (DB[id].empty()) {\n   // ...\n}\nelse\n    DB[id][semester]-&gt;push_back(b);\n</code></pre>\n\n<p>If that's not true, if it has <em>some</em> semester but not this one, then you're not catching that, and you're <code>push_back</code>ing on a default-constructed null pointer. This means your program has undefined behaviour, and today is the reason for the crash.</p>\n\n<p>Instead you could try:</p>\n\n<pre><code>if (!DB[id].count(semester)) {\n   // ...\n}\nelse\n    DB[id][semester]-&gt;push_back(b);\n</code></pre>\n\n<p>&hellip; which actually checks for the existence of the specific inner map element.</p>\n\n<p>You would be much better off without all this dynamic allocation, though:</p>\n\n<pre><code>void add_course(\n   map&lt;int, map&lt;int, vector&lt;course&gt;&gt;&gt;&amp; DB,\n   const int semester,\n   const int id,\n   const course c\n)\n{\n    DB[id][semester].emplace_back(c.name, c.section, c.credits);\n}\n</code></pre>\n\n<p>Isn't that nicer?!</p>\n"}], "owner": {"reputation": 3, "user_id": 10452839, "user_type": "registered", "profile_image": "https://graph.facebook.com/1166935936796400/picture?type=large", "display_name": "William Mo", "link": "https://stackoverflow.com/users/10452839/william-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 1, "accepted_answer_id": 52633158, "answer_count": 1, "score": 0, "last_activity_date": 1538589772, "creation_date": 1538589434, "question_id": 52633050, "link": "https://stackoverflow.com/questions/52633050/c-vector-unused-capacity", "title": "C++ vector: unused capacity", "body": "<p>I am a new comer for C++, I am currently working on this class schedule project and the following is my add_course function. I am storing student's id, semester, and list of classes in a map. It works(I can add course to student and see it when I print a student's schedule) but every time I run the code, an exception always pop up :</p>\n\n<pre><code>Exception thrown: read access violation.\nstd::_Vector_alloc&lt;std::_Vec_base_types&lt;course *,std::allocator&lt;course *&gt; &gt; &gt;::_Myend(...) returned 0xC.\n</code></pre>\n\n<p>I am confusing, why is this happening. Does it mean my vector is having more capacity than it needs ?</p>\n\n<pre><code>void add_course(map&lt;int, map&lt;int, vector&lt;course *&gt; * &gt; &gt; &amp;DB, int semester, int id, course c) {\n    const string a = c.name;\n    course* b = new course(a, c.section, c.credits);\n    if (DB[id].empty()) {\n        vector&lt;course*&gt; *p2 = new vector&lt;course*&gt;;\n        (*p2) = { b };\n        DB[id][semester] = p2; \n        return;\n    }\n    else\n        DB[id][semester]-&gt;push_back(b);\n    return;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "floating-point", "timestamp", "unions"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1538588876, "post_id": 52632873, "comment_id": 92199031, "body": "You can only read form a union member if it was the last member to be assigned to. So if <code>.asFloat</code> was last assigned to, any call to a member function that reads <code>asUInt</code> can&#39;t be called and vice-versa. This <code>TimeStamp</code> type is almost unusable."}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 1, "creation_date": 1538588910, "post_id": 52632873, "comment_id": 92199041, "body": "Seems like this code rely on UB (which does work on some platforms)."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1538589227, "post_id": 52632873, "comment_id": 92199207, "body": "It looks like they want to use float to store the value, but use integer equality tests to avoid floating point errors (not casting float to int but using float bits as integer bits). Maybe?"}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1538590268, "post_id": 52632873, "comment_id": 92199771, "body": "You know, there are lots of bad code on the internet. I believe you found an example. It is not clear what it is aiming to do, and it is certainly unreliable due to variables used without initialization..."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1538663740, "post_id": 52632873, "comment_id": 92230593, "body": "This may be an ancient optimisation, where float comparison could be much slower than integer comparison. So long as the float is not a special INF or NAN value, or a very small denormal, OR ZERO, the binary representations would be the same and the int compare would be faster. Of course the way float can represent both positive and negative zero would be a concern to me."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1538664146, "post_id": 52632873, "comment_id": 92230849, "body": "The speed downside, compared to sticking with one format: if if any method uses the equality test and uses the float value, then the compiler will not be happy to optimise all the code to registers."}, {"owner": {"reputation": 73, "user_id": 8558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508a5f3d4a98eb59d17dd830075bfe54?s=128&d=identicon&r=PG&f=1", "display_name": "Constantineous", "link": "https://stackoverflow.com/users/8558682/constantineous"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1538668530, "post_id": 52632873, "comment_id": 92233675, "body": "@GemTaylor That was my thinking as well. But is it reasonable to compare two floats with no margin allowed? Seems that by subtracting integer representations of two equally signed floats, you can get a number(minus one) of representable floats between them, which then can be compared to some arbitrary value. But that doesn&#39;t explain the &quot;hard&quot; equality above."}, {"owner": {"reputation": 73, "user_id": 8558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508a5f3d4a98eb59d17dd830075bfe54?s=128&d=identicon&r=PG&f=1", "display_name": "Constantineous", "link": "https://stackoverflow.com/users/8558682/constantineous"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538669507, "post_id": 52632873, "comment_id": 92234187, "body": "@JohnnyMopp I believe that if the intention was to avoid the rounding errors, they would&#39;ve introduced some relative value acting as a boundary."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1538669913, "post_id": 52632873, "comment_id": 92234379, "body": "@Constantineous Who knows? We aren&#39;t mind readers! :-) Perhaps the level of equality was good enough for their purposes at that time. If we are only talking float, then you have to accept a restricted accuracy anyway, depending on your epoch. secs/day needs 13 bits, days/year needs 5 bits, 100 years need 7 bits, so something&#39;s gotta give!"}, {"owner": {"reputation": 73, "user_id": 8558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508a5f3d4a98eb59d17dd830075bfe54?s=128&d=identicon&r=PG&f=1", "display_name": "Constantineous", "link": "https://stackoverflow.com/users/8558682/constantineous"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1538742124, "post_id": 52632873, "comment_id": 92260730, "body": "@GemTaylor I must admit, I don&#39;t understand your example. I mean the relation between time intervals and bits."}], "owner": {"reputation": 73, "user_id": 8558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508a5f3d4a98eb59d17dd830075bfe54?s=128&d=identicon&r=PG&f=1", "display_name": "Constantineous", "link": "https://stackoverflow.com/users/8558682/constantineous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538744164, "creation_date": 1538588731, "last_edit_date": 1538744164, "question_id": 52632873, "link": "https://stackoverflow.com/questions/52632873/union-for-storing-timestamp-comparing-floats-as-integers", "title": "Union for storing Timestamp. Comparing floats as integers", "body": "<p>While trying to wrap my brain around a custom game engine, I stumbled across a piece of code that looks rather odd to me:</p>\n\n<pre><code>union TimeStamp\n{\n    f32 asFloat;\n    u32 asUInt;\n\n    TimeStamp() : asUInt(0U)\n    {}\n\n    TimeStamp(f32 floatValue) : asFloat(floatValue)\n    {}\n\n    operator u32() const { return this-&gt;asUInt; }\n\n    inline const bool operator==(const TimeStamp&amp; other) const { return this-&gt;asUInt == other.asUInt; }\n    inline const bool operator!=(const TimeStamp&amp; other) const { return this-&gt;asUInt != other.asUInt; }\n\n    inline const bool operator&lt;(const TimeStamp&amp; other) const { return this-&gt;asFloat &lt; other.asFloat; }\n    inline const bool operator&gt;(const TimeStamp&amp; other) const { return this-&gt;asFloat &gt; other.asFloat; }\n\n};\n</code></pre>\n\n<p>My c++ experience(which is quite limited) tells me that the only meaningful reason to have this union is to make equality operators to treat compared timestamps(otherwise float) as integers? If yes, then why would someone want that?</p>\n\n<p>I also don't understand what is the point of an integer type cast overload here, since we can't event init Timestamp with int?</p>\n\n<p><strong>Note:</strong> <code>f32</code> and <code>u32</code> are defined as <code>float_t</code> and <code>uint32_t</code></p>\n\n<p>Just in case, here is a link containing the definition: <a href=\"https://github.com/tobias-stein/EntityComponentSystem/blob/master/EntityComponentSystem/include/ECS/Platform.h\" rel=\"nofollow noreferrer\">https://github.com/tobias-stein/EntityComponentSystem/blob/master/EntityComponentSystem/include/ECS/Platform.h</a></p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1538588663, "post_id": 52632835, "comment_id": 92198926, "body": "<code>***</code> ALARM! ALARM! BEEP WHEEP BEEP. ALARM!"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1538588718, "post_id": 52632835, "comment_id": 92198955, "body": "<a href=\"//stackoverflow.com/q/4470950\">Why can&#39;t we use double pointer to represent two dimensional arrays?</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538588841, "post_id": 52632835, "comment_id": 92199010, "body": "Seriously, why don&#39;t you use <a href=\"https://en.cppreference.com/w/cpp/container\" rel=\"nofollow noreferrer\">regular standard c++ containers</a> instead?"}, {"owner": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "edited": false, "score": 0, "creation_date": 1538589044, "post_id": 52632835, "comment_id": 92199099, "body": "Is there a good reason to use c-style arrays?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1538589069, "post_id": 52632835, "comment_id": 92199108, "body": "Don&#39;t be a <a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">three star programmer</a>.  Seriously, just use <code>std::vector&lt;std::vector&lt;std::string&gt;&gt;</code> instead of that pointer-to-pointer-to-pointer monstrosity."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1538589149, "post_id": 52632835, "comment_id": 92199155, "body": "Pointers aren&#39;t arrays. Your <code>STORAGE</code> doesn&#39;t actually store anything! The same reason you&#39;ve decided not to use containers is the same reason this approach won&#39;t work (indirection is indirection no matter the allocation method used). Plus you can&#39;t assign arrays, and <code>int**</code> and <code>int[w][h]</code> are unrelated types (perhaps this is unintuitive). I would just go with the expressive method and come up with a serialisation function. Is that an option?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1538589383, "post_id": 52632835, "comment_id": 92199312, "body": "@MilesBudnek As OP states, that won&#39;t work well with network transmissions."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538589481, "post_id": 52632835, "comment_id": 92199364, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Oh, yeah, didn&#39;t see the note at the end of the OP.  Of course, anything with pointers can&#39;t be directly transmitted over a network, so that&#39;s perhaps a bit misguided."}, {"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1538591484, "post_id": 52632835, "comment_id": 92200304, "body": "Miles, and the rest, note, my comment about the sizes being part of the header which is transmitted first.. I am aware that the entire struct won&#39;t be transmitted because it contains pointers, but the size of the remainng data will be predictable after the header. I cant use vecot or string because those are NOT FIXED sizes. There is no way to predict how much space will be transmitted in order to build the data back up."}], "answers": [{"comments": [{"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1538591769, "post_id": 52633029, "comment_id": 92200444, "body": "This breaks my convention of having to read bytes from the socket right into my struct. Using vectors wont work because they grow past what data is stored in them. Also, C++ strings wont work because they point to the heap and also grow."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1538591955, "post_id": 52633029, "comment_id": 92200556, "body": "@ComputerEngineer88 I am pretty sure such thing would work well in any networking environment supposed you already use <code>htonl()</code> <code>ntohl()</code> functions correctly to make these numbers network transparent. Your self constructed convention probably isn&#39;t the best solution for that problem. Your multidimensional array approach won&#39;t work well anyways."}, {"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1546539283, "post_id": 52633029, "comment_id": 94891658, "body": "I ended up using something similar to your transmit/receive order. size, data, size, data and used a higher level object with growing memory inside the struct. As long as I serialize and deserialize the same way, it works. Thanks for your input."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1546539343, "post_id": 52633029, "comment_id": 94891681, "body": "@ComputerEngineer88 Wow, three month later. But well ;)"}, {"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1546541145, "post_id": 52633029, "comment_id": 94892449, "body": "3 months of working code. giving credit where it&#39;s due :)"}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": true, "score": 2, "last_activity_date": 1538592263, "last_edit_date": 1538592263, "creation_date": 1538589333, "answer_id": 52633029, "question_id": 52632835, "link": "https://stackoverflow.com/questions/52632835/assigning-2d-variable-sized-arrays/52633029#52633029", "title": "Assigning 2D variable sized arrays", "body": "<blockquote>\n  <p>It must be low-level arrays unless someone can offer a better solution.</p>\n</blockquote>\n\n<p>A unidimensional <code>std::vector&lt;int&gt;</code> or <code>std::vector&lt;uint8_t&gt;</code> already provides you with a <em>low-level</em> array allocated contiguously using the <code>std::vector::data()</code> member.</p>\n\n<p>Any further dimensions you need might be determined by sectioning that data properly. For network transmission, you would need to provide the necessary sectioning dimensions up front, and sent the data afterwards.</p>\n\n<p>Something like:</p>\n\n<pre><code>Transmit num_of_dimensions\nTransmit dim_size_1, dim_size_2, dim_size_3, ...\nTransmit data\n\nReceive num_of_dimensions\nLoop Receiving dimension sizes\nReceive dim_size_1 * dim_size_2 * dim_size_3 * ... of data\n</code></pre>\n\n<p>What I'd probably have to handle such situation is a class / struct looking like:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass MultiDimensional {\n    size_t num_dimensions_; // If known in advance can be made a template parameter also\n    std::vector&lt;size_t&gt; dimension_sizes_;\n    std::vector&lt;T&gt; data_;\npublic:\n    const T&amp; indexing_accessor(...) const;\n    T&amp; indexing_accessor(...);\n    std::vector&lt;uint8_t&gt; render_transmision_data();\n    // construct from transmission data\n    MultiDimensional(std::vector&lt;uint8_t&gt;&amp; transmission_data); \n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1538592522, "post_id": 52633382, "comment_id": 92200850, "body": "Frax, I have considered using Google&#39;s protocol buffers, but my application needs to be as lean and native as possible since it is running on an embedded system. This doesn&#39;t solve my question, but it is something I already went over."}, {"owner": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "reply_to_user": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1538593023, "post_id": 52633382, "comment_id": 92201085, "body": "In that case you I guess you can take a look at <a href=\"https://github.com/nanopb/nanopb\" rel=\"nofollow noreferrer\">nanopb</a> (unless you considered it as well). I have never used it, but it seems like it&#39;s worth a shot."}], "tags": [], "owner": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "is_accepted": false, "score": 0, "last_activity_date": 1538592210, "last_edit_date": 1538592210, "creation_date": 1538590692, "answer_id": 52633382, "question_id": 52632835, "link": "https://stackoverflow.com/questions/52632835/assigning-2d-variable-sized-arrays/52633382#52633382", "title": "Assigning 2D variable sized arrays", "body": "<p>Using low-level stuff like arrays won't help you much, it's too complicated already. Also, it can get you in a hell of compatibility problems (like thinking about byte-order).</p>\n\n<p>Unless you have very strict performance constraints, use a solution designed specifically for networking instead: <a href=\"https://developers.google.com/protocol-buffers/\" rel=\"nofollow noreferrer\">protocol buffers</a>. This is a bit of overkill for your case, but it scales well in case you need to add anything.</p>\n\n<p>To use protocol buffers, you first define \"messages\" (structures) in a <code>.proto</code> file, then compile them to C++ with Proto Compiler.</p>\n\n<p>You define your message like this (this is a complete <code>.proto</code> file):</p>\n\n<pre><code>syntax = \"proto2\";\n\npackage test;\n\nmessage Storage {\n   message Row {\n       repeated string foo = 1;\n   }\n   repeated Row row = 1;\n}\n</code></pre>\n\n<p>There is no direct support for 2D arrays, but an array of arrays will do just fine (<code>repeated</code> means that there can be multiple values in given field, it is basically a vector). You could add fields for array size, if you need quick access to them, but checking the size of repeated fields should suffice in most practical cases.</p>\n\n<p>What you get is a class that have all the fields you need, takes care of memory management, and have <a href=\"https://developers.google.com/protocol-buffers/docs/cpptutorial#parsing-and-serialization\" rel=\"nofollow noreferrer\">a bunch of methods to serialize and deserialize</a>.</p>\n\n<p>The C++ code gets a little longer in places, as you need to use getters and setters, but it should be well offset by the fact that you never need to think about serialization - it happens all by itself.</p>\n\n<p>Example use of this thing in C++ could look like this:</p>\n\n<pre><code>#include \"test.pb.h\"  // Generated from test.proto\n\nusing ::test::Storage;\n\nint main() {\n  Storage s;\n  Storage::Row* row1 = s.add_row();\n  row1-&gt;add_foo(\"foo 0,0\");\n  row1-&gt;add_foo(\"foo 0,1\");\n  Storage::Row* row2 = s.add_row();\n  row2-&gt;add_foo(\"foo 1,0\");\n  row2-&gt;add_foo(\"foo 1,1\");\n\n  assert(s.row_size() == 2);\n  assert(s.row(0).foo_size() == 2);\n\n  s.PrintDebugString();  // prints to stdout\n}\n</code></pre>\n\n<p>In the result, you get this output (note that this is debug output, not real serialization):</p>\n\n<pre><code>row {\n  foo: \"foo 0,0\"\n  foo: \"foo 0,1\"\n}\nrow {\n  foo: \"foo 1,0\"\n  foo: \"foo 1,1\"\n}\n</code></pre>\n\n<p>For completeness: in above example the source files were <code>test.proto</code> and <code>test.cpp</code>, compiled using:</p>\n\n<pre><code>protoc --cpp_out=. test.proto\ng++ test.cpp test.pb.cc -o test -lprotobuf\n</code></pre>\n"}], "owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 52633029, "answer_count": 2, "score": 0, "last_activity_date": 1538592263, "creation_date": 1538588570, "last_edit_date": 1592644375, "question_id": 52632835, "link": "https://stackoverflow.com/questions/52632835/assigning-2d-variable-sized-arrays", "title": "Assigning 2D variable sized arrays", "body": "<p>I'm trying to store a 2D array of variable length c-strings into a struct so I can transmit and rebuild it over a network socket.</p>\n<p>The plan is to have rows and cols, which is in the header of the packet, help me read the variable size lens and arr that come after. I believe I must be syntactically writing the pointers incorrectly or there's some kind of aux pointer I need use when setting them into the struct.</p>\n<pre><code>struct STORAGE {\n   int rows;     // hdr\n   int cols;     // hdr\n   int** lens;\n   const char*** arr;\n}\n\n// code\nint rows = 11;\nint cols = 2;\n\nint lens[rows][cols];\nconst char* arr[rows][cols];\n// ... fill with strings ...\n// ... along with lens ...\n\nSTORAGE store;\nstore.rows = rows;\nstore.cols = cols;\nstore.lens = lens;\nstore.arr = arr;\n</code></pre>\n<p>I get these errors when compiling this code:</p>\n<blockquote>\n<p>error: invalid conversion from <code>int</code> to <code>int**</code> [-fpermissive]</p>\n<p>error: cannot convert <code>const char* [11][2]</code> to `const char***' in assignment</p>\n</blockquote>\n<p>I come from mostly a Java background, but I do understand how pointers work and such. The syntax of this one is just a little sideways for someone with my background (mostly write java/c++ and less c). Any suggestions?</p>\n<p>Note: the reason why I'm not using more complex types like strings, maps, vectors, etc is that I need to transmit the structure over the network (ie pointers to the heap won't work if they have variable sizes). It must be low-level arrays unless someone can offer a better solution.</p>\n"}, {"tags": ["c++", "templates", "inheritance", "template-argument-deduction"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538588387, "post_id": 52632748, "comment_id": 92198781, "body": "How would the compiler distinguish that from a non template <code>class Base</code> or function otherwise?"}, {"owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538588463, "post_id": 52632748, "comment_id": 92198826, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 But how can we call non-template <code>class Base</code> ctor if we derive from <code>Base&lt;T&gt;</code>?"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1538588478, "post_id": 52632748, "comment_id": 92198836, "body": "In my experience, MSVC accepts <code>Derived(int i) : Base(i) {}</code>. I don&#39;t trust it though."}, {"owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1538588552, "post_id": 52632748, "comment_id": 92198873, "body": "@alterigel Actually, the question appeared from this MSVC behavior - in non-conformant mode it accepts omitting <code>&lt;T&gt;</code>, but in conformant - no :)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538589252, "post_id": 52632748, "comment_id": 92199218, "body": "Closest dupe I can find is <a href=\"https://stackoverflow.com/questions/7969048/are-template-arguments-required-everywhere-when-mentioning-a-template-base-class\">this</a>.  TL;DR: Dependent names don&#39;t become injected class names"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 2, "creation_date": 1538589380, "post_id": 52632748, "comment_id": 92199309, "body": "The fix is to write <code>Derived::Base</code>---this forces <code>Base</code> to be looked up in the dependent base class, finding the injected-class-name."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1538589392, "post_id": 52632748, "comment_id": 92199317, "body": "Similar or dupe: <a href=\"https://stackoverflow.com/q/21118605/560648\">stackoverflow.com/q/21118605/560648</a> tl;dr it&#39;s supposed to work but often doesn&#39;t. What compiler are you using?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538589473, "post_id": 52632748, "comment_id": 92199360, "body": "@NathanOliver Interesting contradiction to the findings of 21118605!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538589497, "post_id": 52632748, "comment_id": 92199371, "body": "@NathanOliver Oh I suppose not as in my case the base wasn&#39;t a dependant name"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1538589610, "post_id": 52632748, "comment_id": 92199426, "body": "@LightnessRacesinOrbit That&#39;s my guess.  Since it depends on the template type from the derived class it doesn&#39;t get injected.  I&#39;m not really finding anything else about it and trying to parse the standard is going to take me a bit.  I think I&#39;ll leave it for others."}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538593099, "post_id": 52632748, "comment_id": 92201131, "body": "i dont understand why the answer i gave below is being downvoted but.. it would help if you guys leave a comment. as for your question. you are doing a static polymorphisim. how do you expect compiler to figure it all out because you derived from base class"}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538593134, "post_id": 52632748, "comment_id": 92201151, "body": "and even if compiler A did. how about the compiler B the next person whos going to use ur code?"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538593645, "post_id": 52632748, "comment_id": 92201382, "body": "@Yucel_K I did not downvote you. But I have tried to understand you. I can&#39;t. I think your wording is realy special. I suppose you could try to give an other answer. I you refer to <a href=\"http://eel.is/c++draft/temp.res#10\" rel=\"nofollow noreferrer\">this paragraph</a> you could use a standardized, probably more widely accepted wording."}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538594073, "post_id": 52632748, "comment_id": 92201594, "body": "@undermind <code>But how can we call non-template class Base</code>. what you mean by that?"}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1538594479, "post_id": 52632748, "comment_id": 92201798, "body": "@Oliv i dont mind people downvoting. I mind people downvoting without telling what&#39;s wrong with it."}, {"owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "reply_to_user": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538594859, "post_id": 52632748, "comment_id": 92201985, "body": "@Yucel_K I meant that if we call <code>Base(i)</code> in the <code>Derived</code>&#39;s ctor member initializer list, then it unambiguously means <code>Base&lt;T&gt;(i)</code>, doesn&#39;t it? It was a reply to the top comment, where was mentioned that without <code>&lt;T&gt;</code> compiler can misinterpret <code>Base(i)</code> as a call to non-template class <code>Base</code>."}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538595116, "post_id": 52632748, "comment_id": 92202104, "body": "Base is a template class. it becomes a template class the moment you added the  template &lt;class T&gt; . (im not sure but perhaps some compilers can remove the template decleration <code>template &lt;class T&gt;</code> ) . just have a struct Base and remove the Derived class. and then try to instantiate a non template Base class. your compiler would more likely complain still."}, {"owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "reply_to_user": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538595133, "post_id": 52632748, "comment_id": 92202115, "body": "@Yucel_K Well, I just thought about that <code>Derived</code> class can have a member variable <code>Base</code> <a href=\"https://wandbox.org/permlink/rgKejgApL09LCkMq\" rel=\"nofollow noreferrer\">like this</a>, then we need to distinguish somehow between member variable and base class."}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538595600, "post_id": 52632748, "comment_id": 92202310, "body": "im pretty sure you can not do that (if not all ,  many compilers. can&#39;t handle the ambiguity during compilation). if you want to derive from a base class that is not a template, you can still do it, but slightly differently. I personally like this mainly because it still allows me to have virtual functions on base class <a href=\"https://blog.feabhas.com/2014/06/template-inheritance/\" rel=\"nofollow noreferrer\">blog.feabhas.com/2014/06/template-inheritance</a>  (Deriving from a non-template base class)"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 2, "creation_date": 1538597142, "post_id": 52632748, "comment_id": 92203005, "body": "Injected class name are in the scope of the class. So are class member names. The general rule is that dependent base scope names are not visible at the point of definition of the derived template class. It is true that whatever <code>T</code> the injected class name of <code>Base&lt;T&gt;</code> is <code>Base</code> so compilers could infer that <code>Base</code> designate the injected class name of <code>Base&lt;T&gt;</code>. But that would be an other special rule. My opinion is that the c++ language has enough corner cases, and special rules which hurts coherency. So I am glad to see there is no special treatment for dependent base class injected name."}, {"owner": {"reputation": 646, "user_id": 2012725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31339f862c8a45653f7fceeafa97baed?s=128&d=identicon&r=PG", "display_name": "Yucel_K", "link": "https://stackoverflow.com/users/2012725/yucel-k"}, "edited": false, "score": 0, "creation_date": 1538597957, "post_id": 52632748, "comment_id": 92203361, "body": "@Oliver I agree.  which all boils down how the compiler designed to handle the translation phase of the source code during compilation. this would then clearly explain why <code>Derived(int i) : Base(i)</code> would work. Unfortunately,  i don&#39;t have any knowledge other than the terminology of translation phase."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1541449057, "post_id": 52632748, "comment_id": 93213521, "body": "@undermind I notice this still has not received an answer.  Would you mind if I add the <a href=\"https://stackoverflow.com/questions/tagged/language-lawyer\">language-lawyer</a> tag and start a bounty on this?"}, {"owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1541514432, "post_id": 52632748, "comment_id": 93237518, "body": "@NathanOliver It seems that <a href=\"https://stackoverflow.com/posts/comments/92203005\">Oliv&#39;s comment</a> gives a reasonable conclusion: compiler <i>could</i> infer that <code>Base</code> is <code>Base&lt;T&gt;</code>, but it would be one more special rule, really no great need to introduce it to language. But, if you feel there is something more here, you&#39;re welcome."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1541514594, "post_id": 52632748, "comment_id": 93237628, "body": "@undermind I&#39;m good with the comment.  I just had this marked as a favorite and came back to it yesterday to see if an answer was ever posted.  I&#39;ll just leave it be."}], "owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1538592069, "creation_date": 1538588298, "question_id": 52632748, "link": "https://stackoverflow.com/questions/52632748/why-must-we-specify-template-arguments-for-template-base-class-when-calling-its", "title": "Why must we specify template arguments for template base class when calling its constructor?", "body": "<p>The following code snippet compiles only if I explicitly specify the template argument <code>T</code> for the <code>Base</code> struct in <code>Derived</code> ctor:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct Base\n{\n    Base(int) {}\n};\n\ntemplate &lt;class T&gt;\nstruct Derived : Base&lt;T&gt;\n{\n    Derived(int i) : Base&lt;T&gt;(i) {}\n};\n</code></pre>\n\n<p>If I call <code>Base(i)</code> instead of <code>Base&lt;T&gt;(i)</code> - it doesn't work. Why can't compiler determine that <code>Base</code> is actually <code>Base&lt;T&gt;</code> (because I derive from <code>Base&lt;T&gt;</code>)? Is this requirement made intentionally?</p>\n"}, {"tags": ["c++", "qt", "console", "stdin", "qdebug"], "comments": [{"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1538612220, "post_id": 52632548, "comment_id": 92207571, "body": "What&#39;s the platform, I tested on Win10 + Mingw, Got <code>Test end</code> after press Enter key"}, {"owner": {"reputation": 53, "user_id": 10118509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c306163ccb0fa4bdd13c1ab4438ed5d3?s=128&d=identicon&r=PG&f=1", "display_name": "sardorkun", "link": "https://stackoverflow.com/users/10118509/sardorkun"}, "reply_to_user": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1538618280, "post_id": 52632548, "comment_id": 92208746, "body": "Im using mac os x . Qt 5.10.1 Help, please (("}], "owner": {"reputation": 53, "user_id": 10118509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c306163ccb0fa4bdd13c1ab4438ed5d3?s=128&d=identicon&r=PG&f=1", "display_name": "sardorkun", "link": "https://stackoverflow.com/users/10118509/sardorkun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538609370, "creation_date": 1538587507, "last_edit_date": 1538609370, "question_id": 52632548, "link": "https://stackoverflow.com/questions/52632548/in-qstr-or-qstr-in-readline", "title": "in &gt;&gt; qstr or qstr = in.readLine()", "body": "<p>I want to find alternative for cin >> </p>\n\n<pre><code>#include &lt;QDebug&gt;\n#include &lt;QTextStream&gt;\n#include &lt;QString&gt;\n\nint main(){\n    qDebug() &lt;&lt; \"Test start\";\n    QTextStream in(stdin);\n    QString qstr;\n    qstr = in.readLine();\n    qDebug() &lt;&lt; \"Test end\";\n}\n</code></pre>\n\n<p>Also I tried</p>\n\n<pre><code>in &gt;&gt; qstr;\n</code></pre>\n\n<p>But nothing changed. Console:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1XEhl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1XEhl.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, I input for infinitive and \"Test End\" isn't coming, help me please guys!</p>\n"}, {"tags": ["c++", "c", "armadillo"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1538587193, "post_id": 52632340, "comment_id": 92198182, "body": "Come up with a set of functions that can be called from C that wrap the armadillo functions.  Then apply the steps given in the question you linked."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1538587610, "post_id": 52632340, "comment_id": 92198390, "body": "Your code cannot be compiled by a C compiler, it is C++. Everything else in your question is about C. You tagged both. Please explain the special language-duality of your question, i.e. how this is both about C AND C++."}, {"owner": {"reputation": 29, "user_id": 9918046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-55RfEjZGg8E/AAAAAAAAAAI/AAAAAAAAAFU/HZyW3fg-Si8/photo.jpg?sz=128", "display_name": "Sushant S Samuel", "link": "https://stackoverflow.com/users/9918046/sushant-s-samuel"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1538588021, "post_id": 52632340, "comment_id": 92198591, "body": "@Yunnosch my code is written in c but I want to use some of the functions from armadillo which I want to call in my c program."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1538588577, "post_id": 52632340, "comment_id": 92198886, "body": "That should be called &quot;Library Wrapper implementation&quot;. not &quot;Library implementation&quot;.  That code calls the library, it isn&#39;t the library."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1538595782, "post_id": 52632340, "comment_id": 92202393, "body": "Can you post an example call to armadillo library function made in C++?"}, {"owner": {"reputation": 1382, "user_id": 3928744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b904e3280e386d51bd888433c8ab0fa4?s=128&d=identicon&r=PG&f=1", "display_name": "hbrerkere", "link": "https://stackoverflow.com/users/3928744/hbrerkere"}, "edited": false, "score": 0, "creation_date": 1538614011, "post_id": 52632340, "comment_id": 92207902, "body": "The simplest solution would be to treat your C project as a C++ project.  Bar a few minor differences, C++ can be essentially considered as a superset of C."}], "owner": {"reputation": 29, "user_id": 9918046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-55RfEjZGg8E/AAAAAAAAAAI/AAAAAAAAAFU/HZyW3fg-Si8/photo.jpg?sz=128", "display_name": "Sushant S Samuel", "link": "https://stackoverflow.com/users/9918046/sushant-s-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538586702, "creation_date": 1538586702, "question_id": 52632340, "link": "https://stackoverflow.com/questions/52632340/how-to-call-armadillo-functions-in-c", "title": "how to call armadillo functions in c?", "body": "<p>I am trying to use the complex matrix operations of the armadillo library but my whole code base is in C. How can I make a wrapper for the existing cpp library.</p>\n\n<p>I have gone through examples online and I am able to make the wrapper for my own cpp library but I am a bit confused regarding an existing library such as armadillo. \nI have gone through the link <a href=\"https://stackoverflow.com/questions/26889142/using-eigen-in-a-c-project\">Using Eigen in a C Project</a></p>\n\n<p>Here I am confused with the Library implementation part</p>\n\n<pre><code>/* foo.cpp */\n#include \"foo.h\"\n#include &lt;iostream&gt;\nextern \"C\" {\nvoid foo(int arg) {\n  std::cout &lt;&lt; arg &lt;&lt; std::endl;\n}\n} /* extern \"C\" */\n</code></pre>\n\n<p>How am I supposed to change the library implementation of armadillo and include the wrapper headers to it?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "queue", "std-pair"], "comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1538586669, "post_id": 52632317, "comment_id": 92197900, "body": "Use <a href=\"https://en.cppreference.com/w/cpp/utility/tuple/tie\" rel=\"nofollow noreferrer\"><code>std::tie</code></a>, or, if C++17 is available, use <a href=\"https://en.cppreference.com/w/cpp/language/structured_binding\" rel=\"nofollow noreferrer\">structured bindings</a>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1538587358, "post_id": 52632317, "comment_id": 92198263, "body": "Do you know that you can extract values from <code>myp</code> simply with <code>int a = myp.first, b = myp.second;</code>?"}, {"owner": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1538588010, "post_id": 52632317, "comment_id": 92198586, "body": "@HolyBlackCat that should be an answer I feel"}, {"owner": {"reputation": 171, "user_id": 8044316, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UF2tc_Q6jLE/AAAAAAAAAAI/AAAAAAAAABg/iOqm9MpMIzc/photo.jpg?sz=128", "display_name": "Rakibul Islam", "link": "https://stackoverflow.com/users/8044316/rakibul-islam"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1538588677, "post_id": 52632317, "comment_id": 92198934, "body": "@HolyBlackCat i didn&#39;t know. it&#39;s working and also as well <b>tie</b>"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 8044316, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UF2tc_Q6jLE/AAAAAAAAAAI/AAAAAAAAABg/iOqm9MpMIzc/photo.jpg?sz=128", "display_name": "Rakibul Islam", "link": "https://stackoverflow.com/users/8044316/rakibul-islam"}, "edited": false, "score": 0, "creation_date": 1538587959, "post_id": 52632406, "comment_id": 92198560, "body": "is there any way in C++11?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1538588022, "last_edit_date": 1538588022, "creation_date": 1538586929, "answer_id": 52632406, "question_id": 52632317, "link": "https://stackoverflow.com/questions/52632317/how-to-treated-pair-integer-as-separated-variable/52632406#52632406", "title": "How to treated pair integer as separated variable?", "body": "<blockquote>\n  <p>is there any way to take value in two separate variable from myp</p>\n</blockquote>\n\n<p>Yes:</p>\n\n<pre><code>auto [c, p] = que.front();\n</code></pre>\n\n<p>Those are called Structured Bindings and have been part of the language since C++17.</p>\n\n<blockquote>\n  <p>is there any way in C++98?</p>\n</blockquote>\n\n<p>Yes. If you take a look at the documentation of <code>std::pair</code>, you'll find that it has two members, <code>first</code>, and <code>second</code>.</p>\n\n<pre><code>int a = myp.first;\nint b = myp.second;\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 8044316, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UF2tc_Q6jLE/AAAAAAAAAAI/AAAAAAAAABg/iOqm9MpMIzc/photo.jpg?sz=128", "display_name": "Rakibul Islam", "link": "https://stackoverflow.com/users/8044316/rakibul-islam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 52632406, "answer_count": 1, "score": 3, "last_activity_date": 1538588022, "creation_date": 1538586609, "last_edit_date": 1538586718, "question_id": 52632317, "link": "https://stackoverflow.com/questions/52632317/how-to-treated-pair-integer-as-separated-variable", "title": "How to treated pair integer as separated variable?", "body": "<p>Is there any way to separate paired integer?\nfirst i declare queue in a way:</p>\n\n<pre><code>typedef pair&lt;int,int&gt;pr;\nqueue&lt;pr&gt;que;\n</code></pre>\n\n<p>i can easily push separate variable in it. e.g.</p>\n\n<pre><code>    que.push(make_pair(c,p));\n</code></pre>\n\n<p>now when i take value from queue. i have to take in any paired variable like myp.</p>\n\n<pre><code> pair&lt;int , int&gt; myp = que.front();\n</code></pre>\n\n<p>Now, is there any way to take value in two separate variable from <strong>myp</strong> or directly take value in separate variable from queue?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1538584975, "post_id": 52631864, "comment_id": 92197030, "body": "Unrelated to your problem, but please read <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\">Why should I not #include &lt;bits/stdc++.h&gt;?</a>"}, {"owner": {"reputation": 115, "user_id": 6645558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/533aa064b1820a05704c3b58c660fff1?s=128&d=identicon&r=PG", "display_name": "Jagreet", "link": "https://stackoverflow.com/users/6645558/jagreet"}, "edited": false, "score": 0, "creation_date": 1538585504, "post_id": 52631864, "comment_id": 92197333, "body": "I have re-edited the code to fit the core C++ programming practice. The output is still the same"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1538587043, "post_id": 52631864, "comment_id": 92198098, "body": "You probably want <code>ans += std::to_string(c) + &quot; &quot;;</code>, which uses <code>std::string</code>&#39;s appending operators instead of pointer arithmetic"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1538592717, "post_id": 52631864, "comment_id": 92200947, "body": "See <code>std::ostringstream</code>."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1538587089, "last_edit_date": 1538587089, "creation_date": 1538585334, "answer_id": 52631994, "question_id": 52631864, "link": "https://stackoverflow.com/questions/52631864/how-is-this-particular-code-processed-in-c14/52631994#52631994", "title": "How is this particular code processed in C++14", "body": "<blockquote>\n  <p>I want to know why adding an integer without conversion to a string results in such a behaviour.</p>\n</blockquote>\n\n<p>A string literal is an array of characters. In a value context (such as as an operand of <code>+</code>), an array will be converted into pointer to first element. This implicit conversion is called <em>decaying</em>.</p>\n\n<p>Adding an integer <code>n</code> to a pointer (to an element of an array) will result in a pointer to <code>n</code>th successive sibling of the originally pointed element.  For example, <code>\"abcd\" + 1</code> will result in a pointer to the characer <code>b</code>. This is called pointer arithmetic.</p>\n\n<p>You generate numbers up to 100, so you end up getting a pointer to up to hundredth index of the string literal. However, the length of the string literal is only 2 (the length of the array includes the null terminator in addition to the length of the string itself), so unless you happened to generate only zeroes and ones, those pointers will be outside the bounds of the string literal.</p>\n\n<p>When a character pointer is passed to the compound assignment operator of <code>std::string</code>, that pointer  will be treated as a null terminated pointer to a character string and the pointed object will be accessed.</p>\n\n<p>The behaviour of accessing an array out of bounds is undefined.</p>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1538587184, "post_id": 52632021, "comment_id": 92198179, "body": "<code>&quot; &quot;[1]</code> would be well defined also."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1538587316, "last_edit_date": 1538587316, "creation_date": 1538585491, "answer_id": 52632021, "question_id": 52631864, "link": "https://stackoverflow.com/questions/52631864/how-is-this-particular-code-processed-in-c14/52632021#52632021", "title": "How is this particular code processed in C++14", "body": "<p>In C++ a string literal like e.g. <code>\" \"</code> is really an array of constant characters. As such it will decay to a pointer to its first element.</p>\n\n<p>What you're doing with <code>a+\" \"</code> is <em>pointer arithmetic</em>: You add the value of <code>a</code> to the pointer pointing to the first character of <code>\" \"</code>. In other words, <code>a + \" \"</code> is equal to <code>&amp;\" \"[a]</code>. (It helps knowing that for <em>any</em> pointer or array <code>p</code> and index <code>i</code> the expression <code>*(p + i)</code> is exactly equal to <code>p[i]</code>.)</p>\n\n<p>Unless the values of your variables is <code>0</code> (or <code>1</code>, which is the index of the terminator), then the values as indexes will be <em>way</em> out of bounds of the array holding <code>\" \"</code>, leading to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n"}], "owner": {"reputation": 115, "user_id": 6645558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/533aa064b1820a05704c3b58c660fff1?s=128&d=identicon&r=PG", "display_name": "Jagreet", "link": "https://stackoverflow.com/users/6645558/jagreet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1538587316, "creation_date": 1538584780, "last_edit_date": 1538585452, "question_id": 52631864, "link": "https://stackoverflow.com/questions/52631864/how-is-this-particular-code-processed-in-c14", "title": "How is this particular code processed in C++14", "body": "<p>I know there is a bug in the code, but I am interested to know exactly how C++14 processes the code to output this</p>\n\n<pre><code>3\n\u00fe\u00ff\u00fft\n</code></pre>\n\n<p>With this code</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid pretty_print(int,int,int);\n\nint main()\n{\n    srand(time(0));\n    const int LIM = 100;\n    int a = rand()%LIM;\n    int b = rand()%LIM;\n    int c = rand()%LIM;\n    if(a+b+c&lt;500)\n    {\n        pretty_print(a,b,c);\n    }\n    else throw new std::invalid_argument(\"FOOBAR\");\n    return 0;\n}\n\nvoid pretty_print(int a, int b,int c)\n{\n    std::string ans = \"\";\n    int count = 0;\n    if(a!=0)\n    {\n        count++;\n        ans+=(a+\" \");\n    }\n    if(b!=0)\n    {\n        count++;\n        ans+=(b+\" \");\n    }\n    if(c!=0)\n    {\n        count++;\n        ans+=(c+\" \");\n    }\n    std::cout &lt;&lt; count &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; ans &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>P.S. I have deliberately tried to add an integer to a string without conversion in order to examine why the output is such. I want to know why adding an integer without conversion to a string results in such a behaviour.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1538584704, "post_id": 52631830, "comment_id": 92196906, "body": "You can&#39;t, and this has nothing to do with templates. A class can only initialize its own class&#39;s members. As far as the base classes go, the only thing it can do is invoke the base class&#39;s constructor, and it is the base class&#39;s constructor that&#39;s responsible for initializing its own members."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 2, "creation_date": 1538584709, "post_id": 52631830, "comment_id": 92196907, "body": "Yes, call a base class constructor that initializes them."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1538584773, "post_id": 52631830, "comment_id": 92196932, "body": "@SamVarshavchik Ah I didn&#39;t know that, surprised I haven&#39;t run into it before.  I&#39;m doing some weird mix-in stuff at the moment so that&#39;s why.  I&#39;ll stick with using this-&gt;a = v;"}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1538584827, "post_id": 52631860, "comment_id": 92196957, "body": "That&#39;s the consensus, unfortunately my number of constructor arguments depends on a template parameter (dimensionality for a vector class), so I was inheriting to provide proper constructors, I&#39;ll just use the this-&gt; syntax"}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1538584897, "post_id": 52631860, "comment_id": 92196990, "body": "@SeanMcAllister you can always overload the base constructor for different cases."}], "tags": [], "owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "is_accepted": false, "score": 2, "last_activity_date": 1538584770, "creation_date": 1538584770, "answer_id": 52631860, "question_id": 52631830, "link": "https://stackoverflow.com/questions/52631830/how-to-initialize-members-of-template-base-class-from-derived-constructor-initia/52631860#52631860", "title": "How to initialize members of template-base class from derived constructor initializer list?", "body": "<p>Create a constructor in the base class and call it in the initialization list of the derived class. ie:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct base {\n    T a;\n    base(T v) : a(v) { }\n};\n\ntemplate &lt;typename T&gt;\nstruct derived : base&lt;T&gt; {\n    derived(T v) : base(v) {}\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1538585625, "post_id": 52632016, "comment_id": 92197387, "body": "You edited out the comment right as I did.  That was pretty quick :)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1538585813, "last_edit_date": 1538585813, "creation_date": 1538585465, "answer_id": 52632016, "question_id": 52631830, "link": "https://stackoverflow.com/questions/52631830/how-to-initialize-members-of-template-base-class-from-derived-constructor-initia/52632016#52632016", "title": "How to initialize members of template-base class from derived constructor initializer list?", "body": "<p>You need to initialize the base class in the member initialization list of the derived class.  Since your base doesn't have a constructor you can use curly brace initialization (uniform initialization) like</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct base {\n    T a;\n};\n\ntemplate &lt;typename T&gt;\nstruct derived : base&lt;T&gt; {\n    derived(T v) : base&lt;T&gt;{v} {}\n};\n</code></pre>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 52632016, "answer_count": 2, "score": 0, "last_activity_date": 1538585813, "creation_date": 1538584606, "question_id": 52631830, "link": "https://stackoverflow.com/questions/52631830/how-to-initialize-members-of-template-base-class-from-derived-constructor-initia", "title": "How to initialize members of template-base class from derived constructor initializer list?", "body": "<p>This:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct base {\n    T a;\n};\n\ntemplate &lt;typename T&gt;\nstruct derived : base&lt;T&gt; {\n    derived(T v) : a(v) {} // xxx: how?\n};\n\nint main() {\n    return 0;\n}\n</code></pre>\n\n<p>Goes boom:</p>\n\n<pre><code>test.cc: In constructor \u2018derived&lt;T&gt;::derived(T)\u2019:\ntest.cc:12:20: error: class \u2018derived&lt;T&gt;\u2019 does not have any field named \u2018a\u2019\n     derived(T v) : a(v) {} // xxx: how?\n</code></pre>\n\n<p>If I replace the <code>a(v)</code> with <code>{ this-&gt;a = v; }</code> it's fine, is there any way to initialize members of a templated base class from the initializer list of a derived class?</p>\n"}, {"tags": ["c++", "byte", "boost-asio", "limit"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9371292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa1471a4594ae4168234e6514ac53cc?s=128&d=identicon&r=PG&f=1", "display_name": "SJS", "link": "https://stackoverflow.com/users/9371292/sjs"}, "edited": false, "score": 0, "creation_date": 1538585957, "post_id": 52631955, "comment_id": 92197541, "body": "I get it but the size of my buffer is changing. What i want to do is that according to my protocol , i read one time to get tne nb of bytes i had to read next and then read exactly that size. I can&#39;t create a new buffer all the time because i have to handle that data in the function handler."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 57, "user_id": 9371292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa1471a4594ae4168234e6514ac53cc?s=128&d=identicon&r=PG&f=1", "display_name": "SJS", "link": "https://stackoverflow.com/users/9371292/sjs"}, "edited": false, "score": 0, "creation_date": 1538586144, "post_id": 52631955, "comment_id": 92197641, "body": "So, use the first option (<code>transfer_exactly</code>)"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 0, "last_activity_date": 1538585122, "creation_date": 1538585122, "answer_id": 52631955, "question_id": 52631666, "link": "https://stackoverflow.com/questions/52631666/async-read-until-limit-size-of-bytes-read-boostasio/52631955#52631955", "title": "Async_read_until limit size of bytes read (Boost::asio)", "body": "<p>You could use <code>transfer_exactly</code> (<a href=\"https://www.boost.org/doc/libs/1_68_0/doc/html/boost_asio/reference/transfer_exactly.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_68_0/doc/html/boost_asio/reference/transfer_exactly.html</a>)</p>\n\n<p>Note that there is no guarantee you'll always read the amount, e.g. if the sending side closes the connection early. So check <code>bytes_transferred</code> as well as the <code>error_code</code>.</p>\n\n<p>In many cases you can simply use <code>async_read</code> instead, with a a fixed buffer:</p>\n\n<pre><code>std::vector&lt;char&gt; m_buffer;\n\n// ...\nm_buffer.resize(24); // receive no more than 24 characters\nboost::asio::async_read(m_socket, \n          boost::asio::buffer(m_buffer),                                             \n          boost::bind(&amp;Client::handleRead, shared_from_this(),                                               \n          boost::asio::placeholders::error));\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9371292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa1471a4594ae4168234e6514ac53cc?s=128&d=identicon&r=PG&f=1", "display_name": "SJS", "link": "https://stackoverflow.com/users/9371292/sjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 52631955, "answer_count": 1, "score": 1, "last_activity_date": 1538585122, "creation_date": 1538583957, "question_id": 52631666, "link": "https://stackoverflow.com/questions/52631666/async-read-until-limit-size-of-bytes-read-boostasio", "title": "Async_read_until limit size of bytes read (Boost::asio)", "body": "<p>i want to know how can i limit the size of bytes to read with async_red_until .\nFrom now i used it with a delimter character but i want to change.\nHere is what i do :</p>\n\n<pre><code>void  Client::doRead()                                                                      \n{                                                                                             \n    boost::asio::async_read_until(m_socket,                                               \n                                    m_buffer,                                             \n                                    '\\n',                                                 \n                                  boost::bind(&amp;Client::handleRead,                        \n                                              shared_from_this(),                         \n                                              boost::asio::placeholders::error));         \n                                              }\n</code></pre>\n"}, {"tags": ["c++", "gpu", "vulkan"], "comments": [{"owner": {"reputation": 3566, "user_id": 8089090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c8fc31c29878a0b7a90c1174d366e90?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Gagne", "link": "https://stackoverflow.com/users/8089090/jonathan-gagne"}, "edited": false, "score": 0, "creation_date": 1538585538, "post_id": 52631656, "comment_id": 92197351, "body": "Hello and welcome on StackOverflow!!! In order to get your a better answer, and your answer don&#39;t get deleted later on, you would have to read and follow some basic rules and conventions that will help everyone to communicate and help better. Please go to <a href=\"https://stackoverflow.com/help\">stackoverflow.com/help</a> and read about the topic &quot;What topics can I ask about here?&quot;, and &quot;What types of questions should I avoid asking?&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538588715, "post_id": 52632788, "comment_id": 92198952, "body": "&quot;<i>Device to device copying may be supported if the devices are bound together in some fashion like SLI.</i>&quot; Technically, shared external memory can be used for non-SLI cases. But this requires that both devices are identical hardware (<code>deviceUUID</code> and <code>driverUUID</code> must match). That is, you don&#39;t have to <i>use them</i> as SLI devices, but they have to have theoretically be <i>able</i> to be used that way."}, {"owner": {"reputation": 26262, "user_id": 85306, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4283ac48d7f22118cc4e47a514b3269c?s=128&d=identicon&r=PG", "display_name": "Jherico", "link": "https://stackoverflow.com/users/85306/jherico"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538589489, "post_id": 52632788, "comment_id": 92199368, "body": "Yeah, I re-read my stuff and realized I might be implying that SLI was required when I meant it just as a potential example, so I edited that out of my response.  Thanks for the feedback."}, {"owner": {"reputation": 93, "user_id": 10443874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a685b5fbd7a3495dfd91b34788beeeab?s=128&d=identicon&r=PG&f=1", "display_name": "slocook", "link": "https://stackoverflow.com/users/10443874/slocook"}, "edited": false, "score": 0, "creation_date": 1538611093, "post_id": 52632788, "comment_id": 92207350, "body": "@Jherico Awesome, this is just what I was looking for. Are there any caveats when using <code>VK_KHR_external_memory</code> since it doesn&#39;t allow you to share memory on separate physical devices? I&#39;m interfacing with an OpenGL application that&#39;s running a separate instance per GPU."}, {"owner": {"reputation": 26262, "user_id": 85306, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4283ac48d7f22118cc4e47a514b3269c?s=128&d=identicon&r=PG", "display_name": "Jherico", "link": "https://stackoverflow.com/users/85306/jherico"}, "edited": false, "score": 0, "creation_date": 1538614509, "post_id": 52632788, "comment_id": 92208003, "body": "You just need to match up the GL contexts to the appropriate Vulkan devices using by querying for <code>DEVICE_UUID_EXT</code> and <code>DRIVER_UUID_EXT</code> on the GL side.  Bear in mind that I have not been able to get interoperability to work on my AMD system due to bugs in their implementation of <code>GL_EXT_external_objects</code>.  I&#39;m currently working on an OpenGL interoperability example here:  <a href=\"https://github.com/jherico/Vulkan/blob/gl_test2/examples/glinterop/glinterop.cpp\" rel=\"nofollow noreferrer\">github.com/jherico/Vulkan/blob/gl_test2/examples/glinterop/&hellip;</a>"}], "tags": [], "owner": {"reputation": 26262, "user_id": 85306, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4283ac48d7f22118cc4e47a514b3269c?s=128&d=identicon&r=PG", "display_name": "Jherico", "link": "https://stackoverflow.com/users/85306/jherico"}, "is_accepted": true, "score": 6, "last_activity_date": 1538589390, "last_edit_date": 1538589390, "creation_date": 1538588398, "answer_id": 52632788, "question_id": 52631656, "link": "https://stackoverflow.com/questions/52631656/device-to-device-copy-in-vulkan/52632788#52632788", "title": "Device to device copy in Vulkan", "body": "<blockquote>\n  <p>is there a feature like CUDA p2p?</p>\n</blockquote>\n\n<p>Vulkan 1.1 supports the concept of <a href=\"https://github.com/KhronosGroup/Vulkan-Docs/blob/master/appendices/VK_KHR_device_group.txt\" rel=\"noreferrer\">device groups</a> to cover this situation. \n It allows you to treat a set of physical devices as a single logical device, and also lets you query how memory can be manipulated within the device group, as well as do things like allocate memory on a subset of devices.  Check the specifications for the full set of functionality.  </p>\n\n<blockquote>\n  <p>Is this possible without staging the image on the CPU </p>\n</blockquote>\n\n<p>If your devices don't support the extenson <code>VK_KHR_device_group</code>, then no.  You must transfer the content through the CPU and system memory.</p>\n\n<p>Since buffers are per-device, you would need two host-visible staging buffers, one for the read operation, and another for the write operation.  You'll also need two queues, two command buffers, etc, etc...</p>\n\n<p>You'll have to execute 3 operations with manual synchronization.</p>\n\n<ul>\n<li><p>On the source GPU execute a copy from the device-local buffer to the host visible buffer for the same device.</p></li>\n<li><p>On the CPU copy from the source GPU host visible buffer to the target GPU host-visible buffer</p></li>\n<li><p>On the target GPU copy from the host-visible buffer to the device-local buffer</p></li>\n</ul>\n\n<p>Make sure to inspect your device queue family properties and if possible use a queue from a queue family that is marked as transfer capable but <em>not</em> graphics or compute capable.  The fewer flags a Vulkan queue family has, the better suited it is to the operations that it <em>does</em> have flags for.  Most <a href=\"https://vulkan.gpuinfo.org/\" rel=\"noreferrer\">modern discrete GPUs</a> have dedicated transfer queues, but again, queues are specific to devices, so you'll need to be interacting with one queue for each device to execute the transfer.  </p>\n\n<blockquote>\n  <p>If staging on the host is required, what would be the optimal method for this?</p>\n</blockquote>\n\n<p>Exactly how to execute this depends on your use case.  If you want to execute the whole thing synchronously in a single thread, then you'll just be doing a bunch of submits and then waiting on fences.  If you want to do it asynchronously in the background while you continue to render frames, then you'll still be doing the submits, but you'll have to non-blocking checking on the fences to see when operations complete before you move to the next part.  </p>\n\n<p>If you're transferring buffers there's probably nothing to be worried about in terms of optimal transfer, but if you're dealing with images then you have to get into the whole linear vs optimal image tiling mess.  In order to avoid that I'd suggest using host visible buffers for staging, regardless of whether you're transferring images or buffers, and as such use <code>vkCmdCopyImageToBuffer</code> and <code>vkCmdCopyBufferToImage</code> to do the transfers between device-local and host-visible memory</p>\n"}], "owner": {"reputation": 93, "user_id": 10443874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a685b5fbd7a3495dfd91b34788beeeab?s=128&d=identicon&r=PG&f=1", "display_name": "slocook", "link": "https://stackoverflow.com/users/10443874/slocook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "accepted_answer_id": 52632788, "answer_count": 1, "score": 5, "last_activity_date": 1538589390, "creation_date": 1538583935, "last_edit_date": 1538586780, "question_id": 52631656, "link": "https://stackoverflow.com/questions/52631656/device-to-device-copy-in-vulkan", "title": "Device to device copy in Vulkan", "body": "<p>I want to copy an image/buffer between two GPUs/physical devices in my Vulkan application (one <code>vkInstance</code>, two <code>vkDevice</code>s). Is this possible without staging the image on the CPU or is there a feature like CUDA p2p? How would this look?</p>\n\n<p>If staging on the host is required, what would be the optimal method for this?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1538583682, "post_id": 52631481, "comment_id": 92196410, "body": "Are you sure you&#39;re showing the correct code snippet? Can you provide a link to Coliru, Wandbox, or something like that?"}, {"owner": {"reputation": 880, "user_id": 692061, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/83d281f5163b973ebce4098f2dad1ba0?s=128&d=identicon&r=PG", "display_name": "Duncan", "link": "https://stackoverflow.com/users/692061/duncan"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1538583821, "post_id": 52631481, "comment_id": 92196470, "body": "Yes... Were you having issues when trying it out? <a href=\"https://godbolt.org/z/OcmyJ_\" rel=\"nofollow noreferrer\">godbolt.org/z/OcmyJ_</a>"}], "answers": [{"comments": [{"owner": {"reputation": 880, "user_id": 692061, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/83d281f5163b973ebce4098f2dad1ba0?s=128&d=identicon&r=PG", "display_name": "Duncan", "link": "https://stackoverflow.com/users/692061/duncan"}, "edited": false, "score": 0, "creation_date": 1538585560, "post_id": 52631877, "comment_id": 92197362, "body": "Okay interesting. I&#39;m now confused as to why <code>void (foo&lt;int&gt;::*ptr)(int*) = &amp;foo&lt;int&gt;::doit</code> is valid, though."}, {"owner": {"reputation": 880, "user_id": 692061, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/83d281f5163b973ebce4098f2dad1ba0?s=128&d=identicon&r=PG", "display_name": "Duncan", "link": "https://stackoverflow.com/users/692061/duncan"}, "edited": false, "score": 0, "creation_date": 1538585954, "post_id": 52631877, "comment_id": 92197537, "body": "Ahh, okay, I think I got it. Thanks for your answer!"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 880, "user_id": 692061, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/83d281f5163b973ebce4098f2dad1ba0?s=128&d=identicon&r=PG", "display_name": "Duncan", "link": "https://stackoverflow.com/users/692061/duncan"}, "edited": false, "score": 0, "creation_date": 1538585959, "post_id": 52631877, "comment_id": 92197544, "body": "As there is a Pointer-to-member conversions (see <a href=\"https://en.cppreference.com/w/cpp/language/implicit_conversion\" rel=\"nofollow noreferrer\">implicit_conversion</a>)"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1538584850, "creation_date": 1538584850, "answer_id": 52631877, "question_id": 52631481, "link": "https://stackoverflow.com/questions/52631481/name-lookup-on-template-base-classes-in-non-dependent-name-scenarios/52631877#52631877", "title": "Name lookup on template base classes in non-dependent name scenarios", "body": "<p><code>&amp;foo&lt;int&gt;::doit</code> is actually <code>&amp;foo_base&lt;int&gt;::doit</code></p>\n\n<p>so its type is <code>void (foo_base&lt;int&gt;::*)(int*)</code>, but <code>GetType</code> expects argument of type <code>void (foo&lt;int&gt;::*)(T*)</code> and so cannot deduce <code>T</code>.</p>\n"}], "owner": {"reputation": 880, "user_id": 692061, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/83d281f5163b973ebce4098f2dad1ba0?s=128&d=identicon&r=PG", "display_name": "Duncan", "link": "https://stackoverflow.com/users/692061/duncan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52631877, "answer_count": 1, "score": 1, "last_activity_date": 1538584850, "creation_date": 1538583254, "question_id": 52631481, "link": "https://stackoverflow.com/questions/52631481/name-lookup-on-template-base-classes-in-non-dependent-name-scenarios", "title": "Name lookup on template base classes in non-dependent name scenarios", "body": "<p>Take the following code as an example:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct foo_base\n{\n    void doit(T*) {}\n};\n\ntemplate &lt;typename T&gt;\nstruct foo : foo_base&lt;T&gt; {};\n\ntemplate &lt;typename T&gt;\nstruct get_result\n{\n    template &lt;typename Result&gt;\n    static Result GetType(void (T::*)(Result*));\n\n    using type = decltype(GetType(&amp;T::doit));\n};\n\nint main()\n{\n    std::cout &lt;&lt; typeid(typename get_result&lt;foo&lt;int&gt;&gt;::type).name() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>This code will fail to compile with both GCC and Clang, but succeeds with MSVC. The error clang gives is:</p>\n\n<pre><code>&lt;source&gt;:21:27: error: use of undeclared identifier 'GetType'\n    using type = decltype(GetType(&amp;T::doit));\n                          ^\n&lt;source&gt;:26:34: note: in instantiation of template class 'get_result&lt;foo&lt;int&gt; &gt;' requested here\n    std::cout &lt;&lt; typeid(typename get_result&lt;foo&lt;int&gt;&gt;::type).name() &lt;&lt; '\\n';\n                                 ^\n&lt;source&gt;:19:19: note: must qualify identifier to find this declaration in dependent base class\n    static Result GetType(void (T::*)(Result*));\n                  ^\n</code></pre>\n\n<p>Typically I'd side with GCC/Clang when it comes to conformance, particularly when they both agree, but I can't exactly reason about why. When <code>get_result&lt;foo&lt;int&gt;&gt;</code> is instantiated, it should also instantiate <code>foo_base&lt;int&gt;</code>, so I would think that the expression <code>T::doit</code> should compile without issues.</p>\n\n<p>FWIW the workaround is rather trivial:</p>\n\n<pre><code>template &lt;typename Type, typename Result&gt;\nstatic Result GetType(void (Type::*)(Result*));\n</code></pre>\n"}, {"tags": ["c++", "object", "methods"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1538583408, "post_id": 52631428, "comment_id": 92196278, "body": "Consider manufacturing <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It is easier to read, and understand, than descriptions of code."}], "answers": [{"tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 6, "last_activity_date": 1538583410, "creation_date": 1538583410, "answer_id": 52631518, "question_id": 52631428, "link": "https://stackoverflow.com/questions/52631428/c-choose-a-property-to-sort-by/52631518#52631518", "title": "C++ choose a property to sort by", "body": "<p>Yes, using pointers-to-members.</p>\n\n<pre><code>void sortCars(std::vector&lt;Car&gt; &amp;cars, int Cars::*property) {\n    std::sort(begin(cars), end(cars), [=](Car const &amp;a, Car const &amp;b){\n         return (a.*property) &lt; (b.*property);\n    });\n}\n</code></pre>\n\n<p>Call syntax:</p>\n\n<pre><code>sortCars(myCars, &amp;Cars::modelNo);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 2, "last_activity_date": 1538583479, "creation_date": 1538583479, "answer_id": 52631540, "question_id": 52631428, "link": "https://stackoverflow.com/questions/52631428/c-choose-a-property-to-sort-by/52631540#52631540", "title": "C++ choose a property to sort by", "body": "<p>The standard library approach is to pass a functor that implements the desired comparison.  See <a href=\"https://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\"><code>std::sort</code></a>.</p>\n\n<p>In this case your <code>sortCars</code> function would look something like this:</p>\n\n<pre><code>template &lt;typename Comp&gt;\nvoid sortCars(std::vector&lt;Car&gt;&amp; cars, Comp comp)\n{\n    // compare cars with comp(car1, car2)\n}\n</code></pre>\n\n<p>Then you would call it like this:</p>\n\n<pre><code>sortCars(carsList, [](const Car&amp; a, const Car&amp; b) { return a.year &lt; b.year; });\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 4677628, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/640b058a420fc856868361392ce02949?s=128&d=identicon&r=PG&f=1", "display_name": "tomh1012", "link": "https://stackoverflow.com/users/4677628/tomh1012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 52631518, "answer_count": 2, "score": 1, "last_activity_date": 1538583479, "creation_date": 1538583047, "question_id": 52631428, "link": "https://stackoverflow.com/questions/52631428/c-choose-a-property-to-sort-by", "title": "C++ choose a property to sort by", "body": "<p>Assume that I have a class Car with three properties, all of which are <code>int</code> type: year, modelNo and topSpeed.</p>\n\n<p>I have a list of Cars, and a function that sorts this list. This method currently sorts the cars by car.modelNo. </p>\n\n<p>If I am going to want to sort by either year, modelNo or topSpeed, I could make three different methods, <code>sortByYear</code>, <code>sortByModelNo</code> etc. </p>\n\n<p>Is there a way that I can implement one sorting method, and instead just pass it the name of the property I want to sort by? \nSo I might call <code>sortCars(carsList, modelNo);</code>\nOr <code>sortCars(carsList, year);</code></p>\n\n<p>Each of these properties will always be int, and the list will only ever contain Car objects. </p>\n"}, {"tags": ["c++", "precision", "eigen3"], "answers": [{"comments": [{"owner": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "edited": false, "score": 0, "creation_date": 1538746776, "post_id": 52638614, "comment_id": 92263603, "body": "I believe that you are a developer for Eigen, if that&#39;s true, thanks for your work.  I&#39;m a fan of the library, mainly for it&#39;s speed and ease of use.  I was going through the change log and I saw this <code>operator&#47;=(Scalar) now performs a true division (instead of mat*(1&#47;s)) </code> in version 3.2.7.  Could this explain the very small deltas in the results?"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "reply_to_user": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "edited": false, "score": 0, "creation_date": 1538768463, "post_id": 52638614, "comment_id": 92274422, "body": "Yes it could be that change or a small change in the criterion to decide whether a sub-diagonal entry is numerically zero during the diagonalization. If you&#39;re curious,  you might try to replace <code>S &#47;= n-1</code> by <code>S*=1.&#47;(n-1)</code> ."}, {"owner": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "edited": false, "score": 0, "creation_date": 1538966816, "post_id": 52638614, "comment_id": 92316047, "body": "I tried your suggestion of replacing the division with multiplication and the differences went away.  Can you add this to your answer and I&#39;ll accept it?"}], "tags": [], "owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "is_accepted": false, "score": 2, "last_activity_date": 1538624222, "creation_date": 1538624222, "answer_id": 52638614, "question_id": 52631377, "link": "https://stackoverflow.com/questions/52631377/numerical-differences-between-eigen-version-3-2-0-and-3-3-4/52638614#52638614", "title": "Numerical differences between Eigen version 3.2.0 and 3.3.4", "body": "<p>You should not rely on the sign on the eigenvectors at all (regardless of the solver and library), but rather adjust them to your needs. For instance, if you want to be sure to have a right-handed basis, then update the last one from the cross product of the first twos.</p>\n"}, {"tags": [], "owner": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1539148050, "creation_date": 1539148050, "answer_id": 52732967, "question_id": 52631377, "link": "https://stackoverflow.com/questions/52631377/numerical-differences-between-eigen-version-3-2-0-and-3-3-4/52732967#52732967", "title": "Numerical differences between Eigen version 3.2.0 and 3.3.4", "body": "<p>There was a change in the way that Eigen calculated division by scalar with <a href=\"http://eigen.tuxfamily.org/index.php?title=ChangeLog#Eigen_3.2.7\" rel=\"nofollow noreferrer\">version 3.2.7</a>.</p>\n\n<blockquote>\n  <p>operator/=(Scalar) now performs a true division (instead of mat*(1/s))</p>\n</blockquote>\n\n<p>Testing the code with <code>S *= 1.0 / (static_cast&lt;pilType&gt;(gridPnts.rows() - 1));</code> shows that the numerical differences are resolved.</p>\n"}], "owner": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 52732967, "answer_count": 2, "score": 1, "last_activity_date": 1539148050, "creation_date": 1538582840, "last_edit_date": 1538583334, "question_id": 52631377, "link": "https://stackoverflow.com/questions/52631377/numerical-differences-between-eigen-version-3-2-0-and-3-3-4", "title": "Numerical differences between Eigen version 3.2.0 and 3.3.4", "body": "<p>I recently rolled a code that uses some basic vector math and <code>SelfAdjointEigenSolver</code> from <a href=\"http://eigen.tuxfamily.org/index.php?title=Main_Page\" rel=\"nofollow noreferrer\">Eigen</a> 3.2.0 to 3.3.4.  The code was prototyped with Matlab and it agreed with 3.2.0.  The motivation for rolling to 3.3.4 was to avoid some warnings and errors that occurred with C++11(and newer) and 3.2.0.</p>\n\n<p>The code works by reading thousands of points into a <code>Eigen::Matrix&lt;double, Eigen::Dynamic, 3&gt;</code>.  When I inspect the values using gdb the input values are the same.  One piece of code that shows a numerical differences is shown below.  <code>pilType</code> is defined as <code>double</code>.</p>\n\n<pre><code>// this is the point cloud, center it about the origin\nEigen::Matrix&lt;pilType, 1, 3&gt; center = gridPnts.colwise().mean();\ngridPnts.rowwise() -= center;\n// Get the transformation matrix to align the point cloud with it's normal\n// Build the co variance matrix\nEigen::Matrix&lt;double, 3, 3&gt; S = gridPnts.transpose() * gridPnts;\nS /= static_cast&lt;pilType&gt;(gridPnts.rows() - 1);\nEigen::SelfAdjointEigenSolver&lt;pilMat3&gt; es(S);\nEigen::Matrix&lt;pilType, 3, 2&gt; trans;\ntrans = es.eigenvectors().block&lt;3, 2&gt;(0, 1);\n// convert the point cloud to 2D for Convex Hull calculation\nEigen::Matrix&lt;double, Eigen::Dynamic, Eigen::Dynamic&gt; output(gridPnts.rows(), 2);\noutput = gridPnts * trans;\n</code></pre>\n\n<p>I am compiling the new version with GCC 5.3.0, flags -std=c++11 -O3 -DEIGEN_NO_DEBUG -Wall -Wextra -Werror -march=native -mtune=native.  I have tried with and without the march and mtune options.  The old version was compiled with GCC 4.3.4 and flags -O3 -DEIGEN_NO_DEBUG -Wall -Wextra -Werror.  The CPU is a SandyBridge E5-2670 running SuSE Enterprise SLES 11.  The differences start after the division of <code>S</code> by the number of points - 1.  They are very small, on the order of 1e-12 but when it comes to the eigen solution the values very close to 0 can cause a change of sign in the eigenvectors.  This causes the transformation matrix to be switched for one axis.  The resulting output is flipped along this axis.  The resulting 2D patch is sent to a routine to find the convex hull.  The same points are returned but in reverse order due to the axis flip.  This is not an error but it was unexpected.  </p>\n\n<p>In fact throughout the application various numbers show differences at the 1e-12 to 1e-15 range.</p>\n\n<p>Here are some values when run with GDB (the top values are from version 3.3.4, the lower are from 3.2.0)</p>\n\n<p><code>S</code> before division:</p>\n\n<pre><code>    Eigen::Matrix&lt;double,3,3,ColMajor&gt; (data ptr: 0x7fffffffb0b0) = {[0,0] = 3532221.7020642869,\n  [1,0] = 1.0913936421275139e-11, [2,0] = 3332.4628071428679, [0,1] = 1.0913936421275139e-11,\n  [1,1] = 335265.83999999962, [2,1] = -1.3073986337985843e-12, [0,2] = 3332.4628071428679,\n  [1,2] = -1.3073986337985843e-12, [2,2] = 4697.4509785714226}\n\nEigen::Matrix&lt;double,3,3,ColMajor&gt; (data ptr: 0x7fffffffb8f0) = {[0,0] = 3532221.7020642869,\n  [1,0] = 1.0913936421275139e-11, [2,0] = 3332.4628071428679, [0,1] = 1.0913936421275139e-11,\n  [1,1] = 335265.83999999962, [2,1] = -1.3073986337985843e-12, [0,2] = 3332.4628071428679,\n  [1,2] = -1.3073986337985843e-12, [2,2] = 4697.4509785714226}\n</code></pre>\n\n<p><code>S</code> after division</p>\n\n<pre><code>Eigen::Matrix&lt;double,3,3,ColMajor&gt; (data ptr: 0x7fffffffb0b0) = {[0,0] = 21151.028156073575,\n  [1,0] = 6.5352912702246338e-14, [2,0] = 19.954867108639927, [0,1] = 6.5352912702246338e-14,\n  [1,1] = 2007.5798802395186, [2,1] = -7.8287343341232597e-15, [0,2] = 19.954867108639927,\n  [1,2] = -7.8287343341232597e-15, [2,2] = 28.128448973481571}\n\nEigen::Matrix&lt;double,3,3,ColMajor&gt; (data ptr: 0x7fffffffb8f0) = {[0,0] = 21151.028156073575,\n  [1,0] = 6.5352912702246351e-14, [2,0] = 19.954867108639927, [0,1] = 6.5352912702246351e-14,\n  [1,1] = 2007.5798802395188, [2,1] = -7.8287343341232597e-15, [0,2] = 19.954867108639927,\n  [1,2] = -7.8287343341232597e-15, [2,2] = 28.128448973481575}\n</code></pre>\n\n<p>After preforming the eigensolution the value for <code>trans</code> are:</p>\n\n<pre><code>{[0,0] = 3.4096942364292876e-18, [1,0] = -1,\n  [2,0] = 3.9893751393767394e-18, [0,1] = 0.99999955376919869, [1,1] = 3.4134614846087836e-18,\n  [2,1] = 0.00094470175363752104}\n\n{[0,0] = 0, [1,0] = 1,\n  [2,0] = -3.2750362278258563e-15, [0,1] = 0.9999995537691988, [1,1] = 3.093932467653499e-18,\n  [2,1] = 0.00094470175363752125}\n</code></pre>\n\n<p>The numerical differences are admittedly very small and are within the noise of accuracy.  In the shown numbers the sign of the transformation matrix flipped which caused the 2D cloud to flip.  Is there a way to clean up what was done such that these differences go away?  I've seen some <code>Eigen</code> functions with thresholds for small values but I didn't see one for division.</p>\n"}, {"tags": ["c++", "initializer-list"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1538583011, "post_id": 52631355, "comment_id": 92196068, "body": "The simple way would be to not to.  Have a <code>std::array&lt;int, N * N&gt;</code> as the class member and pretend that it has multiple dimensions."}, {"owner": {"reputation": 649, "user_id": 3600124, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/122fd539f60a59dd354d9e30f8be7253?s=128&d=identicon&r=PG&f=1", "display_name": "user3600124", "link": "https://stackoverflow.com/users/3600124/user3600124"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538583180, "post_id": 52631355, "comment_id": 92196152, "body": "Though I want my initialization to look proper <code>matrix&lt;2&gt; m = {{1, 2}, {3, 4}};</code> and not <code>matrix&lt;2&gt; m = {1, 2, 3, 4};</code>"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1538583614, "post_id": 52631355, "comment_id": 92196385, "body": "I don&#39;t think you can do aggregate initialization once <i>it</i> becomes <code>initializer_list</code>."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1538585130, "last_edit_date": 1538585130, "creation_date": 1538584282, "answer_id": 52631753, "question_id": 52631355, "link": "https://stackoverflow.com/questions/52631355/how-to-initialize-2d-array-from-initializer-list/52631753#52631753", "title": "how to initialize 2D array from initializer_list", "body": "<p><code>std::array</code> is an aggregate.  That means you can initialize it from a <em>braced-init-list</em> like</p>\n\n<pre><code>std::array&lt;int, 4&gt; foo = {1,2,3,4};\n</code></pre>\n\n<p>In your constructor though you don't <em>braced-init-list</em>, you have a <code>std::initlizer_list</code>, which cannot be used to initialize a <code>std::array</code>.  What you would have to do is copy the data from the <code>std::initlizer_list</code> into the array like</p>\n\n<pre><code>template &lt;u8 N&gt;\nmatrix&lt;N&gt;::matrix(std::initializer_list&lt;std::initializer_list&lt;int&gt;&gt; l)\n{\n    u8 counter = 0;\n    for (auto row : l)\n        std::copy(row.begin(), row.end(), arr[counter++].begin());\n}\n</code></pre>\n\n<p>Also note that you don't have to pass the by <code>std::initlizer_list</code> reference.    It is a lightweight object and passing by value is fine, it wont copy the underlying elements.</p>\n\n<hr>\n\n<p>You could change you class to take a the 2d array as a parameter so you can directly initialize <code>arr</code> with that but because of <a href=\"https://stackoverflow.com/questions/12844475/why-cant-simple-initialize-with-braces-2d-stdarray\">how you have to initialize aggregates of aggregates</a> you get into curly brace hell as your code would become</p>\n\n<pre><code>typedef unsigned char u8;\n\ntemplate &lt;u8 N&gt;\nclass matrix {\n    public:\n        matrix(std::array&lt;std::array&lt;int, N&gt;, N&gt; l);\n    private:\n        std::array&lt;std::array&lt;int, N&gt;, N&gt; arr;\n};\n\ntemplate &lt;u8 N&gt;\nmatrix&lt;N&gt;::matrix(std::array&lt;std::array&lt;int, N&gt;, N&gt; l) : arr(l) {}\n\n\nint main()\n{\n    std::array&lt;std::array&lt;int, 2&gt;, 2&gt; arr{{{{1, 2}}, {{3, 4}}}}; // this is how you have to initialize a 2d std::array\n\n    matrix&lt;2&gt; m = {{{{{1, 2}}, {{3, 4}}}}}; // we need one more brace here since we are initialzing the matrix, which needs its own brace\n}\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 3600124, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/122fd539f60a59dd354d9e30f8be7253?s=128&d=identicon&r=PG&f=1", "display_name": "user3600124", "link": "https://stackoverflow.com/users/3600124/user3600124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1538585130, "creation_date": 1538582776, "last_edit_date": 1538583008, "question_id": 52631355, "link": "https://stackoverflow.com/questions/52631355/how-to-initialize-2d-array-from-initializer-list", "title": "how to initialize 2D array from initializer_list", "body": "<pre><code>typedef unsigned char u8;\n\ntemplate &lt;u8 N&gt;\nclass matrix {\n    public:\n        matrix(const std::initializer_list&lt;std::initializer_list&lt;int&gt;&gt;&amp; l);\n    private:\n        std::array&lt;std::array&lt;int, N&gt;, N&gt; arr;\n};\n\ntemplate &lt;u8 N&gt;\nmatrix&lt;N&gt;::matrix(const std::initializer_list&lt;std::initializer_list&lt;int&gt;&gt;&amp; l) : arr(l) {}\n</code></pre>\n\n<blockquote>\n  <p>error C2664:\n  'std::array,2>::array(std::array,2>\n  &amp;&amp;)': cannot convert argument 1 from 'const\n  std::initializer_list>' to 'const\n  std::array,2> &amp;'</p>\n</blockquote>\n\n<p>How do I initialize 2D <code>std::array</code> (or C array for that matter) from 2D <code>std::initializer_list</code>?</p>\n"}, {"tags": ["c++", "cgal"], "comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1538583875, "post_id": 52631265, "comment_id": 92196498, "body": "Seems you over-engineer there. If you need Triangle_3 then store it. If you need color then store it, if you need both then store both. If you do so then don&#39;t store Point_3 since Triangle_3::operator[] already returns those points of it."}, {"owner": {"reputation": 125, "user_id": 4660380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06403577becc89f5ea6d7a6e60dd3c2?s=128&d=identicon&r=PG", "display_name": "AshenCZ", "link": "https://stackoverflow.com/users/4660380/ashencz"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1538584208, "post_id": 52631265, "comment_id": 92196678, "body": "Yes, my primary concern is how I should feed the stored Triangle_3 into the AABB. If I store both color and Triangle_3 in a class MyTriangle, as you say, I can&#39;t feed a vector of MyTriangle into the AABB because it is not a Primitive. (the first example is basically just an overview of what I want to achieve, not the actual implementation)"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1538586677, "post_id": 52631265, "comment_id": 92197904, "body": "You can keep two synchronized vectors: one of Triangle_3 and other of color."}, {"owner": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1538633992, "post_id": 52631265, "comment_id": 92212775, "body": "@&#214;&#246;Tiib solution is good but you can also use your struct or a std::pair and then use a <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/iterator/doc/transform_iterator.html\" rel=\"nofollow noreferrer\"><code>boost::transform_iterator</code></a> so as to have an iterator with <code>value_type</code> being the triangle type the AABB-tree expects. Since the primitive id is this iterator type, you can get access to your initial iterator by using the <code>base()</code> method."}, {"owner": {"reputation": 125, "user_id": 4660380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06403577becc89f5ea6d7a6e60dd3c2?s=128&d=identicon&r=PG", "display_name": "AshenCZ", "link": "https://stackoverflow.com/users/4660380/ashencz"}, "reply_to_user": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "edited": false, "score": 0, "creation_date": 1538668460, "post_id": 52631265, "comment_id": 92233641, "body": "@sloriot oh, that is an interesting option, I have not used boost much so I didn&#39;t know that I can use that and not write my own. Thanks for pointing that out."}], "owner": {"reputation": 125, "user_id": 4660380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06403577becc89f5ea6d7a6e60dd3c2?s=128&d=identicon&r=PG", "display_name": "AshenCZ", "link": "https://stackoverflow.com/users/4660380/ashencz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538582450, "creation_date": 1538582450, "question_id": 52631265, "link": "https://stackoverflow.com/questions/52631265/cgal-proper-way-of-adding-data-to-triangle-class", "title": "CGAL - Proper way of adding data to Triangle class", "body": "<p>I have begun using CGAL and encountered an issue I am not able to solve. I load a model as a list of triangles and want to store additional information for each triangle - a color. I also want to use the AABB tree from CGAL but I have noticed that I have basically two options:</p>\n\n<pre><code>class DataTriangle {\npublic:\n     Point_3 x;\n     Point_3 y;\n     Point_3 z;\n\n     int color;         \n}\n</code></pre>\n\n<ol>\n<li>Follow the \"AABB_custom_example.cpp\" example and create a functor that converts my DataTriangle to a CGAL::Simple_cartesian::Triangle_3 every time. This wastes computation time because it constructs new Triangle_3 object every time.</li>\n<li><p>I can make my own triangle and include Triangle_3 as a member:</p>\n\n<pre><code>class MyTriangle {\n    Triangle mTriangleCgal;\n    int color;\n    const Triangle&amp; getTri() const { return mTriangleCgal; }\n}\n</code></pre>\n\n<p>Then again declare a My_triangle_primitive functor, define</p>\n\n<pre><code>typedef K::Point_3    Point;\ntypedef K::Triangle_3 Datum;\ntypedef const K::Triangle_3&amp; Datum_reference;\n</code></pre>\n\n<p>and reference the underlying triangle as such.</p>\n\n<pre><code>Datum_reference datum() { return tri-&gt;getTri(); }\n</code></pre>\n\n<p>Is this solution okay? I feel it should not waste time by constructing any new objects. Am I right?</p></li>\n<li><p>The third idea I came up with is simply creating a custom iterator that will go through the vector of MyTriangles and instead of the class itself, return the Triangle_3 class. I should be able to pass this iterator into the AABB tree constructor and get the tree constructed from plain Triangle_3 objects, which should work just fine.</p></li>\n</ol>\n\n<p>Is there another way of approach that I missed that is prefered to these three? Is number 2 okay to use if there is not another way?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "inheritance", "system-calls", "polling"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1538581980, "post_id": 52631088, "comment_id": 92195467, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Be sure to show all declarations that are needed to compile your code example."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1538582222, "post_id": 52631088, "comment_id": 92195601, "body": "Might be related: <a href=\"https://stackoverflow.com/questions/274626/what-is-object-slicing\" title=\"what is object slicing\">stackoverflow.com/questions/274626/what-is-object-slicing</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1538582248, "post_id": 52631088, "comment_id": 92195618, "body": "You can pass one, but not an array of them. An array of <code>PollSocket</code> is not an array of <code>pollfd</code>."}, {"owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1538582592, "post_id": 52631088, "comment_id": 92195811, "body": "You should look at how poll() works : <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">poll</a>. The layouts of memory are not the same (pollfd[] vs PollSocket[] ), so that your program works with 1 PollSocket but bugs if 2 or more."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1538583057, "post_id": 52631088, "comment_id": 92196096, "body": "@Code-Apprentice the question is pretty clear the way it is, I&#39;d disagree with the need for more code. I am also uncertain why the question was downvoted."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1538583259, "post_id": 52631088, "comment_id": 92196205, "body": "@SergeyA Specifically, I was wondering about the signature for <code>poll()</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1538587886, "post_id": 52631088, "comment_id": 92198520, "body": "@Code-Apprentice this is a Posix function, so it&#39;s signature is well-known."}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 2, "last_activity_date": 1538582257, "creation_date": 1538582257, "answer_id": 52631206, "question_id": 52631088, "link": "https://stackoverflow.com/questions/52631088/passing-inherited-structs-to-poll/52631206#52631206", "title": "Passing inherited structs to poll()", "body": "<p>You can't treat an array (or vector) of objects polymorphically, and this question is not specific to <code>poll</code> mechanism.</p>\n\n<p>The reason is rather simple - if the function expects a pointer to N objects, each of which has size Z, and you pass it an array of N objects each of which has size Z1, the function will be very confused - it would expect the second object to begin at offset Z, while instead it would begin at offset Z1. Of course, it will lead to all sort of troubles.</p>\n\n<p>The situation would be different, if function expected the array of <strong>pointers</strong> to objects - this would work.</p>\n"}], "owner": {"reputation": 584, "user_id": 6121268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445cd88162e1194f4962fd22a073923?s=128&d=identicon&r=PG&f=1", "display_name": "NikBond", "link": "https://stackoverflow.com/users/6121268/nikbond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 52631206, "answer_count": 1, "score": -1, "last_activity_date": 1538582257, "creation_date": 1538581887, "question_id": 52631088, "link": "https://stackoverflow.com/questions/52631088/passing-inherited-structs-to-poll", "title": "Passing inherited structs to poll()", "body": "<pre><code>class Socket{ //implementation\n};\n\nstruct PollSocket : pollfd  {\n     Socket mSocket;\n     // some methods\n}\n\nstd::vector&lt;PollSocket&gt; mPolledSockets;\npoll(mPolledSockets.data(), mPolledSockets.size(), 0);\n</code></pre>\n\n<p>Can I pass inherited structs to poll()? If not, why? It seems I get a lot of bugs in such case.</p>\n"}, {"tags": ["c++", "c", "linux", "makefile"], "comments": [{"owner": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 1, "creation_date": 1538583012, "post_id": 52631072, "comment_id": 92196069, "body": "I don&#39;t believe you can without the source.  shared libraries are compiled compiled with as position independent addressing <code>-fPIC</code> so without the code I think your out of luck.  Unless I&#39;m misunderstanding you.  Is this your code?"}, {"owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "reply_to_user": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1538589556, "post_id": 52631072, "comment_id": 92199405, "body": "@jiveturkey No this is not my code. I have source code files but i just need to make some library as static instead of dynamic. i have mentioned libraries which i want to convert to static and i have make file which i need to change."}, {"owner": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1538590471, "post_id": 52631072, "comment_id": 92199864, "body": "You need to use <code>ar</code> to create the library after compiling. <a href=\"https://stackoverflow.com/questions/5947067/how-to-create-a-static-library-with-g\" title=\"how to create a static library with g\">stackoverflow.com/questions/5947067/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "reply_to_user": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1538600752, "post_id": 52631072, "comment_id": 92204575, "body": "@jiveturkey i already have .a file in dev package of libevent, i just need to make it as static."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 0, "creation_date": 1538600086, "post_id": 52633851, "comment_id": 92204295, "body": "Thanks for help. You are right, i dont need systemd lib as static. I tried to change my make file as you suggested but i am getting following error when i compile through make -f Makefile : /usr/bin/ld: cannnot find: No such file or directory. Collect2 : error: ld returned 1 exist status."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "reply_to_user": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 0, "creation_date": 1538602043, "post_id": 52633851, "comment_id": 92205020, "body": "@RookieDev <code>&#47;usr&#47;bin&#47;ld: cannnot find:</code> is not the complete error message. You have left out the library that it cannot find."}, {"owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 0, "creation_date": 1538683021, "post_id": 52633851, "comment_id": 92239889, "body": "gcc -o aftpd aftpd.o cmd_parse.o fs_malloc.o ftpcmd.o ftpdata.o string.o fs_vector.o ./linux/loglinux.o ./linux/systemd.o  -Wl, -Bstatic -levent_core -levent_extra -levent -levent_pthreads -Wl, -Bdynamic -lsystemd /usr/bin/ld: cannot find : No such file or directory /usr/bin/ld: cannot find : No such file or directory collect2: error: ld returned 1 exit status Makefile:15: recipe for target &#39;aftpd&#39; failed make: *** [aftpd] Error 1   @Mike Kinghan This is my full error message"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "reply_to_user": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 1, "creation_date": 1538688595, "post_id": 52633851, "comment_id": 92242119, "body": "@RookieDev <code>-Wl, -Bstatic</code> is wrong. <code>-Wl,-Bstatic</code> is right. There is no space in the middle. That is the cause of <code>cannot find : No such file or directory</code>. The same with <code>-Wl, -Bdynamic</code>."}], "tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": true, "score": 3, "last_activity_date": 1538730451, "last_edit_date": 1538730451, "creation_date": 1538592589, "answer_id": 52633851, "question_id": 52631072, "link": "https://stackoverflow.com/questions/52631072/how-to-use-static-library-in-linux-executable/52633851#52633851", "title": "How to use static library in linux executable", "body": "<p>There is no makefile magic that turns shared libraries into static libraries.\nYou need to install the static versions of the libraries on your system and\nthen, in your makefile, specify that the static versions of the libraries are to\nbe linked.</p>\n\n<p>It appears that the static libraries you would need to install are:</p>\n\n<pre><code>libevent_core.a\nlibevent_extra.a\nlibevent.a\nlibevent_pthreads.a\nlibsystemd.a\n</code></pre>\n\n<p>Having installed those libraries, you would modify your makefile to link them\nstatically by changing:</p>\n\n<pre><code>LIBS    = -levent_core -levent_extra -levent -levent_pthreads -lsystemd\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>LIBS    = -Wl,-Bstatic -levent_core -levent_extra -levent -levent_pthreads -lsystemd -Wl,-Bdynamic\n</code></pre>\n\n<p><em>However</em>, you cannot do exactly that, because there is no static version of <code>libsystemd</code>. <a href=\"https://lists.freedesktop.org/archives/systemd-devel/2014-March/017493.html\" rel=\"nofollow noreferrer\">Here's why</a>.</p>\n\n<p>There are static versions of the other libraries in your list. You can install them\nby installing the <code>libevent</code> development package (probably package <code>libevent-dev</code> or <code>libevent-devel</code>,\ndepending on your linux distro). Then you can link those ones statically with:</p>\n\n<pre><code>LIBS    = -Wl,-Bstatic -levent_core -levent_extra -levent -levent_pthreads -Wl,-Bdynamic -lsystemd\n</code></pre>\n\n<p><em>Note</em> that there are no spaces within <code>-Wl,-Bstatic</code> or <code>-Wl,-Bdynamic</code>. GCC options of the form <code>-Wl,...</code> mean that GCC should pass the options <code>...</code> through to its invocation of the linker.</p>\n\n<p>Here is <a href=\"https://sourceware.org/binutils/docs/ld/Options.html\" rel=\"nofollow noreferrer\">the documentation of the linker options</a></p>\n"}], "owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1247, "favorite_count": 0, "accepted_answer_id": 52633851, "answer_count": 1, "score": 0, "last_activity_date": 1538730451, "creation_date": 1538581835, "last_edit_date": 1538695903, "question_id": 52631072, "link": "https://stackoverflow.com/questions/52631072/how-to-use-static-library-in-linux-executable", "title": "How to use static library in linux executable", "body": "<p>I have a project which I compile on Linux. When I run the <code>ldd</code> command against the executable, here's what I get:</p>\n\n<pre><code>libevent_core-2.1.so.6 =&gt; /usr/lib/x86_64-linux-gnu/libevent_core-2.1.so.6 (0x00007fca87a5e000)\nlibevent_pthreads-2.1.so.6 =&gt; /usr/lib/x86_64-linux-gnu/libevent_pthreads-2.1.so.6 (0x00007fca8785b000)\n</code></pre>\n\n<p>Now, I want to make these libraries compile as static libraries. How can I do that?</p>\n\n<p>Here's my make file library:</p>\n\n<pre><code>LIBS    = -levent_core -levent_extra -levent -levent_pthreads -lsystemd\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538581904, "post_id": 52631030, "comment_id": 92195415, "body": "Look up template specialization and SFINAE."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1538581918, "post_id": 52631030, "comment_id": 92195428, "body": "Just create overloads of the function that take different types. This is not really a generic. What happens if I pass type D to it"}, {"owner": {"reputation": 45, "user_id": 10452176, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ODyaefUYVGQ/AAAAAAAAAAI/AAAAAAAAABQ/uqCDhDZ2Suw/photo.jpg?sz=128", "display_name": "Sawyer", "link": "https://stackoverflow.com/users/10452176/sawyer"}, "edited": false, "score": 1, "creation_date": 1538582078, "post_id": 52631030, "comment_id": 92195527, "body": "But there will be 15 - 20 different types of this vectors not only B,C so I don;t want to create 15 - 20 overloaded functions :/"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1538582154, "post_id": 52631030, "comment_id": 92195569, "body": "just as much code gets typed, in fact maybe less -"}, {"owner": {"reputation": 45, "user_id": 10452176, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ODyaefUYVGQ/AAAAAAAAAAI/AAAAAAAAABQ/uqCDhDZ2Suw/photo.jpg?sz=128", "display_name": "Sawyer", "link": "https://stackoverflow.com/users/10452176/sawyer"}, "edited": false, "score": 0, "creation_date": 1538582189, "post_id": 52631030, "comment_id": 92195583, "body": "I simplyfied this template function, at the beginning it is checking if the type is compatible"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1538582746, "post_id": 52631030, "comment_id": 92195912, "body": "if you have 20 <code>vector&lt;std::pair&lt;std::string, T&gt;&gt;</code> why another 20 <code>void addElement(T Obj)</code> is problem? If those <code>vector</code>s are template generated, then generate the corresponded <code>addElement</code> at the same time."}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1538582206, "post_id": 52631166, "comment_id": 92195591, "body": "yup, generics gets waaay too overused (same in c# land)"}, {"owner": {"reputation": 45, "user_id": 10452176, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ODyaefUYVGQ/AAAAAAAAAAI/AAAAAAAAABQ/uqCDhDZ2Suw/photo.jpg?sz=128", "display_name": "Sawyer", "link": "https://stackoverflow.com/users/10452176/sawyer"}, "edited": false, "score": 1, "creation_date": 1538582398, "post_id": 52631166, "comment_id": 92195699, "body": "But I just said this will be 15 - 20 diferent types, so 15 - 20 functions. I will probably use overload but hipotetical is there a way to use template - right now I&#39;m just curious"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 45, "user_id": 10452176, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ODyaefUYVGQ/AAAAAAAAAAI/AAAAAAAAABQ/uqCDhDZ2Suw/photo.jpg?sz=128", "display_name": "Sawyer", "link": "https://stackoverflow.com/users/10452176/sawyer"}, "edited": false, "score": 0, "creation_date": 1538582645, "post_id": 52631166, "comment_id": 92195842, "body": "@Sawyer I&#39;ve updated the answer to show all of your options."}, {"owner": {"reputation": 45, "user_id": 10452176, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ODyaefUYVGQ/AAAAAAAAAAI/AAAAAAAAABQ/uqCDhDZ2Suw/photo.jpg?sz=128", "display_name": "Sawyer", "link": "https://stackoverflow.com/users/10452176/sawyer"}, "edited": false, "score": 0, "creation_date": 1538582754, "post_id": 52631166, "comment_id": 92195917, "body": "Thank you. And I will use your advice regarding overloading ;)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1538583104, "last_edit_date": 1538583104, "creation_date": 1538582144, "answer_id": 52631166, "question_id": 52631030, "link": "https://stackoverflow.com/questions/52631030/how-to-add-element-to-various-container-depending-of-type-using-template/52631166#52631166", "title": "How to add element to various container depending of type using template", "body": "<p>Instead of having</p>\n\n<pre><code>template &lt;class T&gt;  void addElement(T Obj);\n</code></pre>\n\n<p>Just overload the function instead.  That would give you</p>\n\n<pre><code>void addElement(const B&amp; Obj)\n{\n    V1.push_back({Obj.Name, Obj});\n}\n\nvoid addElement(const C&amp; Obj)\n{\n    V2.push_back({Obj.Name, Obj});\n}\n</code></pre>\n\n<p>This saves you all the syntax of specializing the template or needing C++17 and <a href=\"https://en.cppreference.com/w/cpp/language/if#Constexpr_If\" rel=\"nofollow noreferrer\"><code>if constexpr</code></a> to make the decision at compile time.</p>\n\n<hr>\n\n<p>The reason</p>\n\n<pre><code>template &lt;class T&gt;  void addElement(T Obj){\nstd::pair&lt;std::string, T&gt; AddedPair(Obj.Name, Obj);\n\n    if (typeid(T) == typeid(B)) \n        V1.push_back(AddedPair);\n\n    if (typeid(T) == typeid(C)) \n        V2.push_back(AddedPair);\n\n}\n</code></pre>\n\n<p>Doesn't work is the code in each if block needs to be valid (even if it could never be reached), but it can't be because you would be adding a different type into the vectors.  <code>if constexpr</code> helps but I find overloading is just as much typing and makes the code non-backwards compatible.</p>\n\n<p>That means you would either have to specialize the template like</p>\n\n<pre><code>template &lt;class T&gt;  void addElement(T Obj);\n\ntemplate &lt;&gt;  void addElement(B Obj)\n{\n    V1.push_back({Obj.Name, Obj});\n}   \ntemplate &lt;&gt;  void addElement(C Obj)\n{\n    V1.push_back({Obj.Name, Obj});\n}\n</code></pre>\n\n<p>or using <code>if constexpr</code>:</p>\n\n<pre><code>template &lt;class T&gt;  void addElement(T Obj){\nstd::pair&lt;std::string, T&gt; AddedPair(Obj.Name, Obj);\n\n    if constexpr(std::is_same_v&lt;T, B&gt;) \n        V1.push_back(AddedPair);\n\n    if constexpr(std::is_same_v&lt;T, C&gt;) \n        V2.push_back(AddedPair);\n\n}       \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538582910, "post_id": 52631297, "comment_id": 92196014, "body": "Don&#39;t forget to add the functionality to delete the pointers you have just newed up.  Although using a <code>std::unique_ptr</code> would fix that."}, {"owner": {"reputation": 526, "user_id": 5365012, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_2kQk52HsJQ/AAAAAAAAAAI/AAAAAAAAESI/NauEwEkApuc/photo.jpg?sz=128", "display_name": "138", "link": "https://stackoverflow.com/users/5365012/138"}, "edited": false, "score": 0, "creation_date": 1538583043, "post_id": 52631297, "comment_id": 92196088, "body": "Thank you for the observations :)"}], "tags": [], "owner": {"reputation": 526, "user_id": 5365012, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_2kQk52HsJQ/AAAAAAAAAAI/AAAAAAAAESI/NauEwEkApuc/photo.jpg?sz=128", "display_name": "138", "link": "https://stackoverflow.com/users/5365012/138"}, "is_accepted": false, "score": -1, "last_activity_date": 1538583014, "last_edit_date": 1538583014, "creation_date": 1538582556, "answer_id": 52631297, "question_id": 52631030, "link": "https://stackoverflow.com/questions/52631030/how-to-add-element-to-various-container-depending-of-type-using-template/52631297#52631297", "title": "How to add element to various container depending of type using template", "body": "<p>What if you make use of the shared BaseClass like this??\nYou will have to create a common interface for BaseClass, I am not sure how much B and C will differ in terms of functionality though.</p>\n\n<pre><code>class BaseClass{\npublic:\n    std::string Name;\n};\n\nclass B : public BaseClass{\n};\nclass C : public BaseClass{\n};\n\nclass A{\npublic:\n    std::vector&lt;std::pair&lt;std::string, std::unique_ptr&lt;BaseClass&gt;&gt; &gt; V1;\n    std::vector&lt;std::pair&lt;std::string, std::unique_ptr&lt;BaseClass&gt;&gt; &gt; V2;\n\n    template &lt;class T&gt;  void addElement(T Obj)\n    {\n\n        std::pair&lt;std::string, std::unique_ptr&lt;T&gt;&gt; AddedPair(Obj.Name, std::make_unique&lt;T&gt;(Obj));\n\n        if (typeid(T) == typeid(B)) \n            V1.push_back(AddedPair);\n\n        else if (typeid(T) == typeid(C)) \n            V2.push_back(AddedPair);\n    }  \n};\n\nint main()\n{\n  A a;\n  B b;\n  C c;\n\n  a.addElement&lt;B&gt;(b) ;//-&gt; then element b is added to vector V1\n  a.addElement&lt;C&gt;(c) ;//-&gt; then element c is added to vector V2\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 1, "last_activity_date": 1538583773, "last_edit_date": 1538583773, "creation_date": 1538583367, "answer_id": 52631510, "question_id": 52631030, "link": "https://stackoverflow.com/questions/52631030/how-to-add-element-to-various-container-depending-of-type-using-template/52631510#52631510", "title": "How to add element to various container depending of type using template", "body": "<p>This may be a use case for a <a href=\"https://github.com/guaranteed-to-be-unique/Tagged-Tuple\" rel=\"nofollow noreferrer\">Tagged Tuple library</a>. It makes it possible to index containers by associated type. So code dealing with dozens of similar <code>vector&lt;std::pair&lt;std::string, B&gt;&gt; V1;</code> fields becomes generic:</p>\n\n<pre><code>#include &lt;vtt/container/Tagged Tuple.hpp&gt;\n\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n#include &lt;vector&gt;\n#include &lt;utility&gt;\n\nclass BaseClass{::std::string Name;};\nclass B : public BaseClass{};\nclass C : public BaseClass{};\n\nclass A\n{\n    public: template&lt;typename x_Item&gt; using\n    t_Vector = ::std::vector&lt;::std::pair&lt;::std::string, x_Item&gt;&gt;;\n\n    public: using\n    t_Vectors = ::n_vtt::n_container::t_TaggedTuple\n    &lt;// index type -&gt; value type mapping\n        B, t_Vector&lt;B&gt;\n    ,   C, t_Vector&lt;C&gt;\n    &gt;;\n\n    private: t_Vectors m_vectors;\n\n    public: template&lt;typename x_Item&gt; void\n    Add_Item(x_Item &amp;&amp; item)\n    {\n        m_vectors\n            // invoke either Get_MutableItem&lt;B&gt; or Get_MutableItem&lt;C&gt;\n            .Get_MutableItem&lt;::std::remove_reference_t&lt;::std::remove_cv_t&lt;x_Item&gt;&gt;&gt;()\n            // add item into corresponding std::vector\n            .emplace_back(::std::string{}, ::std::forward&lt;x_Item&gt;(item));\n    }\n};\n\nint main()\n{\n    A a;\n    a.Add_Item(B{});\n    C c{};\n    a.Add_Item(c);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1538584155, "last_edit_date": 1538584155, "creation_date": 1538583798, "answer_id": 52631621, "question_id": 52631030, "link": "https://stackoverflow.com/questions/52631030/how-to-add-element-to-various-container-depending-of-type-using-template/52631621#52631621", "title": "How to add element to various container depending of type using template", "body": "<p>You might use \"generic getter\" for your vector:</p>\n\n<pre><code>class A\n{\npublic:\n\n    template &lt;typename T&gt;\n    std::vector&lt;std::pair&lt;std::string, T&gt;&gt;&amp; getVector() {\n        auto vectors = std::tie(V1, V2);\n        return std::get&lt;std::vector&lt;std::pair&lt;std::string, T&gt;&gt;&amp;&gt;(vectors);\n    }\n\n    template &lt;class T&gt;\n    void addElement(T Obj) {\n        getVector&lt;T&gt;().emplace_back(Obj.Name, Obj);\n    }\n\n    std::vector&lt;std::pair&lt;std::string, B&gt;&gt; V1;\n    std::vector&lt;std::pair&lt;std::string, C&gt;&gt; V2;\n};\n</code></pre>\n\n<p>Changing your member might make sense to have <code>std::tuple</code> directly.\nand you might want to templatize the whole class:</p>\n\n<pre><code>template &lt;typename ... Ts&gt;\nclass A_Impl\n{\nprivate:\n    template &lt;typename T&gt;\n    decltype(auto) getVector() const {\n        return std::get&lt;std::vector&lt;std::pair&lt;std::string, T&gt;&gt;&gt;(Vs);\n    }\n    template &lt;typename T&gt;\n    decltype(auto) getVector() {\n        return std::get&lt;std::vector&lt;std::pair&lt;std::string, T&gt;&gt;&gt;(Vs);\n    }\npublic:\n\n    template &lt;class T&gt;\n    void addElement(T Obj) {\n        getVector&lt;T&gt;().emplace_back(Obj.Name, Obj);\n    }\nprivate:\n    std::tuple&lt;std::vector&lt;std::pair&lt;std::string, Ts&gt;&gt;...&gt; Vs;\n};\n\nusing A = A_Impl&lt;B, C&gt;;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 0, "last_activity_date": 1538583930, "creation_date": 1538583930, "answer_id": 52631652, "question_id": 52631030, "link": "https://stackoverflow.com/questions/52631030/how-to-add-element-to-various-container-depending-of-type-using-template/52631652#52631652", "title": "How to add element to various container depending of type using template", "body": "<p>If you are going to use your vectors in a few places you could specialise a template to get the correct vector once, then your main template code can be generic:</p>\n\n<pre><code>class A{\npublic:\n\n  template &lt; typename T &gt;\n  void addElement(T obj)\n  {\n    getVector&lt;T&gt;().push_back(std::make_pair(obj.Name,obj));\n  }\n\n  template &lt; typename T &gt;\n  T&amp; getElement(size_t index)\n  {\n    return getVector&lt;T&gt;().at(index).second;\n  }\n\nprivate:\n  vector&lt;std::pair&lt;std::string, B&gt;&gt; V1;\n  vector&lt;std::pair&lt;std::string, C&gt;&gt; V2;\n\n  template &lt; typename T &gt;\n  vector&lt;std::pair&lt;std::string, T&gt;&gt;&amp; getVector();\n};\n\ntemplate &lt;&gt;\nvector&lt;std::pair&lt;std::string, B&gt;&gt;&amp; A::getVector&lt;B&gt;() { return V1; }\ntemplate &lt;&gt;\nvector&lt;std::pair&lt;std::string, C&gt;&gt;&amp; A::getVector&lt;C&gt;() { return V2; }\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10452176, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ODyaefUYVGQ/AAAAAAAAAAI/AAAAAAAAABQ/uqCDhDZ2Suw/photo.jpg?sz=128", "display_name": "Sawyer", "link": "https://stackoverflow.com/users/10452176/sawyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 52631166, "answer_count": 5, "score": 2, "last_activity_date": 1538584155, "creation_date": 1538581717, "question_id": 52631030, "link": "https://stackoverflow.com/questions/52631030/how-to-add-element-to-various-container-depending-of-type-using-template", "title": "How to add element to various container depending of type using template", "body": "<p>I've got rather silly question but I hope that you can help me with that. </p>\n\n<p>I've got class with multiple vectors, and this vectors have different storage types. </p>\n\n<pre><code>class BaseClass{\n  std::string Name;\n}\n\nclass B : public BaseClass{\n\n}\nclass C : public BaseClass{\n\n}\n\nclass A{\n  vector&lt;std::pair&lt;std::string, B&gt;&gt; V1;\n  vector&lt;std::pair&lt;std::string, C&gt;&gt; V2;\n}\n</code></pre>\n\n<p>inside my class A there is a template function to add elements to this vectors:</p>\n\n<pre><code>template &lt;class T&gt;  void addElement(T Obj);\n</code></pre>\n\n<p>I want this situation to happen: </p>\n\n<pre><code>A a;\nB b;\nC c;\n\n\na.addElement&lt;B&gt;(b) -&gt; then element b is added to vector V1\na.addElement&lt;C&gt;(c) -&gt; then element c is added to vector V2\n</code></pre>\n\n<p>I came up with something like this:</p>\n\n<pre><code>template &lt;class T&gt;  void addElement(T Obj){\n  std::pair&lt;std::string, T&gt; AddedPair(Obj.Name, Obj);\n\n   if (typeid(T) == typeid(B)) \n    V1.push_back(AddedPair);\n\n   if (typeid(T) == typeid(C)) \n    V2.push_back(AddedPair);\n\n}\n</code></pre>\n\n<p>But unfortunetly this code won't compile because somehow template is compiled as a whole and if I use B as a template argument then compiler cannot convert B to C despite that program will never reach a point where this convertions can happened :(</p>\n\n<p>Do you have any suggestions how can I solve this problem? I would be very greatful.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1538580734, "post_id": 52630681, "comment_id": 92194739, "body": "If the <code>std::promise</code> is destroyed, the future will be notified and <code>get</code> will throw a <a href=\"https://en.cppreference.com/w/cpp/thread/future_error\" rel=\"nofollow noreferrer\"><code>std::future_error</code></a>. That&#39;s how you would &quot;abandon&quot; a promise/future. You can also try setting an exception for the <code>std::promise</code>. In both cases the thread will need to catch an exception."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538580860, "post_id": 52630681, "comment_id": 92194819, "body": "If the application is shutting down, and you just don&#39;t want to throw an exception for terminating an active thread, you can <code>detach()</code> it instead of joining it."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538581088, "post_id": 52630681, "comment_id": 92194963, "body": "@NathanOliver Having threads persisting after the end of main leads to all sorts of portability headaches.  I&#39;d strongly advise against it."}, {"owner": {"reputation": 4014, "user_id": 183123, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/362b86b9f6009f4da2cb4cd82890a673?s=128&d=identicon&r=PG", "display_name": "MM.", "link": "https://stackoverflow.com/users/183123/mm"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1538581703, "post_id": 52630681, "comment_id": 92195308, "body": "Given that this is not an &#39;exceptional&#39; circumstance, I would prefer to not set an exception on the promise. To @Yakk-AdamNevraumont&#39;s point, I do not want to detach the thread."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538586652, "post_id": 52630681, "comment_id": 92197898, "body": "You look like you might want your thread to wait until signalled, then do something, then wait again until signalled, then do something, etc, and only exit when told explicitly to do so.  Is this in fact the case?  The code as posted is a bit confusing."}, {"owner": {"reputation": 4014, "user_id": 183123, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/362b86b9f6009f4da2cb4cd82890a673?s=128&d=identicon&r=PG", "display_name": "MM.", "link": "https://stackoverflow.com/users/183123/mm"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538594111, "post_id": 52630681, "comment_id": 92201623, "body": "@PaulSanders essentially I am exploring whether I can replace that idiom with a promise/future approach."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538599014, "post_id": 52630681, "comment_id": 92203845, "body": "Just like real life, the thing with a promise is that you can only use it once..."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1538582017, "creation_date": 1538582017, "answer_id": 52631119, "question_id": 52630681, "link": "https://stackoverflow.com/questions/52630681/how-do-i-notify-a-c-future-without-setting-a-value/52631119#52631119", "title": "How do I notify a c++ future without setting a value?", "body": "<p>So std threading primitives are primitives.  They are ok for direct use in toy applications, where \"shut down early\" means \"tell the OS to shut down the process\".</p>\n\n<p>For more complex applications, you need to build things up from them.</p>\n\n<p>You'll want thread pools instead of using raw threads, you'll probably want continuations of thread tasks, and you'll want a shutdown architecture.</p>\n\n<p>One way to implement a shutdown architecture is to use exceptions.  If all of your outstanding future's have promises in a central bit of code, you can <a href=\"https://en.cppreference.com/w/cpp/thread/promise/set_exception\" rel=\"nofollow noreferrer\">set exception</a> on them.  Or destroy the promises.  Both result in people waiting on the futures to get an exception thrown.</p>\n\n<p>Or you can enforce that <em>all</em> of your promises/futures are actually <code>future&lt;optional&lt;T&gt;&gt;</code> and use \"nullopt\" to say \"we are shutting down\".  Or use <code>future&lt;expected&lt;T,Error&gt;&gt;</code>.</p>\n\n<p>On the other hand, if your async code is based on continuations (including \"continue into a task queue for idle processing on main thread\" and \"continue into another async task\"), you can have a policy for when the source of a continuation has failed.  Some continuation systems give the next one something like an <code>std::experimental::expected&lt;Data, Error&gt;</code>.  Others hand it a ready-or-error-state <code>std::future&lt;Data&gt;</code>.  In other cases, abandoned inputs of continutations cause the continuation to become abandoned automatically.</p>\n\n<p>Shutting down a C++ application is hard, especially if you want to do it on-demand.  It basically requires a global event that rolls-down all control paths in the app in a clean way.  There isn't an easy answer.  There are many easy ways you can get it to sort of work in a way that doesn't seem to cause any immediate problems, like \"just detach the thread\" or \"just call <code>exit</code>\".</p>\n"}], "owner": {"reputation": 4014, "user_id": 183123, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/362b86b9f6009f4da2cb4cd82890a673?s=128&d=identicon&r=PG", "display_name": "MM.", "link": "https://stackoverflow.com/users/183123/mm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 52631119, "answer_count": 1, "score": 2, "last_activity_date": 1538582017, "creation_date": 1538580681, "question_id": 52630681, "link": "https://stackoverflow.com/questions/52630681/how-do-i-notify-a-c-future-without-setting-a-value", "title": "How do I notify a c++ future without setting a value?", "body": "<p>I have a thread waiting on a future. In the event where my application is shut down, I would like to join the thread. How do I go about notifying the future without fudging it and setting it to some value?</p>\n\n<pre><code>auto promise = std::promise&lt;std::string&gt;();\n...\nauto future = promise.get_future();\nauto consumer = std::thread([&amp;]\n{\n   while (future.wait_for(10ms)){\n       // do something\n       std::cout &lt;&lt; future.get().c_str();\n   }\n});\n...\nconsumer.join();\n</code></pre>\n"}, {"tags": ["c#", "c++"], "comments": [{"owner": {"reputation": 6964, "user_id": 2261657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de05cbfc9a0fbef64f55eb69e761bee5?s=128&d=identicon&r=PG", "display_name": "\u03b3\u03b7\u03c1\u03ac\u03c3\u03ba\u03c9 \u03b4&#39; \u03b1\u03b5\u03af \u03c0\u03bf\u03bb\u03bb\u03ac \u03b4\u03b9\u03b4\u03b1\u03c3\u03ba\u03cc\u03bc\u03b5", "link": "https://stackoverflow.com/users/2261657/%ce%b3%ce%b7%cf%81%ce%ac%cf%83%ce%ba%cf%89-%ce%b4-%ce%b1%ce%b5%ce%af-%cf%80%ce%bf%ce%bb%ce%bb%ce%ac-%ce%b4%ce%b9%ce%b4%ce%b1%cf%83%ce%ba%cf%8c%ce%bc%ce%b5"}, "edited": false, "score": 0, "creation_date": 1538585445, "post_id": 52630680, "comment_id": 92197298, "body": "<code>argv[1] = VarValue;</code>??? This is not correct. String is not the same as char array. You need to copy <code>VarValue</code> to <code>argv[1]</code>."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1538587499, "post_id": 52630680, "comment_id": 92198336, "body": "That the address changes is a feature and not a bug, the strings needs to be converted from wchar_t* to char* so the C# array cannot be directly passed to the C function.  If you change the strings (quite risky) then you have to explicitly tell the pinvoke marshaller that it needs to copy them back into the C# array, that requires using [In, Out] on the argument.  It is quite risky because the memory allocated for the new string needs to be released.  Right now you have a dangling pointer to the VarValue local variable that becomes invalid when the function returns, that can&#39;t work at all."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1538587536, "post_id": 52630680, "comment_id": 92198350, "body": "Consider using BSTR in your C++ code, the marshaller knows how to release it."}, {"owner": {"reputation": 1, "user_id": 10451791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bee85214d99c1eb59c2645a39430991?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/10451791/jane"}, "edited": false, "score": 0, "creation_date": 1538632909, "post_id": 52630680, "comment_id": 92212305, "body": "modified argv[1] = VarValue to strcpy_s. But still it is not working."}], "answers": [{"comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1538664352, "post_id": 52649296, "comment_id": 92230977, "body": "Your comment and post will get the OP into big trouble.  He&#39;ll corrupt the GC heap when he copies the string back.  Very hard to diagnose, such corruption doesn&#39;t crash the CLR quick enough."}], "tags": [], "owner": {"reputation": 6964, "user_id": 2261657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de05cbfc9a0fbef64f55eb69e761bee5?s=128&d=identicon&r=PG", "display_name": "\u03b3\u03b7\u03c1\u03ac\u03c3\u03ba\u03c9 \u03b4&#39; \u03b1\u03b5\u03af \u03c0\u03bf\u03bb\u03bb\u03ac \u03b4\u03b9\u03b4\u03b1\u03c3\u03ba\u03cc\u03bc\u03b5", "link": "https://stackoverflow.com/users/2261657/%ce%b3%ce%b7%cf%81%ce%ac%cf%83%ce%ba%cf%89-%ce%b4-%ce%b1%ce%b5%ce%af-%cf%80%ce%bf%ce%bb%ce%bb%ce%ac-%ce%b4%ce%b9%ce%b4%ce%b1%cf%83%ce%ba%cf%8c%ce%bc%ce%b5"}, "is_accepted": false, "score": 0, "last_activity_date": 1538680425, "last_edit_date": 1538680425, "creation_date": 1538663499, "answer_id": 52649296, "question_id": 52630680, "link": "https://stackoverflow.com/questions/52630680/how-to-update-array-values-from-c-dll-while-calling-by-reference-in-c-code/52649296#52649296", "title": "How to update array values from c++ dll while calling by reference in c# code?", "body": "<p>First of all a <code>char</code> in c# is <strong>not</strong> the same as <code>char</code> in c++. You need an <code>sbyte</code> in c# which is the same as <code>char</code> in c++. We will use a <code>byte</code> for convenience. It works fine.</p>\n\n<p>Code:</p>\n\n<pre><code>string args = \"Hello Disney World\";\nstring[] strArray = args.Split( ' ' );\n\nbyte[][] byteArray = new byte[ strArray.Length ][ ];\n\n//convert string to byte array\nfor( int i = 0; i &lt; strArray.Length; i++ ) {\n    byteArray[ i ] = Encoding.ASCII.GetBytes( strArray[ i ] );\n}\n</code></pre>\n\n<p>To get a <code>byte**</code>, you need a <code>byte*[]</code> ( More info <a href=\"https://stackoverflow.com/questions/890098/converting-from-a-jagged-array-to-double-pointer-in-c-sharp\">Converting from a jagged array to double pointer in C#\n</a> ):</p>\n\n<pre><code>unsafe\n{\n    GCHandle[] pinnedArray = new GCHandle[ byteArray.Length ];\n    byte*[] ptrArray = new byte*[ byteArray.Length ];\n\n    for( int i = 0; i &lt; byteArray.Length; i++ ) {\n        pinnedArray[ i ] = GCHandle.Alloc( byteArray[ i ], GCHandleType.Pinned );\n    }\n\n    for( int i = 0; i &lt; byteArray.Length; i++ ) {\n        ptrArray[ i ] = (byte *)pinnedArray[ i ].AddrOfPinnedObject();\n    }\n\n    fixed ( byte **ptr = &amp;ptrArray[ 0 ] ) {\n        IntPtr mptr = (IntPtr)ptr;\n\n        if( false == cbFunction( mptr, strArray.Count() ) ) {\n            //some task\n        }\n\n    }\n\n    for( int i = 0; i &lt; pinnedArray.Length; i++ )\n        pinnedArray[ i ].Free();\n\n}\n</code></pre>\n\n<p>Your declaration should be:</p>\n\n<pre><code>[UnmanagedFunctionPointer( CallingConvention.Cdecl )]\nprivate delegate bool CallBackFunction( IntPtr argv, int argc );\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>For completion there is an easier way to to do it ( <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/interop/marshaling-data-with-platform-invoke\" rel=\"nofollow noreferrer\">Marshaling Data with Platform Invoke</a>, <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/interop/marshaling-different-types-of-arrays\" rel=\"nofollow noreferrer\">Marshaling Different Types of Arrays</a> ):</p>\n\n<pre><code>bool cbFunction(char *argv[], int argc)\n{\n    //Some task\n    STRSAFE_LPSTR temp;\n    const size_t alloc_size = sizeof(char) * 5; //\"Jetix\" num of characters\n\n    temp = (STRSAFE_LPSTR)CoTaskMemAlloc( alloc_size );\n    StringCchCopyA( temp, alloc_size, (STRSAFE_LPSTR)\"Jetix\" );\n\n    CoTaskMemFree( argv[1] );\n    argv[1] = (char *) temp;\n\n    return false;\n}\n</code></pre>\n\n<p>Call it:</p>\n\n<pre><code>string args = \"Hello Disney World\";\nstrArray = args.Split(' ');\nCallBackFunction cbFunction = ((CallBackFunction)Marshal.GetDelegateForFunctionPointer(\n                                pAddressOfFunctionToCall, typeof(CallBackFunction));\n\nif( false == cbFunction(strArray, strArray.Count()) )\n{\n    //some task\n}\n</code></pre>\n\n<p>And declaration:</p>\n\n<pre><code>[UnmanagedFunctionPointer( CallingConvention.Cdecl )]\npublic delegate bool CallBackFunction( [In, Out] String[] argv, int argc );\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10451791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bee85214d99c1eb59c2645a39430991?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/10451791/jane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538680425, "creation_date": 1538580681, "last_edit_date": 1538632847, "question_id": 52630680, "link": "https://stackoverflow.com/questions/52630680/how-to-update-array-values-from-c-dll-while-calling-by-reference-in-c-code", "title": "How to update array values from c++ dll while calling by reference in c# code?", "body": "<p>I am calling a function (named cbFunction) from a c++ dll using c# code. I have to pass array of strings (named strArray) ,from c# code, as arguments to c++ 'cbFunction'. Inside c++ function, I have to change the array's values. The newly changed values should be read back in c# code.</p>\n\n<p>Problems I face:</p>\n\n<ol>\n<li>The base address of strArray in c# and the one received in arguments in c++ dll are totally different.</li>\n<li>I can read the array of strings in c++ dll. But, I have to modify the array's values inside c++ function. When I change those values in c++ function, the change is not reflected in c# code. `</li>\n</ol>\n\n<p>C# code</p>\n\n<pre><code>public static class Call_API\n{\n   [UnmanagedFunctionPointer(CallingConvention.Cdecl)]\n   private delegate bool CallBackFunction(string[] argv, int argc);\n\n   private static  string[] strArray;\n\n   public static void ChangeValue()\n   {\n      IntPtr pDll = NativeMethods.LoadLibrary(\"DllFunctions.dll\");\n      IntPtr pAddressOfFunctionToCall = NativeMethods.GetProcAddress(pDll, \"cbFunction\");\n\n      string args = \"Hello Disney World\";\n      strArray = args.Split(' ');\n      CallBackFunction cbFunction = ((CallBackFunction)Marshal.GetDelegateForFunctionPointer(\n                                                  pAddressOfFunctionToCall, typeof(CallBackFunction));\n      if(false == cbFunction(strArray, strArray.Count()))\n      {\n          //some task\n      }\n   }\n}\n</code></pre>\n\n<p>c++ dll code (DllFunctions.dll) :</p>\n\n<pre><code>bool cbFunction(char** argv, int argc)\n{\n   //Some task\n\n   char VarValue[256] = { 0 };\n   std::string s = \"Jetix\";\n   sprintf_s(VarValue, s.c_str());\n\n   strcpy_s(argv[1], sizeof(VarValue), VarValue);\n   return false;\n}\n</code></pre>\n\n<p>Based on this code, my expected values at the end in strArray (in c#) are {\"Hello\", \"Jetix\", \"World\"}.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "vulkan"], "comments": [{"owner": {"reputation": 26262, "user_id": 85306, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4283ac48d7f22118cc4e47a514b3269c?s=128&d=identicon&r=PG", "display_name": "Jherico", "link": "https://stackoverflow.com/users/85306/jherico"}, "edited": false, "score": 0, "creation_date": 1538584080, "post_id": 52630633, "comment_id": 92196607, "body": "Have you verified that <code>extensions</code> contains the string <code>VK_EXT_debug_utils</code>?   That <code>vkGetInstanceProcAddr(instance, &quot;vkCreateDebugUtilsMessengerEXT&quot;);</code> is not returning null?  What are the severity flags and type flags set on <code>VkDebugUtilsMessengerCreateInfoEXT</code>? There are several points in this where there could be an error but you&#39;re not telling us enough to help you isolate where it is."}], "owner": {"reputation": 49, "user_id": 7932106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IkoEqdSS-FA/AAAAAAAAAAI/AAAAAAAAKT0/WZm2vQUhG0w/photo.jpg?sz=128", "display_name": "Bryn Murrell", "link": "https://stackoverflow.com/users/7932106/bryn-murrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1538580530, "creation_date": 1538580530, "question_id": 52630633, "link": "https://stackoverflow.com/questions/52630633/vulkan-validation-layer-callback-never-being-called", "title": "Vulkan - Validation layer callback never being called", "body": "<p>VK_LAYER_LUNARG_standard_validation seems to be available, VK_EXT_debug_report and VK_EXT_debug_utils are reported as being available, yet even when I do something that ought to force a complaint from the validation layer, my callback is simply never being called.</p>\n\n<pre><code>const std::vector&lt;const char*&gt; validationLayers = {\n    \"VK_LAYER_LUNARG_standard_validation\"\n};\n\ninternal void createInstance(AppWindow* app, bool enableValidationLayers)\n{\n\n    if (enableValidationLayers &amp;&amp; !checkValidationLayerSupport()) {\n        throw std::runtime_error(\"validation layers requested, but not available!\");\n    }\n\n    VkApplicationInfo appInfo = {};\n    appInfo.sType = VK_STRUCTURE_TYPE_APPLICATION_INFO;\n    appInfo.pApplicationName = \"Hello Triangle\";\n    appInfo.applicationVersion = VK_MAKE_VERSION(1, 0, 0);\n    appInfo.pEngineName = \"No Engine\";\n    appInfo.engineVersion = VK_MAKE_VERSION(1, 0, 0);\n    appInfo.apiVersion = VK_API_VERSION_1_0;\n\n    VkInstanceCreateInfo createInfo = {};\n    createInfo.sType = VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO;\n    createInfo.pApplicationInfo = &amp;appInfo;\n\n    auto extensions = getRequiredExtensions(enableValidationLayers);\n    createInfo.enabledExtensionCount = static_cast&lt;uint32_t&gt;(extensions.size());\n    createInfo.ppEnabledExtensionNames = extensions.data();\n\n    if (enableValidationLayers) {\n        createInfo.enabledLayerCount = static_cast&lt;uint32_t&gt;(validationLayers.size());\n        createInfo.ppEnabledLayerNames = validationLayers.data();\n    }\n    else {\n        createInfo.enabledLayerCount = 0;\n    }\n\n    if (vkCreateInstance(&amp;createInfo, nullptr, &amp;app-&gt;renderObjects.instance) != VK_SUCCESS) {\n        throw std::runtime_error(\"failed to create instance!\");\n    }\n}\n\nVkResult CreateDebugUtilsMessengerEXT(VkInstance instance, const VkDebugUtilsMessengerCreateInfoEXT* pCreateInfo, const VkAllocationCallbacks* pAllocator, VkDebugUtilsMessengerEXT* pCallback) {\n    auto func = (PFN_vkCreateDebugUtilsMessengerEXT)vkGetInstanceProcAddr(instance, \"vkCreateDebugUtilsMessengerEXT\");\n    if (func != nullptr) {\n        return func(instance, pCreateInfo, pAllocator, pCallback);\n    }\n    else {\n        return VK_ERROR_EXTENSION_NOT_PRESENT;\n    }\n}\n\nVKAPI_ATTR VkBool32 VKAPI_CALL debugCallback(VkDebugUtilsMessageSeverityFlagBitsEXT messageSeverity, VkDebugUtilsMessageTypeFlagsEXT messageType, const VkDebugUtilsMessengerCallbackDataEXT* pCallbackData, void* pUserData) {\n    std::cerr &lt;&lt; \"validation layer: \" &lt;&lt; pCallbackData-&gt;pMessage &lt;&lt; std::endl;\n\n    return VK_FALSE;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 145, "user_id": 4700415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f55a2189fcae0c84d59ed50e047f41c0?s=128&d=identicon&r=PG&f=1", "display_name": "Abs", "link": "https://stackoverflow.com/users/4700415/abs"}, "edited": false, "score": 0, "creation_date": 1538579676, "post_id": 52630281, "comment_id": 92194057, "body": "I don&#39;t really understand what ::type() here is, would be nice if you can shed some light on that too."}, {"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 2, "creation_date": 1538580075, "post_id": 52630281, "comment_id": 92194322, "body": "It would be quite pleasing if you would submit a complete example of your work along with some discussion regarding research you have done to answer your question..."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1538580139, "post_id": 52630281, "comment_id": 92194361, "body": "When calling non static member function you must pass the object argument: <code>std::bind(std::forward&lt;callable&gt;(f), *this,std::forward&lt;arguments&gt;(args)...)</code>"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1538580175, "post_id": 52630281, "comment_id": 92194389, "body": "Why are you calling <code>bind</code> when you construct the object when the constructor calls <code>bind</code> itself?"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 2, "creation_date": 1538580262, "post_id": 52630281, "comment_id": 92194439, "body": "I think you have your bind call backwards, you pass the callable object first and then the arguments to the binder call afterwards. <code>std::bind(&amp;MotionAnalyser::ObjectGarbageCollector, this)</code>"}, {"owner": {"reputation": 145, "user_id": 4700415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f55a2189fcae0c84d59ed50e047f41c0?s=128&d=identicon&r=PG&f=1", "display_name": "Abs", "link": "https://stackoverflow.com/users/4700415/abs"}, "reply_to_user": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1538580560, "post_id": 52630281, "comment_id": 92194637, "body": "@SirGuy I think you&#39;re right, compilation errors are gone :) Please submit as an answer for me to mark."}, {"owner": {"reputation": 145, "user_id": 4700415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f55a2189fcae0c84d59ed50e047f41c0?s=128&d=identicon&r=PG&f=1", "display_name": "Abs", "link": "https://stackoverflow.com/users/4700415/abs"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1538580682, "post_id": 52630281, "comment_id": 92194701, "body": "@Oliv I have to because this is the only way I can pass that function call as argument, you are right though it does do it again in the function definition."}, {"owner": {"reputation": 259, "user_id": 5386469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ad83326b4e3fc5b3493f84e8960480?s=128&d=identicon&r=PG&f=1", "display_name": "Ratah", "link": "https://stackoverflow.com/users/5386469/ratah"}, "edited": false, "score": 0, "creation_date": 1538583266, "post_id": 52630281, "comment_id": 92196207, "body": "Seems that ::type is only valid from C++14 version and upper"}], "answers": [{"tags": [], "owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "is_accepted": true, "score": 1, "last_activity_date": 1538585741, "creation_date": 1538585741, "answer_id": 52632092, "question_id": 52630281, "link": "https://stackoverflow.com/questions/52630281/why-does-passing-a-non-static-member-function-cause-compilation-errors/52632092#52632092", "title": "Why does passing a non-static member function cause compilation errors?", "body": "<p>You have your call to <code>bind</code> backwards, it takes the callable object first (in this case the pointer to member function) and then the parameters afterwards.</p>\n\n<pre><code>std::bind(&amp;MotionAnalyser::ObjectGarbageCollector, this)\n</code></pre>\n\n<p>However, looking at the constructor for <code>Timer</code> you should be able to pass those arguments along, since they get bound anyway:</p>\n\n<pre><code>Timer timer(252222, duration_type::milliseconds, true,\n            &amp;MotionAnalyser::ObjectGarbageCollector, this);\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4700415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f55a2189fcae0c84d59ed50e047f41c0?s=128&d=identicon&r=PG&f=1", "display_name": "Abs", "link": "https://stackoverflow.com/users/4700415/abs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 52632092, "answer_count": 1, "score": 1, "last_activity_date": 1538585741, "creation_date": 1538579568, "last_edit_date": 1538580381, "question_id": 52630281, "link": "https://stackoverflow.com/questions/52630281/why-does-passing-a-non-static-member-function-cause-compilation-errors", "title": "Why does passing a non-static member function cause compilation errors?", "body": "<p>When I try to invoke the below constructor, passing it a static member function I don't get any errors but when I pass it a non-static member function I get a compilations error:</p>\n\n<p><strong>Constructor</strong></p>\n\n<pre><code>template &lt;class callable, class... arguments&gt;\nTimer(int after, duration_type duration, bool async, callable&amp;&amp; f, arguments&amp;&amp;... args)\n{\n\n    std::function&lt;typename std::result_of&lt;callable(arguments...)&gt;::type()&gt; \n            task(std::bind(std::forward&lt;callable&gt;(f), std::forward&lt;arguments&gt;(args)...));\n\n}\n</code></pre>\n\n<p><strong>Invokation</strong></p>\n\n<pre><code>Timer timer(252222, duration_type::milliseconds, true, &amp;MotionAnalyser::ObjectGarbageCollector); // Does not work because it does not point to object too.\n\nTimer timer(252222, duration_type::milliseconds, true, std::bind(this, &amp;MotionAnalyser::ObjectGarbageCollector)); //Should work, but does not?!?!\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>Error   C2039   'type': is not a member of 'std::result_of&lt;callable (void)&gt;'    \n</code></pre>\n\n<p>So far I have:</p>\n\n<ul>\n<li>Looked into how <code>std:function</code> is used, which turned out to be in\nconjunction with a callable type, the invoking object should be a\ncallable type since I over-rode the <code>()</code> operator (based on my\nunderstanding of callable types).</li>\n<li>I have looked into passing non-static member functions to a function\nhence my attempt at using <code>std::bind</code></li>\n<li>Googled around for useful info on the compilation error.</li>\n</ul>\n"}, {"tags": ["c++", "shared-libraries", "header-files"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538584160, "post_id": 52630113, "comment_id": 92196656, "body": "Side note: including both <code>&lt;stdio.h&gt;</code> and <code>&lt;cstdio&gt;</code> seems a strange choice."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538584395, "post_id": 52630113, "comment_id": 92196779, "body": "Odds are good what you are after is here: <a href=\"https://stackoverflow.com/questions/1142103/how-do-i-load-a-shared-object-in-c\">How do I load a shared object in C++?</a>. If this answewrs your question, let me know and I&#39;ll close as a duplicate."}, {"owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1538605606, "post_id": 52630113, "comment_id": 92206120, "body": "Unfortuately, that does not answer my question."}], "owner": {"reputation": 11, "user_id": 9934350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79691469f69e3b143e5161a1bdc2377?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian-CV-ML", "link": "https://stackoverflow.com/users/9934350/sebastian-cv-ml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538579072, "creation_date": 1538579072, "question_id": 52630113, "link": "https://stackoverflow.com/questions/52630113/c-use-shared-library-in-other-project-without-specifying-i", "title": "C++ Use shared library in other project without specifying -I", "body": "<p>I have built a shared object to later use a function DoSomethingUseful() from the shared object in other projects. It uses external libraries as well as a bunch of headers that I am using across multiple projects.</p>\n\n<p>Using CMake, I created a project MySharedLib with a header file called <code>library.h</code>:</p>\n\n<pre><code>#ifndef MYSHAREDLIB_LIBRARY_H\n#define MYSHAREDLIB_LIBRARY_H\n\n\n\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string&gt;\n#include &lt;cstdio&gt;\n\n// own header files\n#include &lt;header1.h&gt;\n#include &lt;header2.h&gt;\n\n#define PI 3.14159265\n\n//tesseract\n#include &lt;tesseract/baseapi.h&gt;\n#include &lt;leptonica/allheaders.h&gt;\n\n\n//openCV \n#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n\n//face detection\n#include \"opencv2/objdetect.hpp\"\n#include \"opencv2/imgproc.hpp\"\n\nvoid DoSomethingUseul(int[] inparray);\n\n\n#endif\n</code></pre>\n\n<p>With <code>library.cpp</code> as</p>\n\n<pre><code>#include \"library.h\"\nvoid DoSomethingUseful(int[] inparray){...}\n</code></pre>\n\n<p>My CMake file is as such: </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\nproject(MYSHAREDLIB)\n\nfind_package( OpenCV REQUIRED )\n\nset(CMAKE_CXX_STANDARD 11)\n\nset(MY_INCLUDE_DIR ../source/)\nset(MY_OPENCV_CASCADES /opencvpath/openCV34/opencv/sources/data/haarcascades/)\ninclude_directories(${MY_INCLUDE_DIR} ${MY_OPENCV_CASCADES} /usr/include)\n\nlink_directories(${MY_INCLUDE_DIR})\n\nadd_library(MYSHAREDLIB SHARED library.cpp library.h\n        ${MY_INCLUDE_DIR}header1.cpp\n        ${MY_INCLUDE_DIR}header1.h\n        ${MY_INCLUDE_DIR}header2.cpp\n        ${MY_INCLUDE_DIR}header2.h\n        )\n\nset_target_properties(MYSHAREDLIB PROPERTIES VERSION 3.10)\n\ntarget_link_libraries(MYSHAREDLIB lept tesseract ${OpenCV_LIBS})\n</code></pre>\n\n<p>The *.so file is created sucessfully, i. e. using Clion, no errors are thrown and the file <code>libMySharedLib.so</code> is there.</p>\n\n<p>I then want to use the function <code>DoSomethingUseful()</code> in another file <code>DoSomething.cpp</code>: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"library.h\"\n\nusing namespace std;\n\nint main()\n{\n\n    int[2] myarray; myarray[0]=1; myarray[1] =2;\n\n    DoSomethingUseful(myarray);\n\n    return 0;\n}\n</code></pre>\n\n<p>And </p>\n\n<pre><code>g++ -g -Wall -Wl,-rpath -Wl,'pwd' -o DoSomething DoSomething.cpp -I ../source/ -L. libMYSHAREDLIB.so \n</code></pre>\n\n<p>I can then call the programm by <code>./DoSomething</code> just properly. </p>\n\n<p>The problem is, that this is not what I want. I want to compile a new project file such as <code>./DoSomethingOnlyDependentOnMYSHAREDLIB</code>. Although I already link <code>header1.h</code> and <code>header2.h</code> in <code>MySharedLib.so</code> in the Cmake file: </p>\n\n<pre><code>add_library(MYSHAREDLIB SHARED library.cpp library.h\n        ${MY_INCLUDE_DIR}header1.cpp\n        ${MY_INCLUDE_DIR}header1.h\n        ${MY_INCLUDE_DIR}header2.cpp\n        ${MY_INCLUDE_DIR}header2.h\n        )\n</code></pre>\n\n<p>I do still need the information of the directive of <code>header1.h</code> and <code>header2.h</code>during linking and compiling by </p>\n\n<pre><code>-I ../source/ \n</code></pre>\n\n<p>How can I avoid this? I only want to copy my *.so somewhere and create new function calls in new *.cpp's only based on MySharedLib.so (i. e. only dependent on one file). \nThanks so much for your help! </p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538578980, "post_id": 52630051, "comment_id": 92193544, "body": "This looks like a more generic version of <a href=\"https://stackoverflow.com/questions/52629501/lambda-as-a-template-variable\">this question</a>"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1538579278, "post_id": 52630051, "comment_id": 92193757, "body": "Is there a specific version of C++ (like C++17?) you care about, or every version that supports variable templates?"}, {"owner": {"reputation": 53, "user_id": 10451807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9b9a2d96a03a39a8469dc85be39b12?s=128&d=identicon&r=PG&f=1", "display_name": "Tin Tin", "link": "https://stackoverflow.com/users/10451807/tin-tin"}, "edited": false, "score": 0, "creation_date": 1538579343, "post_id": 52630051, "comment_id": 92193813, "body": "C++14 specifically, but I am assuming it is the same explanation for any that supports variable templates. I am trying to figure out if what I am doing falls under NDR... but the program seems to behave correctly under Clang."}], "answers": [{"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": true, "score": 2, "last_activity_date": 1538586891, "last_edit_date": 1538586891, "creation_date": 1538583325, "answer_id": 52631500, "question_id": 52630051, "link": "https://stackoverflow.com/questions/52630051/are-template-variables-allowed-within-multiple-translation-units-and-effectively/52631500#52631500", "title": "Are template variables allowed within multiple translation units and effectively merged?", "body": "<p>According to the c++14 standard <a href=\"https://timsong-cpp.github.io/cppwp/n4140/basic.def.odr#4\" rel=\"nofollow noreferrer\">[basic.def]/4</a>:</p>\n\n<blockquote>\n  <p>Every program shall contain exactly one definition of every non-inline function or variable that is odr-used in that program outside of a discarded statement; no diagnostic required.</p>\n</blockquote>\n\n<p>So if <code>my_data&lt;T&gt;</code> is ord-used with the same template argument in multiple translation unit, you should have a odr-violation (without any diagnostic). <code>inline</code> variables appeared in c++17 to solve that problem and this is why <code>type_traits</code> *_v family of variable template are declared <code>inline</code>.</p>\n\n<p>In practice, with Gcc and Clang (at least, I cannot check other compilers), you will not get any odr violation because template variables have \"vague linkage\" (as if they were declared inline).</p>\n\n<p>You can check it with <code>nm</code>. If you run this command line <code>g++ -c test.cpp -std=c++14 &amp;&amp; nm test.o | c++filt | grep my_data</code>, you should see that <code>my_data&lt;int&gt;</code> is a symbol of categorie <code>u</code> which is according to <code>nm</code> documentation : </p>\n\n<blockquote>\n  <p>The symbol is a unique global symbol.  This is a GNU extension to the standard set of ELF symbol bindings.  For such a symbol the dynamic linker will make sure that in the entire process there is just one symbol with this name and type in use.</p>\n</blockquote>\n\n<hr>\n\n<p>In <a href=\"http://open-std.org/JTC1/SC22/WG21/docs/cwg_active.html#1849\" rel=\"nofollow noreferrer\">Core issue #1849</a> one can read this obscure sentence:</p>\n\n<blockquote>\n  <p>The description in 6.2 [basic.def.odr] paragraph 6 of when entities can be multiply-declared in a program does not, but should, discuss variable templates.</p>\n</blockquote>\n\n<p>I would bet that if all compilers give to variable templates a vague linkage, a future revision of the standard may reflect that. But for now we should use the inline specifier as it is done in the stl.</p>\n"}], "owner": {"reputation": 53, "user_id": 10451807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9b9a2d96a03a39a8469dc85be39b12?s=128&d=identicon&r=PG&f=1", "display_name": "Tin Tin", "link": "https://stackoverflow.com/users/10451807/tin-tin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 3, "accepted_answer_id": 52631500, "answer_count": 1, "score": 5, "last_activity_date": 1538586891, "creation_date": 1538578854, "question_id": 52630051, "link": "https://stackoverflow.com/questions/52630051/are-template-variables-allowed-within-multiple-translation-units-and-effectively", "title": "Are template variables allowed within multiple translation units and effectively merged?", "body": "<p>See the following:</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/definition#One_Definition_Rule\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/language/definition#One_Definition_Rule</a></p>\n\n<p><a href=\"http://eel.is/c++draft/basic.def.odr#12\" rel=\"noreferrer\">http://eel.is/c++draft/basic.def.odr#12</a></p>\n\n<p>It states that multiple definitions of class templates, static data members of class templates, partial template specializations, etc are allowed and will act as one single definition. Great... but it does not mention variable templates anywhere?</p>\n\n<p>If I have the following in multiple translation units:</p>\n\n<pre><code>template&lt;typename T&gt;\nT my_data{};\n\ninline void test() {\n    my_data&lt;int&gt; = 1;\n}\n</code></pre>\n\n<p>Will each translation unit will be given their own definition of <code>my_data</code> resulting in multiple symbols, or will they all be effectively merged into a single definition within the program where calling <code>test()</code> in one translation unit will modify the variable for another translation unit?</p>\n\n<p>Where in the standard does it mention this behavior?</p>\n"}, {"tags": ["c++", "arduino"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538579345, "post_id": 52629993, "comment_id": 92193814, "body": "You can&#39;t <code>delete</code> an array...You seem to already have the answer: declare the global variable as a pointer: <code>graphStruct *graph  = nullptr;</code>. Then use <code>new</code> and <code>delete</code> to create/resize."}, {"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538579564, "post_id": 52629993, "comment_id": 92193967, "body": "I tried this, unfortunately the arduino begins to run slower and slower and eventually crashes. I forgot to mention this. I&#39;ll update my post to include this information."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538579633, "post_id": 52629993, "comment_id": 92194020, "body": "From what I understand, <code>new</code> and <code>delete</code> should be used sparingly on a microcontroller like the Arduino. You should initially make the array as large as you think you will need. Then, only re-alloc the array when a larger size is required. If a smaller size is needed, keep the array, just don&#39;t use it all."}, {"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538579806, "post_id": 52629993, "comment_id": 92194138, "body": "The problem with this is that the user might want one big graph which would require a large buffer or many smaller graphs with many small buffers. The arduino doesn&#39;t have enough memory to allocate as many array members as I want with the largest possible buffer size. I only want to malloc once at the beginning during the initial serial setup then not touch it after."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538581473, "post_id": 52629993, "comment_id": 92195164, "body": "There are only so many pixels in that little display. Why do you need to store so much data? Does the data arrive in a stream or all at once? (Also, I tried to look at the code but Google docs does not display it well. Pastebin is better as it has syntax highlighting and line numbers)."}, {"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538673475, "post_id": 52629993, "comment_id": 92236179, "body": "The display is 128 pixels wide, and it takes 2 bytes of buffer space for each y value in the array. Each graph instance takes 2 bytes each for the xpos, ypos, xwidth, yheight, readyBool, newVal. Lol, I asked this question over on the arduino forums: <a href=\"https://forum.arduino.cc/index.php?topic=570277.0\" rel=\"nofollow noreferrer\">forum.arduino.cc/index.php?topic=570277.0</a> and they told me they wouldn&#39;t help me cause I used pastebin. I&#39;ll go make a pastebin link for you and update my question."}, {"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538673961, "post_id": 52629993, "comment_id": 92236402, "body": "The data arrives in a stream of 4 bytes, 2 for the int to tell the receiver which graph to add to and 2 for the incoming int."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1538674769, "post_id": 52629993, "comment_id": 92236771, "body": "It&#39;s a catch-22. On the one hand people prefer you put the code directly in your question. On the other hand some complain if you post too much code. Links to code are frowned upon because links can die. A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is prefered, but that&#39;s often hard to do with embedded code."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "edited": false, "score": 0, "creation_date": 1538681696, "post_id": 52653258, "comment_id": 92239278, "body": "The part about using map() is definitely helpful. The reason we need the x/y positions is because the code should be perfectly usable on the larger"}, {"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "edited": false, "score": 0, "creation_date": 1538682664, "post_id": 52653258, "comment_id": 92239728, "body": "displays running on the same oled driver, and I want the code to be portable to larger displays with a more powerful arduino-compatible arm processor. The bool isReady is a flag for a function at the end of the loop that checks if any graphs are ready to be updated instead of redrawing the screen every time. This brings it from ~8 loops per second to over 40. I have plans to hook up an arduino DUE or other arduino ide compatible microcontroller with a larger display."}, {"owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "edited": false, "score": 0, "creation_date": 1538682982, "post_id": 52653258, "comment_id": 92239867, "body": "I really like the idea of using one larger buffer and allocating chunks of that each individual graph needs. The stop and start locations could even be included in the buffer itself. The byte part will give me a lot more space to play with thank you. Assuming that you had a large enough display you could run a ton of slow-moving graphs, it&#39;s mostly just an issue of memory."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "edited": false, "score": 0, "creation_date": 1538684541, "post_id": 52653258, "comment_id": 92240559, "body": "Yes, I think using a single buffer will bring the most improvement."}], "tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": false, "score": 0, "last_activity_date": 1538678585, "creation_date": 1538678585, "answer_id": 52653258, "question_id": 52629993, "link": "https://stackoverflow.com/questions/52629993/deleting-and-re-instantiating-an-arrayed-struct-globally-from-within-a-function/52653258#52653258", "title": "Deleting and re instantiating an arrayed struct globally from within a function without knowing the size of the array at compile", "body": "<p>A couple ideas that may help.</p>\n\n<p>The display is 128 pixels, so you need a buffer no larger than that. I suggest you make that a single, global buffer (instead of each struct having its own buffer). This will never need to be re-sized with <code>new/delete</code>, no matter how many graphs you have.</p>\n\n<pre><code>uint8_t global_graph_buffer[128];\n</code></pre>\n\n<p>Notice that I have changed it from <code>int</code> to <code>byte</code>. The height of the display is only 30 or 40 pixels (?) so there's no need to store any number bigger than that. Just scale the value down when it comes in on the port.</p>\n\n<pre><code>graph_buffer[x] = map(incoming_data, 0, max_input, 0, height_of_graph);\n</code></pre>\n\n<p>See the Arduino <a href=\"https://www.arduino.cc/reference/en/language/functions/math/map/\" rel=\"nofollow noreferrer\"><code>map()</code></a> function.</p>\n\n<p>Next, do you really need the y_pos and height of the graphs? Do you plan on having more than 1 row of graphs? If not, get rid of those struct members. Also, you can get rid of the x_pos and width fields as well. These can be calculated based on the indexes.</p>\n\n<pre><code>struct graphStruct {\n  uint8_t gx;  // Removed\n  uint8_t gy;  // Removed\n  uint8_t gw;  // Removed\n  uint8_t gh;  // Removed\n  int gVal;              // What is this for?\n  //int graphBuffer[graphBufferSize]; This is gone\n  uint8_t start_index;   // First index in the global array\n  uint8_t end_index;     // Last index\n  bool isReady;          // What is this for?\n};\n</code></pre>\n\n<p>To calc x_pos and width:</p>\n\n<pre><code>x_pos = start_index\nwidth = end_index - start_index\n</code></pre>\n\n<p>To handle incoming data, shift just the part of the buffer for the given graph and add the value:</p>\n\n<pre><code>int incoming_data = some_value_from_serial;\n// Shift\nfor (byte i = graph[graphNumber].start_index+1; i &lt; graph[graphNumber].end_index; i++) {\n    global_graph_buffer[i] = global_graph_buffer[i-1]\n }\n// Store\nglobal_graph_buffer[i] = map(incoming_data, 0, graphMax, 0, 128);\n</code></pre>\n\n<p>Lastly, you need to consider: how many graphs can you realistically display at one time? Set a max, and create only that many structs at the start. If you use a global buffer, as I suggest, you can re-use a struct multiple times (without having to use <code>new/delete</code>). Just change the <code>start_index</code> and <code>end_index</code> fields.</p>\n\n<p>Not sure if any of this helps, but maybe you can get some ideas from it.</p>\n"}], "owner": {"reputation": 11, "user_id": 10451792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D40iJcZ-Dkk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUli8K8OPquNx0c7y4n2hYSvJUctw/mo/photo.jpg?sz=128", "display_name": "Andrew Spangler", "link": "https://stackoverflow.com/users/10451792/andrew-spangler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538678585, "creation_date": 1538578705, "last_edit_date": 1538673828, "question_id": 52629993, "link": "https://stackoverflow.com/questions/52629993/deleting-and-re-instantiating-an-arrayed-struct-globally-from-within-a-function", "title": "Deleting and re instantiating an arrayed struct globally from within a function without knowing the size of the array at compile", "body": "<p>Full code: <a href=\"https://pastebin.com/E22ZjbE7\" rel=\"nofollow noreferrer\">Pastebin</a></p>\n\n<p>Full code with your comments enabled (Google Drive): <a href=\"https://docs.google.com/document/d/193a8RCdreRLMRJGnt7iLq_qB8QVTOc0IVJ8S4D1M6eU/edit?usp=sharing\" rel=\"nofollow noreferrer\">SerialGrapherV0.9</a></p>\n\n<p>Code-in-progress is near the bottom.</p>\n\n<p>youTube example of graphing code running: <a href=\"https://www.youtube.com/watch?v=WOhJ6M41eao\" rel=\"nofollow noreferrer\">Grapher</a></p>\n\n<p>Background: My goal is to write a library to allow a caller Arduino to drive a callee Arduino via serial and print to a master-defined graph or graphs on an SSD1306 I2C display(no SPI version to test with). The graphing code is finished. Currently I can have 4 graphs that can update synchronously or asynchronously, there is no blanking and only writes the portions that need updating. </p>\n\n<p>Both arduinos currently run the same sketch and determine their role via a pullup_input tied to ground, however in later versions the sketch will compile using if statements with a #defined boolean to greatly save on program space for the caller arduino.</p>\n\n<p>So far:\nThe actual graphing is working and the graph updates whenever a graphAdd(graphNumber, newVal); is called. \nThe xpos, ypos, xlength, and ylength, of each graph can be defined on the caller side as such:</p>\n\n<pre><code>#define masterGraphNum 4                  //Set this to the number of Graphs you want. \n\ngraphStruct graph[masterGraphNum] = {             //Each set of brackets is an instance of a graph, one for each specified in graphNum, set the array number on the receiver to the max number of graphs you can use.\n  //Graph 1                           //Usage: {LeftX, TopY, width, height}\n  {0, 0, 31, 32},\n  //Graph 2\n  {32, 0, 31, 32},\n  //Graph 3\n  {64, 0, 31, 32},\n  //Graph 4\n  {96, 0, 31, 32},\n};\n</code></pre>\n\n<p>Currently I am trying to use <code>delete[] (graph);</code> followed by <code>graphStruct *graph = new graphStruct[incomingGraphNum];</code> where incomingGraphNum is an int sent by the caller and received by the callee, this seems to work at first, however after a short time of graphing ~15 seconds the arduino crashes and restarts.</p>\n\n<p>FLOW:</p>\n\n<ul>\n<li>Callee awaits connection indefinitely</li>\n<li>Caller sends ready byte</li>\n<li>Callee acks</li>\n<li>Caller sends number of graphs wanted</li>\n<li>NOT WORKING: Re-initializing graph</li>\n<li>Graph adds data via called function</li>\n<li>NYI: Sending graph number and new value over serial </li>\n</ul>\n\n<p>My problem is now instantiating a globally accessible array of structs from within a function as I don't want to have to pre-code the number of graphs into the callee, as well as assign the size of the buffer array within the struct.</p>\n\n<p>For the functions to work graph[] needs to be declared globally. I would like to globally declare graph[number of graphs] within a function during the callee setup, as I want to make this into a plug-and play diagnostic tool for my future projects. </p>\n\n<p>Next Steps:\nSetting up packets to send the graph data over. Not too hard, essentially sending two ints like (graph#, graphData)\nAdd graph \"titling\" (like \"ACC\" or \"Light intensity\")</p>\n\n<p>Implemented:</p>\n\n<ul>\n<li>Graphing system</li>\n<li>Simple serial \"call - response\" system and acknowledgement system. (Just discovered the stream function included with the Arduino IDE, currently rewriting a few sections to use Serial.parseInt() instead of a modified serialEvent().</li>\n<li>Basic Error Handling</li>\n<li>Loops/Second counter</li>\n</ul>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538578901, "post_id": 52629977, "comment_id": 92193484, "body": "At which OS are you running that program?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538578959, "post_id": 52629977, "comment_id": 92193524, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Windows?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538579018, "post_id": 52629977, "comment_id": 92193576, "body": "@PaulSanders What makes you sure from that question?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538579174, "post_id": 52629977, "comment_id": 92193692, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Visual Studio?  That&#39;s where most people run it...  But I see what you mean."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538579282, "post_id": 52629977, "comment_id": 92193762, "body": "@Paul There are other OS where you can use VS Code for example."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1538579310, "post_id": 52629977, "comment_id": 92193791, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Yes, I edited my comment and my answer."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1538580320, "post_id": 52629977, "comment_id": 92194480, "body": "A description of &quot;wouldn&#39;t work&quot; is insufficient.   What input did you provide to the <code>pause</code> command?   What behaviour did you ACTUALLY observe?   Does the program behave one way if run within Visual Studio and another way if run from a command prompt?"}, {"owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1538581949, "post_id": 52629977, "comment_id": 92195445, "body": "@Peter What happens when I run it is that the output window comes up for a split second before going away. It&#39;s supposed to display the sentence before and then wait for the user to press the key to start the timer."}], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 0, "last_activity_date": 1538579126, "creation_date": 1538579126, "answer_id": 52630127, "question_id": 52629977, "link": "https://stackoverflow.com/questions/52629977/systempause-isnt-working-even-with-correct-header/52630127#52630127", "title": "System(&quot;pause&quot;) isn&#39;t working even with correct header", "body": "<p>That actually works fine for me (on Windows), but if all you want to do is read a keystroke then try this (should work everywhere):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdlib&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nint main() {\n    int range = (rand() % 5) + 1;\n    double start = 0;\n    double end = 0;\n\n    cout &lt;&lt; \"Try to hit the same key within \" &lt;&lt; range &lt;&lt; \"seconds.\";\n\n    int c = getc (stdin);\n    start = clock();\n\n    c = getc (stdin);\n    end = clock();\n\n    c = getc (stdin);\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://rextester.com/AQAP8681\" rel=\"nofollow noreferrer\">Live demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 2142, "user_id": 1689504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af4a48f5ed0d4a54a43844ea1ecc395?s=128&d=identicon&r=PG", "display_name": "HerrJoebob", "link": "https://stackoverflow.com/users/1689504/herrjoebob"}, "is_accepted": false, "score": 1, "last_activity_date": 1538586604, "creation_date": 1538586604, "answer_id": 52632315, "question_id": 52629977, "link": "https://stackoverflow.com/questions/52629977/systempause-isnt-working-even-with-correct-header/52632315#52632315", "title": "System(&quot;pause&quot;) isn&#39;t working even with correct header", "body": "<p>\"pause\" isn't a program you can run by itself, it's a function of the command prompt. If you must do this using a system call, instead run:</p>\n\n<p><code>\ncmd.exe /c pause\n</code></p>\n"}], "owner": {"reputation": 19, "user_id": 10361701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bd2ef01cade72310f1ec1409eed7fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10361701/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1382, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1538586604, "creation_date": 1538578662, "last_edit_date": 1538578981, "question_id": 52629977, "link": "https://stackoverflow.com/questions/52629977/systempause-isnt-working-even-with-correct-header", "title": "System(&quot;pause&quot;) isn&#39;t working even with correct header", "body": "<p>I'm making this program where I have to use system(\"pause\") a few times in Visual Studio, but whenever I run the code, it doesn't pause at all. I have the <code>&lt;cstdlib&gt;</code> header and everything in there. Is there another reason why this wouldn't work? Thanks!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdlib&gt;\n#include &lt;stdlib.h&gt;\n\n\nusing namespace std;\n\nint main() {\n    int range = (rand() % 5) + 1;\n    double start = 0;\n    double end = 0;\n\n    cout &lt;&lt; \"Try to hit the same key within \" &lt;&lt; range &lt;&lt; \"seconds.\";\n\n    system(\"pause\");\n    start = clock();\n\n    system(\"pause\");\n    end = clock();\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1538578705, "post_id": 52629870, "comment_id": 92193360, "body": "The class definition <code>A::B</code> is private to class <code>A</code>.  Make it public and it compiles live: <a href=\"https://godbolt.org/z/_FgdYt\" rel=\"nofollow noreferrer\">godbolt.org/z/_FgdYt</a>"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1538578751, "post_id": 52629870, "comment_id": 92193390, "body": "@RichardCritten: He knows that. He doesn&#39;t want to make it public."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1538578896, "post_id": 52629870, "comment_id": 92193480, "body": "@NicolBolas Without class <code>A::B</code> being public how can it be used in the global (outside the scope of A) context?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1538578917, "post_id": 52629870, "comment_id": 92193497, "body": "@RichardCritten: That is <i>literally</i> the question he is asking. Or more specifically, why it isn&#39;t possible to do that."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1538579366, "post_id": 52629870, "comment_id": 92193826, "body": "you need to know there is <code>B</code> inside <code>A</code>, and private type is not visible to others AFAIK. if you do not want <code>B</code> in header, something like <code>PIMPL</code> may be what you want."}], "answers": [{"comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538580074, "post_id": 52630450, "comment_id": 92194321, "body": "You made <code>B</code> public. The point was to avoid breaking encapsulation. This also means that <code>A</code> cannot store a member of type <code>B</code> or use it in any way that requires that a definition of the class exist."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538580145, "post_id": 52630450, "comment_id": 92194367, "body": "@NicolBolas this is effectively private. that&#39;s said, if it is truly private, no global function can access it."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538580194, "post_id": 52630450, "comment_id": 92194399, "body": "@NicolBolas you can use in the sense of <code>PIMPL</code>."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538580202, "post_id": 52630450, "comment_id": 92194403, "body": "Global functions can if they&#39;re <code>friend</code> declared inline within <code>B</code>. Which is again the point of the question: why can you do it when it&#39;s inline defined, but not when it&#39;s externally defined."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538580414, "post_id": 52630450, "comment_id": 92194543, "body": "@NicolBolas I think the point is <i>Is there a way to avoid friend repetition other than defining the function inline</i>. and my answer is on that point. BTW, this does not break encapsulation much AFAICT."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538580677, "post_id": 52630450, "comment_id": 92194699, "body": "@NicolBolas and nothing outside <code>A</code> would have any type of instance to <code>B</code>. what&#39;s the point to make it global function after all?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538581674, "post_id": 52630450, "comment_id": 92195287, "body": "As the OP said: <code>operator&lt;&lt;(ostream&amp;, const B&amp;)</code>."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1538582169, "post_id": 52630450, "comment_id": 92195573, "body": "@NicolBolas one can only possible to use this operator inside <code>A</code> (and <code>B</code>)."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1538589525, "post_id": 52630450, "comment_id": 92199391, "body": "@appleapple Operator in <code>A</code> uses operator in <code>B</code>. Imagine that you have a <code>Tree</code> class and it has an internal private class implementing <code>Node</code> and you want to write a serializer for <code>Tree</code>."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1538621199, "post_id": 52630450, "comment_id": 92209308, "body": "@luk32 I see no problem."}], "tags": [], "owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "is_accepted": false, "score": 0, "last_activity_date": 1538580817, "last_edit_date": 1538580817, "creation_date": 1538580032, "answer_id": 52630450, "question_id": 52629870, "link": "https://stackoverflow.com/questions/52629870/do-i-really-have-to-break-encapsulation-when-defining-out-of-line-friend-for-a-n/52630450#52630450", "title": "Do I really have to break encapsulation when defining out of line friend for a nested class?", "body": "<p>Something like forward declaration or PIMPL can solve it.</p>\n\n<hr>\n\n<pre><code>//header\nclass A\n{\n    public:\n    class B;\n};\n\nextern A::B instance;\nvoid f2(const A::B&amp;);\n\n//main\nint main(){\n    f2(instance);\n}\n\n//impl / another header\nclass A::B{\nfriend void f1(const B&amp;){};\nfriend void f2(const B&amp;);\nint data=0;\n};\n\n// impl\n#include&lt;iostream&gt;\nvoid f2(const A::B&amp; b){\n    std::cout &lt;&lt; \"inside:\" &lt;&lt; b.data;\n}\n\nA::B instance;\n</code></pre>\n\n<hr>\n\n<p>this should not be much different from make <code>A::B</code> private.</p>\n"}, {"comments": [{"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1538590445, "post_id": 52630527, "comment_id": 92199852, "body": "I would suspect language to allow accessing private name in <code>A</code> if the function is a friend of the name, not introduce &quot;as-if&quot; rules, so make A::B visible to friends of B, even if it&#39;s private. Friend could access privates of all the classes that friend it. I agree that this would an exception to standard access rule, but a warranted one IMHO. Current rules render friends of private nested classes useless unless defined inline. The relaxation is pretty slight but maybe it would have some non-obvious consequences. Surely friending the outside class for inner-related function seems bad."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1538591680, "post_id": 52630527, "comment_id": 92200393, "body": "@luk32: &quot;<i>I would suspect language to allow accessing private name in A if the function is a friend of the name</i>&quot; But that&#39;s the thing: there&#39;s no such thing as being &quot;a friend of the name&quot;. Being a friend of a <i>class</i> means having access to <i>that class&#39;s</i> privates. The fact that that class just so happens to be a private member of something else is not relevant."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 2, "last_activity_date": 1538580235, "creation_date": 1538580235, "answer_id": 52630527, "question_id": 52629870, "link": "https://stackoverflow.com/questions/52629870/do-i-really-have-to-break-encapsulation-when-defining-out-of-line-friend-for-a-n/52630527#52630527", "title": "Do I really have to break encapsulation when defining out of line friend for a nested class?", "body": "<p>Accessibility in C++ is centered around the ability to access a name from a given scope. <code>A::B</code> names a private member of <code>A</code>. This means that declarations/definitions which are not either members of <code>A</code> or direct friends of <code>A</code> are not allowed to use the name <code>A::B</code> directly.</p>\n\n<p><code>f2</code> uses the name <code>A::B</code> in its declaration. If that declaration appears outside of the scope of <code>A::B</code>, it therefore must either be a member of <code>A</code> or a direct friend of <code>A</code>.</p>\n\n<p>That's just how accessibility works in C++. What you're encountering is simply the inevitable result of how those rules play out.</p>\n\n<p>What you're getting confused by is the oddball consequence of the rules for inline <code>friend</code> definitions. It's <em>they</em> who have the unexpected rules; or rather, unexpected interaction with obvious rules. These <code>friend</code> declarations are in a scope where <code>A::B</code> is already accessible, so they can use the name as much as they like. And since you can provide a definition for such functions in-situ, there is no need to make <code>A::B</code> visible to that definition.</p>\n\n<p>Would it be theoretically possible to change the rules of accessibility, so as to automatically make external definitions of <code>friend</code>ed functions work <em>as if</em> they were defined in the class that <code>friend</code>ed them? That would be a very weird thing, since a function can be <code>friend</code>s of multiple classes. So which class would it work \"as if\" it had been defined within?</p>\n"}], "owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1538580817, "creation_date": 1538578383, "question_id": 52629870, "link": "https://stackoverflow.com/questions/52629870/do-i-really-have-to-break-encapsulation-when-defining-out-of-line-friend-for-a-n", "title": "Do I really have to break encapsulation when defining out of line friend for a nested class?", "body": "<p>Consider such example:</p>\n\n<pre><code>class A\n{\n    class B {\n        friend void f1(const B&amp;){};\n        friend void f2(const B&amp;);\n    };\n    // friend void f2(const B&amp;); // has to be repeated =[\n};\n\nvoid f2(const A::B&amp;){}\n</code></pre>\n\n<p><strong>Is there a way to avoid friend repetition other than defining the function inline?</strong></p>\n\n<p>I find it surprising that to pull definition out of a class it's needed to repeat oneself, leak details of nested class to the outer one, and IMHO most importantly allow access to <code>A</code> privates to the unrelated function.</p>\n\n<p>The general rule of friendess is that it's not transitive, but here I am basically forced to break it for out-of-line definition, I find it pretty hard trade-off.</p>\n\n<p>Is there a technical reason behind it? I guess the argument could be that out-of-line needs private info that <code>A</code> contains <code>B</code>, though I am not sure it that's it. Seems unconvincing vs drawbacks.</p>\n\n<p><em>Notes: I am not interested in reorganizing class hierarchy to avoid the problem.  The question is not purely academic; I had had <code>operator&lt;&lt;(ostream&amp;, const B&amp;)</code> and wanted to move definition out of the header.</em></p>\n"}, {"tags": ["c++", "templates", "operator-overloading", "argument-dependent-lookup"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 1915199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aadb7bfa18f251dce45bf4b01d3d352?s=128&d=identicon&r=PG", "display_name": "Eugene", "link": "https://stackoverflow.com/users/1915199/eugene"}, "edited": false, "score": 0, "creation_date": 1538583296, "post_id": 52631252, "comment_id": 92196221, "body": "You are right. Thank you!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1538582402, "creation_date": 1538582402, "answer_id": 52631252, "question_id": 52629859, "link": "https://stackoverflow.com/questions/52629859/adl-for-class-in-anonymous-namespace/52631252#52631252", "title": "ADL for class in anonymous namespace", "body": "<pre><code>template&lt;typename T&gt;\ninline std::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, std::vector&lt;T&gt; const&amp; value)\n{\n    stream &lt;&lt; \"[\";\n    std::copy(value.begin(), value.end(), std::ostream_iterator&lt;T&gt;(stream, \", \"));\n    stream &lt;&lt; \"]\";\n\n    return stream;\n}\n</code></pre>\n\n<p>this operator isn't in any associatied namespace of <code>vector</code> or <code>ostream</code> or <code>T</code> (which in this case is <code>anonymous_ns::Struct</code>).  So it cannot be found via ADL.</p>\n\n<p>It is attempted to be called by:</p>\n\n<pre><code>template&lt;typename T&gt;\ninline std::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, QuotedStringImpl&lt;T&gt; const&amp; rhs)\n{\n    return stream &lt;&lt; rhs.Value;\n}\n</code></pre>\n\n<p>which is located <em>earlier</em> in the source.</p>\n\n<p>As a general rule, adding operators outside of the namespace of a type is a bad plan.</p>\n\n<p>As a specific rule, adding operators into <code>namespace std</code> is illegal.</p>\n\n<p>As a consequence, adding operators to types or templates in <code>namespace std</code> is a bad plan.</p>\n\n<p>To fix your specific problem, simply move the definition of the above <code>&lt;&lt;</code> above the point where it is called.  Your code now compiles.  It remains fragile, because it relies on adding operators to types from <code>std</code>.</p>\n\n<p><a href=\"https://godbolt.org/z/rWHCLM\" rel=\"nofollow noreferrer\">Live example</a>.</p>\n\n<p>MSVC fails to do proper two-phase lookup, so it (in error) compiles your code.  Proper two-phase lookup does a lookup at the point where the template was defined, and then does an <em>ADL only</em> lookup at the point where it is instantiated.</p>\n\n<p>MSVC instead does a <em>full</em> lookup at the point where it is instantiated.  This is in violation of the C++ standard.</p>\n"}], "owner": {"reputation": 27, "user_id": 1915199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aadb7bfa18f251dce45bf4b01d3d352?s=128&d=identicon&r=PG", "display_name": "Eugene", "link": "https://stackoverflow.com/users/1915199/eugene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "closed_date": 1538601231, "accepted_answer_id": 52631252, "answer_count": 1, "score": 1, "last_activity_date": 1538582679, "creation_date": 1538578350, "last_edit_date": 1538582679, "question_id": 52629859, "link": "https://stackoverflow.com/questions/52629859/adl-for-class-in-anonymous-namespace", "closed_reason": "Not suitable for this site", "title": "ADL for class in anonymous namespace", "body": "<p>Does anybody know why <a href=\"http://coliru.stacked-crooked.com/a/a04bf6e2091313d3\" rel=\"nofollow noreferrer\">the next piece of code</a> isn't compiled on Clang 4.0.1?</p>\n\n<p>I have the next error:</p>\n\n<blockquote>\n  <p>call to function 'operator&lt;&lt;' that is neither visible in the template\n  definition nor found by argument-dependent lookup</p>\n</blockquote>\n\n<p>There is some file <strong>test.cpp</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\n\nnamespace Wrapper\n{\n\ntemplate&lt;typename T&gt;\nstruct QuotedStringImpl\n{\n    T const&amp; Value;\n\n    explicit QuotedStringImpl(T const&amp; value) :\n        Value(value)\n    {\n    }\n};\n\ntemplate&lt;typename T&gt;\ninline std::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, QuotedStringImpl&lt;T&gt; const&amp; rhs)\n{\n    return stream &lt;&lt; rhs.Value;\n}\n\ntemplate&lt;&gt;\ninline std::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, QuotedStringImpl&lt;std::string&gt; const&amp; rhs)\n{\n    return stream &lt;&lt; '\"' &lt;&lt; rhs.Value &lt;&lt; '\"';\n}\n\ntemplate&lt;typename T&gt;\ninline QuotedStringImpl&lt;T&gt; QuotedString(T const&amp; value)\n{\n    return QuotedStringImpl&lt;T&gt;(value);\n}\n\ntemplate&lt;typename T&gt;\ninline std::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, std::vector&lt;T&gt; const&amp; value)\n{\n    stream &lt;&lt; \"[\";\n    std::copy(value.begin(), value.end(), std::ostream_iterator&lt;T&gt;(stream, \", \"));\n    stream &lt;&lt; \"]\";\n\n    return stream;\n}\n\n} // namespace Wrapper\n\n\nnamespace\n{\n\nstruct Struct\n{\n};\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; stream, Struct const&amp;)\n{\n    return stream &lt;&lt; \"(struct value)\";\n}\n\n} // namespace\n\nint main()\n{\n    std::vector&lt;Struct&gt; collection(2);\n    std::cout &lt;&lt; Wrapper::QuotedString(collection);\n}\n</code></pre>\n\n<p>This code is successfully compiled with msvc 15. But I have troubles with Clang 4.0.1. According with <a href=\"http://clang.llvm.org/compatibility.html#dep_lookup\" rel=\"nofollow noreferrer\">this</a> documentation ADL should be applied in place of instantiation. But it doesn't work for me. What is the reason of such behaviour?</p>\n"}, {"tags": ["c++", "arrays", "initialization", "new-operator"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 3, "creation_date": 1538577682, "post_id": 52629608, "comment_id": 92192622, "body": "How about <code>double p5[] = {0, 1, 2, 3, 4};</code>? <code>double* p5 = new double[5] {0, 1, 2, 3, 4};</code> seems to work. Probably a typo in the book."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1538577744, "post_id": 52629608, "comment_id": 92192666, "body": "<code>std::vector&lt;double&gt; p5 = {0, 1, 2, 3, 4};</code> is the C++ way to do this."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538578126, "post_id": 52629608, "comment_id": 92192930, "body": "Or <code>std::array&lt;double, 5&gt; p5 = {0, 1, 2, 3, 4};</code> if the array is of fixed size."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538579314, "post_id": 52629608, "comment_id": 92193798, "body": "@NathanOliver: a <code>std::vector</code> and a raw array are not the same thing at all. I agree that many users try to use raw arrays when they should use <code>std::vector</code> or <code>std::array</code>, but raw arrays do have legitimate use cases."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1538579419, "post_id": 52629608, "comment_id": 92193864, "body": "@SergeBallesta The OP isn&#39;t using a raw array.  They want to use <code>new[]</code>, which means they should use a vector, or some other RAII type to handle the subsequent <code>delete[]</code>.  I&#39;ve no problem with <code>double p5[] = {0, 1, 2, 3, 4};</code>.  Although I could be misinterpreting it as they start with a Java example where you have to use <code>new</code> instead of like what we can do in C++"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538579759, "post_id": 52629608, "comment_id": 92194108, "body": "@NathanOliver: I assume that OP wants a dynamically allocated array. I cannot really guess whether it is a an appropriate use case (AFAIK the only real world one is the explicit implementation of a container)."}, {"owner": {"reputation": 1, "user_id": 10451588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f088006dad8ba7f25bf750a192e50ee?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Kerman", "link": "https://stackoverflow.com/users/10451588/ben-kerman"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538586122, "post_id": 52629608, "comment_id": 92197630, "body": "@NathanOliver I know that you shouldn&#39;t normally use arrays directly. This particular chapter in the book discusses the implementation of containers (vectors in particular)."}], "answers": [{"comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1538579163, "post_id": 52629936, "comment_id": 92193683, "body": "An array is slightly more than a block of memory. It is an aggregate and the compiler knows the type of its elements and their number. What is true is that arrays are not first class objects in C++"}, {"owner": {"reputation": 928, "user_id": 767535, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5ba03c8b2a09ca766c725cfe79add043?s=128&d=identicon&r=PG", "display_name": "ammcom", "link": "https://stackoverflow.com/users/767535/ammcom"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1538579417, "post_id": 52629936, "comment_id": 92193860, "body": "The number of elements are stored in a slot before the array memory block, the operator <code>new</code> of arrays allocate memory and store the number of elements in this slot."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538579547, "post_id": 52629936, "comment_id": 92193952, "body": "This doesn&#39;t compile as <code>{1,2,3,4}</code> isn&#39;t an actual thing.  <a href=\"http://coliru.stacked-crooked.com/a/a1589d2ab5ecf666\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/a1589d2ab5ecf666</a>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1538579549, "post_id": 52629936, "comment_id": 92193954, "body": "@ammcom: what you describe is only an implementation detail. Not all implementations are required to do that."}], "tags": [], "owner": {"reputation": 928, "user_id": 767535, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5ba03c8b2a09ca766c725cfe79add043?s=128&d=identicon&r=PG", "display_name": "ammcom", "link": "https://stackoverflow.com/users/767535/ammcom"}, "is_accepted": false, "score": -1, "last_activity_date": 1538578581, "creation_date": 1538578581, "answer_id": 52629936, "question_id": 52629608, "link": "https://stackoverflow.com/questions/52629608/array-initiliazation-using-new-and-values-but-no-explicit-number-of-elements/52629936#52629936", "title": "Array initiliazation using new and values but no explicit number of elements", "body": "<p>It seems a mistake in the book.\nArrays in C++ are not objects like Java, it is a block in memory that has a pointer pointing at the first element, so the syntax <code>new double[] {}</code> is not reasonable.</p>\n\n<p>use:</p>\n\n<pre><code>double * d = {1,2,3,4};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": -1, "last_activity_date": 1538580879, "creation_date": 1538580879, "answer_id": 52630763, "question_id": 52629608, "link": "https://stackoverflow.com/questions/52629608/array-initiliazation-using-new-and-values-but-no-explicit-number-of-elements/52630763#52630763", "title": "Array initiliazation using new and values but no explicit number of elements", "body": "<p>C++ allows to omit the size of an array when <strong>in a array declaration</strong>, the size can be deduced from an initializer, for example in:</p>\n\n<pre><code>double d[] = { 0, 1, 2, 3, 4 };   // ok 5 elements\nchar std[] = \"foo\";               // ok 4 elements with the terminating null\n</code></pre>\n\n<p>But <code>double* p5 = new double[5];</code> is not a array declaration. It declares a raw pointer that is initialized to point to a dynamically allocated array.</p>\n\n<p>Both declarations do have very close semantics, because for example both allow for partial initialization (<code>double* p5 = new double[5]{0, 1, 2};</code>). But the syntax you propose is not defined in the standard and is not accepted by current versions of Clang or gcc.</p>\n\n<p>It would be easy to extend the language to accept it but IMHO it is unlikely to happen:</p>\n\n<ul>\n<li>arrays are not first class elements of the language, and programmers are advised to use containers instead</li>\n<li>raw pointers are no longer first class elements, and programmers are advised to use references or smart pointers instead</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10451588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f088006dad8ba7f25bf750a192e50ee?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Kerman", "link": "https://stackoverflow.com/users/10451588/ben-kerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538580879, "creation_date": 1538577599, "last_edit_date": 1538577728, "question_id": 52629608, "link": "https://stackoverflow.com/questions/52629608/array-initiliazation-using-new-and-values-but-no-explicit-number-of-elements", "title": "Array initiliazation using new and values but no explicit number of elements", "body": "<p>In many C-family languages it is possible to initialize an array with the number of elements implicit from the list of initial elements. E.g. in Java:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>int[] ints = new int[] {0, 1, 2, ...}\n</code></pre>\n\n<p>On page 597 of 'Programming: Principles and Practice using C++', Stroustrup writes that it is possible to use a similar syntax in C++:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>double* p5 = new double[] {0, 1, 2, 3, 4};\n</code></pre>\n\n<p>However, when trying to compile this using GCC or Clang, I get errors because an expression is expected in the brackets:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ g++ main.cpp\nmain.cpp: In function 'int main()':\nmain.cpp:17:26: error: expected primary-expression before ']' token\n  double* p5 = new double[]{0, 1, 2, 3, 4};\n                          ^\nmain.cpp:17:41: error: too many initializers for 'double [1]'\n  double* p5 = new double[]{0, 1, 2, 3, 4};\n                                         ^\n</code></pre>\n\n<p>And with Clang:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> $ clang++ main.cpp\n main.cpp:17:26: error: expected expression\n         double* p5 = new double[]{0, 1, 2, 3, 4};\n                                 ^\n main.cpp:17:19: error: excess elements in scalar initializer\n         double* p5 = new double[]{0, 1, 2, 3, 4};\n                          ^         ~~~~~~~~~~~~~\n 2 errors generated.\n</code></pre>\n\n<p>Is the book wrong on this? I've seen at least one SO user recommending this to someone with an unrelated problem (that code didn't compile for me either).</p>\n"}, {"tags": ["c++", "arrays", "vector", "type-conversion"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 4, "creation_date": 1538577521, "post_id": 52629526, "comment_id": 92192502, "body": "Just literally replace <code>char myCharArray[]</code> with <code>std::vector&lt;byte&gt; myCharArray</code> (or whatever name). Problem solved - if by &quot;convert&quot; you mean change type of your variable."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 5, "creation_date": 1538577613, "post_id": 52629526, "comment_id": 92192568, "body": "Or write <code>std::vector&lt;char&gt; v(std::begin(myCharArray), std::end(myCharArray));</code> and it&#39;ll copy the contents itself."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 0, "last_activity_date": 1538634958, "last_edit_date": 1538634958, "creation_date": 1538578429, "answer_id": 52629891, "question_id": 52629526, "link": "https://stackoverflow.com/questions/52629526/c-how-to-convert-char-array-to-vector-of-bytes-vectorbyte/52629891#52629891", "title": "C++ how to convert char array to vector of bytes (vector&lt;byte&gt;)", "body": "<pre><code>std::vector&lt;std::byte&gt; bytes;\nfor (char &amp;c : myCharArray) {\n    bytes.push_back(static_cast&lt;std::byte&gt;(c));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "is_accepted": false, "score": 1, "last_activity_date": 1597221967, "creation_date": 1597221967, "answer_id": 63372992, "question_id": 52629526, "link": "https://stackoverflow.com/questions/52629526/c-how-to-convert-char-array-to-vector-of-bytes-vectorbyte/63372992#63372992", "title": "C++ how to convert char array to vector of bytes (vector&lt;byte&gt;)", "body": "<p>You are allowed to inspect an array of <code>char</code> as an array of <code>std::byte</code>. So the most efficient solution would be:</p>\n<pre><code>#include &lt;iterator&gt; // for std::begin / end\n\nstd::vector&lt;std::byte&gt; v(\n    reinterpret_cast&lt;std::byte*&gt;(std::begin(myCharArray)), \n    reinterpret_cast&lt;std::byte*&gt;(std::end(myCharArray))\n);\n</code></pre>\n<p>This way, the vector knows up front how much memory to allocate and it can perform the copy via memcpy or a similar efficient routine instead of copying one byte after the other and having to reallocate multiple times in between.</p>\n"}], "owner": {"reputation": 555, "user_id": 8579824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bd34eb3f79db484b3af2a0f2853085?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Yordanyan", "link": "https://stackoverflow.com/users/8579824/aaron-yordanyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2422, "favorite_count": 0, "accepted_answer_id": 52629891, "answer_count": 2, "score": 2, "last_activity_date": 1597221967, "creation_date": 1538577400, "last_edit_date": 1568973366, "question_id": 52629526, "link": "https://stackoverflow.com/questions/52629526/c-how-to-convert-char-array-to-vector-of-bytes-vectorbyte", "title": "C++ how to convert char array to vector of bytes (vector&lt;byte&gt;)", "body": "<p>I have large array of char</p>\n\n<pre><code>char myCharArray[] = {\n  0x9B,0x3E,0x34,0x87,0xFD,0x24,0xB4,0x64,0xBA,0x80,0x04,0xFD,\n  0xDF,0x23,0x41,0xEE,0x00,0x00,0x00,0x00,0xAC,0xF9,0x8F,0x00,\n  ...\n}\n</code></pre>\n\n<p>How to convert <strong>myCharArray</strong> to <code>vector&lt;byte&gt;</code></p>\n"}, {"tags": ["c++", "templates", "language-lawyer"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1538577603, "post_id": 52629501, "comment_id": 92192560, "body": "You have two different instantiations of the template, one in each <a href=\"https://en.wikipedia.org/wiki/Translation_unit_(programming)\" rel=\"nofollow noreferrer\"><i>translation unit</i></a>. Each instance of the function will have its own static local variable. This is fine and expected."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1538578254, "post_id": 52629501, "comment_id": 92193030, "body": "@Someprogrammerdude: I would say ODR violation, so no valid expectation."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1538578543, "post_id": 52629501, "comment_id": 92193250, "body": "I&#39;m not sure what you&#39;re setting out to prove here but I can&#39;t say I like this code."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1538578823, "post_id": 52629501, "comment_id": 92193440, "body": "@Someprogrammerdude aren&#39;t variable templates instantiations implicitly inline?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1538579393, "post_id": 52629501, "comment_id": 92193847, "body": "@Quentin Doesn&#39;t say <a href=\"https://en.cppreference.com/w/cpp/language/variable_template\" rel=\"nofollow noreferrer\">on cppreference.com</a>, but it might be in the specification."}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 1554370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df7c8e8dd040b0e89c1d97a7464c77e6?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1554370/igor"}, "edited": false, "score": 0, "creation_date": 1538636949, "post_id": 52630769, "comment_id": 92214251, "body": "It looks like a truth. I don&#39;t see any other explanation. (But if I declare any other type for example &quot;int&quot; it works as I expect. Note: in the last Vandevoorde&#39;s book &quot;C++ Templates: The Complete Guide&quot; he says that each instance of &quot;Template variable&quot; in the different translation unit has inline behaviour and value is shared). It seems that such behaviour only related to lambdas. Tnx"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1538580896, "creation_date": 1538580896, "answer_id": 52630769, "question_id": 52629501, "link": "https://stackoverflow.com/questions/52629501/lambda-as-a-template-variable/52630769#52630769", "title": "Lambda as a template variable", "body": "<p>Currently, you have ODR violation:</p>\n\n<p>In both translation units, you have (after substitution)</p>\n\n<pre><code>auto myvar&lt;int&gt; = []() -&gt; int&amp;{\n    static int v;\n    return v;\n};\n</code></pre>\n\n<p>but lambda declares a different type for each TU,\nso you have <code>lambda1</code> and <code>lambda2</code> for <code>myvar&lt;int&gt;</code>.</p>\n\n<p>Each lambda has its own <code>static</code>, that is why you see that result in practice (but program is ill-formed anyway, NDR).</p>\n"}], "owner": {"reputation": 915, "user_id": 1554370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df7c8e8dd040b0e89c1d97a7464c77e6?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1554370/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 2, "answer_count": 1, "score": 8, "last_activity_date": 1538580896, "creation_date": 1538577317, "last_edit_date": 1538577587, "question_id": 52629501, "link": "https://stackoverflow.com/questions/52629501/lambda-as-a-template-variable", "title": "Lambda as a template variable", "body": "<p>During some investigation related to \"Variable template\" I found out some strange code behaviour for me. Does standard say anything about this behaviour?</p>\n\n<pre><code>//Header.h\n#pragma once\n\ntemplate&lt;typename T&gt;\nauto myvar = []() -&gt; T&amp;{\n    static T v;\n    return v;\n};\n\n//Source.cpp\n#include &lt;iostream&gt;\n#include \"Header.h\"\n\nvoid testFunction()\n{\n    std::cout &lt;&lt; myvar&lt;int&gt;() &lt;&lt; '\\n';\n}\n\n//main.cpp\n#include &lt;iostream&gt;\n#include \"Header.h\"\n\nvoid testFunction();\n\nint main(int argc, char **argv) \n{\n    myvar&lt;int&gt;() = 10;\n\n    testFunction();\n\n    std::cout &lt;&lt; myvar&lt;int&gt;() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0\n10\n</code></pre>\n\n<p>I expect:</p>\n\n<pre><code>10\n10\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "boost", "shared-memory", "interprocess"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5511913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e63dd8c9f87422d895a69ee5a7c91c0?s=128&d=identicon&r=PG&f=1", "display_name": "p.k", "link": "https://stackoverflow.com/users/5511913/p-k"}, "edited": false, "score": 0, "creation_date": 1538580708, "post_id": 52629948, "comment_id": 92194722, "body": "thank you for answering my query. I would specifically like to know about managed heap memory and managed shared memory. From what I have noted in boost interprocess managed shared memory can be shared between processes that has kernel level persistence.whereas managed heap memory I am confused whether that can be shared between processes or it just exists for a particular process? Basically I would like to know the difference between 4 managed segments mentioned in the boost. Interprocess documentation.And  use cases where they can be applied?"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1538578603, "creation_date": 1538578603, "answer_id": 52629948, "question_id": 52629459, "link": "https://stackoverflow.com/questions/52629459/boost-c-interprocess/52629948#52629948", "title": "Boost c++ Interprocess", "body": "<p>Your question is a bit broad and comes down to \"I'm afraid to do it wrong\". So allow me to address the concerns briefly.</p>\n\n<blockquote>\n  <p>Does heap memory allow to increase the size of memory segment online(when processes are accessing it)?</p>\n</blockquote>\n\n<p>If you mean regular process heap (as facilitated by the (C) standard libraries), then, yes. I don't think you've ever needed to explicitly state the size of the heap (let alone grow it) in the last 20-30 years.</p>\n\n<p>Yes, process heaps are grown transparently by the OS\u00b9.</p>\n\n<blockquote>\n  <p>What is the difference between managed shared memory and managed heap memory?</p>\n</blockquote>\n\n<p>Again, if by \"managed heap\" you mean regular [standard library] process heap, the differences are significant.</p>\n\n<p>Anything that's shared across processes must be clear of absolute memory references, because the mapping <strike>might</strike> will be at a different base-address in the other processes. This means that only strictly <a href=\"https://stackoverflow.com/questions/146452/what-are-pod-types-in-c\">POD data types</a> are automatically supported. All the rest, like containers, only if using a special-purpose allocator that avoids absolute pointers.</p>\n\n<p>Sidenote: if you were thinking of \"managed heaps\" like the JVM or CLR concepts, that's a different story. Reference types in those VMs can usually be <em>transparently</em> moved, but the mechanics thereof are significantly different (as they serve different goals: avoiding fragmentation and parititioning in <a href=\"http://wiki.c2.com/?GenerationalGarbageCollection\" rel=\"nofollow noreferrer\">generational garbage collectors</a>).</p>\n\n<blockquote>\n  <p>Does heap memory allow to increase the size of memory segment online(when processes are accessing it)?</p>\n</blockquote>\n\n<p>That kind of heap cannot be accessed from more than one process, at all.</p>\n\n<blockquote>\n  <p>I would like to know if the map object existing in a process accessed by different threads can be shared to other process executing different threads?</p>\n</blockquote>\n\n<p>For the purpose of thread-safety, you can consider processes equivalent to threads. The same goes for threads from other processes. You have to synchronize access to the shared data - whether it's from a thread within the same process, or one outside it.</p>\n\n<p>This can be achieved with atomic data types (<a href=\"https://www.boost.org/doc/libs/1_66_0/doc/html/atomic.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_66_0/doc/html/atomic.html</a> or <a href=\"https://en.cppreference.com/w/cpp/atomic\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/atomic</a>) as well as with the classical synchronization primitives.</p>\n\n<p>Sharing these primitives across processes can often be done in two ways:</p>\n\n<ul>\n<li>using Boost's inteprocess primitives inside the shared memory</li>\n<li>using help from the OS, in the form of named interprocess synchronization primitives</li>\n</ul>\n\n<p>See <a href=\"https://www.boost.org/doc/libs/1_68_0/doc/html/interprocess/synchronization_mechanisms.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_68_0/doc/html/interprocess/synchronization_mechanisms.html</a> for details.</p>\n\n<h2>Summarizing</h2>\n\n<p>The question you did NOT ask but that might be behind your thinking, is \"What does a Boost Interprocess segment manager manage\"?</p>\n\n<p>In practice it does afford heap-like management of shared memory (with one of the limitations: not being able to grow online). This is then used to facilitate the Boost Interprocess <code>allocator</code> that you can use to store non-POD data types (like strings or other containers) inside your shared memory segment.</p>\n\n<p>If you look at my answers, you'll find many many examples of how to do that:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/search?tab=votes&amp;q=user%3a85371%20boost%20interprocess%20allocator\">https://stackoverflow.com/search?tab=votes&amp;q=user%3a85371%20boost%20interprocess%20allocator</a></li>\n<li>also look at scoped allocator adaptors <a href=\"https://stackoverflow.com/search?q=user%3A85371+scoped_allocator_adaptor\">https://stackoverflow.com/search?q=user%3A85371+scoped_allocator_adaptor</a></li>\n</ul>\n\n<hr>\n\n<p>\u00b9 on mainstream operating systems of the last decades</p>\n"}], "owner": {"reputation": 37, "user_id": 5511913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e63dd8c9f87422d895a69ee5a7c91c0?s=128&d=identicon&r=PG&f=1", "display_name": "p.k", "link": "https://stackoverflow.com/users/5511913/p-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 646, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538578603, "creation_date": 1538577209, "last_edit_date": 1538577524, "question_id": 52629459, "link": "https://stackoverflow.com/questions/52629459/boost-c-interprocess", "title": "Boost c++ Interprocess", "body": "<p>I am a beginner starting with boost c++ interprocess  library and ipc mechanism. What is the difference between managed shared memory and managed heap memory? </p>\n\n<p>In managed shared memory to increase the size of segment we need to grow it offline using segment::grow() method. </p>\n\n<p>Does heap memory allow to increase the size of memory segment online(when processes are accessing it)?</p>\n\n<p>I would like to know if the map object existing in a process accessed by different threads can be shared to other process executing different threads? </p>\n\n<p>What is the best technique to implement this? I wasn't able to get this from boost interprocess documentation.</p>\n"}, {"tags": ["c++", "macos", "llvm", "homebrew", "clang++"], "comments": [{"owner": {"reputation": 16607, "user_id": 267482, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fd69625825bed998b63fef68a23592aa?s=128&d=identicon&r=PG", "display_name": "bobah", "link": "https://stackoverflow.com/users/267482/bobah"}, "edited": false, "score": 0, "creation_date": 1538576639, "post_id": 52629110, "comment_id": 92191904, "body": "On a Mac OS X you would normally get <code>clang</code> as a part of <code>XCode</code>. Any specific reason you are trying it from homebrew?"}, {"owner": {"reputation": 195, "user_id": 2602716, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/B8KXt.png?s=128&g=1", "display_name": "Nick Kanellopoulos", "link": "https://stackoverflow.com/users/2602716/nick-kanellopoulos"}, "reply_to_user": {"reputation": 16607, "user_id": 267482, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fd69625825bed998b63fef68a23592aa?s=128&d=identicon&r=PG", "display_name": "bobah", "link": "https://stackoverflow.com/users/267482/bobah"}, "edited": false, "score": 0, "creation_date": 1538577848, "post_id": 52629110, "comment_id": 92192746, "body": "@bobah Which clang version is shipped with Xcode? <code>Apple LLVM version 10.0.0 (clang-1000.11.45.2)</code> does not mean a lot to us, does it? I want to try certain C++17 or C++2a features, and I would like to know the exact clang version I am using."}, {"owner": {"reputation": 16607, "user_id": 267482, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fd69625825bed998b63fef68a23592aa?s=128&d=identicon&r=PG", "display_name": "bobah", "link": "https://stackoverflow.com/users/267482/bobah"}, "edited": false, "score": 0, "creation_date": 1538578611, "post_id": 52629110, "comment_id": 92193301, "body": "lmgfy - <a href=\"https://stackoverflow.com/questions/33603027/get-apple-clang-version-and-corresponding-upstream-llvm-version\" title=\"get apple clang version and corresponding upstream llvm version\">stackoverflow.com/questions/33603027/&hellip;</a> :-)"}, {"owner": {"reputation": 195, "user_id": 2602716, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/B8KXt.png?s=128&g=1", "display_name": "Nick Kanellopoulos", "link": "https://stackoverflow.com/users/2602716/nick-kanellopoulos"}, "reply_to_user": {"reputation": 16607, "user_id": 267482, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fd69625825bed998b63fef68a23592aa?s=128&d=identicon&r=PG", "display_name": "bobah", "link": "https://stackoverflow.com/users/267482/bobah"}, "edited": false, "score": 0, "creation_date": 1538579229, "post_id": 52629110, "comment_id": 92193725, "body": "@boobah Scroll down. The solution in this post does not work any more ;)"}, {"owner": {"reputation": 16607, "user_id": 267482, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fd69625825bed998b63fef68a23592aa?s=128&d=identicon&r=PG", "display_name": "bobah", "link": "https://stackoverflow.com/users/267482/bobah"}, "edited": false, "score": 0, "creation_date": 1538579416, "post_id": 52629110, "comment_id": 92193859, "body": "damn! but I&#39;d still try the <code>__cplusplus</code> and per-feature macros based testing in-code approach if just experimenting opposed to infecting the Mac with &quot;alien&quot; build of the &quot;native&quot; compiler (I use brew for everything apart from clang itself)."}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 2923378, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/16788679cd22857831fb23c8ae030209?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin S", "link": "https://stackoverflow.com/users/2923378/kevin-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1544755635, "creation_date": 1544755635, "answer_id": 53772855, "question_id": 52629110, "link": "https://stackoverflow.com/questions/52629110/clang-installed-via-homebrew-macos-compilation-errors/53772855#53772855", "title": "clang++ installed via homebrew (macOS): compilation errors", "body": "<p>It works for me to add a -I (minus eye) option to the clang++ command line, pointing to /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include </p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 1797412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fbc04d2c1dc03acd5c849b6d26d660b2?s=128&d=identicon&r=PG", "display_name": "shockwave", "link": "https://stackoverflow.com/users/1797412/shockwave"}, "edited": false, "score": 1, "creation_date": 1574463401, "post_id": 54892026, "comment_id": 104255885, "body": "One of the most important parts in this answer is that you need to use <code>-isysroot</code> instead of <code>-I</code>"}], "tags": [], "owner": {"reputation": 5696, "user_id": 4618482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4812a270499aa3e682f6dbe84b5243a3?s=128&d=identicon&r=PG", "display_name": "joki", "link": "https://stackoverflow.com/users/4618482/joki"}, "is_accepted": false, "score": 3, "last_activity_date": 1551208115, "last_edit_date": 1551208115, "creation_date": 1551206208, "answer_id": 54892026, "question_id": 52629110, "link": "https://stackoverflow.com/questions/52629110/clang-installed-via-homebrew-macos-compilation-errors/54892026#54892026", "title": "clang++ installed via homebrew (macOS): compilation errors", "body": "<p>It appears that as of Mojave (10.14), Xcode doesn't install system headers in <code>/usr/include</code> anymore. There is a compatibility package that does, but it's not recommended.</p>\n\n<p>Instead, the official solution is for tools to search for headers in <code>/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk</code>. That path can be obtained from</p>\n\n<pre><code>xcrun --show-sdk-path\n</code></pre>\n\n<p>The <a href=\"https://developer.apple.com/documentation/xcode_release_notes/xcode_10_release_notes#3035623\" rel=\"nofollow noreferrer\">release notes</a> say</p>\n\n<blockquote>\n  <p>The Command Line Tools package installs the macOS system headers inside the macOS SDK. Software that compiles with the installed tools will search for headers within the macOS SDK provided by either Xcode at:</p>\n  \n  <p>/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk</p>\n  \n  <p>or the Command Line Tools at:</p>\n  \n  <p>/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk</p>\n  \n  <p>depending on which is selected using xcode-select.</p>\n</blockquote>\n\n<p>If you built <code>clang</code> yourself, this can be achieved by passing the <code>-isysroot</code> option to clang:</p>\n\n<pre><code>clang++ -isysroot \"$(xcrun --show-sdk-path)\" \u2026\n</code></pre>\n\n<p>See also: <a href=\"https://github.com/Homebrew/homebrew-core/issues/32765\" rel=\"nofollow noreferrer\">https://github.com/Homebrew/homebrew-core/issues/32765</a></p>\n"}], "owner": {"reputation": 195, "user_id": 2602716, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/B8KXt.png?s=128&g=1", "display_name": "Nick Kanellopoulos", "link": "https://stackoverflow.com/users/2602716/nick-kanellopoulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1551208115, "creation_date": 1538576218, "question_id": 52629110, "link": "https://stackoverflow.com/questions/52629110/clang-installed-via-homebrew-macos-compilation-errors", "title": "clang++ installed via homebrew (macOS): compilation errors", "body": "<p>After installing clang++ (tried v. 6.0.1 and 7.0) with:<br>\n<code>brew install --with-toolchain llvm</code></p>\n\n<p>very trivial programs result to the following error:</p>\n\n<pre><code> In file included from test.cpp:1:\n In file included from /usr/local/Cellar/llvm/7.0.0/include/c++/v1/iostream:38:\n In file included from /usr/local/Cellar/llvm/7.0.0/include/c++/v1/ios:215:\n In file included from /usr/local/Cellar/llvm/7.0.0/include/c++/v1/iosfwd:90:\n /usr/local/Cellar/llvm/7.0.0/include/c++/v1/wchar.h:119:15: fatal error: 'wchar.h' file not found\n #include_next &lt;wchar.h&gt;\n</code></pre>\n\n<p>Command used to compile:</p>\n\n<pre><code> clang++7() {\n    LDFLAGS=\"-L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib\"\n    CPPFLAGS=\"-I/usr/local/opt/llvm/include\"\n    /usr/local/opt/llvm/bin/clang++ -std=c++11 $CPPFLAGS $LDFLAGS $1\n }\n</code></pre>\n\n<p>Is it possible to use the official clang instead of Apple's version?<br>\nWith Apple's version, we do not even know which version of LLVM it really is...</p>\n"}, {"tags": ["c++", "3d", "geometry", "mesh", "triangulation"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538577109, "post_id": 52629019, "comment_id": 92192216, "body": "As polygons are planar you can transfer your coordinates to 2D before calculation use &quot;2D Triangulation by John Ratcliff&quot; as it is and then transfer them back. So you do not even need to modify that code, just add pre and post processing."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1538577638, "post_id": 52629019, "comment_id": 92192586, "body": "I think 12 parameters for a function is a little bit too much. Why don&#39;t you use 4 <code>std::array&lt;double, 3&gt;</code> instead?"}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538578161, "post_id": 52629019, "comment_id": 92192960, "body": "@Slava, pre-projection comes with an additional computational cost, I cannot afford, as this piece is designed to process hundreds of thousands of polygons."}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1538578212, "post_id": 52629019, "comment_id": 92193007, "body": "@mch, the code above is for testing. I intend to beautify it once it is ready and working."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538580142, "post_id": 52629019, "comment_id": 92194366, "body": "If you do want to use algo from John Ratcliff I would recommend to rewrite it more generic way - do not pass coordinates as separate variables etc but only using Vector2D and operations on them. Then test it. After you make it work correct make that code templated or just replace <code>Vector2D</code> to <code>Vector3D</code>. Unfortunately code shown is not written in generic way."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538580288, "post_id": 52629019, "comment_id": 92194452, "body": "For example you should not have parameters <code>double Ax</code> <code>double Ay</code> and <code>double Az</code> but <code>Vector2D A</code> and then replaced with <code>Vector3D A</code>. And you should not access separate coordinates of <code>A</code> you should use methods that work with 2 or 3 points."}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1538582455, "post_id": 52629019, "comment_id": 92195724, "body": "@Slava, that&#39;s somehow, what I tried to do, especially identifying which vector function in 2D was used. For example, Ratcliff, doesn&#39;t explicitly use the cross product in finding areas. I had to google it out."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538583202, "post_id": 52629019, "comment_id": 92196169, "body": "&quot;<i>comes with an additional computational cost, I cannot afford</i>&quot; \u2013 the cost of performing a simple projection 2D is likely to be significantly, if not <i>much</i>, lower than that of the triangulation algorithm itself, the former being only two or three vector operations per vertex."}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538655405, "post_id": 52629019, "comment_id": 92224856, "body": "@meowgoesthedog, how do you find the plane of projection, for every polygon in a very complex mesh? How do you make sure the projection section (2D triangle area) is significant enough for the triangulation?"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538655787, "post_id": 52629019, "comment_id": 92225117, "body": "If your polygon is approximately planar then a good choice of normal would simply be the mean normal over all polygons, or even a small random sample of polygons. Again, this is also only a few vector operations per polygon."}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538656045, "post_id": 52629019, "comment_id": 92225281, "body": "@meowgoesthedog, your proposition only works when the mesh is convex, right? Otherwise, I&#39;ll have to take as projection plane, the polygon plane for each face of the mesh."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 1, "creation_date": 1538656128, "post_id": 52629019, "comment_id": 92225339, "body": "Wasn&#39;t the very <b>premise</b> of your question that the polygons are planar?"}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "edited": false, "score": 0, "creation_date": 1538656248, "post_id": 52629019, "comment_id": 92225419, "body": "Nope, I didn&#39;t say so. I said that each polygon seats on its own plane."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538656442, "post_id": 52629019, "comment_id": 92225541, "body": "&quot;<i>How can I modify this code to make it use 3D planar polygons?</i>&quot; Also, if each polygon seats on its own plane, why would it be difficult to obtain said plane?"}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538657160, "post_id": 52629019, "comment_id": 92225995, "body": "@meowgoesthedog, sorry for the misunderstanding in my post. But some bad 3D meshes do have non-planar polygons. Why does it matter? Ok, for each polygon, I have to build the projection matrix (5 to six vector operations, including square roots and inverse matrix calculations). This looks to me like a lot of overhead, doesn&#39;t it?"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538657762, "post_id": 52629019, "comment_id": 92226360, "body": "@N.Wells 1) the polygons don&#39;t necessarily have to be <i>exactly</i> planar, as long as they don&#39;t &quot;fold back&quot;. 2) Still significantly cheaper than the triangulation routine, not to mention that you only need to normalise the normal once at the end (i.e. area-weighted mean). 3) You don&#39;t need to do any explicit matrix inversions; just note that the inverse of a rotation matrix is equal to its transpose (orthogonal)."}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538658106, "post_id": 52629019, "comment_id": 92226563, "body": "@meowgoesthedog, &quot;the normal at end&quot;? Any sample code? Mine is similar to this post: <a href=\"https://stackoverflow.com/questions/38588842/coordinate-system-transformation-3d-projection-to-2d-plane\" title=\"coordinate system transformation 3d projection to 2d plane\">stackoverflow.com/questions/38588842/&hellip;</a>"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1538658294, "post_id": 52629019, "comment_id": 92226693, "body": "Oops ignore that bit; but a few square roots for a matrix, which you only need to compute once per polygon, are still much cheaper than the work needed to triangulate it. The inverse in that post is a generalisation; for your case the matrix <code>M</code> is just a pure rotation matrix. Moral of the story: don&#39;t prematurely optimise \u2013 benchmark instead."}, {"owner": {"reputation": 903, "user_id": 8634018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fipAH.jpg?s=128&g=1", "display_name": "Dominik Mokri\u0161", "link": "https://stackoverflow.com/users/8634018/dominik-mokri%c5%a1"}, "edited": false, "score": 0, "creation_date": 1539370644, "post_id": 52629019, "comment_id": 92492513, "body": "@N. Wells, I am sorry but I still don&#39;t understand what your input is. From your question it seems that the input is a set of polygons and each of them is planar (although the plane might be different for each of those). Then, in a comment you state that &quot;some bad 3D meshes do have non-planar polygons&quot;. Would you mind clarifying this, please?"}, {"owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "reply_to_user": {"reputation": 903, "user_id": 8634018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fipAH.jpg?s=128&g=1", "display_name": "Dominik Mokri\u0161", "link": "https://stackoverflow.com/users/8634018/dominik-mokri%c5%a1"}, "edited": false, "score": 0, "creation_date": 1539583765, "post_id": 52629019, "comment_id": 92539123, "body": "Sorry, @DominikMokri\u0161, I meant to say that my input meshes are &quot;Good&quot; well-formed meshes. Meshes with non-planar polygons are usually from a bad modeling. But you&#39;re right, a good triangulation program must take those &quot;extreme&quot; cases into account."}], "owner": {"reputation": 123, "user_id": 8447746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48a265c0411158be78fb80c035f45d1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Wells", "link": "https://stackoverflow.com/users/8447746/n-wells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 361, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538576529, "creation_date": 1538575971, "last_edit_date": 1538576529, "question_id": 52629019, "link": "https://stackoverflow.com/questions/52629019/how-to-port-a-2d-polygon-triangulation-algorithm-to-3d", "title": "How to port a 2D Polygon Triangulation Algorithm to 3D?", "body": "<p>I came over the code in this link:\n<a href=\"http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\" rel=\"nofollow noreferrer\">2D Triangulation by John Ratcliff</a>.\nThe code presents a triangulation algorithm in C++ for 2D polygons.\nI've tried to port it to 3D polygons but unsuccessfully.\nHow can I modify this code to make it use 3D planar polygons?\nI know I can use a projection, but is there a way to make a 3D version of the code linked above?\nThanks. \nNB: Below is my porting attempt.</p>\n\n<pre><code>double Triangulate::Area(const std::vector&lt;int&gt; &amp;poly)\n{\n\n  int n = poly.size();\n\n  if (n &lt; 3) // not a plane - no area\n        return 0;\n\n  std::vector&lt;double&gt; total = {0, 0, 0};\n  int vi1, vi2;\n  std::vector&lt;double&gt; prod;\n  std::vector&lt;double&gt; v1, v2, v3;\n  double* point = NULL;\n  for(int i = 0; i &lt; n; i++){\n        v1.clear();\n        v2.clear();\n        vi1 = poly[i];\n        if (i == n-1)\n            vi2 = poly[0];\n        else\n            vi2 = poly[i+1];\n        point = input.GetPoint(vi1);\n        v1.insert(v1.begin(), point, point+3);\n\n        point = input.GetPoint(vi2);\n        v2.insert(v2.begin(), point, point+3);\n\n        prod = Cross(v1, v2);\n        total[0] += prod[0];\n        total[1] += prod[1];\n        total[2] += prod[2];\n    }\n    v1.clear();\n    v2.clear();\n    v3.clear();\n    point = input.GetPoint(poly[0]);\n    v1.insert(v1.begin(), point, point+3);\n\n    point = input.GetPoint(poly[1]);\n    v2.insert(v2.begin(), point, point+3);\n\n    point = input.GetPoint(poly[2]);\n    v3.insert(v3.begin(), point, point+3);\n\n    double result = Dot(total, UnitNormal(v1, v2, v3));\n    return result/2;\n}\n\nbool Triangulate::SameSide(double P1x,  double P1y, double P1z, \n                    double P2x,  double P2y, double P2z,\n                    double Ax,  double Ay, double Az,\n                    double Bx,  double By, double Bz){\n    double ABx, ABy, ABz, AP1x, AP1y, AP1z,\n        AP2x, AP2y, AP2z;\n\n    double cp1x, cp1y, cp1z, cp2x, cp2y, cp2z;\n\n    double dot;\n    std::vector&lt;double&gt; AB = {Bx - Ax, By - Ay, Bz - Az};\n\n    std::vector&lt;double&gt; AP1 = {P1x - Ax,P1y - Ay,  P1z - Az};\n\n    std::vector&lt;double&gt; AP2 = {P2x - Ax, P2y - Ay, P2z - Az};\n\n    std::vector&lt;double&gt; cp1 = Cross(AB, AP1);\n    std::vector&lt;double&gt; cp2 = Cross(AB, AP2);\n\n    dot = Dot(cp1, cp2);\n\n   return (dot &gt;= 0);\n}\n\n   /*\n     InsideTriangle decides if a point P is Inside of the triangle\n     defined by A, B, C.\n   */\nbool Triangulate::InsideTriangle(double Ax, double Ay, double Az,\n                      double Bx, double By, double Bz,\n                      double Cx, double Cy, double Cz,\n                      double Px, double Py, double Pz)\n\n{\n    return SameSide(Px, Py, Pz, Ax, Ay, Az, Bx, By, Bz, Cx, Cy, Cz) \n      || SameSide(Px, Py, Pz, Bx, By, Bz, Ax, Ay, Az, Cx, Cy, Cz) \n      || SameSide(Px, Py, Pz, Cx, Cy, Cz, Ax, Ay, Az, Bx, By, Bz) ;\n}\n\nbool Triangulate::Snip(const std::vector&lt;int&gt; &amp;contour,\n   int u,int v,int w,int n,int *V)\n{\n  int p;\n  double Ax, Ay,Az, Bx, By,Bz, Cx, Cy, Cz, Px, Py, Pz;\n  double BAx, BAy, BAz, CAx, CAy, CAz;\n\n  Ax = input.GetPoint(V[u])[X];\n  Ay = input.GetPoint(V[u])[Y];\n  Az = input.GetPoint(V[u])[Z];\n\n  Bx = input.GetPoint(V[v])[X];\n  By = input.GetPoint(V[v])[Y];\n  Bz = input.GetPoint(V[v])[Z];\n\n  Cx = input.GetPoint(V[w])[X];\n  Cy = input.GetPoint(V[w])[Y];\n  Cz = input.GetPoint(V[w])[Z];\n\n  BAx = Bx-Ax;\n  BAy = By - Ay;\n  BAz = Bz - Az;\n\n  CAx = Cx-Ax;\n  CAy = Cy - Ay;\n  CAz = Cz - Az;\n\n  if ( EPSILON &gt; ( (BAy*CAz-BAz*CAy)*(BAy*CAz-BAz*CAy)+ \n   (BAx*CAz-BAz*CAx)*(BAx*CAz-BAz*CAx) +\n   (BAx*CAy-BAy*CAx)*(BAx*CAy-BAy*CAx))  ) return false;\n\n  for (p=0;p&lt;n;p++)\n  {\n    if( (p == u) || (p == v) || (p == w) ) continue;\n    Px = input.GetPoint(V[p])[X];\n    Py = input.GetPoint(V[p])[Y];\n    Pz = input.GetPoint(V[p])[Z];\n\n    if (InsideTriangle(Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Px,Py,Pz)) return false;\n  }\n\n  return true;\n}\n\nint Triangulate::Process(const std::vector&lt;int&gt; &amp;contour,\nstd::vector&lt;std::vector&lt;int&gt;&gt; &amp;result)\n{\n  /* allocate and initialize list of Vertices in polygon */\n\n  int n = contour.size();\n  if ( n &lt; 3 ) {\n    LOG_VAL(\"Cannot happen: contour is a line\", \"\")\n   return 0;\n  }\n\n  int *V = new int[n];\n\n  /* we want a counter-clockwise polygon in V */\n\n  if ( 0.0f &lt; Area(contour) )\n    for (int v=0; v&lt;n; v++) V[v] = v;\n  else\n    for(int v=0; v&lt;n; v++) V[v] = (n-1)-v;\n\n  int nv = n;\n\n  /*  remove nv-2 Vertices, creating 1 triangle every time */\n  int count = 2*nv;   /* error detection */\n  std::vector&lt;int&gt; tri;\n  int trinum = 0;\n\n  for(int m=0, v=nv-1; nv&gt;2; )\n  {\n    /* if we loop, it is probably a non-simple polygon */\n    if (0 &gt;= (count--))\n    {\n      //** Triangulate: ERROR - probable bad polygon!\n      LOG_VAL(\"Bad polygon:\", trinum)\n      return trinum;\n    }\n\n    /* three consecutive vertices in current polygon, &lt;u,v,w&gt; */\n    int u = v  ; if (nv &lt;= u) u = 0;     /* previous */\n    v = u+1; if (nv &lt;= v) v = 0;     /* new v    */\n    int w = v+1; if (nv &lt;= w) w = 0;     /* next     */\n\n    if ( Snip(contour,u,v,w,nv,V) )\n    {\n      int a,b,c,s,t;\n\n      /* true names of the vertices */\n      a = V[u]; b = V[v]; c = V[w];\n\n      /* output Triangle */\n      tri.clear();\n      tri.push_back( contour[a] );\n      tri.push_back( contour[b] );\n      tri.push_back( contour[c] );\n      result.push_back(tri);\n      trinum++;\n\n      m++;\n\n      /* remove v from remaining polygon */\n      for(s=v,t=v+1;t&lt;nv;s++,t++) V[s] = V[t]; nv--;\n\n      /* resest error detection counter */\n      count = 2*nv;\n    }\n  }\n\n\n\n  delete V;\n\n  if(result.size() &lt; 1){\n      LOG_VAL(\"Result Is Empty:\", \"\")\n      exit(1);\n  }\n\n  return trinum;\n}\n</code></pre>\n"}, {"tags": ["java", "c++", "visual-c++", "java-native-interface", "swig"], "answers": [{"tags": [], "owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "is_accepted": true, "score": 0, "last_activity_date": 1538662351, "creation_date": 1538662351, "answer_id": 52648913, "question_id": 52628961, "link": "https://stackoverflow.com/questions/52628961/java-swig-wrapper-vs-direct-function-calling/52648913#52648913", "title": "Java SWIG wrapper vs direct function calling", "body": "<p>Turned out that it is essential to use the same compiler flags as in Visual Studio 2013 compilation. Therefore the batch script should look at least as:</p>\n\n<pre><code>@echo off\ncall \"C:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\VC\\vcvarsall.bat\" x64\n\nswig -c++ -java -outdir java api.i\n\nset CompilerFlags= /Zi /nologo /W3 /WX- /sdl /Od /Oy-^\n    /D WIN32 /D _DEBUG /D _CONSOLE /D _LIB /D _CRT_SECURE_NO_WARNINGS /D _CRT_SECURE_NO_DEPRECATE^\n    /D _UNICODE /D UNICODE^\n    /Gm /EHsc /RTC1 /MDd /GS /fp:precise /Zc:wchar_t /Zc:forScope /Gd /LD\n\npushd build\ncl %CompilerFlags% ..\\api.cpp ..\\api_wrap.cxx /I\"C:\\Program Files (x86)\\Java\\openjdk8u102-win_jdk\\include\"^\n  /I\"C:\\Program Files (x86)\\Java\\openjdk8u102-win_jdk\\include\\win32\"\npopd\n\nCOPY .\\build\\api.dll .\\java\\\n</code></pre>\n\n<p>Now everything works just as fine</p>\n"}], "owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52648913, "answer_count": 1, "score": 0, "last_activity_date": 1538662351, "creation_date": 1538575832, "question_id": 52628961, "link": "https://stackoverflow.com/questions/52628961/java-swig-wrapper-vs-direct-function-calling", "title": "Java SWIG wrapper vs direct function calling", "body": "<p>I have some kind of library that I am writing wrapper for and then I am trying to generate SWIG wrapper on it so I could make calls straight from Java.</p>\n\n<p>I encountered a problem which I can not debug as there are basically 0 information (Java side). Here is what I am dealing with. I have got a custom class like this:</p>\n\n<pre><code>class APIClass {\n\nprivate:\n\npublic:\n    APIClass();\n    void mbstowcsTest();\n};\n</code></pre>\n\n<p>And its implementation looks like this</p>\n\n<pre><code>typedef unsigned short      AName[32];\n\nvoid APIClass::mbstowcsTest() {\n  const char* source = \"D:\\\\test3\\\\source\\\\test.txt\";\n  AName tmp1;\n  mbstowcs((wchar_t*)tmp1, source, 32 - 1);\n}\n</code></pre>\n\n<p>With such code I am generating SWIG files for it and compile the code with batch script like so:</p>\n\n<pre><code>@echo off\ncall \"C:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\VC\\vcvarsall.bat\" x64\n\nswig -c++ -java -outdir java api.i\n\nset CompilerFlags=-nologo -Zi\npushd build\ncl %CompilerFlags% ..\\api.cpp ..\\api_wrap.cxx /I\"C:\\Program Files (x86)\\Java\\openjdk8u102-win_jdk\\include\"^\n  /I\"C:\\Program Files (x86)\\Java\\openjdk8u102-win_jdk\\include\\win32\" /LD /EHsc\npopd\n\nCOPY .\\build\\api.dll .\\java\\\n</code></pre>\n\n<p>As for api.i interface file it is only:</p>\n\n<pre><code>%module api\n%{\n    #include \"api.h\"\n%}\n%include \"api.h\"\n</code></pre>\n\n<p>Basically, if I am calling <code>APIClass::mbstowcsTest()</code> in the C++ main function all is going well and <code>mbstowcs()</code> is going through without any problems like so:</p>\n\n<pre><code>APIClass *api = NULL;\napi = new APIClass();\napi-&gt;mbstowcsTest();\n</code></pre>\n\n<p>While in Java side I have:</p>\n\n<pre><code>class main {\n    public static void main(String[] args) {\n        System.loadLibrary(\"api\");\n        APIClass api = new APIClass();\n        api.mbstowcsTest();\n    }\n}\n</code></pre>\n\n<p>The problem in Java code is that whenever code reaches <code>mbstowcs()</code> in <code>APIClass::mbstowcsTest()</code> all I am getting is outputs like <code>Process finished with exit code -1073740791 (0xC0000409)</code>. Could anyone tell me why is that a problem? I tried using other functions from <code>stdlib.h</code> like <code>abs()</code> and it worked.</p>\n"}, {"tags": ["c++", "opencv", "pointers", "casting", "point"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538575822, "post_id": 52628920, "comment_id": 92191392, "body": "Beware that <code>temp</code> is a copy, and a list of vertices is generally not something you want to be copying much."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538575912, "post_id": 52628920, "comment_id": 92191446, "body": "<code>temp</code> was just to check if the input data are correct. It will not be modified. It will be removed after the problem will be solved."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538575916, "post_id": 52628920, "comment_id": 92191448, "body": "Is <code>.data</code> a data member or a member function? <code>(const cv::Point*)</code> is very suspicious and you might be casting a function pointer to a data pointer. Avoid c style casts, they are too strong and often hide errors."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538576483, "post_id": 52628920, "comment_id": 92191804, "body": "Sorry maybe I was worng about data: let me check maybe I confused dat() from vector with data of Mat opencv object."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538576808, "post_id": 52628920, "comment_id": 92192015, "body": "I&#39;m not an expert with OpenCV but it seems like the pointer returned by <code>Mat::data</code> will be invalidated if the associated <code>Mat</code> object is destroyed. Since you are making a temporary <code>Mat</code> it will be destroyed at the end of the expression, making the obtained pointer unusable."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538577026, "post_id": 52628920, "comment_id": 92192161, "body": "but changing <code>parks.at(ii).getPoly().data()</code> will not create any new vector so the pointer, at least inside the function should be always valid. And the error remains."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1538577310, "post_id": 52628920, "comment_id": 92192332, "body": "Why do you even need a <code>Mat</code>? Simple <code>&amp;temp[0]</code> will give you what you need (pointer to the first <code>cv::Point</code> in the vector)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538577313, "post_id": 52628920, "comment_id": 92192339, "body": "The line you describe doesn&#39;t exist in the code you&#39;ve shown. I&#39;m talking about <code>Mat(parks.at(ii).getPoly()).data</code>. And if we assume the line you describe did exist, it would depend on what <code>getPoly()</code> returns. If it returns a value, then you would still be getting <code>data()</code> from a temporary. If it returns a reference, it might work."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1538577942, "post_id": 52628920, "comment_id": 92192817, "body": "@DanMa\u0161ek&#39;s solutions worked and it is very smart. I have one question still though: why does <code>Point *pts = &amp;temp[0];</code> while <code>Point *pts = &amp;( (parks.at(ii).getPoly())[0]);</code> does not? Is it because the value returned is not stored anywher?"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1538578621, "post_id": 52628920, "comment_id": 92193313, "body": "In the second case you&#39;re taking a pointer to the internal members of a temporary, which ceases to exist after that statement is executed (the memory pointed to may hold anything, but it&#39;s incorrect to access it)."}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "edited": false, "score": 2, "creation_date": 1538579003, "post_id": 52628920, "comment_id": 92193566, "body": "So basically I was seeing some valid data because not all the memory where the temporary was stored has been overwritten but only part of it. Right?"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1538580031, "post_id": 52628920, "comment_id": 92194288, "body": "@FrancescoBoi Exactly."}], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538575728, "creation_date": 1538575728, "question_id": 52628920, "link": "https://stackoverflow.com/questions/52628920/opencv-casting-of-vectorpoint-data-to-point-resulting-in-an-unexpected-behavi", "title": "OpenCV casting of vector&lt;Point&gt;.data to Point* resulting in an unexpected behaviour", "body": "<p>In a OpenCV C++ program I have a function with this body.</p>\n\n<pre><code>  for (int ii=0; ii&lt; static_cast&lt;int&gt;(parks.size()); ii++)\n  {\n     PolygonVertices temp = parks.at(ii).getPoly();\n     const Point *pts = (const cv::Point*) Mat(parks.at(ii).getPoly()).data;\n     int npts = Mat(parks.at(ii).getPoly()).rows;\n     for (int jj=0; jj&lt;npts; jj++)\n     {\n         cout&lt;&lt;\"----\"&lt;&lt;jj&lt;&lt;\"----\"&lt;&lt;endl;\n         cout&lt;&lt;\"x: \"&lt;&lt;pts[jj].x&lt;&lt;\", y: \"&lt;&lt;pts[jj].y&lt;&lt;endl;\n         cout&lt;&lt;\"x: \"&lt;&lt;temp[jj].x&lt;&lt;\", y: \"&lt;&lt;temp[jj].y&lt;&lt;endl;\n         cout&lt;&lt;\"--------\"&lt;&lt;endl;\n     }\n  }\n}\n</code></pre>\n\n<p><code>Polygonvertices</code> is a type defined as <code>typedef std::vector&lt;cv::Point&gt;</code> and the method <code>getPoly()</code> returns such a structure.</p>\n\n<p>I am casting the <code>Polygonvertices</code> (which is a vector of <code>Point</code>) data to a pointer of <code>Point</code> type.</p>\n\n<p>The points are selected with the mouse.</p>\n\n<p>The problem is that printing the <code>x</code> and <code>y</code> coordinates of both the element of the pointer and the original element, for the first element (index 0) data coming from the pointer are shifted.</p>\n\n<p>For example this is the output:</p>\n\n<pre><code>----0----\nx: -1871319456, y: 21975\nx: 286, y: 304\n--------\n----1----\nx: 325, y: 218\nx: 325, y: 218\n--------\n----2----\nx: 375, y: 280\nx: 375, y: 280\n</code></pre>\n\n<p>As you can see the first element is totally shifted away?</p>\n\n<p>What is happening? Is the casting wrong?</p>\n\n<p>This is happening  using OpenCV4 under Ubuntu 18.04.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1538573878, "post_id": 52628303, "comment_id": 92190159, "body": "Accessing deleted objects is undefined behaviour. And no, <code>c_str()</code> simply returns a pointer to the string."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1538574059, "post_id": 52628303, "comment_id": 92190267, "body": "Also, see <a href=\"https://stackoverflow.com/q/31816095/580083\">Why should I not #include &lt;bits/stdc++.h&gt;?</a>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1538574172, "post_id": 52628303, "comment_id": 92190331, "body": "Not related to your question, but the dual combo of <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\"><code>bits&#47;stdc++.h</code></a> and <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\"><code>using namespace std;</code></a> is a bad idea."}, {"owner": {"reputation": 146, "user_id": 871071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVi3k.png?s=128&g=1", "display_name": "The Unknown", "link": "https://stackoverflow.com/users/871071/the-unknown"}, "edited": false, "score": 0, "creation_date": 1538574290, "post_id": 52628303, "comment_id": 92190418, "body": "calling delete is meant to tell the os that the specific memory area is free for reuse, not that the whole of it is completely zero&#39;ed out right after that. you&#39;ll see this clearer and more often in programs run with repeated uses of dynamic alloc and dealloc functions.  So only after main or when the objects in use become out of scope, will you be able to enjoy the non-allocated assets."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1538575187, "post_id": 52628303, "comment_id": 92191005, "body": "If you compile this with MSVC in DEBUG mode then your program will print garbage as MSVC is kind enough to fill deallocated memory with garbage when it frees it: <a href=\"http://rextester.com/HJYZ85336\" rel=\"nofollow noreferrer\">rextester.com/HJYZ85336</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1538573947, "post_id": 52628331, "comment_id": 92190194, "body": "Moreover, one should not even attempt to modify the returned string."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538574188, "post_id": 52628331, "comment_id": 92190339, "body": "@Fran&#231;oisAndrieux: Yup, the original draft had completely the wrong flavour to it. I&#39;ve amended."}, {"owner": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1538574260, "post_id": 52628331, "comment_id": 92190394, "body": "we are deleting the object means we are destroying its memory in heap right...why still i am getting the output..can you guys please explain me in little detail as i am new to c++."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1538574306, "post_id": 52628331, "comment_id": 92190432, "body": "@harishDubakula: The result you observe is a manifestation of that undefined behaviour."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 2, "creation_date": 1538574410, "post_id": 52628331, "comment_id": 92190506, "body": "Is using the value of <code>ptr</code> itself really ok? Isn&#39;t the pointer invalid after being freed due to destruction of the owning <code>std::string</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1538574444, "post_id": 52628331, "comment_id": 92190537, "body": "@Deduplicator; I&#39;m checking, frantically. This is a tricky corner of the standard."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1538574493, "post_id": 52628331, "comment_id": 92190573, "body": "@Deduplicator: You&#39;re correct, same as an uninitialised pointer read."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "reply_to_user": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1538574535, "post_id": 52628331, "comment_id": 92190606, "body": "@harishDubakula <code>std::string</code> buffer can live both on the heap and the stack (for small lengths, see SSO). This is irrelevant to your problem as explained by @Bathsheba."}, {"owner": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1538574543, "post_id": 52628331, "comment_id": 92190616, "body": "will that memory of c_str() allocated in heap?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1538574575, "post_id": 52628331, "comment_id": 92190635, "body": "@Bathsheba <code>ptr</code> is a copy of the result of <code>c_str()</code>. It&#39;s definitely invalidated, but it shouldn&#39;t be modified by the destruction of the string. However, I&#39;m also not 100% sure you are allowed to take address value of a pointer to a deleted object in general. For example, you can&#39;t read the address from a pointer you <code>delete</code> (see <a href=\"https://stackoverflow.com/q/43508771/7359094\">this answer</a>). This doesn&#39;t necessarily mean that this example applies to copies of such pointers, but I seem to remember taking the address from a pointer to a deleted object is just UB in general."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1538574576, "post_id": 52628331, "comment_id": 92190636, "body": "@harishDubakula: It is free, but why would the C++ runtime clean up the memory? That would be a bit like cleaning the holiday cottage yourself before you left."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1538574605, "post_id": 52628331, "comment_id": 92190648, "body": "@Bathsheba afaik you can cast it to <code>uintptr_t</code> and print that without any UB. No one forbids taking integer values of pointers, even if they don&#39;t point anywhere useful."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1538574641, "post_id": 52628331, "comment_id": 92190669, "body": "@DanM.: Yes, that&#39;s my understanding too, although I never program at such a level, so the rules are a little fuzzy in my head."}, {"owner": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1538575184, "post_id": 52628331, "comment_id": 92191003, "body": "can  above code cause memory leak?"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 1, "creation_date": 1538577897, "post_id": 52628331, "comment_id": 92192785, "body": "@harishDubakula It&#39;s UB, so yes, not that it matters."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 6, "last_activity_date": 1538574480, "last_edit_date": 1538574480, "creation_date": 1538573889, "answer_id": 52628331, "question_id": 52628303, "link": "https://stackoverflow.com/questions/52628303/is-c-str-allocate-memory-in-heap/52628331#52628331", "title": "is c_str() allocate memory in heap?", "body": "<p><code>c_str()</code> gives you a pointer to the data buffer in <code>std::string</code> (with a <code>NUL</code> terminator guaranteed to be added at the end of the string), that's all. Note that the pointer is <em>invalidated</em> if the <code>std::string</code> goes out of scope, is destroyed, or is changed.</p>\n\n<p>In your case the behaviour of <code>cout &lt;&lt; ptr &lt;&lt; endl</code>; is <em>undefined</em>. This is because <code>ptr</code> was set to the return value of <code>c_str()</code> on a string that no longer exists, and <code>cout</code> for <code>const char*</code> has a special overload that attempts to read the character buffer from that pointer up to the first NUL character encountered.  The result you observe is a manifestation of that undefined behaviour.</p>\n\n<p>Note that, <code>cout &lt;&lt; (void*)ptr &lt;&lt; endl;</code> is also undefined, as once you no longer own memory at an address, the pointer is essentially in an uninitialised state.</p>\n"}], "owner": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "closed_date": 1538573973, "answer_count": 1, "score": 0, "last_activity_date": 1547211255, "creation_date": 1538573812, "last_edit_date": 1547211255, "question_id": 52628303, "link": "https://stackoverflow.com/questions/52628303/is-c-str-allocate-memory-in-heap", "closed_reason": "Duplicate", "title": "is c_str() allocate memory in heap?", "body": "<p>Recently i have the problem with c_str().below is the sample code snippet</p>\n\n<pre><code>#include&lt;bits/stdc++.h&gt;\n#include&lt;unistd.h&gt;\nusing namespace std;\nclass har{\n\n    public:\n    string h;\n    har(string str){\n        h=str;\n    }\n};\n\nint main(){\n\n\nhar *hg=new har(\"harish\");\nconst char *ptr=hg-&gt;h.c_str();\ndelete hg;\ncout&lt;&lt;ptr&lt;&lt;endl;\nreturn 0;\n}\n</code></pre>\n\n<p>I am getting the output as \"harish\"....I have destroyed the object but still i am getting the output..is c_str() again allocating memory in heap.</p>\n"}, {"tags": ["c++", "qt", "qt5"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1538574139, "post_id": 52628235, "comment_id": 92190311, "body": "Do you have a GUI?"}, {"owner": {"reputation": 11, "user_id": 10451565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebe49394cdf1c60d6170d72973e69102?s=128&d=identicon&r=PG&f=1", "display_name": "Lybbo", "link": "https://stackoverflow.com/users/10451565/lybbo"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1538574318, "post_id": 52628235, "comment_id": 92190449, "body": "Yes there is a GUI with the QMainWindow class."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10451565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebe49394cdf1c60d6170d72973e69102?s=128&d=identicon&r=PG&f=1", "display_name": "Lybbo", "link": "https://stackoverflow.com/users/10451565/lybbo"}, "edited": false, "score": 0, "creation_date": 1538574366, "post_id": 52628419, "comment_id": 92190482, "body": "thank you I&#39;ll take a look at it :)"}], "tags": [], "owner": {"reputation": 1140, "user_id": 9252020, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PDrj2.jpg?s=128&g=1", "display_name": "Rhathin", "link": "https://stackoverflow.com/users/9252020/rhathin"}, "is_accepted": false, "score": 1, "last_activity_date": 1538580556, "last_edit_date": 1538580556, "creation_date": 1538574111, "answer_id": 52628419, "question_id": 52628235, "link": "https://stackoverflow.com/questions/52628235/how-to-use-keyboard-input-in-qt5-for-execution-of-function-xyz/52628419#52628419", "title": "How to use Keyboard input in Qt5 for Execution of function xyz?", "body": "<p>Just override in your class <code>QWidget::keyPressEvent</code> method. You can recieve pressed key from <code>QKeyEvent *event</code> argument using <code>QKeyEvent::key</code> method.</p>\n\n<p>Simple example below:</p>\n\n<pre><code>#include &lt;QWidget&gt;\n#include &lt;QKeyEvent&gt;\n\nclass MyClass : public QWidget\n{\n    Q_OBJECT\npublic:\n    explicit MyClass(QWidget *parent = 0):QWidget(parent){}\n\nprotected:\n     void keyPressEvent(QKeyEvent *event) override\n     {\n         if(event-&gt;key() == Qt::Key_R)\n         {\n             //Do something when 'R' key is pressed\n         }\n     }\n};\n</code></pre>\n\n<p>You can find more informations in <a href=\"http://doc.qt.io/qt-5/qwidget.html#keyPressEvent\" rel=\"nofollow noreferrer\">reference</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10451565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebe49394cdf1c60d6170d72973e69102?s=128&d=identicon&r=PG&f=1", "display_name": "Lybbo", "link": "https://stackoverflow.com/users/10451565/lybbo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4719, "favorite_count": 0, "closed_date": 1538574480, "answer_count": 1, "score": 1, "last_activity_date": 1538580556, "creation_date": 1538573617, "question_id": 52628235, "link": "https://stackoverflow.com/questions/52628235/how-to-use-keyboard-input-in-qt5-for-execution-of-function-xyz", "closed_reason": "Duplicate", "title": "How to use Keyboard input in Qt5 for Execution of function xyz?", "body": "<p>i am doing some experiments on Keyboard Input in Qt5 and now after I did some research I couldn't find a simple way to execute Code if a specific button is pressed e.g. Button R. Now my Question is which way is the most simple to use the Keyboard Input (real Keyboard, not virtual Keyboard) to do things.</p>\n\n<p>I would really appreciate some help or even examples on this :)</p>\n\n<p>Greetings\nLybbo</p>\n"}, {"tags": ["c++", "amazon-web-services", "amazon-s3", "aws-sdk", "aws-sdk-cpp"], "answers": [{"comments": [{"owner": {"reputation": 8010, "user_id": 180904, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ec0e877c4568a175614c5ab947ecf0c9?s=128&d=identicon&r=PG", "display_name": "Ashika Umanga Umagiliya", "link": "https://stackoverflow.com/users/180904/ashika-umanga-umagiliya"}, "edited": false, "score": 0, "creation_date": 1538655097, "post_id": 52631083, "comment_id": 92224659, "body": "Birties : thanks for the tip.. it worked.. however ListObjectsV2 f ailed giving error &quot;ListObjects error: InvalidArgument Unable to parse ExceptionName: InvalidArgument Message: The continuation token provided is incorrect&quot;"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "reply_to_user": {"reputation": 8010, "user_id": 180904, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ec0e877c4568a175614c5ab947ecf0c9?s=128&d=identicon&r=PG", "display_name": "Ashika Umanga Umagiliya", "link": "https://stackoverflow.com/users/180904/ashika-umanga-umagiliya"}, "edited": false, "score": 1, "creation_date": 1538655155, "post_id": 52631083, "comment_id": 92224704, "body": "@AshikaUmangaUmagiliya I guess you aren&#39;t using it correctly, post a new question with your full code and I&#39;m sure someone will tell you whats wrong."}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 3, "last_activity_date": 1538581873, "creation_date": 1538581873, "answer_id": 52631083, "question_id": 52628056, "link": "https://stackoverflow.com/questions/52628056/aws-s3-c-list-all-the-object-when-result-is-truncated/52631083#52631083", "title": "AWS S3 C++ : List all the object when result is truncated", "body": "<p>According to the <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGET.html#RESTBucketGET-responses\" rel=\"nofollow noreferrer\">documentation</a> for NextMarker:</p>\n\n<blockquote>\n  <p>Note</p>\n  \n  <p>This element is returned only if you specify a delimiter request parameter. If the  response does not include the NextMarker and it is truncated, you can use the value of the last Key in the response as the marker in the subsequent request to get the next set of object keys.</p>\n</blockquote>\n\n<p>Your code should therefore be:</p>\n\n<pre><code>if(!isDone) {\n  objects_request.SetMarker(outcome.GetResult().GetContents().back().GetKey());\n}\n</code></pre>\n\n<p>Also note that the V1 ListObjects method is deprecated, you should be using <a href=\"https://sdk.amazonaws.com/cpp/api/LATEST/class_aws_1_1_s3_1_1_s3_client.html#ae6bcac3c32efa6939df8b507112ba2ce\" rel=\"nofollow noreferrer\">ListObjectsV2</a> which uses explicit continuation tokens which are a bit easier to use.</p>\n"}], "owner": {"reputation": 8010, "user_id": 180904, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ec0e877c4568a175614c5ab947ecf0c9?s=128&d=identicon&r=PG", "display_name": "Ashika Umanga Umagiliya", "link": "https://stackoverflow.com/users/180904/ashika-umanga-umagiliya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 1, "accepted_answer_id": 52631083, "answer_count": 1, "score": 2, "last_activity_date": 1538581873, "creation_date": 1538573000, "question_id": 52628056, "link": "https://stackoverflow.com/questions/52628056/aws-s3-c-list-all-the-object-when-result-is-truncated", "title": "AWS S3 C++ : List all the object when result is truncated", "body": "<p>I use following code to list all the keys in my S3 bucket.</p>\n\n<p>I have around 15,000 objects in the bucket. However this code just loops through the first 1000 objects infinitly. Seems it doesnt respect the SetMarker() method.</p>\n\n<p>Any tips on how to fix this ?</p>\n\n<pre><code>#include &lt;aws/s3/S3Client.h&gt;\n#include &lt;aws/s3/model/ListObjectsRequest.h&gt;\n#include &lt;aws/s3/model/Object.h&gt;\n\nint main(int argc, const char* argv[])\n{\n    Aws::SDKOptions options;\n    Aws::InitAPI(options);\n    {\n        Aws::Client::ClientConfiguration config;\n        config.region=\"ap-northeast-1\";\n\n        Aws::S3::S3Client s3_client(config);\n        Aws::S3::Model::ListObjectsRequest objects_request;\n\n        objects_request.WithBucket(\"MYBUCKETNAME\").WithPrefix(\"some-prefox\");\n\n        bool isDone = false;\n        bool isFailed= false;\n        Aws::S3::Model::ListObjectsOutcome outcome;\n        int c=0;\n\n        while(!isDone) {\n                 outcome=s3_client.ListObjects(objects_request);\n                 if(!outcome.IsSuccess()) break;\n                 //process\n                 Aws::Vector&lt;Aws::S3::Model::Object&gt; object_list = outcome.GetResult().GetContents();\n\n                 for (auto const &amp;s3_object : object_list)\n                {\n                    std::cout &lt;&lt; \"* \" &lt;&lt; s3_object.GetKey() &lt;&lt; std::endl;\n                    c++;\n\n                }\n                std::cout&lt;&lt;\"--------- Break\"&lt;&lt;c&lt;&lt;\"\\n\";\n                 isDone=!outcome.GetResult().GetIsTruncated();\n                 if(!isDone) {\n                    objects_request.SetMarker(outcome.GetResult().GetNextMarker());\n\n                }\n            }\n            std::cout &lt;&lt; \"Count \"&lt;&lt;c&lt;&lt;\"\\n\";\n            //check isFailed\n            if(!outcome.IsSuccess()) {\n                std::cout &lt;&lt; \"ListObjects error: \" &lt;&lt;\n                outcome.GetError().GetExceptionName() &lt;&lt; \" \" &lt;&lt;\n                outcome.GetError().GetMessage() &lt;&lt; std::endl;\n            }\n\n    }\n\n    Aws::ShutdownAPI(options);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "edited": false, "score": 1, "creation_date": 1538571602, "post_id": 52627553, "comment_id": 92188645, "body": "<code>override</code> keyword can only be used when you override virtual methods."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538571655, "post_id": 52627553, "comment_id": 92188689, "body": "Only classes can have virtual functions."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1538571656, "post_id": 52627553, "comment_id": 92188691, "body": "Please add <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. As of now, this problem can be everywhere. Include both classes declarations."}, {"owner": {"reputation": 694, "user_id": 1406186, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/efcdbad6895719edb74597d135ecbb91?s=128&d=identicon&r=PG", "display_name": "user1406186", "link": "https://stackoverflow.com/users/1406186/user1406186"}, "edited": false, "score": 0, "creation_date": 1538572001, "post_id": 52627553, "comment_id": 92188904, "body": "I&#39;ve updated it, is this what you meant?"}, {"owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "edited": false, "score": 0, "creation_date": 1538572093, "post_id": 52627553, "comment_id": 92188978, "body": "remove <code>override</code> from cpp"}, {"owner": {"reputation": 694, "user_id": 1406186, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/efcdbad6895719edb74597d135ecbb91?s=128&d=identicon&r=PG", "display_name": "user1406186", "link": "https://stackoverflow.com/users/1406186/user1406186"}, "edited": false, "score": 0, "creation_date": 1538572340, "post_id": 52627553, "comment_id": 92189124, "body": "what&#39;s the reasoning for removing it? I&#39;m reading A Tour of C++ and it uses it the same way?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 3, "creation_date": 1538572685, "post_id": 52627553, "comment_id": 92189349, "body": "@user1406186 <a href=\"https://en.cppreference.com/w/cpp/language/override\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/override</a> &quot;The identifier override, if used, appears immediately after the <b>declarator</b> in the syntax of a member function declaration or a member function definition <b>inside a class definition</b>.&quot; (emphasis mine)"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1538572695, "post_id": 52627553, "comment_id": 92189353, "body": "You want to define <code>get_virtual_year()</code> method from <b><code>bca_interface</code></b>, not from <code>bca</code>. BTW, this naming is confusing. Interface is usually used as name for the class with pure virtual methods."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1538577880, "post_id": 52627553, "comment_id": 92192771, "body": "@Yksisarvinen, it <i>could</i> have been intentional to implement <code>bca::get_virtual_year</code> (but the <code>override</code> suggests not).  Don&#39;t forget that pure virtual methods are allowed to have definitions in C++, unlike certain other languages."}], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 7, "last_activity_date": 1538576906, "last_edit_date": 1538576906, "creation_date": 1538573062, "answer_id": 52628073, "question_id": 52627553, "link": "https://stackoverflow.com/questions/52627553/override-not-allowed-outside-a-class-definition/52628073#52628073", "title": "override not allowed outside a class definition", "body": "<p>The error says it all:</p>\n\n<pre><code>error: virt-specifiers in \u2018get_virtual_year\u2019 not allowed outside a class definition\n</code></pre>\n\n<p>You cannot put a <em>virt-specifier</em> (<code>override</code> and <code>final</code>) outside of a class definition. You only put that specifier on the function declaration within the class definition. The same is true for, e.g., <code>explicit</code>, <code>static</code>, <code>virtual</code>, ...</p>\n\n<p>Where you have it in the header is correct. In your source, just remove it.</p>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1538576248, "post_id": 52629036, "comment_id": 92191647, "body": "You can put default arguments in the definition."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1538576340, "post_id": 52629036, "comment_id": 92191707, "body": "Oh, I forgot that&#39;s just a warning rather than an error (I usually use <code>-Werror</code>).  Your example of <code>explicit</code> is better."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1538577135, "post_id": 52629036, "comment_id": 92192237, "body": "@TobySpeight It shouldn&#39;t even be a warning as far as I&#39;m aware. Just don&#39;t put default args in more than one declaration (including the defining declaration)"}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 7, "last_activity_date": 1538577489, "last_edit_date": 1538577489, "creation_date": 1538576009, "answer_id": 52629036, "question_id": 52627553, "link": "https://stackoverflow.com/questions/52627553/override-not-allowed-outside-a-class-definition/52629036#52629036", "title": "override not allowed outside a class definition", "body": "<p>The <code>override</code> keyword, is only used in the <em>declaration</em> of the member (in the class definition, as the error message says).  That's where it's relevant.</p>\n\n<p>The definition doesn't care whether it's an overriding implementation or not, just that it has the same signature (including <code>const</code>).</p>\n\n<pre><code>//bca_interface.h\nclass bca_interface : public bca {\npublic:\nprivate:\n    std::string get_virtual_year() const override;\n    //                                   ^^^^^^^^ correct\n};\n</code></pre>\n\n\n\n<pre><code>//bca_interface.cpp\nstd::string bca_interface::get_virtual_year() const {\n    //                                  ^^^ not required (or allowed) here\n    return \"\";\n}\n</code></pre>\n\n<p>Of course, if your declaration is also the definition, then <code>override</code> is welcome.</p>\n"}], "owner": {"reputation": 694, "user_id": 1406186, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/efcdbad6895719edb74597d135ecbb91?s=128&d=identicon&r=PG", "display_name": "user1406186", "link": "https://stackoverflow.com/users/1406186/user1406186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3629, "favorite_count": 2, "closed_date": 1538593882, "accepted_answer_id": 52628073, "answer_count": 2, "score": 5, "last_activity_date": 1538577749, "creation_date": 1538571404, "last_edit_date": 1538577749, "question_id": 52627553, "link": "https://stackoverflow.com/questions/52627553/override-not-allowed-outside-a-class-definition", "closed_reason": "Not suitable for this site", "title": "override not allowed outside a class definition", "body": "<p>I created an abstract class and a concrete subclass:</p>\n\n<pre><code>//bca.h\n#include &lt;string&gt;\nclass bca {\npublic:\n    virtual std::string get_virtual_year() const = 0;\n};\n</code></pre>\n\n\n\n<pre><code>//bca_interface.h\n#include \"bca.h\"\nclass bca_interface : public bca {\npublic:\n    std::string get_virtual_year() const override;\n};\n</code></pre>\n\n\n\n<pre><code>//bca_interface.cpp\n#include \"bca_interface.h\"\nstd::string bca::get_virtual_year() const override {\n    return \"\";\n}\n</code></pre>\n\n<p>When I compile <code>bca_interface.cpp</code> with g++, I get:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> error: virt-specifiers in \u2018get_virtual_year\u2019 not allowed outside a class definition\n std::string bca::get_virtual_year() const override {\n</code></pre>\n"}, {"tags": ["c++", "shared-ptr", "c++03"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1538570794, "post_id": 52627324, "comment_id": 92188115, "body": "Why can&#39;t DerivedObject1 inherit from DerivedObject2? Then doesn&#39;t the problem go away?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1538570810, "post_id": 52627324, "comment_id": 92188128, "body": "Any reason why you can&#39;t uplift <code>additionalMethod()</code> into the base class and just make it a do nothing function for <code>DerivedObject2</code>?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1538570848, "post_id": 52627324, "comment_id": 92188157, "body": "Instead of describing your code, please <i>show</i> it to us. Preferably in the form of a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>. Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 285, "user_id": 5243035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dGLr6.jpg?s=128&g=1", "display_name": "Enaid", "link": "https://stackoverflow.com/users/5243035/enaid"}, "edited": false, "score": 0, "creation_date": 1538571088, "post_id": 52627324, "comment_id": 92188308, "body": "Yes sorry, it&#39;s boost::shared_ptr, will edit, I&#39;m switching between versions and getting confused"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1538571997, "post_id": 52627324, "comment_id": 92188899, "body": "There&#39;s nothing particularly wrong with having multiple <code>shared_ptr</code>s to the same object. It&#39;s kind of the <i>point</i> of <code>shared_ptr</code> (although in C++03 you don&#39;t have <code>unique_ptr</code> and <code>reference_wrapper</code>, which might be preferable here)"}, {"owner": {"reputation": 285, "user_id": 5243035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dGLr6.jpg?s=128&g=1", "display_name": "Enaid", "link": "https://stackoverflow.com/users/5243035/enaid"}, "edited": false, "score": 0, "creation_date": 1538572124, "post_id": 52627324, "comment_id": 92188996, "body": "Thank you Bathsheba and NathanOliver, I answered those propositions in a comment to sagi&#39;s answer"}, {"owner": {"reputation": 285, "user_id": 5243035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dGLr6.jpg?s=128&g=1", "display_name": "Enaid", "link": "https://stackoverflow.com/users/5243035/enaid"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1538572665, "post_id": 52627324, "comment_id": 92189330, "body": "Edited the question to add the code, thank you @Someprogrammerdude for the reminder"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1538573271, "post_id": 52627324, "comment_id": 92189743, "body": "<a href=\"https://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"nofollow noreferrer\">Visitor pattern</a> might be an alternative to add new virtual methods to base class."}, {"owner": {"reputation": 3401, "user_id": 1134387, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c36029f02494282a4bb455f584b522e6?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/1134387/bernhard"}, "edited": false, "score": 0, "creation_date": 1538574571, "post_id": 52627324, "comment_id": 92190634, "body": "What is your concern about that duplicate pointers? You are already using shared_ptr and not unique_ptr. So if the vector with all objects goes out of scope, the other vector can still be used, which is probably what you want. You can even question if they really have a common base class, but that depends on what the class represents."}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 5243035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dGLr6.jpg?s=128&g=1", "display_name": "Enaid", "link": "https://stackoverflow.com/users/5243035/enaid"}, "edited": false, "score": 1, "creation_date": 1538572022, "post_id": 52627418, "comment_id": 92188927, "body": "I thought about making a dummy method, but it doesn&#39;t feel like pretty code and it would cluster the class, <code>additionalMethod()</code> really doesn&#39;t mean anything for <code>DerivedObject2</code>. I fear adding it to <code>DerivedObject2</code> would confuse people reading the documentation. Also making <code>DerivedObject1</code> inherit from <code>DerivedObject2</code> wouldn&#39;t make much sense (like if the base class if Fruit, and derived classes are Apple and Banana). Plus there may be a <code>DerivedObject3</code> in the future. Still, those are solutions but I&#39;m wondering if there are actual disadvantages of having multiple copies of the shared ptr"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 285, "user_id": 5243035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dGLr6.jpg?s=128&g=1", "display_name": "Enaid", "link": "https://stackoverflow.com/users/5243035/enaid"}, "edited": false, "score": 1, "creation_date": 1538572401, "post_id": 52627418, "comment_id": 92189172, "body": "@Enaid The disadvantage is wasted space and the complexity of syncing the vectors.  You have to add the same pointer to two vectors and then if you remove an element you need to do it from both vectors.  That extra space and complexity is it&#39;s disadvantage."}], "tags": [], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "is_accepted": false, "score": 1, "last_activity_date": 1538570971, "creation_date": 1538570971, "answer_id": 52627418, "question_id": 52627324, "link": "https://stackoverflow.com/questions/52627324/is-it-good-practice-to-store-copies-of-the-same-shared-pointers-in-different-vec/52627418#52627418", "title": "Is it good practice to store copies of the same shared pointers in different vectors?", "body": "<p>I can suggest this : Store everything in one array , and make a dummy <code>additionalMethod()</code> in <code>DerivedObject2</code> . Then - just invoke <code>additionalMethod</code> for every object .</p>\n\n<p>Alternativly : </p>\n\n<blockquote>\n  <p>They share a common behavior and methods, but DerivedObject1 has an additional method</p>\n</blockquote>\n\n<p>Make <code>DerivedObject1</code> inherit from <code>DerivedObject2</code></p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1538573709, "post_id": 52628040, "comment_id": 92190048, "body": "Boost also has it, see <a href=\"https://www.boost.org/doc/libs/1_50_0/libs/smart_ptr/shared_ptr.htm#dynamic_pointer_cast\" rel=\"nofollow noreferrer\">documentation</a>."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1538573866, "last_edit_date": 1538573866, "creation_date": 1538572944, "answer_id": 52628040, "question_id": 52627324, "link": "https://stackoverflow.com/questions/52627324/is-it-good-practice-to-store-copies-of-the-same-shared-pointers-in-different-vec/52628040#52628040", "title": "Is it good practice to store copies of the same shared pointers in different vectors?", "body": "<p>Yes, your first method is good, the main problem is that you end up duplicating the public members of <code>vector</code> to ensure that the consistency of the <code>Derived</code> vector.</p>\n\n<pre><code>class MyClass\n{\n    typedef std::vector&lt;std::shared_ptr&lt;BaseObject&gt;&gt; BaseObjectVector;\n    typedef std::vector&lt;std::shared_ptr&lt;DerivedObject1&gt;&gt; DerivedObject1Vector;\n    BaseObjectVector everything;\n    DerivedObject1Vector only_derived1;\npublic:\n    void push_back(shared_ptr&lt;Base&gt; ptr)\n    {\n        everything.push_back(ptr);\n        if (shared_ptr&lt;Derived1&gt; derived = dynamic_ptr_cast&lt;Derived1&gt;(ptr))\n        {\n            only_derived1.push_back(derived);\n        }\n    }\n    void remove(shared_ptr&lt;Base&gt; ptr)\n    {\n        base.remove(ptr);\n        only_derived1.remove(dynamic_ptr_cast&lt;Derived1&gt;(ptr));\n    }\n    // dozens more... \n};\n</code></pre>\n\n<p>What you can instead do is provide a view of your <code>bases</code> using something like <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/range/doc/html/range/reference/adaptors/introduction.html\" rel=\"nofollow noreferrer\"><code>boost::range</code>'s adaptors</a></p>\n\n<pre><code>shared_ptr&lt;Derived1&gt; convert(shared_ptr&lt;Base&gt; ptr)\n{\n    return dynamic_ptr_cast&lt;Derived1&gt;(ptr);\n}\n\nbool not_null(shared_ptr&lt;Derived1&gt; ptr)\n{\n    return ptr.get();\n}\n\nboost::for_each(bases \n              | boost::adaptors::transformed(convert) // Base to Derived\n              | boost::adaptors::filtered(not_null)   // Eliminate null\n              | boost::adaptors::indirected,          // dereference\n                boost::bind(&amp;Derived1::additionalMethod, boost::placeholders::_1));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "is_accepted": true, "score": 6, "last_activity_date": 1538685227, "last_edit_date": 1538685227, "creation_date": 1538597460, "answer_id": 52634956, "question_id": 52627324, "link": "https://stackoverflow.com/questions/52627324/is-it-good-practice-to-store-copies-of-the-same-shared-pointers-in-different-vec/52634956#52634956", "title": "Is it good practice to store copies of the same shared pointers in different vectors?", "body": "<p>Interesting question.\nWe sometimes meet such a situation in maintenance of legacy codes which we don\u2019t know who wrote.</p>\n\n<blockquote>\n  <p>Are there any disadvantages of having two vectors in MyClass \u2026 ?</p>\n</blockquote>\n\n<p><strong>I think there are no mechanical (or performance) disadvantages.</strong>\nIf we are struggled to meet the release deadline, we have no choice but to pick such an simple way.\nHowever, storing same vectors twice actually lowers maintainability and <strong>we should consider improving it in the future.</strong></p>\n\n<hr>\n\n<ul>\n<li>std::dynamic_pointer_cast (or boost::dynamic_pointer_cast) <a href=\"https://wandbox.org/permlink/kQQhgAVZRHFUixGK\" rel=\"nofollow noreferrer\">[Demo]</a></li>\n</ul>\n\n<p>If you need <code>dynamic_pointer_cast</code> to implement functions like <a href=\"https://stackoverflow.com/questions/52627324/is-it-good-practice-to-store-copies-of-the-same-shared-pointers-in-different-vec/52628040#52628040\">@Caleth</a> \u2019s <code>push_back</code> / <code>remove</code>,\n how about removing <code>only_derived1</code> and reluctantly applying just one <code>dynamic_pointer_cast</code> in <code>doSomethingForDerivedObject1()</code> from the get-go as follows ?\nIt will make MyClass simpler. Required modification will not be complicated if DerivedObject3 is defined in the future.</p>\n\n<pre><code>void MyClass::doSomethingForDerivedObject1()\n{\n    for (const auto&amp; obj_i : everything)\n    {\n      if (auto derived1 = std::dynamic_pointer_cast&lt;DerivedObject1&gt;(obj_i))\n        {\n           derived1-&gt;additionalMethod();\n        }\n    }\n}\n\nvoid MyClass::doSomethingForDerivedObject3()\n{\n    for (const auto&amp; obj_i : everything)\n    {\n      if (auto derived3 = std::dynamic_pointer_cast&lt;DerivedObject3&gt;(obj_i))\n        {\n           derived3-&gt;additionalMethod();\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Dummy Method as proposed by <a href=\"https://stackoverflow.com/questions/52627324/is-it-good-practice-to-store-copies-of-the-same-shared-pointers-in-different-vec/52627418#52627418\">@sagi</a> <a href=\"https://wandbox.org/permlink/3ebZkWR5he5xjuWB\" rel=\"nofollow noreferrer\">[Demo]</a></li>\n</ul>\n\n<p>Declaring virtual function <code>BaseObject::additionalMethod()</code> and implementing</p>\n\n<pre><code>void DerivedObject2::additionalMethod()\n{ \n  /* nothing to do */\n}\n</code></pre>\n\n<p>then you can again remove <code>only_derived1</code>.\nIn this method you must implement <code>DerivedObject3::additionalMethod()</code> only if DerivedObject3 is defined.</p>\n\n<p>But, although it depends on your constructor or setter code,  if the following case will also occur</p>\n\n<pre><code>everything;    -&gt;derived2\nonly_derived1; -&gt;derived1\n</code></pre>\n\n<p>this method is still insufficient.</p>\n\n<hr>\n\n<ul>\n<li>Changing Design <a href=\"https://wandbox.org/permlink/aLjAFjMbRtkZGfKY\" rel=\"nofollow noreferrer\">[Demo]</a></li>\n</ul>\n\n<p>Ideally, we should not use public inheritance to implement objects within \"IS-ALMOST-A\u201c relations, as Herb Sutter says.\nThe relation between <code>BaseObject</code>, <code>DerivedObject1</code> and <code>DerivedObject2</code> looks like this one.\nSince I don\u2019t know whole code of your application I may be wrong, but it will be worthwhile to consider extracting <code>DerivedObject1::additionalMethod()</code> as another class or a function pointer and putting its vector in MyClass as a private member.</p>\n"}], "owner": {"reputation": 285, "user_id": 5243035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dGLr6.jpg?s=128&g=1", "display_name": "Enaid", "link": "https://stackoverflow.com/users/5243035/enaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 52634956, "answer_count": 3, "score": 7, "last_activity_date": 1538685227, "creation_date": 1538570631, "last_edit_date": 1538573742, "question_id": 52627324, "link": "https://stackoverflow.com/questions/52627324/is-it-good-practice-to-store-copies-of-the-same-shared-pointers-in-different-vec", "title": "Is it good practice to store copies of the same shared pointers in different vectors?", "body": "<p>I have a base class, <code>BaseObject</code>, and two derived class <code>DerivedObject1</code> and <code>DerivedObject2</code>. They share a common behavior and methods, but <code>DerivedObject1</code> has an additional method. My main class <code>MyClass</code> stores (in <code>std::vector</code>) <code>boost::shared_ptr</code> of instances of those classes. <code>MyClass</code> needs to call <code>commonMethod()</code> for all the BaseObject, and sometimes call <code>additionalMethod()</code> for all DerivedObject1. </p>\n\n<pre><code>class BaseObject\n{\n  virtual void commonMethod();\n}\n\nClass DerivedObject1 : public BaseObject\n{\n  void commonMethod();\n  void additionalMethod();\n}\n\nClass DerivedObject2 : public BaseObject\n{\n  void commonMethod();\n}\n</code></pre>\n\n<p>Are there any disadvantages of having two vectors in <code>MyClass</code>, one that stores ALL the pointers of <code>DerivedObject1</code> and <code>DerivedObject2</code>, and another vector that stores only the pointers of <code>DerivedObject1</code> ? Meaning I would have all the <code>DerivedObject1</code> pointers twice. But I think the call to the different methods would be clear, at least.</p>\n\n<pre><code>class MyClass\n{\n  typedef std::vector&lt;std::shared_ptr&lt;BaseObject&gt;&gt; BaseObjectVector;\n  typedef std::vector&lt;std::shared_ptr&lt;DerivedObject1&gt;&gt; DerivedObject1Vector;\n  BaseObjectVector everything;\n  DerivedObject1Vector only_derived1;\n\n  void doSomething()\n  {\n    for (BaseObjectVector::iterator iter = everything.begin(); iter != everything.end(); ++iter)\n    {\n      (*iter)-&gt;commonMethod();\n    }\n  }\n\n  void doSomethingForDerivedObject1()\n  {\n    for (DerivedObject1Vector::iterator iter = only_derived1.begin(); iter != only_derived1.end(); ++iter)\n    {\n      (*iter)-&gt;additionalMethod();\n    }\n  }\n}\n</code></pre>\n\n<p>I can think of other ways to do this, mainly having one vector for <code>DerivedObject1</code> and one vector for <code>DerivedObject2</code>, but to call <code>commonMethod()</code>, I would have to iterate over both vectors. My original solution seems the best to me, except that some pointers are stored twice. What are the disadvantages of this ?</p>\n"}, {"tags": ["android", "c++", "android-ndk", "sensors"], "answers": [{"comments": [{"owner": {"reputation": 546, "user_id": 2170795, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b0d51ae640bfc2c70858a258285549c5?s=128&d=identicon&r=PG", "display_name": "Phil", "link": "https://stackoverflow.com/users/2170795/phil"}, "edited": false, "score": 0, "creation_date": 1539014587, "post_id": 52636290, "comment_id": 92338638, "body": "Sorry for the very late answer. Indeed I chose 19 as minSDK. So this seems to be the reason. Thank you very much for the explanation!"}], "tags": [], "owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "is_accepted": true, "score": 2, "last_activity_date": 1538603999, "creation_date": 1538603999, "answer_id": 52636290, "question_id": 52627303, "link": "https://stackoverflow.com/questions/52627303/android-ndk-undefined-reference-to-asensoreventqueue-registersensor/52636290#52636290", "title": "Android NDK undefined reference to ASensorEventQueue_registerSensor", "body": "<p>One possibility is that you're missing a <code>find_library</code> for liblog and libandroid. Add the following before <code>target_link_libraries</code>:</p>\n\n<pre><code>find_library(android android)\nfind_library(log log)\n</code></pre>\n\n<p>However I'm not sure that's needed.</p>\n\n<p>The other possibility is that your <code>minSdkVersion</code> is lower than 26. <code>ASensorEventQueue_registerSensor</code> was not added until O, so it can't be linked unless your <code>minSdkVersion</code> is at least 26.</p>\n"}], "owner": {"reputation": 546, "user_id": 2170795, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b0d51ae640bfc2c70858a258285549c5?s=128&d=identicon&r=PG", "display_name": "Phil", "link": "https://stackoverflow.com/users/2170795/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 52636290, "answer_count": 1, "score": 1, "last_activity_date": 1539019652, "creation_date": 1538570552, "last_edit_date": 1539019652, "question_id": 52627303, "link": "https://stackoverflow.com/questions/52627303/android-ndk-undefined-reference-to-asensoreventqueue-registersensor", "title": "Android NDK undefined reference to ASensorEventQueue_registerSensor", "body": "<p>I try to register a sensor via NDK and it works until I try to use ASensorEventQueue_registerSensor. I do it like in the following code:</p>\n\n<pre><code>#include &lt;android/sensor.h&gt;\n[...]\nauto status = ASensorEventQueue_registerSensor(accelerometerEventQueue, accelerometer, SENSOR_REFRESH_PERIOD_US,SENSOR_BATCH_REPORT_TIME);\n[...]\n</code></pre>\n\n<p>My CMakeLists.txt looks like</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.4.1)\n\nadd_library( # Sets the name of the library.\n             native-lib\n\n             # Sets the library as a shared library.\n             SHARED\n\n             # Provides a relative path to your source file(s).\n             src/main/cpp/native-lib.cpp )\n\n\ntarget_link_libraries( # Specifies the target library.\n                       native-lib\n                       android\n                       log)\n</code></pre>\n\n<p>I can use functions like <code>ASensorEventQueue_enableSensor</code>or <code>ASensorEventQueue_setEventRate</code> but I am not able to run the app when using <code>ASensorEventQueue_registerSensor</code> due to undefined reference error.</p>\n\n<p>By the way I can see the function in the included header file so this shouldn't be the problem. Does anyone have an idea how to fix this issue?</p>\n"}, {"tags": ["c++", "class", "oop", "constructor"], "comments": [{"owner": {"reputation": 20994, "user_id": 2170192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JsKlq.png?s=128&g=1", "display_name": "Alex Shesterov", "link": "https://stackoverflow.com/users/2170192/alex-shesterov"}, "edited": false, "score": 3, "creation_date": 1538570279, "post_id": 52627164, "comment_id": 92187750, "body": "<code>className ABC();</code> declares a function pointer. Use <code>className ABC;</code> to create a local object. And a method named <code>constructor</code> isn&#39;t a constructor."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1538570390, "post_id": 52627164, "comment_id": 92187840, "body": "Also the constructor is a function with the same name as the class, like <code>className() { ...</code> not a method named constructor."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 20994, "user_id": 2170192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JsKlq.png?s=128&g=1", "display_name": "Alex Shesterov", "link": "https://stackoverflow.com/users/2170192/alex-shesterov"}, "edited": false, "score": 1, "creation_date": 1538570396, "post_id": 52627164, "comment_id": 92187847, "body": "@AlexShesterov It does not declare a function pointer."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1538570476, "post_id": 52627164, "comment_id": 92187902, "body": "Such example <a href=\"https://wandbox.org/permlink/lTF1vJYruVQebH7i\" rel=\"nofollow noreferrer\">didn&#39;t compile</a> for me."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1538570535, "post_id": 52627164, "comment_id": 92187939, "body": "@Swordfish <a href=\"https://stackoverflow.com/questions/1424510/my-attempt-at-value-initialization-is-interpreted-as-a-function-declaration-and\" title=\"my attempt at value initialization is interpreted as a function declaration and\">stackoverflow.com/questions/1424510/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1538570612, "post_id": 52627164, "comment_id": 92187991, "body": "@AlgirdasPreid\u017eius <code>className ABC();</code> DOES NOT declare a function pointer.` No links you throw at me change that fact."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1538570655, "post_id": 52627164, "comment_id": 92188018, "body": "@Swordfish - Correct, it declares a function."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1538570735, "post_id": 52627164, "comment_id": 92188079, "body": "Does not compile on Ubuntu, g++v7.3:  error: ISO C++ forbids declaration of \u2018constructor\u2019 with no type [-fpermissive]     for line  &quot;constructor()...&quot;;  Also, the code requires a &#39;;&#39; after class definition."}, {"owner": {"reputation": 20994, "user_id": 2170192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JsKlq.png?s=128&g=1", "display_name": "Alex Shesterov", "link": "https://stackoverflow.com/users/2170192/alex-shesterov"}, "edited": false, "score": 0, "creation_date": 1538572168, "post_id": 52627164, "comment_id": 92189026, "body": "my bad, it declares a function."}], "answers": [{"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 1, "last_activity_date": 1538570386, "creation_date": 1538570386, "answer_id": 52627246, "question_id": 52627164, "link": "https://stackoverflow.com/questions/52627164/c-classname-function/52627246#52627246", "title": "C++ Classname Function()", "body": "<p>Your posted code won't compile. Ignoring that there are 2 reasons it doesn't do anything.</p>\n\n<ol>\n<li><code>className ABC();</code> declares a function. To call the default constructor of a class simply omit the brackets: <code>className ABC;</code></li>\n<li><code>className</code> has a method called <code>constructor</code> but no contructor so doesn't print anything when it is constructed.</li>\n</ol>\n"}], "owner": {"reputation": 9, "user_id": 5876930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59341bea6483368e31bf2c524ea5cd7?s=128&d=identicon&r=PG&f=1", "display_name": "Anand Vardhan Singh", "link": "https://stackoverflow.com/users/5876930/anand-vardhan-singh"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "closed_date": 1538570363, "answer_count": 1, "score": -3, "last_activity_date": 1538570386, "creation_date": 1538570101, "question_id": 52627164, "link": "https://stackoverflow.com/questions/52627164/c-classname-function", "closed_reason": "Duplicate", "title": "C++ Classname Function()", "body": "<p>I was recently giving an online quiz on c++ and a question came that had similar syntax as</p>\n\n<pre><code>class className\n{\n     public:\n     constructor()\n     {\n         print(\"ABC\");\n     }\n}\n\nint main()\n{\n    className ABC();\n    return 0;\n}\n</code></pre>\n\n<p>I thought it would not compile but rather it compiled and ran without having any effect, I am interested as to what feature this is and in which case do we use this?</p>\n"}, {"tags": ["c++", "codeblocks", "sfml"], "comments": [{"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 2, "creation_date": 1538570149, "post_id": 52627153, "comment_id": 92187652, "body": "Are you mixing code that was compiled with/without C++14 enabled?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1538570153, "post_id": 52627153, "comment_id": 92187655, "body": "Are you sure you&#39;re linking to a lib that&#39;s been compiled with your C++14 compiler?"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 2, "creation_date": 1538570216, "post_id": 52627153, "comment_id": 92187696, "body": "What you mean &quot;changing to have the compiler follow c++14 standards&quot;? Did you just add <code>-std=c++14</code> to a build that works without it? Or is it an entirely new system with fresh libraries, etc.?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1538570262, "post_id": 52627153, "comment_id": 92187736, "body": "What <i>exactly</i> did you change?"}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "edited": false, "score": 0, "creation_date": 1538570467, "post_id": 52627153, "comment_id": 92187898, "body": "Previously I thought i had the compiler set to follow C++14 standards, apparently not, i never realised, The project compiled and built fine day to day, but i have no idea what standard i was actually following?, i wish i knew, or could just rollback to a last working state a day, to get back on track with developement. thanks everyone for the feedback"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1538570513, "post_id": 52627153, "comment_id": 92187924, "body": "I&#39;d guess it&#39;s the __cxx11: <a href=\"https://stackoverflow.com/a/33395489\">stackoverflow.com/a/33395489</a>"}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "edited": false, "score": 0, "creation_date": 1538570695, "post_id": 52627153, "comment_id": 92188043, "body": "It couldnt have been c++11 because ive used keyword auto multiple times in the project, it must be SFML ?"}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "edited": false, "score": 0, "creation_date": 1538570827, "post_id": 52627153, "comment_id": 92188142, "body": "is SFML 2.4 compatable with C++14, is that the issue do you think ? im asking as genuine as i can because i honestly dont know."}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1538571270, "post_id": 52627153, "comment_id": 92188440, "body": "@Paul Floyd Thanks for the edit and enlightening me about the error."}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1538571378, "post_id": 52627153, "comment_id": 92188508, "body": "@NathanOliver did most of the editing."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1538571587, "post_id": 52627153, "comment_id": 92188636, "body": "Your library and program are linked against two different versions of the standard library. Are you using different compilers for each, or are you on a mac, updated xcode, and have not recompiled the library?"}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1538571626, "post_id": 52627153, "comment_id": 92188666, "body": "@FireLancer I defaulted the compiler just in case, and the option Have g++ follow C++ 14 is a valid choice, if i understood that correctly, my apologies if not."}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1538571808, "post_id": 52627153, "comment_id": 92188788, "body": "@RichardHodges If understood correctly I am using Windows 10, Mingw GCC. What do you mean by 2 different versions of the standard libary ? you may be right and i may not be aware of that."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1538572229, "post_id": 52627153, "comment_id": 92189058, "body": "@S_BISHOP C++11 supports &quot;auto&quot;. The SMFL library you have on your machine is not built/supported by C++14, that&#39;s where the errors comes from. Please also start using source code managment (e.g. git) so you can at least roll back your own project to whatever worked before you changed something."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1538572401, "post_id": 52627153, "comment_id": 92189171, "body": "@S_BISHOP there are 3 common versions of the C++ standard library. Windows, libc++ and libstdc++. In addition, these libraries changed semantically in the transition between c++03 and c++11. All libraries in an application must be compiled with the same library and (ideally) against the same standard. In particular, compiling c++11 programs against a library compiled in c++03 is asking for trouble."}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1538572606, "post_id": 52627153, "comment_id": 92189295, "body": "@nos Thanks, and noted must use version control."}, {"owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1538573245, "post_id": 52627153, "comment_id": 92189723, "body": "@nos   &quot;The SMFL library you have on your machine is not built/supported by C++14, that&#39;s where the errors comes from.&quot; If thats honestly the entirety of the error source i am going to be so happy. I now understand and am aware of that dependency thanks."}], "answers": [{"tags": [], "owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "is_accepted": false, "score": 3, "last_activity_date": 1538571854, "creation_date": 1538571854, "answer_id": 52627694, "question_id": 52627153, "link": "https://stackoverflow.com/questions/52627153/compiler-now-following-c14-standards-my-project-no-longer-compiles-cryptic/52627694#52627694", "title": "compiler now following C++14 standards, my project no longer compiles ? cryptic SFML errors (s)", "body": "<p>Try adding <code>-DGLIBCXX_USE_CXX11_ABI=0</code> to your compiler switches (not sure how to do that with CodeBlocks).</p>\n\n<p>See details <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://stackoverflow.com/questions/45417707/glibcxx-use-cxx11-abi-gcc-4-8-and-abi-compatibility\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": false, "score": 2, "last_activity_date": 1538572344, "creation_date": 1538572344, "answer_id": 52627857, "question_id": 52627153, "link": "https://stackoverflow.com/questions/52627153/compiler-now-following-c14-standards-my-project-no-longer-compiles-cryptic/52627857#52627857", "title": "compiler now following C++14 standards, my project no longer compiles ? cryptic SFML errors (s)", "body": "<p>An undefined reference could be a compiler version or config incompatibility between when SFML was compiled and you compiling your project now. If you downloaded a binary build of SFML it should say exactly which compiler and version it works with. If you built SFML from source, then simply rebuilding it with your current compiler configuration should fix it.</p>\n\n<p>Generally adding <code>-std=c++14</code> or such works (on the exact same compiler with the same standard library), but there are edge cases such as when a library uses typedefs or functions protected by macros to use newer types in the interface when available. And if the compiler or library versions changed then there are many more considerations.</p>\n"}], "owner": {"reputation": 31, "user_id": 1887066, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e04fae863c4d61ee3e3c5899253ecc82?s=128&d=identicon&r=PG", "display_name": "S_BISHOP", "link": "https://stackoverflow.com/users/1887066/s-bishop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1538572344, "creation_date": 1538570066, "last_edit_date": 1538570352, "question_id": 52627153, "link": "https://stackoverflow.com/questions/52627153/compiler-now-following-c14-standards-my-project-no-longer-compiles-cryptic", "title": "compiler now following C++14 standards, my project no longer compiles ? cryptic SFML errors (s)", "body": "<p>What do these errors mean? after having worked on a project a very long time 2+ years, and then changing to have the compiler follow c++14 standards, my project now does not compile and now I'm left anxious not knowing. </p>\n\n<p>the error(s):</p>\n\n<pre><code>undefined reference to `_imp___ZN2sf7Texture12loadFromFileERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKNS_4RectIiEE'|\n</code></pre>\n\n<p>Demangled that is</p>\n\n<pre><code>_imp__sf::Texture::loadFromFile(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, sf::Rect&lt;int&gt; const&amp;)\n</code></pre>\n\n<p>My compiler Settings</p>\n\n<p>Have g++ follow C++ 14</p>\n\n<pre><code>Linker Settings:  (the dependencies order SFML requires)  sfml-graphics  \n                  sfml-window\n                  sfml-system\n                  sfml-audio\n\nCompiler: C:\\CodeBlocks\\SFML-2.4.2\\include\nLinker:   C:\\CodeBlocks\\SFML-2.4.2\\lib\n</code></pre>\n"}, {"tags": ["c++", "g++", "one-definition-rule"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1538572468, "post_id": 52627146, "comment_id": 92189203, "body": "Please before asking such questions compile with <code>-Wall -Wextra -Werror -pedantic</code>."}, {"owner": {"reputation": 866, "user_id": 1608468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae275ae74371f0f24d369948a12ac197?s=128&d=identicon&r=PG", "display_name": "tomsmeding", "link": "https://stackoverflow.com/users/1608468/tomsmeding"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1538580542, "post_id": 52627146, "comment_id": 92194625, "body": "@YSC I agree, and I had (well, without the Werror). However, doing so generates no output. Only enabling LTO, as Florian Weimer suggested, produces warnings."}], "answers": [{"comments": [{"owner": {"reputation": 866, "user_id": 1608468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae275ae74371f0f24d369948a12ac197?s=128&d=identicon&r=PG", "display_name": "tomsmeding", "link": "https://stackoverflow.com/users/1608468/tomsmeding"}, "edited": false, "score": 0, "creation_date": 1538571030, "post_id": 52627202, "comment_id": 92188269, "body": "Yes, that&#39;s it. In the <a href=\"http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/n4659.pdf\" rel=\"nofollow noreferrer\">standard</a> paragraph 6.2.6, it is indeed stated that different types need to have different names, even if they are in different translation units. I never realised this was a problem, and thought translation units provided namespace-like separation. Thanks for the answer!"}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 4, "last_activity_date": 1538570211, "creation_date": 1538570211, "answer_id": 52627202, "question_id": 52627146, "link": "https://stackoverflow.com/questions/52627146/odr-use-question-priority-queue-of-identically-named-structs-in-different-file/52627202#52627202", "title": "(ODR-use question) priority_queue of identically named structs in different files", "body": "<p>You have violated the One Definition Rule, so your program has undefined behavior.</p>\n\n<p>To fix it,  you can put one or both structs into a namespace to make them unique.  If they are not needed outside their own .cpp files, you can put them each into an anonymous namespace.</p>\n"}, {"comments": [{"owner": {"reputation": 866, "user_id": 1608468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae275ae74371f0f24d369948a12ac197?s=128&d=identicon&r=PG", "display_name": "tomsmeding", "link": "https://stackoverflow.com/users/1608468/tomsmeding"}, "edited": false, "score": 0, "creation_date": 1538570948, "post_id": 52627353, "comment_id": 92188211, "body": "Thanks, I knew about LTO but not that it can diagnose things like this very well."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1538622014, "last_edit_date": 1538622014, "creation_date": 1538570724, "answer_id": 52627353, "question_id": 52627146, "link": "https://stackoverflow.com/questions/52627146/odr-use-question-priority-queue-of-identically-named-structs-in-different-file/52627353#52627353", "title": "(ODR-use question) priority_queue of identically named structs in different files", "body": "<p>As <a href=\"https://stackoverflow.com/a/52627202/8316315\">John Zwinck said</a>, this is an ODR violation.  You can use <code>-flto</code> to diagnose such violations:</p>\n\n<pre><code>$ g++ -O2 -flto a.cpp b.cpp \na.cpp:3:8: warning: type 'struct Event' violates the C++ One Definition Rule [-Wodr]\n struct Event {\n        ^\nb.cpp:3:8: note: a different type is defined in another translation unit\n struct Event {\n        ^\nb.cpp:4:12: note: the first difference of corresponding definitions is field 'b'\n     int a, b;\n            ^\nb.cpp:3:8: note: a type with different number of fields is defined in another translation unit\n struct Event {\n        ^\n</code></pre>\n"}], "owner": {"reputation": 866, "user_id": 1608468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae275ae74371f0f24d369948a12ac197?s=128&d=identicon&r=PG", "display_name": "tomsmeding", "link": "https://stackoverflow.com/users/1608468/tomsmeding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52627202, "answer_count": 2, "score": 1, "last_activity_date": 1538622014, "creation_date": 1538570046, "last_edit_date": 1538571077, "question_id": 52627146, "link": "https://stackoverflow.com/questions/52627146/odr-use-question-priority-queue-of-identically-named-structs-in-different-file", "title": "(ODR-use question) priority_queue of identically named structs in different files", "body": "<p>Consider the following files:</p>\n\n<p><code>a.cpp</code>:</p>\n\n<pre><code>#include &lt;queue&gt;\n\nstruct Event {  \n    int a;\n};\n\nstatic bool operator&lt;(const Event &amp;a, const Event &amp;b) {\n    return a.a &lt; b.a;\n}\n\nvoid external_insert(std::priority_queue&lt;Event&gt; &amp;pqu, Event event) {\n    pqu.push(event);\n}\n\nint main() {\n    // fails\n    std::priority_queue&lt;Event&gt; pqu;\n    external_insert(pqu, Event());\n\n    // works\n    // std::priority_queue&lt;Event&gt; pqu;\n    // pqu.push(Event());\n    return 0;\n}\n</code></pre>\n\n<p><code>b.cpp</code>:</p>\n\n<pre><code>#include &lt;queue&gt;\n\nstruct Event {\n    int a, b;\n};\n\nstatic bool operator&lt;(const Event &amp;a, const Event &amp;b) {\n    return a.a &lt; b.a;\n}\n\nvoid some_unused_function() {\n    std::priority_queue&lt;Event&gt; evqu;\n    evqu.push(Event());\n}\n</code></pre>\n\n<p>Then compile these two files to two executables using:</p>\n\n<pre><code>g++ a.cpp b.cpp -o ab\ng++ b.cpp a.cpp -o ba\n</code></pre>\n\n<p>And then run both under valgrind:</p>\n\n<pre><code>valgrind ./ab\n# ... ERROR SUMMARY: 0 errors from 0 contexts ...\nvalgrind ./ba\n# ... ERROR SUMMARY: 2 errors from 2 contexts ...\n</code></pre>\n\n<p>The exact output from valgrind for the two programs can be found in <a href=\"https://gist.github.com/tomsmeding/ff4e77f181ff6d87c5bcf03531701435\" rel=\"nofollow noreferrer\">this gist</a>.</p>\n\n<p>No errors occur when doing either of the following things:</p>\n\n<ul>\n<li>Replacing \"Event\" with any other name in one of the two files</li>\n<li>Making both structs the same size</li>\n<li>Choosing the second set of two lines in <code>main()</code> instead of the first</li>\n<li>Replacing the use of <code>priority_queue</code> with <code>vector</code>, and using <code>push_back</code> instead of <code>push</code></li>\n</ul>\n\n<p>I'm inclined to believe this is an issue in the compiler (compiler bug?) where the naming for the template-instantated methods for the two versions of <code>priority_queue</code> conflict with each other.</p>\n\n<p>Is this a known issue, is this a new bug, or am I missing something?</p>\n"}, {"tags": ["c++", "matrix", "linear-algebra", "armadillo"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10316011"}, "edited": false, "score": 1, "creation_date": 1538590667, "post_id": 52627384, "comment_id": 92199948, "body": "the armadillo library uses LAPACK to do its heavy lifting (&quot;Various matrix decompositions are provided through integration with LAPACK&quot;) and that will not work with a c++ custom type, so this approach will not with this library"}, {"owner": {"reputation": 2451, "user_id": 3493433, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Rv0Vj.jpg?s=128&g=1", "display_name": "Valentin Montmirail", "link": "https://stackoverflow.com/users/3493433/valentin-montmirail"}, "edited": false, "score": 0, "creation_date": 1538661704, "post_id": 52627384, "comment_id": 92229168, "body": "I did what you proposed, but now I have another problem in my own LU decomposition modulo 5. I asked another question here: <a href=\"https://stackoverflow.com/questions/52648687/linear-combination-c-in-modulus\" title=\"linear combination c in modulus\">stackoverflow.com/questions/52648687/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1395, "user_id": 3808426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6388b9d4ea9d6e02525fa212aa9d817d?s=128&d=identicon&r=PG&f=1", "display_name": "Demosthenes", "link": "https://stackoverflow.com/users/3808426/demosthenes"}, "is_accepted": false, "score": 1, "last_activity_date": 1538570851, "creation_date": 1538570851, "answer_id": 52627384, "question_id": 52627048, "link": "https://stackoverflow.com/questions/52627048/armadillo-c-linear-combination-with-modulus-calculations/52627384#52627384", "title": "Armadillo C++ : Linear Combination with modulus calculations", "body": "<p>First of all: drop the <code>using namespace</code>s, code can become completely unreadable if you do that.</p>\n\n<p>I haven't used Armadillo yet. But I have looked at the documentation, and it seems templated to me.</p>\n\n<p>Now things are getting a bit wild. The type you use, <code>arma::mat</code> seems to be a typedef on <code>arma::Mat&lt;double&gt;</code>. </p>\n\n<p>The high-level function <code>arma::lu</code> isn't properly documented. It obviously does an LU-decomposition, but I don't know if the function is templated. If it is, i.e., you cannot just call it with <code>double</code> mats but also other types, you might have a shot using a custom type representing the field (since 5 is prime, otherwise you'd be completely lost) of calculations modulo 5. Meaning you write a class, let's call it <code>IntMod5</code> and define all required operators for this class, meaning all operators that IntMod5 uses. For example, you'd need to define <code>operator/()</code>, e.g. by making a table of inverses of 4 of the 5 elements of the field (0 has none), i.e. 1->1, 2->3, 3->2, 4->4, and define</p>\n\n<pre><code>IntMod5 operator/(const IntMod5&amp; o) const\n{\n    return IntMod5((this-&gt;value*inverse(o.value))%5);\n}\n</code></pre>\n\n<p>This is just one example, you likely need to define all arithmetic operators, binary and unary, and possibly more such as comparison (LU decomposition might use finding good pivot elements). If you're lucky and the library is written in a way that it works for any field, not just floating point, you have a chance.</p>\n\n<p>Before you go through all the work, you should use a trivial class simply wrapping double and check if <code>arma::Mat</code> or <code>arma::lu</code> do any type checks blocking you out.</p>\n\n<p>If either of these fails, you'll likely have to write your own LU decomposition modulo 5 or find another library that supports it.  </p>\n"}], "owner": {"reputation": 2451, "user_id": 3493433, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Rv0Vj.jpg?s=128&g=1", "display_name": "Valentin Montmirail", "link": "https://stackoverflow.com/users/3493433/valentin-montmirail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1564492121, "creation_date": 1538569712, "last_edit_date": 1564492121, "question_id": 52627048, "link": "https://stackoverflow.com/questions/52627048/armadillo-c-linear-combination-with-modulus-calculations", "title": "Armadillo C++ : Linear Combination with modulus calculations", "body": "<p>I want to extract linear combinations from matrices but by performing combinations in modulus.</p>\n\n<p>Let us consider the calculation modulus 5, we then have the following for the addition:</p>\n\n<pre><code> + |  0 1 2 3 4\n --+-----------\n 0 | 0 1 2 3 4\n 1 | 1 2 3 4 0\n 2 | 2 3 4 0 1\n 3 | 3 4 0 1 2 \n 4 | 4 0 1 2 3\n</code></pre>\n\n<p>and this table for the multiplication:</p>\n\n<pre><code> * | 0 1 2 3 4\n --+-----------\n 0 | 0 0 0 0 0\n 1 | 0 1 2 3 4\n 2 | 0 2 4 1 3\n 3 | 0 3 1 4 2\n 4 | 0 4 3 2 1\n</code></pre>\n\n<p>So let us take an example:\nLet us consider the following matrix:</p>\n\n<pre><code>E = 2 1 3 2 0\n    4 3 0 1 1\n</code></pre>\n\n<p>Then we can obtain the triangulation matrix by applying a LU decomposition (<a href=\"https://en.wikipedia.org/wiki/LU_decomposition\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/LU_decomposition</a>) (or a Gaussian Elimination), which is the following:</p>\n\n<pre><code>T = 1 0 0 0 0 \n    2 1 0 0 0 \n</code></pre>\n\n<p>and finally, the matrix that I want to extract, which is the one storing the linear combinations:</p>\n\n<pre><code>CL = 3 2 3 0 3\n     0 1 1 3 4\n     0 0 1 0 0 \n     0 0 0 1 0\n     0 0 0 0 1\n</code></pre>\n\n<p>So basically, the algorithm should work as follows:</p>\n\n<pre><code> Input: a matrix E with n rows and m columns, and p, a prime number.\n\n * We perform a Gaussian elimination/LU decomposition to obtain the lower-triangulation matrix T. \n   But all the calculus are done modulo 'p'. \n\n Output: T (with the same size as E, n rows m columns). \n         CL (with a size m rows, m columns), \n         which is basically the identity matrix on which we \n         applied all the modifications that were performed on E to obtain T.\n</code></pre>\n\n<hr>\n\n<p>Alright, so now we have the context, let me explain the problem. \nI started to do it using the Armadillo library (<a href=\"http://arma.sourceforge.net/\" rel=\"nofollow noreferrer\">http://arma.sourceforge.net/</a>), but I did not find any solution on the library to perform the calculus on a mathematical Field p. I easily found the <code>LU</code> method to obtain the lower-triangle matrix, but the calculations are performed in the real.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;armadillo&gt;\n\nusing namespace arma;\nusing namespace std;\n\nint main(int argc,char** argv)\n{\n\n    mat A = mat({{2,1,3,2,0},{4,3,0,1,1}});\n\n    mat L, U, P;\n\n    lu(L, U, P, A);\n\n    cout &lt;&lt; L &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>With the following, you obtain the lower-triangle matrix 'L' but in the real calculus. Thus you obtain:</p>\n\n<pre><code> T' =  1   0\n       1/2 1\n</code></pre>\n\n<p><strong>Is there any technique to perform the computation in a modulus way?</strong></p>\n\n<p><strong>EDIT</strong> The Armadillo library is not able to do it. I developed my own LU decomposition in modulus but there is still a bug there. I asked a new question here <a href=\"https://stackoverflow.com/questions/52648687/linear-combination-c-in-modulus\">Linear Combination C++ in modulus</a>, hoping to solve it.</p>\n"}, {"tags": ["c++", "floating-point", "bitset"], "answers": [{"comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1538568494, "post_id": 52626672, "comment_id": 92186597, "body": "Note though that will only work on systems using that format for floats which is <i>not guaranteed</i> (maybe endianness, maybe just different formats entirely). If you need to support other systems, an actual conversion will be needed."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1538568608, "post_id": 52626672, "comment_id": 92186654, "body": "@FireLancer I don&#39;t think you&#39;re correct. The intermediate <code>ulong</code> will simply store whatever the bitset had, and we already know it&#39;s in IEEE754."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1538568650, "post_id": 52626672, "comment_id": 92186679, "body": "@BartekBanachewicz And if the system the code is running on is <i>not</i> IEEE754, then the result <code>float</code> or <code>double</code> you <code>memcpy</code> into will not have the expected value."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538568784, "post_id": 52626672, "comment_id": 92186770, "body": "Right, that&#39;s true."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 5, "last_activity_date": 1538568321, "creation_date": 1538568321, "answer_id": 52626672, "question_id": 52626555, "link": "https://stackoverflow.com/questions/52626555/bitset-to-float-or-double-value-c/52626672#52626672", "title": "Bitset to float or double value c++", "body": "<p>Use <code>bitset::to_ullong()</code> and <code>memcpy()</code> the bits.</p>\n"}, {"comments": [{"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1538580347, "post_id": 52628717, "comment_id": 92194499, "body": "<code>is_iec559</code> is not a generally useful indicator. <code>is_iec559</code> should be true if the type, including arithmetic and other behaviors, conforms to IEC 60559/IEEE 754. However, many C++ implementations use IEEE-754 formats but do not conform to its arithmetic requirements and hence do not set <code>is_iec559</code>. So <code>is_iec559</code> is not useful as an indicator of whether an IEEE-754 format is in use."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1538581048, "post_id": 52628717, "comment_id": 92194946, "body": "@EricPostpischil Yeah... the key point though is that floating points which are <i>not</i> IEEE 754 <i>never</i> set this though. I was going to work through demonstrating how you could extract the bits to reformulate a floating point that was not IEEE 754 compliant... but then I realized probably no one will ever look at this answer so there&#39;s little reason to expand it beyond the most simplistic use case."}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 0, "last_activity_date": 1538575397, "last_edit_date": 1538575397, "creation_date": 1538575076, "answer_id": 52628717, "question_id": 52626555, "link": "https://stackoverflow.com/questions/52626555/bitset-to-float-or-double-value-c/52628717#52628717", "title": "Bitset to float or double value c++", "body": "<p>First off, one does not simply represent a <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">IEEE 754 floating point</a>. There is a lot that goes into such a representation. Let's say that you're given a <code>bitset</code> variable: <code>param</code> and you want to convert it to a <code>float</code>. To guarantee this is a valid conversion you'll need to ensure:</p>\n\n<ul>\n<li><code>param.size() == sizeof(float) * CHAR_BIT</code></li>\n<li>The <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a> from which <code>param</code> was encoded matches <code>endian::native</code></li>\n<li><code>numeric_limits&lt;float&gt;::is_iec559</code> is true</li>\n<li>The radix with which <code>param</code> was encoded matches <code>numeric_limits&lt;float&gt;::radix</code></li>\n</ul>\n\n<p>If all these are true then effectively these bits are in the format of your internal floating point representation, and you can convert with a simple function like this (provided that <code>sizeof(unsigned long) == sizeof(float)</code> and <code>sizeof(unsigned long long) == sizeof(double)</code>):</p>\n\n<pre><code>double foo(const bitset&lt;sizeof(double) * CHAR_BIT&gt;&amp; param) {\n    const auto val = param.to_ullong();\n    double result;\n\n    memcpy(&amp;result, &amp;val, sizeof(double));\n\n    return result;\n}\n\nfloat foo(const bitset&lt;sizeof(float) * CHAR_BIT&gt;&amp; param) {\n    const auto val = param.to_ulong();\n    float result;\n\n    memcpy(&amp;result, &amp;val, sizeof(float));\n\n    return result;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1538581136, "creation_date": 1538581136, "answer_id": 52630845, "question_id": 52626555, "link": "https://stackoverflow.com/questions/52626555/bitset-to-float-or-double-value-c/52630845#52630845", "title": "Bitset to float or double value c++", "body": "<p>Here is a solution that does not rely on the C++ implementation using IEEE-754 types.</p>\n\n<p>Let <code>s</code> be the first bit of the bitset.</p>\n\n<p>Let <code>e</code> be the next 8 or 11 bits for 32-bit or 64-bit, respectively.</p>\n\n<p>Let <code>f</code> be the remaining 23 or 52 bits, respectively.</p>\n\n<p>Let <code>Ebias</code> be 127 or 1023, respectively.</p>\n\n<p>Let <code>Emax</code> be 255 or 2047, respectively.</p>\n\n<p>Let <code>Fscale</code> be 0x1p-23 or 0x1p-52, respectively.</p>\n\n<p>Then this code returns the value of the bitset interpreted as an IEEE-754 basic binary floating-point object:</p>\n\n<pre><code>// Interpret the sign.\ndouble S = s ? -1 : +1;\n\n// Classify the exponent.\nif (e == 0)\n    // The value is zero or subnormal.\n    return S * std::ldexp(f*Fscale, 1-Ebias);\n\nelse if (e &lt; eMax)\n    // The value is normal.\n    return S * std::ldexp(1 + f*Fscale, e-Ebias);\n\nelse\n    // The value is NaN or infinite.\n    if (f == 0)\n        // The value is infinite.\n        return S * INFINITY;\n    else\n        // The value is a NaN.\n        return NAN;\n</code></pre>\n\n<p>This does not set all the bits in the NAN (including the sign bit) to match the exact bits in the bitset. There is no portable way to do that; it would typically have to be done by copying the bits into <code>float</code> or <code>double</code> object using <code>memcpy</code> or other copying via a character type, and it requires that the C++ implementation be using a <code>float</code> or <code>double</code> type that is IEEE-754. And, of course, the above requires that the C++ implementation support <code>NAN</code> and <code>INFINITY</code>, and that the the floating-point type in the C++ implementation be capable of representing the value.</p>\n"}], "owner": {"reputation": 31, "user_id": 10448031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d374bcd1ca882e0caf2ee6d86a77a8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/10448031/nikolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1538581136, "creation_date": 1538567899, "question_id": 52626555, "link": "https://stackoverflow.com/questions/52626555/bitset-to-float-or-double-value-c", "title": "Bitset to float or double value c++", "body": "<p>I have two IEEE754 binary representation bitsets of float(32bit) and double (64bit).\nHow I can convert this bitsets to REAL float or double number?</p>\n"}, {"tags": ["c++", "macos", "serial-port", "boost-asio", "macos-mojave"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1538573693, "post_id": 52626546, "comment_id": 92190037, "body": "You know there&#39;s a bug in Boost.asio, so you want to know how to work around that? You need to compare the actual system calls being made when <code>screen</code> writes to the device, and when Boost.asio writes to the device. You can run them both under <code>strace</code> for a start, and turn up detailed logging of buffer contents, ioctl calls, etc."}, {"owner": {"reputation": 969, "user_id": 2928544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yeaGD.jpg?s=128&g=1", "display_name": "raidensan", "link": "https://stackoverflow.com/users/2928544/raidensan"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1538638312, "post_id": 52626546, "comment_id": 92214963, "body": "@Useless I don&#39;t know if there is a bug as there is no evidence provided at linked file. My web search did not result in any open bug issue either."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1538644756, "post_id": 52626546, "comment_id": 92218567, "body": "<b>You</b> quoted a file saying <i>boost asio&#39;s serial ports have bugs</i>. And, I&#39;ve told you how to see what screen is doing differently."}], "owner": {"reputation": 969, "user_id": 2928544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yeaGD.jpg?s=128&g=1", "display_name": "raidensan", "link": "https://stackoverflow.com/users/2928544/raidensan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 589, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538638633, "creation_date": 1538567879, "last_edit_date": 1538638633, "question_id": 52626546, "link": "https://stackoverflow.com/questions/52626546/issue-while-writing-to-serial-port-on-macos", "title": "Issue while writing to serial port on MacOS", "body": "<p><strong>Background</strong></p>\n\n<p>I am trying to write/print to a serial port on MacOS Mojave. Serial port is connected to a thermal printer with ESC/POS emulation. I have used <code>boost::asio::serial_port</code> from <code>boost 1.67.0</code> for this task. See the following code:</p>\n\n<pre><code>#define SUCCESS 0\n#define FAIL -1\n\n#include &lt;string&gt;\n#include &lt;cstdio&gt;\n#include &lt;iostream&gt;\n#include &lt;boost/asio.hpp&gt;\n#include &lt;boost/asio/serial_port.hpp&gt;\n\nint main(int argc, char *argv[]){\n\n    boost::system::error_code ec;\n    boost::asio::io_service io;\n    boost::asio::serial_port port( io );\n\n    std::string portname=\"/dev/tty.usbserial-12\";\n\n    try{\n        port.open(portname.c_str(), ec);\n\n        if (ec) {\n            std::cout &lt;&lt; \"error : port.open() failed... portname=\" &lt;&lt; portname &lt;&lt; \", e=\" &lt;&lt; ec.message().c_str() &lt;&lt; std::endl; \n            return FAIL;\n        }\n        port.set_option( boost::asio::serial_port_base::baud_rate( 19200 ) );\n\n        unsigned char init[2] = { 27, 64 };\n        unsigned char hello[6] = { 'h', 'e', 'l', 'l', 'o', '\\0'};\n        unsigned char cut[2] = { 29, 86 };\n\n        boost::asio::write(port, boost::asio::buffer(init, sizeof(init)));\n        boost::asio::write(port, boost::asio::buffer(hello, sizeof(hello)));\n        boost::asio::write(port, boost::asio::buffer(cut, sizeof(cut)));\n\n        port.close();\n        return SUCCESS;\n    }catch(...){\n        return FAIL;\n    }\n}\n</code></pre>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>I tried to use FileDescriptor as in the following snippet:</p>\n\n<pre><code>int fd; //Descriptor for the port\nfd = open(\"/dev/tty.usbserial-12\", O_RDWR | O_NOCTTY | O_NDELAY);\nif (fd == -1) {\n    std::cout &lt;&lt; \"Unable to open port. \\n\";\n    return FAIL;\n}\n\nstruct termios options;\n\ntcgetattr(fd, &amp;options);\ncfsetispeed(&amp;options, B19200);\ncfsetospeed(&amp;options, B19200);\n\noptions.c_cflag &amp;= ~PARENB;\noptions.c_cflag &amp;= ~CSTOPB;\noptions.c_cflag &amp;= ~CSIZE;\noptions.c_oflag &amp;= ~OPOST;\noptions.c_cflag |= CS8;\noptions.c_cflag |= (CLOCAL | CREAD);\ntcsetattr(fd, TCSANOW, &amp;options);\n\nstd::cout &lt;&lt; \"Port configured.\\n\";\n\nunsigned char init[2] = { 27, 64 };\nunsigned char hello[6] = { 'h', 'e', 'l', 'l', 'o', '\\0'};\nunsigned char cut[2] = { 29, 86};\n\nint rv = FAIL;\n\nrv = write(fd, init, 2);\nif(rv&lt;SUCCESS){\n    std::cout &lt;&lt; \"could not write\" &lt;&lt; std::endl;\n    return FAIL;\n}\n\nrv = write(fd, \"hello\\n\", 6);\nif(rv&lt;SUCCESS){\n    std::cout &lt;&lt; \"could not write\" &lt;&lt; std::endl;\n    return FAIL;\n}\n\nrv = write(fd, cut, 2);\nif(rv&lt;SUCCESS){\n    std::cout &lt;&lt; \"could not write\" &lt;&lt; std::endl;\n    return FAIL;\n}\n\nstd::cout &lt;&lt; \"closing FD\" &lt;&lt; std::endl;\nclose(fd);\nreturn SUCCESS;\n</code></pre>\n\n<p>Console output of previous snippet:</p>\n\n<pre><code>Port configured.\nclosing FD\n</code></pre>\n\n<p>Unfortunately, <em>there is no error and no output at device side</em>.</p>\n\n<p><strong>EDIT 1 END</strong></p>\n\n<p>I can confirm that MacOS picks up connected serial port by checking output of <code>ls /dev/tty.usbserial*</code> and <code>ls /dev/cu.usbserial*</code> before and after connecting it to my Mac. </p>\n\n<p>Also, if I run <code>screen /dev/tty.usbserial-12 19200</code> then run my app I get an error stating that <code>resource busy</code>.</p>\n\n<p>While searching online I came across a <a href=\"https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=7&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjB1c3fmOrdAhUHWSwKHZaTCKUQFjAGegQIARAB&amp;url=http%3A%2F%2Fmicrofluidics.utoronto.ca%2Ftrac%2Fdropbot%2Fexport%2F8394ef23b9b9c60bd9df913ce9b49c4f133efc5e%2Fdmf_control_board_software%2FSimpleSerial.cpp&amp;usg=AOvVaw1HvS0YYWj4hV1KeqeAOemw\" rel=\"nofollow noreferrer\"><code>SimpleSerial</code></a> implementation with the following comment written at top of file:</p>\n\n<blockquote>\n  <p>IMPORTANT:\n  On Mac OS X boost asio's serial ports have bugs, and the usual implementation\n  of this class does not work. So a workaround class was written temporarily,\n  until asio (hopefully) will fix Mac compatibility for serial ports.\n  Please note that unlike said in the documentation on OS X until asio will\n  be fixed serial port <em>writes</em> are <em>not</em> asynchronous, but at least\n  asynchronous <em>read</em> works.\n  In addition the serial port open ignores the following options: parity,\n  character size, flow, stop bits, and defaults to 8N1 format.\n  I know it is bad but at least it's better than nothing.</p>\n</blockquote>\n\n<p>I tried to search online in order to confirm that there is a known bug but couldn't find a relevant one.</p>\n\n<p><strong>Issue</strong></p>\n\n<p>The code above executes without any error but, for reasons unknown to me, <em>there is no output at printer</em>. I can \"print\" using <code>screen /dev/tty.usbserial-12 19200</code>.</p>\n\n<p>Same code does work on Raspberry PI running raspbian and produces desired output at printer.</p>\n\n<p><strong>Questions</strong></p>\n\n<p>Is there anything wrong with my code? Have I missed some steps along the way? How can I resolve this issue?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1538570992, "post_id": 52626143, "comment_id": 92188242, "body": "<i>I want to place a mark</i> do you mean a check mark?"}, {"owner": {"reputation": 695, "user_id": 2526978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8879f3faf8d7b0ece063c3d127e3bc?s=128&d=identicon&r=PG", "display_name": "J C Gonzalez", "link": "https://stackoverflow.com/users/2526978/j-c-gonzalez"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1538571427, "post_id": 52626143, "comment_id": 92188533, "body": "No, sorry. I meant some small image. As an example: if I don&#39;t get a way to do it, at the end I will append an asterisk (*) to the end of the title... But I would like to have the possibility of adding any small image (a blue dot, a red diamond, a green star, ...)"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1538571628, "post_id": 52626143, "comment_id": 92188667, "body": "I see. Because a check mark is pretty easy to add. An image is already a challenge. But I am on it and I hope I would be able to give you a solution soon."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1538573509, "post_id": 52626143, "comment_id": 92189900, "body": "Please, take a look at <a href=\"https://i.stack.imgur.com/PmBzK.png\" rel=\"nofollow noreferrer\">this result</a> and let me know if it is suitable for you. If you want to adjusted it somehow, just tell me and I will do it for you. Then I will post the solution."}, {"owner": {"reputation": 695, "user_id": 2526978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8879f3faf8d7b0ece063c3d127e3bc?s=128&d=identicon&r=PG", "display_name": "J C Gonzalez", "link": "https://stackoverflow.com/users/2526978/j-c-gonzalez"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1538575874, "post_id": 52626143, "comment_id": 92191427, "body": "It looks promising! That will be suitable for me, of course!"}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1538582409, "post_id": 52630998, "comment_id": 92195704, "body": "That&#39;s a pretty comprehensive answer from such a simple starting point - excellent work!"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1538582595, "post_id": 52630998, "comment_id": 92195815, "body": "Thank you, @TobySpeight! I really appreciate it! It did seem as a straight-forward task, but I&#39;ve ended up digging in the code of three Qt classes. :) I trully hope this will spare some work for those, wanting to achieve the same effect."}, {"owner": {"reputation": 695, "user_id": 2526978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8879f3faf8d7b0ece063c3d127e3bc?s=128&d=identicon&r=PG", "display_name": "J C Gonzalez", "link": "https://stackoverflow.com/users/2526978/j-c-gonzalez"}, "edited": false, "score": 1, "creation_date": 1538638234, "post_id": 52630998, "comment_id": 92214927, "body": "This solution is simply great!! Thanks a lot for all your effort!!"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1538642638, "post_id": 52630998, "comment_id": 92217259, "body": "You got my upvote but I still have a tiny critic: You didn&#39;t edit the alt text of your image link. As my company&#39;s firewall blocks imgur.com (and I was not able to convince the admin to unblock it) I always see these <i>enter image description here</i> links. This is a bit annoying... ;-) (When I learnt HTML decades ago, this was one of the essential recommendations: always to provide an alt text for images - and this seems to be totally forgotten these days.)"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1538657950, "post_id": 52630998, "comment_id": 92226477, "body": "@Scheff, I really appreciate your critic. As a matter of fact, the [qt] tag description says: <i>We are aiming for high-quality in this tag</i>. So, as the excellence is in the details, no detail is tiny enough to be left unimproved. After your remark I&#39;ve added a description to the images on most of my answers. Later I will edit the rest of them. Thank you for reminding me that!"}], "tags": [], "owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "is_accepted": true, "score": 10, "last_activity_date": 1538656285, "last_edit_date": 1538656285, "creation_date": 1538581604, "answer_id": 52630998, "question_id": 52626143, "link": "https://stackoverflow.com/questions/52626143/how-to-add-an-icon-to-a-qgroupbox-title/52630998#52630998", "title": "How to add an icon to a QGroupBox title?", "body": "<h1>Background</h1>\n\n<p>Unfortunatelly, <code>QGroupBox</code> does not have a <code>setIcon</code> method, as <code>QPushButton</code> does.</p>\n\n<p>A possible solution could be to make <code>QGroupBox</code> checkable using <a href=\"http://doc.qt.io/qt-5/qgroupbox.html#checkable-prop\" rel=\"noreferrer\"><code>QGroupBox::setCheckable</code></a> and set a custom image as an indicator using a <a href=\"http://doc.qt.io/qt-5/stylesheet-examples.html#customizing-qgroupbox\" rel=\"noreferrer\">stylesheet</a> like this:</p>\n\n<pre><code>QGroupBox::indicator:unchecked {\n    image: url(:/images/checkbox_unchecked.png);\n}\n</code></pre>\n\n<p>However, this will make the whole group box disabled, when the checkbox is unchecked.</p>\n\n<h1>Solution</h1>\n\n<p>Having this background in mind, I would suggest you a fairly complex, but also a pretty flexible solution, consisting of the following steps:</p>\n\n<ol>\n<li><p>Subclass <a href=\"http://doc.qt.io/qt-5/qstyleoptiongroupbox.html\" rel=\"noreferrer\"><code>QStyleOptionGroupBox</code></a> and declare additional variables as public class attributes:</p>\n\n<pre><code>QPixmap pixmap;\nint offset;\nint leftSpace;\nint rightSpace;\n</code></pre>\n\n<p>These will be used for passing the decoration pixmap, as well as the placement settings, to the style.</p></li>\n<li><p>Subclass <code>QCommonStyle</code> and reimplement <a href=\"http://doc.qt.io/qt-5/qcommonstyle.html#drawComplexControl\" rel=\"noreferrer\"><code>QCommonStyle::drawComplexControl</code></a> like this:</p>\n\n<pre><code>if (const StyleOptionDecoratedGroupBox *groupBox = qstyleoption_cast&lt;const StyleOptionDecoratedGroupBox *&gt;(opt)) {\n    QRect textRect = proxy()-&gt;subControlRect(CC_GroupBox, opt, SC_GroupBoxLabel, widget);\n    QRect checkBoxRect = proxy()-&gt;subControlRect(CC_GroupBox, opt, SC_GroupBoxCheckBox, widget);\n    int decorationOffset = 0;\n    int pixmapRectWidth = 0;\n    int pixmapHeight = 0;\n    int textOffset = 0;\n\n    if (!groupBox-&gt;pixmap.isNull()) {\n        decorationOffset = groupBox-&gt;offset;\n        pixmapRectWidth = groupBox-&gt;leftSpace\n                        + groupBox-&gt;pixmap.width()\n                        + groupBox-&gt;rightSpace;\n        pixmapHeight = groupBox-&gt;pixmap.height();\n        textOffset = decorationOffset + pixmapRectWidth;\n    }\n\n    textRect.adjust(textOffset, 0, textOffset, 0);\n\n    // Draw frame\n    if (groupBox-&gt;subControls &amp; QStyle::SC_GroupBoxFrame) {\n        QStyleOptionFrame frame;\n        frame.QStyleOption::operator=(*groupBox);\n        frame.features = groupBox-&gt;features;\n        frame.lineWidth = groupBox-&gt;lineWidth;\n        frame.midLineWidth = groupBox-&gt;midLineWidth;\n        frame.rect = proxy()-&gt;subControlRect(CC_GroupBox, opt, SC_GroupBoxFrame, widget);\n        p-&gt;save();\n        QRegion region(groupBox-&gt;rect);\n        if (!groupBox-&gt;text.isEmpty()) {\n            bool ltr = groupBox-&gt;direction == Qt::LeftToRight;\n            QRect finalRect;\n            if (groupBox-&gt;subControls &amp; QStyle::SC_GroupBoxCheckBox) {\n                finalRect = checkBoxRect.united(textRect);\n                finalRect.adjust(ltr ? -4 : 0, 0, ltr ? 0 : 4, 0);\n            } else {\n                finalRect = textRect;\n            }\n            region -= finalRect;\n        }\n        p-&gt;setClipRegion(region);\n        proxy()-&gt;drawPrimitive(PE_FrameGroupBox, &amp;frame, p, widget);\n        p-&gt;restore();\n    }\n\n    // Draw icon\n    if (!groupBox-&gt;pixmap.isNull()) {\n        p-&gt;fillRect(decorationOffset, 0, pixmapRectWidth, pixmapHeight, opt-&gt;palette.window().color());\n        proxy()-&gt;drawItemPixmap(p, QRect(decorationOffset, 0, pixmapRectWidth, pixmapHeight),\n                                Qt::AlignCenter, groupBox-&gt;pixmap);\n    }\n\n    // Draw title\n    if ((groupBox-&gt;subControls &amp; QStyle::SC_GroupBoxLabel) &amp;&amp; !groupBox-&gt;text.isEmpty()) {\n        QColor textColor = groupBox-&gt;textColor;\n        if (textColor.isValid())\n            p-&gt;setPen(textColor);\n        int alignment = int(groupBox-&gt;textAlignment);\n        if (!proxy()-&gt;styleHint(QStyle::SH_UnderlineShortcut, opt, widget))\n            alignment |= Qt::TextHideMnemonic;\n        proxy()-&gt;drawItemText(p, textRect,  Qt::TextShowMnemonic | Qt::AlignHCenter | alignment,\n                              groupBox-&gt;palette, groupBox-&gt;state &amp; State_Enabled, groupBox-&gt;text,\n                              textColor.isValid() ? QPalette::NoRole : QPalette::WindowText);\n        if (groupBox-&gt;state &amp; State_HasFocus) {\n            QStyleOptionFocusRect fropt;\n            fropt.QStyleOption::operator=(*groupBox);\n            fropt.rect = textRect;\n            proxy()-&gt;drawPrimitive(PE_FrameFocusRect, &amp;fropt, p, widget);\n        }\n    }\n} else {\n    QCommonStyle::drawComplexControl(cc, opt, p, widget);\n}\n</code></pre></li>\n<li><p>Subclass <code>QGroupBox</code> and reimplement <a href=\"http://doc.qt.io/qt-5/qgroupbox.html#paintEvent\" rel=\"noreferrer\"><code>QGroupBox::paintEvent</code></a> like this:</p>\n\n<pre><code>CustomStyle style;\nQPainter painter(this);\nStyleOptionDecoratedGroupBox option;\n\ninitStyleOption(&amp;option);\noption.pixmap = m_pixmap;\noption.offset = m_offset;\noption.leftSpace = m_leftSpace;\noption.rightSpace = m_rightSpace;\n\nstyle.drawComplexControl(QStyle::CC_GroupBox, &amp;option, &amp;painter, this);\n</code></pre></li>\n</ol>\n\n<p><strong>Note:</strong> This solution does not work well when the group box is checkable.</p>\n\n<h1>Example</h1>\n\n<p>The solution requires a lot of work, but fortunatelly I have created the necessary classes for you, as well as a complete example of how to use them in your own projects. The code is available on <a href=\"https://github.com/scopchanov/SO-DecoratedGroupBox\" rel=\"noreferrer\">GitHub</a>.</p>\n\n<h1>Result</h1>\n\n<p>The provided example produces the following result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MqMxQ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MqMxQ.png\" alt=\"Window with a decorated group box and radio buttons\"></a></p>\n"}], "owner": {"reputation": 695, "user_id": 2526978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8879f3faf8d7b0ece063c3d127e3bc?s=128&d=identicon&r=PG", "display_name": "J C Gonzalez", "link": "https://stackoverflow.com/users/2526978/j-c-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1905, "favorite_count": 0, "accepted_answer_id": 52630998, "answer_count": 1, "score": 3, "last_activity_date": 1538656285, "creation_date": 1538566422, "last_edit_date": 1538571762, "question_id": 52626143, "link": "https://stackoverflow.com/questions/52626143/how-to-add-an-icon-to-a-qgroupbox-title", "title": "How to add an icon to a QGroupBox title?", "body": "<p>Is it possible to add an icon (programmatically, via QtCreator, with or without a stylesheet) to the QGroupBox title?</p>\n\n<p>I want to place a mark close to the title of some of the QGroupBoxes in my GUI. The best place would be to the right of the title, but any other reasonable position (to the left of the title, or in the top right corner of the widget) could be also valid.</p>\n\n<p>The only way I could think of is creating a QLabel with an icon and visually placing it on top of the QGroupBox, in the desired position. But I find this an ugly solution.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I know there is a way of setting the <code>indicator</code> used for <em>checkable</em> QGroupBoxes, as any image, both for checked and unchecked states, using stylesheets. But then the QGroupBox must be checkable, etc.  I want to add this mark (a small image) independently to the <em>checkability</em> of the QGroupBox. </p>\n"}, {"tags": ["c++", "glade", "webassembly"], "owner": {"reputation": 634, "user_id": 6904362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/29d5e66401a21ca7fb9509b7c687500a?s=128&d=identicon&r=PG&f=1", "display_name": "Manuel Rodriguez", "link": "https://stackoverflow.com/users/6904362/manuel-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 630, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538566129, "creation_date": 1538566129, "question_id": 52626083, "link": "https://stackoverflow.com/questions/52626083/creating-a-gui-with-glade-and-webassembly", "title": "Creating a GUI with Glade and Webassembly", "body": "<p>The Glade software is a visual editor for GUI development. The output is a XML file which can be used in a C++ application for user interaction. A normal C++ program is compiled to run on a desktop, for example in Fedora Linux. In contrast, the Webassembly standard has the aim to execute programs inside the browser. Webassembly is a \u201cC++ to Javascript\u201d converter with a high performance.</p>\n\n<p>My question is: Can i use the Glade GUI creator tool for building a webassembly app which can run inside the webbrowser? The reason is, that I'm not interested in creating native Linux apps, but platform independent apps which can be run in any browser no matter if it's Linux, WIndows or Mac.</p>\n"}]