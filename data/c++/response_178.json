[{"tags": ["c++", "game-engine"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 5, "creation_date": 1528328255, "post_id": 50731071, "comment_id": 88469822, "body": "You have to write it every time for out-of-line method definitions like this."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1528328615, "post_id": 50731071, "comment_id": 88469900, "body": "Benefits? How would the compiler know what <code>initialize</code> method you are defining without you explicitly telling the compiler that you are defining <code>Engine::initialize(char *)</code> method?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528328695, "post_id": 50731071, "comment_id": 88469919, "body": "It might seem like a lot of pointless typing but you get used to it and soon come to expect it."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1528328894, "post_id": 50731071, "comment_id": 88469970, "body": "You can always define the functions inline, within the class definitions.   That has disadvantages - such as, if it is necessary to change the definition of ANY member function at all, then EVERY compilation unit that uses the class must be re-built.   In large projects, with classes used in many places, that can increase incremental build times by orders of magnitude (e.g. from minutes to days).  Conversely, an advantage of defining member functions out of line as you are, is that such complete rebuilds are not required for incremental/minor changes."}, {"owner": {"reputation": 139, "user_id": 9069919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5998224f44d85dc35724d0810d20c98b?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;n", "link": "https://stackoverflow.com/users/9069919/mart%c3%adn"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1528329118, "post_id": 50731071, "comment_id": 88470028, "body": "@AnT I thought that the compiler would know just because the .cpp file have the same name as the header file"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1528329831, "post_id": 50731071, "comment_id": 88470198, "body": "@Mart&#237;n: Firstly, compiler never takes into account file names. File names don&#39;t matter at all. Secondly, by the time it actually begins <i>compiling</i> the code, header files are no longer in the picture. Thirdly, nothing prevents you from defining multiple different classes, all with <code>initialize</code> method, in the same pair of header and <code>.cpp</code> files."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1528329850, "post_id": 50731071, "comment_id": 88470202, "body": "@Mart&#237;n .cpp file can have different name than its header file"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1528330565, "post_id": 50731071, "comment_id": 88470389, "body": "This is why <i>programmers</i> invented <i>code completion</i>."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1528345512, "post_id": 50731071, "comment_id": 88473609, "body": "Just a heads up, the double colon <code>::</code> in C++ is also called the <a href=\"https://www.geeksforgeeks.org/scope-resolution-operator-in-c/\" rel=\"nofollow noreferrer\">scope resolution operator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5517, "user_id": 1227469, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d8fc267b1c19301d8baf672ebf9eb7b?s=128&d=identicon&r=PG", "display_name": "JBentley", "link": "https://stackoverflow.com/users/1227469/jbentley"}, "edited": false, "score": 1, "creation_date": 1528336170, "post_id": 50731116, "comment_id": 88471610, "body": "Taking the question literally then technically the answer is no. Macros."}], "tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": true, "score": 4, "last_activity_date": 1528328515, "creation_date": 1528328515, "answer_id": 50731116, "question_id": 50731071, "link": "https://stackoverflow.com/questions/50731071/using-everytime-in-c/50731116#50731116", "title": "Using :: everytime in C++", "body": "<p>Short answer: Yes, you have to.</p>\n\n<p>Long answer: <code>using namespace</code> only works with namespaces. No surprise here. A class is not a namespace. If you move the code to the header, this necessity falls away, but that has other downsides that are the same as in C, so you probably know them.</p>\n"}], "owner": {"reputation": 139, "user_id": 9069919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5998224f44d85dc35724d0810d20c98b?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;n", "link": "https://stackoverflow.com/users/9069919/mart%c3%adn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 50731116, "answer_count": 1, "score": 1, "last_activity_date": 1528332596, "creation_date": 1528328147, "last_edit_date": 1528332596, "question_id": 50731071, "link": "https://stackoverflow.com/questions/50731071/using-everytime-in-c", "title": "Using :: everytime in C++", "body": "<p>Alright, so I am totally new in C++ since I come from C and Java, so a simple question. I have the following header called <em>Engine.h</em> (the code is from a <a href=\"https://www.youtube.com/playlist?list=PL7lh9ryRNHSJjzOD070wCctd3PvC0h4uG\" rel=\"nofollow noreferrer\">tutorial to make games with C++</a>):</p>\n\n<pre><code>#ifndef TWITCH_ENGINE\n#define TWITCH_ENGINE\n\n#include \"GLFW/glfw3.h\"\n#pragma comment (lib, \"opengl32.lib\")\n\nclass Engine\n{\npublic:\n    static int SCREEN_WIDTH;\n    static int SCREEN_HEIGHT;\n\n    Engine();\n    ~Engine();\n\n    bool initialize(char *windowTitle);\n\nprivate:\n\n};\n\n#endif\n</code></pre>\n\n<p>and the source file <em>Engine.cpp</em></p>\n\n<pre><code>#include \"Engine.h\"\n\nint Engine::SCREEN_WIDTH = 1024;\nint Engine::SCREEN_HEIGHT = 768;\n\nEngine::Engine() {\n\n\n}\n\nEngine::~Engine() {\n\n\n}\n\nbool Engine::initialize(char* windowTitle);\n</code></pre>\n\n<p>So the question is, do I have to write every time Engine::<em>member_name</em> or is there a way to avoid this, maybe by writing something like <code>using namespace Engine;</code>? And if so, what are the beneficts of coding that way?</p>\n"}, {"tags": ["c++", "visual-c++", "linker"], "comments": [{"owner": {"reputation": 11436, "user_id": 89706, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7484b466a474ebffc58e91bc5aa7e892?s=128&d=identicon&r=PG", "display_name": "Ofek Shilon", "link": "https://stackoverflow.com/users/89706/ofek-shilon"}, "edited": false, "score": 0, "creation_date": 1528377102, "post_id": 50730995, "comment_id": 88491730, "body": "What is the project type? (console?) Do you have anything non default under linker/input? (e.g. Ignore specific/all default libraries?)   You might also want to inspect, and perhaps paste the linker /VERBOSE output."}], "answers": [{"tags": [], "owner": {"reputation": 1567, "user_id": 8870224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BomtF.jpg?s=128&g=1", "display_name": "samuelnj", "link": "https://stackoverflow.com/users/8870224/samuelnj"}, "is_accepted": false, "score": 0, "last_activity_date": 1528330585, "creation_date": 1528330585, "answer_id": 50731340, "question_id": 50730995, "link": "https://stackoverflow.com/questions/50730995/linker-error-in-visual-studio-2017/50731340#50731340", "title": "Linker error in visual studio 2017", "body": "<p>If it compiled properly, it means that you have the header file or definition somewhere. What you need to do is add the library (which the symbol is from) in the linker properties of the project so that it can be found at the linking stage.</p>\n"}], "owner": {"reputation": 2608, "user_id": 2012636, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6e6136715596818149afe8fb5f95c53d?s=128&d=identicon&r=PG&f=1", "display_name": "Steini", "link": "https://stackoverflow.com/users/2012636/steini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528361348, "creation_date": 1528327596, "last_edit_date": 1528361348, "question_id": 50730995, "link": "https://stackoverflow.com/questions/50730995/linker-error-in-visual-studio-2017", "title": "Linker error in visual studio 2017", "body": "<p>more then annoying linker-error here:</p>\n\n<pre><code>LNK2001 unresolved external symbol __std_terminate\n</code></pre>\n\n<p>I have no clue how to solve. Im using MSVC 2017 with a project build and using toolkit for MSVC2015.</p>\n\n<p>Compiled fine and links until this very last error.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1528327955, "post_id": 50730913, "comment_id": 88469736, "body": "Please post text as text. Images are hard for future askers to search and potential answerers to compile."}], "answers": [{"tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": true, "score": -1, "last_activity_date": 1528328111, "creation_date": 1528328111, "answer_id": 50731063, "question_id": 50730913, "link": "https://stackoverflow.com/questions/50730913/const-auto-identifier-errors/50731063#50731063", "title": "Const Auto/Identifier Errors", "body": "<p>This is C++17 syntax. As this standard is not yet the default option for most compilers you have to tell the compiler that you are using it via the <code>-std=c++17</code> switch.</p>\n\n<p>PS: you didn't say which compiler you are using, so maybe it will not support that switch or not even support C++17 at all.</p>\n"}], "owner": {"reputation": 55, "user_id": 9905990, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Blanco Yisom", "link": "https://stackoverflow.com/users/9905990/blanco-yisom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1528328952, "accepted_answer_id": 50731063, "answer_count": 1, "score": -6, "last_activity_date": 1528328111, "creation_date": 1528327013, "question_id": 50730913, "link": "https://stackoverflow.com/questions/50730913/const-auto-identifier-errors", "closed_reason": "Not suitable for this site", "title": "Const Auto/Identifier Errors", "body": "<p>I having trouble understanding why it won't identify this.\nAny help is greatly appreciated. </p>\n\n<p><a href=\"https://i.stack.imgur.com/2cIiV.png\" rel=\"nofollow noreferrer\">Errors</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/9FeKR.png\" rel=\"nofollow noreferrer\">Rest of the Code</a></p>\n"}, {"tags": ["c++", "arrays", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 954, "user_id": 1935009, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/LmCmh.png?s=128&g=1", "display_name": "Yashas", "link": "https://stackoverflow.com/users/1935009/yashas"}, "edited": false, "score": 0, "creation_date": 1528343612, "post_id": 50730866, "comment_id": 88473156, "body": "Why are using pointers and <code>new</code>? You should prefer using <code>std::vector&lt;float&gt;</code>. You don&#39;t need pointers at all; use references."}], "answers": [{"comments": [{"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1528331482, "post_id": 50730912, "comment_id": 88470585, "body": "@KillzoneKid - Yeah, I see that now.  I&#39;m gonna hope he misunderstood that requirement, but will kill this answer if he confirms not."}, {"owner": {"reputation": 1, "user_id": 9905969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc96c1c750f0b0b98fda8789d781ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Jacobi97", "link": "https://stackoverflow.com/users/9905969/jacobi97"}, "edited": false, "score": 1, "creation_date": 1528333498, "post_id": 50730912, "comment_id": 88471038, "body": "Yea my assignment was to make an array of pointers... Before that I had it like your code and it worked great but the &quot;stretch challenges&quot; were to make an array of pointers. Thanks though!"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 1, "user_id": 9905969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc96c1c750f0b0b98fda8789d781ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Jacobi97", "link": "https://stackoverflow.com/users/9905969/jacobi97"}, "edited": false, "score": 0, "creation_date": 1528335247, "post_id": 50730912, "comment_id": 88471385, "body": "@Jacobi97 - updated with another way you could allocate the memory for your actual floats."}, {"owner": {"reputation": 1, "user_id": 9905969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc96c1c750f0b0b98fda8789d781ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Jacobi97", "link": "https://stackoverflow.com/users/9905969/jacobi97"}, "edited": false, "score": 0, "creation_date": 1528335361, "post_id": 50730912, "comment_id": 88471413, "body": "@zzxyz Awesome thanks for all the help. Programming is tough! but I&#39;m glad for people like you guys!"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 1, "user_id": 9905969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc96c1c750f0b0b98fda8789d781ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Jacobi97", "link": "https://stackoverflow.com/users/9905969/jacobi97"}, "edited": false, "score": 0, "creation_date": 1528335618, "post_id": 50730912, "comment_id": 88471466, "body": "@Jacobi97 - Absolutely.  PS--Your professor is probably looking for the other approach (on-demand), but neither approach particularly makes sense for this problem and slapping &quot;a layer of indirection&quot; on top of an existing data construct (an array of floats in this case) is hardly unheard of."}], "tags": [], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "is_accepted": false, "score": 1, "last_activity_date": 1528335005, "last_edit_date": 1528335005, "creation_date": 1528327007, "answer_id": 50730912, "question_id": 50730866, "link": "https://stackoverflow.com/questions/50730866/segmentation-fault-with-pointer-array/50730912#50730912", "title": "segmentation fault with pointer array", "body": "<p>Your problem is that you've allocated an array of float pointers.  You need to allocate an array of floats.  So currently you have no memory allocated for the actual floats.  If you do this, you'll allocate that memory:</p>\n\n<pre><code>float *speed = new float[arraySize];\n</code></pre>\n\n<p>You don't have any need for a 2D/jagged array that I can see.  If you start with the code above, the compiler errors should lead you right in the direction.  (Basically you will start removing <code>*</code> from a lot of places in your code.)</p>\n\n<p><strong>EDIT</strong> \nBased on your requirement that I misunderstood, a possible approach is the following.  The other answer (the one that isn't mine) makes sense in broader scenarios than this, but hopefully this is sort of another angle to think about that rather arbitrary problem you're trying to solve:</p>\n\n<pre><code>int main()\n{\n  float *pFloats = new float[10];\n  float **ppFloats = new float*[10];\n  //assign float values and pointers to them in same loop\n  for (int i = 0; i &lt; 10; i++)\n  {\n    pFloats[i] = i;\n    ppFloats[i] = &amp;pFloats[i];\n  }\n  //swap two arbitrary pointers\n  float *pTemp = ppFloats[4];\n  ppFloats[4] = ppFloats[5];\n  ppFloats[5] = pTemp;\n\n  //print our float array\n  for (int i = 0; i &lt; 10; i++)\n    printf(\"%f\\n\", pFloats[i]);\n  //print our float array *through* our pointers\n  for (int i = 0; i &lt; 10; i++)\n    printf(\"%f\\n\", *ppFloats[i]);\n  delete[] ppFloats;\n  delete[] pFloats;\n}\n</code></pre>\n\n<p>Ignore the hard-coded constants, etc...The point here is that I've created a contiguous memory area for the floats, and then created an array of float pointers on top of it.  Note that I can sort my pointer array with zero impact on the original array.  There are <em>much</em> smarter ways to do this, but...looks like you're learning about raw pointers, so...</p>\n\n<p>Contrast with the other answer which creates jagged memory for the floats (1 at a time, on demand, not necessarily contiguous).</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1528327814, "post_id": 50731012, "comment_id": 88469695, "body": "Why? Why not just <code>float* speed = new float[arraySize];</code>"}, {"owner": {"reputation": 126, "user_id": 7753675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4nuPf8_UD9E/AAAAAAAAAAI/AAAAAAAAMpM/X5jJYfGS41I/photo.jpg?sz=128", "display_name": "Quadir Ali", "link": "https://stackoverflow.com/users/7753675/quadir-ali"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1528328095, "post_id": 50731012, "comment_id": 88469775, "body": "He could. But he specifically said the assignment was to create an array of pointers."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1528328190, "post_id": 50731012, "comment_id": 88469805, "body": "On re-read, you are correct. The assignment is insane, but you are correct."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 2, "creation_date": 1528329192, "post_id": 50731012, "comment_id": 88470046, "body": "They could at least make the assignment an array of struct pointers so that dynamically allocating the memory would make...a little sense.  I guess that significantly complicates the sorting exercise, though."}, {"owner": {"reputation": 1, "user_id": 9905969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc96c1c750f0b0b98fda8789d781ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Jacobi97", "link": "https://stackoverflow.com/users/9905969/jacobi97"}, "edited": false, "score": 0, "creation_date": 1528333345, "post_id": 50731012, "comment_id": 88471003, "body": "Thanks for the help I greatly appreciate it!"}], "tags": [], "owner": {"reputation": 126, "user_id": 7753675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4nuPf8_UD9E/AAAAAAAAAAI/AAAAAAAAMpM/X5jJYfGS41I/photo.jpg?sz=128", "display_name": "Quadir Ali", "link": "https://stackoverflow.com/users/7753675/quadir-ali"}, "is_accepted": false, "score": 4, "last_activity_date": 1528327720, "creation_date": 1528327720, "answer_id": 50731012, "question_id": 50730866, "link": "https://stackoverflow.com/questions/50730866/segmentation-fault-with-pointer-array/50731012#50731012", "title": "segmentation fault with pointer array", "body": "<p>You\u2019ve only allocated space for the outer array but you need to also allocate space for each of the internal floats.</p>\n\n<p>So before calling this line:</p>\n\n<pre><code>cin &gt;&gt; *speed[i];\n</code></pre>\n\n<p>You need to first allocate space for it:</p>\n\n<pre><code>speed[i] = new float;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9905969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc96c1c750f0b0b98fda8789d781ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Jacobi97", "link": "https://stackoverflow.com/users/9905969/jacobi97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528335005, "creation_date": 1528326633, "last_edit_date": 1528327622, "question_id": 50730866, "link": "https://stackoverflow.com/questions/50730866/segmentation-fault-with-pointer-array", "title": "segmentation fault with pointer array", "body": "<p>I am a getting a segment fault when trying to input data for my array of pointers. Im pretty new to coding so  any help would be great. My task was to make an array of pointers then display, swap them around and than sort them    </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nfloat getValueFromPointer(float* thePointer)\n{\n   return *thePointer;\n}\n\nfloat* getMinValue(float* a, float* b)\n{\n   if (*a &lt; *b)\n   {\n      return a;\n   }\n   else\n   {\n      return b;\n   }\n}\n\nint main()\n{\n   int arraySize;\n   cout &lt;&lt; \"Enter the array size: \";\n   cin &gt;&gt; arraySize;\n\n   float** speed = new float*[arraySize]; // dynamically allocated array\n\n   for(int i = 0; i &lt; arraySize; i++)\n   {\n      cout &lt;&lt; \"Enter a float value: \";\n      cin &gt;&gt; *speed[i];\n   }\n\n    // Core Requirement 2\n   for (int i = 0; i &lt; arraySize; i++)\n   {\n      float value = getValueFromPointer(*speed+i);\n      cout &lt;&lt; \"The value of the element \" &lt;&lt; i &lt;&lt; \" is: \";\n      cout &lt;&lt; value &lt;&lt; endl;\n   }\n\n\n\n   //float *pointerToMin = getMinValue(&amp;speed[0], &amp;speed[arraySize - 1]);\n   //cout &lt;&lt; *pointerToMin &lt;&lt; endl;\n\n   delete [] speed;\n   speed = NULL;\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "optimization", "visual-c++", "c++17", "clang++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1528326929, "post_id": 50730768, "comment_id": 88469472, "body": "Shorter reproducer: <code>POD make_pod() { POD p = POD{0, 1, 2}; p.c = 3; return p; }</code>. In that form, MSVC can be made to optimise it by changing <code>POD p = POD{0, 1, 2};</code> to <code>POD p = {0, 1, 2};</code>. Not sure if there&#39;s a similar workaround when the initialiser is a function call&#39;s result."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1528327638, "post_id": 50730768, "comment_id": 88469653, "body": "I believe you meant &quot;changing POD p = POD{0, 1, 2}; to POD p = {0, 1, 3};&quot;. The thing is, this sample is a stripped down version of my design. I have readability and design reasons for multiple step initialization: some of the steps are called really later on, or never called. I included an example of the optimization you suggest in my sample so everybody can tell the difference from that to what i need."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1528328009, "post_id": 50730768, "comment_id": 88469745, "body": "No, <code>POD p = {0, 1, 3};</code> is not what I meant. Changing it to <code>POD p = {0, 1, 2};</code> and leaving the <code>p.c = 3;</code> assignment after it does let MSVC optimise it."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1528328253, "post_id": 50730768, "comment_id": 88469820, "body": "Of course, if the second step in the real program is conditionally called, or called after other intervening function calls, then this sort of optimization is likely not possible in that case."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1528328357, "post_id": 50730768, "comment_id": 88469848, "body": "@hvd I&#39;ve spotted the difference, so for MSVC  &quot;A a = {...};&quot; is not the same as &quot;A a = A{}&quot;?"}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1528328506, "post_id": 50730768, "comment_id": 88469878, "body": "But isn&#39;t the type automatically deduced? At least intellisense can deduce the same type. @aschepler I&#39;m going to meditate over my code to check if I&#39;m not actually conditionally intializing, you made me doubt about my implementation, but I really believe I&#39;m not missing such an obvious thing. Will report back."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1528328814, "post_id": 50730768, "comment_id": 88469952, "body": "Nope, I&#39;m not branching anywhere, the branching comes before any initialization. Previous higher level branching results in calls to different &quot;make_pod&quot; functions, which call different combinations of the initialization steps. Each &quot;make_pod&quot; should be fully optimized (by inlining and all the other optimizations). I need the abstraction with zero overhead, as we all know is possible in c++. Let&#39;s say my boss will fire me if I don&#39;t produce such code."}], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1528331046, "post_id": 50731352, "comment_id": 88470496, "body": "This one is a nice try and It&#39;s clever, and helpful for other stuff I&#39;ve got, so thank you a ton! But my POD are dynamically allocated in huge containers :( This realization is really important, I will edit my question to better represent my problem tomorrow."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1528331372, "post_id": 50731352, "comment_id": 88470558, "body": "I now know in a clearer fashion exactly what I need: I need a function which calls other functions, which are inlined, to be optimized again. Sort of a second pass of optimizations. Can MSVC do that? I&#39;m installing CLANG with MSVC integration as an alternative, but I&#39;d rather to remain using MSVC compilers..."}, {"owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "edited": false, "score": 0, "creation_date": 1528332706, "post_id": 50731352, "comment_id": 88470881, "body": "You wouldn&#39;t believe what CLANG compiles to...: &quot;mov eax, 9   pop rcx   ret&quot; LMAO!"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1528330745, "creation_date": 1528330745, "answer_id": 50731352, "question_id": 50730768, "link": "https://stackoverflow.com/questions/50730768/how-to-let-msvc-compiler-optimize-multiple-step-pod-initialization/50731352#50731352", "title": "How to let MSVC compiler optimize multiple step POD initialization?", "body": "<p>If you turn your methods <code>constexpr</code>, you might do:</p>\n\n<pre><code>constexpr POD step_one()\n{\n    POD p{2, 5, 11};\n    p.b = 3;\n    return p;\n}\n\nconstexpr void step_two(POD &amp;p)\n{\n    p.c = 5;\n}\n\nconstexpr POD make_pod(){\n    POD p = step_one();\n    step_two(p);\n    return p;\n}\n\nPOD make_pod_final()\n{\n    constexpr POD res = make_pod();\n    return res;\n}\n</code></pre>\n\n<p>resulting to:</p>\n\n<pre><code>make_pod_final PROC\n    mov      eax, DWORD PTR $T1[esp-4]\n    mov      DWORD PTR [eax], 2\n    mov      DWORD PTR [eax+4], 3\n    mov      DWORD PTR [eax+8], 5\n    ret      0\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/GBzgEC\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 406, "user_id": 3115980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bVM60.jpg?s=128&g=1", "display_name": "NicoBerrogorry", "link": "https://stackoverflow.com/users/3115980/nicoberrogorry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528340905, "creation_date": 1528325939, "last_edit_date": 1528340905, "question_id": 50730768, "link": "https://stackoverflow.com/questions/50730768/how-to-let-msvc-compiler-optimize-multiple-step-pod-initialization", "title": "How to let MSVC compiler optimize multiple step POD initialization?", "body": "<p>I've made this sample code:</p>\n\n<pre><code>#include &lt;vector&gt;\n\nstruct POD {\n    int a;\n    int b;\n    int c;\n\n    inline static POD make_pod_with_default()\n    {\n        POD p{ 41, 51, 61 };\n        return p;\n    }\n\n    inline void change_pod_a(POD &amp;p, int a) {\n        p.a = a;\n    }\n\n    inline void change_pod_b(POD &amp;p, int b) {\n        p.b = b;\n    }\n\n    static POD make_pod_with_a(int a) {\n        POD p = make_pod_with_default();\n        p.change_pod_a(p, a);\n        return p;\n    }\n\n    static POD make_pod_with_b(int a) {\n        POD p = make_pod_with_default();\n        p.change_pod_b(p, a);\n        return p;\n    }\n};\n\nint main()\n{\n    std::vector&lt;POD&gt; vec{};\n    vec.reserve(2);\n    vec.push_back(POD::make_pod_with_a(71));\n    vec.push_back(POD::make_pod_with_b(81));\n    return vec[0].a + vec[0].b + vec[0].c + vec[1].a + vec[1].b + vec[1].c;\n}\n</code></pre>\n\n<p>In the compiled assembly code we can see the following instructions are being generated for the first vec.push_back(...) call:</p>\n\n<pre><code>...\nmov      DWORD PTR $T2[esp+32], 41 ; 00000029H\n...\nmov      DWORD PTR $T2[esp+36], 51 ; 00000033H\n...\nmov      DWORD PTR $T5[esp+32], 71 ; 00000047H\n...\nmov      DWORD PTR $T6[esp+44], 61 ; 0000003dH\n...\n</code></pre>\n\n<p>There's a mov to [esp+32] for the 71, but the mov to [esp+32] for the 41 is still there, being useless! How can I write code for MSVC that will enable this kind of optimization, is MSVC even capable of it?</p>\n\n<p>Both GCC and CLANG give more optimized versions, but CLANG defeats by a large margin with literally no overhead, in a very clean and logical fashion:</p>\n\n<p>CLANG generated code:</p>\n\n<pre><code>main: # @main\npush rax\nmov edi, 24\ncall operator new(unsigned long)\nmov rdi, rax\ncall operator delete(void*)\nmov eax, 366\npop rcx\nret\n</code></pre>\n\n<p>Everything is done at compile time as 71 + 51 + 61 + 41 + 81 + 61 = 366!\nI must admit its painful to see my program being computed at compile time and still throw in that call to vec.reserve() in the assembly... but CLANG still takes the cake, by far! Come on MSVC, this is not a vector of volatile.</p>\n"}, {"tags": ["c++", "switch-statement", "case"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1528326888, "post_id": 50730767, "comment_id": 88469463, "body": "<code>case &#39;Calc&#39; || &#39;calc&#39;:</code> is not a valid <code>case</code> statement. You need separate <code>case</code> statements for each value you want to compare. But you can&#39;t use strings with <code>case</code> statements.  <code>&#39;Calc&#39;</code>, <code>&#39;calc&#39;</code>, <code>&#39;Game&#39;</code>, these are not treated as strings, they are treated as multi-byte characters instead since you are using single-quotes instead of double-quotes"}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528327300, "post_id": 50730767, "comment_id": 88469568, "body": "Out of curiosity: are serious with developing an OS? It would be new to me that Visual Studio can compile one :D I think you rather mean console application instead of operating system? :)"}, {"owner": {"reputation": 1, "user_id": 9905959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aiMxm07xl78/AAAAAAAAAAI/AAAAAAAAACM/hSs53ZvvNNM/photo.jpg?sz=128", "display_name": "Mc Ocelot", "link": "https://stackoverflow.com/users/9905959/mc-ocelot"}, "reply_to_user": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528329265, "post_id": 50730767, "comment_id": 88470074, "body": "@sebrockm I&#39;m just making a small one to help me learn."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528329751, "post_id": 50730767, "comment_id": 88470174, "body": "@McOcelot Well, I see that it is small :) But are you really talking about a real OS with boot sector and so forth? I&#39;ve never touched that topic that&#39;s why I am asking"}], "answers": [{"comments": [{"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1528328666, "post_id": 50730900, "comment_id": 88469913, "body": "This is more apt solution rather using switch case. +1."}], "tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": false, "score": 3, "last_activity_date": 1528330740, "last_edit_date": 1528330740, "creation_date": 1528326841, "answer_id": 50730900, "question_id": 50730767, "link": "https://stackoverflow.com/questions/50730767/switch-case-always-goes-to-default/50730900#50730900", "title": "Switch Case always goes to default", "body": "<ol>\n<li><code>'Game'</code> is not a valid string</li>\n<li>Even if you replace it by <code>\"Game\"</code>, which is a valid string, <code>switch</code> doesn't work with strings.</li>\n</ol>\n\n<p>So either use single chars in your switch or use <code>if</code>-<code>else</code> blocks where you compare <code>std::string</code>s via <code>==</code>.</p>\n\n<pre><code>std::string answer;\ncin &gt;&gt; answer;\nif (answer == \"Calc\" || answer == \"calc\")\n    //...\nelse if (answer == \"Game\")\n    //...\nelse\n    // invalid \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "is_accepted": false, "score": 1, "last_activity_date": 1528327434, "last_edit_date": 1528327434, "creation_date": 1528327103, "answer_id": 50730924, "question_id": 50730767, "link": "https://stackoverflow.com/questions/50730767/switch-case-always-goes-to-default/50730924#50730924", "title": "Switch Case always goes to default", "body": "<p>You are prompting user for a <code>string</code> while your variable <code>answer</code> is a <code>char</code>, change your prompts to characters like <code>c</code> and <code>g</code> thus make it more convenient,  thus you can use and enumerate characters in your <code>switch</code> / <code>case</code> statement:</p>\n\n<pre><code>int main()\n{\nchar answer;\n\ncout &lt;&lt; \"Welcome to the FR Operating System. \\n\";\ncout &lt;&lt; \"If you want to go to the calculator, type in 'c'. \\n\";\ncout &lt;&lt; \"If you want to go to the game, type in 'g'. \\n\";\ncin &gt;&gt; answer;\nswitch (answer) {\ncase 'c':\ncase 'C':\n    cout &lt;&lt; \"Welcome to the calculator. \\n\";\n    break;\n\ncase 'g':\ncase 'G':\n    cout &lt;&lt; \"Welcome to our game, 'A Day in the Life'. \\n\";\n    break;\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1528328553, "post_id": 50731003, "comment_id": 88469891, "body": "If I understood correctly, OP wants to handle these two <b>&#39;Calc&#39; || &#39;calc&#39;</b> situations correctly or same. How would your code handle this key <code>&quot;calc&quot;</code>? I am also wondering, whether we really need to choose <code>std::map</code> for a simple <code>switch</code> case problem."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1528328704, "post_id": 50731003, "comment_id": 88469921, "body": "@JeJo, one can just run std::tolower to normalize the string. If it goes really bad, one can also map multiple strings to the same lambda. I just couldn&#39;t craft any switch version that would be as ergonomic as <code>std::map</code>."}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1528329235, "post_id": 50731003, "comment_id": 88470060, "body": "I have already explained the reason. Considering the fact that it works as an alternative I have reversed it."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528329417, "post_id": 50731003, "comment_id": 88470109, "body": "I like this solution. One issue: it is not flexible if you want to process some strings casesensitive and others not"}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1528329451, "post_id": 50731003, "comment_id": 88470120, "body": "@JeJo, Looking at the other answer I understand your point better. I believe map scales better as the menu could be written in a text file, parsed, then returned as map. I guess I over-engineered it"}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528329546, "post_id": 50731003, "comment_id": 88470140, "body": "@sebrockm, I believe the problem boils down to normalization+enumeration, which is just collection of ifs :)"}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528329895, "post_id": 50731003, "comment_id": 88470217, "body": "@Incomputable true, and once you have that collection of ifs the map becomes kind of redundant :)"}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528329982, "post_id": 50731003, "comment_id": 88470244, "body": "@sebrockm, separation of concerns is a thing for me. If enumeration is done, I would replace with a array to void functions, which would compile into nice jump table. Anyway, have a nice morning/day/evening. Gotta go to sleep."}], "tags": [], "owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "is_accepted": false, "score": 2, "last_activity_date": 1528329057, "last_edit_date": 1528329057, "creation_date": 1528327655, "answer_id": 50731003, "question_id": 50730767, "link": "https://stackoverflow.com/questions/50730767/switch-case-always-goes-to-default/50731003#50731003", "title": "Switch Case always goes to default", "body": "<h2>Use map to item callbacks</h2>\n\n<p>Ideally, it would be better to map item menu to it's respective actions. <code>std::map&lt;std::string, std::function&lt;void()&gt;&gt;</code> allows exactly that! Read the inline comments to make sense of the rest:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nint main()\n{\n    std::map&lt;std::string, std::function&lt;void()&gt;&gt; menu_items;\n    menu_items.emplace(\"calc\", [](){std::cout &lt;&lt; \"calculate chosen\\n\";}); //use lambdas to spare boilerplate\n    menu_items.emplace(\"game\", [](){std::cout &lt;&lt; \"game is chosen\\n\";});\n\n    std::string chosen_item;\n    std::cin &gt;&gt; chosen_item;\n    auto item = menu_items.find(chosen_item); //search by the string\n    if (item == menu_items.end()) //item was not found in the list\n        std::cout &lt;&lt; \"invalid item is chosen\\n\";\n    else\n        item-&gt;second(); //execute the stored function\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/zklEb5kPMGOgHGYj\" rel=\"nofollow noreferrer\">Demo</a>.</p>\n\n<p>Depending on your usage you might want to use <code>void*()</code> for <code>std::function&lt;void()&gt;</code>, and <code>std::unordered_map</code> for <code>std::map</code>. For your usage case it doesn't seem to matter though.</p>\n\n<p>Also you might want to normalize the input, e.g. lowercase the string, or perform some other normalization. Since this is not performance sensitive part of the code, I believe overhead of <code>std::function</code> and <code>std::map</code> won't matter in this case.</p>\n"}], "owner": {"reputation": 1, "user_id": 9905959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aiMxm07xl78/AAAAAAAAAAI/AAAAAAAAACM/hSs53ZvvNNM/photo.jpg?sz=128", "display_name": "Mc Ocelot", "link": "https://stackoverflow.com/users/9905959/mc-ocelot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1528337182, "creation_date": 1528325936, "last_edit_date": 1528337182, "question_id": 50730767, "link": "https://stackoverflow.com/questions/50730767/switch-case-always-goes-to-default", "title": "Switch Case always goes to default", "body": "<p>I am trying to make a small operating system that takes a response from a switch...case to go to a miniature game or a simple calculator. However, no matter what input I give (even correct ones) the output is always the default. \nThe compiler I am using (Microsoft Visual Studio; It could be the problem) isn't giving me any errors, and I can't find or think of any mistakes. Do some of you people who are actually good at this have any answers to my problem?</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;limits&gt;\n\nusing namespace std;\n\nint calc() {\n\nchar op;\nfloat num1, num2;\n\ncout &lt;&lt; \"Enter operation:\";\ncin &gt;&gt; op;\n\ncout &lt;&lt; \"Enter two numbers:\";\ncin &gt;&gt; num1 &gt;&gt; num2;\n\nswitch (op)\n{\ncase '+':\n    cout &lt;&lt; num1 + num2;\n    break;\n\ncase '-':\n    cout &lt;&lt; num1 - num2;\n    break;\n\ncase '*':\n    cout &lt;&lt; num1 * num2;\n    break;\n\ncase '/':\n    cout &lt;&lt; num1 / num2;\n    break;\n\ndefault:\n    cout &lt;&lt; \"That is not an operation\";\n    break;\n}\n\nreturn 0;\n};\n\nint main()\n{\nchar answer;\n\ncout &lt;&lt; \"Welcome to the FR Operating System. \\n\";\ncout &lt;&lt; \"If you want to go to the calculator, type in 'Calc'. \\n\";\ncout &lt;&lt; \"If you want to go to the game, type in 'Game'. \\n\";\n\ncin &gt;&gt; answer;\n\nswitch (answer) {\ncase 'Calc' || 'calc':\n    cout &lt;&lt; \"Welcome to the calculator. \\n\";\n    break;\n\ncase 'Game':\n    cout &lt;&lt; \"Welcome to our game, 'A Day in the Life'. \\n\";\n    break;\n\ndefault:\n    cout &lt;&lt; \"That is an invalid answer. This has caused the system to crash. \\n\";\n    break;\n}\n\natexit([] { system(\"PAUSE\"); });\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1528325928, "post_id": 50730727, "comment_id": 88469200, "body": "You forgot to specify what environment you are in. Anyway, consult the appropriate calling convention documentation on argument passing. Presumably they will be passed on the stack but returned in <code>st0</code>. Also brush up on your x87 knowledge (unless you want to use SSE)"}, {"owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "edited": false, "score": 1, "creation_date": 1528325948, "post_id": 50730727, "comment_id": 88469207, "body": "let your compiler create the assembly code for you ;)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1528326799, "post_id": 50730727, "comment_id": 88469433, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/zkwh89ks.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/zkwh89ks.aspx</a>.  <code>float</code> args are on the stack.  Look at compiler-generated asm for a simple <code>foo</code> with that signature and see where it loads args from and where it puts the return value.  See also Agner Fog&#39;s calling conventions doc: <a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a> and calling convention links in <a href=\"https://stackoverflow.com/tags/x86/info\">stackoverflow.com/tags/x86/info</a>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1528352079, "post_id": 50730727, "comment_id": 88475917, "body": "Search for &quot;cdecl&quot; on the linked duplicate, Russel&#39;s answer (copied from wikipedia) says args are on the stack.  That includes <code>float</code> args."}], "answers": [{"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1528332573, "post_id": 50731467, "comment_id": 88470851, "body": "His code is 32-bit (examine the assembly he posted) and he does say <code>x86</code> (not <code>x86-64</code>) so his C code follows the 32-bit x86 cdecl calling convention for Windows, and which his function has to be written for. In that case floats along with the integer class values are pushed on the stack right to left."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1528333162, "post_id": 50731467, "comment_id": 88470975, "body": "That applies to <code>__fastcall</code> and <code>__vectorcall</code> in 32-bit mode, and the conventions of the same name in 64-bit mode.  But <i>not</i> 32-bit <code>__cdecl</code>, which doesn&#39;t require SSE.  Also, one of the args is a <code>float*</code>, not a <code>float</code>, so it&#39;s an integer/pointer."}, {"owner": {"reputation": 29, "user_id": 5736845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e14a16a093a0a7c5e128f094b408fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Deere", "link": "https://stackoverflow.com/users/5736845/john-deere"}, "edited": false, "score": 0, "creation_date": 1528334684, "post_id": 50731467, "comment_id": 88471274, "body": "I overlooked x86. In today&#39;s world of 64bit processors it is much easier to use x64 ASM in Visual Studio 2017. He will get integer pointer in RCX, and two floats in MM0 and 1."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1528351951, "post_id": 50731467, "comment_id": 88475847, "body": "Yes, agreed that x86-64 is generally easier, and that register-arg calling conventions are better.  I&#39;d recommend that, too, instead of obsolete 32-bit code with crappy stack-args calling conventions especially for new development.  But it&#39;s not like the x86-64 Windows convention is super simple.  You&#39;d get args in XMM1 and 2, because the first arg is an integer.  Unlike x86-64 SysV, only the first 4 total args can go in regs.  (And BTW,  MM0 is a 64-bit vector register that aliases the x87 registers.)  But anyway, this is the wrong answer to <i>this</i> question.  It could be part of an answer..."}], "tags": [], "owner": {"reputation": 29, "user_id": 5736845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e14a16a093a0a7c5e128f094b408fe?s=128&d=identicon&r=PG&f=1", "display_name": "John Deere", "link": "https://stackoverflow.com/users/5736845/john-deere"}, "is_accepted": false, "score": -2, "last_activity_date": 1528331965, "creation_date": 1528331965, "answer_id": 50731467, "question_id": 50730727, "link": "https://stackoverflow.com/questions/50730727/assembly-inline-in-c-float-and-cdecl/50731467#50731467", "title": "assembly inline in c++ (float and _cdecl)", "body": "<p>You will get three floats passed to ASM in XMM0, 1, 2, and 3. Set a break point before calling the function in C++, then F11 to go into ASM and check registers where you have passed values. </p>\n\n<p>See <a href=\"https://software.intel.com/en-us/articles/introduction-to-x64-assembly\" rel=\"nofollow noreferrer\">Calling Conventions</a>\nHave a look at<a href=\"https://deviorel.wordpress.com/2015/01/19/compiling-64-bit-assembler-code-in-visual-studio-2014/\" rel=\"nofollow noreferrer\">Compiling 64-bit Assembler Code in Visual Studio</a></p>\n"}], "owner": {"reputation": 15, "user_id": 8853402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb6a402a8698090b3e8ba2d80ef0eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Yauhen Mardan", "link": "https://stackoverflow.com/users/8853402/yauhen-mardan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "closed_date": 1528352026, "answer_count": 1, "score": -1, "last_activity_date": 1528331965, "creation_date": 1528325663, "last_edit_date": 1528326400, "question_id": 50730727, "link": "https://stackoverflow.com/questions/50730727/assembly-inline-in-c-float-and-cdecl", "closed_reason": "Duplicate", "title": "assembly inline in c++ (float and _cdecl)", "body": "<p>I'm writing a multi-module application (c++ and assembly). I want to make a function with non-integer variables (for example float) using a __cdcel:</p>\n\n<pre><code>extern \"C\" float __cdecl foo(float* arr, float a, float b );\n</code></pre>\n\n<p>What should I write to use these variables in assembly code</p>\n\n<pre><code>.586\nPUBLIC _foo\n.model flat\n.code \n_foo proc \n;...\n;I want to use my arr, a and b here\n;...\nret \n_foo endp\nend\n</code></pre>\n\n<p>It's clear for me, that if my variables were integer, I would use ebp, but in my case <strong>I have floats, so what should I write?</strong>\nI'm using Intel x86 ASM</p>\n"}, {"tags": ["c++", "mfc", "windows-10", "registry", "dac"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1528324707, "post_id": 50730569, "comment_id": 88468815, "body": "Non-admin user does not have the rights to write to HKLM since Vista was released. You can <i>read</i> from HKLM, but not write to it, without admin privileges. RegOpenKeyEx will fail on Windows 7 for HKLM if asking for write access as well. If it&#39;s working for you, you&#39;ve got admin rights."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1528324773, "post_id": 50730569, "comment_id": 88468838, "body": "The way to do this is to create whatever keys you need in your installer (which needs to run elevated) and change the protection on them so that they can be accessed by a regular app.  I do this - I will post some code tomorrow."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528335101, "post_id": 50730569, "comment_id": 88471352, "body": "@KenWhite it does work for Windows 7 and I am certainly not running it as administrator, never had any issues with windows 7.  I will check on permissions for windows 10 tomorrow and will try only read permission there."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528335243, "post_id": 50730569, "comment_id": 88471384, "body": "Win7 does <i>not</i> allow you to write to HKLM without admin privileges. The documentation for RegCreateKeyEx tells you so, as does any effort to write to HKLM without admin rights. I dealt with this issue extensively when Vista was released, because it broke existing code and I had to fix it. If you&#39;re being allowed to write to HKLM in Windown 7, either you&#39;ve got admin privileges or you (or someone else) modified privileges from the defaults to allow it."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528337562, "post_id": 50730569, "comment_id": 88471972, "body": "@KenWhite thanks, I will check on it tomorrow. That&#39;s quite interesting that it works. I wrote a small test application just to test registery and it was working fine too. Not sure if somehow current user is added to registery permission."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528353862, "post_id": 50730569, "comment_id": 88476804, "body": "@zar That&#39;s most unlikely.  I agree with Ken, having had to code round this issue on Vista and later.  I will post some code for you that implements my suggestion above."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528384702, "post_id": 50730569, "comment_id": 88497334, "body": "@KenWhite I updated the question based on comments and posted code. The dilemma with Windows 7 remains."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1528386841, "post_id": 50730569, "comment_id": 88498703, "body": "The general Windows philosophy is that anything that can affect other users requires administrator privileges. Makes sense really. I&#39;m quite surprised that Windows 7 allowed you to modify HKLM at all, because as @KenWhite says it shouldn&#39;t be possible."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528390287, "post_id": 50730569, "comment_id": 88500531, "body": "The dilemma is why you need to write to HKLM in the first place, let alone without elevation. Changes made to HKLM not only affect every user, but also affect the entire OS, so an invalid (or malicious) change can render the OS inoperable. There&#39;s a reason Vista and above require elevation for writing to it, and there&#39;s seldom a good reason to bypass that restriction."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528391306, "post_id": 50730569, "comment_id": 88501026, "body": "@KenWhite The reason is that we want application configurations to be persistent across all users. I think originally this was what HKLM was for to store settings that should be used by all users. One can argue that it&#39;s theoretically right but practically, many times, persistent settings are desirable. So basically its like windows is pushing out persistent settings even if it makes sense in some cases?"}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528391491, "post_id": 50730569, "comment_id": 88501110, "body": "@KenWhite Ahh..that might solve the issue!"}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528394127, "post_id": 50730569, "comment_id": 88502400, "body": "@KenWhite I tested that but it doesn&#39;t have access to HKEY_USERS\\.Default either in Windows 10 either but Windows 7 has."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528394324, "post_id": 50730569, "comment_id": 88502510, "body": "I&#39;m on Windows 7 now, so I can&#39;t test Win 10 until I&#39;m at a different machine later today. In the meantime, <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724836(v=vs.85).aspx\" rel=\"nofollow noreferrer\">this MSDN article might help</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528396572, "post_id": 50730569, "comment_id": 88503644, "body": "I think I found out why it was working in Win 7 and not on Win 10. I suspect (but haven&#39;t been able to confirm yet) that they turned off <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa965884(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Registry Virtualization</a> in Win 10."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1528397246, "post_id": 50730569, "comment_id": 88504010, "body": "@MarkRansom It&#39;s logical that a user Joe can&#39;t write to a profile of Mark but there should be a space that all users can use for user-independent settings."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528408924, "post_id": 50730569, "comment_id": 88509281, "body": "@KenWhite I can&#39;t find any reference to it anywhere but it almost has to be that."}], "answers": [{"comments": [{"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 0, "creation_date": 1528385297, "post_id": 50734836, "comment_id": 88497750, "body": "Thanks, how do we execute this code in the installer? This look like c++ so this could be a separate executable and the installer calls it?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 0, "creation_date": 1528385661, "post_id": 50734836, "comment_id": 88497990, "body": "No idea, I don&#39;t know (and don&#39;t want to know!) what installer you are using.  But yes, that sounds viable, just so long as you can launch the process elevated.  The above code should build fine in Visual Studio if you include the right header files.  MSDN will help you track those down."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 0, "creation_date": 1528405544, "post_id": 50734836, "comment_id": 88508052, "body": "The code nearly builds but I get only 2 errors. BuildACE() and ReportLastError() functions are undefined. Could you please add those functions too? Thanks!"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 0, "creation_date": 1528407384, "post_id": 50734836, "comment_id": 88508787, "body": "Sorry, I hacked it out of my installer and just pasted it in.  I will update it tomorrow."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 0, "creation_date": 1528442482, "post_id": 50734836, "comment_id": 88518552, "body": "Good morning @zar.  I have now updated my code, it should be OK now."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 0, "creation_date": 1528482524, "post_id": 50734836, "comment_id": 88540419, "body": "One thing you want to say is the function <code>grant_access_to_registry_key</code> return 0 if failed and non-zero (1) if success. It looks like your description is the other way round. Thanks!"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "edited": false, "score": 1, "creation_date": 1528484258, "post_id": 50734836, "comment_id": 88541126, "body": "Yeah, just keeping you on your toes :) I edited the post, thanks."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 3, "last_activity_date": 1528484232, "last_edit_date": 1528484232, "creation_date": 1528354918, "answer_id": 50734836, "question_id": 50730569, "link": "https://stackoverflow.com/questions/50730569/registry-permissions-in-windows-10/50734836#50734836", "title": "Registry permissions in Windows 10", "body": "<p>As I said in my comments above, what you have to do here is to create whatever keys you need in HKLM in your installer (which needs to run elevated) and then change the protection on them so that they can be accessed by an app running with standard permissions (i.e., as a member of group <code>BUILTIN\\Users</code>, and running non-elevated).</p>\n\n<p>Here's the code to 'unprotect' a registry key.  Code written in Notepad so may not quite compile and it's obviously a bit hacky, sorry.</p>\n\n<p>Utility function BuildAce (was missing originally, sorry about that):</p>\n\n<pre><code>// Build an access allowed, access denied, system alarm or system audit ACE.  Caller must free.\nACE_HEADER * BuildACE (PSID sid, int ace_type, int ace_flags, ACCESS_MASK ace_mask)\n{\n    int sid_len = GetLengthSid (sid);\n    int ace_len = sizeof (ACCESS_ALLOWED_ACE) - sizeof (DWORD) + sid_len;\n    ACCESS_ALLOWED_ACE *ace = (ACCESS_ALLOWED_ACE *) malloc (ace_len);\n    memset (ace, 0, ace_len);\n    ace-&gt;Header.AceType = ace_type;\n    ace-&gt;Header.AceFlags = ace_flags;\n    ace-&gt;Header.AceSize = ace_len;\n    ace-&gt;Mask = ace_mask;\n    memcpy (&amp;ace-&gt;SidStart, sid, sid_len);\n    return (ACE_HEADER *) ace;\n}\n</code></pre>\n\n<p>Utility function AddOrRemoveACE:</p>\n\n<pre><code>// Add or remove an ACE to/from an ACL\n// Returns a copy of the original ACL with the relevant changes made; caller must free\n// Sequence of ACE's must be:\n//      not inherited, denied\n//      not inherited, allowed\n//      inherited, denied\n//      inherited, allowed\nACL *AddOrRemoveACE (ACL *acl, ACE_HEADER *new_ace, bool add)\n{\n    int acl_size = acl-&gt;AclSize;\n    if (add)\n        acl_size += new_ace-&gt;AceSize;\n\n    ACL *new_acl = (ACL *) malloc (acl_size);\n    BOOL ok = InitializeAcl (new_acl, acl_size, ACL_REVISION);\n    assert (ok);\n\n    // Add new denied ACE at start of list\n    if (add &amp;&amp; new_ace-&gt;AceType == ACCESS_DENIED_ACE_TYPE)\n    {\n        ok = AddAce (new_acl, ACL_REVISION, MAXDWORD, new_ace, new_ace-&gt;AceSize);\n        assert (ok);\n    }\n\n    // Copy all non-inherited ACE's, removing anything matching new_ace\n    for (int i = 0; ; ++i)\n    {\n        ACE_HEADER *old_ace;\n        if (!GetAce (acl, i, (VOID **) &amp;old_ace))\n            break;\n        if ((old_ace-&gt;AceFlags &amp; INHERITED_ACE) == 0 &amp;&amp;\n            (old_ace-&gt;AceSize != new_ace-&gt;AceSize ||\n             memcmp (old_ace, new_ace, old_ace-&gt;AceSize) != 0))\n        {\n            ok = AddAce (new_acl, ACL_REVISION, MAXDWORD, old_ace, old_ace-&gt;AceSize);\n            assert (ok);\n        }\n    }\n\n    // Add new allowed ACE at end of list\n    if (add &amp;&amp; new_ace-&gt;AceType == ACCESS_ALLOWED_ACE_TYPE)\n    {\n        ok = AddAce (new_acl, ACL_REVISION, MAXDWORD, new_ace, new_ace-&gt;AceSize);\n        assert (ok);\n    }\n\n    // Copy all inherited ACE's\n    for (int j = 0; ; ++j)\n    {\n        ACE_HEADER *old_ace;\n        if (!GetAce (acl, j, (VOID **) &amp;old_ace))\n            break;\n        if (old_ace-&gt;AceFlags &amp; INHERITED_ACE)\n        {\n            ok = AddAce (new_acl, ACL_REVISION, MAXDWORD, old_ace, old_ace-&gt;AceSize);\n            assert (ok);\n        }\n    }\n\n    // Store the actual size of the acl data (not reversible)\n    ACL_SIZE_INFORMATION asi;\n    ok = GetAclInformation (new_acl, &amp;asi, sizeof (asi), AclSizeInformation);\n    assert (ok);\n    new_acl-&gt;AclSize = (WORD) asi.AclBytesInUse;\n    return new_acl;\n}\n</code></pre>\n\n<p>Utility function AddOrRemoveRegKeyACE (returns error code):</p>\n\n<pre><code>// Add or remove a registry key ACE.  hKey must have WRITE_DAC access\nDWORD AddOrRemoveRegKeyACE\n    (HKEY hKey, bool add, int ace_type, PSID sid, ACCESS_MASK access_mask)\n{\n    LONG    err;\n    PSECURITY_DESCRIPTOR psd;\n    DWORD buflen = 1024;\n\n    // Read current security information    \n    for ( ; ; )\n    {\n        psd = malloc (buflen);\n        err = RegGetKeySecurity (hKey, DACL_SECURITY_INFORMATION, psd, &amp;buflen);\n        if (err == 0)\n            break;\n        free (psd);\n        if (err == ERROR_INSUFFICIENT_BUFFER)\n            continue;\n        return err;\n    }\n\n    SECURITY_DESCRIPTOR_RELATIVE *sdr = (SECURITY_DESCRIPTOR_RELATIVE *) psd;\n    ACL *pdacl = (ACL *) ((BYTE *) sdr + sdr-&gt;Dacl);\n\n    ACE_HEADER *ace = BuildACE (sid, ace_type, CONTAINER_INHERIT_ACE, access_mask);\n    ACL *new_acl = AddOrRemoveACE (pdacl, ace, add);\n    free (ace);\n    free (psd);\n\n    SECURITY_DESCRIPTOR sd;\n    BOOL ok = InitializeSecurityDescriptor (&amp;sd, SECURITY_DESCRIPTOR_REVISION);\n    assert (ok);\n\n    ok = SetSecurityDescriptorControl (&amp;sd,\n        SE_DACL_AUTO_INHERIT_REQ | SE_DACL_AUTO_INHERITED,\n        SE_DACL_AUTO_INHERIT_REQ | SE_DACL_AUTO_INHERITED);\n    assert (ok);\n\n    ok = SetSecurityDescriptorDacl (&amp;sd, TRUE, new_acl, FALSE);\n    assert (ok);\n\n    // apply the security descriptor to the registry key\n    err = RegSetKeySecurity (hKey, DACL_SECURITY_INFORMATION, &amp;sd);\n    free (new_acl);\n\n    return err;\n}\n</code></pre>\n\n<p>And now a function to grant acces to a registry key to everyone in group 'Users'.  Returns TRUE on success:</p>\n\n<pre><code>BOOL grant_access_to_registry_key (HKEY hKey)\n{\n    // Give the Users group access to hKey\n    SID_IDENTIFIER_AUTHORITY sia = SECURITY_NT_AUTHORITY;\n    PSID pUsersSid;\n    BOOL ok = AllocateAndInitializeSid (&amp;sia, 2,\n        SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_USERS,\n        0, 0, 0, 0, 0, 0, &amp;pUsersSid);\n    if (!ok)\n        return FALSE;\n    ok = AddOrRemoveRegKeyACE (hKey, true, ACCESS_ALLOWED_ACE_TYPE,\n            pUsersSid, KEY_ALL_ACCESS) == 0;\n    FreeSid (pUsersSid);\n    return ok;\n}\n</code></pre>\n"}], "owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2624, "favorite_count": 0, "accepted_answer_id": 50734836, "answer_count": 1, "score": 1, "last_activity_date": 1533025555, "creation_date": 1528324551, "last_edit_date": 1528384569, "question_id": 50730569, "link": "https://stackoverflow.com/questions/50730569/registry-permissions-in-windows-10", "title": "Registry permissions in Windows 10", "body": "<p>An application running as a non-admin in Windows 7 has read/write permissions to <code>HKEY_LOCAL_MACHINE</code>, but apparently not in Windows 10.</p>\n\n<p>A lot of applications store stuff in <code>HKEY_LOCAL_MACHINE</code> which are usually meant to be for all users, and they work fine (like the Visual studio) without being run as an admin, but not my application.</p>\n\n<p>How can I make my own application access <code>HKEY_LOCAL_MACHINE</code> without having to run it as an admin user?</p>\n\n<p>The issue is that <code>RegCreateKeyEx()</code> and <code>RegOpenKeyEx()</code> return <code>ERROR_ACCESS_DENIED</code> in Windows 10, when I run the application  as a standard user, but they work fine if I run it as an admin user.  I don't want to run the application as an admin just for this.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Based on the comments, a non-admin application only has read access to HKLM and I confirmed that with calling application with only READ writes and they can read but it is noted that windows 7 also doesn't have write access but my test application does work fine in Windows 7. Here is the code</p>\n\n<pre><code>void CRegistryPermissionsView::OnBnClickedButtonRegkey()\n{\n    CRegKey regKey;\n    LRESULT ret = 0;\n\n    CString strKey = _T(\"Software\\\\ATestApp\\\\TestAppNode\");\n\n    ret = regKey.Open(HKEY_LOCAL_MACHINE, strKey, KEY_ALL_ACCESS);\n\n    if (ret == ERROR_FILE_NOT_FOUND)\n        ret = regKey.Create(HKEY_LOCAL_MACHINE, strKey);\n\n    if (ret == ERROR_SUCCESS)\n    {\n        ret = regKey.SetStringValue(_T(\"Entry\"), _T(\"EntryValue\"));\n\n        if (ret == ERROR_SUCCESS)\n        {\n            AfxMessageBox(_T(\"Success\"));\n        }\n    }\n}\n</code></pre>\n\n<p>I don't know why the above works in Windows 7 but my main question is where should we store global settings that apply to all users in Windows 10?</p>\n\n<p>Yes, I can create the registry entries through installer which has admin rights but my application would still want to update some of the settings! Do we have to store this locally on a drive now?</p>\n\n<p>All the configuration in the application needs to be applicable to all users.</p>\n"}, {"tags": ["c++", "string", "search", "count", "string-matching"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1528322575, "post_id": 50730219, "comment_id": 88468215, "body": "<i>&quot;...but I still can&#39;t get it&quot;</i> - What <i>do</i> you get? You neglected to mention that. Btw, Debuggers Save Lives (tm)."}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1528322731, "post_id": 50730219, "comment_id": 88468255, "body": "It suffices for essentially every task to iterate through the single characters in the string and process them accordingly, which you can do just as with an array (like <code>if(my_string[i] == &#39; &#39;) ...</code>). There are more sophisticated ways to manipulate strings, which you should easily find using a search engine to read some tutorial on strings, but for your tasks, what I said suffices."}], "answers": [{"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": -1, "last_activity_date": 1528323380, "creation_date": 1528323380, "answer_id": 50730412, "question_id": 50730219, "link": "https://stackoverflow.com/questions/50730219/outputting-vowels-and-consonants-from-strings-in-c/50730412#50730412", "title": "Outputting vowels and consonants from strings in c++", "body": "<p>One method for counting vowels is to make a string containing vowels:  </p>\n\n<pre><code>static const std::string vowels = \"aeiouAEIOU\";\n</code></pre>\n\n<p>Next, for each character in your string, search for it in the vowels string:  </p>\n\n<pre><code>unsigned int vowel_count = 0;\nconst size_t length = text.length();\nfor (unsigned int i = 0; i &lt; length; ++i)\n{\n  const char c = text[i];\n  if (vowels.find(c) != std::string::npos)\n  {\n    ++vowel_count;\n  }\n}\n</code></pre>\n\n<p>This can be applied to consonants as well.  </p>\n\n<p>The code can be modified for those who are not allowed to use <code>std::string</code>.  </p>\n\n<p>Another method is to use <code>std::map</code>.  </p>\n"}], "owner": {"reputation": 11, "user_id": 9905818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v-m1oLaPQxM/AAAAAAAAAAI/AAAAAAAAATk/e8H-1B3RzQo/photo.jpg?sz=128", "display_name": "\u05d0\u05e8\u05d9 \u05db\u05e1\u05e4\u05d9", "link": "https://stackoverflow.com/users/9905818/%d7%90%d7%a8%d7%99-%d7%9b%d7%a1%d7%a4%d7%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1021, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528342665, "creation_date": 1528322244, "last_edit_date": 1528342665, "question_id": 50730219, "link": "https://stackoverflow.com/questions/50730219/outputting-vowels-and-consonants-from-strings-in-c", "title": "Outputting vowels and consonants from strings in c++", "body": "<p>This is the question I have to answer:  </p>\n\n<pre>\nWrite a program that declares two strings: s1 and s2.\n\nInitialize both of them using getline(cin, string) function.  \n\na)      Output the length of each string  \nb)      Output the first appearance of a letter a in the first string  \nc)      Output the first appearance of a letter b in the second string  \nd)      Output the first word of each string  \ne)      Output the last word of each string  \nf)      Output first sentence reversed  \ng)      Output second sentence with the words reversed ( the last word goes first, second last second, and so on)  \nh)      Output the total number of vowels in the first sentence  \ni)      Output the total number of consonants in the second sentence  \n</pre>\n\n<p>This is what I have so far:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;     \n\nint main()  {\n    string s1,s2,s3;\n    int blank = 0;\n    int counter1 = 0;\n    int counter2 = 0;\n    int counter3 = 0;\n    int s2temp = 0;\n\n    cout &lt;&lt; \"enter two sentences\" &lt;&lt;endl;\n    getline (cin, s1);\n    getline (cin, s2);\n    s3=s2;\n\n    // a\n\n    cout &lt;&lt; \"the length of the first string is \" &lt;&lt; s1.length() &lt;&lt; endl;\n    cout &lt;&lt; \"the length of the second string is \" &lt;&lt; s2.length() &lt;&lt; endl;\n\n    // b\n\n    cout&lt;&lt;\"the first appearance of the letter 'A' in the first string is \";\n    cout &lt;&lt; s1.find(\"a\");\n    cout &lt;&lt;endl;\n\n    // c\n\n    cout&lt;&lt;\"the first appearance of the letter 'B' in the second string is \";\n    cout &lt;&lt; s2.find(\"b\");\n    cout &lt;&lt;endl;\n\n    // d\n\n    int s1_first = s1.find(\" \");\n    int s2_first = s2.find(\" \");\n    cout &lt;&lt; \"the first word in the first string is \" &lt;&lt; s1.substr(0,s1_first) &lt;&lt;endl;\n    cout &lt;&lt; \"the first word in the second string is \" &lt;&lt; s2.substr(0,s2_first) &lt;&lt;endl;\n\n    // e\n\n    cout &lt;&lt; \"the last word in the first string is \" &lt;&lt; s1.substr(s1.find_last_of(\" \"), s1.length()-1) &lt;&lt;endl;\n    cout &lt;&lt; \"the last word in the second string is \" &lt;&lt; s2.substr(s2.find_last_of(\" \"), s2.length()-1) &lt;&lt;endl;\n\n    // f\n\n    for(int i = s1.length()-1; i &gt;= 0; i--)\n        cout &lt;&lt;s1.substr (i,1)&lt;&lt;endl;\n\n    // g\n\n    return 0;\n}\n</code></pre>\n\n<p>I\u2019ve tried a few different things for <code>g</code>, <code>h</code>, and <code>i</code>, but none have worked, so I thought I\u2019d ask for help.</p>\n"}, {"tags": ["python", "c++", "syntax", "pybind11"], "answers": [{"tags": [], "owner": {"reputation": 198, "user_id": 7179746, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U7lPPmuoGKI/AAAAAAAAAAI/AAAAAAAAACE/9CPPdZVKg68/photo.jpg?sz=128", "display_name": "Airfield20", "link": "https://stackoverflow.com/users/7179746/airfield20"}, "is_accepted": true, "score": 0, "last_activity_date": 1529615901, "last_edit_date": 1529615901, "creation_date": 1528399266, "answer_id": 50748768, "question_id": 50730012, "link": "https://stackoverflow.com/questions/50730012/what-is-the-proper-syntax-to-bind-a-typedef-type-using-pybind11/50748768#50748768", "title": "What is the proper syntax to bind a typedef type using pybind11?", "body": "<p>For this specific issue, pybind will automatically interpret an std::vector type as a python list when you include <code>\"pybind11/stl.h\"</code> . Thus, a binding for this type is unnecessary. </p>\n\n<p>Ex:</p>\n\n<pre><code>#include \"pybind11.h\"\n#include \"pybind11/stl.h\"\n\nstruct data_point\n{\n    data_point() = delete;\n    data_point(const int&amp; data) :\n            m_data(data)\n    {}\n    int m_data;\n};\n\nstd::vector&lt;data_point&gt; make_vec(){\n    return {data_point(20), data_point(18)};\n}\n\nPYBIND11_MODULE(data_lib, ref)\n{\n    py::class_&lt;data_point&gt; dp(ref, \"data_point\");\n    dp.def(py::init&lt;const int&amp;&gt;());\n    dp.def_readwrite(\"m_data\", &amp;data_point::m_data);\n\n    ref.def(\"make_vec\", &amp;make_vec, \"A function that returns a vector of data_points\");\n}\n</code></pre>\n\n<p>In python, when you import the <code>data_lib</code> library you will be able to use functions that return lists of <code>data_point</code>.</p>\n\n<pre><code>import data_lib\np = data_lib.make_vec()\nprint len(p)\n</code></pre>\n\n<p>output: <code>2</code></p>\n"}], "owner": {"reputation": 198, "user_id": 7179746, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U7lPPmuoGKI/AAAAAAAAAAI/AAAAAAAAACE/9CPPdZVKg68/photo.jpg?sz=128", "display_name": "Airfield20", "link": "https://stackoverflow.com/users/7179746/airfield20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 50748768, "answer_count": 1, "score": 1, "last_activity_date": 1529615901, "creation_date": 1528321148, "question_id": 50730012, "link": "https://stackoverflow.com/questions/50730012/what-is-the-proper-syntax-to-bind-a-typedef-type-using-pybind11", "title": "What is the proper syntax to bind a typedef type using pybind11?", "body": "<p>I have a struct very similar to this:</p>\n\n<pre><code>struct data_point\n{\n    data_point() = delete;\n    data_point(const int&amp; data) :\n            m_data(data)\n    {}\n\n    int m_data;\n};\n</code></pre>\n\n<p>I also have this type declared as such.</p>\n\n<pre><code>typedef std::vector&lt;data_point&gt; data_list;\n</code></pre>\n\n<p>The binding for this struct is defined:</p>\n\n<pre><code>PYBIND11_MODULE(data_lib, ref)\n{\n    py::class_&lt;data_point&gt; dp(ref, \"data_point\");\n    dp.def(py::init&lt;const int&amp;&gt;());\n    dp.def_readwrite(\"m_data\", &amp;data_point::m_data);\n}\n</code></pre>\n\n<p>How do I define a binding for the typedef list type? \nIts not clear to me how to do this in the pybind documentation.</p>\n"}, {"tags": ["c++", "visual-studio-code"], "comments": [{"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1528339618, "post_id": 50729822, "comment_id": 88472379, "body": "Did you set your <code>includePath</code>? <a href=\"https://github.com/Microsoft/vscode-cpptools/blob/release/Documentation/Getting%20started%20with%20IntelliSense%20configuration.md\" rel=\"nofollow noreferrer\">github.com/Microsoft/vscode-cpptools/blob/release/Documentat&zwnj;&#8203;ion/&hellip;</a>"}, {"owner": {"reputation": 2571, "user_id": 445860, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f4007267844d9a3f8637531bcdc6870c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/445860/daniel"}, "reply_to_user": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 1, "creation_date": 1528355973, "post_id": 50729822, "comment_id": 88478020, "body": "@JamesPoag Have no access to the project right now - But no I think the includePath was empty. VS Code should figure it out with the compile_commands.json file right? I mean that&#39;s the point?!"}, {"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1528371834, "post_id": 50729822, "comment_id": 88488103, "body": "It was pretty good about picking up paths, but there were so many edge cases that weren&#39;t fixed until I added the paths manually."}], "owner": {"reputation": 2571, "user_id": 445860, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f4007267844d9a3f8637531bcdc6870c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/445860/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1722, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528321455, "creation_date": 1528320173, "last_edit_date": 1528321455, "question_id": 50729822, "link": "https://stackoverflow.com/questions/50729822/vscode-with-cpptools-usage-of-compile-commands-json-results-in-wrong-autocomple", "title": "VSCode with cpptools: Usage of compile_commands.json results in wrong autocompletion", "body": "<p>I have set up visual studio code with the <a href=\"https://github.com/Microsoft/vscode-cpptools\" rel=\"nofollow noreferrer\">cpptools</a> extension and added this to my <code>c_cpp_properties.json</code> file:</p>\n\n<pre><code>\"compileCommands\": \"${workspaceFolder}/build/compile_commands.json\",\n</code></pre>\n\n<p>The content of <code>compile_commands.json</code> looks something like this (stripped it a bit) </p>\n\n<pre><code>[\n  {\n    \"directory\": \"C:/projects/the_project/build\",\n    \"command\": \"C:\\\\PROGRA~1\\\\LLVM\\\\bin\\\\clang-cl.exe  /nologo -TP -DNOMINMAX -D_WIN32_WINNT=0x0601 -Isrc\\\\Project -I..\\\\src\\\\Project /std:c++17 /MDd /Zi /Ob0 /Od /RTC1  /Fosrc\\\\Project\\\\CMakeFiles\\\\Project.dir\\\\main.cpp.obj /FdTARGET_COMPILE_PDB -c C:\\\\projects\\\\the_project\\\\src\\\\Project\\\\main.cpp\",\n    \"file\": \"C:/projects/the_project/src/Project/main.cpp\"\n  }\n]\n</code></pre>\n\n<p>So the project structure is </p>\n\n<ul>\n<li>root\n\n<ul>\n<li>build (cmake build directory)</li>\n<li>src\n\n<ul>\n<li>Project\n\n<ul>\n<li>main.cpp</li>\n<li>foo.h</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>So the relevant include path from is <code>-I..\\\\src\\\\Project</code>. The autocompletion I expect is <code>#include \"foo.h\"</code>but what I get is <code>#include \"src/Project/foo.h\"</code> </p>\n\n<p>Anyone knows why the the path is not correctly resolved? </p>\n"}, {"tags": ["c++", "arduino"], "comments": [{"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 1, "creation_date": 1528320370, "post_id": 50729678, "comment_id": 88467452, "body": "I\u2019m trying to understand what it is you are trying to achieve with this. You want to ready data from the arduino and write data to it?"}, {"owner": {"reputation": 1002, "user_id": 8078317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ldZij.jpg?s=128&g=1", "display_name": "Nitro", "link": "https://stackoverflow.com/users/8078317/nitro"}, "edited": false, "score": 0, "creation_date": 1528337280, "post_id": 50729678, "comment_id": 88471899, "body": "Is your Computer code showing &quot;Connection Established&quot;&lt; or &quot;ERROR, check port!&quot;. Ideally, you are expected to state this as a part of the question."}, {"owner": {"reputation": 9, "user_id": 9625845, "user_type": "registered", "profile_image": "https://graph.facebook.com/2054745611404712/picture?type=large", "display_name": "Sara M", "link": "https://stackoverflow.com/users/9625845/sara-m"}, "edited": false, "score": 0, "creation_date": 1528345425, "post_id": 50729678, "comment_id": 88473579, "body": "@ Sailanarmo The whole Senario is that : There is a Button connected to the Arduino and video running at PC. The task is to send a character from C++ to Arduino, when the video is started. When Arduino receives the y Character from C++, arduino starts countng the time till the user pushes the button.when the user pushes the button, Arduino sends a signal back to c++ that the user has done so and the elapsed time also. I have difficulty understanding how could C++ understand this process."}, {"owner": {"reputation": 9, "user_id": 9625845, "user_type": "registered", "profile_image": "https://graph.facebook.com/2054745611404712/picture?type=large", "display_name": "Sara M", "link": "https://stackoverflow.com/users/9625845/sara-m"}, "edited": false, "score": 0, "creation_date": 1528345446, "post_id": 50729678, "comment_id": 88473588, "body": "@ Nitro The C++ code is a ready code which returns errors weil compiling. When i ccoment first while()  and uncomment second while() it used to work! so it means there is a serial connection stablished correctly and i recieve the output of arduino in my C++.but i have difficulty sending data back due to lack of programming skill"}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1528346039, "post_id": 50729678, "comment_id": 88473731, "body": "@SaraM so right now you have confirmation that the arduino can send information to the C++ side of things. But in your C++ code, you cannot see the output to the Arduino. Correct?"}, {"owner": {"reputation": 9, "user_id": 9625845, "user_type": "registered", "profile_image": "https://graph.facebook.com/2054745611404712/picture?type=large", "display_name": "Sara M", "link": "https://stackoverflow.com/users/9625845/sara-m"}, "edited": false, "score": 0, "creation_date": 1528351710, "post_id": 50729678, "comment_id": 88475748, "body": "@ Sailanarmo i am not sure if i understand your comment correctly.First i expect my program to be compiled without errors and second see the output from C++ to Arduino."}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1528511461, "post_id": 50729678, "comment_id": 88548315, "body": "@SaraM will you go to <a href=\"https://sailanarmo.github.io/\" rel=\"nofollow noreferrer\">my website</a> and send me an email? I need to understand the problem a bit more and I don&#39;t think this is the best place to get this solved for you."}], "owner": {"reputation": 9, "user_id": 9625845, "user_type": "registered", "profile_image": "https://graph.facebook.com/2054745611404712/picture?type=large", "display_name": "Sara M", "link": "https://stackoverflow.com/users/9625845/sara-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528335311, "creation_date": 1528319501, "last_edit_date": 1528335311, "question_id": 50729678, "link": "https://stackoverflow.com/questions/50729678/arduino-serial-connection", "title": "Arduino serial connection", "body": "<p>I need to make a serial connection between my computer and my arduino.  I found a class which makes the serial connection and works without any error.  I have written my code in arduino(reading from port 2 to arduino and writing it to an output and receiving a character from C++) which is:</p>\n\n<pre><code> int PButton=2;\n int Led=13;\n unsigned long start,finished,elapsed;\n\n\n void setup() {\n Serial.begin(9600); //begins the Serial Connection.\n pinMode(PButton, INPUT_PULLUP);\n pinMode(Led,OUTPUT);\n digitalWrite(Led,LOW);\n Serial.println(\"Is the video already started? \"\"y/n\"\"...\\n\");\n start=millis();\n\n}\n\n void loop() {\n\n\n if(Serial.available()&gt;0){\n char letter=Serial.read();\n if(letter=='y'){\n   digitalWrite(13,HIGH);\n   Serial.println(\"The video is started!\\n\");\n\n  }\n  else if(letter=='n'){\n    digitalWrite(13,LOW);\n    Serial.println(\"The Video is still not started! \\n\");  \n  }\n  else\n  Serial.println(\"Enter a valid Answer please!\\n\");\n\n}\n\nint buttonState=digitalRead(PButton);  //read the input pin\nif(buttonState==LOW){ \n    Serial.println(\" the pushbutton is  pressed!\");\n    finished=millis();\n    elapsed=finished-start;\n    Serial.print(elapsed);\n     } \n\n\n}\n</code></pre>\n\n<p>The code works well as a standalone and it makes the correct output in serial monitor.  The problem is that i am not very experienced in C++ and I am confused how to write the main function to read and write to and from C++ to arduino and vice versa.  I found some codes in stackoverflow but I cant adjust them to my need.</p>\n\n<p>This is my C++ code (I already have the serial connection class). I am not sure which line to comment out and if it is logical at all!</p>\n\n<pre><code>// SerialCommunication.cpp : Definiert den Einstiegspunkt f\u00fcr die \nKonsolenanwendung.\n//This code snippet will help you to read data from arduino\n#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string&gt;\n#include \"SerialPort.h\"\n\n\n//using namespace std;\n//using std::cin;\n//using std::cout;\n//using std::endl;\n\n//String for getting the Output from Arduino\nchar output[MAX_DATA_LENGTH];\n\n//Portname must contain these backslashes\nchar *port_name = \"\\\\\\\\.\\\\COM5\";\n\n//const unsigned int bufSize =255;\n\n//String for incoming data\nchar incomingData[MAX_DATA_LENGTH];\n\n\nint main()\n {\n SerialPort arduino(port_name);\n if (arduino.isConnected())\n    std::cout &lt;&lt; \"Connection Established\" &lt;&lt; std::endl;\n else\n    std::cout &lt;&lt; \"ERROR, check port!\";\n\n while (arduino.isConnected()) {\n    //std::cout &lt;&lt; \"Is the video Started?Yes or No: \\n\";\n    //std::string input_string = \"Blabla\\n\";\n    char answer;\n    std::cin &gt;&gt; answer;\n    //Writing answer to arduino\n    arduino.writeSerialPort( (answer* ), MAX_DATA_LENGTH);\n    //Getting reply from arduino\n    arduino.readSerialPort(output, MAX_DATA_LENGTH);\n    //printing the output\n    puts(output);\n\n}\n\n/*while (arduino.isConnected()) {\n    //Check if data has been read or not\n    int read_result = arduino.readSerialPort(incomingData, bufSize);\n    //prints out data\n    puts(incomingData);\n    //wait a bit\n    Sleep(10);\n}*/\n}\n</code></pre>\n"}, {"tags": ["c++", "curl", "visual-studio-2017"], "comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1528386234, "post_id": 50729642, "comment_id": 88498317, "body": "it&#39;s worth noting that there is no <code>crypt64.lib</code> etc the names are the same as the 32bit versions."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1528386388, "post_id": 50729642, "comment_id": 88498421, "body": "Looks like CURL depends on a few things you&#39;re not including from nuget."}, {"owner": {"reputation": 131, "user_id": 9729549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yqTH.jpg?s=128&g=1", "display_name": "Mutu A.", "link": "https://stackoverflow.com/users/9729549/mutu-a"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1528400066, "post_id": 50729642, "comment_id": 88505343, "body": "@Mgetz I have tried to change the names only to be 100% sure. Anyway, I really don&#39;t understand where is the problem, and I have solved with the WinINet workaround because I can&#39;t permit to spend too much time trying to find a solution for the Curl errors. Striezel I have deleted the &quot;answer&quot;, I&#39;m sorry!"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1528401225, "post_id": 50729642, "comment_id": 88505960, "body": "The issue is you probably don&#39;t have 64bit versions of those libraries built as .lib files nor do you have the project set to find them if you did."}, {"owner": {"reputation": 131, "user_id": 9729549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yqTH.jpg?s=128&g=1", "display_name": "Mutu A.", "link": "https://stackoverflow.com/users/9729549/mutu-a"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1528403958, "post_id": 50729642, "comment_id": 88507306, "body": "@Mgetz Most probably you&#39;re right, OpenSSL, LibZip e etc.. was automatically downloaded and installed when I have installed Curl 32/64bit from NuGet, so I was thinking that also the dependent libs was downloaded for both 32/64. Anyway, thank you for your time."}], "owner": {"reputation": 131, "user_id": 9729549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yqTH.jpg?s=128&g=1", "display_name": "Mutu A.", "link": "https://stackoverflow.com/users/9729549/mutu-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529009025, "creation_date": 1528319336, "last_edit_date": 1529009025, "question_id": 50729642, "link": "https://stackoverflow.com/questions/50729642/nuget-curl-c-unresolved-external-symbol-only-with-x64-build", "title": "NuGet Curl C++. Unresolved external symbol only with x64 build", "body": "<p>I have already searched a solution on <em>Google</em> and here on <em>SO</em> I have only found some questions about the non-NuGet lib package.</p>\n\n<p>(<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383630(v=vs.85).aspx\" rel=\"nofollow noreferrer\">This</a> is the NuGet package. I use the <strong>7.52.1</strong> version because the <em>7.53.0</em> has some compatibility problems with the program I'm developing even with the x86 build)</p>\n\n<p>My problem is that when I want to build my project to <strong>x64</strong>, the linker gives me <strong>149</strong> errors about an <em>unresolved external symbol</em> in <strong>libcurl.lib</strong> (<strong>openssl.obj</strong>), (<strong>md5.obj</strong>) and (<strong>curl_ntlm_core.obj</strong>).\nI'm 90% sure that everything is ok about the project settings for the x64 part, I have <em>verified and re-verified</em> a <strong>lot</strong> of times before asking here for help.</p>\n\n<p>This is the code I use (<strong>who works on the x86 build</strong>):</p>\n\n<pre><code>#include &lt;string&gt;\n\n#pragma comment(lib, \"wldap32.lib\")\n#pragma comment(lib, \"crypt32.lib\")\n#pragma comment(lib, \"Ws2_32.lib\")\n#define CURL_STATICLIB \n#include &lt;curl\\curl.h&gt;\n\nclass _Curl {\n\nprivate:\n\n    static size_t _CURLWriteCallback(void* contents, size_t size, size_t nmemb, void* userp) {\n        ((std::string*)userp)-&gt;append((char*)contents, size * nmemb);\n\n        return size * nmemb;\n    }\n\npublic:\n\n    static BOOL DownloadString(const std::string &amp;URL, std::string &amp;strGET, LONG CONNECTION_TIMEOUT_MS = 1000) {\n        CURL*    _CURL;\n        CURLcode _CURL_RESPONSE;\n\n        _CURL = curl_easy_init();\n        if (_CURL) {\n            curl_easy_setopt(_CURL, CURLOPT_URL, URL.c_str());\n            curl_easy_setopt(_CURL, CURLOPT_CONNECTTIMEOUT_MS, CONNECTION_TIMEOUT_MS);\n            curl_easy_setopt(_CURL, CURLOPT_WRITEFUNCTION, _CURLWriteCallback);\n            curl_easy_setopt(_CURL, CURLOPT_WRITEDATA, &amp;strGET);\n            _CURL_RESPONSE = curl_easy_perform(_CURL);\n            curl_easy_cleanup(_CURL);\n        }\n        if (_CURL_RESPONSE == CURLE_OK) { return TRUE; }\n        return FALSE;\n    }\n};\n</code></pre>\n\n<p>I have also tried to change this part</p>\n\n<pre><code>#pragma comment(lib, \"wldap32.lib\")\n#pragma comment(lib, \"crypt32.lib\")\n#pragma comment(lib, \"Ws2_32.lib\")\n</code></pre>\n\n<p>With</p>\n\n<pre><code>#pragma comment(lib, \"wldap64.lib\")\n#pragma comment(lib, \"crypt64.lib\")\n#pragma comment(lib, \"Ws2_64.lib\")\n</code></pre>\n\n<p>But seems that the names of the libs are hardcoded to *32.lib</p>\n\n<p>I want to say sorry if this will be a duplicate, but I <em>can't</em> find a solution for <em>my case</em>.</p>\n\n<p>P.S: I'm using <em>Visual Studio Community 2017</em></p>\n\n<p><strong>Thank you for your time</strong>!</p>\n\n<p><strong>[UPDATE]</strong></p>\n\n<p>I <em>can't</em> seem to find a solution to make curl to work also with the x64 build.\n<br/>\nSo I have solved using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383630(v=vs.85).aspx\" rel=\"nofollow noreferrer\">WinINet</a> (because I only need to download the <em>HTML</em> <em>content</em> of a Web page as a <strong>string</strong>).</p>\n\n<p>I have created a small class to do this, the \"only\" problem is that WinINet seems to be much slower (<em>approximately with a 48% slower [I have only tested with some files large between 100KB and 800KB]</em>).</p>\n\n<p>This is the class I have written if someone has the <em>same problem</em> and want to use a \"<em>workaround</em>\"</p>\n\n<pre><code>#ifndef _NET_H\n#define _NET_H\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;tchar.h&gt;\n#include &lt;Windows.h&gt;\n#include &lt;WinINet.h&gt;\n#pragma comment(lib, \"WinINet.lib\")\n\nclass _Net {\n\npublic:\n\n    static BOOL DownloadString(const std::basic_string&lt;TCHAR&gt; &amp;URL, std::basic_string&lt;TCHAR&gt; &amp;RETURN, DWORD CONNECTION_TIMEOUT_MS = 1000, DWORD CONNECTION_RETRIES = 1) {\n        if (InternetCheckConnection(_T(\"http://www.google.com\"), FLAG_ICC_FORCE_CONNECTION, 0) == FALSE)\n            return 0;\n\n        HINTERNET _hOpen = InternetOpen(0, INTERNET_OPEN_TYPE_PRECONFIG, 0, 0, 0);\n        if (!_hOpen)\n            return 0;\n\n        InternetSetOption(_hOpen, INTERNET_OPTION_SEND_TIMEOUT \n                                &amp; INTERNET_OPTION_RECEIVE_TIMEOUT \n                                &amp; INTERNET_OPTION_CONNECT_TIMEOUT, &amp;CONNECTION_TIMEOUT_MS, sizeof(DWORD));\n        InternetSetOption(_hOpen, INTERNET_OPTION_CONNECT_RETRIES, &amp;CONNECTION_RETRIES,    sizeof(DWORD));\n\n        DWORD _f = INTERNET_FLAG_DONT_CACHE             | \n                   INTERNET_FLAG_SECURE                 | \n                   INTERNET_FLAG_NO_CACHE_WRITE         | \n                   INTERNET_FLAG_PRAGMA_NOCACHE         | \n                   INTERNET_FLAG_IGNORE_CERT_CN_INVALID | \n                   INTERNET_FLAG_IGNORE_CERT_DATE_INVALID;\n\n        HINTERNET _hInternet = InternetOpenUrl(_hOpen, URL.c_str(), 0, 0, _f, 0);\n        if (!_hInternet) {\n            CloseHandle(_hOpen);\n            return 0;\n        }\n\n        TCHAR _data[2]; ZeroMemory(&amp;_data, sizeof(_data));\n        DWORD _dataReceivedSize;\n        std::basic_string&lt;TCHAR&gt; _strResult;\n\n        while (InternetReadFile(_hInternet, _data, 1, &amp;_dataReceivedSize) &amp;&amp; _dataReceivedSize)\n            _strResult += _data;\n\n        CloseHandle(_hInternet);\n        CloseHandle(_hOpen);\n\n        if (_strResult.length() == 0) \n            return 0;\n\n        RETURN = _strResult;\n        return 1;\n    }\n};\n#endif //_NET_H\n</code></pre>\n\n<p>This will download the Web page from the given url, and return the content in the <code>RETURN</code> string.</p>\n\n<pre><code>std::string content;\n_Net::DownloadString(\"https://www.google.com\", content);\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2015", "fileversioninfo"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528320454, "post_id": 50729612, "comment_id": 88467483, "body": "Reading your own version resource is a lot simpler than reading another file&#39;s resource.  You can&#39;t get a file-not-found error.  GetFileVersionInfo() needs the path, use GetModuleFileName() to get it.  The HMODULE you need is passed to you in DllMain().  If you use macros to create your .rc file then you don&#39;t need it at all.  Google &quot;use macro to set .rc file version number&quot; for hints."}, {"owner": {"reputation": 7285, "user_id": 349045, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/eohqx.jpg?s=128&g=1", "display_name": "ghiboz", "link": "https://stackoverflow.com/users/349045/ghiboz"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528320988, "post_id": 50729612, "comment_id": 88467655, "body": "thanks, but I don&#39;t wnat SET a fileversion, but read it"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528321211, "post_id": 50729612, "comment_id": 88467740, "body": "Yes, that was obvious.  The &quot;don&#39;t need it at all&quot; angle is the way to do it without having to use GetFileVersionInfo().  Code that is not written can never fail and doesn&#39;t have to be maintained."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1528325990, "post_id": 50729612, "comment_id": 88469219, "body": "@ghiboz if you use preprocessor defines in a <code>.h</code> file to specify the version numbers in the <code>.rc</code> file, you can use the same <code>.h</code> file in your <code>.cpp</code> code as well, then you don&#39;t need to query the version numbers dynamically at runtime, they will already be available to your code at compile-time. I think that is what Hans was hinting at"}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1528326200, "last_edit_date": 1528326200, "creation_date": 1528325888, "answer_id": 50730757, "question_id": 50729612, "link": "https://stackoverflow.com/questions/50729612/read-fileversion-value-in-code/50730757#50730757", "title": "read FILEVERSION value in code", "body": "<p>Using <code>GetFileVersionInfo()</code> and <code>VerQueryValue()</code> is the <em>safe</em> and <em>official</em> way to read any file's version data.  The DLL can get its own path + filename by calling <code>GetModuleFileName()</code> with the <code>HINSTANCE</code> provided to its <code>DllMain()</code> entry point.</p>\n\n<p>That being said, it is <em>more efficient</em> for the DLL to just read the version data out of its own version resource directly, using <code>(Find|Load|Lock)Resource()</code> instead of <code>GetFileVersionInfo()</code>.  However, there are caveats with doing this:</p>\n\n<ul>\n<li><p>it is not an approach that is officially supported by Microsoft.</p></li>\n<li><p>the memory pointer that is obtained from <code>LockResouce()</code> <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20061226-06/?p=28603\" rel=\"nofollow noreferrer\"><em>cannot</em> be passed to <code>VerQueryValue()</code></a>.  You <em>must</em> allocate a <em>copy</em> of the resource block, and then you can pass the <em>copy</em> to <code>VerQueryValue()</code>.</p></li>\n<li><p>however, the only version data that you can <em>safely</em> query from the <em>copied</em> resource block using <code>VerQueryValue()</code> is the root <code>VS_FIXEDFILEINFO</code> structure, which is good enough to get the <code>FileVersion</code> and <code>ProductVersion</code> fields. Querying any of the localized version data requires fixups that are normally performed by <code>GetFileVersionInfo()</code>, and even <code>VerQueryValue()</code> itself in coordination with <code>GetFileVersionInfo()</code>.</p></li>\n</ul>\n\n<p>There are several answers on StackOverflow that explain how to use this approach, and some of them have code snippets, including:</p>\n\n<p><a href=\"https://stackoverflow.com/a/48577200/65863\">https://stackoverflow.com/a/48577200/65863</a></p>\n\n<p><a href=\"https://stackoverflow.com/a/13942403/65863\">https://stackoverflow.com/a/13942403/65863</a></p>\n"}], "owner": {"reputation": 7285, "user_id": 349045, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/eohqx.jpg?s=128&g=1", "display_name": "ghiboz", "link": "https://stackoverflow.com/users/349045/ghiboz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "accepted_answer_id": 50730757, "answer_count": 1, "score": 0, "last_activity_date": 1528326200, "creation_date": 1528319209, "question_id": 50729612, "link": "https://stackoverflow.com/questions/50729612/read-fileversion-value-in-code", "title": "read FILEVERSION value in code", "body": "<p>My dll built in c++ has a .rc file that contains this:</p>\n\n<pre><code>VS_VERSION_INFO VERSIONINFO\n FILEVERSION 1,0,8,7\n PRODUCTVERSION 1,0,8,7\n</code></pre>\n\n<p>I wish read the <code>FILEVERSION</code> value to log into my code..\nhow can I do? \nI read something, but all the posts are relative to read other dll or exe, I need to read my current dll</p>\n\n<p>thanks</p>\n"}, {"tags": ["c++", "multithreading", "language-lawyer", "undefined-behavior"], "comments": [{"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1528383498, "post_id": 50729420, "comment_id": 88496469, "body": "There is a <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0137r1.html\" rel=\"nofollow noreferrer\">huge change</a> for pointer in C++17. The sentence you referenced is now deleted. Now the compiler can prove other threads cannot access <code>i</code> legally."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1528391484, "post_id": 50729420, "comment_id": 88501107, "body": "@xskxzr Wow, that is a huge change!"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528422694, "post_id": 50729420, "comment_id": 88512536, "body": "<b>There is no such thing as a specific rule called the &quot;as-if rule&quot;.</b>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 2, "creation_date": 1528467097, "post_id": 50729420, "comment_id": 88532652, "body": "@curiousguy Can you elaborate? <a href=\"http://en.cppreference.com/w/cpp/language/as_if\" rel=\"nofollow noreferrer\">This</a> and <a href=\"https://stackoverflow.com/questions/15718262/what-exactly-is-the-as-if-rule\">this</a> source lead me to believe there is an &quot;as-if&quot; rule. At the very least, the term is common enough to be meaningful in discussing the language."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528479423, "post_id": 50729420, "comment_id": 88539184, "body": "@Fran&#231;oisAndrieux Well applying <i>only</i> &quot;transformations that do not change the observable behavior&quot; just means: <i>correctly</i> implementing the standard. Do you write <code>if(boolean)</code> or <code>if(boolean==true)</code>? Do you prefer <code>if(a==b)</code> or <code>if((a==b) == true)</code>? Saying there is a rule implies that there is a parallel universe in the multiverse where there is no such rule, and I wonder how it looks like."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528481707, "post_id": 50729420, "comment_id": 88540098, "body": "@curiousguy Saying the as-if rule is just there for implicit conversion is not at all true. That&#39;s not what it does, and it&#39;s not what allows for these conversions. The as-if rule means drastically different legal assemblies that can be generated from the same source code. I&#39;m not sure I understand where you&#39;re trying to go with your comment."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528482387, "post_id": 50729420, "comment_id": 88540362, "body": "@Fran&#231;oisAndrieux In my comment I assumed that boolean was actually a boolean. There is no implicit conversion. I could have used an English example: do you say that &quot;water is liquid under standard conditions&quot; or that &quot;saying that &#39;water is liquid under standard conditions&#39; is true&quot;? They mean exactly the same thing."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528482576, "post_id": 50729420, "comment_id": 88540439, "body": "@curiousguy Right, I misspoke. But I don&#39;t see what this has to do with the as-if rule."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528482651, "post_id": 50729420, "comment_id": 88540464, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/172780/discussion-between-curiousguy-and-francois-andrieux\">continue this discussion in chat</a>."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528488114, "post_id": 50729420, "comment_id": 88542732, "body": "&quot;<i>might be able</i>&quot; Instead of writing that code might be able, provide explicit code that you believe is able to do such and such."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1528488268, "post_id": 50729420, "comment_id": 88542799, "body": "@xskxzr &quot;<i>There is a huge change for pointer in C++17.</i>&quot; that changes exactly nothing (there were always restrictions on how so called pointer &quot;values&quot; could be used - there is no such thing as a pointer value) and isn&#39;t even applicable to that question in any way shape or form."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528517577, "post_id": 50729420, "comment_id": 88549168, "body": "@curiousguy Where does the standard forbids codes like <code>int *p = reinterpret&lt;int*&gt;(42); int i = *p; </code> (assume there happens to be an object with automatic storage duration located at the address 42) before the change?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1528568042, "post_id": 50729420, "comment_id": 88561355, "body": "@xskxzr OK some objects that are documented as residing at a given address can be addressed w/o the address of operator. No automatic object is such."}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528482612, "post_id": 50730935, "comment_id": 88540449, "body": "&quot;<i>give it away to somebody else</i>&quot; and lost track of who got a copy. Some uses of pointers can be followed and bound (the compiler knows how many copies there are), but as soon as someone gets out of the view with the copy it&#39;s game over: everyone else might have got a copy of the copy. <b>It&#39;s like secrets</b>: you can try to keep track of all copies of a classified document, but as someone you can&#39;t trust gets a copy, everyone else might have got it. There is no such thing as a classified information/pointer that can&#39;t be copied."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528486858, "post_id": 50730935, "comment_id": 88542196, "body": "&quot;<i>Doing anything else would alter the semantics of your program</i>&quot; This is incorrect in that trivial example code. There is no well defined way for another thread to access <code>i</code>."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528487840, "post_id": 50730935, "comment_id": 88542605, "body": "&quot;<i>the game changes</i>&quot; Even ignoring the essential fact that the function ends with <code>exit</code>, <b>nothing changes</b>. No other thread can access a local variable in a function of another thread that doesn&#39;t synchronize."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528492398, "post_id": 50730935, "comment_id": 88544354, "body": "@curiousguy You voted me down.  You don&#39;t understand my post and you voted me down.  That really takes the biscuit.  Did you even look at the code generated by the compiler at Godbolt?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528492471, "post_id": 50730935, "comment_id": 88544377, "body": "What don&#39;t you understand in: &quot;&#39;as soon as you take the address of i - and give it away to somebody else - the game changes&#39; is WRONG&quot;?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528492596, "post_id": 50730935, "comment_id": 88544418, "body": "@curiousguy My, that was fast.  Did you?  Look at the code?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528492694, "post_id": 50730935, "comment_id": 88544442, "body": "Please provide the exact code such as &quot;the game changes&quot;."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528493990, "post_id": 50730935, "comment_id": 88544862, "body": "@curiousguy I did, it&#39;s on Godbolt, there&#39;s a link in my answer. If you take a look at the machine code, you will see (at line 83) that because I passed its address to another function, <code>j</code> lives on the stack and is incremented between <code>mutex.lock ()</code> and <code>mutex.unlock ()</code>. The compiler could try harder to determine if this is strictly necessary but it doesn&#39;t seem to bother (I see I made a small slip-up in my code there, see if you can spot it). <code>i</code>, on the other hand, is completely optimised away, because the compiler knows that no-else can see it. Does that help you see things more clearly?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528494935, "post_id": 50730935, "comment_id": 88545174, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/172788/discussion-between-curiousguy-and-paul-sanders\">continue this discussion in chat</a>."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528495550, "post_id": 50730935, "comment_id": 88545401, "body": "@curiousguy No way."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528496109, "post_id": 50730935, "comment_id": 88545590, "body": "Can you please clarify &quot;has to&quot;? Is it an absolute? Or the description of a particular implementation?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528496336, "post_id": 50730935, "comment_id": 88545653, "body": "&quot;<i>Doing anything else would alter the semantics of your program</i>&quot; What the heck is &quot;the semantics of your program&quot;? The program prints &quot;j is (hex value)&quot; and returns 1!"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528496876, "post_id": 50730935, "comment_id": 88545813, "body": "@curiousguy That&#39;s actually a decent question, I told you there was a mistake.  Change <code>j</code> to <code>*j</code> in the body of <code>give_away_the_address_of_j()</code> and things should make a bit more sense.  Sorry about that, I&#39;ll update the Godbolt link tomorrow."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528497507, "post_id": 50730935, "comment_id": 88545982, "body": "@curiousguy Just saw your previous comment, sorry.  The gist of it is that, once the address of <code>j</code> is passed to another fuction, the compiler (in general) doesn&#39;t know what that function will do with it so it has to play it safe, no tricky stuff optimising out <code>j</code>.  As it happens,  the code I posted never dereferences that address (I did mean it to but I screwed up) but as soon as I passed the address of <code>j</code> to another function the compiler gave up anyway.  Interesting, no?  I will fix the code tomorrow, it&#39;s a bit sloppy in general."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528567390, "post_id": 50730935, "comment_id": 88561167, "body": "@curiousguy Code at Goldbolt updated, please follow the new link.  Thx."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528568359, "post_id": 50730935, "comment_id": 88561457, "body": "There are many issues with that code. It doesn&#39;t meaningfully synchronize with other threads."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528568961, "post_id": 50730935, "comment_id": 88561614, "body": "@curiousguy It&#39;s not meant to.  It&#39;s meant to address the OP&#39;s question, which has the slightly odd title &quot;Can an object both be stored and not stored?&quot;.  Answer of course: no."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528569158, "post_id": 50730935, "comment_id": 88561663, "body": "1) The OP&#39;s question is meaningless, as I wrote: a) it is predicated on the existence of a so called &quot;as if rule&quot;; b) the code is incorrect WRT other threads and the compiler could know that. 2) The question is not about GCC. The limitations of a particular compiler is not the same thing as the limitation of C++ compilers in general."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 1, "last_activity_date": 1528567340, "last_edit_date": 1528567340, "creation_date": 1528327195, "answer_id": 50730935, "question_id": 50729420, "link": "https://stackoverflow.com/questions/50729420/c-can-an-object-both-be-stored-and-not-stored/50730935#50730935", "title": "C++: Can an object both be stored and not stored?", "body": "<p>I find this question very muddled.  With the code as posted, the compiler is obviously aware that the only use of <code>i</code> is in the <code>return</code> statement, so <code>i</code> will be optimised away, end of story. The mutex doesn't come into it.</p>\n\n<p>But as soon as you take the address of <code>i</code> - and give it away to somebody else - the game changes.  Now the compiler has to put a real variable on the stack and manipulate it <em>only</em> between <code>mutex.lock()</code> and <code>mutex.unlock()</code>.  Doing anything else would alter the semantics of your program.  The mutex also gives you a memory fence.</p>\n\n<p>You can see this clearly at <a href=\"https://godbolt.org/g/5Ek5qi\" rel=\"nofollow noreferrer\">Godbolt</a>.</p>\n\n<p><strong>Edit:</strong> I have fixed a silly bug in that code that rather obscured the point I was trying to make, sorry about that.</p>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528422988, "post_id": 50732492, "comment_id": 88512599, "body": "&quot;<i>match the optimized version</i>&quot; is not a thing (in general). C/C++ are not deterministic. A run of a program can produce many outputs (usually)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 2, "creation_date": 1528467350, "post_id": 50732492, "comment_id": 88532793, "body": "@curiousguy C and C++ (there is no C/C++) are deterministic to the extent that the standard describes them. For a given input (including such things as the source of entropy used to seed pseudo-random generators  as input, network packets, the current time, etc.) a well formed program will be deterministic in terms of observable behavior. If C++ was non-deterministic, all of this would be a huge waste of time."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528485947, "post_id": 50732492, "comment_id": 88541813, "body": "@Fran&#231;oisAndrieux &quot;<i>deterministic to the extent that the standard describes them</i>&quot; Programs in almost all (except Prolog, Haskell) practically used languages  can show non determinism; but well written programs are either fully deterministic (can have exactly one behavior for each inputs) or the non determinism is limited to unimportant behaviors (like logging), or the program is by design non deterministic (like Monte Carlo, but then you could say that&#39;s parameterized deterministic behavior)."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528486653, "post_id": 50732492, "comment_id": 88542092, "body": "&quot;<code>mut.lock();     mut.unlock();</code>&quot; There is nothing after that empty locking that can synchronize with another thread, and then <code>exit(1)</code> will destroy global variables, so it&#39;s clear that no thread can use <code>mut</code> after. It means that another threads cannot use <code>mut</code> at all, so nobody else is synchronizing on <code>mut</code>, so <code>mut</code> can be ignored by the compiler."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528488004, "post_id": 50732492, "comment_id": 88542678, "body": "&quot;<i>as long as the observable results do not change</i>&quot; In a non deterministic language, that&#39;s a very misleading statement."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528931658, "post_id": 50732492, "comment_id": 88698488, "body": "This is not the place to debate &quot;deterministic&quot;, so I will simply state that C++ is deterministic as I understand the word and leave it at that."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529085705, "post_id": 50732492, "comment_id": 88763492, "body": "@JaMiT &quot;Certain other aspects and operations of the abstract machine are described in this document as unspecified (for example, order of evaluation of arguments in a function call ([expr.call])). Where possible, this document defines a <b>set of allowable behaviors</b>. These define the <b>nondeterministic aspects</b> of the abstract machine. An instance of the abstract machine can thus have more than one possible execution for a given program and a given input.&quot; <a href=\"http://eel.is/c++draft/intro.compliance#intro.abstract-3\" rel=\"nofollow noreferrer\">eel.is/c++draft/intro.compliance#intro.abstract-3</a>"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1529086222, "post_id": 50732492, "comment_id": 88763691, "body": "@Fran&#231;oisAndrieux Are you saying that C++ and C are unrelated languages with no useful overlap?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529086378, "post_id": 50732492, "comment_id": 88763757, "body": "@curiousguy <a href=\"https://en.wikipedia.org/wiki/Straw_man\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Straw_man</a> That&#39;s not at all what I said."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1529086915, "post_id": 50732492, "comment_id": 88763984, "body": "@Fran&#231;oisAndrieux How should the useful overlap of C and C++ be called?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1529087261, "post_id": 50732492, "comment_id": 88764109, "body": "@Fran&#231;oisAndrieux &quot;C and C++&quot; is commonly understood as &quot;the subset of valid C programs and valid C++ programs whose semantic are somewhat &#39;equivalent&#39; or covered by isomorphic language rules&quot;?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529087713, "post_id": 50732492, "comment_id": 88764289, "body": "@curiousguy That&#39;s awfully specific, and no. &quot;C and C++&quot; would refer to a pair of languages. But if you are leading on that that&#39;s what &quot;C/C++&quot; should mean, yeah maybe it should. I don&#39;t know. What I do know is how it&#39;s usually (incorrectly) used to refer to some fictitious unified language, as it&#39;s used by people who don&#39;t know anything about programming, such as managers discussing software development related positions. Maybe my comment would have been more clear if I had written &quot;there is no C/C++ language&quot; rather than &quot;there is no C/C++&quot;."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529087733, "post_id": 50732492, "comment_id": 88764298, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173238/discussion-between-francois-andrieux-and-curiousguy\">continue this discussion in chat</a>."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1529090573, "post_id": 50732492, "comment_id": 88765363, "body": "@Jamit <i>C++ is deterministic...</i> - not in my code :)"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1529095764, "post_id": 50732492, "comment_id": 88767219, "body": "Hmm... I wonder if all this nonsense is because I miswrote a part of my answer. That&#39;s one problem with language lawyers -- they can get so hung up on proving themselves right in a literal sense that they fail to put any effort into understanding concepts. In any event, I&#39;ll edit my answer to better express what I meant."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1529103586, "post_id": 50732492, "comment_id": 88769217, "body": "@JaMiT: I would suggest as a refinement the phraseology &quot;the observable results of program execution <i>are among those that could legitimately be produced by</i> a non-optimized executable&quot;.  If a non-optimized executable would be allowed to produce any of four different outputs, chosen in Unspecified fashion, an optimized executable would be allowed to produce any of those outputs, chosen in an Unspecified fashion that may or may not be the same as the unoptimized version."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1529119316, "post_id": 50732492, "comment_id": 88771286, "body": "@supercat thanks. That is the direction I was headed in when I changed &quot;<i>the</i> non-optimized version&quot; to &quot;<i>a</i> non-optimized version&quot;. I added your suggestion as a footnote (because I don&#39;t want the intro to be too verbose), then I thought a bit and did some further revisions. Hopefully it&#39;s looking better now."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1529170478, "post_id": 50732492, "comment_id": 88781449, "body": "@JaMiT: Nice change.  I do think there had historically been significant value in recognizing the range of behaviors that could be produced by a non-optimizing compiler for a particular target <i>that didn&#39;t go out of its way to do something weird</i>.  While there is some ambiguity as to what would be considered &quot;going out of its way&quot;, in many cases there&#39;s a limit to how bizarre a behavior could be and still plausibly satisfy such a definition.  In cases where any remotely-plausible behavior would satisfy requirements, code that can exploit that may be more efficient than code that must..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1529170549, "post_id": 50732492, "comment_id": 88781468, "body": "...avoid UB at all costs.  Unfortunately, even though on most platforms there are some pretty clear and useful limits to &quot;natural&quot; behaviors, and even though the Standard acknowledges the concept of UB behaving &quot;in a documented manner characteristic of the environment&quot;, the notion that it&#39;s useful to let programmers exploit that seems to have become less fashionable than &quot;clever&quot; optimizations."}], "tags": [], "owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "is_accepted": false, "score": 2, "last_activity_date": 1529119130, "last_edit_date": 1529119130, "creation_date": 1528341997, "answer_id": 50732492, "question_id": 50729420, "link": "https://stackoverflow.com/questions/50729420/c-can-an-object-both-be-stored-and-not-stored/50732492#50732492", "title": "C++: Can an object both be stored and not stored?", "body": "<p>The compiler is allowed to perform optimizations as long as the observable results of program execution legitimately could have been obtained (\"as-if\") without those optimizations.<sup>[1]</sup> So this question uses \"as-if\" in a misleading manner, if not actually asking a backwards question:</p>\n\n<blockquote>\n  <p>Is the compiler permitted to store <code>i</code>, but do reordering as-if <code>i</code> was not actually stored?</p>\n</blockquote>\n\n<p>This asks if the compiler is permitted to do things as long as the results of program execution could have been obtained <em>with</em> an optimization. That is not the question to ask. The question should use non-optimized behavior as the reference. So something more like: <em>\"Is the compiler permitted to re-order the statements?\"</em> The answer is yes, as long as the observable results do not change. Nothing external to this particular function is told how to access <code>i</code>, so the compiler should be allowed to implement the increment anywhere between the surrounding uses of it (specifically: its definition and the <code>return</code> statement).</p>\n\n<p>That being said, what I would expect a compiler to do in this case is neither give <code>i</code> a memory address nor treat it as a register variable. I would expect the compiler to treat it like a constant, effectively changing your function to:</p>\n\n<pre><code>int main()\n{\n    doSomethingWhichMaySpawnAThreadAndUseTheMutex();\n    mut.lock();\n    mut.unlock();\n    return 1;\n}\n</code></pre>\n\n<p>This is allowed as long as you have no way to detect that it has been done (short of examining the machine code directly).</p>\n\n<p><em>Note:</em><br>\n<sup>[1]</sup> The use of \"could have been\" is an acknowledgement that there are portions of the C++ specification that use the word \"unspecified\". These portions allow compilers to make choices that (when dealing with non-robust code) could change observable behavior. That is, there can be a set of allowed behaviors, rather than a single allowed behavior. As long as the results remain in this set, an optimization is allowed.</p>\n"}, {"tags": [], "owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1528487300, "creation_date": 1528487300, "answer_id": 50767520, "question_id": 50729420, "link": "https://stackoverflow.com/questions/50729420/c-can-an-object-both-be-stored-and-not-stored/50767520#50767520", "title": "C++: Can an object both be stored and not stored?", "body": "<p>The whole sequence:</p>\n\n<pre><code>    mut.lock(); // i == 0 at that point\n    i += 1;        // can this be reordered?\n    mut.unlock(); // i == 1 at that point\n    exit(i);\n}\n</code></pre>\n\n<p>can be compiled as just <code>exit(1);</code> and other threads can be ignored as there is no proper synchronisation.</p>\n\n<p>You need to wait for other threads to terminate, or for them to engage in doing nothing ever again. You don't do that so it can be assumed that all other threads are doing nothing.</p>\n\n<p>The mutex has no meaningful role here.</p>\n"}], "owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1529119130, "creation_date": 1528318352, "last_edit_date": 1528569707, "question_id": 50729420, "link": "https://stackoverflow.com/questions/50729420/c-can-an-object-both-be-stored-and-not-stored", "title": "C++: Can an object both be stored and not stored?", "body": "<p>I've been in a debate about a corner case regarding local variables in a multithread environment.</p>\n\n<p>The question is regarding programs formed like:</p>\n\n<pre><code>std::mutex mut;\n\nint main()\n{\n    std::size_t i = 0;\n    doSomethingWhichMaySpawnAThreadAndUseTheMutex();\n    mut.lock();\n    i += 1;        // can this be reordered?\n    mut.unlock();\n    return i;\n}\n</code></pre>\n\n<p>The question revolves around whether the <code>i += 1</code> can be reordered to occur above the mutex locking.</p>\n\n<p>The obvious parts are that <code>mut.lock()</code> <em>happens-before</em> <code>i += 1</code>, so if any other thread might be able to observe the value of <code>i</code>, the compiler is obliged to not have incremented it.  From 3.9.2.3 of the C++ spec, \"If an object of type T is located at an address A, a pointer of type cv T* whose value is the address A is said to <em>point to</em> that object, regardless of how the value was obtained.\"\"  This means that if I used any means to get a pointer to <code>i</code>, I can expect to see the right value.</p>\n\n<p>However, the spec does state that the compiler may use the \"as-if\" rule to not give an object a memory address (footnote 4 on section 1.8.6).  For example, <code>i</code> could be stored in a register, which has no memory address.  In such a case, there would be no memory address to point to, so the compiler could prove that no other thread could access <code>i</code>.</p>\n\n<p>The question I am interested in is what if the compiler does not do this \"as-if\" optimization, and does indeed store the object.  Is the compiler permitted to store <code>i</code>, but do reordering as-if <code>i</code> was not actually stored?   From an implementation perspective, this would mean that <code>i</code> might be stored on a stack, and thus it would be possible to have a pointer point at it, but have the compiler assume nobody can see <code>i</code>, and do the re-order?</p>\n"}, {"tags": ["c++", "templates", "macros", "code-generation", "error-code"], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 2, "last_activity_date": 1528328682, "creation_date": 1528328682, "answer_id": 50731134, "question_id": 50729321, "link": "https://stackoverflow.com/questions/50729321/templates-vs-macros-for-c-error-code-boilerplate/50731134#50731134", "title": "Templates Vs Macros for C++ Error Code Boilerplate", "body": "<p>Your macro is needed to stringify the enum, and help to avoid boilerplate for specialization in std, but you can extract some code to create templates:</p>\n\n<pre><code>// Traits to retrieve name and mapping from enum.\ntemplate &lt;typename E&gt;\nstruct enum_traits\n{\n    static_assert(std::is_enum&lt;E&gt;::value, \"!\");\n\n    static const char* const name;\n    static const std::map&lt;E, std::string&gt; mapping;\n};\n\ntemplate &lt;typename E&gt;\nstruct ECategory_impl : std::error_category\n{\n    static_assert(std::is_enum&lt;E&gt;::value, \"!\");\n\n    const char* name() const noexcept override\n    {\n      return enum_traits&lt;E&gt;::name;\n    }\n\n    std::string message(int c) const override\n    {\n        const auto&amp; Map = enum_traits&lt;E&gt;::mapping;\n        E code = static_cast&lt;E&gt;(c);\n        auto itr = Map.find(code);\n        if (itr != Map.end())\n        {\n            return itr-&gt;second;\n        }\n        else\n        {\n            return \"(unrecognized error)\";\n        }\n    }\n};\n\ntemplate &lt;typename E&gt;\nstd::error_code make_error_code(E e)\n{\n    static_assert(std::is_enum&lt;E&gt;::value, \"!\");\n    static const ECategory_impl&lt;E&gt; categ{};\n    return {static_cast&lt;int&gt;(e), categ};\n}\n</code></pre>\n\n<p>and then the MACRO (Which might be omitted if you consider that now stuff to repeat is low enough):</p>\n\n<pre><code>#define MAKE_ERROR_CODE_CATEGORY(E)                      \\\n/* Stringification for the name*/                        \\\ntemplate &lt;&gt; const char* const enum_traits&lt;E&gt;::name = #E; \\\n/* Specialization in std */                              \\\nnamespace std                                            \\\n{                                                        \\\n    template &lt;&gt;                                          \\\n    struct is_error_code_enum&lt;E&gt; : true_type {};         \\\n}                                                        \\\n/* Alias for custom naming */                            \\\nusing E##_category = ECategory_impl&lt;E&gt;;\n//                                    ^\n// You might remove that final ';' for a usage `MAKE_ERROR_CODE_CATEGORY(E);`\n// instead of current `MAKE_ERROR_CODE_CATEGORY(E)`\n</code></pre>\n\n<p>Usage is then similar to:</p>\n\n<pre><code>enum class E {A, B};\ntemplate &lt;&gt;\nconst std::map&lt;E, std::string&gt; enum_traits&lt;E&gt;::mapping{\n    {E::A, \"A\"},\n    {E::B, \"E\"}\n};\n\nMAKE_ERROR_CODE_CATEGORY(E)\n</code></pre>\n\n<p><a href=\"https://ideone.com/4CQWeF\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 706, "user_id": 3886090, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6059e718df1b7411502f347255a29f60?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Lipscomb", "link": "https://stackoverflow.com/users/3886090/andrew-lipscomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 50731134, "answer_count": 1, "score": 2, "last_activity_date": 1528335499, "creation_date": 1528317960, "last_edit_date": 1528335499, "question_id": 50729321, "link": "https://stackoverflow.com/questions/50729321/templates-vs-macros-for-c-error-code-boilerplate", "title": "Templates Vs Macros for C++ Error Code Boilerplate", "body": "<p>TL;DR - can a boilerplate generation macro be implemented using templates? </p>\n\n<p>I have some code which makes use of the C++ std::error_code and error_category classes. I've found that once the number of error codes started to grow the amount of boilerplate being written for each was also growing very quickly. </p>\n\n<p>To work around this I've written some macros which should be statically checking and generating most of the boilerplate from the things we actually care about - the enum codes and the messages attached to them. These macros take in the enum and the messages as a const std::map.</p>\n\n<p>My question - can this sort of boilerplate generation be replaced with a template of some sort? Right now if this fails the goto advice for others has been \"check for static_asserts\" which make it a bit of a PITA to use. </p>\n\n<p>If it can't be simply replaced with templates, can code be added to improve the output of a failed compile so these are less painful to use? Right now a failed compile outputs both the static asserts and lot of other unneeded output. </p>\n\n<p>I've included some code below which demonstrates the macros - I've removed all of our namespace-ing related code so it may be a tad incorrect but should demonstrate the goal well enough.  </p>\n\n<pre><code>//C++14 definition - we are using C++11\ntemplate&lt; bool B, class T = void &gt;\nusing enable_if_t = typename std::enable_if&lt;B,T&gt;::type;\n\n//Generic template test for any other type\ntemplate &lt;typename T, typename = void&gt;\nstruct is_std_map : std::false_type {};\n\n//Specialised test for a std::map type\ntemplate &lt;typename T&gt;\nstruct is_std_map&lt;T, enable_if_t&lt;\n                    std::is_same&lt;typename T::value_type,\n                                std::pair&lt;const typename T::key_type,\n                                          typename T::mapped_type&gt;\n                    &gt;::value&gt;\n&gt; : std::true_type {};\n\n#define MAKE_ERROR_CODE_CATEGORY(EC, EC_MESSAGE_MAP)               \\\n/* Check that we have an enum type as the first arg, and a const std::map arg for the second */                 \\\nstatic_assert(std::is_enum&lt;EC&gt;::value, \"!\");                                             \\\nstatic_assert(std::is_const&lt;decltype(EC_MESSAGE_MAP)&gt;::value, \"!\" );                \\\nstatic_assert(is_std_map&lt;decltype(EC_MESSAGE_MAP)&gt;::value, \"!\");        \\\n/* Validate that the non-const types for our EC and our EC_MESSAGE_MAP are as expected*/                        \\\nstatic_assert(std::is_same&lt;                                                                                     \\\n                    std::remove_const&lt;EC&gt;::type,                                                                \\\n                    std::remove_const&lt;decltype(EC_MESSAGE_MAP)::key_type                                        \\\n                &gt;::type&gt;::value,                                                                                \\\n              \"!\");                          \\\nstatic_assert(std::is_same&lt;                                                                                     \\\n                    std::remove_const&lt;std::string&gt;::type,                                                       \\\n                    std::remove_const&lt;decltype(EC_MESSAGE_MAP)::mapped_type                                     \\\n                &gt;::type&gt;::value,                                                                                \\\n              \"!\");  \\\n/*Generates a standardised category for the provided EC */                                                      \\\nstruct EC## _category : std::error_category                                                                \\\n{                                                                                                               \\\n    const char* name() const noexcept override                                                                  \\\n    {                                                                                                           \\\n      return  #EC ;                                                                                             \\\n    }                                                                                                           \\\n    std::string message(int c) const override                                                                   \\\n    {                                                                                                           \\\n        EC code = static_cast&lt;EC&gt;(c);                                                                           \\\n        auto itr = EC_MESSAGE_MAP.find(code);                                                                   \\\n        if (itr != EC_MESSAGE_MAP.end())                                                                        \\\n        {                                                                                                       \\\n            return itr-&gt;second;                                                                                 \\\n        }                                                                                                       \\\n        else                                                                                                    \\\n        {                                                                                                       \\\n            return \"(unrecognized error)\";                                                                      \\\n        }                                                                                                       \\\n    }                                                                                                           \\                                                                                                    \\\n};\nnamespace std                                                                                                   \\\n{                                                                                                               \\\n    template &lt;&gt;                                                                                                 \\\n        struct is_error_code_enum&lt; EC &gt; : true_type {};                                   \\\n}                                                                                                               \\\n/* Declare a global function returning a static instance of the custom category */                              \\\nconst EC## _category&amp; EC## _category_generator()                     \\\n{                                                                                                               \\\n    static EC## _category c;                                                              \\\n    return c;                                                                                                   \\\n}                                                                                                               \\\n/* Adds the standard error code construction call */                                                            \\\ninline std::error_code make_error_code(EC e)                                              \\\n{                                                                                                               \\\n    return {static_cast&lt;int&gt;(e), EC## _category_generator()};                                                   \\\n}                                 \n</code></pre>\n"}, {"tags": ["c++", "qt", "qt3d"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9905500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52763e1ace92e8f35a2873f94cab354d?s=128&d=identicon&r=PG&f=1", "display_name": "Xxomen", "link": "https://stackoverflow.com/users/9905500/xxomen"}, "edited": false, "score": 0, "creation_date": 1528322186, "post_id": 50729813, "comment_id": 88468081, "body": "Thanks. How would I go about attaching the viewports to the main Qt3Dwindow? Based on the QML sample, the view ports have a QCameraSelector child node and have a singular viewport as a parent node. How do I attach the CameraSelector child node to the viewport, the four viewports to the main viewport, and finally the main viewport to the Qt3DWindow?"}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "reply_to_user": {"reputation": 33, "user_id": 9905500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52763e1ace92e8f35a2873f94cab354d?s=128&d=identicon&r=PG&f=1", "display_name": "Xxomen", "link": "https://stackoverflow.com/users/9905500/xxomen"}, "edited": false, "score": 0, "creation_date": 1528322630, "post_id": 50729813, "comment_id": 88468230, "body": "You can pass the parent object in the constructor. QViewport::QViewport(Qt3DCore::QNode *parent = nullptr)"}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "reply_to_user": {"reputation": 33, "user_id": 9905500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52763e1ace92e8f35a2873f94cab354d?s=128&d=identicon&r=PG&f=1", "display_name": "Xxomen", "link": "https://stackoverflow.com/users/9905500/xxomen"}, "edited": false, "score": 0, "creation_date": 1528323505, "post_id": 50729813, "comment_id": 88468471, "body": "You can use QFrameGraph. I will update the answer. Look into link <a href=\"http://doc.qt.io/qt-5.6/qt3d-cpp-example-main-cpp.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5.6/qt3d-cpp-example-main-cpp.html</a>"}, {"owner": {"reputation": 33, "user_id": 9905500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52763e1ace92e8f35a2873f94cab354d?s=128&d=identicon&r=PG&f=1", "display_name": "Xxomen", "link": "https://stackoverflow.com/users/9905500/xxomen"}, "edited": false, "score": 0, "creation_date": 1528329072, "post_id": 50729813, "comment_id": 88470017, "body": "It looks like the example may be a bit outdated. In newer iterations of QT3D C++ samples, they forego the use of Qt3DCore::QAspectEngine  and Qt3DRender::QFrameGraph seems to either be renamed/removed. I&#39;m able to set up a main view port and attach it to a technique filter, but since there&#39;s no framegraph class, I&#39;m not able to attach the technique filter to the framegraph nor am I able to change the current frame graph of my Qt3DExtras::Qt3DWindow. Here&#39;s one of the latest samples provided using Qt3D - <a href=\"https://doc.qt.io/qt-5/qt3d-simple-cpp-main-cpp.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qt3d-simple-cpp-main-cpp.html</a>"}], "tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": true, "score": 0, "last_activity_date": 1528323740, "last_edit_date": 1528323740, "creation_date": 1528320123, "answer_id": 50729813, "question_id": 50729052, "link": "https://stackoverflow.com/questions/50729052/how-do-i-set-up-multiple-viewports-using-qt3d-without-having-to-use-qml/50729813#50729813", "title": "How do I set up multiple viewports using Qt3D without having to use QML", "body": "<p>You have to use <code>QViewport</code> class and <code>setNormalizedRect</code> function to specify with in [0.0, 0.0, 1.0, 1.0].</p>\n\n<p>Something like below.</p>\n\n<pre><code>//DECLARE A FRAME GRAPH\nQt3DRender::QFrameGraph *frameGraph = new Qt3DRender::QFrameGraph();\nQt3DRender::QTechniqueFilter *techniqueFilter = new Qt3DRender::QTechniqueFilter();\n\nQt3DRender::QViewport *viewport1 = new Qt3DRender::QViewport(techniqueFilter);\nQt3DRender::QViewport *viewport2 = new Qt3DRender::QViewport(techniqueFilter);\nQt3DRender::QViewport *viewport3 = new Qt3DRender::QViewport(techniqueFilter);\nQt3DRender::QViewport *viewport4 = new Qt3DRender::QViewport(techniqueFilter);\n\nviewport1-&gt;setNormalizedRect(QRectF(0, 0, 0.5, 0.5));\nviewport2-&gt;setNormalizedRect(QRectF(0.5, 0, 0.5, 0.5));\nviewport3-&gt;setNormalizedRect(QRectF(0, 0.5, 0.5, 0.5));\nviewport4-&gt;setNormalizedRect(QRectF(0.5, 0.5, 0.5, 0.5));\n\n//SET ACTIVE FRAME GRAPH NODE TO YOUR WINDOW\nyour_qt3d_wndObject-&gt;setActiveFrameGraph(frameGraph-&gt;activeFrameGraph());\n</code></pre>\n\n<p><a href=\"https://doc-snapshots.qt.io/qt5-5.9/qt3drender-qviewport.html\" rel=\"nofollow noreferrer\">https://doc-snapshots.qt.io/qt5-5.9/qt3drender-qviewport.html</a></p>\n"}], "owner": {"reputation": 33, "user_id": 9905500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52763e1ace92e8f35a2873f94cab354d?s=128&d=identicon&r=PG&f=1", "display_name": "Xxomen", "link": "https://stackoverflow.com/users/9905500/xxomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 1, "accepted_answer_id": 50729813, "answer_count": 1, "score": 3, "last_activity_date": 1528323740, "creation_date": 1528316889, "question_id": 50729052, "link": "https://stackoverflow.com/questions/50729052/how-do-i-set-up-multiple-viewports-using-qt3d-without-having-to-use-qml", "title": "How do I set up multiple viewports using Qt3D without having to use QML", "body": "<p>I'd like to set up a multiple view port scene akin to <a href=\"https://doc.qt.io/archives/qt-5.10/qt3d-multiviewport-example.html\" rel=\"nofollow noreferrer\">https://doc.qt.io/archives/qt-5.10/qt3d-multiviewport-example.html</a>\nwithout having to use QML.</p>\n\n<p>At the moment I've got a single view working with:</p>\n\n<pre><code>Qt3DExtras::Qt3DWindow* createView ( Qt3DCore::QEntity* rootEntity ) {\n\n    Qt3DExtras::Qt3DWindow* view = new Qt3DExtras::Qt3DWindow();\n\n    Qt3DRender::QCamera* camera = view-&gt;camera();\n    camera-&gt;lens()-&gt;setPerspectiveProjection ( 45.0f, 16.0f / 9.0f, 0.1f, 1000.0f );\n    camera-&gt;setPosition ( QVector3D ( 0, 0, 10.0f ) );\n    camera-&gt;setViewCenter ( QVector3D ( 0, 0, 0 ) );\n\n    Qt3DExtras::QOrbitCameraController* manipulator = new Qt3DExtras::QOrbitCameraController ( rootEntity );\n    manipulator-&gt;setLinearSpeed ( 5.0f );\n    manipulator-&gt;setLookSpeed ( 180.f );\n    manipulator-&gt;setZoomInLimit ( 5.0f );\n    manipulator-&gt;setCamera ( camera );\n\n    return view;\n}\n</code></pre>\n\n<p>In essence, the question is how do I convert the QML code supplied in the example to C++.</p>\n"}, {"tags": ["c++", "serialization", "save", "load", "rapidjson"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4573047"}, "edited": false, "score": 0, "creation_date": 1528318305, "post_id": 50728931, "comment_id": 88466560, "body": "What&#39;s your question?"}, {"owner": {"reputation": 109, "user_id": 9630627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4e166f1be36452a06241d7431dba10?s=128&d=identicon&r=PG&f=1", "display_name": "Taknie", "link": "https://stackoverflow.com/users/9630627/taknie"}, "edited": false, "score": 0, "creation_date": 1528321478, "post_id": 50728931, "comment_id": 88467829, "body": "I want to save the &quot;person&quot; objects from vector to a file, and load them back to a vector when I open the program again in order to expand the database."}], "answers": [{"tags": [], "owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "is_accepted": false, "score": 1, "last_activity_date": 1528383621, "last_edit_date": 1528383621, "creation_date": 1528321756, "answer_id": 50730118, "question_id": 50728931, "link": "https://stackoverflow.com/questions/50728931/save-load-vector-of-object-using-rapidjson-c/50730118#50730118", "title": "save/load vector of object using rapidjson c++", "body": "<p>There is no point to have  vector of <code>person</code>, as it will be very complex to serialize and store as JSON.</p>\n\n<p>Instead, you can maintain serialized object strings in a <code>vector</code> and store them as an <code>json</code> array into a <code>Document</code>.</p>\n\n<p>You can store your <em>person</em> json document to local storage with <code>FileWriteStream</code>:</p>\n\n<pre><code>#include \"include/rapidjson/writer.h\"\n#include \"include/rapidjson/stringbuffer.h\"\n#include \"include/rapidjson/document.h\"\n#include \"include/rapidjson/ostreamwrapper.h\"\n#include \"include/rapidjson/filewritestream.h\"\n#include \"include/rapidjson/filereadstream.h\"\n#include \"fstream\"\n#include \"iostream\"\n#include \"sstream\"\n\nvector&lt;string&gt; Save; // replace vector&lt;person&gt; with vector&lt;string&gt; \n//\nperson P1(\"Tak\", \"Nie\", 20);\nperson P2(\"Yes\", \"No\", 10);\n// more persons\n//\nSave.push_back(P1.serialize());\nSave.push_back(P2.serialize());\n//  push more persons\n//\nDocument d;        // rapidjson Document\nd.SetArray();      // to store Array of objects\nrapidjson::Document::AllocatorType&amp; allocator = d.GetAllocator();\n// iterate over objects vector created above\n// and create rapidjson Values for each object\n// Then store the object in Document\nfor (auto it = Save.begin(); it!=Save.end(); it++){\n    Value n((*it).c_str(), allocator);\n    d.PushBack(n,allocator);\n}\n// save rapidjson Document to local storage file name \"output.json\"\nFILE* fp = fopen(\"output.json\", \"wb\");\nchar writeBuffer[65536];\nFileWriteStream os(fp, writeBuffer, sizeof(writeBuffer));\nWriter&lt;FileWriteStream&gt; writer(os);\nd.Accept(writer);\nfclose(fp);\n</code></pre>\n\n<p>Now all your objects were serialized, store as elements in array in the document. </p>\n\n<hr>\n\n<p>Now to restore the objects into an array of classes of <code>person</code>, say <code>P[]</code>, we can do the reverse, first use <code>FileReadStream</code> to restore stored <code>rapidjson</code> array into a <code>Document</code>, then iterate over your document an fetch objects one by one, use the data to create new <code>person</code> classes:</p>\n\n<pre><code>// restore saved rapidjson Document from file \"output.json\"\nFILE* fp = fopen(\"output.json\", \"rb\"); // non-Windows use \"r\"\nchar readBuffer[65536];\nFileReadStream is(fp, readBuffer, sizeof(readBuffer));\nDocument d;\nd.ParseStream(is);\nfclose(fp);\n//\nassert(d.IsArray());\nint size= d.Size();\nperson* P[size+1]; // Now create an array of class person to restore retrieved objects.\n// person object paramets\n    std::string theName;\n    std::string theSur;\n    int theid;\n// loop over the Array Document\nfor (int i = 0; i &lt; d.Size(); i++)\n{\n    Document P1_doc;                 // new rapidjson Document\n    P1_doc.Parse(d[i].GetString());  // parse each object from d into new  Dcoument P1_doc\n    assert(P1_doc.IsObject());\n    // now restore each person object data\n    if(P1_doc.HasMember(\"name\")){\n        const rapidjson::Value&amp; name = P1_doc[\"name\"];\n        theName =  name.GetString();\n    }\n    if (P1_doc.HasMember(\"surname\")){\n         const rapidjson::Value&amp; surname = P1_doc[\"surname\"];\n         theSur =  surname.GetString();\n    }\n    if (P1_doc.HasMember(\"id\")){\n         const rapidjson::Value&amp; id = P1_doc[\"id\"];\n         theid =  id.GetInt();\n    }\n    // Now restore a person object from retrieved data \n    P[i] = new person(theName, theSur, theid);\n}\n\nreturn 0;\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9630627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4e166f1be36452a06241d7431dba10?s=128&d=identicon&r=PG&f=1", "display_name": "Taknie", "link": "https://stackoverflow.com/users/9630627/taknie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528383621, "creation_date": 1528316510, "question_id": 50728931, "link": "https://stackoverflow.com/questions/50728931/save-load-vector-of-object-using-rapidjson-c", "title": "save/load vector of object using rapidjson c++", "body": "<p>I am trying to make a simple \"person\" vector of objects which can be saved and then loaded from file to vector of objects. I made a function found in some tutorials which returns all the content from class, but I have no clue what to do now, to put it into a file. Should I use i/o stream operators or something? At now I have the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;            // person.h\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\n#include \"rapidjson/writer.h\"\n#include \"rapidjson/stringbuffer.h\"\nusing namespace rapidjson;\n\nclass person {\npublic:\n    std::string name;\n    string surname;\n    int age;\n    person();\n    ~person();\n    person(string, string, int);\n\n\n    template &lt;typename Writer&gt;\n    void Serialize(Writer&amp; writer) const {\n        writer.StartObject();\n        writer.String(\"name\");\n        writer.String(name.c_str());\n        writer.String(\"surname\");\n        writer.String(surname.c_str());\n        writer.String((\"id\"));\n        writer.Uint(age);\n        writer.EndObject();\n    }\n\n    std::string serialize(){\n        StringBuffer s;\n        Writer&lt;StringBuffer&gt; writer(s);\n        Serialize(writer);\n        return  s.GetString();\n    }\n};\n#include \"person.h\"           // person.cpp\n\nperson::person() {\n\n}\n\nperson::~person() {\n\n}\n\nperson::person(string name, string surname, int age) : name(name), surname(surname), age(age) {\n\n}\n#include \"person.h\"            // main.cpp\n\nint main() {\n\n    vector&lt;person&gt; Save;\n\n    person P1(\"Tak\", \"Nie\", 20);\n    person P2(\"Yes\", \"No\", 10);\n\n    Save.push_back(P1);\n    Save.push_back(P2);\n\n    cout &lt;&lt; P1.serialize();\n    cout &lt;&lt; P2.serialize();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1528318149, "post_id": 50728895, "comment_id": 88466490, "body": "You&#39;re giving <code>x+3,y+3</code> as width and height to <a href=\"https://docs.opencv.org/3.4.1/d2/d44/classcv_1_1Rect__.html#a5a41149f4b012b9f323b5913454375a1\" rel=\"nofollow noreferrer\"><code>cv::Rect(x,y,width,height)</code></a>. So as the values of x and y increases so do the dimensions of your rectangles."}], "answers": [{"tags": [], "owner": {"reputation": 724, "user_id": 4627737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f5f5f8408ceca1773fd142cba4bc6a97?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel R.", "link": "https://stackoverflow.com/users/4627737/daniel-r"}, "is_accepted": true, "score": 4, "last_activity_date": 1528324375, "last_edit_date": 1528324375, "creation_date": 1528318319, "answer_id": 50729414, "question_id": 50728895, "link": "https://stackoverflow.com/questions/50728895/c-opencv-rect-size-increasing/50729414#50729414", "title": "c++ OpenCV Rect size increasing", "body": "<p>The use of <code>cv::Rect(x, y, x + 3, y + 3);</code> is not in your sense because the last parameters does not mean the coordinates of lower right corner of the Rectangle as you are thinking. Having a look at the <a href=\"https://docs.opencv.org/3.4.1/d2/d44/classcv_1_1Rect__.html#a5a41149f4b012b9f323b5913454375a1\" rel=\"nofollow noreferrer\">OpenCV doc</a> or into <a href=\"https://github.com/opencv/opencv/blob/master/modules/core/include/opencv2/core/types.hpp#L1765\" rel=\"nofollow noreferrer\"><code>types.hpp</code></a>, you will have </p>\n\n<pre><code>template&lt;typename _Tp&gt; inline\nRect_&lt;_Tp&gt;::Rect_(_Tp _x, _Tp _y, _Tp _width, _Tp _height)\n: x(_x), y(_y), width(_width), height(_height) {}\n</code></pre>\n\n<p>The last 2 parameters stands for width and height of the Rectangle, so to fix your code, you will need\n<code>cv::Rect my_region = cv::Rect(x, y, 3, 3);</code></p>\n"}], "owner": {"reputation": 669, "user_id": 5991761, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/984565203d53cc51598def5bb244f159?s=128&d=identicon&r=PG&f=1", "display_name": "Mint.K", "link": "https://stackoverflow.com/users/5991761/mint-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 50729414, "answer_count": 1, "score": 1, "last_activity_date": 1528324375, "creation_date": 1528316352, "last_edit_date": 1528317355, "question_id": 50728895, "link": "https://stackoverflow.com/questions/50728895/c-opencv-rect-size-increasing", "title": "c++ OpenCV Rect size increasing", "body": "<p>I am trying to learn how cv::Rect() works.\nI have a 200x200 image and I'd like break this image into 3x3 rectangles.\nHere's my code:</p>\n\n<pre><code>for(int y = 0; y &lt; img.rows; y+=3;) // img.rows = 200\n{\n    for(int x =0; x &lt; img.cols; x+=3){ // img.cols = 200\n        cv:: Rect my_region = cv::Rect(x, y, x + 3, y + 3);\n        Mat my_mat = img(my_region).clone();\n        int mat_Size = mymat.total(); \n        cout &lt;&lt; \"region size: \" &lt;&lt; mat_Size &lt;&lt; endl;\n        if(x==6){  // test up to 6\n           return - 1;\n        }\n    }\n}\n</code></pre>\n\n<p>mat_size should be consistently 9 because I am generating 3x3 rectangles. However, it's actually increasing by 9 every time: 9 -> 18 -> 27. Which is not what I intended to do. How do I fix it? Please help.</p>\n"}, {"tags": ["c++", "c++11", "templates", "variadic", "partial-ordering"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3114918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xD3lk.png?s=128&g=1", "display_name": "bigtit", "link": "https://stackoverflow.com/users/3114918/bigtit"}, "edited": false, "score": 0, "creation_date": 1528317401, "post_id": 50728742, "comment_id": 88466168, "body": "Actually I tried other writings with the primary template having implementations and they worked fine. So I assume what you mean &#39;should&#39; here is a convention?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "reply_to_user": {"reputation": 93, "user_id": 3114918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xD3lk.png?s=128&g=1", "display_name": "bigtit", "link": "https://stackoverflow.com/users/3114918/bigtit"}, "edited": false, "score": 0, "creation_date": 1528317482, "post_id": 50728742, "comment_id": 88466210, "body": "@bigint, Oh, yes, the primary template can have an implementation. It&#39;s just that in your case, <code>max&lt;&gt;::value</code> makes no sense whatsoever, so you should leave it undefined. I&#39;ve amended the answer to clarify."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1528327314, "post_id": 50728742, "comment_id": 88469570, "body": "@Frank One can argue that <code>max&lt;&gt;::value</code> should be <code>std::numeric_limits&lt;int&gt;::min()</code>. Otherwise, the base-template should require at least one template-argument."}], "tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": false, "score": 2, "last_activity_date": 1528317515, "last_edit_date": 1528317515, "creation_date": 1528315762, "answer_id": 50728742, "question_id": 50728631, "link": "https://stackoverflow.com/questions/50728631/c-template-cannot-match-the-last-template-in-variadic-class-template/50728742#50728742", "title": "C++ template: cannot match the last template in variadic class template", "body": "<p>The reason you are getting that error is that every invocation of the template must first match the base template, and specialization only kicks in after that.</p>\n\n<p>Your base template should match any number of arguments, and have no implementation (since <code>max&lt;&gt;::value</code> makes no sense), and have a single variadic argument, with all your other classes be specialization of that. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;int... cs&gt;\nstruct max;\n\ntemplate &lt;int a, int b, int... cs&gt;\nstruct max&lt;a, b, cs...&gt;: std::integral_constant&lt;int, (a&gt;b? max&lt;a, cs...&gt;::value: max&lt;b, cs...&gt;::value)&gt; {};\ntemplate &lt;int a, int b&gt;\nstruct max&lt;a, b&gt;: std::integral_constant&lt;int, (a&gt;b? max&lt;a&gt;::value: max&lt;b&gt;::value)&gt; {};\ntemplate &lt;int a&gt;\nstruct max&lt;a&gt;: std::integral_constant&lt;int, a&gt; {};\n\nint main() {\n  std::cout &lt;&lt; max&lt;2,1,5,7&gt;::value &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528317212, "post_id": 50728746, "comment_id": 88466082, "body": "why dont you make it an answer? It doesnt answer the question literally, but thats what OP was actually after, i guess"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528317431, "post_id": 50728746, "comment_id": 88466180, "body": "@user463035818 I am not sure about this, since OP asked for rules. He even knew how to make his solution work by adding another version of primary template."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528317569, "post_id": 50728746, "comment_id": 88466251, "body": "oh you are right. I misread the question, was already wondering why top answers does not mention how to fix it ;)"}], "tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": false, "score": 2, "last_activity_date": 1528316365, "last_edit_date": 1528316365, "creation_date": 1528315769, "answer_id": 50728746, "question_id": 50728631, "link": "https://stackoverflow.com/questions/50728631/c-template-cannot-match-the-last-template-in-variadic-class-template/50728746#50728746", "title": "C++ template: cannot match the last template in variadic class template", "body": "<p>Not an answer, but why not simply...</p>\n\n<pre><code>template &lt;int a, int... bs&gt;\nstruct max : std::integral_constant&lt;int,\n   (a &gt; max&lt;bs...&gt;::value ? a : max&lt;bs...&gt;::value)&gt; {};\n\ntemplate &lt;int a&gt;\nstruct max&lt;a&gt; : std::integral_constant&lt;int, a&gt; {};\n</code></pre>\n\n<p>...?</p>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 3114918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xD3lk.png?s=128&g=1", "display_name": "bigtit", "link": "https://stackoverflow.com/users/3114918/bigtit"}, "edited": false, "score": 0, "creation_date": 1528317532, "post_id": 50728816, "comment_id": 88466237, "body": "So does the standard require the following partial spec template must be a specialized version of the primary one?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 93, "user_id": 3114918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xD3lk.png?s=128&g=1", "display_name": "bigtit", "link": "https://stackoverflow.com/users/3114918/bigtit"}, "edited": false, "score": 0, "creation_date": 1528317670, "post_id": 50728816, "comment_id": 88466290, "body": "@bigtit, I didn&#39;t get your drift. Please elaborate."}, {"owner": {"reputation": 93, "user_id": 3114918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xD3lk.png?s=128&g=1", "display_name": "bigtit", "link": "https://stackoverflow.com/users/3114918/bigtit"}, "edited": false, "score": 0, "creation_date": 1528317937, "post_id": 50728816, "comment_id": 88466407, "body": "you said <code>since the base class template requires at least two template parameters.</code> so I assume that the c++ standard force all the templates after the base one to be a specialized version of it, as in this case <code>max&lt;a&gt;</code> is not a more specialized version of the base template?"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1528316052, "creation_date": 1528316052, "answer_id": 50728816, "question_id": 50728631, "link": "https://stackoverflow.com/questions/50728631/c-template-cannot-match-the-last-template-in-variadic-class-template/50728816#50728816", "title": "C++ template: cannot match the last template in variadic class template", "body": "<p>When you define a class template as:</p>\n\n<pre><code>template &lt;int a, int b, int... cs&gt; struct max { ... };\n</code></pre>\n\n<p>The following is a valid specialization.</p>\n\n<pre><code>template &lt;int a, int b&gt; struct max&lt;a, b&gt; { ... };\n</code></pre>\n\n<p>However, the following is not.</p>\n\n<pre><code>template &lt;int a&gt; struct max&lt;a&gt; { ... };\n</code></pre>\n\n<p>since the base class template requires at least two template parameters.</p>\n"}], "owner": {"reputation": 93, "user_id": 3114918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xD3lk.png?s=128&g=1", "display_name": "bigtit", "link": "https://stackoverflow.com/users/3114918/bigtit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "accepted_answer_id": 50728816, "answer_count": 3, "score": 4, "last_activity_date": 1528326506, "creation_date": 1528315278, "last_edit_date": 1528326506, "question_id": 50728631, "link": "https://stackoverflow.com/questions/50728631/c-template-cannot-match-the-last-template-in-variadic-class-template", "title": "C++ template: cannot match the last template in variadic class template", "body": "<p>I'm learning C++11 variadic template and created a template struct to calculate the max number of a given list and tried:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;int a, int b, int... cs&gt;\nstruct max: std::integral_constant&lt;int, (a&gt;b? max&lt;a, cs...&gt;::value: max&lt;b, cs...&gt;::value)&gt; {};\ntemplate &lt;int a, int b&gt;\nstruct max&lt;a, b&gt;: std::integral_constant&lt;int, (a&gt;b? max&lt;a&gt;::value: max&lt;b&gt;::value)&gt; {};\ntemplate &lt;int a&gt;\nstruct max&lt;a&gt;: std::integral_constant&lt;int, a&gt; {};\n\nint main() {\n  std::cout &lt;&lt; max&lt;2,1,5,7&gt;::value &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p>but g++ complains:</p>\n\n<pre><code>test.cc:7:58: error: wrong number of template arguments (1, should be at least 2)\n struct max&lt;a, b&gt;: std::integral_constant&lt;int, (a&gt;b? max&lt;a&gt;::value : max&lt;b&gt;::value)&gt; {};\n\ntest.cc:9:13: error: wrong number of template arguments (1, should be at least 2)\n struct max&lt;a&gt;: std::integral_constant&lt;int, a&gt; {};\n</code></pre>\n\n<p>I can make it run by adding a simple declaration ahead:</p>\n\n<pre><code>template &lt;int...&gt;\nstruct max;\n</code></pre>\n\n<p>and change the first template above to:</p>\n\n<pre><code>template &lt;int a, int b, int... cs&gt;\nstruct max&lt;a, b, cs...&gt;: ...\n</code></pre>\n\n<p>I referred to cppreference: <a href=\"https://en.cppreference.com/w/cpp/language/partial_specialization#Partial_ordering\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/partial_specialization#Partial_ordering</a>\nbut I cannot find any useful explanation for my case.</p>\n\n<p>The problem may come from the last template (<code>max&lt;a&gt;</code>) with only one template parameter, which is not a specialized version of the primary one.</p>\n\n<p>So my question is:</p>\n\n<p>Why <code>max&lt;a&gt;</code> cannot be matched? Is there any rules or standards dealing with this?</p>\n\n<p>=================================================================</p>\n\n<p>okay, I found the C++ standards (Document No. N4659) that says:</p>\n\n<blockquote>\n  <p>[ Note: Partial specializations of class templates are found by\n  looking up the primary class template and <strong>then considering</strong> all partial\n  specializations of that template. If a using-declaration names a class\n  template, partial specializations introduced after the\n  using-declaration are effectively visible because the primary template\n  is visible (17.5.5). \u2014 end note ]</p>\n</blockquote>\n\n<p>So I think any partial specialized template that does not specialize from the base/primary one is considered to be an error, even though sometimes we can generate some non-specialized forms of expression from normal ones.</p>\n"}, {"tags": ["c++", "file", "search"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1528314757, "post_id": 50728498, "comment_id": 88464956, "body": "Short answer - yes"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1528314848, "post_id": 50728498, "comment_id": 88464995, "body": "Not really - binary search requires random access, and you can&#39;t effectively perform random access on a text file (i.e. a file made up of variable length lines)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528314935, "post_id": 50728498, "comment_id": 88465048, "body": "@NeilButterworth you can scan for the nearest carriage return, or file may contain fixed length records."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528314939, "post_id": 50728498, "comment_id": 88465052, "body": "@NeilButterworth You <i>can</i> perform random access in a file&#39;s data. It&#39;s up to the file format if that random access is meaningful or not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528314972, "post_id": 50728498, "comment_id": 88465072, "body": "@Francois Which is why I said &quot;effectively&quot;."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1528314985, "post_id": 50728498, "comment_id": 88465078, "body": "@NeilButterworth You could jump to a random place in file, search for a new linebreak and continuing from there. The algorithm would be still a little more complicated than standard binary search but it would be entirely possible. It makes sense only if files are large, though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528315016, "post_id": 50728498, "comment_id": 88465103, "body": "@Slava Which is why I qualified my comment with &quot;variable length lines&quot;."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528315095, "post_id": 50728498, "comment_id": 88465136, "body": "@NeilButterworth which is why I said it either fixed length or you can scan for next <code>\\n</code>"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528315181, "post_id": 50728498, "comment_id": 88465182, "body": "@Slava Just that then it technically wouldn&#39;t be binary search (with respect to line records if they were variable-length)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1528315750, "post_id": 50728498, "comment_id": 88465446, "body": "@DanielLangr why not? You find position in file by binary search, you just adjust it by actual data. Still binary search."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528315948, "post_id": 50728498, "comment_id": 88465533, "body": "@Slava That&#39;s why I wrote <i>&quot;with respect to line records&quot;</i>, since such algorithm might move over records in a different way than true binary search algorithm. Imagine a file where you have 100 single-character lines and one 1000000 character line. Just finding <code>\\n</code> of the latter effectively makes searching linear."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1528316060, "post_id": 50728498, "comment_id": 88465582, "body": "@DanielLangr the fact that it will not work efficiently in such case does not mean it is not binary search anymore AFAIK"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528316656, "post_id": 50728498, "comment_id": 88465841, "body": "@Slava I am not sure whether <i>O(log n)</i> complexity is guaranteed in this case. Just another example that came to my mind: Suppose <code>i</code>th line of the input file has <code>2&lt;&lt;i</code> characters."}], "answers": [{"tags": [], "owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "is_accepted": false, "score": 0, "last_activity_date": 1528316735, "creation_date": 1528316735, "answer_id": 50729004, "question_id": 50728498, "link": "https://stackoverflow.com/questions/50728498/implementing-binary-search-in-a-sorted-text-file/50729004#50729004", "title": "Implementing binary search in a sorted text file?", "body": "<p>in theory: yes, but it will be quite inefficient.</p>\n\n<p>i'd recommend to put the data in a sqlite database, that way you still have a single file, but can nicely query/search for entries.</p>\n"}, {"tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": -1, "last_activity_date": 1528316902, "creation_date": 1528316902, "answer_id": 50729056, "question_id": 50728498, "link": "https://stackoverflow.com/questions/50728498/implementing-binary-search-in-a-sorted-text-file/50729056#50729056", "title": "Implementing binary search in a sorted text file?", "body": "<p>tl;dr: Yes, but it's often not worth it</p>\n\n<p>You neglected to mention how the text file is sorted, exactly, and whether there are escaped characters, quotation marks, multi-octet characters etc. - these would all impact the answer.</p>\n\n<p>But let's make the following assumptions:</p>\n\n<ul>\n<li>Plain printable ASCII text, with no newlines in each string.</li>\n<li>Newlines (i.e. 0xA characters) separate strings.</li>\n</ul>\n\n<p>This is still not enough for a set of assumptions, because - maybe some of the strings are much longer than the others? In fact, what about the not-that-extreme case of n strings overall, but a few of them take up most of the characters? If you start sampling characters in the file, you'll need to go back and forth, linearly, at least to both edges of a single string (or forwarded until you hit a newline twice). </p>\n\n<p>So let's add more assumptions, although frankly - they're quite invalid:</p>\n\n<ul>\n<li>You know the minimum Min and maximum Max string lengths.</li>\n<li>The ratio R of minimum to maximum length is not very high</li>\n</ul>\n\n<p>This makes it at least theoretically reasonable to start reading from some arbitrary point in the file, and look for a complete string. However, files are usually on disks; and disks are accessed by blocks. So for reading even a single character from the file you need to read a whole block of size B (think of B as, say, 1 KiB as a reasonable example). We'll assume Max &lt; B, otherwise you're in the huge-strings case.</p>\n\n<p>Another point to be made is that disk latencies are high. This is especially true for magnetic (or optical disks), where you can wait as much as 10 msec for a single read! If you read sequentially, there's no need to \"seek\" or lookup the position you're interested in, and you could make use of the disk's full bandwidth. This is less of a problem with SSDs, but it's still not negligible.</p>\n\n<p>So, as you can see, there's quite a bit of overhead for your binary search. It may still be worth it your file is really really large relative to Min, Max, R and B. So in a file of several Gigabytes, I'd certainly consider it. Otherwise - probably not worth the bother.</p>\n"}], "owner": {"reputation": 1, "user_id": 9890733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7bINLONKxc/AAAAAAAAAAI/AAAAAAAAAFE/bTP0GZEk5IM/photo.jpg?sz=128", "display_name": "Manas Sharma", "link": "https://stackoverflow.com/users/9890733/manas-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540203271, "creation_date": 1528314732, "last_edit_date": 1540203271, "question_id": 50728498, "link": "https://stackoverflow.com/questions/50728498/implementing-binary-search-in-a-sorted-text-file", "title": "Implementing binary search in a sorted text file?", "body": "<p>Is there a way by which instead of copying the data of file directly implement search in it?</p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528314408, "post_id": 50728384, "comment_id": 88464785, "body": "Perhaps you could use an implicit conversion operator to <code>Grandparent&amp;</code>. Edit : It seems like private inheritance hides an implicit conversion operator to <code>Grandparent&amp;</code>..."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 6, "creation_date": 1528314520, "post_id": 50728384, "comment_id": 88464835, "body": "Please explain why you need such strange behavior. There might be a better design that will work for your needs without pulling crazy stunts like that."}, {"owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "edited": false, "score": 0, "creation_date": 1528314857, "post_id": 50728384, "comment_id": 88465000, "body": "If I can use <code>using</code> to publicly expose privately inherited member variables, why can&#39;t I do the same for privately inherited bases? I don&#39;t see any fundamental differences here, so I don&#39;t think what I&#39;m asking for is unreasonable"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1528315045, "post_id": 50728384, "comment_id": 88465114, "body": "Please read <a href=\"https://meta.stackexchange.com/questions/66377\">What is the X Y problem?</a>  The comment from R Sahu is very on point.  It&#39;s likely that the answer to your problem is that you don&#39;t need to do this."}, {"owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "edited": false, "score": 0, "creation_date": 1528315173, "post_id": 50728384, "comment_id": 88465177, "body": "Child is a Grandparent, but not a Parent. Parent is a Grandparent too. I see exactly no problem here."}, {"owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "edited": false, "score": 0, "creation_date": 1528320363, "post_id": 50728384, "comment_id": 88467448, "body": "I&#39;ve updated the question with the description of my use case."}], "answers": [{"comments": [{"owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "edited": false, "score": 0, "creation_date": 1528316097, "post_id": 50728700, "comment_id": 88465598, "body": "Technically, Child is still Parent privately. This properly can be used in its private methods, for instance. The fact that it can&#39;t expose part but not all of that inheritance publicly is a pity, but I see it as a language shortcoming rather than something which is fundamentally incorrect"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1528315575, "creation_date": 1528315575, "answer_id": 50728700, "question_id": 50728384, "link": "https://stackoverflow.com/questions/50728384/inherit-parent-privately-while-inheriting-its-grandparent-publicly-in-c/50728700#50728700", "title": "Inherit parent privately while inheriting its grandparent publicly in C++", "body": "<p>No, there is no \"cleaner\" way. </p>\n\n<p>Public inheritance expresses is-a relationship, and private does not. Once you marked that your <code>Child</code> is not <code>Parent</code>, your lost all claims to say that <code>Child</code> is a <code>Grandparent</code> - you broke transitivity chain. The only way to establish <code>Child</code> as a <code>Grandparent</code> is to <strong>also</strong> inherit it from <code>Grandparent</code> - but I am pretty sure you do not want to go this road.</p>\n"}, {"comments": [{"owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "edited": false, "score": 0, "creation_date": 1528317247, "post_id": 50728835, "comment_id": 88466099, "body": "I want to expose the inherited property of being <code>Grandparent</code> in <code>Child</code>, but not the rest of the Parent&#39;s interface. It&#39;s up to <code>Child</code> to define its own interface any way it wants, and grant any sort of partial access to what it has access to by itself. The <code>using</code> directive allows doing exactly that."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 0, "last_activity_date": 1528316155, "creation_date": 1528316155, "answer_id": 50728835, "question_id": 50728384, "link": "https://stackoverflow.com/questions/50728384/inherit-parent-privately-while-inheriting-its-grandparent-publicly-in-c/50728835#50728835", "title": "Inherit parent privately while inheriting its grandparent publicly in C++", "body": "<p>There is a conceptual problem with implementing <code>Child</code> in terms of <code>Parent</code>, but only making it a <code>Grandparent</code>:</p>\n\n<p>It implies that <code>Parent</code>'s contract is broken, meaning the implementation of <code>Child</code> intimately depends on the particulars of the implementation of <code>Parent</code>. We use abstraction and encapsulation isolating us from those details for a reason.</p>\n\n<p>Otherwise, you could simply make <code>Child</code> a <code>Parent</code> too.</p>\n\n<p>Therefore, C++ never added any syntax to allow this.</p>\n"}, {"comments": [{"owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "edited": false, "score": 0, "creation_date": 1528321414, "post_id": 50729973, "comment_id": 88467803, "body": "Sadly, that would require to change Parent. Still a valid solution, thanks!"}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 1, "last_activity_date": 1528321281, "last_edit_date": 1528321281, "creation_date": 1528320972, "answer_id": 50729973, "question_id": 50728384, "link": "https://stackoverflow.com/questions/50728384/inherit-parent-privately-while-inheriting-its-grandparent-publicly-in-c/50729973#50729973", "title": "Inherit parent privately while inheriting its grandparent publicly in C++", "body": "<p>You can inherit <code>Grandparent</code> also directly. This requires <code>virtual</code> inheritance, as is usually the case with multiple inheritance.</p>\n\n<pre><code>class Grandparent {};\n\nclass Parent: virtual public Grandparent {};\n\nclass Child: Parent, virtual public Grandparent\n{\n  // No special treatment needed, interface is inherited automatically\n};\n</code></pre>\n\n<p>This actually makes sense in the context of the idea of private inheritance. You may think of private inheritance as \"I am too lazy to add a <code>Parent</code> member to <code>Child</code>, so I'll implement it with inheritance instead\". If you do it \"properly\" with composition, it becomes more like regular code with delegation:</p>\n\n<pre><code>class Grandparent\n{\npublic:\n    virtual int GrandparentMethod() {return 8;}\n};\n\nclass Parent: public Grandparent {};\n\nclass Child: public Grandparent\n{\npublic:\n    virtual int GrandparentMethod() {return parent.GrandparentMethod();}\n\nprivate:\n    Parent parent;\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1528397689, "creation_date": 1528397689, "answer_id": 50748383, "question_id": 50728384, "link": "https://stackoverflow.com/questions/50728384/inherit-parent-privately-while-inheriting-its-grandparent-publicly-in-c/50748383#50748383", "title": "Inherit parent privately while inheriting its grandparent publicly in C++", "body": "<pre><code>class Grandparent {\npublic:\n  virtual void foo() = 0;\n};\n\nclass Parent: public Grandparent {\npublic:\n  virtual void foo() final { std::cout &lt;&lt; \"Dance!\\n\"; }\n};\n\n\ntemplate&lt;class D&gt;\nstruct proxy_Grandparent:Grandparent {\n  virtual void foo() final {\n    return proxy().foo();\n  }\nprivate:\n  D* self() { return static_cast&lt;D*&gt;(this); }\n  D const* self() const { return static_cast&lt;D const*&gt;(this); }\n  decltype(auto) proxy() {\n    return self()-&gt;get_proxy();\n  }\n};\n\nclass Child: Parent,\n  public proxy_Grandparent&lt;Child&gt;\n{\n  friend class proxy_Grandparent&lt;Child&gt;;\nprivate:\n  Parent&amp; get_proxy() { return *this; }\n};\n</code></pre>\n\n<p>this has two copies of <code>Grandparent</code> in it; if <code>Grandparent</code> is an interface this isn't all that problematic.</p>\n\n<p>Really, you should change <code>Parent</code> inheritance into a fully has-a:</p>\n\n<pre><code>class Child:\n  public proxy_Grandparent&lt;Child&gt;\n{\n  friend class proxy_Grandparent&lt;Child&gt;;\nprivate:\n  Parent parent;\n  Parent&amp; get_proxy() { return parent; }\n};\n</code></pre>\n"}], "owner": {"reputation": 4970, "user_id": 882478, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ba7a0499650df3855d8abb564d9ca348?s=128&d=identicon&r=PG", "display_name": "dragonroot", "link": "https://stackoverflow.com/users/882478/dragonroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1528397689, "creation_date": 1528314332, "last_edit_date": 1528320659, "question_id": 50728384, "link": "https://stackoverflow.com/questions/50728384/inherit-parent-privately-while-inheriting-its-grandparent-publicly-in-c", "title": "Inherit parent privately while inheriting its grandparent publicly in C++", "body": "<p>The title says it. <code>Parent</code> exposes <code>Grandparent</code> publicly, and I want to keep it public in <code>Child</code>, but I want to hide the <code>Parent</code> itself. I don't see why this shouldn't be possible, but I can't find a way to use a <code>using</code> directive to achieve that. If I can use <code>using</code> to publicly expose privately inherited member variables, I expect to be able to do the same for privately inherited bases, but I can't seem to be able to find a syntax for that. An explicit conversion operator in <code>Child</code> might work, but is there a cleaner way?</p>\n\n<pre><code>class Grandparent {};\n\nclass Parent: public Grandparent {};\n\nclass Child: Parent\n{\n  // How can I expose Grandparent here publicly?\n};\n\nvoid takeGrandparent( Grandparent const &amp; );\n\nint main()\n{\n  takeGrandparent( Child() ); // error: cannot cast 'Child' to its private base class 'Grandparent'\n}\n</code></pre>\n\n<p>UPD: since people have asked why I needed this, here's my use case. <code>Grandparent</code> is an interface which <code>Parent</code> implements. I want <code>Child</code> to use <code>Parent</code> to implement and provide this interface, but otherwise keep <code>Parent</code> private.</p>\n"}, {"tags": ["c++", "c", "segmentation-fault", "stack-overflow"], "comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 6, "creation_date": 1528314287, "post_id": 50728345, "comment_id": 88464728, "body": "You can jump over the guard page and hit another mapped region."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 4, "creation_date": 1528314295, "post_id": 50728345, "comment_id": 88464732, "body": "It could cause your program to branch to an invalid instruction"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 8, "creation_date": 1528314325, "post_id": 50728345, "comment_id": 88464750, "body": "The program <i>could</i> behave correctly and as expected."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 2, "creation_date": 1528314327, "post_id": 50728345, "comment_id": 88464752, "body": "Is highly OS related."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 6, "creation_date": 1528314387, "post_id": 50728345, "comment_id": 88464778, "body": "<a href=\"https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt\" rel=\"nofollow noreferrer\">qualys.com/2017/06/19/stack-clash/stack-clash.txt</a>"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528314399, "post_id": 50728345, "comment_id": 88464782, "body": "@Ivan: You mean, if your stack frame is larger than a single page?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1528314440, "post_id": 50728345, "comment_id": 88464800, "body": "@einpoklum Yes. You can even return back successfully after corrupting some other page."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 6, "creation_date": 1528314445, "post_id": 50728345, "comment_id": 88464806, "body": "The answer, essentially, is &quot;anything.&quot; Sure, most (all?) common modern OS&#39;s have guard pages, but there&#39;s nothing that guarantees one. Once you&#39;re accessing random memory, almost anything can happen. You might, in the absence of read-only code pages or execute protection bits, create gibberish code or try to execute non-code memory. You might corrupt a function pointer stored by some other part of the program, causing it to jump somewhere else. And so on..."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 2, "creation_date": 1528314446, "post_id": 50728345, "comment_id": 88464807, "body": "In our OpenMP program, it once caused silent overwriting of data of some other data structures. The program then finished correctly, just with incorrect results, and it was not easy to figure out the cause. (Setting <code>OMP_STACKSIZE</code> resolved the problem.)"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1528314459, "post_id": 50728345, "comment_id": 88464813, "body": "@Stefan: I understand that could be the case; if it is, an answer would be an example of an OS where this <i>always</i> happens and an OS with which something <i>else</i> can happen."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 1, "creation_date": 1528314517, "post_id": 50728345, "comment_id": 88464832, "body": "Of course, <i>visting</i> Stack Overflow often leads to <i>fixing</i> your segmentation fault... :)"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 1, "creation_date": 1528314563, "post_id": 50728345, "comment_id": 88464858, "body": "@Linuxios: It may result in brain stack overflow though, causing another kind of segmentation fault... :-)"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1528314754, "post_id": 50728345, "comment_id": 88464952, "body": "@einpoklum: yes, I understand. MS-DOS was the first to pop into my mind, but I see you excluded that one ;-) It&#39;s a bit tricky since there are a lot of os-es... so... there must be a faulty one somewhere.... Asking if something else <i>can</i> happen is like asking if <i>all</i> are working properly, which I think will not be the case. I know, it lacks an example."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 3, "creation_date": 1528315477, "post_id": 50728345, "comment_id": 88465318, "body": "Undefined Behaviour is undefined. Anything could happen, all bets are off and you&#39;ve left the land of guaranteed behaviour for <i>anything</i>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528315534, "post_id": 50728345, "comment_id": 88465338, "body": "Have anyone mentioned <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a> already?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1528315736, "post_id": 50728345, "comment_id": 88465439, "body": "This classic comes to mind: <a href=\"http://insecure.org/stf/smashstack.html\" rel=\"nofollow noreferrer\">Smashing The Stack For Fun And Profit</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 5, "creation_date": 1528314778, "post_id": 50728450, "comment_id": 88464968, "body": "Out of curiosity: do any of the standard compilers emit a warning on code like this? Some &quot;Stack-allocated local variable ... likely to overflow...&quot;?"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 2, "creation_date": 1528314834, "post_id": 50728450, "comment_id": 88464987, "body": "Wouldn&#39;t (isn&#39;t) that (be) a big potential exploit?"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528314973, "post_id": 50728450, "comment_id": 88465073, "body": "@melpomene: lol, I up-ed that one a minute ago and putted it on my reading list."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1528315138, "post_id": 50728450, "comment_id": 88465164, "body": "@Linuxios: I remember seeing warnings for large stack frame sizes back in the 1990s (maybe with MrC or Metrowerks) but for the life of me I can&#39;t get GCC or Clang to emit warnings for the obviously dangerous function written above."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1528315261, "post_id": 50728450, "comment_id": 88465217, "body": "@DietrichEpp: Weird. It would seem reasonably trivial to sum the sizeof&#39;s of a functions stack variables and just emit a warning if it&#39;s more than a worst-case guard page size. Maybe there&#39;s a missing subtlty here? Or maybe GCC and Clang are just assuming no one would write code like this..."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 7, "creation_date": 1528315276, "post_id": 50728450, "comment_id": 88465229, "body": "@Linuxios MSVC inserts <code>_chkstk</code> call in functions whose frame is larger than a single page. Its purpose is to avoid segfaults during stack expansion (Windows specific thing), but afair it also detects  stack overflow and raises Structured Exception. This should guarantee that stack overflow always leads to an exception and avoids silent data corruption."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528315949, "post_id": 50728450, "comment_id": 88465534, "body": "@Ivan: Huh, interesting. After reading bits of the link from melporneme, it looks like there is an option for GCC that does something similar, writing a byte to every page in a stack expansion, ensuring that the guard page is hit and a segfault occurs."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1528316490, "post_id": 50728450, "comment_id": 88465765, "body": "Since stack allocation/size is a linker/loader responsibility, a compiler cannot easily/reliably emit warnings/errors."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528322372, "post_id": 50728450, "comment_id": 88468151, "body": "@einpoklum: I am unhappy with the choice of emphasis in your edit."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528323014, "post_id": 50728450, "comment_id": 88468334, "body": "@DietrichEpp: Fair enough, it&#39;s your answer."}, {"owner": {"reputation": 2752, "user_id": 2015911, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BaMzg.jpg?s=128&g=1", "display_name": "BlueMoon93", "link": "https://stackoverflow.com/users/2015911/bluemoon93"}, "edited": false, "score": 0, "creation_date": 1528973076, "post_id": 50728450, "comment_id": 88713772, "body": "I don&#39;t understand, why is this a stack overflow?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 2752, "user_id": 2015911, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BaMzg.jpg?s=128&g=1", "display_name": "BlueMoon93", "link": "https://stackoverflow.com/users/2015911/bluemoon93"}, "edited": false, "score": 0, "creation_date": 1528997896, "post_id": 50728450, "comment_id": 88728560, "body": "@BlueMoon93: Local variables are stored in a part of memory called the stack. If you put too much data there, you get a stack overflow."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 31, "last_activity_date": 1528322386, "last_edit_date": 1528322386, "creation_date": 1528314568, "answer_id": 50728450, "question_id": 50728345, "link": "https://stackoverflow.com/questions/50728345/can-a-stack-overflow-result-in-something-other-than-a-segmentation-fault/50728450#50728450", "title": "Can a stack overflow result in something other than a segmentation fault?", "body": "<p>Yes, even on a standard OS (Linux) and standard hardware (x86).</p>\n\n<pre><code>void f(void) {\n    char arr[BIG_NUMBER];\n    arr[0] = 0; // stack overflow\n}\n</code></pre>\n\n<p>Note that on x86, the stack grows down, so we are assigning to the beginning of the array to trigger the overflow. The usual disclaimers apply... the exact behavior depends on more factors than are discussed in this answer, including the particulars of your C compiler.</p>\n\n<p>If the BIG_NUMBER is just barely large enough to overflow, you will run into the stack guard and get a segmentation fault. That's what the stack guard is there for, and it can be as small as a single 4 KiB page (but no smaller, and this 4 KiB size is used prior to Linux 4.12) or it can be larger (1 MiB default on Linux 4.12, see <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1be7107fbe18eed3e319a6c3e83c78254b693acb\" rel=\"noreferrer\">mm: large stack guard gap</a>), but it is always some particular size.</p>\n\n<p>If BIG_NUMBER is large enough, the overflow can skip over the stack guard and land on some other piece of memory, potentially memory that is valid. This may result in your program behaving incorrectly but not crashing, which is basically the worst-case scenario: we <em>want</em> our programs to crash when they are incorrect rather than do something unintended.</p>\n"}, {"comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528325795, "post_id": 50728825, "comment_id": 88469169, "body": "On Windows with MSVC it is very well defined."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528326199, "post_id": 50728825, "comment_id": 88469269, "body": "MSVC does not follow c standard."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528328468, "post_id": 50728825, "comment_id": 88469872, "body": "OP wasn&#39;t asking about standard C. Also standard C is meaningless because programs are not written in &quot;standard C&quot;."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528371284, "post_id": 50728825, "comment_id": 88487751, "body": "@Ivan; Can you provide some quote where it is well defined in MSVC?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1528371511, "post_id": 50728825, "comment_id": 88487894, "body": "@Ivan I don&#39;t have any link on me, but MSVC emits <code>_chkstk</code> call for functions with large frame. With guard page and emergency guard  page this makes it possible to handle stack overflow. Unlike other platforms there is a guarantee that you will get structured exception, not random data corruption."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 3, "last_activity_date": 1528316092, "creation_date": 1528316092, "answer_id": 50728825, "question_id": 50728345, "link": "https://stackoverflow.com/questions/50728345/can-a-stack-overflow-result-in-something-other-than-a-segmentation-fault/50728825#50728825", "title": "Can a stack overflow result in something other than a segmentation fault?", "body": "<p>Stackoverflow is one of the <a href=\"https://stackoverflow.com/q/367633/2455888\">many reasons</a> for <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">undefined behavior</a> of a program. In this case you can get an expected result or segmentation fault or your hard disk could be erased, etc. Do not expect any defined behaviour because it's undefined behaviour. </p>\n"}, {"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528318051, "post_id": 50729290, "comment_id": 88466459, "body": "I wasn&#39;t talking about overstepping array bounds, just perfectly valid program behavior except for exceeding the space allocated for the stack. Let me clarify that in the question."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528318254, "post_id": 50729290, "comment_id": 88466540, "body": "@einpoklum exceeding the size of the stack is <i>not</i> valid program behaviour and would equally result in UB."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1528318367, "post_id": 50729290, "comment_id": 88466587, "body": "One of the ways (and the most common one) to overflow a stack <i>is</i> to access a stack allocated array out of its bounds."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528318606, "post_id": 50729290, "comment_id": 88466693, "body": "@JesperJuhl: When you write your program, you don&#39;t know what the size of the stack is going to be."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528318687, "post_id": 50729290, "comment_id": 88466732, "body": "@einpoklum Just because you don&#39;t know what the (available) size will be does not make it legal to exceed it. And what happens if you do is undefined."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 2, "creation_date": 1528318709, "post_id": 50729290, "comment_id": 88466743, "body": "@einpoklum You mean the space allocated for stack, or the usage? The former one you can know for sure. The latter can be bounded or estimated."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 7, "last_activity_date": 1529357856, "last_edit_date": 1529357856, "creation_date": 1528317822, "answer_id": 50729290, "question_id": 50728345, "link": "https://stackoverflow.com/questions/50728345/can-a-stack-overflow-result-in-something-other-than-a-segmentation-fault/50729290#50729290", "title": "Can a stack overflow result in something other than a segmentation fault?", "body": "<p>One thing is what happens at runtime when you overflow the stack, which can be many things. Including, but not limited to; segmentation fault, overwriting variables following whatever you overflow, causing an illegal instruction, nothing at all and much more. The \"old\" classic paper <a href=\"http://insecure.org/stf/smashstack.html\" rel=\"nofollow noreferrer\">Smashing The Stack For Fun And Profit</a> describes a lot of ways one can have \"fun\" with this stuff.</p>\n\n<p>Another thing is what can happen at compile time. In both C and C++, writing beyond an array or exceeding the size of the stack is Undefined Behaviour and when a program contains UB <em>anywhere</em> the compiler is basically free to do <em>whatever it wants</em> to <em>any</em> part of your program. And modern compilers are becoming very aggressive in exploiting UB for optimization purposes - often by assuming that UB never happens, leading them to simply remove the code containing UB or causing a branch to always or never be taken because the alternative would cause UB. Sometimes the compiler will introduce <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20140627-00/?p=633\" rel=\"nofollow noreferrer\">time travel</a> or <a href=\"https://kristerw.blogspot.com/2017/09/why-undefined-behavior-may-call-never.html\" rel=\"nofollow noreferrer\">call a function that was never called in the source code</a> and many, many other things that can cause really confusing run-time behaviour.</p>\n\n<p>See also:</p>\n\n<p><a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">What Every C Programmer Should Know About Undefined Behavior #1/3</a></p>\n\n<p><a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_14.html\" rel=\"nofollow noreferrer\">What Every C Programmer Should Know About Undefined Behavior #2/3</a></p>\n\n<p><a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_21.html\" rel=\"nofollow noreferrer\">What Every C Programmer Should Know About Undefined Behavior #3/3</a></p>\n\n<p><a href=\"https://blog.regehr.org/archives/213\" rel=\"nofollow noreferrer\">A Guide to Undefined Behavior in C and C++, Part 1</a></p>\n\n<p><a href=\"https://blog.regehr.org/archives/226\" rel=\"nofollow noreferrer\">A Guide to Undefined Behavior in C and C++, Part 2</a></p>\n\n<p><a href=\"https://blog.regehr.org/archives/232\" rel=\"nofollow noreferrer\">A Guide to Undefined Behavior in C and C++, Part 3</a></p>\n"}, {"tags": [], "owner": {"reputation": 1597, "user_id": 5162810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDGmO.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/5162810/graham"}, "is_accepted": false, "score": 6, "last_activity_date": 1528331556, "creation_date": 1528331556, "answer_id": 50731422, "question_id": 50728345, "link": "https://stackoverflow.com/questions/50728345/can-a-stack-overflow-result-in-something-other-than-a-segmentation-fault/50731422#50731422", "title": "Can a stack overflow result in something other than a segmentation fault?", "body": "<p>Other answers have covered the PC side fairly well. I'll touch on some of the issues in the embedded world.</p>\n\n<p>Embedded code does have something similar to a segfault. Code is stored in some kind of non-volatile storage (usually flash these days, but some kind of ROM or PROM in the past). Writing to this needs special operations to set it up; normal memory accesses can read from it but not write to it. In addition, embedded processors usually have large gaps in their memory maps. If the processor gets a write request for memory which is read-only, or if it gets a read or write request for an address which does not physically exist, the processor will usually throw a hardware exception. If you have a debugger connected, you can check the state of the system to find what went wrong, as with a core dump.</p>\n\n<p>There's no guarantee that this will happen for a stack overflow though. The stack can be placed anywhere in RAM, and this will usually be alongside other variables. The result of stack overflow will usually be to corrupt those variables.</p>\n\n<p>If your application also uses heap (dynamic allocation) then it is common to assign a section of memory where the stack begins at the bottom of that section and expands upwards, and the heap begins at the top of that section and expands downwards. Clearly this means dynamically-allocated data will be the first casualty.</p>\n\n<p>If you're unlucky, you may not even notice when it happens, and then you need to work out why your code is not behaving correctly.  In the most ironic case, if the data being overwritten is a pointer then you may still get a hardware exception when the pointer tries to access invalid memory - but this will be some time after the stack overflow and the natural assumption will usually be that it's a bug in your code.</p>\n\n<p>Embedded code has a common pattern to deal with this, which is to \"watermark\" the stack by initialising every byte to a known value. Sometimes the compiler can do this; or sometimes you may need to implement it yourself in the startup code before main(). You can look back from the end of the stack to find where it is no longer set to this value, at which point you know the high-water-mark for stack usage; or if it is all incorrect then you know you have an overflow. It is common (and good practise) for embedded applications to poll this continuously as a background operation, and to be able to report it for diagnostic purposes.</p>\n\n<p>Having made it possible to track stack usage, most companies will set an acceptable worst-case margin to avoid overflows. This is typically somewhere from 75% to 90%, but there will always be some spare. Not only does this allow for the possibility that there is a worse worst-case which you have not yet seen, but it also makes life easier for future development when new code needs to be added which uses more stack.</p>\n"}], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2382, "favorite_count": 7, "accepted_answer_id": 50728450, "answer_count": 4, "score": 36, "last_activity_date": 1529357856, "creation_date": 1528314182, "last_edit_date": 1528339525, "question_id": 50728345, "link": "https://stackoverflow.com/questions/50728345/can-a-stack-overflow-result-in-something-other-than-a-segmentation-fault", "title": "Can a stack overflow result in something other than a segmentation fault?", "body": "<p>In a compiled program (let's say C or C++, but I guess this question could extend to any non-VM-ish language with a call stack) - very often when you overflow your stack, <a href=\"https://stackoverflow.com/a/2685434/1593077\">you get a segmentation fault</a>:</p>\n\n<blockquote>\n  <p>Stack overflow is [a] cause, segmentation fault is the result.</p>\n</blockquote>\n\n<p>Is this always the case, though? Can a stack overflow result in other kinds of program/OS behavior?</p>\n\n<p>I'm asking also about non-Linux, non-Windows OSes and non-X86 hardware. (Of course if you don't have hardware memory protection or OS support for it (e.g. MS-DOS) then there's no such thing as a segmentation fault; I'm asking about cases where you <em>could</em> get a segmentation fault but something else happens).</p>\n\n<p>Note: Assume that other than the stack overflow, the program is valid and does not try to access arrays beyond their bounds, dereference invalid pointers, etc.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 862, "user_id": 890897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7846a21f6ef5adf0d5bd0375b04428e?s=128&d=identicon&r=PG", "display_name": "tdk001", "link": "https://stackoverflow.com/users/890897/tdk001"}, "edited": false, "score": 0, "creation_date": 1528314531, "post_id": 50728327, "comment_id": 88464838, "body": "Is this the result of auto-generated code?"}, {"owner": {"reputation": 2051, "user_id": 8539057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7834c2ec493485bbc1867121cdee50ed?s=128&d=identicon&r=PG&f=1", "display_name": "Nichlas Uden", "link": "https://stackoverflow.com/users/8539057/nichlas-uden"}, "edited": false, "score": 0, "creation_date": 1528315174, "post_id": 50728327, "comment_id": 88465178, "body": "Wow this ruins the actual question.. Anyway, I have now updated the code to show some redeclarations rather than redefinitions."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528318175, "post_id": 50728327, "comment_id": 88466502, "body": "With reference to your updated question, how many million forward declarations of <code>class X</code> were you thinking of typing in?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1528318275, "post_id": 50728327, "comment_id": 88466547, "body": "It will not compile any faster, right? But compared to the 300.000 lines you would get from things like <code>#include &quot;windows.h&quot;</code>, any difference would likely be insignificant."}, {"owner": {"reputation": 2051, "user_id": 8539057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7834c2ec493485bbc1867121cdee50ed?s=128&d=identicon&r=PG&f=1", "display_name": "Nichlas Uden", "link": "https://stackoverflow.com/users/8539057/nichlas-uden"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1528320095, "post_id": 50728327, "comment_id": 88467341, "body": "@BoPersson Well so just theoretically, if you for some reason had 300.000 lines of redeclarations of the same entity, it could affect compile time? If so, why? You might be able to save my day :))))))"}], "answers": [{"comments": [{"owner": {"reputation": 2051, "user_id": 8539057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7834c2ec493485bbc1867121cdee50ed?s=128&d=identicon&r=PG&f=1", "display_name": "Nichlas Uden", "link": "https://stackoverflow.com/users/8539057/nichlas-uden"}, "edited": false, "score": 0, "creation_date": 1528315207, "post_id": 50728398, "comment_id": 88465193, "body": "Yes, I know... I accidentally copied the wrong code.. But it is updated now :=)"}], "tags": [], "owner": {"reputation": 5957, "user_id": 997196, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/E5hdR.png?s=128&g=1", "display_name": "Rivasa", "link": "https://stackoverflow.com/users/997196/rivasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1528314374, "creation_date": 1528314374, "answer_id": 50728398, "question_id": 50728327, "link": "https://stackoverflow.com/questions/50728327/compile-time-effect-of-several-redeclarations/50728398#50728398", "title": "Compile time effect of several redeclarations?", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">It simply won't compile.</a> </p>\n\n<blockquote>\n  <p>Only one definition of any variable, function, class type, enumeration type, concept (since C++20) or template is allowed in any one translation unit (some of these may have multiple declarations, but only one definition is allowed).</p>\n</blockquote>\n"}], "owner": {"reputation": 2051, "user_id": 8539057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7834c2ec493485bbc1867121cdee50ed?s=128&d=identicon&r=PG&f=1", "display_name": "Nichlas Uden", "link": "https://stackoverflow.com/users/8539057/nichlas-uden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528315435, "creation_date": 1528314110, "last_edit_date": 1528315435, "question_id": 50728327, "link": "https://stackoverflow.com/questions/50728327/compile-time-effect-of-several-redeclarations", "title": "Compile time effect of several redeclarations?", "body": "<p>Maybe this question sounds silly, but is there any compile time overhead associated with multiple declarations (in this case very useless ones) of the same name in the same declarative region, like:\n(Thanks to the ones who pointed out that I was using wrong code, forgot that I was re<em>defining</em> names, so here is an updated version):</p>\n\n<pre><code>class X;\nclass X;\nclass X;\nclass X;\nclass X;\n//And much more of those\nint main()\n{\n}\n</code></pre>\n\n<p>How would this affect the compilation?</p>\n"}, {"tags": ["c++", "linux", "multithreading", "tbb"], "comments": [{"owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1528314784, "post_id": 50728274, "comment_id": 88464971, "body": "Did you search for just <code>TBB_tbb_LIBRARY_DEBUG</code>?"}, {"owner": {"reputation": 364, "user_id": 7951709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pTg61.png?s=128&g=1", "display_name": "Sulphur", "link": "https://stackoverflow.com/users/7951709/sulphur"}, "reply_to_user": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1528314985, "post_id": 50728274, "comment_id": 88465079, "body": "@John  Yes, I typed <code>locate -i TBB_tbb_LIBRARY_DEBUG</code> . It didn&#39;t give me any result."}, {"owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1528315773, "post_id": 50728274, "comment_id": 88465458, "body": "Try a recursive grep in the source directory."}, {"owner": {"reputation": 364, "user_id": 7951709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pTg61.png?s=128&g=1", "display_name": "Sulphur", "link": "https://stackoverflow.com/users/7951709/sulphur"}, "reply_to_user": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1528316293, "post_id": 50728274, "comment_id": 88465684, "body": "@John  Hi, I did. I am attaching the snapshot of the result: [IMG]<a href=\"http://i68.tinypic.com/n13vwh.png[/IMG]\" rel=\"nofollow noreferrer\">i68.tinypic.com/n13vwh.png[/IMG]</a>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1528321486, "post_id": 50728274, "comment_id": 88467833, "body": "The variable is set by <code>FindTBB.cmake</code> script, shipped with the project. Most likely, the name of the variable is never used directly in the script. Instead, the script concatenates the variable&#39;s name from other variables. The variable is intended to contain path to debug version of <code>tbb</code> library. So, you need to provide this library for make things work. Alternatively, you may set this variable in CMake cache to the release version of the library, which is already found (<code>&#47;usr&#47;lib&#47;x86_64-linux-gnu&#47;libtbb.so</code>)."}, {"owner": {"reputation": 364, "user_id": 7951709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pTg61.png?s=128&g=1", "display_name": "Sulphur", "link": "https://stackoverflow.com/users/7951709/sulphur"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1529893399, "post_id": 50728274, "comment_id": 89023770, "body": "@Tsyvarev It worked. Thanks."}], "owner": {"reputation": 364, "user_id": 7951709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pTg61.png?s=128&g=1", "display_name": "Sulphur", "link": "https://stackoverflow.com/users/7951709/sulphur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528314472, "creation_date": 1528313861, "last_edit_date": 1528314472, "question_id": 50728274, "link": "https://stackoverflow.com/questions/50728274/cmake-error-tbb-variable-set-to-not-found", "title": "CMAKE error: TBB variable set to not found", "body": "<p>System: Linux</p>\n\n<p>I am getting the following error when trying to run a C++ code. When I run cmake .., I get -</p>\n\n<pre><code>srishti@ubuntu:~/realtimeKCF/build$ cmake ..\nFINALLL TBB_LIBRARIES = 'optimized;/usr/lib/x86_64-linux-gnu/libtbb.so;debug;TBB_tbb_LIBRARY_DEBUG-NOTFOUND'\nCMake Error: The following variables are used in this project, but they are set to NOTFOUND.\nPlease set them or make sure they are set and tested correctly in the CMake files:\nTBB_tbb_LIBRARY_DEBUG (ADVANCED)\nlinked by target \"DSKCFcpp\" in directory /home/srishti/realtimeKCF\n\n-- Configuring incomplete, errors occurred!\nSee also \"/home/srishti/realtimeKCF/build/CMakeFiles/CMakeOutput.log\".\n</code></pre>\n\n<p>I also searched for:</p>\n\n<blockquote>\n  <p>TBB_tbb_LIBRARY_DEBUG (ADVANCED)</p>\n</blockquote>\n\n<p>but I can't find this anywhere. Can someone please help me with this? I am just having this error stopping me from running the code.</p>\n"}, {"tags": ["c++", "arduino", "arduino-esp8266"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9905217, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dretzer", "link": "https://stackoverflow.com/users/9905217/dretzer"}, "edited": false, "score": 0, "creation_date": 1528360512, "post_id": 50732091, "comment_id": 88480589, "body": "I try with the older version and it doesn&#39;t work, if you have another idea don&#39;t miss me ^^"}, {"owner": {"reputation": 11, "user_id": 9905217, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dretzer", "link": "https://stackoverflow.com/users/9905217/dretzer"}, "edited": false, "score": 0, "creation_date": 1528385008, "post_id": 50732091, "comment_id": 88497554, "body": "Ok i resolve it, line scl / sda inversed (wrong  welding)"}], "tags": [], "owner": {"reputation": 1002, "user_id": 8078317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ldZij.jpg?s=128&g=1", "display_name": "Nitro", "link": "https://stackoverflow.com/users/8078317/nitro"}, "is_accepted": false, "score": 0, "last_activity_date": 1528337829, "creation_date": 1528337829, "answer_id": 50732091, "question_id": 50728272, "link": "https://stackoverflow.com/questions/50728272/no-tcs34725-found-check-your-connections/50732091#50732091", "title": "No TCS34725 found ... check your connections", "body": "<p>Given that your hardware and code were tested and working earlier, this is obviously due to a change in the compiler.</p>\n\n<p>Go to Arduino IDE boards manager, and check for which version of Esp8266 core you are using. Try switching to older versions, one of them will definitely work for you.</p>\n"}], "owner": {"reputation": 11, "user_id": 9905217, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dretzer", "link": "https://stackoverflow.com/users/9905217/dretzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528337829, "creation_date": 1528313851, "last_edit_date": 1528314062, "question_id": 50728272, "link": "https://stackoverflow.com/questions/50728272/no-tcs34725-found-check-your-connections", "title": "No TCS34725 found ... check your connections", "body": "<p>My TCS34725 is plugged in on an ESP8266. when the ESP boots, i got this message because it can't detect the TCS.</p>\n\n<p>here is the full code in the ESP if it can help !</p>\n\n<p>Connections and Wires are fine as they were working already, but now, be it with a new sensor, ESP or wires it doesn't recognize it (i have tested with all combinaisons i could with 4 ESP and 5 sensors)</p>\n\n<pre><code>#include &lt;ESP8266WiFi.h&gt;\n#include &lt;WiFiUdp.h&gt;\n#include &lt;Wire.h&gt;\n#include \"Adafruit_TCS34725.h\"\n\n\nconst char* ssid = \"Karting\";\nconst char* password = \"\";\nchar i = 0;\nchar color; \nWiFiUDP Udp;\nunsigned int localUdpPort = 4444;  // local port to listen on\nchar incomingPacket[255];  // buffer for incoming packets\n//char  replyPacket[] = \"1\";  // a reply string to send back\n\nAdafruit_TCS34725 tcs = Adafruit_TCS34725(TCS34725_INTEGRATIONTIME_700MS, TCS34725_GAIN_1X);\n\n\nvoid setup()\n{\n  pinMode(14,OUTPUT);\n  Serial.begin(115200);\n  Serial.println();\n  Serial.printf(\"Connecting to %s \", ssid);\n  WiFi.begin(\"SSID\", \"PASS\");\n  while (WiFi.status() != WL_CONNECTED)\n  {\n    delay(500);\n    Serial.print(\".\");\n  }\n  Serial.println(\" connected\");\n\n  if (tcs.begin()) {\n   Serial.println(\"Found sensor\");\n  } else {\n   Serial.println(\"No TCS34725 found ... check your connections\");\n   while(1);\n  }\n\n  Udp.begin(4444);\n    Wire.begin(); // join i2c bus (address optional for master)\n\n  Serial.printf(\"Now listening at IP %s, UDP port %d\\n\", WiFi.localIP().toString().c_str(), localUdpPort);\n  digitalWrite(14,LOW);\n\n}\n\n\nvoid loop()\n{\n\n  uint16_t r, g, b, c, colorTemp, lux;\n  int packetSize = Udp.parsePacket();\n\n  tcs.getRawData(&amp;r, &amp;g, &amp;b, &amp;c);\n  colorTemp = tcs.calculateColorTemperature(r, g, b);\n  lux = tcs.calculateLux(r, g, b);\n\n  Serial.print(\"Color Temp: \"); Serial.print(colorTemp, DEC); Serial.print(\" K - \");\n  Serial.print(\"Lux: \"); Serial.print(lux); Serial.print(\" - \");\n  Serial.print(\"R: \"); Serial.print(r, DEC); Serial.print(\" \");\n  Serial.print(\"G: \"); Serial.print(g, DEC); Serial.print(\" \");\n  Serial.print(\"B: \"); Serial.print(b, DEC); Serial.print(\" \");\n  Serial.print(\"C: \"); Serial.print(c, DEC); Serial.print(\" \");\n  Serial.println(\" \");\n\n  if ((r &gt; g) &amp;&amp; (r &gt; b) &amp;&amp; (colorTemp &gt; 7300) &amp;&amp; (colorTemp &lt; 7600))\n  {\n    i = 1;\n    color = 'R';\n    digitalWrite(14,LOW);\n  }\n\n  if ((g &gt; r) &amp;&amp; (g &gt; b) &amp;&amp; (colorTemp &gt; 7300) &amp;&amp; (colorTemp &lt; 7600))\n  {\n    i = 1;\n    color = 'G';\n    digitalWrite(14,LOW);\n  }\n\n  if ((b &gt; r) &amp;&amp; (b &gt; g) &amp;&amp; (colorTemp &gt; 9500) &amp;&amp; (colorTemp &lt; 9800))\n  {\n    i = 1;\n    color = 'B';\n    digitalWrite(14,LOW);\n  }\n  else {\n    if ((lux &gt;2000 ) &amp;&amp; (lux &lt;2500) &amp;&amp; (colorTemp &gt; 5800) &amp;&amp; (colorTemp &lt; 6400))\n    {\n    i = 1;\n    color = 'W';\n    digitalWrite(14,LOW);\n    Udp.beginPacket(Udp.remoteIP(), Udp.remotePort());\n    Udp.write(color);\n    Udp.endPacket();\n    Serial.println(\"pupupupute\");\n    Serial.println(Udp.remotePort());\n    }\n\n  if (packetSize!=0)\n  {\n    digitalWrite(14,HIGH);\n    Serial.printf(\"Received %d bytes from %s, port %d\\n\", packetSize, Udp.remoteIP().toString().c_str(), Udp.remotePort());\n    int len = Udp.read(incomingPacket, 255);\n    if (len &gt; 0)\n    {\n      Wire.beginTransmission(8); // transmit to device #8\n      Wire.write(\"x is \");        // sends five bytes\n      Wire.write(incomingPacket);              // sends one byte\n      Wire.endTransmission();    // stop transmitting\n      Serial.printf(\"UDP packet contents: %s\\n\", incomingPacket);\n      incomingPacket[len] = 0;\n    }\n\n  }\n\n}\n}\nvoid requestEvent() {\n  if ( i = 1 )\n  {\n    Wire.beginTransmission(8);\n    Wire.write( color );\n    Wire.endTransmission();    // stop transmitting\n    i = 0;\n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-c++", "visual-studio-2015", "c-preprocessor"], "answers": [{"comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528318413, "post_id": 50728314, "comment_id": 88466613, "body": "Much to  my amazement <a href=\"https://wandbox.org/permlink/NFTpwjftwUaRIomW\" rel=\"nofollow noreferrer\">that works</a>.  I never knew that <code>#include</code> expanded macros."}, {"owner": {"reputation": 73, "user_id": 9905283, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jrntgzt_p38/AAAAAAAAAAI/AAAAAAAABRg/7eWHPzzP8OA/photo.jpg?sz=128", "display_name": "Paul Harrison", "link": "https://stackoverflow.com/users/9905283/paul-harrison"}, "edited": false, "score": 0, "creation_date": 1532359661, "post_id": 50728314, "comment_id": 89933496, "body": "Thank you very much for the help, that worked beautifully!"}], "tags": [], "owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "is_accepted": true, "score": 2, "last_activity_date": 1528315187, "last_edit_date": 1528315187, "creation_date": 1528314055, "answer_id": 50728314, "question_id": 50728230, "link": "https://stackoverflow.com/questions/50728230/concatenating-preprocessor-definition-and-string-to-create-include-path/50728314#50728314", "title": "Concatenating preprocessor definition and string to create #include path", "body": "<p>There are two things that are causing your problem.</p>\n\n<ol>\n<li>You are trying to turn <code>\"A\" \"B\"</code> into <code>\"AB\"</code>.</li>\n<li><code>#include \"A\"\"B\"</code> is not valid syntax.</li>\n</ol>\n\n<p>What you can do, is concatenate <code>A</code> and <code>B</code> and then turn that into a string literal.</p>\n\n<pre><code>#define STR_IMPL(A) #A\n#define STR(A) STR_IMPL(A)\n</code></pre>\n\n<p>Then you can do this:</p>\n\n<pre><code>#define RESOURCE_FILE resource.h\n#define PROJECT_DIRECTORY /foo/bar\n#define RESOURCE_PATH STR(PROJECT_DIRECTORY/RESOURCE_FILE)\n\n#include RESOURCE_PATH\n</code></pre>\n\n<p>Unfortunately, there's no way to turn <code>\"A\"</code> into <code>A</code> or <code>\"A\"\"B\"</code> into <code>\"AB\"</code> in C++ preprocessor. So, you have to work with tokens without quotes and stringize the result at the end.</p>\n"}], "owner": {"reputation": 73, "user_id": 9905283, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jrntgzt_p38/AAAAAAAAAAI/AAAAAAAABRg/7eWHPzzP8OA/photo.jpg?sz=128", "display_name": "Paul Harrison", "link": "https://stackoverflow.com/users/9905283/paul-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 50728314, "answer_count": 1, "score": 2, "last_activity_date": 1528315187, "creation_date": 1528313688, "question_id": 50728230, "link": "https://stackoverflow.com/questions/50728230/concatenating-preprocessor-definition-and-string-to-create-include-path", "title": "Concatenating preprocessor definition and string to create #include path", "body": "<p>I am trying to concatenate a file path for a header file using a preprocessor definition (in this case, the project path) and the filename, but I am persistently getting the following: \"warning C4067: unexpected tokens following preprocessor directive - expected a newline\". I have tried the following approaches:</p>\n\n<pre><code>#define RESOURCE_PATH PROJECT_DIRECTORY \"resource.h\"\n#include RESOURCE_PATH\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>#define RESOURCE_FILE \"resource.h\"\n#define RESOURCE_PATH PROJECT_DIRECTORY RESOURCE_FILE\n#include RESOURCE_PATH\n</code></pre>\n\n<p>Both of yield warning C4067 on the <code>#include</code> line. I have also tried:</p>\n\n<pre><code>#define RESOURCE_FILE \"resource.h\"\n#define RESOURCE_PATH PROJECT_DIRECTORY ## RESOURCE_FILE\n#include RESOURCE_PATH\n</code></pre>\n\n<p>which also does not work but changes the error to \"error C2006: '#include': expected a filename, found 'identifier'\".</p>\n\n<p>I have double checked that my source file is UTF-8, so I'm not inadvertently including Unicode characters. PROJECT_DIRECTORY appears to be properly formatted and is the correct path.</p>\n\n<p>I'm using VS2015.</p>\n\n<p>Any ideas would be appreciated!</p>\n"}, {"tags": ["c++", "pid", "createprocess"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528313388, "post_id": 50728144, "comment_id": 88464303, "body": "Check your <code>pi</code> argument. It should contain everything you need to know about the new process. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684873(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528313438, "post_id": 50728144, "comment_id": 88464334, "body": "<code>pi</code> has PID of calc.exe but when I do EnumWindows it can&#39;t find calc.exe since it is already closed. So I need to find PID of <code>win32calc.exe</code>"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528313697, "post_id": 50728144, "comment_id": 88464445, "body": "Perhaps you should just launch <code>win32calc.exe</code>..."}, {"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "edited": false, "score": 0, "creation_date": 1528316440, "post_id": 50728144, "comment_id": 88465745, "body": "it was an example, windows has a number of such apps. So this can&#39;t help."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528318520, "post_id": 50728144, "comment_id": 88466661, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50327232/waitforsingleobject-works-when-trying-to-open-notepad-but-returns-immediately\" title=\"waitforsingleobject works when trying to open notepad but returns immediately\">stackoverflow.com/questions/50327232/&hellip;</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1528320905, "post_id": 50728144, "comment_id": 88467634, "body": "This was the traditional code to kick the tires on EnumWindows and friends.  It however does not work anymore on Win10, the calculator app is now a UWP app.  Which has a <i>very</i> different way of creating the window, its main window is a child of the UWP desktop host.  You can still kick by using Notepad instead."}, {"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528325051, "post_id": 50728144, "comment_id": 88468942, "body": "Different case, I need to find PID or hWND of the subproccess which is running. @HansPassant can you explain in more details please or give some code example please?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528343392, "post_id": 50728144, "comment_id": 88473119, "body": "Hard to give you more details when you don&#39;t give more details.  You already get the PID back from CreateProcess, last argument."}, {"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528360011, "post_id": 50728144, "comment_id": 88480269, "body": "@HansPassant Yes I get this PID but it is for <code>calc.exe</code> but the window it opens belongs to a different application <code>win32calc.exe</code>. So I need somehow to find the PID of that application and have no idea how."}, {"owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "edited": false, "score": 0, "creation_date": 1528832237, "post_id": 50728144, "comment_id": 88654130, "body": "Didn&#39;t find any better solution then take process snapshot and iterate through all of them with checking parent PID"}], "owner": {"reputation": 449, "user_id": 1101955, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/619ab4ed1fc7a0862f2e6382b35eb05a?s=128&d=identicon&r=PG", "display_name": "htonus", "link": "https://stackoverflow.com/users/1101955/htonus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528313743, "creation_date": 1528313298, "last_edit_date": 1528313743, "question_id": 50728144, "link": "https://stackoverflow.com/questions/50728144/how-to-get-real-id-of-the-process-spawned-by-createprocess", "title": "How to get real ID of the process spawned by CreateProcess", "body": "<p>I'm spawning calc.exe by CreateProcess:</p>\n\n<pre><code>CreateProcess(pathToCalc, NULL, NULL, NULL, FALSE, 0, NULL, NULL, &amp;si, &amp;pi);\n</code></pre>\n\n<p>then I need to find hWND of the calculator dialog window. To find it I use </p>\n\n<pre><code>EnumWindows(EnumWindowsCallback, pi.dwProcessId);\n</code></pre>\n\n<p>But it never finds hWND. After investigation it appeared that calc.exe spawns different aplication <code>win32calc.exe</code> and it has different PID (not he one in pi.dwProcessId)</p>\n\n<p>how to get PID of <code>win32calc.exe</code> or/and hWND of it's window please?</p>\n\n<p>Windows 10. Visual Studio 2017</p>\n"}, {"tags": ["python", "c++", "regex", "c++11"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1528313376, "post_id": 50728105, "comment_id": 88464300, "body": "You need <a href=\"https://ideone.com/7QNwCv\" rel=\"nofollow noreferrer\">ideone.com/7QNwCv</a>, use a regex iterator to get multiple matches. You can only get the first match with <code>regex_search</code> and there are as many submatches as there are capturing groups in the pattern."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1528313408, "post_id": 50728105, "comment_id": 88464316, "body": "One set of parens <code>()</code> means only on capture group means only one index (excluding <code>0</code>). I don&#39;t think what you want is possible without adding all the capture groups. What is the greater problem you are trying to solve here?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1528313752, "post_id": 50728105, "comment_id": 88464465, "body": "This answer may be of use <a href=\"https://stackoverflow.com/a/32553718/3807729\">stackoverflow.com/a/32553718/3807729</a>"}], "owner": {"reputation": 71, "user_id": 6092337, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0dc22280e63123bfe3714400c8161f7?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan Aggarwal", "link": "https://stackoverflow.com/users/6092337/rohan-aggarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1528313593, "answer_count": 0, "score": 0, "last_activity_date": 1528313325, "creation_date": 1528313129, "last_edit_date": 1528313325, "question_id": 50728105, "link": "https://stackoverflow.com/questions/50728105/c-regular-expressions-saving-only-last-matched", "closed_reason": "Duplicate", "title": "C++ Regular expressions * saving only last matched", "body": "<p>This is a very simple example to explain the problem I am facing regularly.</p>\n\n<p>This is my code for processing a text file a.txt using regular expressions \ncontaining only the text \"0123456789\" , ie str after reading the file becomes this string.</p>\n\n<p>Now I wanted each of the numbers to be in a separate index of the match array.</p>\n\n<p>Like match[1] should give 0 match[2] should give 1 .. but instead what happens is only the last matched in * is retained ie match[1] gives us 9.</p>\n\n<p>If we take the regular expression as \"([0-9]*)\" then the entire string will\nbe in match[1] which is not required.</p>\n\n<p>How to retain all of them in separated manner ?</p>\n\n<p>I faced a similar issue in python regex also where the same happens only the last matched is retained.</p>\n\n<p>Again I emphasise that this is a very basic example of what I am facing but is on the exact lines of what I am facing which will be very difficult to explain here.</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include&lt;regex&gt;\n#include&lt;string&gt;\nusing namespace std;\nint main()\n{\n    ifstream inFile;\n    inFile.open(\"a.txt\");//open the input file\n\n    stringstream strStream;\n    strStream &lt;&lt; inFile.rdbuf();//read the file\n    string str = strStream.str();//str holds the content of the file\n\n    regex r4(\"([0-9])*\");\n\n    if (std::regex_search(str, match, r4)) {\n        cout&lt;&lt;match[1];\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "boost", "websocket", "boost-asio", "boost-beast"], "comments": [{"owner": {"reputation": 4520, "user_id": 150679, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7162b2123d51b183b31a4dbb6548adaf?s=128&d=identicon&r=PG", "display_name": "Vinnie Falco", "link": "https://stackoverflow.com/users/150679/vinnie-falco"}, "edited": false, "score": 0, "creation_date": 1528571828, "post_id": 50728059, "comment_id": 88562377, "body": "I can&#39;t even..."}], "answers": [{"comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528331426, "post_id": 50731097, "comment_id": 88470570, "body": "Please check my edit that explains what&#39;s going on :-)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332255, "post_id": 50731097, "comment_id": 88470774, "body": "&quot;because the socket is not thread-safe, and a multithreaded io_service would create a race there&quot;  - well the <code>async_write</code> operation needs to be on the strand for <i>the exact same reason</i>."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332264, "post_id": 50731097, "comment_id": 88470778, "body": "&quot;when it&#39;s being used sequentially in a loop in the main-thread&quot; - firstly, you&#39;re not &quot;using&quot; the method. You&#39;re &quot;using&quot; the object. And the object already has pending async operations being serviced from other threads."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332278, "post_id": 50731097, "comment_id": 88470782, "body": "&quot;What else can be missing?&quot; - making sure you don&#39;t overlap write (or read) calls. With only the &quot;naive&quot; addition of <code>post</code> you can still be executing the next async_write before the completion handler ran."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332290, "post_id": 50731097, "comment_id": 88470787, "body": "&quot;This is why I&#39;m using futures, to exactly define test cases and define the time order of my tests.&quot; - in fact you do very little in that way. If you send 50 messages to a single client, the way your test code is set-up you will read <b>any</b> response. This might make sense but not if the response belongs to the message sent. The way you multiplied the read_futures to match the write_futures gave me the suspicion that you <i>do</i> want them matching."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332304, "post_id": 50731097, "comment_id": 88470789, "body": "So, if you describe /functionally/ what you want your client class to achieve, we can try to show/suggest a simpler (and correct) approach."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332680, "post_id": 50731097, "comment_id": 88470872, "body": "(PS. The irony in this all is that with the code you have you don&#39;t even ever need the strand in the first place, since each session is on its own <code>io_context</code> instance. That means everything is always on an implicit strand.)"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332695, "post_id": 50731097, "comment_id": 88470876, "body": "(let&#39;s see if it suggests chat now). What confuses me is that the pending operations in that object are all in io_service, and the interface of io_service is (by definition as a semi thread-pool) thread-safe. If I understand correctly, even if I post from 10 threads to io_service, it should be safe, right? also remember that my <code>async_write_future</code> doesn&#39;t use any <code>this</code> parameters (except for websocket, which simply posts to io_service). Shouldn&#39;t this mechanism be thread-safe? Does <code>websock.async_write</code> do anything other than posting to io_service?"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332757, "post_id": 50731097, "comment_id": 88470892, "body": "True that! I&#39;m using a single io_context here, but in general this may change. So I&#39;m treating this as if I have multiple threads running on that io_context."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332831, "post_id": 50731097, "comment_id": 88470905, "body": "The fact that it&#39;s thread safe merely means you don&#39;t get a data race (Undefined Behaviour) when you do. <code>websocket</code> is expressly not thread aware."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1528332859, "post_id": 50731097, "comment_id": 88470912, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/172637/discussion-between-sehe-and-the-quantum-physicist\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1528328369, "creation_date": 1528328369, "answer_id": 50731097, "question_id": 50728059, "link": "https://stackoverflow.com/questions/50728059/boostbeast-multiple-async-write-calls-are-firing-an-assertion-error/50731097#50731097", "title": "Boost::beast: Multiple async_write calls are firing an assertion error", "body": "<p>You <strong>said</strong> you cover your <code>async_write</code> with a strand. But <strong><em>you do no such thing</em></strong>. All you can be seen doing is <em>wrapping the completion handlers in that strand</em>. But you're posting the async operations <em>directly</em>. </p>\n\n<p>What's worse, you're doing it from the main thread, while there are async operations underway on any of the threads associated with your <code>WSClient</code> instances which means you're concurrently accessing object instances that aren't thread-safe.</p>\n\n<p>That's a data race, so you get <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behaviour</a>.</p>\n\n<p>A naive fix might be:</p>\n\n<pre><code>std::future&lt;void&gt; write_data_async_future(const std::string &amp;data) {\n    // shared_ptr is used to ensure data's survival\n    std::shared_ptr&lt;std::string&gt; data_ptr = std::make_shared&lt;std::string&gt;(data);\n    std::shared_ptr&lt;std::promise&lt;void&gt; &gt; write_promise = std::make_shared&lt;std::promise&lt;void&gt; &gt;();\n\n    post(strand_, [=,self=shared_from_this()] {\n        websock.async_write(\n            boost::asio::buffer(*data_ptr),\n            boost::asio::bind_executor(strand_, std::bind(&amp;WSClientSession::on_write_future, self,\n                                                          std::placeholders::_1, std::placeholders::_2, data_ptr,\n                                                          write_promise)));\n    });\n\n    return write_promise-&gt;get_future();\n}\n</code></pre>\n\n<p>But that's <strong>not enough</strong>. Now you can be sure that none of your async operations or the completions thereof will run at the same time, but you can still post the next async-operation before the completion handler for the first is invoked.</p>\n\n<p>To fix that you'll just need to queue.</p>\n\n<p>To be honest I'm not sure why you are focusing so much on synchronization using the futures. That just makes it very hard to achieve this. If you can describe what it is that you /functionally/ want to achieve, I can propose a solution that is probably a lot shorter.</p>\n\n<h2>Code Review Notes</h2>\n\n<p>Before it dawned on me what the code was all about, I spent quite a lot of time reading your code. I wouldn't want to rob you of the notes I made along the way.</p>\n\n<blockquote>\n  <p>Warning: This was quite a protracted code dive. I provide it because some of the insights might help you see how you need to restructure your code.</p>\n</blockquote>\n\n<p>I started out reading the async code chains up until <code>on_handshake</code> (which <em>sets</em> the <code>started_promise</code> value).</p>\n\n<p>Then I headed onto the malstrom that is your <code>main</code> function. Your main function is 50 lines of code?! Having several parallel containers and repeated manual nested loops through them?</p>\n\n<p>This is what I got after some refactoring:</p>\n\n<pre><code>int main() {\n    std::vector&lt;actor&gt; actors(1);\n\n    for (auto&amp; a : actors) {\n        a.client = std::make_shared&lt;WSClient&gt;();\n        a.session_start_future = a.client-&gt;start(\"127.0.0.1\", \"8085\");\n        a.messages.resize(50);\n    }\n\n    for (auto&amp; a : actors) { a.session_start_future.get(); }\n\n    for (auto&amp; a : actors) { for (auto&amp; m : a.messages) {\n        m.write_future = a.client-&gt;write_data_async_future(\"Hello\");\n    } }\n\n    for (auto&amp; a : actors) { for (auto&amp; m : a.messages) {\n        m.read_future = a.client-&gt;read_data_async_future();\n    } }\n\n    for (auto&amp; a : actors) { for (auto&amp; m : a.messages) {\n        m.write_future.get();\n        std::string result = m.read_future.get();\n    } }\n}\n</code></pre>\n\n<p>All the datastructures have been folded into the small helper <code>actor</code>:</p>\n\n<pre><code>struct actor {\n    std::shared_ptr&lt;WSClient&gt; client;\n    std::future&lt;void&gt; session_start_future;\n\n    struct message {\n        std::string message = GenerateRandomString(20);\n        std::future&lt;void&gt; write_future;\n        std::future&lt;std::string&gt; read_future;\n    };\n\n    std::vector&lt;message&gt; messages;\n};\n</code></pre>\n\n<blockquote>\n  <p>We're approximately one hour of code review down the road now, with no gain, except that we can now TELL what <code>main</code> is doing, and have some confidence that there isn't some trivial mistake with a loop variable or something.</p>\n</blockquote>\n\n<h2>Picking Back Up</h2>\n\n<p>At the start of writing: <code>write_data_async_future</code>. Wait. There's also <code>write_data_async</code> and <code>write_data_sync</code>. Why? You'll want to read</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/46852215/how-to-set-error-code-to-asioyield-context/46859110#46859110\">How to set error_code to asio::yield_context</a></li>\n<li>or <a href=\"https://stackoverflow.com/questions/49950679/how-can-i-get-a-future-from-boostasiopost/49955899#49955899\">How can I get a future from boost::asio::post?</a></li>\n</ul>\n\n<p>What's worse, <code>WSClient</code> only relayed these to the assumed <em>single</em> session. Why is there a distinction between <code>WSClient</code> and <code>WSClientSession</code> at all at this point? I say, there is none.</p>\n\n<p>Evaporating 30 lines of not-so-useful code further we still have the same failure, so that's good.</p>\n\n<p>Where were we. <code>write_data_async_future</code>. Oh yeah, do we need the non-future versions? No. So, 40 more lines of code gone.</p>\n\n<p>Now, for real: <code>write_data_async_future</code>:</p>\n\n<pre><code>std::future&lt;void&gt; write_data_async_future(const std::string &amp;data) {\n    // shared_ptr is used to ensure data's survival\n    std::shared_ptr&lt;std::string&gt; data_ptr = std::make_shared&lt;std::string&gt;(data);\n    std::shared_ptr&lt;std::promise&lt;void&gt; &gt; write_promise = std::make_shared&lt;std::promise&lt;void&gt; &gt;();\n    websock.async_write(\n        boost::asio::buffer(*data_ptr),\n        boost::asio::bind_executor(strand_, std::bind(&amp;WSClientSession::on_write_future, shared_from_this(),\n                                                      std::placeholders::_1, std::placeholders::_2, data_ptr,\n                                                      write_promise)));\n    return write_promise-&gt;get_future();\n}\n</code></pre>\n\n<p>Looks... okayish. Wait, there's <code>on_write_future</code>? This probably means we need to vaporize more lines of unused code. Looking... Yep. Poof, gone. </p>\n\n<blockquote>\n  <p>By now, the diffstat looks like this:</p>\n\n<pre><code>  test.cpp | 683 +++++++++++++++++++++++----------------------------------------\n  1 file changed, 249 insertions(+), 434 deletions(-)\n</code></pre>\n</blockquote>\n\n<p>Back to that function, so let's look at <code>on_write_future</code>:</p>\n\n<pre><code>void on_write_future(boost::system::error_code ec, std::size_t bytes_transferred,\n                     std::shared_ptr&lt;std::string&gt; data_posted,\n                     std::shared_ptr&lt;std::promise&lt;void&gt; &gt; write_promise) {\n    boost::ignore_unused(bytes_transferred);\n    boost::ignore_unused(data_posted);\n\n    if (ec) {\n        try {\n            throw std::runtime_error(\"Error thrown while performing async write: \" + ec.message());\n        } catch (...) {\n            write_promise-&gt;set_exception(std::current_exception());\n        }\n        return;\n    }\n    write_promise-&gt;set_value();\n}\n</code></pre>\n\n<p>A few issues. Everything passed is being ignored. I know what you pass the shared_ptrs for, but maybe you should pass them as part of an  operation object so as to avoid having so many separate shared-ptrs.</p>\n\n<p>Throwing an exception just to catch it? Mmm. I'm not sure about that. Perhaps just set a fresh exception:</p>\n\n<pre><code>if (ec) {\n    write_promise-&gt;set_exception(\n            std::make_exception_ptr(std::system_error(ec, \"async write failed\")));\n} else {\n    write_promise-&gt;set_value();\n}\n</code></pre>\n\n<p>Even with that, there's a conceptual problem now. The way you liberally use <code>get()</code> without catching in <code>main</code> this means that any error in any connection will just abort all operations. It would be quite useful to have an error simply abort the one connection/session/client. Which, in your code are all pretty synonymous (and also with <code>io_context</code> and <code>thread</code>).</p>\n\n<p>Sidenote: You store the thread as a member, but you always detach it. That means the member is useless from then on.</p>\n\n<blockquote>\n  <p>At this point I took a break from reviewing, and as it happens I got the brainwave that showed me the issue. The halfbaked result of my exercise are <a href=\"https://paste.ubuntu.com/p/wFqrwWQJ6V/\" rel=\"nofollow noreferrer\">here</a>. Note that you cannot use it because it doesn't actually fix the problem. But it might help in other ways?</p>\n</blockquote>\n"}], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "accepted_answer_id": 50731097, "answer_count": 1, "score": 4, "last_activity_date": 1528331408, "creation_date": 1528312886, "last_edit_date": 1528331408, "question_id": 50728059, "link": "https://stackoverflow.com/questions/50728059/boostbeast-multiple-async-write-calls-are-firing-an-assertion-error", "title": "Boost::beast: Multiple async_write calls are firing an assertion error", "body": "<p>I'm writing tests for my full-duplex server, and when I do multiple (sequential) <code>async_write</code> calls (although covered with a strand), I get the following assertion error from <code>boost::beast</code> in the file <code>boost/beast/websocket/detail/stream_base.hpp</code>:</p>\n\n<pre><code>// If this assert goes off it means you are attempting to\n// simultaneously initiate more than one of same asynchronous\n// operation, which is not allowed. For example, you must wait\n// for an async_read to complete before performing another\n// async_read.\n//\nBOOST_ASSERT(id_ != T::id);\n</code></pre>\n\n<p><strong>To reproduce the problem on your machine:</strong> A full client code that reproduces this issue (MCVE) can be found <a href=\"http://coliru.stacked-crooked.com/a/ca1c4a97b5aa043b\" rel=\"nofollow noreferrer\">here</a>. It doesn't work in the link because you need a server (on your own machine, sorry as it's not possible to do this conveniently online, and this is better objectively to show that the problem is in the client, not in the server if I include it here). I used <a href=\"http://websocketd.com/\" rel=\"nofollow noreferrer\">websocketd</a> to create a server with the command <code>./websocketd --ssl --sslkey /path/to/server.key --sslcert /path/to/server.crt --port=8085 ./prog.py</code> where <code>./prog.py</code> is a simply python program that prints and flushes (I got it from <a href=\"http://websocketd.com/\" rel=\"nofollow noreferrer\">websocketd home page</a>).</p>\n\n<p>The call that does the writing in the client looks like this:</p>\n\n<pre><code>  std::vector&lt;std::vector&lt;std::future&lt;void&gt;&gt;&gt; clients_write_futures(\n      clients_count);\n  for (int i = 0; i &lt; clients_count; i++) {\n    clients_write_futures[i] = std::vector&lt;std::future&lt;void&gt;&gt;(num_of_messages);\n    for (int j = 0; j &lt; num_of_messages; j++) {\n      clients_write_futures[i][j] =\n          clients[i]-&gt;write_data_async_future(\"Hello\"); // writing here\n    }\n  }\n</code></pre>\n\n<p>Notice that I'm using only 1 client in the example. The array of clients is just a generalization for more stress on the server when testing.</p>\n\n<p>My comments on the problem:</p>\n\n<ol>\n<li>The loop is sequential; it's not like I'm doing this in multiple threads</li>\n<li>It should be possible to do communication in a full-duplex form, where an indefinite number messages are sent to the server. How else can a full-duplex comm be done?</li>\n<li>I'm using strands to wrap my async calls to prevent any clash in the socket through io_service/io_context</li>\n<li>Investigating this with a debugger shows that the second iteration of the loop fails consistently, which means I'm doing something fundamentally wrong, but I don't know what is it. In other words: This is a deterministic problem apparently.</li>\n</ol>\n\n<p>What am I doing wrong here? How can I write an indefinite number of messages to my websocket server?</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Sehe, I wanna start by apologizing for the code mess (didn't realize it's that bad), and thanking you for your effort on this. I wish you asked me why it's structured in this (probably) organized and also chaotic way simultaneously, and the answer is simple: The main is a gtest code to see whether my generic, versatile websocket client works that I'm using to stress-test my server (which uses tons of multithreaded io_service objects, which I consider sensitive and need broad testing). I'm planning to bombard my server with many clients simultaneously during real production tests. I posted this question because the behavior of the client I don't understand. What I did in this file is create an MCVE (that people consistently request on SO). It took me two hours to strip my code to create it, and eventually I copied my gtest test fixture code (which is a fixture on the server) and pasted it in the main and verified that the problem still exists on another server and cleaned up a little (which obviously turned out not to be enough).</p>\n\n<p>So why I don't catch exceptions? Because gtest will catch them and deem the test failed. The main is not production code, but the client is. I learned a lot from what you mentioned, and I have to say it's stupid to throw and catch, but I didn't know about std::make_exception_ptr(), so I found my (dumm) way to achieve the same result :-). Why too many useless functions: They're useless here in this test/example, but generally I could use them for other things later as this client is not only for this case.</p>\n\n<p>Now moving back to the problem: Something I don't understand is why do we have to cover <code>async_write</code> with strand_ when it's being used sequentially in a loop in the main-thread (I misexpressed that I covered the handler only). I'd understand why the handler is covered, because the socket is not thread-safe, and a multithreaded <code>io_service</code> would create a race there. We also know that <code>io_service::post</code> itself is thread-safe (which is why I thought wrapping async_write is not necessary). Could you explain what it's that's not thread-safe when doing this that we need to wrap async_write itself? I know you know this already, but the same assert is firing still. We sequentialized the handler and the async queuing and the client is still not happy for making multiple write calls. What else can be missing?</p>\n\n<p>(Btw, if you write, then get the future, then read, then write again, it works. This is why I'm using futures, to exactly define test cases and define the time order of my tests. I'm being paranoid here.)</p>\n"}, {"tags": ["c++", "arrays", "multidimensional-array", "casting"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 5, "creation_date": 1528312914, "post_id": 50728052, "comment_id": 88464085, "body": "<a href=\"https://stackoverflow.com/questions/50722982/warning-iso-c-forbids-variable-length-array\">Didn&#39;t you ask that exact same question 4 hours ago?</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1528313042, "post_id": 50728052, "comment_id": 88464147, "body": "you also can&#39;t initialize an array from a pointer to another array. You can only initialize it with an initializer list."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1528313080, "post_id": 50728052, "comment_id": 88464161, "body": "Stop this and just use <code>std::array</code> or <code>std::vector</code>.  The code looks like you&#39;re trying to write bad code on purpose."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1528313082, "post_id": 50728052, "comment_id": 88464163, "body": "It isn&#39;t a problem, C++ <b>does not have C VLAs</b>, but g++ supports them as an extension. If you compile with <code>-pedantic</code> -- of course it is going to warn of the circumstance."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1528313087, "post_id": 50728052, "comment_id": 88464169, "body": "It looks like you want to declare a pointer that points to the other array, not a new array."}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "edited": false, "score": 0, "creation_date": 1528313188, "post_id": 50728052, "comment_id": 88464210, "body": "Same issue but it is different context and this question is more clearer to understand"}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528313398, "post_id": 50728052, "comment_id": 88464312, "body": "using std::vector how can i do this operation &#39;float (<i>p)[numcols]=(float(</i>)[numcols])q;&#39; ?? @PaulMcKenzie"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1528313468, "post_id": 50728052, "comment_id": 88464350, "body": "@nhkrishna Question back to you -- what is that line supposed to do?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1528313697, "post_id": 50728052, "comment_id": 88464446, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50722982/warning-iso-c-forbids-variable-length-array\">warning: ISO C++ forbids variable length array</a>"}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528313962, "post_id": 50728052, "comment_id": 88464567, "body": "@PaulMcKenzie rhs  expression will return the address of first column of <b>q</b> and rhs expression <b>p</b> will point the array of elements in first column"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528313963, "post_id": 50728052, "comment_id": 88464570, "body": "for me the question is completely unclear, it seems like you know why the warning is there while the code compiles (with the right compiler flags) and does what you expect (thanks to some compiler specific extensions), what is the problem?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1528314009, "post_id": 50728052, "comment_id": 88464600, "body": "@nhkrishna <i>My intention is to change the 1D buffer(p) to 2D buffere(q) with just pointer redirections and without any loop.</i> -- You cannot &quot;change&quot; the buffer.  Why not stay with the 1D buffer and use simple pointer arithmetic to get you to position <code>(x,y)</code>?  That is a well-known technique in simulating a 2D array from a 1D buffer."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528314216, "post_id": 50728052, "comment_id": 88464690, "body": "<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528314377, "post_id": 50728052, "comment_id": 88464772, "body": "@PaulMcKenzie yes know..I&#39;m tryimg this for optimization purpose. So, I&#39;m just exposing simple example to understand my issue."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1528314502, "post_id": 50728052, "comment_id": 88464829, "body": "@nhkrishna -- Why do you believe that the solution of calculating the offset is not optimal?  Optimizing compilers are smart these days, much smarter than what you may believe.  The result of your current attempts may result in <i>slower</i> code, all due to too much pointer usage / aliasing (and then the compiler has no way of optimizing your code and just gives up)."}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528545164, "post_id": 50728052, "comment_id": 88554952, "body": "@PaulMcKenzie yes, but i want use openmp over the nested for loop to take advantage of multithreading. (Here nested loop must be perfect then only we can use collapse flag in openmp). And, finally now i&#39;m able to get optimal performance just by making numcols constant without this error."}], "answers": [{"comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528315600, "post_id": 50728499, "comment_id": 88465369, "body": "<i>Compilers are usually much better than humans in optimizing.</i> -- Yes, I mentioned to the OP in the main comments that trying to be too tricky with pointers could result in the optimizer just not touching the code, thus resulting in slower code than was intended."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528315858, "post_id": 50728499, "comment_id": 88465495, "body": "@PaulMcKenzie would you consider my code as &quot;too tricky with pointers&quot; ? I actually dont like it too much but tried to stay close to the question, otherwise I would simply recommend to use a plain <code>std::vector</code> and stop messing around with pointers at all"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528316446, "post_id": 50728499, "comment_id": 88465748, "body": "Your code is fine.  You&#39;re merely multiplying and adding a value to get to a position in the array.  It&#39;s just that there are too many coders who believe they&#39;re smarter than the compiler, and thus go overboard with pointer usage.  Maybe 30 years ago that was the case, where you could attempt to &quot;beat the compiler&quot; by using a lot of pointers and aliases, but that is less often the case these days."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1528316763, "post_id": 50728499, "comment_id": 88465885, "body": "yeah i was about to add something along that line.. I mean even if someone would spend all his lifetime to become a master of optimizing pointer arithmetics, still compilers will always be a couple of centuries in advance"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1528316884, "last_edit_date": 1528316884, "creation_date": 1528314737, "answer_id": 50728499, "question_id": 50728052, "link": "https://stackoverflow.com/questions/50728052/warning-iso-c-forbids-variable-length-array-wvla/50728499#50728499", "title": "warning: ISO C++ forbids variable length array [-Wvla]", "body": "<p>You dont need to change anything about the 1D array, but you just need to access it differently. This is what I can come up with that is closest to what you seem to ask for:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\ntemplate &lt;typename T&gt; struct twoD_access {\n    T* first_elem;\n    size_t col_count;\n    T* operator[](size_t row){ return first_elem + (row*col_count);}\n};\ntemplate &lt;typename T&gt; twoD_access&lt;T&gt; get_2D_access(T* ptr,size_t col_count){\n    return { ptr,col_count};\n}\n\n\nint main() {\n    float q[10]={1,2,3,4,5,6,7,8,9,10};\n    auto x = get_2D_access(q,3);\n    for (int i=0;i&lt;3;i++){\n        for (int j=0;j&lt;3;j++){\n            std::cout &lt;&lt; x[i][j];\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>123456789\n</code></pre>\n\n<p>PS: only now i read that you are doing this for optimization. My advice: just dont do it. Actually I dont really understand why you expect better performance by magically turning a 1D array into a 2D one. Compilers are usually much better than humans in optimizing. Especially when it comes to such basic stuff as efficiently accessing arrays, compilers have a couple of centuries of experience that is hard to catch up with. You probably should take a look at <code>std::vector</code> and forget all that pointer nostalgy.</p>\n"}], "owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "closed_date": 1528325607, "answer_count": 1, "score": -4, "last_activity_date": 1528316884, "creation_date": 1528312830, "last_edit_date": 1528314790, "question_id": 50728052, "link": "https://stackoverflow.com/questions/50728052/warning-iso-c-forbids-variable-length-array-wvla", "closed_reason": "Needs details or clarity", "title": "warning: ISO C++ forbids variable length array [-Wvla]", "body": "<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n\n    float q[10]={1,2,3,4,5,6,7,8,9,10};\n    int numrows=2, numcols=5;\n    float (*p)[numcols]=(float(*)[numcols])q;\n    for(int i=0;i&lt;numrows;i++)\n        for(int j=0;j&lt;numcols;j++)\n            printf(\"p[%d][%d]=%f \\n\", i, j, p[i][j]);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Problem reprosteps:</p>\n\n<pre><code>g++ -pedantic problem1.cpp \n</code></pre>\n\n<p>Issue:</p>\n\n<p>For the above code we can see the warning warning: ISO C++ forbids variable length array. We know this is expected warning. My intention is to change the 1D buffer <code>p</code> to 2D buffer <code>q</code> with just pointer redirection and without any loop. I have done this by using </p>\n\n<pre><code>float (*p)[numcols]=(float(*)[numcols])q;\n</code></pre>\n\n<p>But it gives warning. Is there any suggestion to the same operation or we can use same line to take dynamic values?</p>\n"}, {"tags": ["c++", "copy-constructor", "deep-copy"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1528313195, "post_id": 50728043, "comment_id": 88464212, "body": "I don&#39;t understand what you are trying to do. Is it that when you copy an instance, you want to add that instance to the container that owned the original? From reading your code, I don&#39;t see anything special about your copy constructors."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528313415, "post_id": 50728043, "comment_id": 88464320, "body": "&quot;A typical copy constructor is used when object is passed by value, returned by value&quot;  you missed one, when you want to copy an object... which is what you&#39;re doing here."}, {"owner": {"reputation": 1238, "user_id": 2175975, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/994fd0b30b1cd46b51af699c4a80a7ce?s=128&d=identicon&r=PG", "display_name": "Splash", "link": "https://stackoverflow.com/users/2175975/splash"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1528385255, "post_id": 50728043, "comment_id": 88497716, "body": "@Fran&#231;oisAndrieux, I am trying to put the copied instance to a new container, but can&#39;t figure how.  I can only get the original container from other."}], "answers": [{"tags": [], "owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "is_accepted": true, "score": 2, "last_activity_date": 1528314889, "creation_date": 1528314889, "answer_id": 50728530, "question_id": 50728043, "link": "https://stackoverflow.com/questions/50728043/is-it-ok-to-use-c-copy-constructor-for-other-purpose/50728530#50728530", "title": "Is it ok to use C++ copy constructor for other purpose?", "body": "<p>yes, you can define your own copy constructor.</p>\n\n<p>however, as you already noted, this way you'll find it hard to \"forbid\" copies where you do not want them explicitly.</p>\n\n<p>my suggestion: give your object a <code>clone()</code> function and <code>delete</code> the copy constructor (maybe also the copy operator).</p>\n\n<p>this way you only clone when you explicitly intend to.</p>\n"}], "owner": {"reputation": 1238, "user_id": 2175975, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/994fd0b30b1cd46b51af699c4a80a7ce?s=128&d=identicon&r=PG", "display_name": "Splash", "link": "https://stackoverflow.com/users/2175975/splash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "accepted_answer_id": 50728530, "answer_count": 1, "score": 2, "last_activity_date": 1528314889, "creation_date": 1528312786, "question_id": 50728043, "link": "https://stackoverflow.com/questions/50728043/is-it-ok-to-use-c-copy-constructor-for-other-purpose", "title": "Is it ok to use C++ copy constructor for other purpose?", "body": "<p>By other purpose, I mean Clone.  Here is a simplified example: I have objects, some are squares, some are boxes, which are both Object2D. Each one has a unique id. </p>\n\n<p>In this system, I don't need a typical meaning of copy of an object. A typical copy constructor is used when object is passed by value, returned by value, and ...  Here in this system every object is unique, so we don't need the typical copy constructor.  Two squares will differ for at least the id. Therefore, I am using the copy constructor to make clones.  During a clone, I will deep copy the tree structure except the id.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;memory&gt;\n#include &lt;cstdlib&gt;\n#include &lt;vector&gt;\nint offset(){\n    return rand()%100-50;\n}\nint location(){\n    return rand()%10000-5000;\n}\nclass Object2D{\npublic:\n    int x_, y_;\n    int id;\n    static int count;\n    Object2D(int x, int y):x_(x), y_(y){\n        id=count++;\n    }\n};\nint Object2D::count=0;\nclass Square: public Object2D{\npublic:\n    int getParent(){return containedBy_-&gt;id;}\n    Square(Object2D* containedBy, int size):\n            Object2D(containedBy-&gt;x_+offset(), containedBy-&gt;y_+offset()),\n            containedBy_(containedBy),size_(size){\n        std::cout&lt;&lt;\"Square constructor\"&lt;&lt;std::endl;\n    }\n    Square(const Square&amp; other):\n            Object2D(other.x_-other.containedBy_-&gt;x_, other.y_-other.containedBy_-&gt;y_), \n            containedBy_(other.containedBy_), size_(other.size_){\n        std::cout&lt;&lt;\"Square clone\"&lt;&lt;std::endl;\n    }\nprivate:    \n    Object2D* containedBy_;\n    size_t size_;\n};\nclass Box:public Object2D{\nprivate:\n    size_t l_;size_t h_;\n    std::vector&lt;std::shared_ptr&lt;Square&gt;&gt; all;\npublic:\n    void addSquare(int size){\n        auto temp = std::make_shared&lt;Square&gt;(this, size);\n        all.push_back(std::move(temp));\n    }\n    const std::vector&lt;std::shared_ptr&lt;Square&gt;&gt;&amp; getAll() const{\n        return all;\n    }\n    Box(int x, int y, size_t l, size_t h):\n            Object2D(x,y), l_(l), h_(h){}\n    Box(const Box&amp; other):Object2D(location(), location()){// clone the other box, put cloned squares in\n        for(const auto&amp; item:other.getAll()){\n            all.push_back(std::make_shared&lt;Square&gt;(*item));\n        }\n    }\n    void showOffsets(){\n        std::cout&lt;&lt;\"show offsets of all components for container\"&lt;&lt;id&lt;&lt;\":\";\n        for(const auto&amp; item: all){\n            std::cout&lt;&lt;item-&gt;id&lt;&lt;\"(\"&lt;&lt;item-&gt;x_-x_&lt;&lt;\",\"&lt;&lt;item-&gt;y_-y_&lt;&lt;\")\"&lt;&lt;\" \";\n        }\n        std::cout&lt;&lt;std::endl;\n    }\n};\n\nint main()\n{\n    Box b(100,100,100,100);\n    std::cout&lt;&lt;\"before do it\"&lt;&lt;std::endl;\n\n    b.addSquare(10);\n    Box c(b);\n    std::cout&lt;&lt;b.id&lt;&lt;c.id&lt;&lt;std::endl;\n\n    b.showOffsets();\n    c.showOffsets();\n    return 0;\n}\n</code></pre>\n\n<p>Here I clone a box, I need to also clone the contained squares, and keep their offsets.  The cloned objects will have new ids, which are all unique.</p>\n\n<h1>Question</h1>\n\n<p>Is it a good idea to use copy constructor for clone?  Note that, in this case, the copy constructor will behave differently from a typical copy constructor, so I need to forbid any way to make a call to the typically expected copy constructor, such as I can't use vector to contain squares, since a simple vector erase will call copy constructor which will not preserve the id. So I used smart pointers.</p>\n\n<p>Second, how come the offsets are not copied during clone? That is the thing I would like to preserve.</p>\n\n<p>Results:</p>\n\n<pre><code>before do it\nSquare constructor\nSquare clone\n02\nshow offsets of all components for container0:1(36,33) \nshow offsets of all components for container2:3(-1879,2256) \n</code></pre>\n"}, {"tags": ["c++", "testing"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528312586, "post_id": 50727939, "comment_id": 88463947, "body": "An exported or otherwise externally visible symbol can&#39;t be discarded. This isn&#39;t a language feature and depends on your compiler and platform. If you are compiling an executable directly, doing this is harder but I struggle to see why you would want to in that case."}, {"owner": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528312672, "post_id": 50727939, "comment_id": 88463991, "body": "I would like to do this because I&#39;m trying to assess test coverage in a header-only library."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1528322170, "post_id": 50727939, "comment_id": 88468075, "body": "By &quot;not to do that&quot;, you mean that you don&#39;t want the linker to discard uncalled class member functions?"}, {"owner": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "edited": false, "score": 0, "creation_date": 1528393117, "post_id": 50727939, "comment_id": 88501906, "body": "Yes, exactly. I want them to remain in the binary so that gcov can see they were there but not used."}], "answers": [{"comments": [{"owner": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "edited": false, "score": 0, "creation_date": 1528317541, "post_id": 50728050, "comment_id": 88466240, "body": "I recognize that the definition is compiled right away, but I would like it to also compile the body of the methods and include that in the binary. Would you mind clarifying what you mean by &quot;compile your program as a library&quot;?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "edited": false, "score": 0, "creation_date": 1528318673, "post_id": 50728050, "comment_id": 88466722, "body": "@seaotternerd yes, by &quot;compiled right away&quot; I meant the whole body (definition) of all the member functions are compiled."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "edited": false, "score": 0, "creation_date": 1528318897, "post_id": 50728050, "comment_id": 88466834, "body": "@seaotternerd by compiling into a library I mean not compiling into an executable, but as a separated library."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 1, "last_activity_date": 1528318851, "last_edit_date": 1528318851, "creation_date": 1528312822, "answer_id": 50728050, "question_id": 50727939, "link": "https://stackoverflow.com/questions/50727939/explicit-class-instantiation-for-non-templated-classes/50728050#50728050", "title": "Explicit class instantiation for non-templated classes", "body": "<p>There is no concept of instantiation with non template classes. When the compiler encounters the definition of a member function, the definition is compiled right away.</p>\n\n<p>Whether the function is outputted in the binary is up to the compiler and your setup. If you compile your program as a library, all functions will be implemented. If you use static linking, the linker won't add unused functions in you binary.</p>\n\n<p>On the contrary, if you use dynamic linking, all exported definition will be there. Although non exported function such as function with static linkage can be inlined without having a separated definition.</p>\n\n<p>Whether they are actually saved and outputted into the binary is something separated from the compilation itself. For example you could instantiate 100 template functions and in reality have none outputted in the binary. It's up to the linker if your function make it to the binary.</p>\n\n<p>If your function is a public symbol, it will likely get into the binary.</p>\n"}, {"tags": [], "owner": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1529010206, "creation_date": 1529010206, "answer_id": 50865896, "question_id": 50727939, "link": "https://stackoverflow.com/questions/50727939/explicit-class-instantiation-for-non-templated-classes/50865896#50865896", "title": "Explicit class instantiation for non-templated classes", "body": "<p>I didn't manage to get a solution working with dynamic linking (the reason I write header-only libraries is that I hate linkers with a firey passion), but along the way I discovered some built-in compiler options in Clang that did what I want. I added the <code>-fprofile-instr-generate -fcoverage-mapping</code> flags to my compilation, and then used llvm-profdata and llvm-cov to view the test coverage (as described <a href=\"https://clang.llvm.org/docs/SourceBasedCodeCoverage.html\" rel=\"nofollow noreferrer\">here</a>). </p>\n\n<p>Note for anyone else trying to make this work: make sure to use the same llvm version for all three of these commands (clang, llvm-profdata, and llvm-cov).</p>\n"}], "owner": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 50728050, "answer_count": 2, "score": 0, "last_activity_date": 1529010206, "creation_date": 1528312326, "question_id": 50727939, "link": "https://stackoverflow.com/questions/50727939/explicit-class-instantiation-for-non-templated-classes", "title": "Explicit class instantiation for non-templated classes", "body": "<p>In C++, you can explicitly instantiate a templated class like this:</p>\n\n<pre><code>template class A&lt;B&gt;;\n</code></pre>\n\n<p>This forces the compiler to include all of that class's methods its output, which is very useful for assessing which ones are covered by tests.</p>\n\n<p>While (as I understand it) non-templated classes technically get instantiated automatically, unused methods of non-templated classes are often left out of the compiler's output (even with -O0 and other similar flags). Is there a way to force the compiler not to do that?</p>\n"}, {"tags": ["c++", "opencv", "image-processing", "rgb"], "comments": [{"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1528318675, "post_id": 50727873, "comment_id": 88466724, "body": "Try using the debugger. Break where you calculate the mean and check it. Then break where you adjust each pixel and see if you are not handling saturated values correctly or if you are looping incorrectly. Or just try commenting out the <code>if</code> and/or the <code>else</code> in your loop."}], "answers": [{"tags": [], "owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "is_accepted": true, "score": 1, "last_activity_date": 1528468305, "last_edit_date": 1528468305, "creation_date": 1528349756, "answer_id": 50733631, "question_id": 50727873, "link": "https://stackoverflow.com/questions/50727873/opencv-edit-single-band-and-remerge/50733631#50733631", "title": "OpenCV edit single band and remerge", "body": "<p>When you do:</p>\n\n<pre><code>split(image, Bands);\n</code></pre>\n\n<p>You will get from a CV_8UC3 image (<code>image</code>) 3 CV_8U images (<code>Bands</code>). Everything is good until this point. Then you go to your adjusting and do 2 mistakes:</p>\n\n<ol>\n<li><p><code>Mat adjustedBand;</code> is never initialized... You can do <code>Mat adjustedBand(band.rows, band.cols, CV_8UC1);</code> or intialized in a later stage.</p></li>\n<li><p><code>pixel = band.at&lt;Vec3b&gt;(i,j)[0];</code> and <code>adjustedBand.at&lt;Vec3b&gt;(i,j) = temp;</code> are for manipulating 3 channels not a 1 channel image. You need to use <code>uchar</code>instead, like: <code>adjustedBand.at&lt;uchar&gt;(i,j) = temp;</code></p></li>\n</ol>\n\n<p>Those are the errors I see... fix them and try using a debugger, that way you know if something is initialize correctly or if it does the correct operation</p>\n"}], "owner": {"reputation": 702, "user_id": 5956151, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36cbd9873a8a5ca327f20f95974e5f75?s=128&d=identicon&r=PG&f=1", "display_name": "C.Radford", "link": "https://stackoverflow.com/users/5956151/c-radford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 50733631, "answer_count": 1, "score": 0, "last_activity_date": 1528468305, "creation_date": 1528312066, "last_edit_date": 1528465218, "question_id": 50727873, "link": "https://stackoverflow.com/questions/50727873/opencv-edit-single-band-and-remerge", "title": "OpenCV edit single band and remerge", "body": "<p>I have an image which I have split into its three separate channels (b,g,r). I want to manipulate just the red band and then remerge to blue and green band to recompose image. I keep getting a sig abort in my function however. the <code>RBandSlider</code> refers to a global int used for a trackbar which is defaulted to 1. Almost positive the issue is within the <code>ImageEnhancement</code> function.</p>\n\n<p>Do I need to define <code>redBandsAdjsuted</code> as something else or am I not grabbing the pixel local and rewriting it correctly?</p>\n\n<pre><code>Mat ImageEnhancement(Mat band){\nMat adjustedBand;\nScalar mean, std;\nmeanStdDev(band, mean , std);\nint pixel,temp;\nfor(int i = 0; i &lt; band.rows;i++){\n    for(int j = 0; j &lt; band.cols;j++){\n        //extract pixel\n        pixel = band.at&lt;Vec3b&gt;(i,j)[0];\n        //pixel greater than mean\n        if ( pixel &gt; mean[0]){\n            temp = (255);\n            adjustedBand.at&lt;Vec3b&gt;(i,j) = temp;\n        }\n        else{\n            temp = 0;\n            adjustedBand.at&lt;Vec3b&gt;(i,j) = temp ;\n        }\n    }\n}\nreturn adjustedBand;\n}\n\n\nMat Bands[3],merged,redBandsAdjusted(image.cols,image.rows,CV_8UC1),result;\nsplit(image, Bands);\n\n//loop the echancement adjustment\nwhile(true){\n\n\n    //adjust red band and merge\n    redBandsAdjusted = ImageEnhancement(Bands[2]);\n    vector&lt;Mat&gt; channels = {Bands[0],Bands[1],redBandsAdjusted};\n    merge(channels,merged);\n\n}\n</code></pre>\n"}, {"tags": ["c++", "shared-libraries", "v8", "embedding", "embedded-v8"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9960945, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UjagXg8eR_g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0nfcroepF-CPCS4dL_v_jSqVZPIg/mo/photo.jpg?sz=128", "display_name": "Damaris M", "link": "https://stackoverflow.com/users/9960945/damaris-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1530797721, "creation_date": 1530797721, "answer_id": 51192748, "question_id": 50727785, "link": "https://stackoverflow.com/questions/50727785/how-to-use-v8-shared-library-in-linux/51192748#51192748", "title": "how to use v8 shared library in linux", "body": "<p>This tutorial helped me a lot:</p>\n\n<p><a href=\"https://medium.com/dailyjs/how-to-build-v8-on-windows-and-not-go-mad-6347c69aacd4\" rel=\"nofollow noreferrer\">https://medium.com/dailyjs/how-to-build-v8-on-windows-and-not-go-mad-6347c69aacd4</a></p>\n\n<p>and also, if you don't want to have this kind of problem with the libraries, you can use the v8 NuGet:</p>\n\n<p><a href=\"https://github.com/pmed/v8-nuget\" rel=\"nofollow noreferrer\">https://github.com/pmed/v8-nuget</a></p>\n\n<p>You can install directly into your project in VisualStudio and you don't need to make any reference.</p>\n"}], "owner": {"reputation": 19, "user_id": 7402660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iofic.jpg?s=128&g=1", "display_name": "spicy chicken", "link": "https://stackoverflow.com/users/7402660/spicy-chicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 660, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530797721, "creation_date": 1528311759, "last_edit_date": 1528324562, "question_id": 50727785, "link": "https://stackoverflow.com/questions/50727785/how-to-use-v8-shared-library-in-linux", "title": "how to use v8 shared library in linux", "body": "<p>I am working on a project that uses v8 engine. I have followed the instructions on v8 git page to compile it and generated some .so files. But now after that there are no more directions as how to proceed with those library files. I wanted to try out with the hello-world example provided but it uses static libraries(but we need dynamic ones). I couldn't find any relavant documentation nor tutorials on internet...\nCould anyone point me to some directions as how to proceed to include those dynamic libraries to my program..</p>\n"}, {"tags": ["c++", "makefile", "gnu-make"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1528311569, "post_id": 50727687, "comment_id": 88463484, "body": "Use <a href=\"http://bashdb.sourceforge.net/remake/\" rel=\"nofollow noreferrer\">remake</a> as <code>remake -x</code> to debug your <code>Makefile</code> and understand how <code>make</code> works"}], "answers": [{"comments": [{"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1528314140, "post_id": 50728086, "comment_id": 88464657, "body": "Ah! I will try this. did not know that."}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1528314433, "post_id": 50728086, "comment_id": 88464795, "body": "and it looks like you are right--I am updating the path of the <code>SHELL</code> with the new binaries, but I the shell command created a child shell that was a brand new bash shell, rather than a child of the current. got it solved (next comment)"}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1528314484, "post_id": 50728086, "comment_id": 88464822, "body": "solution was to take your statement, and add:   <code>$(shell &#47;bin&#47;bash -c &#39;PATH=$(my_new_bin_folder):$$PATH; which program&#39;)</code>"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1528373669, "post_id": 50728086, "comment_id": 88489304, "body": "I see.  Well it would have been a lot more obvious what the problem was if you&#39;d added the <code>PATH</code> assignment to the original makefile you showed in your question, and if you&#39;d used the correct path to the program that which discovered (e.g., <code>&#47;path&#47;to&#47;hew&#47;programs&#47;program</code> rather than <code>&#47;path&#47;to&#47;program</code>) so it was clear that the program you&#39;re looking for was in that directory.  In general it&#39;s best to provide a short, <i>working</i> example (cut and pasted) including error output rather than a paraphrased version which may not be accurate."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1528373762, "post_id": 50728086, "comment_id": 88489349, "body": "I don&#39;t think you need the <code>bash -c</code> though: the problem is not the shell, the problem is that <code>PATH</code> isn&#39;t exported.  And you can just use make&#39;s variable, like this: <code>$(shell PATH=&#39;$(PATH)&#39; which program)</code> should work."}], "tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": false, "score": 2, "last_activity_date": 1528313003, "creation_date": 1528313003, "answer_id": 50728086, "question_id": 50727687, "link": "https://stackoverflow.com/questions/50727687/make-variable-fails-to-assign-from-shell-call/50728086#50728086", "title": "Make: variable fails to assign from shell call", "body": "<p>Does the explicit <code>which</code> work if you don't set the <code>SHELL</code> variable in your makefile?</p>\n\n<p>Setting the <code>SHELL</code> variable only impacts recipes.  It's not used for the <code>$(shell ...)</code> function.  You can use:</p>\n\n<pre><code>my_var := $(shell /bin/bash -c 'which function')\n</code></pre>\n\n<p>However on my system even using the default shell works with <code>which</code>.  Maybe your system is different somehow.</p>\n\n<p>Note of course <code>which</code> finds <em>programs</em>, not functions...</p>\n"}, {"comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1530114141, "post_id": 51063140, "comment_id": 89123351, "body": "That is not true.  Any variable that was imported from the environment is automatically marked for export as well.  Modifications to those variables made in the makefile do get exported automatically.  However it is true that variable assignments made in the makefile do not get sent to <code>shell</code> functions."}, {"owner": {"reputation": 13127, "user_id": 470195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02d4760cd8c4c374aa12b8920df8ba9?s=128&d=identicon&r=PG", "display_name": "bobbogo", "link": "https://stackoverflow.com/users/470195/bobbogo"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1530271316, "post_id": 51063140, "comment_id": 89188365, "body": "@MadScientist Urk! You are right, making all the text in my answer wrong. Sigh."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1530276834, "post_id": 51063140, "comment_id": 89191642, "body": "This is the way GNU make has always worked.  I can&#39;t say whether it was originally intended to work this way, or if it was just an oversight.  Since it&#39;s not documented we can&#39;t say for sure.  There is a bug/enhancement request open in Savannah to change this behavior.  I don&#39;t care much myself but I am leery of changing it due to backward-compatibility issues."}], "tags": [], "owner": {"reputation": 13127, "user_id": 470195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02d4760cd8c4c374aa12b8920df8ba9?s=128&d=identicon&r=PG", "display_name": "bobbogo", "link": "https://stackoverflow.com/users/470195/bobbogo"}, "is_accepted": true, "score": 0, "last_activity_date": 1530272505, "last_edit_date": 1530272505, "creation_date": 1530103474, "answer_id": 51063140, "question_id": 50727687, "link": "https://stackoverflow.com/questions/50727687/make-variable-fails-to-assign-from-shell-call/51063140#51063140", "title": "Make: variable fails to assign from shell call", "body": "<p><strong>RE-WRITTEN</strong>\n(Thanks to @MadScientist for pointing out my confusion.\nI thought it best to completely delete the erroneous info.)</p>\n\n<p>As <code>$PATH</code> was originally exported into <em>make</em>'s environment,\n<em>make</em> will ensure that it is exported into the environment of any recipe commands that it runs.\nAny change made to <code>$PATH</code> in the makefile <em>will</em> make its way through to the environment of receipe commands run by <em>make</em>.</p>\n\n<p>Note that this is <em>not</em> true for commands run via <code>$(shell \u2026)</code>.\nExported variables keep the values they had when <em>make</em> started.\nAny changes they suffer within the makefile are ignored as far as the external commands are concerned.</p>\n\n<p>As pointed out elsewhere,\none workaround is to explicitly repeat the augmentation of <code>$PATH</code> in any <code>$(shell \u2026)</code></p>\n\n<pre><code>my_var := $(shell PATH='${PATH}' which program)\n</code></pre>\n\n<p>(Surprises me. Is this a <em>make</em> bug? Or at least a documentation bug?)</p>\n"}], "owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51063140, "answer_count": 2, "score": 0, "last_activity_date": 1530272505, "creation_date": 1528311435, "last_edit_date": 1528315153, "question_id": 50727687, "link": "https://stackoverflow.com/questions/50727687/make-variable-fails-to-assign-from-shell-call", "title": "Make: variable fails to assign from shell call", "body": "<pre><code># makefile\n\nSHELL:=/bin/bash\nPATH:=/path/to/new/programs:$(PATH)\n\n\nmy_var:=$(shell which program)\n\nrule:\n    echo $(my_var)\n    which program\n\n#output\n$: make rule\n\necho \n\nwhich program\n/path/to/program\n\n# prints nothing\n</code></pre>\n\n<p>I have tried everything, and actually recall getting this to work as I was creating the makefile earlier.  It is turning into a quagmire--all I need to do is check whether an exe exists before I install it. </p>\n"}, {"tags": ["c++", "multithreading", "openmp"], "answers": [{"comments": [{"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1528322485, "post_id": 50730135, "comment_id": 88468191, "body": "Thank you very much.  Don&#39;t think I can do much about the new/delete.  It&#39;s not my code.  Thanks."}, {"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "reply_to_user": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 1, "creation_date": 1528369169, "post_id": 50730135, "comment_id": 88486444, "body": "@bob if you really have to do memory allocation, make sure that you are using a thread-aware memory allocator. <a href=\"https://www.infoworld.com/article/3201285/software/why-effective-parallel-programming-must-include-scalable-memory-allocation.html\" rel=\"nofollow noreferrer\">infoworld.com/article/3201285/software/&hellip;</a> seems a useful place to start."}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1528379198, "post_id": 50730135, "comment_id": 88493300, "body": "@JimCownie  Thanks very much for the tip.  Will look into it."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 1, "last_activity_date": 1528321833, "creation_date": 1528321833, "answer_id": 50730135, "question_id": 50727589, "link": "https://stackoverflow.com/questions/50727589/adequately-privatizing-data-in-openmp-threads/50730135#50730135", "title": "Adequately privatizing data in OpenMP threads", "body": "<p>Your code is perfectly safe.</p>\n\n<p>Anything that happens in <code>GetNumber</code> is completely local to one thread, no variable or pointer escapes. To be precise, the variable <code>tmp</code> is private to each thread - other threads do not see it. Consequently, the data pointed to by <code>tmp</code>, which is allocated by each thread, is not visible to any other thread.</p>\n\n<p>That said - if the code is any indication of real code, I would highly recommend using less <code>new</code> / <code>delete</code> and placing more objects on the stack. It makes reasoning about the code much easier - especially involving threads.</p>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 50730135, "answer_count": 1, "score": 0, "last_activity_date": 1528321833, "creation_date": 1528311124, "question_id": 50727589, "link": "https://stackoverflow.com/questions/50727589/adequately-privatizing-data-in-openmp-threads", "title": "Adequately privatizing data in OpenMP threads", "body": "<p>The following toy code does nothing useful that I am aware of:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include \"omp.h\"\n\nusing namespace std;\n\nclass OtherClass {\n\n   public:\n\n   OtherClass() {\n      cout &lt;&lt; \"hi\\n\";\n   }\n\n   int GetNumber(int input) {\n      int i, num;\n      int *tmp;\n\n      tmp = new int[100];\n\n      tmp[0] = 0;\n      for (i=1;i&lt;100;i++) {\n         tmp[i] = (input*tmp[i-1]+1)%5;\n      }\n      num = tmp[input];\n\n      delete[] tmp;\n\n      return num;\n   }\n\n   ~OtherClass() {\n      cout &lt;&lt; \"bye\\n\";\n   }\n\n};\n\n\nclass MainClass {\n\n   public:\n\n   int *myarray;\n\n   MainClass(int numcells) {\n      myarray = new int[numcells];\n   }\n\n   ~MainClass() {\n      delete[] myarray;\n   }\n\n};\n\n\nint main() {\n\n   int i;\n\n#define NUMELEMS 100\n\n   MainClass *mc = new MainClass(NUMELEMS);\n   OtherClass *oc = new OtherClass();\n\n#pragma omp parallel private(i)\n   { \n#pragma omp for\n   for (i=0; i&lt;NUMELEMS; i++ ) {\n      mc-&gt;myarray[i] = oc-&gt;GetNumber(omp_get_thread_num()+1);\n   }\n   } // end of omp parallel\n\n   for (i=0; i&lt;NUMELEMS; i++) {\n      cout &lt;&lt; mc-&gt;myarray[i] &lt;&lt; \"\\n\";\n   }\n\n   delete mc;\n   delete oc;\n\n}\n</code></pre>\n\n<p>But it illustrates a question that has arisen in my mind while dealing with a real code.  Namely, I am wondering about the array <code>tmp</code> in <code>OtherClass:GetNumber</code>.  The details of how <code>tmp</code> is populated are unimportant; I was just putting in some code to produce some \"interesting\" numbers that would somehow vary from thread to thread.  My question is, is <code>tmp</code> adequately protected from the various threads that might be running?  Is it possible that the threads will be tripping over each other as they initialize, access, and delete it?  Will one thread access <code>tmp</code> as defined by another thread, for instance?  Or might one thread delete <code>tmp</code> before another thread can access it?  Can someone tell me how I should modify the code, if modifications are needed?</p>\n\n<p>This code runs fine by the way.  But I am wondering what might happen in a much more complicated, larger code.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1528311246, "post_id": 50727529, "comment_id": 88463326, "body": "It seems like an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is in order. What compiler and what compilation flags are you using?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1528312346, "post_id": 50727529, "comment_id": 88463846, "body": "What leads you to expect an exception on overflow? <i>I</i> would expect it to be Undefined Behaviour, but I didn&#39;t check the standard to verify thst."}, {"owner": {"reputation": 321, "user_id": 8694474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97659a955c605478604ad5252e73a28?s=128&d=identicon&r=PG&f=1", "display_name": "JuliusCaesar", "link": "https://stackoverflow.com/users/8694474/juliuscaesar"}, "edited": false, "score": 0, "creation_date": 1528313584, "post_id": 50727529, "comment_id": 88464400, "body": "how can i be sure not to run into unexpected behaviour because of to few free heap. How can i check if adding a vector element failed?"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 8694474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97659a955c605478604ad5252e73a28?s=128&d=identicon&r=PG&f=1", "display_name": "JuliusCaesar", "link": "https://stackoverflow.com/users/8694474/juliuscaesar"}, "edited": false, "score": 0, "creation_date": 1528406075, "post_id": 50729224, "comment_id": 88508277, "body": "thx for the tip. I removed the fno-exceptions flag. (BTW for G++ you have to disable this in the compiler options AND linker options, I only did the first) But the general problem still exist. How can I tell whether a vector reallocation failed because of insufficient heap?. There must be a way?"}], "tags": [], "owner": {"reputation": 2597, "user_id": 4755321, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e93c2832d8928731e8e5d2f6d665c4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek \u015alimok", "link": "https://stackoverflow.com/users/4755321/jacek-%c5%9alimok"}, "is_accepted": false, "score": 2, "last_activity_date": 1528317554, "creation_date": 1528317554, "answer_id": 50729224, "question_id": 50727529, "link": "https://stackoverflow.com/questions/50727529/c-heap-overflow-results-in-hardfault/50729224#50729224", "title": "C++ Heap Overflow results in hardfault", "body": "<p>You definitely won't get an exception as you compile with <code>-fno-exceptions</code>, which is quite normal for bare-metal applications like yours.</p>\n"}], "owner": {"reputation": 321, "user_id": 8694474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97659a955c605478604ad5252e73a28?s=128&d=identicon&r=PG&f=1", "display_name": "JuliusCaesar", "link": "https://stackoverflow.com/users/8694474/juliuscaesar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1528317554, "creation_date": 1528310919, "last_edit_date": 1528313413, "question_id": 50727529, "link": "https://stackoverflow.com/questions/50727529/c-heap-overflow-results-in-hardfault", "title": "C++ Heap Overflow results in hardfault", "body": "<p>I was trying to test a heap overflow:\nTherefore I'm adding lots of dummy elements to a vector.\nMy expectation: some sort of exception (bad alloc or something like that).</p>\n\n<p>(since a vector is a contiguous memory area reallocations are likely to happen once the vector grows. I'm wondering how i could detect if adding an element worked.\nAccording to <a href=\"http://www.cplusplus.com/reference/vector/vector/push_back/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/vector/vector/push_back/</a>\npush_back has no return value).</p>\n\n<p>Additionally i have defined a custom termination handler. The custom termination handler is set <strong>before</strong>  the heap overflow is induced.</p>\n\n<p>I'm setting my termination handler to a custom handler</p>\n\n<pre><code>void CFatal_Error::Set_Termination_Handler()\n{\n    set_terminate(Termination_Handler);\n}\n\nvoid CFatal_Error::Termination_Handler()\n{\n    // crash and stop here\n    configASSERT(0);\n}\n</code></pre>\n\n<p>The heap overflow is provoked by</p>\n\n<pre><code>vector&lt;uint32_t&gt; test;\ntry\n{\n    for (uint32_t i = 0; i &lt; UINT32_MAX; i++)\n    {\n        test.push_back(i);\n    }\n}\ncatch (const exception &amp;ex)\n{\n    configASSERT(0);\n}\n</code></pre>\n\n<p>First I'd expect that I'm running into the exception but instead I'm going directly to a hard fault. Could somebody explain this behaviour?</p>\n\n<p>Compiler flags used:</p>\n\n<pre><code>Building file: ../Test_SD.cpp\nInvoking: MCU G++ Compiler\n\\Debug\narm-none-eabi-g++ -mcpu=cortex-m4 -mthumb -mfloat-abi=hard -mfpu=fpv4-sp-d16 '-D__weak=__attribute__((weak))' '-D__packed=__attribute__((__packed__))' -DUSE_HAL_DRIVER -DSTM32F429xx -I\"Inc\" -I\"Inc/User\" -I\"xxx/Inc/User/debug\" -I\"xxx/Inc/User/Testcases\" -I\"xxx/Inc/User/display\" -I\"xxx/Inc/User/SD\" -I\"xxx/Inc/User/SD/XML\" -I\"xxx/Drivers/STM32F4xx_HAL_Driver/Inc\" -I\"xxx/Drivers/STM32F4xx_HAL_Driver/Inc/Legacy\" -I\"xxx/Middlewares/Third_Party/FreeRTOS/Source/portable/GCC/ARM_CM4F\" -I\"xxx/Middlewares/ST/STM32_USB_Device_Library/Core/Inc\" -I\"xxx/Middlewares/ST/STemWin/Config\" -I\"xxx/Middlewares/ST/STemWin/inc\" -I\"xxx/Middlewares/ST/STM32_USB_Device_Library/Class/CustomHID/Inc\" -I\"xxx/Drivers/CMSIS/Device/ST/STM32F4xx/Include\" -I\"xxx/Middlewares/Third_Party/FatFs/src\" -I\"xxx/Middlewares/Third_Party/FreeRTOS/Source/include\" -I\"xxx/Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS\" -I\"xxx/Drivers/CMSIS/Include\"  -g3 -pedantic -Wall -Wextra -Wconversion -fmessage-length=0 -std=c++17 -ffunction-sections -c -fno-rtti -MMD -MP -MF\"Src/User/Testcases/Test_SD.d\" -MT\"Src/User/Testcases/Test_SD.o\" -o \"Src/User/Testcases/Test_SD.o\" \"../Src/User/Testcases/Test_SD.cpp\"\nFinished building: ../Src/User/Testcases/Test_SD.cpp\n</code></pre>\n\n<p>Linker flags used</p>\n\n<pre><code>    Building target: xxx.elf\nInvoking: MCU G++ Linker\narm-none-eabi-g++ -mcpu=cortex-m4 -mthumb -mfloat-abi=hard -mfpu=fpv4-sp-d16 -L\"xxx\\Middlewares\\ST\\STemWin\\Lib\"  -specs=nosys.specs -specs=nano.specs -u_printf_float -T\"../STM32F429ZITx_FLASH.ld\" -Wl,-Map=output.map -Wl,--gc-sections -fno-exceptions -fno-rtti -o \"Giessomat.elf\" @\"objects.list\"  -lSTemWin540_CM4_OS_GCC -lm\nFinished building target: Giessomat.elf\n\nmake --no-print-directory post-build\nGenerating binary and Printing size information:\n</code></pre>\n\n<p><strong>Edited Entry</strong></p>\n"}, {"tags": ["c++", "breakpoints", "guid", "heap-corruption", "setupapi"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528310503, "post_id": 50727394, "comment_id": 88462964, "body": "At first glace, the error sounds like you have undefined behavior somewhere that&#39;s corrupting the heap."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528310631, "post_id": 50727394, "comment_id": 88463039, "body": "Are you sure <code>EnumerateAllWinUsbGuids();</code> returns a vector with at least two elements?"}, {"owner": {"reputation": 31, "user_id": 6305497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbeb8d6bfde84279a316bcfb307cd76?s=128&d=identicon&r=PG&f=1", "display_name": "Heng Beng", "link": "https://stackoverflow.com/users/6305497/heng-beng"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528310804, "post_id": 50727394, "comment_id": 88463131, "body": "Yes it does return 2 guids. I printed them as a string at first to make sure."}, {"owner": {"reputation": 31, "user_id": 6305497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbeb8d6bfde84279a316bcfb307cd76?s=128&d=identicon&r=PG&f=1", "display_name": "Heng Beng", "link": "https://stackoverflow.com/users/6305497/heng-beng"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528310870, "post_id": 50727394, "comment_id": 88463156, "body": "I will have to do more research on the heap. Im not familiar with it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528311160, "post_id": 50727394, "comment_id": 88463280, "body": "Print the vector&#39;s size instead, with <code>guid.size()</code>, to be sure. It&#39;s not because that the print succeeded that the vector <i>actually</i> contains two elements. Trying to print an element from a vector past the end is undefined behavior, which can include printing something that looks like a GUID."}, {"owner": {"reputation": 31, "user_id": 6305497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbeb8d6bfde84279a316bcfb307cd76?s=128&d=identicon&r=PG&f=1", "display_name": "Heng Beng", "link": "https://stackoverflow.com/users/6305497/heng-beng"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528315911, "post_id": 50727394, "comment_id": 88465510, "body": "@Fran&#231;oisAndrieux i tried looking at vector size, i get vector size equal to 2 but error still appears."}, {"owner": {"reputation": 31, "user_id": 6305497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbeb8d6bfde84279a316bcfb307cd76?s=128&d=identicon&r=PG&f=1", "display_name": "Heng Beng", "link": "https://stackoverflow.com/users/6305497/heng-beng"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528400239, "post_id": 50727394, "comment_id": 88505433, "body": "@Fran&#231;oisAndrieux thanks for the help, i was able to solve it!"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6305497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbeb8d6bfde84279a316bcfb307cd76?s=128&d=identicon&r=PG&f=1", "display_name": "Heng Beng", "link": "https://stackoverflow.com/users/6305497/heng-beng"}, "is_accepted": true, "score": 0, "last_activity_date": 1541704985, "last_edit_date": 1541704985, "creation_date": 1528400199, "answer_id": 50749001, "question_id": 50727394, "link": "https://stackoverflow.com/questions/50727394/get-a-random-breakpoint-then-an-unhandled-exception-while-trying-to-use-syntax-f/50749001#50749001", "title": "Get a random breakpoint then an unhandled exception while trying to use syntax from setup.api", "body": "<p>Found my error.</p>\n\n<p>Fixed by adding the following line to my code,</p>\n\n<pre><code> PSP_DEVICE_INTERFACE_DETAIL_DATA mem = (PSP_DEVICE_INTERFACE_DETAIL_DATA)LocalAlloc(LPTR, size);\n</code></pre>\n\n<p>I needed to allocate a certain amount of bytes of memory. The reason it would break is because not enough memory was allocated using the \"new\"; that is my assumption. If anyone knows why this fixed the problem please comment down below to give more information.</p>\n\n<p>The example from the link below helped me in finding the solution. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb204769(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/bb204769(v=vs.85).aspx</a> </p>\n"}], "owner": {"reputation": 31, "user_id": 6305497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbeb8d6bfde84279a316bcfb307cd76?s=128&d=identicon&r=PG&f=1", "display_name": "Heng Beng", "link": "https://stackoverflow.com/users/6305497/heng-beng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 50749001, "answer_count": 1, "score": -1, "last_activity_date": 1541705321, "creation_date": 1528310401, "last_edit_date": 1541705321, "question_id": 50727394, "link": "https://stackoverflow.com/questions/50727394/get-a-random-breakpoint-then-an-unhandled-exception-while-trying-to-use-syntax-f", "title": "Get a random breakpoint then an unhandled exception while trying to use syntax from setup.api", "body": "<p>I have spent hours looking through this code trying different things. But to no avail. After running the code below sometimes it will throw me an exception \".exe has triggered a breakpoint.\". </p>\n\n<p>After i press continue it will give me \"Unhandled exception at 0x00007FFCF935775F (ntdll.dll) in SeekThermalCPP_V3.exe: 0xC0000374: A heap has been corrupted (parameters: 0x00007FFCF93B86B0).\"  </p>\n\n<p>Then i press continue again and i get my actual results (which are the devicepaths). </p>\n\n<p>I tried setting my own breakpoints and look at values. But they all look fine. I switched between 32 and 64 bit but that didnt do much. </p>\n\n<p>The problem seems to occur in GetDevicePathString(). if i remove it, no problem occurs in the other 1st two methods.</p>\n\n<p>Thank you very much, any help and/or advice would be appreciated! If im not doing something right please tell.</p>\n\n<hr>\n\n<h2>The code is below</h2>\n\n<p>Im trying to obtain a device path. First i find the GUIDs and then i look at the device interfaces. From the SetupDiGetDeviceInterfaceDetail  im trying to obtain SP_DEVICE_INTERFACE_DETAIL_DATA and get the DevicePath. I want to use that device path later to send commands to my USB device. Im thinking of using WINUSB API to accomplish that. </p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;windows.h&gt;\n#include &lt;SetupAPI.h&gt;\n#include &lt;Cfgmgr32.h&gt;\n#include &lt;vector&gt;\n//#include &lt;winusb.h&gt;\n#pragma comment (lib, \"Setupapi.lib\")\n\nusing namespace std;\n\nvector&lt;GUID&gt; EnumerateAllWinUsbGuids();\nvoid FindUsbDevicePath(GUID inputGUID);\nvoid GetDevicePathString(HDEVINFO DeviceInfoSet, PSP_DEVICE_INTERFACE_DATA DeviceInterfaceData);\n\nint main()\n{\n    vector&lt;GUID&gt; guid = EnumerateAllWinUsbGuids();\n    GUID guid0 = guid[0];\n\n    GUID guid1 = guid[1];\n\n\n\n    FindUsbDevicePath(guid0);\n\n    FindUsbDevicePath(guid1);\n\n    std::getchar();\n    return 0;\n}\n\nvector&lt;GUID&gt; EnumerateAllWinUsbGuids()\n{\n    vector&lt;GUID&gt; dataVECTOR;\n    HDEVINFO DeviceInfoSet = SetupDiGetClassDevs(NULL, NULL, NULL, DIGCF_ALLCLASSES | DIGCF_PRESENT);\n\n    PSP_DEVINFO_DATA devInfoData = new SP_DEVINFO_DATA();\n    devInfoData-&gt;cbSize = sizeof(SP_DEVINFO_DATA);\n\n    for (unsigned int i = 0;; i++)\n    {\n        bool checkINFO = SetupDiEnumDeviceInfo(DeviceInfoSet, i, devInfoData);\n\n        HKEY hkey = SetupDiOpenDevRegKey(DeviceInfoSet, devInfoData, DICS_FLAG_GLOBAL, 0, DIREG_DEV, KEY_QUERY_VALUE | KEY_ENUMERATE_SUB_KEYS | KEY_NOTIFY);\n\n        if (!checkINFO)\n        {\n            SetupDiDestroyDeviceInfoList(DeviceInfoSet);\n            RegCloseKey(hkey);\n            break;\n        }\n\n        wchar_t dataIN[MAX_DEVICE_ID_LEN];\n        unsigned long outLength = sizeof(dataIN);\n\n        LPCWSTR deviceProperty = L\"DeviceInterfaceGUIDs\";\n\n        long checkGET = RegGetValue(hkey, NULL, deviceProperty, RRF_RT_REG_SZ | RRF_RT_REG_MULTI_SZ, NULL, &amp;dataIN, &amp;outLength);\n\n        if (checkGET == 0)\n        {\n            GUID guid;\n            CLSIDFromString(dataIN, (LPCLSID)&amp;guid);\n            dataVECTOR.push_back(guid);\n        }\n    }\n    return dataVECTOR;\n}\n\nvoid FindUsbDevicePath(GUID inputGUID)\n{\n    HDEVINFO DeviceInfoSet = SetupDiGetClassDevs(&amp;inputGUID, NULL, NULL, DIGCF_DEVICEINTERFACE | DIGCF_PRESENT);\n    if (GetLastError() == 8)\n    {\n        SetupDiDestroyDeviceInfoList(DeviceInfoSet);\n    }\n    cout &lt;&lt; \"LAST ERROR SetupDiGetClassDevs : \" &lt;&lt; GetLastError() &lt;&lt; endl;\n\n    unsigned long i = 0;\n    while (true)\n    {\n        SP_DEVICE_INTERFACE_DATA DeviceInterfaceData;\n        DeviceInterfaceData.cbSize = sizeof(SP_DEVICE_INTERFACE_DATA);\n\n        bool checkINFO = SetupDiEnumDeviceInterfaces(DeviceInfoSet, NULL, &amp;inputGUID, i, &amp;DeviceInterfaceData);\n        if (!checkINFO)\n        {\n            SetupDiDestroyDeviceInfoList(DeviceInfoSet);\n            break;\n        }\n        GetDevicePathString(DeviceInfoSet, &amp;DeviceInterfaceData);\n        i++;\n    }\n}\n\nvoid GetDevicePathString(HDEVINFO DeviceInfoSet, PSP_DEVICE_INTERFACE_DATA DeviceInterfaceData)\n{\n    unsigned long checkSize;\n    bool check = SetupDiGetDeviceInterfaceDetail(DeviceInfoSet, DeviceInterfaceData, NULL, 0, &amp;checkSize, NULL);\n    cout &lt;&lt; \"LAST ERROR SetupDiGetDeviceInterfaceDetail 1: \" &lt;&lt; GetLastError() &lt;&lt; endl;\n\n    unsigned long trueSize = checkSize;\n    int** pointerSize;\n    cout &lt;&lt; \"size of a pointer : \" &lt;&lt; sizeof(pointerSize) &lt;&lt; endl;\n    unsigned long structlength = 6;\n    if (sizeof(pointerSize) == 8) { structlength = 8; }\n\n    PSP_DEVICE_INTERFACE_DETAIL_DATA mem = new SP_DEVICE_INTERFACE_DETAIL_DATA();\n    mem-&gt;cbSize = structlength;\n    check = SetupDiGetDeviceInterfaceDetail(DeviceInfoSet, DeviceInterfaceData, mem, trueSize, &amp;checkSize, NULL);\n    cout &lt;&lt; \"LAST ERROR SetupDiGetDeviceInterfaceDetail 2: \" &lt;&lt; GetLastError() &lt;&lt; endl;\n\n    wstring dataSTR = wstring(mem-&gt;DevicePath);\n    wcout &lt;&lt; dataSTR &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1528310168, "post_id": 50727304, "comment_id": 88462797, "body": "So your trouble is getting the milliseconds? Would this be a duplicate then? <a href=\"https://stackoverflow.com/q/19555121/2602718\">stackoverflow.com/q/19555121/2602718</a>"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528310184, "post_id": 50727304, "comment_id": 88462802, "body": "All of the ton of duplicates will exhibit a pattern to get from bigger to lower and lower units. Extrapolate and apply to your question."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528310211, "post_id": 50727304, "comment_id": 88462816, "body": "Could you link a duplicate and explain why it&#39;s not applicable? It&#39;s not clear what your special requirements are."}, {"owner": {"reputation": 880, "user_id": 1089763, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/nYmmz.jpg?s=128&g=1", "display_name": "Tom Mekken", "link": "https://stackoverflow.com/users/1089763/tom-mekken"}, "edited": false, "score": 1, "creation_date": 1528310854, "post_id": 50727304, "comment_id": 88463149, "body": "Hint: 1000ms = 1s; 60s = 1min; 60min = 1h. The rest is math and it shouldn&#39;t matter whether you only have an example in Java (your c++ line seems valid so far)"}], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 9746273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9hgs.png?s=128&g=1", "display_name": "L. Kue", "link": "https://stackoverflow.com/users/9746273/l-kue"}, "is_accepted": false, "score": 0, "last_activity_date": 1528310461, "creation_date": 1528310461, "answer_id": 50727405, "question_id": 50727304, "link": "https://stackoverflow.com/questions/50727304/convert-milliseconds-to-hoursminutessecondsmilliseconds-in-c/50727405#50727405", "title": "Convert milliseconds to hours:minutes:seconds:milliseconds in C++", "body": "<p>Not exactly what you're looking for, but if you're only accessing the current time, this will work:</p>\n\n<pre><code>#include &lt;chrono&gt;\n\nauto ms = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(std::chrono::high_resolution_clock::now().time_since_epoch());\nconst auto seconds = std::chrono::duration_cast&lt;std::chrono::seconds&gt;(ms);\nms -= seconds;\n</code></pre>\n\n<p>You can then add <code>ms.count()</code> to your cout, even if it isn't the <em>actual</em> remainder of the time you originally look at.</p>\n\n<p>Edit: This method should be faster than using a modulus.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 2570001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xuZTD.jpg?s=128&g=1", "display_name": "Berkyjay", "link": "https://stackoverflow.com/users/2570001/berkyjay"}, "edited": false, "score": 0, "creation_date": 1528313479, "post_id": 50727438, "comment_id": 88464356, "body": "I like this solution as well.  Thanks!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 14, "last_activity_date": 1567525281, "last_edit_date": 1567525281, "creation_date": 1528310592, "answer_id": 50727438, "question_id": 50727304, "link": "https://stackoverflow.com/questions/50727304/convert-milliseconds-to-hoursminutessecondsmilliseconds-in-c/50727438#50727438", "title": "Convert milliseconds to hours:minutes:seconds:milliseconds in C++", "body": "<pre><code>std::string format_duration( std::chrono::milliseconds ms ) {\n    using namespace std::chrono;\n    auto secs = duration_cast&lt;seconds&gt;(ms);\n    ms -= duration_cast&lt;milliseconds&gt;(secs);\n    auto mins = duration_cast&lt;minutes&gt;(secs);\n    secs -= duration_cast&lt;seconds&gt;(mins);\n    auto hour = duration_cast&lt;hours&gt;(mins);\n    mins -= duration_cast&lt;minutes&gt;(hour);\n\n    std::stringstream ss;\n    ss &lt;&lt; hour.count() &lt;&lt; \" Hours : \" &lt;&lt; mins.count() &lt;&lt; \" Minutes : \" &lt;&lt; secs.count() &lt;&lt; \" Seconds : \" &lt;&lt; ms.count() &lt;&lt; \" Milliseconds\";\n    return ss.str();\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/5bbcee9e001d2413\" rel=\"noreferrer\">live example</a>.</p>\n\n<p>Extending this to days/years/etc should be easy (there isn't a predefined std::chrono duration type for days/years/etc prior to <a href=\"/questions/tagged/c%2b%2b20\" class=\"post-tag\" title=\"show questions tagged &#39;c++20&#39;\" rel=\"tag\">c++20</a> however).</p>\n\n<p>But I can do better.</p>\n\n<pre><code>template&lt;class Duration&gt;\nstruct split_duration {\n  Duration d;\n  std::chrono::milliseconds leftover;\n\n  split_duration( std::chrono::milliseconds ms ):\n    d( std::chrono::duration_cast&lt;Duration&gt;(ms) ),\n    leftover( ms - std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(d) )\n  {}\n};\n\n\ntemplate&lt;class...Durations&gt;\nstd::tuple&lt;Durations...&gt; durations( std::chrono::milliseconds ms ) {\n  std::tuple&lt;std::optional&lt;split_duration&lt;Durations&gt;&gt;...&gt; tmp;\n  ( (void)(\n       (void)std::get&lt;std::optional&lt;split_duration&lt;Durations&gt;&gt;&gt;(tmp).emplace( ms ),\n       ms = std::get&lt;std::optional&lt;split_duration&lt;Durations&gt;&gt;&gt;(tmp)-&gt;leftover\n     ), ...\n  );\n  return std::make_tuple( std::get&lt;std::optional&lt;split_duration&lt;Durations&gt;&gt;&gt;( tmp )-&gt;d... );\n}\n\ntemplate&lt;class T&gt;\nstruct tag_t {};\ntemplate&lt;class T&gt;\nconstexpr tag_t&lt;T&gt; tag = {};\n\ninline std::string duration_name( tag_t&lt;std::chrono::milliseconds&gt; ) { return \"ms\"; }\ninline std::string duration_name( tag_t&lt;std::chrono::seconds&gt; ) { return \"Seconds\"; }\ninline std::string duration_name( tag_t&lt;std::chrono::minutes&gt; ) { return \"Minutes\"; }\ninline std::string duration_name( tag_t&lt;std::chrono::hours&gt; ) { return \"Hours\"; }\n// inline std::string duration_name( tag_t&lt;std::chrono::days&gt; ) { return \"Days\"; }\n// inline std::string duration_name( tag_t&lt;std::chrono::years&gt; ) { return \"Years\"; }\n\ntemplate&lt;class...Durations&gt;\nstd::string format_duration( std::chrono::milliseconds ms ) {\n    auto split = durations&lt;Durations...&gt;(ms);\n\n    std::stringstream ss;\n\n    (\n        (void)( ss &lt;&lt; duration_name(tag&lt;Durations&gt;) &lt;&lt; \": \" &lt;&lt; std::get&lt;Durations&gt;(split).count() &lt;&lt; \" \" ), ...\n    );\n\n    return ss.str();\n}\n</code></pre>\n\n<p>Days/Years requires <a href=\"/questions/tagged/c%2b%2b20\" class=\"post-tag\" title=\"show questions tagged &#39;c++20&#39;\" rel=\"tag\">c++20</a>, everything else is <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a>.</p>\n\n<p>You just call <code>format_durations&lt;Durations...&gt;( some_ms )</code> and out comes a formatted string based off the <code>Durations...</code>.  You do have to do it from most-to-least significant.</p>\n\n<p><code>durations&lt;Durations...&gt;</code> gives you a tuple breakdown of the time that has to be most-to-least; you could then reorder that before formatting if you chose.</p>\n\n<p>Duplicate duration types leads to compile time errors, as <code>std::get</code> dies a  horrible ambiguous death.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/f6dee14028115149\" rel=\"noreferrer\">Live example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 90, "user_id": 9469058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jsqsh", "link": "https://stackoverflow.com/users/9469058/jsqsh"}, "is_accepted": true, "score": 4, "last_activity_date": 1528311296, "creation_date": 1528311296, "answer_id": 50727647, "question_id": 50727304, "link": "https://stackoverflow.com/questions/50727304/convert-milliseconds-to-hoursminutessecondsmilliseconds-in-c/50727647#50727647", "title": "Convert milliseconds to hours:minutes:seconds:milliseconds in C++", "body": "<p>Maybe you're looking for something like this:\n</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n//Value chosen to be 1 hour, 1 minute, 1 second, and 1 millisecond\nlong milli = 3661001;\n//3600000 milliseconds in an hour\nlong hr = milli / 3600000;\nmilli = milli - 3600000 * hr;\n//60000 milliseconds in a minute\nlong min = milli / 60000;\nmilli = milli - 60000 * min;\n\n//1000 milliseconds in a second\nlong sec = milli / 1000;\nmilli = milli - 1000 * sec;\n\n\ncout &lt;&lt; hr &lt;&lt; \" hours and \" &lt;&lt; min &lt;&lt; \" minutes and \" &lt;&lt; sec &lt;&lt; \" seconds and \" &lt;&lt; milli &lt;&lt; \" milliseconds.\" &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 4, "last_activity_date": 1528312102, "creation_date": 1528312102, "answer_id": 50727882, "question_id": 50727304, "link": "https://stackoverflow.com/questions/50727304/convert-milliseconds-to-hoursminutessecondsmilliseconds-in-c/50727882#50727882", "title": "Convert milliseconds to hours:minutes:seconds:milliseconds in C++", "body": "<pre><code>int milliseconds = ...;\n\nint seconds = milliseconds / 1000;\nmilliseconds %= 1000;\n\nint minutes = seconds / 60;\nseconds %= 60;\n\nint hours = minutes / 60;\nminutes %= 60;\n\ncout &lt;&lt; hours &lt;&lt; \" Hours : \" &lt;&lt; minutes &lt;&lt; \" Minutes : \" &lt;&lt; seconds &lt;&lt; \" Seconds : \" &lt;&lt; milliseconds &lt;&lt; \" Milliseconds\" &lt;&lt; endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 4818535, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YCLF2vuFmXs/AAAAAAAAAAI/AAAAAAAAAEo/od_EhlJLCZ8/photo.jpg?sz=128", "display_name": "Ilya Khudyakov", "link": "https://stackoverflow.com/users/4818535/ilya-khudyakov"}, "is_accepted": false, "score": -1, "last_activity_date": 1584891962, "creation_date": 1584891962, "answer_id": 60801407, "question_id": 50727304, "link": "https://stackoverflow.com/questions/50727304/convert-milliseconds-to-hoursminutessecondsmilliseconds-in-c/60801407#60801407", "title": "Convert milliseconds to hours:minutes:seconds:milliseconds in C++", "body": "<p>Two types of output</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n//Value chosen to be 1 hour, 1 minute, 1 second, and 1 millisecond\nlong milli = 3661001;\n\n// hours\nint hr = (milli / (1000 * 60 * 60)) % 24;\n\n// minutes\nint min = (milli / (1000 * 60)) % 60;\n\n// seconds\nint sec = (milli / 1000) % 60;\n\n// milliseconds\nint mill = milli % 1000;\n\nchar msg[10];\n        sprintf(\n                msg,\n                \"%02d hours and %02d minutes and %02d seconds and %02d milliseconds.\\n\",\n                hr,\n                min,\n                sec,\n                mill\n                );\nprintf(msg);\n\ncout &lt;&lt; hr &lt;&lt; \" hours and \" &lt;&lt; min &lt;&lt; \" minutes and \" &lt;&lt; sec &lt;&lt; \" seconds and \" &lt;&lt; mill &lt;&lt; \" milliseconds.\" &lt;&lt; endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 2570001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xuZTD.jpg?s=128&g=1", "display_name": "Berkyjay", "link": "https://stackoverflow.com/users/2570001/berkyjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14431, "favorite_count": 0, "accepted_answer_id": 50727647, "answer_count": 5, "score": 3, "last_activity_date": 1584891962, "creation_date": 1528310038, "last_edit_date": 1528313330, "question_id": 50727304, "link": "https://stackoverflow.com/questions/50727304/convert-milliseconds-to-hoursminutessecondsmilliseconds-in-c", "title": "Convert milliseconds to hours:minutes:seconds:milliseconds in C++", "body": "<p>I'm looking for a way to print out milliseconds in this format using C++:</p>\n\n<pre><code>cout &lt;&lt; hours &lt;&lt; \" Hours : \" &lt;&lt; minutes &lt;&lt; \" Minutes : \" &lt;&lt; seconds &lt;&lt; \" Seconds : \" &lt;&lt; milliseconds &lt;&lt; \" Milliseconds\" &lt;&lt; endl;\n</code></pre>\n\n<p>I know there are a ton of duplicate questions about this.  But none of them really handle how to get the remainder in milliseconds.  There are a few that do this using Java, but I want a solution in C++.</p>\n\n<p>Edit:</p>\n\n<p>I wanted to clarify the question.  I'm looking to take a time value that I get for the time it takes a program to run and print out that time in a legible format for the user.  Getting the standard hr:min:sec was straight forward.  But including any remaining milliseconds was tripping me up.</p>\n"}, {"tags": ["c++", "compilation", "clion", "soil"], "owner": {"reputation": 423, "user_id": 9746273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9hgs.png?s=128&g=1", "display_name": "L. Kue", "link": "https://stackoverflow.com/users/9746273/l-kue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1528309837, "creation_date": 1528309837, "question_id": 50727242, "link": "https://stackoverflow.com/questions/50727242/compiling-soil-with-clion", "title": "Compiling SOIL with Clion", "body": "<p>I've tried to use SOIL on one of my projects, but it needs to be compiled first, because it is not a header-only library. Unfortunately, attempting such with Clion only delivers lots of compiler errors, as the project wasn't made with CMake. I've tried compiling versions of SOIL that were \"tailored for CMake\" like this one: <a href=\"https://github.com/paralin/soil\" rel=\"nofollow noreferrer\">https://github.com/paralin/soil</a> without success.</p>\n\n<p>Simply using the lib file along with the sources that were provided by SOIL without further compilation results in linker errors in my main project similar to these:\n<a href=\"https://stackoverflow.com/questions/50068522/linking-soil-mingw-undef-ref\">linking soil, mingw, undef ref</a></p>\n\n<p><code>undefined reference to 'glGetString@4'</code></p>\n\n<p>But the provided solution of including <code>-lsoil</code> in the linker options did not work for me.</p>\n\n<p>How do I properly include SOIL in my project or properly compile it, assuming I made no mistakes in including it?</p>\n"}, {"tags": ["c++", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 1, "creation_date": 1528336587, "post_id": 50727167, "comment_id": 88471741, "body": "Getting <i>only</i> O(n^2) here would be pretty good: brute force is O(n 2^n), from the number of <a href=\"https://en.m.wikipedia.org/wiki/Composition_(combinatorics)\" rel=\"nofollow noreferrer\">compositions</a> of <i>n</i>."}, {"owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "edited": false, "score": 0, "creation_date": 1528340638, "post_id": 50727167, "comment_id": 88472549, "body": "Your time complexity is not O(n^2), sadly"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1528355701, "post_id": 50727167, "comment_id": 88477850, "body": "are all the parts of the array with the same length or the length is arbitrary ?"}, {"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1528363269, "post_id": 50727167, "comment_id": 88482507, "body": "@Spektre Length is arbitrary."}, {"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "reply_to_user": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "edited": false, "score": 0, "creation_date": 1528364329, "post_id": 50727167, "comment_id": 88483275, "body": "@PhamTrung I&#39;ve had a few mistakes in my code (used 0 instead of first and such) which increased complexity exponentially, after fixing the mistakes I tried my algorithm for input 1 10000 followed by 10000 numbers -1 since then the array is split in 10000 parts with length 1,  it entered the recursion 19999 times and counting the number of total iterations it was near 150000 seems pretty solid. Though I think my algorithm doesn&#39;t work for every output"}, {"owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "edited": false, "score": 0, "creation_date": 1528365984, "post_id": 50727167, "comment_id": 88484481, "body": "Ahh, I saw your approach is greedy, greedily split the array by choosing the largest part. Maybe using interval tree could help to find the largest part faster, which reduces your program to O(nlogn), however I am not sure about the correctness still."}, {"owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "edited": false, "score": 0, "creation_date": 1528376185, "post_id": 50727167, "comment_id": 88491022, "body": "I believe your solution works for every conf. Try to imagine what would happen if you split one of the final <i>parts</i>. That would reduce sum."}, {"owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "edited": false, "score": 0, "creation_date": 1528376222, "post_id": 50727167, "comment_id": 88491055, "body": "As a small optimization, you can skip over negatives."}, {"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "reply_to_user": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "edited": false, "score": 1, "creation_date": 1528382137, "post_id": 50727167, "comment_id": 88495542, "body": "@Yola I&#39;ve just found a counterexample if I take 1 2 -6 2 1 my algorithm chooses the whole array which gives 0*6 = 0 while the optimum is [1,2],[-6],[2,1] = (1+2)*2+(-6)+(2+1)*2=6. Back to the drawing board I guess :P"}, {"owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "edited": false, "score": 1, "creation_date": 1528387207, "post_id": 50727167, "comment_id": 88498929, "body": "Thanks for the update. I tried dynamic programming approach, but it needs to much memory and failed time constraints."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1528457384, "post_id": 50727167, "comment_id": 88526647, "body": "I added some code to my answer. Could you possibly try it in SPOJ? (Maybe convert to c++? ...I have very little practice reading and writing to std-io :)"}, {"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "reply_to_user": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1528460683, "post_id": 50727167, "comment_id": 88528556, "body": "@\u05d2\u05dc\u05e2\u05d3\u05d1\u05e8\u05e7\u05df Javascript std-io seems scary so I converted it to C++, I&#39;ve put it on ideone <a href=\"https://ideone.com/4fkSse\" rel=\"nofollow noreferrer\">here</a> tried it on SPOJ it exceeds the time limit (can&#39;t link directly to submission so here&#39;s the link of my latest <a href=\"http://www.spoj.com/status/kingw3/\" rel=\"nofollow noreferrer\">submissions</a> ). I&#39;ll try looking for optimizations to your code later (perhaps it&#39;s on the edge of time limit) as I&#39;m mega tried atm."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1528461224, "post_id": 50727167, "comment_id": 88528894, "body": "oh, wow, thanks! I&#39;ll think about it some more  :)"}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1528473330, "post_id": 50727167, "comment_id": 88536267, "body": "Are you getting any feedback about the correctness of the results of \u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df&#39;s method, or just that the time limit was exceeded ?"}, {"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "reply_to_user": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1528478051, "post_id": 50727167, "comment_id": 88538587, "body": "@m69 No, just that the program took to long to execute (SPOJ is pretty terrible at feedback) it could be for any reason including bugs in program i.e infinite loops or waiting for input (which most likely isn&#39;t the case here)."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1528720702, "post_id": 50727167, "comment_id": 88601717, "body": "I added more info at the end of my anewer about the blog I found with the crux of the optimisation."}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "reply_to_user": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1528736054, "post_id": 50727167, "comment_id": 88611247, "body": "@\u05d2\u05dc\u05e2\u05d3\u05d1\u05e8\u05e7\u05df tried the compacting non negative numbers mentioned at the end and still tle &gt;.&lt;"}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "edited": false, "score": 0, "creation_date": 1528816553, "post_id": 50751974, "comment_id": 88646381, "body": "Thanks for the link it&#39;s extremely helpful, I&#39;ll try implementing my own solution if I succeed I&#39;ll post the answer here."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "reply_to_user": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "edited": false, "score": 0, "creation_date": 1528821158, "post_id": 50751974, "comment_id": 88648890, "body": "@kingW3 yea, it&#39;s fascinating how the computational geometry relates to these number queries. I&#39;m trying to visualize it myself. (By the way, in case you&#39;re having difficulty, notice that user dacin21 posted the full code in that blog :)"}], "tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": true, "score": 3, "last_activity_date": 1528718906, "last_edit_date": 1528718906, "creation_date": 1528419504, "answer_id": 50751974, "question_id": 50727167, "link": "https://stackoverflow.com/questions/50727167/divide-array-into-smaller-consecutive-parts-such-that-neo-value-is-maximal/50751974#50751974", "title": "Divide array into smaller consecutive parts such that NEO value is maximal", "body": "<p>This is not a complete solution but should provide some helpful direction.</p>\n\n<ol>\n<li><p>Combining two groups that each have a positive sum (or one of the sums is non-negative) would always yield a bigger NEO than leaving them separate:</p>\n\n<p><code>m * a + n * b &lt; (m + n) * (a + b) where a, b &gt; 0 (or a &gt; 0, b &gt;= 0); m and n are subarray lengths</code></p></li>\n<li><p>Combining a group with a negative sum with an entire group of non-negative numbers always yields a greater NEO than combining it with only part of the non-negative group. But excluding the group with the negative sum could yield an even greater NEO:</p>\n\n<p><code>[1, 1, 1, 1] [-2] =&gt; m * a + 1 * (-b)</code> </p>\n\n<p>Now, imagine we gradually move the dividing line to the left, increasing the sum b is combined with. While the expression on the right is negative, the NEO for the left group keeps decreasing. But if the expression on the right gets positive, relying on our first assertion (see 1.), combining the two groups would always be greater than not.</p></li>\n<li><p>Combining negative numbers alone in sequence will always yield a smaller NEO than leaving them separate:</p>\n\n<p><code>-a - b - c ... = -1 * (a + b + c ...)</code></p>\n\n<p><code>l * (-a - b - c ...) = -l * (a + b + c ...)</code></p>\n\n<p><code>-l * (a + b + c ...) &lt; -1 * (a + b + c ...) where l &gt; 1; a, b, c ... &gt; 0</code></p></li>\n</ol>\n\n<p><br>\n<code>O(n^2)</code> time, <code>O(n)</code> space JavaScript code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function f(A){\r\n  A.unshift(0);\r\n\r\n  let negatives = [];\r\n  let prefixes = new Array(A.length).fill(0);\r\n  let m = new Array(A.length).fill(0);\r\n\r\n  for (let i=1; i&lt;A.length; i++){\r\n    if (A[i] &lt; 0)\r\n      negatives.push(i);\r\n\r\n    prefixes[i] = A[i] + prefixes[i - 1];\r\n    m[i] = i * (A[i] + prefixes[i - 1]);\r\n\r\n    for (let j=negatives.length-1; j&gt;=0; j--){\r\n      let negative = prefixes[negatives[j]] - prefixes[negatives[j] - 1];\r\n      let prefix = (i - negatives[j]) * (prefixes[i] - prefixes[negatives[j]]);\r\n\r\n      m[i] = Math.max(m[i], prefix + negative + m[negatives[j] - 1]);\r\n    }\r\n  }\r\n\r\n  return m[m.length - 1];\r\n}\r\n\r\nconsole.log(f([1, 2, -5, 2, 1, 3, -4, 1, 2]));\r\nconsole.log(f([1, 2, -4, 1]));\r\nconsole.log(f([2, 3, -2, 1]));\r\nconsole.log(f([-2, -3, -2, -1]));</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<h3>Update</h3>\n\n<p><a href=\"https://codeforces.com/blog/entry/59694?locale=en\" rel=\"nofollow noreferrer\">This blog</a> provides that we can transform the dp queries from</p>\n\n<pre><code>dp_i\u2009=\u2009sum_i*i\u2009+\u2009max(for j\u2009&lt;\u2009i) of ((dp_j\u2009+\u2009sum_j*j)\u2009+\u2009(-j*sum_i)\u2009+\u2009(-i*sumj))\n</code></pre>\n\n<p>to</p>\n\n<pre><code>dp_i = sum_i*i + max(for j &lt; i) of (dp_j + sum_j*j, -j, -sum_j) \u22c5 (1, sum_i, i)\n</code></pre>\n\n<p>which means we could then look at each iteration for an already seen vector that would generate the largest dot product with our current information. The math alluded to involves convex hull and farthest point query, which are beyond my reach to implement at this point but will make a study of.</p>\n"}], "owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 4, "accepted_answer_id": 50751974, "answer_count": 1, "score": 7, "last_activity_date": 1528718906, "creation_date": 1528309525, "last_edit_date": 1528382304, "question_id": 50727167, "link": "https://stackoverflow.com/questions/50727167/divide-array-into-smaller-consecutive-parts-such-that-neo-value-is-maximal", "title": "Divide array into smaller consecutive parts such that NEO value is maximal", "body": "<p>On this years <a href=\"http://www.bubblecup.org/\" rel=\"nofollow noreferrer\">Bubble Cup</a> (finished) there was the problem <a href=\"http://www.spoj.com/problems/NEO2/\" rel=\"nofollow noreferrer\">NEO</a> (which I couldn't solve), which asks </p>\n\n<p>Given array with n integer elements. We divide it into several part (may be 1), each part is a consecutive of elements. The NEO value in that case is computed by: Sum of value of each part. Value of a part is sum all elements in this part multiple by its length.</p>\n\n<p>Example: We have array: [ 2 3 -2 1 ]. If we divide it like: [2 3] [-2 1]. Then NEO = (2 + 3) * 2 + (-2 + 1) * 2 = 10 - 2 = 8.</p>\n\n<p>The number of elements in array is smaller then <code>10^5</code> and the numbers are integers between <code>-10^6</code> and <code>10^6</code></p>\n\n<p>I've tried something like divide and conquer to constantly split array into two parts if it increases the maximal NEO number otherwise return the NEO of the whole array. But unfortunately the algorithm has worst case O(N^2) complexity (my implementation is below) so I'm wondering whether there is a better solution </p>\n\n<p>EDIT: My algorithm (greedy) doesn't work, taking for example <code>[1,2,-6,2,1]</code> my algorithm returns the whole array while to get the maximal NEO value is to take parts <code>[1,2],[-6],[2,1]</code> which gives NEO value of <code>(1+2)*2+(-6)+(1+2)*2=6</code> </p>\n\n<pre><code>#include &lt;iostream&gt;\nint maxInterval(long long int suma[],int first,int N)\n{\n    long long int max = -1000000000000000000LL; \n    long long int curr;\n    if(first==N) return 0;\n    int k;\n    for(int i=first;i&lt;N;i++)\n    {\n        if(first&gt;0) curr = (suma[i]-suma[first-1])*(i-first+1)+(suma[N-1]-suma[i])*(N-1-i); // Split the array into elements from [first..i] and [i+1..N-1] store the corresponding NEO value\n        else curr = suma[i]*(i-first+1)+(suma[N-1]-suma[i])*(N-1-i); // Same excpet that here first = 0 so suma[first-1] doesn't exist\n        if(curr &gt; max) max = curr,k=i; // find the maximal NEO value for splitting into two parts\n    }\n    if(k==N-1) return max; // If the max when we take the whole array then return the NEO value of the whole array\n    else\n    {\n        return maxInterval(suma,first,k+1)+maxInterval(suma,k+1,N); // Split the 2 parts further if needed and return it's sum\n    }\n}\nint main() {\n    int T;\n    std::cin &gt;&gt; T;\n    for(int j=0;j&lt;T;j++) // Iterate over all the test cases\n    {\n        int N;\n        long long int NEO[100010]; // Values, could be long int but just to be safe\n        long long int suma[100010]; // sum[i] = sum of NEO values from NEO[0] to NEO[i]\n        long long int sum=0;\n        int k;\n        std::cin &gt;&gt; N;\n        for(int i=0;i&lt;N;i++)\n        {\n            std::cin &gt;&gt; NEO[i];\n            sum+=NEO[i];\n            suma[i] = sum;\n        }\n        std::cout &lt;&lt; maxInterval(suma,0,N) &lt;&lt; std::endl;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "matlab", "printing", "output", "mex"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528373071, "post_id": 50726945, "comment_id": 88488871, "body": "The solution is to not use that function. When you call <code>printf</code>, it is automatically converted to a call to <code>mexPrintf</code>. That is the right way to print to the MATLAB command window. <a href=\"https://www.mathworks.com/help/matlab/apiref/mexprintf.html\" rel=\"nofollow noreferrer\">mathworks.com/help/matlab/apiref/mexprintf.html</a>"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528373369, "post_id": 50726945, "comment_id": 88489098, "body": "If you use <code>std::cout</code> see here: <a href=\"https://stackoverflow.com/a/41276477/7328782\">stackoverflow.com/a/41276477/7328782</a> \u2014 not sure if this affects <code>vprintf</code> too."}, {"owner": {"reputation": 805, "user_id": 1476932, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7ef5bed732b83efa1451e4c5888217eb?s=128&d=identicon&r=PG", "display_name": "ttsesm", "link": "https://stackoverflow.com/users/1476932/ttsesm"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528375317, "post_id": 50726945, "comment_id": 88490400, "body": "I know that <code>mexPrintf</code> is the suggested way to use in Matlab, but as I am saying I need to call this <code>PrintInfo()</code> function. Thus, I was wandering if possible to make <code>vprintf()</code> and its calling function work. I am not sure that I understand the issue with the <code>cout</code>, as you can see in my example I am able to use <code>cout</code> without problems."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528378383, "post_id": 50726945, "comment_id": 88492776, "body": "<code>cout</code> works for you? What OS? It doesn\u2019t on Mac. At least not with R2016a. Maybe newer MATLAB\u2019s automatically redirect it? That would make sense. It\u2019s easy enough. <code>vprintf</code> writes to file handle 1, which is not attached to anything. Either don\u2019t use that function, or rewrite it. There is no other solution. Sorry."}, {"owner": {"reputation": 805, "user_id": 1476932, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7ef5bed732b83efa1451e4c5888217eb?s=128&d=identicon&r=PG", "display_name": "ttsesm", "link": "https://stackoverflow.com/users/1476932/ttsesm"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528378901, "post_id": 50726945, "comment_id": 88493096, "body": "yes <code>cout</code> works here, with Microsoft Visual C++ 2015 compiler and matlab 2017b. So what you are suggesting is to create my own <code>vprintf.cpp</code> that calls mexprintf instead and use that? But how this will tell to <code>PrintInfo()</code> to use my <code>vprintf()</code> instead of the one that is linking where the <code>PrintInfo()</code> is defined in the third party library?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528380332, "post_id": 50726945, "comment_id": 88494145, "body": "No, I\u2019m telling you that there is no way of doing this, other than changing the 3rd party library or not using that function."}, {"owner": {"reputation": 805, "user_id": 1476932, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7ef5bed732b83efa1451e4c5888217eb?s=128&d=identicon&r=PG", "display_name": "ttsesm", "link": "https://stackoverflow.com/users/1476932/ttsesm"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1528389035, "post_id": 50726945, "comment_id": 88499888, "body": "I see :-(. Thanks for the help though."}], "owner": {"reputation": 805, "user_id": 1476932, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7ef5bed732b83efa1451e4c5888217eb?s=128&d=identicon&r=PG", "display_name": "ttsesm", "link": "https://stackoverflow.com/users/1476932/ttsesm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528358956, "creation_date": 1528308618, "last_edit_date": 1528358956, "question_id": 50726945, "link": "https://stackoverflow.com/questions/50726945/mex-script-and-how-to-show-output-from-another-function-which-is-using-vprintf", "title": "mex script and how to show output from another function which is using vprintf()", "body": "<p>I am implementing a mex script, where at some point I need to call a function from an external library. This function is as simple as printing the provided input, which is though collected as arguments and passed to <code>vprintf()</code>. See below:</p>\n\n<pre><code>void PrintInfo(const char *format, ...)\n{\n        va_list args;\n        va_start(args, format);\n        vprintf(format, args);\n        va_end(args);\n}\n</code></pre>\n\n<p>The issue now is that once I call the <code>PrintInfo()</code> function inside my mex script for example:</p>\n\n<pre><code>PrintInfo(\"Give me %i apples.\\n\", 3);\n</code></pre>\n\n<p>I am not able to get any output in the matlab's console prompt, like I do when I used <code>printf()</code> or <code>cout</code> instead. I was trying to figure it out myself but no chance so far, thus I would appreciate if someone could explain me what is the issue and how I can bypass it.</p>\n\n<p>Altering the library's files is not possible, thus I am looking for a solution that can be done on mex script from my side.</p>\n\n<hr>\n\n<p>Update: For example in the following mex script from the printing functions only the <code>PrintInfo()</code> does not show anything:</p>\n\n<pre><code>#include \"mex.h\"\n\n// cpp system headers\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;cstdio&gt;\n#include &lt;cstdarg&gt;\n\nusing namespace std;\n\nvoid PrintInfo(const char *format, ...)\n  {\n          va_list args;\n          va_start(args, format);\n          vprintf(format, args);\n          va_end(args);\n  }\n\n  void foo()\n  {\n      printf(\"Vector size is: %i \\n\", 5);\n  }\n\n  void foo1(const char *format, int sz)\n  {\n      printf(format, sz);\n  }\n\n  void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[]) {\n      PrintInfo(\"Vector size is: \\n\", 10);\n      foo();\n      foo1(\"Vector size is: %i \\n\", 2);\n      cout &lt;&lt; \"Vector size is:\" &lt;&lt; 4 &lt;&lt; endl;\n  }\n</code></pre>\n"}, {"tags": ["c++", "templates", "c++17", "chess", "micro-optimization"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528308459, "post_id": 50726812, "comment_id": 88461944, "body": "<i>&quot;Is there a way of optimising this function without manually unrolling all of my loops?&quot;</i> Modern compilers are very good at determining when to unroll a loop and at unroll them when it&#39;s appropriate."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1528308518, "post_id": 50726812, "comment_id": 88461974, "body": "If a constant <code>type</code> argument is given, it&#39;s extremely likely that the call will be inlined and optimized out."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1528308565, "post_id": 50726812, "comment_id": 88462003, "body": "Honestly, this looks pretty much optimal. You can always fiddle with the code to see if it has any effect, but I doubt that you&#39;ll get significantly faster than what you have here."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528308568, "post_id": 50726812, "comment_id": 88462006, "body": "It seems like you are looking for <a href=\"https://en.cppreference.com/w/cpp/language/template_specialization\" rel=\"nofollow noreferrer\"><code>full explicit template specialization</code></a> which lets you provide distinct implementations for specific sets of template arguments."}, {"owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "edited": false, "score": 1, "creation_date": 1528308631, "post_id": 50726812, "comment_id": 88462038, "body": "I&#39;m not completely sure; profiling seems to suggest that huge amount of CPU time is spent inside that find_moves function, even though it just delegates to another function or performs an array lookup"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1528308695, "post_id": 50726812, "comment_id": 88462064, "body": "@konsolas If this is the primary function you are calling in a loop, then yes, a huge amount of time is spent inside this function. Profilers usually give the amount of time spent in a function, <i>including the time spent in functions that it calls</i>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528308766, "post_id": 50726812, "comment_id": 88462103, "body": "@konsolas That would be surprising. What optimization flags are you using? What compiler and what version of it are you uisng?"}, {"owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "edited": false, "score": 1, "creation_date": 1528308799, "post_id": 50726812, "comment_id": 88462116, "body": "I&#39;m using mingw-w64, gcc 8.1.0, flags <code>&quot;-march=native -Ofast -g -static -std=c++17 -pedantic&quot;</code>"}, {"owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "edited": false, "score": 0, "creation_date": 1528308849, "post_id": 50726812, "comment_id": 88462151, "body": "Some time is spent in the functions called by <code>find_moves</code>, but the time spent in <code>find_moves</code> itself is much higher than the combined time of the callees. I&#39;m not entirely sure if i can embed images here."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528308893, "post_id": 50726812, "comment_id": 88462172, "body": "Is <code>type</code> dynamically provided? If so, a <code>template</code> based solution can&#39;t help you."}, {"owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "edited": false, "score": 0, "creation_date": 1528309039, "post_id": 50726812, "comment_id": 88462242, "body": "I&#39;ve given an example of an use case of find_moves. The function called is always the same on the same iteration of the loop"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1528309156, "post_id": 50726812, "comment_id": 88462301, "body": "@konsolas Chandler Carruths talk <a href=\"https://youtu.be/2EWejmkKlxs\" rel=\"nofollow noreferrer\">&quot;Going Nowhere Faster&quot;</a> could help you find what&#39;s happening. There might be a bunch of cache misses or a bunch of branch prediction fails or something like that. Also, you might find <a href=\"https://www.youtube.com/watch?v=rX0ItVEVjHc\" rel=\"nofollow noreferrer\">Mike Acton&#39;s talk on Data Oriented Design</a> helpful."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1528309352, "post_id": 50726812, "comment_id": 88462397, "body": "@konsolas With your given example, I&#39;d consider trying making it into a tight loop that just calls <code>find_moves</code> and stores the result for reference later. It takes more memory, but it could potentially help avoid cache misses and branch mispredictions."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528325179, "post_id": 50726812, "comment_id": 88468982, "body": "@Fran&#231;oisAndrieux: Modern compilers aren&#39;t that good.  gcc doesn&#39;t enable <code>-funroll-loops</code> by default.  You need to compile with profile-guided optimization (<code>-fprofile-use</code>) so it knows which loops are actually hot for it to ever unroll loops (except for fully unrolling small loops with a small constant iteration count).  PGO may help a lot."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1528325444, "post_id": 50726812, "comment_id": 88469059, "body": "@konsolas: Do you have this function in a header where it can inline and optimize away a compile-time constant <code>type</code> arg, for cases where it is constant?  Or link-time optimization should solve the same problem.  Your loop looks like it will be prone to branch mispredicts.  Profile your code with performance counters to see if the time is spent on branch misses, cache misses, or what."}, {"owner": {"reputation": 485, "user_id": 4079970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ff70aa7cfec663212ade95168e3732?s=128&d=identicon&r=PG", "display_name": "Stefan Atev", "link": "https://stackoverflow.com/users/4079970/stefan-atev"}, "edited": false, "score": 0, "creation_date": 1528374869, "post_id": 50726812, "comment_id": 88490095, "body": "Maybe I&#39;m missing something - the body of the example loop you have can become the body of a function where piece is a template argument; then you need to call the function 6 times; if you consider that unrolling, then I guess you&#39;re stuck with the unrolling unless you got to great lengths with boost::fusion or something like that."}, {"owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "edited": false, "score": 0, "creation_date": 1528375450, "post_id": 50726812, "comment_id": 88490479, "body": "I have the function in a .cpp file with a prototype in a header used by other source files. I haven&#39;t tried profile-guided optimization yet, but I will do so. Will the fact that the function is not in the header significantly limit optimisation?"}, {"owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "reply_to_user": {"reputation": 485, "user_id": 4079970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ff70aa7cfec663212ade95168e3732?s=128&d=identicon&r=PG", "display_name": "Stefan Atev", "link": "https://stackoverflow.com/users/4079970/stefan-atev"}, "edited": false, "score": 0, "creation_date": 1528375620, "post_id": 50726812, "comment_id": 88490612, "body": "@StefanAtev that seems to be a good compromise, I&#39;ll try it."}], "answers": [{"comments": [{"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1528581304, "post_id": 50727993, "comment_id": 88564583, "body": "you are a template specialist. (+1) :)"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1528312558, "creation_date": 1528312558, "answer_id": 50727993, "question_id": 50726812, "link": "https://stackoverflow.com/questions/50726812/optimising-without-templates/50727993#50727993", "title": "Optimising without templates", "body": "<p>Given that the values of your <code>Piece</code> enum are from 1 to 6, you can use templates, <code>std::make_index_sequence</code>, <code>std::index_sequence</code> to unroll.</p>\n\n<p>Sorry but I can only prepare a minimal example (no <code>move</code>, no <code>board</code>, etc).</p>\n\n<p>If you call something as</p>\n\n<pre><code>foo(std::make_index_sequence&lt;6U&gt;{});\n</code></pre>\n\n<p>in <code>foo()</code> you can call another function with singles values (you tagged C++17 so you can use template folding)</p>\n\n<pre><code>template &lt;std::size_t ... Ps&gt;\nvoid foo (std::index_sequence&lt;Ps...&gt; const &amp;)\n { (bar&lt;Ps&gt;(), ...); }\n</code></pre>\n\n<p>My idea is that in <code>bar()</code> you can place the content of the body of the <code>for (uint8_t piece = 1; piece &lt; 6; piece++)</code> loop of your example; I place only the call to a trivial (no other arguments) <code>find_moves()</code> function.</p>\n\n<pre><code>template &lt;std::size_t Ps&gt;\nvoid bar ()\n { find_moves&lt;pieces(1+Ps)&gt;(); }\n</code></pre>\n\n<p>Now you can develop six <code>find_moves()</code> template function using full specialization (I write only <code>std::cout</code> messages; you, using other arguments, can place the content of the <code>case</code>s in your <code>switch</code>.</p>\n\n<pre><code>template &lt;pieces P&gt;\nvoid find_moves ();\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Pawn&gt; ()\n { std::cout &lt;&lt; \"Case Pawn\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Knight&gt; ()\n { std::cout &lt;&lt; \"Case Knight\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Bishop&gt; ()\n { std::cout &lt;&lt; \"Case Bishop\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Rook&gt; ()\n { std::cout &lt;&lt; \"Case Rook\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Queen&gt; ()\n { std::cout &lt;&lt; \"Case Queen\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;King&gt; ()\n { std::cout &lt;&lt; \"Case King\" &lt;&lt; std::endl; }\n</code></pre>\n\n<p>The following is a full compiling example</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;utility&gt;\n#include &lt;type_traits&gt;\n\nenum pieces { Pawn = 1, Knight, Bishop, Rook, Queen, King };\n\ntemplate &lt;pieces P&gt;\nvoid find_moves ();\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Pawn&gt; ()\n { std::cout &lt;&lt; \"Case Pawn\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Knight&gt; ()\n { std::cout &lt;&lt; \"Case Knight\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Bishop&gt; ()\n { std::cout &lt;&lt; \"Case Bishop\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Rook&gt; ()\n { std::cout &lt;&lt; \"Case Rook\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;Queen&gt; ()\n { std::cout &lt;&lt; \"Case Queen\" &lt;&lt; std::endl; }\n\ntemplate &lt;&gt;\nvoid find_moves&lt;King&gt; ()\n { std::cout &lt;&lt; \"Case King\" &lt;&lt; std::endl; }\n\ntemplate &lt;std::size_t Ps&gt;\nvoid bar ()\n { find_moves&lt;pieces(1+Ps)&gt;(); }\n\ntemplate &lt;std::size_t ... Ps&gt;\nvoid foo (std::index_sequence&lt;Ps...&gt; const &amp;)\n { (bar&lt;Ps&gt;(), ...); }\n\nint main ()\n {\n   foo(std::make_index_sequence&lt;6U&gt;{});\n }\n</code></pre>\n"}], "owner": {"reputation": 736, "user_id": 5441932, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4acbacc09001d66b0fd772f7d3426617?s=128&d=identicon&r=PG", "display_name": "konsolas", "link": "https://stackoverflow.com/users/5441932/konsolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1528312743, "creation_date": 1528308165, "last_edit_date": 1528312743, "question_id": 50726812, "link": "https://stackoverflow.com/questions/50726812/optimising-without-templates", "title": "Optimising without templates", "body": "<p>I'm writing a chess engine, and I have a function that looks like this:</p>\n\n<pre><code>U64 find_moves(Piece type, Team side, uint8_t square, U64 occupied) {\n    switch (type) {\n        case PAWN: {\n            U64 result = 0;\n            result |= occupied &amp; bb_normal_moves::pawn_caps[side][square];\n            if (!(occupied &amp; bb_normal_moves::pawn_moves_x1[side][square])) {\n                result |= bb_normal_moves::pawn_moves_x1[side][square];\n                if (!(occupied &amp; bb_normal_moves::pawn_moves_x2[side][square])) {\n                    result |= bb_normal_moves::pawn_moves_x2[side][square];\n                }\n            }\n            return result;\n        }\n        case KNIGHT:\n            return bb_normal_moves::knight_moves[square];\n        case BISHOP:\n            return bb_magics::bishop_moves(square, occupied);\n        case ROOK:\n            return bb_magics::rook_moves(square, occupied);\n        case QUEEN:\n            return bb_magics::bishop_moves(square, occupied) | bb_magics::rook_moves(square, occupied);\n        case KING:\n            return bb_normal_moves::king_moves[square];\n    }\n\n    return 0; // Can't happen\n}\n</code></pre>\n\n<p>It essentially delegates to another function call depending on the <code>type</code> parameter. In many places around the program, this function is called after looping through different <code>Piece</code> values, which happens to be an <code>enum</code>.</p>\n\n<p>Unfortunately, that means that this function is called each time in that loop, so a lot of CPU time is wasted in this function branching.</p>\n\n<p>What I'd like to do is change this function to allow the compiler to optimise the calls:</p>\n\n<pre><code>template &lt;Piece type&gt; U64 find_moves(Team side, uint8_t square, U64 occupied)\n</code></pre>\n\n<p>but then my loops would not compile as the target of the function call cannot be resolved at compile time.</p>\n\n<p>Is there a way of optimising this function without manually unrolling all of my loops?</p>\n\n<p>EDIT: Here is an example of one of the loops that calls <code>find_moves</code>:</p>\n\n<pre><code>for (uint8_t piece = 1; piece &lt; 6; piece++) {\n    move.info.piece = piece;\n    U64 bb_piece = board.bb_pieces[team][piece];\n\n    while (bb_piece) {\n        uint8_t from = pop_bit(team, bb_piece);\n        move.info.from = from;\n\n        U64 bb_targets = find_moves((Piece) piece, team, from, board.bb_all) &amp; mask;\n\n        while (bb_targets) {\n            uint8_t to = pop_bit(x_team, bb_targets);\n            move.info.to = to;\n\n            buf[buf_size++] = move;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors", "clion", "undeclared-identifier"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1528308066, "post_id": 50726754, "comment_id": 88461758, "body": "Does <code>SomeClass.h</code> include <code>Anotherclass.h</code> or include other headers that include it?"}, {"owner": {"reputation": 818, "user_id": 6854564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3e863e9aa31107cc90b44d0047cc312?s=128&d=identicon&r=PG&f=1", "display_name": "Kubuntuer82", "link": "https://stackoverflow.com/users/6854564/kubuntuer82"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528308224, "post_id": 50726754, "comment_id": 88461831, "body": "You mean there might be a cyclic inclusion?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1528308303, "post_id": 50726754, "comment_id": 88461869, "body": "Yes, that&#39;s the most common cause of this type of problem. If this is the case, see <a href=\"https://stackoverflow.com/questions/625799/resolve-build-errors-due-to-circular-dependency-amongst-classes\" title=\"resolve build errors due to circular dependency amongst classes\">stackoverflow.com/questions/625799/&hellip;</a>."}, {"owner": {"reputation": 818, "user_id": 6854564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3e863e9aa31107cc90b44d0047cc312?s=128&d=identicon&r=PG&f=1", "display_name": "Kubuntuer82", "link": "https://stackoverflow.com/users/6854564/kubuntuer82"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528308942, "post_id": 50726754, "comment_id": 88462198, "body": "Many thanks for this! It was difficult to see it because there was a chain of headers which at the end formed a loop (I could not write everything here because I needed to simplify the problem). But thanks to your suggestion I checked deeply and finally it&#39;s fixed..."}, {"owner": {"reputation": 818, "user_id": 6854564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3e863e9aa31107cc90b44d0047cc312?s=128&d=identicon&r=PG&f=1", "display_name": "Kubuntuer82", "link": "https://stackoverflow.com/users/6854564/kubuntuer82"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528309032, "post_id": 50726754, "comment_id": 88462238, "body": "Are you sure this is a duplicate? The difference here is that an IDE (in this case CLion) was capable of navigating to the class, which created the confusion. I am just curious, if you think it is a duplicate it&#39;s fine for me."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1528309264, "post_id": 50726754, "comment_id": 88462352, "body": "An IDE will be able to resolve types some of time despite the circular inclusion, depending on how it parses the headers. I understood the question as asking how to fix your problem, and the fact that CLion was able to determine the type being interesting but unimportant context information. If what you are actually asking about is how CLion manages to resolve your types, then it&#39;s not a duplicate and I&#39;ll retract the close."}, {"owner": {"reputation": 818, "user_id": 6854564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3e863e9aa31107cc90b44d0047cc312?s=128&d=identicon&r=PG&f=1", "display_name": "Kubuntuer82", "link": "https://stackoverflow.com/users/6854564/kubuntuer82"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528309549, "post_id": 50726754, "comment_id": 88462498, "body": "You understood correctly, the main purpose was to fix the problem, but I also was curious of why CLion was not detecting any error, but you already gave a good explanation in your last comment, which may even be considered as a general answer to my curiosity (about behaviour of IDEs in general). Thanks again..."}], "owner": {"reputation": 818, "user_id": 6854564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3e863e9aa31107cc90b44d0047cc312?s=128&d=identicon&r=PG&f=1", "display_name": "Kubuntuer82", "link": "https://stackoverflow.com/users/6854564/kubuntuer82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1528308963, "answer_count": 0, "score": 0, "last_activity_date": 1528307933, "creation_date": 1528307933, "last_edit_date": 1592644375, "question_id": 50726754, "link": "https://stackoverflow.com/questions/50726754/class-was-not-declared-but-clion-sees-it", "closed_reason": "Duplicate", "title": "&quot;[class] was not declared&quot; but CLion sees it", "body": "<p>I have a header file, let's call it <code>SomeClass.h</code> in which a class is defined as usual:</p>\n<pre><code>class SomeClass {\n...\n};\n</code></pre>\n<p>The implementation of <code>SomeClass</code> is in another file, say <code>SomeClass.cpp</code>.</p>\n<p>Then I have another header file, say <code>AnotherClass.h</code> which tries to use the <code>SomeClass</code> class to define another class, as shown below.</p>\n<pre><code>#include &lt;SomeClass.h&gt;\n\nclass AnotherClass {\n...\nprotected:\n  std::unique_ptr&lt;SomeClass&gt; s;  // (*)\n};\n</code></pre>\n<p>when I try to compile, I get the following error:</p>\n<pre><code>error: 'SomeClass' was not declared in this scope\n</code></pre>\n<p>but this is quite surprising, since CLion is not detecting this error and when I click on <code>SomeClass</code> in the instruction commented with <code>// (*)</code> above, CLion correctly goes to the definition of <code>SomeClass</code> in <code>SomeClass.h</code></p>\n<h3>So the question is:</h3>\n<p>why is CLion seeing <code>SomeClass</code> while the compiler is not seeing it?</p>\n"}, {"tags": ["c++", "reference"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1528307156, "post_id": 50726511, "comment_id": 88461266, "body": "Just use <code>map&lt;int,int&gt; myMap;</code>"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1528307255, "post_id": 50726511, "comment_id": 88461323, "body": "Can you explain why you want to do something like: <code>map&lt;int,int&gt;&amp; myMap = new map&lt;int,int&gt;();</code>; it&#39;s strange and feels like an XY-Problem?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528307883, "post_id": 50726511, "comment_id": 88461667, "body": "@RichardCritten looks like OP has Java background and tries to fix compilation error for <code>map&lt;int,int&gt;&amp; myMap;</code>"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528308132, "post_id": 50726511, "comment_id": 88461790, "body": "@Slava I agree, but without clarification from the OP all I could do would be to recommend the book list: <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/388242/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1528307795, "post_id": 50726585, "comment_id": 88461626, "body": "I do not think OP needs dynamically allocated memory at all, I bet it came to fix compilation error for <code>map&lt;int,int&gt;&amp; myMap;</code>"}, {"owner": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 0, "creation_date": 1528308088, "post_id": 50726585, "comment_id": 88461768, "body": "Yeah i want to keep that reference because im passing it to a recursive function. I can delete it after im done with it. Thanks"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 2, "creation_date": 1528308187, "post_id": 50726585, "comment_id": 88461814, "body": "@Fancypants753, that is not sufficient reason to use dynamically allocated object. You can pass an object created on the stack to the recursive function."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1528308221, "post_id": 50726585, "comment_id": 88461830, "body": "And I would retain from recommending such code <code>map&lt;int,int&gt;&amp; myMap = *new map&lt;int,int&gt;();</code> to novice programmer. Later somebody would notice this ugliness and &quot;fix&quot; it with automatic object possibly leaving <code>delete &amp;myMap;</code> in the code. Data types should be maintained properly."}, {"owner": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 0, "creation_date": 1528308495, "post_id": 50726585, "comment_id": 88461960, "body": "@RSahu but if I just use pass by value, won&#39;t a copy of the value be created during every recursive call? and couldn&#39;t that be fixed by just passing a reference? And yes I come from a java heavy background and am trying to come into c++"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 2, "creation_date": 1528308581, "post_id": 50726585, "comment_id": 88462013, "body": "@Fancypants753, don&#39;t pass by value. Pass by reference."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 8, "last_activity_date": 1528309137, "last_edit_date": 1528309137, "creation_date": 1528307321, "answer_id": 50726585, "question_id": 50726511, "link": "https://stackoverflow.com/questions/50726511/c-references-to-heap-objects/50726585#50726585", "title": "c++ references to heap objects?", "body": "<p>You can use</p>\n\n<pre><code>map&lt;int,int&gt;&amp; myMap = *new map&lt;int,int&gt;();\n</code></pre>\n\n<p>but I don't recommend it.</p>\n\n<p>The dynamically allocated memory has to be deallocated. At that time, you will need to use something along the lines of </p>\n\n<pre><code>delete &amp;myMap;\n</code></pre>\n\n<p>That is poor quality code, IMO.</p>\n\n<p>Use a smart pointer <strong>if</strong> you need dynamically allocated memory.</p>\n\n<pre><code>std::shared_ptr&lt;map&lt;int,int&gt;&gt; ptr = new map&lt;int,int&gt;();\n</code></pre>\n\n<p>If you need to use a reference, you can use:</p>\n\n<pre><code>map&lt;int,int&gt;&amp; myMap = *ptr;\n</code></pre>\n\n<p>It will better if you can avoid dynamically allocated object altogether and use an automatic object (object in stack memory).</p>\n\n<pre><code>map&lt;int,int&gt; myMap;\n</code></pre>\n\n<hr>\n\n<h3>Update, in response to OP's comment</h3>\n\n<p>In a comment you said</p>\n\n<blockquote>\n  <p>Yeah i want to keep that reference because im passing it to a recursive function</p>\n</blockquote>\n\n<p>The C++ way to deal with it is to pass an object by reference.</p>\n\n<pre><code>void recursive_foo(std::map&lt;int, int&gt;&amp; myMap)\n{\n}\n\nvoid foo_user()\n{\n   std::map&lt;int, int&gt; myMap;\n   // Fill up myMap\n   // ...\n\n   recursive_foo(myMap);\n}\n</code></pre>\n\n<p>If the recursive function does not modify the object, you can follow the idiom used by the standard library and use iterators instead.</p>\n\n<pre><code>void recursive_foo(std::map&lt;int, int&gt;::iterator start,\n                   std::map&lt;int, int&gt;::iterator end)\n{\n}\n\nvoid foo_user()\n{\n   std::map&lt;int, int&gt; myMap;\n   // Fill up myMap\n   // ...\n\n   recursive_foo(myMap.begin(), myMap.end());\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 0, "creation_date": 1528308605, "post_id": 50726596, "comment_id": 88462023, "body": "so when you create a heap object, does it not give you the value automatically?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 1, "creation_date": 1528309009, "post_id": 50726596, "comment_id": 88462230, "body": "@Fancypants753 <code>new</code> returns pointer to object. This pointer can be later dereferenced to be used as &quot;real&quot; object. Instead you can create real object directly but it will live only to the end of scope. Dynamically allocated objects have overhead, but programmer controllable lifetime. Read a textbook C++ is not Java."}, {"owner": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "edited": false, "score": 0, "creation_date": 1528309095, "post_id": 50726596, "comment_id": 88462275, "body": "thanks that really helps. In java I never had to worry about stuff like that but c++ is pretty popular nowadays so I wanted to learn."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1528309499, "last_edit_date": 1528309499, "creation_date": 1528307351, "answer_id": 50726596, "question_id": 50726511, "link": "https://stackoverflow.com/questions/50726511/c-references-to-heap-objects/50726596#50726596", "title": "c++ references to heap objects?", "body": "<blockquote>\n  <p>I thought that objects could passed to references without dereferencing first (as opposed to pointers)?</p>\n</blockquote>\n\n<p>Yes objects can be passed, but what you have here:</p>\n\n<pre><code>map&lt;int,int&gt;&amp; myMap = new map&lt;int,int&gt;();\n</code></pre>\n\n<p>is not an object but reference which you try to initialize by pointer to dynamically allocated object. Just create object:</p>\n\n<pre><code>map&lt;int,int&gt; myMap;\n</code></pre>\n\n<p>and it should work fine.</p>\n\n<p>To make things clear, you mixed different concepts, lets say we have a function that accepts variable of <code>sometype</code> by reference:</p>\n\n<pre><code>void func( sometype &amp;ref ) { ... }\n</code></pre>\n\n<p>it does not mean you have to declare variable as reference to pass it there, you can pass automatic object:</p>\n\n<pre><code> sometype auto_object;\n func( auto_object );\n</code></pre>\n\n<p>or pass dynamically allocated one:</p>\n\n<pre><code> sometype *ptr_to_object = new sometype;\n func( *ptr_to_object );\n delete ptr_to_object; // or better use smart pointer\n</code></pre>\n\n<p>and if you do not need this object to outlive scope where you use it it is preferable to use first variant.</p>\n"}], "owner": {"reputation": 309, "user_id": 8501925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6a86669427713b0387eca1a0b327abf?s=128&d=identicon&r=PG&f=1", "display_name": "Fancypants753", "link": "https://stackoverflow.com/users/8501925/fancypants753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1790, "favorite_count": 1, "accepted_answer_id": 50726585, "answer_count": 2, "score": 1, "last_activity_date": 1528309499, "creation_date": 1528307094, "question_id": 50726511, "link": "https://stackoverflow.com/questions/50726511/c-references-to-heap-objects", "title": "c++ references to heap objects?", "body": "<p>I have the below bit of code:</p>\n\n<pre><code>map&lt;int,int&gt;&amp; myMap = new map&lt;int,int&gt;();\n</code></pre>\n\n<p>but I get the following compiler error:</p>\n\n<pre><code>no suitable constructor exists to convert from \"std::map&lt;int,int, std::less&lt;int&gt;, std::allocator&lt;std::pair&lt;const int, int&gt;&gt;&gt;*\" to \"std::map&lt;int,int, std::less&lt;int&gt;, std::allocator&lt;std::pair&lt;const int, int&gt;&gt;&gt;\".\n</code></pre>\n\n<p>Does this mean I have to do:</p>\n\n<pre><code>map&lt;int,int&gt;&amp; myMap = *new map&lt;int,int&gt;();\n</code></pre>\n\n<p>I thought that objects could passed to references without dereferencing first (as opposed to pointers)? Also I know smart pointers exist but I'm not trying to use those for now.</p>\n"}, {"tags": ["c++", "struct", "header-files"], "comments": [{"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1528306911, "post_id": 50726449, "comment_id": 88461144, "body": "Before you import that header, obviously."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528313486, "post_id": 50726449, "comment_id": 88464362, "body": "... by saying <code>#define V1</code> or <code>#define V3</code> as appropriate."}], "answers": [{"tags": [], "owner": {"reputation": 295, "user_id": 9911093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f993fb65fe7902f2f75f9f420b705b3b?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9911093/j-doe"}, "is_accepted": true, "score": 1, "last_activity_date": 1528429540, "creation_date": 1528429540, "answer_id": 50753055, "question_id": 50726449, "link": "https://stackoverflow.com/questions/50726449/initialize-a-typedef-struct-variable-in-cpp/50753055#50753055", "title": "initialize a typedef struct variable in CPP", "body": "<p>To define a macro in the <a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"nofollow noreferrer\">C preprocessor</a>, use the syntax <code>#define MACRO VALUE</code>, or, for an empty flag macro, just <code>#define MACRO</code>. So, in your case, your code should like like:</p>\n\n<pre><code>#define V3 // or V1\n#include &lt;thirdpartylib&gt;\n</code></pre>\n"}], "owner": {"reputation": 302, "user_id": 2172637, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/970bc66640e98a3ef5654b9ffa36a045?s=128&d=identicon&r=PG&f=1", "display_name": "0x52616A657368", "link": "https://stackoverflow.com/users/2172637/0x52616a657368"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 50753055, "answer_count": 1, "score": -2, "last_activity_date": 1528429540, "creation_date": 1528306828, "question_id": 50726449, "link": "https://stackoverflow.com/questions/50726449/initialize-a-typedef-struct-variable-in-cpp", "title": "initialize a typedef struct variable in CPP", "body": "<p>I'm trying to access a 3rd party library in which one of the header contains a struct as follows</p>\n\n<pre><code>#if defined(V1) || defined(V3)\ntypedef struct\n{\n   int8         ErrorCode;\n   boolean      isValid;\n} validation, *validation_p;\n#endif // #ifdef V1/V3\n</code></pre>\n\n<p>So if i would like to access validation/validation_p how can I access within my cpp, It's very clear that we need to define V1/V3 but where and how do I define those??</p>\n\n<p>Sorry for the basic question on CPP</p>\n"}, {"tags": ["android", "c++", "visual-studio", "gradle"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528307062, "post_id": 50726359, "comment_id": 88461220, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36667374/how-to-enable-c11-for-android-studio\">How to enable C++11 for Android Studio?</a>"}, {"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1528337465, "post_id": 50726359, "comment_id": 88471946, "body": "I have several projects that compile on XCode, Android Studio and Visual Studio.  <a href=\"https://stackoverflow.com/questions/44294140/how-i-can-add-a-cflag-in-cmake-android-studio/44295150#44295150\">This is how I setup Gradle/CMake to compile on Android.</a>  If you are just starting out, make sure to use CMake projects and not Android.mk.  They are musch, much faster"}], "owner": {"reputation": 462, "user_id": 5438234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f2da95ecbe88be791adc2380c4e7c88?s=128&d=identicon&r=PG&f=1", "display_name": "Figwig", "link": "https://stackoverflow.com/users/5438234/figwig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528323256, "creation_date": 1528306515, "last_edit_date": 1528323256, "question_id": 50726359, "link": "https://stackoverflow.com/questions/50726359/using-gradle-to-compile-c-for-android-compiles-in-visual-studio-but-not-in-g", "title": "Using Gradle to compile c++ for android - compiles in Visual Studio but not in Gradle?", "body": "<p>I am trying to port my basic sdl game over onto android, but I've been stuck for a while now on using gradle. While I can compile an APK using a very basic main.cpp, as soon as I start coding as I normally would I get all sorts of errors that simply don't crop up in the visual studio compiler. For example, \"nullptr not defined in this scope\", for each causes not being acceptable, and lots of warnings saying bits of code are only available in -stdC++11. The error feed I could mostly rewrite my code around, but I'd much rather be able to have gradle compile using the same rules the VS compiler does... What am I doing wrong?\nThanks \nWill</p>\n\n<p>edit:\nprevious question is similar but I am not using android studio</p>\n"}, {"tags": ["c++", "c++11", "vector"], "comments": [{"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 1, "creation_date": 1528306473, "post_id": 50726294, "comment_id": 88460886, "body": "You&#39;re very close... Hint: <code>std::remove_if</code> returns a value. ;-]"}, {"owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "reply_to_user": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 0, "creation_date": 1528306934, "post_id": 50726294, "comment_id": 88461160, "body": "Ah, nailed it - but now I have a scary code. This is the best-optimized code one can write to the same with the std::vector ?"}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 3, "creation_date": 1528307142, "post_id": 50726294, "comment_id": 88461258, "body": "<code>auto it = std::remove_if(v.begin(), v.end(), ...); v.erase(it, v.end());</code> is pretty well idiomatic \u2013 it&#39;s hard to answer without knowing what you find scary about it."}, {"owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "reply_to_user": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 0, "creation_date": 1528307266, "post_id": 50726294, "comment_id": 88461327, "body": "Scary for my teammates - most only just started you know ..... :-)"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 1, "creation_date": 1528307394, "post_id": 50726294, "comment_id": 88461408, "body": "There&#39;s also <a href=\"http://en.cppreference.com/w/cpp/experimental/vector/erase_if\" rel=\"nofollow noreferrer\"><code>std::erase_if</code></a> if your compiler provides the library fundamentals TS implementation."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 2, "creation_date": 1528307399, "post_id": 50726294, "comment_id": 88461412, "body": "propose this code to them and take it as an opportunity to teach them about <code>remove_if</code> and whatever else they find confusing, this is very common."}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 1, "creation_date": 1528307442, "post_id": 50726294, "comment_id": 88461441, "body": "If your teammates are scared of this then <i>they</i> need to learn C++ better. This code is so common and well-known that it <a href=\"https://en.wikipedia.org/wiki/Erase%E2%80%93remove_idiom\" rel=\"nofollow noreferrer\">has its own named idiom</a>. ;-] FWIW, there&#39;s also <a href=\"http://en.cppreference.com/w/cpp/experimental/vector/erase_if\" rel=\"nofollow noreferrer\">a proposal</a> to supply a shorthand for this in the standard library."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1528307502, "post_id": 50726294, "comment_id": 88461470, "body": "You can probably just write <code>return animation-&gt;isActive();</code>."}, {"owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "edited": false, "score": 0, "creation_date": 1528307643, "post_id": 50726294, "comment_id": 88461547, "body": "I think I better teach them than changing the code. The code seems neat for me. Thanks for the assistance."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1528307655, "post_id": 50726294, "comment_id": 88461552, "body": "Please do not edit the question in a way that invalidates the comments and answers. It destroys important context for future readers. If you have further questions about the &quot;fixed&quot; code, either post another question or append the new code at the end of the question, noting that it&#39;s a new iteration."}, {"owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "edited": false, "score": 0, "creation_date": 1528307747, "post_id": 50726294, "comment_id": 88461597, "body": "Oh ok i am sorry, I will revert the change."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1528308259, "post_id": 50726294, "comment_id": 88461845, "body": "Note that if <code>activeAnimations</code> contains <i>owning pointers</i> you must remember to <code>delete</code> them yourself. If that&#39;s the case, consider using <code>std::vector&lt;std::unique_ptr&lt;AnimationState&gt;&gt;</code> or <code>std::vector&lt;AnimationState&gt;</code> instead."}, {"owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "edited": false, "score": 1, "creation_date": 1528308513, "post_id": 50726294, "comment_id": 88461970, "body": "Memory leaks - I nearly forgot it"}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 1, "creation_date": 1528309625, "post_id": 50726294, "comment_id": 88462539, "body": "It you are removing elements from the middle of an array very often, <code>std::vector</code> might not be the best STL container. Maybe a <code>std::list</code> would be better."}, {"owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "edited": false, "score": 0, "creation_date": 1528311570, "post_id": 50726294, "comment_id": 88463485, "body": "Mostly animations come to the vector after clearing the old animation states so vector suffix for now. I am considering list for the rendering engine. Thak you for your suggestions."}], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 4432988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhNKZ.jpg?s=128&g=1", "display_name": "Mikhail Vasilyev", "link": "https://stackoverflow.com/users/4432988/mikhail-vasilyev"}, "edited": false, "score": 2, "creation_date": 1528401368, "post_id": 50726457, "comment_id": 88506025, "body": "You are capturing everything by reference now while in fact you don&#39;t need to capture anything in the lambda. You should change <code>[&amp;]</code> to <code>[]</code>."}], "tags": [], "owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "is_accepted": false, "score": 1, "last_activity_date": 1528311751, "last_edit_date": 1528311751, "creation_date": 1528306867, "answer_id": 50726457, "question_id": 50726294, "link": "https://stackoverflow.com/questions/50726294/iterating-through-a-vector-and-deleting-contents/50726457#50726457", "title": "Iterating through a vector and deleting contents", "body": "<p>Removes and delete the element from the vector while iterating through it.  </p>\n\n<pre><code> void AnimationPack::removeDeadAnimations()\n    {\n        activeAnimations.erase(std::remove_if(activeAnimations.begin(), activeAnimations.end(),\n            [&amp;](AnimationState*&amp; animation) {\n            if (animation-&gt;isActive())\n                return false;\n            else\n            {\n                delete animation;\n                return true;\n            }\n        }), activeAnimations.end());\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "is_accepted": false, "score": 2, "last_activity_date": 1528308668, "last_edit_date": 1528308668, "creation_date": 1528308180, "answer_id": 50726817, "question_id": 50726294, "link": "https://stackoverflow.com/questions/50726294/iterating-through-a-vector-and-deleting-contents/50726817#50726817", "title": "Iterating through a vector and deleting contents", "body": "<p>Yes, it is called an <a href=\"https://en.wikipedia.org/wiki/Erase%E2%80%93remove_idiom\" rel=\"nofollow noreferrer\">erase-remove</a> idiom.</p>\n\n<p>Quote from Wikipedia:</p>\n\n<blockquote>\n  <p>The <em>erase\u2013remove idiom</em> is a common C++ technique to eliminate elements\n  that fulfill a certain criterion from a C++ Standard Library\n  container.</p>\n  \n  <p><code>erase</code> can be used to delete an element from a collection, but for\n  containers which are based on an array, such as vector, all elements\n  after the deleted element have to be moved forward, to avoid \"gaps\" in\n  the collection. </p>\n  \n  <p>The algorithm library provides the <code>remove</code> and <code>remove_if</code> algorithms\n  for this. </p>\n  \n  <p>These algorithms do not remove elements from the container, but move\n  all elements that don't fit the remove criteria to the front of the\n  range, keeping the relative order of the elements. This is done in a\n  single pass through the data range.</p>\n  \n  <p><code>remove</code> returns an iterator pointing to the first of these elements, so\n  they can be deleted using a single call to <code>erase</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 121, "user_id": 7057208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Htu0XvVZso/AAAAAAAAAAI/AAAAAAAAACM/JnfQtrR4GC4/photo.jpg?sz=128", "display_name": "Thinkal VB", "link": "https://stackoverflow.com/users/7057208/thinkal-vb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528311751, "creation_date": 1528306306, "last_edit_date": 1528308423, "question_id": 50726294, "link": "https://stackoverflow.com/questions/50726294/iterating-through-a-vector-and-deleting-contents", "title": "Iterating through a vector and deleting contents", "body": "<p>Is this a good or standard practice to code like this to loop through a vector while deleting unwanted elements from it without losing performance. If there is a faster way please suggest it.\nThis vector is of the form <code>std::vector&lt;AnimationState*&gt; activeAnimations;</code></p>\n\n<pre><code>void AnimationPack::removeDeadAnimations()\n{\n    int counter = 0;\n    std::remove_if(activeAnimations.begin(), activeAnimations.end(), \n        [&amp;](AnimationState*&amp; animation) {\n            if (animation-&gt;isActive())\n            {\n                counter++;\n                return true;\n            }\n            else\n                return false;\n        });\n    activeAnimations.erase(activeAnimations.end() - counter, activeAnimations.end());\n}\n</code></pre>\n\n<p>Edited version</p>\n\n<pre><code>void AnimationPack::removeDeadAnimations()\n{\n    activeAnimations.erase(std::remove_if(activeAnimations.begin(), activeAnimations.end(), \n        [&amp;](AnimationState*&amp; animation) {\n            if (animation-&gt;isActive())\n                return true;\n            else\n                return false;\n        }),activeAnimations.end());\n}\n</code></pre>\n\n<p>Edited Code (As suggested from comments)</p>\n\n<pre><code>void AnimationPack::removeDeadAnimations()\n{\n    activeAnimations.erase(std::remove_if(activeAnimations.begin(), activeAnimations.end(),\n        [](AnimationState*&amp; animation) { return animation-&gt;isActive(); }), activeAnimations.end());\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "qnetworkaccessmanager", "qnetworkreply"], "comments": [{"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 2, "creation_date": 1528315351, "post_id": 50726263, "comment_id": 88465264, "body": "Please shorten your question to specific problem. Which error signal is not working? what output you expect?"}, {"owner": {"reputation": 301, "user_id": 6671163, "user_type": "registered", "profile_image": "https://graph.facebook.com/686529364820372/picture?type=large", "display_name": "Kto  To", "link": "https://stackoverflow.com/users/6671163/kto-to"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1528322570, "post_id": 50726263, "comment_id": 88468214, "body": "I think must be <code>QNetworkReply::UnknownNetworkError</code> or <code>QNetworkReply::ProtocolFailure</code> for link <a href=\"ftp://cddis.gsfc.nasa.gov/pub/slr/data/npt_crd/gracea/2010/gracea_20100101.npt.Z\" rel=\"nofollow noreferrer\">cddis.gsfc.nasa.gov/pub/slr/data/npt_crd/gracea/2010/&hellip;</a>"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1528326086, "post_id": 50726263, "comment_id": 88469238, "body": "I get the following on onResult() <code>QNetworkReply::NetworkError(ContentNotFoundError)</code>"}], "owner": {"reputation": 301, "user_id": 6671163, "user_type": "registered", "profile_image": "https://graph.facebook.com/686529364820372/picture?type=large", "display_name": "Kto  To", "link": "https://stackoverflow.com/users/6671163/kto-to"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528306194, "creation_date": 1528306194, "question_id": 50726263, "link": "https://stackoverflow.com/questions/50726263/catching-an-incorrect-link-error-qnetworkaccessmanager", "title": "Catching an incorrect link error QNetworkAccessManager", "body": "<p>How to catch incorrect link errors? For example: </p>\n\n<blockquote>\n  <p><a href=\"ftp://cddis.gsfc.nasa.gov/pub/slr/data/npt_crd/gracea/2010/gracea_20100101.npt.Z\" rel=\"nofollow noreferrer\">ftp://cddis.gsfc.nasa.gov/pub/slr/data/npt_crd/gracea/2010/gracea_20100101.npt.Z</a>\n   -- this is incorrect link</p>\n</blockquote>\n\n<p>Why doesn't any error signal work? Or How to determine the correct links? Please, write an example of correct work with errors.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xZZp0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xZZp0.png\" alt=\"screen\"></a></p>\n\n<pre><code>#ifndef WIDGET_H\n#define WIDGET_H\n\n#include \"Downloader.h\"\n#include &lt;QWidget&gt;\n#include &lt;QNetworkReply&gt;\n\nnamespace Ui {\nclass Widget;\n}\n\nclass Widget : public QWidget\n{\n    Q_OBJECT\n\npublic:\n    explicit Widget(QWidget *parent = nullptr);\n    ~Widget();\n\nprivate slots:\n    void onDownloadButtonClicked();\n\n    void onSelectTargetFolderButtonClicked();\n\n    void onCancelButtonClicked();\n\n    void onUpdateProgress(qint64 bytesReceived, qint64 bytesTotal);\n    void onResult(QNetworkReply *reply);\nprivate:\n    Ui::Widget *ui;\n    Downloader m_downloader;\n};\n\n#endif // WIDGET_H\n</code></pre>\n\n<p><strong>Widget.cpp</strong></p>\n\n<pre><code>#include \"Widget.h\"\n#include \"ui_Widget.h\"\n\n#include &lt;QFileDialog&gt;\n#include &lt;QStandardPaths&gt;\nWidget::Widget(QWidget *parent) :\n    QWidget(parent),\n    ui(new Ui::Widget)\n{\n    ui-&gt;setupUi(this);\n    connect(ui-&gt;downloadPushButton, &amp;QPushButton::clicked, this, &amp;Widget::onDownloadButtonClicked);\n    connect(ui-&gt;selectTargetFolderPushButton, &amp;QPushButton::clicked, this, &amp;Widget::onSelectTargetFolderButtonClicked);\n    connect(ui-&gt;cancelPushButton, &amp;QPushButton::clicked, this, &amp;Widget::onCancelButtonClicked);\n    connect(&amp;m_downloader, &amp;Downloader::updateDownloadProgress, this, &amp;Widget::onUpdateProgress);\n    connect(&amp;m_downloader.manager, &amp;QNetworkAccessManager::finished, this, &amp;Widget::onResult);\n}\n\nWidget::~Widget()\n{\n    delete ui;\n}\n\nvoid Widget::onDownloadButtonClicked()\n{\n    m_downloader.get(ui-&gt;targetFolderLineEdit-&gt;text(), ui-&gt;urlLineEdit-&gt;text());\n}\n\nvoid Widget::onSelectTargetFolderButtonClicked()\n{\n    QString targetFolder = QFileDialog::getExistingDirectory(this,\n                tr(\"Select folder\"),\n                QStandardPaths::writableLocation(QStandardPaths::DownloadLocation),\n                QFileDialog::ShowDirsOnly | QFileDialog::DontResolveSymlinks);\n    ui-&gt;targetFolderLineEdit-&gt;setText(targetFolder);\n}\n\nvoid Widget::onCancelButtonClicked()\n{\n    m_downloader.cancelDownload();\n    ui-&gt;downloadProgressBar-&gt;setMaximum(100);\n    ui-&gt;downloadProgressBar-&gt;setValue(0);\n}\n\nvoid Widget::onUpdateProgress(qint64 bytesReceived, qint64 bytesTotal)\n{\n    ui-&gt;downloadProgressBar-&gt;setMaximum(bytesTotal);\n    ui-&gt;downloadProgressBar-&gt;setValue(bytesReceived);\n}\n\nvoid Widget::onResult(QNetworkReply *reply)\n{\n    if (reply-&gt;error()) {\n        qDebug() &lt;&lt; \"Error\";\n        qDebug() &lt;&lt; reply-&gt;error();\n    } else {\n        qDebug() &lt;&lt; \"Done\";\n    }\n}\n</code></pre>\n\n<p><strong>Downloader.h</strong></p>\n\n<pre><code>#ifndef DOWNLOADER_H\n#define DOWNLOADER_H\n\n#include &lt;QNetworkAccessManager&gt;\n#include &lt;QNetworkReply&gt;\n//class QNetworkReply;\nclass QFile;\n\nclass Downloader : public QObject\n{\n    Q_OBJECT\n    using BaseClass = QObject;\n\npublic:\n    explicit Downloader(QObject* parent = nullptr);\n\n    bool get(const QString&amp; targetFolder, const QUrl&amp; url);\n\n    QNetworkReply* currentReply {nullptr};\n    QNetworkAccessManager manager;\n    QString fullName;\npublic slots:\n    void cancelDownload();\n\nsignals:\n    void updateDownloadProgress(qint64 bytesReceived, qint64 bytesTotal);\n\nprivate slots:\n    void onReadyRead();\n    void onReply(QNetworkReply* reply);\n    void errorSlot(QNetworkReply::NetworkError er);\nprivate:\n    QFile* m_file                 {nullptr};\n};\n\n#endif // DOWNLOADER_H\n</code></pre>\n\n<p><strong>Downloader.cpp</strong></p>\n\n<pre><code>#include \"Downloader.h\"\n#include &lt;QNetworkReply&gt;\n#include &lt;QNetworkRequest&gt;\n#include &lt;QFile&gt;\n#include &lt;QDir&gt;\nDownloader::Downloader(QObject* parent) :\n    BaseClass(parent)\n{\n    connect(&amp;manager, &amp;QNetworkAccessManager::finished, this, &amp;Downloader::onReply);\n}\nbool Downloader::get(const QString&amp; targetFolder, const QUrl&amp; url)\n{\n    qDebug() &lt;&lt; \"get\";\n    if (targetFolder.isEmpty() || url.isEmpty())\n    {\n        return false;\n    }\n    fullName = targetFolder + QDir::separator() + url.fileName();\n    m_file = new QFile(fullName);\n    if (!m_file-&gt;open(QIODevice::WriteOnly))\n    {\n        delete m_file;\n        m_file = nullptr;\n        return false;\n    }\n    QNetworkRequest request(url);\n    request.setAttribute(QNetworkRequest::FollowRedirectsAttribute, true);\n    currentReply = manager.get(request);\n    connect(currentReply, QOverload&lt;QNetworkReply::NetworkError&gt;::of(&amp;QNetworkReply::error),\n                this, &amp;Downloader::errorSlot);\n    connect(currentReply, &amp;QNetworkReply::readyRead, this, &amp;Downloader::onReadyRead);\n    connect(currentReply, &amp;QNetworkReply::downloadProgress, this, &amp;Downloader::updateDownloadProgress);\n    return true;\n}\nvoid Downloader::onReadyRead()\n{\n    qDebug() &lt;&lt; \"onReadyRead\";\n    if (m_file)\n    {\n        m_file-&gt;write(currentReply-&gt;readAll());\n    }\n}\nvoid Downloader::cancelDownload()\n{\n    qDebug() &lt;&lt; \"cancelDownload\";\n    if (currentReply)\n    {\n        currentReply-&gt;abort();\n    }\n}\nvoid Downloader::onReply(QNetworkReply* reply)\n{\n    qDebug() &lt;&lt; \"onReply\";\n    if (reply-&gt;error() == QNetworkReply::NoError)\n    {\n        m_file-&gt;flush();\n        m_file-&gt;close();\n    }\n    else\n    {\n        m_file-&gt;remove();\n    }\n    delete m_file;\n    m_file = nullptr;\n    reply-&gt;deleteLater();\n}\nvoid Downloader::errorSlot(QNetworkReply::NetworkError er)\n{\n    qDebug() &lt;&lt; er;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "function-prototypes"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 4, "creation_date": 1528306054, "post_id": 50726174, "comment_id": 88460656, "body": "When the function is only to be used internally and is not part of the functionality exported/exposed by your header file."}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 1, "creation_date": 1528306093, "post_id": 50726174, "comment_id": 88460670, "body": "If your function is only used inside a single file, then it is perfectly valid to put it inside the cpp file itself. If your function is meant to be reused it&#39;s better to put it in header..."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1528306130, "post_id": 50726174, "comment_id": 88460699, "body": "Declare the internally used functions as static. Put the interface function declarations to header file."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1528306141, "post_id": 50726174, "comment_id": 88460707, "body": "Primarily opinion-based."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1528306157, "post_id": 50726174, "comment_id": 88460713, "body": "<i>Only</i> if the function is both defined and exclusively used in that file (in which case it might as well be explicitly declared <code>static</code>).  But an <code>extern</code> prototype in a <code>.c</code> file, for a function defined elsewhere, pretty much demolishes the whole point of prototypes.  (You weren&#39;t asking about <code>extern</code> prototypes, but I wanted to make this point.  See also <a href=\"https://stackoverflow.com/questions/50401100/compiler-warning-for-function-defined-without-prototype-in-scope\">this question</a>.)"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1528309411, "post_id": 50726174, "comment_id": 88462422, "body": "Opinion-based. I avoid prototypes for unexposed functions, preferring to implement the functions in an order where it is not necessary. I&#39;m lazy. I can&#39;t think of any good enough reasons to have to make two changes when I&#39;m forced to update the signature of a function that is only used internally."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1528314000, "post_id": 50726174, "comment_id": 88464595, "body": "@user4581301 Yeah, me too.  I bet I&#39;m even lazier than you."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1528306242, "creation_date": 1528306242, "answer_id": 50726276, "question_id": 50726174, "link": "https://stackoverflow.com/questions/50726174/when-to-not-put-c-function-prototypes-in-header-files/50726276#50726276", "title": "When to not put C function prototypes in header files", "body": "<blockquote>\n  <p>Is there a reason why it might not be good practice to place C/C++ function prototypes in header files but instead place them at the top of the main .c/.cpp file?</p>\n</blockquote>\n\n<p>The only time that makes sense to me is when the functions are implementation details of other functions. Of course, in that case, I prefer to define them in the file scope using file scoped functions using <code>static</code> qualifier or putting them in a namespace specific to the .cpp file.</p>\n\n<p>For all other functions, I find it hard to justify not putting the declaration in a header file and <code>#include</code>ing the header file in the files that use the functions and in the file that defines the functions.</p>\n"}], "owner": {"reputation": 31, "user_id": 9904700, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-u2sGwlksfvY/AAAAAAAAAAI/AAAAAAAABBA/lr3zdeZWNOQ/photo.jpg?sz=128", "display_name": "James Downer", "link": "https://stackoverflow.com/users/9904700/james-downer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528306242, "creation_date": 1528305881, "question_id": 50726174, "link": "https://stackoverflow.com/questions/50726174/when-to-not-put-c-function-prototypes-in-header-files", "title": "When to not put C function prototypes in header files", "body": "<p>Is there a reason why it might not be good practice to place C/C++ function prototypes in header files but instead place them at the top of the main .c/.cpp file?</p>\n\n<p>For example, I could write a dothis.c file:</p>\n\n<pre><code>#include \"funcs.h\"\n\nint main(int argc, char ** argv) {\n   // some code\n   int result = doThis();\n   // more code\n\n   return 0;\n}\n\nint doThis(void) {\n   // code and return value\n}\n</code></pre>\n\n<p>And in my funcs.h file, I'd write:</p>\n\n<pre><code>#ifndef FUNCS_H\n#define FUNCS_H\n\nint doThis(void);\n\n// more function prototypes\n\n#endif // FUNCS_H\n</code></pre>\n\n<p>Is there any reason why it might be better to place the prototype(s) (assuming there are many) at the top of the .c/.cpp file instead? For example:</p>\n\n<pre><code>#include \"funcs.h\"\n\nint doThis(void);\n\n// more function prototypes\n\nint main(int argc, char ** argv) {\n   // some code\n   int result = doThis();\n   // more code\n\n   return 0;\n}\n\nint doThis(void) {\n   // code and return value\n}\n</code></pre>\n\n<p>In the first case, I feel it would be helpful to have many function prototypes in a separate header file plus documentation to logically separate declaration from implementation and to make it easier to concisely see what the main file is doing.</p>\n"}, {"tags": ["c++", "iterator", "c++17", "const-iterator"], "answers": [{"tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 2, "last_activity_date": 1528306597, "creation_date": 1528306597, "answer_id": 50726388, "question_id": 50726153, "link": "https://stackoverflow.com/questions/50726153/insert-or-assign-is-allowing-iterator/50726388#50726388", "title": "insert_or_assign is allowing iterator", "body": "<p>All containers are required to provide an <code>iterator</code> type that is convertible to <code>const_iterator</code>. See the <a href=\"https://timsong-cpp.github.io/cppwp/n4659/container.requirements.general#tab:containers.container.requirements\" rel=\"nofollow noreferrer\"><em>Container requirements</em></a> table</p>\n\n<p><code>X\u200b::\u200biterator</code> is required to be <em>any iterator category that meets the forward iterator requirements. <strong>convertible to <code>X::const_iterator</code></strong>.</em></p>\n\n<p>So a <code>const_iterator</code> is being constructed from the <code>iterator</code> returned by <code>lower_bound</code> in the call to <code>insert_or_assign</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 2, "last_activity_date": 1528306639, "creation_date": 1528306639, "answer_id": 50726392, "question_id": 50726153, "link": "https://stackoverflow.com/questions/50726153/insert-or-assign-is-allowing-iterator/50726392#50726392", "title": "insert_or_assign is allowing iterator", "body": "<p>Your <code>lower_bound</code> call will give you a non-const iterator on non-const map. However, there is an automatic conversion from non-const iterator to const-iterator, so any function which requires const_iterator can be called with non-const iterator of the same type.</p>\n"}], "owner": {"reputation": 5009, "user_id": 1455108, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zaRtd.jpg?s=128&g=1", "display_name": "Jo&#227;o Paulo", "link": "https://stackoverflow.com/users/1455108/jo%c3%a3o-paulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 50726388, "answer_count": 2, "score": 1, "last_activity_date": 1528306639, "creation_date": 1528305813, "question_id": 50726153, "link": "https://stackoverflow.com/questions/50726153/insert-or-assign-is-allowing-iterator", "title": "insert_or_assign is allowing iterator", "body": "<p>I have this piece of code:</p>\n\n<pre><code>auto it = my_map.lower_bound(my_key);\n</code></pre>\n\n<p>The following assert gives me error:</p>\n\n<pre><code>static_assert(std::is_same&lt;decltype(it), std::map&lt;K, V&gt;::const_iterator&gt;::value, \"Error\");\n</code></pre>\n\n<p>And the following one, is ok:</p>\n\n<pre><code>static_assert(std::is_same&lt;decltype(it), std::map&lt;K, V&gt;::iterator&gt;::value, \"Error\");\n</code></pre>\n\n<p>Then, the compiler is not giving me a <code>const_iterator</code>. Ok. But here:</p>\n\n<pre><code>my_map.insert_or_assign(it, my_key, some_val);\n</code></pre>\n\n<p>even with <code>iterator</code> (not <code>const_iterator</code>), the function is working. But, in this <a href=\"https://en.cppreference.com/w/cpp/container/map/insert_or_assign\" rel=\"nofollow noreferrer\">link</a>, on <code>insert_or_assign</code> signatures, I only have <code>const_iterator</code> arguments. I also searched for the <code>.h</code> file on Visual Studio and this information matches. Tested on GCC 7.2+  and Visual Studio 2015, everything compiles and runs.</p>\n\n<p>Why does it compile? Why <code>insert_or_assign</code> accepts <code>iterator</code>?</p>\n"}, {"tags": ["c++", "constexpr"], "comments": [{"owner": {"reputation": 331, "user_id": 8231265, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/cr6PJ.jpg?s=128&g=1", "display_name": "Hello Everyone", "link": "https://stackoverflow.com/users/8231265/hello-everyone"}, "edited": false, "score": 0, "creation_date": 1528306331, "post_id": 50726085, "comment_id": 88460807, "body": "No, FOO is allocated only once in both cases.There is no reallocation in every included cpp as you say."}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 4154993, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Bv8Wx.jpg?s=128&g=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/4154993/valentin"}, "edited": false, "score": 0, "creation_date": 1528309742, "post_id": 50726805, "comment_id": 88462589, "body": "So what translation unit will it be defined in? The one randomly chosen by the compiler? This asymmetry bothers me... Or will it be outside of all translation units?"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "reply_to_user": {"reputation": 1040, "user_id": 4154993, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Bv8Wx.jpg?s=128&g=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/4154993/valentin"}, "edited": false, "score": 0, "creation_date": 1528310623, "post_id": 50726805, "comment_id": 88463037, "body": "@Valentin It will be defined in several translation units.  From my understanding the linker will assume all the definitions are identical and use one of them. Which one is not specified, you only have the guarantee that once linked it will refer to the same object."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528314118, "post_id": 50726805, "comment_id": 88464648, "body": "@super Correct.  Bad things can happen if you lie to the linker."}], "tags": [], "owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "is_accepted": true, "score": 1, "last_activity_date": 1528308148, "creation_date": 1528308148, "answer_id": 50726805, "question_id": 50726085, "link": "https://stackoverflow.com/questions/50726085/pros-and-cons-of-constexpr-class-members/50726805#50726805", "title": "Pros and cons of constexpr class members", "body": "<p>The first version is only possible since <code>c++17</code>. It works because all static member variables declared <code>constexpr</code> are implicitly <a href=\"https://en.cppreference.com/w/cpp/language/inline\" rel=\"nofollow noreferrer\">inline</a>.</p>\n\n<p>Multiple definitions are allowed (in separate compilation units) but when linked there will be only 1. So your assumption that it gets allocated once in every <code>.cpp</code> file is not correct.</p>\n\n<p>Which one is preferable could depend. I would choose the first option if I know I'm not gonna change it ever, or very seldom.</p>\n\n<p>If I need to change it, it could cause all <code>.cpp</code> files that <code>#include</code> it to have to recompile, and then it would be better to have it separated in a <code>.cpp</code> file.</p>\n"}], "owner": {"reputation": 1040, "user_id": 4154993, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Bv8Wx.jpg?s=128&g=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/4154993/valentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 1, "accepted_answer_id": 50726805, "answer_count": 1, "score": 3, "last_activity_date": 1528308148, "creation_date": 1528305580, "last_edit_date": 1528306050, "question_id": 50726085, "link": "https://stackoverflow.com/questions/50726085/pros-and-cons-of-constexpr-class-members", "title": "Pros and cons of constexpr class members", "body": "<p>Compare these two approaches:</p>\n\n<pre><code>// MyClass.hpp\nclass MyClass\n{\n  static constexpr char* const FOO = \"bar\";\n};\n</code></pre>\n\n<p>vs </p>\n\n<pre><code>// MyClass.hpp\nclass MyClass\n{\n  static const char* const FOO;\n};\n\n// MyClass.cpp\nconst char* const MyClass::FOO = \"bar\";\n</code></pre>\n\n<p>Which one is preferable? I'd imagine that in the second case the \"bar\" string only gets allocated once, while in the first case it gets allocated once per every .cpp that includes my header. Am I correct? Are there any other points to take into account?</p>\n"}, {"tags": ["c++", "c++11", "move-semantics", "rvalue-reference"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1528305434, "post_id": 50726022, "comment_id": 88460316, "body": "Read this <a href=\"http://thbecker.net/articles/rvalue_references/section_01.html\" rel=\"nofollow noreferrer\">thbecker.net/articles/rvalue_references/section_01.html</a>"}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 1, "creation_date": 1528305542, "post_id": 50726022, "comment_id": 88460378, "body": "moveing a fundamental type would yield a copy"}, {"owner": {"reputation": 128, "user_id": 4045265, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-OZYL7bbylfI/AAAAAAAAAAI/AAAAAAAAAyU/Ewk4LJ--o9o/photo.jpg?sz=128", "display_name": "arjun jawalkar", "link": "https://stackoverflow.com/users/4045265/arjun-jawalkar"}, "edited": false, "score": 0, "creation_date": 1528305694, "post_id": 50726022, "comment_id": 88460449, "body": "Can you suggest how my code to change to make output main:"}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 2, "creation_date": 1528305831, "post_id": 50726022, "comment_id": 88460526, "body": "there&#39;s no way to make <code>cout &lt;&lt; a</code> print nothing, move or no move"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 1, "creation_date": 1528312138, "post_id": 50726022, "comment_id": 88463731, "body": "A move constructor is supposed to leave a moved-from object in a <a href=\"https://stackoverflow.com/questions/12095048/what-constitutes-a-valid-state-for-a-moved-from-object-in-c11\">valid but unspecified state</a>.  What that is varies between types, but as a rule of thumb I just don&#39;t use a moved-from variable except to completely reassign it in some way (if at all), unless its move constructor gives me other guarantees (e.g. that of <code>std::vector</code>)."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530521311, "post_id": 50726022, "comment_id": 89248998, "body": "Hopefully, move semantic isn&#39;t an explicit destructor call. It doesn&#39;t undeclare an object, as there is no such thing as an undeclaration. It doesn&#39;t change the scope of a name or reduces the lifetime of an object."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 4045265, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-OZYL7bbylfI/AAAAAAAAAAI/AAAAAAAAAyU/Ewk4LJ--o9o/photo.jpg?sz=128", "display_name": "arjun jawalkar", "link": "https://stackoverflow.com/users/4045265/arjun-jawalkar"}, "edited": false, "score": 0, "creation_date": 1528308501, "post_id": 50726126, "comment_id": 88461963, "body": "IN the code snippet provided, if I try to access the values of vector a, what will the size of a be and what will the contents of a be?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 128, "user_id": 4045265, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-OZYL7bbylfI/AAAAAAAAAAI/AAAAAAAAAyU/Ewk4LJ--o9o/photo.jpg?sz=128", "display_name": "arjun jawalkar", "link": "https://stackoverflow.com/users/4045265/arjun-jawalkar"}, "edited": false, "score": 1, "creation_date": 1528308931, "post_id": 50726126, "comment_id": 88462192, "body": "See the documentation for the <code>std::vector</code> constructor. &quot;After the move, other is guaranteed to be empty().&quot; <a href=\"http://en.cppreference.com/w/cpp/container/vector/vector\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector/vector</a>"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 128, "user_id": 4045265, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-OZYL7bbylfI/AAAAAAAAAAI/AAAAAAAAAyU/Ewk4LJ--o9o/photo.jpg?sz=128", "display_name": "arjun jawalkar", "link": "https://stackoverflow.com/users/4045265/arjun-jawalkar"}, "edited": false, "score": 0, "creation_date": 1528314205, "post_id": 50726126, "comment_id": 88464686, "body": "@arjunjawalkar: I was unable to substantiate this claim using the C++ standard, there&#39;s a longer discussion here: <a href=\"https://stackoverflow.com/questions/17730689/is-a-moved-from-vector-always-empty\" title=\"is a moved from vector always empty\">stackoverflow.com/questions/17730689/&hellip;</a> In general, I would consider it a style error to use an object after moving from it, unless it is reinitialized somehow."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 4, "last_activity_date": 1528305726, "creation_date": 1528305726, "answer_id": 50726126, "question_id": 50726022, "link": "https://stackoverflow.com/questions/50726022/how-to-use-c11-stdmove-semantics-i-tried-writing-code-the-output-i-get-is/50726126#50726126", "title": "How to use C++11 std::move semantics. I tried writing code, the output I get is some thing different", "body": "<p>The <code>std::move</code> technically doesn't <em>move</em> anything, it just gives you an rvalue reference. The actual semantics of moving something only happen because this causes overload resolution to call different functions, so:</p>\n\n<pre><code>std::vector&lt;int&gt; a{1, 2, 3};\nstd::vector&lt;int&gt; b{std::move(a)};\n</code></pre>\n\n<p>This is equivalent to:</p>\n\n<pre><code>std::vector&lt;int&gt; a{1, 2, 3};\nstd::vector&lt;int&gt; b{static_cast&lt;std::vector&lt;int&gt;&amp;&amp;&gt;(a)};\n</code></pre>\n\n<p>Again, there's nothing special about the rvalue reference <code>&amp;&amp;</code> that makes it \"move\" things, all the move semantics are in the <code>std::vector</code> constructor. The <code>int</code> type doesn't have any special move semantics, so it doesn't do that.</p>\n\n<p>This makes sense. For a <code>std::vector</code>, moving the vector and zeroing the original is cheaper than a copy. For an <code>int</code>, zeroing the original is actually <em>more expensive</em> than just copying it--you have to copy the value anyway, so there is no point in doing extra work to throw away the original.</p>\n"}, {"tags": [], "owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "is_accepted": false, "score": 2, "last_activity_date": 1528313103, "last_edit_date": 1528313103, "creation_date": 1528312592, "answer_id": 50728002, "question_id": 50726022, "link": "https://stackoverflow.com/questions/50726022/how-to-use-c11-stdmove-semantics-i-tried-writing-code-the-output-i-get-is/50728002#50728002", "title": "How to use C++11 std::move semantics. I tried writing code, the output I get is some thing different", "body": "<blockquote>\n  <p>But shouldn't it be as below?</p>\n</blockquote>\n\n<p>No it should not.</p>\n\n<hr>\n\n<h3>Theory</h3>\n\n<p>1) <a href=\"https://en.cppreference.com/w/cpp/utility/move\" rel=\"nofollow noreferrer\"><code>std::move</code></a>:</p>\n\n<blockquote>\n  <p><code>std::move</code> produces an <em>xvalue</em> expression that identifies its argument\n  t. It is <strong>exactly equivalent to a static_cast to an rvalue reference</strong>\n  type.</p>\n</blockquote>\n\n<p>2) <a href=\"http://en.cppreference.com/w/cpp/language/reference\" rel=\"nofollow noreferrer\">Rvalue references</a>:</p>\n\n<blockquote>\n  <p>Rvalue references can be used to extend the lifetimes of temporary objects \n  (note, <strong><em>lvalue</em></strong> <strong>references to const can extend the lifetimes of\n  temporary objects too</strong>, but <strong>they are not modifiable</strong> through them):</p>\n</blockquote>\n\n<p><strong>Conclusion:</strong>\nsince <code>a</code> is not a temporary, your code is essentially <strong>equivalent to</strong> passing <code>a</code> as <strong>a reference</strong>.</p>\n\n<hr>\n\n<p><strong>Side note:</strong>\nin standard library</p>\n\n<blockquote>\n  <p>Unless otherwise specified, all standard library objects that have\n  been moved from are placed in a valid but unspecified state.</p>\n</blockquote>\n"}], "owner": {"reputation": 128, "user_id": 4045265, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-OZYL7bbylfI/AAAAAAAAAAI/AAAAAAAAAyU/Ewk4LJ--o9o/photo.jpg?sz=128", "display_name": "arjun jawalkar", "link": "https://stackoverflow.com/users/4045265/arjun-jawalkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530521174, "creation_date": 1528305314, "last_edit_date": 1530521174, "question_id": 50726022, "link": "https://stackoverflow.com/questions/50726022/how-to-use-c11-stdmove-semantics-i-tried-writing-code-the-output-i-get-is", "title": "How to use C++11 std::move semantics. I tried writing code, the output I get is some thing different", "body": "<pre><code>#include &lt;iostream&gt;\n#include&lt;vector&gt;\n\nusing namespace std;\nint function(int &amp;&amp;p)\n{\n    cout&lt;&lt;\"function:\"&lt;&lt;p&lt;&lt;endl;\n\n    return 0;\n}\nint main()\n{\n\n    int a =10;\n    function(std::move(a));\n    cout&lt;&lt;\"main:\"&lt;&lt;a&lt;&lt;endl;\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The output I get is as below.</p>\n\n<pre><code>function:10\nmain:10\n</code></pre>\n\n<p>But shouldn't it be as below?</p>\n\n<pre><code>function:10\nmain:\n</code></pre>\n"}, {"tags": ["c++", "qt", "tensorflow"], "comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1528305718, "post_id": 50725848, "comment_id": 88460462, "body": "This has way too little information to know what you&#39;re doing. Where do you want to see the output? I doubt that you need tensorflow etc. Minimize the code to 50 lines, to a single file. Yes, it can be done, and you should have done it first."}, {"owner": {"reputation": 1, "user_id": 9894252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f294d2c3b236d65c4086ed4daf6235df?s=128&d=identicon&r=PG&f=1", "display_name": "apoorva", "link": "https://stackoverflow.com/users/9894252/apoorva"}, "reply_to_user": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1528394398, "post_id": 50725848, "comment_id": 88502536, "body": "@kuba sorry for not being clear. <code>cout &lt;&lt; &quot;graph successfully imported.&quot;; cout &lt;&lt; &quot;Session successfully created.&quot;; cout &lt;&lt; &quot;graph successfully added to session.&quot;;</code> these are some lines I&#39;m trying to print. added <code>cout &lt;&lt; flush</code> before every cout statement. yet I&#39;m getting only first 2 outputs/lines as expected and rest are getting printed all at once in the end(after the execution is completed). to be more clear, Its printing &quot;graph imported and session created&quot; then nothing till the execution is done, in the end printing all the remaining output -&gt; &quot;graph added to session... etc .. etc&quot;."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1528720997, "post_id": 50725848, "comment_id": 88601914, "body": "You still need to minimize it etc. What you&#39;re &quot;clarifying&quot; in reply to my suggestion doesn&#39;t add any information. It doesn&#39;t quite matter what text you&#39;re trying to output. What matters is whatever else you&#39;re doing that makes it somehow not work. If I write those same output statements and trigger them e.g. via a <code>QTimer</code>, they work just fine. So whatever you&#39;re doing wrong is up to you to demonstrate. All I can say is &quot;works for me, sorry&quot;. You must help yourself by minimizing the problem. Please just do it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9894252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f294d2c3b236d65c4086ed4daf6235df?s=128&d=identicon&r=PG&f=1", "display_name": "apoorva", "link": "https://stackoverflow.com/users/9894252/apoorva"}, "edited": false, "score": 0, "creation_date": 1528306226, "post_id": 50725964, "comment_id": 88460750, "body": "thanks! @Jesper Juhl its printing for the first 2 outputs but then its the same again for the rest. I added <code>cout &lt;&lt; flush;</code> before every <code>cout</code> statement i the code."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 1, "last_activity_date": 1528305052, "creation_date": 1528305052, "answer_id": 50725964, "question_id": 50725848, "link": "https://stackoverflow.com/questions/50725848/display-printed-output-while-code-is-still-running-in-c-qt/50725964#50725964", "title": "Display printed output while code is still running in C++ QT", "body": "<p><code>std::cout</code> is buffered. Use <code>std::flush</code> to flush it or use <code>std::cerr</code> (which is unbuffered).</p>\n"}], "owner": {"reputation": 1, "user_id": 9894252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f294d2c3b236d65c4086ed4daf6235df?s=128&d=identicon&r=PG&f=1", "display_name": "apoorva", "link": "https://stackoverflow.com/users/9894252/apoorva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528305141, "creation_date": 1528304660, "last_edit_date": 1528305141, "question_id": 50725848, "link": "https://stackoverflow.com/questions/50725848/display-printed-output-while-code-is-still-running-in-c-qt", "title": "Display printed output while code is still running in C++ QT", "body": "<p>I wrote a C++ tensorflow code which is working just as expected (using Cmake &amp; make). But when executing the same code on QT Creator (using qmake), the code is not printing the output while it's still running. So we see no output till the execution is completed. Once its done executing, it then prints all the output at once.\nI came across a <a href=\"https://github.com/IRkernel/IRkernel/issues/3\" rel=\"nofollow noreferrer\">similar issue</a> while looking for a solution. But it is for python. I appreciate any help.</p>\n"}, {"tags": ["c++", "algorithm", "graph-theory"], "comments": [{"owner": {"reputation": 9372, "user_id": 4585963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yzwc.jpg?s=128&g=1", "display_name": "hilberts_drinking_problem", "link": "https://stackoverflow.com/users/4585963/hilberts-drinking-problem"}, "edited": false, "score": 0, "creation_date": 1528304133, "post_id": 50725698, "comment_id": 88459618, "body": "You can reverse the edges and find the nodes reachable from every node."}, {"owner": {"reputation": 181, "user_id": 9318612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4511432d7fa6cc810dfc00d567ced8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Moreira", "link": "https://stackoverflow.com/users/9318612/philip-moreira"}, "reply_to_user": {"reputation": 9372, "user_id": 4585963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yzwc.jpg?s=128&g=1", "display_name": "hilberts_drinking_problem", "link": "https://stackoverflow.com/users/4585963/hilberts-drinking-problem"}, "edited": false, "score": 1, "creation_date": 1528305140, "post_id": 50725698, "comment_id": 88460156, "body": "Could you please be a little more specific?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1528373365, "post_id": 50725698, "comment_id": 88489097, "body": "If you want to do it &quot;efficiently&quot;, you should probably say how your graph is stored. Are you using nodes-and-pointers? Or an adjacency list? Or an adjacency matrix? Or something else?"}, {"owner": {"reputation": 181, "user_id": 9318612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4511432d7fa6cc810dfc00d567ced8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Moreira", "link": "https://stackoverflow.com/users/9318612/philip-moreira"}, "edited": false, "score": 0, "creation_date": 1528410158, "post_id": 50725698, "comment_id": 88509649, "body": "Adjacency list / Adjacency matrix whatever is more efficient."}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 9796174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9dStb.jpg?s=128&g=1", "display_name": "Helium_1s2", "link": "https://stackoverflow.com/users/9796174/helium-1s2"}, "edited": false, "score": 1, "creation_date": 1528306163, "post_id": 50726109, "comment_id": 88460719, "body": "You should probably describe complexity of graph algorithms in terms of number of vertices and number of edges (V and E) instead of n, to avoid ambiguity. For example, DFS to check if a cycle exists is O(V+E)."}, {"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "edited": false, "score": 1, "creation_date": 1528306303, "post_id": 50726109, "comment_id": 88460793, "body": "My answer was independently found but is morally the same as this one, with the exception that I did the research to identify a linear algorithm for your first step. :-)"}, {"owner": {"reputation": 6218, "user_id": 821497, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/956003d5607ba6be2dd3f37427980e2c?s=128&d=identicon&r=PG", "display_name": "ciamej", "link": "https://stackoverflow.com/users/821497/ciamej"}, "reply_to_user": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "edited": false, "score": 0, "creation_date": 1528372813, "post_id": 50726109, "comment_id": 88488716, "body": "@btilly Yeah, I just haven&#39;t had the time to do the research, just typed the answer and shut down my computer ;) I think you could also use a modified DFS to achieve the goal."}, {"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "edited": false, "score": 0, "creation_date": 1528383579, "post_id": 50726109, "comment_id": 88496521, "body": "@ciamej I bet you could use a modified DFS to achieve the goal..particularly since that is exactly what Tarjan&#39;s algorithm is. :-)  (DFS with some dynamic programming.)"}], "tags": [], "owner": {"reputation": 6218, "user_id": 821497, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/956003d5607ba6be2dd3f37427980e2c?s=128&d=identicon&r=PG", "display_name": "ciamej", "link": "https://stackoverflow.com/users/821497/ciamej"}, "is_accepted": false, "score": 2, "last_activity_date": 1528372510, "last_edit_date": 1528372510, "creation_date": 1528305652, "answer_id": 50726109, "question_id": 50725698, "link": "https://stackoverflow.com/questions/50725698/directed-graph-how-to-count-the-number-of-vertices-from-which-each-other-verte/50726109#50726109", "title": "Directed Graph - How to count the number of vertices from which each other vertex in graph is reachable?", "body": "<p>If there is no cycle in the graph, there can be only one such vertex and it has an in-degree zero, and there are no other vertices with an in-degree zero. You then have to run a DFS to check if all other vertices are reachable from it. So the answer is either one or zero, depending on the result of DFS.</p>\n\n<p>If there is a cycle, then all the vertices in the cycle have this property or none of them have it. </p>\n\n<p>If you detect a cycle, replace all the vertices in the cycle with one vertex and keep a label for that vertex of how many vertices it represents. Use the same procedure as above. I.e., check in-degrees and run DFS from the new node. The answer will be zero or the label.</p>\n\n<p>Detecting a cycle can be accomplished using a DFS.</p>\n\n<p>There might be several cycles in the graph. In that case you have to eliminate all of them. You can eliminate all of them in one linear pass of DFS, but that's tricky. You could also use Tarjan's algorithm as suggested by btilly in his answer.</p>\n"}, {"tags": [], "owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "is_accepted": false, "score": 1, "last_activity_date": 1528306233, "creation_date": 1528306233, "answer_id": 50726274, "question_id": 50725698, "link": "https://stackoverflow.com/questions/50725698/directed-graph-how-to-count-the-number-of-vertices-from-which-each-other-verte/50726274#50726274", "title": "Directed Graph - How to count the number of vertices from which each other vertex in graph is reachable?", "body": "<p>Use <a href=\"https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm\" rel=\"nofollow noreferrer\">Tarjan's strongly connected components algorithm</a> to detect all loops then construct a graph with each strongly connected component collapsed to a single node.</p>\n\n<p>Now in this new graph, it is sufficient to look for a vertex with no in edges.  If that vertex connects to every other one (verifiable with a breadth first linear search), then everything in the strongly connected component that it came from is in your set, otherwise no vertex is in your set.</p>\n"}], "owner": {"reputation": 181, "user_id": 9318612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4511432d7fa6cc810dfc00d567ced8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Moreira", "link": "https://stackoverflow.com/users/9318612/philip-moreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1528372510, "creation_date": 1528303990, "last_edit_date": 1528305400, "question_id": 50725698, "link": "https://stackoverflow.com/questions/50725698/directed-graph-how-to-count-the-number-of-vertices-from-which-each-other-verte", "title": "Directed Graph - How to count the number of vertices from which each other vertex in graph is reachable?", "body": "<p>In a directed graph how to efficiently count the number of vertices from which each other vertex in graph is reachable?</p>\n"}, {"tags": ["c++", "c", "command-line", "arguments"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528304053, "post_id": 50725671, "comment_id": 88459574, "body": "Even if there is none, it will consider as string only the part up  to the null character."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528304061, "post_id": 50725671, "comment_id": 88459579, "body": "The command line arguments are strings, terminated by a null byte.  Trying to pass binary data with embedded nulls fails because of that \u2014 the data for each argument is deemed terminated by the first null byte.  You have to accept that, and redesign your interface so null bytes are not needed or are specially encoded (and what else then needs encoding).  Or, if you&#39;re implementing your own o/s, you can go with a non-POSIX approach to handling command line arguments."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528304105, "post_id": 50725671, "comment_id": 88459601, "body": "That&#39;s not passing binary data. That&#39;s passing a string representation of a hex number. <code>printf()</code> is not even interpreting it correctly, as <code>0x123</code> != <code>123</code>. And what you&#39;re passing to bash is not a valid anything."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528304205, "post_id": 50725671, "comment_id": 88459659, "body": "it is not a good idea to pass binary data this way. Pass it through standard input or file."}, {"owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1528304226, "post_id": 50725671, "comment_id": 88459668, "body": "@ken, <code>printf &quot;1\\x0123&quot; | od -c</code> shows 4 characters: <code>1 001   2   3</code>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 0, "creation_date": 1528304278, "post_id": 50725671, "comment_id": 88459693, "body": "@glennjackman: Not according to the poster&#39;s example."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528304348, "post_id": 50725671, "comment_id": 88459732, "body": "@JonathanLeffler I think there is no prevention from C side if the OS is deciding to pass some data with zeros as the <code>argv</code> to <code>main</code>."}, {"owner": {"reputation": 1466, "user_id": 2689696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/303b6001169b9992aee46c054b3c49bc?s=128&d=identicon&r=PG&f=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2689696/tejas"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528304370, "post_id": 50725671, "comment_id": 88459747, "body": "@KenWhite Seems like so removed the character when i copy pasted"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528304381, "post_id": 50725671, "comment_id": 88459755, "body": "@KenWhite: The poster&#39;s output does not reliably show which bytes are printed.  The variant with the embedded null byte gets called out; the variant without the null byte probably has an invisible control-A (<code>\\x01&#39;</code>) in the string."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1528304566, "post_id": 50725671, "comment_id": 88459859, "body": "@EugeneSh.: How does that work?  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.2.2.1\" rel=\"nofollow noreferrer\">C11 &#167;5.1.2.2.1 Program startup</a> says: <i>If the value of <code>argc</code> is greater than zero, the array members <code>argv[0]</code> through <code>argv[argc-1]</code> inclusive shall contain pointers to strings, which are given implementation-defined values by the host environment prior to program startup.</i> and <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.1\" rel=\"nofollow noreferrer\">C11 &#167;7.1.1</a> defines a string as <i>A string is a contiguous sequence of characters terminated by and including the first null character.</i>  That doesn&#39;t leave much wriggle room."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528304693, "post_id": 50725671, "comment_id": 88459927, "body": "@JonathanLeffler Right. So I guess there is a prevention. But what if the hosting environment is putting some defined stuff after the terminating zero? I guess then C compiler will be free to assume it is not there..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528304783, "post_id": 50725671, "comment_id": 88459973, "body": "Ah.. this question changed to c++ now.."}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1528304869, "post_id": 50725671, "comment_id": 88460021, "body": "However I&#39;d expect that the output would be just &quot;1&quot;, not &quot;123&quot;. Clearly the &quot;\\x00&quot; is not passed down the params. However <code>printf &quot;1\\x0023&quot; | od -c</code> works - prints the zero character. Interesting :)"}, {"owner": {"reputation": 1466, "user_id": 2689696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/303b6001169b9992aee46c054b3c49bc?s=128&d=identicon&r=PG&f=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2689696/tejas"}, "reply_to_user": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1528305102, "post_id": 50725671, "comment_id": 88460140, "body": "@axalis <code>|</code> would go to stdin not arguments"}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1528305328, "post_id": 50725671, "comment_id": 88460262, "body": "Yep, true. So it seems that not possible directly with params, but you can read the binary string from stdin (or from a &quot;regular&quot; file indeed)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1528305373, "post_id": 50725671, "comment_id": 88460294, "body": "@axalis .. and it is completely different story.."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1528306671, "post_id": 50725671, "comment_id": 88460998, "body": "You <i>might</i> be able to do this sort of thing by calling <code>execl</code> or <code>execv</code>.  (But it probably wouldn&#39;t work, if the kernel has occasion to recopy the argument list, which it probably does.)"}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1528312661, "post_id": 50727091, "comment_id": 88463985, "body": "There are certainly utilities which will interpret an empty option argument as though it were a NUL byte (such as the <code>-d</code> options for Gnu <code>cut</code> and bash&#39;s <code>read</code>). But in general, it seems to me that if you are defining a mechanism such as the one you describe, implementing standard escape codes would be a lot cleaner, less error-prone, and not that much more difficult to write."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1528313025, "post_id": 50727091, "comment_id": 88464142, "body": "I agree that this is not a good way to do it \u2014 the &#39;by special arrangement&#39; means that only utilities that know about the scheme can use it.  And yes, for the most part, handling some sort of escape scheme would be simpler, whether that&#39;s as long-winded as &quot;string of pairs of hex digits&quot; or &quot;use <code>\\037</code> for octal; use <code>\\x1F</code> for hexadecimal; use <code>\\\\</code> for a backslash (\u2026and what else?\u2026)&quot;.  The use of backslashes is ubiquitous on Unix, of course, but doesn&#39;t necessarily work well with the shell (or, more accurately, requires you to be fully aware of which code is interpreting what and how)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1528314006, "post_id": 50727091, "comment_id": 88464596, "body": "Backslashes are not special inside single quotes, and c-style escapes are not special inside double quotes, all of which facilitates their use (for example in the printf format strings in the OP). There are confusing cases, but for the most part people don&#39;t think too hard before writing <code>printf &quot;%s\\n&quot;</code>. You do sometimes have to use four backslashes, which I guess speaks to your point. You could always use URL-style %-encoding, arguably even simpler but less ubiquitous."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1528310135, "last_edit_date": 1528310135, "creation_date": 1528309263, "answer_id": 50727091, "question_id": 50725671, "link": "https://stackoverflow.com/questions/50725671/binary-data-as-command-line-argument/50727091#50727091", "title": "Binary data as command line argument", "body": "<p>This answer is written in C, but can be compiled as C++ and works the same in both.  I quote from the C11 standard; there are equivalent definitions in the <a href=\"https://stackoverflow.com/questions/204476/\">C++ standards</a>.</p>\n\n<h3>There isn't a good way to pass null bytes to a program's arguments</h3>\n\n<blockquote>\n  <p><strong><a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.2.2.1\" rel=\"nofollow noreferrer\">C11 \u00a75.1.2.2.1 Program startup</a>:</strong><br>\n  If the value of <code>argc</code> is greater than zero, the array members <code>argv[0]</code> through <code>argv[argc-1]</code> inclusive shall contain pointers to strings, which are given implementation-defined values by the host environment prior to program startup.</p>\n  \n  <p><strong><a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.1\" rel=\"nofollow noreferrer\">C11 \u00a77.1.1 Definitions of terms</a></strong><br>\n  A string is a contiguous sequence of characters terminated by and including the first null character.</p>\n</blockquote>\n\n<p>That means that each argument passed to <code>main()</code> in <code>argv</code> is a null-terminated string.  There is no reliable data after the null byte at the end of the string \u2014 searching there would be accessing out of bounds of the string.</p>\n\n<p>So, as noted at length in the comments to the question, it is not possible in the ordinary course of events to get null bytes to a program via the argument list because null bytes are interpreted as being the end of each argument.</p>\n\n<h3>By special agreement</h3>\n\n<p>That doesn't leave much wriggle room.  However, if both the calling/invoking program and the called/invoked program agree on the convention, then, even with the limitations imposed by the standards, you can pass arbitrary binary data, including arbitrary sequences of null bytes, to the invoked program \u2014 up to the limits on the length of an argument list imposed by the implementation.</p>\n\n<p>The convention has to be along the lines of:</p>\n\n<ul>\n<li>All arguments (except <code>argv[0]</code>, which is ignored, and the last argument, <code>argv[argc-1]</code>) consist of a stream of non-null bytes followed by a null.</li>\n<li>If you need adjacent nulls, you have to provide empty arguments on the command line.</li>\n<li>If you need trailing nulls, you have to provide empty arguments as the last arguments on the command line.</li>\n</ul>\n\n<p>This could lead to a program such as (<code>null19.c</code>):</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstatic void hex_dump(const char *tag, size_t size, const char *buffer);\n\nint main(int argc, char **argv)\n{\n    if (argc &lt; 2)\n    {\n        fprintf(stderr, \"Usage: %s arg1 [arg2 '' arg4 ...]\\n\", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    size_t len_args = 0;\n    for (int i = 1; i &lt; argc; i++)\n        len_args += strlen(argv[i]) + 1;\n\n    char buffer[len_args];\n\n    size_t offset = 0;\n    for (int i = 1; i &lt; argc; i++)\n    {\n        size_t arglen = strlen(argv[i]) + 1;\n        memmove(buffer + offset, argv[i], strlen(argv[i]) + 1);\n        offset += arglen;\n    }\n    assert(offset != 0);\n    offset--;\n\n    hex_dump(\"Argument list\", offset, buffer);\n    return 0;\n}\n\nstatic inline size_t min_size(size_t x, size_t y) { return (x &lt; y) ? x : y; }\n\nstatic void hex_dump(const char *tag, size_t size, const char *buffer)\n{\n    printf(\"%s (%zu):\\n\", tag, size);\n    size_t offset = 0;\n    while (size != 0)\n    {\n        printf(\"0x%.4zX:\", offset);\n        size_t count = min_size(16, size);\n        for (size_t i = 0; i &lt; count; i++)\n            printf(\" %.2X\", buffer[offset + i] &amp; 0xFF);\n        putchar('\\n');\n        size -= count;\n        offset += count;\n    }\n}\n</code></pre>\n\n<p>This could be invoked using:</p>\n\n<pre><code>$ ./null19 '1234' '5678' '' '' '' '' 'def0' ''\nArgument list (19):\n0x0000: 31 32 33 34 00 35 36 37 38 00 00 00 00 00 64 65\n0x0010: 66 30 00\n$\n</code></pre>\n\n<p>The first argument is deemed to consist of 5 bytes \u2014 four digits and a null byte.  The second is similar.  The third through sixth arguments each represent a single null byte (it gets painful if you need large numbers of contiguous null bytes), then there is another string of five bytes (three letters, one digit, one null byte).  The last argument is empty but ensures that there is a null byte at the end.  If omitted, the output would not include that final terminal null byte.</p>\n\n<pre><code>$ ./null19 '1234' '5678' '' '' '' '' 'def0' \nArgument list (18):\n0x0000: 31 32 33 34 00 35 36 37 38 00 00 00 00 00 64 65\n0x0010: 66 30\n$\n</code></pre>\n\n<p>This is the same as before except there is no trailing null byte in the data.  The two examples in the question are easily handled:</p>\n\n<pre><code>$ ./null19 $(printf \"1\\x0123\")\nArgument list (4):\n0x0000: 31 01 32 33\n$ ./null19 1 23\nArgument list (4):\n0x0000: 31 00 32 33\n$\n</code></pre>\n\n<p>This works strictly within the standard assuming only that empty strings are recognized as valid arguments.  In practice, those arguments are already contiguous in memory so it might be possible on many platforms to avoid the copying phase into the buffer.  However, the standard does not stipulate that the argument strings are laid out contiguously in memory.</p>\n\n<p>If you need multiple arguments with binary data, you can modify the convention.  For example, you could take a control argument of a string which indicates how many subsequent physical arguments make up one logical binary argument.</p>\n\n<p>All this relies on the programs interpreting the argument list as agreed.  It is not really a general solution.</p>\n"}], "owner": {"reputation": 1466, "user_id": 2689696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/303b6001169b9992aee46c054b3c49bc?s=128&d=identicon&r=PG&f=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2689696/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2248, "favorite_count": 1, "accepted_answer_id": 50727091, "answer_count": 1, "score": 0, "last_activity_date": 1528310135, "creation_date": 1528303883, "last_edit_date": 1528307695, "question_id": 50725671, "link": "https://stackoverflow.com/questions/50725671/binary-data-as-command-line-argument", "title": "Binary data as command line argument", "body": "<p>I have a simple c++ program (and a similar one for c) that just prints out the first argument</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main(int argc, char** argv)\n{\n    if(argc &gt; 1)\n        std::cout &lt;&lt; \"&gt;&gt;\" &lt;&lt; argv[1] &lt;&lt; \"&lt;&lt;\\n\";\n}\n</code></pre>\n\n<p>I can pass binary data (i have tried on bash) as argument like </p>\n\n<pre><code>$./a.out $(printf \"1\\x0123\")\n  &gt;&gt;1?23&lt;&lt;\n</code></pre>\n\n<p>If I try to pass a null there i get</p>\n\n<pre><code>./a.out $(printf \"1\\x0023\")\nbash: warning: command substitution: ignored null byte in input\n&gt;&gt;123&lt;&lt;\n</code></pre>\n\n<p>Clearly bash(?) does not allow this</p>\n\n<p>But is it possible to send a null as a command line argument this way?\nDo either c or c++ put any restrictions on this?</p>\n\n<p>Edit: I am not using this in day-to-day c++, this question is just out of curiosity</p>\n"}, {"tags": ["c++", "qt", "cmake", "qt5"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9174145"}, "edited": false, "score": 0, "creation_date": 1528925782, "post_id": 50821373, "comment_id": 88696766, "body": "Yes, it may be a shot in the dark, but it actually solved my problem Teivaz!! Thanks for your comment and also for sharing the other documentation posted from other posts. :) :)"}], "tags": [], "owner": {"reputation": 4506, "user_id": 3344612, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jwgap.jpg?s=128&g=1", "display_name": "Teivaz", "link": "https://stackoverflow.com/users/3344612/teivaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1528819073, "creation_date": 1528819073, "answer_id": 50821373, "question_id": 50725670, "link": "https://stackoverflow.com/questions/50725670/cmake-automoc-error-1-cant-compile-project/50821373#50821373", "title": "CMake Automoc Error 1 - Can&#39;t compile project", "body": "<p>It's a shot in a dark but this is most likely caused by the missing <code>set(CMAKE_INCLUDE_CURRENT_DIR ON)</code>. As said in the <a href=\"https://cmake.org/cmake/help/v3.1/manual/cmake-qt.7.html#automoc\" rel=\"nofollow noreferrer\">documentation</a> it should set because generated files are not in your source directory:</p>\n\n<blockquote>\n  <p>Generated moc_*.cpp and *.moc files are placed in the build directory so it is convenient to set the CMAKE_INCLUDE_CURRENT_DIR variable.</p>\n</blockquote>\n\n<p>Another mistake I see people doing is mixing Qt processing pipelines. I've mentioned this already in my other <a href=\"https://stackoverflow.com/a/48695692/3344612\">answers</a>. As it says in documentation on <a href=\"https://cmake.org/cmake/help/v3.1/prop_tgt/AUTOUIC.html#prop_tgt:AUTOUIC\" rel=\"nofollow noreferrer\"><code>AUTOUIC</code> property</a> you shouldn't use <code>qt5_wrap_ui</code> function when this property is enabled.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9174145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 0, "accepted_answer_id": 50821373, "answer_count": 1, "score": 2, "last_activity_date": 1528819073, "creation_date": 1528303879, "question_id": 50725670, "link": "https://stackoverflow.com/questions/50725670/cmake-automoc-error-1-cant-compile-project", "title": "CMake Automoc Error 1 - Can&#39;t compile project", "body": "<p>I just moved a project I built in Qt5 into my CMake project tree.\nI exported the project in the CMake directory. However as I try to build the project the compiler gives me the following error:\n<strong>[src/GUIconceptStudy/CMakeFiles/GUIconceptStudy_automoc] Error 1</strong></p>\n\n<p>See also the following print screen attached:\n<a href=\"https://i.stack.imgur.com/ydvgl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ydvgl.png\" alt=\"Automoc Error 1\"></a></p>\n\n<p>Also the CMakeLists.txt files is below:</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.1)\nproject(GUIconceptStudy)\n\nset(CMAKE_AUTOMOC ON)\nset(CMAKE_AUTORCC ON)\nset(CMAKE_AUTOUIC ON)\n\nfind_package( OpenCV REQUIRED )\nfind_package( Boost COMPONENTS system thread filesystem REQUIRED)\n\n#find_package (sqlite3)\nfind_package(Qt5 REQUIRED COMPONENTS Core Quick)\n\n###\n### make sure we use c++11\n###\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11\")\n\n###\n###boost include stuff (required for all libcam)\n###\nINCLUDE_DIRECTORIES( ${Boost_INCLUDE_DIR} )\n\nfind_package(Qt5Widgets)\nfind_package(Qt5PrintSupport)\n#find all the qt UI stuff\nfile(GLOB UI\n    \"ui/*.ui\"\n)\n\n#make them into headers\nqt5_wrap_ui (UI_HDRS  ${UI})\n\n###\n### add all your non QT sources\n###\n\n# find all non ui sources\nfile(GLOB SRCS\n    \"src/*.h\"\n    \"src/*.cpp\"\n    \"src/*.hpp\"\n)\n\n# find all ui related sources\nfile(GLOB UI_SRCS\n    \"ui/*.h\"\n    \"ui/*.cpp\"\n    \"ui/*.hpp\"\n)\n\n###\n### Add executables\n###\nadd_executable(GUIconceptStudy main/main.cpp ui/qrc/res.qrc ${SRCS} ${UI_HDRS} ${UI_SRCS})\ntarget_link_libraries (GUIconceptStudy  Qt5::Widgets  ${Boost_LIBRARIES} ${OpenCV_LIBS} Qt5::PrintSupport Qt5::Core Qt5::Quick)\n\n###\n### Add Library\n###\nadd_library(GUIconceptStudy_lib SHARED ui/qrc/res.qrc ${SRCS} ${UI_HDRS} ${UI_SRCS})\ntarget_link_libraries (GUIconceptStudy_lib Qt5::Widgets  ${Boost_LIBRARIES} ${OpenCV_LIBS} Qt5::PrintSupport Qt5::Core Qt5::Quick)\n</code></pre>\n\n<p>After looking at different on-line sources I could't find anything particularly useful. Anyone who can shed a little bit of light on what the problem could be?</p>\n"}, {"tags": ["python", "c++", "boost", "boost-python"], "comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1528304142, "post_id": 50725646, "comment_id": 88459620, "body": "Do you just need to do this for a single function type (eg: double(double)) or something more generic?"}, {"owner": {"reputation": 4142, "user_id": 3765905, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/xkm1p.png?s=128&g=1", "display_name": "BoltzmannBrain", "link": "https://stackoverflow.com/users/3765905/boltzmannbrain"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1528304652, "post_id": 50725646, "comment_id": 88459900, "body": "@SeanMcAllister if there is a solution for a more generic callback function that takes in other args -- e.g. <code>callback(x, y=42., z=True)</code> -- that&#39;d be great to see."}], "answers": [{"tags": [], "owner": {"reputation": 4142, "user_id": 3765905, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/xkm1p.png?s=128&g=1", "display_name": "BoltzmannBrain", "link": "https://stackoverflow.com/users/3765905/boltzmannbrain"}, "is_accepted": true, "score": 1, "last_activity_date": 1528559857, "creation_date": 1528559857, "answer_id": 50776056, "question_id": 50725646, "link": "https://stackoverflow.com/questions/50725646/convert-python-function-to-c-via-boost-python-for-use-as-a-callback/50776056#50776056", "title": "Convert Python function to C++, via Boost Python, for use as a callback", "body": "<p>Implement a functor in foo_bindings.cpp, where the callback is invoked with <a href=\"https://www.boost.org/doc/libs/1_58_0/libs/python/doc/v2/call.html#call-spec\" rel=\"nofollow noreferrer\">call</a>:</p>\n\n<pre><code>#include &lt;boost/python.hpp&gt;\n#include &lt;boost/python/call.hpp&gt;\n\nstruct PythonCallback : {\npublic:\n    PythonCallback(PyObject* func) : cb_(func) {}\n    double operator() (const double&amp; value) {\n        // Call the callback function in python\n        return boost::python::call&lt;double&gt;(cb_, value);\n    }\nprivate:\n    PyObject* cb_;\n};\n</code></pre>\n"}], "owner": {"reputation": 4142, "user_id": 3765905, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/xkm1p.png?s=128&g=1", "display_name": "BoltzmannBrain", "link": "https://stackoverflow.com/users/3765905/boltzmannbrain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 50776056, "answer_count": 1, "score": 0, "last_activity_date": 1528559857, "creation_date": 1528303798, "last_edit_date": 1528305211, "question_id": 50725646, "link": "https://stackoverflow.com/questions/50725646/convert-python-function-to-c-via-boost-python-for-use-as-a-callback", "title": "Convert Python function to C++, via Boost Python, for use as a callback", "body": "<p>In general what is the recommended way to pass a Python function through Boost-Python for use later in C++ code (i.e. as a callback in a C++ object)?</p>\n\n<p>More specifically, I have a C++ class <code>FooCPP</code> that I've successfully exposed to Python via Boost-Python; the user interacts with the Python class <code>Foo</code> that runs the C++ counterpart under the hood. Contrived example:</p>\n\n<pre><code># Foo.py\n\nfrom foo_base import FooBase\n\nclass Foo(FooBase):\n    ...\n\ndef callback(val=42.):\n    return val\n\nfoo = Foo()\nfoo.run(callback)\n</code></pre>\n\n<p>And the Boost Python bindings:</p>\n\n<pre><code>// foo_bindings.cpp\n\n#include \"foo.hpp\"\n#include &lt;boost/python.hpp&gt;\n\nnamespace bp =  boost::python;\n\nFooPython::Run(const bp::object&amp; py_callback)\n    // TODO: Do something with the python callback to make it a C++ function!\n    std::function&lt;double(double)&gt; cpp_callback;\n    FooCPP::Run(cpp_callback);\n)\n\nBOOST_PYTHON_MODULE(foo_base){\n    bp::class_&lt;FooPython&gt;(\"FooBase\")\n    .def(\"run\", &amp;FooPython::Run)\n    ;\n}\n</code></pre>\n\n<p>So how can I address the TODO comment in foo_bindings.cpp?</p>\n\n<p>I've gone through a number of related SO questions -- e.g. <a href=\"https://stackoverflow.com/questions/21451863/passing-python-function-to-boost-c\">pass python function to boost c</a> and <a href=\"https://stackoverflow.com/questions/36049533/sending-python-function-as-boost-function-argument\">sending py function as boost function arg</a> -- and I'm familiar with the <a href=\"https://www.boost.org/doc/libs/1_58_0/libs/python/doc/v2/callbacks.html\" rel=\"nofollow noreferrer\">Boost-Python docs</a>, but have not found a good solution/explanation. Thanks in advance!</p>\n\n<p>Notes: C++11, boost v1.58.0, ubuntu 16.04</p>\n\n<h3>Update</h3>\n\n<p>I may have just found a solution, where I can implement a functor in foo_bindings.cpp, e.g.,</p>\n\n<pre><code>struct PythonCallback {\npublic:\n    PythonCallback(bp::object cb_func) : cb_func_(cb_func) {}\n    double operator() (const double&amp; val) {\n        // Call the callback function in python\n        return cb_func_(val);\n    }\nprivate:\n    bp::object cb_func_;\n};\n</code></pre>\n\n<p>But then what should the <code>FooCPP::Run</code> signature be? I.e. what type is defined for the <code>cpp_callback</code> passed in?</p>\n\n<p>And does the <code>BOOST_PYTHON_MODULE</code> code need to change for this callback functor?</p>\n"}, {"tags": ["c++", "c++11", "stl", "variadic-templates", "template-meta-programming"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1528303436, "post_id": 50725500, "comment_id": 88459250, "body": "Please post what you have tried."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1528303695, "post_id": 50725500, "comment_id": 88459393, "body": "strictly C++11? No C++14?"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1528303806, "post_id": 50725500, "comment_id": 88459448, "body": "@max66 correct unfortunately"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1528303844, "post_id": 50725500, "comment_id": 88459467, "body": "@R Sahu I haven&#39;t tried much, tried a little pattern matching to get the head and tail of the tuple, but didn&#39;t have much luck.  There&#39;s tuple_cat to merge tuples but nothing to split them nicely so it&#39;s tricky."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1528304896, "post_id": 50725500, "comment_id": 88460032, "body": "A template function that takes <code>int index</code> template parameter, alongside the tuple, and does <code>return get&lt;index&gt;(t)() || ThisFunction&lt;index+1&gt;(t);</code> Plus an overload SFINAE-enabled for the case of <code>index &gt;= tuple_size&lt;T&gt;::value</code> and returning <code>false</code> unconditionally. Something like that."}, {"owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 0, "creation_date": 1528305502, "post_id": 50725500, "comment_id": 88460353, "body": "Can functors have different arity? How are functor&#39;s arguments passed?"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528305451, "post_id": 50725949, "comment_id": 88460325, "body": "Or replace <code>std::tuple</code> with <code>std::vector</code> and remove all that unnecessary code"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528307112, "post_id": 50725949, "comment_id": 88461243, "body": "@Slava - Yes, but so isn&#39;t funny :-( (I&#39;m joking and I&#39;m agree: if the OP can, the use a std::vector, instead of a std::tuple, is greatly preferable)."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 1, "last_activity_date": 1528305618, "last_edit_date": 1528305618, "creation_date": 1528305001, "answer_id": 50725949, "question_id": 50725500, "link": "https://stackoverflow.com/questions/50725500/iterate-over-tuple-of-functors-in-c11/50725949#50725949", "title": "Iterate over tuple of functors in c++11", "body": "<p>Not particularly creative but...</p>\n\n<p>If you create a <code>foo()</code> function as follows</p>\n\n<pre><code>template &lt;typename ... Args&gt;\nbool foo (std::tuple&lt;Args...&gt; const &amp; tf)\n { return bar&lt;0&gt;(tf); }\n</code></pre>\n\n<p>that call, starting with template index 0, the following couple of template (SFINAE enabled/disabled) alternative functions</p>\n\n<pre><code>template &lt;std::size_t I, typename ... Args&gt;\ntypename std::enable_if&lt;(I &gt;= sizeof...(Args)), bool&gt;::type\n   bar (std::tuple&lt;Args...&gt; const &amp;)\n { return false; }\n\ntemplate &lt;std::size_t I, typename ... Args&gt;\ntypename std::enable_if&lt;(I &lt; sizeof...(Args)), bool&gt;::type\n   bar (std::tuple&lt;Args...&gt; const &amp; tf)\n { return baz(std::get&lt;I&gt;(tf)) || bar&lt;I+1U&gt;(tf); }\n</code></pre>\n\n<p>and an additional <code>baz()</code> function to call single functors</p>\n\n<pre><code>bool baz (functor const &amp; f)\n { return f(); }\n</code></pre>\n\n<p>I suppose you can obtain what do you want.</p>\n\n<p>The following is a full working example</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nusing functor = std::function&lt;bool()&gt;;\n\nbool baz (functor const &amp; f)\n { return f(); }\n\ntemplate &lt;std::size_t I, typename ... Args&gt;\ntypename std::enable_if&lt;(I &gt;= sizeof...(Args)), bool&gt;::type\n   bar (std::tuple&lt;Args...&gt; const &amp;)\n { return false; }\n\ntemplate &lt;std::size_t I, typename ... Args&gt;\ntypename std::enable_if&lt;(I &lt; sizeof...(Args)), bool&gt;::type\n   bar (std::tuple&lt;Args...&gt; const &amp; tf)\n { return baz(std::get&lt;I&gt;(tf)) || bar&lt;I+1U&gt;(tf); }\n\ntemplate &lt;typename ... Args&gt;\nbool foo (std::tuple&lt;Args...&gt; const &amp; tf)\n { return bar&lt;0&gt;(tf); }\n\nbool f0 () { std::cout &lt;&lt; \"f0 \"; return false; }\nbool f1 () { std::cout &lt;&lt; \"f1 \"; return false; }\nbool f2 () { std::cout &lt;&lt; \"f2 \"; return false; }\nbool f3 () { std::cout &lt;&lt; \"f3 \"; return false; }\nbool f4 () { std::cout &lt;&lt; \"f4 \"; return true; }\nbool f5 () { std::cout &lt;&lt; \"f5 \"; return false; }\nbool f6 () { std::cout &lt;&lt; \"f6 \"; return false; }\nbool f7 () { std::cout &lt;&lt; \"f7 \"; return false; }\nbool f8 () { std::cout &lt;&lt; \"f8 \"; return false; }\nbool f9 () { std::cout &lt;&lt; \"f9 \"; return false; }\n\nint main ()\n {\n   auto tf = std::make_tuple(f0, f1, f2, f3, f4, f5, f6, f7, f8, f9);\n\n   foo(tf);\n }\n</code></pre>\n\n<p>Obviously you can avoid the use of <code>baz()</code> and simply call the functors as follows</p>\n\n<pre><code> return std::get&lt;I&gt;(tf)() || bar&lt;I+1U&gt;(tf);\n</code></pre>\n\n<p>but you loose a check over the <code>Args...</code> types.</p>\n"}, {"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1528306124, "post_id": 50726092, "comment_id": 88460697, "body": "I was a little inaccurate, the parsers all return &quot;compatible&quot; types so that they can be promoted to some type, but they&#39;re not necessarily exactly the same type.   Plus I want to use tuple to keep thing statically allocated."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1528306437, "post_id": 50726092, "comment_id": 88460866, "body": "Then if you read documentation on <code>std::tuple_cat</code> <a href=\"http://en.cppreference.com/w/cpp/utility/tuple/tuple_cat\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/utility/tuple/tuple_cat</a>  it gives you exact example on how to iterate over tuple"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": -1, "last_activity_date": 1528305920, "last_edit_date": 1528305920, "creation_date": 1528305598, "answer_id": 50726092, "question_id": 50725500, "link": "https://stackoverflow.com/questions/50725500/iterate-over-tuple-of-functors-in-c11/50726092#50726092", "title": "Iterate over tuple of functors in c++11", "body": "<p>Just use proper container - <code>std::vector</code> instead of <code>std::tuple</code>:</p>\n\n<pre><code>using functor = std::function&lt;bool()&gt;;\nusing functors = std::vector&lt;functor&gt;;\n</code></pre>\n\n<p>and I thing it is pretty obvious how to iterate over <code>std::vector</code></p>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 50725949, "answer_count": 2, "score": -1, "last_activity_date": 1528305920, "creation_date": 1528303297, "last_edit_date": 1528305137, "question_id": 50725500, "link": "https://stackoverflow.com/questions/50725500/iterate-over-tuple-of-functors-in-c11", "title": "Iterate over tuple of functors in c++11", "body": "<p>I have a <code>std::tuple</code> of functors (of unknown arity) that are expected to all return the same type, so something like:</p>\n\n<pre><code>typedef functor std::function&lt;bool()&gt;;\nstd::tuple&lt;functor, functor, functor...&gt; functors;\n</code></pre>\n\n<p>I'd like to iterate over functors, evaluating each member until I find one that succeeds, otherwise failure.  How can I achieve this in c++11?</p>\n"}, {"tags": ["c++", "gcc", "compiler-optimization", "move-constructor", "noexcept"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 3, "creation_date": 1528302863, "post_id": 50725290, "comment_id": 88458930, "body": "There is an explicit list here saying when the compiler can assume <code>noexcept</code> <a href=\"http://en.cppreference.com/w/cpp/language/noexcept_spec\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/noexcept_spec</a>  The standard needs to play-safe to ensure the strong exception guarentee.  Analysing user-written code is not safe enough."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528303284, "post_id": 50725290, "comment_id": 88459163, "body": "@RichardCritten: So you&#39;re saying the compiler is supposed to <i>assume</i> my code may throw, even though it can easily tell that it can&#39;t (using the potentially-throwing-expressions logic)?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528303355, "post_id": 50725290, "comment_id": 88459204, "body": "I&#39;m saying that may be the reasoning behind the wording of the standard."}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1528303378, "post_id": 50725290, "comment_id": 88459217, "body": "One reason I suppose is that you can technically do many different things in a custom defined move constructor (although many of those might not be a good practice) that might actually result in an exception being thrown (in the fact, AFAIK nothing will prevent you to throw an exception from your move constructor explicitly)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1528303574, "post_id": 50725290, "comment_id": 88459316, "body": "@einpoklum if the move constructor was in a library for example, how would the compiler be able to assume that it will not throw? All it would be able to see is the declaration in the header."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 2, "creation_date": 1528303577, "post_id": 50725290, "comment_id": 88459323, "body": "@axalis: I can, but I&#39;m not, and the compiler can know / does know that I&#39;m not.... of course, if the compiler doesn&#39;t know, then it has to assume there might be an exception, that&#39;s obvious."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1528306360, "post_id": 50725290, "comment_id": 88460823, "body": "@NathanOliver: You won&#39;t get a compiler error from std::vector copying instead of moving, you&#39;ll get very subtle bugs at run-time."}], "answers": [{"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528306412, "post_id": 50725743, "comment_id": 88460849, "body": "I like your answer, I don&#39;t like the situation with the standard."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528306755, "post_id": 50725743, "comment_id": 88461034, "body": "@einpoklum would you like const specifier to be inferred as well? noexcept specification is a promise to the user of the function that the author of the API might not wish to be required to be accountable for implicitly."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528306964, "post_id": 50725743, "comment_id": 88461176, "body": "Actually, it&#39;s not exactly a promise to the user. I mean, you can throw exceptions just fine in a <code>noexcept</code> function, you&#39;ll just terminate the program instead of finding an exception handler, right?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528307033, "post_id": 50725743, "comment_id": 88461207, "body": "But I will say that I want that whenever we ask &quot;do we have a method/function so-and-so which is <code>noexcept</code>?&quot;, and there&#39;s a method not marked this way or that, which the compiler knows to be <code>noexcept</code> - then the answer would be &quot;yes&quot;."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1528308296, "post_id": 50725743, "comment_id": 88461864, "body": "@einpoklum it&#39;s a promise that the user doesn&#39;t need to handle any exceptions, because no exception will propagate out of the function. Sure, it doesn&#39;t promise that the function won&#39;t cause the process to terminate, but that&#39;s besides the point."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1528308452, "last_edit_date": 1528308452, "creation_date": 1528304228, "answer_id": 50725743, "question_id": 50725290, "link": "https://stackoverflow.com/questions/50725290/when-does-a-c-compiler-infer-noexcept-for-a-method/50725743#50725743", "title": "When does a C++ compiler infer noexcept for a method?", "body": "<h3>tl;dr: The compiler is not allowed to infer <code>noexcept</code></h3>\n\n<blockquote>\n  <p>Why, given the move ctor's code, does the compiler not determine it to be noexcept?</p>\n</blockquote>\n\n<p>Because noexcept specification is determined based on the declaration - not the definition. This is analogous to how const specification works. The compiler isn't allowed to determine a function to be const even though its implementation doesn't modify any members.</p>\n\n<blockquote>\n  <p>is inferring noexcept disallowed by the standard</p>\n</blockquote>\n\n<p>As I understand, yes:</p>\n\n<blockquote>\n  <p>[except.spec] ... absence of an exception-specification in a\n  function declarator other than that for a destructor (12.4) or a deallocation function (3.7.4.2) denotes an\n  exception specification that is the set of all types.</p>\n</blockquote>\n\n<p>Inferring something other than set of all types would contradict this rule. Of course, when the compiler can prove that no exception can be thrown, it can optimise away any stack unwinding code under the as-if rule, but such optimisations cannot affect SFINAE introspection.</p>\n\n<hr>\n\n<p>There has been <a href=\"https://groups.google.com/a/isocpp.org/forum/#!topic/std-proposals/ICtSsQxnPAw\" rel=\"nofollow noreferrer\">discussion</a> about possibility of introducing <code>noexcept(auto)</code>, which would be an <em>explicit</em> way of letting the compiler infer noexcept specification.</p>\n"}], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 50725743, "answer_count": 1, "score": 2, "last_activity_date": 1528308452, "creation_date": 1528302561, "last_edit_date": 1528306524, "question_id": 50725290, "link": "https://stackoverflow.com/questions/50725290/when-does-a-c-compiler-infer-noexcept-for-a-method", "title": "When does a C++ compiler infer noexcept for a method?", "body": "<p>I just noticing a <code>std::vector&lt;Foo&gt;</code> of mine was copying instead of moving its elements when resizing - even though <code>Foo</code> has a move ctor:</p>\n\n<pre><code>class Foo {\n    // ...\n    Foo(Foo&amp;&amp; other) : id_(other.id_), ptr_(other.ptr_), flag(other.flag)\n    {\n        other.flag = false;\n    };\n    // ...\n    int   id_; \n    void* ptr_; \n    bool  flag;\n}\n</code></pre>\n\n<p>Then I read:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28166001/resize-on-stdvector-does-not-call-move-constructor\">Resize on std::vector does not call move constructor</a></p>\n\n<p>which reminded me that <code>std::vector</code> will only use move construction if the elements' move ctor is declared <code>noexcept</code>. When I add <code>noexcept</code>, move ctor's are called.</p>\n\n<p>My question is: Why, given the move ctor's code, does the compiler not determine it to be <code>noexcept</code>? I mean, it can know for a fact that an exception cannot be thrown. Also, is inferring <code>noexcept</code> disallowed by the standard, or not just done by my specific compiler?</p>\n\n<p>I'm using GCC 5.4.0 on GNU/Linux.</p>\n"}, {"tags": ["c++", "opencv", "image-processing", "contour"], "comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1528302180, "post_id": 50724973, "comment_id": 88458596, "body": "You say &quot;error&quot; but forget to describe what did you expect and how it is different from what you achieved?"}, {"owner": {"reputation": 64, "user_id": 9806624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m6jKditfNxg/AAAAAAAAAAI/AAAAAAAAAAc/xrvV1RzJFVU/photo.jpg?sz=128", "display_name": "Giulio Auriemma", "link": "https://stackoverflow.com/users/9806624/giulio-auriemma"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1528303819, "post_id": 50724973, "comment_id": 88459454, "body": "Sorry, I thought it was clear."}, {"owner": {"reputation": 1595, "user_id": 5878054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb66b3b2529859a30f8ba5c502b393c?s=128&d=identicon&r=PG&f=1", "display_name": "mainactual", "link": "https://stackoverflow.com/users/5878054/mainactual"}, "edited": false, "score": 0, "creation_date": 1528313988, "post_id": 50724973, "comment_id": 88464587, "body": "Well, hard to say, as you only publish glimbses of your current work... looking at the cyan curve: it looks piecewise in the middle below the lip, so maybe you sample too few points on the curve or your points get unevenly distributed during curve evolution (you typically need to resample the curve at certain intervals). Have you calculated the maximum displacement during the evolution? Maybe your curve is dangling back and forth, which might explain the shape? &quot;Finite-element methods for active contour models and balloons for 2-D and 3-D images&quot; by Cohen&amp;Cohen is worth reading."}, {"owner": {"reputation": 64, "user_id": 9806624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m6jKditfNxg/AAAAAAAAAAI/AAAAAAAAAAc/xrvV1RzJFVU/photo.jpg?sz=128", "display_name": "Giulio Auriemma", "link": "https://stackoverflow.com/users/9806624/giulio-auriemma"}, "reply_to_user": {"reputation": 1595, "user_id": 5878054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb66b3b2529859a30f8ba5c502b393c?s=128&d=identicon&r=PG&f=1", "display_name": "mainactual", "link": "https://stackoverflow.com/users/5878054/mainactual"}, "edited": false, "score": 0, "creation_date": 1528318741, "post_id": 50724973, "comment_id": 88466753, "body": "@mainactual I will read the paper and I will update my work. But I have some questions for you: Why I need to resample the curve? What maximum displacement is worth for? My derivative matrix have both negative and positive value since I did no adjustment on Sobel algorithm, do you think I need to shift it on the positive axis (btw, I have added external() code)? And last, since greedy algorithm seems simpler, do you think is worth to go with it?"}, {"owner": {"reputation": 1595, "user_id": 5878054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb66b3b2529859a30f8ba5c502b393c?s=128&d=identicon&r=PG&f=1", "display_name": "mainactual", "link": "https://stackoverflow.com/users/5878054/mainactual"}, "edited": false, "score": 0, "creation_date": 1528389460, "post_id": 50724973, "comment_id": 88500113, "body": "Um, brief me what is greedy in this context. You choose the time step s.t. it doesn&#39;t jump over features (which consequently causes a backjump and dangling around) and naturally you want to stop evolution at equilibrium (when displacement is small enough) so there&#39;s that. Reinitialization is to keep sampling of the curve somewhat even (also to account for growing/shrinking). I think you want the edge potential be minimized at the edges. Gradient magnitude is highest there, but gradient itself, which you put into the for loop is large, so it just pushes your curve away."}, {"owner": {"reputation": 64, "user_id": 9806624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m6jKditfNxg/AAAAAAAAAAI/AAAAAAAAAAc/xrvV1RzJFVU/photo.jpg?sz=128", "display_name": "Giulio Auriemma", "link": "https://stackoverflow.com/users/9806624/giulio-auriemma"}, "edited": false, "score": 0, "creation_date": 1528390287, "post_id": 50724973, "comment_id": 88500530, "body": "Greedy algorithm is the one described in &quot;Locating Head Boundary by Snakes&quot; by Lam &amp; Yan. For the displacement I got you, I just misunderstood what you had to mean the first time I read the comment, sorry. Reinitialization is something obscure to me, but I read about it in the paper you linked, so I will read it again.  I didn&#39;t get your point about the gradient. Since it is - derivative it should have the minimum at the edges point, isn&#39;t it?"}, {"owner": {"reputation": 1595, "user_id": 5878054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb66b3b2529859a30f8ba5c502b393c?s=128&d=identicon&r=PG&f=1", "display_name": "mainactual", "link": "https://stackoverflow.com/users/5878054/mainactual"}, "edited": false, "score": 0, "creation_date": 1528458732, "post_id": 50724973, "comment_id": 88527407, "body": "From Cohen&amp;Cohen, <code>P(v)=-|Grad( I(v) )|^2, F(v)=-Grad( P(v) )</code> where <code>P</code> is the potential map and driving force is <code>F</code> while <code>I</code> is the input image. What I see, you use <code>F=-Grad( I(v) )</code> which is at high value at edges while it should get to zero from both sides. If you correct that + reduce the time step, I guess you can get some convergence."}, {"owner": {"reputation": 64, "user_id": 9806624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m6jKditfNxg/AAAAAAAAAAI/AAAAAAAAAAc/xrvV1RzJFVU/photo.jpg?sz=128", "display_name": "Giulio Auriemma", "link": "https://stackoverflow.com/users/9806624/giulio-auriemma"}, "reply_to_user": {"reputation": 1595, "user_id": 5878054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb66b3b2529859a30f8ba5c502b393c?s=128&d=identicon&r=PG&f=1", "display_name": "mainactual", "link": "https://stackoverflow.com/users/5878054/mainactual"}, "edited": false, "score": 0, "creation_date": 1528809067, "post_id": 50724973, "comment_id": 88641172, "body": "@mainactual sorry for late answer, but you spotted the problem, now I have still some difficulties on tuning parameters, but my algorithm definitively works. If you can write an answer I can sign it as correct one. Thank you very much."}], "owner": {"reputation": 64, "user_id": 9806624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m6jKditfNxg/AAAAAAAAAAI/AAAAAAAAAAc/xrvV1RzJFVU/photo.jpg?sz=128", "display_name": "Giulio Auriemma", "link": "https://stackoverflow.com/users/9806624/giulio-auriemma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1000, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1528318869, "creation_date": 1528301443, "last_edit_date": 1528318869, "question_id": 50724973, "link": "https://stackoverflow.com/questions/50724973/snake-active-contour-algorithm-with-c-and-opencv-3", "title": "Snake active contour algorithm with C++ and OpenCV 3", "body": "<p>I am trying to implement the snake algorithm for active contour using C++ and OpenCV 3. I am working with the version that uses the gradient descent. As base test I am trying to draw a contour of a lip. This is the base image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LvpvX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LvpvX.jpg\" alt=\"This\"></a></p>\n\n<p>This is the evolution of the contour without external forces (alpha = 0.001, beta = 3, step-size=0.3).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Eps4f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Eps4f.png\" alt=\"This\"></a></p>\n\n<p>When I add the external force, this is the result.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oEK8N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oEK8N.png\" alt=\"this\"></a></p>\n\n<p>As external force I have used just the edge detection with Sobel derivative.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oj3Lr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oj3Lr.png\" alt=\"Sobel derivative\"></a></p>\n\n<p>This is the code I use for points update.</p>\n\n<pre><code>array&lt;Mat, 2&gt; edges = edgeMatrices(croppedImage);\nconst float ALPHA = 0.001, BETA = 3, GAMMA = 0.3, // Gamma is step size.\n    a = GAMMA * ALPHA, b = GAMMA * BETA;\nconst uint16_t CYCLES = 1000;\n\nconst float p = b, q = -a - 4 * b, r = 1 + 2 * a + 6 * b;\nMat pMatrix = pentadiagonalMatrix(POINTS_NUM, p, q, r).inv();\n\nfor (uint16_t i = 0; i &lt; CYCLES; ++i) {\n    // Extract the x and y derivatives for current points. \n    auto externalForces = external(edges, x, y);\n\n    x = pMatrix * (x + GAMMA * externalForces[0]);\n    y = pMatrix * (y + GAMMA * externalForces[1]);\n\n    // Draw the points.\n    if (i % 200 == 0 &amp;&amp; i &gt; 0)\n        drawPoints(croppedImage, x, y, { 0.2f * i, 0.2f * i, 0 });\n}\n</code></pre>\n\n<p>This is the code for computing the derivatives.</p>\n\n<pre><code>array&lt;Mat, 2&gt; edgeMatrices(Mat &amp;img) {\n    // Convert image.\n    Mat gray;\n    cvtColor(img, gray, COLOR_BGR2GRAY);\n\n    // Apply scharr filter.\n    Mat grad_x, grad_y, blurred_x, blurred_y;\n    int scale = 1;\n    int delta = 0;\n    int ddepth = CV_16S;\n    int kernSize = 3;\n\n    Sobel(gray, grad_x, ddepth, 1, 0, kernSize, scale, delta, BORDER_DEFAULT);\n    Sobel(gray, grad_y, ddepth, 0, 1, kernSize, scale, delta, BORDER_DEFAULT);\n\n    GaussianBlur(grad_x, blurred_x, Size(5, 5), 30);\n    GaussianBlur(grad_y, blurred_y, Size(5, 5), 30);\n\n    return { blurred_x, blurred_y };\n}\n\narray&lt;Mat, 2&gt; external(array&lt;Mat, 2&gt; &amp;edgeMat, Mat &amp;x, Mat &amp;y) {\n    array&lt;Mat, 2&gt; ext;\n    ext[0] = { Size{ 1, POINTS_NUM }, CV_32FC1 };\n    ext[1] = { Size{ 1, POINTS_NUM }, CV_32FC1 };\n\n    for (size_t i = 0; i &lt; POINTS_NUM; ++i) {\n        ext[0].at&lt;float&gt;(0, i) = - edgeMat[0].at&lt;short&gt;(y.at&lt;float&gt;(0, i), x.at&lt;float&gt;(0, i));\n        ext[1].at&lt;float&gt;(0, i) = - edgeMat[1].at&lt;short&gt;(y.at&lt;float&gt;(0, i), x.at&lt;float&gt;(0, i));\n    }\n\n    return ext;\n}\n</code></pre>\n\n<p>As you can see, the contour points converge in a very strange way and not towards the edge of the lip (that was the result I would expect).\nI am not able to understand if it is an error about implementation or about tuning the parameters or it is just is normal behaviour and I misunderstood something about the algorithm.\nI have some doubts on the derivative matrices, I think that they should be regularized in some way, but I am not sure which is the right one. Can someone help me?</p>\n\n<p>The only implementations I have found are of the greedy method.  </p>\n"}, {"tags": ["c++", "string", "visual-studio-2017"], "comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 1, "creation_date": 1528301338, "post_id": 50724893, "comment_id": 88458169, "body": "C or C++, chose either language. Your code is a horrible mixture."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1528301390, "post_id": 50724893, "comment_id": 88458199, "body": "1) Undefined behavior. <code>malloc</code> doesn&#39;t invoke constructors. Use <code>new</code> for memory allocation in C++. 2) How is this question related to C? C doesn&#39;t have <code>std::string</code>."}], "owner": {"reputation": 761, "user_id": 6386155, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-YUFMoRcx3uo/AAAAAAAAAAI/AAAAAAAAAAA/I9gNVrYQpDQ/photo.jpg?sz=128", "display_name": "user6386155", "link": "https://stackoverflow.com/users/6386155/user6386155"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1528301368, "answer_count": 0, "score": 0, "last_activity_date": 1528301377, "creation_date": 1528301137, "last_edit_date": 1528301377, "question_id": 50724893, "link": "https://stackoverflow.com/questions/50724893/string-assignment-behavior-in-vs2017", "closed_reason": "Duplicate", "title": "String assignment behavior in VS2017", "body": "<p>Consider following code snippet(mimicking whats going on in my very large project, using some C routines in C++ code)</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include \"stdafx.h\"\nstruct lName\n{\n       std::string name;\n};\n\nvoid lalloc( int *nloc, lName **tst)\n{\n       lName *tst1;\n       int bn = 2;\n       tst1 = (lName*)malloc(bn * sizeof(*tst1));\n       memset((void*)tst1, 0, bn * sizeof(*tst1));\n       *nloc = bn;\n       *tst = tst1;\n}\nvoid ltest()\n{\n       std::string fid = \"tst\";\n       lName *tst, *tst1;\n       int lsz;\n       lalloc(&amp;lsz, &amp;tst);\n       for (int j = 0; j &lt; lsz; ++j)\n       {\n              tst1 = &amp;tst[j];\n              tst1-&gt;name = fid;\n              std::cout &lt;&lt; \"fid : \" &lt;&lt; fid &lt;&lt; \" Name: \" &lt;&lt; tst1-&gt;name &lt;&lt; \"\\n\";\n       }\n}\n</code></pre>\n\n<p>In visual Studio 2017, the content of the <code>tst1-&gt;name</code> is garbage after the assignment (Its empty string prior to the assignment). However if I use <code>tst1-&gt;name = std::string(fid);</code>, it seems to work as expected (my understanding is that this line will create a temporary). Seems to work fine in VS2012 as well. Is there something here in the code not conforming? (The real code involves proper freeing of the memory etc)</p>\n"}, {"tags": ["c++", "cmake", "protocol-buffers", "ros"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1528300957, "post_id": 50724782, "comment_id": 88457965, "body": "I am pretty sure you will not be able to mix proto 2 and proto 3 in the same application."}, {"owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "edited": false, "score": 0, "creation_date": 1528301525, "post_id": 50724782, "comment_id": 88458274, "body": "Might possibly still work in the same ap if at least one module linked via shared lib (which would technically allow to use different versions of dependencies, together with &quot;-fvisibility=hidden&quot;), but likely not to work if everything linked statically."}], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 1, "last_activity_date": 1528301494, "creation_date": 1528301494, "answer_id": 50724985, "question_id": 50724782, "link": "https://stackoverflow.com/questions/50724782/trying-to-compile-code-with-references-to-both-protobuffers-2-6-1-and-3-4-1/50724985#50724985", "title": "Trying to compile code with references to both protobuffers 2.6.1 and 3.4.1", "body": "<p>You will find it possible to build a single executable that references 2 versions of the same library on mac, quite difficult on windows, and pretty much impossible on unix. This is because the symbol names are not distinct between the two libraries, so if you load both libraries, there is no way to know which library should service which call.</p>\n\n<p>If you are building 2 different executables in one makefile package, then you just need to set the right libraries to load in the link stage. In linux, libraries are usually installed on your system with a version-number suffix, and a symlink that publishes the latest version without the version number. Normally you simply link to the unsuffixed latest version, but in your case, in your link command you will need to explicitly add the suffix.</p>\n\n<p>If you really do need to link this cobble-together into a single executable, on unix you can do a lot with <code>objcopy --redefine-syms</code> to rename all the entrypoints in one of the libraries, and all the references in the dependant code all after compilation, but before linking. Note that the intended end result is that both libraries will run independently and will not be aware of each other.</p>\n"}, {"tags": [], "owner": {"reputation": 5258, "user_id": 1274747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2942e1483b9befa80a61cb98bce39d?s=128&d=identicon&r=PG", "display_name": "axalis", "link": "https://stackoverflow.com/users/1274747/axalis"}, "is_accepted": false, "score": 0, "last_activity_date": 1528302222, "creation_date": 1528302222, "answer_id": 50725203, "question_id": 50724782, "link": "https://stackoverflow.com/questions/50724782/trying-to-compile-code-with-references-to-both-protobuffers-2-6-1-and-3-4-1/50725203#50725203", "title": "Trying to compile code with references to both protobuffers 2.6.1 and 3.4.1", "body": "<p>If you will be able to wrap up at least one of the libs (i.e. either Cartographer or Rotors or both) into a separate shared library, and if the protobuff is only used internally in each of them, you still might be able to use them both in a single executable by building the shared libs with <code>-fvisibility=hidden</code> gcc flag (to switch the default visibility to hide symbols) and only exporting the symbols that are needed (that the app is using) via <code>__attribute__((visibility(\"default\")))</code>.</p>\n\n<p>This way I recall I was able to use two completely different Boost versions in the past, in the same app (by the shared lib not exporting the boost symbols linked in statically).</p>\n"}], "owner": {"reputation": 11, "user_id": 9904240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70f356e074c9a758825c2841cf8eef29?s=128&d=identicon&r=PG&f=1", "display_name": "jochemverboom", "link": "https://stackoverflow.com/users/9904240/jochemverboom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528302222, "creation_date": 1528300760, "question_id": 50724782, "link": "https://stackoverflow.com/questions/50724782/trying-to-compile-code-with-references-to-both-protobuffers-2-6-1-and-3-4-1", "title": "Trying to compile code with references to both protobuffers 2.6.1 and 3.4.1", "body": "<p>I am trying to compile a single codebase with references to both protobuffers 3.4.1 and 2.6.1. Now the 2.6.1 variant is globally defined as I am using ubuntu xenial, also: </p>\n\n<pre><code>$ protoc --version\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>libprotoc 2.6.1\n</code></pre>\n\n<p>The requirement for protobuffer version 3.4.1 comes from Google Cartographer (<a href=\"https://github.com/googlecartographer/cartographer\" rel=\"nofollow noreferrer\">https://github.com/googlecartographer/cartographer</a>) while the requirement for 2.6.1 comes from rotors simulator (<a href=\"https://github.com/ethz-asl/rotors_simulator\" rel=\"nofollow noreferrer\">https://github.com/ethz-asl/rotors_simulator</a>) as it relies on Gazebo-7 (which uses protobuffer 2.6.1). In order to compile Google Cartographer I have added the binaries (added them in a proto3 folder, see below) to the installation by adapting the CMakeList.txt (see original file here: <a href=\"https://raw.githubusercontent.com/googlecartographer/cartographer/master/CMakeLists.txt\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/googlecartographer/cartographer/master/CMakeLists.txt</a>) for Google Cartographer by adding the following lines:</p>\n\n<pre><code>set(CMAKE_PREFIX_PATH CMAKE_PREFIX_PATH \"${CMAKE_SOURCE_DIR}/proto3\")\n...\ninstall(DIRECTORY proto3/ DESTINATION .)\n</code></pre>\n\n<p>So the binaries of the protobuffer 3.4.1 are added to the install folder. I am utilizing catkin-tools (<a href=\"https://catkin-tools.readthedocs.io/en/latest/\" rel=\"nofollow noreferrer\">https://catkin-tools.readthedocs.io/en/latest/</a>) to build the whole workspace. Now in a CMakelist.txt for Rotors Simulator I have the following line:</p>\n\n<pre><code>find_package(Protobuf 2.6.1 REQUIRED HINTS \"/usr\")\n</code></pre>\n\n<p>But at the moment while trying to compile it does not seem to be able to find the protobuffer 2.4.1 as it returns the following:</p>\n\n<pre><code>Could not find a configuration file for package \"Protobuf\" that is\ncompatible with requested version \"2.6.1\".\n\nThe following configuration files were considered but not accepted:\n\n/home/jochem/catkin_ws/install/lib/cmake/protobuf/protobuf-config.cmake, \nversion: 3.4.1\n</code></pre>\n\n<p>As a side-note, if I compile the packages separately I am able to compile and install the packages. This is done with the following commands:</p>\n\n<pre><code> catkin build cartographer_ros \n</code></pre>\n\n<p>and </p>\n\n<pre><code> catkin build rotors_gazebo_plugins\n</code></pre>\n\n<p>I am at the moment trying to adapt the package of rotors_gazebo_plugins but am so far unsuccessful at making sure the correct protobuffer library is selected, am I missing something by defining references to a local protobuffer version?</p>\n"}, {"tags": ["c++", "c", "windows", "winapi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 3, "creation_date": 1528301043, "post_id": 50724768, "comment_id": 88458022, "body": "Windows have an invisible border around them for the drop shadow."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 7, "creation_date": 1528301797, "post_id": 50724768, "comment_id": 88458397, "body": "You are not doing anything wrong. That&#39;s specific to Windows 10, parts of the window&#39;s non-client area are transparent. See also <a href=\"https://stackoverflow.com/questions/34139450\">stackoverflow.com/questions/34139450</a>"}], "owner": {"reputation": 1721, "user_id": 941831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZdiGx.jpg?s=128&g=1", "display_name": "Gediminas", "link": "https://stackoverflow.com/users/941831/gediminas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528300728, "creation_date": 1528300728, "question_id": 50724768, "link": "https://stackoverflow.com/questions/50724768/createwindowex-invalid-x-position-once-created", "title": "CreateWindowEx invalid X position once created", "body": "<p>I've noticed that once a window is created using \"CreateWindowEx\" with <strong>x=0, y=0</strong> position coordinates, window does not appear to be located in the the 0,0 corner of the screen. Instead it appears at the <strong>x=<em>9</em>, y=0</strong>.</p>\n\n<ul>\n<li>I'm using a single monitor. </li>\n<li>I'm not modyfing it's position anywhere else. </li>\n<li>Window is created as an overlapped parent window.</li>\n<li>When window is created, WM_MOVE get's called with x=8, y=31. (Those are \"client-area\" coordinates)</li>\n</ul>\n\n<p><em>(It's a bit strange that WM_MOVE y coordinate is 31px but in the screenshot you can see that it should be ~38px...)</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/korF5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/korF5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Window is created by:</p>\n\n<pre><code>mHandle = ::CreateWindowEx(WS_EX_APPWINDOW, CLASS_NAME, APP_NAME, WS_OVERLAPPEDWINDOW, 0, 0, mWidth, mHeight, HWND_DESKTOP, nullptr, mInstance, this);\n</code></pre>\n\n<p>Any ideas on what I might be doing wrong? What might be the reason?</p>\n"}, {"tags": ["c++", "c++11", "reference", "lifetime", "const-reference"], "comments": [{"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1528298973, "post_id": 50724163, "comment_id": 88456708, "body": "I mean... throw it in the compiler and see what it says?"}, {"owner": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1528299046, "post_id": 50724163, "comment_id": 88456755, "body": "It works correct, but for mee it seems v and v2 variable catch references for temporary value that mean lead to SEGFAULT"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1528299210, "post_id": 50724163, "comment_id": 88456859, "body": "<a href=\"https://stackoverflow.com/questions/23063211/why-does-most-important-const-have-to-be-const\" title=\"why does most important const have to be const\">stackoverflow.com/questions/23063211/&hellip;</a>"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 2, "creation_date": 1528299226, "post_id": 50724163, "comment_id": 88456872, "body": "Binding a temporary to a const reference extends the lifetime of the temporary to the lifetime of the reference."}], "answers": [{"comments": [{"owner": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "edited": false, "score": 0, "creation_date": 1528299698, "post_id": 50724242, "comment_id": 88457180, "body": "So, the expression like <code>auto v&amp; = (1 - 2)</code> also will correct, will it?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "reply_to_user": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "edited": false, "score": 1, "creation_date": 1528299777, "post_id": 50724242, "comment_id": 88457234, "body": "@voltento, no, it has to be a const reference."}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "reply_to_user": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "edited": false, "score": 1, "creation_date": 1528299801, "post_id": 50724242, "comment_id": 88457251, "body": "@voltento If you actually meant <code>auto&amp; v = (1 - 2);</code> then no. You can&#39;t bind a temporary to a non-const reference. It must be const. So <code>const auto&amp; v = (1 - 2);</code> would work."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1528300011, "post_id": 50724242, "comment_id": 88457381, "body": "Note that <code>auto &amp;&amp; v = (1 - 2)</code> would be also fine in C++11."}], "tags": [], "owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "is_accepted": true, "score": 3, "last_activity_date": 1528299455, "last_edit_date": 1528299455, "creation_date": 1528299111, "answer_id": 50724242, "question_id": 50724163, "link": "https://stackoverflow.com/questions/50724163/reference-for-rvalue-or-not/50724242#50724242", "title": "Reference for rvalue or not", "body": "<p>Yes, <a href=\"http://coliru.stacked-crooked.com/a/b19bc453552cf696\" rel=\"nofollow noreferrer\">this works fine</a> and its behavior is defined.</p>\n\n<pre><code>const auto&amp; v = foo();\n</code></pre>\n\n<p>This binds a temporary to a reference.  The lifetime of the temporary will be extended to match the lifetime of <code>v</code>.  (Binding temporaries to const references was supported in C++03 even, before rvalue references were a thing.)</p>\n\n<pre><code>const auto&amp; v2 = v;\n</code></pre>\n\n<p>This just takes another reference to the same object.  It's basically a no-op that will be eliminated during compilation.  As long as <code>v2</code> doesn't outlive <code>v</code> (which it doesn't in this case) then there is no problem.</p>\n"}], "owner": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 50724242, "answer_count": 1, "score": 1, "last_activity_date": 1528299491, "creation_date": 1528298879, "last_edit_date": 1528299491, "question_id": 50724163, "link": "https://stackoverflow.com/questions/50724163/reference-for-rvalue-or-not", "title": "Reference for rvalue or not", "body": "<p>I wonder will next code work correct with v and v2 variable or these are references for temporary variables? In other words, can I capture returned rvalue by reference? I think no, but my teamlead think another way.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Foo {\n  Foo(Foo&amp;&amp;) = delete;\n  Foo&amp; operator=(Foo&amp;&amp;) = delete;\n\n  Foo() {\n    std::cout &lt;&lt; \"Constructor\" &lt;&lt;std::endl;\n  }\n  Foo(const Foo&amp;) {\n    std::cout &lt;&lt; \"Copy Constructor\" &lt;&lt;std::endl;\n  }\n  Foo&amp; operator=(const Foo&amp;) {\n    std::cout &lt;&lt; \"Copy  = Constructor\" &lt;&lt;std::endl;\n    return *this;\n  }\n  ~Foo() {\n    std::cout &lt;&lt; \"Destructor\" &lt;&lt;std::endl;\n  }\n};\n\nFoo foo() {\n  Foo v;\n  return v;\n}\n\nint main() {\n  const auto&amp; v = foo();\n  const auto&amp; v2 = v;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "build", "cmake", "zlib"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1528300641, "post_id": 50724148, "comment_id": 88457774, "body": "You repeat <code>add_subdirectory(zlib-1.2.11)</code> call multiple times, and CMake complains about that. What about calling this only <b>once</b>?"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 6618562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f4d7da41244c1db116059e11aa6fbdd?s=128&d=identicon&r=PG&f=1", "display_name": "arun", "link": "https://stackoverflow.com/users/6618562/arun"}, "is_accepted": false, "score": 2, "last_activity_date": 1528359912, "last_edit_date": 1528359912, "creation_date": 1528359578, "answer_id": 50736239, "question_id": 50724148, "link": "https://stackoverflow.com/questions/50724148/altering-a-cmake-file-to-compile-dependency-from-source-instead-of-using-find-pa/50736239#50736239", "title": "Altering a Cmake File to compile Dependency from Source instead of using FIND_PACKAGE", "body": "<p>This is how, I add zlib to my project,</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.0) \n\nproject (simple) \n\nSET(SIMPLE_EXAMPLE main.cpp) \n##Since your zlib folder is named as \"zlib-1.2.11\"\nset(ENV{PATH} \"${CMAKE_SOURCE_DIR}/zlib-1.2.11\")\n\nset(ZLIB_LIBRARY \"${CMAKE_SOURCE_DIR}/zlib-1.2.11\" ) \n\nadd_subdirectory (zlib-1.2.11)     \n\nADD_EXECUTABLE (simple ${SIMPLE_EXAMPLE}) \n\nTARGET_LINK_LIBRARIES(simple zlib)\n</code></pre>\n\n<p>In your code, <code>TARGET_LINK_LIBRARIES(xlsxio_read_${LINKTYPE} zlib-1.2.11 ${EXPAT_LIBRARIES})</code>\nreplace <code>zlib-1.2.11</code> with it with <code>zlib</code> or <code>zlibstatic</code> based on whether it is static or dynamic library.</p>\n\n<p><code>add_subdirectory (zlib-1.2.11)</code> should be done once. Preferably at the beginning of project declaration.\nThis will internally call the <code>CMakeLists.txt</code> inside <code>zlib-1.2.11</code> folder and build libraries which you can link in <code>TARGET_LINK_LIBRARIES</code>\nHope it helps. </p>\n"}], "owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1528359912, "creation_date": 1528298830, "question_id": 50724148, "link": "https://stackoverflow.com/questions/50724148/altering-a-cmake-file-to-compile-dependency-from-source-instead-of-using-find-pa", "title": "Altering a Cmake File to compile Dependency from Source instead of using FIND_PACKAGE", "body": "<p>I am trying to compile a library called <a href=\"https://github.com/brechtsanders/xlsxio/issues/26\" rel=\"nofollow noreferrer\">xlsxio</a> using Cmake. The Cmake file uses the <code>FIND_PACKAGE</code> command for Zlib (or miniz).</p>\n\n<p>Instead, I want to place the Zlib source as a subdirectory and compile from source, but I am unable to alter the xlsxio Cmake file sufficiently to make this work.</p>\n\n<p>I have the xlsxio repo, and into this I have placed a subdirectory <code>zlib-1.2.11</code>.</p>\n\n<p>The original xlsxio Cmake file is:</p>\n\n<pre><code>CMAKE_MINIMUM_REQUIRED(VERSION 2.6)\nPROJECT(xlsxio)\n\n# parameters\nOPTION(BUILD_STATIC \"Build static libraries\" ON)\nOPTION(BUILD_SHARED \"Build shared libraries\" ON)\nOPTION(BUILD_TOOLS \"Build tools\" ON)\nOPTION(BUILD_EXAMPLES \"Build examples\" ON)\nOPTION(WITH_LIBZIP \"Use libzip instead of Minizip\" OFF)\nOPTION(WITH_WIDE \"Also build UTF-16 library (libxlsxio_readw)\" OFF)\n\n# conditions\nIF(NOT BUILD_STATIC AND NOT BUILD_SHARED)\n  MESSAGE(FATAL_ERROR \"Cannot build with both BUILD_STATIC and BUILD_SHARED disabled\")\nENDIF()\n\n# dependancies\nSET(CMAKE_MODULE_PATH \"${CMAKE_CURRENT_SOURCE_DIR}/CMake\" ${CMAKE_MODULE_PATH})\nIF(WITH_LIBZIP)\nFIND_PACKAGE(LibZip REQUIRED)\nSET(ANYZIP_INCLUDE_DIRS ${LIBZIP_INCLUDE_DIRS})\nSET(ANYZIP_LIBRARIES ${LIBZIP_LIBRARIES})\nSET(ANYZIP_DEF USE_LIBZIP)\nELSE()\nFIND_PACKAGE(Minizip REQUIRED)\nSET(ANYZIP_INCLUDE_DIRS ${MINIZIP_INCLUDE_DIRS})\nSET(ANYZIP_LIBRARIES ${MINIZIP_LIBRARIES})\nSET(ANYZIP_DEF USE_MINIZIP)\nENDIF()\nFIND_PACKAGE(EXPAT REQUIRED)\nIF(WITH_WIDE)\nFIND_LIBRARY(EXPATW_LIBRARY NAMES expatw)\nENDIF()\nFIND_PACKAGE(Doxygen)\n\n# build parameters\nOPTION(BUILD_DOCUMENTATION \"Create and install API documentation (requires Doxygen)\" ${DOXYGEN_FOUND})\n#SET(CMAKE_CXX_FLAGS \"-g -Wall\")\n#ADD_SUBDIRECTORY(src)\n\nIF(NOT WIN32 AND NOT APPLE)\n  SET(THREADLIB \"-pthread\")\nENDIF()\n\nINCLUDE_DIRECTORIES(include)\nINCLUDE_DIRECTORIES(${ANYZIP_INCLUDE_DIRS})\nINCLUDE_DIRECTORIES(${EXPAT_INCLUDE_DIRS})\n\n# build definitions\nSET(ALLTARGETS)\nSET(LINKTYPES)\nIF(BUILD_STATIC)\n  LIST(APPEND LINKTYPES \"STATIC\")\nENDIF()\nIF(BUILD_SHARED)\n  LIST(APPEND LINKTYPES \"SHARED\")\nENDIF()\n\nFOREACH(LINKTYPE ${LINKTYPES})\n  ADD_LIBRARY(xlsxio_read_${LINKTYPE} ${LINKTYPE} lib/xlsxio_read.c lib/xlsxio_read_sharedstrings.c)\n  SET_TARGET_PROPERTIES(xlsxio_read_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n  SET_TARGET_PROPERTIES(xlsxio_read_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"BUILD_XLSXIO;${ANYZIP_DEF}\")\n  SET_TARGET_PROPERTIES(xlsxio_read_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_read)\n  TARGET_INCLUDE_DIRECTORIES(xlsxio_read_${LINKTYPE} PRIVATE lib)\n  TARGET_LINK_LIBRARIES(xlsxio_read_${LINKTYPE} ${ANYZIP_LIBRARIES} ${EXPAT_LIBRARIES})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_read_${LINKTYPE})\n\n  ADD_LIBRARY(xlsxio_write_${LINKTYPE} ${LINKTYPE} lib/xlsxio_write.c)\n  SET_TARGET_PROPERTIES(xlsxio_write_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n  SET_TARGET_PROPERTIES(xlsxio_write_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"BUILD_XLSXIO;${ANYZIP_DEF}\")\n  SET_TARGET_PROPERTIES(xlsxio_write_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_write)\n  TARGET_LINK_LIBRARIES(xlsxio_write_${LINKTYPE} ${ANYZIP_LIBRARIES} ${THREADLIB})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_write_${LINKTYPE})\n\n  IF(WITH_WIDE)\n    ADD_LIBRARY(xlsxio_readw_${LINKTYPE} ${LINKTYPE} lib/xlsxio_read.c lib/xlsxio_read_sharedstrings.c)\n    SET_TARGET_PROPERTIES(xlsxio_readw_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n    SET_TARGET_PROPERTIES(xlsxio_readw_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"XML_UNICODE;BUILD_XLSXIO;${ANYZIP_DEF}\")\n    SET_TARGET_PROPERTIES(xlsxio_readw_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_readw)\n    TARGET_INCLUDE_DIRECTORIES(xlsxio_readw_${LINKTYPE} PRIVATE lib)\n    TARGET_LINK_LIBRARIES(xlsxio_readw_${LINKTYPE} ${ANYZIP_LIBRARIES} ${EXPATW_LIBRARY})\n    SET(ALLTARGETS ${ALLTARGETS} xlsxio_readw_${LINKTYPE})\n\n    #ADD_LIBRARY(xlsxio_writew_${LINKTYPE} ${LINKTYPE} lib/xlsxio_write.c)\n    #SET_TARGET_PROPERTIES(xlsxio_writew_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n    #SET_TARGET_PROPERTIES(xlsxio_writew_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"XML_UNICODE;BUILD_XLSXIO;${ANYZIP_DEF}\")\n    #SET_TARGET_PROPERTIES(xlsxio_writew_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_write_w)\n    #TARGET_LINK_LIBRARIES(xlsxio_writew_${LINKTYPE} ${ANYZIP_LIBRARIES} ${THREADLIB})\n    #SET(ALLTARGETS ${ALLTARGETS} xlsxio_writew_${LINKTYPE})\n  ENDIF()\n\n  SET(EXELINKTYPE ${LINKTYPE})\nENDFOREACH()\n\nIF(BUILD_TOOLS)\n  ADD_EXECUTABLE(xlsxio_xlsx2csv src/xlsxio_xlsx2csv.c)\n  TARGET_LINK_LIBRARIES(xlsxio_xlsx2csv xlsxio_read_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_xlsx2csv)\n\n  ADD_EXECUTABLE(xlsxio_csv2xlsx src/xlsxio_csv2xlsx.c)\n  TARGET_LINK_LIBRARIES(xlsxio_csv2xlsx xlsxio_write_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_csv2xlsx)\nENDIF()\n\nIF(BUILD_EXAMPLES)\n  ADD_EXECUTABLE(example_xlsxio_write_getversion examples/example_xlsxio_write_getversion.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_write_getversion xlsxio_write_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_write_getversion)\n\n  ADD_EXECUTABLE(example_xlsxio_write examples/example_xlsxio_write.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_write xlsxio_write_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_write)\n\n  ADD_EXECUTABLE(example_xlsxio_read examples/example_xlsxio_read.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_read xlsxio_read_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_read)\n\n  ADD_EXECUTABLE(example_xlsxio_read_advanced examples/example_xlsxio_read_advanced.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_read_advanced xlsxio_read_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_read_advanced)\n\n  IF(WITH_WIDE)\n    ADD_EXECUTABLE(example_xlsxio_readw examples/example_xlsxio_read.c)\n    SET_TARGET_PROPERTIES(example_xlsxio_readw PROPERTIES COMPILE_DEFINITIONS \"XML_UNICODE\")\n    TARGET_LINK_LIBRARIES(example_xlsxio_readw xlsxio_readw_${EXELINKTYPE})\n    SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_readw)\n  ENDIF()\nENDIF()\n\nIF(BUILD_DOCUMENTATION)\n  IF(NOT DOXYGEN_FOUND)\n    MESSAGE(FATAL_ERROR \"Doxygen is needed to build the documentation.\")\n  ENDIF()\n  ADD_CUSTOM_TARGET(doc ALL\n    COMMAND ${DOXYGEN_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/doc/Doxyfile\n    #WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}\n    WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}\n    COMMENT \"Generating API documentation with Doxygen\"\n    VERBATIM\n  )\n  INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/doc/man\n    DESTINATION .\n  )\n  #INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/doc/html\n  #  DESTINATION share/doc\n  #)\nENDIF()\n\n# install definitions\nINSTALL(TARGETS ${ALLTARGETS}\n  ARCHIVE DESTINATION lib\n  LIBRARY DESTINATION lib\n  RUNTIME DESTINATION bin\n)\nINSTALL(DIRECTORY include/\n  DESTINATION include \n  FILES_MATCHING PATTERN \"xlsxio*.h\"\n)\n</code></pre>\n\n<p>I have altered this to:</p>\n\n<pre><code>CMAKE_MINIMUM_REQUIRED(VERSION 3.0)\nPROJECT(xlsxio)\n\n# parameters\nOPTION(BUILD_STATIC \"Build static libraries\" ON)\nOPTION(BUILD_SHARED \"Build shared libraries\" OFF)\nOPTION(BUILD_TOOLS \"Build tools\" ON)\nOPTION(BUILD_EXAMPLES \"Build examples\" OFF)\nOPTION(WITH_LIBZIP \"Use libzip instead of Minizip\" ON)\nOPTION(WITH_WIDE \"Also build UTF-16 library (libxlsxio_readw)\" OFF)\n\n# conditions\nIF(NOT BUILD_STATIC AND NOT BUILD_SHARED)\n  MESSAGE(FATAL_ERROR \"Cannot build with both BUILD_STATIC and BUILD_SHARED disabled\")\nENDIF()\n\n# dependancies\nSET(CMAKE_MODULE_PATH \"${CMAKE_CURRENT_SOURCE_DIR}/CMake\" ${CMAKE_MODULE_PATH})\n\nSET(ANYZIP_INCLUDE_DIRS zlib-1.2.11)\nSET(ANYZIP_LIBRARIES zlib-1.2.11)\nSET(ANYZIP_DEF USE_LIBZIP)\n\nFIND_PACKAGE(EXPAT REQUIRED)\nIF(WITH_WIDE)\nFIND_LIBRARY(EXPATW_LIBRARY NAMES expatw)\nENDIF()\nFIND_PACKAGE(Doxygen)\n\n# build parameters\nOPTION(BUILD_DOCUMENTATION \"Create and install API documentation (requires Doxygen)\" ${DOXYGEN_FOUND})\n#SET(CMAKE_CXX_FLAGS \"-g -Wall\")\n#ADD_SUBDIRECTORY(src)\n\nIF(NOT WIN32 AND NOT APPLE)\n  SET(THREADLIB \"-pthread\")\nENDIF()\n\nINCLUDE_DIRECTORIES(include)\nINCLUDE_DIRECTORIES(${ANYZIP_INCLUDE_DIRS})\nINCLUDE_DIRECTORIES(${EXPAT_INCLUDE_DIRS})\n\n# build definitions\nSET(ALLTARGETS)\nSET(LINKTYPES)\nIF(BUILD_STATIC)\n  LIST(APPEND LINKTYPES \"STATIC\")\nENDIF()\nIF(BUILD_SHARED)\n  LIST(APPEND LINKTYPES \"SHARED\")\nENDIF()\n\nFOREACH(LINKTYPE ${LINKTYPES})\n  ADD_LIBRARY(xlsxio_read_${LINKTYPE} ${LINKTYPE} lib/xlsxio_read.c lib/xlsxio_read_sharedstrings.c)\n  SET_TARGET_PROPERTIES(xlsxio_read_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n  SET_TARGET_PROPERTIES(xlsxio_read_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"BUILD_XLSXIO;${ANYZIP_DEF}\")\n  SET_TARGET_PROPERTIES(xlsxio_read_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_read)\n  TARGET_INCLUDE_DIRECTORIES(xlsxio_read_${LINKTYPE} PRIVATE lib)\n  add_subdirectory(zlib-1.2.11)\n  TARGET_LINK_LIBRARIES(xlsxio_read_${LINKTYPE} zlib-1.2.11 ${EXPAT_LIBRARIES})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_read_${LINKTYPE})\n\n  ADD_LIBRARY(xlsxio_write_${LINKTYPE} ${LINKTYPE} lib/xlsxio_write.c)\n  SET_TARGET_PROPERTIES(xlsxio_write_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n  SET_TARGET_PROPERTIES(xlsxio_write_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"BUILD_XLSXIO;${ANYZIP_DEF}\")\n  SET_TARGET_PROPERTIES(xlsxio_write_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_write)\n  add_subdirectory(zlib-1.2.11)\n  TARGET_LINK_LIBRARIES(xlsxio_write_${LINKTYPE} ${ANYZIP_LIBRARIES} ${THREADLIB})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_write_${LINKTYPE})\n\n  IF(WITH_WIDE)\n    ADD_LIBRARY(xlsxio_readw_${LINKTYPE} ${LINKTYPE} lib/xlsxio_read.c lib/xlsxio_read_sharedstrings.c)\n    SET_TARGET_PROPERTIES(xlsxio_readw_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n    SET_TARGET_PROPERTIES(xlsxio_readw_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"XML_UNICODE;BUILD_XLSXIO;${ANYZIP_DEF}\")\n    SET_TARGET_PROPERTIES(xlsxio_readw_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_readw)\n    TARGET_INCLUDE_DIRECTORIES(xlsxio_readw_${LINKTYPE} PRIVATE lib)\n    add_subdirectory(zlib-1.2.11)\n    TARGET_LINK_LIBRARIES(xlsxio_readw_${LINKTYPE} ${ANYZIP_LIBRARIES} ${EXPATW_LIBRARY})\n    SET(ALLTARGETS ${ALLTARGETS} xlsxio_readw_${LINKTYPE})\n\n    #ADD_LIBRARY(xlsxio_writew_${LINKTYPE} ${LINKTYPE} lib/xlsxio_write.c)\n    #SET_TARGET_PROPERTIES(xlsxio_writew_${LINKTYPE} PROPERTIES DEFINE_SYMBOL \"BUILD_XLSXIO_DLL\")\n    #SET_TARGET_PROPERTIES(xlsxio_writew_${LINKTYPE} PROPERTIES COMPILE_DEFINITIONS \"XML_UNICODE;BUILD_XLSXIO;${ANYZIP_DEF}\")\n    #SET_TARGET_PROPERTIES(xlsxio_writew_${LINKTYPE} PROPERTIES OUTPUT_NAME xlsxio_write_w)\n    #TARGET_LINK_LIBRARIES(xlsxio_writew_${LINKTYPE} ${ANYZIP_LIBRARIES} ${THREADLIB})\n    #SET(ALLTARGETS ${ALLTARGETS} xlsxio_writew_${LINKTYPE})\n  ENDIF()\n\n  SET(EXELINKTYPE ${LINKTYPE})\nENDFOREACH()\n\nIF(BUILD_TOOLS)\n  ADD_EXECUTABLE(xlsxio_xlsx2csv src/xlsxio_xlsx2csv.c)\n  TARGET_LINK_LIBRARIES(xlsxio_xlsx2csv xlsxio_read_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_xlsx2csv)\n\n  ADD_EXECUTABLE(xlsxio_csv2xlsx src/xlsxio_csv2xlsx.c)\n  TARGET_LINK_LIBRARIES(xlsxio_csv2xlsx xlsxio_write_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} xlsxio_csv2xlsx)\nENDIF()\n\nIF(BUILD_EXAMPLES)\n  ADD_EXECUTABLE(example_xlsxio_write_getversion examples/example_xlsxio_write_getversion.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_write_getversion xlsxio_write_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_write_getversion)\n\n  ADD_EXECUTABLE(example_xlsxio_write examples/example_xlsxio_write.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_write xlsxio_write_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_write)\n\n  ADD_EXECUTABLE(example_xlsxio_read examples/example_xlsxio_read.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_read xlsxio_read_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_read)\n\n  ADD_EXECUTABLE(example_xlsxio_read_advanced examples/example_xlsxio_read_advanced.c)\n  TARGET_LINK_LIBRARIES(example_xlsxio_read_advanced xlsxio_read_${EXELINKTYPE})\n  SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_read_advanced)\n\n  IF(WITH_WIDE)\n    ADD_EXECUTABLE(example_xlsxio_readw examples/example_xlsxio_read.c)\n    SET_TARGET_PROPERTIES(example_xlsxio_readw PROPERTIES COMPILE_DEFINITIONS \"XML_UNICODE\")\n    TARGET_LINK_LIBRARIES(example_xlsxio_readw xlsxio_readw_${EXELINKTYPE})\n    SET(ALLTARGETS ${ALLTARGETS} example_xlsxio_readw)\n  ENDIF()\nENDIF()\n\nIF(BUILD_DOCUMENTATION)\n  IF(NOT DOXYGEN_FOUND)\n    MESSAGE(FATAL_ERROR \"Doxygen is needed to build the documentation.\")\n  ENDIF()\n  ADD_CUSTOM_TARGET(doc ALL\n    COMMAND ${DOXYGEN_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/doc/Doxyfile\n    #WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}\n    WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}\n    COMMENT \"Generating API documentation with Doxygen\"\n    VERBATIM\n  )\n  INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/doc/man\n    DESTINATION .\n  )\n  #INSTALL(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/doc/html\n  #  DESTINATION share/doc\n  #)\nENDIF()\n\n# install definitions\nINSTALL(TARGETS ${ALLTARGETS}\n  ARCHIVE DESTINATION lib\n  LIBRARY DESTINATION lib\n  RUNTIME DESTINATION bin\n)\nINSTALL(DIRECTORY include/\n  DESTINATION include \n  FILES_MATCHING PATTERN \"xlsxio*.h\"\n)\n</code></pre>\n\n<p>Cmake complains:</p>\n\n<pre><code>CMake Error at CMakeLists.txt:78 (add_subdirectory):\n      The binary directory\n\n        /Users/x/Documents/repos/xlsx-test/xlsxio/cmake-build-debug/zlib-1.2.11\n\n      is already used to build a source directory.  It cannot be used to build\n      source directory\n\n        /Users/x/Documents/repos/xlsx-test/xlsxio/zlib-1.2.11\n\n      Specify a unique binary directory name.\n</code></pre>\n\n<p>I have spent several hours trying many different approaches without success. Any help would be appreciated. A working Cmake file would be a Godsend. I can use a higher minimum Cmake version if that helps.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 5, "creation_date": 1528298861, "post_id": 50724105, "comment_id": 88456629, "body": "<i>I have a list (or vector) of objects, all casted to their parent type</i>. That&#39;s a problem in C++. Your code suffers from <a href=\"https://stackoverflow.com/questions/274626/what-is-object-slicing\">object slicing</a>. Use a <code>std::vector&lt;shared_ptr&lt;IComponent*&gt;&gt;</code> instead."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1528298862, "post_id": 50724105, "comment_id": 88456630, "body": "<a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list/388282#388282\">Get a couple of good C++ books</a> and start reading. Of special interest for this problem, read about <i>pointers</i>, <i>polymophism</i> and <i>virtual functions</i>."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 3, "creation_date": 1528299026, "post_id": 50724105, "comment_id": 88456745, "body": "In C++, runtime polymorphism is based on pointers. You need vector/list of pointers of type <code>IComponent*</code> (or unique/shared pointers) and then store pointers to instances of inherited classes. Via these pointers, you can then call virtual methods such as <code>ComponentMask</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1528299960, "post_id": 50724105, "comment_id": 88457341, "body": "Correction to my previous comment. Use a <code>std::vector&lt;shared_ptr&lt;IComponent&gt;&gt;</code> instead."}, {"owner": {"reputation": 69, "user_id": 6277854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5361b5577f59ce03c2c6b877cdbcace?s=128&d=identicon&r=PG&f=1", "display_name": "Naglfar705", "link": "https://stackoverflow.com/users/6277854/naglfar705"}, "edited": false, "score": 2, "creation_date": 1528302977, "post_id": 50724105, "comment_id": 88458994, "body": "Thank you for your speedy responses, they were very helpful and helped me fix my problem and also made me learn something in the process."}], "answers": [{"tags": [], "owner": {"reputation": 295, "user_id": 9911093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f993fb65fe7902f2f75f9f420b705b3b?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9911093/j-doe"}, "is_accepted": false, "score": 0, "last_activity_date": 1528430615, "creation_date": 1528430615, "answer_id": 50753192, "question_id": 50724105, "link": "https://stackoverflow.com/questions/50724105/c-calling-child-method-from-parent-type-without-knowing-child-type/50753192#50753192", "title": "C++ Calling child method from parent type without knowing child type", "body": "<p>The OP has already figured it out, so this is for anyone else coming across this question.</p>\n\n<p>In C++, you can declare <code>virtual</code> methods (you can also declare <em>pure</em> virtual methods, but that's a bit more complex). These methods can be overwritten by child classes, but <em>must</em> be implemented them selves as well, or you'll get some <a href=\"https://stackoverflow.com/questions/23255256/undefined-reference-to-vtable-for-class-constructor\">cryptic errors</a>.</p>\n\n<p>If you want them to do nothing by default, the easiest solution is to just define them with an empty body. Here's a simple example:</p>\n\n<pre><code>class ParentClass\n{\n    int x, y;\n    virtual void handleNewPos(int newX, int newY){}\n\npublic:\n    ParentClass(int x, int y)\n    {\n        resetPos(x, y);\n    }\n\n    void resetPos(int newX, int newY)\n    {\n        handleNewPos(newX, newY);\n        x = newX;\n        y = newY;\n    }\n}\n\nclass ChildClass: public ParentClass\n{\n    // marked 'override' because it's replacing a previous virtual method that had the same\n    // return type / params. Not required, but if you're using C++11 or greater, than it's\n    // preferred \n    virtual void handleNewPos(int newX, int newY) override\n    {\n        // Every time the resetPos method is called, it prints out it's new position.\n        std::cout &lt;&lt; \"New Position: \" &lt;&lt; newX &lt;&lt; \", \" &lt;&lt; newY &lt;&lt; std::endl;\n    }      \n\npublic:\n    ChildClass(int x, int y): ParentClass(x, y) {}                                          \n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6277854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5361b5577f59ce03c2c6b877cdbcace?s=128&d=identicon&r=PG&f=1", "display_name": "Naglfar705", "link": "https://stackoverflow.com/users/6277854/naglfar705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528430615, "creation_date": 1528298684, "question_id": 50724105, "link": "https://stackoverflow.com/questions/50724105/c-calling-child-method-from-parent-type-without-knowing-child-type", "title": "C++ Calling child method from parent type without knowing child type", "body": "<p>I am trying to convert a project from c# to c++ and have come across a piece of functionality I am not sure on how to implement in c++.</p>\n\n<p>I have a list (or vector) of objects, all casted to their parent type. In c# I can call a function from an object in this list without knowing the child and the appropriate child function will be called, however I am not sure how to make this certain functionality work in c++.</p>\n\n<p>Code snippet from C#:</p>\n\n<pre><code>        public void AddComponent(IComponent component)\n    {\n        Debug.Assert(component != null, \"Component must not be null\");\n\n        componentList.Add(component);\n        mask |= component.ComponentMask;\n    }\n</code></pre>\n\n<p>Retrieves the ComponentMask enum value from the Component and performs bitwise operation correctly.</p>\n\n<p>Code snippet from C++:</p>\n\n<pre><code>void oEntity::AddComponent(IComponent &amp;componentIn)\n{\n    componentList.push_back(componentIn);\n    mask |= componentIn.ComponentMask();\n}\n</code></pre>\n\n<p>This returns the error \"IComponent cannot instantiate abstract class\", if I remove the brackets from the method the operator overload no longer works and throws the error \"binary '|=': no operator found which takes a right-hand operand of type 'overloaded-function' (or there is no acceptable conversion)\"</p>\n\n<p>The mask value is an enum that contains bit shifted ints used as a flag to identify the component type. Operator has also been overloaded appropriately to work with the enum type.</p>\n"}, {"tags": ["c++", "stdoptional"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1528298468, "post_id": 50723966, "comment_id": 88456343, "body": "How about overloading <code>operator&lt;&lt;</code> with <code>std::optional&lt;Card&gt;</code>?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1528298487, "post_id": 50723966, "comment_id": 88456362, "body": "Perhaps provide a free function <code>std::ostream &amp; operator&lt;&lt;(std::ostream&amp;, const std::optional&lt;Card&gt;&amp;)</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1528298589, "post_id": 50723966, "comment_id": 88456429, "body": "Something like <code>my_optional_visit(cardDeck.drawCard(), [](const Card&amp;c){ std::cout &lt;&lt; c; }, [](){ std::cout &lt;&lt; &quot;Out of Cards!&quot; });</code>."}, {"owner": {"reputation": 107, "user_id": 7585641, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5IupbxWJqkk/AAAAAAAAAAI/AAAAAAAAAAc/q06VO-yo2pI/photo.jpg?sz=128", "display_name": "Thomas Eberhard", "link": "https://stackoverflow.com/users/7585641/thomas-eberhard"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528298795, "post_id": 50723966, "comment_id": 88456573, "body": "@Jarod42 could you elaborate?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 7585641, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5IupbxWJqkk/AAAAAAAAAAI/AAAAAAAAAAc/q06VO-yo2pI/photo.jpg?sz=128", "display_name": "Thomas Eberhard", "link": "https://stackoverflow.com/users/7585641/thomas-eberhard"}, "edited": false, "score": 0, "creation_date": 1528299145, "post_id": 50724125, "comment_id": 88456816, "body": "The only concern I would voice is the loss of flexibility. In more modern languages the string could be adapted to the respective situation. e.g. <code>std::cout&lt;&lt;cardDeck.drawCard().value_or(&quot;Damn thief, give me my cards back!&quot;);</code>."}, {"owner": {"reputation": 10545, "user_id": 238902, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BRFti.png?s=128&g=1", "display_name": "Default", "link": "https://stackoverflow.com/users/238902/default"}, "reply_to_user": {"reputation": 107, "user_id": 7585641, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5IupbxWJqkk/AAAAAAAAAAI/AAAAAAAAAAc/q06VO-yo2pI/photo.jpg?sz=128", "display_name": "Thomas Eberhard", "link": "https://stackoverflow.com/users/7585641/thomas-eberhard"}, "edited": false, "score": 0, "creation_date": 1528300012, "post_id": 50724125, "comment_id": 88457383, "body": "@ThomasEberhard I think that would be a valid addition to your question, that you want the text to be context dependent."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 107, "user_id": 7585641, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5IupbxWJqkk/AAAAAAAAAAI/AAAAAAAAAAc/q06VO-yo2pI/photo.jpg?sz=128", "display_name": "Thomas Eberhard", "link": "https://stackoverflow.com/users/7585641/thomas-eberhard"}, "edited": false, "score": 0, "creation_date": 1528300166, "post_id": 50724125, "comment_id": 88457481, "body": "@ThomasEberhard Yes, you do lose some flexibiltiy. If you want that functionality then I would suggest Jarod42&#39;s answer or something like Parker Coates answer."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 6, "last_activity_date": 1528298758, "creation_date": 1528298758, "answer_id": 50724125, "question_id": 50723966, "link": "https://stackoverflow.com/questions/50723966/alternative-to-value-or-that-is-indifferent-to-the-returned-type/50724125#50724125", "title": "Alternative to value_or that is indifferent to the returned type", "body": "<p>The easiest way to deal with this in my opion is to add an overload for <code>operator &lt;&lt;</code> for <code>std::optional&lt;Card&gt;</code>.  In there you can handle the logic on what to print like</p>\n\n<pre><code>std::ostream&amp; operator &lt;&lt;(std::ostream&amp; os, const std::optional&lt;Card&gt;&amp; card)\n{\n    if (card == std::nullopt)\n        return os &lt;&lt; \"Out of cards!\";\n    else\n        return os &lt;&lt; *card;\n}\n</code></pre>\n\n<p>and then you can just have</p>\n\n<pre><code>std::cout &lt;&lt; cardDeck.drawCard();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 4, "last_activity_date": 1528299135, "creation_date": 1528299135, "answer_id": 50724251, "question_id": 50723966, "link": "https://stackoverflow.com/questions/50723966/alternative-to-value-or-that-is-indifferent-to-the-returned-type/50724251#50724251", "title": "Alternative to value_or that is indifferent to the returned type", "body": "<p>You might write generic helper function a la <code>std::visit</code> for variant but for <code>std::optional</code>, something like:</p>\n\n<pre><code>template &lt;typename T, typename F, typename FEmpty&gt;\nauto my_optional_visit(const std::optional&lt;T&gt;&amp; o, F f, FEmpty fEmpty)\n{\n    return o ? f(*o) : fEmpty();\n}\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>my_optional_visit(cardDeck.drawCard(),\n                  [](const Card&amp;c){ std::cout &lt;&lt; c; },\n                  [](){ std::cout &lt;&lt; \"Out of Cards!\" });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1528299628, "creation_date": 1528299628, "answer_id": 50724415, "question_id": 50723966, "link": "https://stackoverflow.com/questions/50723966/alternative-to-value-or-that-is-indifferent-to-the-returned-type/50724415#50724415", "title": "Alternative to value_or that is indifferent to the returned type", "body": "<p>I would use a function (either namespace scoped or a static member of card) that takes a <code>std::optional&lt;Card&gt;</code> and return its textual representaion as a string. The relevant bits would be:</p>\n\n<pre><code>class Card {\n    ...\n    std::string repr() const {\n        std::string cr;\n        // writes the textual representation of a card here\n        return cr;\n    }\n    static std::string repr(const std::optional&lt;Card&gt; &amp;card) {\n        if (card.has_value()) {\n            return card.value().repr();\n        }\n        return \"Out of cards!\";\n    }\n};\n\nstd::ostream&amp; operator &lt;&lt; (std ostream&amp; out, const Card&amp; card) {\n    out &lt;&lt; card.repr();\n}\n</code></pre>\n\n<p>You would then simply use:</p>\n\n<pre><code>std::cout &lt;&lt; Card::repr(cardDeck.drawCard());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5788, "user_id": 4757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35f9815e64399a4e81e2e379b6560957?s=128&d=identicon&r=PG", "display_name": "Parker Coates", "link": "https://stackoverflow.com/users/4757/parker-coates"}, "is_accepted": false, "score": 0, "last_activity_date": 1528299988, "creation_date": 1528299988, "answer_id": 50724523, "question_id": 50723966, "link": "https://stackoverflow.com/questions/50723966/alternative-to-value-or-that-is-indifferent-to-the-returned-type/50724523#50724523", "title": "Alternative to value_or that is indifferent to the returned type", "body": "<p>A C++ function can only have one return type. In your case you'd like the type of the result to be determined at runtime, where it could be different every time it's called. That just isn't possible.</p>\n\n<p>If you need to do this often enough, I'd suggest just creating a small wrapper function.</p>\n\n<pre><code>std::string optionalCardToString(const std::optional&lt;Card&gt; &amp; card,\n                                 const std::string &amp; emptyString) {\n    return card ? card-&gt;to_string() : emptyString;\n}\n\nstd::cout &lt;&lt; optionalCardToString(cardDeck.drawCard(), \"Out of Cards\");\n</code></pre>\n\n<p>If performance is a concern, there's plenty you could do to make this more efficient to avoid making copies, but the general idea is there.</p>\n\n<p>I should note that in a real world scenario, you are unlikely to draw a <code>Card</code> from the <code>CarDeck</code> and just pipe it to <code>cout</code>. You typically will want to do something else with the card as well, such as add it to a <code>Hand</code> or a <code>Pile</code>. This need to do something else sort of negates your concern about having to mention the value more than once.</p>\n"}], "owner": {"reputation": 107, "user_id": 7585641, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5IupbxWJqkk/AAAAAAAAAAI/AAAAAAAAAAc/q06VO-yo2pI/photo.jpg?sz=128", "display_name": "Thomas Eberhard", "link": "https://stackoverflow.com/users/7585641/thomas-eberhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 50724125, "answer_count": 4, "score": 2, "last_activity_date": 1528299988, "creation_date": 1528298262, "question_id": 50723966, "link": "https://stackoverflow.com/questions/50723966/alternative-to-value-or-that-is-indifferent-to-the-returned-type", "title": "Alternative to value_or that is indifferent to the returned type", "body": "<p>I have built a little class <code>Card</code> overloading the <code>&lt;&lt;</code> operator, essentially printing out Suit and value of the card. </p>\n\n<p>The implementation details are not relevant for the question I want to ask here just assume the obvious. For <code>Card</code> I built a class <code>CardDeck</code>. Of course a <code>CardDeck</code> can run out of cards. That motivated me to this attempt:</p>\n\n<pre><code>std::optional&lt;Card&gt; CardDeck::drawCard() {\n    if (this-&gt;Cards.empty()) {\n        return std::nullopt;\n    }\n    else {\n        Card card = this-&gt;Cards.front();\n        this-&gt;Cards.pop_front();\n        return std::optional&lt;Card&gt;{card};\n    }\n}\n</code></pre>\n\n<p>Now one can draw a card and dealing with the possibility of a empty deck is the responsibility of client code using <code>CardDeck</code>, yet it is verbose that the method will not always return a value. I like that solution.</p>\n\n<p>Anyways a newbie to C++ I made the naive ansatz:</p>\n\n<p><code>std::cout&lt;&lt; cardDeck.drawCard().value_or(\"Out of cards!\");</code></p>\n\n<p>This fails as the type of <code>\"Out of cards!\"</code> is <code>char*</code> but not <code>Card</code>.</p>\n\n<p>My question: Is there a way to safe the elegant oneliner without checking and accessing the vaule / using the replacement in two seperate places?</p>\n"}, {"tags": ["c++", "multithreading", "gdb", "openmp"], "comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1528297712, "post_id": 50723675, "comment_id": 88455814, "body": "Show us the code, at least how parallel section is defined. The number of threads can be set many ways and some of them have higher priority than <code>OMP_NUM_THREADS</code>."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1528297802, "post_id": 50723675, "comment_id": 88455876, "body": "What is the number of threads without using gdb?"}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1528298057, "post_id": 50723675, "comment_id": 88456059, "body": "@ks1322  Running without a debugger, the number of threads is whatever I set OMP_NUM_THREADS to.  For right now, I want to run it on just two."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1528298248, "post_id": 50723675, "comment_id": 88456196, "body": "How do you set <code>OMP_NUM_THREADS</code> when run within debugger? And how many cores / hardware threads is on your machine?"}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1528298334, "post_id": 50723675, "comment_id": 88456252, "body": "@DanielLangr  Well, I guess I&#39;m showing my ignorance, but I set it just before I start up the debugger.  Am I supposed to do it within the debugger?  Don&#39;t know how."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1528298424, "post_id": 50723675, "comment_id": 88456309, "body": "Try <code>(gdb) set environment OMP_NUM_THREADS 2</code> before running the program in gdb."}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1528298812, "post_id": 50723675, "comment_id": 88456583, "body": "@ks1322  OK, that did it!  Thank you.  Will be happy to hit the &quot;accept&quot; button if you want to post it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "is_accepted": true, "score": 1, "last_activity_date": 1528299175, "creation_date": 1528299175, "answer_id": 50724267, "question_id": 50723675, "link": "https://stackoverflow.com/questions/50723675/how-to-fix-number-of-threads-in-gdb-run-of-an-openmp-program/50724267#50724267", "title": "How to fix number of threads in gdb run of an OpenMP program", "body": "<blockquote>\n  <p>Well, I guess I'm showing my ignorance, but I set it just before I\n  start up the debugger. Am I supposed to do it within the debugger?</p>\n</blockquote>\n\n<p>You should set environment variable <code>OMP_NUM_THREADS</code> inside gdb:</p>\n\n<pre><code>(gdb) set environment OMP_NUM_THREADS 2\n</code></pre>\n\n<p>See also builtin help:</p>\n\n<pre><code>(gdb) help set environment \nSet environment variable value to give the program.\nArguments are VAR VALUE where VAR is variable name and VALUE is value.\nVALUES of environment variables are uninterpreted strings.\nThis does not affect the program until the next \"run\" command.\n</code></pre>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 50724267, "answer_count": 1, "score": 0, "last_activity_date": 1528299175, "creation_date": 1528297464, "question_id": 50723675, "link": "https://stackoverflow.com/questions/50723675/how-to-fix-number-of-threads-in-gdb-run-of-an-openmp-program", "title": "How to fix number of threads in gdb run of an OpenMP program", "body": "<p>I am trying to debug an OpenMP C++ program with gdb on a Mac OSX machine.  (OK, using \"ggdb\" technically.)  No matter what I set OMP_NUM_THREADS to, gdb tries to run the code on 8 threads.  Why is this?  Is there a way for me to tell it myself the number of threads the code will run on?</p>\n"}, {"tags": ["c++", "templates", "c++17"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528297616, "post_id": 50723472, "comment_id": 88455739, "body": "Do you want <code>b</code> be template ?"}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1528298104, "post_id": 50723472, "comment_id": 88456089, "body": "You can write <code>struct b : public decltype(base(3))</code> in C++17, but that&#39;s not shorter than <code>struct b : public base&lt;int&gt;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528297449, "post_id": 50723574, "comment_id": 88455627, "body": "Following on from your example; if you do something like <code>auto bar = foo ? &quot;a&quot; : 5</code> you get a compiler error; I don&#39;t see the issue with the compiler doing the same in this case"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1528297546, "post_id": 50723574, "comment_id": 88455693, "body": "@UKMonkey - The type inference rules for the conditional operator don&#39;t need to account for the same open endendess that this feature has to deal with. It&#39;s not quite the same."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1528297638, "post_id": 50723574, "comment_id": 88455765, "body": "@UKMonkey - Also, this is also quite brittle. And innocent change in a member initialization list can break a build. And it won&#39;t be very clear WTH just happened. The conditional operator breaking is still a local error for the most part."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1528297762, "post_id": 50723574, "comment_id": 88455844, "body": "What is more likely happen is to allow this for function return types I think."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528297763, "post_id": 50723574, "comment_id": 88455847, "body": "I didn&#39;t mean to suggest they were the same - I was making the point that the compiler could just error in your example without trying to guess what type it should be - don&#39;t disagree with the brittle though!"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 12, "last_activity_date": 1528297198, "creation_date": 1528297198, "answer_id": 50723574, "question_id": 50723472, "link": "https://stackoverflow.com/questions/50723472/is-it-possible-to-auto-deduce-base-class-template-parameters-from-constructor/50723574#50723574", "title": "Is it possible to auto-deduce base class template parameters from constructor?", "body": "<p>The template argument deduction rules don't allow for it. And it's unlikely they ever will. Consider this:</p>\n\n<pre><code>struct b : public base { // note lack of &lt;int&gt;\n    b()    : base(3) {}\n    b(int) : base(false) {}\n};\n</code></pre>\n\n<p>What is the base class of <code>b</code> now? One may argue that it's feasible if all initializations of the base class agree on the type. But it's hard to check that in practice (think separate object files where c'tors reside), and it seems IMO too niche of a feature to be useful.</p>\n\n<p>So, to summarize, you can't avoid specifying the template arguments for the base class template.</p>\n"}], "owner": {"reputation": 4122, "user_id": 3951525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/hix21.jpg?s=128&g=1", "display_name": "Starl1ght", "link": "https://stackoverflow.com/users/3951525/starl1ght"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 50723574, "answer_count": 1, "score": 3, "last_activity_date": 1528297198, "creation_date": 1528296955, "question_id": 50723472, "link": "https://stackoverflow.com/questions/50723472/is-it-possible-to-auto-deduce-base-class-template-parameters-from-constructor", "title": "Is it possible to auto-deduce base class template parameters from constructor?", "body": "<p>This code sample works and doing exactly what it is supposed to do.</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct base {\n    base(T a) {};\n};\n\nstruct b : public base&lt;int&gt; {\n    b() : base(3) {};\n};\n</code></pre>\n\n<p>I want to utilize C++17 feature with auto-deduction template parameters from constructor and do something like this:</p>\n\n<pre><code>struct b : public base { // note lack of &lt;int&gt;\n    b() : base(3) {};\n};\n</code></pre>\n\n<p>Is it possible at all without some ugly hacks?</p>\n"}, {"tags": ["c++", "windows", "dll", "com"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528297031, "post_id": 50723362, "comment_id": 88455345, "body": "As you already know the path and if you are loading the DLLs using <code>LoadLibrary</code> then just use an absolute path.  If you are loading them via COM then they have not been registered properly."}, {"owner": {"reputation": 53, "user_id": 4558747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3308f43d9a0748fa1d37c0369bc8c1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Sawant", "link": "https://stackoverflow.com/users/4558747/mohan-sawant"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528297948, "post_id": 50723362, "comment_id": 88455987, "body": "@RichardCritten, They are non-COM dlls and should be located from search path. I can&#39;t use absolute path because it&#39;s going to be tedious to find out path of each and every dependent dlls. It will be a maintenance nightmare."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528299261, "post_id": 50723362, "comment_id": 88456894, "body": "It is excessively unlikely that the client programmer is going to take care of this for you.  In general they don&#39;t have the faintest idea where this stuff is located, your installer takes care of it when it registers the server."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1528328996, "post_id": 50723362, "comment_id": 88469997, "body": "Please clarify whether you are talking about in-process or out-of-process server"}, {"owner": {"reputation": 53, "user_id": 4558747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3308f43d9a0748fa1d37c0369bc8c1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Sawant", "link": "https://stackoverflow.com/users/4558747/mohan-sawant"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1528349327, "post_id": 50723362, "comment_id": 88474805, "body": "@M.M, this is about out-of-proc server. Had it been in-proc, it would have inherited client&#39;s search paths, which is enough for me."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4558747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3308f43d9a0748fa1d37c0369bc8c1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Sawant", "link": "https://stackoverflow.com/users/4558747/mohan-sawant"}, "edited": false, "score": 0, "creation_date": 1528376542, "post_id": 50728028, "comment_id": 88491322, "body": "I can change the server to load the dlls by absolute paths, but what about dependency chain? I can&#39;t find them and load one by one.       Also, I can&#39;t keep the dlls in the folder where server resides due to some constraints. So, for now putting paths in the PATH env variable seems to be the only option."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 53, "user_id": 4558747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3308f43d9a0748fa1d37c0369bc8c1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Sawant", "link": "https://stackoverflow.com/users/4558747/mohan-sawant"}, "edited": false, "score": 0, "creation_date": 1528385598, "post_id": 50728028, "comment_id": 88497949, "body": "@MohanSawant per <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586.aspx\" rel=\"nofollow noreferrer\">Dynamic-Link Library Search Order</a> on MSDN: &quot;<i>If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names. This is true even if the first DLL was loaded by specifying a full path.</i>&quot; Why do you have DLL dependencies scattered all over the place to begin with, instead of having them all in one place? What is preventing the server from using <code>SetDllDirectory()</code>/<code>AddDllDirectory()</code> to specify the folders where dependencies are looked in?"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1528313281, "last_edit_date": 1592644375, "creation_date": 1528312719, "answer_id": 50728028, "question_id": 50723362, "link": "https://stackoverflow.com/questions/50723362/how-to-set-dll-search-path-for-a-com-server-from-client/50728028#50728028", "title": "How to set dll search path for a COM server from client?", "body": "<p>Assuming the COM server loads the DLLs by name only:</p>\n<ul>\n<li><p>If the COM server is an in-proc DLL, it is loaded into the client's process, so the client can use <code>SetDllDirectory()</code> or <code>AddDllDirectory()</code> for itself and the server will include that extra path when loading the DLLs.</p>\n</li>\n<li><p>If the COM server is in out-of-proc EXE, the client cannot influence the server's search paths without altering the global <code>PATH</code> environment before loading the server, unless the server exposes a COM method that the client can call to let the server alter its own search paths.</p>\n<p>However, if you can put the DLLs in the same folder as the server's EXE, that will be the first place the OS looks for them, then you won't have to mess around with search paths at all.</p>\n</li>\n</ul>\n<p>If you can change the server to load the DLLs by absolute paths, you can then put the DLLs in a folder whose path is relative to the server's installation path, and have the server retrieve its own folder path at runtime (via <code>GetModuleFileName()</code>, stripping off the filename) and then append each DLL's relative path+filename to that base installation path.</p>\n<p>Or, put the DLLs wherever you want, and store those paths somewhere in your server's internal configuration.</p>\n<p>Or, register the DLLs in the Registry so the OS knows where to find them:</p>\n<pre><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4558747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3308f43d9a0748fa1d37c0369bc8c1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Sawant", "link": "https://stackoverflow.com/users/4558747/mohan-sawant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528448325, "creation_date": 1528296595, "last_edit_date": 1528448325, "question_id": 50723362, "link": "https://stackoverflow.com/questions/50723362/how-to-set-dll-search-path-for-a-com-server-from-client", "title": "How to set dll search path for a COM server from client?", "body": "<p>I am instantiating a COM server using CoCreateInstance(). My COM server loads some dlls dynamically later on. But it fails to find those dlls. One solution to this is to add these paths to PATH env variable, which I want to avoid. I can't set it in code as server is already loaded and it will not honor PATHs set after it is loaded. Best possible solution could be that client should be able to set COM server's search path. Is it possible? How?</p>\n"}, {"tags": ["c++", "arrays", "matrix", "multidimensional-array", "casting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 14, "creation_date": 1528295556, "post_id": 50722982, "comment_id": 88454364, "body": "Use a std::vector."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1528295800, "post_id": 50722982, "comment_id": 88454540, "body": "Please fill in some missing code, I don&#39;t think you&#39;ve even shown the line that&#39;s getting the error."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1528298472, "post_id": 50722982, "comment_id": 88456346, "body": "Er... &quot;this works fine&quot;? What is <code>(float ()[2])</code> and what compiler makes it &quot;work fine&quot;? This will not even compile."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1528298505, "post_id": 50722982, "comment_id": 88456374, "body": "I would use typedefs it makes things so much easier. Something like typedef float twoByTwo[2][2]; I have nit tried it but I think it will work."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1528298782, "post_id": 50722982, "comment_id": 88456561, "body": "@NeilButterworth std::vector is a wrong tool for the job in this situation."}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 3, "creation_date": 1528296253, "post_id": 50723214, "comment_id": 88454830, "body": "You can even declare <code>matrixReturnAsArray</code> as <code>float(&amp;matrixReturnAsArray)[SIZE][SIZE]</code> to aid deduction"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1528296434, "post_id": 50723214, "comment_id": 88454958, "body": "You&#39;re right. Although if I had to it in C++, I would probably use std::array instead."}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "edited": false, "score": 0, "creation_date": 1528300295, "post_id": 50723214, "comment_id": 88457572, "body": "My my intention is to change this  &quot;float (<i>somethingAsMatrix)[2] = (float (</i>)[2]) matrixReturnAsArray; &quot;. Actually It will create matrixReturnAsArray(1D) to somethingAsMatrix(p&#215;2)."}, {"owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "edited": false, "score": 0, "creation_date": 1528300427, "post_id": 50723214, "comment_id": 88457661, "body": "But In above comment, how to mention value in subscript dynamically?"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 1, "creation_date": 1528300768, "post_id": 50723214, "comment_id": 88457861, "body": "You can use template type inference. You don&#39;t need to cast the value. Just let your compiler do the job for you."}], "tags": [], "owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "is_accepted": true, "score": 3, "last_activity_date": 1528300853, "last_edit_date": 1528300853, "creation_date": 1528296148, "answer_id": 50723214, "question_id": 50722982, "link": "https://stackoverflow.com/questions/50722982/warning-iso-c-forbids-variable-length-array/50723214#50723214", "title": "warning: ISO C++ forbids variable length array", "body": "<p>Array in C++ must have a size defined at compile-time. </p>\n\n<p>If you want variable length array, use <code>std::vector</code> instead.</p>\n\n<p>In your case, I would use template for Matrix Size and have different implementation for different matrix size (unless I misunderstood your intentions).</p>\n\n<pre><code>template&lt;int SIZE&gt; \n    struct Matrix {\n    std::array&lt;std::array&lt;float, SIZE&gt;,SIZE&gt; m;\n    std::array&lt;float,SIZE&gt;&amp; operator[](int a) {\n        if(a&gt;=SIZE) {\n            throw std::out_of_range(\"Out of range exception\");\n        }\n        return m[a];\n    }\n};\n\ntemplate&lt;int SIZE&gt;\nvoid calcMatrix(Matrix&lt;SIZE&gt;&amp; matrixReturnAsArray );\n\n\ntemplate&lt;&gt;\nvoid calcMatrix&lt;2&gt;(Matrix&lt;2&gt;&amp; matrixReturnAsArray )\n{\n     // Code for 2x2 Matrix\n    std::cout &lt;&lt; \"&lt;2&gt;\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; matrixReturnAsArray[1][1] &lt;&lt; std::endl;\n}\n\ntemplate&lt;&gt;\nvoid calcMatrix&lt;3&gt;(Matrix&lt;3&gt;&amp; matrixReturnAsArray )\n{\n     // Code for 3x3 matrix\n        std::cout &lt;&lt; \"&lt;3&gt;\" &lt;&lt; std::endl;\n        std::cout &lt;&lt; matrixReturnAsArray[2][2] &lt;&lt; std::endl;\n}\n\nint main() {\n   std::array&lt;float,2&gt; a={1,2};\n   Matrix&lt;2&gt; m2;\n   m2.m = {a,a};\n   std::array&lt;float,3&gt; b={1,2,3};\n   Matrix&lt;3&gt; m3;\n   m3.m = {b,b,b};\n   calcMatrix(m3); \n   calcMatrix(m2);\n}\n</code></pre>\n\n<p>Since I did not defined the generic template, using any other value than 2 or 3 for size will result in an error at compile time. </p>\n\n<p>Edit :\nUsed reference to std::array instead of pointer after @Caleth's suggestion</p>\n\n<p>Edit 2:\nAdded operator [] for easy access and exception for safety</p>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1528301019, "last_edit_date": 1528301019, "creation_date": 1528300439, "answer_id": 50724667, "question_id": 50722982, "link": "https://stackoverflow.com/questions/50722982/warning-iso-c-forbids-variable-length-array/50724667#50724667", "title": "warning: ISO C++ forbids variable length array", "body": "<p>The following shows how to do the casts.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef float t2[2][2];\ntypedef float t3[3][3];\n\nstatic void test(int is2, void * p)\n{\n    if(is2)\n    {\n        t2 *a = (t2 *)p;\n        (*a)[1][1] = 1.23;\n    }\n    else\n    {\n        (*((t3*)p))[1][1] = 2.34;\n    }\n}\n\nint main()\n{\n    printf(\"Hello World\\n\");\n    t2 test2 = {{1,2},{3,4}};\n    t3 test3 = {{1,2,3},{4,5,6},{7,8,9}};\n\n    test(1,(void *)test2);\n    printf(\"%g\\n\",test2[1][1]);\n\n    test(0,(void *)test3);\n    printf(\"%g\\n\",test3[1][1]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 1, "last_activity_date": 1528303577, "creation_date": 1528303577, "answer_id": 50725588, "question_id": 50722982, "link": "https://stackoverflow.com/questions/50722982/warning-iso-c-forbids-variable-length-array/50725588#50725588", "title": "warning: ISO C++ forbids variable length array", "body": "<p>You can pass an array by reference.</p>\n\n<pre><code>void calcMatrix(float (&amp;matrix)[2][2])   // Only binds to 2*2 matrix\n{\n}\nvoid calcMatrix(float (&amp;matrix)[3][3])   // Only binds to 3*3 matrix\n{\n}\n\nint main()\n{\n   float a[2][2] ={{1,2} , {3,4}};\n   calcMatrix(a); \n\n   float b[3][3] ={{1,2,3} , {4,5,6}, {7,8,9}};\n   calcMatrix(b); \n}\n</code></pre>\n\n<p>If you want a function that works for varying sizes you can templatize it:</p>\n\n<pre><code>template&lt;int S&gt;\nvoid calcMatrix(float (&amp;matrix)[S][S])   // Only binds to S*S matrix\n{\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4615352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7C8xy.jpg?s=128&g=1", "display_name": "nhkrishna", "link": "https://stackoverflow.com/users/4615352/nhkrishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4775, "favorite_count": 0, "accepted_answer_id": 50723214, "answer_count": 3, "score": 0, "last_activity_date": 1528303577, "creation_date": 1528295449, "last_edit_date": 1528295659, "question_id": 50722982, "link": "https://stackoverflow.com/questions/50722982/warning-iso-c-forbids-variable-length-array", "title": "warning: ISO C++ forbids variable length array", "body": "<p>I have a function that takes a pointer to a floating point array. Based on other conditions, I know that pointer is actually pointing to a 2x2 OR 3x3 matrix. (in fact the memory was initially allocated as such, e.g. float M[2][2] ) The important thing is I want to make this determination in the function body, not as the function argument.</p>\n\n<pre><code>void calcMatrix( int face, float * matrixReturnAsArray )\n{\n    // Here, I would much rather work in natural matrix notation\n    if( is2x2 )\n    {\n        // ### cast matrixReturnAsArray to somethingAsMatrix[2][2]\n        somethingAsMatrix[0][1] = 2.002;\n        // etc..\n    }\n    else if(is3x3)\n    { //etc...\n    }\n\n}\n\nfloat (somethingAsMatrix)[2] = (float ()[2]) matrixReturnAsArray; \n</code></pre>\n\n<p>this works fine. </p>\n\n<p>here if i want mention value in subscript as a variable which will change based on some conditions. </p>\n\n<p>If i do this, it showing warning: ISO C++ forbids variable length array. From this how can i dynamically create something?</p>\n"}, {"tags": ["c++", "oop", "virtual-functions", "private-members", "overriding"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528295030, "post_id": 50722824, "comment_id": 88453988, "body": "because it&#39;s ok for things to call it on an A, but not on a Base?"}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528295084, "post_id": 50722824, "comment_id": 88454020, "body": "@UKMonkey ? What?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1528295168, "post_id": 50722824, "comment_id": 88454075, "body": "<code>virtual</code> and <code>override</code> simply do not pay any attention to access modifiers. Notably, it&#39;s not part of the function signature, which is what <code>virtual</code> and <code>override</code> look at."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528295186, "post_id": 50722824, "comment_id": 88454083, "body": "@Fran&#231;oisAndrieux Isn&#39;t the question why this is so?"}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528295202, "post_id": 50722824, "comment_id": 88454099, "body": "@Fran&#231;oisAndrieux emm... source please?"}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 1, "creation_date": 1528295210, "post_id": 50722824, "comment_id": 88454105, "body": "Because that&#39;s the nature of private? Subclasses cannot access (therefore cannot override) private methods from their parent class. I suggest you go back and read about private inheritance"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 10, "creation_date": 1528295232, "post_id": 50722824, "comment_id": 88454128, "body": "@AlexG But they can, that&#39;s the point of this question."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1528295384, "post_id": 50722824, "comment_id": 88454236, "body": "@tower120: UKMonkey means that <code>Base&amp; base = a; base.do_run();</code> would produce error."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 6, "creation_date": 1528295456, "post_id": 50722824, "comment_id": 88454279, "body": "THis is a very good question. IMO this is an error in the language design contradicting &quot;private members cannot be seen by subclasses&quot;."}, {"owner": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "edited": false, "score": 0, "creation_date": 1528296241, "post_id": 50722824, "comment_id": 88454820, "body": "Not exactly a duplicate, but very close to it, and with explanatory answers: <a href=\"https://stackoverflow.com/q/2170688/1332041\">Private virtual method in C++</a>"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528296620, "post_id": 50722824, "comment_id": 88455083, "body": "@sebrockm Taking a solid example; assume some logic in <code>run</code> that makes sure that it can&#39;t be run twice. In my specific implementation, that logic isn&#39;t required because it&#39;s done in <code>do_run</code> (because of some hardware feature - who knows), which makes them identical; I can safely call <code>do_run</code> or <code>run</code>; but I know that <code>do_run</code> will be just that little bit faster because it doesn&#39;t need to go through into the checking of <code>run()</code>.  Well, why shouldn&#39;t I let things that KNOW they&#39;re using this implementation use the faster version; while still allowing things that don&#39;t to still work?"}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1528297621, "post_id": 50722824, "comment_id": 88455746, "body": "@UKMonkey I don&#39;t understand how your example justifies that it is reasonable for me as a base class author to allow a subclass author to override my method but not to call it, as this is what a private virtual function allows and disallows you to do. Could you clarify your point?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 2, "creation_date": 1528397756, "post_id": 50722824, "comment_id": 88504251, "body": "@sebrockm -- &quot;private members cannot be seen by subclasses&quot; is simply wrong. They cannot be <b>accessed</b>; their names are <b>visible</b>."}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1528845105, "post_id": 50722969, "comment_id": 88658751, "body": "It kind of breaks the private-ness of private inheritance."}], "tags": [], "owner": {"reputation": 172, "user_id": 5111088, "user_type": "registered", "profile_image": "https://graph.facebook.com/746345188/picture?type=large", "display_name": "rawberry", "link": "https://stackoverflow.com/users/5111088/rawberry"}, "is_accepted": false, "score": 11, "last_activity_date": 1528295411, "creation_date": 1528295411, "answer_id": 50722969, "question_id": 50722824, "link": "https://stackoverflow.com/questions/50722824/c-override-private-pure-virtual-method-as-public/50722969#50722969", "title": "C++ override private pure virtual method as public", "body": "<p>That behavior is intended. If a method is virtual then it's meant to be customizable by derived classes, regardless of access modifier.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/2170688/private-virtual-method-in-c\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528295871, "post_id": 50723062, "comment_id": 88454576, "body": "Ok... How <a href=\"https://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Non-Virtual_Interface\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Non-Virtual_Interf&zwnj;&#8203;ace</a> should work then?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 1, "creation_date": 1528296001, "post_id": 50723062, "comment_id": 88454665, "body": "@tower120 I don&#39;t understand what you are asking. That example works <i>because</i> <code>private</code> member functions can be overridden."}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528296141, "post_id": 50723062, "comment_id": 88454757, "body": "I mean, its work - but if you can &quot;accidentally&quot; override it as public, what&#39;s the point of NVI?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 3, "creation_date": 1528296270, "post_id": 50723062, "comment_id": 88454843, "body": "If you accidentally override the as <code>public</code>, you&#39;ve misused the pattern. I&#39;m not sure how you can modify the pattern to mitigate that risk. But the same is true of countless features and technologies in c++. It&#39;s possible to make a mistake using it. This is one of the main reasons why bugs exist. Though in this case, making it <code>public</code> only exposes you to further problems, it doesn&#39;t cause any problems on it&#39;s own."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528296319, "post_id": 50723062, "comment_id": 88454879, "body": "@tower120 when you declared the method as virtual and especially as pure virtual, you have to implement it. If you are asking for it, it cannot be accidental"}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1528296366, "post_id": 50723062, "comment_id": 88454917, "body": "@KillzoneKid yes - but implement it as PUBLIC can easily be done accidental."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528296546, "post_id": 50723062, "comment_id": 88455034, "body": "@tower120 you can just as well &quot;accidentally&quot; override PUBLIC method as private, what&#39;s then?"}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1528296608, "post_id": 50723062, "comment_id": 88455076, "body": "@KillzoneKid then I can call it. This will be interface violation. I will be able to call intentionally hided function."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528296704, "post_id": 50723062, "comment_id": 88455150, "body": "@tower120 And if you make mistake other way round and make public private, you cannot call what you should be able to call publicly. Who is to decide what is worse? Was a good question nevertheless"}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528296900, "post_id": 50723062, "comment_id": 88455268, "body": "@Fran&#231;oisAndrieux &quot;Base::vf does not need to be visible (can be declared private, or inherited using private inheritance) to be overridden.&quot; - But from the other side, this does not mean that access level is allowed to be changed...."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 1, "creation_date": 1528297001, "post_id": 50723062, "comment_id": 88455317, "body": "@tower120 The point is that the derived type&#39;s <code>override</code> is seen as a match for the base type&#39;s <code>virtual</code> member, regardless of their access modifier. Nothing in the language gives explicit permission to do this, but the rules of overriding do not prevent it. It&#39;s allowed by virtue of overriding existing and not disallowing this case. It sounds like you&#39;re already convinced that this isn&#39;t allowed and are looking for someone to validate that all of the documentation is wrong. Note that you aren&#39;t changing any access modifiers. You&#39;re supplying a new function with different a different access."}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528297380, "post_id": 50723062, "comment_id": 88455577, "body": "@Fran&#231;oisAndrieux IOW this allowed, because not denied. Please, update answer with this."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1528305416, "post_id": 50723062, "comment_id": 88460307, "body": "It <i>does</i> care about the return type though. What you probably want to say is that if they are not the same they have to be covariant."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1528305924, "post_id": 50723062, "comment_id": 88460575, "body": "@Rakete1111 That&#39;s a different concern. The return type isn&#39;t considered when determining whether  a member function overrides or hides base type&#39;s member function. That the return types need to be covariant is a requirement once the function has been determined to be an override. For example, if you change any of the four elements I mention, the function will be considered as hiding the base type&#39;s function. Generally this will still compile (barring the use of the <code>override</code> keyword). If you change the return type, you have an ill-formed function override and the compiler will complain."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1528306236, "post_id": 50723062, "comment_id": 88460757, "body": "@Fran&#231;oisAndrieux Ahh, it&#39;s because functions can&#39;t be overloaded using just the return type, so there is no way to hide the base function, right?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1528306306, "post_id": 50723062, "comment_id": 88460797, "body": "@Rakete1111 I hadn&#39;t thought of why, but that makes sense."}, {"owner": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "edited": false, "score": 2, "creation_date": 1528320039, "post_id": 50723062, "comment_id": 88467321, "body": "@Fran&#231;oisAndrieux Your avatar is a strangely good match for this answer. Well, given your activity in C++ tag, maybe not only this one..."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528844140, "post_id": 50723062, "comment_id": 88658484, "body": "&quot;<i>overwriting a base&#39;s virtual</i>&quot; overwriting or overriding?"}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 18, "last_activity_date": 1583853601, "last_edit_date": 1583853601, "creation_date": 1528295707, "answer_id": 50723062, "question_id": 50722824, "link": "https://stackoverflow.com/questions/50722824/c-override-private-pure-virtual-method-as-public/50723062#50723062", "title": "C++ override private pure virtual method as public", "body": "<p>According to <a href=\"https://en.cppreference.com/w/cpp/language/virtual#In_detail\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/virtual#In_detail</a> overriding a base's <code>virtual</code> member function only care about the function name, parameters, const/volatile-ness and ref qualifier. It doesn't care about return type, access modifier or other things you might expect it to care about. </p>\n\n<p>The linked reference also specifically notes that :</p>\n\n<blockquote>\n  <p>Base::vf does not need to be visible (can be declared private, or inherited using private inheritance) to be overridden.</p>\n</blockquote>\n\n<p>Nothing that I can find explicitly gives permission to do this, but the rules of overriding do not prevent it. It's allowed by virtue of <code>virtual</code> functions and function overriding existing and not disallowing this case.</p>\n\n<p>If you are asking <em>why</em> this is how the language is, you may have to ask the standardization committee.</p>\n"}, {"comments": [{"owner": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "edited": false, "score": 0, "creation_date": 1528319017, "post_id": 50723410, "comment_id": 88466893, "body": "Well, there is an uplift: <code>A</code> is neither member nor friend, so I would expect it to have no access to private function of <code>B</code> whatsoever. This is incredibly inconsistent."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "reply_to_user": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "edited": false, "score": 2, "creation_date": 1528329171, "post_id": 50723410, "comment_id": 88470040, "body": "@Frax <code>A</code> has no access to a private function of <code>Base</code>. It cannot place a call to <code>Base::do_run</code>. It can customize a customization point that Base offered, but that doesn&#39;t involve any form of access."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1530382818, "post_id": 50723410, "comment_id": 89220983, "body": "@Cubbi The validity of the declaration overriding the base class declaration is checked by comparing to the base class, inaccessible, declaration. Saying that it isn&#39;t an &quot;access&quot; really is a stretch."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530458037, "post_id": 50723410, "comment_id": 89234078, "body": "@curiousguy Are you inventing a new meaning for the word &quot;access&quot;? Its technical meaning (to which &quot;private:&quot; relates) applies when compiling a function call."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1530468118, "post_id": 50723410, "comment_id": 89236312, "body": "@Cubbi I wasn&#39;t aware of a technical meaning different from the common sense meaning. Your code depends on a declaration. Compilation must access that declaration. Common sense. That&#39;s all."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 3, "last_activity_date": 1528296752, "creation_date": 1528296752, "answer_id": 50723410, "question_id": 50722824, "link": "https://stackoverflow.com/questions/50722824/c-override-private-pure-virtual-method-as-public/50723410#50723410", "title": "C++ override private pure virtual method as public", "body": "<blockquote>\n  <p>Why I can override PRIVATE virtual method as public???</p>\n</blockquote>\n\n<p>Because you look at the base method being private at wrong angle. <code>B::do_run</code> being private means \"only members and friends of this class can use it\". To prohibit derived classes from overriding it we would need separate specifier but we can simply make it not <code>virtual</code>. Class <code>A</code> on another side allows anybody to call <code>A::do_run()</code> and it is up to class <code>A</code> designer to decide so. So there is no uplift as you see it.</p>\n"}, {"comments": [{"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528300154, "post_id": 50724135, "comment_id": 88457474, "body": "Yes, overriding, implementing, but not changing visibility."}, {"owner": {"reputation": 1574, "user_id": 239189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUAlH.png?s=128&g=1", "display_name": "jszpilewski", "link": "https://stackoverflow.com/users/239189/jszpilewski"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1528300893, "post_id": 50724135, "comment_id": 88457933, "body": "@tower120 You may change the visibility of members in a derived class but regardless of this the base class interface will always work following its own definition. Whatever happens in a derived (implementing) class is expected to be an implementation detail and be less visible and not affecting the base interface. And with providing implementation some extra flexibility may be sometimes handy."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530382701, "post_id": 50724135, "comment_id": 89220960, "body": "@jszpilewski Access control (public, protected, private) is <i>not</i> the same as visibility."}], "tags": [], "owner": {"reputation": 1574, "user_id": 239189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUAlH.png?s=128&g=1", "display_name": "jszpilewski", "link": "https://stackoverflow.com/users/239189/jszpilewski"}, "is_accepted": false, "score": 2, "last_activity_date": 1528298803, "creation_date": 1528298803, "answer_id": 50724135, "question_id": 50722824, "link": "https://stackoverflow.com/questions/50722824/c-override-private-pure-virtual-method-as-public/50724135#50724135", "title": "C++ override private pure virtual method as public", "body": "<p>Notice that this implementation does not change the way how the base class is accessed and a construct:</p>\n\n<pre><code>Base&amp; b = a;\nb.do_run();\n</code></pre>\n\n<p>will not work. </p>\n\n<p>I remember there is some rationale behind it described in more detail in \"Effective C++\" by Scott Meyers. But the key practical feature is to be able to use such flexibility in the opposite direction, to override public base class members with private functions in a derived class forcing the client to use the base class as the interface and not be tempted to use directly the derived one that should remain a hidden implementation.</p>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530333171, "post_id": 51093334, "comment_id": 89210373, "body": "If the function should not be overridden, just don&#39;t make it virtual. (Am I missing something?)"}, {"owner": {"reputation": 1812, "user_id": 706055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59587d800e072afcecf5dfe8bc374957?s=128&d=identicon&r=PG&f=1", "display_name": "Amit G.", "link": "https://stackoverflow.com/users/706055/amit-g"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530387884, "post_id": 51093334, "comment_id": 89222038, "body": "Let&#39;s say you have a base-class B with (no virtual) <code>void f1(int);</code> and a derive-class D with <code>void f1(int);</code> - bad (hope for a warning): D::f1() hides B::f1(). Visual Studio C++ Compiler warnings <a href=\"https://docs.microsoft.com/en-us/visualstudio/code-quality/c26434\" rel=\"nofollow noreferrer\">C26434</a> on Code-Analysis. On the other hand: if you have base-class B with <code>virtual void f1(int) final;</code> and derived-class D with <code>void f1(int);</code> - you get an ERROR: overriding final function."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530388017, "post_id": 51093334, "comment_id": 89222057, "body": "I see but it the effort worth it? Also, making a class polymorphic as a (small) cost."}, {"owner": {"reputation": 1812, "user_id": 706055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59587d800e072afcecf5dfe8bc374957?s=128&d=identicon&r=PG&f=1", "display_name": "Amit G.", "link": "https://stackoverflow.com/users/706055/amit-g"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530388763, "post_id": 51093334, "comment_id": 89222158, "body": "Overall, name hiding is dangerous and error-prone. In some cases, as a strong design-statement, I assume it worth the &quot;effort&quot;."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1530389674, "post_id": 51093334, "comment_id": 89222357, "body": "But compilers often can warn about name hiding without forcing the programmer to make member function virtual final. Also the method can only work for non static member functions, so this is no fix for cases of hiding of a static member, a data member, a type definition member, or a non static template function."}], "tags": [], "owner": {"reputation": 1812, "user_id": 706055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59587d800e072afcecf5dfe8bc374957?s=128&d=identicon&r=PG&f=1", "display_name": "Amit G.", "link": "https://stackoverflow.com/users/706055/amit-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1530240834, "last_edit_date": 1530240834, "creation_date": 1530237739, "answer_id": 51093334, "question_id": 50722824, "link": "https://stackoverflow.com/questions/50722824/c-override-private-pure-virtual-method-as-public/51093334#51093334", "title": "C++ override private pure virtual method as public", "body": "<p>If the intention is to write a private code for the base-class &amp; to prevent the possibility of override it, implement the private function in the base class, and declare it <code>final</code>, otherwise: When should someone use private virtuals? <a href=\"https://isocpp.org/wiki/faq/strange-inheritance#private-virtuals\" rel=\"nofollow noreferrer\">ISOCPP.ORG FAQ</a></p>\n"}], "owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3397, "favorite_count": 2, "accepted_answer_id": 50723062, "answer_count": 5, "score": 17, "last_activity_date": 1583853601, "creation_date": 1528294985, "last_edit_date": 1530233737, "question_id": 50722824, "link": "https://stackoverflow.com/questions/50722824/c-override-private-pure-virtual-method-as-public", "title": "C++ override private pure virtual method as public", "body": "<p>Why does this happen?</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/e1376beff0c157a1\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/e1376beff0c157a1</a></p>\n\n<pre><code>class Base{\nprivate:\n    virtual void do_run() = 0;\npublic:\n    void run(){\n        do_run();\n    }\n};\n\nclass A : public Base {\npublic:\n    // uplift ??\n    virtual void do_run() override {}\n};\n\n\nint main()\n{\n    A a;\n    a.do_run();\n}\n</code></pre>\n\n<p>Why can I override a <strong>PRIVATE</strong> virtual method as public?</p>\n"}, {"tags": ["c++", "winapi", "coordinates", "mouse", "directx-11"], "comments": [{"owner": {"reputation": 1021, "user_id": 3335118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s22sH.png?s=128&g=1", "display_name": "theGleep", "link": "https://stackoverflow.com/users/3335118/thegleep"}, "edited": false, "score": 0, "creation_date": 1528295465, "post_id": 50722818, "comment_id": 88454291, "body": "Maybe the window boundaries are including the window border?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1528296692, "post_id": 50722818, "comment_id": 88455144, "body": "<code>WM_LBUTTONDOWN</code> provides client-based mouse coordinates.  Does <code>place</code> also expect client based, or does it want window based coordinates?"}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1528296854, "post_id": 50722818, "comment_id": 88455242, "body": "@1201ProgramAlarm what&#39;s the difference? I&#39;m using winapi for the first time, I thought that the message parameter would contain the window coordinates from the top left corner. My function expects those."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1528298419, "post_id": 50722818, "comment_id": 88456305, "body": "The client coordinates are offset from the window coordinates by the border, title bar, etc.  Usually when you&#39;re working in the client area you don&#39;t care what the border looks like.  Maybe <a href=\"https://stackoverflow.com/questions/140347/win32-mfc-get-window-rect-from-client-rect\">this question</a> can help."}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1528298816, "post_id": 50722818, "comment_id": 88456587, "body": "@1201ProgramAlarm then how come the top left corner is 0,0 ? If the&#39;re offset the origin should be offset as well. It&#39;s strange that the top left corner is 0,0 and the bottom right is 1004, 716 instead of 1024,768"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1528299196, "post_id": 50722818, "comment_id": 88456849, "body": "Client area coordinates start at 0,0 (top left). The difference you see in width, height is because window size includes title bar and borders, but client size does not. Call <code>GetClientRect()</code> to get client area size."}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1528300356, "post_id": 50722818, "comment_id": 88457617, "body": "@zett42 thanks, that solved my problem, answer my question so I can accept the answer"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1528305175, "post_id": 50722818, "comment_id": 88460181, "body": "@Luca also FYI, don&#39;t manually shift the bits of <code>lParam</code> to get the coordinates.  Use the <code>GET_X_LPARAM()</code>/<code>GET_Y_LPARAM()</code> or <code>MAKEPOINTS()</code> macros instead, per the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms645607.aspx\" rel=\"nofollow noreferrer\">documentation</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1298, "user_id": 1131162, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/314fed69b12de022a5e077f724e05ac5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1131162/alex"}, "is_accepted": true, "score": 3, "last_activity_date": 1528317966, "last_edit_date": 1528317966, "creation_date": 1528307327, "answer_id": 50726587, "question_id": 50722818, "link": "https://stackoverflow.com/questions/50722818/getting-mouse-position-in-a-windows-application/50726587#50726587", "title": "Getting mouse position in a Windows application", "body": "<p>The coordinates you receive from <code>WM_LBUTTONDOWN</code> are client coordinates, and are correct. The real issue here stems from the difference between the <em>window area</em> and <em>client area</em>. </p>\n\n<p>The window area contains the whole window, including the title bar and borders. The <code>RECT</code> you would get from <code>GetWindowRect</code> is exactly large enough to cover every pixel of your window, such that superimposing a black box of that size on the screen would cause your entire window, title bar and borders included, to disappear. </p>\n\n<p>The client area, however, is the area <em>inside</em> the borders Windows creates for you. The <code>RECT</code> you would get from <code>GetClientRect</code> is just large enough that, again, superimposing a black box of that size on the screen would cover your entire 3D scene, but leave the title bar and borders visible. </p>\n\n<p>The theory and definitions here are all well and good, but now we need to solve the problem. It turns out, the code you have in your window procedure, aside from the API compliance issues noted by Remy Lebeau (use <code>GET_X_LPARAM()</code>/<code>GET_Y_LPARAM()</code> instead of shifting), is perfectly fine, and needs no modification. The actual point where you introduce the error is during your window creation code.</p>\n\n<p>The <code>nWidth</code> and <code>nHeight</code> parameters to <code>CreateWindow</code> specify the width and height of the <em>window</em>, not the client area. As such, your client area will be smaller. However, you want the client area to have those widths.</p>\n\n<p>Turns out, this is such a common occurence that Windows 2000 added a function to generate the proper window width and height for a given client area: <code>AdjustWindowRect</code>. To use it, change your <code>CreateWindow</code> call to the following:</p>\n\n<pre><code>RECT windowRect;\nwindowRect.top = 0;\nwindowRect.left = 0;\nwindowRect.right = DisplayManager::GetInstance()-&gt;GetDisplayWidth();\nwindowRect.bottom = DisplayManager::GetInstance()-&gt;GetDisplayHeight();\n\nAdjustWindowRect(&amp;windowRect, WS_OVERLAPPEDWINDOW, FALSE);\n\nmWindow = CreateWindow(L\"wndClass\", \n                       L\"DirectX 11 Engine\", \n                       WS_OVERLAPPEDWINDOW, \n                       CW_USEDEFAULT, \n                       CW_USEDEFAULT, \n                       windowRect.right, \n                       windowRect.bottom, \n                       0, \n                       0, \n                       hInstance, \n                       0);\n</code></pre>\n\n<p>This will offset your coordinates to ensure that the client area is exactly the size the DisplayManager thinks it should be.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you have an extended window style, <code>AdjustWindowRectEx</code> allows you to specify those extended window styles as an additional fourth argument to the function. </p>\n"}], "owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 50726587, "answer_count": 1, "score": -1, "last_activity_date": 1528317966, "creation_date": 1528294977, "last_edit_date": 1528298343, "question_id": 50722818, "link": "https://stackoverflow.com/questions/50722818/getting-mouse-position-in-a-windows-application", "title": "Getting mouse position in a Windows application", "body": "<p>I'm coding a simple game engine with DirectX11 and I'm using Win32 API to create a window and process user input. I'm implementing a ray casting routine to pick and place entities on a terrain, and all works fine except that when I try to place something on the ground it has a weird offset to the top and to the left:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GKDL6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GKDL6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After quite a bit of debugging I found out that my code works fine, and the issue is with the window coordinates that I send to the ray casting class/function:</p>\n\n<pre><code>LRESULT Game::GameWndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)\n{\n    switch (msg)\n    {\n        case WM_LBUTTONDOWN:\n            /*MessageBox(mWindow, L\"left mouse button clicked\", L\"CLICK\", MB_OK);*/\n            Timer::GetInstance()-&gt;Stop();\n-------&gt;    Input::GetInstance()-&gt;Place(lParam &amp; 0xFFFF, lParam &gt;&gt; 16 &amp; 0xFFFF, mCamera, mEntity, mTerrain, mRenderer);\n            return 0;\n           // ....\n           // .... other cases\n    }\n}\n</code></pre>\n\n<p>The coordinates of the mouse cursor are not between 0 and the window width/height (1024 X 768 in my case), but the maximum width is 1004 and the maximum height is 718 (more or less when I click on the bottom right corner of the window), that's what I read when I debug the application.</p>\n\n<p>A final prove of that is that if I use those width and height in my code, objects are placed where they should. \nSo my question is, how come the coordinates don't cover the whole window size? Am I missing something/ doing something wrong? How can I get correct coordinates?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>my function requires client area coordinates, the coordinates of the mouse cursor INSIDE the window, of course.</p>\n\n<p><strong>EDIT EDIT</strong></p>\n\n<p>this is the code I use to create the window</p>\n\n<pre><code>void Game::InitializeWindow(HINSTANCE hInstance)\n{\n    WNDCLASS windowClass = {};\n    windowClass.hInstance = hInstance;\n    windowClass.lpfnWndProc = &amp;WndProc;\n    windowClass.lpszClassName = L\"wndClass\";\n    windowClass.lpszMenuName = NULL;\n    windowClass.style = CS_HREDRAW | CS_VREDRAW;\n    windowClass.cbClsExtra = 0;\n    windowClass.cbWndExtra = 0;\n    windowClass.hCursor = LoadCursor(NULL, IDC_ARROW);\n    windowClass.hIcon = LoadIcon(NULL, IDI_APPLICATION);\n    windowClass.hbrBackground = (HBRUSH)GetStockObject(GRAY_BRUSH);\n    RegisterClass(&amp;windowClass);\n\n    mWindow = CreateWindow(L\"wndClass\", L\"DirectX 11 Engine\", WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, DisplayManager::GetInstance()-&gt;GetDisplayWidth(), DisplayManager::GetInstance()-&gt;GetDisplayHeight(), 0, 0, hInstance, 0);\n    if (!mWindow)\n        ErrorBox(L\"window creation failed\");\n\n    ShowWindow(mWindow, SW_SHOW);\n    UpdateWindow(mWindow);\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 2, "creation_date": 1528295152, "post_id": 50722747, "comment_id": 88454062, "body": "cvSplit and most (I think all) functions that start with cv and then the function name belong to the C API which is deprecated and should not be used. What you are looking for is  <a href=\"https://docs.opencv.org/2.4/modules/core/doc/operations_on_arrays.html?highlight=compare#split\" rel=\"nofollow noreferrer\">cv::split</a> which is from the C++ module and accepts cv::Mat"}], "answers": [{"tags": [], "owner": {"reputation": 9345, "user_id": 4237316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/100004533998341/picture?type=large", "display_name": "Harald Nordgren", "link": "https://stackoverflow.com/users/4237316/harald-nordgren"}, "is_accepted": false, "score": 1, "last_activity_date": 1528295620, "creation_date": 1528295620, "answer_id": 50723041, "question_id": 50722747, "link": "https://stackoverflow.com/questions/50722747/opencv-split-and-merge/50723041#50723041", "title": "OpenCV Split and Merge", "body": "<p>Try this function instead if <code>cvSplit</code>:</p>\n\n<pre><code>cv::split\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 702, "user_id": 5956151, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36cbd9873a8a5ca327f20f95974e5f75?s=128&d=identicon&r=PG&f=1", "display_name": "C.Radford", "link": "https://stackoverflow.com/users/5956151/c-radford"}, "is_accepted": true, "score": 7, "last_activity_date": 1528296480, "creation_date": 1528296480, "answer_id": 50723331, "question_id": 50722747, "link": "https://stackoverflow.com/questions/50722747/opencv-split-and-merge/50723331#50723331", "title": "OpenCV Split and Merge", "body": "<p>A mat does not allow a subscript operator if not stated when created. Therefore most create a Mat denoting number of bands within so it can then be split. this means that <code>Bands[0],Bands[1],Bands[2]</code> are each of a single channel and are grayscale. Not get original image must then merge the channels using <code>merge</code> function.</p>\n\n<pre><code>Mat image = imread(file,1);\nMat Bands[3],merged;\nsplit(image, Bands);\nvector&lt;Mat&gt; channels = {Bands[0],Bands[1],Bands[2]};\nmerge(channels,merged);\nimshow(\"red\", Bands[2]);\nimshow(\"blue\", Bands[0]);\nimshow(\"green\",Bands[1]);\nimshow(\"merged\",merged);\n</code></pre>\n"}], "owner": {"reputation": 702, "user_id": 5956151, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36cbd9873a8a5ca327f20f95974e5f75?s=128&d=identicon&r=PG&f=1", "display_name": "C.Radford", "link": "https://stackoverflow.com/users/5956151/c-radford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7649, "favorite_count": 0, "closed_date": 1528305987, "accepted_answer_id": 50723331, "answer_count": 2, "score": 3, "last_activity_date": 1528296622, "creation_date": 1528294747, "last_edit_date": 1528296622, "question_id": 50722747, "link": "https://stackoverflow.com/questions/50722747/opencv-split-and-merge", "closed_reason": "Duplicate", "title": "OpenCV Split and Merge", "body": "<p>I have an image of type <code>Mat</code> that I am trying to separate into its individual bands so I can then adjust the pixel values in each band separately. When I write the code this error pops up \"No matching function for call to 'cvSplit'\".</p>\n\n<pre><code>Mat image = imread(file,1);\nMat rBand, gBand,bBand;\ncvSplit(image, bBand, gBand, rBand, NULL);\nimshow(\"red\", rBand);\nimshow(\"blue\", bBand);\nimshow(\"green\",gBand);\n</code></pre>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528294913, "post_id": 50722704, "comment_id": 88453905, "body": "why the reference ? Why not just <code>std::variant&lt;std::atomic&lt;double&gt;, std::atomic&lt;int&gt;, std::string&gt;</code> ?"}, {"owner": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528302176, "post_id": 50722704, "comment_id": 88458594, "body": "@SanderDeDycker Check the <code>std::visit</code> handler. I assign values to these variables..."}], "answers": [{"comments": [{"owner": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 1, "creation_date": 1528294974, "post_id": 50722799, "comment_id": 88453940, "body": "OK, but why this compiles? <code>using foo = std::variant&lt;std::atomic&lt;double&gt; &amp;, std::atomic&lt;int&gt; &amp;, std::string &amp;&gt;;</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 4, "creation_date": 1528295098, "post_id": 50722799, "comment_id": 88454038, "body": "@AlBundy: You don&#39;t instantiate <code>foo</code>, just declaring an alias."}], "tags": [], "owner": {"reputation": 418, "user_id": 4432988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhNKZ.jpg?s=128&g=1", "display_name": "Mikhail Vasilyev", "link": "https://stackoverflow.com/users/4432988/mikhail-vasilyev"}, "is_accepted": true, "score": 4, "last_activity_date": 1528295260, "last_edit_date": 1528295260, "creation_date": 1528294920, "answer_id": 50722799, "question_id": 50722704, "link": "https://stackoverflow.com/questions/50722704/static-assertion-failed-variant-must-have-no-reference-alternative/50722799#50722799", "title": "static assertion failed: variant must have no reference alternative", "body": "<p>From <a href=\"http://en.cppreference.com/w/cpp/utility/variant\" rel=\"nofollow noreferrer\">cppreference.com</a>:</p>\n\n<blockquote>\n  <p>A variant is not permitted to hold references, arrays, or the type\n  void. Empty variants are also ill-formed (<code>std::variant&lt;std::monostate&gt;</code>\n  can be used instead).</p>\n</blockquote>\n\n<p>So using pointers instead would be correct.</p>\n"}, {"tags": [], "owner": {"reputation": 2132, "user_id": 1315480, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0ec5acc01d8130dfefe52b6ea8823bbb?s=128&d=identicon&r=PG", "display_name": "Patrizio Bertoni", "link": "https://stackoverflow.com/users/1315480/patrizio-bertoni"}, "is_accepted": false, "score": 0, "last_activity_date": 1618932623, "creation_date": 1618932623, "answer_id": 67181938, "question_id": 50722704, "link": "https://stackoverflow.com/questions/50722704/static-assertion-failed-variant-must-have-no-reference-alternative/67181938#67181938", "title": "static assertion failed: variant must have no reference alternative", "body": "<p>It should be noticed that <code>boost::variant&lt;&gt;</code> allows to hold references. So consider moving on that.</p>\n<p>A nice MWE:</p>\n<pre><code>#include &quot;boost/variant.hpp&quot;\n#include &lt;iostream&gt;\n\nclass my_visitor : public boost::static_visitor&lt;int&gt;\n{\npublic:\n    int operator() (int &amp; i) const\n    {\n        return i;\n    }\n\n    int operator() (const std::string &amp; str) const\n    {\n        return str.length();\n    }\n};\n\nint main()\n{\n    std::string mystr = &quot;hello world&quot;;\n    boost::variant&lt;int &amp;, std::string &amp;&gt; u(mystr);\n    std::cout &lt;&lt; u; // output: hello world\n\n    int result = boost::apply_visitor(my_visitor(), u);\n    std::cout &lt;&lt; result; // output: 11 (i.e., length of &quot;hello world&quot;)\n}\n\n</code></pre>\n"}], "owner": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 50722799, "answer_count": 2, "score": 2, "last_activity_date": 1618932623, "creation_date": 1528294627, "question_id": 50722704, "link": "https://stackoverflow.com/questions/50722704/static-assertion-failed-variant-must-have-no-reference-alternative", "title": "static assertion failed: variant must have no reference alternative", "body": "<p>I want to have a map which contains references to variables of different type. For this I am using <code>std::variant</code> like this:</p>\n\n<pre><code>using foo = std::variant&lt;std::atomic&lt;double&gt; &amp;, std::atomic&lt;int&gt; &amp;, std::string &amp;&gt;;\n</code></pre>\n\n<p>This compiles that far with gcc 7.3.0. Used compiler flags: <code>-Wall -Wextra -Werror -O3 -std=c++17</code></p>\n\n<p>Adding this code:</p>\n\n<pre><code>using ServerParameter = struct ServerParameter\n{\n    foo  myVariants;     &lt;---- gcc error\n    bool someLogic;\n};\n</code></pre>\n\n<p>breaks the code and I get this gcc error:</p>\n\n<blockquote>\n  <p>error: static assertion failed: variant must have no reference\n  alternative</p>\n</blockquote>\n\n<p>My intention is something like this - but for the moment I cannot because the <code>using</code> for <code>ServerParameter</code> already fails:</p>\n\n<pre><code>auto bar() -&gt; void\n{    \n    std::atomic&lt;double&gt; atom_double;\n    std::atomic&lt;int&gt;    atom_int;\n    std::string         myString;\n    ...\n    std::map&lt;std::string, ServerParameter&gt; variableList(\n        {\n            { {\"SomeText1\" }, { atom_double; true  } },\n            { {\"SomeText2\" }, { atom_int;    true  } },\n            { {\"SomeText3\" }, { myString;    false } },\n        }\n    );\n    ...\n}\n</code></pre>\n\n<p>I can then process very nicely the items in <code>variableList</code> - depending on the type of the reference - with <code>std::visit</code>.</p>\n\n<hr>\n\n<p><strong>Note:</strong></p>\n\n<p><code>pointer</code> <strong>works</strong> instead of <code>reference</code>, e.q.:</p>\n\n<pre><code>using foo = std::variant&lt;std::atomic&lt;double&gt; *, std::atomic&lt;int&gt; *, std::string *&gt;;\n\nauto bar() -&gt; void\n{    \n    std::atomic&lt;double&gt; atom_double;\n    std::atomic&lt;int&gt;    atom_int;\n    std::string         myString;\n    ...\n    std::map&lt;std::string, ServerParameter&gt; variableList(\n        {\n            { {\"SomeText1\" }, { &amp;atom_double; true  } },\n            { {\"SomeText2\" }, { &amp;atom_int;    true  } },\n            { {\"SomeText3\" }, { &amp;myString;    false } },\n        }\n    );\n    ...\n}\n</code></pre>\n\n<p>And then the very elegant <code>std::visit</code>:</p>\n\n<pre><code>std::visit( visitHandler             \n        {\n            [&amp;](std::atomic&lt;double&gt; * enumType) { *enumType = ..an assignment..; },\n            [&amp;](std::atomic&lt;int&gt; * enumType)    { *enumType = ..an assignment..; },\n            [&amp;](FaF::string * enumType)         { *enumType = ..an assignment..; },\n        }, variantEntry );\n</code></pre>\n\n<hr>\n\n<p><strong>My question:</strong>  </p>\n\n<ol>\n<li>What am I doing here wrong? I don't understand the error message and I didn't find anything in the net.</li>\n<li>What would be the correct declaration of <code>ServerParameter</code>?</li>\n</ol>\n"}, {"tags": ["c++", "c", "leda"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1528294267, "post_id": 50722467, "comment_id": 88453451, "body": "Add  <code>#include &lt;limits.h&gt;</code> before <code>#include &lt;LEDA&#47;core&#47;string.h&gt;</code> and add <code>return 0;</code> into main function."}, {"owner": {"reputation": 1, "user_id": 9878362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nn Kk", "link": "https://stackoverflow.com/users/9878362/nn-kk"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1528294560, "post_id": 50722467, "comment_id": 88453656, "body": "Thaaaanks!!!!!!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528301989, "post_id": 50722467, "comment_id": 88458489, "body": "<code>return</code> is optional in <code>main</code>."}], "owner": {"reputation": 1, "user_id": 9878362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nn Kk", "link": "https://stackoverflow.com/users/9878362/nn-kk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1528294760, "creation_date": 1528293968, "last_edit_date": 1528294760, "question_id": 50722467, "link": "https://stackoverflow.com/questions/50722467/compiling-error-leda-6-1", "title": "Compiling error LEDA 6.1", "body": "<p>I am trying to compile the simple Hello World! program from this tutorial <a href=\"http://www.leda-tutorial.org/en/unofficial/ch01s03s01.html\" rel=\"nofollow noreferrer\">LEDA Tutorial, section 1.3</a> using LEDA 6.1 on the UNIX system of my department. </p>\n\n<pre><code>#include &lt;LEDA/core/string.h&gt;\n#include &lt;iostream&gt;\n\nusing leda::string;\nusing std::cout;\n\nint main ()\n{\n\n    string msg = \"Hello World!\";\n    cout &lt;&lt; msg &lt;&lt; \"\\n\";\n\n}\n</code></pre>\n\n<p>After setting the environment variable </p>\n\n<pre><code>LEDAROOT = /usr/local/LEDA-6.1\nexport LEDAROOT\n</code></pre>\n\n<p>I try to compile the file <code>leda1.c</code> containing the upper code</p>\n\n<pre><code>g++ -c leda1.c -I$LEDAROOT/incl\n</code></pre>\n\n<p>I get some errors witch are:</p>\n\n<pre><code>In file included from /usr/local/LEDA-6.1/incl/LEDA/system/basic.h:70,\n                 from /usr/local/LEDA-6.1/incl/LEDA/core/string.h:16,\n                 from leda1.c:1:\n/usr/local/LEDA-6.1/incl/LEDA/system/misc.h: In function \u2018int leda::Max_Value(int&amp;)\u2019:\n/usr/local/LEDA-6.1/incl/LEDA/system/misc.h:120: error: \u2018INT_MAX\u2019 was not declared in this scope\n/usr/local/LEDA-6.1/incl/LEDA/system/misc.h: In function \u2018int leda::Min_Value(int&amp;)\u2019:\n/usr/local/LEDA-6.1/incl/LEDA/system/misc.h:121: error: \u2018INT_MAX\u2019 was not declared in this scope\n</code></pre>\n\n<p>Can anyone help me with this problem?</p>\n"}, {"tags": ["c++", "pointers", "type-conversion"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528294005, "post_id": 50722446, "comment_id": 88453279, "body": "do you mean you want something like <code>uint_t test=memory[0]</code>; but for an array?"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1528294058, "post_id": 50722446, "comment_id": 88453309, "body": "Is that <i>really</i> the exact error message?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528294107, "post_id": 50722446, "comment_id": 88453345, "body": "I would be afraid of breaking the strict aliasing rule, but I should mention that I never fully understood that rule"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1528294107, "post_id": 50722446, "comment_id": 88453346, "body": "@JoshDetwiler <a href=\"https://godbolt.org/g/N7PKUJ\" rel=\"nofollow noreferrer\">That won&#39;t work.</a>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528294171, "post_id": 50722446, "comment_id": 88453392, "body": "@user463035818 <code>uint8_t</code> is most probably an alias to <code>unsigned char</code> so aliasing rule should be fine"}, {"owner": {"reputation": 41, "user_id": 9903770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55e655f85e089cf85b3034a8411bcb1?s=128&d=identicon&r=PG&f=1", "display_name": "Croxa", "link": "https://stackoverflow.com/users/9903770/croxa"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1528294237, "post_id": 50722446, "comment_id": 88453429, "body": "@G.M. whoops, forgot the &#39; * &#39; you are right, edited"}, {"owner": {"reputation": 2651, "user_id": 3371258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmVpr.png?s=128&g=1", "display_name": "Candy Gumdrop", "link": "https://stackoverflow.com/users/3371258/candy-gumdrop"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528294471, "post_id": 50722446, "comment_id": 88453586, "body": "@Slava even if it was <code>unsigned char</code> instead of <code>std::uint8_t</code>, this would still violate the strict aliasing rule.  Only if memory was being accessed via a <code>char</code> / <code>unsigned char</code> pointer would this be okay (other way round to what&#39;s happening in this question)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528294480, "post_id": 50722446, "comment_id": 88453594, "body": "@Slava, nope, since it is a char* which can alias everything, not the other way around."}], "answers": [{"comments": [{"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1528295191, "post_id": 50722649, "comment_id": 88454088, "body": "Some compilers offer options to disable the strict aliasing rule, like -fno_strict_aliasing. (But in most cases it does not make sense to use them IMHO)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1528295321, "post_id": 50722649, "comment_id": 88454193, "body": "@alain disabling this is often a terrible pessimization"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1528295424, "post_id": 50722649, "comment_id": 88454256, "body": "Yes, I agree. The only use case I see is if you have a very large legacy code base that you&#39;re unwilling to change at the moment."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 5, "last_activity_date": 1528294925, "last_edit_date": 1528294925, "creation_date": 1528294439, "answer_id": 50722649, "question_id": 50722446, "link": "https://stackoverflow.com/questions/50722446/uint32-t-pointer-to-the-same-location-as-uint8-t-pointer/50722649#50722649", "title": "uint32_t pointer to the same location as uint8_t pointer", "body": "<p>This would be a violation of so-called <a href=\"https://stackoverflow.com/q/98650/1332041\">Strict Aliasing Rule</a>, so it can not be done. Sad, but true.</p>\n\n<p>Use <code>memcpy</code> to copy data and in many cases compilers will optimize memory copy and generate the same code as they would with cast, but in Standard-conforming way.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528294791, "post_id": 50722743, "comment_id": 88453817, "body": "Aside endianness <code>uint32_t</code> is 4 bytes, OP assigns only 2. I would see that as bigger problem here."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1528294849, "post_id": 50722743, "comment_id": 88453868, "body": "@Slava well, if you&#39;re going to dance with UB, in for a penny in for a pound.  Next step, assign threads to play with it"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528294897, "post_id": 50722743, "comment_id": 88453898, "body": "You started it first"}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1528294733, "creation_date": 1528294733, "answer_id": 50722743, "question_id": 50722446, "link": "https://stackoverflow.com/questions/50722446/uint32-t-pointer-to-the-same-location-as-uint8-t-pointer/50722743#50722743", "title": "uint32_t pointer to the same location as uint8_t pointer", "body": "<p>This question completely ignores the concept of endian-ness; while your example has the lower and upper byte the same value, if the byte order is swapped it makes no difference; but in the case where it is; your number will be wrong unexpectedly.</p>\n\n<p>As such, there's no portable way to use the resulting number.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1528295088, "post_id": 50722834, "comment_id": 88454024, "body": "This is even worse than <code>reinterpret_cast</code> which already explained why it is wrong to do it."}], "tags": [], "owner": {"reputation": 94, "user_id": 8218414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79901ba79e8fc2c164915bc3d80e541c?s=128&d=identicon&r=PG&f=1", "display_name": "Vishnu R", "link": "https://stackoverflow.com/users/8218414/vishnu-r"}, "is_accepted": false, "score": -3, "last_activity_date": 1528295032, "creation_date": 1528295032, "answer_id": 50722834, "question_id": 50722446, "link": "https://stackoverflow.com/questions/50722446/uint32-t-pointer-to-the-same-location-as-uint8-t-pointer/50722834#50722834", "title": "uint32_t pointer to the same location as uint8_t pointer", "body": "<pre><code>uint32_t *test =(uint32_t*) memory;\n</code></pre>\n\n<p>uint32_t shows that the memory pointed by <code>test</code> should contain uint32_t .</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1528295693, "post_id": 50722995, "comment_id": 88454465, "body": "You might as well explain why it is not portable (not evident for everyone, I suppose)"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1528298390, "post_id": 50722995, "comment_id": 88456291, "body": "It could be noted that <code>uintxx_t</code> types <i>when they exist</i> are required to have exactly xx bits and <b>no padding bits</b>. So if that code is compiled, the result is implementation defined because of endianness, but no UB is involved and no trap representation is possible. Simply, an implementation is free to not define the <code>uintxx_t</code> types..."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 4, "last_activity_date": 1528295831, "last_edit_date": 1528295831, "creation_date": 1528295471, "answer_id": 50722995, "question_id": 50722446, "link": "https://stackoverflow.com/questions/50722446/uint32-t-pointer-to-the-same-location-as-uint8-t-pointer/50722995#50722995", "title": "uint32_t pointer to the same location as uint8_t pointer", "body": "<p>As already mentioned you cannot convert <code>uint8_t *</code> to <code>uint32_t *</code> due to strict aliasing rule, you can convert <code>uint32_t *</code> to <code>unsigned char *</code> though:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main(){\n    uint32_t test[1024/4] = {}; // initialize it!\n    auto memory = reinterpret_cast&lt;unsigned char *&gt;( test );\n    memory[0] = 1;\n    memory[1] = 1;\n    std::cout &lt;&lt; test[0] &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>this is not portable code due to <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Endianness</a>, but at least it does not have UB.</p>\n"}, {"tags": [], "owner": {"reputation": 2247, "user_id": 2746472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84c7aae0c71a20aa7b4f265a15390e5?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysiek", "link": "https://stackoverflow.com/users/2746472/krzysiek"}, "is_accepted": false, "score": 0, "last_activity_date": 1617711972, "last_edit_date": 1617711972, "creation_date": 1617711607, "answer_id": 66968536, "question_id": 50722446, "link": "https://stackoverflow.com/questions/50722446/uint32-t-pointer-to-the-same-location-as-uint8-t-pointer/66968536#66968536", "title": "uint32_t pointer to the same location as uint8_t pointer", "body": "<p>You can do that with <code>union</code>. As mentioned above, you have to be aware of endianness of target device, but in most cases it will be little-endian. And there is also a bit of <a href=\"https://stackoverflow.com/a/11996970/2746472\">controversy about using unions in such way</a>, but fwiw it's getting a job done and for some uses it's good enough.</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\nint main(){\n    union {\n        uint8_t memory[1024] = {};\n        uint32_t test[1024/4];\n    };\n    \n    memory[0] = 1;\n    memory[1] = 1;\n    std::cout &lt;&lt; test[0]; // 257\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9903770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55e655f85e089cf85b3034a8411bcb1?s=128&d=identicon&r=PG&f=1", "display_name": "Croxa", "link": "https://stackoverflow.com/users/9903770/croxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 1, "answer_count": 5, "score": 3, "last_activity_date": 1617711972, "creation_date": 1528293897, "last_edit_date": 1528294814, "question_id": 50722446, "link": "https://stackoverflow.com/questions/50722446/uint32-t-pointer-to-the-same-location-as-uint8-t-pointer", "title": "uint32_t pointer to the same location as uint8_t pointer", "body": "<pre><code>#include &lt;iostream&gt;\n\nint main(){\n    uint8_t memory[1024];\n    memory[0] = 1;\n    memory[1] = 1;\n    uint32_t *test = memory;\n    //is it possible to get a value for *test that would be in this example 257?\n}\n</code></pre>\n\n<p>I want to create a uin32_t pointer to the same adress as the uint8_t pointer. Is this possible without using new(adress)? I don't want to lose the information at the adress. I know pointers are just adresses and therefor I should be able to just set the uint32_t pointer to the same adress.<br>\nThis code produces an error: </p>\n\n<pre><code>invalid conversion from 'uint8_t*' to 'uint32_t*' in initialization\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1528293960, "post_id": 50722069, "comment_id": 88453248, "body": "As an aside, this is why <a href=\"http://en.cppreference.com/w/cpp/types/void_t\" rel=\"nofollow noreferrer\"><code>std::void_t</code></a> was added in C++17."}], "answers": [{"comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1528293807, "post_id": 50722225, "comment_id": 88453136, "body": "@rmawatson <code>test&lt;int&gt;</code> is, by the definition of your template, the same as <code>test&lt;int, void&gt;</code>. Your <code>#if 0</code> case introduces a specialisation for <code>test&lt;T, T&gt;</code>, which would be matches by <code>test&lt;int, int&gt;</code>, but not by <code>test&lt;int, void&gt;</code>."}, {"owner": {"reputation": 1759, "user_id": 6661174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OBv75.jpg?s=128&g=1", "display_name": "rmawatson", "link": "https://stackoverflow.com/users/6661174/rmawatson"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1528293894, "post_id": 50722225, "comment_id": 88453198, "body": "@Angew ahh, of course - this is the answer I was looking for -thanks."}], "tags": [], "owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "is_accepted": false, "score": 5, "last_activity_date": 1528293373, "last_edit_date": 1528293373, "creation_date": 1528293233, "answer_id": 50722225, "question_id": 50722069, "link": "https://stackoverflow.com/questions/50722069/template-class-specialization-enable-if-and-default-values/50722225#50722225", "title": "template class specialization enable_if and default values", "body": "<p>In the first case you have the type</p>\n\n<pre><code>std::enable_if&lt; true, void &gt;\n</code></pre>\n\n<p>In the second case you have the type </p>\n\n<pre><code>std::enable_if&lt; true, int &gt;\n</code></pre>\n\n<p><code>std::enable_if&lt; true, int &gt;::type</code> is <code>int</code>. It doesnt qualify a as type for <code>typename Enable</code>, which was requested to be <code>void</code></p>\n"}, {"tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 1, "last_activity_date": 1528293870, "creation_date": 1528293870, "answer_id": 50722437, "question_id": 50722069, "link": "https://stackoverflow.com/questions/50722069/template-class-specialization-enable-if-and-default-values/50722437#50722437", "title": "template class specialization enable_if and default values", "body": "<blockquote>\n  <p>My question is where in the standard is the ordering described for which template is chosen, and why is the instanciation <code>test&lt;T,void&gt;</code> considered as a better match then <code>test&lt;T,T&gt;</code>.</p>\n</blockquote>\n\n<p><a href=\"http://eel.is/c++draft/temp.class.spec.match\" rel=\"nofollow noreferrer\">[temp.class.spec.match]</a>.</p>\n\n<p>You wrote <code>test&lt;int&gt;</code>, which means that you didn't provide any template argument for the second parameter. Because it has a default parameter, it is chosen, so you actually have <code>test&lt;int, void&gt;</code>.</p>\n\n<p>Now, according to the text linked above, the template parameters are matched to a specialization.</p>\n\n<p>In the first case, the specialization is <code>test&lt;int, void&gt;</code> after evaluation, and so it is an exact match and chosen.</p>\n\n<p>In the second case, the specialization is <code>test&lt;int, int&gt;</code> after evaluation, which is not an exact match and so the primary template is chosen instead of that specialization.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 4, "last_activity_date": 1528294110, "creation_date": 1528294110, "answer_id": 50722515, "question_id": 50722069, "link": "https://stackoverflow.com/questions/50722069/template-class-specialization-enable-if-and-default-values/50722515#50722515", "title": "template class specialization enable_if and default values", "body": "<p><code>test&lt;int&gt; v;</code> is <code>test&lt;int, void&gt; v;</code> (thanks to default type).</p>\n\n<p><code>test&lt;int, int&gt; v;</code> would select your last specialization.</p>\n"}], "owner": {"reputation": 1759, "user_id": 6661174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OBv75.jpg?s=128&g=1", "display_name": "rmawatson", "link": "https://stackoverflow.com/users/6661174/rmawatson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 1, "accepted_answer_id": 50722437, "answer_count": 3, "score": 7, "last_activity_date": 1528294110, "creation_date": 1528292672, "last_edit_date": 1528293537, "question_id": 50722069, "link": "https://stackoverflow.com/questions/50722069/template-class-specialization-enable-if-and-default-values", "title": "template class specialization enable_if and default values", "body": "<p>Given the following</p>\n\n<pre><code>template &lt;typename T, typename Enable=void&gt;\nstruct test{};\n\ntemplate &lt;typename T,\n    typename std::enable_if&lt; some_trait&lt;T&gt;::value &gt;::type &gt;\nstruct test{};\n</code></pre>\n\n<p>assuming <code>some_trait&lt;T&gt;::value</code> is <code>true</code>,  <code>enable_if&lt;T&gt;::type</code> is <code>void</code>, and the specialization is selected.\nHowever, my query is related to the selection when the follow is the case.</p>\n\n<pre><code>template &lt;typename T,\n    typename std::enable_if_t&lt; some_trait&lt;T&gt;::value,T&gt;::type &gt;\nstruct test{};\n</code></pre>\n\n<p>When a second non void template parameter for <code>enable_if</code> is provided for <code>::type</code>, the unspecialized template \nis selected, even when <code>some_trait&lt;T&gt;::value</code> is <code>true</code>, as <code>::type</code> is <code>T</code> instead of <code>void</code>, and so doesn't\nmatch the default value in the primary template.</p>\n\n<p>My question is where in the standard is the ordering described for which template is chosen, and why is\nthe instanciation <code>test&lt;T,void&gt;</code> considered as a better match then <code>test&lt;T,T&gt;</code>.</p>\n\n<p><a href=\"https://ideone.com/7v4TTS\" rel=\"nofollow noreferrer\">https://ideone.com/7v4TTS</a></p>\n\n<p>full sample : </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename T,typename Enable=void&gt;\nstruct test\n{\n    const char* value = \"Primary\";\n};\n\n#if 1// toggle this\n\ntemplate &lt;typename T&gt;\nstruct test&lt;T,typename std::enable_if&lt; std::is_same&lt;T,T&gt;::value &gt;::type &gt; \n{\n    const char* value = \"Specialization\";\n};\n\n#else\n\ntemplate &lt;typename T&gt;                                    \nstruct test&lt;T,typename std::enable_if&lt; std::is_same&lt;T,T&gt;::value,T &gt;::type&gt; \n{                                                          ///  ^    \n    const char* value = \"Specialization\";\n};\n\n#endif\n\nint main() {\n    test&lt;int&gt; v;\n    std::cout &lt;&lt; v.value &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c#", "c++", "unity3d", "window"], "answers": [{"comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528294533, "post_id": 50722081, "comment_id": 88453634, "body": "<b>&quot;wanna set the Windows volume(Not the unity)&quot;</b> This is not System volume. You are setting Unity&#39;s volume. Please read the question again."}, {"owner": {"reputation": 93, "user_id": 9595938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9595938/rob"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 1, "creation_date": 1528295996, "post_id": 50722081, "comment_id": 88454659, "body": "Please read my answer again where I stated &quot;You cannot do this&quot; and asked him to provide an example of where this was done. Is that not an applicable answer?"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528296094, "post_id": 50722081, "comment_id": 88454723, "body": "You can. You can do this. Setting system Volume is different than setting the game volume. OP clearly said that. Your answer did not address the issue here"}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528302805, "post_id": 50722081, "comment_id": 88458903, "body": "@Programmer &quot;You cannot&quot; is a valid answer. In trying to see how a C# application could adjust the Windows system volume, I found <a href=\"https://stackoverflow.com/a/13139478/1663383\">this</a>, which is basically a wrapper around a C++ dll...and does not compile in Unity. Visual Studio says its fine, but Unity cannot find <code>System.Windows</code>."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1528303191, "post_id": 50722081, "comment_id": 88459105, "body": "@Draco18s &quot;You cannot is a valid answer&quot; true statement but you can. The problem is that OP said clearly stated that the volume to change is not Unity volume but this answer did just that. As for the link you provided, note that it&#39;s bad to change volume or perform task with key press. That answer may have been up-voted 100 times but it&#39;s still bad. You have to do that properly with the proper API. I plan on adding answer since no proper answer yet."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528303907, "post_id": 50722081, "comment_id": 88459494, "body": "@Programmer I&#39;m looking for other answers, but I haven&#39;t yet found one that actually works. <a href=\"https://stackoverflow.com/a/294525/1663383\">This one</a> compiles and runs (with some minor adjustments, such as marking things public and wrapping it in a class), but does not actually <i>modify</i> the volume setting."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1528304842, "post_id": 50722081, "comment_id": 88460006, "body": "<a href=\"https://blog.sverrirs.com/2016/02/windows-coreaudio-api-in-c.html\" rel=\"nofollow noreferrer\">This solution</a> appears to work, based on comments, but crashes with an Invalid Cast Exception. And that encompasses everything in the first page worth of Google results."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1528310121, "post_id": 50722081, "comment_id": 88462765, "body": "@Draco18s Saw your comment but didn&#39;t have time to reply. The proper solution is to use the Windows API. Any Windows API that can do that is fine.In this case, <code>IAudioEndpointVolume</code> is more appropriate for that. It works both for getting and setting the volume on Windows."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528314328, "post_id": 50722081, "comment_id": 88464753, "body": "@Programmer I&#39;m glad a solution <i>does exist</i> but in trying to search for it, <code>IAudioEndpointVolume</code> (and similar) do not appear."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1528315046, "post_id": 50722081, "comment_id": 88465115, "body": "@Draco18s You mean  on the internet or Visual Studio? If you mean on the internet then that&#39;s because most already end up using key press which are answers posted on every question about this topic. Haven&#39;t seen a complete example on SO about this topic that works without using key press to simulate it."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528329171, "post_id": 50722081, "comment_id": 88470041, "body": "@Programmer On the internet. And I was searching for &quot;C# change [windows|system] volume&quot;"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 1, "creation_date": 1528332591, "post_id": 50722081, "comment_id": 88470854, "body": "@Draco18s I search question like this one with C++ instead of C#. I learned that whenever you need to access or control a hardware, there is a 90 percent chances that the official API which is guaranteed to work is only available in C++. Other programming languages will just implement it with that C++ API sometimes but not most of the times. This is why other the solution in C# won&#39;t show the official API, and is usually a very long code or a short code that&#39;s not a proper way to do that such as using key press."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1528332726, "post_id": 50722081, "comment_id": 88470888, "body": "I&#39;ve also seen those that uses bunch of pointers while trying to hack into Windows dll to do a simple task that could have been with C++ right away. When you search with C# and don&#39;t find any standard API to do that then forget about it and do the search with C++. It will save you some time."}], "tags": [], "owner": {"reputation": 93, "user_id": 9595938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9595938/rob"}, "is_accepted": false, "score": 0, "last_activity_date": 1528302883, "last_edit_date": 1528302883, "creation_date": 1528292720, "answer_id": 50722081, "question_id": 50722026, "link": "https://stackoverflow.com/questions/50722026/how-to-get-and-set-system-volume-in-windows/50722081#50722081", "title": "How to Get and Set System Volume in Windows", "body": "<p>You cannot do this from what I am aware of. There would be no beneficial gain to this and have you seen this done in any game/application?  </p>\n\n<p>You can change the master volume of the Unity application, using a slider and also manage other sound effects in the same way</p>\n\n<p><a href=\"http://docs.unity3d.com/ScriptReference/AudioListener.html\" rel=\"nofollow noreferrer\">http://docs.unity3d.com/ScriptReference/AudioListener.html</a><br>\n<a href=\"http://docs.unity3d.com/ScriptReference/AudioListener-volume.html\" rel=\"nofollow noreferrer\">http://docs.unity3d.com/ScriptReference/AudioListener-volume.html</a></p>\n\n<p>Example</p>\n\n<pre><code>public class AudioControl: MonoBehaviour {\nvoid SetVolume(Slider slider) {\n    AudioListener.volume = slider.Value;\n    // probably save this value to a playerpref so it is remembered. \n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 359, "user_id": 7586762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d2ab1f2452acbaa9320e51424cb1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ismaeel", "link": "https://stackoverflow.com/users/7586762/ammar-ismaeel"}, "edited": false, "score": 1, "creation_date": 1528355605, "post_id": 50727287, "comment_id": 88477793, "body": "Exactly What I want...Thank you...Its working well :)"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 359, "user_id": 7586762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d2ab1f2452acbaa9320e51424cb1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ismaeel", "link": "https://stackoverflow.com/users/7586762/ammar-ismaeel"}, "edited": false, "score": 0, "creation_date": 1528356324, "post_id": 50727287, "comment_id": 88478252, "body": "@AmmarIsmaeel Good. Glad I was able to help."}, {"owner": {"reputation": 769, "user_id": 1459275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97b6e6e18f5679240faa05ca2b595c3a?s=128&d=identicon&r=PG", "display_name": "niltoid", "link": "https://stackoverflow.com/users/1459275/niltoid"}, "edited": false, "score": 0, "creation_date": 1547244976, "post_id": 50727287, "comment_id": 95140474, "body": "Great answer - all worked flawlessly. My DLL didn&#39;t compile until i commented out the first include:      //#include &quot;stdafx.h&quot;"}, {"owner": {"reputation": 2323, "user_id": 5170571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d3960d3070cd9362f0d87bade465fc?s=128&d=identicon&r=PG&f=1", "display_name": "sonny", "link": "https://stackoverflow.com/users/5170571/sonny"}, "edited": false, "score": 0, "creation_date": 1547591220, "post_id": 50727287, "comment_id": 95242132, "body": "Thank you! Just a note to be careful about possible DLL dependencies. A colleague of mine made a DLL based on this answer using Visual Studio 2015, but we found that on some users&#39; Windows 10 machines, there was a <a href=\"https://stackoverflow.com/q/1246486/5170571\">DLLNotFoundException even though the DLL was present</a>. This exception was actually due to missing DLL dependencies (specifically, missing Microsoft Visual C++ Redistributable). In our case, including vcruntime140.dll and api-ms-win-crt-runtime-l1-1-0.dll in the Plugins folder along with this DLL fixed the issue."}, {"owner": {"reputation": 2323, "user_id": 5170571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d3960d3070cd9362f0d87bade465fc?s=128&d=identicon&r=PG&f=1", "display_name": "sonny", "link": "https://stackoverflow.com/users/5170571/sonny"}, "edited": false, "score": 0, "creation_date": 1547671612, "post_id": 50727287, "comment_id": 95276047, "body": "Also, for anyone directly using the above code - note that <code>defaultDevice</code> can be <code>null</code> if <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint\" rel=\"nofollow noreferrer\"><code>IMMDeviceEnumerator.GetDefaultAudioEndpoint</code></a> fails or if no device is available, which will then cause a Unity crash. Specifically, I ran into this issue on one user&#39;s machine where there were no valid sound playback devices due to a driver issue. (See <code>Control Panel -&gt; Sound -&gt; Playback</code> and disable all devices to test for this.)"}], "tags": [], "owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "is_accepted": true, "score": 13, "last_activity_date": 1547740989, "last_edit_date": 1547740989, "creation_date": 1528309994, "answer_id": 50727287, "question_id": 50722026, "link": "https://stackoverflow.com/questions/50722026/how-to-get-and-set-system-volume-in-windows/50727287#50727287", "title": "How to Get and Set System Volume in Windows", "body": "<p>This requires a plugin. Since this question is for Windows, you can use <a href=\"https://msdn.microsoft.com/en-us/library/aa964574.aspx\" rel=\"noreferrer\"><code>IAudioEndpointVolume</code></a> to build a <a href=\"https://stackoverflow.com/questions/49793560/build-c-plugin-for-unity/49795660?s=1%7C47.3947#49795660\">C++ plugin</a> then call it from C#. <a href=\"https://blogs.msdn.microsoft.com/larryosterman/2007/03/06/how-do-i-change-the-master-volume-in-windows-vista/\" rel=\"noreferrer\">This</a> post has a working C++ example of how to change volume with <code>IAudioEndpointVolume</code> and you can use it as the base source to create the C++ plugin.</p>\n\n<hr>\n\n<p>I've gone ahead and cleaned that code up then converted into a dll plugin and placed the DLL at Assets/Plugins folder. You can see how to build the C++ plugin <a href=\"https://stackoverflow.com/questions/49793560/build-c-plugin-for-unity/49795660?s=1%7C47.3947#49795660\">here</a>.</p>\n\n<p><strong>The C++ code</strong>:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;windows.h&gt;\n#include &lt;mmdeviceapi.h&gt;\n#include &lt;endpointvolume.h&gt;\n\n#define DLLExport __declspec(dllexport)\n\nextern \"C\"\n{\n    enum class VolumeUnit {\n        Decibel,\n        Scalar\n    };\n\n    //Gets volume\n    DLLExport float GetSystemVolume(VolumeUnit vUnit) {\n        HRESULT hr;\n\n        // -------------------------\n        CoInitialize(NULL);\n        IMMDeviceEnumerator *deviceEnumerator = NULL;\n        hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL, CLSCTX_INPROC_SERVER, __uuidof(IMMDeviceEnumerator), (LPVOID *)&amp;deviceEnumerator);\n        IMMDevice *defaultDevice = NULL;\n\n        hr = deviceEnumerator-&gt;GetDefaultAudioEndpoint(eRender, eConsole, &amp;defaultDevice);\n        deviceEnumerator-&gt;Release();\n        deviceEnumerator = NULL;\n\n        IAudioEndpointVolume *endpointVolume = NULL;\n        hr = defaultDevice-&gt;Activate(__uuidof(IAudioEndpointVolume), CLSCTX_INPROC_SERVER, NULL, (LPVOID *)&amp;endpointVolume);\n        defaultDevice-&gt;Release();\n        defaultDevice = NULL;\n\n        float currentVolume = 0;\n        if (vUnit == VolumeUnit::Decibel) {\n            //Current volume in dB\n            hr = endpointVolume-&gt;GetMasterVolumeLevel(&amp;currentVolume);\n        }\n\n        else if (vUnit == VolumeUnit::Scalar) {\n            //Current volume as a scalar\n            hr = endpointVolume-&gt;GetMasterVolumeLevelScalar(&amp;currentVolume);\n        }\n        endpointVolume-&gt;Release();\n        CoUninitialize();\n\n        return currentVolume;\n    }\n\n    //Sets volume\n    DLLExport void SetSystemVolume(double newVolume, VolumeUnit vUnit) {\n        HRESULT hr;\n\n        // -------------------------\n        CoInitialize(NULL);\n        IMMDeviceEnumerator *deviceEnumerator = NULL;\n        hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL, CLSCTX_INPROC_SERVER, __uuidof(IMMDeviceEnumerator), (LPVOID *)&amp;deviceEnumerator);\n        IMMDevice *defaultDevice = NULL;\n\n        hr = deviceEnumerator-&gt;GetDefaultAudioEndpoint(eRender, eConsole, &amp;defaultDevice);\n        deviceEnumerator-&gt;Release();\n        deviceEnumerator = NULL;\n\n        IAudioEndpointVolume *endpointVolume = NULL;\n        hr = defaultDevice-&gt;Activate(__uuidof(IAudioEndpointVolume), CLSCTX_INPROC_SERVER, NULL, (LPVOID *)&amp;endpointVolume);\n        defaultDevice-&gt;Release();\n        defaultDevice = NULL;\n\n        if (vUnit == VolumeUnit::Decibel)\n            hr = endpointVolume-&gt;SetMasterVolumeLevel((float)newVolume, NULL);\n\n        else    if (vUnit == VolumeUnit::Scalar)\n            hr = endpointVolume-&gt;SetMasterVolumeLevelScalar((float)newVolume, NULL);\n\n        endpointVolume-&gt;Release();\n\n        CoUninitialize();\n    }\n}\n</code></pre>\n\n<p><strong>The C# code</strong>:</p>\n\n<pre><code>using System.Runtime.InteropServices;\nusing UnityEngine;\n\npublic class VolumeManager : MonoBehaviour\n{\n    //The Unit to use when getting and setting the volume\n    public enum VolumeUnit\n    {\n        //Perform volume action in decibels&lt;/param&gt;\n        Decibel,\n        //Perform volume action in scalar\n        Scalar\n    }\n\n    /// &lt;summary&gt;\n    /// Gets the current volume\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"vUnit\"&gt;The unit to report the current volume in&lt;/param&gt;\n    [DllImport(\"ChangeVolumeWindows\")]\n    public static extern float GetSystemVolume(VolumeUnit vUnit);\n    /// &lt;summary&gt;\n    /// sets the current volume\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"newVolume\"&gt;The new volume to set&lt;/param&gt;\n    /// &lt;param name=\"vUnit\"&gt;The unit to set the current volume in&lt;/param&gt;\n    [DllImport(\"ChangeVolumeWindows\")]\n    public static extern void SetSystemVolume(double newVolume, VolumeUnit vUnit);\n\n    // Use this for initialization\n    void Start()\n    {\n        //Get volume in Decibel \n        float volumeDecibel = GetSystemVolume(VolumeUnit.Decibel);\n        Debug.Log(\"Volume in Decibel: \" + volumeDecibel);\n\n        //Get volume in Scalar \n        float volumeScalar = GetSystemVolume(VolumeUnit.Scalar);\n        Debug.Log(\"Volume in Scalar: \" + volumeScalar);\n\n        //Set volume in Decibel \n        SetSystemVolume(-16f, VolumeUnit.Decibel);\n\n        //Set volume in Scalar \n        SetSystemVolume(0.70f, VolumeUnit.Scalar);\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>The <code>GetSystemVolume</code> function is used to get the current volume and <code>SetSystemVolume</code> is used to set it. This question is for Windows but you can do a similar thing with the API for other platforms.</p>\n\n<p>To set it to <code>70%</code> when A key is pressed:</p>\n\n<pre><code>void Update()\n{\n    if (Input.GetKeyDown(KeyCode.A))\n    {\n        //Set Windows Volume 70%  \n        SetSystemVolume(0.70f, VolumeUnit.Scalar);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 7586762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d2ab1f2452acbaa9320e51424cb1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ismaeel", "link": "https://stackoverflow.com/users/7586762/ammar-ismaeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5888, "favorite_count": 2, "accepted_answer_id": 50727287, "answer_count": 2, "score": 5, "last_activity_date": 1547740989, "creation_date": 1528292540, "last_edit_date": 1528310173, "question_id": 50722026, "link": "https://stackoverflow.com/questions/50722026/how-to-get-and-set-system-volume-in-windows", "title": "How to Get and Set System Volume in Windows", "body": "<p>I wanna set the OS volume on a certain level on keyboard click using unity and c# for example I wanna set the Windows volume(Not the unity) to 70: How Can I do that???</p>\n\n<pre><code>void Update()\n{   \n    if (Input.GetKeyDown(KeyCode.A))\n    {\n        //Set Windows Volume 70%      \n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "sdl-2"], "comments": [{"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 1, "creation_date": 1528292709, "post_id": 50721989, "comment_id": 88452434, "body": "Do you have a solid understanding of how mutexes work? You don&#39;t protect access by locking a variable, you protect concurrent thread access by mutual exclusion: whenever the variable is accessed, make sure that thread takes a specific lock for it first."}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1528292885, "post_id": 50721989, "comment_id": 88452526, "body": "Upvoting for the use of mutexes while you&#39;re learning multithreading. Not everyone does --- <i>looks at myself</i>"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528293431, "post_id": 50721989, "comment_id": 88452880, "body": "When do you assign <code>map.kill_chunk_loader_thread</code>, to 0 or 1?  I&#39;d put breakpoints on those and check that that&#39;s getting set as expected"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1528293598, "post_id": 50721989, "comment_id": 88452991, "body": "Read some <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">POSIX thread tutorial</a>. Consider perhaps using <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic\" rel=\"nofollow noreferrer\">std::atomic_bool</a> and its <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/load\" rel=\"nofollow noreferrer\">load</a> &amp; <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/store\" rel=\"nofollow noreferrer\">store</a>"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1528297137, "post_id": 50721989, "comment_id": 88455420, "body": "Expanding on what Josh Detwiler said, if you want to protect a variable, or a <i>group</i> of related variables, it&#39;s up to you to make sure that there&#39;s no place in your code that uses the variable(s) when the mutex is not locked. Also, it&#39;s up to you to make sure that it&#39;s always the <i>same</i> mutex. (Locking the wrong mutex is a common rookie mistake.)"}, {"owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "reply_to_user": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1528305620, "post_id": 50721989, "comment_id": 88460412, "body": "@JoshDetwiler im not realy sure if i fully understood it. I read somewhere that only one thread should read and write a variable at a time. so i put a mutex around every part that reads and writes that variable. is that the right way ?"}, {"owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528305689, "post_id": 50721989, "comment_id": 88460448, "body": "@UKMonkey i expanded my code in the question a little bit more. I will try using breakpoints"}, {"owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1528305770, "post_id": 50721989, "comment_id": 88460490, "body": "@BasileStarynkevitch thanks i will look into it."}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1528306295, "post_id": 50721989, "comment_id": 88460787, "body": "<code>Map map = *(Map*)data;</code> that is really weird. Looks like you operate on different copies of <code>map</code> in different threads?"}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1528307002, "post_id": 50721989, "comment_id": 88461196, "body": "@just_some_dude This might help you better understand locks and thread safety: <a href=\"https://courses.cs.vt.edu/~cs3214/spring2018/lectures/Lecture-Multithreading-Locking.pdf\" rel=\"nofollow noreferrer\">Multithreading &amp; Locking</a>."}, {"owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1528307863, "post_id": 50721989, "comment_id": 88461657, "body": "@keltar im stupid. Your right im copying map there and that  explains why kill_chunk_loader_thread is never set to true in the copy. Thanks a lot. Does someone know how i should go about marking the solution ?"}, {"owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "reply_to_user": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1528307925, "post_id": 50721989, "comment_id": 88461691, "body": "@JoshDetwiler Thanks! i will read what ever i can get my hands on"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "edited": false, "score": 0, "creation_date": 1528305283, "post_id": 50722691, "comment_id": 88460237, "body": "expanded the sourcecode a little. im giving a pointer to the instance of the Map class to the thread. its the one and only instance of this class."}], "tags": [], "owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "is_accepted": true, "score": 2, "last_activity_date": 1528359178, "last_edit_date": 1528359178, "creation_date": 1528294585, "answer_id": 50722691, "question_id": 50721989, "link": "https://stackoverflow.com/questions/50721989/how-do-i-lock-access-to-a-bool-with-a-mutex/50722691#50722691", "title": "how do i lock access to a bool with a mutex?", "body": "<p>First of all, you should try to upload a minimal complete program in the question.</p>\n\n<p>Its look like you set <code>kill_chunk_loader_thread = true</code> <p>\nbut you didn't set <code>map.kill_chunk_loader_thread = true</code> <p></p>\n\n<p>the section of <code>map</code> declaration is missig from your question, but I guess you didn't use a reference to the local or global variable, or you just perform struct  copy so when you change one struct the other doesn't been affected at all.</p>\n\n<p><strong>EDIT:</strong> <P>\n<code>Map map = *(Map*)data;</code> copies the <code>map</code> structure (default copy constructor, I guess) so from now on if the source map change the copy won't.</p>\n\n<p>You should keep work with the pointer, like this: <code>Map* pMap = (Map*)data;</code>\nand check the pointer like this: <code>kill_this_thread = pMap-&gt;kill_chunk_loader_thread;</code> so you read from the source map.</p>\n"}], "owner": {"reputation": 77, "user_id": 4442525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a69735ada46c63d7c6ff3c32d8b40dd?s=128&d=identicon&r=PG&f=1", "display_name": "just_some_dude", "link": "https://stackoverflow.com/users/4442525/just-some-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 50722691, "answer_count": 1, "score": 3, "last_activity_date": 1528359178, "creation_date": 1528292444, "last_edit_date": 1528308111, "question_id": 50721989, "link": "https://stackoverflow.com/questions/50721989/how-do-i-lock-access-to-a-bool-with-a-mutex", "title": "how do i lock access to a bool with a mutex?", "body": "<p><strong>solved!: im copying the instance of Map in the new Thread an dont use the reference.</strong></p>\n\n<p>im learning how to use multiple threads. For this im programing a little game where i want the game to run in the main thread and the next chunk of the level shall be loaded in another thread. for this i set up a mutex around a vector to tell the loading thread what to load next. inside this mutex i also have a boolean to tell the thread when tu terminate.</p>\n\n<p><strong>initialising thread in Map::Map()</strong></p>\n\n<pre><code>pending_orders_mutex = SDL_CreateMutex();\ncan_process_order = SDL_CreateCond();\nchunk_loader_thread = SDL_CreateThread(Map::chunk_loader,\"chunk_loader_thread\",(void*)this);\n</code></pre>\n\n<p><strong>loading thread</strong></p>\n\n<pre><code>int Map::chunk_loader(void * data)\n{\n    Map map = *(Map*)data;\n    bool kill_this_thread = false;\n\n    Chunk_Order actual_order;\n    actual_order.load_graphics = false;\n    actual_order.x = 0;\n    actual_order.y = 0;\n\n\n\n    while (!kill_this_thread)\n    {\n        SDL_LockMutex(map.pending_orders_mutex);            // lock mutex\n        printf(\"3-kill_chunk_loader_thread: %d\\n\", map.kill_chunk_loader_thread);\n        kill_this_thread = map.kill_chunk_loader_thread;\n        printf(\"4-kill_chunk_loader_thread: %d\\n\", map.kill_chunk_loader_thread);\n        if (!kill_this_thread)\n        {\n            if (map.pending_orders.size())\n            {\n                actual_order = map.pending_orders.back();\n                map.pending_orders.pop_back();\n                printf(\"in thread processing order\\n\");\n            }\n            else\n            {\n                printf(\"in thread waiting for order\\n\");\n                SDL_CondWait(map.can_process_order, map.pending_orders_mutex);\n            }\n        }\n        SDL_UnlockMutex(map.pending_orders_mutex);          // unlock mutex\n\n        //load actual order\n    }\n    printf(\"thread got killed\\n\");\n    return 0;\n}\n</code></pre>\n\n<p><strong>killing the thread (main thread)</strong></p>\n\n<pre><code>SDL_LockMutex(pending_orders_mutex);            // lock mutex\n  printf(\"setting kill command\\n\");\n  printf(\"1-kill_chunk_loader_thread: %d\\n\", kill_chunk_loader_thread);\nkill_chunk_loader_thread = true;                // send kill command\n  printf(\"2-kill_chunk_loader_thread: %d\\n\", kill_chunk_loader_thread);\nSDL_CondSignal(can_process_order);              // signal that order was pushed\nSDL_UnlockMutex(pending_orders_mutex);          // unlock mutex\n\nSDL_WaitThread(chunk_loader_thread, NULL);\n</code></pre>\n\n<p><strong>console output</strong></p>\n\n<pre><code>3-kill_chunk_loader_thread: 0\n4-kill_chunk_loader_thread: 0\nin thread waiting for order\nsetting kill command\n1-kill_chunk_loader_thread: 0\n2-kill_chunk_loader_thread: 1\n3-kill_chunk_loader_thread: 0\n4-kill_chunk_loader_thread: 0\nin thread waiting for order\n</code></pre>\n\n<p>why does the mainthread not change the \"kill_chunk_loader_thread\" boolean in the loading thread?</p>\n"}, {"tags": ["c++", "opencv", "nan", "divide"], "owner": {"reputation": 11, "user_id": 9903482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zs9bnBvak4M/AAAAAAAAAAI/AAAAAAAAAB4/ixwbahHGbd0/photo.jpg?sz=128", "display_name": "tydu", "link": "https://stackoverflow.com/users/9903482/tydu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1528292395, "creation_date": 1528292395, "question_id": 50721970, "link": "https://stackoverflow.com/questions/50721970/is-that-a-bug-while-using-cvdivide-or-with-nan", "title": "Is that a bug while using cv::divide or / with NAN\uff1f", "body": "<p>I'm using <code>cv::divide</code> and just found a strange bug:</p>\n\n<p>Assume there's a NAN in Mat and the Mat has more than 3 elements. If the Mat is denominator, the result will be all NAN no matter which position is the NAN.</p>\n\n<p>I defined NAN in such way:</p>\n\n<pre><code>float const NAN_f = numeric_limits&lt;float&gt;::quiet_NaN();\n</code></pre>\n\n<p>And here is the code:</p>\n\n<pre><code>Mat A4 = (Mat_&lt;float&gt;(1, 4) &lt;&lt; 1, NAN_f, 2, 3);\nMat B4 = (Mat_&lt;float&gt;(1, 4) &lt;&lt; 4, 5, 5, 6);\nMat A4_B4;\nMat B4_A4;\ndivide(A4, B4, A4_B4);\ndivide(B4, A4, B4_A4);\ncout &lt;&lt; A4_B4 &lt;&lt; endl;\ncout &lt;&lt; B4_A4 &lt;&lt; endl;\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>[0.25, nan, 0.40000001, 0.5]\n[nan, nan, nan, nan]\n</code></pre>\n\n<p>by the way, the slash <code>/</code> would get same wrong result:</p>\n\n<pre><code>cout &lt;&lt; A4 / B4 &lt;&lt; endl;\ncout &lt;&lt; B4 / A4 &lt;&lt; endl;\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>[0.25, nan, 0.40000001, 0.5]\n[nan, nan, nan, nan]\n</code></pre>\n\n<hr>\n\n<p>BUT, if the Mat is less than 4 elements, the divide function or <code>/</code> would output correct result:</p>\n\n<pre><code>Mat A3 = (Mat_&lt;float&gt;(1, 3) &lt;&lt; 1, 2, NAN_f);\nMat B3 = (Mat_&lt;float&gt;(1, 3) &lt;&lt; 4, 5, 6);\nMat A3_B3;\nMat B3_A3;\ndivide(A3, B3, A3_B3);\ndivide(B3, A3, B3_A3);\ncout &lt;&lt; A3_B3 &lt;&lt; endl;\ncout &lt;&lt; B3_A3 &lt;&lt; endl;\ncout &lt;&lt; A3 / B3 &lt;&lt; endl;\ncout &lt;&lt; B3 / A3 &lt;&lt; endl;\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>[0.25, 0.40000001, nan]\n[4, 2.5, nan]\n[0.25, 0.40000001, nan]\n[4, 2.5, nan]\n</code></pre>\n\n<hr>\n\n<p>And if the Mat has 5 elements, the 5-th element of result is correct and the rest 4 are NANs:</p>\n\n<pre><code>Mat A5 = (Mat_&lt;float&gt;(1, 5) &lt;&lt; 1, NAN_f, 2, 3, 4);\nMat B5 = (Mat_&lt;float&gt;(1, 5) &lt;&lt; 4, 5, 6, 7, 8);\nMat A5_B5;\nMat B5_A5;\ndivide(A5, B5, A5_B5);\ndivide(B5, A5, B5_A5);\ncout &lt;&lt; A5_B5 &lt;&lt; endl;\ncout &lt;&lt; B5_A5 &lt;&lt; endl;\ncout &lt;&lt; A5 / B5 &lt;&lt; endl;\ncout &lt;&lt; B5 / A5 &lt;&lt; endl;\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>[0.25, nan, 0.33333334, 0.42857143, 0.5]\n[nan, nan, nan, nan, 2]\n[0.25, nan, 0.33333334, 0.42857143, 0.5]\n[nan, nan, nan, nan, 2]\n</code></pre>\n\n<hr>\n\n<p>I'm just wondering whether this is a bur or is just a special characteristic of divide in opencv.My opencv version is 2.4.8.</p>\n\n<pre><code>#define CV_VERSION_EPOCH    2\n#define CV_VERSION_MAJOR    4\n#define CV_VERSION_MINOR    8\n#define CV_VERSION_REVISION 0\n</code></pre>\n\n<p>And is there any solution to solve the NAN divide problem <strong>except</strong> write an  element-wise divide function in loop?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c++11", "gcc", "std", "allocator"], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 9903503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf71f19def9044d001dca080cd6a996?s=128&d=identicon&r=PG&f=1", "display_name": "amakh", "link": "https://stackoverflow.com/users/9903503/amakh"}, "edited": false, "score": 0, "creation_date": 1528297139, "post_id": 50723210, "comment_id": 88455424, "body": "I feel you are right but there are some minor caveats: 1) I believe that should read <code>::operator delete(p, n*sizeof(T));</code>?                                                                                                                                                                            2) The corresponding operator overload seems to be available only since C++14. I am actually forced to use C++11. What would be the equivalent there? 3) Is the cplusplus.com example I linked above &quot;correct&quot;? Why doesn&#39;t it produce any violation (according to AddressSanitizer)?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 48, "user_id": 9903503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf71f19def9044d001dca080cd6a996?s=128&d=identicon&r=PG&f=1", "display_name": "amakh", "link": "https://stackoverflow.com/users/9903503/amakh"}, "edited": false, "score": 0, "creation_date": 1528297618, "post_id": 50723210, "comment_id": 88455740, "body": "@amakh See my edits.  The example is flawed.  It works in that case because they&#39;re using it with <code>int</code>, which does nothing when destroyed."}, {"owner": {"reputation": 48, "user_id": 9903503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf71f19def9044d001dca080cd6a996?s=128&d=identicon&r=PG&f=1", "display_name": "amakh", "link": "https://stackoverflow.com/users/9903503/amakh"}, "edited": false, "score": 0, "creation_date": 1528297970, "post_id": 50723210, "comment_id": 88456004, "body": "Great, thanks! AddressSanitizer does report an issue with <code>::operator delete(p, n)</code> though: <code>object passed to delete has wrong type:   size of the allocated type:   16 bytes;   size of the deallocated type: 1 bytes.</code> Using <code>n*sizeof(T)</code> fixes that."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 48, "user_id": 9903503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf71f19def9044d001dca080cd6a996?s=128&d=identicon&r=PG&f=1", "display_name": "amakh", "link": "https://stackoverflow.com/users/9903503/amakh"}, "edited": false, "score": 0, "creation_date": 1528298282, "post_id": 50723210, "comment_id": 88456215, "body": "@amakh I&#39;ve edited again.  I hadn&#39;t completely thought thru what I looking at."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 1, "last_activity_date": 1528298238, "last_edit_date": 1528298238, "creation_date": 1528296131, "answer_id": 50723210, "question_id": 50721756, "link": "https://stackoverflow.com/questions/50721756/segfault-in-minimal-example-of-scoped-allocator-adaptor-used-with-vector-of-unor/50723210#50723210", "title": "Segfault in minimal example of scoped_allocator_adaptor used with vector of unordered_map", "body": "<p>Your <code>allocate</code> function allocates a bunch of bytes, but does not call any constructors (by directly invoking the <code>operator new</code> global function).  Your <code>deallocate</code> function invokes <code>delete</code> on a typed pointer, which results in the destructor for that type being called before the global <code>operator delete</code> function is called to free the memory.  The end result is that you destruct memory that you did not construct (the construction and destruction are handled by the caller after/before your <code>allocate</code>/<code>deallocate</code> functions are called.</p>\n\n<p>You should be releasing the memory using a complementary method to the way you allocate it.  In C++14 or later, this would be:</p>\n\n<pre><code>void deallocate (T* p, std::size_t n) { ::operator delete(p, n * sizeof(T)); }\n</code></pre>\n\n<p>where <code>n</code> is value passed to <code>allocate</code>, and the second parameter is the value passed to <code>new</code>.  Prior to C++14, just relay to the single parameter version (which is what the default two parameter operator delete will do):</p>\n\n<pre><code>void deallocate (T* p, std::size_t n) { ::operator delete(p); }\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 9903503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf71f19def9044d001dca080cd6a996?s=128&d=identicon&r=PG&f=1", "display_name": "amakh", "link": "https://stackoverflow.com/users/9903503/amakh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50723210, "answer_count": 1, "score": 2, "last_activity_date": 1528298238, "creation_date": 1528291807, "last_edit_date": 1528294035, "question_id": 50721756, "link": "https://stackoverflow.com/questions/50721756/segfault-in-minimal-example-of-scoped-allocator-adaptor-used-with-vector-of-unor", "title": "Segfault in minimal example of scoped_allocator_adaptor used with vector of unordered_map", "body": "<p>I have recently learned about custom allocators in C++11 and am trying to use them in my application. However I am running into a segfault, which can be reproduced by the following minimal example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;vector&gt;\n#include &lt;unordered_map&gt;\n#include &lt;scoped_allocator&gt;\n\ntemplate&lt;class T&gt; struct custom_allocator {\n    typedef T value_type;\n    custom_allocator() noexcept {}\n    template &lt;class U&gt; custom_allocator (const custom_allocator&lt;U&gt;&amp;) noexcept {}\n    T* allocate (std::size_t n) { return static_cast&lt;T*&gt;(::operator new(n*sizeof(T))); }\n    void deallocate (T* p, std::size_t n) { ::delete(p); }\n    template &lt;typename U&gt; constexpr bool operator==(const custom_allocator&lt;U&gt;&amp;) const { return true; }\n    template &lt;typename U&gt; constexpr bool operator!=(const custom_allocator&lt;U&gt;&amp;) const { return false; }\n};\n\ntemplate&lt;class T&gt; using custom_scoped_allocator = std::scoped_allocator_adaptor&lt;custom_allocator&lt;T&gt; &gt;;\n\ntypedef std::unordered_map&lt;int, int, std::hash&lt;int&gt;, std::equal_to&lt;int&gt;,\n                           custom_scoped_allocator&lt;std::pair&lt;const int, int&gt; &gt; &gt; MyMap;\n\ntypedef std::vector&lt;MyMap, custom_scoped_allocator&lt;MyMap&gt; &gt; MyVector;\n\nint main() {\n    MyVector vec(1);\n    vec[0][0] = 0;\n    return 0;\n}\n</code></pre>\n\n<p>The custom allocator is exactly the one suggested in the example at\n<a href=\"http://www.cplusplus.com/reference/memory/allocator_traits/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/memory/allocator_traits/</a>\nIt is then combined with <code>std::scoped_allocator_adaptor</code> as I have seen suggested in a few places on the internet.</p>\n\n<p>The code compiles fine with gcc 5.4.0 using <code>g++ -g3 -O0 -std=c++11 -march=core-avx-i -o tmpalloc tmpalloc.cpp</code>. When I attempt to run it, a segfault is reported starting with</p>\n\n<pre><code>*** Error in `./tmpalloc': double free or corruption (fasttop): 0x0000000000ae3c90 ***\n</code></pre>\n\n<p>If I recompile using AddressSanitizer, I get the following details about the double free: <a href=\"https://pastebin.com/raw/xy2NQtD0\" rel=\"nofollow noreferrer\">https://pastebin.com/raw/xy2NQtD0</a>\n(Sorry for the pastebin but it is not pretty.)\nBasically, the destructor for an unordered_map object seems to be called twice.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++", "video", "timestamp", "gstreamer"], "comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1528290145, "post_id": 50720911, "comment_id": 88450552, "body": "What version? According to the <a href=\"https://github.com/GStreamer/gstreamer/blob/master/gst/gstbuffer.h\" rel=\"nofollow noreferrer\">public repository</a>, you need at least 1.14."}, {"owner": {"reputation": 770, "user_id": 4834108, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9ff8c9a23c77cf9ed7aeeb0709f54985?s=128&d=identicon&r=PG&f=1", "display_name": "skr_robo", "link": "https://stackoverflow.com/users/4834108/skr-robo"}, "reply_to_user": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1528290209, "post_id": 50720911, "comment_id": 88450589, "body": "That&#39;s one area I am a bit confused about. I will include an edit in the question explaining it."}, {"owner": {"reputation": 1113, "user_id": 3336541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a2fe96f859a541bd9f0fb375800922d?s=128&d=identicon&r=PG", "display_name": "Prabhakar Lad", "link": "https://stackoverflow.com/users/3336541/prabhakar-lad"}, "edited": false, "score": 1, "creation_date": 1528383333, "post_id": 50720911, "comment_id": 88496349, "body": "you will have to manually install the latest version of gstreamer (as debian packages for Ubuntu are not up to date of latest gstreamer releases), you can follow this link to install <a href=\"http://www.linuxfromscratch.org/blfs/view/svn/multimedia/gstreamer10.html\" rel=\"nofollow noreferrer\">linuxfromscratch.org/blfs/view/svn/multimedia/gstreamer10.ht&zwnj;&#8203;ml</a>"}], "owner": {"reputation": 770, "user_id": 4834108, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9ff8c9a23c77cf9ed7aeeb0709f54985?s=128&d=identicon&r=PG&f=1", "display_name": "skr_robo", "link": "https://stackoverflow.com/users/4834108/skr-robo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528292456, "creation_date": 1528289508, "last_edit_date": 1528292456, "question_id": 50720911, "link": "https://stackoverflow.com/questions/50720911/c-gstreamer-using-gst-buffer-get-reference-timestamp-meta-function", "title": "C++ / Gstreamer - Using gst_buffer_get_reference_timestamp_meta function", "body": "<p>I am trying to use alternative timestamp with an existing gstreamer based video acquisition code. I am not allowed to post the code and have little expertise with Gstreamer, to provide a minimal example for this case. I am currently looking for a method to use the function:</p>\n\n<pre><code>gst_buffer_get_reference_timestamp_meta (GstBuffer * buffer,\nGstCaps * reference)\n</code></pre>\n\n<p>My code has the following line:</p>\n\n<pre><code>std::cout &lt;&lt; \"Ref timestamp meta: \" &lt;&lt; gst_buffer_get_reference_timestamp_meta(buf, sample_caps) &lt;&lt; std::endl;\n</code></pre>\n\n<p>However, this throws the error:</p>\n\n<pre><code>'gst_buffer_get_reference_timestamp_meta' was not declared in this scope\n</code></pre>\n\n<p>I tried adding <code>#include &lt;gst/gstbuffer.h&gt;</code> other than <code>gst.h</code>, but this did not resolve the issue. I also tried reinstalling Gstreamer. </p>\n\n<p>I suspect that <code>sample_caps</code> is not the appropriate kind of <code>GstCaps</code> element; but I don't think that it should throw a declaration error as it satisfies the <code>type</code> requirement for the second argument. Kindly provide suggestions.</p>\n\n<p><strong>Edit1:</strong>\nWhen I check the version of Gstreamer using <code>dpkg -l|grep gstreamer</code>, it returns a few lines similar to:</p>\n\n<p><code>ii  gir1.2-gstreamer-1.0                        1.8.3-1~ubuntu0.1                            amd64        GObject introspection data for the GStreamer library</code></p>\n\n<p>When I run <code>gst-launch-1.0 --gst-version</code>, it returns:</p>\n\n<pre><code>GStreamer Core Library version 1.8.3\n</code></pre>\n\n<p>As pointed out in comments, the above function requires API 1.14 or above. But I am not sure if it is referring to Core Library version. My installation command in Ubuntu was:</p>\n\n<p><code>sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools</code> </p>\n\n<p>I tried running the command with <code>1.14</code> instead of <code>1.0</code>, but didn't work. Also, <code>gst-inspect-1.0 --version</code> returns:</p>\n\n<pre><code>gst-inspect-1.0 version 1.8.3\nGStreamer 1.8.3\nhttps://launchpad.net/distros/ubuntu/+source/gstreamer1.0\n</code></pre>\n"}, {"tags": ["c++", "compare", "uint8t", "uint16"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1528289689, "post_id": 50720895, "comment_id": 88450251, "body": "Given that <code>y</code> is an unsigned value, can you <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">explain to your rubber duck</a> how could <code>y</code> possibly be ever less than 0?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 2, "creation_date": 1528289716, "post_id": 50720895, "comment_id": 88450269, "body": "<code>if ( y &lt; 0 )</code> this will never be true. <code>y</code> is an unsigned integer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1528289909, "post_id": 50720895, "comment_id": 88450397, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/12938053/detect-integer-overflow-in-input\">Detect Integer Overflow in Input</a>"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1528290084, "post_id": 50720895, "comment_id": 88450516, "body": "<a href=\"https://godbolt.org/g/TCuznK\" rel=\"nofollow noreferrer\">GCC warns</a> about this by the way."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1528290351, "post_id": 50720895, "comment_id": 88450685, "body": "One problem is that <code>uint8_t</code> might be <code>unsigned char</code> and <code>istream</code> has an <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt2\" rel=\"nofollow noreferrer\"><code>operator&gt;&gt;</code></a> that reads this as a character and not as a number."}, {"owner": {"reputation": 154, "user_id": 6708476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35fefeff0f21ee566df4cbe2a670cf17?s=128&d=identicon&r=PG&f=1", "display_name": "gerrard2461", "link": "https://stackoverflow.com/users/6708476/gerrard2461"}, "edited": false, "score": 0, "creation_date": 1528357564, "post_id": 50720895, "comment_id": 88478917, "body": "Sorry for compare y to zero in fact i would like to compare to zero i would like if y ==0"}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 6708476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35fefeff0f21ee566df4cbe2a670cf17?s=128&d=identicon&r=PG&f=1", "display_name": "gerrard2461", "link": "https://stackoverflow.com/users/6708476/gerrard2461"}, "edited": false, "score": 0, "creation_date": 1528358038, "post_id": 50721532, "comment_id": 88479198, "body": "yeah , i see that but i would like to oblige the user to enter a correct number of byte to a given variable type."}], "tags": [], "owner": {"reputation": 2023, "user_id": 2309279, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b6f77ad82a31d963002374d9287f1397?s=128&d=identicon&r=PG", "display_name": "KostasRim", "link": "https://stackoverflow.com/users/2309279/kostasrim"}, "is_accepted": false, "score": 0, "last_activity_date": 1528291461, "last_edit_date": 1528291461, "creation_date": 1528291158, "answer_id": 50721532, "question_id": 50720895, "link": "https://stackoverflow.com/questions/50720895/compare-uint8-t-and-uint16-t-in-c/50721532#50721532", "title": "Compare uint8_t and uint16_t in c++", "body": "<p>The problem with the above code is that you are testing for a <code>negative</code> value in an <code>unsigned integer</code>. The <code>if(y &lt; 0)</code> part will always be false. </p>\n\n<p>Now, from my understanding you want to filter values that are greater than <code>1Byte</code>. You know, that for a given <code>byte</code> you have <code>2^8 - 1</code> range of values, that is, the unsigned number lies in the range <code>[0-255]</code>. Thus, your problem is reduced to a simple check, that is, <code>if the input value is greater than 255, throw away that input</code>. (Ofc you have to check for <code>&lt; 0</code> values)</p>\n\n<p>There are other solutions to this but without any context I can't provide a precise answer. Hope the above simplification helps.</p>\n"}, {"comments": [{"owner": {"reputation": 154, "user_id": 6708476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35fefeff0f21ee566df4cbe2a670cf17?s=128&d=identicon&r=PG&f=1", "display_name": "gerrard2461", "link": "https://stackoverflow.com/users/6708476/gerrard2461"}, "edited": false, "score": 0, "creation_date": 1528357954, "post_id": 50722434, "comment_id": 88479143, "body": "and when i enter a tempX 0xfffff..uint16_t can&#39;t support it."}], "tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": false, "score": 0, "last_activity_date": 1528293860, "creation_date": 1528293860, "answer_id": 50722434, "question_id": 50720895, "link": "https://stackoverflow.com/questions/50720895/compare-uint8-t-and-uint16-t-in-c/50722434#50722434", "title": "Compare uint8_t and uint16_t in c++", "body": "<p>In order to check if a value is in the range of a small type, you have to assign it to a bigger type first. You simply cannot do the check with the small type itself because it can never contain that too huge value you want to check for.</p>\n\n<pre><code>uint16_t tempX;\nuint8_t x;\ncin &gt;&gt; hex &gt;&gt; tempX;\nif (tempX &gt; 0xff)\n    cout &lt;&lt; \"error\";\nelse\n    x = (uint8_t)tempX;\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 6708476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35fefeff0f21ee566df4cbe2a670cf17?s=128&d=identicon&r=PG&f=1", "display_name": "gerrard2461", "link": "https://stackoverflow.com/users/6708476/gerrard2461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2306, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528357580, "creation_date": 1528289462, "last_edit_date": 1528357580, "question_id": 50720895, "link": "https://stackoverflow.com/questions/50720895/compare-uint8-t-and-uint16-t-in-c", "title": "Compare uint8_t and uint16_t in c++", "body": "<p>i would like to test if a value of an input variable passed one byte size or know so i write this code</p>\n\n<pre><code>{\n    uint8_t x;\n    cout &lt;&lt; \" enter x\" &lt;&lt; endl;\n    cin  &gt;&gt; hex &gt;&gt; x;\n    cout &lt;&lt; hex &lt;&lt; x;\n    uint8_t y ;  \n    y = x &gt;&gt; 4 ;\n    cout &lt;&lt; hex &lt;&lt; y;\n    if ( y == 0 )\n    {\n        cout &lt;&lt; \" succes, coorect value for x\";\n    }\n    if (y &gt;  0)\n    {\n        /*here i supoosed that x = 0xfff and when shifting, y would be 0xff but y is uint8 so it's just for compare\n        std::cout &lt;&lt; \"fail, \";\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I would like to know how to test if the user type two or more byte in uint8.\nAnd tell him to retype the value of just one byte.that's why i tried to compare uint8_t to uint16_t.</p>\n"}, {"tags": ["c++", "mfc", "opengl-3", "libjpeg"], "comments": [{"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1528289588, "post_id": 50720808, "comment_id": 88450195, "body": "I think that <a href=\"https://github.com/Windower/libjpeg/blob/master/libjpeg.txt\" rel=\"nofollow noreferrer\">this readme</a> and <a href=\"https://github.com/Windower/libjpeg/blob/master/example.c\" rel=\"nofollow noreferrer\">this example</a> might be useful."}, {"owner": {"reputation": 1, "user_id": 9087876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d57f5682d5ae17421af8986d12b5d09?s=128&d=identicon&r=PG&f=1", "display_name": "Moula Pakali", "link": "https://stackoverflow.com/users/9087876/moula-pakali"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1528348905, "post_id": 50720808, "comment_id": 88474652, "body": "Hey thank you for inputs. I have gone through this example."}, {"owner": {"reputation": 1, "user_id": 9087876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d57f5682d5ae17421af8986d12b5d09?s=128&d=identicon&r=PG&f=1", "display_name": "Moula Pakali", "link": "https://stackoverflow.com/users/9087876/moula-pakali"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1528349101, "post_id": 50720808, "comment_id": 88474718, "body": "However, Its reading and writing logic is based on the file. However I looking to store image in buffer and reading it from buffer."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1528378191, "post_id": 50720808, "comment_id": 88492618, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4559648/write-to-memory-buffer-instead-of-file-with-libjpeg\">Write to memory buffer instead of file with libjpeg?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9087876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d57f5682d5ae17421af8986d12b5d09?s=128&d=identicon&r=PG&f=1", "display_name": "Moula Pakali", "link": "https://stackoverflow.com/users/9087876/moula-pakali"}, "is_accepted": true, "score": 0, "last_activity_date": 1529659478, "creation_date": 1529659478, "answer_id": 50984801, "question_id": 50720808, "link": "https://stackoverflow.com/questions/50720808/writejpgbuffer-method-using-libjpeg-libraries-instead-of-ijl15-lib/50984801#50984801", "title": "WriteJPGBuffer method using libjpeg libraries instead of ijl15.lib", "body": "<p>Thanks for your inputs. I have implemented the solution below through RND. In below implementation, we have image data stored in the class member variable in the form of RGBQUAD which i am converting into unsigned char* first using ConversionfromGLRGBQUADToUnsignedChar function and then writing it jpeg buffer.</p>\n\n<pre><code>void ConversionfromGLRGBQUADToUnsignedChar(unsigned char* dataInCharFromGLRGBQUAD)\n{\n    int spot,spotDst;\n    for (int y = 0;y &lt; m_height;y++)\n    {\n        for (int x = 0;x&lt;m_width;x++)\n        {\n            spot = y * m_width + x;\n            spotDst = spot * 3;\n            dataInCharFromGLRGBQUAD[spotDst] = m_pData[spot].red;\n            dataInCharFromGLRGBQUAD[spotDst + 1] = m_pData[spot].green;\n            dataInCharFromGLRGBQUAD[spotDst + 2] = m_pData[spot].blue;\n        }\n    }\n}\n\n\n\nunsigned char * WriteJPGBuffer(unsigned int &amp;size)\n    {\n       size = 0;\n       struct jpeg_compress_struct cinfo;\n       struct jpeg_error_mgr jerr;\n       JSAMPROW row_pointer[1];\n       unsigned char* dataInCharFromGLRGBQUAD;\n       bool colorsSwapped;\n       int row_stride;\n\n       cinfo.err = jpeg_std_error(&amp;jerr);\n       jpeg_create_compress(&amp;cinfo);\n\n       unsigned long sizeOfJPGBuffer = 0;\n\n       jpeg_mem_dest(&amp;cinfo, &amp;m_pDIBData, &amp;sizeOfJPGBuffer);\n\n       cinfo.image_width = m_width;\n       cinfo.image_height = m_height;\n       cinfo.input_components = 3;\n       cinfo.in_color_space = JCS_RGB;\n\n       cinfo.jpeg_color_space = JCS_YCbCr;\n\n       jpeg_set_defaults(&amp;cinfo);\n       jpeg_set_quality(&amp;cinfo, jpgQuality, true);\n       jpeg_start_compress(&amp;cinfo, true);\n\n       colorsSwapped = SetInternalFormat(RGB);\n\n       FlipVert();\n\n       dataInCharFromGLRGBQUAD = new unsigned char[m_width*m_height*3];\n       ConversionfromGLRGBQUADToUnsignedChar(dataInCharFromGLRGBQUAD);\n\n       row_stride = cinfo.image_width * cinfo.input_components;\n\n       while (cinfo.next_scanline &lt; cinfo.image_height) \n       {\n            row_pointer[0] = &amp;dataInCharFromGLRGBQUAD[cinfo.next_scanline * row_stride];\n            jpeg_write_scanlines(&amp;cinfo, row_pointer, 1);\n       }\n\n       if (colorsSwapped)\n           SetInternalFormat(BGR);\n\n       jpeg_finish_compress(&amp;cinfo);\n       jpeg_destroy_compress(&amp;cinfo);\n\n       size = sizeOfJPGBuffer;\n       delete[] dataInCharFromGLRGBQUAD;\n\n       return m_pDIBData;\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9087876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d57f5682d5ae17421af8986d12b5d09?s=128&d=identicon&r=PG&f=1", "display_name": "Moula Pakali", "link": "https://stackoverflow.com/users/9087876/moula-pakali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 50984801, "answer_count": 1, "score": -1, "last_activity_date": 1529659478, "creation_date": 1528289258, "question_id": 50720808, "link": "https://stackoverflow.com/questions/50720808/writejpgbuffer-method-using-libjpeg-libraries-instead-of-ijl15-lib", "title": "WriteJPGBuffer method using libjpeg libraries instead of ijl15.lib", "body": "<p>We have following method implemented using ijl15.lib API.\nWe want to use libjpeg libraries instead of ijl. How should I implement WriteJPGBuffer using libjpeg libraries? We are aware of LoadJPG and SaveJPG from file. However i want to write and read the jpg image in buffer using libjpeg libraries. Any inputs will be very helpul. Thank you in advance.</p>\n\n<pre><code>   unsigned char WriteJPGBuffer(unsigned int &amp;size)\n    {\n      size = 0;\n      int jErr;\n      JPEG_CORE_PROPERTIES jpgProps;\n      bool colorsSwapped;\n\n      if (!jpgSupported)  \n        return NULL;\n\n      jErr = ijlInit(&amp;jpgProps);\n      if (jErr != IJL_OK)\n        return NULL;\n\n\n      jpgProps.DIBWidth = m_width;\n      jpgProps.DIBHeight = -m_height;\n      jpgProps.DIBBytes = (unsigned char *)m_pData;\n      jpgProps.DIBPadBytes = 0 ;     \n      jpgProps.DIBChannels = 4;\n      jpgProps.DIBColor = IJL_RGB;\n\n      jpgProps.JPGFile = NULL;\n      jpgProps.JPGWidth = m_width;\n      jpgProps.JPGHeight = m_height;\n      jpgProps.JPGChannels = 3;\n      jpgProps.JPGColor = IJL_YCBCR;\n      jpgProps.JPGSubsampling = IJL_411;\n      jpgProps.jquality = jpgQuality;   \n      unsigned int iSize = m_width*m_height*3;\n      unsigned char * pBuffer = new unsigned char[iSize];\n      jpgProps.JPGSizeBytes = iSize;\n      jpgProps.JPGBytes = pBuffer;\n\n      jpgProps.jprops.jpeg_comment_size = (unsigned short)m_strCommentAdobe.length;\n      jpgProps.jprops.jpeg_comment = (char*)m_strCommentAdobe;\n\n      colorsSwapped = SetInternalFormat(RGB);\n\n      jErr = ijlWrite(&amp;jpgProps, IJL_JBUFF_WRITEWHOLEIMAGE);\n\n      if (colorsSwapped)\n        SetInternalFormat(BGR);\n\n      if (jErr != IJL_OK)\n      {\n        ijlFree(&amp;jpgProps);\n        return NULL;\n      }\n\n      size = jpgProps.JPGSizeBytes;\n\n      ijlFree(&amp;jpgProps);\n\n      return jpgProps.JPGBytes;\n    }\n</code></pre>\n"}, {"tags": ["c++", "stack"], "comments": [{"owner": {"reputation": 3, "user_id": 9894327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1cd93006ccc47a254cb3a364e6044?s=128&d=identicon&r=PG", "display_name": "acc", "link": "https://stackoverflow.com/users/9894327/acc"}, "edited": false, "score": 0, "creation_date": 1528289458, "post_id": 50720784, "comment_id": 88450119, "body": "Sorry for that, Ron"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1528290005, "post_id": 50720784, "comment_id": 88450467, "body": "You seem to rearrange <b>all</b> the pointers instead of only the deleted node. Walk the links until you find the value you are looking for. Then change <b>one</b> pointer <code>prev-&gt;next = this-&gt;next;</code>. Now <code>this</code> has left the list and can be disposed of."}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 6456868, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1222441641099597/picture?type=large", "display_name": "Rishabh Jain", "link": "https://stackoverflow.com/users/6456868/rishabh-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1528290427, "creation_date": 1528290427, "answer_id": 50721225, "question_id": 50720784, "link": "https://stackoverflow.com/questions/50720784/remove-max-value-from-simply-connected-list/50721225#50721225", "title": "Remove max value from simply-connected list", "body": "<p>Your first solution takes maximum value as a parameter, while the second one doesn't. I am assuming we don't have the maximum value and will calculate it while processing the stack. </p>\n\n<p>The basic approach should be to think of a logic first. </p>\n\n<p>Step 1.) We need to pop all the elements to find the maximum element in the stack. Also, we need to store all the values we popped in another stack(say, <em>auxiliary</em>). Now, we are aware of the maximum value(say <em>MAX</em>). </p>\n\n<p>Step 2.) Note we would have the stack in reverse now. Pop all elements from the auxiliary stack and if the value is not max, push them in the original stack.</p>\n\n<p>Data Initially,</p>\n\n<pre><code>Original Stack: 1-&gt;2-&gt;3-&gt;4-&gt;100-&gt;5-&gt;7-&gt;NULL\nAuxiliary Stack: NULL\n</code></pre>\n\n<p>Data after first Step,</p>\n\n<pre><code>Original Stack: NULL \nAuxiliary Stack: 7-&gt;5-&gt;100-&gt;4-&gt;3-&gt;2-&gt;1-&gt;NULL \nMAX: 100\n</code></pre>\n\n<p>Finally,</p>\n\n<pre><code>Original Stack: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;7-&gt;NULL\nAuxiliary Stack: NULL\n</code></pre>\n\n<p>Try to code for this. Your both solutions are doing things way differently than expected. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9130757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BLdxc.png?s=128&g=1", "display_name": "hsencan", "link": "https://stackoverflow.com/users/9130757/hsencan"}, "is_accepted": false, "score": 0, "last_activity_date": 1528290623, "creation_date": 1528290623, "answer_id": 50721297, "question_id": 50720784, "link": "https://stackoverflow.com/questions/50720784/remove-max-value-from-simply-connected-list/50721297#50721297", "title": "Remove max value from simply-connected list", "body": "<p>I hope It will be helpful.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct LList\n{\n    int info;\n    LList *next;\n\n    //constructer\n    LList(int info_) :info(info_) {\n        next = nullptr;\n    }\n};\nvoid removeMaxValue(LList *&amp;root) {\n    int max = 0;\n\n    LList *temp = root;\n    //Searching for max value\n    while (temp!=nullptr)\n    {\n        if (temp-&gt;info &gt; max)\n            max = temp-&gt;info;\n\n        temp = temp-&gt;next;\n    }\n    temp = root;\n    //Find max value and remove\n    while (temp-&gt;next-&gt;info != max)\n        temp = temp-&gt;next;\n\n    LList *maxNode = temp-&gt;next;\n\n    temp-&gt;next = temp-&gt;next-&gt;next;\n\n    delete maxNode;\n}\nvoid print(const LList *root)\n{\n    while (root!=nullptr)\n    {\n        std::cout &lt;&lt; root-&gt;info &lt;&lt; \" \";\n        root = root-&gt;next;\n    }\n    std::cout &lt;&lt; std::endl;\n}\n\nint main() {\n\n    LList *root = new LList(15);\n    root-&gt;next= new LList(10);\n    root-&gt;next-&gt;next= new LList(45);\n    root-&gt;next-&gt;next-&gt;next = new LList(85);\n    root-&gt;next-&gt;next-&gt;next-&gt;next = new LList(5);\n\n    //before removing\n    print(root);\n\n    removeMaxValue(root);\n\n    //After removing\n    print(root);\n\n    std::cin.get();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1528291054, "creation_date": 1528291054, "answer_id": 50721487, "question_id": 50720784, "link": "https://stackoverflow.com/questions/50720784/remove-max-value-from-simply-connected-list/50721487#50721487", "title": "Remove max value from simply-connected list", "body": "<pre><code>#include &lt;cstdio&gt;\n#include &lt;iostream&gt;\n\nstruct Stack\n{\n    int info;\n    Stack *next;\n    // added just to easy initialization\n    Stack(int _info, Stack *_next) : info(_info), next(_next) {}\n} *top;\n\nvoid delMaxValue(Stack *&amp;head) \n{\n    // first - find MaxValue in the list\n    // as you can see, i save pointer to the previous element in the list\n    Stack* max_prev = nullptr;\n    Stack* max = head;\n    for(Stack *i_prev = nullptr, *i = head; i; i_prev = i, i = i-&gt;next) {\n         if (max-&gt;info &lt; i-&gt;info) {\n             max_prev = i_prev;\n             max = i;\n         }\n    }\n    // max has the maximum value and max_prev is the element before max in the list\n    // now we remove max\n    if (max_prev == nullptr) {\n        // max has no prev, so max is the head of the list. We assign the new head\n        head = max-&gt;next;\n     } else {\n        max_prev-&gt;next = max-&gt;next;\n        max-&gt;next = NULL;\n     }\n}\n\nvoid printStack(Stack *head) {\n    std::cout &lt;&lt; \"Priting \" &lt;&lt; head &lt;&lt; std::endl;\n    for(Stack *i = head; i; i = i-&gt;next) {\n        std::cout &lt;&lt; i &lt;&lt; \" \" &lt;&lt; i-&gt;info &lt;&lt; std::endl;\n    }\n}\n\nint main()\n{\n    Stack *head = new Stack(1, new Stack(15, new Stack(10, nullptr)));\n    printStack(head);\n    delMaxValue(head);\n    printStack(head);\n    return 0;\n}\n</code></pre>\n\n<p>You may interest yourself in list helping macros from bsd, now available in glibc, newlib, openbsd etc., see <a href=\"https://github.com/zerovm/glibc/blob/master/misc/sys/queue.h\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 656, "user_id": 5277022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7aa91dde8db1b879b0842a0a75ee62b?s=128&d=identicon&r=PG&f=1", "display_name": "navyblue", "link": "https://stackoverflow.com/users/5277022/navyblue"}, "is_accepted": false, "score": 0, "last_activity_date": 1528292384, "creation_date": 1528292384, "answer_id": 50721965, "question_id": 50720784, "link": "https://stackoverflow.com/questions/50720784/remove-max-value-from-simply-connected-list/50721965#50721965", "title": "Remove max value from simply-connected list", "body": "<p>Your two functions take two different approaches. I chose the one where the function doesn't know what actual max value is so it has to find it first.</p>\n\n<p>First, the function just iterates through the elements and chooses the max value.\nThen it searches for the first node that contains this value and removes the node.</p>\n\n<pre><code>void stackRemoveMaxValue(Stack*&amp; top) {\n    if(top == nullptr) {\n        return;\n    }\n\n    // Find max value.\n    int maxValue = top-&gt;info;\n    Stack* node = top-&gt;next;\n    for(; node != nullptr; node = node-&gt;next) {\n        if(maxValue &lt; node-&gt;info) {\n            maxValue = node-&gt;info;\n        }\n    }\n\n    // Remove first node that contains maxValue.\n    Stack* previous = nullptr;\n    Stack* current = top;\n    do {\n        if(current-&gt;info != maxValue) {\n            previous = current;\n            current = current-&gt;next;\n        } else {\n            if(previous != nullptr) {\n                previous-&gt;next = current-&gt;next;\n            } else {\n                top = current-&gt;next;\n            }\n            delete current;\n            return;\n        }\n    } while(current != nullptr);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9894327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1cd93006ccc47a254cb3a364e6044?s=128&d=identicon&r=PG", "display_name": "acc", "link": "https://stackoverflow.com/users/9894327/acc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 50721487, "answer_count": 4, "score": 0, "last_activity_date": 1528292809, "creation_date": 1528289196, "last_edit_date": 1528292809, "question_id": 50720784, "link": "https://stackoverflow.com/questions/50720784/remove-max-value-from-simply-connected-list", "title": "Remove max value from simply-connected list", "body": "<p>How can I can remove max value from a Simply-Connected list?</p>\n\n<p>Two of the solutions I tried produce wrong results. Please explain to me what am I doing wrong. With code, if not difficult.</p>\n\n<p><strong>Stack:</strong></p>\n\n<pre><code>struct Stack\n{\n    int info;\n    Stack *next;\n} *top;\n</code></pre>\n\n<p><strong>Wrong solution 1:</strong></p>\n\n<pre><code>void delMaxValue(Stack **stck, int maxValue){\nStack *tmp = NULL;\ndo {\n    if ((*stck)-&gt;info != maxValue) \n        tmp = *stck;\n        cout &lt;&lt; tmp-&gt;info &lt;&lt; endl;\n        tmp = tmp-&gt;next;\n    *stck = (*stck)-&gt;next;\n} while ((*stck)-&gt;next != NULL);\nwhile (tmp != NULL)\n{\n    *stck = tmp;\n    *stck = (*stck)-&gt;next;\n    tmp = tmp-&gt;next;\n}\n</code></pre>\n\n<p><strong>Wrong solution 2:</strong></p>\n\n<pre><code>Stack* deleteMaxValue(Stack *begin) {\nStack *t = begin, *p = begin-&gt;next;\nfor (; p; p = p-&gt;next)\n    if (p-&gt;info &gt; t-&gt;info)  t = p;\np = begin;\nif (p != t) {\n    while (p-&gt;next != t)   p = p-&gt;next;\n    p-&gt;next = t-&gt;next;\n}\nelse\n    begin = t-&gt;next;\ndelete t;\nreturn begin;}\n</code></pre>\n"}, {"tags": ["c++", "lambda", "types", "c++14"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1528290434, "post_id": 50720766, "comment_id": 88450735, "body": "<code>lambda</code>s aren&#39;t implemented as functions, they&#39;re implemented as functors; <code>class</code>es/<code>struct</code>s with <code>operator()</code> defined. Being methods on unrelated classes, they&#39;re not going to behave like normal functions."}], "answers": [{"comments": [{"owner": {"reputation": 1050, "user_id": 1043529, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dc8S5.png?s=128&g=1", "display_name": "John P", "link": "https://stackoverflow.com/users/1043529/john-p"}, "edited": false, "score": 0, "creation_date": 1528306219, "post_id": 50721245, "comment_id": 88460747, "body": "What about the return type of the lambda? That seems like par for the course, since it can do <code>&amp;type::operator()</code> -&gt; <code>std::string (type::*)(unsigned int)</code> and so on. It&#39;s fine if you don&#39;t know the details about <code>__PRETTY_FUNCTION__</code>, I knew it wasn&#39;t standard, I was mostly looking for details about lambda and why it <i>could</i> be different."}, {"owner": {"reputation": 1050, "user_id": 1043529, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dc8S5.png?s=128&g=1", "display_name": "John P", "link": "https://stackoverflow.com/users/1043529/john-p"}, "edited": false, "score": 0, "creation_date": 1528306699, "post_id": 50721245, "comment_id": 88461011, "body": "Oh, I guess it could capture and return itself, maybe it protects against self-referential types. A lambda wouldn&#39;t be able to declare itself with itself as an argument, so the parameters should be safe."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 5, "last_activity_date": 1528292675, "last_edit_date": 1528292675, "creation_date": 1528290501, "answer_id": 50721245, "question_id": 50720766, "link": "https://stackoverflow.com/questions/50720766/why-are-these-lambdas-considered-different-types/50721245#50721245", "title": "Why are these lambdas considered different types?", "body": "<p>Each lambda <em>expression</em> denotes a <em>unique</em> closure type.</p>\n\n<p><a href=\"http://eel.is/c++draft/expr.prim.lambda#closure-1\" rel=\"nofollow noreferrer\"><code>[expr.prim.lambda.closure]</code></a></p>\n\n<blockquote>\n  <p>The type of a lambda-expression (which is also the type of the closure\n  object) is a unique, unnamed non-union class type, called the closure\n  type, whose properties are described below.</p>\n</blockquote>\n\n<p>As to why <code>__PRETTY_FUNCTION__</code> renders the same, you'd have to ask the implementer (it's not a standard macro), but at a guess it's hard to de-mangle to a name that is both unique and representative. </p>\n"}], "owner": {"reputation": 1050, "user_id": 1043529, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dc8S5.png?s=128&g=1", "display_name": "John P", "link": "https://stackoverflow.com/users/1043529/john-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528292675, "creation_date": 1528289150, "last_edit_date": 1528291717, "question_id": 50720766, "link": "https://stackoverflow.com/questions/50720766/why-are-these-lambdas-considered-different-types", "title": "Why are these lambdas considered different types?", "body": "<p>I found this odd behavior with <code>__PRETTY_FUNCTION__</code>, but the odd part has more to do with what I assume is correct behavior than a quirk in demangling. I could be wrong.</p>\n\n<pre><code>auto lambda1 = [] { return __PRETTY_FUNCTION__; };\nauto lambda2 = [] { return __PRETTY_FUNCTION__; };\n//static_assert(std::is_same&lt;decltype(lambda1), decltype(lambda2)&gt;(), \"Distinct types!\");\nstd::cout &lt;&lt; pretty(lambda1) &lt;&lt; \"\\n\" &lt;&lt; pretty(lambda2) &lt;&lt; std::endl;\nlambda1(); // ...with T = main(int, const char**)::&lt;lambda()&gt;\nlambda2(); // ...with T = main(int, const char**)::&lt;lambda()&gt;\n</code></pre>\n\n<p>Now, it doesn't surprise me terribly that they aren't considered the same type - only that they're distinct and don't reflect it in their signature. (This works the same when the lambdas return null.) Why would that be?</p>\n\n<p>I'll also point out that the return type isn't shown at all, which I've never seen omitted from a regular function. I'm certain the return type is both strongly typed and a fundamental part of the type of the lambda, so why would it be omitted?</p>\n"}, {"tags": ["c++", "emoji", "freetype", "harfbuzz"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9741573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beUyl.jpg?s=128&g=1", "display_name": "vooku", "link": "https://stackoverflow.com/users/9741573/vooku"}, "edited": false, "score": 0, "creation_date": 1531211994, "post_id": 51234621, "comment_id": 89499523, "body": "Newer Harfbuzz seems to be the way to go, thanks for the tip!"}], "tags": [], "owner": {"reputation": 131, "user_id": 5798127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K06Eq.jpg?s=128&g=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/5798127/axel"}, "is_accepted": false, "score": 3, "last_activity_date": 1531072167, "creation_date": 1531072167, "answer_id": 51234621, "question_id": 50720755, "link": "https://stackoverflow.com/questions/50720755/emoji-modifiers-zwj-sequences-using-harfbuzz-freetype-in-apple-color-emoji/51234621#51234621", "title": "Emoji modifiers &amp; ZWJ sequences using Harfbuzz &amp; Freetype in Apple Color Emoji", "body": "<p>I am pretty new to text shaping, but I managed, using Harfbuzz and Cairo to display emoji (with modifiers and ZWJ) onto a SDL2 window.</p>\n\n<p><a href=\"https://github.com/rozaxe/ex-harfbuzz-sdl2-cairo-freetype-emoji\" rel=\"nofollow noreferrer\" title=\"The repository\">GitHub Repository</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PUvgl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PUvgl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Based on what you said, the main difference is that I used HarfBuzz version 1.8.2.</p>\n"}, {"tags": [], "owner": {"reputation": 8032, "user_id": 1414809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63e622128f1f2b74858a10c1a60707fb?s=128&d=identicon&r=PG", "display_name": "Ebrahim Byagowi", "link": "https://stackoverflow.com/users/1414809/ebrahim-byagowi"}, "is_accepted": true, "score": 5, "last_activity_date": 1599986252, "last_edit_date": 1599986252, "creation_date": 1541274913, "answer_id": 53134976, "question_id": 50720755, "link": "https://stackoverflow.com/questions/50720755/emoji-modifiers-zwj-sequences-using-harfbuzz-freetype-in-apple-color-emoji/53134976#53134976", "title": "Emoji modifiers &amp; ZWJ sequences using Harfbuzz &amp; Freetype in Apple Color Emoji", "body": "<p>HarfBuzz gradually improved different sequences support and now is reliable to be used for different Emoji modifiers and sequences.</p>\n<p>Additionally, v2.1.0 added support to all of the available Emoji file formats with a simple and concise API, <a href=\"https://github.com/harfbuzz/harfbuzz/blob/master/src/hb-ot-color.h\" rel=\"nofollow noreferrer\">https://github.com/harfbuzz/harfbuzz/blob/master/src/hb-ot-color.h</a> of course rendering parts still will be up to you (or use freetype to render then) but you don't have to deal with font structures at least anymore given the simple to use API which <a href=\"https://github.com/harfbuzz/harfbuzz/blob/1934652/src/main.cc#L46-L247\" rel=\"nofollow noreferrer\">https://github.com/harfbuzz/harfbuzz/blob/1934652/src/main.cc#L46-L247</a> is also a good example on how to use the APIs.</p>\n"}], "owner": {"reputation": 33, "user_id": 9741573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beUyl.jpg?s=128&g=1", "display_name": "vooku", "link": "https://stackoverflow.com/users/9741573/vooku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 1, "accepted_answer_id": 53134976, "answer_count": 2, "score": 3, "last_activity_date": 1599986252, "creation_date": 1528289124, "question_id": 50720755, "link": "https://stackoverflow.com/questions/50720755/emoji-modifiers-zwj-sequences-using-harfbuzz-freetype-in-apple-color-emoji", "title": "Emoji modifiers &amp; ZWJ sequences using Harfbuzz &amp; Freetype in Apple Color Emoji", "body": "<p>I'm using Freetype 1.9.1 and Harfbuzz 1.7.6 to render text possibly including emoji, however I don't know how to correctly render emoji modifiers and ZWJ sequencces from Apple Color Emoji (<a href=\"https://docs.microsoft.com/en-us/typography/opentype/spec/sbix\" rel=\"nofollow noreferrer\">sbix</a> color font).</p>\n\n<p>I've also tried Noto Color Emoji (<a href=\"https://docs.microsoft.com/en-us/typography/opentype/spec/cbdt\" rel=\"nofollow noreferrer\">CBDT/CBLC</a> color font), which works as expected, and Segoe UI Emoji (<a href=\"https://docs.microsoft.com/en-us/typography/opentype/spec/colr\" rel=\"nofollow noreferrer\">COLR/CPAL</a> color font), which renders black &amp; white glyphs, however it seems that support for COLR/CPAL is just <a href=\"https://git.savannah.gnu.org/cgit/freetype/freetype2.git/log/?qt=grep&amp;q=cpal\" rel=\"nofollow noreferrer\">being developed</a> in Freetype and therefore is not an issue for me.</p>\n\n<p>Has anyone any tips on what to look out for with the sbix font? Cluster types? Harfbuzz flags...?</p>\n\n<p><a href=\"https://i.stack.imgur.com/SF3rU.png\" rel=\"nofollow noreferrer\">Expected behaviour</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/lzh8a.png\" rel=\"nofollow noreferrer\">Apple Color Emoji -- not OK</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/N29aC.png\" rel=\"nofollow noreferrer\">Noto Color Emoji -- OK</a></p>\n"}, {"tags": ["c++", "qt", "qt-signals", "qaction"], "answers": [{"tags": [], "owner": {"reputation": 1638, "user_id": 1037293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycPs2.jpg?s=128&g=1", "display_name": "Andrii", "link": "https://stackoverflow.com/users/1037293/andrii"}, "is_accepted": false, "score": 2, "last_activity_date": 1528292652, "creation_date": 1528292652, "answer_id": 50722065, "question_id": 50720742, "link": "https://stackoverflow.com/questions/50720742/determine-which-shortcut-is-pressed-in-qt/50722065#50722065", "title": "Determine which Shortcut is pressed in Qt", "body": "<p>You should create a separate <code>QAction</code> for each shortcut and group them using a <a href=\"http://doc.qt.io/qt-5/qsignalmapper.html\" rel=\"nofollow noreferrer\">QSignalMapper</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9117006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1683088825087847/picture?type=large", "display_name": "Tamim Boubou", "link": "https://stackoverflow.com/users/9117006/tamim-boubou"}, "edited": false, "score": 0, "creation_date": 1528354565, "post_id": 50726133, "comment_id": 88477216, "body": "Thanks...it&#39;s working ....although I didn&#39;t understand the third &quot;connect&quot; statement very well...is it ok if you explained"}, {"owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "reply_to_user": {"reputation": 65, "user_id": 9117006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1683088825087847/picture?type=large", "display_name": "Tamim Boubou", "link": "https://stackoverflow.com/users/9117006/tamim-boubou"}, "edited": false, "score": 0, "creation_date": 1528358462, "post_id": 50726133, "comment_id": 88479419, "body": "You&#39;re welcome. I edited my answer to explain better how it works. Yes it&#39;s a long story...I hope it is clearer :)"}, {"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1528360517, "post_id": 50726133, "comment_id": 88480591, "body": "@GabriellaGiordano, Great answer :), Is there any reason why you don&#39;t use <code>QObject::sender()</code> instead of using <code>QSignalMapper</code> to map the object to itself? (or even better just capture whatever you want <a href=\"https://stackoverflow.com/a/22411267/2666212\">using lambdas</a>). Another small nitpick, you might want to clear <code>act-&gt;data()</code> after reading it, because <code>data()</code> might be otherwise retained when the action gets invoked by means other than these two shortcuts (e.g. another shortcut, or a being pressed from a <code>QToolBar</code>/<code>QMenu</code>...)"}, {"owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "reply_to_user": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1528362353, "post_id": 50726133, "comment_id": 88481858, "body": "@Mike, thanks for your comment. All your observations are correct and I tried to improve my answer with my last edit. Thanks for the hint on the data reset after use. Anyway if you have time why don&#39;t you post your answer? I think it could be useful and maybe accepted instead of mine :)"}, {"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1528362971, "post_id": 50726133, "comment_id": 88482264, "body": "@GabriellaGiordano, I just had these two small notes. It is really not worth a new answer. Your answer is great :), I tried to answer this question before you did, but I didn&#39;t know about <code>QShortcut</code>, so I thought that the only way to go about this if one wanted to keep using one <code>QAction</code> is to have some sort of weird event filter... you did quite a better job! :D"}, {"owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "reply_to_user": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1528365953, "post_id": 50726133, "comment_id": 88484464, "body": "@Mike ahah so we were both overkilling it a little bit... that&#39;s why I have the rule <i>Check if there is a class for that, darling...</i> but as you can see sometimes it is not enough... :) Again, thanks for your suggestions."}], "tags": [], "owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "is_accepted": true, "score": 3, "last_activity_date": 1528362123, "last_edit_date": 1528362123, "creation_date": 1528305748, "answer_id": 50726133, "question_id": 50720742, "link": "https://stackoverflow.com/questions/50720742/determine-which-shortcut-is-pressed-in-qt/50726133#50726133", "title": "Determine which Shortcut is pressed in Qt", "body": "<p>You could try a more elaborate pattern with QSignalMapper that avoids the need to define as many actions as many shortcut you need, but requires c++11 (at least this implementation).</p>\n\n<p>In the constructor of your window use the following code to declare your <code>QShortcut</code> objects and a <code>QSignalMapper</code>: </p>\n\n<pre><code>QSignalMapper* signalMapper = new QSignalMapper(this);\nQShortcut* sc1 = new QShortcut(QKeySequence(Qt::CTRL + Qt::Key_N), this);\nQShortcut* sc2 = new QShortcut(QKeySequence(Qt::CTRL + Qt::Key_T), this);\n\nconnect(sc1, &amp;QShortcut::activated, signalMapper, static_cast&lt;void (QSignalMapper::*)(void)&gt;(&amp;QSignalMapper::map));\nconnect(sc2, &amp;QShortcut::activated, signalMapper, static_cast&lt;void (QSignalMapper::*)(void)&gt;(&amp;QSignalMapper::map));\n\nsignalMapper-&gt;setMapping(sc1, sc1);\nsignalMapper-&gt;setMapping(sc2, sc2);\n\nQAction* action = new QAction();\nconnect(signalMapper, static_cast&lt;void (QSignalMapper::*)(QObject*)&gt;(&amp;QSignalMapper::mapped),\n    [action](QObject *object){\n\n    QShortcut* sc = qobject_cast&lt;QShortcut*&gt;(object);\n    if (sc)\n    {\n        action-&gt;setData(sc-&gt;key().toString());\n        action-&gt;trigger();\n    }\n});\n\nconnect(action, &amp;QAction::triggered, this, &amp;MainWindow::doStuff);\n</code></pre>\n\n<p>The 3rd connection is required because of the way QSignalMapper works: when a shortcut is activated, it will be notified to the QSignalMapper thanks to the 1st and 2nd connections, that will trigger the map() slot. </p>\n\n<p>The QSignalMapper::map() slot will scan its mappings, made with the setMapping() API, whose first argument is the mapped object, and the second one is the parameter that will be used to emit the mapped() slot of the QSignalMapper, once the emitting object is identified. To do so, it uses the sender() method and simply compares the pointer returned to the mapped QObject pointers you provided as mappings.</p>\n\n<p>Once the QObject is identified, QSignalMapper will emit the QSignalMapper::mapped(QObject*) signal, whose argument is the second argument given to setMapping, and in this case it the same as the first one, that is again a pointer to the QShortcut that was activated. </p>\n\n<p>I used a lambda to catch this signal, and inside this lambda I simply check that the parameter given is a QShortcut pointer, and store its key sequence inside the data member of the QAction <em>before</em> triggering the action itself. The QAction::trigger() slot will then emit the QAction::triggered() signal that will in turn invoke your custom slot, in  this case doStuff(). There you can retrieve the key sequence and do what you want with it.</p>\n\n<p>So your slot implementation should look similar to this one:</p>\n\n<pre><code>void MainWindow::doStuff()\n{\n    // use sender() to fetch data from action\n    QAction* act = qobject_cast&lt;QAction*&gt;(sender());\n    if (act)\n    {\n        QString sequence = act-&gt;data().toString();\n\n        // debug output will show you the triggering key sequence\n        qDebug() &lt;&lt; sequence;\n\n        // use sequence string to determine which shortcut was used\n\n        // On Mike hint: better to reset data after use :)\n        act.setData(QVariant());\n    }\n}\n</code></pre>\n\n<p>Note that I'm using a mapping based on QObject pointers. In this way you can reuse the <code>signalMapper</code> instance to connect events from other kind of QObjects (e.g. QPushButtons) and identify them in your custom slot as well setting a proper value for the QAction data member, that can store a generic QVariant istance.</p>\n\n<p>Also when using QShortcut, be aware of their <a href=\"http://doc.qt.io/qt-5/qt.html#ShortcutContext-enum\" rel=\"nofollow noreferrer\">contex</a>, that is when they are active, as it could be at widget or a window scope. </p>\n\n<p>Unfortunately this pattern violates pure oop principles, but could be better than managing many actions (icon, text, tooltip etc...) for the same purpose. </p>\n\n<p>EDIT: to answer comments</p>\n\n<p>First of all, let me clarify that you can of course skip the use of QSignalMapper at all. This is just a possible solution (not the better, maybe an overkill... but not really worse in terms of performance).</p>\n\n<p>A simpler way, as pointed by Mike in the comments consists in using lambdas for each QShotcut::activated signal, but this will result in copy/paste code, that I always try to avoid. \nYou can instead define a custom slot inside the MainWindow and use sender() to catch the QShortcut and prepare the action before triggering it. </p>\n\n<p>Anyway, QSignalMapper IMHO, better explains what you are doing (from a semantic point of view) and is more flexible in case you need to expand the connection to other QObjects, supporting also other type of mappings.</p>\n\n<p>Furthermore, but this is related to my personal taste, I like the idea to have fragments of code that are logically tied condensed into small snippets, instead of have it sparse among several slot/functions because it makes it easier to read and to trace back when I need to change it, of course only if this does not hurt the quality of code itself.</p>\n"}], "owner": {"reputation": 65, "user_id": 9117006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1683088825087847/picture?type=large", "display_name": "Tamim Boubou", "link": "https://stackoverflow.com/users/9117006/tamim-boubou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 50726133, "answer_count": 2, "score": 2, "last_activity_date": 1528362123, "creation_date": 1528289086, "question_id": 50720742, "link": "https://stackoverflow.com/questions/50720742/determine-which-shortcut-is-pressed-in-qt", "title": "Determine which Shortcut is pressed in Qt", "body": "<p>I have a QAction which I've assigned multiple shortcuts to it</p>\n\n<pre><code>   test = new QAction();\n   this-&gt;addAction(test);\n   QList&lt;QKeySequence&gt; shortcuts;\n   shortcuts &lt;&lt; QKeySequence(Qt::Key_N) &lt;&lt; QKeySequence(Qt::Key_T);\n   test-&gt;setShortcuts(shortcuts);\n   connect(test,SIGNAL(triggered()),this,SLOT(SomeFucntion()))\n</code></pre>\n\n<p>In <code>SomeFucntion</code> I need to know which shortcut was pressed....Is there anyway of knowing that ?</p>\n"}, {"tags": ["c++", "opengl-es", "webgl", "transparency", "depth-buffer"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1528289507, "post_id": 50720534, "comment_id": 88450147, "body": "<a href=\"http://jcgt.org/published/0002/02/09/\" rel=\"nofollow noreferrer\">order independent transparency</a>"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 2, "creation_date": 1528289634, "post_id": 50720534, "comment_id": 88450221, "body": "<i>&quot;My ideal answer will contain code...&quot;</i> Same as the &quot;ideal&quot; SO question, with <a href=\"https://stackoverflow.com/help/mcve\">mcve</a>"}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1528291661, "post_id": 50720534, "comment_id": 88451642, "body": "@Ripi2 that McGuire paper is a very good example of how the examples out there are unusable. e.g. the use <code>gl_FragData[0]</code> is deprecated. He uses stuff like <code>bindFramebuffer(accumTexture, revealageTexture);</code>. What are these accumTexture and revealageTexture framebuffers and how are they configured? I also don&#39;t get the <code>bindFragmentShader</code> function. I can go on... What am I missing?"}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1528291802, "post_id": 50720534, "comment_id": 88451746, "body": "In the meantime I will throw together a web based example to improve the quality of my question."}], "answers": [{"tags": [], "owner": {"reputation": 8286, "user_id": 533037, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f711473fb27cd269ba5ad2064c15dcd3?s=128&d=identicon&r=PG", "display_name": "solidpixel", "link": "https://stackoverflow.com/users/533037/solidpixel"}, "is_accepted": false, "score": 1, "last_activity_date": 1528380209, "creation_date": 1528380209, "answer_id": 50743268, "question_id": 50720534, "link": "https://stackoverflow.com/questions/50720534/implementing-depth-testing-for-semi-transparent-objects/50743268#50743268", "title": "Implementing depth testing for semi-transparent objects", "body": "<blockquote>\n  <p>I have three requirements for my depth testing of semi-transparent objects</p>\n</blockquote>\n\n<p>It's actually quite rare to have self-intersecting objects with partially transparent (actually blended) samples. The common cases for self-intersecting geometry is grass and leaves. However, in these cases the actual areas covered by grass and leaves are not transparent - they are opaque. </p>\n\n<p>The common solution here is alpha testing. Render the leaves as an opaque (not blended) quad (with a normal depth test and write), and discard fragments which have insufficient alpha (e.g. because they are outside of the leaf). Because individual samples here are opaque, then you get order independence for free because the depth test works as you would expect for an opaque object.</p>\n\n<p>If you want blended edges, then enable alpha-to-coverage and let the multi-sample resolve clean up the edges a little.</p>\n\n<p>For the small amount of actually transparent stuff you have left, then normally you need to a back-to-front sort on the CPU, and render it after the opaque pass.</p>\n\n<p>Proper OIT is possible, but is is generally quite an expensive technique, so I've yet to see anyone actually use it outside of an academic environment (at least on mobile OpenGL ES implementations).</p>\n"}, {"comments": [{"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1528575152, "post_id": 50777930, "comment_id": 88563137, "body": "I&#39;ve been dying to get a working example! This is amazing. I want to try make it get the rgba values from a png instead of just one color for the whole quad. I&#39;m imagining windows that have any color glass, an opaque frame, and with rounded corner that are discarded. Like in this tutorial: <a href=\"https://learnopengl.com/Advanced-OpenGL/Blending\" rel=\"nofollow noreferrer\">learnopengl.com/Advanced-OpenGL/Blending</a>"}, {"owner": {"reputation": 82151, "user_id": 128511, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/KwGaJ.png?s=128&g=1", "display_name": "gman", "link": "https://stackoverflow.com/users/128511/gman"}, "reply_to_user": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1528611756, "post_id": 50777930, "comment_id": 88568900, "body": "You just need to change the transparent shader so that <code>Ci</code> comes from a texture"}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1528639917, "post_id": 50777930, "comment_id": 88575613, "body": "So then the opaque pass is optional since I can just use the transparency pass with a texture that has no transparency. However I&#39;m assuming the opaque pass performs much better than the transparency pass."}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1528718170, "post_id": 50777930, "comment_id": 88600164, "body": "I&#39;m struggling understand how the texture attachment is shared between the two fbos. Specifically this part: <code>attachment: opaqueFBI.attachments[1]</code>. How would I share an attachment without using twgl.js? I need to understand this when I port my webgl code to opengl."}, {"owner": {"reputation": 82151, "user_id": 128511, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/KwGaJ.png?s=128&g=1", "display_name": "gman", "link": "https://stackoverflow.com/users/128511/gman"}, "reply_to_user": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1528727369, "post_id": 50777930, "comment_id": 88606094, "body": "create depth texture or renderbuffer, create 2 framebuffers, for each framebuffer, bind it, call framebufferTexture2D or framebufferRenderbuffer to attach the depth buffer to both. twgl is open source. The code is not that long."}], "tags": [], "owner": {"reputation": 82151, "user_id": 128511, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/KwGaJ.png?s=128&g=1", "display_name": "gman", "link": "https://stackoverflow.com/users/128511/gman"}, "is_accepted": true, "score": 2, "last_activity_date": 1528612076, "last_edit_date": 1528612076, "creation_date": 1528573634, "answer_id": 50777930, "question_id": 50720534, "link": "https://stackoverflow.com/questions/50720534/implementing-depth-testing-for-semi-transparent-objects/50777930#50777930", "title": "Implementing depth testing for semi-transparent objects", "body": "<p>This seems to be the what <a href=\"http://jcgt.org/published/0002/02/09/\" rel=\"nofollow noreferrer\">the paper linked by ripi2</a> is doing</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function main() {\r\n  const m4 = twgl.m4;\r\n  const gl = document.querySelector('canvas').getContext('webgl2', {alpha: false});\r\n  if (!gl) {\r\n    alert('need WebGL2');\r\n    return;\r\n  }\r\n  const ext = gl.getExtension('EXT_color_buffer_float');\r\n  if (!ext) {\r\n    alert('EXT_color_buffer_float');\r\n    return;\r\n  }\r\n\r\n  const vs = `\r\n  #version 300 es\r\n  layout(location=0) in vec4 position;\r\n  uniform mat4 u_matrix;\r\n  void main() {\r\n    gl_Position = u_matrix * position;\r\n  }\r\n  `;\r\n\r\n  const checkerFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n\r\n  uniform vec4 color1;\r\n  uniform vec4 color2;\r\n\r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    ivec2 grid = ivec2(gl_FragCoord.xy) / 32;\r\n    fragColor = mix(color1, color2, float((grid.x + grid.y) % 2));\r\n  }\r\n  `;\r\n\r\n  const transparentFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform vec4 Ci;\r\n\r\n  out vec4 fragData[2];\r\n\r\n  float w(float z, float a) {\r\n    return a * max(pow(10.0,-2.0),3.0*pow(10.0,3.0)*pow((1.0 - z), 3.));\r\n  }\r\n\r\n  void main() {\r\n    float ai = Ci.a;\r\n    float zi = gl_FragCoord.z;\r\n\r\n    float wresult = w(zi, ai);\r\n    fragData[0] = vec4(Ci.rgb * wresult, ai);\r\n    fragData[1].r = ai * wresult;\r\n  }\r\n  `;\r\n\r\n  const compositeFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform sampler2D ATexture;\r\n  uniform sampler2D BTexture;\r\n\r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    vec4 accum = texelFetch(ATexture, ivec2(gl_FragCoord.xy), 0);\r\n    float r = accum.a;\r\n    accum.a = texelFetch(BTexture, ivec2(gl_FragCoord.xy), 0).r;\r\n    fragColor = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\r\n  }\r\n  `;\r\n\r\n  const checkerProgramInfo = twgl.createProgramInfo(gl, [vs, checkerFS]);\r\n  const transparentProgramInfo = twgl.createProgramInfo(gl, [vs, transparentFS]);\r\n  const compositeProgramInfo = twgl.createProgramInfo(gl, [vs, compositeFS]);\r\n\r\n  const bufferInfo = twgl.primitives.createXYQuadBufferInfo(gl);\r\n\r\n  const fbi = twgl.createFramebufferInfo(\r\n    gl,\r\n    [\r\n      { internalFormat: gl.RGBA32F, minMag: gl.NEAREST },\r\n      { internalFormat: gl.R32F, minMag: gl.NEAREST },\r\n    ]);\r\n\r\n  function render(time) {\r\n    time *= 0.001;\r\n\r\n    twgl.setBuffersAndAttributes(gl, transparentProgramInfo, bufferInfo);\r\n\r\n    // drawOpaqueSurfaces();\r\n    gl.useProgram(checkerProgramInfo.program);\r\n    gl.disable(gl.BLEND);\r\n    twgl.setUniforms(checkerProgramInfo, {\r\n      color1: [.5, .5, .5, 1],\r\n      color2: [.7, .7, .7, 1],\r\n      u_matrix: m4.identity(),\r\n    });\r\n    twgl.drawBufferInfo(gl, bufferInfo);\r\n\r\n    twgl.bindFramebufferInfo(gl, fbi);\r\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0, gl.COLOR_ATTACHMENT1]);\r\n    gl.clearBufferfv(gl.COLOR, 0, new Float32Array([0, 0, 0, 1]));\r\n    gl.clearBufferfv(gl.COLOR, 1, new Float32Array([1, 1, 1, 1]));\r\n\r\n    gl.depthMask(false);\r\n    gl.enable(gl.BLEND);\r\n    gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ZERO, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    gl.useProgram(transparentProgramInfo.program);\r\n\r\n    // drawTransparentSurfaces();\r\n    const quads = [\r\n       [ .4,  0,  0, .4],\r\n       [ .4, .4,  0, .4],\r\n       [  0, .4,  0, .4],\r\n       [  0, .4, .4, .4],\r\n       [  0, .0, .4, .4],\r\n       [ .4, .0, .4, .4],\r\n    ];\r\n    quads.forEach((color, ndx) =&gt; {\r\n      const u = ndx / (quads.length - 1);\r\n      // change the order every second\r\n      const v = ((ndx + time | 0) % quads.length) / (quads.length - 1);\r\n      const xy = (u * 2 - 1) * .25;\r\n      const z = (v * 2 - 1) * .25;\r\n      let mat = m4.identity();\r\n      mat = m4.translate(mat, [xy, xy, z]);\r\n      mat = m4.scale(mat, [.3, .3, 1]);\r\n      twgl.setUniforms(transparentProgramInfo, {\r\n        Ci: color,\r\n        u_matrix: mat,\r\n      });\r\n      twgl.drawBufferInfo(gl, bufferInfo);\r\n    });\r\n\r\n    twgl.bindFramebufferInfo(gl, null);\r\n    gl.drawBuffers([gl.BACK]);\r\n\r\n    gl.blendFunc(gl.ONE_MINUS_SRC_ALPHA, gl.SRC_ALPHA);\r\n\r\n    gl.useProgram(compositeProgramInfo.program);\r\n\r\n    twgl.setUniforms(compositeProgramInfo, {\r\n      ATexture: fbi.attachments[0],\r\n      BTexture: fbi.attachments[1],\r\n      u_matrix: m4.identity(),\r\n    });\r\n\r\n    twgl.drawBufferInfo(gl, bufferInfo);\r\n\r\n    /* only needed if {alpha: false} not passed into getContext\r\n    gl.colorMask(false, false, false, true);\r\n    gl.clearColor(1, 1, 1, 1);\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    gl.colorMask(true, true, true, true);\r\n    */\r\n\r\n    requestAnimationFrame(render);\r\n  }\r\n  requestAnimationFrame(render);\r\n}\r\nmain();</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;canvas&gt;&lt;/canvas&gt;\r\n&lt;script src=\"https://twgljs.org/dist/4.x/twgl-full.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Some things to note:</p>\n\n<ul>\n<li>It's using WebGL2 but it should be possible in WebGL1, you'd have to change the shaders to use GLSL ES 1.0.</li>\n<li>It's using floating point textures. The paper mentions you can use half float textures as well. Note that rendering to both half and float textures is an optional feature in even WebGL2. I believe most mobile hardware can render to half but not to float. </li>\n<li>It's using weight equation 10 from the paper. There are 4 weight equations in the paper. 7, 8, 9, and 10. To do 7, 8, or 9 you'd need to pass in view space <code>z</code> from the vertex shader to the fragment shader</li>\n<li>It's switching the order of drawing every second</li>\n</ul>\n\n<p>The code is pretty straight forward.</p>\n\n<p>It creates 3 shaders. One to draw a checkerboard just so we have something that is opaque to see the transparent stuff drawn above. One is the transparent object shader. The last is the shader the composites the transparent stuff into the scene.</p>\n\n<p>Next it makes 2 textures, a floating point RGBA32F texture and a floating point R32F texture (red channel only). It attaches those to a framebuffer. (that is all done in the 1 function, <code>twgl.createFramebufferInfo</code>. That function makes the textures the same size as the canvas by default.</p>\n\n<p>We make a single quad that goes from -1 to +1</p>\n\n<p>We use that quad to draw the checkerboard into the canvas</p>\n\n<p>Then we turn on blending, setup the blend equations as the paper said, switch to rendering onto our framebuffer, clear that framebuffer. note, it's cleared to 0,0,0,1 and 1 respectively. This is the version where we don't have separate blend functions per draw buffer. If you switch to the version that can use separate blending functions per draw buffer then you need to clear to different values and use a different shader (See paper)</p>\n\n<p>Using our transparency shader we that same quad to draw 6 rectangles each of a solid color. I just used a solid color to keep it simple. Each is at a different Z and the Zs change every second just to see the results Z changing.</p>\n\n<p>In the shader <code>Ci</code> is the input color. It's expected to be a premultiplied alpha color according to the paper.  fragData[0]<code>is the \"accumulate\" texture and</code>fragData[1]<code>is the \"revealage\" texture and is only one channel, red. The</code>w` function represents the equation 10 from the paper.</p>\n\n<p>After all 6 quads are drawn we switch back to rendering to the canvas and use the compositing shader to composite the transparency result with the non-transparent canvas contents.</p>\n\n<p>Here's an example with some geometry. Differences:</p>\n\n<ul>\n<li>It's using equations (7) from the paper instead of (10)</li>\n<li>In order to do correct zbuffering the depth buffer needs to be shared when doing opaque and transparent rendering. So there are 2 frames buffers. One buffer has RGBA8 + depth, the other is RGBA32F + R32F + depth. The depth buffer is shared.</li>\n<li>The transparent renderer computes simple lighting and then uses the result as the <code>Ci</code> value from the paper</li>\n<li>After compositing the transparent into the opaque we still need to copy the opaque into the canvas to see the result</li>\n</ul>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function main() {\r\n  const m4 = twgl.m4;\r\n  const v3 = twgl.v3;\r\n  const gl = document.querySelector('canvas').getContext('webgl2', {alpha: false});\r\n  if (!gl) {\r\n    alert('need WebGL2');\r\n    return;\r\n  }\r\n  const ext = gl.getExtension('EXT_color_buffer_float');\r\n  if (!ext) {\r\n    alert('EXT_color_buffer_float');\r\n    return;\r\n  }\r\n\r\n  const vs = `\r\n  #version 300 es\r\n  layout(location=0) in vec4 position;\r\n  layout(location=1) in vec3 normal;\r\n  uniform mat4 u_projection;\r\n  uniform mat4 u_modelView;\r\n  \r\n  out vec4 v_viewPosition;\r\n  out vec3 v_normal;\r\n\r\n  void main() {\r\n    gl_Position = u_projection * u_modelView * position;\r\n    v_viewPosition = u_modelView * position;\r\n    v_normal = (u_modelView * vec4(normal, 0)).xyz;\r\n  }\r\n  `;\r\n\r\n  const checkerFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n\r\n  uniform vec4 color1;\r\n  uniform vec4 color2;\r\n\r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    ivec2 grid = ivec2(gl_FragCoord.xy) / 32;\r\n    fragColor = mix(color1, color2, float((grid.x + grid.y) % 2));\r\n  }\r\n  `;\r\n  \r\n  const opaqueFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  \r\n  in vec4 v_viewPosition;\r\n  in vec3 v_normal;\r\n  \r\n  uniform vec4 u_color;\r\n  uniform vec3 u_lightDirection;\r\n  \r\n  out vec4 fragColor;\r\n  \r\n  void main() {\r\n    float light = abs(dot(normalize(v_normal), u_lightDirection));\r\n    fragColor = vec4(u_color.rgb * light, u_color.a);\r\n  }\r\n  `;\r\n\r\n  const transparentFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform vec4 u_color;\r\n  uniform vec3 u_lightDirection;\r\n  \r\n  in vec4 v_viewPosition;\r\n  in vec3 v_normal;\r\n  \r\n  out vec4 fragData[2];\r\n\r\n  // eq (7)\r\n  float w(float z, float a) {\r\n    return a * max(\r\n      pow(10.0, -2.0),\r\n      min(\r\n        3.0 * pow(10.0, 3.0),\r\n        10.0 /\r\n        (pow(10.0, -5.0) + \r\n         pow(abs(z) / 5.0, 2.0) +\r\n         pow(abs(z) / 200.0, 6.0)\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  void main() {\r\n    float light = abs(dot(normalize(v_normal), u_lightDirection));\r\n    vec4 Ci = vec4(u_color.rgb * light, u_color.a);\r\n  \r\n    float ai = Ci.a;\r\n    float zi = gl_FragCoord.z;\r\n\r\n    float wresult = w(zi, ai);\r\n    fragData[0] = vec4(Ci.rgb * wresult, ai);\r\n    fragData[1].r = ai * wresult;\r\n  }\r\n  `;\r\n\r\n  const compositeFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform sampler2D ATexture;\r\n  uniform sampler2D BTexture;\r\n  \r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    vec4 accum = texelFetch(ATexture, ivec2(gl_FragCoord.xy), 0);\r\n    float r = accum.a;\r\n    accum.a = texelFetch(BTexture, ivec2(gl_FragCoord.xy), 0).r;\r\n    fragColor = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\r\n  }\r\n  `;\r\n  \r\n  const blitFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform sampler2D u_texture;\r\n  \r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    fragColor = texelFetch(u_texture, ivec2(gl_FragCoord.xy), 0);\r\n  }\r\n  `;\r\n\r\n  const checkerProgramInfo = twgl.createProgramInfo(gl, [vs, checkerFS]);\r\n  const opaqueProgramInfo = twgl.createProgramInfo(gl, [vs, opaqueFS]);\r\n  const transparentProgramInfo = twgl.createProgramInfo(gl, [vs, transparentFS]);\r\n  const compositeProgramInfo = twgl.createProgramInfo(gl, [vs, compositeFS]);\r\n  const blitProgramInfo = twgl.createProgramInfo(gl, [vs, blitFS]);\r\n\r\n  const xyQuadVertexArrayInfo = makeVAO(checkerProgramInfo, twgl.primitives.createXYQuadBufferInfo(gl));\r\n  const sphereVertexArrayInfo = makeVAO(transparentProgramInfo, twgl.primitives.createSphereBufferInfo(gl, 1, 16, 12));\r\n  const cubeVertexArrayInfo = makeVAO(opaqueProgramInfo, twgl.primitives.createCubeBufferInfo(gl, 1, 1));\r\n  \r\n  function makeVAO(programInfo, bufferInfo) {\r\n    return twgl.createVertexArrayInfo(gl, programInfo, bufferInfo);\r\n  }\r\n  \r\n  // In order to do proper zbuffering we need to share\r\n  // the depth buffer \r\n  \r\n  const opaqueAttachments = [\r\n    { internalFormat: gl.RGBA8, minMag: gl.NEAREST },\r\n    { format: gl.DEPTH_COMPONENT16, minMag: gl.NEAREST },\r\n  ];\r\n  const opaqueFBI = twgl.createFramebufferInfo(gl, opaqueAttachments);\r\n  \r\n  const transparentAttachments = [\r\n    { internalFormat: gl.RGBA32F, minMag: gl.NEAREST },\r\n    { internalFormat: gl.R32F, minMag: gl.NEAREST },\r\n    { format: gl.DEPTH_COMPONENT16, minMag: gl.NEAREST, attachment: opaqueFBI.attachments[1] },\r\n  ];\r\n  const transparentFBI = twgl.createFramebufferInfo(gl, transparentAttachments);\r\n\r\n  function render(time) {\r\n    time *= 0.001;\r\n\r\n    if (twgl.resizeCanvasToDisplaySize(gl.canvas)) {\r\n      // if the canvas is resized also resize the framebuffer\r\n      // attachments (the depth buffer will be resized twice \r\n      // but I'm too lazy to fix it)\r\n      twgl.resizeFramebufferInfo(gl, opaqueFBI, opaqueAttachments);\r\n      twgl.resizeFramebufferInfo(gl, transparentFBI, transparentAttachments);\r\n    }\r\n    \r\n    const aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;\r\n    const fov = 45 * Math.PI / 180;\r\n    const zNear = 0.1;\r\n    const zFar = 500;\r\n    \r\n    const projection = m4.perspective(fov, aspect, zNear, zFar);\r\n    const eye = [0, 0, -5];\r\n    const target = [0, 0, 0];\r\n    const up = [0, 1, 0];\r\n    const camera = m4.lookAt(eye, target, up);\r\n    const view = m4.inverse(camera);\r\n\r\n    const lightDirection = v3.normalize([1, 3, 5]);\r\n\r\n    twgl.bindFramebufferInfo(gl, opaqueFBI);\r\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0]);    \r\n    gl.depthMask(true);\r\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n    gl.bindVertexArray(xyQuadVertexArrayInfo.vertexArrayObject);\r\n\r\n    // drawOpaqueSurfaces();\r\n    // draw checkerboard\r\n    gl.useProgram(checkerProgramInfo.program);\r\n    gl.disable(gl.DEPTH_TEST);\r\n    gl.disable(gl.BLEND);\r\n    twgl.setUniforms(checkerProgramInfo, {\r\n      color1: [.5, .5, .5, 1],\r\n      color2: [.7, .7, .7, 1],\r\n      u_projection: m4.identity(),\r\n      u_modelView: m4.identity(),\r\n    });\r\n    twgl.drawBufferInfo(gl, xyQuadVertexArrayInfo);\r\n\r\n    // draw a cube with depth buffer\r\n    gl.enable(gl.DEPTH_TEST);\r\n    \r\n    {\r\n      gl.useProgram(opaqueProgramInfo.program);\r\n      gl.bindVertexArray(cubeVertexArrayInfo.vertexArrayObject);\r\n      let mat = view;\r\n      mat = m4.rotateX(mat, time * .1);\r\n      mat = m4.rotateY(mat, time * .2);\r\n      mat = m4.scale(mat, [1.5, 1.5, 1.5]);\r\n      twgl.setUniforms(opaqueProgramInfo, {\r\n        u_color: [1, .5, .2, 1],\r\n        u_lightDirection: lightDirection,\r\n        u_projection: projection,\r\n        u_modelView: mat,\r\n      });    \r\n      twgl.drawBufferInfo(gl, cubeVertexArrayInfo);\r\n    }\r\n    \r\n    twgl.bindFramebufferInfo(gl, transparentFBI);\r\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0, gl.COLOR_ATTACHMENT1]);\r\n    // these values change if using separate blend functions\r\n    // per attachment (something WebGL2 does not support)\r\n    gl.clearBufferfv(gl.COLOR, 0, new Float32Array([0, 0, 0, 1]));\r\n    gl.clearBufferfv(gl.COLOR, 1, new Float32Array([1, 1, 1, 1]));\r\n\r\n    gl.depthMask(false);  // don't write to depth buffer (but still testing)\r\n    gl.enable(gl.BLEND);\r\n    // this changes if using separate blend functions per attachment\r\n    gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ZERO, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    gl.useProgram(transparentProgramInfo.program);\r\n    gl.bindVertexArray(sphereVertexArrayInfo.vertexArrayObject);\r\n\r\n    // drawTransparentSurfaces();\r\n    const spheres = [\r\n       [ .4,  0,  0, .4],\r\n       [ .4, .4,  0, .4],\r\n       [  0, .4,  0, .4],\r\n       [  0, .4, .4, .4],\r\n       [  0, .0, .4, .4],\r\n       [ .4, .0, .4, .4],\r\n    ];\r\n    spheres.forEach((color, ndx) =&gt; {\r\n      const u = ndx + 2;\r\n      let mat = view;\r\n      mat = m4.rotateX(mat, time * u * .1);\r\n      mat = m4.rotateY(mat, time * u * .2);\r\n      mat = m4.translate(mat, [0, 0, 1 + ndx * .1]);\r\n      twgl.setUniforms(transparentProgramInfo, {\r\n        u_color: color,\r\n        u_lightDirection: lightDirection,\r\n        u_projection: projection,\r\n        u_modelView: mat,\r\n      });\r\n      twgl.drawBufferInfo(gl, sphereVertexArrayInfo);\r\n    });\r\n\r\n    // composite transparent results with opaque\r\n    twgl.bindFramebufferInfo(gl, opaqueFBI);\r\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0]);\r\n\r\n    gl.disable(gl.DEPTH_TEST);\r\n    gl.blendFunc(gl.ONE_MINUS_SRC_ALPHA, gl.SRC_ALPHA);\r\n\r\n    gl.useProgram(compositeProgramInfo.program);\r\n    gl.bindVertexArray(xyQuadVertexArrayInfo.vertexArrayObject);\r\n\r\n    twgl.setUniforms(compositeProgramInfo, {\r\n      ATexture: transparentFBI.attachments[0],\r\n      BTexture: transparentFBI.attachments[1],\r\n      u_projection: m4.identity(),\r\n      u_modelView: m4.identity(),\r\n    });\r\n\r\n    twgl.drawBufferInfo(gl, xyQuadVertexArrayInfo);\r\n\r\n    /* only needed if {alpha: false} not passed into getContext\r\n    gl.colorMask(false, false, false, true);\r\n    gl.clearColor(1, 1, 1, 1);\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    gl.colorMask(true, true, true, true);\r\n    */\r\n    \r\n    // draw opaque color buffer into canvas\r\n    // could probably use gl.blitFramebuffer\r\n    gl.disable(gl.BLEND);\r\n    twgl.bindFramebufferInfo(gl, null);\r\n    gl.useProgram(blitProgramInfo.program);\r\n    gl.bindVertexArray(xyQuadVertexArrayInfo.vertexArrayObject);\r\n\r\n    twgl.setUniforms(blitProgramInfo, {\r\n      u_texture: opaqueFBI.attachments[0],\r\n      u_projection: m4.identity(),\r\n      u_modelView: m4.identity(),\r\n    });\r\n    twgl.drawBufferInfo(gl, xyQuadVertexArrayInfo);\r\n\r\n    requestAnimationFrame(render);\r\n  }\r\n  requestAnimationFrame(render);\r\n}\r\nmain();</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>body { margin: 0; }\r\ncanvas { width: 100vw; height: 100vh; display: block; }</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;canvas&gt;&lt;/canvas&gt;\r\n&lt;script src=\"https://twgljs.org/dist/4.x/twgl-full.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>It occurs to me rather than use standard OpenGL blending for the last 2 steps (composite followed by blit) we could change the composite shader so it takes 3 textures (ATexutre, BTexture, opaqueTexture) and blends in the shader outputting directly to the canvas. That would be faster.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function main() {\r\n  const m4 = twgl.m4;\r\n  const v3 = twgl.v3;\r\n  const gl = document.querySelector('canvas').getContext('webgl2', {alpha: false});\r\n  if (!gl) {\r\n    alert('need WebGL2');\r\n    return;\r\n  }\r\n  const ext = gl.getExtension('EXT_color_buffer_float');\r\n  if (!ext) {\r\n    alert('EXT_color_buffer_float');\r\n    return;\r\n  }\r\n\r\n  const vs = `\r\n  #version 300 es\r\n  layout(location=0) in vec4 position;\r\n  layout(location=1) in vec3 normal;\r\n  uniform mat4 u_projection;\r\n  uniform mat4 u_modelView;\r\n  \r\n  out vec4 v_viewPosition;\r\n  out vec3 v_normal;\r\n\r\n  void main() {\r\n    gl_Position = u_projection * u_modelView * position;\r\n    v_viewPosition = u_modelView * position;\r\n    v_normal = (u_modelView * vec4(normal, 0)).xyz;\r\n  }\r\n  `;\r\n\r\n  const checkerFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n\r\n  uniform vec4 color1;\r\n  uniform vec4 color2;\r\n\r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    ivec2 grid = ivec2(gl_FragCoord.xy) / 32;\r\n    fragColor = mix(color1, color2, float((grid.x + grid.y) % 2));\r\n  }\r\n  `;\r\n  \r\n  const opaqueFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  \r\n  in vec4 v_viewPosition;\r\n  in vec3 v_normal;\r\n  \r\n  uniform vec4 u_color;\r\n  uniform vec3 u_lightDirection;\r\n  \r\n  out vec4 fragColor;\r\n  \r\n  void main() {\r\n    float light = abs(dot(normalize(v_normal), u_lightDirection));\r\n    fragColor = vec4(u_color.rgb * light, u_color.a);\r\n  }\r\n  `;\r\n\r\n  const transparentFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform vec4 u_color;\r\n  uniform vec3 u_lightDirection;\r\n  \r\n  in vec4 v_viewPosition;\r\n  in vec3 v_normal;\r\n  \r\n  out vec4 fragData[2];\r\n\r\n  // eq (7)\r\n  float w(float z, float a) {\r\n    return a * max(\r\n      pow(10.0, -2.0),\r\n      min(\r\n        3.0 * pow(10.0, 3.0),\r\n        10.0 /\r\n        (pow(10.0, -5.0) + \r\n         pow(abs(z) / 5.0, 2.0) +\r\n         pow(abs(z) / 200.0, 6.0)\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  void main() {\r\n    float light = abs(dot(normalize(v_normal), u_lightDirection));\r\n    vec4 Ci = vec4(u_color.rgb * light, u_color.a);\r\n  \r\n    float ai = Ci.a;\r\n    float zi = gl_FragCoord.z;\r\n\r\n    float wresult = w(zi, ai);\r\n    fragData[0] = vec4(Ci.rgb * wresult, ai);\r\n    fragData[1].r = ai * wresult;\r\n  }\r\n  `;\r\n\r\n  const compositeFS = `\r\n  #version 300 es\r\n  precision highp float;\r\n  uniform sampler2D ATexture;\r\n  uniform sampler2D BTexture;\r\n  uniform sampler2D opaqueTexture;\r\n  \r\n  out vec4 fragColor;\r\n\r\n  void main() {\r\n    vec4 accum = texelFetch(ATexture, ivec2(gl_FragCoord.xy), 0);\r\n    float r = accum.a;\r\n    accum.a = texelFetch(BTexture, ivec2(gl_FragCoord.xy), 0).r;\r\n    vec4 transparentColor = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\r\n    vec4 opaqueColor = texelFetch(opaqueTexture, ivec2(gl_FragCoord.xy), 0);\r\n    //  gl.blendFunc(gl.ONE_MINUS_SRC_ALPHA, gl.SRC_ALPHA);\r\n    fragColor = transparentColor * (1. - r) + opaqueColor * r;\r\n  }\r\n  `;\r\n  \r\n  const checkerProgramInfo = twgl.createProgramInfo(gl, [vs, checkerFS]);\r\n  const opaqueProgramInfo = twgl.createProgramInfo(gl, [vs, opaqueFS]);\r\n  const transparentProgramInfo = twgl.createProgramInfo(gl, [vs, transparentFS]);\r\n  const compositeProgramInfo = twgl.createProgramInfo(gl, [vs, compositeFS]);\r\n\r\n  const xyQuadVertexArrayInfo = makeVAO(checkerProgramInfo, twgl.primitives.createXYQuadBufferInfo(gl));\r\n  const sphereVertexArrayInfo = makeVAO(transparentProgramInfo, twgl.primitives.createSphereBufferInfo(gl, 1, 16, 12));\r\n  const cubeVertexArrayInfo = makeVAO(opaqueProgramInfo, twgl.primitives.createCubeBufferInfo(gl, 1, 1));\r\n  \r\n  function makeVAO(programInfo, bufferInfo) {\r\n    return twgl.createVertexArrayInfo(gl, programInfo, bufferInfo);\r\n  }\r\n  \r\n  // In order to do proper zbuffering we need to share\r\n  // the depth buffer \r\n  \r\n  const opaqueAttachments = [\r\n    { internalFormat: gl.RGBA8, minMag: gl.NEAREST },\r\n    { format: gl.DEPTH_COMPONENT16, minMag: gl.NEAREST },\r\n  ];\r\n  const opaqueFBI = twgl.createFramebufferInfo(gl, opaqueAttachments);\r\n  \r\n  const transparentAttachments = [\r\n    { internalFormat: gl.RGBA32F, minMag: gl.NEAREST },\r\n    { internalFormat: gl.R32F, minMag: gl.NEAREST },\r\n    { format: gl.DEPTH_COMPONENT16, minMag: gl.NEAREST, attachment: opaqueFBI.attachments[1] },\r\n  ];\r\n  const transparentFBI = twgl.createFramebufferInfo(gl, transparentAttachments);\r\n\r\n  function render(time) {\r\n    time *= 0.001;\r\n\r\n    if (twgl.resizeCanvasToDisplaySize(gl.canvas)) {\r\n      // if the canvas is resized also resize the framebuffer\r\n      // attachments (the depth buffer will be resized twice \r\n      // but I'm too lazy to fix it)\r\n      twgl.resizeFramebufferInfo(gl, opaqueFBI, opaqueAttachments);\r\n      twgl.resizeFramebufferInfo(gl, transparentFBI, transparentAttachments);\r\n    }\r\n    \r\n    const aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;\r\n    const fov = 45 * Math.PI / 180;\r\n    const zNear = 0.1;\r\n    const zFar = 500;\r\n    \r\n    const projection = m4.perspective(fov, aspect, zNear, zFar);\r\n    const eye = [0, 0, -5];\r\n    const target = [0, 0, 0];\r\n    const up = [0, 1, 0];\r\n    const camera = m4.lookAt(eye, target, up);\r\n    const view = m4.inverse(camera);\r\n\r\n    const lightDirection = v3.normalize([1, 3, 5]);\r\n\r\n    twgl.bindFramebufferInfo(gl, opaqueFBI);\r\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0]);    \r\n    gl.depthMask(true);\r\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n    gl.bindVertexArray(xyQuadVertexArrayInfo.vertexArrayObject);\r\n\r\n    // drawOpaqueSurfaces();\r\n    // draw checkerboard\r\n    gl.useProgram(checkerProgramInfo.program);\r\n    gl.disable(gl.DEPTH_TEST);\r\n    gl.disable(gl.BLEND);\r\n    twgl.setUniforms(checkerProgramInfo, {\r\n      color1: [.5, .5, .5, 1],\r\n      color2: [.7, .7, .7, 1],\r\n      u_projection: m4.identity(),\r\n      u_modelView: m4.identity(),\r\n    });\r\n    twgl.drawBufferInfo(gl, xyQuadVertexArrayInfo);\r\n\r\n    // draw a cube with depth buffer\r\n    gl.enable(gl.DEPTH_TEST);\r\n    \r\n    {\r\n      gl.useProgram(opaqueProgramInfo.program);\r\n      gl.bindVertexArray(cubeVertexArrayInfo.vertexArrayObject);\r\n      let mat = view;\r\n      mat = m4.rotateX(mat, time * .1);\r\n      mat = m4.rotateY(mat, time * .2);\r\n      mat = m4.scale(mat, [1.5, 1.5, 1.5]);\r\n      twgl.setUniforms(opaqueProgramInfo, {\r\n        u_color: [1, .5, .2, 1],\r\n        u_lightDirection: lightDirection,\r\n        u_projection: projection,\r\n        u_modelView: mat,\r\n      });    \r\n      twgl.drawBufferInfo(gl, cubeVertexArrayInfo);\r\n    }\r\n    \r\n    twgl.bindFramebufferInfo(gl, transparentFBI);\r\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0, gl.COLOR_ATTACHMENT1]);\r\n    // these values change if using separate blend functions\r\n    // per attachment (something WebGL2 does not support)\r\n    gl.clearBufferfv(gl.COLOR, 0, new Float32Array([0, 0, 0, 1]));\r\n    gl.clearBufferfv(gl.COLOR, 1, new Float32Array([1, 1, 1, 1]));\r\n\r\n    gl.depthMask(false);  // don't write to depth buffer (but still testing)\r\n    gl.enable(gl.BLEND);\r\n    // this changes if using separate blend functions per attachment\r\n    gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ZERO, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    gl.useProgram(transparentProgramInfo.program);\r\n    gl.bindVertexArray(sphereVertexArrayInfo.vertexArrayObject);\r\n\r\n    // drawTransparentSurfaces();\r\n    const spheres = [\r\n       [ .4,  0,  0, .4],\r\n       [ .4, .4,  0, .4],\r\n       [  0, .4,  0, .4],\r\n       [  0, .4, .4, .4],\r\n       [  0, .0, .4, .4],\r\n       [ .4, .0, .4, .4],\r\n    ];\r\n    spheres.forEach((color, ndx) =&gt; {\r\n      const u = ndx + 2;\r\n      let mat = view;\r\n      mat = m4.rotateX(mat, time * u * .1);\r\n      mat = m4.rotateY(mat, time * u * .2);\r\n      mat = m4.translate(mat, [0, 0, 1 + ndx * .1]);\r\n      twgl.setUniforms(transparentProgramInfo, {\r\n        u_color: color,\r\n        u_lightDirection: lightDirection,\r\n        u_projection: projection,\r\n        u_modelView: mat,\r\n      });\r\n      twgl.drawBufferInfo(gl, sphereVertexArrayInfo);\r\n    });\r\n\r\n    // composite transparent results with opaque\r\n    twgl.bindFramebufferInfo(gl, null);\r\n\r\n    gl.disable(gl.DEPTH_TEST);\r\n    gl.disable(gl.BLEND);\r\n    \r\n    gl.useProgram(compositeProgramInfo.program);\r\n    gl.bindVertexArray(xyQuadVertexArrayInfo.vertexArrayObject);\r\n\r\n    twgl.setUniforms(compositeProgramInfo, {\r\n      ATexture: transparentFBI.attachments[0],\r\n      BTexture: transparentFBI.attachments[1],\r\n      opaqueTexture: opaqueFBI.attachments[0],\r\n      u_projection: m4.identity(),\r\n      u_modelView: m4.identity(),\r\n    });\r\n\r\n    twgl.drawBufferInfo(gl, xyQuadVertexArrayInfo);\r\n\r\n    /* only needed if {alpha: false} not passed into getContext\r\n    gl.colorMask(false, false, false, true);\r\n    gl.clearColor(1, 1, 1, 1);\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    gl.colorMask(true, true, true, true);\r\n    */\r\n    \r\n    requestAnimationFrame(render);\r\n  }\r\n  requestAnimationFrame(render);\r\n}\r\nmain();</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>body { margin: 0; }\r\ncanvas { width: 100vw; height: 100vh; display: block; }</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;canvas&gt;&lt;/canvas&gt;\r\n&lt;script src=\"https://twgljs.org/dist/4.x/twgl-full.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 3, "accepted_answer_id": 50777930, "answer_count": 2, "score": 1, "last_activity_date": 1528612076, "creation_date": 1528288450, "last_edit_date": 1528309366, "question_id": 50720534, "link": "https://stackoverflow.com/questions/50720534/implementing-depth-testing-for-semi-transparent-objects", "title": "Implementing depth testing for semi-transparent objects", "body": "<p>I've been carefully trolling the internet for the past two days to understand depth testing for semi-transparent objects. I've read multiple papers/tutorials on the subject and in theory I believe I understand how it works. However none of them give me actual example code.</p>\n\n<p>I have three requirements for my depth testing of semi-transparent objects:</p>\n\n<ol>\n<li><p>It should be order independant.</p></li>\n<li><p>It should work if two quads of the same objects are intersection each other. Both semi-transparent. Imagine a grass object that looks like a X when viewed from above:</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/sWESO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sWESO.jpg\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"3\">\n<li>It should correctly render a semi-transparent player <code>rgba(0, 1, 0, 0.5)</code>, behind a building's window <code>rgba(0, 0, 1, 0.5)</code>, but in front of a background object <code>rgba(1, 0, 0, 1)</code>:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/FmNCN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FmNCN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><em>The line on the far left is how I imagine the light/color changes as it travels through the semi-transparent objects towards the camera</em></p>\n\n<h2>Final Thoughts</h2>\n\n<p>I suspect the best approach to go for is to do depth peeling, but I'm still lacking some implementation/example. I'm leaning towards this approach because the game is 2.5D and since it could get dangerous for performance (lots of layers to peel), there won't need to be more than two semi-transparent objects to \"peel\".</p>\n\n<p>I'm already familiar with framebuffers and how to code them (doing some post processing effects with them). I will be using them, right?</p>\n\n<p>Most of the knowledge of opengl comes from <a href=\"https://learnopengl.com/\" rel=\"nofollow noreferrer\">this tutorial</a> but it covers depth testing and semi-transparency separately. He also sadly doesn't cover order independent transparency at all (see bottom of Blending page).</p>\n\n<p>Finally, please don't answer only in theory. e.g. </p>\n\n<blockquote>\n  <p>Draw opaque, draw transparent, draw opaque again, etc.</p>\n</blockquote>\n\n<p>My ideal answer will contain code of how the buffers are configured, the shaders, and screenshots of each pass with an explanation of what its doing.</p>\n\n<p>The programming language used is also not too important as long as it uses OpenGL 4 or newer. The non-opengl code can be pseudo (I don't care how you sort an array or create an GLFW window).</p>\n\n<h3>EDIT:</h3>\n\n<p>I'm updating my question to just have so example of the current state of my code. This example draws the semi-transparent player (green) first, opaque background (red) second and then the semi-transparent window (blue). However the depth should be calculated by the Z position of the square and not the order of which it is drawn.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>(function() {\r\n   // your page initialization code here\r\n   // the DOM will be available here\r\n  var script = document.createElement('script');\r\n  script.onload = function () {\r\n    main();\r\n  };\r\n  script.src = 'https://mdn.github.io/webgl-examples/tutorial/gl-matrix.js';\r\n  document.head.appendChild(script); //or something of the likes\r\n})();\r\n\r\n//\r\n// Start here\r\n//\r\nfunction main() {\r\n  const canvas = document.querySelector('#glcanvas');\r\n  const gl = canvas.getContext('webgl', {alpha:false});\r\n\r\n  // If we don't have a GL context, give up now\r\n\r\n  if (!gl) {\r\n    alert('Unable to initialize WebGL. Your browser or machine may not support it.');\r\n    return;\r\n  }\r\n\r\n  // Vertex shader program\r\n\r\n  const vsSource = `\r\n    attribute vec4 aVertexPosition;\r\n    attribute vec4 aVertexColor;\r\n\r\n    uniform mat4 uModelViewMatrix;\r\n    uniform mat4 uProjectionMatrix;\r\n\r\n    varying lowp vec4 vColor;\r\n\r\n    void main(void) {\r\n      gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\r\n      vColor = aVertexColor;\r\n    }\r\n  `;\r\n\r\n  // Fragment shader program\r\n\r\n  const fsSource = `\r\n    varying lowp vec4 vColor;\r\n\r\n    void main(void) {\r\n      gl_FragColor = vColor;\r\n    }\r\n  `;\r\n\r\n  // Initialize a shader program; this is where all the lighting\r\n  // for the vertices and so forth is established.\r\n  const shaderProgram = initShaderProgram(gl, vsSource, fsSource);\r\n\r\n  // Collect all the info needed to use the shader program.\r\n  // Look up which attributes our shader program is using\r\n  // for aVertexPosition, aVevrtexColor and also\r\n  // look up uniform locations.\r\n  const programInfo = {\r\n    program: shaderProgram,\r\n    attribLocations: {\r\n      vertexPosition: gl.getAttribLocation(shaderProgram, 'aVertexPosition'),\r\n      vertexColor: gl.getAttribLocation(shaderProgram, 'aVertexColor'),\r\n    },\r\n    uniformLocations: {\r\n      projectionMatrix: gl.getUniformLocation(shaderProgram, 'uProjectionMatrix'),\r\n      modelViewMatrix: gl.getUniformLocation(shaderProgram, 'uModelViewMatrix'),\r\n    },\r\n  };\r\n\r\n  // Here's where we call the routine that builds all the\r\n  // objects we'll be drawing.\r\n  const buffers = initBuffers(gl);\r\n\r\n  // Draw the scene\r\n  drawScene(gl, programInfo, buffers);\r\n}\r\n\r\n//\r\n// initBuffers\r\n//\r\n// Initialize the buffers we'll need. For this demo, we just\r\n// have one object -- a simple two-dimensional square.\r\n//\r\nfunction initBuffers(gl) {\r\n  // Create a buffer for the square's positions.\r\n\r\n  const positionBuffer0 = gl.createBuffer();\r\n\r\n  // Select the positionBuffer as the one to apply buffer\r\n  // operations to from here out.\r\n\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer0);\r\n\r\n  // Now create an array of positions for the square.\r\n\r\n  var positions = [\r\n     0.5,  0.5,\r\n    -0.5,  0.5,\r\n     0.5, -0.5,\r\n    -0.5, -0.5,\r\n  ];\r\n\r\n  // Now pass the list of positions into WebGL to build the\r\n  // shape. We do this by creating a Float32Array from the\r\n  // JavaScript array, then use it to fill the current buffer.\r\n\r\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\r\n\r\n  // Now set up the colors for the vertices\r\n\r\n  var colors = [\r\n    0.0,  1.0,  0.0,  0.5,    // white\r\n    0.0,  1.0,  0.0,  0.5,    // red\r\n    0.0,  1.0,  0.0,  0.5,    // green\r\n    0.0,  1.0,  0.0,  0.5,    // blue\r\n  ];\r\n\r\n  const colorBuffer0 = gl.createBuffer();\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer0);\r\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.STATIC_DRAW);\r\n\r\n\r\n\r\n  // Create a buffer for the square's positions.\r\n\r\n  const positionBuffer1 = gl.createBuffer();\r\n\r\n  // Select the positionBuffer as the one to apply buffer\r\n  // operations to from here out.\r\n\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer1);\r\n\r\n  // Now create an array of positions for the square.\r\n\r\n  positions = [\r\n     2.0,  0.4,\r\n    -2.0,  0.4,\r\n     2.0, -2.0,\r\n    -2.0, -2.0,\r\n  ];\r\n\r\n  // Now pass the list of positions into WebGL to build the\r\n  // shape. We do this by creating a Float32Array from the\r\n  // JavaScript array, then use it to fill the current buffer.\r\n\r\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\r\n\r\n  // Now set up the colors for the vertices\r\n\r\n  colors = [\r\n    1.0,  0.0,  0.0,  1.0,    // white\r\n    1.0,  0.0,  0.0,  1.0,    // red\r\n    1.0,  0.0,  0.0,  1.0,    // green\r\n    1.0,  0.0,  0.0,  1.0,    // blue\r\n  ];\r\n\r\n  const colorBuffer1 = gl.createBuffer();\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer1);\r\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.STATIC_DRAW);\r\n  \r\n  // Create a buffer for the square's positions.\r\n\r\n  const positionBuffer2 = gl.createBuffer();\r\n\r\n  // Select the positionBuffer as the one to apply buffer\r\n  // operations to from here out.\r\n\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer2);\r\n\r\n  // Now create an array of positions for the square.\r\n\r\n  positions = [\r\n     1.0,  1.0,\r\n    -0.0,  1.0,\r\n     1.0, -1.0,\r\n    -0.0, -1.0,\r\n  ];\r\n\r\n  // Now pass the list of positions into WebGL to build the\r\n  // shape. We do this by creating a Float32Array from the\r\n  // JavaScript array, then use it to fill the current buffer.\r\n\r\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\r\n\r\n  // Now set up the colors for the vertices\r\n\r\n  colors = [\r\n    0.0,  0.0,  1.0,  0.5,    // white\r\n    0.0,  0.0,  1.0,  0.5,    // red\r\n    0.0,  0.0,  1.0,  0.5,    // green\r\n    0.0,  0.0,  1.0,  0.5,    // blue\r\n  ];\r\n\r\n  const colorBuffer2 = gl.createBuffer();\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer2);\r\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.STATIC_DRAW);\r\n\r\n\r\n\r\n  return {\r\n    position0: positionBuffer0,\r\n    color0: colorBuffer0,\r\n    position1: positionBuffer1,\r\n    color1: colorBuffer1,\r\n    position2: positionBuffer2,\r\n    color2: colorBuffer2,\r\n  };\r\n}\r\n\r\n//\r\n// Draw the scene.\r\n//\r\nfunction drawScene(gl, programInfo, buffers) {\r\n  gl.clearColor(0.0, 0.0, 0.0, 1.0);  // Clear to black, fully opaque\r\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n  //gl.clearDepth(1.0);                 // Clear everything\r\n  gl.disable(gl.DEPTH_TEST)\r\n  gl.enable(gl.BLEND)\r\n  gl.blendEquation(gl.FUNC_ADD)\r\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA)\r\n\r\n  // Clear the canvas before we start drawing on it.\r\n\r\n\r\n  // Create a perspective matrix, a special matrix that is\r\n  // used to simulate the distortion of perspective in a camera.\r\n  // Our field of view is 45 degrees, with a width/height\r\n  // ratio that matches the display size of the canvas\r\n  // and we only want to see objects between 0.1 units\r\n  // and 100 units away from the camera.\r\n\r\n  const fieldOfView = 45 * Math.PI / 180;   // in radians\r\n  const aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;\r\n  const zNear = 0.1;\r\n  const zFar = 100.0;\r\n  const projectionMatrix = mat4.create();\r\n\r\n  // note: glmatrix.js always has the first argument\r\n  // as the destination to receive the result.\r\n  mat4.perspective(projectionMatrix,\r\n                   fieldOfView,\r\n                   aspect,\r\n                   zNear,\r\n                   zFar);\r\n\r\n  // Set the drawing position to the \"identity\" point, which is\r\n  // the center of the scene.\r\n  const modelViewMatrix = mat4.create();\r\n\r\n  // Now move the drawing position a bit to where we want to\r\n  // start drawing the square.\r\n\r\n  mat4.translate(modelViewMatrix,     // destination matrix\r\n                 modelViewMatrix,     // matrix to translate\r\n                 [-0.0, 0.0, -6.0]);  // amount to translate\r\n\r\n  function drawSquare(positionbuffer, colorbuffer) {\r\n  // Tell WebGL how to pull out the positions from the position\r\n  // buffer into the vertexPosition attribute\r\n  {\r\n    const numComponents = 2;\r\n    const type = gl.FLOAT;\r\n    const normalize = false;\r\n    const stride = 0;\r\n    const offset = 0;\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, positionbuffer);\r\n    gl.vertexAttribPointer(\r\n        programInfo.attribLocations.vertexPosition,\r\n        numComponents,\r\n        type,\r\n        normalize,\r\n        stride,\r\n        offset);\r\n    gl.enableVertexAttribArray(\r\n        programInfo.attribLocations.vertexPosition);\r\n  }\r\n\r\n  // Tell WebGL how to pull out the colors from the color buffer\r\n  // into the vertexColor attribute.\r\n  {\r\n    const numComponents = 4;\r\n    const type = gl.FLOAT;\r\n    const normalize = false;\r\n    const stride = 0;\r\n    const offset = 0;\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, colorbuffer);\r\n    gl.vertexAttribPointer(\r\n        programInfo.attribLocations.vertexColor,\r\n        numComponents,\r\n        type,\r\n        normalize,\r\n        stride,\r\n        offset);\r\n    gl.enableVertexAttribArray(\r\n        programInfo.attribLocations.vertexColor);\r\n  }\r\n\r\n  // Tell WebGL to use our program when drawing\r\n\r\n  gl.useProgram(programInfo.program);\r\n\r\n  // Set the shader uniforms\r\n\r\n  gl.uniformMatrix4fv(\r\n      programInfo.uniformLocations.projectionMatrix,\r\n      false,\r\n      projectionMatrix);\r\n  gl.uniformMatrix4fv(\r\n      programInfo.uniformLocations.modelViewMatrix,\r\n      false,\r\n      modelViewMatrix);\r\n\r\n  {\r\n    const offset = 0;\r\n    const vertexCount = 4;\r\n    gl.drawArrays(gl.TRIANGLE_STRIP, offset, vertexCount);\r\n  }\r\n  }\r\n  drawSquare(buffers.position0, buffers.color0); // Player\r\n  drawSquare(buffers.position1, buffers.color1); // Background\r\n  drawSquare(buffers.position2, buffers.color2); // Window\r\n}\r\n\r\n//\r\n// Initialize a shader program, so WebGL knows how to draw our data\r\n//\r\nfunction initShaderProgram(gl, vsSource, fsSource) {\r\n  const vertexShader = loadShader(gl, gl.VERTEX_SHADER, vsSource);\r\n  const fragmentShader = loadShader(gl, gl.FRAGMENT_SHADER, fsSource);\r\n\r\n  // Create the shader program\r\n\r\n  const shaderProgram = gl.createProgram();\r\n  gl.attachShader(shaderProgram, vertexShader);\r\n  gl.attachShader(shaderProgram, fragmentShader);\r\n  gl.linkProgram(shaderProgram);\r\n\r\n  // If creating the shader program failed, alert\r\n\r\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\r\n    alert('Unable to initialize the shader program: ' + gl.getProgramInfoLog(shaderProgram));\r\n    return null;\r\n  }\r\n\r\n  return shaderProgram;\r\n}\r\n\r\n//\r\n// creates a shader of the given type, uploads the source and\r\n// compiles it.\r\n//\r\nfunction loadShader(gl, type, source) {\r\n  const shader = gl.createShader(type);\r\n\r\n  // Send the source to the shader object\r\n\r\n  gl.shaderSource(shader, source);\r\n\r\n  // Compile the shader program\r\n\r\n  gl.compileShader(shader);\r\n\r\n  // See if it compiled successfully\r\n\r\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n    alert('An error occurred compiling the shaders: ' + gl.getShaderInfoLog(shader));\r\n    gl.deleteShader(shader);\r\n    return null;\r\n  }\r\n\r\n  return shader;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n  &lt;meta charset=\"utf-8\"&gt;\r\n  &lt;meta name=\"viewport\" content=\"width=device-width\"&gt;\r\n  &lt;title&gt;&lt;/title&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n  &lt;canvas id=\"glcanvas\" width=\"640\" height=\"480\"&gt;&lt;/canvas&gt;\r\n\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c++", "if-statement", "switch-statement", "conversion-operator", "explicit-conversion"], "answers": [{"comments": [{"owner": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "edited": false, "score": 2, "creation_date": 1528289105, "post_id": 50720682, "comment_id": 88449905, "body": "But there&#39;ll still be an error of ambiguity if both the bool and int casts are present, even if both are not declared explicit."}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "reply_to_user": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "edited": false, "score": 0, "creation_date": 1528290269, "post_id": 50720682, "comment_id": 88450630, "body": "I added an example to adress the ambiguity part"}, {"owner": {"reputation": 2920, "user_id": 3022952, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b62f68f2f334d828423b8706fc88c56e?s=128&d=identicon&r=PG&f=1", "display_name": "R.M.", "link": "https://stackoverflow.com/users/3022952/r-m"}, "edited": false, "score": 0, "creation_date": 1528298129, "post_id": 50720682, "comment_id": 88456106, "body": "So is the 2 cent summary that <code>switch</code> does an implicit conversion to int, whereas <code>if</code> does an explicit conversion (to bool)?"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1528298383, "post_id": 50720682, "comment_id": 88456286, "body": "Basically, yes. The compiler cast the condition inside a if-statement to a boolean. This is why there is no ambiguity with <code>if(...)</code> even if both are implicit operator."}], "tags": [], "owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "is_accepted": false, "score": 17, "last_activity_date": 1528290684, "last_edit_date": 1592644375, "creation_date": 1528288884, "answer_id": 50720682, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators/50720682#50720682", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>The syntax is <code>switch ( condition ) statement</code> with</p>\n<blockquote>\n<p>condition     -   any expression of integral or enumeration type, or of a class type <strong>contextually</strong> <strong>implicitly</strong> convertible to an integral or enumeration type, or a declaration of a single non-array variable of such type with a brace-or-equals initializer.</p>\n</blockquote>\n<p>Taken from <a href=\"https://en.cppreference.com/w/cpp/language/switch\" rel=\"noreferrer\">cppreference.</a></p>\n<p>This means you can only do a switch case on an integer or enum <strong>type</strong>. For the compiler to be able implicitly convert Wrapper to integer / enum type you need to remove the explicit keyword :</p>\n<blockquote>\n<p>The explicit specifier specifies that a constructor or conversion function (since C++11) doesn't allow implicit conversions</p>\n</blockquote>\n<p>You can also cast Wrapper to int type.</p>\n<p>Edit to adress @acraig5075 remarks :</p>\n<p>You must be careful which operator is explicit and which is implicit. If both are implicit the code won't compile because there will be an amibiguity :</p>\n<pre><code>struct Wrapper\n{\n    operator int() { return 0; }\n    operator bool() { return true; }    \n};\n</code></pre>\n<blockquote>\n<p>source_file.cpp: In function \u2018int main()\u2019: source_file.cpp:12:14:</p>\n<p>error: ambiguous default type conversion from \u2018Wrapper\u2019</p>\n<p>switch (w) {</p>\n<p>^ source_file.cpp:12:14: note:   candidate conversion</p>\n<p>include \u2018Wrapper::operator int()\u2019 and \u2018Wrapper::operator bool()\u2019</p>\n</blockquote>\n<p>The only way to remove the ambiguity is to do a cast.</p>\n<p>If only one of the operator is explicit, the other one will be chosen for the switch statement :</p>\n<pre><code>#include &lt;iostream&gt;\nstruct Wrapper\n{\n    explicit operator int() { return 0; }\n    operator bool() { return true; }    \n};\n\nint main()\n{\n    Wrapper w;\n    if (w) { /** this line compiles **/std::cout &lt;&lt; &quot; if is true &quot; &lt;&lt; std::endl; }\n    switch (w) { \n        case 0:\n            std::cout &lt;&lt; &quot;case 0&quot; &lt;&lt; std::endl;\n            break;\n        case 1:\n            std::cout &lt;&lt; &quot;case 1&quot; &lt;&lt; std::endl;\n            break;\n    }\n    return 0;\n}\n</code></pre>\n<p>Output :</p>\n<pre><code> if is true \ncase 1\n</code></pre>\n<p><code>w</code> has been implicitly converted to <code>1</code> (<code>true</code>) (because operator int is explicit) and case 1 is executed.</p>\n<p>On the other hand :</p>\n<pre><code>struct Wrapper\n{\n    operator int() { return 0; }\n    explicit operator bool() { return true; }    \n};\n</code></pre>\n<p>Ouput :</p>\n<pre><code> if is true \ncase 0\n</code></pre>\n<p><code>w</code> has been implicitly converted to <code>0</code> because operator bool is explicit.</p>\n<p>In both case, the if statement is true because <code>w</code> is evaluated <strong>contextually</strong> to a boolean inside the if-statement.</p>\n"}, {"comments": [{"owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 0, "creation_date": 1528289348, "post_id": 50720717, "comment_id": 88450058, "body": "This explains why <code>if</code> is accepted, but does not explain why the same concept of &quot;contextually convertible&quot; has been decided to not apply towards an integral type when inside the context of a <code>switch</code> statement."}, {"owner": {"reputation": 3023, "user_id": 5587393, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1d83bf6603c6c7a002ab8e18e418e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Luzzara", "link": "https://stackoverflow.com/users/5587393/marco-luzzara"}, "reply_to_user": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 3, "creation_date": 1528292192, "post_id": 50720717, "comment_id": 88452032, "body": "Go on reading when it refers to the 3 context behind (included the <code>switch</code>): <code>Note that explicit conversion functions are not considered, even though they are considered in contextual conversions to bool.</code> However I did not found a precise reason why this is not implemented with <code>switch</code>."}, {"owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 2, "creation_date": 1528292706, "post_id": 50720717, "comment_id": 88452431, "body": "The &quot;double standard&quot; here (so to say) is puzzling me."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 1, "creation_date": 1528302550, "post_id": 50720717, "comment_id": 88458794, "body": "@nyarlathotep108: <code>explicit</code> conversion operators exist to prevent people from performing implicit conversions. The &quot;contextual conversion to <code>bool</code>&quot; rule exists for the sole purpose of excepting this rule in certain very specific locations. It only works for <code>bool</code>, and only in those locations, by design. This allows us to avoid needing the &quot;safe bool&quot; idiom, while still being able to have types that are convertible to <code>bool</code> for conditions."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "reply_to_user": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 0, "creation_date": 1528880724, "post_id": 50720717, "comment_id": 88670320, "body": "@nyarlathotep108 there&#39;s nothing else in C++ that offers an automatic/implicit cast to any integral type. Consider a class that contains three cast operators returning different enum types, which of the three should the implicit switch cast prefer?"}], "tags": [], "owner": {"reputation": 3023, "user_id": 5587393, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1d83bf6603c6c7a002ab8e18e418e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Luzzara", "link": "https://stackoverflow.com/users/5587393/marco-luzzara"}, "is_accepted": false, "score": 10, "last_activity_date": 1528289000, "creation_date": 1528289000, "answer_id": 50720717, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators/50720717#50720717", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>I think <a href=\"https://en.cppreference.com/w/cpp/language/implicit_conversion#Contextual_conversions\" rel=\"noreferrer\">this</a> explains why the <code>switch</code> statement is not accepted, whereas the <code>if</code> statement is:</p>\n\n<blockquote>\n  <p>In the following five contexts, the type bool is expected and the implicit conversion sequence is built if the declaration <code>bool t(e);</code> is well-formed. that is, the explicit user-defined conversion function such as <code>explicit T::operator bool() const;</code> is considered. Such expression e is said to be <strong>contextually convertible to bool</strong>.</p>\n</blockquote>\n\n<ul>\n<li>controlling expression of if, while, for;</li>\n<li>the logical operators !, &amp;&amp; and ||;</li>\n<li>the conditional operator ?:;</li>\n<li>static_assert;</li>\n<li>noexcept.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 0, "creation_date": 1528290686, "post_id": 50721007, "comment_id": 88450903, "body": "I am reformulating the question as the example code is raising ambuigity on the purpose of the question itself"}, {"owner": {"reputation": 656, "user_id": 5277022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7aa91dde8db1b879b0842a0a75ee62b?s=128&d=identicon&r=PG&f=1", "display_name": "navyblue", "link": "https://stackoverflow.com/users/5277022/navyblue"}, "reply_to_user": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "edited": false, "score": 1, "creation_date": 1528292881, "post_id": 50721007, "comment_id": 88452524, "body": "After you&#39;ve reformulated the question: Regarding <code>switch</code>, there is no ambiguity but the conversion operator is explicit so it won&#39;t work because <code>switch</code> requires that the condition expression is implicitly convertible to an integral type. When it comes to <code>if</code>, its condition is such a context that explicit conversion to <code>bool</code> is also taken into account by the compiler so it&#39;s fine. In other words, <code>switch</code> requires an integral type and only implicit conversions may be used while in <code>if</code> statement a <code>bool</code> is required but both implicit and explicit conversions may be used."}], "tags": [], "owner": {"reputation": 656, "user_id": 5277022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7aa91dde8db1b879b0842a0a75ee62b?s=128&d=identicon&r=PG&f=1", "display_name": "navyblue", "link": "https://stackoverflow.com/users/5277022/navyblue"}, "is_accepted": false, "score": 0, "last_activity_date": 1528289787, "creation_date": 1528289787, "answer_id": 50721007, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators/50721007#50721007", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>There are two problems with your code.\nFirst, the conversion operator(s) must not be explicit to work with <code>switch</code> statements.\nSecondly, <code>switch</code> condition requires an integral type and both <code>int</code> and <code>bool</code> are such types so there is an ambiguity.\nIf you change your class so that it doesn't have these two problems the <code>switch</code> will compile and work as expected.</p>\n\n<p>Another solution that doesn't require changing your class is to explicitly cast (<code>static_cast</code> will do) the value to <code>int</code> or <code>bool</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "is_accepted": false, "score": 3, "last_activity_date": 1528304651, "last_edit_date": 1528304651, "creation_date": 1528302121, "answer_id": 50725164, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators/50725164#50725164", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>One answer is that <code>if</code> and <code>switch</code> behave differently because that's how the standard was written. Another answer might speculate on why the standard was written that way. Well, I suppose the standard made <code>if</code> statements behave that way to address a specific problem (implicit conversions to <code>bool</code> <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2333.html\" rel=\"nofollow noreferrer\">had been problematic</a>), but I'd like to adopt a different perspective.</p>\n\n<p>In an <code>if</code> statement, the condition must be a boolean value. Not everyone thinks about <code>if</code> statements this way, presumably because of the various conveniences built into the language. However, at its core, an <code>if</code> statement needs to know \"do this\" or \"do that\"; \"yes\" or \"no\"; <code>true</code> or <code>false</code> -- i.e. a boolean value. In this respect, putting something inside the statement's conditional is explicitly requesting that the something be converted to <code>bool</code>.</p>\n\n<p>On the other hand, a <code>switch</code> statement accepts any integral type. That is, there is no single type preferred over all others. Use of a <code>switch</code> can be seen as an explicit request to convert a value to an integral type, but not necessarily specifically to <code>int</code>. So it is not considered appropriate to use a conversion to <code>int</code> when that specific conversion needs to be explicitly requested.</p>\n"}, {"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 3, "last_activity_date": 1528303839, "creation_date": 1528303839, "answer_id": 50725658, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators/50725658#50725658", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>Declaring a conversion operator <code>explicit</code> exists to prevent implicit conversions to that type. That is its purpose. <code>switch</code> attempts to implicitly convert its argument to an integer; therefore an <code>explicit</code> operator will not be called. That's the expected behavior.</p>\n\n<p>What is unexpected is that an <code>explicit</code> operator is called in the <code>if</code> case. And thereby hangs a tale.</p>\n\n<p>See, given the above rules, the way to make a type testable via <code>if</code> is to make a non-<code>explicit</code> conversion to <code>bool</code>. The thing is... <code>bool</code> is a problematic type. It is implicitly convertible to integers. So if you make a type that is implicitly convertible to <code>bool</code>, this is legal code:</p>\n\n<pre><code>void foo(int);\nfoo(convertible_type{});\n</code></pre>\n\n<p>But this is also meaningless code. You never meant for <code>convertible_type</code> to implicitly convert to an integer. You just wanted it to convert to a boolean for testing purposes.</p>\n\n<p>Pre-C++11, the way to fix that was the \"safe bool idiom\", which was a complex pain and made no logical sense (basically, you provided an implicit conversion to a member pointer, which was convertible to a boolean but not to integers or regular pointers).</p>\n\n<p>So in C++11, when they added <code>explicit</code> conversion operators, they made an exception for <code>bool</code>. If you have an <code>explicit operator bool()</code>, this type can be \"contextually converted to <code>bool</code>\" inside of a set number of language-defined places. This allows <code>explicit operator bool()</code> to mean \"testable in boolean conditions\".</p>\n\n<p><code>switch</code> doesn't need such protection. If you want a type to be implicitly convertible to <code>int</code> for <code>switch</code> purposes, there's no reason why it wouldn't be implicitly convertible to <code>int</code> for other purposes too.</p>\n"}, {"comments": [{"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528338780, "post_id": 50729291, "comment_id": 88472210, "body": "This answer is inaccurate concerning C. In C, an <code>if</code> statement&#39;s conditional must be a scalar type (not a class instance -- C has no concept of &quot;convertible&quot;). So this particular question, involving a struct convertible to a scalar type, is not applicable in C; i.e. C++ can handle it any way it likes and still maintain compatibility with C. No matter what is done, it would not be how C does it. In fact, the use of explicit conversions was not even how C++ handled <code>if</code> statements until C++11."}, {"owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528346437, "post_id": 50729291, "comment_id": 88473827, "body": "I did not say that C does conversions in <code>if</code> statements. I&#39;m trying to explain why the behavior described in the question is exactly what one would expect given how floats and pointers are treated in both languages. C is applicable here because that&#39;s the language that set the precedent. As someone who learned C before C++, it seems obvious to me that this is the reasoning that the OP is looking for."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528353801, "post_id": 50729291, "comment_id": 88476776, "body": "The word &quot;obvious&quot; is overused. For example, the behavior is not what <b>I</b> would expect given how floats and pointers are treated in both languages. As someone who learned C before C++, it seems to me that these conclusions are wrong, hence <i>not</i> what the OP is looking for."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528354186, "post_id": 50729291, "comment_id": 88476999, "body": "To clarify: the behavior for <code>if</code> statements is not what I would expect. If talking about just the behavior of <code>switch</code> statements, then sure, it&#39;s the same in both languages. But that does not really address the question of why <code>if</code> looks at explicit conversions but <code>switch</code> does not."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528355087, "post_id": 50729291, "comment_id": 88477524, "body": "Another clarification: I have no issues with the rationale for why this behavior is reasonable. It&#39;s the (boldface) assertion that &quot;this is how C does it&quot; that I am questioning. From my perspective, this answer would be fine if the mentions of C were dropped."}, {"owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528373669, "post_id": 50729291, "comment_id": 88489302, "body": "I added a sentence to try to clarify the connection. I understand that people can disagree on what&#39;s obvious. It happens all the time. But when someone asks why a language feature is the way it is, I think it&#39;s important to dig as far as we need to to show how that feature fits into the larger scheme of things. Even if the exact feature in the question doesn&#39;t exist in C, we still have to talk about how C sets the precedent for <code>if</code> statements being as permissive as they are."}], "tags": [], "owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "is_accepted": false, "score": 0, "last_activity_date": 1528370354, "last_edit_date": 1528370354, "creation_date": 1528317829, "answer_id": 50729291, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators/50729291#50729291", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>I believe the real reason for this behavior has its roots in C, but before explaining that, I'll try to justify it in C++ terms.</p>\n\n<p>An <code>if</code>/<code>while</code>/<code>for</code> statement is supposed to take any scalar (integer, float, or pointer), or class instance convertible to a <code>bool</code>. It simply checks to see if the value is equivalent to zero. Given this permissiveness, it's relatively harmless for the compiler to use an <code>explicit</code> operator to fit a value into an <code>if</code> statement.</p>\n\n<p><code>switch</code>, on the other hand, only really makes sense with integers and <code>enum</code>s. If you try to use <code>switch</code> with a <code>double</code> or pointer, you get the same error. This makes it easier to define discrete case values. Since a <code>switch</code> statement specifically needs to see an integer, it's probably a mistake to use a class instance that doesn't define implicit conversion.</p>\n\n<p>Historically, the reason is that <strong>this is how C does it.</strong></p>\n\n<p>C++ was originally intended to be backward compatible with C (though it's never been successful at that). C never had a boolean type until more recent times. C's <code>if</code> statements had to be permissive, because there just wasn't any other way to do it. While C does not do struct-to-scalar type conversions like C++ does, C++'s treatment of <code>explicit</code> methods reflects the fact that <code>if</code> statements are very permissive in both languages.</p>\n\n<p>C's <code>switch</code> statement, unlike <code>if</code>, needs to work with discrete values, therefore it can't be so permissive.</p>\n"}], "owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2469, "favorite_count": 1, "answer_count": 6, "score": 15, "last_activity_date": 1528370354, "creation_date": 1528288177, "last_edit_date": 1528292792, "question_id": 50720440, "link": "https://stackoverflow.com/questions/50720440/why-do-switch-and-if-statements-behave-differently-with-conversion-operators", "title": "Why do switch and if statements behave differently with conversion operators?", "body": "<p>Why do <code>switch</code> and <code>if</code> statements behave differently with conversion operators?</p>\n\n<pre><code>struct WrapperA\n{\n    explicit operator bool() { return false; }    \n};\n\nstruct WrapperB\n{\n    explicit operator int() { return 0; }\n};\n\nint main()\n{\n    WrapperA wrapper_a;\n    if (wrapper_a) { /** this line compiles **/ }\n\n    WrapperB wrapper_b;\n    switch (wrapper_b) { /** this line does NOT compile **/ }\n}\n</code></pre>\n\n<p>The compilation error is <code>switch quantity is not an integer</code> while in the <code>if</code> statement it is perfectly recognized as a <code>bool</code>. (GCC)</p>\n"}, {"tags": ["c++", "linux", "cmake", "code-coverage", "gcov"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9641575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Domenico Paolicelli", "link": "https://stackoverflow.com/users/9641575/domenico-paolicelli"}, "edited": false, "score": 0, "creation_date": 1528353196, "post_id": 50724817, "comment_id": 88476461, "body": "Thank You Mahnu! Now it&#39;s clear for me! The error was that i was linking the executable of the program, so it wasn&#39;t working!"}], "tags": [], "owner": {"reputation": 51, "user_id": 9890401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ef8c1f39ade389b91a2e117ca955cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mahnu", "link": "https://stackoverflow.com/users/9890401/mahnu"}, "is_accepted": true, "score": 1, "last_activity_date": 1528300872, "creation_date": 1528300872, "answer_id": 50724817, "question_id": 50720385, "link": "https://stackoverflow.com/questions/50720385/using-gcov-with-cmake-step-by-step/50724817#50724817", "title": "Using gcov with CMake step by step", "body": "<p>The <code>EXECUTABLE</code> option should define how to run something on your code and generate coverage data.</p>\n\n<p>For instance, it should be the instruction that run all your tests.</p>\n\n<p>If you have test defined using ctest, try something like:</p>\n\n<pre><code>SETUP_TARGET_FOR_COVERAGE(NAME coverage \n                          EXECUTABLE ctest)\n</code></pre>\n\n<p>(or <code>ctest --parallel n</code> if you have a lot of tests and more than one processor!)\nIf you have a specific target that run some test, then try something like:</p>\n\n<pre><code>SETUP_TARGET_FOR_COVERAGE(NAME coverage \n                          EXECUTABLE make target)\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 77, "user_id": 9641575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Domenico Paolicelli", "link": "https://stackoverflow.com/users/9641575/domenico-paolicelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3079, "favorite_count": 0, "accepted_answer_id": 50724817, "answer_count": 1, "score": 0, "last_activity_date": 1528300872, "creation_date": 1528288049, "last_edit_date": 1528290403, "question_id": 50720385, "link": "https://stackoverflow.com/questions/50720385/using-gcov-with-cmake-step-by-step", "title": "Using gcov with CMake step by step", "body": "<p>I'm trying to run gcov on a project i'm working on, using <a href=\"https://github.com/bilke/cmake-modules/blob/master/CodeCoverage.cmake\" rel=\"nofollow noreferrer\">this guide</a>.</p>\n\n<p>I followed the instruction on the guide and read a lot of posts, including the <a href=\"https://stackoverflow.com/questions/13116488/detailed-guide-on-using-gcov-with-cmake-cdash\">detailed guide</a> on this site.</p>\n\n<p>But I can't make it work.</p>\n\n<p>The steps I followed are:</p>\n\n<ol>\n<li><p>My main <code>CMakeLists.txt</code> of my project is inside a folder called <code>cmake</code>. Inside this folder I created another folder called <code>CMakeModules</code> and put the <code>CodeCoverage.cmake</code> file inside.</p></li>\n<li><p>I added this code to my CMakeLists.txt:</p>\n\n<pre><code>set(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/CMakeModules)\nif(CMAKE_COMPILER_IS_GNUCXX)\ninclude(CodeCoverage)\nAPPEND_COVERAGE_COMPILER_FLAGS()\nSETUP_TARGET_FOR_COVERAGE(NAME coverage \nEXECUTABLE \nDEPENDENCIES coverage)\nendif()\n</code></pre></li>\n<li><p>I compiled using the commands:</p>\n\n<pre><code>cmake -DCMAKE_BUILD_TYPE=DEBUG ../cmake\n# (I'm compiling from a subfolder of the master folder)\n\nmake\n\nmake coverage\n</code></pre></li>\n<li><p>I have an error when I run <code>make coverage</code> command:</p>\n\n<pre><code>[100%] Resetting code coverage counters to zero.\nProcessing code coverage counters and generating report.\n\nErrno architecture (x86_64-linux-thread-multi-4.6.4-301.fc24.x86_64) does not match executable architecture (x86_64-linux-thread-multi-4.12.9-300.fc26.x86_64) at /usr/lib64/perl5/Errno.pm line 11.\n\nCompilation failed in require at /usr/share/perl5/vendor_perl/File/Temp.pm line 17.\n\nBEGIN failed--compilation aborted at /usr/share/perl5/vendor_perl/File/Temp.pm line 17.\n\nCompilation failed in require at /usr/bin/lcov line 66.\n\nBEGIN failed--compilation aborted at /usr/bin/lcov line 66.\n\nCMakeFiles/coverage.dir/build.make:57: set di istruzioni per l'obiettivo \"CMakeFiles/coverage\" non riuscito\n\nmake[3]: *** [CMakeFiles/coverage] Error 255\n\nCMakeFiles/Makefile2:178: set di istruzioni per l'obiettivo \"CMakeFiles/coverage.dir/all\" non riuscito\n\nmake[2]: *** [CMakeFiles/coverage.dir/all] Errore 2\nCMakeFiles/Makefile2:185: set di istruzioni per l'obiettivo \"CMakeFiles/coverage.dir/rule\" non riuscito\n\nmake[1]: *** [CMakeFiles/coverage.dir/rule] Errore 2\n\nMakefile:214: set di istruzioni per l'obiettivo \"coverage\" non riuscito\nmake: *** [coverage] Errore 2\n</code></pre></li>\n</ol>\n\n<p>My questions are:</p>\n\n<p>Exactly what should I put into the EXECUTABLE slot? The path to the executable that starts the program?</p>\n\n<p>The Setup of the program can be done just by that line I wrote?</p>\n\n<p>I already tried the solution from other threads on this site, but I can't anything that suggest me how to make this work.</p>\n"}, {"tags": ["c++", "qt", "global-variables", "global"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 3, "creation_date": 1528288089, "post_id": 50720361, "comment_id": 88449248, "body": "How did this link? You have a duplicate definition of <code>flag</code>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1528288097, "post_id": 50720361, "comment_id": 88449251, "body": "You have two variables named flag. You want to define your extern <code>int flag;</code> in one cpp file, not both."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1528288151, "post_id": 50720361, "comment_id": 88449283, "body": "Also there is no call to <code>function()</code> - so how you get 2 outputs is a mystery."}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528288203, "post_id": 50720361, "comment_id": 88449321, "body": "Earlier I defined flag in main.cpp only but throws error : Error31\terror LNK2001: unresolved external symbol &quot;int flag&quot; (?flag@@3HA)"}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528288286, "post_id": 50720361, "comment_id": 88449389, "body": "All the functions are being called from another function. It&#39;s a small part of a big project"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 3, "creation_date": 1528288396, "post_id": 50720361, "comment_id": 88449461, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  If you post code that either does not compile or can not show you problem you have, how can you expect an answer?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1528288397, "post_id": 50720361, "comment_id": 88449463, "body": "What was the complete error message including the obj file the unresolved symbol was in?"}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528288631, "post_id": 50720361, "comment_id": 88449603, "body": "I am sorry for some errors in my question : Here is the complete error including the obj file: Error\t31\terror LNK2001: unresolved external symbol &quot;int flag&quot; (?flag@@3HA)\tin the  MainWindow.obj file"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528291745, "post_id": 50720361, "comment_id": 88451710, "body": "aside: Do yourself a favour, and don&#39;t do this... global variables are going to lead to pain later; and that later might be sooner than you think"}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528292483, "post_id": 50720361, "comment_id": 88452252, "body": "@UKMonkey I wish i could do that but it is the requirement of the program to use a global variable"}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528369266, "post_id": 50720361, "comment_id": 88486506, "body": "If anyone finds the solution! Do Post it, meanwhile I implemented a workaround using singleton class. <a href=\"https://www.geeksforgeeks.org/singleton-class-java/\" rel=\"nofollow noreferrer\">link</a> provides a beautiful insight about singleton classes. I advise anyone who comes here to have a look on it. Thanks! :-)"}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 7753675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4nuPf8_UD9E/AAAAAAAAAAI/AAAAAAAAMpM/X5jJYfGS41I/photo.jpg?sz=128", "display_name": "Quadir Ali", "link": "https://stackoverflow.com/users/7753675/quadir-ali"}, "edited": false, "score": 0, "creation_date": 1528291233, "post_id": 50721523, "comment_id": 88451314, "body": "Here&#39;s a reference to this question which has been answered previously: <a href=\"https://stackoverflow.com/questions/10422034/when-to-use-extern-in-c\" title=\"when to use extern in c\">stackoverflow.com/questions/10422034/when-to-use-extern-in-c</a>"}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528292402, "post_id": 50721523, "comment_id": 88452187, "body": "I am sorry but you are wrong. I had to define the flag in MainWindow.cpp because it threw error elsewise (error is given in the comments to the question).  I ran a similar program in Qt Creator WITHOUT defining flag in MainWindow.cpp and again I got the same output &quot;flag is 0&quot; from MainWindow and &quot;flag is 1&quot; from main"}, {"owner": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "reply_to_user": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528292699, "post_id": 50721523, "comment_id": 88452424, "body": "@jmoriarty You have definitions <code>int flag;</code> in MainWindow.cpp and <code>int flag=0;</code> in main.cpp. i.e <i>Two</i> definitions. One of them doesn&#39;t belong. Take one out."}, {"owner": {"reputation": 126, "user_id": 7753675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4nuPf8_UD9E/AAAAAAAAAAI/AAAAAAAAMpM/X5jJYfGS41I/photo.jpg?sz=128", "display_name": "Quadir Ali", "link": "https://stackoverflow.com/users/7753675/quadir-ali"}, "edited": false, "score": 0, "creation_date": 1528293691, "post_id": 50721523, "comment_id": 88453052, "body": "I was addressing any linker errors you were experiencing. The only way this program of yours even links is if one of those &quot;int flag;&quot; definitions was made inside a different scope (i.e. within a namespace). Otherwise, you will get a &quot;duplicate symbol&quot; error. This would also explain how the values don&#39;t sync up because you essentially have 2 distinct variables."}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528294032, "post_id": 50721523, "comment_id": 88453291, "body": "I get the duplicate symbol error when compiling it with Qt Creator but the output still doesnt matches even after removing the definition and compiling it in Qt Creator where as in VS it throws Link error on removing the definition from MainWindow"}, {"owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "edited": false, "score": 0, "creation_date": 1528369237, "post_id": 50721523, "comment_id": 88486486, "body": "If anyone finds the solution! Do Post it, meanwhile I implemented a workaround using singleton class. <a href=\"https://www.geeksforgeeks.org/singleton-class-java/\" rel=\"nofollow noreferrer\">link</a> provides a beautiful insight about singleton classes. I advise anyone who comes here to have a look on it. Thanks! :-)"}], "tags": [], "owner": {"reputation": 126, "user_id": 7753675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4nuPf8_UD9E/AAAAAAAAAAI/AAAAAAAAMpM/X5jJYfGS41I/photo.jpg?sz=128", "display_name": "Quadir Ali", "link": "https://stackoverflow.com/users/7753675/quadir-ali"}, "is_accepted": false, "score": 2, "last_activity_date": 1528291138, "creation_date": 1528291138, "answer_id": 50721523, "question_id": 50720361, "link": "https://stackoverflow.com/questions/50720361/global-variable-not-updating-itself-c/50721523#50721523", "title": "Global Variable not Updating itself - c++", "body": "<p>You <em>declare</em> the global variable flag in MY_GLOBALS_H:</p>\n\n<pre><code>extern int flag;\n</code></pre>\n\n<p>You then <em>define</em> it in MainWindow.cpp:</p>\n\n<pre><code>int flag; // this essentially means \"int flag = 0;\"\n</code></pre>\n\n<p>And then you define it again in main.cpp:</p>\n\n<pre><code>int flag = 0;\n</code></pre>\n\n<p>You can declare a variable many times but it must be defined exactly once.</p>\n"}], "owner": {"reputation": 17, "user_id": 9810218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da30e88a3dd8b1af6544783f0a694fc?s=128&d=identicon&r=PG&f=1", "display_name": "jmoriarty", "link": "https://stackoverflow.com/users/9810218/jmoriarty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528291138, "creation_date": 1528287962, "last_edit_date": 1528289010, "question_id": 50720361, "link": "https://stackoverflow.com/questions/50720361/global-variable-not-updating-itself-c", "title": "Global Variable not Updating itself - c++", "body": "<p>This is a simple example of what i am trying to achieve: \nI have a header file GlobalVar.h </p>\n\n<pre><code>#ifndef MY_GLOBALS_H\n#define MY_GLOBALS_H\n\nextern int flag;\n\n#endif\n</code></pre>\n\n<p>A MainWindow.cpp </p>\n\n<pre><code>#include \"Globalvar.h\"\nint flag;\nvoid function() {\nqDebug() &lt;&lt;\"Flag is\"&lt;&lt;flag;\n}\n</code></pre>\n\n<p>A main.cpp </p>\n\n<pre><code>    #include \"GlobalVar.h\"\n    int flag=0;\n    int main() {\n    if(true) {\n    flag=1;\n    qDebug() &lt;&lt;\"Flag is\"&lt;&lt;flag;\n    }\n}\n</code></pre>\n\n<p>Now the console output shows the value of flag as : \"Flag is 1\" (In Line no:61) and \"Flag is 0\" (In Line no: 80).</p>\n\n<p>This means that the flag has been set to 1 already when it reaches to the MainWindow.cpp then why does to shows the value of flag equal to 0 ?</p>\n"}, {"tags": ["c++", "macros"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528288275, "post_id": 50720334, "comment_id": 88449377, "body": "&quot;any ideas how I could create the init function?&quot; write it by typing the code yourself? To my experience, using macros only to save typing always ends in horror"}, {"owner": {"reputation": 14655, "user_id": 1439522, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/924a7f2067fd21632db2d88559bd1dd9?s=128&d=identicon&r=PG", "display_name": "prom85", "link": "https://stackoverflow.com/users/1439522/prom85"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528288333, "post_id": 50720334, "comment_id": 88449420, "body": "this way it&#39;s easy to forget it. I don&#39;t want to do one thing (adding a parameter) and always have to add it at 2 places... I currently did copy the definitions into notepad++, apply a regex and copied the result back into my init function. I want to avoid this manual step and I want to avoid the danger of forgetting to register a parameter in the list"}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1528289091, "post_id": 50720334, "comment_id": 88449895, "body": "Why do you need <code>getP1()</code>, <code>getP2()</code>, etc? Why not having just one function <code>IParam* getP(int i)</code>? You would need no macro at all."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1528290851, "post_id": 50720334, "comment_id": 88451021, "body": "@user463035818 tell this to the google auto-test goup; if it wasn&#39;t so well supported in various IDE&#39;s I&#39;d write my own that wasn&#39;t so macro abusive!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1528292112, "post_id": 50720334, "comment_id": 88451972, "body": "@UKMonkey imho if it is for a limited scope macros can be fine. I just wrote my own toy test framework based on macros. For tests I am fine with using arcane stuff as long as it doesnt leak into my actual code"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528303309, "post_id": 50720334, "comment_id": 88459175, "body": "Q1: Why do you need an <code>init</code> function? Lazy loading is already a requirement of your scenario, so why not take it to its conclusion: don&#39;t load a given <code>IParam</code> until it is needed?"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528303501, "post_id": 50720334, "comment_id": 88459287, "body": "Q2: It looks like <code>allParams</code> has a fixed length. (Why not use <code>std::array</code> instead?) Why don&#39;t you construct it to the required size, then loop over it, instead of listing each <code>getPN</code> individually? You could also get rid of the individual <code>pN</code> declarations."}, {"owner": {"reputation": 14655, "user_id": 1439522, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/924a7f2067fd21632db2d88559bd1dd9?s=128&d=identicon&r=PG", "display_name": "prom85", "link": "https://stackoverflow.com/users/1439522/prom85"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1528304413, "post_id": 50720334, "comment_id": 88459777, "body": "@JaMiT because I have tools that need to know all available parameters, so I also have a getter for the <code>allParams</code> vector. And yes, an array would do it as well. And yes, you are right, if I can fill the array anyways, I can use it as well to avoid the need of declaring all the parameters"}], "answers": [{"comments": [{"owner": {"reputation": 14655, "user_id": 1439522, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/924a7f2067fd21632db2d88559bd1dd9?s=128&d=identicon&r=PG", "display_name": "prom85", "link": "https://stackoverflow.com/users/1439522/prom85"}, "edited": false, "score": 0, "creation_date": 1528304202, "post_id": 50720626, "comment_id": 88459657, "body": "omg, I&#39;m doing this in multiple places already, did not see this solution to reuse a list..."}], "tags": [], "owner": {"reputation": 706, "user_id": 4070330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de272559ba2ec727fe9b3108afa222f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Kashpur", "link": "https://stackoverflow.com/users/4070330/andrew-kashpur"}, "is_accepted": true, "score": 2, "last_activity_date": 1528288710, "creation_date": 1528288710, "answer_id": 50720626, "question_id": 50720334, "link": "https://stackoverflow.com/questions/50720334/macro-that-creates-a-list-of-all-via-another-macro-created-functions/50720626#50720626", "title": "Macro that creates a list of all via another macro created functions", "body": "<p>It can be done this way:</p>\n\n<p>fields.h:</p>\n\n<pre><code>current_macro(p1)\ncurrent_macro(p2)\ncurrent_macro(p3)\n</code></pre>\n\n<p>manager.h</p>\n\n<pre><code>class Manager{\n  private:\n    #define current_macro //how you want define elements\n    #include fields.h\n    #undef current_macro\n    std::vector&lt;IParam*&gt; allParams;\n  public:\n    #define current_macro //how you want your getter to look like\n    #include fields.h\n    #undef current_macro\n    void init() \n    {\n      #define current_macro //how you want your part of init look like\n      #include fields.h\n      #undef current_macro            \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 14655, "user_id": 1439522, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/924a7f2067fd21632db2d88559bd1dd9?s=128&d=identicon&r=PG", "display_name": "prom85", "link": "https://stackoverflow.com/users/1439522/prom85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 50720626, "answer_count": 1, "score": 1, "last_activity_date": 1528288710, "creation_date": 1528287874, "last_edit_date": 1528288272, "question_id": 50720334, "link": "https://stackoverflow.com/questions/50720334/macro-that-creates-a-list-of-all-via-another-macro-created-functions", "title": "Macro that creates a list of all via another macro created functions", "body": "<p>Here is what I need:    </p>\n\n<pre><code>class Manager\n{\n    private:\n        IParam *p1;\n        IParam *p2;\n        IParam *p3;\n\n        std::vector&lt;IParam*&gt; allParams;\n\n    public:\n\n        void init() \n        {\n            // init allParams list, simply calling all getter is enough here\n            getP1();\n            getP2();\n            getP3();\n        }\n\n        IParam *getP1()\n        {\n            if (p1 == NULL)\n            {\n                p1 = new IParam(\"p1\");\n                allParams.push_back(p1);\n            }\n            return p1;\n        }\n\n        IParam *getP2()\n        {\n            if (p2 == NULL)\n            {\n                p2 = new IParam(\"p2\");\n                allParams.push_back(p2);\n            }\n            return p2;\n        }\n\n        IParam *getP3()\n        {\n            if (p3 == NULL)\n            {\n                p3 = new IParam(\"p3\");\n                allParams.push_back(p3);\n            }\n            return p3;\n        }\n}\n</code></pre>\n\n<p>My macro look look like following:</p>\n\n<pre><code>#define DEFINE_PARAM_CPP(NAME) \\\n        private: \\\n            IParam * NAME; \\\n        public: \\\n            IParam * get##NAME() \\\n            { \\\n                if (NAME == NULL) \\\n                { \\\n                    NAME = new IParam(\"NAME\"); \\\n                    allParams.push_back(NAME); \\\n                } \\\n                return NAME; \\\n            }\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<p>As you can see, I need to initialise a vector (<code>allParams</code>). The macro does not solve this problem yet (the <code>init</code> function is not created by the macro), any ideas how I could create the init function? Defining a static list and adding items to this list in the macro itself is no solution (check background info to find out why). I would need a macro that creates a list of all functions that have been created with the <code>DEFINE_PARAM_CPP</code> macro...</p>\n\n<p><strong>Background</strong></p>\n\n<p>My class is implementing an interface and it will be registered in another software's plugin API. This means, I can't create instances of <code>IParam</code> before all plugins are registered and the API allows me to create <code>IParam</code> objects (<code>IParam</code> objects are registered via another plugin). This means, I need to initialise my list in a lazy way like I currently do.</p>\n"}, {"tags": ["c++", "visual-studio", "macros", "c++17"], "comments": [{"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1528289806, "post_id": 50720327, "comment_id": 88450327, "body": "I remember a question where someone wanted to get a warning or error on missing defines and the solution was to add parentheses to the macros so they are &quot;functions without arguments&quot;. These do not implicitly become false. Unfortunately I cannot remember the title."}, {"owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "reply_to_user": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1528291670, "post_id": 50720327, "comment_id": 88451653, "body": "@PaulR That&#39;s kinda nice and hacky at the same time."}], "answers": [{"comments": [{"owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1528291551, "post_id": 50721506, "comment_id": 88451556, "body": "I&#39;ve already thought of property sheets. But afaik, preprocessor conditionals (<code>#if</code>) cannot be specified in property sheets (like I did with <code>MM_EXEC_POLICY</code>). That&#39;s why I&#39;m not using it already. To the <code>MM_DEBUG</code> macro: I know it&#39;s hacky but sometimes I have to build in release mode (because in debug it would be incredibly slow) but still have to generate some additional output. That&#39;s why I&#39;m overwriting it sometimes."}, {"owner": {"reputation": 1073, "user_id": 8855783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3db067b033a034c53710b8d29e2cf36?s=128&d=identicon&r=PG&f=1", "display_name": "wdudzik", "link": "https://stackoverflow.com/users/8855783/wdudzik"}, "reply_to_user": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1528292798, "post_id": 50721506, "comment_id": 88452478, "body": "Actually you can still use property sheet. If you don&#39;t have many of those <code>#if </code> (like only for Parallel ) you can just create another build configuration."}, {"owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1528293134, "post_id": 50721506, "comment_id": 88452691, "body": "And how would I do that? I don&#39;t want to explicitly define the macro in each config."}], "tags": [], "owner": {"reputation": 1073, "user_id": 8855783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3db067b033a034c53710b8d29e2cf36?s=128&d=identicon&r=PG&f=1", "display_name": "wdudzik", "link": "https://stackoverflow.com/users/8855783/wdudzik"}, "is_accepted": false, "score": 0, "last_activity_date": 1528291113, "creation_date": 1528291113, "answer_id": 50721506, "question_id": 50720327, "link": "https://stackoverflow.com/questions/50720327/internal-build-configuration-during-project-development-good-practices/50721506#50721506", "title": "Internal build configuration during project development - good practices", "body": "<p>The <code>_DEBUG</code> macro is available project wide because it is defined in project properties page in Visual Studio. I am not sure it there is a possibility to export macros from *.hpp to cmd (as far as I know it is not possible). As you tagged your question with Visual Studio, I assume that this is the only IDE that you are using and you don't care for portability.</p>\n\n<p>When it comes to Visual Studio there are property sheets which are designed to hold whole configuration for project. They are separated by build type (e.g. debug, release, x64, x86). I think that it might be good idea to use them. You can read more about it on <a href=\"https://msdn.microsoft.com/en-us/library/669zx6zc.aspx\" rel=\"nofollow noreferrer\">MSDN</a>. IMHO I think it is better than holding all of that in some source file, but this is only my opinion.</p>\n\n<p>I am not sure if this is better way. As in case of many C++ libraries there are often a lot of macros used in similar manner to what you have written like checking compiler version, and switching some things if <code>_DEBUG</code> is defined. Other thing to choose might be using CMake which holds build configuration but this will be almost the same as Visual Studio Property Page (but just more portable to other OS).</p>\n\n<p>Important thing never do this kind of hack because someday you will forget to remove it and it will cause troubles for others</p>\n\n<pre><code>// temporarily overrules _DEBUG\n   #define MM_DEBUG true\n</code></pre>\n"}], "owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528293921, "creation_date": 1528287844, "last_edit_date": 1528293921, "question_id": 50720327, "link": "https://stackoverflow.com/questions/50720327/internal-build-configuration-during-project-development-good-practices", "title": "Internal build configuration during project development - good practices", "body": "<p><em>First of all sorry for the vague title. If someone comes up with a better one feel free to change it.</em></p>\n\n<p>I'm developing a c++ library in Visual Studio and during development I want to be able to change some internal build configurations (for easier testing, tracing, etc.), i.e. compile code for sequential instead of parallel execution (easier debugging).</p>\n\n<p>The way I'm doing it right now is by defining some macros in a separate header file:</p>\n\n<p><strong>BuildConfig.hpp</strong></p>\n\n<pre><code>#pragma once\n\n#ifdef _DEBUG \n    #define MM_DEBUG true\n#else\n    #define MM_DEBUG false\n#endif\n\n// temporarily overrules _DEBUG\n#define MM_DEBUG true\n\n#define MM_PARALLEL true\n#define MM_DEBUG_SEQUENTIAL (MM_DEBUG &amp;&amp; !MM_PARALLEL)\n\n#if MM_PARALLEL\n    #define MM_EXEC_POLICY std::execution::par\n#else\n    #define MM_EXEC_POLICY std::execution::seq\n#endif\n</code></pre>\n\n<p>The only problem I have with using a header file is that I have to include it in basically every source (or header) file to make the macros available. But when I forget to include that header somewhere those source files are not build correctly (as all the <code>#if</code> statements will evaluate to false because the macro does not exist in that file).</p>\n\n<p>Is there a way to <em>export</em> all the macros from <strong>BuildConfig.hpp</strong> to the command line, so that the macros become available project wide (like <code>_DEBUG</code> or <code>__cplusplus</code>)?</p>\n\n<p>Is this even a good practice? Are there better ways (in terms of good practice) to achieve what I want?</p>\n\n<h2>Edit</h2>\n\n<p>I've found a way to include the <strong>BuildConfig.hpp</strong> header in each file using the <strong>FI</strong> flag (forced include). It's located at <em>project properties > C/C++ > Advanced > Forced Include File</em></p>\n"}, {"tags": ["c++", "r", "boolean", "subset", "rcpp"], "answers": [{"tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": true, "score": 2, "last_activity_date": 1528287945, "creation_date": 1528287945, "answer_id": 50720358, "question_id": 50720118, "link": "https://stackoverflow.com/questions/50720118/subsetting-using-a-bool-vector-in-rcpp-function-problems-of-a-rcpp-beginner/50720358#50720358", "title": "Subsetting using a Bool-Vector in Rcpp-Function (problems of a Rcpp Beginner...)", "body": "<p>There is no need to go for C++ here. Just use R properly:</p>\n\n<pre><code>raw_data = data.frame(\n  age = c(10, 14, 99, 67, 87, 54, 12, 44, 22, 8),\n  iCode = c(\"code1\", \"code2\", \"code3\", \"code1\", \"code4\", \"code3\", \"code2\", \"code5\", \"code5\", \"code3\"))\n\ndecoder = data.frame(\n  code = c(\"code1\",\"code2\",\"code3\",\"code4\",\"code5\"),\n  kid = c(0,0,0,0,100),\n  adult = c(100,200,300,400,500))\n\nfoo &lt;- merge(raw_data, decoder, by.x = \"iCode\", by.y = \"code\")\nfoo$res &lt;- ifelse(foo$age &gt; 18, foo$adult, foo$kid)\nfoo\n#&gt;    iCode age kid adult res\n#&gt; 1  code1  10   0   100   0\n#&gt; 2  code1  67   0   100 100\n#&gt; 3  code2  14   0   200   0\n#&gt; 4  code2  12   0   200   0\n#&gt; 5  code3  54   0   300 300\n#&gt; 6  code3  99   0   300 300\n#&gt; 7  code3   8   0   300   0\n#&gt; 8  code4  87   0   400 400\n#&gt; 9  code5  44 100   500 500\n#&gt; 10 code5  22 100   500 500\n</code></pre>\n\n<p>That should also work for large data sets.</p>\n"}], "owner": {"reputation": 68, "user_id": 5669003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2755957057edfe185c5eabd1e3d5d0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Phi89", "link": "https://stackoverflow.com/users/5669003/phi89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 50720358, "answer_count": 1, "score": 0, "last_activity_date": 1528288011, "creation_date": 1528287189, "last_edit_date": 1528288011, "question_id": 50720118, "link": "https://stackoverflow.com/questions/50720118/subsetting-using-a-bool-vector-in-rcpp-function-problems-of-a-rcpp-beginner", "title": "Subsetting using a Bool-Vector in Rcpp-Function (problems of a Rcpp Beginner...)", "body": "<p>Problem description (think of a membership with different prices for adults and kids): \nI am having two data sets, one containing age and a code. A second dataframe \"decodes\" the codes to numeric values dependent someone is a kid or adult. I know want to match the codes in both data sets and receive a vector that contains numeric values for each customer in the data set.</p>\n\n<p>I can make this work with standard R-functionalities, but since my original data contains several million observations I would like to speed up computation using the Rcpp package. </p>\n\n<p>Unfortunately I do not succeed, especially how to perform the subsetting based on a logical vector as I would do it in R. I am quite new to Rcpp and have no experience with C++ so I am maybe missing some very basic point.</p>\n\n<p>I attached a minimum working example for R and appreciate any kind of help or explanation!</p>\n\n<hr>\n\n<pre><code>library(Rcpp)\n\nraw_data = data.frame(\n       age = c(10, 14, 99, 67, 87, 54, 12, 44, 22, 8),\n       iCode = c(\"code1\", \"code2\", \"code3\", \"code1\", \"code4\", \"code3\", \"code2\", \"code5\", \"code5\", \"code3\"))\n\ndecoder = data.frame(\n        code = c(\"code1\",\"code2\",\"code3\",\"code4\",\"code5\"),\n        kid = c(0,0,0,0,100),\n        adult = c(100,200,300,400,500))\n\n#-------- R approach (works, but takes ages for my original data set)\ncalc_value = function(data, decoder){\ny = nrow(data)\nfor (i in 1:nrow(data)){\n   position_in_decoder = (data$iCode[i] == decoder$code)\n   if (data$age[i] &gt; 18){\n          y[i] = decoder$adult[position_in_decoder]\n      }else{\n          y[i] = decoder$kid[position_in_decoder]\n      }\n    }\n return(y)\n }\n\ny = calc_value(raw_data, decoder)\n\n#--------- RCPP approach (I cannot make this one work) :(\n\ncppFunction(\n'NumericVector calc_Rcpp(DataFrame df, DataFrame decoder) {\n NumericVector age = df[\"age\"];\n CharacterVector iCode = df[\"iCode\"];\n CharacterVector code = decoder[\"code\"];\n NumericVector adult = decoder[\"adult\"];\n NumericVector kid = decoder[\"kid\"];\n const int n = age.size();\n LogicalVector position;\n NumericVector y(n);\n\n  for (int i=0; i &lt; n; ++i) {\n    position = (iCode[i] == code);\n    if (age[i] &gt; 18 ) y[i] = adult[position];\n    else y[i] = kid[position];\n    }\n  return y;\n  }')\n</code></pre>\n"}, {"tags": ["c++", "mysql", "libmysql"], "comments": [{"owner": {"reputation": 4806, "user_id": 1945697, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bGRTK.jpg?s=128&g=1", "display_name": "Sloan Thrasher", "link": "https://stackoverflow.com/users/1945697/sloan-thrasher"}, "edited": false, "score": 1, "creation_date": 1528287646, "post_id": 50720077, "comment_id": 88448966, "body": "Instead of multiple INSERTs, create one INSERT with multiple values. IOW, before the loop, have the <code>INSERT INTO TABLE (columns)</code>, then inside the loop, append <code>(values),</code> for each value set"}], "answers": [{"tags": [], "owner": {"reputation": 4806, "user_id": 1945697, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bGRTK.jpg?s=128&g=1", "display_name": "Sloan Thrasher", "link": "https://stackoverflow.com/users/1945697/sloan-thrasher"}, "is_accepted": true, "score": 0, "last_activity_date": 1528287948, "creation_date": 1528287948, "answer_id": 50720359, "question_id": 50720077, "link": "https://stackoverflow.com/questions/50720077/mysql-transaction-and-buffered-list-of-requests/50720359#50720359", "title": "MySQL transaction and buffered list of requests", "body": "<p>Instead of multiple INSERTs, create one INSERT with multiple values. IOW, before the loop, \nhave the <code>INSERT INTO TABLE (columns)</code>, then inside the loop, append <code>(values),</code> for each value set.</p>\n\n<pre><code>MySQLWrapper.StartTransaction();\n\nstring QueryBuffer = \"INSERT INTO mytable (myfield) VALUES \";\n\n// Element count is the number of elements parsed from the files\nfor( int i = 0 ; i &lt; ElementCount ; ++i )\n{\n    bool FlushBuffer = \n    ( i&gt; 0 &amp;&amp; ! (( i + 1 ) % N) )    ||\n    ( i == ElementCount - 1 ); // determines if we have reached the buffer max number of requests\n\n    QueryBuffer += \"(\" Element[ i ] \")\";\n    if( flushbuffer ) {\n        QueryBuffer += \";\";\n    } else {\n        QueryBuffer += \",\";\n    }\n\n    if( FlushBuffer )\n    {\n        MySQLWrapper.SendRequest( QueryBuffer );\n        QueryBuffer.assign(\"\");\n    }\n}\nMySQLWrapper.Commit();\n</code></pre>\n\n<p>The resulting SQL statement will be something like:</p>\n\n<pre><code>INSERT INTO mytable\n(myfield)\nVALUES\n(1),\n(2),\n(3),\n(3);\n</code></pre>\n"}], "owner": {"reputation": 122, "user_id": 8608529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a872f435322c5d067ff5b20a73bc650?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu.V", "link": "https://stackoverflow.com/users/8608529/matthieu-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 50720359, "answer_count": 1, "score": 0, "last_activity_date": 1528287948, "creation_date": 1528287064, "question_id": 50720077, "link": "https://stackoverflow.com/questions/50720077/mysql-transaction-and-buffered-list-of-requests", "title": "MySQL transaction and buffered list of requests", "body": "<p>I have a C++ code that parses files and updates the MySQL Database according to the content of these files.\nI run my code in Windows 10, with MySQL 5.7, and my base uses the InnoDB engine. The MySQL calls are performed through a wrapper of my own around libmysql.</p>\n\n<p>In an attempt to optimize this code, I append the update requests in a buffer until reaching the maximum size of the buffer, then send the whole buffer (containing N updates) at the same time. This whole process is done inside a single transaction.</p>\n\n<p>Here is how my code looks:</p>\n\n<pre><code>MySQLWrapper.StartTransaction();\n\nstring QueryBuffer = \"\";\n\n// Element count is the number of elements parsed from the files\nfor( int i = 0 ; i &lt; ElementCount ; ++i )\n{\nbool FlushBuffer = \n( i&gt; 0 &amp;&amp; ! (( i + 1 ) % N) )    ||\n( i == ElementCount - 1 ); // determines if we have reached the buffer max number of requests\n\nQueryBuffer += \"INSERT INTO mytable (myfield) VALUES (\" Element[ i ] \");\";\n\nif( FlushBuffer )\n{\nMySQLWrapper.SendRequest( QueryBuffer );\nQueryBuffer.assign(\"\");\n}\n}\nMySQLWrapper.Commit();\n</code></pre>\n\n<p>The implementation of SendRequest(string Request ) would basically be:</p>\n\n<pre><code>void SendRequest(string Request)\n{\nmysql_query( SQLSocket, Request.c_str())\n}\n</code></pre>\n\n<p>However, when committing the transaction, the transaction happens to have been broken: MySQL indicates that that the state is incorrect for comitting. I have tried to do the same thing but sending requests ony by one, and this error does not happen at the moment of the commit.</p>\n\n<p>So, my 2 questions are:</p>\n\n<ol>\n<li>Do you know why the fact to send multiple requests at a time breaks my transaction?</li>\n<li>Do you think that the use of a buffered list of requests can really optimize my code?</li>\n</ol>\n"}, {"tags": ["c++", "c++17", "typetraits", "c++-standard-library"], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1528289124, "post_id": 50720306, "comment_id": 88449919, "body": "okay, so i got it conceptually right :P i guess other implementations will follow msvc with the &quot;right&quot; thing sometime?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1528289292, "post_id": 50720306, "comment_id": 88450021, "body": "@ph&#246;n Yes, sooner or later, the other implementations should become conforming, too. C++17 is still quite new; it usually can take a bit until all changes to the standard are fully implemented."}], "tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": true, "score": 10, "last_activity_date": 1528288407, "last_edit_date": 1528288407, "creation_date": 1528287787, "answer_id": 50720306, "question_id": 50720054, "link": "https://stackoverflow.com/questions/50720054/is-stdis-trivially-copyable-wrong/50720306#50720306", "title": "Is std::is_trivially_copyable wrong?", "body": "<p>This was changed in C++17; before that, <code>non_trivially_copyable</code> would have been trivially copyable. Your class is indeed not trivially copyable in C++17, by the part of the standard you refer to yourself.</p>\n\n<p>However, it appears libstdc++ and libc++ were not updated to reflect that yet. So to answer your question directly: those two implementations are indeed wrong.\nNote that your godbolt link shows that MSVC does get it right.</p>\n\n<p>As this was considered a defect (see <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1734\" rel=\"noreferrer\">CWG 1734</a>), this is supposed to change for implementations of older revisions of C++, too.</p>\n\n<hr>\n\n<p>As far as I know, one core motivation for the change in the standard was to make <code>memcpy</code>-ing around atomics and mutexes illegal.</p>\n"}], "owner": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 3, "accepted_answer_id": 50720306, "answer_count": 1, "score": 11, "last_activity_date": 1528289152, "creation_date": 1528286961, "last_edit_date": 1528289152, "question_id": 50720054, "link": "https://stackoverflow.com/questions/50720054/is-stdis-trivially-copyable-wrong", "title": "Is std::is_trivially_copyable wrong?", "body": "<p>Considering cppreference and the current c++ working draft, a class is trivially copyable if:</p>\n\n<ol>\n<li>Every copy constructor is trivial or deleted</li>\n<li>Every move constructor is trivial or deleted</li>\n<li>Every copy assignment operator is trivial or deleted</li>\n<li>Every move assignment operator is trivial or deleted</li>\n<li><strong>at least one copy constructor, move constructor, copy assignment operator, or move assignment operator is non-deleted</strong></li>\n<li><p>Trivial non-deleted destructor</p>\n\n<ul>\n<li><a href=\"http://en.cppreference.com/w/cpp/concept/TriviallyCopyable\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/concept/TriviallyCopyable</a></li>\n<li><a href=\"http://en.cppreference.com/w/cpp/types/is_trivially_copyable\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/types/is_trivially_copyable</a></li>\n<li><a href=\"https://github.com/cplusplus/draft/blob/master/papers/n4750.pdf\" rel=\"nofollow noreferrer\">https://github.com/cplusplus/draft/blob/master/papers/n4750.pdf</a> (page 215)</li>\n</ul></li>\n</ol>\n\n<p>So I came up with this code sample: </p>\n\n<pre><code>#include &lt;type_traits&gt;\n\nstruct non_trivially_copyable {\n  non_trivially_copyable(non_trivially_copyable const&amp;) = delete;\n  non_trivially_copyable&amp; operator=(non_trivially_copyable const&amp;) = delete;\n  non_trivially_copyable(non_trivially_copyable &amp;&amp;) = delete;\n  non_trivially_copyable&amp; operator=(non_trivially_copyable &amp;&amp;) = delete;\n};\n\nint main()\n{\n    return std::is_trivially_copyable&lt;non_trivially_copyable&gt;::value;\n}\n</code></pre>\n\n<p>My class does not satisfy requirement number 5. Still it gives me the result that my class <code>non_trivially_copyable</code> is trivially copyable. I tested it on some online compilers:</p>\n\n<ul>\n<li><a href=\"https://godbolt.org/g/9s4fr9\" rel=\"nofollow noreferrer\">https://godbolt.org/g/9s4fr9</a></li>\n<li><a href=\"https://wandbox.org/permlink/sEJYdi5aIDMzsjGY\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/sEJYdi5aIDMzsjGY</a></li>\n<li><a href=\"https://onlinegdb.com/SyFyTBrx7\" rel=\"nofollow noreferrer\">https://onlinegdb.com/SyFyTBrx7</a></li>\n<li><a href=\"http://coliru.stacked-crooked.com/a/93b6ea4d202092a6\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/93b6ea4d202092a6</a></li>\n</ul>\n\n<p>I doubt that all implementations are wrong; so why do I get this result?</p>\n"}]